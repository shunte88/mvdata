id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2569921224,issue,open,,Batch Quantity Should b Editable ,"**Is your feature request related to a problem? Please describe.**
As we are implementing the Manufacturing, we need to Edit the BOM Raw material Consumed item ( Because it always differs and Is also Related to ITC  )


**Describe the solution you'd like**
Option to edit BOM consumed with ( 10% or Any Value ) As general Setting 

Also Discussed with Rohit ( Manufacturing Product Owner )
",Kushalnahata17,2024-10-07 09:49:07+00:00,[],2024-10-14 05:21:12+00:00,,https://github.com/frappe/erpnext/issues/43519,"[('feature-request', None)]","[{'comment_id': 2399399342, 'issue_id': 2569921224, 'author': 'frewper', 'body': 'can you please explain your use case in detail. Only then can it relate to your requirement. \r\nMore information will be viable.', 'created_at': datetime.datetime(2024, 10, 8, 9, 56, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2409969685, 'issue_id': 2569921224, 'author': 'Kushalnahata17', 'body': ""For example, the Vendor sent 100kg to a subcontractor, and then I placed a subcontracting order for 30kg. I received 28 kg ( As per BOM consumed Qty is 27 ) But Actually is 28 kgs so we don't have an option to update consumed Qty in Manufacturing and in Subcontracting, which leads to imbalance in stock and also in ITC04 REPORT."", 'created_at': datetime.datetime(2024, 10, 14, 5, 21, 11, tzinfo=datetime.timezone.utc)}]","frewper on (2024-10-08 09:56:16 UTC): can you please explain your use case in detail. Only then can it relate to your requirement. 
More information will be viable.

Kushalnahata17 (Issue Creator) on (2024-10-14 05:21:11 UTC): For example, the Vendor sent 100kg to a subcontractor, and then I placed a subcontracting order for 30kg. I received 28 kg ( As per BOM consumed Qty is 27 ) But Actually is 28 kgs so we don't have an option to update consumed Qty in Manufacturing and in Subcontracting, which leads to imbalance in stock and also in ITC04 REPORT.

"
2569849066,issue,open,,Required valuation in Stock Ageing Report,"For the compliance part, a company needs to show Stock Ageing report with its valuation. Currently, the stock ageing is not showing the valuation in the report it shows only Inventory Qty related part. Can we add valuation also?

<img width=""1313"" alt=""image"" src=""https://github.com/user-attachments/assets/64db9c91-0b85-4078-809e-d26c4437fd62"">
",smbcatalyst,2024-10-07 09:19:34+00:00,[],2024-10-07 09:19:34+00:00,,https://github.com/frappe/erpnext/issues/43516,"[('feature-request', None)]",[],
2578670944,issue,open,,Unable to create 'payment entry' for 'party type - student'.,"## Description of the issue
Updated erpnext v13 to erpnext v15.
I'm trying to create 'payment entry' for 'party type' student. After selecting 'party' from the drop down options, the section Payment From / To remains empty but other field sections like 'accounts' display information regarding the past payment. Also, no drop down options are displayed when I enter names in 'party name' field. Even after selecting the student from the 'party' drop down options and filling up the 'paid amount' field, the amount does not reflect in the 'accounting ledger' for that particular student.
![erp1](https://github.com/user-attachments/assets/191f8843-1dcd-4c3e-91e9-d3b7e0a1d14f)


## Steps to reproduce the issue

1. Open 'payment entry' form and enter the 'mode of payment' as 'bank draft'.
2. Enter 'party type' as student.
3. Enter 'party name'.
4. Enter 'paid amount'.
5. Click save and submit.

### Observed result
1. No students name displayed.
2. No payment entry is connected to the student's name.

### Expected result
1. 'party name' should display students name.
2. successful payment entry for the student.

## Additional information
Frappe Cloud
Education: v15.0.0 (HEAD)

ERPNext: v15.38.0 (HEAD)

Frappe Framework: v15.43.0 (HEAD)

Frappe HR: v15.30.0 (HEAD)
",deepakc21,2024-10-07 07:31:38+00:00,[],2024-10-10 12:13:26+00:00,,https://github.com/frappe/erpnext/issues/43606,"[('bug', None)]",[],
2569097465,issue,open,,`Customer Acquisition and Loyalty` report considers a customer as a new customer on the first occurrence within the selected data range,"### Information about bug

Go to `Customer Acquisition and Loyalty` report and select a date range (say 1st of July 2024 to 30th September 2024). The report's logic is written in such a way, it will consider a customer as a new customer when that customer is seen for the 1st time within the selected range. 

This report uses `Sales Invoice` docs to get customer data. If an old customer has purchased something within this period, that customer is counted as a new customer in the first occurrence. 

See https://github.com/frappe/erpnext/blob/develop/erpnext/selling/report/customer_acquisition_and_loyalty/customer_acquisition_and_loyalty.py#L173 where this distinction is being made.

### Module

selling

### Version

ERPNext 14.66.1
Frappe - 14.69.0

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",IMS94,2024-10-07 01:57:52+00:00,[],2024-10-07 01:57:52+00:00,,https://github.com/frappe/erpnext/issues/43510,"[('bug', None)]",[],
2568807769,issue,closed,completed,"1054, ""Unknown column 'tabContact.is_billing_contact' in 'where clause'""","### Information about bug

I am getting an unknown column error while creating a customer from a Quotation Doctype.
![image](https://github.com/user-attachments/assets/d672d91e-7c34-4ca6-adc3-eb7638407c55)

There is no field called ""is_billing_contact"" in the Customer doctype JSON file, but there is one in another JSON file.
![image](https://github.com/user-attachments/assets/a273b6f0-ca8a-465d-9043-eb2321eb0655)


### Module

selling

### Version

""erpnext"": ""16.0.0-dev"",
""frappe"": ""16.0.0-dev"",
""hrms"": ""16.0.0-dev""

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""erpnext"": ""16.0.0-dev"",
	""frappe"": ""16.0.0-dev"",
	""hrms"": ""16.0.0-dev""
}
```
### Route
```
Form/Quotation/new-quotation-osljqkbdql
```
### Traceback
```python
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 115, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1823, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 32, in wrapper
    return func(*args, **kwargs)
  File ""apps/erpnext/erpnext/accounts/party.py"", line 74, in get_party_details
    return _get_party_details(
  File ""apps/erpnext/erpnext/accounts/party.py"", line 133, in _get_party_details
    set_contact_details(party_details, party, party_type)
  File ""apps/erpnext/erpnext/accounts/party.py"", line 306, in set_contact_details
    party_details.contact_person = get_default_contact(party_type, party.name)
  File ""apps/erpnext/erpnext/accounts/party.py"", line 932, in get_default_contact
    contacts = frappe.get_all(
  File ""apps/frappe/frappe/__init__.py"", line 2112, in get_all
    return get_list(doctype, *args, **kwargs)
  File ""apps/frappe/frappe/__init__.py"", line 2087, in get_list
    return frappe.model.db_query.DatabaseQuery(doctype).execute(*args, **kwargs)
  File ""apps/frappe/frappe/model/db_query.py"", line 193, in execute
    result = self.build_and_run()
  File ""apps/frappe/frappe/model/db_query.py"", line 234, in build_and_run
    return frappe.db.sql(
  File ""apps/frappe/frappe/database/database.py"", line 236, in sql
    self._cursor.execute(query, values)
  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 153, in execute
    result = self._query(query)
  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 322, in _query
    conn.query(q)
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 825, in _read_query_result
    result.read()
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 1199, in read
    first_packet = self.connection._read_packet()
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 775, in _read_packet
    packet.raise_for_error()
  File ""env/lib/python3.10/site-packages/pymysql/protocol.py"", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File ""env/lib/python3.10/site-packages/pymysql/err.py"", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, ""Unknown column 'tabContact.is_billing_contact' in 'where clause'"")

```
### Request Data
```json
{
	""type"": ""POST"",
	""args"": {
		""party"": ""John Doe"",
		""party_type"": ""Customer"",
		""price_list"": ""Standard Selling"",
		""posting_date"": ""2024-10-06"",
		""fetch_payment_terms_template"": 1,
		""currency"": ""INR"",
		""company"": ""Ejaaz Khan"",
		""doctype"": ""Quotation""
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/erpnext.accounts.party.get_party_details"",
	""request_id"": null
}
```
### Response Data
```json
{
	""exception"": ""pymysql.err.OperationalError: (1054, \""Unknown column 'tabContact.is_billing_contact' in 'where clause'\"")"",
	""exc_type"": ""OperationalError"",
	""_exc_source"": ""erpnext (app)""
}
```
",iamejaaz,2024-10-06 18:16:55+00:00,[],2024-10-26 00:10:12+00:00,2024-10-09 18:36:10+00:00,https://github.com/frappe/erpnext/issues/43509,"[('bug', None)]","[{'comment_id': 2396599158, 'issue_id': 2568807769, 'author': 'Nihantra-Patel', 'body': ""We tested variaous flow but we haven't found the issue.\r\n\r\n[scrnli_TtpGnQVbFweTXi.webm](https://github.com/user-attachments/assets/8fa81c30-b4ff-4508-a667-761933e006f5)"", 'created_at': datetime.datetime(2024, 10, 7, 10, 59, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2396714215, 'issue_id': 2568807769, 'author': 'iamejaaz', 'body': ""> We tested variaous flow but we haven't found the issue.\r\n> \r\n>  scrnli_TtpGnQVbFweTXi.webm\r\n\r\nTry creating a new site, installing the HRMS app on it, and then create a customer directly from the Quotation Doctype."", 'created_at': datetime.datetime(2024, 10, 7, 11, 52, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2396717929, 'issue_id': 2568807769, 'author': 'Nihantra-Patel', 'body': ""Already hrms installed on site and the site is new. also, i tested on frappe cloud side, we haven't found the issue."", 'created_at': datetime.datetime(2024, 10, 7, 11, 54, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2396762250, 'issue_id': 2568807769, 'author': 'iamejaaz', 'body': ""> Already hrms installed on site and the site is new. also, i tested on frappe cloud side, we haven't found the issue.\r\n\r\nOkay, I will check again and let you know."", 'created_at': datetime.datetime(2024, 10, 7, 12, 14, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2397601789, 'issue_id': 2568807769, 'author': 'iamejaaz', 'body': 'Hey @Nihantra-Patel I have attached video can you please check it now?\r\n\r\nhttps://github.com/user-attachments/assets/17c95f92-1cba-45d3-a2c1-5a666f37b28b\r\n\r\nOne more thing: the error message shows version 16 for all apps, but when I check the version in the About menu, it shows as version 15 for Frappe and ERPNext.\r\n<img width=""1461"" alt=""image"" src=""https://github.com/user-attachments/assets/3149616f-309e-4c89-a888-86f64a9235a4"">', 'created_at': datetime.datetime(2024, 10, 7, 18, 25, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2401243858, 'issue_id': 2568807769, 'author': 'Nihantra-Patel', 'body': 'please upgrade your develop branch and check it.\r\n\r\n[scrnli_3cQUzSmqHCggyP.webm](https://github.com/user-attachments/assets/9a15cfc2-16a0-49f2-87e4-879192af44a4)', 'created_at': datetime.datetime(2024, 10, 9, 4, 4, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2401293744, 'issue_id': 2568807769, 'author': 'iamejaaz', 'body': '> please upgrade your develop branch and check it.\r\n> \r\n>  scrnli_3cQUzSmqHCggyP.webm\r\n\r\nOkay, I will check and let you know by tomorrow.', 'created_at': datetime.datetime(2024, 10, 9, 4, 32, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2403017039, 'issue_id': 2568807769, 'author': 'iamejaaz', 'body': '> please upgrade your develop branch and check it.\r\n> \r\n>  scrnli_3cQUzSmqHCggyP.webm\r\n\r\nUpgrading resolved the issue. Thank you.', 'created_at': datetime.datetime(2024, 10, 9, 18, 36, 10, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-10-07 10:59:56 UTC): We tested variaous flow but we haven't found the issue.

[scrnli_TtpGnQVbFweTXi.webm](https://github.com/user-attachments/assets/8fa81c30-b4ff-4508-a667-761933e006f5)

iamejaaz (Issue Creator) on (2024-10-07 11:52:20 UTC): Try creating a new site, installing the HRMS app on it, and then create a customer directly from the Quotation Doctype.

Nihantra-Patel on (2024-10-07 11:54:03 UTC): Already hrms installed on site and the site is new. also, i tested on frappe cloud side, we haven't found the issue.

iamejaaz (Issue Creator) on (2024-10-07 12:14:32 UTC): Okay, I will check again and let you know.

iamejaaz (Issue Creator) on (2024-10-07 18:25:10 UTC): Hey @Nihantra-Patel I have attached video can you please check it now?

https://github.com/user-attachments/assets/17c95f92-1cba-45d3-a2c1-5a666f37b28b

One more thing: the error message shows version 16 for all apps, but when I check the version in the About menu, it shows as version 15 for Frappe and ERPNext.
<img width=""1461"" alt=""image"" src=""https://github.com/user-attachments/assets/3149616f-309e-4c89-a888-86f64a9235a4"">

Nihantra-Patel on (2024-10-09 04:04:18 UTC): please upgrade your develop branch and check it.

[scrnli_3cQUzSmqHCggyP.webm](https://github.com/user-attachments/assets/9a15cfc2-16a0-49f2-87e4-879192af44a4)

iamejaaz (Issue Creator) on (2024-10-09 04:32:42 UTC): Okay, I will check and let you know by tomorrow.

iamejaaz (Issue Creator) on (2024-10-09 18:36:10 UTC): Upgrading resolved the issue. Thank you.

"
2568635222,issue,open,,CRM Opportunity -> new task creates always 2 ToDos,"### Information about bug

CRM -> Opportunity view → Tab Activities → new Task

If I fill in “Assigned To” field, there are automatically 2 ToDos created. 
One Todo is referencing the opportunity. the other Todo is referencing the ToDo associated to the opportunity and is automatically called “Assignment for ToDo xxxx”. Of both ToDos the ""Allocated To"" fields are set to the user that has been filled in the “Assigned To” field in the dialog before.

![grafik](https://github.com/user-attachments/assets/a0177d34-9c5e-4b46-8184-4af712522d3a)
![grafik](https://github.com/user-attachments/assets/3239c36d-d3b0-486d-8c23-4d6d964fcedc)

If I leave the “assigned To” field blank in the dialogue, the ToDo is not assigned at all and the “allocated To” field remains empty. Only one ToDo is created but an additional step is necessary to allocate the Todo to a user (setting the allocated to field).
If the SideBar funtionality ""assign to"" is used to assign it to a user an additional ToDo is created referencing the original ToDo.

There has always been as mismatch between the “assigned To” functionality and setting the “allocated To” field in a ToDo depending on the entry point (from within an opportunity new Task dialogue or from the Todo-List view new Todo form).

This ""assignment""/""allocated to"" bug is cluttering the system with duplicate entries and tracking of Todo's status is almost impossible.

Setting the “Allocated To” field is not possible from within the dialogue that is presented when creating a Task when you use the entry point Opportunity → Activies → new task. Actually this should be possible!
Alternatively the mismatch and confusing usage logic of ""assign to"" and ""allocated To"" for ToDos should be resolved.


### Module

CRM

### Version

Frappe Version - 15
ERPNext Version - 15

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",healthvisionadmin,2024-10-06 12:27:01+00:00,[],2025-01-09 10:49:22+00:00,,https://github.com/frappe/erpnext/issues/43508,"[('bug', None)]","[{'comment_id': 2571695933, 'issue_id': 2568635222, 'author': 'swissbyte', 'body': 'Hey there \r\nIm experience the same behaviour. \r\nThere is a dirty workaround for this... \r\n\r\n- Create a serverscript from the ui (Build -> Serverscript -> Add) You might have to enable this feature in the bench config or through the bench command itself... \r\n\r\n- Choose as Doctype ""ToDo""\r\n- Choose ""before save""\r\n- Add the code: \r\n\r\n```\r\n# Prüfe, ob ""Zuweisung für ToDo "" in der Beschreibung der Aufgabe enthalten ist\r\nif ""Zuweisung für ToDo "" in doc.description:\r\n    # Speichern ohne Nachricht abbrechen\r\n    raise frappe.ValidationError\r\n```\r\n\r\nThe above code is for german. \r\nIn your case you need to look for the text ""Assignement for ToDo ""\r\n\r\nExample: \r\n\r\n```\r\n# Prüfe, ob ""Zuweisung für ToDo "" in der Beschreibung der Aufgabe enthalten ist\r\nif ""Assignement for ToDo "" in doc.description:\r\n    # Speichern ohne Nachricht abbrechen\r\n    raise frappe.ValidationError\r\n\r\n```\r\n\r\nThis code will prevent the system from saving the duplicate ToDo entry... \r\n\r\nIf one can tell me how to setup a proper dev environment on Windows without docker.... i would be happy to solve a lot of issues from ErpNext ;)', 'created_at': datetime.datetime(2025, 1, 5, 17, 25, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2579819281, 'issue_id': 2568635222, 'author': 'mihir-kandoi', 'body': 'It looks like you are Frappe Cloud customer. Please create a support ticket on Frappe Cloud.', 'created_at': datetime.datetime(2025, 1, 9, 10, 49, 20, tzinfo=datetime.timezone.utc)}]","swissbyte on (2025-01-05 17:25:31 UTC): Hey there 
Im experience the same behaviour. 
There is a dirty workaround for this... 

- Create a serverscript from the ui (Build -> Serverscript -> Add) You might have to enable this feature in the bench config or through the bench command itself... 

- Choose as Doctype ""ToDo""
- Choose ""before save""
- Add the code: 

```
# Prüfe, ob ""Zuweisung für ToDo "" in der Beschreibung der Aufgabe enthalten ist
if ""Zuweisung für ToDo "" in doc.description:
    # Speichern ohne Nachricht abbrechen
    raise frappe.ValidationError
```

The above code is for german. 
In your case you need to look for the text ""Assignement for ToDo ""

Example: 

```
# Prüfe, ob ""Zuweisung für ToDo "" in der Beschreibung der Aufgabe enthalten ist
if ""Assignement for ToDo "" in doc.description:
    # Speichern ohne Nachricht abbrechen
    raise frappe.ValidationError

```

This code will prevent the system from saving the duplicate ToDo entry... 

If one can tell me how to setup a proper dev environment on Windows without docker.... i would be happy to solve a lot of issues from ErpNext ;)

mihir-kandoi on (2025-01-09 10:49:20 UTC): It looks like you are Frappe Cloud customer. Please create a support ticket on Frappe Cloud.

"
2568549479,issue,open,,Allow tax-inclusive prices for 'Actual' Sales Taxes and Charges,".... **or** Allow for 'Service' type items to NOT be included on delivery notes.

The issue / use case:

Our prices for sales transactions are GST-inclusive.  The problem we are facing is that we:

a) Can't add a shipping charge on sales transactions as an 'Actual' charge in the Sales Taxes and Charges section because it doesn't allow for GST-inclusive prices.

As a way around this, we could add it as a 'Service' type line item in the Item Table instead, however the problem then becomes:

b)  We cannot exclude this from appearing on subsequent delivery notes.  As an inventory-based business, if a delivery note goes into the customer's parcel it seems silly to have Postage/Shipping/Delivery there as a line item, as it is not a physical item being delivered.  

c) This becomes even more problematic if orders are being part-fulfilled until the order is complete, which is not unusual.  In this case, if there is one postage charge added for the entire order to be invoiced, where or when, should the shipping charge be 'delivered'?  With the first delivery, or randomly added into one of the further deliveries, or at the end?  Perhaps just keep removing the line item from each delivery note until all items have been fulfilled and delivered, leaving only the shipping line left to be 'delivered' which we do internally as a last step and is not part of any customer facing delivery notes?  

d) Another possible way to workaround it could be to use the Picking Lists (renamed as Package Slips or something to that effect) which don't populate with Service items, and use those to include in the customer deliveries instead.  Then forgo the delivery notes all together, just 'update stock' from the sales invoice.  But from a procedure and process perspective for order fulfillment, this also has its issues: ie when looking down the sales order list we won't be able to differentiate which orders (and items within) have been picked/packed vs delivered vs invoiced, especially when we are incrementally fullfilling and invoicing orders as items are despatched.

As eluded to above, I am looking at this from a process and procedural perspective (not necessarily a technical or any other perspective) and any which way I look at it, it is cumbersome and not straightforward.  Once you start to have multiple users interacting with the system for order fulfillment and variation in types of order processes (ie, invoiced and paid upfront vs incrementally as the order is fulfilled and despatched vs at the end once the entire order is completed, etc) this just becomes even more exacerbated.    

",c-l-v,2024-10-06 09:00:16+00:00,[],2024-10-06 21:27:15+00:00,,https://github.com/frappe/erpnext/issues/43505,"[('feature-request', None)]",[],
2567786295,issue,open,,Trial Balance Report,"Hello,

Could you please bold the trial balance report's group accounts? Our auditor suggests that making the groupings bold and the type a little larger to make managing the report easier.

Thanks,

Midhat Ayesha Shaikh",precihole,2024-10-05 09:44:28+00:00,[],2024-10-07 19:46:37+00:00,,https://github.com/frappe/erpnext/issues/43500,"[('feature-request', None)]","[{'comment_id': 2397752474, 'issue_id': 2567786295, 'author': 'iamejaaz', 'body': '@precihole \r\nCould you please share some screenshots or indicate which sections you would like in bold? That would make it easier to understand.', 'created_at': datetime.datetime(2024, 10, 7, 19, 46, 35, tzinfo=datetime.timezone.utc)}]","iamejaaz on (2024-10-07 19:46:35 UTC): @precihole 
Could you please share some screenshots or indicate which sections you would like in bold? That would make it easier to understand.

"
2566389722,issue,open,,“Actual Cost” should be included as an option in that list,"
Is there a way to obtain the actual cost of produced items during production? Currently, the available costing methods are: 1. Valuation Rate, 2. Last Purchase Price, and 3. Price List. However, when I choose one of these methods, I don’t seem to get the actual cost.

I suggest that “Actual Cost” should be included as an option in that list.

I purchased raw material X: 10 kg (batch no. 001) at a unit price of 100, totaling 1000.

I also purchased the same item X: 10 kg (batch no. 002) at a unit price of 120, totaling 1200.

BOM costing method: last purchase price

Finished Good: Y

In this scenario, we’re using the “last purchase price” costing method for the Bill of Materials (BOM) for item Y, which means the system will use the most recent purchase price of raw material X when calculating costs.

Since you have two batches of raw material X:

Batch no. 001: 10 kg at 100 per kg (total 1000)
Batch no. 002: 10 kg at 120 per kg (total 1200)
If we produce item Y from batch no. 001, the actual cost should be based on the cost of that batch (1000). However, because we are using the “latest price” method, the system defaults to the price of the most recent batch (batch no. 002 at 1200) for calculations.

If I choose the valuation price method, the cost will be calculated based on what we mentioned for the valuation cost.

How can we get the actual cost, which is 1000?

",kumuduraj,2024-10-04 13:31:35+00:00,[],2024-10-04 13:31:35+00:00,,https://github.com/frappe/erpnext/issues/43497,"[('feature-request', None)]",[],
2566232539,issue,open,,Sales Person wise sales analytics report,"### Information about bug

Similar to sales analytics for customer there should be a report to see sales person wise sales. 

![image](https://github.com/user-attachments/assets/0e3e1f31-82d9-4608-8eb4-b0aef104b063)


### Module

accounts, selling

### Version

V15

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",maveezmh,2024-10-04 12:14:33+00:00,[],2024-10-13 07:30:52+00:00,,https://github.com/frappe/erpnext/issues/43496,"[('feature-request', None)]","[{'comment_id': 2408861261, 'issue_id': 2566232539, 'author': 'azharumar', 'body': 'This will be extremely good. I also have added a feature request to add ""Brand"" to Sales Analytics.\r\n\r\n[https://github.com/frappe/erpnext/issues/43635](url)', 'created_at': datetime.datetime(2024, 10, 13, 7, 30, 51, tzinfo=datetime.timezone.utc)}]","azharumar on (2024-10-13 07:30:51 UTC): This will be extremely good. I also have added a feature request to add ""Brand"" to Sales Analytics.

[https://github.com/frappe/erpnext/issues/43635](url)

"
2563699403,issue,closed,completed,Issue in Serial and  Batch Bundle creation for Rejected Quantity in Purchase Reciept Doctype,"### Information about bug

Below is the Scenario of the issue

I have an Item RM001 which is serial number enabled , I have created below serial numbrers manually which are not yet active
SN0001
SN0002
SN0003
SN0004
SN0005

In Purchase reciept document , I am adding the below serial numbers to accepted Warehouse “ Stores”  through scanning using Add Serial/Batch No button  at Item level as shown below SS
SN0001
SN0002
SN0003

![image](https://github.com/user-attachments/assets/82eae298-eb95-47be-afa7-2341fe77083f)

After that Updating the rejected serial numbers through the option “ Add Serial/ Batch No ( Rejected Qty)  

![rejected](https://github.com/user-attachments/assets/32479bb6-c7ed-4047-b816-95ba48cd4440)

First issue here is Rejected Warehouse is not fetching automatically

Second for rejected serial numbers a Seperate batch bundle is not creating , It is overriding the previously created accepted serial number Serial and Batch Bundle document

Also System is throwing below error once we click on update serial number button. System Automatically changing the rejected warehouse

![image](https://github.com/user-attachments/assets/ec714724-804d-45df-8b27-885fc01b00dc)








### Module

stock

### Version

ERPNext: v15.36.2 (HEAD)

Frappe Framework: v15.42.0 (HEAD)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",Akshaths12,2024-10-03 10:35:33+00:00,[],2024-11-30 00:10:48+00:00,2024-11-13 11:14:55+00:00,https://github.com/frappe/erpnext/issues/43492,"[('bug', None)]","[{'comment_id': 2473266026, 'issue_id': 2563699403, 'author': 'rohitwaghchaure', 'body': '@Akshaths12 We have fixed this issue, please update the site and check', 'created_at': datetime.datetime(2024, 11, 13, 11, 14, 55, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure on (2024-11-13 11:14:55 UTC): @Akshaths12 We have fixed this issue, please update the site and check

"
2562683003,issue,open,,Exchange Rate Fetch Issue,"### Information about bug

<img width=""1141"" alt=""image"" src=""https://github.com/user-attachments/assets/7a82754b-fdca-4b36-9762-db0159b0e518"">


### Module

other

### Version

15.37.0
15.43.0

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",chanyork,2024-10-02 21:40:23+00:00,[],2024-10-07 10:18:58+00:00,,https://github.com/frappe/erpnext/issues/43491,"[('bug', None)]","[{'comment_id': 2395405243, 'issue_id': 2562683003, 'author': 'jukkis69', 'body': 'I have the same issue with, cannot get exchange rate (was working couple of years without an issue)\r\nERPNext: v14.29.1 (version-14)\r\nFrappe Framework: v14.40.1 (version-14)\r\n\r\n![image](https://github.com/user-attachments/assets/94860478-6f5f-4071-bac0-389d1e7c388d)\r\n\r\n\r\nStrangely error message says URL to be: https://frankfurter.dev/2024-10-06?base=USD&symbols=INR which does not work manually doing query.\r\n\r\nHowever if you manually copy the example query ""https://api.frankfurter.app/2023-03-28?base=USD&symbols=INR"" you will get the reply {""amount"":1.0,""base"":""USD"",""date"":""2023-03-28"",""rates"":{""INR"":82.15}} --> so the Frankfurther app is working. My currencies are GBP --> USD, so they also work in manual query.\r\n\r\nWonder where the issue might be?\r\n\r\nAlso if I use exchangerate.host, it complains about ACCESS_KEY.\r\nI have got one, but there seems to be no way to add the ACCESS_KEY to the request query parameters? At least do not seem to figure way to add this.\r\n\r\n![image](https://github.com/user-attachments/assets/d2006b2a-268d-4865-9f81-69138445470c)', 'created_at': datetime.datetime(2024, 10, 6, 11, 37, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2396514638, 'issue_id': 2562683003, 'author': 'jukkis69', 'body': 'Ok I updated my versions to latest\r\nERPNext: v14.74.3 (version-14)\r\nFrappe Framework: v14.81.6 (version-14)\r\nAnd exchange rate error went away - so maybe fix along the line - or just needed resetting some properties', 'created_at': datetime.datetime(2024, 10, 7, 10, 18, 57, tzinfo=datetime.timezone.utc)}]","jukkis69 on (2024-10-06 11:37:33 UTC): I have the same issue with, cannot get exchange rate (was working couple of years without an issue)
ERPNext: v14.29.1 (version-14)
Frappe Framework: v14.40.1 (version-14)

![image](https://github.com/user-attachments/assets/94860478-6f5f-4071-bac0-389d1e7c388d)


Strangely error message says URL to be: https://frankfurter.dev/2024-10-06?base=USD&symbols=INR which does not work manually doing query.

However if you manually copy the example query ""https://api.frankfurter.app/2023-03-28?base=USD&symbols=INR"" you will get the reply {""amount"":1.0,""base"":""USD"",""date"":""2023-03-28"",""rates"":{""INR"":82.15}} --> so the Frankfurther app is working. My currencies are GBP --> USD, so they also work in manual query.

Wonder where the issue might be?

Also if I use exchangerate.host, it complains about ACCESS_KEY.
I have got one, but there seems to be no way to add the ACCESS_KEY to the request query parameters? At least do not seem to figure way to add this.

![image](https://github.com/user-attachments/assets/d2006b2a-268d-4865-9f81-69138445470c)

jukkis69 on (2024-10-07 10:18:57 UTC): Ok I updated my versions to latest
ERPNext: v14.74.3 (version-14)
Frappe Framework: v14.81.6 (version-14)
And exchange rate error went away - so maybe fix along the line - or just needed resetting some properties

"
2561284705,issue,open,,Batch DocType - Connection for Purchase Receipt broken.,"### Information about bug

The Batch DocType does list the Source Document Type and Source Document Name
![image](https://github.com/user-attachments/assets/69080480-419d-494f-9111-a55652089f5d)

But this isn't listed in the connections.
![image](https://github.com/user-attachments/assets/fced029c-d6b1-4d8c-979d-8a7182d95973)



### Module

stock

### Version

Frappe version - 15.42
ERPNext version - 15.37

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",pmjd-code,2024-10-02 11:10:38+00:00,[],2024-10-02 11:10:38+00:00,,https://github.com/frappe/erpnext/issues/43487,"[('bug', None)]",[],
2561251695,issue,open,,Purchase Receipt Item Quanities - Quality Inspections Do Not Work Logically with Quantity Types,"### Information about bug

A Quality Inspection is a binary option of accepted/rejected, so it should not be possible to put quantities in both the **Accepted Quantity** and **Rejected Quantity** fields in the same line of a Purchase Receipt Item when the item has a Quality Inspection.
![image](https://github.com/user-attachments/assets/2b504818-07d4-480e-a9b7-4fc2c200657a)


When this does happen, separate batch numbers are created for both the Accepted and Rejected quantities but the Quality Inspection is only linked to the Accepted Quantity batch number not the Rejected Quantity batch number, regardless of the Quality Inspection result of pass/fail. So the Accepted Quantity can be linked to a failed QI.

Would the solution be for items that have a Quality Inspection, the **Received Quantity** field should be allowed to be used for data entry (or a new QI Quantity field) and on saving the status of the Quality Inspection updates either the Accepted Quantity or Rejected Quantity field (which are read only) to match the result of the QI?

### Module

stock

### Version

Frappe version - 15.42
ERPNext version - 15.37

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",pmjd-code,2024-10-02 10:50:40+00:00,[],2024-10-08 15:18:17+00:00,,https://github.com/frappe/erpnext/issues/43486,"[('bug', None)]","[{'comment_id': 2400144911, 'issue_id': 2561251695, 'author': 'pmjd-code', 'body': ""The following script from NCP on the Frappe forum prevents having values entered in both accepted and rejected columns, if a value is entered in one the other is reset to zero. May be of use to others.\r\n\r\n```\r\nfrappe.ui.form.on('Purchase Receipt Item', {\r\n\tqty: function(frm, cdt, cdn) {\r\n\t\tvar d = locals[cdt][cdn];\r\n\t\td.rejected_qty = 0;\r\n\t\tfrm.refresh_field('items');\r\n\t},\r\n\trejected_qty: function(frm, cdt, cdn) {\r\n\t\tvar d = locals[cdt][cdn];\r\n\t\td.qty = 0;\r\n\t\tfrm.refresh_field('items');\r\n\t}\r\n});\r\n```"", 'created_at': datetime.datetime(2024, 10, 8, 15, 18, 16, tzinfo=datetime.timezone.utc)}]","pmjd-code (Issue Creator) on (2024-10-08 15:18:16 UTC): The following script from NCP on the Frappe forum prevents having values entered in both accepted and rejected columns, if a value is entered in one the other is reset to zero. May be of use to others.

```
frappe.ui.form.on('Purchase Receipt Item', {
	qty: function(frm, cdt, cdn) {
		var d = locals[cdt][cdn];
		d.rejected_qty = 0;
		frm.refresh_field('items');
	},
	rejected_qty: function(frm, cdt, cdn) {
		var d = locals[cdt][cdn];
		d.qty = 0;
		frm.refresh_field('items');
	}
});
```

"
2561058539,issue,open,,Consider hosting frankfurter on Frappe Cloud to avoid API break,"The API broke recently:
https://github.com/frappe/erpnext/pull/43476

It's very simple to self-host:
https://github.com/hakanensari/frankfurter#deployment",sagarvora,2024-10-02 09:22:04+00:00,[],2024-10-07 07:59:09+00:00,,https://github.com/frappe/erpnext/issues/43480,"[('proposal', '')]","[{'comment_id': 2394553715, 'issue_id': 2561058539, 'author': 'dj12djdjs', 'body': ""If  I recall correctly this is the 2nd time the API broke in the 3 or 4 years I've been working with ERPNext."", 'created_at': datetime.datetime(2024, 10, 4, 20, 49, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2395029582, 'issue_id': 2561058539, 'author': 'sagarvora', 'body': 'Frappe is testing it:\r\nfrankfurter.frappe.cloud', 'created_at': datetime.datetime(2024, 10, 5, 11, 45, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2396193613, 'issue_id': 2561058539, 'author': 'adityahase', 'body': 'Reference: https://github.com/frappe/press/blob/master/press/playbooks/roles/frankfurter/README.md', 'created_at': datetime.datetime(2024, 10, 7, 7, 59, 8, tzinfo=datetime.timezone.utc)}]","dj12djdjs on (2024-10-04 20:49:46 UTC): If  I recall correctly this is the 2nd time the API broke in the 3 or 4 years I've been working with ERPNext.

sagarvora (Issue Creator) on (2024-10-05 11:45:47 UTC): Frappe is testing it:
frankfurter.frappe.cloud

adityahase on (2024-10-07 07:59:08 UTC): Reference: https://github.com/frappe/press/blob/master/press/playbooks/roles/frankfurter/README.md

"
2559003085,issue,open,,Purchase Receipt is required for Services Item Is this not right? We require feature for not asking for purchase receipt if item is services item,"<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**Additional context**
Add any other context or screenshots about the feature request here.
",Sadariya0054,2024-10-01 11:54:16+00:00,[],2024-10-01 11:54:16+00:00,,https://github.com/frappe/erpnext/issues/43470,"[('feature-request', None)]",[],
2558227261,issue,closed,completed,Promotional Scheme is not updating Pricing Rule properly,"### Information about bug

If we create Promotional Scheme for a customer then Pricing rule is created automatically, but if we remove that customer then pricing rule is not removed.

To replicate this:

Create a Promotional Scheme for 2 to 3 customers and save, Pricing rule will be created.
Then remove one customer from Promotional Scheme the created pricing rule will be there.

![Oct-01-2024 10-58-54](https://github.com/user-attachments/assets/c17b53b6-3e93-4b07-84c6-b916c2b93592)
 

### Module

accounts

### Version

ERPNext: v15.37.0 (HEAD)
Frappe Framework: v15.42.0 (HEAD)
Frappe HR: v15.30.0 (HEAD)
India Compliance: v15.13.3 (HEAD)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",rknroot,2024-10-01 05:34:05+00:00,[],2024-10-31 00:10:37+00:00,2024-10-15 09:54:42+00:00,https://github.com/frappe/erpnext/issues/43456,"[('bug', None), ('released', None)]","[{'comment_id': 2415738407, 'issue_id': 2558227261, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.74.6 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.6)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 10, 16, 5, 3, 45, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-10-16 05:03:45 UTC): :tada: This issue has been resolved in version 14.74.6 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.6)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2556343190,issue,closed,completed,Warehouse wise stock balance not showing stock available in other company warehouses,"### Information about bug

### Information about bug

Warehouse wise stock balance report is supposed to show stock in all warehouses irrespective of companies 

but now its showing only for one company

if you see the screenshot of item master you can see the available stock in different companies. 
![image](https://github.com/frappe/erpnext/assets/112148467/e061a0cb-7ee4-4ebf-bcc5-bff4e455c944)

but in Warehouse report its showing stock for only one company. it was working fine earlier but now ita not. 
![image](https://github.com/frappe/erpnext/assets/112148467/090fc4cc-53f1-44c4-b39d-92fcc4ee002b)

Basically somehow the report is fetching and filtering company from session defaults and showing stock only for selected company

![image](https://github.com/frappe/erpnext/assets/112148467/ca931cff-f134-433c-a30a-3e155b32df26)



### Module

stock

### Version

V13 and V14


### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_

### Module

stock

### Version

V14 and V15

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",maveezmh,2024-09-30 11:19:23+00:00,[],2024-10-20 00:11:19+00:00,2024-10-01 05:46:14+00:00,https://github.com/frappe/erpnext/issues/43443,"[('bug', None), ('released', None)]","[{'comment_id': 2392706136, 'issue_id': 2556343190, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.74.3 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.3)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 10, 4, 3, 4, 40, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-10-04 03:04:40 UTC): :tada: This issue has been resolved in version 14.74.3 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.3)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2554603278,issue,closed,completed,Bulk transaction feature merge to version-15?,"@ruthra-kumar 

For this bulk transaction feature,

https://github.com/frappe/erpnext/pull/43058

Is this plan to merge in version-15?

Thank you",kittiu,2024-09-29 01:30:13+00:00,['ruthra-kumar'],2024-10-16 00:10:10+00:00,2024-09-30 04:29:04+00:00,https://github.com/frappe/erpnext/issues/43419,"[('feature-request', None)]","[{'comment_id': 2381967724, 'issue_id': 2554603278, 'author': 'ruthra-kumar', 'body': ""There wasn't any plan. But I don't see any reason not to, as the change is simple and non-breaking."", 'created_at': datetime.datetime(2024, 9, 30, 4, 10, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2381984414, 'issue_id': 2554603278, 'author': 'ruthra-kumar', 'body': 'Backported https://github.com/frappe/erpnext/pull/43434', 'created_at': datetime.datetime(2024, 9, 30, 4, 29, 4, tzinfo=datetime.timezone.utc)}]","ruthra-kumar (Assginee) on (2024-09-30 04:10:18 UTC): There wasn't any plan. But I don't see any reason not to, as the change is simple and non-breaking.

ruthra-kumar (Assginee) on (2024-09-30 04:29:04 UTC): Backported https://github.com/frappe/erpnext/pull/43434

"
2554154853,issue,open,,Update Vehicle or Transporter Option in Submitted Sales Invoice in India (GST Compliance) without EWayBill Invoices,"Is your feature request related to a problem? Please describe.
In India, for GST compliance, the vehicle or transporter details need to be added or updated for transportation documentation. Currently, ERPNext allows updating these details for submitted sales invoices with EWayBills, but there is no provision to update them for invoices that do not require an EWayBill. This creates operational challenges when transport or vehicle details change for such invoices, as users need to cancel and recreate the invoice to update this information, which is cumbersome and time-consuming.

Describe the solution you'd like
The ability to update the Vehicle or Transporter details in submitted Sales Invoices that do not require an EWayBill. This should be possible without the need to cancel or recreate the invoice, ensuring compliance with GST requirements and maintaining accurate records in ERPNext for all types of shipments.

Describe alternatives you've considered

Manually canceling and recreating the invoice to add or update vehicle details. However, this is inefficient, especially for larger operations.
Using custom scripts to bypass this limitation, which adds unnecessary complexity and requires ongoing maintenance.
Additional context
This feature will bring flexibility in managing transportation details for non-EWayBill invoices, particularly useful in industries where shipments occur frequently without requiring an EWayBill. It will enhance user experience and streamline the process, especially for companies dealing with various transporters and changing vehicle details post invoice submission.


Installed Apps

Active Users: v1.0.10 (HEAD)

Frappe Builder: v1.11.6 (HEAD)

Frappe CRM: v1.23.1 (HEAD)

Custom Development: v0.0.1 (HEAD)

Frappe Drive: v0.0.1 (HEAD)

ERPNext: v15.36.0 (HEAD)

Frappe Framework: v15.41.0 (HEAD)

Frappe HR: v15.29.0 (HEAD)

India Compliance: v15.13.2 (HEAD)

Frappe Insights: v2.2.6 (HEAD)

Payments: v0.0.1 (HEAD)

POS Awesome: v15.0.1 (HEAD)

Raven: v1.7.1 (HEAD)

Webshop: v0.0.1 (HEAD)",sagarrgarg,2024-09-28 10:32:45+00:00,[],2024-09-28 10:32:45+00:00,,https://github.com/frappe/erpnext/issues/43415,"[('feature-request', None)]",[],
2552994591,issue,open,,Subcontracting PO- Item rate is not picking correct,"### Information about bug

Hi Team,

In Subcontracting Receipt, item rate is showing wrong. It is not capturing Raw material rate + Subcontracting service cost.

This is observed where there are multiple subcontracting services.

You can create first subcontracting PO with RM rate Rs. 100 and service rate is 10/-

in Sucontracting PO rate it shows only Rs. 100 
which should be Rs 110 for the incoming item. In stock entry, it is working correct.

This is misguiding for subcontracting valuation process.

<img width=""1172"" alt=""image"" src=""https://github.com/user-attachments/assets/0abd84f7-6128-4880-acce-a9726a35561a"">

<img width=""1245"" alt=""image"" src=""https://github.com/user-attachments/assets/ebd50e60-8d8b-4acd-853d-b327cc067a53"">





### Module

manufacturing

### Version

Installed Apps
ERPNext: v15.35.2 (version-15)

Frappe Framework: v15.40.6 (version-15)

India Compliance: v15.13.2 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",satisharalkar,2024-09-27 13:46:54+00:00,[],2024-10-08 09:26:03+00:00,,https://github.com/frappe/erpnext/issues/43406,"[('bug', None)]","[{'comment_id': 2399331134, 'issue_id': 2552994591, 'author': 'frewper', 'body': 'can you confirm that the valuation rate is different on the stock sheet?', 'created_at': datetime.datetime(2024, 10, 8, 9, 26, 2, tzinfo=datetime.timezone.utc)}]","frewper on (2024-10-08 09:26:02 UTC): can you confirm that the valuation rate is different on the stock sheet?

"
2552405542,issue,closed,completed,Feature Request: Enable Child Table Fields in Quick Entry for Parent Doctype (Contact),"
Description: I would like to request an enhancement to the Quick Entry functionality in ERPNext, specifically for the Contact doctype, which currently does not display fields from its child tables (Contact Email and Contact Phone) in the Quick Entry form.

Current Behavior: After enabling the Quick Entry checkbox for the child tables and checking the ""Allow in Quick Entry"" option for their fields in the Customize Form, the child table fields still do not appear in the Quick Entry form. Only the parent doctype fields are displayed.

Desired Behavior: It would be beneficial if the fields from the child tables could be included in the Quick Entry form for the Contact doctype. This would streamline data entry and enhance user experience by allowing users to input contact information more efficiently.

Use Case: Many users manage contacts with multiple email addresses and phone numbers. Having the ability to enter this information directly in the Quick Entry form would save time and reduce the need for additional clicks to open the full form.

Proposed Solution: Consider implementing the option to include child table fields in the Quick Entry form alongside the parent fields, allowing users to add or edit contact details seamlessly.",falahteam,2024-09-27 09:04:26+00:00,[],2024-10-13 00:12:12+00:00,2024-09-27 09:12:33+00:00,https://github.com/frappe/erpnext/issues/43404,"[('feature-request', None)]","[{'comment_id': 2378821689, 'issue_id': 2552405542, 'author': 'Nihantra-Patel', 'body': 'Duplicate Issue: https://github.com/frappe/frappe/issues/27918', 'created_at': datetime.datetime(2024, 9, 27, 9, 12, 33, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-27 09:12:33 UTC): Duplicate Issue: https://github.com/frappe/frappe/issues/27918

"
2551752264,issue,open,,RMA - Return material authorisation ,"After manufacturing and product is shipped. During free warranty period and AMC period (If amc is taken)free replacement or service of parts required. 

As per product bom erpnext should allow to send free spares or service as per warranty period and amc. To replace free spares customer requires RMA - return material authorisation. RMA form tracks individual spares as per BOM. ERPNEXt should allow to generate RMA, replace new spare with serial number and update record, also track cost involved in free service and amc.

Refer https://store.webkul.com/Odoo-Return-Merchandise-Authorization.html


<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**Additional context**
Add any other context or screenshots about the feature request here.
",Gaurang1979,2024-09-27 00:21:08+00:00,[],2024-09-27 00:21:08+00:00,,https://github.com/frappe/erpnext/issues/43403,"[('feature-request', None)]",[],
2551477531,issue,open,,Aging stock calculation issue,"### Information about bug

Aging stock report is not getting correct data. Aging of stock supposed to calculate based on GRN,, but its calculating based on warehouse transfer date. Eg. We have one company , under that company we have 3 virtual warehouses, we may change the goods sometimes to different warehoused among this 3 virtual warehouse.  how the Aging stock, instead of taking base date as FRN date, its taking the warehouse transfer date.. which is wrong. (( Eg. if i have an item took GRN on 10-Jan-2024 and later made a warehouse transfer on 10th Aug, .. erp shoes aging of the items is just 1 month .. its wrong.. )) 


### Module

stock

### Version

ERPNext: v14.70.11 (HEAD)
Frappe Framework: v14.78.0 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",ErpNextIssues,2024-09-26 20:28:34+00:00,[],2024-10-08 09:31:51+00:00,,https://github.com/frappe/erpnext/issues/43401,"[('bug', None)]","[{'comment_id': 2399343978, 'issue_id': 2551477531, 'author': 'frewper', 'body': 'Since this is an old version it will help if you can confirm this on the current version, so that this can be quickly fixed. \r\n\r\nDo note that even if this is fixed in the coming days, you will have to update. Hence better to check.', 'created_at': datetime.datetime(2024, 10, 8, 9, 31, 50, tzinfo=datetime.timezone.utc)}]","frewper on (2024-10-08 09:31:50 UTC): Since this is an old version it will help if you can confirm this on the current version, so that this can be quickly fixed. 

Do note that even if this is fixed in the coming days, you will have to update. Hence better to check.

"
2551154519,issue,open,,"Add the ability to edit drop shipping details in ""Update Items"" dialog in sales order","**Is your feature request related to a problem? Please describe.**
Our sales team doesn't know if certain items are being drop shipped or shipped from our warehouse.  They also don't know what supplier will be used if an item is drop shipped.  Our fulfillment team decides if an item should be drop shipped or not and who the supplier is that it will be drop shipped from.  Many of our drop shipped products use regional suppliers because they are very expensive to ship.

**Describe the solution you'd like**
I would like to be able to edit ""Supplier delivers to Customer"" and ""Supplier"" values when ""Update Items"" is clicked on a sales order.

**Describe alternatives you've considered**
Making ""Supplier delivers to Customer"" and ""Supplier"" values editable on submit.  I tried to make this happen, but it wouldn't let me change those values in the customization of the ""Sales Order Item"" doctype.

It would be fine with me to just have a setup item to allow this behavior so not everyone has to use it.

Thanks!",prices,2024-09-26 17:24:45+00:00,[],2024-09-26 17:24:45+00:00,,https://github.com/frappe/erpnext/issues/43398,"[('feature-request', None)]",[],
2550043434,issue,open,,I can't use scale barcode in POS ,"### Information about bug

Hello there, 

I can't use scale generated barcode on the POS, is there a workaround? 
the weight barcode consists of 3 parts (the prefix from the scale - item code - and weight) where can I set this up on ERPnext ?? 

### Module

selling

### Version

ERPNext: v15.36.2 (HEAD)

Frappe Framework: v15.42.0 (HEAD)



### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",Mina-Geez,2024-09-26 09:29:54+00:00,[],2024-09-26 09:29:54+00:00,,https://github.com/frappe/erpnext/issues/43393,"[('bug', None)]",[],
2550033956,issue,open,,the closing entry for POS does not post closing amount difference to write-off amount ,"### Information about bug

the closing entry for POS does not post closing amount difference to write-off amount among the journal

### Module

selling

### Version

ERPNext: v15.36.2 (HEAD)
Frappe Framework: v15.42.0 (HEAD)



### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",Mina-Geez,2024-09-26 09:26:42+00:00,['diptanilsaha'],2024-12-23 06:45:53+00:00,,https://github.com/frappe/erpnext/issues/43392,"[('bug', None), ('POS', None)]","[{'comment_id': 2525555407, 'issue_id': 2550033956, 'author': 'nnnpooh', 'body': 'I encountered this behavior in \r\n\r\nERPNext: v15.45.2 (version-15)\r\nFrappe Framework: v15.49.1 (version-15)\r\n\r\nFrom a fresh install (local install in WSL Ubuntu 22.04), I\r\n1) Created one item.\r\n2) Used stock entry to import stock into the warehouse (THB500 Value).\r\n3) Used POS to sell one item for 10THB.\r\n4) Recorded the POS closing entry with the difference of -THB20.\r\n5) Inspected the general ledger. I did not see the THB20 amount in the transaction in the Write-Off account.  \r\n\r\n![2024-12-08_16-15-09](https://github.com/user-attachments/assets/b2bcbdd1-cc6d-40b3-af27-96c5529f51cb)', 'created_at': datetime.datetime(2024, 12, 8, 9, 23, 29, tzinfo=datetime.timezone.utc)}]","nnnpooh on (2024-12-08 09:23:29 UTC): I encountered this behavior in 

ERPNext: v15.45.2 (version-15)
Frappe Framework: v15.49.1 (version-15)

From a fresh install (local install in WSL Ubuntu 22.04), I
1) Created one item.
2) Used stock entry to import stock into the warehouse (THB500 Value).
3) Used POS to sell one item for 10THB.
4) Recorded the POS closing entry with the difference of -THB20.
5) Inspected the general ledger. I did not see the THB20 amount in the transaction in the Write-Off account.  

![2024-12-08_16-15-09](https://github.com/user-attachments/assets/b2bcbdd1-cc6d-40b3-af27-96c5529f51cb)

"
2548303042,issue,open,,Update Cost Center in Stock Entry and Update Accounting ledger like sales invoice,"
**Problem**
I'm always frustrated when we accidentally submit stock entries without updating cost center in stock entry detail table. Once Stock entry is submitted without cost center, there is a difference amount that shows in stock vs account ledger report and it is very difficult to cancel a stock entry because it gives an error that cost center is required for adjustment account.
![image](https://github.com/user-attachments/assets/cedaaa28-4522-44a7-bab3-93977e227edb)


**Solution**
I would like an option to update cost center in stock entry detail table even after submission and doing so could also update the accounting ledger of that stock entry like we have an option in sales or purchase invoice to update cost center or expense/income account in sales invoice items like Below:
![image](https://github.com/user-attachments/assets/2dd2c1bf-e755-44d3-b4fe-58f653781150)

",zahidmansoor,2024-09-25 15:25:11+00:00,[],2024-09-25 15:25:11+00:00,,https://github.com/frappe/erpnext/issues/43386,"[('feature-request', None)]",[],
2547663079,issue,closed,completed,"Purchase Order from Supplier Quotation does not auto-populate ""Supplier's quotation reference"" field","### Information about bug

Creating a Purchase Order from a Supplier Quotation does not auto-populate the ""Supplier's quotation reference"" in the New Purchase Order.

This should be a straightforward pull from the source document to the new one.

### Module

buying

### Version

Frappe 14.81.4
ERPNext 14.74.1

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",fishter,2024-09-25 10:57:58+00:00,[],2024-10-16 00:10:06+00:00,2024-10-01 07:30:35+00:00,https://github.com/frappe/erpnext/issues/43383,"[('bug', None)]","[{'comment_id': 2385004753, 'issue_id': 2547663079, 'author': 'Nihantra-Patel', 'body': 'Everything is working fine. No problems were encountered in the latest version 14 and version 15.\r\n\r\n\r\nhttps://github.com/user-attachments/assets/59445a8a-7b40-4350-a09b-88207f701a3a', 'created_at': datetime.datetime(2024, 10, 1, 7, 30, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2385606926, 'issue_id': 2547663079, 'author': 'fishter', 'body': 'I did not mean the ERPNext reference of the supplier quotation. I meant the supplier\'s reference - the one the supplier gives on their quotation. In the following screenshot it is ""350003185"", visible at the bottom right\r\n![image](https://github.com/user-attachments/assets/72629938-0391-4679-8bec-575f0ddf8284)\r\n\r\nThis reference does not get pulled into the Purchase Order when it is created from the Supplier Quotation. You can see here the Supplier quote reference is blank.\r\n![image](https://github.com/user-attachments/assets/84f804d6-09a6-4f91-a5a6-05d3228cfe48)', 'created_at': datetime.datetime(2024, 10, 1, 12, 8, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2385614708, 'issue_id': 2547663079, 'author': 'Nihantra-Patel', 'body': ""It's your custom field and custom requirement, you can customize in your custom app according to the scenario."", 'created_at': datetime.datetime(2024, 10, 1, 12, 12, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2385975932, 'issue_id': 2547663079, 'author': 'fishter', 'body': ""Ah. That's a bit embarassing! Sorry for wasting your time."", 'created_at': datetime.datetime(2024, 10, 1, 13, 46, 16, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-10-01 07:30:36 UTC): Everything is working fine. No problems were encountered in the latest version 14 and version 15.


https://github.com/user-attachments/assets/59445a8a-7b40-4350-a09b-88207f701a3a

fishter (Issue Creator) on (2024-10-01 12:08:58 UTC): I did not mean the ERPNext reference of the supplier quotation. I meant the supplier's reference - the one the supplier gives on their quotation. In the following screenshot it is ""350003185"", visible at the bottom right
![image](https://github.com/user-attachments/assets/72629938-0391-4679-8bec-575f0ddf8284)

This reference does not get pulled into the Purchase Order when it is created from the Supplier Quotation. You can see here the Supplier quote reference is blank.
![image](https://github.com/user-attachments/assets/84f804d6-09a6-4f91-a5a6-05d3228cfe48)

Nihantra-Patel on (2024-10-01 12:12:39 UTC): It's your custom field and custom requirement, you can customize in your custom app according to the scenario.

fishter (Issue Creator) on (2024-10-01 13:46:16 UTC): Ah. That's a bit embarassing! Sorry for wasting your time.

"
2547353482,issue,open,,Request to Apply Group Company Filter for HR Reports,"**Is your feature request related to a problem? Please describe.**
 Ticket: https://support.frappe.io/helpdesk/my-tickets/22453

**Describe the solution you'd like**
I would like to request the application of a filter across all HR reports based on the group company. This filter should encompass all companies under the group, ensuring that the reports reflect data for each of them collectively.


",saista2,2024-09-25 08:40:06+00:00,[],2024-10-24 06:41:14+00:00,,https://github.com/frappe/erpnext/issues/43381,"[('feature-request', None), ('good first issue', 'Good issue for beginners.')]","[{'comment_id': 2434425419, 'issue_id': 2547353482, 'author': 'krantheman', 'body': 'Refer https://github.com/frappe/hrms/pull/2177', 'created_at': datetime.datetime(2024, 10, 24, 6, 41, 14, tzinfo=datetime.timezone.utc)}]","krantheman on (2024-10-24 06:41:14 UTC): Refer https://github.com/frappe/hrms/pull/2177

"
2546934131,issue,open,,Feature Request: Display Full Hierarchical Organizational Chart Across Companies,"**Is your feature request related to a problem? Please describe.**
Reference Ticket: https://support.frappe.io/helpdesk/my-tickets/22448

**Describe the solution you'd like**
To ensure that the entire hierarchy is presented clearly, I kindly request the removal of the company filter. This would allow the organizational chart to show the full hierarchy across all related companies, without being limited by the current company boundaries.

I believe this feature would provide better visibility and improve organizational transparency.


",saista2,2024-09-25 05:03:01+00:00,[],2024-09-25 05:03:01+00:00,,https://github.com/frappe/erpnext/issues/43379,"[('feature-request', None)]",[],
2545365493,issue,closed,completed,Cannot Delete a Project Update,"### Information about bug

There is no ""Cancel"" action in the project update therefore can't delete it. 
![Screenshot 2024-09-24 at 9 03 50 PM](https://github.com/user-attachments/assets/de7ed990-261e-4067-8200-35a92c7d4512)

### Module

projects

### Version

ERPNext Version: V15

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

",kptdaaron,2024-09-24 13:08:59+00:00,[],2024-10-16 00:10:09+00:00,2024-10-01 07:41:03+00:00,https://github.com/frappe/erpnext/issues/43371,"[('bug', None)]","[{'comment_id': 2385024462, 'issue_id': 2545365493, 'author': 'Nihantra-Patel', 'body': 'You have to give the cancel rights to the user role. so please check the video.\r\n\r\n\r\nhttps://github.com/user-attachments/assets/d55f6f29-ba62-4333-9269-ba90c8c894a8', 'created_at': datetime.datetime(2024, 10, 1, 7, 41, 3, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-10-01 07:41:03 UTC): You have to give the cancel rights to the user role. so please check the video.


https://github.com/user-attachments/assets/d55f6f29-ba62-4333-9269-ba90c8c894a8

"
2545303201,issue,open,,why the system validate paid_amount = invoice_total  in sales invoice and POS invoice which make trouple when to try to return partly paid invoice. ,"### Information about bug

## Problem Overview

System checks when make a return for partly paid invoice If  **Total Invoice** = **Paid Amount**
 
### Scenario

## Example

| Item   | Rate | Quantity |
|--------|------|----------|
| Item 1 | 500  | 1        |

- **Total Invoice**: 500
- **Paid Amount**: 250

If i tried to make a return i got this message  

`""Paid amount + Write Off Amount can not be greater than Grand Total""
`
so to make a  return, I have to change rate from 500 to 250  for making  **Total Invoice** = **Paid Amount**

| Item   | Rate | Quantity |
|--------|------|----------|
| Item 1 | 250  | 1        |

- **Total Invoice** :  500
- **Paid Amount** : 250
Which does not make any sense and will be more difficult to manage with multiple items

### code 
```
def validate_pos(self):
if self.is_return:
	invoice_total = self.rounded_total or self.grand_total
	if flt(self.paid_amount) + flt(self.write_off_amount) - flt(invoice_total) > 1.0 / (
		10.0 ** (self.precision(""grand_total"") + 1.0)
	):
		frappe.throw(_(""Paid amount + Write Off Amount can not be greater than Grand Total""))

```
what the point of validate that paid_amount =  invoice_total
If anyone can help why this validation exist 

### Module

accounts, selling

### Version

Frappe 15 
ERPnext 15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
""Paid amount + Write Off Amount can not be greater than Grand Total""
```
",MhmedRjb,2024-09-24 12:43:57+00:00,['diptanilsaha'],2024-12-23 06:50:46+00:00,,https://github.com/frappe/erpnext/issues/43369,"[('bug', None), ('POS', None)]",[],
2544720406,issue,closed,completed,When Supplier is choose in purchase order ,"### Information about bug

      When the Supplier is selected in the purchase order an error is throwing. 
![image](https://github.com/user-attachments/assets/8759b7ce-334e-413d-b5ff-bae5137f753b)


### Module

buying

### Version

ERPNext: v15.36.1 (version-15)

Frappe Framework: v15.41.0 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""chat"": ""0.0.1"",
	""crm"": ""1.23.2"",
	""erpnext"": ""15.36.1"",
	""frappe"": ""15.41.0"",
	""hrms"": ""15.29.0"",
	""india_compliance"": ""15.13.2"",
	""lms"": ""2.5.0"",
	""payments"": ""0.0.1"",
	""suyog"": ""0.0.2"",
	""twilio_integration"": ""0.0.1""
}
```
### Route
```
Form/Purchase Order/new-purchase-order-vyjhtaeewv
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1775, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/frappe/frappe/desk/search.py"", line 47, in search_link
    results = search_widget(
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/frappe/frappe/desk/search.py"", line 93, in search_widget
    is_whitelisted(frappe.get_attr(query))
  File ""apps/frappe/frappe/__init__.py"", line 1765, in get_attr
    return getattr(get_module(modulename), methodname)
AttributeError: module 'erpnext.controllers.queries' has no attribute 'supplier_query'

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""txt"": """",
		""doctype"": ""Supplier"",
		""ignore_user_permissions"": 0,
		""reference_doctype"": ""Purchase Order"",
		""page_length"": 10,
		""query"": ""erpnext.controllers.queries.supplier_query""
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.search.search_link"",
	""request_id"": null
}
```
### Response Data
```
{
	""exception"": ""AttributeError: module 'erpnext.controllers.queries' has no attribute 'supplier_query'"",
	""exc_type"": ""AttributeError""
}
```
```
",IBSLPUNE,2024-09-24 08:29:07+00:00,[],2024-10-16 00:10:08+00:00,2024-10-01 09:23:49+00:00,https://github.com/frappe/erpnext/issues/43359,"[('bug', None)]","[{'comment_id': 2385266246, 'issue_id': 2544720406, 'author': 'Nihantra-Patel', 'body': 'Everything is working fine in locally and also on the frappe cloud. No problems were encountered in the latest version 15.\r\n\r\n\r\nhttps://github.com/user-attachments/assets/c4d9f906-c5ee-496a-8d94-da4486c2010c', 'created_at': datetime.datetime(2024, 10, 1, 9, 23, 49, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-10-01 09:23:49 UTC): Everything is working fine in locally and also on the frappe cloud. No problems were encountered in the latest version 15.


https://github.com/user-attachments/assets/c4d9f906-c5ee-496a-8d94-da4486c2010c

"
2544400533,issue,closed,completed,My Account secureedgsal.erpnext.com is too slow we cannot work. can you check please the service or the server. we have tried to open the account on 2 diffrent connections and mane PC's and problem is the same.,"### Information about bug

My Account secureedgsal.erpnext.com is too slow we cannot work. can you check please the service or the server. we have tried to open the account on 2 different connections and mane PC's and problem is the same.

### Module

accounts

### Version

Frappe Framework: v13.58.21 (HEAD)
ERPNext: v13.55.2 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",marioseif-ceo,2024-09-24 05:49:09+00:00,[],2024-10-16 00:10:07+00:00,2024-10-01 09:26:12+00:00,https://github.com/frappe/erpnext/issues/43354,"[('bug', None)]","[{'comment_id': 2385271333, 'issue_id': 2544400533, 'author': 'Nihantra-Patel', 'body': 'If site hosting on frappe cloud then raise the support ticket on the [frappe cloud](https://support.frappe.io).', 'created_at': datetime.datetime(2024, 10, 1, 9, 26, 12, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-10-01 09:26:12 UTC): If site hosting on frappe cloud then raise the support ticket on the [frappe cloud](https://support.frappe.io).

"
2544310895,issue,open,,Monthly and Quarterly Filters in Financial Ratio Report,"### Information about bug

V15 have introduced financial ratio reports. which is one of the most awaited feature. but its only available yearly basis. most of the companies in UAE and around check financial ratio reports monthly and Quarterly basis.

it will be really useful if the ratio reports can be filtered by months or Quarters just like balance sheet and profit and loss statements. 

### Module

accounts

### Version

V15

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",maveezmh,2024-09-24 04:54:41+00:00,[],2024-10-14 07:22:24+00:00,,https://github.com/frappe/erpnext/issues/43352,"[('feature-request', None)]",[],
2541919560,issue,open,,Feature Request: Add QR Code Reader to Barcode Functionality in ERPNext,"Is your feature request related to a problem? Please describe.
Currently, it is impossible to read a QR code using the Barcode feature. This limitation was confirmed by the support team. This is frustrating because QR codes are widely used in modern business processes, and their integration into ERPNext would enhance workflow efficiency.

Describe the solution you'd like
I would like to request the addition of a QR code reader feature in ERPNext's Barcode functionality. This would allow users to scan and process QR codes directly within ERPNext.

Describe alternatives you've considered
As an alternative, I've considered using external applications to scan QR codes, but it would be much more efficient to have this feature integrated directly into ERPNext.

Additional context
Adding a QR code reader would significantly enhance the usability of the Barcode feature and help businesses streamline their operations, especially in inventory management and logistics.",SergioMiGuPr,2024-09-23 08:24:16+00:00,[],2024-09-23 08:24:16+00:00,,https://github.com/frappe/erpnext/issues/43330,"[('feature-request', None)]",[],
2541906370,issue,open,,Material Request (Transfer) does not validate duplicacy based on Sales Order for Bundle item.,"### Information about bug

When a user tries to create multiple (duplicate) material requests against a single Sales Order for a bundle item, the system allows the user to do so.
Ideally, once a MR is created, the system should validate and stop/warn the user of the duplicacy.

### Module

stock

### Version

ERPNext: v15.36.1
Frappe Framework: v15.41.0

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",hpotabatti,2024-09-23 08:18:04+00:00,[],2024-09-23 08:18:04+00:00,,https://github.com/frappe/erpnext/issues/43329,"[('bug', None)]",[],
2541403506,issue,open,,Exchange revaluation difference in showing up in AR,"### Information about bug

When we pass Exchange Rate Re-Valuation Entry for a Customer, the entire receivable amount changes as per the revised exchange rate. We do not have invoice-wise reference in it.

And so, at the time of passing payment entry, the system still takes the older exchange rate at which the invoice was generated and also an Exchange gain or loss is passed.

This leads to two issues.

1) Even after receiving full payment in USD from the customer, there is an outstanding in INR. This outstanding corresponds to the difference caused by the exchange revaluation. The user will not be able to reconcile this.

2) The exchange gain or loss is booked twice. One during the revaluation and another during the payment entry as the payment entry reconciles the invoice with the invoice's exchange rate and books the remaining in exchange gain or loss.

### Module

accounts

### Version

ERPNext version - Version 15

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",Vigneshsekar,2024-09-23 01:43:02+00:00,['Vigneshsekar'],2025-01-10 14:51:21+00:00,,https://github.com/frappe/erpnext/issues/43327,"[('bug', None)]","[{'comment_id': 2497359679, 'issue_id': 2541403506, 'author': 'finbyz', 'body': 'Dear @ruthra-kumar,\r\n\r\nThere is no update on this issue even after 2 months, I can think through below solutions.\r\n\r\nOption 1: Easy solution for now can be provide functionality in Exchang rate revaluation entry to pass reversal entry, and both should carry Exchange rate revaluation entry reference. This is exactly how we want them to use it as of now, but reversal of revaluation JV is actually not mentioned anywhere as per regulation.\r\n\r\nOption 2: Second more permanent solution will be to check at payment entry time if there is any exchange rate revaluation entry against particular invoice, it should affect INR value of that invoice in the payment entry to pass difference only as exchange gain and loss. This is more permanent solution but it need further brainstorming on:\r\n    - What will be the effect of past dated transactions of revaluation.\r\n    - How to handle this in payment reconciliation.\r\n    \r\nIf you agree on any we can collaborate to complete this faster.', 'created_at': datetime.datetime(2024, 11, 25, 9, 13, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582332124, 'issue_id': 2541403506, 'author': 'Vigneshsekar', 'body': 'I will assign it to myself. \r\n\r\nWill workout both of your options and get back @finbyz .', 'created_at': datetime.datetime(2025, 1, 10, 10, 35, 53, tzinfo=datetime.timezone.utc)}]","finbyz on (2024-11-25 09:13:52 UTC): Dear @ruthra-kumar,

There is no update on this issue even after 2 months, I can think through below solutions.

Option 1: Easy solution for now can be provide functionality in Exchang rate revaluation entry to pass reversal entry, and both should carry Exchange rate revaluation entry reference. This is exactly how we want them to use it as of now, but reversal of revaluation JV is actually not mentioned anywhere as per regulation.

Option 2: Second more permanent solution will be to check at payment entry time if there is any exchange rate revaluation entry against particular invoice, it should affect INR value of that invoice in the payment entry to pass difference only as exchange gain and loss. This is more permanent solution but it need further brainstorming on:
    - What will be the effect of past dated transactions of revaluation.
    - How to handle this in payment reconciliation.
    
If you agree on any we can collaborate to complete this faster.

Vigneshsekar (Issue Creator) on (2025-01-10 10:35:53 UTC): I will assign it to myself. 

Will workout both of your options and get back @finbyz .

"
2541383749,issue,open,,Cancelled payment entry shows up in AP/AR,"### Information about bug

Steps to reproduce:
- Create a payment entry and add sales invoices and credit notes in references.
- Submit the payment entry.
- Unreconcile the credit note referenced in the payment entry using `Unreconcile Payment`
- With that, the `unallocated amount` in the payment entry is not appropriately updated.
- Now, cancel the payment entry.
- In the payment ledger entry, the amount corresponding to the credit note is not delinked
- So, it shows up in the AR.
- The same applies to the purchase cycle and AP.

[set_unallocated_amount](https://github.com/frappe/erpnext/blob/75cf3e245ffc96ba3ac3ce58571a4675424bad11/erpnext/accounts/doctype/payment_entry/payment_entry.py#L1055) doesn't handle this case and checks for this specifically and skips it.

Internal ticket reference: 19990

### Module

accounts

### Version

ERPNext Version - From V14 to develop

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",Vigneshsekar,2024-09-23 01:17:17+00:00,['ruthra-kumar'],2024-09-23 05:03:10+00:00,,https://github.com/frappe/erpnext/issues/43326,"[('bug', None)]",[],
2540634172,issue,closed,completed,"""Save"" Button (DRAFT) Not Working for Sales Orders, Invoices, and Other Documents in ERPNext","### Information about bug

The ""Save"" button (in Draft mode) for several key documents, including Sales Orders and Invoices, is not functioning as expected. When attempting to save a document as a draft, the system fails to save the document. Currently, the document is only saved when the user proceeds to submit it, preventing users from saving drafts for later review or updates.

Tested in FrappeCloud and Docker Compose installation.

### Module

accounts, buying, selling

### Version

ERPNext: v15.36.1 (HEAD)

Frappe Framework: v15.41.0 (HEAD)

Frappe HR: v15.29.0 (HEAD)

Payments: v0.0.1 (HEAD)

Print Designer: v1.4.2 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",edardev,2024-09-22 04:28:23+00:00,[],2024-10-10 00:10:06+00:00,2024-09-23 06:34:29+00:00,https://github.com/frappe/erpnext/issues/43323,"[('bug', None)]","[{'comment_id': 2367334980, 'issue_id': 2540634172, 'author': 'Nihantra-Patel', 'body': ""We tested locally and also in the frappe cloud side, but we haven't found the issue.\r\n\r\n\r\nhttps://github.com/user-attachments/assets/605ace18-8fc3-4e79-bb1b-c0ca9821ee28\r\n\r\n\r\n\r\n\r\nIf your site is hosted on frappe cloud and if support is available in your plan, raise a [support ticket](https://support.frappe.io)."", 'created_at': datetime.datetime(2024, 9, 23, 6, 34, 29, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-23 06:34:29 UTC): We tested locally and also in the frappe cloud side, but we haven't found the issue.


https://github.com/user-attachments/assets/605ace18-8fc3-4e79-bb1b-c0ca9821ee28




If your site is hosted on frappe cloud and if support is available in your plan, raise a [support ticket](https://support.frappe.io).

"
2540096518,issue,open,,Add a status based on the Payment of the Invoices in Sales Order,"<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
I'm having trouble tracking payment status based on payments made using sales orders. To do this, I need to open all related documents, including sales invoices and linked payment entries.

**Describe the solution you'd like**
Need a progress bar status or status based on the Payment of the Invoices in sales order
",KBP-Civil,2024-09-21 09:12:38+00:00,[],2024-09-21 09:12:38+00:00,,https://github.com/frappe/erpnext/issues/43318,"[('feature-request', None)]",[],
2538009994,issue,open,,Unable to select Expired item in Batch bundle doctype to do material issue or make purchase receipt,"### Information about bug

 i Have a bacth number CC240907001 which is expired i went to material issue where i dont see option to select expired batch

![image](https://github.com/user-attachments/assets/649fa4cb-689e-45db-8a1c-8eaf926db479)

<img width=""1234"" alt=""Screenshot 2024-09-20 at 10 37 07 AM"" src=""https://github.com/user-attachments/assets/db8a0076-3881-4e6e-98bb-2299e76789df"">
<img width=""1338"" alt=""Screenshot 2024-09-20 at 10 38 49 AM"" src=""https://github.com/user-attachments/assets/e2927363-ed85-425f-b3e1-fc99c28d7cb5"">

in above screenshot neither of the batch selector or old batch field is allowing me to select expired batch so that i can return the expired products. 

also there is no provision to handle expired products. 





### Module

stock, buying, selling

### Version

V15 

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",maveezmh,2024-09-20 06:41:50+00:00,[],2024-09-20 06:41:50+00:00,,https://github.com/frappe/erpnext/issues/43309,"[('bug', None)]",[],
2537835031,issue,open,,Serial Number Status and Batch Source Document Not Reverting Correctly After Cancelling Internal Transfer Delivery Note,"### Information about bug

### Issue Title: Serial Number Status and Batch Source Document Not Reverting Correctly After Cancelling Internal Transfer Delivery Note

#### Steps to Reproduce:
1. Create an internal transfer delivery note with both a source warehouse and target warehouse.
2. Add an item in the delivery note that has both a batch number and a serial number.
3. Submit the delivery note.
4. Cancel the delivery note after submission.

#### Expected Behavior:
- After cancelling the delivery note:
  1. The batch source document should revert to its original state (e.g., Purchase Receipt or Stock Reconciliation) instead of changing to the cancelled delivery note.
  2. The serial number’s status should revert to **Active**, and the warehouse should revert to the original **source warehouse** (before the delivery note creation).

#### Actual Behavior:
- After cancelling the delivery note:
  1. The source document of the batch gets incorrectly updated to the cancelled delivery note instead of reverting to its original document (Purchase Receipt/Stock Reconciliation).
  2. The serial number remains **Inactive/Delivered**, and the warehouse becomes **None**. The serial number is not reverting to its previous state (Active in the source warehouse) as expected.

#### Impact:
This issue causes incorrect tracking of inventory, leading to confusion in batch and serial number management, especially during internal transfers.

### Module

stock

### Version

erpnext 15.35.2 version-15 (28f1f93)
frappe 15.40.5 version-15 (4cfdc8a)
india_compliance 15.12.1 version-15 (7e1ed2d)
payments 0.0.1 develop (f84edf9)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",bhickta,2024-09-20 04:26:36+00:00,[],2024-10-15 03:36:25+00:00,,https://github.com/frappe/erpnext/issues/43306,"[('bug', None)]","[{'comment_id': 2367178511, 'issue_id': 2537835031, 'author': 'bhickta', 'body': '@rohitwaghchaure Kindly look into it, because of the above issue, we are not able to move the inventory for such internal transfers. Let me know if anything is required from our side', 'created_at': datetime.datetime(2024, 9, 23, 3, 41, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2382032059, 'issue_id': 2537835031, 'author': 'bhickta', 'body': 'Please some one look into this, this is creating serious issues with our inventory. Please let me know what I can do from my side.', 'created_at': datetime.datetime(2024, 9, 30, 4, 48, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2412827696, 'issue_id': 2537835031, 'author': 'bhickta', 'body': 'Please Help with this, this is creating issues with our stock. @rohitwaghchaure', 'created_at': datetime.datetime(2024, 10, 15, 3, 36, 24, tzinfo=datetime.timezone.utc)}]","bhickta (Issue Creator) on (2024-09-23 03:41:18 UTC): @rohitwaghchaure Kindly look into it, because of the above issue, we are not able to move the inventory for such internal transfers. Let me know if anything is required from our side

bhickta (Issue Creator) on (2024-09-30 04:48:19 UTC): Please some one look into this, this is creating serious issues with our inventory. Please let me know what I can do from my side.

bhickta (Issue Creator) on (2024-10-15 03:36:24 UTC): Please Help with this, this is creating issues with our stock. @rohitwaghchaure

"
2537546191,issue,closed,completed,"Issues with Print Format ""Sales Order PD v2” and custom Print format ERPNext Version vv15.36.1 and Frappe v15.41.0","### Information about bug

Hi everyone,

I’m encountering several issues related to printing invoices on Frappe/ERPNext Version 15. Specifically, I’m having trouble with the following:

- Printing invoices and generating PDFs
- Setting up Print Formats
- The new Print Designer app

When using the default print format for Sales Orders (“Sales Order PD v2”), it’s throwing errors and failing to generate a proper output. However, when I remove this format, I’m able to view and print the PDF, but the resulting format is messy and unsuitable for my prospective clients.

![image](https://github.com/user-attachments/assets/94ce6ca7-7aa7-4443-8a80-125cfd8bd9d5)
![image](https://github.com/user-attachments/assets/c3ad21c8-e5bb-4c85-b58c-e482edbee7fe)
![image](https://github.com/user-attachments/assets/653d492b-bb4b-4cfb-8cca-a508b408af4b)
![image](https://github.com/user-attachments/assets/2475eba8-ee92-4830-932e-ccbdc6c741fe)




### Module

buying, selling, other

### Version

**Installed Apps**

- Frappe CRM: v2.0.0-dev
- Ecommerce Integrations: v1.17.0
- ERPNext: v15.36.1
- Frappe Framework: v15.41.0
- Frappe HR: v15.29.0
- Frappe Insights: v3.0.0
- Payments: v0.0.1
- Print Designer: v1.2.0

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback with variables (most recent call last):
  File ""apps/frappe/frappe/core/doctype/file/utils.py"", line 368, in attach_files_to_document
    file.insert(ignore_permissions=True)
      doc = <PDPrintFormat: Sales Invoice PD Format v2>
      event = 'on_update'
      attach_fields = [<Attach ImageDocField: print_designer_preview_img parent=Print Format>]
      df = <Attach ImageDocField: print_designer_preview_img parent=Print Format>
      value = '/private/files/print_designer-sales_invoice_pd_format_v2-preview.jpg'
      unattached_file = None
      file = <File: unsaved>
  File ""apps/frappe/frappe/model/document.py"", line 285, in insert
    self.run_method(""before_insert"")
      self = <File: unsaved>
      ignore_permissions = True
      ignore_links = None
      ignore_if_duplicate = False
      ignore_mandatory = None
      set_name = None
      set_child_names = True
  File ""apps/frappe/frappe/model/document.py"", line 962, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
      self = <File: unsaved>
      method = 'before_insert'
      args = ()
      kwargs = {}
      fn = <function Document.run_method.<locals>.fn at 0x7fc25c3c5940>
  File ""apps/frappe/frappe/model/document.py"", line 1322, in composer
    return composed(self, method, *args, **kwargs)
      self = <File: unsaved>
      args = ()
      kwargs = {}
      hooks = []
      method = 'before_insert'
      doc_events = {'*': {'on_update': ['frappe.desk.notifications.clear_doctype_notifications', 'frappe.workflow.doctype.workflow_action.workflow_action.process_workflow_actions', 'frappe.core.doctype.file.utils.attach_files_to_document', 'frappe.automation.doctype.assignment_rule.assignment_rule.apply', 'frappe.automation.doctype.assignment_rule.assignment_rule.update_due_date', 'frappe.core.doctype.user_type.user_type.apply_permissions_for_non_standard_user_type'], 'after_rename': ['frappe.desk.notifications.clear_doctype_notifications'], 'on_cancel': ['frappe.desk.notifications.clear_doctype_notifications', 'frappe.workflow.doctype.workflow_action.workflow_action.process_workflow_actions', 'frappe.automation.doctype.assignment_rule.assignment_rule.apply'], 'on_trash': ['frappe.desk.notifications.clear_doctype_notifications', 'frappe.workflow.doctype.workflow_action.workflow_action.process_workflow_actions'], 'on_update_after_submit': ['frappe.workflow.doctype.workflow_action.workflow_action.process_w...
      composed = <function Document.hook.<locals>.compose.<locals>.runner at 0x7fc25c269c60>
      compose = <function Document.hook.<locals>.compose at 0x7fc25c3c6020>
      f = <function Document.run_method.<locals>.fn at 0x7fc25c3c5940>
  File ""apps/frappe/frappe/model/document.py"", line 1304, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
      self = <File: unsaved>
      method = 'before_insert'
      args = ()
      kwargs = {}
      add_to_return_value = <function Document.hook.<locals>.add_to_return_value at 0x7fc25c3c5f80>
      fn = <function Document.run_method.<locals>.fn at 0x7fc25c3c5940>
      hooks = ()
  File ""apps/frappe/frappe/model/document.py"", line 959, in fn
    return method_object(*args, **kwargs)
      self = <File: unsaved>
      args = ()
      kwargs = {}
      method_object = <bound method File.before_insert of <File: unsaved>>
      method = 'before_insert'
  File ""apps/frappe/frappe/core/doctype/file/file.py"", line 104, in before_insert
    self.save_file(content=self.get_content())
      self = <File: unsaved>
  File ""apps/frappe/frappe/core/doctype/file/file.py"", line 539, in get_content
    with open(file_path, mode=""rb"") as f:
      self = <File: unsaved>
      file_path = './frontend/private/files/print_designer-sales_invoice_pd_format_v2-preview.jpg'
builtins.FileNotFoundError: [Errno 2] No such file or directory: './frontend/private/files/print_designer-sales_invoice_pd_format_v2-preview.jpg'
```
",edardev,2024-09-19 23:58:58+00:00,[],2024-10-10 00:10:05+00:00,2024-09-23 06:35:50+00:00,https://github.com/frappe/erpnext/issues/43304,"[('bug', None)]","[{'comment_id': 2367336669, 'issue_id': 2537546191, 'author': 'Nihantra-Patel', 'body': 'Duplicate Issue: https://github.com/frappe/print_designer/issues/359', 'created_at': datetime.datetime(2024, 9, 23, 6, 35, 50, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-23 06:35:50 UTC): Duplicate Issue: https://github.com/frappe/print_designer/issues/359

"
2536795735,issue,closed,completed,"Print Language not editable on Invoices, Quotation, ...","### Information about bug

The field language of an Invoice (and other documents) can't be changed after initial creation.
Note: The field language is automatically populated on creation of the document from the customer-settings (that's good).

I would expect to be able to change the language of the document after the creation, because:
- either the customer requested to have the document in another language this time.
- or the language-settings in the customer was wrong while creating the document and got corrected afterwards.

Attempts to customize the form failed, as the form customization tool prohibits changes to the read-only flag.

### Module

accounts, selling

### Version

Frappe version: v15.41.0
ERPNext version: v15.35.1

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",BinaryCraX,2024-09-19 16:13:21+00:00,[],2024-10-10 00:10:04+00:00,2024-09-23 06:57:20+00:00,https://github.com/frappe/erpnext/issues/43302,"[('bug', None)]","[{'comment_id': 2367366830, 'issue_id': 2536795735, 'author': 'Nihantra-Patel', 'body': 'You can easily achieve this from the Property Setter, so please check the video.\r\n\r\n\r\nhttps://github.com/user-attachments/assets/085ba98d-965f-463a-8bde-03159f46e208', 'created_at': datetime.datetime(2024, 9, 23, 6, 57, 20, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-23 06:57:20 UTC): You can easily achieve this from the Property Setter, so please check the video.


https://github.com/user-attachments/assets/085ba98d-965f-463a-8bde-03159f46e208

"
2536025285,issue,closed,completed,"Request for ""Assign To"" User Field in Asset Maintenance Log","Hi,

When creating an Asset Maintenance, there is an option to assign it to a user. However, the Asset Maintenance Log generated from it doesn’t have an ""Assign To"" (User Field) option. The problem is that we can’t set up an automatic notification to the assigned person from the Asset Maintenance Log because the email field or User field is missing

We request adding a user email field in the Asset Maintenance Log for notifications. This feature is essential so users can set automatic notifications for assigned users. Please consider implementing it.

<img width=""1277"" alt=""image"" src=""https://github.com/user-attachments/assets/683db21a-1b40-4928-bfc7-d4b7720d7f45"">
<img width=""1219"" alt=""image"" src=""https://github.com/user-attachments/assets/325eb9b3-0b00-420c-93a9-c4b2acaf8f86"">

Reference Ticket: https://support.frappe.io/helpdesk/my-tickets/22346


",reeta-greycube,2024-09-19 11:09:34+00:00,['khushi8112'],2024-11-05 00:10:16+00:00,2024-10-21 19:43:15+00:00,https://github.com/frappe/erpnext/issues/43298,"[('feature-request', None)]",[],
2535901157,issue,open,,Sidebar doesn't list out Attachments,"### Information about bug

I can’t seem to see what files are linked. Is this a bug? The image below has an attachment linked to it but is not showing. When I click on the “Attachments” link, it shows me that there is a file linked to it. Only when I click on the attachment link, it shows in the File List.Is there a way to show it so users can see the files? (Phoot shows a page that has an attachment already linked but it is not showing)
![image](https://github.com/user-attachments/assets/1960867f-6429-4c7b-a74a-8e996a2d8d4d)
<img width=""1406"" alt=""Screenshot 2024-09-19 at 6 13 33 PM"" src=""https://github.com/user-attachments/assets/dd8d67ae-de6a-4ce6-b097-ab4840076c20"">



### Module

other

### Version

Frappe Version: 15.41.0
ERPNext Version : 15.36.1

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",nathanso,2024-09-19 10:14:34+00:00,[],2024-09-19 10:14:43+00:00,,https://github.com/frappe/erpnext/issues/43297,"[('bug', None)]",[],
2534923644,issue,closed,completed,Payments app - UnboundLocalError: local variable 'grand_total' referenced before assignment,"### Information about bug


<img width=""1148"" alt=""image"" src=""https://github.com/user-attachments/assets/1cd976a8-ba69-40d5-ad2c-6d90a1813cc5"">

Clicked on ""Pay $1000.00"" and get the following message

error UnboundLocalError: local variable 'grand_total' referenced before assignment


### Module

accounts

### Version

Version - Frappe Cloud (latest versions for each under the ""version-14"" branch)
ERPNext: v14.74.1 (HEAD)
Frappe Framework: v14.81.4 (HEAD)
Payments: v0.0.1 (HEAD) 

<img width=""565"" alt=""image"" src=""https://github.com/user-attachments/assets/bc89423e-4a57-4cfe-864c-1a6fd6057495"">


### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 97, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 48, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 86, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1619, in call
    return fn(*args, **newargs)
  File ""apps/erpnext/erpnext/accounts/doctype/payment_request/payment_request.py"", line 410, in make_payment_request
    grand_total = get_amount(ref_doc, gateway_account.get(""payment_account""))
  File ""apps/erpnext/erpnext/accounts/doctype/payment_request/payment_request.py"", line 522, in get_amount
    if grand_total > 0:
UnboundLocalError: local variable 'grand_total' referenced before assignment
```
",eleben,2024-09-18 23:06:05+00:00,[],2024-11-07 00:10:11+00:00,2024-10-22 13:39:06+00:00,https://github.com/frappe/erpnext/issues/43286,"[('bug', None)]","[{'comment_id': 2360851636, 'issue_id': 2534923644, 'author': 'AlaaL', 'body': 'i have the same issue', 'created_at': datetime.datetime(2024, 9, 19, 12, 26, 45, tzinfo=datetime.timezone.utc)}]","AlaaL on (2024-09-19 12:26:45 UTC): i have the same issue

"
2533931079,issue,closed,completed,Incorrect advance entries are get pulled in Purchase and Sales Invoice. Need to check the exact party account when pulling the advances.,"### Information about bug

**Incorrect advance entries are get pulled in Purchase and Sales Invoice. Need to check the exact party account when pulling the advances.**


https://github.com/user-attachments/assets/b4fbc5a0-9c9a-424a-ad6f-c900bf93d102



**Steps to Reproduce:**

Let's consider a customer with the default receivable account (party account) as ""Debtors"".

1. Create an advance payment entry for the customer using the default receivable account.
2. Create a sales invoice for the customer with ""debit to"" as different account like ""Debtors 1"".
3. In advance tab, select the ""Allocate Advances Automatically (FIFO)"" option, it will fetch the payment and journal entries for both party account and the debit to account from current sales invoice.
4. Submit the Sales Invoice, it will show as paid. but if you reload, it will show unpaid.
5. In payment entry, it will allocated to that invoice. But in invoice, the paid amount was not reduced in outstanding amount.
6. In case of journal entry, it will not allow to submit the invoice.

This is same for Supplier and Purchase Invoice

**Solution**
When fetching the advance entries in sales invoice, check only the current invoice's account (don't include default party account)


**Solution Reference:**

1. In Payment Reconciliation page, it filters the vouchers and payments by checking single receivable account
2. In Payment Entry ""Get Outstanding Invoices"" option, it filters the voucher by single party account from the payment entry

### Module

accounts, buying, selling

### Version

Installed Apps
ERPNext: v15.36.0 (version-15)

Frappe Framework: v15.41.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",Ponnusamy1-V,2024-09-18 14:37:24+00:00,[],2025-01-30 07:29:11+00:00,2025-01-30 07:29:10+00:00,https://github.com/frappe/erpnext/issues/43275,"[('bug', None)]","[{'comment_id': 2623738697, 'issue_id': 2533931079, 'author': 'ljain112', 'body': 'We have fixed this issue: https://github.com/frappe/erpnext/pull/44545\nKindly update the app to resolve the issue.', 'created_at': datetime.datetime(2025, 1, 30, 7, 28, 21, tzinfo=datetime.timezone.utc)}]","ljain112 on (2025-01-30 07:28:21 UTC): We have fixed this issue: https://github.com/frappe/erpnext/pull/44545
Kindly update the app to resolve the issue.

"
2533640380,issue,closed,completed,Payment Reconciliation Issue for Advance Payment Against Sales Order,"### Information about bug

**Title:** Payment Reconciliation Issue for Advance Payment Against Sales Order

**Description:**

There is a bug in the payment reconciliation process when handling advance payments received against a sales order.

**Steps to Reproduce:**

1. Create a sales order and receive an advance payment for it.
2. Post the payment entry against the sales order.
3. Generate a sales invoice for the sales order.
4. Proceed to reconcile the payment against the sales invoice.

Notice that the payment entry reconciles successfully, but it still appears on the invoice side of the payment reconciliation screen.

**Expected Behavior:**

The payment entry should be removed from the invoice side of the reconciliation screen once it has been successfully reconciled.

**Actual Behavior:**

The payment entry remains visible on the invoice side, despite being reconciled.

Below is the example for reference.
![AdvanceagainstSalesOrderPmtReconciliationissue-ezgif com-resize (1)](https://github.com/user-attachments/assets/2a507aec-d0fd-44d8-8cee-fd297f5dc636)


### Module

accounts

### Version

ERPNext: v15.35.1 (version-15)

Frappe Framework: v15.40.6 (version-15)

India Compliance: v15.13.2 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",parasonit,2024-09-18 12:42:41+00:00,['ruthra-kumar'],2024-10-28 00:10:58+00:00,2024-10-13 04:59:02+00:00,https://github.com/frappe/erpnext/issues/43272,"[('bug', None)]","[{'comment_id': 2408824317, 'issue_id': 2533640380, 'author': 'ruthra-kumar', 'body': 'Fixed in https://github.com/frappe/erpnext/pull/43627', 'created_at': datetime.datetime(2024, 10, 13, 4, 59, 2, tzinfo=datetime.timezone.utc)}]","ruthra-kumar (Assginee) on (2024-10-13 04:59:02 UTC): Fixed in https://github.com/frappe/erpnext/pull/43627

"
2532877156,issue,open,,Set standard sender email per doctype,"We work in the different doctypes and branches of the company with different system email accounts: purchase orders - procurement@, customer support support@, etc.

If we write an email we have to choose every time the system email account and sometimes we forget and the answers will be written to the personal accounts.

It would be super helpful to add a standard sender address to the doc type settings like the default email template.


",bastelfeak,2024-09-18 06:50:22+00:00,[],2024-09-18 06:50:22+00:00,,https://github.com/frappe/erpnext/issues/43269,"[('feature-request', None)]",[],
2532052631,issue,closed,completed,Company creation failed with error : Could not find Warehouse Type: Transit,"### Information about bug

When creating a company in a fresh installation this unexpected error occurs : Could not find Warehouse Type: Transit

### Module

stock

### Version

15.35.2

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
Message : Could not find Warehouse Type: Transit

This issue is mentioned here:
https://github.com/frappe/erpnext/issues/42309
https://discuss.frappe.io/t/new-company-creation/99670/5

The workaround suggested seems a bit unnecessary, why not create the default Warehouse Type Transit ?
I think it is a bug because in the company creation screen I do not see the need for filling in a warehouse / type. The suggestion of following setup is more or less what I did.

I suggest if this default being there is not viable, an option to create it at company creation and making it visible there somehow, or just have it as default setup.

Thank you for creating this great product, I am up and running using the workaround, just feel this product would be even better when this is addressed :).
```
",VGerris,2024-09-17 20:13:20+00:00,[],2025-02-01 00:11:16+00:00,2025-01-17 11:43:25+00:00,https://github.com/frappe/erpnext/issues/43262,"[('bug', None)]","[{'comment_id': 2598183150, 'issue_id': 2532052631, 'author': 'nabinhait', 'body': ""Can't replicate it. If you are still getting the error on a new docker setup, please reopen the issue."", 'created_at': datetime.datetime(2025, 1, 17, 11, 43, 25, tzinfo=datetime.timezone.utc)}]","nabinhait on (2025-01-17 11:43:25 UTC): Can't replicate it. If you are still getting the error on a new docker setup, please reopen the issue.

"
2532043531,issue,closed,completed,Cannot create company - could not find Warehouse Type Transit,"### Information about bug

Being able to save the company without error.

### Module

stock

### Version

15.35.2 docker 

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
Message : Could not find Warehouse Type: Transit

This issue is mentioned here:
https://github.com/frappe/erpnext/issues/42309
https://discuss.frappe.io/t/new-company-creation/99670/5

The workaround suggested seems a bit unnecessary, why not create the default Warehouse Type Transit ?
I think it is a bug because in the company creation screen I do not see the need for filling in a warehouse / type. The suggestion of following setup is more or less what I did.

I suggest if this default being there is not viable, an option to create it at company creation and making it visible there somehow, or just have it as default setup.

Thank you for creating this great product, I am up and running using the workaround, just feel this product would be even better when this is addressed :).
```
",VGerris,2024-09-17 20:10:41+00:00,[],2025-02-01 00:11:15+00:00,2025-01-17 11:43:33+00:00,https://github.com/frappe/erpnext/issues/43261,"[('bug', None)]","[{'comment_id': 2598183380, 'issue_id': 2532043531, 'author': 'nabinhait', 'body': ""Can't replicate it. If you are still getting the error on a new docker setup, please reopen the issue."", 'created_at': datetime.datetime(2025, 1, 17, 11, 43, 33, tzinfo=datetime.timezone.utc)}]","nabinhait on (2025-01-17 11:43:33 UTC): Can't replicate it. If you are still getting the error on a new docker setup, please reopen the issue.

"
2531282632,issue,open,,Serial and Batch Bundle Issue in Subcontracting,"### Information about bug

My customer was on v13 and was use to a particular scenario which is impossible to achieve after upgrading to v15.

The cycle goes as following:

1. Purchase order is made, qty of finished goods entered.
- Multiple service items inserted as multiple finished goods to be received.
FG: RO1 -> 40 qty
FG: RO2 -> 60 qty

2. Subcontracting Order is created.

3. Material is transferred 
- Note: raw material transferred is the same for all finished goods
For example if finished goods are RO1 and RO2, both consume the same raw material RB01, so 100 qty of RB01 transferred

5. During Subcontracting Receipt (facing issue)
- the nature of process is that while creating PO it is not confirm how much FG I will receive of each item, the total will remain same, but the qty might differ, since the raw material is same, it doesnt matter in that aspect.
- I want to be able to adjust the quantities during Subcontract receipt
Ex: Suppose RO1 in PO had 40 qty and RO2 had 60. total is 100
during receipt I want RO1 to be 30 and RO2 to be 70.

When I try to do this the system doesnt let me do it stating error related to Serial Batch Bundle

![image](https://github.com/user-attachments/assets/566fe9c2-383f-4453-9366-63c98c7da513)

This issue is really frustating to the client, as it is the new subcontracting and serial batch bundle scnearios are too much complicated than before, and now this makes using the system difficult.

I tried changing the setting to Backflush from Transfered for Subcontracting, that change now lets me to edit the consumed qty but still, the issue is there when consumed is more then required. (this should not be an issue as the raw material was the same)

I could only think of a workaround to ask the user to only receive the RO1 as 30 and RO2 as 60. then make stock return of 10 and then make a new PO for the remaining order, but this is too tedious.

I am not very good with coding. so if someone can guide me how to resolve this it would be a great help!




### Module

buying

### Version

ERPNext: v15.34.0 (version-15)

Frappe Framework: v15.39.2 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1768, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 337, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 373, in _save
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1091, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 962, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1322, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1304, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 959, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/subcontracting/doctype/subcontracting_receipt/subcontracting_receipt.py"", line 127, in validate
    super().validate()
  File ""apps/erpnext/erpnext/controllers/subcontracting_controller.py"", line 54, in validate
    self.create_raw_materials_supplied()
  File ""apps/erpnext/erpnext/controllers/subcontracting_controller.py"", line 835, in create_raw_materials_supplied
    self.set_materials_for_subcontracted_items(raw_material_table)
  File ""apps/erpnext/erpnext/controllers/subcontracting_controller.py"", line 831, in set_materials_for_subcontracted_items
    self.__prepare_supplied_items()
  File ""apps/erpnext/erpnext/controllers/subcontracting_controller.py"", line 786, in __prepare_supplied_items
    self.__set_supplied_items()
  File ""apps/erpnext/erpnext/controllers/subcontracting_controller.py"", line 712, in __set_supplied_items
    self.__add_supplied_item(row, transfer_item.get(""item_details""), qty)
  File ""apps/erpnext/erpnext/controllers/subcontracting_controller.py"", line 595, in __add_supplied_item
    rm_obj.serial_and_batch_bundle = self.__set_serial_and_batch_bundle(
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/controllers/subcontracting_controller.py"", line 519, in __set_serial_and_batch_bundle
    ).make_serial_and_batch_bundle()
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 949, in make_serial_and_batch_bundle
    self.validate_qty(doc)
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 988, in validate_qty
    frappe.throw(msg, title=_(""Insufficient Stock""))
  File ""apps/frappe/frappe/__init__.py"", line 645, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 610, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 561, in _raise_exception
    raise exc
frappe.exceptions.ValidationError: For the item <strong>RO28-100g</strong>, the Avaliable qty <strong>500.0</strong> is less than the Required Qty <strong>600.0</strong> in the warehouse <strong>Taha Slitting - GEM</strong>. Please add sufficient qty in the warehouse.

```
",moizsami,2024-09-17 14:12:37+00:00,[],2025-01-17 13:36:45+00:00,,https://github.com/frappe/erpnext/issues/43258,"[('bug', None)]","[{'comment_id': 2356001438, 'issue_id': 2531282632, 'author': 'moizsami', 'body': '@rohitwaghchaure brother tagging you, do let me know if there is any solution to this, it is really affecting the users.', 'created_at': datetime.datetime(2024, 9, 17, 14, 23, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2358412691, 'issue_id': 2531282632, 'author': 'moizsami', 'body': 'Regarding this, would really appreciate if Update Items functionality is implemented on the level of Subcontracting, as figures tend to change time to time for the subcontracting order..\r\n\r\nsimilar to sales and purchase order, if receipt is not completed fully we should have option to update the items..', 'created_at': datetime.datetime(2024, 9, 18, 13, 2, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2598352779, 'issue_id': 2531282632, 'author': 'rohitwaghchaure', 'body': '@moizsami are you still facing the serial and batch bundle issue?', 'created_at': datetime.datetime(2025, 1, 17, 13, 18, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2598385122, 'issue_id': 2531282632, 'author': 'moizsami', 'body': '> [@moizsami](https://github.com/moizsami) are you still facing the serial and batch bundle issue?\n\nYes, This feature is really required..atleast in our type of industry and region where things are not always so precise.\n\nStill the Update Items feature is not available and neither while receiving we can change the qty of received FG (when RM is same for more than one item)', 'created_at': datetime.datetime(2025, 1, 17, 13, 36, 43, tzinfo=datetime.timezone.utc)}]","moizsami (Issue Creator) on (2024-09-17 14:23:12 UTC): @rohitwaghchaure brother tagging you, do let me know if there is any solution to this, it is really affecting the users.

moizsami (Issue Creator) on (2024-09-18 13:02:42 UTC): Regarding this, would really appreciate if Update Items functionality is implemented on the level of Subcontracting, as figures tend to change time to time for the subcontracting order..

similar to sales and purchase order, if receipt is not completed fully we should have option to update the items..

rohitwaghchaure on (2025-01-17 13:18:42 UTC): @moizsami are you still facing the serial and batch bundle issue?

moizsami (Issue Creator) on (2025-01-17 13:36:43 UTC): Yes, This feature is really required..atleast in our type of industry and region where things are not always so precise.

Still the Update Items feature is not available and neither while receiving we can change the qty of received FG (when RM is same for more than one item)

"
2530654365,issue,open,,Supplier Scorecard Criteria fails when division sign is used,"### Information about bug

When creating a Supplier Scorecard Criteria, it always returns an error whenever a division sign is used. For exactly the same formula, replacing the division sign with any other (addition, subtraction, or multiplication), the criteria can be saved.

![supplier_scorecard_error](https://github.com/user-attachments/assets/40ad4d83-3a4c-4add-a9e6-f0e3188e443a)
Using division sign

![image](https://github.com/user-attachments/assets/67a81d07-c93a-46c3-85fd-24b7838da2b6)
Using multiplication sign

Maybe it is something to do with character escape?

### Module

buying

### Version

Frappe version: **v15.39.1**
ERPNext version: **v15.34.0**

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",hans-permana,2024-09-17 09:52:26+00:00,[],2024-09-17 09:52:26+00:00,,https://github.com/frappe/erpnext/issues/43256,"[('bug', None)]",[],
2530534879,issue,closed,completed,Parent (Group) Chart of Accounts Not updating while Posting Entry in child company (subsidiary),"### Information about bug

Hi Team,

 while we Posting Entry in child company (subsidiary) the Parent (Group) Chart of Accounts Not reflecting ( Updating) the Amount ( Entry Posted in Child Company )

Pls Suggest , Thanks You in Advanced

### Module

accounts

### Version

Frappe Framework: v14.52.0 (version-14)
ERPNext: v14.44.0 (version-14)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",Chourey30,2024-09-17 09:17:43+00:00,[],2025-01-29 00:10:02+00:00,2025-01-14 12:31:06+00:00,https://github.com/frappe/erpnext/issues/43252,"[('bug', None)]","[{'comment_id': 2510836943, 'issue_id': 2530534879, 'author': 'Chourey30', 'body': '[COA Error.docx](https://github.com/user-attachments/files/17974681/COA.Error.docx)', 'created_at': datetime.datetime(2024, 12, 2, 8, 8, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2589792554, 'issue_id': 2530534879, 'author': 'nabinhait', 'body': 'Currently, the Trial Balance report does not consolidate values based on the child company\'s data. There is a ""Consolidated Financial Statement"" for the consolidated balance sheet and P&L statement.', 'created_at': datetime.datetime(2025, 1, 14, 12, 31, 6, tzinfo=datetime.timezone.utc)}]","Chourey30 (Issue Creator) on (2024-12-02 08:08:08 UTC): [COA Error.docx](https://github.com/user-attachments/files/17974681/COA.Error.docx)

nabinhait on (2025-01-14 12:31:06 UTC): Currently, the Trial Balance report does not consolidate values based on the child company's data. There is a ""Consolidated Financial Statement"" for the consolidated balance sheet and P&L statement.

"
2530346965,issue,closed,completed,India_compliance Installation Error,"### Information about bug

Docker using Success full installation erpnext and frappe version-15 in my windows server. [pwd.yml](https://github.com/frappe/frappe_docker/blob/main/pwd.yml).  

And  India compliance  install my backend bench site successfull run but some modules are broken attach frappe forum discussion for this error [invalid-depends-on-expression](https://discuss.frappe.io/t/india-compliance-error-invalid-depends-on-expression/131061). 

 - bench get-app --branch version-15 https://github.com/resilient-tech/india-compliance.git;

 -  bench --site frontend install-app india_compliance;

Next i try to install india_compliance my frontend bench sit show all css an js files are broken  ref: [#40054 ]



 

### Module

other

### Version

frappe           15.40.6 
erpnext          15.35.1
india_compliance 15.13.2 version-15

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/env/lib/python3.11/site-packages/gunicorn/workers/gthread.py"", line 282, in handle
2024-09-17 12:42:06     keepalive = self.handle_request(req, conn)
2024-09-17 12:42:06                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/env/lib/python3.11/site-packages/gunicorn/workers/gthread.py"", line 334, in handle_request
2024-09-17 12:42:06     respiter = self.wsgi(environ, resp.start_response)
2024-09-17 12:42:06                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/apps/frappe/frappe/app.py"", line 79, in application
2024-09-17 12:42:06     app(environ, start_response),
2024-09-17 12:42:06     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/env/lib/python3.11/site-packages/werkzeug/wrappers/request.py"", line 190, in application
2024-09-17 12:42:06     resp = f(*args[:-2] + (request,))
2024-09-17 12:42:06            ^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/apps/frappe/frappe/app.py"", line 132, in application
2024-09-17 12:42:06     response = handle_exception(e)
2024-09-17 12:42:06                ^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/apps/frappe/frappe/app.py"", line 395, in handle_exception
2024-09-17 12:42:06     response = get_response(""message"", http_status_code=http_status_code)
2024-09-17 12:42:06                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/apps/frappe/frappe/website/serve.py"", line 28, in get_response
2024-09-17 12:42:06     response = ErrorPage(exception=e).render()
2024-09-17 12:42:06                ^^^^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/apps/frappe/frappe/website/page_renderers/error_page.py"", line 7, in __init__
2024-09-17 12:42:06     super().__init__(path=path, http_status_code=http_status_code)
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/apps/frappe/frappe/website/page_renderers/template_page.py"", line 45, in __init__
2024-09-17 12:42:06     self.set_template_path()
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/apps/frappe/frappe/website/page_renderers/template_page.py"", line 54, in set_template_path
2024-09-17 12:42:06     app_path = frappe.get_app_path(app)
2024-09-17 12:42:06                ^^^^^^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/apps/frappe/frappe/__init__.py"", line 1512, in get_app_path
2024-09-17 12:42:06     return get_pymodule_path(app_name, *joins)
2024-09-17 12:42:06            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/apps/frappe/frappe/__init__.py"", line 1542, in get_pymodule_path
2024-09-17 12:42:06     return abspath(join(dirname(get_module(scrub(modulename)).__file__ or """"), *joins))
2024-09-17 12:42:06                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""/home/frappe/frappe-bench/apps/frappe/frappe/__init__.py"", line 1483, in get_module
2024-09-17 12:42:06     return importlib.import_module(modulename)
2024-09-17 12:42:06            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""/usr/local/lib/python3.11/importlib/__init__.py"", line 126, in import_module
2024-09-17 12:42:06     return _bootstrap._gcd_import(name[level:], package, level)
2024-09-17 12:42:06            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2024-09-17 12:42:06   File ""<frozen importlib._bootstrap>"", line 1204, in _gcd_import
2024-09-17 12:42:06   File ""<frozen importlib._bootstrap>"", line 1176, in _find_and_load
2024-09-17 12:42:06   File ""<frozen importlib._bootstrap>"", line 1140, in _find_and_load_unlocked
```
",RajPW,2024-09-17 07:58:27+00:00,[],2024-10-10 00:10:03+00:00,2024-09-23 11:22:45+00:00,https://github.com/frappe/erpnext/issues/43251,"[('bug', None)]","[{'comment_id': 2360036286, 'issue_id': 2530346965, 'author': 'Nihantra-Patel', 'body': 'apply command and check it.\r\n\r\n```\r\nbench build --force\r\n```\r\n\r\nCC: @sagarvora', 'created_at': datetime.datetime(2024, 9, 19, 5, 52, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2367921029, 'issue_id': 2530346965, 'author': 'RajPW', 'body': '@Nihantra-Patel i tried..error not clear.. give one video for india compliance installation step by step', 'created_at': datetime.datetime(2024, 9, 23, 11, 20, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2367926131, 'issue_id': 2530346965, 'author': 'Nihantra-Patel', 'body': 'Please check [this](https://docs.indiacompliance.app/docs/getting-started/installation).', 'created_at': datetime.datetime(2024, 9, 23, 11, 22, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2367995316, 'issue_id': 2530346965, 'author': 'RajPW', 'body': ""@Nihantra-Patel  \r\nI already this website refered to india_complaince install successfully ..\r\n\r\nbench get-app https://github.com/resilient-tech/india-compliance.git\r\nbench --site [site name] install-app india_compliance\r\n\r\nfrappe@f12aae146fd6:~/frappe-bench$  bench get-app https://github.com/resilient-tech/india-compliance.git --branch version-15\r\nGetting india-compliance\r\n$ git clone https://github.com/resilient-tech/india-compliance.git --branch version-15  --origin upstream\r\nCloning into 'india-compliance'...\r\nremote: Enumerating objects: 33311, done.\r\nremote: Counting objects: 100% (3160/3160), done.\r\nremote: Compressing objects: 100% (1159/1159), done.\r\nremote: Total 33311 (delta 2386), reused 2482 (delta 1970), pack-reused 30151 (from 1)\r\nReceiving objects: 100% (33311/33311), 7.69 MiB | 6.47 MiB/s, done.\r\nResolving deltas: 100% (23584/23584), done.\r\nIgnoring dependencies of https://github.com/resilient-tech/india-compliance.git. To install dependencies use --resolve-deps\r\nInstalling india_compliance\r\n$ /home/frappe/frappe-bench/env/bin/python -m pip install --quiet --upgrade -e /home/frappe/frappe-bench/apps/india_compliance\r\n$ bench build --app india_compliance\r\n✔ Application Assets Linked\r\n\r\n\r\nyarn run v1.22.22\r\n$ node esbuild --production --apps india_compliance --run-build-command\r\nBrowserslist: caniuse-lite is outdated. Please run:\r\n  npx update-browserslist-db@latest\r\n  Why you should do it regularly: https://github.com/browserslist/update-db#readme\r\nFile                                                        Size\r\n\r\nindia_compliance/dist/js/\r\n├─ gstr1.bundle.K2EDK2GL.js                                 6.97 Kb\r\n├─ india_compliance.bundle.RDJWGSGZ.js                      33.14 Kb\r\n├─ purchase_reconciliation_tool.bundle.KYAT73KU.js          5.66 Kb\r\n├─ india_compliance_account.bundle.KB2LZBYY.js              140.59 Kb\r\n└─ india_compliance_account.bundle.Y33L76RA.css             7.44 Kb\r\n\r\nindia_compliance/dist/css/\r\n├─ india_compliance.bundle.F3CU5POB.css                     0.10 Kb\r\n└─ india_compliance_account.bundle.NLKWFOIN.css             3.08 Kb\r\n\r\nindia_compliance/dist/css-rtl/\r\n├─ india_compliance.bundle.Y7WJDPVS.css                     0.10 Kb\r\n└─ india_compliance_account.bundle.3FAO2MPH.css             3.08 Kb\r\n\r\n DONE  Total Build Time: 988.065ms\r\n\r\nDone in 2.76s.\r\nCompiling translations for india_compliance\r\nWARN: restart failed: Couldn't find supervisorctl in PATH\r\nfrappe@f12aae146fd6:~/frappe-bench$ bench --site frontend migrate\r\nMigrating frontend\r\nUpdating DocTypes for frappe        : [========================================] 100%\r\nUpdating DocTypes for erpnext       : [========================================] 100%\r\nUpdating Dashboard for frappe\r\nUpdating Dashboard for erpnext\r\nUpdating customizations for Address\r\nUpdating customizations for Contact\r\nQueued rebuilding of search index for frontend\r\n\r\nfrappe@f12aae146fd6:~/frappe-bench$ bench --site frontend install-app india_compliance\r\nApp erpnext already installed\r\n\r\nInstalling india_compliance...\r\nUpdating DocTypes for india_compliance: [========================================] 100%\r\nSetting up Income Tax...\r\nSetting up GST...\r\nPatching Existing Data...\r\nThank you for installing India Compliance!\r\nUpdating Dashboard for india_compliance\r\n\r\nAfter install India_comp;liance css and js broken"", 'created_at': datetime.datetime(2024, 9, 23, 11, 55, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2368009195, 'issue_id': 2530346965, 'author': 'Nihantra-Patel', 'body': ""We installed it locally and also on the frappe cloud side, but we haven't found the issue. If have an issue then raise it on the [india-compliance](https://github.com/resilient-tech/india-compliance) github.\r\n\r\n> After install India_comp;liance css and js broken\r\n\r\nafter install the india-compliance you have to run the \r\n```js\r\nbench build --app india_compliance\r\n\r\n// OR\r\n\r\nbench build --app india_compliance --force\r\n```"", 'created_at': datetime.datetime(2024, 9, 23, 12, 0, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2370195721, 'issue_id': 2530346965, 'author': 'Infochain2024', 'body': 'An error occurred while installing india_compliance: Could not find DocType: Bill of Entry\r\nTraceback with variables (most recent call last):\r\n  File ""apps/frappe/frappe/commands/site.py"", line 445, in install_app\r\n    _install_app(app, verbose=context.verbose, force=force)\r\n      context = {\'sites\': [\'idemo.info-chain.in\'], \'force\': False, \'verbose\': False, \'profile\': False}\r\n      apps = (\'india_compliance\',)\r\n      force = False\r\n      _install_app = <function install_app at 0x743f7bd3d580>\r\n      filelock = <function filelock at 0x743f7becb1a0>\r\n      exit_code = 0\r\n      site = \'idemo.info-chain.in\'\r\n      app = \'india_compliance\'\r\n      err = LinkValidationError(\'Could not find DocType: Bill of Entry\')\r\n  File ""apps/frappe/frappe/installer.py"", line 311, in install_app\r\n    frappe.get_attr(after_install)()\r\n      name = \'india_compliance\'\r\n      verbose = False\r\n      set_as_patched = True\r\n      force = False\r\n      sync_jobs = <function sync_jobs at 0x743f7b21dda0>\r\n      sync_for = <function sync_for at 0x743f7b21eb60>\r\n      sync_customizations = <function sync_customizations at 0x743f7cad18a0>\r\n      sync_fixtures = <function sync_fixtures at 0x743f7b21ee80>\r\n      app_hooks = {\'accounting_dimension_doctypes\': [\'Bill of Entry\', \'Bill of Entry Item\'], \'after_app_install\': [\'india_compliance.install.after_app_install\'], \'after_install\': [\'india_compliance.install.after_install\'], \'after_migrate\': [\'india_compliance.audit_trail.setup.after_migrate\'], \'app_color\': [\'grey\'], \'app_description\': [\'ERPNext app to simplify compliance with Indian Rules and Regulations\'], \'app_email\': [\'hello@indiacompliance.app\'], \'app_icon\': [\'octicon octicon-file-directory\'], \'app_include_css\': [\'india_compliance.bundle.css\'], \'app_include_js\': [\'india_compliance.bundle.js\'], \'app_license\': [\'GNU General Public License (v3)\'], \'app_name\': [\'india_compliance\'], \'app_publisher\': [\'Resilient Tech\'], \'app_title\': [\'India Compliance\'], \'audit_trail_doctypes\': [\'Accounts Settings\', \'Dunning\', \'Invoice Discounting\', \'Journal Entry\', \'Payment Entry\', \'Period Closing Voucher\', \'Process Deferred Accounting\', \'Purchase Invoice\', \'Sales Invoice\', \'Asset\', \'Asset Capitalization\', \'Asset Repair\',...\r\n      installed_apps = [\'frappe\', \'erpnext\']\r\n      app = \'frappe/erpnext\'\r\n      required_app = \'erpnext\'\r\n      before_install = \'india_compliance.patches.check_version_compatibility.execute\'\r\n      out = None\r\n      after_install = \'india_compliance.install.after_install\'\r\n  File ""apps/india_compliance/india_compliance/install.py"", line 75, in after_install\r\n    raise e\r\n  File ""apps/india_compliance/india_compliance/install.py"", line 54, in after_install\r\n    setup_audit_trail()\r\n  File ""apps/india_compliance/india_compliance/audit_trail/setup.py"", line 15, in setup_fixtures\r\n    create_property_setters_for_versioning()\r\n  File ""apps/india_compliance/india_compliance/audit_trail/setup.py"", line 35, in create_property_setters_for_versioning\r\n    property_setter.insert()\r\n      doctype = \'Bill of Entry\'\r\n      property_setter_data = {\'doctype_or_field\': \'DocType\', \'doc_type\': \'Bill of Entry\', \'property\': \'track_changes\', \'value\': \'1\', \'property_type\': \'Check\', \'is_system_generated\': 1}\r\n      property_setter = <PropertySetter: unsaved>\r\n  File ""apps/frappe/frappe/model/document.py"", line 283, in insert\r\n    self._validate_links()\r\n      self = <PropertySetter: unsaved>\r\n      ignore_permissions = None\r\n      ignore_links = None\r\n      ignore_if_duplicate = False\r\n      ignore_mandatory = None\r\n      set_name = None\r\n      set_child_names = True\r\n  File ""apps/frappe/frappe/model/document.py"", line 930, in _validate_links\r\n    frappe.throw(_(""Could not find {0}"").format(msg), frappe.LinkValidationError)\r\n      self = <PropertySetter: unsaved>\r\n      invalid_links = [(\'doc_type\', \'Bill of Entry\', \'DocType: Bill of Entry\')]\r\n      cancelled_links = []\r\n      msg = \'DocType: Bill of Entry\'\r\n  File ""apps/frappe/frappe/__init__.py"", line 652, in throw\r\n    msgprint(\r\n      msg = \'Could not find DocType: Bill of Entry\'\r\n      exc = <class \'frappe.exceptions.LinkValidationError\'>\r\n      title = None\r\n      is_minimizable = False\r\n      wide = False\r\n      as_list = False\r\n      primary_action = None\r\n  File ""apps/frappe/frappe/__init__.py"", line 617, in msgprint\r\n    _raise_exception()\r\n      msg = \'Could not find DocType: Bill of Entry\'\r\n      title = None\r\n      raise_exception = <class \'frappe.exceptions.LinkValidationError\'>\r\n      as_table = False\r\n      as_list = False\r\n      indicator = \'red\'\r\n      alert = False\r\n      primary_action = None\r\n      is_minimizable = False\r\n      wide = False\r\n      realtime = False\r\n      sys = <module \'sys\' (built-in)>\r\n      _raise_exception = <function msgprint.<locals>._raise_exception at 0x743f796c93a0>\r\n      inspect = <module \'inspect\' from \'/usr/lib/python3.12/inspect.py\'>\r\n      out = {\'message\': \'Could not find DocType: Bill of Entry\', \'title\': \'Message\', \'indicator\': \'red\', \'raise_exception\': 1, \'__frappe_exc_id\': \'bc0ec57a24342d50b578bff48092e9fd0a943f0f2531f52389f14362\'}\r\n  File ""apps/frappe/frappe/__init__.py"", line 568, in _raise_exception\r\n    raise exc\r\n      exc = LinkValidationError(\'Could not find DocType: Bill of Entry\')\r\n      inspect = <module \'inspect\' from \'/usr/lib/python3.12/inspect.py\'>\r\n      msg = \'Could not find DocType: Bill of Entry\'\r\n      out = {\'message\': \'Could not find DocType: Bill of Entry\', \'title\': \'Message\', \'indicator\': \'red\', \'raise_exception\': 1, \'__frappe_exc_id\': \'bc0ec57a24342d50b578bff48092e9fd0a943f0f2531f52389f14362\'}\r\n      raise_exception = <class \'frappe.exceptions.LinkValidationError\'>\r\nfrappe.exceptions.LinkValidationError: Could not find DocType: Bill of Entry', 'created_at': datetime.datetime(2024, 9, 24, 5, 21, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2370196428, 'issue_id': 2530346965, 'author': 'Infochain2024', 'body': 'Any idea how to resolve this issue?', 'created_at': datetime.datetime(2024, 9, 24, 5, 22, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2370232282, 'issue_id': 2530346965, 'author': 'RajPW', 'body': '@Infochain2024  i am not facing this issue.. no idea..... You which type installation method used?   I am using  docker installation method and locally hosted in my windows server...', 'created_at': datetime.datetime(2024, 9, 24, 5, 36, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2370312058, 'issue_id': 2530346965, 'author': 'Infochain2024', 'body': 'I am using manual installation.', 'created_at': datetime.datetime(2024, 9, 24, 6, 33, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2370342832, 'issue_id': 2530346965, 'author': 'RajPW', 'body': '@Infochain2024 sorry i am new user for erpnext.  no idea this type of errors.... i am also stuck some errors, only manual installation lot of errors showing, Frappe cloud only is smooth running. but its paid platform....', 'created_at': datetime.datetime(2024, 9, 24, 6, 52, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2370837109, 'issue_id': 2530346965, 'author': 'vorasmit', 'body': 'Did you try installation with the docker guide given [here](https://docs.indiacompliance.app/docs/getting-started/installation)?\r\n\r\nYou need to first build a custom image of India Compliance App with apps you need, and then use it in docker.', 'created_at': datetime.datetime(2024, 9, 24, 10, 5, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2371055911, 'issue_id': 2530346965, 'author': 'vinodjp21', 'body': '> Did you try installation with the docker guide given [here](https://docs.indiacompliance.app/docs/getting-started/installation)?\r\n> \r\n> You need to first build a custom image of India Compliance App with apps you need, and then use it in docker.\r\n\r\nThe India compliance app has some issues with installation.  Even I am getting the same error.', 'created_at': datetime.datetime(2024, 9, 24, 11, 56, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2371127350, 'issue_id': 2530346965, 'author': 'RajPW', 'body': '@vinodjp21 yes... only manual installation lot of issues.  This is india_compliance error or erpnext error so i am confused.....\r\n\r\nyou solve this errors.. i need help', 'created_at': datetime.datetime(2024, 9, 24, 12, 25, 31, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-19 05:52:39 UTC): apply command and check it.

```
bench build --force
```

CC: @sagarvora

RajPW (Issue Creator) on (2024-09-23 11:20:11 UTC): @Nihantra-Patel i tried..error not clear.. give one video for india compliance installation step by step

Nihantra-Patel on (2024-09-23 11:22:45 UTC): Please check [this](https://docs.indiacompliance.app/docs/getting-started/installation).

RajPW (Issue Creator) on (2024-09-23 11:55:04 UTC): @Nihantra-Patel  
I already this website refered to india_complaince install successfully ..

bench get-app https://github.com/resilient-tech/india-compliance.git
bench --site [site name] install-app india_compliance

frappe@f12aae146fd6:~/frappe-bench$  bench get-app https://github.com/resilient-tech/india-compliance.git --branch version-15
Getting india-compliance
$ git clone https://github.com/resilient-tech/india-compliance.git --branch version-15  --origin upstream
Cloning into 'india-compliance'...
remote: Enumerating objects: 33311, done.
remote: Counting objects: 100% (3160/3160), done.
remote: Compressing objects: 100% (1159/1159), done.
remote: Total 33311 (delta 2386), reused 2482 (delta 1970), pack-reused 30151 (from 1)
Receiving objects: 100% (33311/33311), 7.69 MiB | 6.47 MiB/s, done.
Resolving deltas: 100% (23584/23584), done.
Ignoring dependencies of https://github.com/resilient-tech/india-compliance.git. To install dependencies use --resolve-deps
Installing india_compliance
$ /home/frappe/frappe-bench/env/bin/python -m pip install --quiet --upgrade -e /home/frappe/frappe-bench/apps/india_compliance
$ bench build --app india_compliance
✔ Application Assets Linked


yarn run v1.22.22
$ node esbuild --production --apps india_compliance --run-build-command
Browserslist: caniuse-lite is outdated. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
File                                                        Size

india_compliance/dist/js/
├─ gstr1.bundle.K2EDK2GL.js                                 6.97 Kb
├─ india_compliance.bundle.RDJWGSGZ.js                      33.14 Kb
├─ purchase_reconciliation_tool.bundle.KYAT73KU.js          5.66 Kb
├─ india_compliance_account.bundle.KB2LZBYY.js              140.59 Kb
└─ india_compliance_account.bundle.Y33L76RA.css             7.44 Kb

india_compliance/dist/css/
├─ india_compliance.bundle.F3CU5POB.css                     0.10 Kb
└─ india_compliance_account.bundle.NLKWFOIN.css             3.08 Kb

india_compliance/dist/css-rtl/
├─ india_compliance.bundle.Y7WJDPVS.css                     0.10 Kb
└─ india_compliance_account.bundle.3FAO2MPH.css             3.08 Kb

 DONE  Total Build Time: 988.065ms

Done in 2.76s.
Compiling translations for india_compliance
WARN: restart failed: Couldn't find supervisorctl in PATH
frappe@f12aae146fd6:~/frappe-bench$ bench --site frontend migrate
Migrating frontend
Updating DocTypes for frappe        : [========================================] 100%
Updating DocTypes for erpnext       : [========================================] 100%
Updating Dashboard for frappe
Updating Dashboard for erpnext
Updating customizations for Address
Updating customizations for Contact
Queued rebuilding of search index for frontend

frappe@f12aae146fd6:~/frappe-bench$ bench --site frontend install-app india_compliance
App erpnext already installed

Installing india_compliance...
Updating DocTypes for india_compliance: [========================================] 100%
Setting up Income Tax...
Setting up GST...
Patching Existing Data...
Thank you for installing India Compliance!
Updating Dashboard for india_compliance

After install India_comp;liance css and js broken

Nihantra-Patel on (2024-09-23 12:00:58 UTC): We installed it locally and also on the frappe cloud side, but we haven't found the issue. If have an issue then raise it on the [india-compliance](https://github.com/resilient-tech/india-compliance) github.


after install the india-compliance you have to run the 
```js
bench build --app india_compliance

// OR

bench build --app india_compliance --force
```

Infochain2024 on (2024-09-24 05:21:43 UTC): An error occurred while installing india_compliance: Could not find DocType: Bill of Entry
Traceback with variables (most recent call last):
  File ""apps/frappe/frappe/commands/site.py"", line 445, in install_app
    _install_app(app, verbose=context.verbose, force=force)
      context = {'sites': ['idemo.info-chain.in'], 'force': False, 'verbose': False, 'profile': False}
      apps = ('india_compliance',)
      force = False
      _install_app = <function install_app at 0x743f7bd3d580>
      filelock = <function filelock at 0x743f7becb1a0>
      exit_code = 0
      site = 'idemo.info-chain.in'
      app = 'india_compliance'
      err = LinkValidationError('Could not find DocType: Bill of Entry')
  File ""apps/frappe/frappe/installer.py"", line 311, in install_app
    frappe.get_attr(after_install)()
      name = 'india_compliance'
      verbose = False
      set_as_patched = True
      force = False
      sync_jobs = <function sync_jobs at 0x743f7b21dda0>
      sync_for = <function sync_for at 0x743f7b21eb60>
      sync_customizations = <function sync_customizations at 0x743f7cad18a0>
      sync_fixtures = <function sync_fixtures at 0x743f7b21ee80>
      app_hooks = {'accounting_dimension_doctypes': ['Bill of Entry', 'Bill of Entry Item'], 'after_app_install': ['india_compliance.install.after_app_install'], 'after_install': ['india_compliance.install.after_install'], 'after_migrate': ['india_compliance.audit_trail.setup.after_migrate'], 'app_color': ['grey'], 'app_description': ['ERPNext app to simplify compliance with Indian Rules and Regulations'], 'app_email': ['hello@indiacompliance.app'], 'app_icon': ['octicon octicon-file-directory'], 'app_include_css': ['india_compliance.bundle.css'], 'app_include_js': ['india_compliance.bundle.js'], 'app_license': ['GNU General Public License (v3)'], 'app_name': ['india_compliance'], 'app_publisher': ['Resilient Tech'], 'app_title': ['India Compliance'], 'audit_trail_doctypes': ['Accounts Settings', 'Dunning', 'Invoice Discounting', 'Journal Entry', 'Payment Entry', 'Period Closing Voucher', 'Process Deferred Accounting', 'Purchase Invoice', 'Sales Invoice', 'Asset', 'Asset Capitalization', 'Asset Repair',...
      installed_apps = ['frappe', 'erpnext']
      app = 'frappe/erpnext'
      required_app = 'erpnext'
      before_install = 'india_compliance.patches.check_version_compatibility.execute'
      out = None
      after_install = 'india_compliance.install.after_install'
  File ""apps/india_compliance/india_compliance/install.py"", line 75, in after_install
    raise e
  File ""apps/india_compliance/india_compliance/install.py"", line 54, in after_install
    setup_audit_trail()
  File ""apps/india_compliance/india_compliance/audit_trail/setup.py"", line 15, in setup_fixtures
    create_property_setters_for_versioning()
  File ""apps/india_compliance/india_compliance/audit_trail/setup.py"", line 35, in create_property_setters_for_versioning
    property_setter.insert()
      doctype = 'Bill of Entry'
      property_setter_data = {'doctype_or_field': 'DocType', 'doc_type': 'Bill of Entry', 'property': 'track_changes', 'value': '1', 'property_type': 'Check', 'is_system_generated': 1}
      property_setter = <PropertySetter: unsaved>
  File ""apps/frappe/frappe/model/document.py"", line 283, in insert
    self._validate_links()
      self = <PropertySetter: unsaved>
      ignore_permissions = None
      ignore_links = None
      ignore_if_duplicate = False
      ignore_mandatory = None
      set_name = None
      set_child_names = True
  File ""apps/frappe/frappe/model/document.py"", line 930, in _validate_links
    frappe.throw(_(""Could not find {0}"").format(msg), frappe.LinkValidationError)
      self = <PropertySetter: unsaved>
      invalid_links = [('doc_type', 'Bill of Entry', 'DocType: Bill of Entry')]
      cancelled_links = []
      msg = 'DocType: Bill of Entry'
  File ""apps/frappe/frappe/__init__.py"", line 652, in throw
    msgprint(
      msg = 'Could not find DocType: Bill of Entry'
      exc = <class 'frappe.exceptions.LinkValidationError'>
      title = None
      is_minimizable = False
      wide = False
      as_list = False
      primary_action = None
  File ""apps/frappe/frappe/__init__.py"", line 617, in msgprint
    _raise_exception()
      msg = 'Could not find DocType: Bill of Entry'
      title = None
      raise_exception = <class 'frappe.exceptions.LinkValidationError'>
      as_table = False
      as_list = False
      indicator = 'red'
      alert = False
      primary_action = None
      is_minimizable = False
      wide = False
      realtime = False
      sys = <module 'sys' (built-in)>
      _raise_exception = <function msgprint.<locals>._raise_exception at 0x743f796c93a0>
      inspect = <module 'inspect' from '/usr/lib/python3.12/inspect.py'>
      out = {'message': 'Could not find DocType: Bill of Entry', 'title': 'Message', 'indicator': 'red', 'raise_exception': 1, '__frappe_exc_id': 'bc0ec57a24342d50b578bff48092e9fd0a943f0f2531f52389f14362'}
  File ""apps/frappe/frappe/__init__.py"", line 568, in _raise_exception
    raise exc
      exc = LinkValidationError('Could not find DocType: Bill of Entry')
      inspect = <module 'inspect' from '/usr/lib/python3.12/inspect.py'>
      msg = 'Could not find DocType: Bill of Entry'
      out = {'message': 'Could not find DocType: Bill of Entry', 'title': 'Message', 'indicator': 'red', 'raise_exception': 1, '__frappe_exc_id': 'bc0ec57a24342d50b578bff48092e9fd0a943f0f2531f52389f14362'}
      raise_exception = <class 'frappe.exceptions.LinkValidationError'>
frappe.exceptions.LinkValidationError: Could not find DocType: Bill of Entry

Infochain2024 on (2024-09-24 05:22:19 UTC): Any idea how to resolve this issue?

RajPW (Issue Creator) on (2024-09-24 05:36:19 UTC): @Infochain2024  i am not facing this issue.. no idea..... You which type installation method used?   I am using  docker installation method and locally hosted in my windows server...

Infochain2024 on (2024-09-24 06:33:39 UTC): I am using manual installation.

RajPW (Issue Creator) on (2024-09-24 06:52:14 UTC): @Infochain2024 sorry i am new user for erpnext.  no idea this type of errors.... i am also stuck some errors, only manual installation lot of errors showing, Frappe cloud only is smooth running. but its paid platform....

vorasmit on (2024-09-24 10:05:24 UTC): Did you try installation with the docker guide given [here](https://docs.indiacompliance.app/docs/getting-started/installation)?

You need to first build a custom image of India Compliance App with apps you need, and then use it in docker.

vinodjp21 on (2024-09-24 11:56:40 UTC): The India compliance app has some issues with installation.  Even I am getting the same error.

RajPW (Issue Creator) on (2024-09-24 12:25:31 UTC): @vinodjp21 yes... only manual installation lot of issues.  This is india_compliance error or erpnext error so i am confused.....

you solve this errors.. i need help

"
2540538114,issue,open,,Unable to create new Cost Center group,"<!--
Welcome to the frappe_docker issue tracker! Before creating an issue, please heed the following:

1. Is your issue relevant to the frappe_docker or the main Frappe framework? https://github.com/frappe/frappe . if It's the latter, publish the issue there.
2. Use the search function before creating a new issue. Duplicates will be closed and directed to the original discussion.
3. When making a bug report, make sure you provide all the required information. The easier it is for maintainers to reproduce, the faster it'll be fixed.
4. If you think you know what the reason for the bug is, share it with us. Maybe put in a PR 😉
-->

## Description of the issue
When trying to create a Cost Center Group, error is thrown stating ""Mandatory fields required in Cost Center"", ""Parent Cost Center"".

## Context information (for bug reports)

## Steps to reproduce the issue

1. Navigate to Cost Center List
2. Select ""Add Cost Center""
3. Enter 'Cost Center Name' and check 'Is Group'
4. Click 'Save'
5. Error message regarding required fields

### Observed result

### Expected result
Should be able to create Cost Center Group without required Parent Cost Center.

### Stacktrace / full error message if available

```
(paste here)
```
",northern-concrete,2024-09-16 12:12:10+00:00,[],2024-09-21 22:35:37+00:00,,https://github.com/frappe/erpnext/issues/43322,"[('bug', None)]",[],
2527952349,issue,open,,Desk page and workspaces unavailable after migration from v13 to v14,"### Information about bug

After migrating from version 13 to version 14 We got error AttributeError: 'Workspace' object has no attribute 'onboarding_list'
<img width=""643"" alt=""image"" src=""https://github.com/user-attachments/assets/61c7d9da-9fb4-42b7-a0ea-67ab1f98b63a"">

I thought there is problem with DB so I run bench migrate which migrated all of the doctypes but still no change in this. 

Clicking on any workspace shows blank page

<img width=""1490"" alt=""image"" src=""https://github.com/user-attachments/assets/c3965243-1c6a-4c80-a2b2-faf33e3f88dc"">


This is the screenshot from developers console in chrome
<img width=""2051"" alt=""image"" src=""https://github.com/user-attachments/assets/cb13f745-9242-464b-bffa-9404d1749c9a"">


How can we fix this issue? This makes ERPNext unusable for us, as the only way to get to pages is through search...

### Module

other

### Version

Frappe version - 14.81.3
ERPNext version - 14.74.0

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""erpnext"": ""14.74.0"",
	""frappe"": ""14.81.3"",
	""hrms"": ""14.30.1"",
	""payments"": ""0.0.1"",
	""rc_swagger"": ""0.0.1"",
	""re_ca"": ""0.0.1"",
	""re_ca_2"": ""0.0.1""
}
```
### Route
```
Workspaces/private/Home
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 97, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 48, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 86, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1619, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/__init__.py"", line 815, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
  File ""apps/frappe/frappe/desk/desktop.py"", line 398, in get_desktop_page
    workspace.build_workspace()
  File ""apps/frappe/frappe/desk/desktop.py"", line 163, in build_workspace
    self.onboardings = {""items"": self.get_onboardings()}
  File ""apps/frappe/frappe/desk/desktop.py"", line 23, in wrapper
    return fn(*args, **kwargs)
  File ""apps/frappe/frappe/desk/desktop.py"", line 320, in get_onboardings
    if self.onboarding_list:
AttributeError: 'Workspace' object has no attribute 'onboarding_list'

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""page"": ""{\""name\"":\""Home-filippazdic@gmail.com\"",\""title\"":\""Home\"",\""for_user\"":\""filippazdic@gmail.com\"",\""parent_page\"":null,\""content\"":null,\""public\"":0,\""module\"":\""Setup\"",\""icon\"":\""getting-started\"",\""is_hidden\"":0,\""label\"":\""Home-filippazdic@gmail.com\"",\""is_editable\"":true,\""selected\"":true}""
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.desktop.get_desktop_page""
}
```
### Response Data
```
{
	""exception"": ""AttributeError: 'Workspace' object has no attribute 'onboarding_list'""
}
```
```
",Pazdo,2024-09-16 09:31:21+00:00,[],2024-09-16 09:31:21+00:00,,https://github.com/frappe/erpnext/issues/43234,"[('bug', None)]",[],
2527248912,issue,open,,Translations page unavailable as The certificate for translate.erpnext.com expired,"### Information about bug

Translations page is not available for a long time: https://translate.erpnext.com/ 

""The certificate for translate.erpnext.com expired on 9/12/2023.""
""Error code: [SEC_ERROR_EXPIRED_CERTIFICATE](about:certerror?e=nssBadCert&u=https%3A//translate.erpnext.com/&s=badStsCert&c=UTF-8&d=%20#certificateErrorDebugInformation)""

![image](https://github.com/user-attachments/assets/f0cb7ccd-adb0-44b0-84bf-1904197c7e77)


### Module

other

### Version

15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",aha999,2024-09-15 23:04:27+00:00,[],2024-09-18 20:33:13+00:00,,https://github.com/frappe/erpnext/issues/43229,"[('bug', None)]","[{'comment_id': 2359354138, 'issue_id': 2527248912, 'author': 'MhmedRjb', 'body': 'I hope this get solved soon, Arabic language need an essential update in most modules', 'created_at': datetime.datetime(2024, 9, 18, 20, 33, 12, tzinfo=datetime.timezone.utc)}]","MhmedRjb on (2024-09-18 20:33:12 UTC): I hope this get solved soon, Arabic language need an essential update in most modules

"
2526873827,issue,open,,Loan Repayment not effect Journal Entry \,"### Information about bug

when creating Loan for Employee and arrange for Repayment 
the payment not effect Journal Entry and not deducted form Principle Loan Amount
as in Previous on Loan Management in Erpnext 14 it was effect the Journal Entry and deducted from Principle    

### Module

other

### Version

ERPNext: v15.34.0 (version-15)
Frappe Framework: v15.40.0 (version-15)

Frappe HR: v15.28.1 (version-15)

Frappe Lending: v0.0.1 (develop)

### Installation method

easy-install

### Relevant log output / Stack trace / Full Error Message.

```shell
No error appear but Loan Repayment not effect the Journal
```
",YasserMounir,2024-09-15 11:41:35+00:00,[],2024-11-07 15:54:22+00:00,,https://github.com/frappe/erpnext/issues/43228,"[('bug', None)]","[{'comment_id': 2391615909, 'issue_id': 2526873827, 'author': 'YasserMounir', 'body': 'any reply could help', 'created_at': datetime.datetime(2024, 10, 3, 14, 47, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2462593810, 'issue_id': 2526873827, 'author': 'fdav1la', 'body': 'Hello, just wondering if someone had a response? We are facing the same issue, its importante for loans to have accounting registries.', 'created_at': datetime.datetime(2024, 11, 7, 15, 54, 20, tzinfo=datetime.timezone.utc)}]","YasserMounir (Issue Creator) on (2024-10-03 14:47:01 UTC): any reply could help

fdav1la on (2024-11-07 15:54:20 UTC): Hello, just wondering if someone had a response? We are facing the same issue, its importante for loans to have accounting registries.

"
2525621240,issue,closed,completed,"Set ""Available Batch Report"" Default Date to Today","### Information about bug

Currently, the default date for the ""Available Batch Report"" is set to a month before Today.

The expected behavior is that the date should default to Today.
 
![Screenshot 2024-09-13 at 15 48 28](https://github.com/user-attachments/assets/1b54811c-a144-4361-b666-316d46f29733)

Suggested fix for for available_batch_report.js

![Screenshot 2024-09-13 at 16 05 11](https://github.com/user-attachments/assets/91e3152e-48f1-4245-b0ec-3ae0665626d5)


### Module

stock

### Version

Frappe and ERPNext v14 and v15.

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",jayfiro,2024-09-13 20:16:39+00:00,[],2024-10-03 00:10:14+00:00,2024-09-14 16:52:57+00:00,https://github.com/frappe/erpnext/issues/43220,"[('bug', None)]","[{'comment_id': 2350964691, 'issue_id': 2525621240, 'author': 'maveezmh', 'body': 'looks like its been already fixed\r\n![image](https://github.com/user-attachments/assets/6784fc94-6f43-4b0b-b209-89b1d9891318)', 'created_at': datetime.datetime(2024, 9, 14, 11, 54, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2351060031, 'issue_id': 2525621240, 'author': 'jayfiro', 'body': ""That's right! Thank you for pointing that out. It was fixed by #43121"", 'created_at': datetime.datetime(2024, 9, 14, 16, 52, 57, tzinfo=datetime.timezone.utc)}]","maveezmh on (2024-09-14 11:54:41 UTC): looks like its been already fixed
![image](https://github.com/user-attachments/assets/6784fc94-6f43-4b0b-b209-89b1d9891318)

jayfiro (Issue Creator) on (2024-09-14 16:52:57 UTC): That's right! Thank you for pointing that out. It was fixed by #43121

"
2524849683,issue,open,,Incorrect Accounts Payable and Accounts Payable Summary Report,"### Information about bug

I have enabled the setting in company to book advances of customers and suppliers in a separate ledger.
Now when I cancel a payment entry due to any reason, that specific payment entry still effects the payable, receivable and summary reports. According to my understanding, Payable and receivable reports show these entries because they have hit the advance account like below: 

![image](https://github.com/user-attachments/assets/797e9d20-d401-4eca-9a92-77c2304833eb)



### Module

accounts, buying, selling

### Version

ERPNext: v15.34.2 (version-15)

Frappe Framework: v15.39.1 (version-15)

Frappe HR: v15.28.3 (version-15)

Payments: v0.0.1 (develop)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",zahidmansoor,2024-09-13 13:24:33+00:00,[],2024-09-13 13:24:33+00:00,,https://github.com/frappe/erpnext/issues/43217,"[('bug', None)]",[],
2524797480,issue,closed,completed,ERP fails to update due to site migration failure due to Executing erpnext.patches.v15_0.add_disassembly_order_stock_entry_type,"### Information about bug

When I updated my erpnext to latest version, by doing bench update, I get the following error:
Executing erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1 in shamojee.com (_edc58923b501049b)
Queued rebuilding of search index for shamojee.com
![image](https://github.com/user-attachments/assets/410c06b9-7ff2-4e5b-9db6-8ea82981a123)

Executing erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1 in shamojee.com (_edc58923b501049b)
Queued rebuilding of search index for shamojee.com

Traceback with variables (most recent call last):
  File ""/usr/lib/python3.10/runpy.py"", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
      mod_name = 'frappe.utils.bench_helper'
      alter_argv = True
      mod_spec = ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, origin='/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py')
      code = <code object <module> at 0x7f6ebbb3c7c0, file ""/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 1>
      main_globals = {'__name__': '__main__', '__doc__': None, '__package__': 'frappe.utils', '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, '__spec__': ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, origin='/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'), '__annotations__': {}, '__builtins__': <module 'builtins' (built-in)>, '__file__': '/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py', '__cached__': '/home/frappe/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc', 'importlib': <module 'importlib' from '/usr/lib/python3.10/importlib/__init__.py'>, 'json': <module 'json' from '/usr/lib/python3.10/json/__init__.py'>, 'os': <module 'os' from '/usr/lib/python3.10/os.py'>, 'traceback': <module 'traceback' from '/usr/lib/python3.10/traceback.py'>, 'warnings': <module 'warnings' from '/usr/lib/python3.10/warnings.py'>, 'Path': <cl...
  File ""/usr/lib/python3.10/runpy.py"", line 86, in _run_code
    exec(code, run_globals)
      code = <code object <module> at 0x7f6ebbb3c7c0, file ""/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 1>
      run_globals = {'__name__': '__main__', '__doc__': None, '__package__': 'frappe.utils', '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, '__spec__': ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, origin='/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'), '__annotations__': {}, '__builtins__': <module 'builtins' (built-in)>, '__file__': '/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py', '__cached__': '/home/frappe/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc', 'importlib': <module 'importlib' from '/usr/lib/python3.10/importlib/__init__.py'>, 'json': <module 'json' from '/usr/lib/python3.10/json/__init__.py'>, 'os': <module 'os' from '/usr/lib/python3.10/os.py'>, 'traceback': <module 'traceback' from '/usr/lib/python3.10/traceback.py'>, 'warnings': <module 'warnings' from '/usr/lib/python3.10/warnings.py'>, 'Path': <cl...
      init_globals = None
      mod_name = '__main__'
      mod_spec = ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, origin='/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py')
      pkg_name = 'frappe.utils'
      script_name = None
      loader = <_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>
      fname = '/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'
      cached = '/home/frappe/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc'
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 114, in <module>
    main()
      ...skipped... 27 vars
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 20, in main
    click.Group(commands=commands)(prog_name=""bench"")
      commands = {'frappe': <Group frappe>, 'get-frappe-commands': <Command get-frappe-commands>, 'get-frappe-help': <Command get-frappe-help>}
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1157, in __call__
    return self.main(*args, **kwargs)
      self = <Group None>
      args = ()
      kwargs = {'prog_name': 'bench'}
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1078, in main
    rv = self.invoke(ctx)
      self = <Group None>
      args = ['frappe', '--site', 'shamojee.com', 'migrate']
      prog_name = 'bench'
      complete_var = None
      standalone_mode = True
      windows_expand_args = True
      extra = {}
      ctx = <click.core.Context object at 0x7f6ebc2cbfa0>
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
      _process_result = <function MultiCommand.invoke.<locals>._process_result at 0x7f6ebbb56200>
      args = ['migrate']
      cmd_name = 'frappe'
      cmd = <Group frappe>
      sub_ctx = <click.core.Context object at 0x7f6eba594850>
      ctx = <click.core.Context object at 0x7f6ebc2cbfa0>
      self = <Group None>
      __class__ = <class 'click.core.MultiCommand'>
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
      _process_result = <function MultiCommand.invoke.<locals>._process_result at 0x7f6eba549900>
      args = []
      cmd_name = 'migrate'
      cmd = <Command migrate>
      sub_ctx = <click.core.Context object at 0x7f6eba594c10>
      ctx = <click.core.Context object at 0x7f6eba594850>
      self = <Group frappe>
      __class__ = <class 'click.core.MultiCommand'>
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
      self = <Command migrate>
      ctx = <click.core.Context object at 0x7f6eba594c10>
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 783, in invoke
    return __callback(*args, **kwargs)
      _Context__self = <click.core.Context object at 0x7f6eba594c10>
      _Context__callback = <function migrate at 0x7f6ebbb85ea0>
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      ctx = <click.core.Context object at 0x7f6eba594c10>
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py"", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      f = <function migrate at 0x7f6ebbb85c60>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/commands/__init__.py"", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
      ctx = <click.core.Context object at 0x7f6eba594c10>
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      profile = False
      f = <function migrate at 0x7f6ebbb85bd0>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/commands/site.py"", line 616, in migrate
    SiteMigration(
      context = {'sites': ['shamojee.com'], 'force': False, 'verbose': False, 'profile': False}
      skip_failing = False
      skip_search_index = False
      activate_by_import = <module 'traceback_with_variables.activate_by_import' from '/home/frappe/frappe-bench/env/lib/python3.10/site-packages/traceback_with_variables/activate_by_import.py'>
      SiteMigration = <class 'frappe.migrate.SiteMigration'>
      site = 'shamojee.com'
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 186, in run
    self.run_schema_updates()
      self = <frappe.migrate.SiteMigration object at 0x7f6eba594b20>
      site = 'shamojee.com'
      filelock = <function filelock at 0x7f6eb8fb9f30>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 52, in wrapper
    raise e
      args = (<frappe.migrate.SiteMigration object at 0x7f6eba594b20>,)
      kwargs = {}
      method = <function SiteMigration.run_schema_updates at 0x7f6eb8fb9b40>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 44, in wrapper
    ret = method(*args, **kwargs)
      args = (<frappe.migrate.SiteMigration object at 0x7f6eba594b20>,)
      kwargs = {}
      method = <function SiteMigration.run_schema_updates at 0x7f6eb8fb9b40>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 121, in run_schema_updates
    frappe.modules.patch_handler.run_all(
      self = <frappe.migrate.SiteMigration object at 0x7f6eba594b20>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 76, in run_all
    run_patch(patch)
      patch_type = <PatchType.post_model_sync: 'post_model_sync'>
      executed = {""execute:frappe.delete_doc_if_exists('Workspace', 'ERPNext Integrations Settings')"", 'erpnext.patches.v12_0.rename_lost_reason_detail', 'frappe.patches.v14_0.different_encryption_key', 'erpnext.patches.v13_0.update_start_end_date_for_old_shift_assignment', 'erpnext.patches.v12_0.set_job_offer_applicant_email', 'frappe.patches.v15_0.copy_disable_prepared_report_to_prepared_report', 'erpnext.patches.v13_0.enable_provisional_accounting', 'erpnext.patches.v13_0.trim_sales_invoice_custom_field_length', 'erpnext.patches.v15_0.rename_purchase_receipt_amount_to_purchase_amount', 'erpnext.patches.v12_0.rename_pricing_rule_child_doctypes', 'erpnext.patches.v12_0.add_taxjar_integration_field', 'erpnext.patches.v13_0.setup_uae_vat_fields', 'frappe.patches.v13_0.increase_password_length', 'frappe.patches.v11_0.set_allow_self_approval_in_workflow', 'frappe.patches.v12_0.remove_feedback_rating', 'erpnext.patches.v12_0.set_italian_import_supplier_invoice_permissions', 'execute:frappe.utils.global_sea...
      run_patch = <function run_all.<locals>.run_patch at 0x7f6eb7f82050>
      patches = [""execute:frappe.get_doc('Role', 'Guest').save() # remove desk access"", 'frappe.core.doctype.role.patches.v13_set_default_desk_properties', 'frappe.patches.v14_0.update_workspace2 # 06.06.2023', 'frappe.patches.v14_0.drop_data_import_legacy', 'frappe.patches.v14_0.copy_mail_data #08.03.21', 'frappe.patches.v14_0.update_github_endpoints #08-11-2021', 'frappe.patches.v14_0.remove_db_aggregation', 'frappe.patches.v14_0.update_color_names_in_kanban_board_column', 'frappe.patches.v14_0.update_is_system_generated_flag', 'frappe.patches.v14_0.update_auto_account_deletion_duration', 'frappe.patches.v14_0.update_integration_request', 'frappe.patches.v14_0.set_document_expiry_default', 'frappe.patches.v14_0.delete_data_migration_tool', 'frappe.patches.v14_0.set_suspend_email_queue_default', 'frappe.patches.v14_0.different_encryption_key', 'frappe.patches.v14_0.update_multistep_webforms', ""execute:frappe.delete_doc('Page', 'background_jobs', ignore_missing=True, force=True)"", 'frappe.patches.v14_...
      patch = 'erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1'
      skip_failing = False
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 62, in run_patch
    if not run_single(patchmodule=patch):
      patch = 'erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1'
      skip_failing = False
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 152, in run_single
    return execute_patch(patchmodule, method, methodargs)
      patchmodule = 'erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1'
      method = None
      methodargs = None
      force = False
      conf = <LocalProxy unbound>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 188, in execute_patch
    _patch()
      patchmodule = 'erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1'
      method = None
      methodargs = None
      has_patch_file = True
      patch = 'erpnext.patches.v15_0.add_disassembly_order_stock_entry_type.execute'
      docstring = ''
      _patch = <function execute at 0x7f6eb7ab3d90>
      start_time = 940029.764886946
  File ""/home/frappe/frappe-bench/apps/erpnext/erpnext/patches/v15_0/add_disassembly_order_stock_entry_type.py"", line 6, in execute
    frappe.get_doc(
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/model/document.py"", line 292, in insert
    self._validate()
      self = <StockEntryType: Disassemble>
      ignore_permissions = True
      ignore_links = None
      ignore_if_duplicate = False
      ignore_mandatory = None
      set_name = None
      set_child_names = True
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/model/document.py"", line 576, in _validate
    self._validate_selects()
      self = <StockEntryType: Disassemble>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/model/base_document.py"", line 886, in _validate_selects
    frappe.throw(
      self = <StockEntryType: Disassemble>
      df = <SelectDocField: purpose parent=Stock Entry Type>
      options = ['Material Issue', 'Material Receipt', 'Material Transfer', 'Material Transfer for Manufacture', 'Material Consumption for Manufacture', 'Manufacture', 'Repack', 'Send to Subcontractor']
      value = 'Disassemble'
      prefix = ''
      label = 'Purpose'
      comma_options = 'Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor'
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/__init__.py"", line 652, in throw
    msgprint(
      msg = ' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""'
      exc = <class 'frappe.exceptions.ValidationError'>
      title = None
      is_minimizable = False
      wide = False
      as_list = False
      primary_action = None
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/__init__.py"", line 617, in msgprint
    _raise_exception()
      title = None
      as_table = False
      as_list = False
      indicator = 'red'
      alert = False
      primary_action = None
      is_minimizable = False
      wide = False
      realtime = False
      sys = <module 'sys' (built-in)>
      _raise_exception = <function msgprint.<locals>._raise_exception at 0x7f6eb7ab3520>
      msg = ' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""'
      out = {'message': ' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""', 'title': 'Message', 'indicator': 'red', 'raise_exception': 1, '__frappe_exc_id': 'f39b975f316ce355fc4fc8e63fde5e7f4dc4a43907d60474840779dc'}
      raise_exception = <class 'frappe.exceptions.ValidationError'>
      ...skipped... 1 vars
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/__init__.py"", line 568, in _raise_exception
    raise exc
      exc = ValidationError(' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""')
      msg = ' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""'
      out = {'message': ' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""', 'title': 'Message', 'indicator': 'red', 'raise_exception': 1, '__frappe_exc_id': 'f39b975f316ce355fc4fc8e63fde5e7f4dc4a43907d60474840779dc'}
      raise_exception = <class 'frappe.exceptions.ValidationError'>
      ...skipped... 1 vars
frappe.exceptions.ValidationError:  Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""

### Module

other

### Version

ERPNext: v15.34.2 (version-15)

Frappe Framework: v15.39.1 (version-15)

Frappe HR: v15.28.3 (version-15)

Payments: v0.0.1 (develop)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Done in 27.57s.
Patching sites...
Migrating shamojee.com
Updating DocTypes for frappe        : [========================================] 100%
Updating DocTypes for erpnext       : [========================================] 100%
Updating DocTypes for payments      : [========================================] 100%
Updating DocTypes for hrms          : [========================================] 100%
Executing erpnext.patches.v15_0.update_invoice_remarks in shamojee.com (_edc58923b501049b)
Success: Done in 3.004s
Executing erpnext.patches.v14_0.update_reports_with_range in shamojee.com (_edc58923b501049b)
Success: Done in 0.027s
Executing erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1 in shamojee.com (_edc58923b501049b)
Queued rebuilding of search index for shamojee.com

Traceback with variables (most recent call last):
  File ""/usr/lib/python3.10/runpy.py"", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
      mod_name = 'frappe.utils.bench_helper'
      alter_argv = True
      mod_spec = ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, origin='/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py')
      code = <code object <module> at 0x7f6ebbb3c7c0, file ""/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 1>
      main_globals = {'__name__': '__main__', '__doc__': None, '__package__': 'frappe.utils', '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, '__spec__': ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, origin='/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'), '__annotations__': {}, '__builtins__': <module 'builtins' (built-in)>, '__file__': '/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py', '__cached__': '/home/frappe/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc', 'importlib': <module 'importlib' from '/usr/lib/python3.10/importlib/__init__.py'>, 'json': <module 'json' from '/usr/lib/python3.10/json/__init__.py'>, 'os': <module 'os' from '/usr/lib/python3.10/os.py'>, 'traceback': <module 'traceback' from '/usr/lib/python3.10/traceback.py'>, 'warnings': <module 'warnings' from '/usr/lib/python3.10/warnings.py'>, 'Path': <cl...
  File ""/usr/lib/python3.10/runpy.py"", line 86, in _run_code
    exec(code, run_globals)
      code = <code object <module> at 0x7f6ebbb3c7c0, file ""/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 1>
      run_globals = {'__name__': '__main__', '__doc__': None, '__package__': 'frappe.utils', '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, '__spec__': ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, origin='/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'), '__annotations__': {}, '__builtins__': <module 'builtins' (built-in)>, '__file__': '/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py', '__cached__': '/home/frappe/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc', 'importlib': <module 'importlib' from '/usr/lib/python3.10/importlib/__init__.py'>, 'json': <module 'json' from '/usr/lib/python3.10/json/__init__.py'>, 'os': <module 'os' from '/usr/lib/python3.10/os.py'>, 'traceback': <module 'traceback' from '/usr/lib/python3.10/traceback.py'>, 'warnings': <module 'warnings' from '/usr/lib/python3.10/warnings.py'>, 'Path': <cl...
      init_globals = None
      mod_name = '__main__'
      mod_spec = ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>, origin='/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py')
      pkg_name = 'frappe.utils'
      script_name = None
      loader = <_frozen_importlib_external.SourceFileLoader object at 0x7f6ebd12afe0>
      fname = '/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'
      cached = '/home/frappe/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc'
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 114, in <module>
    main()
      ...skipped... 27 vars
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 20, in main
    click.Group(commands=commands)(prog_name=""bench"")
      commands = {'frappe': <Group frappe>, 'get-frappe-commands': <Command get-frappe-commands>, 'get-frappe-help': <Command get-frappe-help>}
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1157, in __call__
    return self.main(*args, **kwargs)
      self = <Group None>
      args = ()
      kwargs = {'prog_name': 'bench'}
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1078, in main
    rv = self.invoke(ctx)
      self = <Group None>
      args = ['frappe', '--site', 'shamojee.com', 'migrate']
      prog_name = 'bench'
      complete_var = None
      standalone_mode = True
      windows_expand_args = True
      extra = {}
      ctx = <click.core.Context object at 0x7f6ebc2cbfa0>
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
      _process_result = <function MultiCommand.invoke.<locals>._process_result at 0x7f6ebbb56200>
      args = ['migrate']
      cmd_name = 'frappe'
      cmd = <Group frappe>
      sub_ctx = <click.core.Context object at 0x7f6eba594850>
      ctx = <click.core.Context object at 0x7f6ebc2cbfa0>
      self = <Group None>
      __class__ = <class 'click.core.MultiCommand'>
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
      _process_result = <function MultiCommand.invoke.<locals>._process_result at 0x7f6eba549900>
      args = []
      cmd_name = 'migrate'
      cmd = <Command migrate>
      sub_ctx = <click.core.Context object at 0x7f6eba594c10>
      ctx = <click.core.Context object at 0x7f6eba594850>
      self = <Group frappe>
      __class__ = <class 'click.core.MultiCommand'>
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
      self = <Command migrate>
      ctx = <click.core.Context object at 0x7f6eba594c10>
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 783, in invoke
    return __callback(*args, **kwargs)
      _Context__self = <click.core.Context object at 0x7f6eba594c10>
      _Context__callback = <function migrate at 0x7f6ebbb85ea0>
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      ctx = <click.core.Context object at 0x7f6eba594c10>
  File ""/home/frappe/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py"", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      f = <function migrate at 0x7f6ebbb85c60>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/commands/__init__.py"", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
      ctx = <click.core.Context object at 0x7f6eba594c10>
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      profile = False
      f = <function migrate at 0x7f6ebbb85bd0>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/commands/site.py"", line 616, in migrate
    SiteMigration(
      context = {'sites': ['shamojee.com'], 'force': False, 'verbose': False, 'profile': False}
      skip_failing = False
      skip_search_index = False
      activate_by_import = <module 'traceback_with_variables.activate_by_import' from '/home/frappe/frappe-bench/env/lib/python3.10/site-packages/traceback_with_variables/activate_by_import.py'>
      SiteMigration = <class 'frappe.migrate.SiteMigration'>
      site = 'shamojee.com'
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 186, in run
    self.run_schema_updates()
      self = <frappe.migrate.SiteMigration object at 0x7f6eba594b20>
      site = 'shamojee.com'
      filelock = <function filelock at 0x7f6eb8fb9f30>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 52, in wrapper
    raise e
      args = (<frappe.migrate.SiteMigration object at 0x7f6eba594b20>,)
      kwargs = {}
      method = <function SiteMigration.run_schema_updates at 0x7f6eb8fb9b40>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 44, in wrapper
    ret = method(*args, **kwargs)
      args = (<frappe.migrate.SiteMigration object at 0x7f6eba594b20>,)
      kwargs = {}
      method = <function SiteMigration.run_schema_updates at 0x7f6eb8fb9b40>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 121, in run_schema_updates
    frappe.modules.patch_handler.run_all(
      self = <frappe.migrate.SiteMigration object at 0x7f6eba594b20>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 76, in run_all
    run_patch(patch)
      patch_type = <PatchType.post_model_sync: 'post_model_sync'>
      executed = {""execute:frappe.delete_doc_if_exists('Workspace', 'ERPNext Integrations Settings')"", 'erpnext.patches.v12_0.rename_lost_reason_detail', 'frappe.patches.v14_0.different_encryption_key', 'erpnext.patches.v13_0.update_start_end_date_for_old_shift_assignment', 'erpnext.patches.v12_0.set_job_offer_applicant_email', 'frappe.patches.v15_0.copy_disable_prepared_report_to_prepared_report', 'erpnext.patches.v13_0.enable_provisional_accounting', 'erpnext.patches.v13_0.trim_sales_invoice_custom_field_length', 'erpnext.patches.v15_0.rename_purchase_receipt_amount_to_purchase_amount', 'erpnext.patches.v12_0.rename_pricing_rule_child_doctypes', 'erpnext.patches.v12_0.add_taxjar_integration_field', 'erpnext.patches.v13_0.setup_uae_vat_fields', 'frappe.patches.v13_0.increase_password_length', 'frappe.patches.v11_0.set_allow_self_approval_in_workflow', 'frappe.patches.v12_0.remove_feedback_rating', 'erpnext.patches.v12_0.set_italian_import_supplier_invoice_permissions', 'execute:frappe.utils.global_sea...
      run_patch = <function run_all.<locals>.run_patch at 0x7f6eb7f82050>
      patches = [""execute:frappe.get_doc('Role', 'Guest').save() # remove desk access"", 'frappe.core.doctype.role.patches.v13_set_default_desk_properties', 'frappe.patches.v14_0.update_workspace2 # 06.06.2023', 'frappe.patches.v14_0.drop_data_import_legacy', 'frappe.patches.v14_0.copy_mail_data #08.03.21', 'frappe.patches.v14_0.update_github_endpoints #08-11-2021', 'frappe.patches.v14_0.remove_db_aggregation', 'frappe.patches.v14_0.update_color_names_in_kanban_board_column', 'frappe.patches.v14_0.update_is_system_generated_flag', 'frappe.patches.v14_0.update_auto_account_deletion_duration', 'frappe.patches.v14_0.update_integration_request', 'frappe.patches.v14_0.set_document_expiry_default', 'frappe.patches.v14_0.delete_data_migration_tool', 'frappe.patches.v14_0.set_suspend_email_queue_default', 'frappe.patches.v14_0.different_encryption_key', 'frappe.patches.v14_0.update_multistep_webforms', ""execute:frappe.delete_doc('Page', 'background_jobs', ignore_missing=True, force=True)"", 'frappe.patches.v14_...
      patch = 'erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1'
      skip_failing = False
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 62, in run_patch
    if not run_single(patchmodule=patch):
      patch = 'erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1'
      skip_failing = False
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 152, in run_single
    return execute_patch(patchmodule, method, methodargs)
      patchmodule = 'erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1'
      method = None
      methodargs = None
      force = False
      conf = <LocalProxy unbound>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 188, in execute_patch
    _patch()
      patchmodule = 'erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1'
      method = None
      methodargs = None
      has_patch_file = True
      patch = 'erpnext.patches.v15_0.add_disassembly_order_stock_entry_type.execute'
      docstring = ''
      _patch = <function execute at 0x7f6eb7ab3d90>
      start_time = 940029.764886946
  File ""/home/frappe/frappe-bench/apps/erpnext/erpnext/patches/v15_0/add_disassembly_order_stock_entry_type.py"", line 6, in execute
    frappe.get_doc(
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/model/document.py"", line 292, in insert
    self._validate()
      self = <StockEntryType: Disassemble>
      ignore_permissions = True
      ignore_links = None
      ignore_if_duplicate = False
      ignore_mandatory = None
      set_name = None
      set_child_names = True
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/model/document.py"", line 576, in _validate
    self._validate_selects()
      self = <StockEntryType: Disassemble>
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/model/base_document.py"", line 886, in _validate_selects
    frappe.throw(
      self = <StockEntryType: Disassemble>
      df = <SelectDocField: purpose parent=Stock Entry Type>
      options = ['Material Issue', 'Material Receipt', 'Material Transfer', 'Material Transfer for Manufacture', 'Material Consumption for Manufacture', 'Manufacture', 'Repack', 'Send to Subcontractor']
      value = 'Disassemble'
      prefix = ''
      label = 'Purpose'
      comma_options = 'Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor'
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/__init__.py"", line 652, in throw
    msgprint(
      msg = ' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""'
      exc = <class 'frappe.exceptions.ValidationError'>
      title = None
      is_minimizable = False
      wide = False
      as_list = False
      primary_action = None
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/__init__.py"", line 617, in msgprint
    _raise_exception()
      title = None
      as_table = False
      as_list = False
      indicator = 'red'
      alert = False
      primary_action = None
      is_minimizable = False
      wide = False
      realtime = False
      sys = <module 'sys' (built-in)>
      _raise_exception = <function msgprint.<locals>._raise_exception at 0x7f6eb7ab3520>
      msg = ' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""'
      out = {'message': ' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""', 'title': 'Message', 'indicator': 'red', 'raise_exception': 1, '__frappe_exc_id': 'f39b975f316ce355fc4fc8e63fde5e7f4dc4a43907d60474840779dc'}
      raise_exception = <class 'frappe.exceptions.ValidationError'>
      ...skipped... 1 vars
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/__init__.py"", line 568, in _raise_exception
    raise exc
      exc = ValidationError(' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""')
      msg = ' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""'
      out = {'message': ' Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""', 'title': 'Message', 'indicator': 'red', 'raise_exception': 1, '__frappe_exc_id': 'f39b975f316ce355fc4fc8e63fde5e7f4dc4a43907d60474840779dc'}
      raise_exception = <class 'frappe.exceptions.ValidationError'>
      ...skipped... 1 vars
frappe.exceptions.ValidationError:  Purpose cannot be ""Disassemble"". It should be one of ""Material Issue"", ""Material Receipt"", ""Material Transfer"", ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"", ""Manufacture"", ""Repack"", ""Send to Subcontractor""
frappe@vmi779817:~/frappe-bench$
```
",zahidmansoor,2024-09-13 13:01:52+00:00,[],2025-01-30 00:09:57+00:00,2025-01-15 11:45:32+00:00,https://github.com/frappe/erpnext/issues/43215,"[('bug', None)]","[{'comment_id': 2349288143, 'issue_id': 2524797480, 'author': 'zahidmansoor', 'body': 'The patch below causes this error. Kindly help me to fix it.\r\nfrappe/frappe-bench/apps/erpnext/erpnext/patches/v15_0/__pycache__/add_disassembly_order_stock_entry_type.cpython-310.pyc', 'created_at': datetime.datetime(2024, 9, 13, 16, 1, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2351686536, 'issue_id': 2524797480, 'author': 'akashdubey22', 'body': 'Modify the Patch: \r\n\r\nYou will need to modify the patch file to ensure that it does not attempt to set an invalid value. Navigate to the patch file located at /home/frappe/frappe-bench/apps/erpnext/erpnext/patches/v15_0/add_disassembly_order_stock_entry_type.py and adjust the logic to use a valid ""Purpose"" value or skip the operation if ""Disassemble"" is not allowed.\r\n\r\nJust replace the following code and save..\r\n\r\n```\r\nimport frappe\r\nfrom frappe import _\r\n\r\ndef execute():\r\n    try:\r\n        # Check if \'Disassemble\' is a valid purpose before proceeding\r\n        valid_purposes = [\r\n            ""Material Issue"", ""Material Receipt"", ""Material Transfer"",\r\n            ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"",\r\n            ""Manufacture"", ""Repack"", ""Send to Subcontractor""\r\n        ]\r\n\r\n        # If \'Disassemble\' is not valid, skip this operation\r\n        if ""Disassemble"" not in valid_purposes:\r\n            frappe.log_error(_(""Skipping patch: \'Disassemble\' is not a valid purpose""), ""Patch Skipped"")\r\n            return\r\n\r\n        # Proceed with creating the stock entry type if valid\r\n        frappe.get_doc({\r\n            ""doctype"": ""Stock Entry Type"",\r\n            ""name"": ""Disassemble"",\r\n            ""purpose"": ""Disassemble""\r\n        }).insert(ignore_permissions=True)\r\n\r\n    except frappe.ValidationError as e:\r\n        frappe.log_error(message=str(e), title=_(""Validation Error in Patch""))\r\n        # Optionally, handle the exception or re-raise it\r\n        raise\r\n```\r\n\r\nThen try these commands ...\r\nbench --site your-site-name execute erpnext.patches.v15_0.add_disassembly_order_stock_entry_type.execute\r\nbench update --patch', 'created_at': datetime.datetime(2024, 9, 15, 17, 20, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2379209099, 'issue_id': 2524797480, 'author': 'zahidmansoor', 'body': 'I have proceeded with your command but it does not allow me to do bench update because it gives an error that you have committed local changes', 'created_at': datetime.datetime(2024, 9, 27, 12, 50, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2379227307, 'issue_id': 2524797480, 'author': 'akashdubey22', 'body': '> I have proceeded with your command but it does not allow me to do bench update because it gives an error that you have committed local changes\r\n\r\n1. Changed code in file ?\r\n2. Used exact bench update command for running patch only ?', 'created_at': datetime.datetime(2024, 9, 27, 12, 59, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2423624842, 'issue_id': 2524797480, 'author': 'happypotter1993', 'body': 'I am trying to do this in FrappeCloud, restoring a new site from backup. \r\nI am getting this same error :\r\n\r\nExecuting erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1 in  (_d1beae7343f9ce26)\r\n....\r\nfrappe.exceptions.ValidationError:  Purpose cannot be ""Disassemble"". It should be one of """", ""Send to Warehouse"", ""Material Transfer""\r\n\r\n\r\nI can\'t edit the Stock Entry Type - Purpose field, I get this error - \r\nYou can\'t set \'Options\' for field Purpose\r\n\r\n\r\nCan you please help me @akashdubey22  ?', 'created_at': datetime.datetime(2024, 10, 19, 6, 56, 36, tzinfo=datetime.timezone.utc)}]","zahidmansoor (Issue Creator) on (2024-09-13 16:01:21 UTC): The patch below causes this error. Kindly help me to fix it.
frappe/frappe-bench/apps/erpnext/erpnext/patches/v15_0/__pycache__/add_disassembly_order_stock_entry_type.cpython-310.pyc

akashdubey22 on (2024-09-15 17:20:51 UTC): Modify the Patch: 

You will need to modify the patch file to ensure that it does not attempt to set an invalid value. Navigate to the patch file located at /home/frappe/frappe-bench/apps/erpnext/erpnext/patches/v15_0/add_disassembly_order_stock_entry_type.py and adjust the logic to use a valid ""Purpose"" value or skip the operation if ""Disassemble"" is not allowed.

Just replace the following code and save..

```
import frappe
from frappe import _

def execute():
    try:
        # Check if 'Disassemble' is a valid purpose before proceeding
        valid_purposes = [
            ""Material Issue"", ""Material Receipt"", ""Material Transfer"",
            ""Material Transfer for Manufacture"", ""Material Consumption for Manufacture"",
            ""Manufacture"", ""Repack"", ""Send to Subcontractor""
        ]

        # If 'Disassemble' is not valid, skip this operation
        if ""Disassemble"" not in valid_purposes:
            frappe.log_error(_(""Skipping patch: 'Disassemble' is not a valid purpose""), ""Patch Skipped"")
            return

        # Proceed with creating the stock entry type if valid
        frappe.get_doc({
            ""doctype"": ""Stock Entry Type"",
            ""name"": ""Disassemble"",
            ""purpose"": ""Disassemble""
        }).insert(ignore_permissions=True)

    except frappe.ValidationError as e:
        frappe.log_error(message=str(e), title=_(""Validation Error in Patch""))
        # Optionally, handle the exception or re-raise it
        raise
```

Then try these commands ...
bench --site your-site-name execute erpnext.patches.v15_0.add_disassembly_order_stock_entry_type.execute
bench update --patch

zahidmansoor (Issue Creator) on (2024-09-27 12:50:23 UTC): I have proceeded with your command but it does not allow me to do bench update because it gives an error that you have committed local changes

akashdubey22 on (2024-09-27 12:59:41 UTC): 1. Changed code in file ?
2. Used exact bench update command for running patch only ?

happypotter1993 on (2024-10-19 06:56:36 UTC): I am trying to do this in FrappeCloud, restoring a new site from backup. 
I am getting this same error :

Executing erpnext.patches.v15_0.add_disassembly_order_stock_entry_type #1 in  (_d1beae7343f9ce26)
....
frappe.exceptions.ValidationError:  Purpose cannot be ""Disassemble"". It should be one of """", ""Send to Warehouse"", ""Material Transfer""


I can't edit the Stock Entry Type - Purpose field, I get this error - 
You can't set 'Options' for field Purpose


Can you please help me @akashdubey22  ?

"
2523875434,issue,open,,Stock Settings : Update Existing Price List Rate,"### Information about bug

The Setting in
Stock Settings : Update Existing Price List Rate
does not seems working while passing Purchase Order, Purchase Receipt, Purchase Invoice, Sales Order, Delivery Nore, Sales Invoice

The Item price List is not getting Updated.

### Module

buying

### Version

ERPNext: v15.34.0 (HEAD)
Frappe Framework: v15.40.0 (HEAD)
Frappe HR: v15.28.2 (HEAD)
India Compliance: v15.13.2 (HEAD)
Payments: v0.0.1 (HEAD)
Print Designer: v1.4.2 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",nitin-anantpranali,2024-09-13 04:57:22+00:00,[],2024-10-28 07:34:40+00:00,,https://github.com/frappe/erpnext/issues/43200,"[('bug', None)]","[{'comment_id': 2351999015, 'issue_id': 2523875434, 'author': 'Nihantra-Patel', 'body': 'Hi, Kindly upgrade your version 15 because everything is working fine. No problems were encountered in the latest version 15. \r\n\r\nWe tested the purchase and sales flow, we haven\'t found the issue.\r\n\r\nIf you want to update the Item Price then you have to update the rate in ""price list rate"" field, not in the ""rate"" field.\r\n\r\n\r\nhttps://github.com/user-attachments/assets/892c9741-2301-43bb-b802-105b1063c3b7\r\n\r\n\r\nhttps://github.com/user-attachments/assets/39d81a9b-5638-4460-8f82-5777c001a31d', 'created_at': datetime.datetime(2024, 9, 16, 4, 27, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2394320449, 'issue_id': 2523875434, 'author': 'sliwkawsieci', 'body': ""@Nihantra-Patel \r\nI don't know if this is the same issue but probably yes. \r\nPO created from SO is not created with correct price list.\r\n\r\nhttps://github.com/user-attachments/assets/1558d961-efb8-4585-9de3-a0b5128e918c"", 'created_at': datetime.datetime(2024, 10, 4, 18, 16, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2396361178, 'issue_id': 2523875434, 'author': 'Nihantra-Patel', 'body': ""Hi @sliwkawsieci, your video is not proper. didn't understand your video because it was not a proper shoot.\r\n\r\nAnd @nitin-anantpranali, any updates? Otherwise we'll close the issue, because we haven't found the problem. And no update from you. So please give an update on it."", 'created_at': datetime.datetime(2024, 10, 7, 9, 11, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2396420159, 'issue_id': 2523875434, 'author': 'sliwkawsieci', 'body': 'Hi @Nihantra-Patel maybe I will quickly describe it. \r\nWhen I am creating PO(Buying is in currency PLN) from Sales order(Sales was done in EUR) it is not picking pricel list buying(Zakupy in polish). \r\nInstead of that it looks like it is just inserting name of buy item price and not using that. \r\nFor example:\r\n\r\nEUR/PLN = 4,32\r\nSales price is 596,16 EUR\r\nPurchace price is 1000 PLN\r\n\r\nBut instead of taking price 1000 PLN program is doing some wierd calcultation. Looks like it is making something like below\r\n596,16/4,32 = 138 EUR\r\nThan after 1 sec. it is changing EUR into PLN and in the end we see 138 PLN.', 'created_at': datetime.datetime(2024, 10, 7, 9, 37, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2396485024, 'issue_id': 2523875434, 'author': 'Nihantra-Patel', 'body': ""@sliwkawsieci, Your issue is different; it's not a relevant issue with updating the existing price list rate."", 'created_at': datetime.datetime(2024, 10, 7, 10, 6, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2396593731, 'issue_id': 2523875434, 'author': 'sliwkawsieci', 'body': 'Sorry forgot to mention that in the end price list for buying is updated with that wrong value 138 PLN', 'created_at': datetime.datetime(2024, 10, 7, 10, 57, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2439838660, 'issue_id': 2523875434, 'author': 'amrit-citrusleaf', 'body': '> Hi, Kindly upgrade your version 15 because everything is working fine. No problems were encountered in the latest version 15. \n> \n> We tested the purchase and sales flow, we haven\'t found the issue.\n> \n> If you want to update the Item Price then you have to update the rate in ""price list rate"" field, not in the ""rate"" field.\n> \n> \n> https://github.com/user-attachments/assets/892c9741-2301-43bb-b802-105b1063c3b7\n> \n> \n> https://github.com/user-attachments/assets/39d81a9b-5638-4460-8f82-5777c001a31d\n> \n> \n\nI believe version 14 is being maintained till December 2024, right?   So why can\'t we raise issues related to version 14?', 'created_at': datetime.datetime(2024, 10, 27, 4, 18, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2440756127, 'issue_id': 2523875434, 'author': 'sliwkawsieci', 'body': 'Hi @amrit-citrusleaf , thank you for your input. \r\nI have version 15. I have also created new ERPnext instance and it works the same. The scenario you have presented are not like I wrote.\r\n\r\nIf you want to replicate issue than please make belowe steps:\r\n1) create itemprice for item XXX for  sail in EUR and buying in INR\r\n2) Create Sales Order with XXX that is done in EUR\r\n3) firectly from Sales Order click create-> Purchase order\r\n4) here you see the price is Wrong.', 'created_at': datetime.datetime(2024, 10, 28, 7, 34, 39, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-16 04:27:12 UTC): Hi, Kindly upgrade your version 15 because everything is working fine. No problems were encountered in the latest version 15. 

We tested the purchase and sales flow, we haven't found the issue.

If you want to update the Item Price then you have to update the rate in ""price list rate"" field, not in the ""rate"" field.


https://github.com/user-attachments/assets/892c9741-2301-43bb-b802-105b1063c3b7


https://github.com/user-attachments/assets/39d81a9b-5638-4460-8f82-5777c001a31d

sliwkawsieci on (2024-10-04 18:16:56 UTC): @Nihantra-Patel 
I don't know if this is the same issue but probably yes. 
PO created from SO is not created with correct price list.

https://github.com/user-attachments/assets/1558d961-efb8-4585-9de3-a0b5128e918c

Nihantra-Patel on (2024-10-07 09:11:53 UTC): Hi @sliwkawsieci, your video is not proper. didn't understand your video because it was not a proper shoot.

And @nitin-anantpranali, any updates? Otherwise we'll close the issue, because we haven't found the problem. And no update from you. So please give an update on it.

sliwkawsieci on (2024-10-07 09:37:57 UTC): Hi @Nihantra-Patel maybe I will quickly describe it. 
When I am creating PO(Buying is in currency PLN) from Sales order(Sales was done in EUR) it is not picking pricel list buying(Zakupy in polish). 
Instead of that it looks like it is just inserting name of buy item price and not using that. 
For example:

EUR/PLN = 4,32
Sales price is 596,16 EUR
Purchace price is 1000 PLN

But instead of taking price 1000 PLN program is doing some wierd calcultation. Looks like it is making something like below
596,16/4,32 = 138 EUR
Than after 1 sec. it is changing EUR into PLN and in the end we see 138 PLN.

Nihantra-Patel on (2024-10-07 10:06:25 UTC): @sliwkawsieci, Your issue is different; it's not a relevant issue with updating the existing price list rate.

sliwkawsieci on (2024-10-07 10:57:27 UTC): Sorry forgot to mention that in the end price list for buying is updated with that wrong value 138 PLN

amrit-citrusleaf on (2024-10-27 04:18:06 UTC): I believe version 14 is being maintained till December 2024, right?   So why can't we raise issues related to version 14?

sliwkawsieci on (2024-10-28 07:34:39 UTC): Hi @amrit-citrusleaf , thank you for your input. 
I have version 15. I have also created new ERPnext instance and it works the same. The scenario you have presented are not like I wrote.

If you want to replicate issue than please make belowe steps:
1) create itemprice for item XXX for  sail in EUR and buying in INR
2) Create Sales Order with XXX that is done in EUR
3) firectly from Sales Order click create-> Purchase order
4) here you see the price is Wrong.

"
2522312129,issue,open,,"""Set Operating Cost / Scrape Items From Sub-assemblies"" option does not work","### Information about bug

In Manufacturing Setting, there is a Check Box of ""Set Operating Cost / Scrape Items From Sub-assemblies"" which is added for adding operation cost to be added in item valuation without creating Job card.

I have tested this functionality and observed that when this check box is ticked, functionality is not working.
When unchecked, its working properly. 

This is working exactly reverse, I think naming should be changed to avoid confusion in Manufacturing setting.

### Module

manufacturing

### Version

ERPNext: v15.30.0 (version-15)

Frappe Framework: v15.35.0 (version-15)

<img width=""1307"" alt=""image"" src=""https://github.com/user-attachments/assets/42d1ad5f-8d45-46d9-a64b-ffd104058387"">


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",satisharalkar,2024-09-12 12:50:37+00:00,[],2024-09-12 12:50:37+00:00,,https://github.com/frappe/erpnext/issues/43197,"[('bug', None)]",[],
2522301947,issue,open,,Balance sheet omits certain accounts,"### Information about bug

We are having issues with Accounts (at least to our understanding) randomly disappearing. We have booked a transaction into an equity account  via a journal entry and it clearly shows up in the Trial Balance. However, in the Balance Sheet it doesn't show up. Find attached a couple of screenshots to understand the situation.

**Balance sheet selection:**

![selection](https://github.com/user-attachments/assets/7244844b-5d2c-4a14-97f3-f5b7618bd39c)

**Balance Sheet result:**

![bs](https://github.com/user-attachments/assets/db983e23-6506-4a4b-90b9-3bf770a558d0)

**Trial Balance selection:**

![trialbalance selection](https://github.com/user-attachments/assets/2a157313-6553-4c86-9bad-f685e1f9b45e)

**Trial Balance accounts showing up:**

![trialbalance_equity_accounts](https://github.com/user-attachments/assets/da5644cb-cfca-4686-8fa9-adf59e0455b7)

**Journal Entry with the posting:**

![journalentry](https://github.com/user-attachments/assets/20e3c24a-44ff-41c9-b733-4ff68648544b)


**Account information as registered in Accounts doctype:**
![image](https://github.com/user-attachments/assets/0c66b5a7-2051-47f9-ab5c-8bf6438a679f)
 

### Module

accounts

### Version

ERPNext: v15.17.1
Frappe Framework: v15.17.3
Frappe HR: v15.14.1

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",Libermentix,2024-09-12 12:46:36+00:00,[],2024-09-12 12:59:02+00:00,,https://github.com/frappe/erpnext/issues/43196,"[('bug', None)]",[],
2522183314,issue,open,,"Use Bank Account from Bank Statement Import form, rather than requiring Bank Account column in imported CSV","**Is your feature request related to a problem? Please describe.**
When importing a bank statement with the Bank Statement Import tool, there is a required field on the form for ""Bank Account."" But if you try to import a CSV file which does not have a column titled Bank Account, with the same value in every cell, you get an error ""Please add the Bank Account column."" That means you have to manually open every CSV you've downloaded from the bank website, add the column and populate those values. This is time consuming and seems unnecessary.
![Screenshot 2024-09-12 060527](https://github.com/user-attachments/assets/0557c608-3128-47e6-8bdb-395ad657e907)
![Screenshot 2024-09-12 060503](https://github.com/user-attachments/assets/409229d8-8a82-41da-a471-4c30eb6fe679)


**Describe the solution you'd like**
Possible solutions would be
1. Do not accept a bank account column in the CSV, and assign the Bank Account entered in the form to all transactions.
2. Allow a bank account column in the CSV (in case someone wants to import transactions across multiple bank accounts in a single file), but default to the form's Bank Account field if the column is missing or the column has no value for a given row.

I imagine the first option would work fine for 95% of users, and the 2nd would work for everyone but be a little less intuitive.

**Additional context**
Using ERPNext v15.34.1.",mepoland,2024-09-12 11:52:41+00:00,[],2024-09-12 12:08:11+00:00,,https://github.com/frappe/erpnext/issues/43193,"[('feature-request', None)]",[],
2521930441,issue,closed,completed, Invalid Date %% is not a valid date string.,"### Information about bug

Created Accounting Dimension for sales  invoice, when i try to create a sales invoice getting the error as above.

### Module

accounts

### Version

ERPNext: v15.34.2 (version-15)

Frappe Framework: v15.40.3 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Invalid Date
%% is not a valid date string.
```
",manyam0258,2024-09-12 10:00:26+00:00,[],2024-09-27 00:10:25+00:00,2024-09-12 10:16:14+00:00,https://github.com/frappe/erpnext/issues/43190,"[('bug', None)]","[{'comment_id': 2345834628, 'issue_id': 2521930441, 'author': 'manyam0258', 'body': 'solved', 'created_at': datetime.datetime(2024, 9, 12, 10, 10, 12, tzinfo=datetime.timezone.utc)}]","manyam0258 (Issue Creator) on (2024-09-12 10:10:12 UTC): solved

"
2520708039,issue,closed,completed,Use real time asset value from GL Entries for asset transactions,"**Add `asset_id` to GL Entries:**
- Introduce a new field asset_id in GL entries to store a reference to the associated asset.
- Ensure that this field is populated for all asset-related transactions, including:

> Asset Depreciation
> Asset Capitalization.
> Asset Repair.
> Asset Revaluation.
> Asset Sale.

**Remove pre-calculated depreciation schedule:**
- Modify the existing depreciation logic to calculate depreciation dynamically at the moment it's needed, based on the asset value retrieved from GL entries.
- Upcoming depreciation can be pre-calculated and booked through background jobs.

**Depreciation schedule button:**

- Add a button on the Asset form that generates the depreciation schedule based on the current asset value when clicked.

**Base all asset transactions on current asset value from GL Entries:**

- Asset repair, maintenance, revaluation, and other transactions should utilize the current asset value from GL entries.",khushi8112,2024-09-11 20:32:24+00:00,[],2025-02-06 00:10:12+00:00,2025-01-22 07:25:07+00:00,https://github.com/frappe/erpnext/issues/43179,"[('feature-request', None)]",[],
2519285724,issue,closed,completed,Bug - Item - variant can create single variant skipping item attribute,"### Information about bug

Hi Team,

There is an issue with Item Variants, it is possible to skip Item Attributes while using creating Single Variants. This seems like a bug as this option is not available while creating multiple variants.

If this is new process in ERPNext there should be an option to set mandatory attributes in the Variant template or else wouldn't this make way for users creating item variants with the wrong attributes?

### Module

stock

### Version

ERPNext: v15.34.0
Frappe Framework: v15.39.2

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",bibinqcs,2024-09-11 10:09:40+00:00,[],2024-10-03 00:10:13+00:00,2024-09-16 03:58:04+00:00,https://github.com/frappe/erpnext/issues/43173,"[('bug', None)]","[{'comment_id': 2345350674, 'issue_id': 2519285724, 'author': 'Nihantra-Patel', 'body': ""There are two main types of variant features to handle product options:\r\n\r\n1. **Single Variant**: This feature is used when you want to offer a product with just one attribute, such as color, without needing to specify other attributes like size. For instance, if a customer wants to select a product only by color and doesn't care about size, the Single Variant feature will handle this scenario effectively.\r\n\r\n2. **Multiple Variant**: This feature is used when you need to offer products with multiple attributes, such as both color and size. With Multiple Variant, you can create combinations of attributes, allowing customers to select from a variety of options. For example, if you want to offer a product in different colors and sizes, the Multiple Variant feature will manage these combinations.\r\n\r\nCurrently, if you want to create multiple options for color alone, it is managed under the Single Variant feature. However, if you need to handle more complex combinations involving multiple attributes, such as color and size together, the Multiple Variant feature is the appropriate choice."", 'created_at': datetime.datetime(2024, 9, 12, 6, 8, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2345637906, 'issue_id': 2519285724, 'author': 'bibinqcs', 'body': 'Thank you for the reply, is there plan to make some attributes mandatory?', 'created_at': datetime.datetime(2024, 9, 12, 8, 38, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2345642959, 'issue_id': 2519285724, 'author': 'Nihantra-Patel', 'body': 'There are currently no plans.', 'created_at': datetime.datetime(2024, 9, 12, 8, 40, 51, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-12 06:08:45 UTC): There are two main types of variant features to handle product options:

1. **Single Variant**: This feature is used when you want to offer a product with just one attribute, such as color, without needing to specify other attributes like size. For instance, if a customer wants to select a product only by color and doesn't care about size, the Single Variant feature will handle this scenario effectively.

2. **Multiple Variant**: This feature is used when you need to offer products with multiple attributes, such as both color and size. With Multiple Variant, you can create combinations of attributes, allowing customers to select from a variety of options. For example, if you want to offer a product in different colors and sizes, the Multiple Variant feature will manage these combinations.

Currently, if you want to create multiple options for color alone, it is managed under the Single Variant feature. However, if you need to handle more complex combinations involving multiple attributes, such as color and size together, the Multiple Variant feature is the appropriate choice.

bibinqcs (Issue Creator) on (2024-09-12 08:38:16 UTC): Thank you for the reply, is there plan to make some attributes mandatory?

Nihantra-Patel on (2024-09-12 08:40:51 UTC): There are currently no plans.

"
2518796074,issue,closed,completed,Issue in stock ledger Invariant ledger affecting Gross profit and incoming rate,"### Information about bug

![image](https://github.com/user-attachments/assets/630c7b54-5f0f-4129-b194-19d0f8e72efb)

As described in above image if there is an item which comes in and goes out from the stock the incoming rate will be proper while item is coming in but when same item goes out. the system is taking initial incoming rate and the gross profit is calculated based on wrong incoming rate of the item. 

in above example the item was first bought at 72 and sold 
again it was bought 2nd time at 44 and sold in this scenario the system is taking 72 as incoming rate where it should have taken 44 as incoming rate. 
same is happening in next set of transaction.

as a result the incoming value in gross profit report and delivery note is fetched wrong. showing wrong profit margin

![image](https://github.com/user-attachments/assets/712ca738-e64d-4604-b41e-4be250cd341b)


### Module

stock, buying, selling

### Version

ERPNext: v14.60.1 (version-14)

Frappe Framework: v14.62.2 (version-14)

Frappe HR: v14.5.1 (version-14)

Payments: v0.0.1 (version-14)

Vector Customization: v0.0.1 (master)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",maveezmh,2024-09-11 07:23:35+00:00,['dj12djdjs'],2024-10-23 00:10:12+00:00,2024-10-08 10:47:52+00:00,https://github.com/frappe/erpnext/issues/43168,"[('bug', None)]","[{'comment_id': 2345321970, 'issue_id': 2518796074, 'author': 'maveezmh', 'body': '@dj12djdjs any possible solution for this?', 'created_at': datetime.datetime(2024, 9, 12, 5, 44, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2357503795, 'issue_id': 2518796074, 'author': 'maveezmh', 'body': 'Hey there, any solution for this?', 'created_at': datetime.datetime(2024, 9, 18, 5, 3, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2370855719, 'issue_id': 2518796074, 'author': 'maveezmh', 'body': '@ruthra-kumar', 'created_at': datetime.datetime(2024, 9, 24, 10, 14, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2394398618, 'issue_id': 2518796074, 'author': 'dj12djdjs', 'body': ""@maveezmh I've tested your above scenario using the Stock Ledger Invariance Check report on version:\r\nfrappe: 14.81.6\r\nerpnext: 14.74.3\r\n\r\nAnd it appears to be working correctly on that version. See screenshot.\r\n![image](https://github.com/user-attachments/assets/7fc40c97-e152-4152-ba73-217a165959cf)\r\n\r\n\r\nCan you confirm?"", 'created_at': datetime.datetime(2024, 10, 4, 19, 9, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2398977399, 'issue_id': 2518796074, 'author': 'maveezmh', 'body': '@dj12djdjs thanks for confirmation. i guess its issue in previous version. let me update the client site and check.', 'created_at': datetime.datetime(2024, 10, 8, 6, 41, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2399506798, 'issue_id': 2518796074, 'author': 'maveezmh', 'body': 'closing this issue as completed @dj12djdjs', 'created_at': datetime.datetime(2024, 10, 8, 10, 47, 49, tzinfo=datetime.timezone.utc)}]","maveezmh (Issue Creator) on (2024-09-12 05:44:44 UTC): @dj12djdjs any possible solution for this?

maveezmh (Issue Creator) on (2024-09-18 05:03:55 UTC): Hey there, any solution for this?

maveezmh (Issue Creator) on (2024-09-24 10:14:39 UTC): @ruthra-kumar

dj12djdjs (Assginee) on (2024-10-04 19:09:32 UTC): @maveezmh I've tested your above scenario using the Stock Ledger Invariance Check report on version:
frappe: 14.81.6
erpnext: 14.74.3

And it appears to be working correctly on that version. See screenshot.
![image](https://github.com/user-attachments/assets/7fc40c97-e152-4152-ba73-217a165959cf)


Can you confirm?

maveezmh (Issue Creator) on (2024-10-08 06:41:14 UTC): @dj12djdjs thanks for confirmation. i guess its issue in previous version. let me update the client site and check.

maveezmh (Issue Creator) on (2024-10-08 10:47:49 UTC): closing this issue as completed @dj12djdjs

"
2518769471,issue,open,,The POS system doesn't handle bundles correctly and results in insufficient stock levels.,"### Information about bug

Bundles have no effect on items in the POS system, so the number of bundles sold will not make a difference in the individual items themselves tell close the shift so you need to make a return
 
![image](https://github.com/user-attachments/assets/df0acb80-6db9-4bb4-b8ce-0f62c1e795ae)


### Module

stock, selling

### Version

ERPNext: v15.34.2 (version-15)
Frappe Framework: v15.40.3 (version-15)



### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",MhmedRjb,2024-09-11 07:13:52+00:00,[],2024-12-23 06:50:29+00:00,,https://github.com/frappe/erpnext/issues/43167,"[('bug', None), ('POS', None)]",[],
2518635350,issue,open,,Pricing Rules are not working properly,"Hi,

I have set the pricing rule for a item group Fruit Crushes and this is a mixed condition.

if the sum of all the fruit crushes

Conditions Below:

min 23 and max 33 then it should add a free item in simple words I am saying this 23+1

min 33 and max 3 then it should add 3 free items in simple words I am saying this 33+3

min 42 and max 50 then it should add 6 free items in simple words I am saying this 42+6

min 50 and no max limit then it should add 9 free items in simple words I am saying this 51+9

but in the given video I have shown that when I am working with the item which default UOM is pcs it is working perfect but if a item comes which default UOM is CTN and when I change that to PCS it adds up a new free item row that should not happen also it is not adding a free item row when i am working on UOM CTN as fruit crushes conversion is 12 pcs in 1 CTN and when I add 2 CTN it should a free item row which did not happen here.

https://drive.google.com/file/d/1AmV16iQ85bis7SLwZERP4Ak3w_tJxXHo/view?usp=sharing",Sunil-Codes,2024-09-11 06:21:16+00:00,['ruthra-kumar'],2024-09-12 04:32:05+00:00,,https://github.com/frappe/erpnext/issues/43166,"[('feature-request', None)]",[],
2518426511,issue,open,,Account Payable Summary Report : Default Value of ageing_based_on,"### Information about bug

Change is required for default value of ageing_based_on

Since current default value is Due Date, some of the entires that don't have any due date are ignored in the default view.
This shows wrong outstanding total in the first sight.

Change default value of ageing_based_on = Posting Date

### Module

accounts

### Version

Frappe - v15
Erpnext - v15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",akashdubey22,2024-09-11 04:24:25+00:00,[],2024-09-11 15:52:54+00:00,,https://github.com/frappe/erpnext/issues/43164,"[('bug', None)]","[{'comment_id': 2344051463, 'issue_id': 2518426511, 'author': 'akashdubey22', 'body': 'Please see for more comments here as the case is same ...\r\n\r\nhttps://github.com/frappe/erpnext/issues/43161#issuecomment-2344046641', 'created_at': datetime.datetime(2024, 9, 11, 15, 52, 53, tzinfo=datetime.timezone.utc)}]","akashdubey22 (Issue Creator) on (2024-09-11 15:52:53 UTC): Please see for more comments here as the case is same ...

https://github.com/frappe/erpnext/issues/43161#issuecomment-2344046641

"
2518426005,issue,open,,Account Payable Report : Default Value of ageing_based_on,"### Information about bug

Change is required for default value of ageing_based_on

Since current default value is Due Date, some of the entires that don't have any due date are ignored in the default view.
This shows wrong outstanding total in the first sight.

Change default value of ageing_based_on = Posting Date

### Module

accounts

### Version

Frappe - v15
Erpnext v15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",akashdubey22,2024-09-11 04:23:50+00:00,[],2024-09-11 15:52:37+00:00,,https://github.com/frappe/erpnext/issues/43163,"[('bug', None)]","[{'comment_id': 2344050777, 'issue_id': 2518426005, 'author': 'akashdubey22', 'body': 'Please see for more comments here as the case is same ...\r\n\r\nhttps://github.com/frappe/erpnext/issues/43161#issuecomment-2344046641', 'created_at': datetime.datetime(2024, 9, 11, 15, 52, 36, tzinfo=datetime.timezone.utc)}]","akashdubey22 (Issue Creator) on (2024-09-11 15:52:36 UTC): Please see for more comments here as the case is same ...

https://github.com/frappe/erpnext/issues/43161#issuecomment-2344046641

"
2518425000,issue,open,,Account Receivable Summary Report : Default Value of ageing_based_on,"### Information about bug

Change is required for default value of ageing_based_on

Since current default value is Due Date, some of the entires that don't have any due date are ignored in the default view.
This shows wrong outstanding total in the first sight.

Change default value of ageing_based_on = Posting Date

### Module

accounts

### Version

Frappe v15
Erpnext v15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",akashdubey22,2024-09-11 04:22:47+00:00,[],2024-09-11 15:52:22+00:00,,https://github.com/frappe/erpnext/issues/43162,"[('bug', None)]","[{'comment_id': 2344050336, 'issue_id': 2518425000, 'author': 'akashdubey22', 'body': 'Please see for more comments here as the case is same ...\r\n\r\nhttps://github.com/frappe/erpnext/issues/43161#issuecomment-2344046641', 'created_at': datetime.datetime(2024, 9, 11, 15, 52, 21, tzinfo=datetime.timezone.utc)}]","akashdubey22 (Issue Creator) on (2024-09-11 15:52:21 UTC): Please see for more comments here as the case is same ...

https://github.com/frappe/erpnext/issues/43161#issuecomment-2344046641

"
2518414678,issue,open,,Account Receivable Report : Default Value of ageing_based_on,"### Information about bug

Change is required for default value of ageing_based_on

Since current default value is Due Date, some of the entires that don't have any due date are ignored in the default view. 
This shows wrong outstanding total in the first sight.
 
Change default value of ageing_based_on = Posting Date

### Module

accounts

### Version

Frappe - v15
ERPNext - v15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",akashdubey22,2024-09-11 04:11:47+00:00,[],2024-09-11 15:50:38+00:00,,https://github.com/frappe/erpnext/issues/43161,"[('bug', None)]","[{'comment_id': 2343122039, 'issue_id': 2518414678, 'author': 'Nihantra-Patel', 'body': ""voucher will still be included in the Accounts Receivable (AR) / Accounts Payable (AP) report, even if there is no due date. If a voucher doesn't have a due date, it will automatically be categorized under the 0-30 days age group.\r\n\r\nCould you please provide the steps to replicate the issue where the voucher is not being reported? It’s possible that in your case, the voucher might not have any outstanding balance. Keep in mind that the AR/AP report will not show any vouchers that don't have an outstanding amount."", 'created_at': datetime.datetime(2024, 9, 11, 9, 26, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2344046641, 'issue_id': 2518414678, 'author': 'akashdubey22', 'body': 'The Grand Total of Outstanding is different when I change value of filter to Posting Date or Due Date.\r\n\r\nEarlier in v13, the default value of filter was Posting Date, and it was perfect to get the correct values in first sight without verifying correctness of the output.\r\n\r\nOn digging up more, the few possibility of getting lesser entries in table if we choose DUE DATE as the filter....\r\n1. Missing Due Date field in few types of JV Entries.\r\n2. Some of the entries that are not reconciled. Like payment entries that are not reconciled are shown as negative outstanding in Receivable Report.\r\n3. Few more types of entries other than the Sales Invoice, that effect receivable values.\r\n\r\nOverall, change in number of entries in the report is not a bug .... I see that if the filter value is Posting Date, it shows all the entries and shows correct outstanding figures as for Grand Total is concerned. \r\n\r\nThis case is similar for ..\r\n1. Accounts Receivable \r\n2. Accounts Receivable Summary\r\n3. Accounts Payable\r\n4. Accounts Payable Summary', 'created_at': datetime.datetime(2024, 9, 11, 15, 50, 36, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-11 09:26:37 UTC): voucher will still be included in the Accounts Receivable (AR) / Accounts Payable (AP) report, even if there is no due date. If a voucher doesn't have a due date, it will automatically be categorized under the 0-30 days age group.

Could you please provide the steps to replicate the issue where the voucher is not being reported? It’s possible that in your case, the voucher might not have any outstanding balance. Keep in mind that the AR/AP report will not show any vouchers that don't have an outstanding amount.

akashdubey22 (Issue Creator) on (2024-09-11 15:50:36 UTC): The Grand Total of Outstanding is different when I change value of filter to Posting Date or Due Date.

Earlier in v13, the default value of filter was Posting Date, and it was perfect to get the correct values in first sight without verifying correctness of the output.

On digging up more, the few possibility of getting lesser entries in table if we choose DUE DATE as the filter....
1. Missing Due Date field in few types of JV Entries.
2. Some of the entries that are not reconciled. Like payment entries that are not reconciled are shown as negative outstanding in Receivable Report.
3. Few more types of entries other than the Sales Invoice, that effect receivable values.

Overall, change in number of entries in the report is not a bug .... I see that if the filter value is Posting Date, it shows all the entries and shows correct outstanding figures as for Grand Total is concerned. 

This case is similar for ..
1. Accounts Receivable 
2. Accounts Receivable Summary
3. Accounts Payable
4. Accounts Payable Summary

"
2516952530,issue,open,,Valuation rate Incorrect when changing 'Backflush Raw Materials of Subcontract Based On',"### Information about bug

Facing issue in V15 with the Subcontracting Module.

When I pass an entry while the 'Backflush Raw Materials of Subcontract Based On' is set to 'BOM'
I get the following figures in Rate column
![image](https://github.com/user-attachments/assets/515115bb-7961-4d13-9863-ac6fcde0e46b)

But actually I want to change that setting of 'Backflush Raw Materials of Subcontract Based On' to 'Based on Consumption', and when I do that, the rate is changed to incorrect values as below
![image](https://github.com/user-attachments/assets/6f867af8-805c-4b0d-be9a-0f52f4ff4b5f)

Can someone from Frappe/ERPNext team please help with this, we are on production and unfortunately I am not having ERPNext support subscription.

### Module

buying

### Version

ERPNext: v15.34.0 (version-15)

Frappe Framework: v15.39.2 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",moizsami,2024-09-10 16:39:45+00:00,[],2024-09-10 16:39:45+00:00,,https://github.com/frappe/erpnext/issues/43159,"[('bug', None)]",[],
2516060606,issue,closed,completed,Server error: pymysql.err.ProgrammingError,"### Information about bug

Getting an error while creating a “payment entry” from the drop down menu of a “purchase invoice”. Please refer the screenshot attached for reference. 
![univ1](https://github.com/user-attachments/assets/bd943633-5da1-4dea-af93-9a6fb451f26a)


### Module

accounts, buying

### Version

""erpnext"": ""13.55.2"",
""frappe"": ""13.58.21""

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""erpnext"": ""13.55.2"",
	""frappe"": ""13.58.21""
}
```
### Route
```
Form/Payment Entry/new-payment-entry-2
```
### Traceback
```
Syntax error in query:
select sum(base_net_total) from `tabPurchase Order` where `name` in () order by modified desc limit 1
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 66, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 38, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 76, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1474, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/desk/form/save.py"", line 25, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 312, in save
    return self._save(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 334, in _save
    return self.insert()
  File ""apps/frappe/frappe/model/document.py"", line 263, in insert
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1059, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 943, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1267, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1249, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 940, in fn
    return method_object(*args, **kwargs)
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 82, in validate
    self.set_tax_withholding()
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 620, in set_tax_withholding
    order_amount = self.get_order_net_total()
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 676, in get_order_net_total
    doctype, {""name"": [""in"", docnames]}, [""sum(base_net_total)""]
  File ""apps/frappe/frappe/database/database.py"", line 482, in get_value
    limit=1,
  File ""apps/frappe/frappe/database/database.py"", line 553, in get_values
    limit=limit,
  File ""apps/frappe/frappe/database/database.py"", line 752, in _get_values_from_table
    update=update,
  File ""apps/frappe/frappe/database/database.py"", line 187, in sql
    self._cursor.execute(query, values)
  File ""env/lib/python3.7/site-packages/pymysql/cursors.py"", line 148, in execute
    result = self._query(query)
  File ""env/lib/python3.7/site-packages/pymysql/cursors.py"", line 310, in _query
    conn.query(q)
  File ""env/lib/python3.7/site-packages/pymysql/connections.py"", line 548, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File ""env/lib/python3.7/site-packages/pymysql/connections.py"", line 775, in _read_query_result
    result.read()
  File ""env/lib/python3.7/site-packages/pymysql/connections.py"", line 1156, in read
    first_packet = self.connection._read_packet()
  File ""env/lib/python3.7/site-packages/pymysql/connections.py"", line 725, in _read_packet
    packet.raise_for_error()
  File ""env/lib/python3.7/site-packages/pymysql/protocol.py"", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File ""env/lib/python3.7/site-packages/pymysql/err.py"", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, ""You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ') order by modified desc limit 1' at line 1"")

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""doc"": ""{\""owner\"":\""server@whitepearl.biz\"",\""idx\"":0,\""docstatus\"":0,\""naming_series\"":\""ACC-PAY-.YYYY.-\"",\""payment_type\"":\""Pay\"",\""payment_order_status\"":\""Initiated\"",\""posting_date\"":\""2024-09-10\"",\""company\"":\""University of Lunsar\"",\""party_type\"":\""Supplier\"",\""party\"":\""Whitepearl IT solutions pvt. ltd.\"",\""party_name\"":\""Whitepearl IT solutions pvt. ltd.\"",\""party_balance\"":-10774.43,\""paid_from\"":\""1110 - Cash - UOL\"",\""paid_from_account_currency\"":\""SLL\"",\""paid_from_account_balance\"":150000,\""paid_to\"":\""2110 - Creditors - UOL\"",\""paid_to_account_currency\"":\""SLL\"",\""paid_to_account_balance\"":0,\""paid_amount\"":10774.43,\""paid_amount_after_tax\"":0,\""source_exchange_rate\"":1,\""base_paid_amount\"":10774.43,\""base_paid_amount_after_tax\"":0,\""received_amount\"":10774.43,\""received_amount_after_tax\"":0,\""target_exchange_rate\"":1,\""base_received_amount\"":10774.43,\""base_received_amount_after_tax\"":0,\""total_allocated_amount\"":10774.43,\""base_total_allocated_amount\"":10774.43,\""unallocated_amount\"":0,\""difference_amount\"":0,\""apply_tax_withholding_amount\"":1,\""base_total_taxes_and_charges\"":0,\""total_taxes_and_charges\"":0,\""reference_date\"":\""2024-09-10\"",\""cost_center\"":\""Main - UOL\"",\""status\"":\""Draft\"",\""custom_remarks\"":0,\""letter_head\"":\""uol-letter head\"",\""doctype\"":\""Payment Entry\"",\""references\"":[{\""modified\"":\""2024-09-10 10:16:34.956672\"",\""modified_by\"":\""server@whitepearl.biz\"",\""parentfield\"":\""references\"",\""parenttype\"":\""Payment Entry\"",\""idx\"":1,\""docstatus\"":0,\""reference_doctype\"":\""Purchase Invoice\"",\""reference_name\"":\""ACC-PINV-2024-00001\"",\""due_date\"":\""2024-08-09\"",\""bill_no\"":\""39-08/2025\"",\""total_amount\"":10774.43,\""outstanding_amount\"":10774.43,\""allocated_amount\"":10774.43,\""exchange_rate\"":1,\""exchange_gain_loss\"":0,\""doctype\"":\""Payment Entry Reference\"",\""__islocal\"":1,\""parent\"":\""new-payment-entry-2\"",\""name\"":\""new-payment-entry-reference-2\""}],\""taxes\"":[],\""deductions\"":[],\""__islocal\"":1,\""__unsaved\"":1,\""name\"":\""new-payment-entry-2\"",\""__last_sync_on\"":\""2024-09-10T10:16:34.459Z\"",\""mode_of_payment\"":\""Cash\"",\""paid_from_account_type\"":\""Cash\"",\""tax_withholding_category\"":\""With holding tax 6.5%\"",\""reference_no\"":\""1345677777\""}"",
		""action"": ""Save""
	},
	""btn"": {
		""jQuery2240148155950403088931"": {
			""events"": {
				""click"": [
					{
						""type"": ""click"",
						""origType"": ""click"",
						""guid"": 2999,
						""namespace"": """"
					}
				]
			}
		}
	},
	""freeze"": true,
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.form.save.savedocs""
}
```
### Response Data
```
{
	""exception"": ""pymysql.err.ProgrammingError: (1064, \""You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ') order by modified desc limit 1' at line 1\"")""
}
```
```
",artspark,2024-09-10 10:34:14+00:00,[],2024-09-26 00:10:00+00:00,2024-09-11 06:46:10+00:00,https://github.com/frappe/erpnext/issues/43153,"[('bug', None)]","[{'comment_id': 2342615979, 'issue_id': 2516060606, 'author': 'Nihantra-Patel', 'body': ""If it's a bug, it hasn't been fixed in version 13 because they stopped fixing bugs for that version. It might still have problems. It's best to upgrade to version 14 or 15. But once you generate a [support ticket](https://support.frappe.io/) if the cloud plan has support."", 'created_at': datetime.datetime(2024, 9, 11, 4, 49, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2342678754, 'issue_id': 2516060606, 'author': 'artspark', 'body': 'Thank you @Nihantra-Patel \r\n\r\n1) How can I upgrade the version.\r\n\r\n2) Will the upgrade process remove any changes(custom form designs etc) that I made in version 13.\r\n\r\nThanks,\r\nDeepak', 'created_at': datetime.datetime(2024, 9, 11, 5, 50, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2342730540, 'issue_id': 2516060606, 'author': 'Nihantra-Patel', 'body': 'If there is any customization then first store it in your custom app. if minor changes (custom field etc.) then it will stored in the database so first you can take a backup.\r\n\r\nHow to Version Upgrade in Frappe Cloud?: https://frappecloud.com/docs/sites/version-upgrade', 'created_at': datetime.datetime(2024, 9, 11, 6, 25, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2342757642, 'issue_id': 2516060606, 'author': 'artspark', 'body': 'Thank you for the version upgrade link.\r\nCan you share a link that explains about custom app and how to store in it.\r\nYes, I have custom fields/doctypes and renamed doctypes. \r\nI have backed up the db, private and public files, JSON file.', 'created_at': datetime.datetime(2024, 9, 11, 6, 33, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2342784670, 'issue_id': 2516060606, 'author': 'Nihantra-Patel', 'body': 'You can search it on [Frappe Forum](https://discuss.frappe.io), and there are lots of posts.', 'created_at': datetime.datetime(2024, 9, 11, 6, 40, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2342794678, 'issue_id': 2516060606, 'author': 'artspark', 'body': 'Great! Thanks @Nihantra-Patel', 'created_at': datetime.datetime(2024, 9, 11, 6, 45, 27, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-11 04:49:40 UTC): If it's a bug, it hasn't been fixed in version 13 because they stopped fixing bugs for that version. It might still have problems. It's best to upgrade to version 14 or 15. But once you generate a [support ticket](https://support.frappe.io/) if the cloud plan has support.

artspark (Issue Creator) on (2024-09-11 05:50:47 UTC): Thank you @Nihantra-Patel 

1) How can I upgrade the version.

2) Will the upgrade process remove any changes(custom form designs etc) that I made in version 13.

Thanks,
Deepak

Nihantra-Patel on (2024-09-11 06:25:37 UTC): If there is any customization then first store it in your custom app. if minor changes (custom field etc.) then it will stored in the database so first you can take a backup.

How to Version Upgrade in Frappe Cloud?: https://frappecloud.com/docs/sites/version-upgrade

artspark (Issue Creator) on (2024-09-11 06:33:04 UTC): Thank you for the version upgrade link.
Can you share a link that explains about custom app and how to store in it.
Yes, I have custom fields/doctypes and renamed doctypes. 
I have backed up the db, private and public files, JSON file.

Nihantra-Patel on (2024-09-11 06:40:23 UTC): You can search it on [Frappe Forum](https://discuss.frappe.io), and there are lots of posts.

artspark (Issue Creator) on (2024-09-11 06:45:27 UTC): Great! Thanks @Nihantra-Patel

"
2515790613,issue,closed,completed,Missing HR Module ,"### Information about bug

Not able to find HR modules like Payroll, attendance etc, Tried searching in Search engine with various HR modules but could find only Employee List but rest all fields of HR is not there .
In the Modules section the whole HR module is not visible .

### Module

HR

### Version

14

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",rithika271999,2024-09-10 08:38:52+00:00,[],2024-10-05 00:10:08+00:00,2024-09-11 04:46:43+00:00,https://github.com/frappe/erpnext/issues/43145,"[('bug', None)]","[{'comment_id': 2340035639, 'issue_id': 2515790613, 'author': 'mohsinalimat', 'body': 'For version 14, if you need hrms then you must have to use below command.\n\n`bench get-app https://github.com/frappe/hrms --branch version-14`\n\n`bench --site sitename install-app hrms`', 'created_at': datetime.datetime(2024, 9, 10, 8, 41, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2342613152, 'issue_id': 2515790613, 'author': 'Nihantra-Patel', 'body': 'HR module has been separated in version 14 and 15 so you have to install it separately on the site. so follow the Mohsin Ali step.', 'created_at': datetime.datetime(2024, 9, 11, 4, 46, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2360010771, 'issue_id': 2515790613, 'author': 'rithika271999', 'body': 'Can you guide me through mohin Ali steps\r\nWhere can I find it ?\r\n\r\nOn Wed, 11 Sept 2024, 10:17 Nihantra C. Patel, ***@***.***>\r\nwrote:\r\n\r\n> HR module has been separated in version 14 and 15 so you have to install\r\n> it separately on the site. so follow the Mohsin Ali step.\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/frappe/erpnext/issues/43145#issuecomment-2342613152>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/BLFOL3FR4WPFFEHTYC46P2LZV7DMTAVCNFSM6AAAAABN6HDHAGVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDGNBSGYYTGMJVGI>\r\n> .\r\n> You are receiving this because you authored the thread.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 9, 19, 5, 29, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2360013466, 'issue_id': 2515790613, 'author': 'Nihantra-Patel', 'body': 'https://github.com/frappe/hrms?tab=readme-ov-file#installation\r\n\r\nExplore the Bench Commands Cheatsheet: https://frappeframework.com/docs/user/en/bench/resources/bench-commands-cheatsheet', 'created_at': datetime.datetime(2024, 9, 19, 5, 31, 21, tzinfo=datetime.timezone.utc)}]","mohsinalimat on (2024-09-10 08:41:35 UTC): For version 14, if you need hrms then you must have to use below command.

`bench get-app https://github.com/frappe/hrms --branch version-14`

`bench --site sitename install-app hrms`

Nihantra-Patel on (2024-09-11 04:46:43 UTC): HR module has been separated in version 14 and 15 so you have to install it separately on the site. so follow the Mohsin Ali step.

rithika271999 (Issue Creator) on (2024-09-19 05:29:28 UTC): Can you guide me through mohin Ali steps
Where can I find it ?

On Wed, 11 Sept 2024, 10:17 Nihantra C. Patel, ***@***.***>
wrote:

Nihantra-Patel on (2024-09-19 05:31:21 UTC): https://github.com/frappe/hrms?tab=readme-ov-file#installation

Explore the Bench Commands Cheatsheet: https://frappeframework.com/docs/user/en/bench/resources/bench-commands-cheatsheet

"
2515548091,issue,open,,"Inconsistent Rounding Between ""Total Taxes and Charges"" and ""Item Tax Breakdown"" in Sales Invoice","### Information about bug

The discount and rounding of amounts in the sales invoice are calculated inconsistently in certain cases. Specifically, the rounding method differs between the ""Total Taxes and Charges"" and ""Item Tax Breakdown"" sections of the invoice.

This behavior also happen in the total taxes and charges table and the Grand total field which have the same gap
![image](https://github.com/user-attachments/assets/eecee1f1-8b4f-40ef-b4b9-8db5033f0b45)
 
**Preconditions** 

- Item with a price of 2000, qty 1 
- Item with a price of 1500, qty 1 and discount on the item 100%
- Item with a price of 1300, qty 4 and discount amount 800 on the item
- Item with a price of 300, qty 1 and discount on the item 100%
- Item with a price of 350, qty 5 and discount amount on the item 100

**Repro Steps**

1. Create a sales invoice.
2. Select the mentioned items
4. Apply a 1231 discount amount on the invoice.
5. Save and submit the invoice.


**Actual results **
The invoice is rejected due to a discrepancy in the amounts. Upon investigation, it was found that the ""Total Taxes and Charges"" field is rounded differently compared to the sum of the individual line items, with a difference of 0.01.
The grand total on the invoice is 4,806.50 and the total of the invoice in the sales taxes and charges table is 4,806.51
The round adjustment is 0.49

**Expected Results **
The total taxes and charges should be consistent with the sum of the individual line items' tax amounts.
The total of the invoice in the taxes and charges table should be same as the grand total 


### Module

accounts, buying, selling

### Version

ERPNext: v15.19.1 (HEAD)

Frappe Framework: v15.20.0 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",omarashrafsarhan,2024-09-10 06:43:28+00:00,[],2024-12-26 09:19:44+00:00,,https://github.com/frappe/erpnext/issues/43143,"[('bug', None)]","[{'comment_id': 2441265777, 'issue_id': 2515548091, 'author': 'meaziz', 'body': '@nabinhait any updates on this.\r\nThis is negatively impacting the KSA compliance integration.', 'created_at': datetime.datetime(2024, 10, 28, 11, 1, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2441670805, 'issue_id': 2515548091, 'author': 'Vigneshsekar', 'body': 'Requesting backport of this PR #39481 to version-15 to resolve this issue.', 'created_at': datetime.datetime(2024, 10, 28, 13, 59, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2463900101, 'issue_id': 2515548091, 'author': 'umairsy', 'body': '@Vigneshsekar hi,\r\n\r\nAnyone working on the refactor or back-porting, as you suggested?', 'created_at': datetime.datetime(2024, 11, 8, 6, 47, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2547662830, 'issue_id': 2515548091, 'author': 'Vigneshsekar', 'body': 'Hi @umairsy , Sorry, I missed your comment. This is merged on Nov 8. (https://github.com/frappe/erpnext/pull/44040)\r\n\r\n@omarashrafsarhan , Can you please confirm if the issue is resolved?', 'created_at': datetime.datetime(2024, 12, 17, 7, 10, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2562339270, 'issue_id': 2515548091, 'author': 'omarashrafsarhan', 'body': 'Hi @Vigneshsekar , Apologies for the delay in providing this feedback.\r\nThe issue persists in specific scenarios, such as invoices containing two items with rates of 35 and 80, where the checkbox ""Is this Tax included in Basic Rate"" is enabled. While the issue appears to be resolved in some cases, it is still occurring in others.', 'created_at': datetime.datetime(2024, 12, 26, 9, 1, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2562346331, 'issue_id': 2515548091, 'author': 'Vigneshsekar', 'body': 'Sure, let me try with `Is this Tax included in Basic Rate` enabled. \r\n\r\nIn the meantime, can you please share those specific cases where the issue persists with the steps to reproduce?', 'created_at': datetime.datetime(2024, 12, 26, 9, 9, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2562355008, 'issue_id': 2515548091, 'author': 'omarashrafsarhan', 'body': 'Thanks for your quick response @Vigneshsekar \r\n\r\nPreconditions\r\n\r\n1. Item with a price of 35, qty 1\r\n2. Item with a price of 80, qty 1 \r\n3. The tax template is 15% rate and ""Is this Tax included in Basic Rate"" enabled\r\n\r\nSteps:\r\n\r\n1. Create new sales invoice\r\n2. Add the mentioned items in the sales invoice\r\n3. Select the configured tax template\r\n4. Click save then submit', 'created_at': datetime.datetime(2024, 12, 26, 9, 19, 44, tzinfo=datetime.timezone.utc)}]","meaziz on (2024-10-28 11:01:31 UTC): @nabinhait any updates on this.
This is negatively impacting the KSA compliance integration.

Vigneshsekar on (2024-10-28 13:59:14 UTC): Requesting backport of this PR #39481 to version-15 to resolve this issue.

umairsy on (2024-11-08 06:47:58 UTC): @Vigneshsekar hi,

Anyone working on the refactor or back-porting, as you suggested?

Vigneshsekar on (2024-12-17 07:10:45 UTC): Hi @umairsy , Sorry, I missed your comment. This is merged on Nov 8. (https://github.com/frappe/erpnext/pull/44040)

@omarashrafsarhan , Can you please confirm if the issue is resolved?

omarashrafsarhan (Issue Creator) on (2024-12-26 09:01:51 UTC): Hi @Vigneshsekar , Apologies for the delay in providing this feedback.
The issue persists in specific scenarios, such as invoices containing two items with rates of 35 and 80, where the checkbox ""Is this Tax included in Basic Rate"" is enabled. While the issue appears to be resolved in some cases, it is still occurring in others.

Vigneshsekar on (2024-12-26 09:09:40 UTC): Sure, let me try with `Is this Tax included in Basic Rate` enabled. 

In the meantime, can you please share those specific cases where the issue persists with the steps to reproduce?

omarashrafsarhan (Issue Creator) on (2024-12-26 09:19:44 UTC): Thanks for your quick response @Vigneshsekar 

Preconditions

1. Item with a price of 35, qty 1
2. Item with a price of 80, qty 1 
3. The tax template is 15% rate and ""Is this Tax included in Basic Rate"" enabled

Steps:

1. Create new sales invoice
2. Add the mentioned items in the sales invoice
3. Select the configured tax template
4. Click save then submit

"
2513528529,issue,closed,completed,"POS: opening POS Item Details causes error in Console  ""e.item_stock_map[e.item_row.item_code] is undefined""","### Information about bug

When an item is selected in the shopping cart, an error is displayed in the console.

### Module

selling

### Version

erpnext 15.33.4
frappe 15.39.0


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Uncaught (in promise) TypeError: e.item_stock_map[e.item_row.item_code] is undefined
    onchange https://riwollis-shop.now-dns.org/app/point-of-sale line 294 > injectedScript:182
    promise callback*bind_custom_control_change_event/this.warehouse_control.df.onchange https://riwollis-shop.now-dns.org/app/point-of-sale line 294 > injectedScript:182
    l https://riwollis-shop.now-dns.org/assets/frappe/dist/js/controls.bundle.FAMWCXNE.js:15248
    promise callback*frappe.run_serially/< https://riwollis-shop.now-dns.org/assets/frappe/dist/js/desk.bundle.YX5N3HJG.js:294
    run_serially https://riwollis-shop.now-dns.org/assets/frappe/dist/js/desk.bundle.YX5N3HJG.js:294
    l https://riwollis-shop.now-dns.org/assets/frappe/dist/js/controls.bundle.FAMWCXNE.js:15248
    validate_and_set_in_model https://riwollis-shop.now-dns.org/assets/frappe/dist/js/controls.bundle.FAMWCXNE.js:15248
    promise callback*validate_and_set_in_model https://riwollis-shop.now-dns.org/assets/frappe/dist/js/controls.bundle.FAMWCXNE.js:15248
    set_value https://riwollis-shop.now-dns.org/assets/frappe/dist/js/controls.bundle.FAMWCXNE.js:15248
    render_form https://riwollis-shop.now-dns.org/app/point-of-sale line 294 > injectedScript:182
    render_form https://riwollis-shop.now-dns.org/app/point-of-sale line 294 > injectedScript:182
    toggle_item_details_section https://riwollis-shop.now-dns.org/app/point-of-sale line 294 > injectedScript:177
    cart_item_clicked https://riwollis-shop.now-dns.org/app/point-of-sale line 294 > injectedScript:306
    bind_events https://riwollis-shop.now-dns.org/app/point-of-sale line 294 > injectedScript:76
    dispatch https://riwollis-shop.now-dns.org/assets/frappe/dist/js/libs.bundle.TIV7ZGVY.js:1
    handle https://riwollis-shop.now-dns.org/assets/frappe/dist/js/libs.bundle.TIV7ZGVY.js:1
point-of-sale line 294 > injectedScript:182:2152
```
",zahlenhexe,2024-09-09 10:12:06+00:00,[],2024-09-26 00:09:59+00:00,2024-09-11 06:58:11+00:00,https://github.com/frappe/erpnext/issues/43136,"[('bug', None)]","[{'comment_id': 2342815339, 'issue_id': 2513528529, 'author': 'Nihantra-Patel', 'body': 'We tested the complete POS flow but did not encounter any errors in the latest version 15. Please upgrade to version 15, migrate the site, and build the app.\r\n\r\n\r\nhttps://github.com/user-attachments/assets/2ef15668-0a62-4d56-a4f3-64225ccf0ecc', 'created_at': datetime.datetime(2024, 9, 11, 6, 58, 11, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-11 06:58:11 UTC): We tested the complete POS flow but did not encounter any errors in the latest version 15. Please upgrade to version 15, migrate the site, and build the app.


https://github.com/user-attachments/assets/2ef15668-0a62-4d56-a4f3-64225ccf0ecc

"
2513453656,issue,open,,Purchase Invoice Not Found After I Deleted the Unsubmitted Invoice and Created a New Invoice,"### Information about bug

I just encountered a bug where an invoice is not found accidentally. Here's the step on how I reproduce the bugs:
1. Create a purchase invoice (paid)
2. Delete the invoice after having been redirected to invoice overview
3. Create another new purchase invoice (paid)
4. The error appears after redirected to invoice overview

I have also attached the screenshot of what the page looks like when the error appears as follows:
![image](https://github.com/user-attachments/assets/d5707c53-500f-4522-b062-6e2f6008044a)


### Module

buying

### Version

ERPNext Version 15.34.2
Frappe Version 15.40.3

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",ahmadoji01,2024-09-09 09:39:11+00:00,[],2024-09-09 09:40:31+00:00,,https://github.com/frappe/erpnext/issues/43130,"[('bug', None)]","[{'comment_id': 2337629895, 'issue_id': 2513453656, 'author': 'ahmadoji01', 'body': ""PS: I eventually added a new purchase invoice to bypass the deleted invoice to avoid such event to occur again as I wonder this might be intentional thus the problem is on my side, or it's unexpected behavior"", 'created_at': datetime.datetime(2024, 9, 9, 9, 40, 30, tzinfo=datetime.timezone.utc)}]","ahmadoji01 (Issue Creator) on (2024-09-09 09:40:30 UTC): PS: I eventually added a new purchase invoice to bypass the deleted invoice to avoid such event to occur again as I wonder this might be intentional thus the problem is on my side, or it's unexpected behavior

"
2512500659,issue,closed,completed,Stock Report: Available Batch Report - Default Date = 1 month back,"### Information about bug

Stock Report: Available Batch Report's default date is of one month back from Today(). Make correction for showing it default as today()

### Module

stock

### Version

erpnext: v15.34.2 (version-15)
Frappe Framework: v15.40.3 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",akashdubey22,2024-09-08 17:52:33+00:00,[],2024-09-26 00:10:01+00:00,2024-09-09 08:25:38+00:00,https://github.com/frappe/erpnext/issues/43113,"[('bug', None), ('released', None)]","[{'comment_id': 2342638362, 'issue_id': 2512500659, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.74.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 9, 11, 5, 12, 7, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-09-11 05:12:07 UTC): :tada: This issue has been resolved in version 14.74.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2512389651,issue,open,,Issue with Inventory Dimension Field Naming in ERPNext ,"### Information about bug

Hi,
I intended to create an Inventory Dimension with the following values:

```json
{
	""dimension_name"": ""Cost Center Dimension"",
	""reference_document"": ""Cost Center"",
	""apply_to_all_doctypes"": 1
}
```

While creating this Inventory Dimension, I encountered the following error:

```bash
A field with the name 'cost_center' already exists in doctype Asset Capitalization Stock Item.
```

As you know, there is a field named `cost_center` in the Accounting Dimension section, which caused this error.

After thoroughly reviewing the code related to `inventory_dimension.py`, I realized that custom fields created by Inventory Dimension should be named based on `dimension_name`. However, it was strange that for `Asset Capitalization Stock Item`, the custom field name was `cost_center` instead of `cost_center_dimension`, while for other DocTypes, the naming was done correctly (see the information below).

```json
{
  ""..."" : ""..."",
  
  ""Asset Capitalization Stock Item"": [
    {
      ""fieldname"": ""inventory_dimension"",
      ""fieldtype"": ""Section Break"",
      ""insert_after"": ""dimension_col_break"",
      ""label"": ""Inventory Dimension"",
      ""collapsible"": 1
    },
    {
      ""fieldname"": ""cost_center"",
      ""fieldtype"": ""Link"",
      ""insert_after"": ""inventory_dimension"",
      ""options"": ""Cost Center"",
      ""label"": ""cc"",
      ""search_index"": 1,
      ""reqd"": 0,
      ""mandatory_depends_on"": """"
    }
  ],
  ""Stock Ledger Entry"": {
    ""fieldname"": ""cost_center"",
    ""fieldtype"": ""Link"",
    ""insert_after"": ""inventory_dimension"",
    ""options"": ""Cost Center"",
    ""label"": ""cc"",
    ""search_index"": 1,
    ""reqd"": 0,
    ""mandatory_depends_on"": """"
  }
}
```

After extensive code review, I found that the issue is in the `add_custom_fields` method of the `inventory_dimension.py` file, where Copy By Reference is used instead of Copy By Value.

According to the code below, on line 219, after the `if` condition, the last value of the `dimension_fields` array is copied by reference, and then its value, which is a Python dictionary, is modified.

```python
dimension_field = dimension_fields[1]
dimension_field[""mandatory_depends_on""] = """"
dimension_field[""reqd""] = 0
dimension_field[""fieldname""] = self.target_fieldname
custom_fields[""Stock Ledger Entry""] = dimension_field
```

This change is also a change in the reference, causing the `fieldname` value for `Asset Capitalization Stock Item` to change from `cost_center_dimension` (self.source_fieldname) to `cost_center` (self.target_fieldname), resulting in this error.

Now, what is the solution to this bug? It's very simple. It is better to perform Copy By Value as shown in the code below.

```python
dimension_field = dimension_fields[1].copy()
```

Additionally, I noticed something that I don't understand. After deleting the Inventory Dimension using the Delete Dimension button, the custom fields are removed from the Custom Field, but these fields remain in the database tables. Why?

### Module

stock

### Version

Frappe Version: `15`
ERPNext Version: `15`

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
A field with the name 'cost_center' already exists in doctype Asset Capitalization Stock Item.
```
",mohsen-zanjani,2024-09-08 13:28:24+00:00,[],2024-09-08 13:28:24+00:00,,https://github.com/frappe/erpnext/issues/43112,"[('bug', None)]",[],
2512382061,issue,open,,wrong permissions for task while in kanab view and projects module,"### Information about bug

# Background
while the projects module and tasks does have some great functionality, it lacks, the necessary default permissions, and filtering for the users, so to get around this, we can add a custom permission to restrict for the department how ever this still doesn't filter the tasks that don't belong to the user or the projects department, so to fix that we can edit the permissions for the Task and enable `only if creator` it will filter the tasks that only belong or/and shared wit the user, how ever with this enabled the user can no longer, use the drag and drop functionality when using the kanban view, and gets a permission denied error. 

# Issues
- event when the projects are restricted and  the task belongs to that project its still visible to every user, if they view through the tasks page.
- when `only if creator` is enabled for the tasks, the user cannot use the kanban view to edit the tasks.

# Suggestions
- for the tasks, it makes more sense for the default to be only view there own tasks, or tasks assigned to them.
- for the projects the same as above, plus the department if they are a part of, or if the department is not specified in project, the project and all of its tasks should be visible to the user and but not editable.


# Steps to reproduce
1. edit the permission for any rule, that has access to tasks, and enable the `only if creator` for the Task Table.
2. create any tasks and/or assign to the user that has the role.
3. go to tasks and view in kanban, try to drag and drop or edit the task, you get permission error.

### Module

projects, other

### Version

ERPNext: v15.31.5 (version-15)
Frappe Framework: v15.37.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",MrJico,2024-09-08 13:10:48+00:00,[],2024-09-11 13:38:43+00:00,,https://github.com/frappe/erpnext/issues/43111,"[('bug', None)]","[{'comment_id': 2343704547, 'issue_id': 2512382061, 'author': 'MrJico', 'body': 'any updates ?', 'created_at': datetime.datetime(2024, 9, 11, 13, 38, 42, tzinfo=datetime.timezone.utc)}]","MrJico (Issue Creator) on (2024-09-11 13:38:42 UTC): any updates ?

"
2511608387,issue,open,,Promotional Scheme is not working as expected in v15,"### Information about bug

![image](https://github.com/user-attachments/assets/dd7b41f6-889f-4122-a809-c6b804feb83e)
![image](https://github.com/user-attachments/assets/73043d4a-74c0-4472-bdf6-89c889ae1312)



### Module

accounts, selling

### Version

 ERPNext Ver 15

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Relevant details and config screens are provided .
Please reach out to me for any more information or testing the system once solution is identified
```
",SNSANTHOSH,2024-09-07 11:38:52+00:00,[],2024-09-07 11:38:52+00:00,,https://github.com/frappe/erpnext/issues/43106,"[('bug', None)]",[],
2511491030,issue,open,,Future Payments for account Receivable and payable reports,"### Information about bug

The future payments reference in Account receivable and payable works on posting date of the payment entry. it should validate based on cheque reference date of the payment entry. and also the future payment should remain in the column as long as the clearance date is not updated in the system.

Right now the future payment column validates based on posting date entry and once the posting date is crossed it will automatically treat it as paid value without any validation.

![image](https://github.com/user-attachments/assets/5a7a52cc-335f-42df-b4fd-2c0f6ea1f1e1)


### Module

accounts, buying, selling

### Version

V14 and V15 ERPNext

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",maveezmh,2024-09-07 06:04:34+00:00,[],2024-12-27 04:48:11+00:00,,https://github.com/frappe/erpnext/issues/43102,"[('bug', None)]",[],
2511433499,issue,open,,Payment Reconciliation unable to do it,"### Information about bug

![image](https://github.com/user-attachments/assets/e0cc09c3-d2b5-464d-914a-b33bffc36aa3)
Journal Entry Date fall previous year, accounting period already closed
Invoice Date : August 2024
Account Receivable show both line

### Module

accounts

### Version

ERPNext: v15.34.1 (version-15)

Frappe Framework: v15.40.2 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-09-07 02:59:52+00:00,[],2024-09-07 02:59:52+00:00,,https://github.com/frappe/erpnext/issues/43101,"[('bug', None)]",[],
2510555422,issue,open,,Sales Invoice Cancel Issue still exists,"### Information about bug

The issue https://github.com/frappe/erpnext/issues/34187 still exists in 15 as well.

The proposed fix https://github.com/frappe/erpnext/pull/34337 does not fix it, only fixes it when you cancel a timesheet - but not a invoice.

The line `frm.ignore_doctypes_on_cancel_all = [""Sales Invoice""];` was added in erpnext/projects/doctype/timesheet/timesheet.js.

 We probably need a similar element in the sales_invoice__js.

### Module

accounts

### Version

ERPNext: v15.34.1 (version-15)

Frappe Framework: v15.40.2 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",RANSoftRA,2024-09-06 14:20:04+00:00,[],2024-09-06 14:34:10+00:00,,https://github.com/frappe/erpnext/issues/43094,"[('bug', None)]","[{'comment_id': 2334190347, 'issue_id': 2510555422, 'author': 'RANSoftRA', 'body': 'In the meantime, i added a new client script to fix this behavior at /app/client-script > Add Clientscript:\r\n\r\n- DocType: Sales Invoice\r\n- Active\r\n\r\n```js\r\nfrappe.ui.form.on(\'Sales Invoice\', {\r\n    onload_post_render: function(frm) {\r\n\r\n        // adding all doctypes from original script and added ""Sales Invoice"" too\r\n        frm.ignore_doctypes_on_cancel_all = [\r\n\t\t\t""POS Invoice"",\r\n\t\t\t""Timesheet"",\r\n\t\t\t""POS Invoice Merge Log"",\r\n\t\t\t""POS Closing Entry"",\r\n\t\t\t""Journal Entry"",\r\n\t\t\t""Payment Entry"",\r\n\t\t\t""Repost Payment Ledger"",\r\n\t\t\t""Repost Accounting Ledger"",\r\n\t\t\t""Unreconcile Payment"",\r\n\t\t\t""Unreconcile Payment Entries"",\r\n\t\t\t""Serial and Batch Bundle"",\r\n\t\t\t""Bank Transaction"",\r\n\t\t\t""Sales Invoice""\r\n\t\t];\r\n        \r\n    }\r\n})\r\n```\r\n\r\nI do not know if this is an actual solution for the core script (may be some scenarios where you actually want to cancel other sales invoices), but for our use case it works just fine.', 'created_at': datetime.datetime(2024, 9, 6, 14, 30, 35, tzinfo=datetime.timezone.utc)}]","RANSoftRA (Issue Creator) on (2024-09-06 14:30:35 UTC): In the meantime, i added a new client script to fix this behavior at /app/client-script > Add Clientscript:

- DocType: Sales Invoice
- Active

```js
frappe.ui.form.on('Sales Invoice', {
    onload_post_render: function(frm) {

        // adding all doctypes from original script and added ""Sales Invoice"" too
        frm.ignore_doctypes_on_cancel_all = [
			""POS Invoice"",
			""Timesheet"",
			""POS Invoice Merge Log"",
			""POS Closing Entry"",
			""Journal Entry"",
			""Payment Entry"",
			""Repost Payment Ledger"",
			""Repost Accounting Ledger"",
			""Unreconcile Payment"",
			""Unreconcile Payment Entries"",
			""Serial and Batch Bundle"",
			""Bank Transaction"",
			""Sales Invoice""
		];
        
    }
})
```

I do not know if this is an actual solution for the core script (may be some scenarios where you actually want to cancel other sales invoices), but for our use case it works just fine.

"
2509722245,issue,open,,General Ledger Report Generated,"### Information about bug

General Ledger can't view data, error message as per below:
""This is a background report. Please set the appropriate filters and then generate a new one.""

![image](https://github.com/user-attachments/assets/4652720b-8f56-40ef-98b0-7c911a39ea74)


### Module

accounts

### Version

ERPNext: v13.55.2 (HEAD)

Frappe Framework: v13.58.21 (HEAD)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
General Ledger, can't generate the report, only appear below message.

This is a background report. Please set the appropriate filters and then generate a new one.
```
",winnietlc,2024-09-06 07:27:14+00:00,[],2024-09-22 02:33:09+00:00,,https://github.com/frappe/erpnext/issues/43089,"[('bug', None)]","[{'comment_id': 2365264066, 'issue_id': 2509722245, 'author': 'MhmedRjb', 'body': ""Hello, \nthis is not an error; this is how prepared reports function. \n\nSimply click on 'Generate New Report,' then click the refresh button next to it, and the data will appear if it exists"", 'created_at': datetime.datetime(2024, 9, 21, 17, 36, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2365425829, 'issue_id': 2509722245, 'author': 'winnietlc', 'body': ""Dear sirs,\r\n\r\nNoted with thanks.\r\n\r\nBest regards,\r\n\r\n[image: Bion]\r\n\r\n*Winnie Tan*\r\n\r\n\r\n*T* +65 6939 8099\r\n\r\n*E* ***@***.***\r\n\r\n*A* 35 Pioneer Road North #02-03 Singapore 628475\r\n\r\n[image: https://www.facebook.com/bionsg/]\r\n<https://www.google.com/url?q=https://www.facebook.com/bionsg/&source=gmail-html&ust=1705025611124000&usg=AOvVaw3EdIHFOMavUTi3Wi4UhnRC>\r\n[image:\r\nhttps://www.instagram.com/bion.sg/]\r\n<https://www.google.com/url?q=https://www.instagram.com/bion.sg/&source=gmail-html&ust=1705025611125000&usg=AOvVaw11e0-Zu0WV3k6_Sv-HCl8S>\r\n[image:\r\nhttps://www.bion.sg/]\r\n<https://www.google.com/url?q=https://www.bion.sg/&source=gmail-html&ust=1705025611125000&usg=AOvVaw3uvBUfsBNE7qbDoBfCOy0F>\r\n\r\n\r\nOn Sun, Sep 22, 2024 at 1:37\u202fAM mhmed rjb ***@***.***> wrote:\r\n\r\n> Hello,\r\n> this is not an error; this is how prepared reports function.\r\n>\r\n> Simply click on 'Generate New Report,' then click the refresh button next\r\n> to it, and the data will appear if it exists\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/frappe/erpnext/issues/43089#issuecomment-2365264066>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/BLCDWOSSOUCJ4T6HANIRVV3ZXWVERAVCNFSM6AAAAABNX77KCKVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDGNRVGI3DIMBWGY>\r\n> .\r\n> You are receiving this because you authored the thread.Message ID:\r\n> ***@***.***>\r\n>"", 'created_at': datetime.datetime(2024, 9, 22, 2, 33, 8, tzinfo=datetime.timezone.utc)}]","MhmedRjb on (2024-09-21 17:36:50 UTC): Hello, 
this is not an error; this is how prepared reports function. 

Simply click on 'Generate New Report,' then click the refresh button next to it, and the data will appear if it exists

winnietlc (Issue Creator) on (2024-09-22 02:33:08 UTC): Dear sirs,

Noted with thanks.

Best regards,

[image: Bion]

*Winnie Tan*


*T* +65 6939 8099

*E* ***@***.***

*A* 35 Pioneer Road North #02-03 Singapore 628475

[image: https://www.facebook.com/bionsg/]
<https://www.google.com/url?q=https://www.facebook.com/bionsg/&source=gmail-html&ust=1705025611124000&usg=AOvVaw3EdIHFOMavUTi3Wi4UhnRC>
[image:
https://www.instagram.com/bion.sg/]
<https://www.google.com/url?q=https://www.instagram.com/bion.sg/&source=gmail-html&ust=1705025611125000&usg=AOvVaw11e0-Zu0WV3k6_Sv-HCl8S>
[image:
https://www.bion.sg/]
<https://www.google.com/url?q=https://www.bion.sg/&source=gmail-html&ust=1705025611125000&usg=AOvVaw3uvBUfsBNE7qbDoBfCOy0F>


On Sun, Sep 22, 2024 at 1:37 AM mhmed rjb ***@***.***> wrote:

"
2509546079,issue,closed,completed,Mandatory Fields which are mandatory based on a condition are coming as mandatory in Bulk Edit.,"### Information about bug

I have set Project as Non-mandatory when ""is template"" check box is checked.
![image](https://github.com/user-attachments/assets/5dd9be7a-a585-4c5a-9ad5-7adff7201c34)

But in Bulk Edit, system is showing this field as mandatory even though I am only selecting tasks which have project as non-mandatory.

![image](https://github.com/user-attachments/assets/c7f44111-49c1-42d5-994e-79a69e8edb89)

![image](https://github.com/user-attachments/assets/45ae10c4-5640-4532-ba72-08af1b0895d7)
 

### Module

projects

### Version

V15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",RAhmed-Dev,2024-09-06 05:25:53+00:00,[],2024-09-21 00:09:40+00:00,2024-09-06 08:49:32+00:00,https://github.com/frappe/erpnext/issues/43088,"[('bug', None)]","[{'comment_id': 2333562442, 'issue_id': 2509546079, 'author': 'Nihantra-Patel', 'body': 'If there is any condition in the ""Mandatory Depends On"" field, it will still make the field mandatory during a bulk update because it doesn\'t evaluate the condition. It simply marks it as mandatory. Bulk entry is designed for quick data updates, and while using it for fast data updates, no condition checks are performed. Let me explain why this happens.\r\n\r\nSuppose you have 100 tasks, with ""Is Template"" selected for 60 tasks and not selected for the other 40 tasks. When you attempt to update all 100 tasks at once, the system cannot determine whether the field should be mandatory or not, leading to confusion. This tool is meant for fast updates without considering specific conditions.\r\n\r\nIf you need to update data in bulk with conditions, you can use the [System Console](https://frappeframework.com/docs/user/en/desk/scripting/system-console) instead.', 'created_at': datetime.datetime(2024, 9, 6, 8, 49, 32, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-06 08:49:32 UTC): If there is any condition in the ""Mandatory Depends On"" field, it will still make the field mandatory during a bulk update because it doesn't evaluate the condition. It simply marks it as mandatory. Bulk entry is designed for quick data updates, and while using it for fast data updates, no condition checks are performed. Let me explain why this happens.

Suppose you have 100 tasks, with ""Is Template"" selected for 60 tasks and not selected for the other 40 tasks. When you attempt to update all 100 tasks at once, the system cannot determine whether the field should be mandatory or not, leading to confusion. This tool is meant for fast updates without considering specific conditions.

If you need to update data in bulk with conditions, you can use the [System Console](https://frappeframework.com/docs/user/en/desk/scripting/system-console) instead.

"
2505972846,issue,open,,Maintain Same Rate in Selling not working,"### Information about bug

There have been several bugs raised and fixes implemented to try to fix ""Maintain Same Rate"" Settings but none of them actually address the issue, which is major.

The problem is that validation of a transaction triggers `set_missing_values` in the `Accounts Controller`.

https://github.com/frappe/erpnext/blob/5442487b6c6b88cbc9364d7304a97ab8afdb13be/erpnext/controllers/accounts_controller.py#L180

This effectively triggers recalculation of the whole document including running pricing rules. So if, for example, you have imported lines from various Sales Orders to a Delivery Note, the whole Delivery Note will be recalculated. This includes manually modified lines. So if there are pricing rules or price lists, the document changes. Then your Sales Invoice is also wrong.

**NOTE**: you do not necessarily need pricing rules for this to fail, a price list is sufficient.

Because each transaction will always have a price list set, (there is a default in the Selling/Buying Settings) validation or any item row change, e.g. to quantity, will cause it to pull in the price list price if it exists.

So what needs to happen is this:

- Importing lines from a document which has been manually created or `ignore_pricing_rule` is set, also means this flag needs to ALWAYS be set on the created document;
- `maintain_same_sales_rate` on both Selling and Buying needs to ensure `set_missing_values` is never run, and/or `ignore_pricing_rule` is ALWAYS enabled on child documents;

To reproduce:

- Ensure Selling Settings: `Maintain Same Rate throughout...` is set
- Create Items
- Create Price Lists
- Create Pricing Rules
- Create 2 Sales Orders using items with price lists and pricing rules for the SAME customer: enable ignore pricing rule on ONE of them and manually adjust pricing
- Create a Delivery Note from the Sales Order where ignore pricing rule is SET, do not save
- Import the lines from Sales Order where ignore pricing rule is NOT SET
- Note: ignore pricing rule is no longer set
- Save Delivery Note
- Manual pricing has now changed to match price lists and pricing rules

NOTE: also worth considering what happens when a transaction is duplicated, which is different to when the transaction is part of a series in the same selling cycle: QN -> SO -> DN -> SI. There is an argument to say transaction duplication should have a separate control to ""Maintain Rate"" which is independent to this bug.

@deepeshgarg007 
@tundebabzy 
@rohitwaghchaure 
@rtdany10 
@Nihantra-Patel 

Related:
#40159 
https://github.com/frappe/erpnext/pull/32923
https://github.com/frappe/erpnext/issues/35528
https://github.com/frappe/erpnext/issues/35485
https://github.com/frappe/erpnext/issues/33987
https://github.com/frappe/erpnext/issues/33209

### Module

accounts, buying, selling

### Version

ERPNext v13 onwards

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-09-04 17:56:06+00:00,['ruthra-kumar'],2024-11-11 23:26:51+00:00,,https://github.com/frappe/erpnext/issues/43059,"[('bug', None)]","[{'comment_id': 2411380160, 'issue_id': 2505972846, 'author': 'garyhyam', 'body': 'This is having a huge impact for us too. It would be helpful to have some idea of a timeframe for when this is likely to be fixed?', 'created_at': datetime.datetime(2024, 10, 14, 14, 8, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2428464801, 'issue_id': 2505972846, 'author': 'umairsy', 'body': '@ruthra-kumar can we validate and check into it.', 'created_at': datetime.datetime(2024, 10, 22, 7, 25, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2469205117, 'issue_id': 2505972846, 'author': 'casesolved-co-uk', 'body': '**NOTE**: you do not necessarily need pricing rules for this to fail, a price list is sufficient.\r\n\r\nBecause each transaction will always have a price list set, (there is a default in the Selling/Buying Settings) validation or any item row change, e.g. to quantity, will cause it to pull in the price list price if it exists.', 'created_at': datetime.datetime(2024, 11, 11, 22, 37, 56, tzinfo=datetime.timezone.utc)}]","garyhyam on (2024-10-14 14:08:33 UTC): This is having a huge impact for us too. It would be helpful to have some idea of a timeframe for when this is likely to be fixed?

umairsy on (2024-10-22 07:25:16 UTC): @ruthra-kumar can we validate and check into it.

casesolved-co-uk (Issue Creator) on (2024-11-11 22:37:56 UTC): **NOTE**: you do not necessarily need pricing rules for this to fail, a price list is sufficient.

Because each transaction will always have a price list set, (there is a default in the Selling/Buying Settings) validation or any item row change, e.g. to quantity, will cause it to pull in the price list price if it exists.

"
2505208693,issue,closed,completed,POS allow me to sell even the item is out stock ,"### Information about bug

In the POS system, it's possible to sell an item more than once even when it's out of stock, as long as it had stock during the first transaction.

**How to Reproduce the Issue:**

1. Set an item with a stock quantity in the POS system.
2. Sell all units of the item.
3. Create a new sales invoice.
4. You’ll find that you can sell the same item again, despite the stock being depleted.


**Reason for the Issue:** 
The POS system doesn’t update stock levels until the POS is closed, which can lead to the system allowing sales even when stock is unavailable.


### Module

stock, selling

### Version

ERPNext: v15.34.0 (version-15)
Frappe Framework: v15.39.1 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",MhmedRjb,2024-09-04 12:26:19+00:00,[],2024-09-24 00:10:14+00:00,2024-09-07 12:45:16+00:00,https://github.com/frappe/erpnext/issues/43052,"[('bug', None)]",[],
2504911396,issue,closed,completed,"On Work Order Screen, In Items Child Table UOM is not showing.","### Information about bug

On Work Order Screen, In Items Child Table UOM is not showing.

### Module

manufacturing

### Version

Installed Apps
ERPNext: v15.30.0 (HEAD)
Frappe Framework: v15.36.0 (HEAD)
Frappe HR: v15.24.0 (HEAD)
India Compliance: v15.11.0 (HEAD)
Payments: v0.0.1 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",nitin-anantpranali,2024-09-04 10:19:36+00:00,[],2024-12-12 00:11:24+00:00,2024-11-20 05:50:48+00:00,https://github.com/frappe/erpnext/issues/43050,"[('bug', None), ('released', None)]","[{'comment_id': 2330542303, 'issue_id': 2504911396, 'author': 'Nihantra-Patel', 'body': ""Share the screenshot or video and provide the steps to reproduce the issue. We tested the latest version and couldn't find the issue."", 'created_at': datetime.datetime(2024, 9, 5, 3, 52, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2337172355, 'issue_id': 2504911396, 'author': 'nitin-anantpranali', 'body': '<img width=""997"" alt=""image"" src=""https://github.com/user-attachments/assets/2ec59b27-aa1b-4b99-beb3-fe6460285d7a"">\r\n\r\nThere is no UOM field in child table and at header level...', 'created_at': datetime.datetime(2024, 9, 9, 5, 42, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2337332636, 'issue_id': 2504911396, 'author': 'Nihantra-Patel', 'body': 'The reason the Unit of Measure (UOM) is not available in the Work Order Item table because the system does not support multiple UOMs for items in Work Orders by default. However, if you require UOM functionality in this table, you can customize it by adding a custom field for UOM. This customization would allow you to track and manage UOM for specific Work Order items based on your requirements.', 'created_at': datetime.datetime(2024, 9, 9, 7, 25, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2337579731, 'issue_id': 2504911396, 'author': 'nitin-anantpranali', 'body': 'This is a big flaw on the UI side. \r\nImagine a scenario where there are multiple items in BOM and the user should get a clear idea about the quantity of the Raw Material which is getting consumed. So on the screen (may be in disabled mode) the UOM should be visible. \r\n\r\nOtherwise until the user do not make Stock Entry he wont get a clear idea about the UOM, whether its in KG or GMs.\r\n\r\nPlease do not overlook it. We are facing issues while implementation at various clients.', 'created_at': datetime.datetime(2024, 9, 9, 9, 17, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2337599568, 'issue_id': 2504911396, 'author': 'nitin-anantpranali', 'body': 'This is a typical screen. What user is going to understand by looking at the figures... Whether the quantity is in Kg, Gm, ml, cm, meter????\r\n\r\nThere should be a clear information on the screen. The units (based on the BOM) should be visible there.\r\n\r\n\r\n<img width=""997"" alt=""image"" src=""https://github.com/user-attachments/assets/260b948f-1c13-4b36-b9b3-34adc49202af"">', 'created_at': datetime.datetime(2024, 9, 9, 9, 26, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2340163145, 'issue_id': 2504911396, 'author': 'umairsy', 'body': 'We can simply fetch UoM from BOM Item table? @rohitwaghchaure \r\n\r\nIf there is qty, UoM should be there.', 'created_at': datetime.datetime(2024, 9, 10, 9, 36, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2504157681, 'issue_id': 2504911396, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.77.3 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.77.3)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 11, 27, 15, 25, 57, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-09-05 03:52:10 UTC): Share the screenshot or video and provide the steps to reproduce the issue. We tested the latest version and couldn't find the issue.

nitin-anantpranali (Issue Creator) on (2024-09-09 05:42:21 UTC): <img width=""997"" alt=""image"" src=""https://github.com/user-attachments/assets/2ec59b27-aa1b-4b99-beb3-fe6460285d7a"">

There is no UOM field in child table and at header level...

Nihantra-Patel on (2024-09-09 07:25:40 UTC): The reason the Unit of Measure (UOM) is not available in the Work Order Item table because the system does not support multiple UOMs for items in Work Orders by default. However, if you require UOM functionality in this table, you can customize it by adding a custom field for UOM. This customization would allow you to track and manage UOM for specific Work Order items based on your requirements.

nitin-anantpranali (Issue Creator) on (2024-09-09 09:17:10 UTC): This is a big flaw on the UI side. 
Imagine a scenario where there are multiple items in BOM and the user should get a clear idea about the quantity of the Raw Material which is getting consumed. So on the screen (may be in disabled mode) the UOM should be visible. 

Otherwise until the user do not make Stock Entry he wont get a clear idea about the UOM, whether its in KG or GMs.

Please do not overlook it. We are facing issues while implementation at various clients.

nitin-anantpranali (Issue Creator) on (2024-09-09 09:26:32 UTC): This is a typical screen. What user is going to understand by looking at the figures... Whether the quantity is in Kg, Gm, ml, cm, meter????

There should be a clear information on the screen. The units (based on the BOM) should be visible there.


<img width=""997"" alt=""image"" src=""https://github.com/user-attachments/assets/260b948f-1c13-4b36-b9b3-34adc49202af"">

umairsy on (2024-09-10 09:36:38 UTC): We can simply fetch UoM from BOM Item table? @rohitwaghchaure 

If there is qty, UoM should be there.

frappe-pr-bot on (2024-11-27 15:25:57 UTC): :tada: This issue has been resolved in version 14.77.3 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.77.3)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2504817603,issue,open,,Multiple Margin Pricing Rules do not get added up,"### Information about bug

Hello everyone :),

we have discovered a little Bug in ERPNext.
If you create multiple margin pricing rules for an item, the margins do not get added or multiplied up.

Right now the current state is, that the margin always get overwritten by one of the multiple pricing rules.

To give a better example, we have made a video, which will describe the problem and shows how to reproduce the bug.

Thank you for considering the issue!


https://github.com/user-attachments/assets/b303197a-b578-4505-b75f-cf81aa39ed41





### Module

accounts

### Version

Frappe Version 15
ERPNext Version 15

Frappe Version 14
ERPNext Version 14

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",Didiman1998,2024-09-04 09:40:07+00:00,[],2025-01-08 09:38:50+00:00,,https://github.com/frappe/erpnext/issues/43048,"[('bug', None)]","[{'comment_id': 2472030052, 'issue_id': 2504817603, 'author': 'jonaspm', 'body': 'I have a similar issue...\r\n\r\nExample:\r\n\r\n- Item price: **$400**\r\n\r\nI have two price rules:\r\n\r\n- **$600** (priority 1)\r\n- **20%** of price margin (priority 2)\r\n\r\nFor instance a product with a fixed price of $400 should show on the quote as: $1,080\r\nCalculation: 400 + 600  + (400 * 0.2)\r\n\r\nBut actual result is wrong: $2,880\r\nWrong calculation: 400 + (400 * 6.2)\r\n\r\nDo you see the problem?', 'created_at': datetime.datetime(2024, 11, 13, 0, 38, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2577217592, 'issue_id': 2504817603, 'author': 'Didiman1998', 'body': '@jonaspm we have solved it. You can leave a like if you want to!', 'created_at': datetime.datetime(2025, 1, 8, 9, 38, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2577218030, 'issue_id': 2504817603, 'author': 'Didiman1998', 'body': 'https://github.com/frappe/erpnext/pull/45165', 'created_at': datetime.datetime(2025, 1, 8, 9, 38, 49, tzinfo=datetime.timezone.utc)}]","jonaspm on (2024-11-13 00:38:38 UTC): I have a similar issue...

Example:

- Item price: **$400**

I have two price rules:

- **$600** (priority 1)
- **20%** of price margin (priority 2)

For instance a product with a fixed price of $400 should show on the quote as: $1,080
Calculation: 400 + 600  + (400 * 0.2)

But actual result is wrong: $2,880
Wrong calculation: 400 + (400 * 6.2)

Do you see the problem?

Didiman1998 (Issue Creator) on (2025-01-08 09:38:37 UTC): @jonaspm we have solved it. You can leave a like if you want to!

Didiman1998 (Issue Creator) on (2025-01-08 09:38:49 UTC): https://github.com/frappe/erpnext/pull/45165

"
2504816218,issue,closed,completed,Need Multiple Subcontracting Orders against a single Purchase Order in ERPNext,"The customer makes 1 Purchase Order to their supplier for multiple Finished Goods, each Finished Good having a separate line item in purchase order.

Now Only 1 subcontracting order currently is created against 1 purchase order.
But multiple subcontracting orders needed to be created against single purchase order. 
Here each line item of finished good can have single subcontracting order.",dipane,2024-09-04 09:39:29+00:00,[],2025-01-18 00:09:54+00:00,2025-01-03 10:40:53+00:00,https://github.com/frappe/erpnext/issues/43047,"[('feature-request', None)]","[{'comment_id': 2566387137, 'issue_id': 2504816218, 'author': 'mihir-kandoi', 'body': 'Hi,\nDoes #44711 address your issue?', 'created_at': datetime.datetime(2024, 12, 31, 11, 56, 46, tzinfo=datetime.timezone.utc)}]","mihir-kandoi on (2024-12-31 11:56:46 UTC): Hi,
Does #44711 address your issue?

"
2504507747,issue,open,,Pause job card via workstation overview,"**Is your feature request related to a problem? Please describe.**

In the current ERPNext version (v15.34.0), it is not possible to pause and restart a job card via the workstation job card overview. This is only possible via the job card itself. A job card can only be started and stopped via the overview
![image](https://github.com/user-attachments/assets/33e59b0e-0a72-4c51-9221-ba3c7e1cf51e)

This feature has been available in the develop branch of erpnext for several weeks now. Why is it not being merged?
![image](https://github.com/user-attachments/assets/e5bd6305-322c-452d-bd7d-028c5cbfba7a)

In my opinion, interrupting the job card is a very important feature that also belongs in the job card overview of the workstation. 

**Describe the solution you'd like**
The solution that is already provided in the develop branch.

",SamuelHelbling,2024-09-04 07:18:50+00:00,[],2024-09-04 10:53:21+00:00,,https://github.com/frappe/erpnext/issues/43044,"[('feature-request', None)]",[],
