id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2648058073,issue,closed,completed,"Successfully update to the latest version ERPNext: v15.41.2, but show the ERPNext: v15.41.1 in About menu","### Information about bug

I successfully update my ERPNext v15.41.2,
But when I check it on my About menu still on  ERPNext: v15.41.1 


### Module

other

### Version


ERPNext: v15.41.1 (version-15)

Frappe Framework: v15.47.1 (version-15)

Payments: v0.0.1 (version-15)

Print Designer: v1.4.3 (main)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
No error while updating
```
",bobotdls,2024-11-11 03:49:46+00:00,[],2024-11-26 00:10:54+00:00,2024-11-11 06:12:21+00:00,https://github.com/frappe/erpnext/issues/44061,"[('bug', None)]","[{'comment_id': 2467322406, 'issue_id': 2648058073, 'author': 'Nihantra-Patel', 'body': 'You’re right, but the last version was released recently. Normally, a new version is released each week, but due to a critical bug, it wasn’t updated by the frappe-bot. You can ignore this for now, as it will be automatically updated in the next version.', 'created_at': datetime.datetime(2024, 11, 11, 6, 12, 21, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-11 06:12:21 UTC): You’re right, but the last version was released recently. Normally, a new version is released each week, but due to a critical bug, it wasn’t updated by the frappe-bot. You can ignore this for now, as it will be automatically updated in the next version.

"
2646723417,issue,open,,Add filter by company on Supplier or Customer,"Hi,
I have a concern regarding suppliers and customers. Currently, suppliers and customers are shared across all companies. However, some companies do not want their suppliers or customers to be visible to others.

If assign a specific company to a supplier or customer, it limits visibility to that company, but if leave it blank, it becomes visible to all companies.",emm31ph,2024-11-10 02:32:39+00:00,[],2024-11-10 02:32:39+00:00,,https://github.com/frappe/erpnext/issues/44056,"[('feature-request', None)]",[],
2646182176,issue,closed,completed,Error during task creation,"### Information about bug

I tried to create a task from tree view.
![image](https://github.com/user-attachments/assets/ba0d5882-2117-4b63-bddc-aecd498b7329)
I got this error:
![image](https://github.com/user-attachments/assets/69f1a3f5-d8de-4896-9332-63f55368bbcf)

Also, check the URL at the bottom left.
![image](https://github.com/user-attachments/assets/da3e6a07-c44e-4d16-b4a2-288807eb9f9c)

But when I click the link, I get to this link:
https://erp.example.com/app/%23Form/Task/TASK-2024-00206

This is the error I got:

![image](https://github.com/user-attachments/assets/d4907a19-4b69-4184-b86c-ba485c63d870)

Also the said task `TASK-2024-00206` was not created.

![image](https://github.com/user-attachments/assets/e35da18d-0434-44c3-8978-f5e6d31abf5a)


### Module

projects

### Version

![image](https://github.com/user-attachments/assets/5b630956-dc6d-444c-ba70-e8413653297d)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",ajiragroup,2024-11-09 14:50:52+00:00,[],2024-11-30 00:10:45+00:00,2024-11-11 07:03:31+00:00,https://github.com/frappe/erpnext/issues/44054,"[('bug', None), ('released', None)]","[{'comment_id': 2473869603, 'issue_id': 2646182176, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.76.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.76.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 11, 13, 15, 1, 32, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-11-13 15:01:32 UTC): :tada: This issue has been resolved in version 14.76.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.76.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2645762026,issue,open,,inter-bank transfer entry issue in bank reconciliation tool,"### Information about bug

When we make an inter-bank transfer entry and then reconcile it, the effect of this entry is not reflected in the bank reconciliation tool, and the difference still appears.


<img width=""1207"" alt=""Screenshot 2024-11-09 at 12 56 43 PM"" src=""https://github.com/user-attachments/assets/df97add1-8563-4c1b-8ae1-9e7986c6ae50"">


### Module

accounts

### Version

version 14 and version 15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",mohsinalimat,2024-11-09 07:32:04+00:00,[],2024-11-18 15:53:44+00:00,,https://github.com/frappe/erpnext/issues/44047,"[('bug', None)]",[],
2644040311,issue,open,,Issue with Multiple Rows in BOM for Same Raw Material Item,"Hi,

We have one issue that system combines the same item across the rows into a single row in work order, which is incorrect. We want the same item to appear in multiple rows as we have done in the BOM

Steps to Reproduce:

We created one raw material and one finished item.

First, we repacked the raw material into two batches, which is fine because two batches of raw items are derived from that Repack

![image](https://github.com/user-attachments/assets/89cf2c70-b367-4fef-bf8a-f84ce1bb2c0c)


Next, we created a Bill of Materials (BOM) for the finished item using the raw material.

In the BOM, under the ""Raw Material"" section, we used the same item code in multiple rows but changed the item name for each row, as per our requirements.
<img width=""1230"" alt=""image"" src=""https://github.com/user-attachments/assets/4746d3cf-56eb-48d8-83eb-1567246475c1"">


The issue arises when we create a work order: the system combines the same item across the rows into a single row, which is incorrect. We want the same item to appear in multiple rows as we have done in the BOM.

<img width=""1226"" alt=""image"" src=""https://github.com/user-attachments/assets/237f4f33-1ef4-4106-8fb7-1b9f1f4f130e"">


Could you please check and give the feature to keep the items same in Work Order as they were in BOM",reeta-greycube,2024-11-08 13:19:02+00:00,['mihir-kandoi'],2024-12-11 09:37:15+00:00,,https://github.com/frappe/erpnext/issues/44043,"[('feature-request', None)]",[],
2643670078,issue,closed,completed,Expected Time Required is not transferred from Work Order to Job Card,"### Information about bug

If a new work order is created and submitted, the time from the work order (time_in_mins) is not transferred to the job card field Expected Time Required (time_required).
![image](https://github.com/user-attachments/assets/4b93104a-2be4-4b55-9693-a11249f91386)
![image](https://github.com/user-attachments/assets/ce0199ab-3482-4935-bb3d-0eca68f0339c)


### Module

manufacturing

### Version

Frappe Framework: v15.47.1 (version-15)
ERPNext: v15.41.1 (version-15)


### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",SamuelHelbling,2024-11-08 10:54:32+00:00,[],2024-12-10 00:11:33+00:00,2024-11-25 14:42:15+00:00,https://github.com/frappe/erpnext/issues/44041,"[('bug', None)]",[],
2643435675,issue,closed,completed,Payment terms not visible in payment schedule table after selecting the payment term template,"### Information about bug

After selecting the payment term template the payment terms are auto populated in the payment schedule table but currently the payment schedule table is not getting auto filled this error occured after current release of the erpnext 
![purchase issue](https://github.com/user-attachments/assets/2631ef4d-b656-4d79-9b92-cc8648039748)
if i save the purchase order after selecting the payment terms template with 2 terms that are not getting reflected in the table but when im trying to save the purchase order then im getting error for due date same for 2 terms

### Module

buying

### Version

ERPNext: v14.75.0 (HEAD)
Frappe Framework: v14.85.0 (HEAD)
Helpdesk: v0.10.0 (HEAD)
Frappe HR: v14.35.0 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",nikitadattapawar06,2024-11-08 09:29:12+00:00,[],2024-11-30 00:10:46+00:00,2024-11-11 07:34:55+00:00,https://github.com/frappe/erpnext/issues/44039,"[('bug', None), ('released', None)]","[{'comment_id': 2464822124, 'issue_id': 2643435675, 'author': 'shaikhmk73', 'body': 'It seems there’s no explicit trigger or function call here that auto-populates or updates the Payment Schedule table when a Payment Terms Template is selected. To resolve this, a method could be added to force a reload or calculation of payment terms when a template is selected.\r\n\r\nBelow is the suggestion:\r\n\r\nAdd the following function to handle updates to the payment schedule when terms are added or changed.\r\n\r\npayment_terms_template.js\r\n\r\n    terms_add: function(frm) {\r\n        // Trigger update_payment_schedule when a term is added\r\n        frm.trigger(""update_payment_schedule"");\r\n    },\r\n\r\n    update_payment_schedule: function(frm) {\r\n        frappe.call({\r\n            method: ""erpnext.accounts.doctype.payment_terms_template.payment_terms_template.update_payment_schedule"",\r\n            args: {\r\n                template_name: frm.doc.name,\r\n                schedule: frm.doc.terms\r\n            },\r\n            callback: function(r) {\r\n                if (r.message) {\r\n                    frm.set_value(""payment_schedule"", r.message);\r\n                    frm.refresh_field(""payment_schedule"");\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n\r\nIn payment_terms_template.py, add a new method to calculate the payment schedule:\r\n\r\n\r\n@frappe.whitelist()\r\ndef update_payment_schedule(template_name, schedule):\r\n    template = frappe.get_doc(""Payment Terms Template"", template_name)\r\n    payment_schedule = []\r\n    \r\n    for term in template.terms:\r\n        schedule_entry = {\r\n            ""payment_term"": term.payment_term,\r\n            ""due_date"": calculate_due_date(term),\r\n            ""invoice_portion"": term.invoice_portion,\r\n            ""payment_amount"": calculate_payment_amount(term)\r\n        }\r\n        payment_schedule.append(schedule_entry)\r\n    \r\n    return payment_schedule\r\n\r\ndef calculate_due_date(term):\r\n    # Placeholder for your due date calculation logic\r\n    return term.due_date  # Adjust this as needed\r\n\r\ndef calculate_payment_amount(term):\r\n    # Placeholder for payment amount calculation logic\r\n    return term.amount  # Adjust this as needed\r\n    \r\n    \r\n I believe above changes will enable the Payment Schedule to auto-populate based on the selected Payment Terms Template.', 'created_at': datetime.datetime(2024, 11, 8, 13, 52, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2467209699, 'issue_id': 2643435675, 'author': 'nikitadattapawar06', 'body': ""Thank you for your reply but I'm currently using the on cloud instance of erpnext is there anything that i can do to solve this issue"", 'created_at': datetime.datetime(2024, 11, 11, 4, 29, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2473869442, 'issue_id': 2643435675, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.76.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.76.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 11, 13, 15, 1, 28, tzinfo=datetime.timezone.utc)}]","shaikhmk73 on (2024-11-08 13:52:59 UTC): It seems there’s no explicit trigger or function call here that auto-populates or updates the Payment Schedule table when a Payment Terms Template is selected. To resolve this, a method could be added to force a reload or calculation of payment terms when a template is selected.

Below is the suggestion:

Add the following function to handle updates to the payment schedule when terms are added or changed.

payment_terms_template.js

    terms_add: function(frm) {
        // Trigger update_payment_schedule when a term is added
        frm.trigger(""update_payment_schedule"");
    },

    update_payment_schedule: function(frm) {
        frappe.call({
            method: ""erpnext.accounts.doctype.payment_terms_template.payment_terms_template.update_payment_schedule"",
            args: {
                template_name: frm.doc.name,
                schedule: frm.doc.terms
            },
            callback: function(r) {
                if (r.message) {
                    frm.set_value(""payment_schedule"", r.message);
                    frm.refresh_field(""payment_schedule"");
                }
            }
        });
    }



In payment_terms_template.py, add a new method to calculate the payment schedule:


@frappe.whitelist()
def update_payment_schedule(template_name, schedule):
    template = frappe.get_doc(""Payment Terms Template"", template_name)
    payment_schedule = []
    
    for term in template.terms:
        schedule_entry = {
            ""payment_term"": term.payment_term,
            ""due_date"": calculate_due_date(term),
            ""invoice_portion"": term.invoice_portion,
            ""payment_amount"": calculate_payment_amount(term)
        }
        payment_schedule.append(schedule_entry)
    
    return payment_schedule

def calculate_due_date(term):
    # Placeholder for your due date calculation logic
    return term.due_date  # Adjust this as needed

def calculate_payment_amount(term):
    # Placeholder for payment amount calculation logic
    return term.amount  # Adjust this as needed
    
    
 I believe above changes will enable the Payment Schedule to auto-populate based on the selected Payment Terms Template.

nikitadattapawar06 (Issue Creator) on (2024-11-11 04:29:34 UTC): Thank you for your reply but I'm currently using the on cloud instance of erpnext is there anything that i can do to solve this issue

frappe-pr-bot on (2024-11-13 15:01:28 UTC): :tada: This issue has been resolved in version 14.76.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.76.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2642338940,issue,closed,completed,DropShip Address is not maintained from Sales Order to Purchase Order,"### Information about bug

When dropshipping an order with all items marked as ""Delivered by Supplier"", after creating the Purchase Order from the Sales Order, the Shipping Address reverts back to the Company Address instead of being the Customer Shipping Address.

This issue breaks the whole idea of Drop Shipping on ERP Next. It started to appear after upgrading to latest version.

### Module

buying, selling

### Version

ERPNext: v15.40.0 (HEAD)
Frappe Framework: v15.46.0 (HEAD)
Frappe HR: v15.33.2 (HEAD)
Frappe Insights: v2.2.6 (HEAD)
Raven: v2.0.0 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",NassimBentarka,2024-11-07 22:28:40+00:00,[],2024-11-30 00:10:46+00:00,2024-11-13 10:00:46+00:00,https://github.com/frappe/erpnext/issues/44019,"[('bug', None), ('released', None)]","[{'comment_id': 2463362571, 'issue_id': 2642338940, 'author': 'NassimBentarka', 'body': 'Also, I noticed that this issue is specifically affects/happens on Sales Orders that were previously created off of a Quotation.', 'created_at': datetime.datetime(2024, 11, 7, 22, 35, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2473869307, 'issue_id': 2642338940, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.76.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.76.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 11, 13, 15, 1, 25, tzinfo=datetime.timezone.utc)}]","NassimBentarka (Issue Creator) on (2024-11-07 22:35:03 UTC): Also, I noticed that this issue is specifically affects/happens on Sales Orders that were previously created off of a Quotation.

frappe-pr-bot on (2024-11-13 15:01:25 UTC): :tada: This issue has been resolved in version 14.76.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.76.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2641481796,issue,closed,completed,Incorrect calculation for Provisional Profit/Loss (Credit),"### Information about bug

The Provisional Profit / Loss (Credit) should be calculated as:
Total Asset−(Total Liability+Total Equity) 
When I look at my balance sheet report, I see inconsistencies.

Expected:
179.372,31 - (11.255,87 + 168.116,44 ) =   0  
Actual Result 
179.372,31 - (11.255,87 + 168.116,44 ) =    -17.000,00

![image](https://github.com/user-attachments/assets/c6a241f9-7e0e-4e46-92ea-ba91326206be)
![image](https://github.com/user-attachments/assets/b09f26d5-18fb-4a20-a2b5-50a1cebf6bfb)


### Module

accounts

### Version

ERPNext: v15.32.1

Frappe Framework: v15.37.0

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",dryk0127,2024-11-07 16:04:05+00:00,[],2024-11-24 00:11:48+00:00,2024-11-08 16:58:50+00:00,https://github.com/frappe/erpnext/issues/44017,"[('bug', None)]","[{'comment_id': 2463836434, 'issue_id': 2641481796, 'author': 'Nihantra-Patel', 'body': 'Please update your version because your version is old and lots of changes made in last 2 months: https://github.com/frappe/erpnext/pull/43426\r\n\r\nCurrent Version is:\r\n\r\n```\r\nERPNext: v15.41.1 (version-15)\r\nFrappe Framework: v15.47.1 (version-15)\r\n```', 'created_at': datetime.datetime(2024, 11, 8, 5, 48, 43, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-08 05:48:43 UTC): Please update your version because your version is old and lots of changes made in last 2 months: https://github.com/frappe/erpnext/pull/43426

Current Version is:

```
ERPNext: v15.41.1 (version-15)
Frappe Framework: v15.47.1 (version-15)
```

"
2640947237,issue,closed,completed,PO status update,"### Information about bug

POs entered are received by entering a Purchase invoice. Update stock was checked and quantity and amount recieved was 101% of the PO amt. This was allowed in settings. Still it shows to Receive and Bill and following errors are there.

![Screenshot 2024-11-07 at 6 27 05 PM](https://github.com/user-attachments/assets/3df9e6de-0950-4a23-8286-b9d17cca857e)



### Module

accounts, buying

### Version


ERPNext: v15.40.0 (HEAD)

Frappe Framework: v15.46.0 (HEAD)

India Compliance: v15.13.5 (HEAD)

Frappe Insights: v2.2.6 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",nakul80,2024-11-07 12:57:48+00:00,[],2024-11-26 00:10:53+00:00,2024-11-11 08:46:06+00:00,https://github.com/frappe/erpnext/issues/44016,"[('bug', None)]","[{'comment_id': 2463848049, 'issue_id': 2640947237, 'author': 'Nihantra-Patel', 'body': ""We tested in the latest version but we haven't found the issue. for better understanding, you have to share a screenshot or video of the process.\r\n\r\n[scrnli_Tk91BDg6oBr7gO.webm](https://github.com/user-attachments/assets/d959c5b4-0a1b-4e9b-9566-451e5af6dded)"", 'created_at': datetime.datetime(2024, 11, 8, 5, 59, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2467515439, 'issue_id': 2640947237, 'author': 'nakul80', 'body': 'This is the PO\r\n![PO](https://github.com/user-attachments/assets/fa3db184-3707-4d31-8fef-f082d51a1874)\r\n\r\n\r\nThis is the status of the PO\r\n![PO Status](https://github.com/user-attachments/assets/33d7f91c-60db-4147-9076-43a70707090f)\r\n\r\nThis is the Invoice\r\n![Purchase Invoice](https://github.com/user-attachments/assets/dc0bf7a0-d585-4605-bfe4-67d413ad838e)\r\n\r\n\r\nPlease note that PO has been manually marked as Completed by me. \r\nQty and Amt both are higher in the Invoice as against the PO', 'created_at': datetime.datetime(2024, 11, 11, 8, 24, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2467524398, 'issue_id': 2640947237, 'author': 'Nihantra-Patel', 'body': 'How to manually mark as Completed?\r\n\r\nThere is no direct option to mark as Completed, but you can close and hold it. If you want to restrict applying the same rate on purchase transactions, go to the Buying Settings and enable the ""Maintain Same Rate Throughout the Purchase Cycle"" option.', 'created_at': datetime.datetime(2024, 11, 11, 8, 29, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2467544483, 'issue_id': 2640947237, 'author': 'nakul80', 'body': 'Sorry I meant marked it as Closed.\r\n\r\n\r\nRegards,\r\nNakul\r\n\r\n\r\nOn Mon, 11 Nov 2024 at 13:59, Nihantra C. Patel ***@***.***>\r\nwrote:\r\n\r\n> How to manually mark as Completed?\r\n>\r\n> There is no direct option to mark as Completed, but you can close and hold\r\n> it. If you want to restrict applying the same rate on purchase\r\n> transactions, go to the Buying Settings and enable the ""Maintain Same Rate\r\n> Throughout the Purchase Cycle"" option.\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/frappe/erpnext/issues/44016#issuecomment-2467524398>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/APPSRLBQSJRCF7RNLHGSBZD2ABTGHAVCNFSM6AAAAABRLESNV2VHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDINRXGUZDIMZZHA>\r\n> .\r\n> You are receiving this because you authored the thread.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 11, 11, 8, 38, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2467559323, 'issue_id': 2640947237, 'author': 'Nihantra-Patel', 'body': 'Purchase Order is closed means the status of the order is updated to ""Closed,"" but it does not affect the quantities or amounts in the system. The system will retain the originally ordered quantities and values, but no further transactions or updates are allowed.\r\n\r\nIt is typically used to prevent further actions on the order, even if there are remaining items that were not received.\r\n\r\nClosing a PO stops further actions from being taken but does not update the quantities or amounts in the system.\r\n\r\nI hope this clears your doubts.', 'created_at': datetime.datetime(2024, 11, 11, 8, 46, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2467713267, 'issue_id': 2640947237, 'author': 'nakul80', 'body': 'My doubt was not regarding Closed. As you can see, the quantity received\r\nand amount billed is more than the PO. Yet PO status shows less than 100%\r\nand there was showing as To Recieve and Bill as the status. I manually\r\nclosed it because of that. But status should never have shown less than\r\n100% if billing of qty and amt is more.\r\n\r\n\r\nRegards,\r\nNakul\r\n\r\n\r\nOn Mon, 11 Nov 2024 at 14:16, Nihantra C. Patel ***@***.***>\r\nwrote:\r\n\r\n> Purchase Order is closed means the status of the order is updated to\r\n> ""Closed,"" but it does not affect the quantities or amounts in the system.\r\n> The system will retain the originally ordered quantities and values, but no\r\n> further transactions or updates are allowed.\r\n>\r\n> It is typically used to prevent further actions on the order, even if\r\n> there are remaining items that were not received.\r\n>\r\n> Closing a PO stops further actions from being taken but does not update\r\n> the quantities or amounts in the system.\r\n>\r\n> I hope this clears your doubts.\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/frappe/erpnext/issues/44016#issuecomment-2467559323>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/APPSRLGPSXY5L5KUIXDZ4532ABVGHAVCNFSM6AAAAABRLESNV2VHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDINRXGU2TSMZSGM>\r\n> .\r\n> You are receiving this because you authored the thread.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 11, 11, 9, 57, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2467735442, 'issue_id': 2640947237, 'author': 'Nihantra-Patel', 'body': 'I reviewed both of your images. If the purchase invoice is fully paid, there’s no need to manually close the purchase order (PO). When the amount entered in the purchase invoice matches or exceeds the PO amount, the status should automatically set to ""Completed."" We tested this in 10-12 purchase orders and didn\'t find any issues. However, a custom client or server script could interfere with the status update.\r\n\r\nIf you\'re expecting the ""Completed"" status after full payment, remember that it should automatically update when you submit the purchase invoice, which then reflects on the PO. I suggest creating a new purchase order, then generating a purchase invoice from it to see if the process works as expected.', 'created_at': datetime.datetime(2024, 11, 11, 10, 5, 45, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-08 05:59:43 UTC): We tested in the latest version but we haven't found the issue. for better understanding, you have to share a screenshot or video of the process.

[scrnli_Tk91BDg6oBr7gO.webm](https://github.com/user-attachments/assets/d959c5b4-0a1b-4e9b-9566-451e5af6dded)

nakul80 (Issue Creator) on (2024-11-11 08:24:12 UTC): This is the PO
![PO](https://github.com/user-attachments/assets/fa3db184-3707-4d31-8fef-f082d51a1874)


This is the status of the PO
![PO Status](https://github.com/user-attachments/assets/33d7f91c-60db-4147-9076-43a70707090f)

This is the Invoice
![Purchase Invoice](https://github.com/user-attachments/assets/dc0bf7a0-d585-4605-bfe4-67d413ad838e)


Please note that PO has been manually marked as Completed by me. 
Qty and Amt both are higher in the Invoice as against the PO

Nihantra-Patel on (2024-11-11 08:29:01 UTC): How to manually mark as Completed?

There is no direct option to mark as Completed, but you can close and hold it. If you want to restrict applying the same rate on purchase transactions, go to the Buying Settings and enable the ""Maintain Same Rate Throughout the Purchase Cycle"" option.

nakul80 (Issue Creator) on (2024-11-11 08:38:53 UTC): Sorry I meant marked it as Closed.


Regards,
Nakul


On Mon, 11 Nov 2024 at 13:59, Nihantra C. Patel ***@***.***>
wrote:

Nihantra-Patel on (2024-11-11 08:46:06 UTC): Purchase Order is closed means the status of the order is updated to ""Closed,"" but it does not affect the quantities or amounts in the system. The system will retain the originally ordered quantities and values, but no further transactions or updates are allowed.

It is typically used to prevent further actions on the order, even if there are remaining items that were not received.

Closing a PO stops further actions from being taken but does not update the quantities or amounts in the system.

I hope this clears your doubts.

nakul80 (Issue Creator) on (2024-11-11 09:57:50 UTC): My doubt was not regarding Closed. As you can see, the quantity received
and amount billed is more than the PO. Yet PO status shows less than 100%
and there was showing as To Recieve and Bill as the status. I manually
closed it because of that. But status should never have shown less than
100% if billing of qty and amt is more.


Regards,
Nakul


On Mon, 11 Nov 2024 at 14:16, Nihantra C. Patel ***@***.***>
wrote:

Nihantra-Patel on (2024-11-11 10:05:45 UTC): I reviewed both of your images. If the purchase invoice is fully paid, there’s no need to manually close the purchase order (PO). When the amount entered in the purchase invoice matches or exceeds the PO amount, the status should automatically set to ""Completed."" We tested this in 10-12 purchase orders and didn't find any issues. However, a custom client or server script could interfere with the status update.

If you're expecting the ""Completed"" status after full payment, remember that it should automatically update when you submit the purchase invoice, which then reflects on the PO. I suggest creating a new purchase order, then generating a purchase invoice from it to see if the process works as expected.

"
2640777941,issue,closed,completed,Issue: Splitting a batch with STE-Repack purpose does not split,"### Information about bug

I just upgraded version from v13 to v15 with docker frappe+erpnext installation method & everythings looks good.
But when I tried to split a batch using StockEntry - Repack Purpose with BOM the result does not split the batch after submitted. Is this consider a bug or there's feature / updates on business process in certain version?

<details><summary>Details on the use case</summary>
<p>
- on the left side (source), nos enabled (serialized, lets say item-A with SN-A), 1 item, qty = 1<br>
- on the right side (target), 3 items (1 item is nos enabled serialized, item-B), qty each = 1<br>
when using v13 this case resulting:<br>
- Item-A is replaced with 3 items, one of them is Item-B with SN-A<br>
- the serial no is changed from item-A to item-B<br>
- which is correct<br>
but when using v15 this case resulting:<br>
- Item-A still intact to the serial no (does not replaced with the item-B)<br>
- but the ledger says the qty of Item-A is reduced & item-B is increased<br>
- which is dont know, is it intended to be that or..?<br>
- is this related to the new SABB also?<br>
</p>
</details>

Thank you

### Module

stock

### Version

ERPNext: v15.41.0
Frappe Framework: v15.47.0

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",YamadaKaito,2024-11-07 11:43:07+00:00,[],2024-12-02 00:11:33+00:00,2024-11-14 05:07:23+00:00,https://github.com/frappe/erpnext/issues/44015,"[('bug', None)]","[{'comment_id': 2475427502, 'issue_id': 2640777941, 'author': 'rohitwaghchaure', 'body': '@YamadaKaito In v13 we were allowing but that was not a proper way. It was causing a lot of problem with the valuation. Better you create the one serial no for one item. Also you can add custom field in which you can keep the non-unique value in that field for two different serial nos.\r\n\r\nFor example\r\n\r\nItem A has unique serial No SN-00001 with non-unique value SND-0001 (Custom field)\r\nItem B has unique serial No SN-00002 with non-unique value SND-0001 (Custom field)', 'created_at': datetime.datetime(2024, 11, 14, 5, 7, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2481265919, 'issue_id': 2640777941, 'author': 'YamadaKaito', 'body': 'Hi @rohitwaghchaure thank you for the reply..\r\nI see, so if according to my case, how to do a simple assembly & disassembly process without going through the work-order manufacture process? & this is what i find this far:\r\n1. STE-Manufacture to replicate the repack purpose (from materials to finished good) but yes using additional custom field as non-unique value (additional SN on my case)\r\n2. STE-Disassemble to replicate the repack purpose but with opposite (from finished good back to materials), but how to skip the mandatory which needed to create work order for this purpose?\r\n\r\nIs this the correct way?\r\nThank you', 'created_at': datetime.datetime(2024, 11, 17, 13, 24, 36, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure on (2024-11-14 05:07:23 UTC): @YamadaKaito In v13 we were allowing but that was not a proper way. It was causing a lot of problem with the valuation. Better you create the one serial no for one item. Also you can add custom field in which you can keep the non-unique value in that field for two different serial nos.

For example

Item A has unique serial No SN-00001 with non-unique value SND-0001 (Custom field)
Item B has unique serial No SN-00002 with non-unique value SND-0001 (Custom field)

YamadaKaito (Issue Creator) on (2024-11-17 13:24:36 UTC): Hi @rohitwaghchaure thank you for the reply..
I see, so if according to my case, how to do a simple assembly & disassembly process without going through the work-order manufacture process? & this is what i find this far:
1. STE-Manufacture to replicate the repack purpose (from materials to finished good) but yes using additional custom field as non-unique value (additional SN on my case)
2. STE-Disassemble to replicate the repack purpose but with opposite (from finished good back to materials), but how to skip the mandatory which needed to create work order for this purpose?

Is this the correct way?
Thank you

"
2640634321,issue,closed,completed,"pymysql.err.OperationalError: (1054, ""Unknown column 'tabSubcontracting Receipt.purchase_order' in 'where clause'"")","### Information about bug

After system update this server error appear when viewing a purchase order record:

`pymysql.err.OperationalError: (1054, ""Unknown column 'tabSubcontracting Receipt.purchase_order' in 'where clause'"")`


### Module

buying

### Version

ERPNext: v14.75.0 (HEAD)

Frappe Framework: v14.85.0 (HEAD)

Frappe HR: v14.35.0 (HEAD)

Frappe LMS: v2.9.0 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
`### App Versions

{
	""erpnext"": ""14.75.0"",
	""frappe"": ""14.85.0"",
	""hrms"": ""14.35.0"",
	""lms"": ""2.9.0""
}
```
### Route
```
Form/Purchase Order/PUR-ORD-2024-00032
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 97, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 48, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 86, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1619, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/__init__.py"", line 815, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
  File ""apps/frappe/frappe/desk/notifications.py"", line 293, in get_open_count
    external_links_data_for_d = get_external_links(d, name, links)
  File ""apps/frappe/frappe/desk/notifications.py"", line 340, in get_external_links
    total_count = get_doc_count(doctype, filters)
  File ""apps/frappe/frappe/desk/notifications.py"", line 352, in get_doc_count
    frappe.get_all(
  File ""apps/frappe/frappe/__init__.py"", line 1938, in get_all
    return get_list(doctype, *args, **kwargs)
  File ""apps/frappe/frappe/__init__.py"", line 1910, in get_list
    return frappe.model.db_query.DatabaseQuery(doctype).execute(*args, **kwargs)
  File ""apps/frappe/frappe/model/db_query.py"", line 190, in execute
    result = self.build_and_run()
  File ""apps/frappe/frappe/model/db_query.py"", line 231, in build_and_run
    return frappe.db.sql(
  File ""apps/frappe/frappe/database/database.py"", line 244, in sql
    self._cursor.execute(query, values)
  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 153, in execute
    result = self._query(query)
  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 322, in _query
    conn.query(q)
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 825, in _read_query_result
    result.read()
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 1199, in read
    first_packet = self.connection._read_packet()
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 775, in _read_packet
    packet.raise_for_error()
  File ""env/lib/python3.10/site-packages/pymysql/protocol.py"", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File ""env/lib/python3.10/site-packages/pymysql/err.py"", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, ""Unknown column 'tabSubcontracting Receipt.purchase_order' in 'where clause'"")

```
### Request Data
```
{
	""type"": ""GET"",
	""args"": {
		""doctype"": ""Purchase Order"",
		""name"": ""PUR-ORD-2024-00032"",
		""items"": ""[\""Purchase Receipt\"",\""Purchase Invoice\"",\""Sales Order\"",\""Payment Entry\"",\""Journal Entry\"",\""Payment Request\"",\""Supplier Quotation\"",\""Project\"",\""Auto Repeat\"",\""Material Request\"",\""BOM\"",\""Production Plan\"",\""Blanket Order\"",\""Subcontracting Order\"",\""Subcontracting Receipt\"",\""Stock Entry\"",\""Sales Order\""]""
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.notifications.get_open_count""
}
```
### Response Data
```
{
	""exception"": ""pymysql.err.OperationalError: (1054, \""Unknown column 'tabSubcontracting Receipt.purchase_order' in 'where clause'\"")""
}
````
```
",Ponyooooo,2024-11-07 10:48:54+00:00,[],2024-11-24 00:11:49+00:00,2024-11-08 06:57:01+00:00,https://github.com/frappe/erpnext/issues/44013,"[('bug', None)]","[{'comment_id': 2463909863, 'issue_id': 2640634321, 'author': 'Nihantra-Patel', 'body': 'Issue has been fixed: https://github.com/frappe/erpnext/pull/44014', 'created_at': datetime.datetime(2024, 11, 8, 6, 57, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2463946752, 'issue_id': 2640634321, 'author': 'nikitadattapawar06', 'body': ""I'm encountering the same error on my cloud instance of ERPNext. How can I resolve this issue?"", 'created_at': datetime.datetime(2024, 11, 8, 7, 26, 5, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-08 06:57:01 UTC): Issue has been fixed: https://github.com/frappe/erpnext/pull/44014

nikitadattapawar06 on (2024-11-08 07:26:05 UTC): I'm encountering the same error on my cloud instance of ERPNext. How can I resolve this issue?

"
2640605106,issue,closed,completed,POS Bug With Multi Item Price Or Item in Many Warehouse,"### Information about bug

### _**POS Show Some Item Multi Time In POS Page.**_
**I Follow This Bug Found The Reason Is:**
    1 - Item Had More than one Item Price
    2 - Item In More Than one Warehouse

### Module

accounts

### Version

Frappe Version - 15.45.1 ERPNext Version 15.39.3

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",amrbasha900,2024-11-07 10:39:40+00:00,[],2024-11-24 00:11:50+00:00,2024-11-08 07:13:04+00:00,https://github.com/frappe/erpnext/issues/44011,"[('bug', None)]",[],
2640270965,issue,closed,completed,Department Doctype is not not found after the update,"### Information about bug

Department Doctype is not not found after the update.

### Module

HR

### Version

ERPNext: v15.41.0 (version-15)
Frappe Framework: v15.47.1 (version-15)
Frappe HR: v16.0.0-dev (develop)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",khourytony,2024-11-07 08:38:36+00:00,[],2024-11-24 00:11:52+00:00,2024-11-08 07:03:24+00:00,https://github.com/frappe/erpnext/issues/44009,"[('bug', None)]","[{'comment_id': 2463917405, 'issue_id': 2640270965, 'author': 'Nihantra-Patel', 'body': 'I’ve shared a suggestion:\r\nIf you’ve installed ERPNext in version 15, make sure the hrms is also in version 15 to prevent errors.\r\n\r\nAlso check the latest version 15 and develop branch, Department doctype show properly.\r\n\r\n![image](https://github.com/user-attachments/assets/67ade10c-a493-45f6-8fcd-b3885c7dfa5b)\r\n\r\n\r\nAlso check, if user has not right of Department doctype then give them from the [Role Permission Manager](https://docs.erpnext.com/docs/user/manual/en/role-based-permissions)', 'created_at': datetime.datetime(2024, 11, 8, 7, 3, 25, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-08 07:03:25 UTC): I’ve shared a suggestion:
If you’ve installed ERPNext in version 15, make sure the hrms is also in version 15 to prevent errors.

Also check the latest version 15 and develop branch, Department doctype show properly.

![image](https://github.com/user-attachments/assets/67ade10c-a493-45f6-8fcd-b3885c7dfa5b)


Also check, if user has not right of Department doctype then give them from the [Role Permission Manager](https://docs.erpnext.com/docs/user/manual/en/role-based-permissions)

"
2638637986,issue,closed,completed,Stock Workspace Permission,"### Information about bug

Stock Workspace is permitted only to role - Workspace Manager.

It should be associated with better meaningful ROLE.

### Module

stock

### Version

Frappe - v15.47.0
ERPNext - 15.40.0

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",akashdubey22,2024-11-06 16:38:38+00:00,[],2024-11-24 00:12:03+00:00,2024-11-07 04:30:16+00:00,https://github.com/frappe/erpnext/issues/44000,"[('bug', None)]","[{'comment_id': 2461296127, 'issue_id': 2638637986, 'author': 'Nihantra-Patel', 'body': ""You must have set it yourself because by default, it doesn't come set in ERPNext and secondly, there is no role link in the stock workspace. If you want to assign a particular role, set it in the role table.\r\n\r\n![image](https://github.com/user-attachments/assets/ca4673cb-fb4d-4895-8c65-55c553176941)\r\n\r\nIf have a any doubt then raise the issue on the https://discuss.frappe.io"", 'created_at': datetime.datetime(2024, 11, 7, 4, 30, 17, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-07 04:30:17 UTC): You must have set it yourself because by default, it doesn't come set in ERPNext and secondly, there is no role link in the stock workspace. If you want to assign a particular role, set it in the role table.

![image](https://github.com/user-attachments/assets/ca4673cb-fb4d-4895-8c65-55c553176941)

If have a any doubt then raise the issue on the https://discuss.frappe.io

"
2638278574,issue,closed,completed,Process Deferred Accounting pymysql.err.ProgrammingError,"### Information about bug

pymysql.err.ProgrammingError: (1064, ""You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '1203-01-02-01 - LICENCIAS Y SOFTWARE - PTK''' at line 6"")
Possible source of error: erpnext (app)

![image](https://github.com/user-attachments/assets/6d50b2a7-bd70-441b-bcf4-30655503eec5)


### Module

assets

### Version

- ERPNext: v15.41.0
- Frappe Framework: v15.47.0
- Helpdesk: v1.0.0
- Frappe HR: v15.34.0
- Frappe Lending: v0.0.1
- Print Designer: v1.4.3

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
Syntax error in query:
select distinct item.parent
		from `tabPurchase Invoice Item` item, `tabPurchase Invoice` p
		where item.service_start_date<=%s and item.service_end_date>=%s
		and item.enable_deferred_expense = 1 and item.parent=p.name
		and item.docstatus = 1 and coalesce(item.amount, 0) > 0
		AND item.deferred_expense_account=''1203-01-02-01 - LICENCIAS Y SOFTWARE - PTK'' ('2024-10-30', '2024-09-30')

{
    ""doc"": ""{\""name\"":\""ACC-PDA-00051\"",\""owner\"":\""mcastillo@protelca.com\"",\""creation\"":\""2024-11-06 08:03:32.072493\"",\""modified\"":\""2024-11-06 08:16:11.207052\"",\""modified_by\"":\""Administrator\"",\""docstatus\"":0,\""idx\"":0,\""company\"":\""PROTELCA\"",\""type\"":\""Expense\"",\""account\"":\""1203-01-02-01 - LICENCIAS Y SOFTWARE - PTK\"",\""posting_date\"":\""2024-10-30\"",\""start_date\"":\""2024-09-30\"",\""end_date\"":\""2024-10-30\"",\""doctype\"":\""Process Deferred Accounting\"",\""__last_sync_on\"":\""2024-11-06T14:32:04.920Z\""}"",
    ""action"": ""Submit""
}

pymysql.err.ProgrammingError: (1064, ""You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '1203-01-02-01 - LICENCIAS Y SOFTWARE - PTK''' at line 6"")
```
",albertfns,2024-11-06 14:37:28+00:00,[],2024-11-24 00:12:02+00:00,2024-11-07 04:32:07+00:00,https://github.com/frappe/erpnext/issues/43998,"[('bug', None)]","[{'comment_id': 2461297687, 'issue_id': 2638278574, 'author': 'Nihantra-Patel', 'body': 'Issue has been fixed: https://github.com/frappe/erpnext/pull/43985', 'created_at': datetime.datetime(2024, 11, 7, 4, 32, 7, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-07 04:32:07 UTC): Issue has been fixed: https://github.com/frappe/erpnext/pull/43985

"
2637321476,issue,closed,completed,Cannot map because following condition fails: docstatus=1,"### Information about bug

While getting items from material request in purchase order, the list is showing the cancelled and draft material requests as well. 

![image](https://github.com/user-attachments/assets/a5dc86d2-669e-4325-8d57-6e32b6326bca)

![image](https://github.com/user-attachments/assets/89b19735-5cad-4979-8d31-22c6922acd5e)

Hence while getting items, it is showing below error:

![image](https://github.com/user-attachments/assets/c473e2a7-ca0f-4da4-ba14-289aa8e58c73)


### Module

buying

### Version

ERPNext: v15.35.1 (HEAD)
Frappe Framework: v15.40.6 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1775, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/mapper.py"", line 53, in map_docs
    target_doc = method(*_args)
                 ^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/stock/doctype/material_request/material_request.py"", line 435, in make_purchase_order
    doclist = get_mapped_doc(
              ^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/mapper.py"", line 93, in get_mapped_doc
    map_doc(source_doc, target_doc, table_maps[source_doc.doctype])
  File ""apps/frappe/frappe/model/mapper.py"", line 170, in map_doc
    frappe.throw(
  File ""apps/frappe/frappe/__init__.py"", line 652, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 617, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 568, in _raise_exception
    raise exc
frappe.exceptions.ValidationError: Cannot map because following condition fails: docstatus=1
```
",Craftint,2024-11-06 07:58:26+00:00,[],2024-11-24 00:11:59+00:00,2024-11-06 11:15:47+00:00,https://github.com/frappe/erpnext/issues/43992,"[('bug', None)]","[{'comment_id': 2459472553, 'issue_id': 2637321476, 'author': 'Nihantra-Patel', 'body': 'We tested in the latest version and also defined docstatus 1 in the below code. please check line no. 550\r\n\r\nhttps://github.com/frappe/erpnext/blob/9ccdb987d9deb844a1126fba1e33c55367484631/erpnext/buying/doctype/purchase_order/purchase_order.js#L536-L561\r\n\r\n![image](https://github.com/user-attachments/assets/e39d3960-c33f-4c19-95e5-8f430233c878)\r\n\r\n\r\n![image](https://github.com/user-attachments/assets/66cb588e-3b6f-47e7-93b9-fbb96a9b36fb)', 'created_at': datetime.datetime(2024, 11, 6, 11, 15, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461349212, 'issue_id': 2637321476, 'author': 'Craftint', 'body': 'As you can see in the screenshot, it is showing with the latest version itself. Its not showing for all. Whichever is coming by default in the list, it is not filtered.\r\n\r\n![image](https://github.com/user-attachments/assets/b981a436-1cf8-4688-8804-f9af77f6f5c6)\r\n\r\n![image](https://github.com/user-attachments/assets/831b9ef0-4462-481c-a861-41c452e70068)\r\n![image](https://github.com/user-attachments/assets/b4a87d11-92e2-4462-abab-7607be2b7192)\r\n\r\nIt is not showing if you are searching for old which is not part of the initial list\r\n\r\n![image](https://github.com/user-attachments/assets/92f9c266-1cfb-40a0-8f93-3e4cf09c065f)\r\n\r\n![image](https://github.com/user-attachments/assets/c1a1bde1-8e42-4c1e-8b3c-609e8c7f1327)', 'created_at': datetime.datetime(2024, 11, 7, 5, 28, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461354379, 'issue_id': 2637321476, 'author': 'Nihantra-Patel', 'body': ""I tested it with and without filters on the Frappe Cloud and also checked it locally, but I couldn't find this type of issue. I have already shared the code, and it appears to have the docstatus set to 1 correctly. If there is any custom code applied in the client script doctype or a custom app, please check that as well."", 'created_at': datetime.datetime(2024, 11, 7, 5, 33, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461380160, 'issue_id': 2637321476, 'author': 'Craftint', 'body': 'There is no customization. The site is on frappe cloud. \r\nAs mentioned, the initial list showing on the dialogue is not filtered somehow. \r\n\r\n![image](https://github.com/user-attachments/assets/3a3c9601-ee29-4b0b-b164-baaded9e108f)\r\n\r\nMAT-MR-2024-00003 which is in draft is also showing.\r\n\r\n![image](https://github.com/user-attachments/assets/956ed7dc-a9af-4520-a6fa-f1a9f87f37a5)\r\n\r\nIs there any way for you to access frappe cloud sites and check', 'created_at': datetime.datetime(2024, 11, 7, 5, 46, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461386671, 'issue_id': 2637321476, 'author': 'Nihantra-Patel', 'body': 'If your site have a support plan then raise the [support ticket](https://support.frappe.io/).', 'created_at': datetime.datetime(2024, 11, 7, 5, 53, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461394357, 'issue_id': 2637321476, 'author': 'Craftint', 'body': ""Site is under 25$ plan. Hence i don't think it will be covered :("", 'created_at': datetime.datetime(2024, 11, 7, 6, 0, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461395987, 'issue_id': 2637321476, 'author': 'Nihantra-Patel', 'body': 'Also, your version is old so please update it and again check it.', 'created_at': datetime.datetime(2024, 11, 7, 6, 1, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461409024, 'issue_id': 2637321476, 'author': 'Craftint', 'body': 'ERPNext: v15.40.0 (version-15)\r\n\r\nFrappe Framework: v15.46.0 (version-15)\r\n\r\nUpdated to latest', 'created_at': datetime.datetime(2024, 11, 7, 6, 12, 16, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-06 11:15:47 UTC): We tested in the latest version and also defined docstatus 1 in the below code. please check line no. 550

https://github.com/frappe/erpnext/blob/9ccdb987d9deb844a1126fba1e33c55367484631/erpnext/buying/doctype/purchase_order/purchase_order.js#L536-L561

![image](https://github.com/user-attachments/assets/e39d3960-c33f-4c19-95e5-8f430233c878)


![image](https://github.com/user-attachments/assets/66cb588e-3b6f-47e7-93b9-fbb96a9b36fb)

Craftint (Issue Creator) on (2024-11-07 05:28:35 UTC): As you can see in the screenshot, it is showing with the latest version itself. Its not showing for all. Whichever is coming by default in the list, it is not filtered.

![image](https://github.com/user-attachments/assets/b981a436-1cf8-4688-8804-f9af77f6f5c6)

![image](https://github.com/user-attachments/assets/831b9ef0-4462-481c-a861-41c452e70068)
![image](https://github.com/user-attachments/assets/b4a87d11-92e2-4462-abab-7607be2b7192)

It is not showing if you are searching for old which is not part of the initial list

![image](https://github.com/user-attachments/assets/92f9c266-1cfb-40a0-8f93-3e4cf09c065f)

![image](https://github.com/user-attachments/assets/c1a1bde1-8e42-4c1e-8b3c-609e8c7f1327)

Nihantra-Patel on (2024-11-07 05:33:46 UTC): I tested it with and without filters on the Frappe Cloud and also checked it locally, but I couldn't find this type of issue. I have already shared the code, and it appears to have the docstatus set to 1 correctly. If there is any custom code applied in the client script doctype or a custom app, please check that as well.

Craftint (Issue Creator) on (2024-11-07 05:46:51 UTC): There is no customization. The site is on frappe cloud. 
As mentioned, the initial list showing on the dialogue is not filtered somehow. 

![image](https://github.com/user-attachments/assets/3a3c9601-ee29-4b0b-b164-baaded9e108f)

MAT-MR-2024-00003 which is in draft is also showing.

![image](https://github.com/user-attachments/assets/956ed7dc-a9af-4520-a6fa-f1a9f87f37a5)

Is there any way for you to access frappe cloud sites and check

Nihantra-Patel on (2024-11-07 05:53:19 UTC): If your site have a support plan then raise the [support ticket](https://support.frappe.io/).

Craftint (Issue Creator) on (2024-11-07 06:00:38 UTC): Site is under 25$ plan. Hence i don't think it will be covered :(

Nihantra-Patel on (2024-11-07 06:01:58 UTC): Also, your version is old so please update it and again check it.

Craftint (Issue Creator) on (2024-11-07 06:12:16 UTC): ERPNext: v15.40.0 (version-15)

Frappe Framework: v15.46.0 (version-15)

Updated to latest

"
2637091642,issue,closed,completed,Flexible Subcontracting Orders for Multiple Finished Goods in a Single PO,"**Flexible Subcontracting Orders for Multiple Finished Goods in a Single PO**

**Objective**
Enable the ERPNext system to handle subcontracting orders more flexibly, allowing a single Purchase Order (PO) with multiple line items (each line item having its own specified finished good) to generate multiple Subcontracting Orders.

**Current Limitations**
1. **Single Subcontracting Order Per PO:** ERPNext currently restricts subcontracting processes to one subcontracting order per PO, limiting its flexibility when multiple line items are involved, each requiring unique FGs.
2. **Lack of Multi-Finished Goods Handling:** Each line item in a PO may correspond to a different finished good, requiring individual tracking and order management, but the current subcontracting process in ERPNext does not support this scenario effectively.

**Feature Request**
To address these limitations, we request the following enhancements:

1. **Support Multiple Subcontracting Orders from a Single PO:**

- When a PO contains multiple line items, each item should be able to generate a separate subcontracting order if required.
- The system should allow users to select specific line items for each subcontracting order, with associated raw materials, so subcontractors can complete the job efficiently.

2. **Individual Finished Goods Assignment:**

- Each line item in a PO should have the flexibility to specify a unique finished good. This would allow each subcontracting order created from the same PO to be managed with its distinct FG requirements.
- ERPNext should facilitate tracking and fulfillment based on these specific finished goods per subcontracting order.

3. **Subcontracting Order Status and Tracking Improvements:**

- Once multiple subcontracting orders are generated from a single PO, the status of each subcontracting order should be visible within the original PO view.
- A summary or log feature showing real-time updates on each subcontracting order would enhance visibility and tracking, especially for complex subcontracting processes involving multiple FGs.

**Scenario Example**

Purchase Order: PO-0001
Line Item 1: Component A ➔ FG-001
Line Item 2: Component B ➔ FG-002
Line Item 3: Component C ➔ FG-003

**Expected Workflow:**

1. The user creates PO-0001 with three line items, each specifying its component and corresponding FG.
2. ERPNext allows the user to generate three separate subcontracting orders from this PO, each order tied to a distinct FG (e.g., Subcontracting Order SC-0001 for FG-001, SC-0002 for FG-002, etc.).
3. Each subcontracting order can then be processed, tracked, and fulfilled individually.
4. The PO-0001 screen should display the status of each subcontracting order, offering a consolidated view of subcontracting status per line item.

**Benefits**

1. Increased Flexibility: Supports diverse manufacturing needs by handling multiple subcontracted items in one PO.
2. Improved Tracking: Allows better oversight of each finished good, improving order fulfillment accuracy.
3. Streamlined Operations: Reduces the need for workarounds or multiple POs, simplifying the subcontracting process.

This enhancement would make ERPNext more adaptable for users with complex subcontracting workflows, especially in manufacturing sectors where a single PO often covers various finished goods that require individual processing and tracking.",dipane,2024-11-06 05:36:30+00:00,[],2025-01-18 00:09:53+00:00,2025-01-03 10:41:25+00:00,https://github.com/frappe/erpnext/issues/43986,"[('feature-request', None)]",[],
2634930747,issue,closed,completed,POS Opening entry creation popup,"### Information about bug

1- While creating a new POS opening entry the list of saved POS profiles doesn't show i have to type the name of the profile each time i want to create a new pos opening entry.
2- There is no way to close the popup window if you wanted to cancel the creation.
![Capture](https://github.com/user-attachments/assets/04129189-dd18-42df-8f4b-c6e9c8be6bb6)



### Module

selling

### Version

v: 15.38.0

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",Ahmed8647,2024-11-05 09:38:02+00:00,[],2024-11-24 00:11:58+00:00,2024-11-07 04:39:57+00:00,https://github.com/frappe/erpnext/issues/43976,"[('bug', None)]","[{'comment_id': 2458692252, 'issue_id': 2634930747, 'author': 'Nihantra-Patel', 'body': 'If the POS Opening Entry is open, the popup will not appear. However, if the POS Opening Entry is closed, you must first enter the POS Opening Entry before creating a POS Invoice.', 'created_at': datetime.datetime(2024, 11, 6, 4, 14, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461474341, 'issue_id': 2634930747, 'author': 'Ahmed8647', 'body': '> If the POS Opening Entry is open, the popup will not appear. However, if the POS Opening Entry is closed, you must first enter the POS Opening Entry before creating a POS Invoice.\r\n\r\nHi Patel, thank you for the reply but I think you misunderstood the issue,\r\n![001](https://github.com/user-attachments/assets/9081f742-1d8e-417f-9c98-e4949ec93c34)\r\n![002](https://github.com/user-attachments/assets/7c3ceca6-bd93-4449-bd91-cc68001c5fc3)', 'created_at': datetime.datetime(2024, 11, 7, 7, 7, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461479286, 'issue_id': 2634930747, 'author': 'Nihantra-Patel', 'body': 'There is no close option because if there is close then how the entry of opening is done then run some logic, and second thing POS profile is created company wise, you may have created in some other company then create company wise POS profile and check.', 'created_at': datetime.datetime(2024, 11, 7, 7, 10, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461873162, 'issue_id': 2634930747, 'author': 'Ahmed8647', 'body': ""i have one company but i created a second profile the second showed but not the first, as for the close button i am aware that i can't use pos without the opening entry but if there was a close button that when you click on it redirects to the home screen if i wanted to cancel the operation, rather than go back then refresh the browser."", 'created_at': datetime.datetime(2024, 11, 7, 10, 31, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461891860, 'issue_id': 2634930747, 'author': 'Nihantra-Patel', 'body': ""First, you need to understand the basic POS flow to know how it works. Once you create a POS Opening Entry, it won't show up every time you open POS, but If you want to switch to a different company, you also need to close the current POS session with a POS Closing Entry and then create a new POS Opening Entry for the new company. You can't manage POS for multiple companies at the same time."", 'created_at': datetime.datetime(2024, 11, 7, 10, 39, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461900762, 'issue_id': 2634930747, 'author': 'Ahmed8647', 'body': 'Ok thank you, I will learn more about that.', 'created_at': datetime.datetime(2024, 11, 7, 10, 43, 37, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-06 04:14:58 UTC): If the POS Opening Entry is open, the popup will not appear. However, if the POS Opening Entry is closed, you must first enter the POS Opening Entry before creating a POS Invoice.

Ahmed8647 (Issue Creator) on (2024-11-07 07:07:07 UTC): Hi Patel, thank you for the reply but I think you misunderstood the issue,
![001](https://github.com/user-attachments/assets/9081f742-1d8e-417f-9c98-e4949ec93c34)
![002](https://github.com/user-attachments/assets/7c3ceca6-bd93-4449-bd91-cc68001c5fc3)

Nihantra-Patel on (2024-11-07 07:10:46 UTC): There is no close option because if there is close then how the entry of opening is done then run some logic, and second thing POS profile is created company wise, you may have created in some other company then create company wise POS profile and check.

Ahmed8647 (Issue Creator) on (2024-11-07 10:31:47 UTC): i have one company but i created a second profile the second showed but not the first, as for the close button i am aware that i can't use pos without the opening entry but if there was a close button that when you click on it redirects to the home screen if i wanted to cancel the operation, rather than go back then refresh the browser.

Nihantra-Patel on (2024-11-07 10:39:18 UTC): First, you need to understand the basic POS flow to know how it works. Once you create a POS Opening Entry, it won't show up every time you open POS, but If you want to switch to a different company, you also need to close the current POS session with a POS Closing Entry and then create a new POS Opening Entry for the new company. You can't manage POS for multiple companies at the same time.

Ahmed8647 (Issue Creator) on (2024-11-07 10:43:37 UTC): Ok thank you, I will learn more about that.

"
2633682751,issue,closed,completed,Sorting leads,"### Information about bug

I selected the sorting method for leads as ""Last Modified On"".
When I modify any lead internally (e.g. I send an email from the lead) it became to the top of the lead list.
However when the lead is modified externally (e.g. the lead receives an email from partner) then the concerned lead does not go to the top of the list.

### Module

CRM

### Version

No idea how to check it.

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",jballaballa,2024-11-04 19:39:38+00:00,[],2024-12-10 00:11:31+00:00,2024-11-06 04:25:20+00:00,https://github.com/frappe/erpnext/issues/43968,"[('bug', None)]","[{'comment_id': 2458700444, 'issue_id': 2633682751, 'author': 'Nihantra-Patel', 'body': 'The ""Last Modified On"" date updates only when a value on the form is changed. However, if you receive an email but don’t make any changes to the form, the ""Last Modified On"" will not update.', 'created_at': datetime.datetime(2024, 11, 6, 4, 25, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2459966699, 'issue_id': 2633682751, 'author': 'jballaballa', 'body': 'So, do you think ""It is not a bug, it is a feature""?\r\nI believe that the ""Last Modified On"" shall be updated if the Lead receives an email or I send and email from the lead.  It is a modification to the lead even if I changed nothing on the form.', 'created_at': datetime.datetime(2024, 11, 6, 14, 54, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2460284769, 'issue_id': 2633682751, 'author': 'Nihantra-Patel', 'body': 'No, I tried, if we send the mail from the lead then also ""Last Modified On"" not update. receiving and sending mail does not update the any doc. It has already been done like this.', 'created_at': datetime.datetime(2024, 11, 6, 16, 47, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2460345600, 'issue_id': 2633682751, 'author': 'jballaballa', 'body': 'My experience shows the same.  Sending and receiving email does not update the last modified on.  \r\nAnd this is the problem.  Sending and receiving email should have been update the last modified on.\r\nCan you amend the system to behave this way?', 'created_at': datetime.datetime(2024, 11, 6, 17, 13, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2466845173, 'issue_id': 2633682751, 'author': 'jballaballa', 'body': 'Can you see any chance to make the necessary modification in your system?', 'created_at': datetime.datetime(2024, 11, 10, 18, 53, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2466956333, 'issue_id': 2633682751, 'author': 'jballaballa', 'body': 'Dear Nihantra-Patel,\r\nSome additional information.\r\nIf you just send and email from the lead it will not be ""Last Modified On"".\r\nHowever if you send a quotation to the customer, the email with the quotation will be attached to the lead and the lead updated, it will jump on the top of the list.  Please note I did not modify anything in the lead, it just received an email with the quotation.\r\n\r\nIf the customer send me and email with address replies+...  (as it happened yesterday) it will be attached to the lead.  However I will not have information about that the lead received and email.  Should I recheck each lead every day to see if email has been received?  It is very much not user friendly, I hope you agree.\r\nPlease improve your system to make the lead ""Last Modified On"" if it receives an email or I just send an email from the lead.', 'created_at': datetime.datetime(2024, 11, 10, 22, 12, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2467186704, 'issue_id': 2633682751, 'author': 'Nihantra-Patel', 'body': ""It handles on the framework's side, not set for the particular doctype or event."", 'created_at': datetime.datetime(2024, 11, 11, 4, 2, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2467590379, 'issue_id': 2633682751, 'author': 'jballaballa', 'body': 'Your answer is totally unclear for me.  Please use terms of end users not developers.\r\nPlease answer these questions:\r\n1. Are you agree the problem I described is a real problem for the users?\r\n2. Are you agree your system does not work user friendly in this issue?\r\n3. Will you improve it?', 'created_at': datetime.datetime(2024, 11, 11, 9, 0, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2467620707, 'issue_id': 2633682751, 'author': 'Nihantra-Patel', 'body': '[scrnli_9Tfc1Rthp40l76.webm](https://github.com/user-attachments/assets/595ed1f4-4191-4287-bc11-54cb00e3dbb0)\r\n\r\nThank you for your detailed explanation. I understand your concern about the ""Last Modified On"" field not updating when emails are sent or received, even if the lead itself isn\'t modified.\r\n\r\nFrom our side, we tested this behavior, and as it stands, the ""Last Modified On"" field only updates when an actual change is made to the lead\'s form (like updating a field or modifying information). For instance, when an email is sent from the lead, the system doesn\'t treat it as a form modification, so the ""Last Modified On"" remains unchanged.\r\n\r\nHowever, when a quotation is sent and linked to the lead, the lead will update because the system recognizes the link as a form change. \r\n\r\nWe’ve not encountered the specific issue you mentioned in our tests. To help us investigate further and potentially improve the system, could you please share a video? This will allow us to replicate the issue on our side and take the necessary steps to address it.\r\n\r\nWe appreciate your feedback and are always looking for ways to improve the user experience.', 'created_at': datetime.datetime(2024, 11, 11, 9, 14, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2468575125, 'issue_id': 2633682751, 'author': 'jballaballa', 'body': 'Here is a list of my leads:\r\n![image](https://github.com/user-attachments/assets/77183a5e-d1b5-4dcc-a917-81622c0dc3ef)\r\nLet suppose the 8-th customer (Alex Control System FZE) sent me an inquiry in email.  The email will be attached to the lead however the lead remain on the 8-th place. \r\nSo that I have no information about his inquiry unless I check manually his lead.\r\nTo see if there is a new email attached to any lead I have to check manually ALL my leads.  Which is nonsense.\r\nIf the lead jumps on the top of the list I will know I have to check it because it has some news for me (it was modified few hours ago).\r\nSo my suggestion or request if you wish to modify the system in such a way that receiving or sending email to/from the lead taken as a modification and the last modified on field updated.\r\nIs it clear now or should I put more explanation?\r\nI cannot attach a video about some missed feature because it is missed.  No way to record it on video.', 'created_at': datetime.datetime(2024, 11, 11, 16, 28, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2480807810, 'issue_id': 2633682751, 'author': 'jballaballa', 'body': 'Any comment please.', 'created_at': datetime.datetime(2024, 11, 16, 20, 56, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2486447401, 'issue_id': 2633682751, 'author': 'jballaballa', 'body': 'Let me ask my previous questions:\r\nAre you agree the problem I described is a real problem for the users?\r\nAre you agree your system does not work user friendly in this issue?\r\nWill you improve it?', 'created_at': datetime.datetime(2024, 11, 19, 18, 27, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2499010143, 'issue_id': 2633682751, 'author': 'jballaballa', 'body': 'Does somebody read my comments?\r\nIf yes, why do no respond in any way?\r\nIf not, then why this comment area provided?', 'created_at': datetime.datetime(2024, 11, 25, 20, 52, 58, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-06 04:25:20 UTC): The ""Last Modified On"" date updates only when a value on the form is changed. However, if you receive an email but don’t make any changes to the form, the ""Last Modified On"" will not update.

jballaballa (Issue Creator) on (2024-11-06 14:54:10 UTC): So, do you think ""It is not a bug, it is a feature""?
I believe that the ""Last Modified On"" shall be updated if the Lead receives an email or I send and email from the lead.  It is a modification to the lead even if I changed nothing on the form.

Nihantra-Patel on (2024-11-06 16:47:13 UTC): No, I tried, if we send the mail from the lead then also ""Last Modified On"" not update. receiving and sending mail does not update the any doc. It has already been done like this.

jballaballa (Issue Creator) on (2024-11-06 17:13:46 UTC): My experience shows the same.  Sending and receiving email does not update the last modified on.  
And this is the problem.  Sending and receiving email should have been update the last modified on.
Can you amend the system to behave this way?

jballaballa (Issue Creator) on (2024-11-10 18:53:36 UTC): Can you see any chance to make the necessary modification in your system?

jballaballa (Issue Creator) on (2024-11-10 22:12:04 UTC): Dear Nihantra-Patel,
Some additional information.
If you just send and email from the lead it will not be ""Last Modified On"".
However if you send a quotation to the customer, the email with the quotation will be attached to the lead and the lead updated, it will jump on the top of the list.  Please note I did not modify anything in the lead, it just received an email with the quotation.

If the customer send me and email with address replies+...  (as it happened yesterday) it will be attached to the lead.  However I will not have information about that the lead received and email.  Should I recheck each lead every day to see if email has been received?  It is very much not user friendly, I hope you agree.
Please improve your system to make the lead ""Last Modified On"" if it receives an email or I just send an email from the lead.

Nihantra-Patel on (2024-11-11 04:02:21 UTC): It handles on the framework's side, not set for the particular doctype or event.

jballaballa (Issue Creator) on (2024-11-11 09:00:55 UTC): Your answer is totally unclear for me.  Please use terms of end users not developers.
Please answer these questions:
1. Are you agree the problem I described is a real problem for the users?
2. Are you agree your system does not work user friendly in this issue?
3. Will you improve it?

Nihantra-Patel on (2024-11-11 09:14:44 UTC): [scrnli_9Tfc1Rthp40l76.webm](https://github.com/user-attachments/assets/595ed1f4-4191-4287-bc11-54cb00e3dbb0)

Thank you for your detailed explanation. I understand your concern about the ""Last Modified On"" field not updating when emails are sent or received, even if the lead itself isn't modified.

From our side, we tested this behavior, and as it stands, the ""Last Modified On"" field only updates when an actual change is made to the lead's form (like updating a field or modifying information). For instance, when an email is sent from the lead, the system doesn't treat it as a form modification, so the ""Last Modified On"" remains unchanged.

However, when a quotation is sent and linked to the lead, the lead will update because the system recognizes the link as a form change. 

We’ve not encountered the specific issue you mentioned in our tests. To help us investigate further and potentially improve the system, could you please share a video? This will allow us to replicate the issue on our side and take the necessary steps to address it.

We appreciate your feedback and are always looking for ways to improve the user experience.

jballaballa (Issue Creator) on (2024-11-11 16:28:13 UTC): Here is a list of my leads:
![image](https://github.com/user-attachments/assets/77183a5e-d1b5-4dcc-a917-81622c0dc3ef)
Let suppose the 8-th customer (Alex Control System FZE) sent me an inquiry in email.  The email will be attached to the lead however the lead remain on the 8-th place. 
So that I have no information about his inquiry unless I check manually his lead.
To see if there is a new email attached to any lead I have to check manually ALL my leads.  Which is nonsense.
If the lead jumps on the top of the list I will know I have to check it because it has some news for me (it was modified few hours ago).
So my suggestion or request if you wish to modify the system in such a way that receiving or sending email to/from the lead taken as a modification and the last modified on field updated.
Is it clear now or should I put more explanation?
I cannot attach a video about some missed feature because it is missed.  No way to record it on video.

jballaballa (Issue Creator) on (2024-11-16 20:56:08 UTC): Any comment please.

jballaballa (Issue Creator) on (2024-11-19 18:27:09 UTC): Let me ask my previous questions:
Are you agree the problem I described is a real problem for the users?
Are you agree your system does not work user friendly in this issue?
Will you improve it?

jballaballa (Issue Creator) on (2024-11-25 20:52:58 UTC): Does somebody read my comments?
If yes, why do no respond in any way?
If not, then why this comment area provided?

"
2633092349,issue,open,,"Issue with Buying Settings ""Set Landed Cost Based on Purchase Invoice Rate""","### Information about bug

When creating a `Purchase Invoice` against a `Purchase Order` (which have `Purchase Receipt`), it won't update the the reception price in the stock ledger.

Steps:

- Activate `Buying Settings` ""Set Landed Cost Based on Purchase Invoice Rate""
- Create and Submit a `Purchase Order` for ItemA (has batch no)
- Create a `Purchase Receipt` against the `Purchase Order`. Split the ItemA into 3 different batches. Submit the `Purchase Receipt`.
- Create a `Purchase Invoice` against the `Purchase Order`. Update the ItemA price. Submit the `Purchase Invoice`.
- Execute `Item Repost Valuation` scheduled job.
- Check the `Stock Ledger` for ItemA, the new price enterred in `Purchase Invoice` won't be reflected.

Doing the same steps, but create the `Purchase Invoice` against the `Purchase Receipt` instead of the `Purchase Order`, and it works OK.

I think this is a bug, or at least very misleading. My users first instinct is to create the invoice against the `Purchase Order`. And they don't understand why the price isn't updated.


### Module

buying

### Version

ERPNext v14.74.8

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",guilmori,2024-11-04 15:14:33+00:00,[],2024-11-04 15:14:33+00:00,,https://github.com/frappe/erpnext/issues/43967,"[('bug', None)]",[],
2632140422,issue,closed,completed,Process Deferred Accounting submit error,"### Information about bug

![Screenshot from 2024-11-04 11-14-05](https://github.com/user-attachments/assets/e89c23bb-d14f-4286-a92c-4bdd3ce923a1)

The expected bug fix is to remove the single quotes wrapping frappe.db.escape(account) in build_condition(...) method in the deferred_revenue.py file (Line: 61).

Original Syntax is: 
60	if account:
61		conditions += f""AND {deferred_account}='{frappe.db.escape(account)}'""

Corrected Syntax:
60	if account:
61		conditions += f""AND {deferred_account} = {frappe.db.escape(account)}""  #Removed ' ' single quotes

### Module

accounts

### Version

Frappe  Version: 15.46.0
ERPNext Version: 15.40.0

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",QualityPoint,2024-11-04 08:19:31+00:00,[],2024-11-24 00:11:57+00:00,2024-11-06 06:32:30+00:00,https://github.com/frappe/erpnext/issues/43963,"[('bug', None), ('released', None)]","[{'comment_id': 2462148926, 'issue_id': 2632140422, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.75.1 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.75.1)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 11, 7, 12, 45, 13, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-11-07 12:45:13 UTC): :tada: This issue has been resolved in version 14.75.1 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.75.1)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2631910826,issue,closed,completed,Consolidate Items - Material Request/Purchase Order,"### Information about bug

There is no option to merge similar items.

![image](https://github.com/user-attachments/assets/858b6e20-a151-43a0-9f4c-45880276d48b)


### Module

stock

### Version

ERPNext: v15.x.x-develop () (develop)

Frappe Framework: v15.45.1 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",tajff,2024-11-04 05:54:03+00:00,[],2024-12-04 00:11:23+00:00,2024-11-06 06:59:53+00:00,https://github.com/frappe/erpnext/issues/43957,"[('bug', None)]","[{'comment_id': 2458853099, 'issue_id': 2631910826, 'author': 'Nihantra-Patel', 'body': 'The feature is not available yet, as users sometimes purchase the same material in different units of measurement (UOM), which makes it challenging to set or merge the item. However, you can implement logic on the client or server side to achieve this.\r\n\r\n\r\nFor Material Request:\r\n```py\r\nitem_qty = {}\r\nitems_to_delete = []\r\n\r\nfor item in doc.items:\r\n    item_code = item.item_code\r\n    \r\n    if item_code in item_qty:\r\n        item_qty[item_code] = item_qty[item_code] + item.qty\r\n        items_to_delete.append(item)\r\n    else:\r\n        item_qty[item_code] = item.qty\r\n\r\nfor item in items_to_delete:\r\n    doc.items.remove(item)\r\n\r\nfor item_code, qty in item_qty.items():\r\n    for item in doc.items:\r\n        if item.item_code == item_code:\r\n            item.qty = qty\r\n            break\r\n```', 'created_at': datetime.datetime(2024, 11, 6, 6, 59, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2484781606, 'issue_id': 2631910826, 'author': 'tajff', 'body': 'Thanks, it works\r\nI hope it is in the update , making sure of the different units', 'created_at': datetime.datetime(2024, 11, 19, 6, 6, 59, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-06 06:59:54 UTC): The feature is not available yet, as users sometimes purchase the same material in different units of measurement (UOM), which makes it challenging to set or merge the item. However, you can implement logic on the client or server side to achieve this.


For Material Request:
```py
item_qty = {}
items_to_delete = []

for item in doc.items:
    item_code = item.item_code
    
    if item_code in item_qty:
        item_qty[item_code] = item_qty[item_code] + item.qty
        items_to_delete.append(item)
    else:
        item_qty[item_code] = item.qty

for item in items_to_delete:
    doc.items.remove(item)

for item_code, qty in item_qty.items():
    for item in doc.items:
        if item.item_code == item_code:
            item.qty = qty
            break
```

tajff (Issue Creator) on (2024-11-19 06:06:59 UTC): Thanks, it works
I hope it is in the update , making sure of the different units

"
2632003756,issue,open,,Sales Order and Sales Invoice Item Rate Discount,"In Sales Invoice, I can either apply one discount to entire invoice using ""Additional Discount Option"" or apply a discount to price list. 

Practically, esp for small businesses, sometimes different discounts need to be applied to different items. Also, frequently small businesses do not have a standard price list rather they enter a rate and then apply a discount. to show to customer that s/he has been given a discount a discount may be applied to that rate. E.g. business ABC does not have a standard price list. A customer walks in and he is quoted price of USD 100 for product A and USD 50 for product B. After negotiations it is agreed that s/he will be given 20% discount on Product A and 10% discount on product B. Now since there is no standard price list the user needs to enter the rate and show discounts respectively on invoice. Currently this is not possible in ERPNext. I would request to de-link the discount field from price list rate and rather apply the discount to the rate field. The rate field is anyways updated based on standard price list where available. ",usman-alikhan,2024-11-03 19:21:32+00:00,[],2024-11-04 07:00:55+00:00,,https://github.com/frappe/erpnext/issues/43960,"[('feature-request', None)]",[],
2631285630,issue,closed,completed,CSS not Working after bench buld,"### Information about bug

After 'bench build'

i got this

Please help me 
![Screenshot at Nov 03 22-40-19](https://github.com/user-attachments/assets/fe3232c4-5423-4991-9f0f-29848839f919)


### Module

other

### Version

15.39.3

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",tranminhnhanchinh,2024-11-03 15:41:10+00:00,[],2024-11-21 00:10:49+00:00,2024-11-06 11:26:53+00:00,https://github.com/frappe/erpnext/issues/43954,"[('bug', None)]","[{'comment_id': 2459494279, 'issue_id': 2631285630, 'author': 'Nihantra-Patel', 'body': 'Please apply it\r\n\r\n```\r\nbench setup requirements\r\nbench build\r\nbench clear-cache\r\nbench clear-website-cache\r\n```\r\n\r\n```\r\nchmod -R o+rx /home/[frappe-user]\r\n\r\n// OR\r\n\r\nsudo chmod -R o+rx /home/frappe\r\n```\r\n\r\nIt’s not a bug. I think this is your first time manually installing it. If you have any doubts, feel free to raise an issue on https://discuss.frappe.io/.', 'created_at': datetime.datetime(2024, 11, 6, 11, 26, 53, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-06 11:26:53 UTC): Please apply it

```
bench setup requirements
bench build
bench clear-cache
bench clear-website-cache
```

```
chmod -R o+rx /home/[frappe-user]

// OR

sudo chmod -R o+rx /home/frappe
```

It’s not a bug. I think this is your first time manually installing it. If you have any doubts, feel free to raise an issue on https://discuss.frappe.io/.

"
2631039198,issue,closed,completed,JSONDecodeError in Sales Pipeline Analytics Doctype,"### Information about bug

In the ` check_for_assigned_to` method located in the **sales_pipeline_analytics** doctype, when `info.get(""opportunity_owner"")` returns a string that cannot be parsed as JSON, the `json.loads()` function raises a _JSONDecodeError_. This occurs when the value of `opportunity_owner` is not a valid JSON string.

**Code Snippet:**
```python
def check_for_assigned_to(self, period, value, count_or_amount, assigned_to, info):
    if self.filters.get(""assigned_to""):
        # Change here to check for assigned_to instead of opportunity_owner
        for data in json.loads(info.get(""assigned_to"") or ""[]""):
            if data == self.filters.get(""assigned_to""):
                self.set_formatted_data(period, data, count_or_amount, assigned_to)
    else:
        self.set_formatted_data(period, value, count_or_amount, assigned_to)
```

**Suggested Fix:**
Replace `json.loads(info.get(""opportunity_owner"") or ""[]"")` with the `assigned_to` input argument to avoid the error when opportunity_owner is a non-JSON string.



### Module

CRM

### Version

frappe 14.45.0
erpnext 14.35.2

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
**Error Message:**
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
```
",Triplem8360,2024-11-03 07:44:08+00:00,[],2024-11-24 00:12:01+00:00,2024-11-07 04:48:39+00:00,https://github.com/frappe/erpnext/issues/43952,"[('bug', None)]","[{'comment_id': 2453358305, 'issue_id': 2631039198, 'author': 'Triplem8360', 'body': 'This error occurs when the following filters are set in the report:\r\n\r\nPipeline by = Owner\r\nBased on = Amount', 'created_at': datetime.datetime(2024, 11, 3, 9, 29, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461311972, 'issue_id': 2631039198, 'author': 'Nihantra-Patel', 'body': ""Your version is old, we tested in below version but we haven't found the issue. code is updated so please check it on the latest version.\r\n\r\n```\r\nERPNext: v14.74.8 (version-14)\r\nFrappe Framework: v14.85.0 (version-14)\r\n```\r\n\r\nhttps://github.com/frappe/erpnext/blob/710771edf41b897d77f4235b0ec09f4dbfcd3b10/erpnext/crm/report/sales_pipeline_analytics/sales_pipeline_analytics.py#L230-L236"", 'created_at': datetime.datetime(2024, 11, 7, 4, 48, 40, tzinfo=datetime.timezone.utc)}]","Triplem8360 (Issue Creator) on (2024-11-03 09:29:39 UTC): This error occurs when the following filters are set in the report:

Pipeline by = Owner
Based on = Amount

Nihantra-Patel on (2024-11-07 04:48:40 UTC): Your version is old, we tested in below version but we haven't found the issue. code is updated so please check it on the latest version.

```
ERPNext: v14.74.8 (version-14)
Frappe Framework: v14.85.0 (version-14)
```

https://github.com/frappe/erpnext/blob/710771edf41b897d77f4235b0ec09f4dbfcd3b10/erpnext/crm/report/sales_pipeline_analytics/sales_pipeline_analytics.py#L230-L236

"
2631011833,issue,closed,completed,Opportunity don't appear in Customer Connections Tab,"### Information about bug

I create customer from opportunity but in Customer Connection Tab, opportunities don't appear

### Module

CRM

### Version

ERPNext 15.39.0

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",tranminhnhanchinh,2024-11-03 06:44:06+00:00,[],2024-11-21 00:10:50+00:00,2024-11-06 11:22:21+00:00,https://github.com/frappe/erpnext/issues/43951,"[('bug', None)]","[{'comment_id': 2459485499, 'issue_id': 2631011833, 'author': 'Nihantra-Patel', 'body': 'If the Opportunity from ""Customer"" then will show in the customer connection dashboard. We tested in the latest version so it\'s worked properly.\r\n\r\nPlease check it.\r\n\r\n![image](https://github.com/user-attachments/assets/5af9620c-3cef-47d0-8345-b27fca79d330)\r\n\r\n![image](https://github.com/user-attachments/assets/021a046f-2aeb-418e-9421-f04cf0f14e9b)', 'created_at': datetime.datetime(2024, 11, 6, 11, 22, 21, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-06 11:22:21 UTC): If the Opportunity from ""Customer"" then will show in the customer connection dashboard. We tested in the latest version so it's worked properly.

Please check it.

![image](https://github.com/user-attachments/assets/5af9620c-3cef-47d0-8345-b27fca79d330)

![image](https://github.com/user-attachments/assets/021a046f-2aeb-418e-9421-f04cf0f14e9b)

"
2630453410,issue,closed,completed,Customer portal doesnot show all tasks,"### Information about bug

I set up a customer user, assigned user in Projects and in Customer doctypes. I logged in with customer account..

The portal shows the project correctly. Upon entering the project, it loads only 10 tasks with no ""More"" Button.



### Module

portal

### Version

erpnext 15.36.2
frappe 15.42.0


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",ajiragroup,2024-11-02 13:24:40+00:00,[],2024-11-24 00:11:55+00:00,2024-11-07 06:55:50+00:00,https://github.com/frappe/erpnext/issues/43949,"[('bug', None), ('released', None)]","[{'comment_id': 2461510472, 'issue_id': 2630453410, 'author': 'ajiragroup', 'body': 'Hello, this is great. But does this solve the pagination issue?\r\n\r\n\r\n\r\n> Upon entering the project, it loads only 10 tasks with no ""More"" Button.\r\n\r\nWith current fix, it will load 100 tasks. But 100 tasks might not be enough. \r\n\r\nThis is the screenshot of current (before this fix) system. There are 100\'s of tasks in this project. It currently shows 10 and no option to ""View More"".\r\n![image](https://github.com/user-attachments/assets/1c29fb70-4f93-4358-851a-b9dd8eedf336)', 'created_at': datetime.datetime(2024, 11, 7, 7, 31, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461513305, 'issue_id': 2630453410, 'author': 'Nihantra-Patel', 'body': 'Pagination will not be set because it is a custom-designed page if looks like order or invoice portal page then pagination comes automatically.', 'created_at': datetime.datetime(2024, 11, 7, 7, 33, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2462148827, 'issue_id': 2630453410, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.75.1 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.75.1)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 11, 7, 12, 45, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2462612476, 'issue_id': 2630453410, 'author': 'ajiragroup', 'body': '> Pagination will not be set because it is a custom-designed page if looks like order or invoice portal page then pagination comes automatically.\r\n\r\nOK. But what will be the default sorting of this Tasks list be based on ? Will it display according to ID ? Or Task name(alphabetic) ? or last edited on ?', 'created_at': datetime.datetime(2024, 11, 7, 16, 1, 45, tzinfo=datetime.timezone.utc)}]","ajiragroup (Issue Creator) on (2024-11-07 07:31:26 UTC): Hello, this is great. But does this solve the pagination issue?




With current fix, it will load 100 tasks. But 100 tasks might not be enough. 

This is the screenshot of current (before this fix) system. There are 100's of tasks in this project. It currently shows 10 and no option to ""View More"".
![image](https://github.com/user-attachments/assets/1c29fb70-4f93-4358-851a-b9dd8eedf336)

Nihantra-Patel on (2024-11-07 07:33:25 UTC): Pagination will not be set because it is a custom-designed page if looks like order or invoice portal page then pagination comes automatically.

frappe-pr-bot on (2024-11-07 12:45:10 UTC): :tada: This issue has been resolved in version 14.75.1 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.75.1)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

ajiragroup (Issue Creator) on (2024-11-07 16:01:45 UTC): OK. But what will be the default sorting of this Tasks list be based on ? Will it display according to ID ? Or Task name(alphabetic) ? or last edited on ?

"
2629275462,issue,closed,completed,"v16 bug: BOM Creator failure to create BOMs: KeyError, caused by parent_row_no or fg_reference_id being invalid","### Information about bug

The scheduled job `erpnext.manufacturing.doctype.bom_creator.bom_creator.BOMCreator.create_boms` fails with the error below.

The root cause appears to be `parent_row_no` or `fg_reference_id` being empty or otherwise invalid, possibly due to a row being removed or renamed.

These are redundant references to the parent assembly.

Having looked deeper into the code, it appears the reason for the redundant info is
- `fg_reference_id`: The tree uses the BOM Creator Item name as a reference (items are saved in the database individually so the row names are always available)
- `parent_row_no`: But the Items table uses the row number as a reference (multiple rows can be added at a time before save, so the row names are not known)

A reference to the specific parent row is required because otherwise it is impossible to determine the proper structure since the parent item could be in the BOM tree in multiple positions at once.

The error below was caused by fg_reference_id being invalid, somehow the name of the item row had changed yet the reference was to the old name.

**To reproduce**
This happened perfectly innocently by the customer learning how to use the BOM Creator 'on the job'. Once a sub-assembly had been created in the tree view, they realised it needed to be inside another sub-assembly, so deleted and recreated part of the BOM. This resulted in the below error and the Item table being invalid.

Either way the item table requires stricter validation before it gets to submission and BOM creation.

### Module

manufacturing

### Version

ERPNext v16 develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
File ""/home/frappe/frappe-bench/apps/erpnext/erpnext/manufacturing/doctype/bom_creator/bom_creator.py"", line 252, in create_boms
    production_item_wise_rm[(row.fg_item, row.fg_reference_id)][""items""].append(row)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyError: ('2000430', '2i0vr5sc82')
```
",casesolved-co-uk,2024-11-01 15:29:04+00:00,['rohitwaghchaure'],2025-01-30 00:09:55+00:00,2025-01-15 12:52:41+00:00,https://github.com/frappe/erpnext/issues/43948,"[('bug', None)]","[{'comment_id': 2498154703, 'issue_id': 2629275462, 'author': 'rohitwaghchaure', 'body': '@casesolved-co-uk I did try to replicate the issue but I am unable to replicate the issue. I have tried to add items using the tree view. Could you please share the steps to replicate the issue? \r\n\r\nI did try the steps you have mentioned but still not able to replicate the issue.', 'created_at': datetime.datetime(2024, 11, 25, 14, 22, 34, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure (Assginee) on (2024-11-25 14:22:34 UTC): @casesolved-co-uk I did try to replicate the issue but I am unable to replicate the issue. I have tried to add items using the tree view. Could you please share the steps to replicate the issue? 

I did try the steps you have mentioned but still not able to replicate the issue.

"
2628697938,issue,closed,completed,TypeError: 'NoneType' object is not iterable while loading accounts payable summary report,"### Information about bug

While generating accounts payable summary report, getting error

![image](https://github.com/user-attachments/assets/584f2ccb-61fa-4eba-8490-89a7f047530c)

### App Versions
```
{
	""emi"": ""0.0.1"",
	""erpnext"": ""14.74.8"",
	""everestmi"": ""0.0.1"",
	""frappe"": ""14.84.0""
}
```
### Route
```
query-report/Accounts Payable Summary
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 97, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 48, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 86, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1619, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/__init__.py"", line 815, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
  File ""apps/frappe/frappe/desk/query_report.py"", line 242, in run
    result = generate_report_result(report, filters, user, custom_columns, is_tree, parent_field)
  File ""apps/frappe/frappe/__init__.py"", line 815, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
  File ""apps/frappe/frappe/desk/query_report.py"", line 94, in generate_report_result
    res = get_report_result(report, filters) or []
  File ""apps/frappe/frappe/desk/query_report.py"", line 75, in get_report_result
    res = report.execute_script_report(filters)
  File ""apps/frappe/frappe/core/doctype/report/report.py"", line 128, in execute_script_report
    res = self.execute_module(filters)
  File ""apps/frappe/frappe/core/doctype/report/report.py"", line 145, in execute_module
    return frappe.get_attr(method_name)(frappe._dict(filters))
  File ""apps/erpnext/erpnext/accounts/report/accounts_payable_summary/accounts_payable_summary.py"", line 15, in execute
    return AccountsReceivableSummary(filters).run(args)
  File ""apps/emi/emi/__init__.py"", line 207, in custom_run
    self.get_data(args)
  File ""apps/erpnext/erpnext/accounts/report/accounts_receivable_summary/accounts_receivable_summary.py"", line 40, in get_data
    for party_type in self.party_type:
TypeError: 'NoneType' object is not iterable

```
### Request Data
```
{
	""type"": ""GET"",
	""args"": {
		""report_name"": ""Accounts Payable Summary"",
		""filters"": ""{\""company\"":\""EMI\"",\""report_date\"":\""2024-11-01\"",\""ageing_based_on\"":\""Due Date\"",\""range1\"":30,\""range2\"":60,\""range3\"":90,\""range4\"":120,\""party\"":[]}"",
		""ignore_prepared_report"": false,
		""are_default_filters"": false
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.query_report.run""
}
```
### Response Data
```
{
	""exception"": ""TypeError: 'NoneType' object is not iterable""
}
```

### Module

accounts

### Version

ERPNext: v14.74.8 (version-14)
Frappe Framework: v14.84.0 (version-14)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",Craftint,2024-11-01 09:37:57+00:00,[],2024-11-16 00:10:34+00:00,2024-11-01 09:41:39+00:00,https://github.com/frappe/erpnext/issues/43947,"[('bug', None)]",[],
2627746061,issue,open,,v16 bug: SO unlinked from PO on cancellation,"### Information about bug

The accounts controller has specific functionality to unlink SOs from POs when the SO is cancelled. This seems counter-intuitive, consider the following use-case:

- Create a PO from an SO. When the SO is no longer required and is cancelled, the user should be asked whether they also wish to cancel the PO, because they would need to inform the supplier. If the PO is not cancelled, it would still make sense that the PO remains linked to the SO for traceability;
- One common reason for cancelling an SO is to amend it, therefore the link from the PO should also be amended to point to the new SO;
- If the link is being removed to allow for easy SO deletion, I would argue deletion should be prevented and fail specifically because the link exists if the PO is still active. For many use-cases, a PO would not be linked to an SO anyway.
- If on amending the Sales Order the PO Sales Order Item link no longer exists, it could be cleared but doesn't really matter because it is a data field and not a link field anyway.

https://github.com/frappe/erpnext/blob/ba9fb4effc32f7e5454b8a0bab664195b6cb2108/erpnext/controllers/accounts_controller.py#L1640-L1669

To further support this bug, it does not align with the operation for creating further POs from an amended SO. At several points the SO client code checks the item quantity against the ordered quantity, the ordered quantity having being set upon PO creation, but not cleared on SO cancellation to align with the link removal above:

https://github.com/frappe/erpnext/blob/ba9fb4effc32f7e5454b8a0bab664195b6cb2108/erpnext/selling/doctype/sales_order/sales_order.js#L1187-L1190

https://github.com/frappe/erpnext/blob/ba9fb4effc32f7e5454b8a0bab664195b6cb2108/erpnext/selling/doctype/sales_order/sales_order.js#L1308-L1322

This means if you cancel an SO, and also cancel the PO manually, you cannot create the PO from the SO again, because the ordered quantity is still set, and is read-only so cannot be cleared manually.

## What should happen:

Upon SO cancellation, the user should be asked if the PO(s) should also be cancelled and prompted to inform their Supplier:

- If yes, the SO & PO cancelled and the SO ordered quantity cleared
- If no, the PO remains unchanged and the SO cancelled

Upon SO amend and the PO is still active:

- SO links should be updated on the PO Items

Upon SO Item amend of line already linked from an active PO:

- Amend of quantity: Warn the user that the PO will no longer accurately reflect the SO. An increase in SO quantity will be picked up by creation of further POs. A decrease will result in excess stock;
- Line deletion: clear the PO Sales Order Item field. This could trigger a warning on the PO line: ""Originating Sales Order line has been removed on amend""

Backport:
version-15
version-14

### Module

accounts, buying, selling

### Version

ERPNext - develop v16

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-10-31 20:17:53+00:00,[],2024-10-31 21:11:31+00:00,,https://github.com/frappe/erpnext/issues/43944,"[('bug', None)]",[],
2626591421,issue,open,,Improve performance on Budget valiation,"# Issue
The current implementation of budget validation needs some refactor. On large sites, Purchase Orders with 100 items timeout while submitting.

# Bottlenecks

## Unavoidable nested-loop
Purchase Order can have any number of Items 'I', each item can have any number of dimensions 'D', and each dimension can have budgets for different fiscal years 'B'.

This structure lends itself to be handled by nested-loop -  (I x D x B), like so


``` python
for x in item / gl entry:
 for dim in all_dimensions:
  for budget in all_budgets:
   calculate_and_validate_expenses()
```


## Methods are too generic
`validate_expense_against_budget()` is too generic. It implicitly handles individual GL Entries and 'Items' (from Purchase Order) passed as args.

https://github.com/frappe/erpnext/blob/c7d692345253c8d464a1637fb56d3a3168ba2392/erpnext/accounts/doctype/budget/budget.py#L143


",ruthra-kumar,2024-10-31 11:11:13+00:00,['ruthra-kumar'],2025-01-04 03:31:13+00:00,,https://github.com/frappe/erpnext/issues/43939,"[('performance', '')]","[{'comment_id': 2450831367, 'issue_id': 2626591421, 'author': 'miteshpc', 'body': 'Maybe the logic used for making Trial Balance work with large memory footprint data, can work here too.', 'created_at': datetime.datetime(2024, 10, 31, 21, 17, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2453312307, 'issue_id': 2626591421, 'author': 'ruthra-kumar', 'body': ""> Maybe the logic used for making Trial Balance work with large memory footprint data, can work here too.\r\n\r\nYou mean the 'Account Closing Balance' feature?"", 'created_at': datetime.datetime(2024, 11, 3, 6, 16, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2454047012, 'issue_id': 2626591421, 'author': 'ruthra-kumar', 'body': ""For Purchase Order, there are some \r\n\r\n1. Unlike GL Entry, PO has all the 'Items' and dimensions already available while validating. Deduplication can be done beforehand. Only validate for each unique key - (expense_account, dimension)\r\n2. Cache the results for each key - (expense_account, dimension) - new method with clear parameters"", 'created_at': datetime.datetime(2024, 11, 4, 8, 7, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2468598101, 'issue_id': 2626591421, 'author': 'miteshpc', 'body': '#1 sounds just fine. That will help to move through that list without much pending. The results can be resulting into a list of items that are contributing towards the violation of budget control.', 'created_at': datetime.datetime(2024, 11, 11, 16, 39, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2570031006, 'issue_id': 2626591421, 'author': 'miteshpc', 'body': 'Somewhere down the line we may need a `Budget Usage Ledger` doctype and a `Budget Closing Balance` doctype', 'created_at': datetime.datetime(2025, 1, 4, 3, 30, 42, tzinfo=datetime.timezone.utc)}]","miteshpc on (2024-10-31 21:17:41 UTC): Maybe the logic used for making Trial Balance work with large memory footprint data, can work here too.

ruthra-kumar (Issue Creator) on (2024-11-03 06:16:52 UTC): You mean the 'Account Closing Balance' feature?

ruthra-kumar (Issue Creator) on (2024-11-04 08:07:14 UTC): For Purchase Order, there are some 

1. Unlike GL Entry, PO has all the 'Items' and dimensions already available while validating. Deduplication can be done beforehand. Only validate for each unique key - (expense_account, dimension)
2. Cache the results for each key - (expense_account, dimension) - new method with clear parameters

miteshpc on (2024-11-11 16:39:55 UTC): #1 sounds just fine. That will help to move through that list without much pending. The results can be resulting into a list of items that are contributing towards the violation of budget control.

miteshpc on (2025-01-04 03:30:42 UTC): Somewhere down the line we may need a `Budget Usage Ledger` doctype and a `Budget Closing Balance` doctype

"
2626340175,issue,closed,completed,Updating Customer Contact Email in POS almost not possible,"**Is your feature request related to a problem? Please describe.**

When trying to update a customers contact information such as email or phone number the system reacts really fast. Entering some keystrokes are enough. The following are the consequences:

Phone number:
- While entering a phone number the customer contact information gets updated several times.
- This is annoying but works.
- Example (see gif):
  - I want to enter *+41 44 444 44 44*
  - While entering the number I get about 6-7 system notification ""Customer contact updated successfully.""

Email:
- While entering a email the system checks right away if the entered keystrokes are a valid email address which means it gives an error before the whole email is entered.
- Of course some random keystrokes can never make a valid email.
- Example (see gif):
  - I want to enter *anna@example.com*
  - After I enter *anna@* I get the error message ""anna@ is not a valid Email Address"".
  - The error message takes the focus away from the field. I have to click the field again and enter the next part.
  - This happens several times while entering the whole email (depending on my typing speed?).

![Example as GIF](https://github.com/user-attachments/assets/47361c8e-c81f-462e-bad5-c95142348721)

**Describe the solution you'd like**
I would like to be able to just enter a phone number and email without getting nagged by the system:

- Either the systems checks and saving should start after I left the field or by pressing a ""SAVE"" button.
- Instead of giving me an error message ""anna@ is not a valid Email Address"" there should be a hint how the email should be without interrupting my flow.
- This is an example for such a message:
![Please enter a valid email address using the following format: joe@example.com](https://lh3.googleusercontent.com/voxRlVN3ouWRbgtQmaeibOEX92-zfGE4kP7dnUUME-yae_gOABvF0c8Ikk6az3a1dhpivId2pjs-2P9yuHNW_hepP3zvLp-o91WekOFH9oboaE9DJbySZVyV_jswU8AykpAf7P76)",indibart,2024-10-31 09:00:59+00:00,['diptanilsaha'],2025-01-23 00:10:10+00:00,2025-01-06 09:23:46+00:00,https://github.com/frappe/erpnext/issues/43938,"[('POS', None), ('feature-request', None), ('released', None)]","[{'comment_id': 2577327613, 'issue_id': 2626340175, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.78.9 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.78.9)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2025, 1, 8, 10, 28, 16, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2025-01-08 10:28:16 UTC): :tada: This issue has been resolved in version 14.78.9 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.78.9)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2625195577,issue,open,,Sales Analytics Report and Sales Register Report disregards User Role Permissions,"### Information about bug

The Sales Analytics Report currently fetches and displays sales data for all users, regardless of their assigned roles and permissions. This includes data from branches and POS profiles that the user cannot access.

**Steps to Reproduce:**

- Log in as a user with limited permissions (e.g., a branch user).

- Access the Sales Analytics Report.

- Observe the report data.

**Expected Behavior:** The report should only display sales data relevant to the user's role and permissions. For example, a branch user should only see sales data for their specific branch.

**Actual Behavior:** The report displays sales data for all branches and POS profiles, including those that the user is not authorized to view.



### Module

selling

### Version

Frappe: Version-15
ERPNext: Version-15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",venkat102,2024-10-30 19:53:25+00:00,[],2025-01-16 12:25:01+00:00,,https://github.com/frappe/erpnext/issues/43935,"[('bug', None)]","[{'comment_id': 2448243104, 'issue_id': 2625195577, 'author': 'venkat102', 'body': 'Assigning myself', 'created_at': datetime.datetime(2024, 10, 30, 19, 55, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2579835634, 'issue_id': 2625195577, 'author': 'Mohamedlavaloon', 'body': 'Any update for this issue', 'created_at': datetime.datetime(2025, 1, 9, 10, 56, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2595443524, 'issue_id': 2625195577, 'author': 'Vigneshsekar', 'body': '@Bhavan23 , your draft is closed. Can you check to open it and request a merge?\nhttps://github.com/frappe/erpnext/pull/44911', 'created_at': datetime.datetime(2025, 1, 16, 12, 24, 59, tzinfo=datetime.timezone.utc)}]","venkat102 (Issue Creator) on (2024-10-30 19:55:22 UTC): Assigning myself

Mohamedlavaloon on (2025-01-09 10:56:23 UTC): Any update for this issue

Vigneshsekar on (2025-01-16 12:24:59 UTC): @Bhavan23 , your draft is closed. Can you check to open it and request a merge?
https://github.com/frappe/erpnext/pull/44911

"
2623092536,issue,closed,completed,Error in test_jv_against_sales_order,"### Information about bug

ERROR: test_jv_against_sales_order (erpnext.accounts.doctype.journal_entry.test_journal_entry.TestJournalEntry)

### Module

accounts

### Version

Frappe - v15
Erpnext - v15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
bench run-tests --doctype ""Journal Entry"" --test test_jv_against_sales_order
E
======================================================================
ERROR: test_jv_against_sales_order (erpnext.accounts.doctype.journal_entry.test_journal_entry.TestJournalEntry)
----------------------------------------------------------------------
Traceback (most recent call last):
  File ""/home/aarti/postgres/frappe-bench-post/apps/erpnext/erpnext/accounts/doctype/journal_entry/test_journal_entry.py"", line 28, in test_jv_against_sales_order
    self.jv_against_voucher_testcase(base_jv, sales_order)
  File ""/home/aarti/postgres/frappe-bench-post/apps/erpnext/erpnext/accounts/doctype/journal_entry/test_journal_entry.py"", line 40, in jv_against_voucher_testcase
    test_voucher.insert()
  File ""/home/aarti/postgres/frappe-bench-post/apps/frappe/frappe/model/document.py"", line 291, in insert
    self.run_before_save_methods()
  File ""/home/aarti/postgres/frappe-bench-post/apps/frappe/frappe/model/document.py"", line 1091, in run_before_save_methods
    self.run_method(""validate"")
  File ""/home/aarti/postgres/frappe-bench-post/apps/frappe/frappe/model/document.py"", line 962, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""/home/aarti/postgres/frappe-bench-post/apps/frappe/frappe/model/document.py"", line 1322, in composer
    return composed(self, method, *args, **kwargs)
  File ""/home/aarti/postgres/frappe-bench-post/apps/frappe/frappe/model/document.py"", line 1304, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""/home/aarti/postgres/frappe-bench-post/apps/frappe/frappe/model/document.py"", line 959, in fn
    return method_object(*args, **kwargs)
  File ""/home/aarti/postgres/frappe-bench-post/apps/erpnext/erpnext/selling/doctype/sales_order/sales_order.py"", line 189, in validate
    super().validate()
  File ""/home/aarti/postgres/frappe-bench-post/apps/erpnext/erpnext/controllers/selling_controller.py"", line 29, in validate
    super().validate()
  File ""/home/aarti/postgres/frappe-bench-post/apps/erpnext/erpnext/controllers/stock_controller.py"", line 52, in validate
    super().validate()
  File ""/home/aarti/postgres/frappe-bench-post/apps/erpnext/erpnext/controllers/accounts_controller.py"", line 180, in validate
    self.set_missing_values(for_validate=True)
  File ""/home/aarti/postgres/frappe-bench-post/apps/erpnext/erpnext/controllers/selling_controller.py"", line 50, in set_missing_values
    self.set_missing_lead_customer_details(for_validate=for_validate)
  File ""/home/aarti/postgres/frappe-bench-post/apps/erpnext/erpnext/controllers/selling_controller.py"", line 77, in set_missing_lead_customer_details
    party_details = _get_party_details(
  File ""/home/aarti/postgres/frappe-bench-post/apps/erpnext/erpnext/accounts/party.py"", line 160, in _get_party_details
    party_details[""sales_team""] = [
TypeError: 'NoneType' object is not iterable

----------------------------------------------------------------------
Ran 1 test in 0.276s

FAILED (errors=1)
```
",aartimanjare,2024-10-30 06:58:31+00:00,[],2024-11-14 00:10:12+00:00,2024-10-30 07:17:19+00:00,https://github.com/frappe/erpnext/issues/43924,"[('bug', None)]",[],
2623080048,issue,open,,How to restrict a POS order from being finalized without 100% payment.,"              > Also, did you take note of #43815 in the process? The order can be finalized without paying a penny or dime.

I think setting mode of payment as cash/phone instead of Bank prevents this.

_Originally posted by @muchai in https://github.com/frappe/erpnext/issues/43867#issuecomment-2440789127_

I was suggested the above: yet it does not work. Has anyone got it to work?
            ",uc77,2024-10-30 06:51:45+00:00,[],2024-10-30 06:51:45+00:00,,https://github.com/frappe/erpnext/issues/43923,[],[],
2623060726,issue,open,,Feature Request for App Management Automation Across Multiple Sites on Bench,"Hello Frappe Cloud Team,

I currently manage a Frappe bench with approximately 10 sites, and updating each site individually whenever I need to add or remove an app is time-consuming and challenging. I’d like to request a feature that automates the app management process across multiple sites.

Ideally, this feature would allow users to select which sites to modify when adding or removing an app on the bench, streamlining the process and significantly improving efficiency.

Thank you for considering this request. I believe this would be a valuable addition for users managing multiple sites.

Best regards,  
Karan Mistry",karan-sanskar,2024-10-30 06:40:18+00:00,[],2024-10-30 06:40:18+00:00,,https://github.com/frappe/erpnext/issues/43922,"[('feature-request', None)]",[],
2693318819,issue,closed,completed,"Incorrect Calculation of Debit, Credit, and Balance in General Ledger Number Card on Dashboard","**Description**: When setting up a **number card** on the Dashboard using the **Report type**, I selected the General Ledger report and specified the following configuration:

**Type**: Report
**Report Name**: General Ledger
**Field**: Debit (INR), Credit (INR), Balance (INR)
**Function**: Sum
The number card should calculate the sum of **original values** in each row for **Debit, Credit**, or **Balance**. However, the calculation  includes the **opening, closing**, and **total**, leading to inaccurate results.

**Steps to Reproduce:**

Create a **number card** on the Dashboard.
Set **Type** to ""Report"".
Choose **General Ledger** as the **Report Name**.
Select **Field** as one of the following: Debit (INR), Credit (INR), or Balance (INR).
Choose **Function** as ""Sum"".
Add the card to the dashboard.
Observe that the displayed total includes values from opening, closing, and total rows instead of only the row-wise original values.

**Screenshots**
![image](https://github.com/user-attachments/assets/18ceb10e-2895-4a6b-8d0b-2c56c9374838)









![image](https://github.com/user-attachments/assets/ce8e80a8-28d8-45ef-97be-30a75cb0fefa)
",UmakanthKaspa,2024-10-30 05:40:05+00:00,[],2025-01-29 00:10:03+00:00,2025-01-14 12:23:44+00:00,https://github.com/frappe/erpnext/issues/44336,"[('bug', None)]","[{'comment_id': 2589777789, 'issue_id': 2693318819, 'author': 'nabinhait', 'body': ""As the number card is generic in nature, there is no way to identify those unwanted rows and exclude them. In this case basically we can't use the General Ledger report for creating a number card."", 'created_at': datetime.datetime(2025, 1, 14, 12, 23, 44, tzinfo=datetime.timezone.utc)}]","nabinhait on (2025-01-14 12:23:44 UTC): As the number card is generic in nature, there is no way to identify those unwanted rows and exclude them. In this case basically we can't use the General Ledger report for creating a number card.

"
2621985397,issue,closed,completed,Job card cannot be completed,"### Information about bug

When I try to complete a job card via the workstation dashboard, I get this error after the quantity prompt‎:
![Screenshot 2024-10-29 at 6 57 01 PM](https://github.com/user-attachments/assets/3070905e-c1ea-4cd1-ae65-7195176aebce)


### Module

manufacturing

### Version

ERPNext: v16.0.0-dev
Framework: v16.0.0-dev

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
Console log:

POST https://mysite.example/api/method/erpnext.manufacturing.doctype.workstation.workstation.update_job_card 404 (Not Found) request.js:280
```
",SamuelHelbling,2024-10-29 18:02:53+00:00,[],2024-12-10 00:11:34+00:00,2024-11-25 14:42:14+00:00,https://github.com/frappe/erpnext/issues/43911,"[('bug', None)]","[{'comment_id': 2444993877, 'issue_id': 2621985397, 'author': 'SamuelHelbling', 'body': 'https://github.com/frappe/erpnext/issues/41789', 'created_at': datetime.datetime(2024, 10, 29, 18, 4, 52, tzinfo=datetime.timezone.utc)}]","SamuelHelbling (Issue Creator) on (2024-10-29 18:04:52 UTC): https://github.com/frappe/erpnext/issues/41789

"
2621652059,issue,open,,Freight Charges Table in Sales Order Doctype editable after Submit,"We would like an Update Freight button to change the Taxes and Charges Child Table (that we are using as our Freight Child Table) the same way the Items Child Table has this feature, so we can resubmit our totals.

![Button Example](https://github.com/user-attachments/assets/cf9407be-c2e2-48cf-8ccf-f75341685b82)
![Example Child Table](https://github.com/user-attachments/assets/f53e52d4-17f5-429a-bcb2-79a9b10c5d74)
",doranteseric,2024-10-29 15:42:48+00:00,[],2024-10-29 15:42:48+00:00,,https://github.com/frappe/erpnext/issues/43903,"[('feature-request', None)]",[],
2617653624,issue,open,,Proposal for Snapshot Testing in ERPNext,"**Introduction to Snapshot Testing**

Snapshot testing is a type of regression testing that captures the current state of a system and compares it to a previously recorded state to identify changes. It is particularly useful for tracking changes in UI components, JSON data, or any other output format. This approach can simplify test writing, enhance test coverage, and automate manual processes.

**Proposed Implementation**

1. **Snapshot Capture and Storage:**
   - Initiate snapshot mode in the UI during development.
   - Perform transactions and capture snapshots of records before and after changes.
   - Store snapshots in `test_snapshots.toml` files associated with the relevant doctype.

2. **Test Stub Creation:**
   - Automatically generate a stub class, e.g., `SnapshotTestMyDoctype`, referencing snapshots as instance attributes.

3. **Transaction Recreation:**
   - Developers specify transactions (e.g., create, validate) in tests using the captured snapshots.

**Example Interaction**

```python
class SnapshotMyDoc(SnapshotTestCase):
    def __init__(self):
        self.snapshots = load([f for f in *.toml])

    def test_create_invoice_in_usd(self):
        so = self.snapshots[0]
        si = so.create_ainv()
        self.assertEqual(si, self.snapshots[1])
```

**Challenges and Considerations**

- **Dependency Management:** Ensure all dependencies are captured during snapshot creation to avoid incomplete records.
- **File Pollution:** This is normal for snapshot tests; of practical importance is a readable diff; maybe use semantic differ.
- **Rollback Mechanism:** Implement reliable transaction rollback to maintain test isolation and integrity; be immune to db pollution from diverse snapshots (e.g. all recreating thier own _Company_ record).
- **Update Mechanism:** Implement an update mechanism so that alongside an intentional change, a developer can review the resulting diff in snapshot target records instead of having to manually update each record.

This proposal aims to streamline functional test creation in ERPNext by leveraging the benefits of snapshot testing.

Citations:
[1] Snapshot Testing: Example and Its Benefits - ORIL https://oril.co/blog/snapshot-testing-example-and-its-benefits/
[2] Snapshot Testing in Action: Helpful or Trouble? - Snoopy Developer https://snoopydeveloper.com/snapshot-testing-in-action-helpful-or-trouble
[3] Pros and cons of Jest snapshot testing | TSH.io - The Software House https://tsh.io/blog/pros-and-cons-of-jest-snapshot-tests/
[4] Snapshot Testing: Benefits and Drawbacks - SitePen https://www.sitepen.com/blog/snapshot-testing-benefits-and-drawbacks
[5] When should I use Snapshot testing? - Stack Overflow https://stackoverflow.com/questions/43771602/when-should-i-use-snapshot-testing
[6] Snapshot testing; what are the benefits? : r/reactjs - Reddit https://www.reddit.com/r/reactjs/comments/auyi54/snapshot_testing_what_are_the_benefits/
",blaggacao,2024-10-28 08:17:27+00:00,[],2024-10-28 08:34:26+00:00,,https://github.com/frappe/erpnext/issues/43872,"[('feature-request', None)]","[{'comment_id': 2440870785, 'issue_id': 2617653624, 'author': 'uc77', 'body': 'Great initiative. We are with you on this.', 'created_at': datetime.datetime(2024, 10, 28, 8, 34, 26, tzinfo=datetime.timezone.utc)}]","uc77 on (2024-10-28 08:34:26 UTC): Great initiative. We are with you on this.

"
2617491464,issue,closed,completed,POS: After selling item stock is not deducted from selected warehouse/WH.,"### Information about bug

Maybe we have not set something up right. So we setup a store profile using WH: Good in transit. We then sold an item from the POS. The issue is that the stock levels stayed the same say (121 units) as per item master; 117 items in the POS. 

Part1:
![POS inaccurate stock issue](https://github.com/user-attachments/assets/69c37616-346b-4165-924b-d3d4335e9132)

Part2:
![POS inaccurate stock issue - part2](https://github.com/user-attachments/assets/1f2932da-b0a2-48aa-9460-8d475434e4a7)


When we jump back in the POS we will see that the stock is minus one piece (i.e 116).

![POS showing stock minus 1 item](https://github.com/user-attachments/assets/e1985893-182e-4d63-9722-10cc4ef33050)

This is urgent as **stock levels** are at risk. Thanks guys!

### Module

stock, selling

### Version

Frappe version: v15.45.0
ERPNext version: v15.39.0

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",uc77,2024-10-28 06:54:28+00:00,[],2024-11-12 00:10:03+00:00,2024-10-28 09:54:48+00:00,https://github.com/frappe/erpnext/issues/43867,"[('bug', None)]","[{'comment_id': 2440739850, 'issue_id': 2617491464, 'author': 'muchai', 'body': 'The design is that POS updates stock qtys, after closing the till: https://docs.erpnext.com/docs/user/manual/en/point-of-sales#35-pos-closing-voucher', 'created_at': datetime.datetime(2024, 10, 28, 7, 24, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2440747787, 'issue_id': 2617491464, 'author': 'uc77', 'body': ""🙈 We thought there was some missing step here, thanks for shedding light!\r\nHowever, doesn't it make more sense & a better logic to validate the stock at the minute? Why I am saying this is that what happens if the stock showing available in the item master is allocated to someone else, resulting in a stock minus?\r\nHave you tried this?"", 'created_at': datetime.datetime(2024, 10, 28, 7, 29, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2440753409, 'issue_id': 2617491464, 'author': 'uc77', 'body': 'Also, did you take note of https://github.com/frappe/erpnext/issues/43815 in the process? The order can be finalized wthout paying a penny or dime.', 'created_at': datetime.datetime(2024, 10, 28, 7, 32, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2440789127, 'issue_id': 2617491464, 'author': 'muchai', 'body': '> Also, did you take note of #43815 in the process? The order can be finalized without paying a penny or dime.\r\n\r\nI think setting mode of payment as cash/phone instead of Bank prevents this.', 'created_at': datetime.datetime(2024, 10, 28, 7, 53, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2440792694, 'issue_id': 2617491464, 'author': 'muchai', 'body': ""> 🙈 We thought there was some missing step here, thanks for shedding light! However, doesn't it make more sense & a better logic to validate the stock at the minute? Why I am saying this is that what happens if the stock showing available in the item master is allocated to someone else, resulting in a stock minus? Have you tried this?\r\n\r\nYou're late to the party. This is an ongoing debate, caused a major debate on the forum way back. Either way, that's why POS Awesome came to be, since it updates stock in real time. But POS Awesome from v15 is no longer open source."", 'created_at': datetime.datetime(2024, 10, 28, 7, 55, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2440823246, 'issue_id': 2617491464, 'author': 'uc77', 'body': '> > Also, did you take note of #43815 in the process? The order can be finalized without paying a penny or dime.\r\n> \r\n> I think setting mode of payment as cash/phone instead of Bank prevents this.\r\n\r\nTried this. No luck. Can you show it from your end?', 'created_at': datetime.datetime(2024, 10, 28, 8, 11, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2440825352, 'issue_id': 2617491464, 'author': 'uc77', 'body': ""> > 🙈 We thought there was some missing step here, thanks for shedding light! However, doesn't it make more sense & a better logic to validate the stock at the minute? Why I am saying this is that what happens if the stock showing available in the item master is allocated to someone else, resulting in a stock minus? Have you tried this?\r\n> \r\n> You're late to the party. This is an ongoing debate, caused a major debate on the forum way back. Either way, that's why POS Awesome came to be, since it updates stock in real time. But POS Awesome from v15 is no longer open source.\r\n\r\nHmm. That's interesting. We have only been using this product for < 9 months 😉 \r\nThanks for highlighting this. Do you have a link to the debate on the forum?"", 'created_at': datetime.datetime(2024, 10, 28, 8, 12, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2441103883, 'issue_id': 2617491464, 'author': 'uc77', 'body': 'Closing this topic.', 'created_at': datetime.datetime(2024, 10, 28, 9, 54, 48, tzinfo=datetime.timezone.utc)}]","muchai on (2024-10-28 07:24:03 UTC): The design is that POS updates stock qtys, after closing the till: https://docs.erpnext.com/docs/user/manual/en/point-of-sales#35-pos-closing-voucher

uc77 (Issue Creator) on (2024-10-28 07:29:19 UTC): 🙈 We thought there was some missing step here, thanks for shedding light!
However, doesn't it make more sense & a better logic to validate the stock at the minute? Why I am saying this is that what happens if the stock showing available in the item master is allocated to someone else, resulting in a stock minus?
Have you tried this?

uc77 (Issue Creator) on (2024-10-28 07:32:56 UTC): Also, did you take note of https://github.com/frappe/erpnext/issues/43815 in the process? The order can be finalized wthout paying a penny or dime.

muchai on (2024-10-28 07:53:15 UTC): I think setting mode of payment as cash/phone instead of Bank prevents this.

muchai on (2024-10-28 07:55:15 UTC): You're late to the party. This is an ongoing debate, caused a major debate on the forum way back. Either way, that's why POS Awesome came to be, since it updates stock in real time. But POS Awesome from v15 is no longer open source.

uc77 (Issue Creator) on (2024-10-28 08:11:17 UTC): Tried this. No luck. Can you show it from your end?

uc77 (Issue Creator) on (2024-10-28 08:12:23 UTC): Hmm. That's interesting. We have only been using this product for < 9 months 😉 
Thanks for highlighting this. Do you have a link to the debate on the forum?

uc77 (Issue Creator) on (2024-10-28 09:54:48 UTC): Closing this topic.

"
2617434136,issue,closed,completed,The discount applied to each Sales Order item is copied over to the corresponding Purchase Order item.,"### Information about bug

When creating a `Sales Order`, if we fill in the `Margin Rate or Amount` fields, the discount amount is automatically added to each `Purchase Order` item when we use the Create `Purchase Order` button from that Sales Order.

### Module

selling

### Version

ERPNext Version - 14.66.2

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
No response
```
",NethminaHiker360,2024-10-28 06:20:44+00:00,['NethminaHiker360'],2024-11-30 00:10:43+00:00,2024-11-08 05:59:06+00:00,https://github.com/frappe/erpnext/issues/43865,"[('bug', None), ('released', None)]","[{'comment_id': 2473869717, 'issue_id': 2617434136, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.76.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.76.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 11, 13, 15, 1, 34, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-11-13 15:01:34 UTC): :tada: This issue has been resolved in version 14.76.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.76.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2617064550,issue,open,,Unlinked Transactions in Submitted POS Closing Entry,"### Information about bug

We are using ERPNext POS across several stores. When we do a closing entry, there is some lag while the system is loading up the linked transactions. If the user presses the save button before these transactions are loaded and show on the screen, the transactions don't get consolidated to the ledger when the entry is finally submitted.

Opening the POS Closing Entry after it has been submitted shows that totals but the transactions are not displayed on the table. Searching the relevant transactions also shows their status as ""Paid"" instead of ""Consolidated"". 

### Module

accounts, selling

### Version

ERPNext 15

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",spyhunter925,2024-10-28 01:43:46+00:00,[],2024-10-28 01:43:46+00:00,,https://github.com/frappe/erpnext/issues/43855,"[('bug', None)]",[],
2616370000,issue,open,,"Allow Using Serials Just for Warranty Tracking, Not Inventory","### Feature Request
We need the option to use serial numbers for warranty tracking only, without enforcing them for inventory management in Delivery Notes. Ideally:
Serial numbers should be optional in Delivery Notes: if entered, they’re tracked; if not, the Delivery Note saves without errors.

### Current Challenge
With `has_serial_no` enabled, ERPNext enforces serial tracking globally, even when it’s only needed for after-sales or warranty cases. Custom overrides are required to bypass this validation, which can be complex to maintain.

### Proposed Solution
Add a feature to allow optional serial tracking in Delivery Notes, supporting businesses that track serials only for warranty purposes, not inventory control.

Thank you for considering this!",KhaledBinAmir,2024-10-27 06:49:21+00:00,[],2024-10-27 06:49:21+00:00,,https://github.com/frappe/erpnext/issues/43852,"[('feature-request', None)]",[],
2616237781,issue,closed,completed,Item batch no when sales return is error,"### Information about bug

The batch number. When a sales return occurs, it will be changed to a new batch number (no longer the original batch number). At the same time, if the Item cost price changes, the return will reference the new cost price instead of the original cost price

### Module

selling

### Version

ERPNext: v15.38.0 (version-15)
Frappe Framework: v15.43.0 (version-15)
Frappe HR: v15.30.0 (version-15)
Payments: v0.0.1 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",sxyouling,2024-10-27 00:54:17+00:00,[],2024-11-15 00:11:03+00:00,2024-10-31 17:24:31+00:00,https://github.com/frappe/erpnext/issues/43850,"[('bug', None)]","[{'comment_id': 2444832197, 'issue_id': 2616237781, 'author': 'rohitwaghchaure', 'body': ""@sxyouling I have tested on local instance and it's working fine. Issue might be related to customizations"", 'created_at': datetime.datetime(2024, 10, 29, 16, 50, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2445994499, 'issue_id': 2616237781, 'author': 'rohitwaghchaure', 'body': ""@sxyouling The new batch is creating for the Rejected Quantity, could you please confirm the issue you're facing is for Rejected Quantity"", 'created_at': datetime.datetime(2024, 10, 30, 6, 43, 53, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure on (2024-10-29 16:50:57 UTC): @sxyouling I have tested on local instance and it's working fine. Issue might be related to customizations

rohitwaghchaure on (2024-10-30 06:43:53 UTC): @sxyouling The new batch is creating for the Rejected Quantity, could you please confirm the issue you're facing is for Rejected Quantity

"
2615595891,issue,open,,"The way standard system has given document level status in all transactions, similar way there is a requirement to have such status at item level too.","The way standard system has given document level status in all transactions, similar way there is a requirement to have such status at item level too.

For Eg:- There is a purchase order with 10 items. 9 items are completely received but 10th is partially received.
                 Now we know that the remaining is not to get received. Purchase order shows status as partially received and thus need to close the PO manually. These scenarios are practical and occur frequently in majority of the cases. Under this circumstances we need to have item level close status as well which will affect the overall document status.
              Similar is the case for sales order as well.

 Hope this helps.








<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**Additional context**
Add any other context or screenshots about the feature request here.
",HnsMobileApp,2024-10-26 06:33:31+00:00,[],2024-10-26 06:33:31+00:00,,https://github.com/frappe/erpnext/issues/43845,"[('feature-request', None)]",[],
2615205650,issue,closed,completed,Handling Unallocated Amounts and Exchange Discrepancies in Multi-Currency Payment Entries,"### Information about bug

Process Overview in Bullet Points:
Multi-Currency Setup:

CAD is the base currency, and payments can be made from foreign currency bank accounts.
Payment Preparation:

When creating a payment entry from a foreign currency bank account, the system calculates the amount based on historical exchange rates, sourced from online platforms.

Unallocated Amount:
The calculated amount difference (between the base currency and foreign currency) is placed in the Write-Off section as ""Unallocated Amount"" in the supplier's currency.
This represents the discrepancy between the actual payment amount and the amount registered by the system.
Adjusting Unallocated Amount:

User Action Required: The user must adjust this ""Unallocated Amount"" to match the exact amount received by the supplier.
Risk: If the user skips this adjustment, the payment may be saved incorrectly, resulting in a discrepancy on the third-party account.
Exchange Gain/Loss:

Once the unallocated amount is adjusted, the ""Set Exchange Gain/Loss"" button becomes active.
The user can then specify an FX Gain/Loss account, which ensures the accounting entry reflects the actual currency exchange difference.

Diagram: Multi-Currency Payment Entry Flow. 
point 4 if not done it ll cause the problem in question

Start
  |
  v
1. Initiate Payment Entry
   - Select Bank with Foreign Currency
  |
  v
2. System Calculates Amount
   - Uses Historical Exchange Rate
  |
  v
3. Register Unallocated Amount
   - Difference shown in Write-Off Section
  |
  v
4. User Adjusts Unallocated Amount
   - Match exact amount received by supplier
   - Avoids discrepancies in supplier account
  |
  v
5. Set Exchange Gain/Loss
   - Activate ""Set Exchange Gain/Loss""
   - Enter FX Gain/Loss Account
  |
  v
End: Entry Reflects Accurate Foreign Exchange



![photo_2024-10-24_17-05-45](https://github.com/user-attachments/assets/dd75bdf4-7fd4-4979-9b6e-715d5a18ddab)


### Module

accounts

### Version

ERPNext: v15.39.2 (HEAD) - Frappe Framework: v15.45.0 (HEAD)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",melhembitar,2024-10-25 21:55:39+00:00,['sagarvora'],2024-12-17 00:11:15+00:00,2024-12-02 09:24:30+00:00,https://github.com/frappe/erpnext/issues/43844,"[('bug', None)]","[{'comment_id': 2461320237, 'issue_id': 2615205650, 'author': 'sagarvora', 'body': ""#### Proposed Solution\r\n\r\nThe logic to calculate `unallocated_amount` is incorrect. It needs following corrections:\r\n- Consider `base_paid_amount` instead of `base_received_amount` for calculation when Payment Entry is of type **Receive**. And vice-versa for **Pay**.\r\n- Don't consider the deduction row related to Exchange Gain / Loss when calculating the **Total Allocatable Amount**. All other deductions like **Cash Discount** will still be considered.\r\n\r\nThe following additional changes are proposed to do above properly:\r\n- Add a checkbox **Is Exchange Gain / Loss?** in Payment Entry Deduction. The row with this checkbox will be excluded for the purpose of calculating `unallocated_amount`.\r\n- (**_slightly breaking change_**) Remove the **Set Exchange Gain / Loss** button. Instead, automatically calculate the Exchange Gain / Loss as the difference between `base_paid_amount` and `base_received_amount` and add the row for Exchange Gain / Loss in Payment Deductions or Loss table automatically in the client side and while saving. This row will also be auto-updated whenever exchange gain/loss changes and during save. Removal of this row will not be permitted, but changing account and cost center will be possible.\r\n\r\n---\r\n\r\nAnother approach that is possible is to not add exchange gain / loss in the **Deductions** table and create separate fields for that. But that will be more breaking."", 'created_at': datetime.datetime(2024, 11, 7, 4, 58, 20, tzinfo=datetime.timezone.utc)}]","sagarvora (Assginee) on (2024-11-07 04:58:20 UTC): #### Proposed Solution

The logic to calculate `unallocated_amount` is incorrect. It needs following corrections:
- Consider `base_paid_amount` instead of `base_received_amount` for calculation when Payment Entry is of type **Receive**. And vice-versa for **Pay**.
- Don't consider the deduction row related to Exchange Gain / Loss when calculating the **Total Allocatable Amount**. All other deductions like **Cash Discount** will still be considered.

The following additional changes are proposed to do above properly:
- Add a checkbox **Is Exchange Gain / Loss?** in Payment Entry Deduction. The row with this checkbox will be excluded for the purpose of calculating `unallocated_amount`.
- (**_slightly breaking change_**) Remove the **Set Exchange Gain / Loss** button. Instead, automatically calculate the Exchange Gain / Loss as the difference between `base_paid_amount` and `base_received_amount` and add the row for Exchange Gain / Loss in Payment Deductions or Loss table automatically in the client side and while saving. This row will also be auto-updated whenever exchange gain/loss changes and during save. Removal of this row will not be permitted, but changing account and cost center will be possible.

---

Another approach that is possible is to not add exchange gain / loss in the **Deductions** table and create separate fields for that. But that will be more breaking.

"
2615036059,issue,closed,completed,Error while submitting sales invoice,"### Information about bug

### App Versions
```
{
	""erpnext"": ""15.39.3"",
	""frappe"": ""15.41.0"",
	""hrms"": ""15.33.0"",
	""india_compliance"": ""15.13.2"",
	""payments"": ""0.0.1"",
	""print_designer"": ""1.4.0"",
	
}
```
### Route
```
Form/Sales Invoice/SINV-24-00001
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1775, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 37, in savedocs
    doc.submit()
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1048, in submit
    return self._submit()
           ^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1031, in _submit
    return self.save()
           ^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 337, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 390, in _save
    self.run_post_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1131, in run_post_save_methods
    self.run_method(""on_submit"")
  File ""apps/frappe/frappe/model/document.py"", line 962, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1322, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1304, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 959, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/accounts/doctype/sales_invoice/sales_invoice.py"", line 463, in on_submit
    self.make_gl_entries()
  File ""apps/erpnext/erpnext/accounts/doctype/sales_invoice/sales_invoice.py"", line 1183, in make_gl_entries
    make_gl_entries(
  File ""apps/erpnext/erpnext/accounts/general_ledger.py"", line 48, in make_gl_entries
    save_entries(gl_map, adv_adj, update_outstanding, from_repost)
  File ""apps/erpnext/erpnext/accounts/general_ledger.py"", line 385, in save_entries
    validate_against_pcv(is_opening, gl_map[0][""posting_date""], gl_map[0][""company""])
  File ""apps/erpnext/erpnext/accounts/general_ledger.py"", line 710, in validate_against_pcv
    last_pcv_date = frappe.db.get_value(
                    ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 512, in get_value
    result = self.get_values(
             ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 616, in get_values
    out = self._get_values_from_table(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 889, in _get_values_from_table
    return query.run(as_dict=as_dict, debug=debug, update=update, run=run, pluck=pluck)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/query_builder/utils.py"", line 87, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 227, in sql
    self._cursor.execute(query, values)
  File ""env/lib/python3.11/site-packages/pymysql/cursors.py"", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/cursors.py"", line 322, in _query
    conn.query(q)
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 825, in _read_query_result
    result.read()
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 775, in _read_packet
    packet.raise_for_error()
  File ""env/lib/python3.11/site-packages/pymysql/protocol.py"", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File ""env/lib/python3.11/site-packages/pymysql/err.py"", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, ""Unknown column 'period_end_date' in 'field list'"")

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""doc"": ""{\""name\"":\""SINV-24-00001\"",\""owner\"":\""Administrator\"",\""creation\"":\""2024-10-26 01:45:38.087460\"",\""modified\"":\""2024-10-26 01:45:38.087460\"",\""modified_by\"":\""yogesh@transcendent.co.in\"",\""docstatus\"":0,\""idx\"":0,\""title\"":\""Yogesh\"",\""naming_series\"":\""SINV-.YY.-\"",\""customer\"":\""Yogesh\"",\""irn\"":null,\""customer_name\"":\""Yogesh\"",\""ewaybill\"":null,\""e_waybill_status\"":\""\"",\""tax_id\"":null,\""company\"":\""Arete\"",\""company_tax_id\"":null,\""posting_date\"":\""2024-10-26\"",\""posting_time\"":\""01:45:38.245166\"",\""set_posting_time\"":0,\""due_date\"":\""2024-10-26\"",\""is_pos\"":0,\""pos_profile\"":null,\""is_consolidated\"":0,\""is_return\"":0,\""return_against\"":null,\""update_outstanding_for_self\"":1,\""update_billed_amount_in_sales_order\"":0,\""update_billed_amount_in_delivery_note\"":1,\""is_debit_note\"":0,\""is_reverse_charge\"":0,\""is_export_with_gst\"":0,\""amended_from\"":null,\""cost_center\"":null,\""project\"":null,\""currency\"":\""INR\"",\""conversion_rate\"":1,\""selling_price_list\"":\""Standard Selling\"",\""price_list_currency\"":\""INR\"",\""plc_conversion_rate\"":1,\""ignore_pricing_rule\"":0,\""scan_barcode\"":null,\""update_stock\"":0,\""set_warehouse\"":null,\""set_target_warehouse\"":null,\""total_qty\"":1,\""total_net_weight\"":0,\""base_total\"":10,\""base_net_total\"":10,\""total\"":10,\""net_total\"":10,\""tax_category\"":\""\"",\""taxes_and_charges\"":null,\""shipping_rule\"":null,\""incoterm\"":null,\""named_place\"":null,\""base_total_taxes_and_charges\"":0,\""total_taxes_and_charges\"":0,\""base_grand_total\"":10,\""base_rounding_adjustment\"":0,\""base_rounded_total\"":10,\""base_in_words\"":\""\"",\""grand_total\"":10,\""rounding_adjustment\"":0,\""use_company_roundoff_cost_center\"":0,\""rounded_total\"":10,\""in_words\"":\""\"",\""total_advance\"":0,\""outstanding_amount\"":10,\""disable_rounded_total\"":0,\""apply_discount_on\"":\""Grand Total\"",\""base_discount_amount\"":0,\""is_cash_or_non_trade_discount\"":0,\""additional_discount_account\"":null,\""additional_discount_percentage\"":0,\""discount_amount\"":0,\""other_charges_calculation\"":null,\""gst_breakup_table\"":null,\""total_billing_hours\"":0,\""total_billing_amount\"":0,\""cash_bank_account\"":null,\""base_paid_amount\"":0,\""paid_amount\"":0,\""base_change_amount\"":0,\""change_amount\"":0,\""account_for_change_amount\"":null,\""allocate_advances_automatically\"":0,\""only_include_allocated_payments\"":0,\""write_off_amount\"":0,\""base_write_off_amount\"":0,\""write_off_outstanding_amount_automatically\"":0,\""write_off_account\"":null,\""write_off_cost_center\"":null,\""redeem_loyalty_points\"":0,\""loyalty_points\"":0,\""loyalty_amount\"":0,\""loyalty_program\"":null,\""loyalty_redemption_account\"":null,\""loyalty_redemption_cost_center\"":null,\""customer_address\"":null,\""address_display\"":null,\""billing_address_gstin\"":null,\""gst_category\"":\""Unregistered\"",\""place_of_supply\"":null,\""contact_person\"":null,\""contact_display\"":null,\""contact_mobile\"":null,\""contact_email\"":null,\""territory\"":null,\""shipping_address_name\"":null,\""shipping_address\"":null,\""port_address\"":null,\""dispatch_address_name\"":null,\""dispatch_address\"":null,\""company_address\"":\""\"",\""company_gstin\"":\""\"",\""company_address_display\"":\""\"",\""ignore_default_payment_terms_template\"":0,\""payment_terms_template\"":null,\""tc_name\"":null,\""terms\"":null,\""po_no\"":\""\"",\""po_date\"":null,\""debit_to\"":\""Debtors - ART\"",\""party_account_currency\"":\""INR\"",\""is_opening\"":\""No\"",\""unrealized_profit_loss_account\"":null,\""against_income_account\"":\""Sales - ART\"",\""sales_partner\"":null,\""amount_eligible_for_commission\"":10,\""commission_rate\"":0,\""total_commission\"":0,\""letter_head\"":null,\""group_same_items\"":0,\""invoice_copy\"":\""Original for Recipient\"",\""select_print_heading\"":null,\""language\"":\""en\"",\""transporter\"":null,\""gst_transporter_id\"":null,\""driver\"":null,\""lr_no\"":null,\""vehicle_no\"":null,\""distance\"":0,\""transporter_name\"":null,\""mode_of_transport\"":\""Road\"",\""driver_name\"":null,\""lr_date\"":\""2024-10-26\"",\""gst_vehicle_type\"":\""Regular\"",\""ecommerce_gstin\"":null,\""port_code\"":null,\""shipping_bill_number\"":null,\""shipping_bill_date\"":null,\""ecommerce_supply_type\"":null,\""subscription\"":null,\""from_date\"":null,\""auto_repeat\"":null,\""to_date\"":null,\""status\"":\""Draft\"",\""einvoice_status\"":\""\"",\""inter_company_invoice_reference\"":null,\""campaign\"":null,\""represents_company\"":null,\""source\"":null,\""customer_group\"":null,\""is_internal_customer\"":0,\""is_discounted\"":0,\""remarks\"":null,\""doctype\"":\""Sales Invoice\"",\""payments\"":[],\""taxes\"":[],\""packed_items\"":[],\""timesheets\"":[],\""pricing_rules\"":[],\""payment_schedule\"":[{\""name\"":\""fn17lhh5q7\"",\""owner\"":\""yogesh@transcendent.co.in\"",\""creation\"":\""2024-10-26 01:45:38.335880\"",\""modified\"":\""2024-10-26 01:45:38.335880\"",\""modified_by\"":\""Administrator\"",\""docstatus\"":0,\""idx\"":1,\""payment_term\"":null,\""description\"":null,\""due_date\"":\""2024-10-26\"",\""mode_of_payment\"":null,\""invoice_portion\"":100,\""discount_type\"":null,\""discount_date\"":null,\""discount\"":0,\""payment_amount\"":10,\""outstanding\"":10,\""paid_amount\"":0,\""discounted_amount\"":0,\""base_payment_amount\"":10,\""parent\"":\""SINV-24-00001\"",\""parentfield\"":\""payment_schedule\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Payment Schedule\""}],\""sales_team\"":[],\""advances\"":[],\""items\"":[{\""name\"":\""fn155f2ku6\"",\""owner\"":\""Administrator\"",\""creation\"":\""2024-10-26 01:45:38.087460\"",\""modified\"":\""2024-10-26 01:45:38.087460\"",\""modified_by\"":\""yogesh@transcendent.co.in\"",\""docstatus\"":0,\""idx\"":1,\""barcode\"":null,\""has_item_scanned\"":0,\""item_code\"":\""Pen\"",\""item_name\"":\""Pen\"",\""customer_item_code\"":null,\""description\"":\""Pen\"",\""gst_hsn_code\"":\""010129\"",\""item_group\"":\""All Item Groups\"",\""brand\"":null,\""image\"":\""\"",\""qty\"":1,\""stock_uom\"":\""Nos\"",\""uom\"":\""Nos\"",\""conversion_factor\"":1,\""stock_qty\"":1,\""price_list_rate\"":0,\""base_price_list_rate\"":0,\""margin_type\"":\""\"",\""margin_rate_or_amount\"":0,\""rate_with_margin\"":0,\""discount_percentage\"":0,\""discount_amount\"":0,\""base_rate_with_margin\"":0,\""rate\"":10,\""amount\"":10,\""item_tax_template\"":null,\""gst_treatment\"":\""Nil-Rated\"",\""base_rate\"":10,\""base_amount\"":10,\""pricing_rules\"":null,\""stock_uom_rate\"":10,\""is_free_item\"":0,\""grant_commission\"":1,\""net_rate\"":10,\""net_amount\"":10,\""base_net_rate\"":10,\""base_net_amount\"":10,\""taxable_value\"":0,\""igst_rate\"":0,\""cgst_rate\"":0,\""sgst_rate\"":0,\""cess_rate\"":0,\""cess_non_advol_rate\"":0,\""igst_amount\"":0,\""cgst_amount\"":0,\""sgst_amount\"":0,\""cess_amount\"":0,\""cess_non_advol_amount\"":0,\""delivered_by_supplier\"":0,\""income_account\"":\""Sales - ART\"",\""is_fixed_asset\"":0,\""asset\"":null,\""finance_book\"":null,\""expense_account\"":\""Cost of Goods Sold - ART\"",\""discount_account\"":null,\""deferred_revenue_account\"":null,\""service_stop_date\"":null,\""enable_deferred_revenue\"":0,\""service_start_date\"":null,\""service_end_date\"":null,\""weight_per_unit\"":0,\""total_weight\"":0,\""weight_uom\"":null,\""warehouse\"":\""Stores - ART\"",\""target_warehouse\"":null,\""quality_inspection\"":null,\""serial_and_batch_bundle\"":null,\""use_serial_batch_fields\"":1,\""allow_zero_valuation_rate\"":0,\""incoming_rate\"":0,\""item_tax_rate\"":\""{}\"",\""actual_batch_qty\"":0,\""actual_qty\"":0,\""serial_no\"":null,\""batch_no\"":null,\""sales_order\"":\""SAL-ORD-2024-00001\"",\""so_detail\"":\""fmsrc7re24\"",\""sales_invoice_item\"":null,\""delivery_note\"":null,\""dn_detail\"":null,\""delivered_qty\"":0,\""purchase_order\"":null,\""purchase_order_item\"":null,\""cost_center\"":\""Main - ART\"",\""project\"":null,\""page_break\"":0,\""parent\"":\""SINV-24-00001\"",\""parentfield\"":\""items\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Sales Invoice Item\"",\""__unsaved\"":1}],\""__onload\"":{\""make_payment_via_journal_entry\"":0},\""__last_sync_on\"":\""2024-10-25T20:16:07.581Z\"",\""_submitted_from_ui\"":1}"",
		""action"": ""Submit""
	},
	""btn"": {
		""jQuery370068393238206661991"": {
			""events"": {
				""click"": [
					{
						""type"": ""click"",
						""origType"": ""click"",
						""guid"": 11412,
						""namespace"": """"
					}
				]
			}
		}
	},
	""freeze"": true,
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.form.save.savedocs"",
	""request_id"": null
}
```
### Response Data
```
{
	""exception"": ""pymysql.err.OperationalError: (1054, \""Unknown column 'period_end_date' in 'field list'\"")"",
	""exc_type"": ""OperationalError"",
	""_exc_source"": ""erpnext (app)""
}
```

### Module

accounts, stock

### Version

""erpnext"": ""15.39.3"",
	""frappe"": ""15.41.0"",
	""hrms"": ""15.33.0"",
	""india_compliance"": ""15.13.2"",
	""payments"": ""0.0.1"",
	""print_designer"": ""1.4.0"",

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""erpnext"": ""15.39.3"",
	""frappe"": ""15.41.0"",
	""hrms"": ""15.33.0"",
	""india_compliance"": ""15.13.2"",
	""payments"": ""0.0.1"",
	""print_designer"": ""1.4.0"",
	
}
```
### Route
```
Form/Sales Invoice/SINV-24-00001
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1775, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 37, in savedocs
    doc.submit()
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1048, in submit
    return self._submit()
           ^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1031, in _submit
    return self.save()
           ^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 337, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 390, in _save
    self.run_post_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1131, in run_post_save_methods
    self.run_method(""on_submit"")
  File ""apps/frappe/frappe/model/document.py"", line 962, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1322, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1304, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 959, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/accounts/doctype/sales_invoice/sales_invoice.py"", line 463, in on_submit
    self.make_gl_entries()
  File ""apps/erpnext/erpnext/accounts/doctype/sales_invoice/sales_invoice.py"", line 1183, in make_gl_entries
    make_gl_entries(
  File ""apps/erpnext/erpnext/accounts/general_ledger.py"", line 48, in make_gl_entries
    save_entries(gl_map, adv_adj, update_outstanding, from_repost)
  File ""apps/erpnext/erpnext/accounts/general_ledger.py"", line 385, in save_entries
    validate_against_pcv(is_opening, gl_map[0][""posting_date""], gl_map[0][""company""])
  File ""apps/erpnext/erpnext/accounts/general_ledger.py"", line 710, in validate_against_pcv
    last_pcv_date = frappe.db.get_value(
                    ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 512, in get_value
    result = self.get_values(
             ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 616, in get_values
    out = self._get_values_from_table(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 889, in _get_values_from_table
    return query.run(as_dict=as_dict, debug=debug, update=update, run=run, pluck=pluck)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/query_builder/utils.py"", line 87, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 227, in sql
    self._cursor.execute(query, values)
  File ""env/lib/python3.11/site-packages/pymysql/cursors.py"", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/cursors.py"", line 322, in _query
    conn.query(q)
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 825, in _read_query_result
    result.read()
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 775, in _read_packet
    packet.raise_for_error()
  File ""env/lib/python3.11/site-packages/pymysql/protocol.py"", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File ""env/lib/python3.11/site-packages/pymysql/err.py"", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, ""Unknown column 'period_end_date' in 'field list'"")

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""doc"": ""{\""name\"":\""SINV-24-00001\"",\""owner\"":\""Administrator\"",\""creation\"":\""2024-10-26 01:45:38.087460\"",\""modified\"":\""2024-10-26 01:45:38.087460\"",\""modified_by\"":\""yogesh@transcendent.co.in\"",\""docstatus\"":0,\""idx\"":0,\""title\"":\""Yogesh\"",\""naming_series\"":\""SINV-.YY.-\"",\""customer\"":\""Yogesh\"",\""irn\"":null,\""customer_name\"":\""Yogesh\"",\""ewaybill\"":null,\""e_waybill_status\"":\""\"",\""tax_id\"":null,\""company\"":\""Arete\"",\""company_tax_id\"":null,\""posting_date\"":\""2024-10-26\"",\""posting_time\"":\""01:45:38.245166\"",\""set_posting_time\"":0,\""due_date\"":\""2024-10-26\"",\""is_pos\"":0,\""pos_profile\"":null,\""is_consolidated\"":0,\""is_return\"":0,\""return_against\"":null,\""update_outstanding_for_self\"":1,\""update_billed_amount_in_sales_order\"":0,\""update_billed_amount_in_delivery_note\"":1,\""is_debit_note\"":0,\""is_reverse_charge\"":0,\""is_export_with_gst\"":0,\""amended_from\"":null,\""cost_center\"":null,\""project\"":null,\""currency\"":\""INR\"",\""conversion_rate\"":1,\""selling_price_list\"":\""Standard Selling\"",\""price_list_currency\"":\""INR\"",\""plc_conversion_rate\"":1,\""ignore_pricing_rule\"":0,\""scan_barcode\"":null,\""update_stock\"":0,\""set_warehouse\"":null,\""set_target_warehouse\"":null,\""total_qty\"":1,\""total_net_weight\"":0,\""base_total\"":10,\""base_net_total\"":10,\""total\"":10,\""net_total\"":10,\""tax_category\"":\""\"",\""taxes_and_charges\"":null,\""shipping_rule\"":null,\""incoterm\"":null,\""named_place\"":null,\""base_total_taxes_and_charges\"":0,\""total_taxes_and_charges\"":0,\""base_grand_total\"":10,\""base_rounding_adjustment\"":0,\""base_rounded_total\"":10,\""base_in_words\"":\""\"",\""grand_total\"":10,\""rounding_adjustment\"":0,\""use_company_roundoff_cost_center\"":0,\""rounded_total\"":10,\""in_words\"":\""\"",\""total_advance\"":0,\""outstanding_amount\"":10,\""disable_rounded_total\"":0,\""apply_discount_on\"":\""Grand Total\"",\""base_discount_amount\"":0,\""is_cash_or_non_trade_discount\"":0,\""additional_discount_account\"":null,\""additional_discount_percentage\"":0,\""discount_amount\"":0,\""other_charges_calculation\"":null,\""gst_breakup_table\"":null,\""total_billing_hours\"":0,\""total_billing_amount\"":0,\""cash_bank_account\"":null,\""base_paid_amount\"":0,\""paid_amount\"":0,\""base_change_amount\"":0,\""change_amount\"":0,\""account_for_change_amount\"":null,\""allocate_advances_automatically\"":0,\""only_include_allocated_payments\"":0,\""write_off_amount\"":0,\""base_write_off_amount\"":0,\""write_off_outstanding_amount_automatically\"":0,\""write_off_account\"":null,\""write_off_cost_center\"":null,\""redeem_loyalty_points\"":0,\""loyalty_points\"":0,\""loyalty_amount\"":0,\""loyalty_program\"":null,\""loyalty_redemption_account\"":null,\""loyalty_redemption_cost_center\"":null,\""customer_address\"":null,\""address_display\"":null,\""billing_address_gstin\"":null,\""gst_category\"":\""Unregistered\"",\""place_of_supply\"":null,\""contact_person\"":null,\""contact_display\"":null,\""contact_mobile\"":null,\""contact_email\"":null,\""territory\"":null,\""shipping_address_name\"":null,\""shipping_address\"":null,\""port_address\"":null,\""dispatch_address_name\"":null,\""dispatch_address\"":null,\""company_address\"":\""\"",\""company_gstin\"":\""\"",\""company_address_display\"":\""\"",\""ignore_default_payment_terms_template\"":0,\""payment_terms_template\"":null,\""tc_name\"":null,\""terms\"":null,\""po_no\"":\""\"",\""po_date\"":null,\""debit_to\"":\""Debtors - ART\"",\""party_account_currency\"":\""INR\"",\""is_opening\"":\""No\"",\""unrealized_profit_loss_account\"":null,\""against_income_account\"":\""Sales - ART\"",\""sales_partner\"":null,\""amount_eligible_for_commission\"":10,\""commission_rate\"":0,\""total_commission\"":0,\""letter_head\"":null,\""group_same_items\"":0,\""invoice_copy\"":\""Original for Recipient\"",\""select_print_heading\"":null,\""language\"":\""en\"",\""transporter\"":null,\""gst_transporter_id\"":null,\""driver\"":null,\""lr_no\"":null,\""vehicle_no\"":null,\""distance\"":0,\""transporter_name\"":null,\""mode_of_transport\"":\""Road\"",\""driver_name\"":null,\""lr_date\"":\""2024-10-26\"",\""gst_vehicle_type\"":\""Regular\"",\""ecommerce_gstin\"":null,\""port_code\"":null,\""shipping_bill_number\"":null,\""shipping_bill_date\"":null,\""ecommerce_supply_type\"":null,\""subscription\"":null,\""from_date\"":null,\""auto_repeat\"":null,\""to_date\"":null,\""status\"":\""Draft\"",\""einvoice_status\"":\""\"",\""inter_company_invoice_reference\"":null,\""campaign\"":null,\""represents_company\"":null,\""source\"":null,\""customer_group\"":null,\""is_internal_customer\"":0,\""is_discounted\"":0,\""remarks\"":null,\""doctype\"":\""Sales Invoice\"",\""payments\"":[],\""taxes\"":[],\""packed_items\"":[],\""timesheets\"":[],\""pricing_rules\"":[],\""payment_schedule\"":[{\""name\"":\""fn17lhh5q7\"",\""owner\"":\""yogesh@transcendent.co.in\"",\""creation\"":\""2024-10-26 01:45:38.335880\"",\""modified\"":\""2024-10-26 01:45:38.335880\"",\""modified_by\"":\""Administrator\"",\""docstatus\"":0,\""idx\"":1,\""payment_term\"":null,\""description\"":null,\""due_date\"":\""2024-10-26\"",\""mode_of_payment\"":null,\""invoice_portion\"":100,\""discount_type\"":null,\""discount_date\"":null,\""discount\"":0,\""payment_amount\"":10,\""outstanding\"":10,\""paid_amount\"":0,\""discounted_amount\"":0,\""base_payment_amount\"":10,\""parent\"":\""SINV-24-00001\"",\""parentfield\"":\""payment_schedule\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Payment Schedule\""}],\""sales_team\"":[],\""advances\"":[],\""items\"":[{\""name\"":\""fn155f2ku6\"",\""owner\"":\""Administrator\"",\""creation\"":\""2024-10-26 01:45:38.087460\"",\""modified\"":\""2024-10-26 01:45:38.087460\"",\""modified_by\"":\""yogesh@transcendent.co.in\"",\""docstatus\"":0,\""idx\"":1,\""barcode\"":null,\""has_item_scanned\"":0,\""item_code\"":\""Pen\"",\""item_name\"":\""Pen\"",\""customer_item_code\"":null,\""description\"":\""Pen\"",\""gst_hsn_code\"":\""010129\"",\""item_group\"":\""All Item Groups\"",\""brand\"":null,\""image\"":\""\"",\""qty\"":1,\""stock_uom\"":\""Nos\"",\""uom\"":\""Nos\"",\""conversion_factor\"":1,\""stock_qty\"":1,\""price_list_rate\"":0,\""base_price_list_rate\"":0,\""margin_type\"":\""\"",\""margin_rate_or_amount\"":0,\""rate_with_margin\"":0,\""discount_percentage\"":0,\""discount_amount\"":0,\""base_rate_with_margin\"":0,\""rate\"":10,\""amount\"":10,\""item_tax_template\"":null,\""gst_treatment\"":\""Nil-Rated\"",\""base_rate\"":10,\""base_amount\"":10,\""pricing_rules\"":null,\""stock_uom_rate\"":10,\""is_free_item\"":0,\""grant_commission\"":1,\""net_rate\"":10,\""net_amount\"":10,\""base_net_rate\"":10,\""base_net_amount\"":10,\""taxable_value\"":0,\""igst_rate\"":0,\""cgst_rate\"":0,\""sgst_rate\"":0,\""cess_rate\"":0,\""cess_non_advol_rate\"":0,\""igst_amount\"":0,\""cgst_amount\"":0,\""sgst_amount\"":0,\""cess_amount\"":0,\""cess_non_advol_amount\"":0,\""delivered_by_supplier\"":0,\""income_account\"":\""Sales - ART\"",\""is_fixed_asset\"":0,\""asset\"":null,\""finance_book\"":null,\""expense_account\"":\""Cost of Goods Sold - ART\"",\""discount_account\"":null,\""deferred_revenue_account\"":null,\""service_stop_date\"":null,\""enable_deferred_revenue\"":0,\""service_start_date\"":null,\""service_end_date\"":null,\""weight_per_unit\"":0,\""total_weight\"":0,\""weight_uom\"":null,\""warehouse\"":\""Stores - ART\"",\""target_warehouse\"":null,\""quality_inspection\"":null,\""serial_and_batch_bundle\"":null,\""use_serial_batch_fields\"":1,\""allow_zero_valuation_rate\"":0,\""incoming_rate\"":0,\""item_tax_rate\"":\""{}\"",\""actual_batch_qty\"":0,\""actual_qty\"":0,\""serial_no\"":null,\""batch_no\"":null,\""sales_order\"":\""SAL-ORD-2024-00001\"",\""so_detail\"":\""fmsrc7re24\"",\""sales_invoice_item\"":null,\""delivery_note\"":null,\""dn_detail\"":null,\""delivered_qty\"":0,\""purchase_order\"":null,\""purchase_order_item\"":null,\""cost_center\"":\""Main - ART\"",\""project\"":null,\""page_break\"":0,\""parent\"":\""SINV-24-00001\"",\""parentfield\"":\""items\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Sales Invoice Item\"",\""__unsaved\"":1}],\""__onload\"":{\""make_payment_via_journal_entry\"":0},\""__last_sync_on\"":\""2024-10-25T20:16:07.581Z\"",\""_submitted_from_ui\"":1}"",
		""action"": ""Submit""
	},
	""btn"": {
		""jQuery370068393238206661991"": {
			""events"": {
				""click"": [
					{
						""type"": ""click"",
						""origType"": ""click"",
						""guid"": 11412,
						""namespace"": """"
					}
				]
			}
		}
	},
	""freeze"": true,
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.form.save.savedocs"",
	""request_id"": null
}
```
### Response Data
```
{
	""exception"": ""pymysql.err.OperationalError: (1054, \""Unknown column 'period_end_date' in 'field list'\"")"",
	""exc_type"": ""OperationalError"",
	""_exc_source"": ""erpnext (app)""
}
```
```
",TranscendentThinkers,2024-10-25 20:22:05+00:00,[],2025-01-08 00:10:31+00:00,2024-12-23 06:34:33+00:00,https://github.com/frappe/erpnext/issues/43842,"[('bug', None)]","[{'comment_id': 2446050228, 'issue_id': 2615036059, 'author': 'ashuio', 'body': 'Can confirm, Facing the exact bug.', 'created_at': datetime.datetime(2024, 10, 30, 7, 18, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2508099759, 'issue_id': 2615036059, 'author': 'adeebabdulsalam', 'body': 'Same here, but I was only trying to link an existing customer to a new Opportunity\r\n<img width=""1076"" alt=""Screenshot 2024-11-29 at 9 45 37\u202fPM"" src=""https://github.com/user-attachments/assets/84cf0002-8322-42ab-b883-1996fc1af1c2"">', 'created_at': datetime.datetime(2024, 11, 29, 16, 15, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2540623298, 'issue_id': 2615036059, 'author': 'mohmedfasilp', 'body': 'Got the same error while submitting salary slips through payroll entry', 'created_at': datetime.datetime(2024, 12, 13, 6, 7, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2547544287, 'issue_id': 2615036059, 'author': 'adeebabdulsalam', 'body': ""for me, it happened because frappe version and erpnext version were not matching\r\ndefault command installs 15.x.x\r\nwhich is not enough\r\nyou need to specify the version using `--branch version-15 `\r\nthen it will install the latest specific version for both frappe and erpnext.\r\nit won't work if the versions look like this\r\nERPNext 15.x.x\r\nFrappe 8.x.x\r\n\r\nI think they should specify this in the documentation more clearly, or avoid installing .x.x versions altogether"", 'created_at': datetime.datetime(2024, 12, 17, 5, 34, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2559004746, 'issue_id': 2615036059, 'author': 'nabinhait', 'body': 'You will get this error if you do not migrate your account properly or skip the account closing balance patch while migrating.', 'created_at': datetime.datetime(2024, 12, 23, 6, 34, 28, tzinfo=datetime.timezone.utc)}]","ashuio on (2024-10-30 07:18:45 UTC): Can confirm, Facing the exact bug.

adeebabdulsalam on (2024-11-29 16:15:22 UTC): Same here, but I was only trying to link an existing customer to a new Opportunity
<img width=""1076"" alt=""Screenshot 2024-11-29 at 9 45 37 PM"" src=""https://github.com/user-attachments/assets/84cf0002-8322-42ab-b883-1996fc1af1c2"">

mohmedfasilp on (2024-12-13 06:07:37 UTC): Got the same error while submitting salary slips through payroll entry

adeebabdulsalam on (2024-12-17 05:34:06 UTC): for me, it happened because frappe version and erpnext version were not matching
default command installs 15.x.x
which is not enough
you need to specify the version using `--branch version-15 `
then it will install the latest specific version for both frappe and erpnext.
it won't work if the versions look like this
ERPNext 15.x.x
Frappe 8.x.x

I think they should specify this in the documentation more clearly, or avoid installing .x.x versions altogether

nabinhait on (2024-12-23 06:34:28 UTC): You will get this error if you do not migrate your account properly or skip the account closing balance patch while migrating.

"
2614816451,issue,open,,@Nihantra-Patel Webforms Not Capturing/Saving Comments to ERPNext V15,"              @Nihantra-Patel According to the attached picture, users must be logged in and the 'allow comments' option must be checked. If this is a lead form, requiring users to sign up may create sales friction, as they might be reluctant to create an account for a simple inquiry. Allowing visitors to send messages without creating an account can potentially capture more leads without having them to go through the account creating process. 
If we uncheck the 'Login Required"" option ,it does not allow to capture comments or messages typed by Lead.

Would appreciate , if you could provide a solution or a work around to capture comments. 

![image](https://github.com/frappe/erpnext/assets/161945345/11621c77-1f06-4042-903b-7a36ff879743)

_Originally posted by @thatphythonguy in https://github.com/frappe/erpnext/issues/40517#issuecomment-2175374744_
            ",thatphythonguy,2024-10-25 18:10:40+00:00,[],2024-10-25 18:11:18+00:00,,https://github.com/frappe/erpnext/issues/43841,[],[],
2614180071,issue,open,,Reference in addresses is not loaded / populated porperly,"### Information about bug

When viewing addesses in the CRM module, occasionally the reference is not loaded at all. This also happens, when someone is creating a new address from within a customer / supplier / ... form and leading to a missing link. As this is not very noticable to the common user, they just think it wasn't saved properly and therefore create the same address again, leading to many duplicates and missing links. When opening the address, it looks like this:
![grafik](https://github.com/user-attachments/assets/0ed85af4-02d1-4d5d-973d-684eadd7bb3b)

The problem is not solved by reloading the page. Occassionally, it can be solved be reloading the addresses list page. However, the this fix is not predicatable nor reproducible. The error appears on multiple systems, even on other databases. 

### Module

CRM

### Version

Frappe Framework Version v15.45.1
ERPNext Version v15.39.3
Bench Version 5.22.9

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
No error message presented
```
",InnowepGmbH,2024-10-25 13:54:04+00:00,[],2024-10-25 13:54:04+00:00,,https://github.com/frappe/erpnext/issues/43840,"[('bug', None)]",[],
2612985577,issue,open,,Cannot Login due to Workspace Error,"### Information about bug

Please help, I don't know what I need to do. Suddenly, this happened after the update.

![error login](https://github.com/user-attachments/assets/142f5b55-fba2-46ee-8b0a-ff8a1fdc7b13)

### Module

other

### Version

erpnext 15.39.3
frappe 15.45.1
payments 0.0.1
print_designer 1.x.x-develop

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/www/app.py"", line 30, in get_context
    boot = frappe.sessions.get()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/sessions.py"", line 142, in get
    bootinfo = get_bootinfo()
               ^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/boot.py"", line 55, in get_bootinfo
    load_desktop_data(bootinfo)
  File ""apps/frappe/frappe/boot.py"", line 147, in load_desktop_data
    bootinfo.module_wise_workspaces = get_controller(""Workspace"").get_module_wise_workspaces()
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'Document' has no attribute 'get_module_wise_workspaces'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""apps/frappe/frappe/website/serve.py"", line 20, in get_response
    response = renderer_instance.render()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 84, in render
    html = self.get_html()
           ^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/website/utils.py"", line 529, in cache_html_decorator
    html = func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 95, in get_html
    self.update_context()
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 163, in update_context
    data = self.run_pymodule_method(""get_context"")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 223, in run_pymodule_method
    return method(self.context)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/www/app.py"", line 32, in get_context
    raise frappe.SessionBootFailed from e
frappe.exceptions.SessionBootFailed
```
",thorhat,2024-10-25 03:31:46+00:00,[],2024-10-26 00:54:12+00:00,,https://github.com/frappe/erpnext/issues/43828,"[('bug', None)]","[{'comment_id': 2437279308, 'issue_id': 2612985577, 'author': 'Savan120', 'body': '> ps aux | grep bench\r\n> bench --site your-site-name set-maintenance-mode off\r\n> bench --site your-site-name migrate (Bench must be running)\r\n\r\nUse this command for this issue.', 'created_at': datetime.datetime(2024, 10, 25, 9, 7, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2437474890, 'issue_id': 2612985577, 'author': 'thorhat', 'body': '> bench --site your-site-name set-maintenance-mode off\r\n\r\nI tried that, but the error still persists.', 'created_at': datetime.datetime(2024, 10, 25, 10, 49, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2438275332, 'issue_id': 2612985577, 'author': 'Savan120', 'body': 'bench update Or bench update --reset\nbench restart\nbench clear-cache\nbench build\nbench migrate\n\nUse this commands.', 'created_at': datetime.datetime(2024, 10, 25, 16, 32, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2439095773, 'issue_id': 2612985577, 'author': 'thorhat', 'body': '> bench migrate\r\n\r\nalready tried, same error', 'created_at': datetime.datetime(2024, 10, 26, 0, 54, 11, tzinfo=datetime.timezone.utc)}]","Savan120 on (2024-10-25 09:07:45 UTC): Use this command for this issue.

thorhat (Issue Creator) on (2024-10-25 10:49:48 UTC): I tried that, but the error still persists.

Savan120 on (2024-10-25 16:32:33 UTC): bench update Or bench update --reset
bench restart
bench clear-cache
bench build
bench migrate

Use this commands.

thorhat (Issue Creator) on (2024-10-26 00:54:11 UTC): already tried, same error

"
2612224992,issue,open,,Recording Variable Quantities for Serial Numbers,"**Situation**
In our use-case of ERPNext, we often need to track both the units of an item and the quantity of each unit, which can vary. This situation arises with items like containers of liquid, rolls of material, and bags of material or by-product. These use-cases are examples of needing dual units of measure, and this need spans multiple industries including textiles, chemicals, steel, and food, making it a widely applicable feature.

**Complication**
The most effective solution is to serialize the items, allowing the tracking of each individual unit and its quantity. However, ERPNext currently restricts the quantity of each serialized item to 1, which limits this capability.

**Solution**
Enable users to record variable quantities for serial numbers. We have a proposed solution that won’t disrupt current ERPNext functionality and will benefit many industries that rely on this feature. The full scope of the solution is provided as a PDF in the link below. 
[Development Scope for Recording Variable Quantities for Serial Numbers.pdf](https://github.com/user-attachments/files/17510832/Development.Scope.for.Recording.Variable.Quantities.for.Serial.Numbers.pdf)

**Alternatives We Have Considered**
We considered using batch numbers, which allow recording variable quantities, except we found that they are not ideal for these cases because:
- We are dealing with individual units, not batches;
- We still need to use batches with serial numbers to track units from the same manufacturing process;
- Partial stock transfers of units should not be allowed but partial consumption should be allowed (batches do not prevent partial stock transfers); and
- Material receipts to refill the same unit should not be allowed (batches allow this).",sailr7,2024-10-24 17:47:48+00:00,[],2024-10-24 17:49:30+00:00,,https://github.com/frappe/erpnext/issues/43826,"[('feature-request', None)]",[],
2611243667,issue,open,,customize form ,"<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
whenever i am opening the customize form then its show page unresponsive 






",itsdhaka,2024-10-24 11:12:24+00:00,[],2025-01-19 23:17:53+00:00,,https://github.com/frappe/erpnext/issues/43820,"[('feature-request', None)]","[{'comment_id': 2601062502, 'issue_id': 2611243667, 'author': 'kalungia', 'body': 'hello @itsdhaka, kindly share more info about the problem you are facing.', 'created_at': datetime.datetime(2025, 1, 19, 23, 17, 52, tzinfo=datetime.timezone.utc)}]","kalungia on (2025-01-19 23:17:52 UTC): hello @itsdhaka, kindly share more info about the problem you are facing.

"
2610642723,issue,closed,completed,User is able to fulfill the POS order despite not being fully paid.,"### Information about bug

When creating a POS order, the user can finalize the transaction let's say for a $200 order just with $1. This causes issues in both financial and book-keeping aspects.

### Module

accounts, selling

### Version

Latest version (v15.39.2)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",uc77,2024-10-24 06:46:46+00:00,[],2024-11-24 00:11:56+00:00,2024-11-07 15:56:46+00:00,https://github.com/frappe/erpnext/issues/43815,"[('bug', None)]","[{'comment_id': 2440161566, 'issue_id': 2610642723, 'author': 'uc77', 'body': ""Dear community, any leverage on this one? It's a showstopper."", 'created_at': datetime.datetime(2024, 10, 27, 20, 18, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2462599802, 'issue_id': 2610642723, 'author': 'uc77', 'body': 'Issue raised https://github.com/frappe/erpnext/pull/43966', 'created_at': datetime.datetime(2024, 11, 7, 15, 56, 46, tzinfo=datetime.timezone.utc)}]","uc77 (Issue Creator) on (2024-10-27 20:18:15 UTC): Dear community, any leverage on this one? It's a showstopper.

uc77 (Issue Creator) on (2024-11-07 15:56:46 UTC): Issue raised https://github.com/frappe/erpnext/pull/43966

"
2609562862,issue,closed,completed,`Sales Register` shows incorrect tax amounts if the same invoice number is shared in 2 different doctypes,"### Information about bug

For example, we had a scenario where Quotes and Sales Invoices can share the same document name. Due to the way tax total query is written in `Sales Register` report, the total tax for that invoice will be doubled.

The query in https://github.com/frappe/erpnext/blob/96cb08dba8056e54ed10597668bdf411f2281fc6/erpnext/accounts/report/sales_register/sales_register.py#L525 line should have an additional condition saying `parenttype = 'Sales Invoice'`

### Module

selling

### Version

ERPNext Version - 14.66.2

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",IMS94,2024-10-23 18:49:56+00:00,[],2024-11-14 00:10:11+00:00,2024-10-29 10:09:22+00:00,https://github.com/frappe/erpnext/issues/43811,"[('bug', None), ('released', None)]","[{'comment_id': 2446384555, 'issue_id': 2609562862, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.74.8 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.8)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 10, 30, 9, 53, 54, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-10-30 09:53:54 UTC): :tada: This issue has been resolved in version 14.74.8 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.8)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2608008431,issue,open,,Exception during Setup,"### Information about bug

Traceback with variables (most recent call last):
  File ""apps/frappe/frappe/desk/page/setup_wizard/setup_wizard.py"", line 423, in make_records
    doc.insert(ignore_permissions=True, ignore_if_duplicate=True)
      records = [{'doctype': 'Address Template', 'country': 'South Africa'}, {'doctype': 'Item Group', 'item_group_name': 'All Item Groups', 'is_group': 1, 'parent_item_group': ''}, {'doctype': 'Item Group', 'item_group_name': 'Products', 'is_group': 0, 'parent_item_group': 'All Item Groups', 'show_in_website': 1}, {'doctype': 'Item Group', 'item_group_name': 'Raw Material', 'is_group': 0, 'parent_item_group': 'All Item Groups'}, {'doctype': 'Item Group', 'item_group_name': 'Services', 'is_group': 0, 'parent_item_group': 'All Item Groups'}, {'doctype': 'Item Group', 'item_group_name': 'Sub Assemblies', 'is_group': 0, 'parent_item_group': 'All Item Groups'}, {'doctype': 'Item Group', 'item_group_name': 'Consumable', 'is_group': 0, 'parent_item_group': 'All Item Groups'}, {'doctype': 'Stock Entry Type', 'name': 'Material Issue', 'purpose': 'Material Issue', 'is_standard': 1}, {'doctype': 'Stock Entry Type', 'name': 'Material Receipt', 'purpose': 'Material Receipt', 'is_standard': 1}, {'doctype': 'Stock ...
      debug = False
      _dict = <class 'frappe._dict'>
      scrub = <function scrub at 0x7f3d0afdf370>
      record = {'doctype': 'Item Group', 'item_group_name': 'All Item Groups', 'is_group': 1, 'parent_item_group': ''}
      doctype = 'Item Group'
      condition = None
      doc = <ItemGroup: All Item Groups>
      parent_link_field = 'parent_item_group'
      savepoint = 'setup_fixtures_creation'
      e = NestedSetRecursionError('Item cannot be added to its own descendants')
      exception = None
  File ""apps/frappe/frappe/model/document.py"", line 315, in insert
    self.run_post_save_methods()
      self = <ItemGroup: All Item Groups>
      ignore_permissions = True
      ignore_links = None
      ignore_if_duplicate = True
      ignore_mandatory = None
      set_name = None
      set_child_names = True
  File ""apps/frappe/frappe/model/document.py"", line 1128, in run_post_save_methods
    self.run_method(""on_update"")
      self = <ItemGroup: All Item Groups>
  File ""apps/frappe/frappe/model/document.py"", line 962, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
      self = <ItemGroup: All Item Groups>
      args = ()
      kwargs = {}
      fn = <function Document.run_method.<locals>.fn at 0x7f3d069384c0>
      method = 'on_update'
  File ""apps/frappe/frappe/model/document.py"", line 1322, in composer
    return composed(self, method, *args, **kwargs)
      self = <ItemGroup: All Item Groups>
      args = ()
      kwargs = {}
      hooks = [<function clear_doctype_notifications at 0x7f3d07e1dab0>, <function process_workflow_actions at 0x7f3d06b4b880>, <function attach_files_to_document at 0x7f3d0a65cb80>, <function apply at 0x7f3d06b66440>, <function update_due_date at 0x7f3d06b664d0>, <function apply_permissions_for_non_standard_user_type at 0x7f3d07e1d360>]
      method = 'on_update'
      doc_events = {'*': {'on_update': ['frappe.desk.notifications.clear_doctype_notifications', 'frappe.workflow.doctype.workflow_action.workflow_action.process_workflow_actions', 'frappe.core.doctype.file.utils.attach_files_to_document', 'frappe.automation.doctype.assignment_rule.assignment_rule.apply', 'frappe.automation.doctype.assignment_rule.assignment_rule.update_due_date', 'frappe.core.doctype.user_type.user_type.apply_permissions_for_non_standard_user_type'], 'after_rename': ['frappe.desk.notifications.clear_doctype_notifications'], 'on_cancel': ['frappe.desk.notifications.clear_doctype_notifications', 'frappe.workflow.doctype.workflow_action.workflow_action.process_workflow_actions', 'frappe.automation.doctype.assignment_rule.assignment_rule.apply', 'healthcare.healthcare.doctype.patient_history_settings.patient_history_settings.delete_medical_record'], 'on_trash': ['frappe.desk.notifications.clear_doctype_notifications', 'frappe.workflow.doctype.workflow_action.workflow_action.process_workflow...
      handler = 'frappe.core.doctype.user_type.user_type.apply_permissions_for_non_standard_user_type'
      composed = <function Document.hook.<locals>.compose.<locals>.runner at 0x7f3d06938b80>
      compose = <function Document.hook.<locals>.compose at 0x7f3d06938f70>
      f = <function Document.run_method.<locals>.fn at 0x7f3d069384c0>
  File ""apps/frappe/frappe/model/document.py"", line 1304, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
      self = <ItemGroup: All Item Groups>
      method = 'on_update'
      args = ()
      kwargs = {}
      add_to_return_value = <function Document.hook.<locals>.add_to_return_value at 0x7f3d069383a0>
      fn = <function Document.run_method.<locals>.fn at 0x7f3d069384c0>
      hooks = (<function clear_doctype_notifications at 0x7f3d07e1dab0>, <function process_workflow_actions at 0x7f3d06b4b880>, <function attach_files_to_document at 0x7f3d0a65cb80>, <function apply at 0x7f3d06b66440>, <function update_due_date at 0x7f3d06b664d0>, <function apply_permissions_for_non_standard_user_type at 0x7f3d07e1d360>)
  File ""apps/frappe/frappe/model/document.py"", line 959, in fn
    return method_object(*args, **kwargs)
      self = <ItemGroup: All Item Groups>
      args = ()
      kwargs = {}
      method_object = <bound method ItemGroup.on_update of <ItemGroup: All Item Groups>>
      method = 'on_update'
  File ""apps/erpnext/erpnext/setup/doctype/item_group/item_group.py"", line 57, in on_update
    NestedSet.on_update(self)
      self = <ItemGroup: All Item Groups>
  File ""apps/frappe/frappe/utils/nestedset.py"", line 269, in on_update
    update_nsm(self)
      self = <ItemGroup: All Item Groups>
  File ""apps/frappe/frappe/utils/nestedset.py"", line 55, in update_nsm
    update_add_node(doc, parent or """", parent_field)
      doc = <ItemGroup: All Item Groups>
      old_parent_field = 'old_parent'
      parent_field = 'parent_item_group'
      parent = 'All Item Groups'
      old_parent = None
  File ""apps/frappe/frappe/utils/nestedset.py"", line 78, in update_add_node
    validate_loop(doc.doctype, doc.name, left, right)
      doc = <ItemGroup: All Item Groups>
      parent = 'All Item Groups'
      parent_field = 'parent_item_group'
      doctype = 'Item Group'
      name = 'All Item Groups'
      Table = Table('tabItem Group')
      left = 1
      right = 6
  File ""apps/frappe/frappe/utils/nestedset.py"", line 233, in validate_loop
    frappe.throw(_(""Item cannot be added to its own descendants""), NestedSetRecursionError)
      doctype = 'Item Group'
      name = 'All Item Groups'
      lft = 1
      rgt = 6
  File ""apps/frappe/frappe/__init__.py"", line 655, in throw
    msgprint(
      msg = 'Item cannot be added to its own descendants'
      exc = <class 'frappe.utils.nestedset.NestedSetRecursionError'>
      title = None
      is_minimizable = False
      wide = False
      as_list = False
      primary_action = None
  File ""apps/frappe/frappe/__init__.py"", line 620, in msgprint
    _raise_exception()
      title = None
      as_table = False
      as_list = False
      indicator = 'red'
      alert = False
      primary_action = None
      is_minimizable = False
      wide = False
      realtime = False
      sys = <module 'sys' (built-in)>
      _raise_exception = <function msgprint.<locals>._raise_exception at 0x7f3d06939090>
      inspect = <module 'inspect' from '/usr/lib/python3.10/inspect.py'>
      msg = 'Item cannot be added to its own descendants'
      out = {'message': 'Item cannot be added to its own descendants', 'title': 'Message', 'indicator': 'red', 'raise_exception': 1, '__frappe_exc_id': '95e6c35ea004ba11365a28fa397ced1bfd47545b41ee7a4bf536e215'}
      raise_exception = <class 'frappe.utils.nestedset.NestedSetRecursionError'>
  File ""apps/frappe/frappe/__init__.py"", line 571, in _raise_exception
    raise exc
      exc = NestedSetRecursionError('Item cannot be added to its own descendants')
      inspect = <module 'inspect' from '/usr/lib/python3.10/inspect.py'>
      msg = 'Item cannot be added to its own descendants'
      out = {'message': 'Item cannot be added to its own descendants', 'title': 'Message', 'indicator': 'red', 'raise_exception': 1, '__frappe_exc_id': '95e6c35ea004ba11365a28fa397ced1bfd47545b41ee7a4bf536e215'}
      raise_exception = <class 'frappe.utils.nestedset.NestedSetRecursionError'>
frappe.utils.nestedset.NestedSetRecursionError: Item cannot be added to its own descendants

### Module

other

### Version

Installed Apps
ERPNext: v15.39.0 (version-15)

Frappe Framework: v15.45.0 (version-15)

Frappe Health: v15.0.1 (version-15)

Frappe HR: v15.33.0 (version-15)

Payments: v0.0.1 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",msalim79,2024-10-23 10:00:00+00:00,[],2024-10-23 10:00:00+00:00,,https://github.com/frappe/erpnext/issues/43802,"[('bug', None)]",[],
2604801041,issue,closed,completed,Inter-Company Payment Transfer issue,"### Information about bug

We are creating an inter-company journal entry for the advance payment but are encountering a payment value mismatch. Company A has sent the payment to Company B, and Company B has received it. However, the payment has not been deducted from Company A’s account, causing the sending amount to be doubled.

Company A before Inter company Journal entry
![Screenshot 2024-10-18 173731](https://github.com/user-attachments/assets/8f473951-ec5f-4697-b1c0-8a6584d3cede)

Company A after Inter company journal entry
![Screenshot 2024-10-18 173850](https://github.com/user-attachments/assets/0bf7e57d-834b-4756-82b2-bd529c424078)

And there is report or ledger to view inter-company Transfer.





### Module

accounts

### Version

ERPNext: v15.38.4 (version-15)
Frappe Framework: v15.44.2 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",sowndharya998,2024-10-22 09:12:56+00:00,[],2024-11-07 00:10:10+00:00,2024-10-23 07:48:29+00:00,https://github.com/frappe/erpnext/issues/43772,"[('bug', None)]",[],
2604585540,issue,open,,Inididual discount amount entered turns 0 in product list,"### Information about bug

Individual discount amount entering in the product list turns zero automatically making it impossible to apply a discount for individual items

### Module

buying, selling

### Version

v15.44.2-v15.38.3

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",NihalN10,2024-10-22 07:51:15+00:00,[],2024-10-22 07:51:15+00:00,,https://github.com/frappe/erpnext/issues/43771,"[('bug', None)]",[],
2602551306,issue,closed,completed,Purchase Order. Update Item Functionality throws error.,"### Information about bug

Hello!

I just found a bug in ERPNext, which I wanted to report.
To reproduce:
1. Create a sales order and submit
2. From the sales order Create > Purchase Order
3. Submit the new Purchase Order
4. On the purchase order > Update Items
5. Add a new item via the update items functionality
6. Afterwards via Update Items, try remove the newly created item.
7. This leads to the following exception:

```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1775, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/erpnext/erpnext/controllers/accounts_controller.py"", line 3324, in update_child_qty_rate
    _removed_items = validate_and_delete_children(parent, data)
  File ""apps/erpnext/erpnext/controllers/accounts_controller.py"", line 3203, in validate_and_delete_children
    parent.update_ordered_qty_in_so_for_removed_items(deleted_children)
  File ""apps/erpnext/erpnext/buying/doctype/purchase_order/purchase_order.py"", line 633, in update_ordered_qty_in_so_for_removed_items
    ""Sales Order Item"", item.get(""sales_order_item""), ""ordered_qty"", prev_ordered_qty - item.qty
TypeError: unsupported operand type(s) for -: 'NoneType' and 'float'

```

As far as I can tell, it is due to the incorrect assumption that a purchase order, which is created from a sales order has ALL items within linked to the sales order. This is not the case, if an item is added on the purchase order via the Update Items functionality.

### Module

buying

### Version

ERPNext: v15.38.1 (version-15)
Frappe Framework: v15.44.1 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",timeo-schmidt,2024-10-21 13:23:17+00:00,['bhavesh95863'],2024-11-24 00:11:53+00:00,2024-11-08 05:09:37+00:00,https://github.com/frappe/erpnext/issues/43758,"[('bug', None)]","[{'comment_id': 2427474565, 'issue_id': 2602551306, 'author': 'bhavesh95863', 'body': 'https://github.com/frappe/erpnext/pull/43762', 'created_at': datetime.datetime(2024, 10, 21, 18, 51, 23, tzinfo=datetime.timezone.utc)}]","bhavesh95863 (Assginee) on (2024-10-21 18:51:23 UTC): https://github.com/frappe/erpnext/pull/43762

"
2602386310,issue,open,,Is it possible to reuse a delivered serial number?,"We have a scenario where the client has 2 companies running on the same ERPNext instance- Company A and Company B.
Company A makes products and sell it Company B.

The items are batched and serialized and the team print labels with QR codes (with serial no) to identify them before delivering it to Company B.

When creating a purchase receipt at Company B, is it possible to reuse the same serial nos? (its possible to use the same batch from Company A) 
",amrit-citrusleaf,2024-10-21 12:22:45+00:00,[],2024-10-21 12:23:52+00:00,,https://github.com/frappe/erpnext/issues/43757,"[('feature-request', None)]",[],
2601736519,issue,open,,Sales Return does not automatically select the correct warehouse,"I don’t know if this function is available, or I haven’t found the corresponding position adjustment.

When processing a sales return, create a Sales Return document.
In the ""Sales Return"" document, the system can not automatically select the warehouse used during the initial shipment based on the records. only can manually select the original shipping warehouse.  
Or an option to choose whether to return the sales order to the warehouse where it was shipped.

",dtxman,2024-10-21 08:15:08+00:00,[],2024-10-21 08:15:08+00:00,,https://github.com/frappe/erpnext/issues/43751,"[('feature-request', None)]",[],
2601719571,issue,open,, Quotation not linking on the customer Dashboard,"We have a customer who started out as lead which turned into a customer and a quote.
Now the quote does not show up on the customer dashboard.



https://support.frappe.io/helpdesk/my-tickets/23839
",Lin-Mari,2024-10-21 08:08:27+00:00,[],2024-10-21 08:08:27+00:00,,https://github.com/frappe/erpnext/issues/43750,"[('feature-request', None)]",[],
2600499149,issue,closed,completed,Execute bench update --reset to update hrms and prompt an error,"### Information about bug

When I execute bench update --reset to update hrms, an error message pops up. I used to upgrade normally without any error. But 3 months have passed since my last upgrade, and this message pops up suddenly.

### Module

HR

### Version

ERPNext: v15.28.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback with variables (most recent call last):
  File ""/usr/lib/python3.10/runpy.py"", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
      mod_name = 'frappe.utils.bench_helper'
      alter_argv = True
      mod_spec = ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f1b1999da20>, origin='/home/sulada/frappe-bench/apps/frappe/frappe/utils/bench_helper.py')
      code = <code object <module> at 0x7f1b183961e0, file ""/home/sulada/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 1>
      main_globals = {'__name__': '__main__', '__doc__': None, '__package__': 'frappe.utils', '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x7f1b1999da20>, '__spec__': ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f1b1999da20>, origin='/home/sulada/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'), '__annotations__': {}, '__builtins__': <module 'builtins' (built-in)>, '__file__': '/home/sulada/frappe-bench/apps/frappe/frappe/utils/bench_helper.py', '__cached__': '/home/sulada/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc', 'importlib': <module 'importlib' from '/usr/lib/python3.10/importlib/__init__.py'>, 'json': <module 'json' from '/usr/lib/python3.10/json/__init__.py'>, 'os': <module 'os' from '/usr/lib/python3.10/os.py'>, 'traceback': <module 'traceback' from '/usr/lib/python3.10/traceback.py'>, 'warnings': <module 'warnings' from '/usr/lib/python3.10/warnings.py'>, 'Path': <cl...
  File ""/usr/lib/python3.10/runpy.py"", line 86, in _run_code
    exec(code, run_globals)
      code = <code object <module> at 0x7f1b183961e0, file ""/home/sulada/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 1>
      run_globals = {'__name__': '__main__', '__doc__': None, '__package__': 'frappe.utils', '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x7f1b1999da20>, '__spec__': ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f1b1999da20>, origin='/home/sulada/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'), '__annotations__': {}, '__builtins__': <module 'builtins' (built-in)>, '__file__': '/home/sulada/frappe-bench/apps/frappe/frappe/utils/bench_helper.py', '__cached__': '/home/sulada/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc', 'importlib': <module 'importlib' from '/usr/lib/python3.10/importlib/__init__.py'>, 'json': <module 'json' from '/usr/lib/python3.10/json/__init__.py'>, 'os': <module 'os' from '/usr/lib/python3.10/os.py'>, 'traceback': <module 'traceback' from '/usr/lib/python3.10/traceback.py'>, 'warnings': <module 'warnings' from '/usr/lib/python3.10/warnings.py'>, 'Path': <cl...
      init_globals = None
      mod_name = '__main__'
      mod_spec = ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f1b1999da20>, origin='/home/sulada/frappe-bench/apps/frappe/frappe/utils/bench_helper.py')
      pkg_name = 'frappe.utils'
      script_name = None
      loader = <_frozen_importlib_external.SourceFileLoader object at 0x7f1b1999da20>
      fname = '/home/sulada/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'
      cached = '/home/sulada/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc'
  File ""/home/sulada/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 114, in <module>
    main()
      ...skipped... 27 vars
  File ""/home/sulada/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 20, in main
    click.Group(commands=commands)(prog_name=""bench"")
      commands = {'frappe': <Group frappe>, 'get-frappe-commands': <Command get-frappe-commands>, 'get-frappe-help': <Command get-frappe-help>}
  File ""/home/sulada/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1157, in __call__
    return self.main(*args, **kwargs)
      self = <Group None>
      args = ()
      kwargs = {'prog_name': 'bench'}
  File ""/home/sulada/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1078, in main
    rv = self.invoke(ctx)
      self = <Group None>
      args = ['frappe', '--site', 'erpnext', 'migrate']
      prog_name = 'bench'
      complete_var = None
      standalone_mode = True
      windows_expand_args = True
      extra = {}
      ctx = <click.core.Context object at 0x7f1b19a2e140>
  File ""/home/sulada/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
      _process_result = <function MultiCommand.invoke.<locals>._process_result at 0x7f1b183cb760>
      args = ['migrate']
      cmd_name = 'frappe'
      cmd = <Group frappe>
      sub_ctx = <click.core.Context object at 0x7f1b182d15d0>
      ctx = <click.core.Context object at 0x7f1b19a2e140>
      self = <Group None>
      __class__ = <class 'click.core.MultiCommand'>
  File ""/home/sulada/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
      _process_result = <function MultiCommand.invoke.<locals>._process_result at 0x7f1b18276b90>
      args = []
      cmd_name = 'migrate'
      cmd = <Command migrate>
      sub_ctx = <click.core.Context object at 0x7f1b182d13c0>
      ctx = <click.core.Context object at 0x7f1b182d15d0>
      self = <Group frappe>
      __class__ = <class 'click.core.MultiCommand'>
  File ""/home/sulada/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
      self = <Command migrate>
      ctx = <click.core.Context object at 0x7f1b182d13c0>
  File ""/home/sulada/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 783, in invoke
    return __callback(*args, **kwargs)
      _Context__self = <click.core.Context object at 0x7f1b182d13c0>
      _Context__callback = <function migrate at 0x7f1b183f7250>
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      ctx = <click.core.Context object at 0x7f1b182d13c0>
  File ""/home/sulada/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py"", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      f = <function migrate at 0x7f1b183f7010>
  File ""/home/sulada/frappe-bench/apps/frappe/frappe/commands/__init__.py"", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
      ctx = <click.core.Context object at 0x7f1b182d13c0>
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      profile = False
      f = <function migrate at 0x7f1b183f6f80>
  File ""/home/sulada/frappe-bench/apps/frappe/frappe/commands/site.py"", line 613, in migrate
    SiteMigration(
      context = {'sites': ['erpnext'], 'force': False, 'verbose': False, 'profile': False}
      skip_failing = False
      skip_search_index = False
      activate_by_import = <module 'traceback_with_variables.activate_by_import' from '/home/sulada/frappe-bench/env/lib/python3.10/site-packages/traceback_with_variables/activate_by_import.py'>
      SiteMigration = <class 'frappe.migrate.SiteMigration'>
      site = 'erpnext'
  File ""/home/sulada/frappe-bench/apps/frappe/frappe/migrate.py"", line 187, in run
    self.post_schema_updates()
      self = <frappe.migrate.SiteMigration object at 0x7f1b182d12a0>
      site = 'erpnext'
      filelock = <function filelock at 0x7f1b15db6dd0>
  File ""/home/sulada/frappe-bench/apps/frappe/frappe/migrate.py"", line 52, in wrapper
    raise e
      args = (<frappe.migrate.SiteMigration object at 0x7f1b182d12a0>,)
      kwargs = {}
      method = <function SiteMigration.post_schema_updates at 0x7f1b15db6b00>
  File ""/home/sulada/frappe-bench/apps/frappe/frappe/migrate.py"", line 44, in wrapper
    ret = method(*args, **kwargs)
      args = (<frappe.migrate.SiteMigration object at 0x7f1b182d12a0>,)
      kwargs = {}
      method = <function SiteMigration.post_schema_updates at 0x7f1b15db6b00>
  File ""/home/sulada/frappe-bench/apps/frappe/frappe/migrate.py"", line 152, in post_schema_updates
    frappe.get_attr(fn)()
      self = <frappe.migrate.SiteMigration object at 0x7f1b182d12a0>
      app = 'hrms'
      fn = 'hrms.setup.update_select_perm_after_install'
  File ""/home/sulada/frappe-bench/apps/frappe/frappe/__init__.py"", line 1758, in get_attr
    return getattr(get_module(modulename), methodname)
      method_string = 'hrms.setup.update_select_perm_after_install'
      app_name = 'hrms'
      modulename = 'hrms.setup'
      methodname = 'update_select_perm_after_install'
  File ""/home/sulada/frappe-bench/apps/frappe/frappe/__init__.py"", line 1476, in get_module
    return importlib.import_module(modulename)
      modulename = 'hrms.setup'
  File ""/usr/lib/python3.10/importlib/__init__.py"", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
      name = 'hrms.setup'
      package = None
      level = 0
  File ""<frozen importlib._bootstrap>"", line 1050, in _gcd_import
      name = 'hrms.setup'
      package = None
      level = 0
  File ""<frozen importlib._bootstrap>"", line 1027, in _find_and_load
      name = 'hrms.setup'
      import_ = <function _gcd_import at 0x7f1b19a8b400>
      module = <object object at 0x7f1b19ab0060>
  File ""<frozen importlib._bootstrap>"", line 1006, in _find_and_load_unlocked
      name = 'hrms.setup'
      import_ = <function _gcd_import at 0x7f1b19a8b400>
      path = ['/home/sulada/frappe-bench/apps/hrms/hrms']
      parent = 'hrms'
      parent_module = <module 'hrms' from '/home/sulada/frappe-bench/apps/hrms/hrms/__init__.py'>
      spec = ModuleSpec(name='hrms.setup', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f1b141651b0>, origin='/home/sulada/frappe-bench/apps/hrms/hrms/setup.py')
  File ""<frozen importlib._bootstrap>"", line 688, in _load_unlocked
      spec = ModuleSpec(name='hrms.setup', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f1b141651b0>, origin='/home/sulada/frappe-bench/apps/hrms/hrms/setup.py')
      module = <module 'hrms.setup' from '/home/sulada/frappe-bench/apps/hrms/hrms/setup.py'>
  File ""<frozen importlib._bootstrap_external>"", line 883, in exec_module
      self = <_frozen_importlib_external.SourceFileLoader object at 0x7f1b141651b0>
      module = <module 'hrms.setup' from '/home/sulada/frappe-bench/apps/hrms/hrms/setup.py'>
      code = <code object <module> at 0x7f1b14592340, file ""/home/sulada/frappe-bench/apps/hrms/hrms/setup.py"", line 1>
  File ""<frozen importlib._bootstrap>"", line 241, in _call_with_frames_removed
      f = <built-in function exec>
      args = (<code object <module> at 0x7f1b14592340, file ""/home/sulada/frappe-bench/apps/hrms/hrms/setup.py"", line 1>, {'__name__': 'hrms.setup', '__doc__': None, '__package__': 'hrms', '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x7f1b141651b0>, '__spec__': ModuleSpec(name='hrms.setup', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f1b141651b0>, origin='/home/sulada/frappe-bench/apps/hrms/hrms/setup.py'), '__file__': '/home/sulada/frappe-bench/apps/hrms/hrms/setup.py', '__cached__': '/home/sulada/frappe-bench/apps/hrms/hrms/__pycache__/setup.cpython-310.pyc', '__builtins__': {'__name__': 'builtins', '__doc__': ""Built-in functions, exceptions, and other objects.\n\nNoteworthy: None is the `nil' object; Ellipsis represents `...' in slices."", '__package__': '', '__loader__': <class '_frozen_importlib.BuiltinImporter'>, '__spec__': ModuleSpec(name='builtins', loader=<class '_frozen_importlib.BuiltinImporter'>, origin='built-in'), '__build_class__': <built...
      kwds = {}
  File ""/home/sulada/frappe-bench/apps/hrms/hrms/setup.py"", line 5, in <module>
    from frappe.desk.page.setup_wizard.install_fixtures import (
      ...skipped... 11 vars
builtins.ImportError: cannot import name '_' from 'frappe.desk.page.setup_wizard.install_fixtures' (/home/sulada/frappe-bench/apps/frappe/frappe/desk/page/setup_wizard/install_fixtures.py)
```
",HankSU7889,2024-10-20 14:06:54+00:00,[],2024-11-24 00:11:47+00:00,2024-11-09 08:28:13+00:00,https://github.com/frappe/erpnext/issues/43737,"[('bug', None)]",[],
2599483282,issue,open,,Batch information tracking - stock entry customisation,"<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
My BOMs are created based on item templates, while my purchase receipts work on item variants basis (split by supplier) - I am trying to update the Stock Entry form to pull items and item variants when selecting the stock and batch bundles - i.e. selecting the stock and batch bundles for item XYZ lets you see the bundles for

XYZ,
XYZ - Supplier 123,
XYZ - Supplier 456,
XYZ - Supplier 789

I’m trying to update the Stock Entry form to pick up the batch numbers of items and their variants - I receive goods as variants (e.g. Plain Flour - Supplier XYZ, Plain Flour - Supplier ABC, Plain Flour - Supplier DEF), while the BOMs are created for the actual item templates (e.g. Plain Flour). How can I have the Serial and Batch Bundle dropdown show the batch numbers for any of the variants in the dropdown (the item template - Plain Flour) does not have any entries against it

**Describe the solution you'd like**
I would like the Serial and Batch Bundle dropdown to show the batch numbers for any of the variants in the dropdown (the item template - Plain Flour does not have any entries against it).

**Describe alternatives you've considered**
I have tried to amend the code for the dropdowns to search for `item.item_code like item.name`

**Additional context**
Add any other context or screenshots about the feature request here.
",redolencetech,2024-10-19 18:47:10+00:00,[],2024-10-19 18:47:10+00:00,,https://github.com/frappe/erpnext/issues/43734,"[('feature-request', None)]",[],
2599128313,issue,closed,completed,Need Unreconcile Entries option on Journal Entry,"When we adjust any Journal entry with Journal entry type ""Bank Entry"" and adjust the same entry with any invoice or journal entry (except bank entry), it will not allow to unreconcile the adjusted  entries on journal entry. Every-time user needs to open each invoice or adjusted entries one by one and unreconcile the one by one. Which is a lengthy, time consuming and error prone process. 

Can we get the unreconcile function on journal entry with ""bank entry"" as journal entry type?

Journal Entry
<img width=""1219"" alt=""image"" src=""https://github.com/user-attachments/assets/7decd2ab-1d8a-4b92-b2d1-1d9f345b7ffa"">


Journal Entry with type as a Bank Entry
<img width=""1126"" alt=""image"" src=""https://github.com/user-attachments/assets/2d022780-437b-4c20-a8bf-4c00fa80625c"">



",smbcatalyst,2024-10-19 12:41:32+00:00,[],2024-11-10 00:11:01+00:00,2024-10-26 12:40:25+00:00,https://github.com/frappe/erpnext/issues/43732,"[('feature-request', None)]",[],
2597302981,issue,closed,completed,Text editor Features are not working,"### Information about bug

Text editor features are not working i created a descriptions with  bold colors in description on save the colors are getting reset to default.

Tested in Item master description table

![image](https://github.com/user-attachments/assets/3ed6b023-0e27-4960-8fd1-fa9b49dae653)
Description created before save

![image](https://github.com/user-attachments/assets/d5ceea17-bee9-4e36-b8e4-8cc3a9824f87)
Description after Save.

Similar issues with bullet and numbering

![image](https://github.com/user-attachments/assets/c4f51b7e-de1f-431d-8f98-8ae8a9403d06)
before save it was bullets

![image](https://github.com/user-attachments/assets/b09d98fc-b8f9-457b-824f-511aa68c693e)
After save it becomes numbering

### Module

stock

### Version

ERPNext: v15.38.1 (HEAD)

Frappe Framework: v15.44.1 (HEAD)

Frappe HR: v15.31.0 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",maveezmh,2024-10-18 11:43:58+00:00,[],2024-11-30 00:10:40+00:00,2024-11-15 08:39:40+00:00,https://github.com/frappe/erpnext/issues/43724,"[('bug', None)]","[{'comment_id': 2473329630, 'issue_id': 2597302981, 'author': 'Nandhinidevi123', 'body': ""![image](https://github.com/user-attachments/assets/c994c3d9-a255-479e-86c0-e2915240da52)\r\n\r\n@maveezmh It's not a bug; it's a feature in stock settings. Disable the 'Convert Item Description to Clean HTML in Transactions' checkbox, and it will work as expected."", 'created_at': datetime.datetime(2024, 11, 13, 11, 41, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2478239538, 'issue_id': 2597302981, 'author': 'maveezmh', 'body': ""> ![image](https://private-user-images.githubusercontent.com/95607404/385739875-c994c3d9-a255-479e-86c0-e2915240da52.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzE2NjAyNDIsIm5iZiI6MTczMTY1OTk0MiwicGF0aCI6Ii85NTYwNzQwNC8zODU3Mzk4NzUtYzk5NGMzZDktYTI1NS00NzllLTg2YzAtZTI5MTUyNDBkYTUyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDExMTUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMTE1VDA4MzkwMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTdiZDBiN2RlODI3NmI5NTVkY2Y5MGNkZDUwY2I5YTM5YTkwNzljMTYwN2JkODhkYzIyNTM1ZjY3NWI2OWUyYzAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.udftZ_fFLB0kqyVafaUBAfl3CR_b3jXpJtvOdYcpDms)\r\n> \r\n> @maveezmh It's not a bug; it's a feature in stock settings. Disable the 'Convert Item Description to Clean HTML in Transactions' checkbox, and it will work as expected.\r\n\r\nits working as expected. thanks @Nandhinidevi123"", 'created_at': datetime.datetime(2024, 11, 15, 8, 39, 40, tzinfo=datetime.timezone.utc)}]","Nandhinidevi123 on (2024-11-13 11:41:07 UTC): ![image](https://github.com/user-attachments/assets/c994c3d9-a255-479e-86c0-e2915240da52)

@maveezmh It's not a bug; it's a feature in stock settings. Disable the 'Convert Item Description to Clean HTML in Transactions' checkbox, and it will work as expected.

maveezmh (Issue Creator) on (2024-11-15 08:39:40 UTC): its working as expected. thanks @Nandhinidevi123

"
2597229152,issue,open,,Option to disable or uninstall unneeded modules,"
Now that Frappe CRM and Frappe Helpdesk are beginning to integrate with ERPNext, it's necessary to clean up the 'legacy' CRM and Support modules in ERPNext. Having ERPNext installed on the same system as Frappe CRM or Frappe Helpdesk can get overly confusing (eg., CRM vs FCRM doctypes and the various entangled permissions). If the original modules are not going to be removed from ERPNext in the near future, there should be an option to disable them or, at minimum, avoid having their installation.",joshuarestivo,2024-10-18 11:08:43+00:00,[],2024-10-18 11:08:43+00:00,,https://github.com/frappe/erpnext/issues/43722,"[('feature-request', None)]",[],
2596993827,issue,open,,Multiple Edit Failed to Update Task Status,"### Information about bug

In Task List, when we select multiple data and try to edit Status from Template to Open message show successful update, but the Status not change even after we refresh the list

### Module

projects

### Version

ERPNext: v15.38.3

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
no error message
```
",efendyIglo,2024-10-18 09:34:13+00:00,[],2024-10-18 09:34:13+00:00,,https://github.com/frappe/erpnext/issues/43721,"[('bug', None)]",[],
2596373419,issue,closed,completed,Error when click Get Advanced Received on POS Invoice,"### Information about bug

To produce the bug, just go to POS Inovice (draft) and click the button.

![image](https://github.com/user-attachments/assets/35d5bd67-8cf4-4b01-bc0c-58db771ae60c)

To fix this, quite simple by adding POS Invoice in `accounts_controller.py`

```
	def get_advance_entries(self, include_unallocated=True):
		party_account = []
		if self.doctype in [""Sales Invoice"", ""POS Invoice""]:    # <-------- add POS Invoice
			party_type = ""Customer""
			party = self.customer
```

But although I can get the Payment Entry for this customer, but the Payment Entry does not seem to get reconciled with this invoice like when normal sales invoice / payment case.


### Module

selling

### Version

ERPNext: v15.38.3 (version-15)
Frappe Framework: v15.44.2 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",kittiu,2024-10-18 04:28:19+00:00,['diptanilsaha'],2025-01-07 00:11:05+00:00,2024-12-23 15:29:01+00:00,https://github.com/frappe/erpnext/issues/43715,"[('bug', None), ('POS', None)]",[],
2594722957,issue,closed,completed,Need provision for Remark on Process statement of accounts,"As in v14, there is no default option for getting remark on General ledger attachment, it is getting difficult to understand the transaction details to customers/suppliers. On v13, remark was showing on general ledger and due to this on process statement of accounts showing correct print on attachment.

Need SHow Remark option on process statement of accounts as check boxes are there for exchange gain/loss and system generated entries.

![image](https://github.com/user-attachments/assets/0729e027-3a49-4f77-b61e-05a51addc121)
",smbcatalyst,2024-10-17 13:17:36+00:00,['ruthra-kumar'],2024-11-10 00:11:00+00:00,2024-10-26 12:40:54+00:00,https://github.com/frappe/erpnext/issues/43713,"[('feature-request', None), ('released', None)]","[{'comment_id': 2430883191, 'issue_id': 2594722957, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.74.7 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.7)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 10, 23, 4, 46, 37, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-10-23 04:46:37 UTC): :tada: This issue has been resolved in version 14.74.7 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.7)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2593731450,issue,open,,Default Letter Head won't get applied for Purchase Order and Sales Invoice,"### Information about bug

Once the user has set a Default Letter Head for the First time, and Add another Letter Head as Default while disabling all the other Letter Heads, Purchase Order and Sales Order will still display the Old Letter Head by Default even though those Letter Heads are being disabled.

Steps to recreate the Bug:

1.  Letter Head List > Add Letter Head (Create 2 or More Letter Heads, One named with ""No Letter Head"" and keep it blank)
2.  Letter Head List > Select a Letter Head and make it Default (""Letter Head 1"" set as Default Letter Head)
3.  Make sure it works on Other Documents such as Loan Application, Purchase Order by Clicking Print.
4.  Letter Head List > Select Letter Head 1 and 2 and disable them. Make ""No Letter Head"" Default.
5.  Purchase Order/ Sale Invoice > Print

By default it'll select the Old Letter Head, not the New One, even if the Old Letter Heads are disabled.


https://github.com/user-attachments/assets/97339c25-4047-43eb-b32d-8580a2e0c3b1



### Module

buying, selling

### Version

Frappe Framework: v14.82.1 (version-14)
ERPNext: v14.74.4 (version-14)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",ransikerandeni,2024-10-17 06:16:49+00:00,[],2024-10-29 08:16:37+00:00,,https://github.com/frappe/erpnext/issues/43707,"[('bug', None)]","[{'comment_id': 2443531146, 'issue_id': 2593731450, 'author': 'penieldev', 'body': 'There is a field in Sales Invoice named `Letter Head` under the `Print Settings` section. If there is a value set, then that letter head will be chosen by default even if you have a different one set as default.\r\n\r\nCheck if you have any letter head selected there. If not, this might be a bug.', 'created_at': datetime.datetime(2024, 10, 29, 8, 16, 36, tzinfo=datetime.timezone.utc)}]","penieldev on (2024-10-29 08:16:36 UTC): There is a field in Sales Invoice named `Letter Head` under the `Print Settings` section. If there is a value set, then that letter head will be chosen by default even if you have a different one set as default.

Check if you have any letter head selected there. If not, this might be a bug.

"
2592020599,issue,closed,completed,plaid setup but not pulling transactions,"### Information about bug

i've setup and got erpnext working, setup a plaid account and enabled the plaid integration with my bank. everything went well, and i can have erpnext sync, but no new transactions show up.
i have noticed however that plaid's dashboard shows i've got hits on balance checks, but no hits on the transactions api. 

any help would be appreciated.

### Module

integrations

### Version

ERPNext: v15.38.0
Frappe Framework: v15.43.0

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
installed on a kubernetes cluster using helm chart: https://helm.erpnext.com
found this log entry in one of the workers:
2024-10-16 13:55:56,107 home-frappe-frappe-bench:default: frappe.utils.background_jobs.execute_job(event=None, is_async=True, job_name='erpnext.erpnext_integrations.doctype.plaid_settings.plaid_settings.sync_tr..., kwargs={'bank': 'Capital One', 'bank_account': 'Business Basic Checking - Capital ..., method='erpnext.erpnext_integrations.doctype.plaid_settings.plaid_settings.sync_tr..., site='erpnext.wetrackleads.com', user='XXX@XXXXXXX') (XXXsitenameXXX::e7e873a6-e085-44a6-9f93-30ecedd386c5)
```
",albertkohl-monotek,2024-10-16 14:09:25+00:00,[],2025-02-08 00:10:00+00:00,2025-01-24 07:42:01+00:00,https://github.com/frappe/erpnext/issues/43699,"[('bug', None)]","[{'comment_id': 2444300655, 'issue_id': 2592020599, 'author': 'albertkohl-monotek', 'body': 'any feedback on this?', 'created_at': datetime.datetime(2024, 10, 29, 13, 48, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2455489420, 'issue_id': 2592020599, 'author': 'albertkohl-monotek', 'body': 'little more context. i found this in my error logs. seems like it\'s trying to run auth and not just pull transactions, but when i linked the account with plaid sync setup, i think it only asked me to authorize transactions. \r\n\r\n\r\n\r\n`Traceback with variables (most recent call last):\r\n  File ""apps/erpnext/erpnext/erpnext_integrations/doctype/plaid_settings/plaid_connector.py"", line 74, in auth\r\n    self.client.Auth.get(self.access_token)\r\n      self = <erpnext.erpnext_integrations.doctype.plaid_settings.plaid_connector.PlaidConnector object at 0x7d60270a1c50>\r\n      e = InvalidInputError(\'client does not have user consent to access the PRODUCT_AUTH product\')\r\n  File ""env/lib/python3.11/site-packages/plaid/api/auth.py"", line 23, in get\r\n    return self.client.post(\'/auth/get\', {\r\n      self = <plaid.api.auth.Auth object at 0x7d602840fbd0>\r\n      access_token = ********\r\n      _options = None\r\n      account_ids = None\r\n      options = {}\r\n  File ""env/lib/python3.11/site-packages/plaid/client.py"", line 103, in post\r\n    return self._post(path, post_data, is_json)\r\n      self = <plaid.client.Client object at 0x7d6026fc7ad0>\r\n      path = \'/auth/get\'\r\n      data = {\'access_token\': \'access-production-425bb1bc-fccf-4a87-b2c0-6d860076f5ec\', \'options\': {}}\r\n      is_json = True\r\n      post_data = {\'client_id\': \'6701563b2006bd001a891d37\', \'secret\': \'********\', \'access_token\': \'access-production-425bb1bc-fccf-4a87-b2c0-6d860076f5ec\', \'options\': {}}\r\n  File ""env/lib/python3.11/site-packages/plaid/client.py"", line 115, in _post\r\n    return post_request(\r\n      self = <plaid.client.Client object at 0x7d6026fc7ad0>\r\n      path = \'/auth/get\'\r\n      data = {\'client_id\': \'6701563b2006bd001a891d37\', \'secret\': \'********\', \'access_token\': \'access-production-425bb1bc-fccf-4a87-b2c0-6d860076f5ec\', \'options\': {}}\r\n      is_json = True\r\n      headers = {\'Plaid-Version\': \'2020-09-14\', \'User-Agent\': \'Plaid Python v7.2.1\'}\r\n  File ""env/lib/python3.11/site-packages/plaid/internal/requester.py"", line 68, in _http_request\r\n    raise PlaidError.from_response(response_body)\r\n      url = \'https://production.plaid.com/auth/get\'\r\n      method = \'POST\'\r\n      data = {\'client_id\': \'6701563b2006bd001a891d37\', \'secret\': \'********\', \'access_token\': \'access-production-425bb1bc-fccf-4a87-b2c0-6d860076f5ec\', \'options\': {}}\r\n      headers = {\'Plaid-Version\': \'2020-09-14\', \'User-Agent\': \'Plaid Python v7.2.1\'}\r\n      timeout = 600\r\n      is_json = True\r\n      response = <Response [400]>\r\n      response_body = {\'display_message\': None, \'documentation_url\': \'https://plaid.com/docs/?ref=error#invalid-input-errors\', \'error_code\': \'ADDITIONAL_CONSENT_REQUIRED\', \'error_message\': \'client does not have user consent to access the PRODUCT_AUTH product\', \'error_type\': \'INVALID_INPUT\', \'request_id\': \'oqNHjgEhCcxNLud\', \'suggested_action\': None}\r\nplaid.errors.InvalidInputError: client does not have user consent to access the PRODUCT_AUTH product`', 'created_at': datetime.datetime(2024, 11, 4, 19, 5, 59, tzinfo=datetime.timezone.utc)}]","albertkohl-monotek (Issue Creator) on (2024-10-29 13:48:56 UTC): any feedback on this?

albertkohl-monotek (Issue Creator) on (2024-11-04 19:05:59 UTC): little more context. i found this in my error logs. seems like it's trying to run auth and not just pull transactions, but when i linked the account with plaid sync setup, i think it only asked me to authorize transactions. 



`Traceback with variables (most recent call last):
  File ""apps/erpnext/erpnext/erpnext_integrations/doctype/plaid_settings/plaid_connector.py"", line 74, in auth
    self.client.Auth.get(self.access_token)
      self = <erpnext.erpnext_integrations.doctype.plaid_settings.plaid_connector.PlaidConnector object at 0x7d60270a1c50>
      e = InvalidInputError('client does not have user consent to access the PRODUCT_AUTH product')
  File ""env/lib/python3.11/site-packages/plaid/api/auth.py"", line 23, in get
    return self.client.post('/auth/get', {
      self = <plaid.api.auth.Auth object at 0x7d602840fbd0>
      access_token = ********
      _options = None
      account_ids = None
      options = {}
  File ""env/lib/python3.11/site-packages/plaid/client.py"", line 103, in post
    return self._post(path, post_data, is_json)
      self = <plaid.client.Client object at 0x7d6026fc7ad0>
      path = '/auth/get'
      data = {'access_token': 'access-production-425bb1bc-fccf-4a87-b2c0-6d860076f5ec', 'options': {}}
      is_json = True
      post_data = {'client_id': '6701563b2006bd001a891d37', 'secret': '********', 'access_token': 'access-production-425bb1bc-fccf-4a87-b2c0-6d860076f5ec', 'options': {}}
  File ""env/lib/python3.11/site-packages/plaid/client.py"", line 115, in _post
    return post_request(
      self = <plaid.client.Client object at 0x7d6026fc7ad0>
      path = '/auth/get'
      data = {'client_id': '6701563b2006bd001a891d37', 'secret': '********', 'access_token': 'access-production-425bb1bc-fccf-4a87-b2c0-6d860076f5ec', 'options': {}}
      is_json = True
      headers = {'Plaid-Version': '2020-09-14', 'User-Agent': 'Plaid Python v7.2.1'}
  File ""env/lib/python3.11/site-packages/plaid/internal/requester.py"", line 68, in _http_request
    raise PlaidError.from_response(response_body)
      url = 'https://production.plaid.com/auth/get'
      method = 'POST'
      data = {'client_id': '6701563b2006bd001a891d37', 'secret': '********', 'access_token': 'access-production-425bb1bc-fccf-4a87-b2c0-6d860076f5ec', 'options': {}}
      headers = {'Plaid-Version': '2020-09-14', 'User-Agent': 'Plaid Python v7.2.1'}
      timeout = 600
      is_json = True
      response = <Response [400]>
      response_body = {'display_message': None, 'documentation_url': 'https://plaid.com/docs/?ref=error#invalid-input-errors', 'error_code': 'ADDITIONAL_CONSENT_REQUIRED', 'error_message': 'client does not have user consent to access the PRODUCT_AUTH product', 'error_type': 'INVALID_INPUT', 'request_id': 'oqNHjgEhCcxNLud', 'suggested_action': None}
plaid.errors.InvalidInputError: client does not have user consent to access the PRODUCT_AUTH product`

"
2589048908,issue,open,,Dashboard Chart not translate,"### Information about bug

Hi, in ERPNext 15, the chart inside the Dashboad graphics are not translated.

In my case the date dans module name should be in french:
![image](https://github.com/user-attachments/assets/c5abd987-38a7-4403-9cf6-96e1ea08f7c7)


### Module

other

### Version

v15

### Installation method

easy-install

### Relevant log output / Stack trace / Full Error Message.

_No response_",ginovo,2024-10-15 14:57:51+00:00,[],2024-10-15 14:57:51+00:00,,https://github.com/frappe/erpnext/issues/43686,"[('bug', None)]",[],
2585871810,issue,open,,Multi Company Access Control doesn't work,"### Information about bug

I am using ERPNext V15.37 on Kubernetes

Steps to Reproduce: 
Step 1: Create Companies
Log in to ERPNext as an admin.

Navigate to Company Creation:

Go to Settings > Companies.
Click on the New button.
Create Company A:

Fill in the Company Name (e.g., ""Company A"").
Set the Abbreviation (e.g., ""C_A"").
Configure other settings as needed (currency, time zone, etc.).
Click on Save.
Create Company B:

Click on the New button again.
Fill in the Company Name (e.g., ""Company B"").
Set the Abbreviation (e.g., ""C_B"").
Configure other settings as needed.
Click on Save.
Step 2: Create Admin Users
Navigate to User Creation:

Go to Settings > Users and Permissions > Users.
Click on the New button.
Create Admin for Company A:

Fill in the Email (e.g., ""admin_a@example.com"").
Set the First Name (e.g., ""Admin A"").
Configure a Password and ensure Enabled is checked.
Under Roles, select System Manager (or any role that grants admin privileges).
Scroll down to Permissions and set:
Company: Select ""Company A"" from the dropdown.
Click Save.
Create Admin for Company B:

Click on the New button again.
Fill in the Email (e.g., ""admin_b@example.com"").
Set the First Name (e.g., ""Admin B"").
Configure a Password and ensure Enabled is checked.
Under Roles, select System Manager (or any role that grants admin privileges).
Scroll down to Permissions and set:
Company: Select ""Company B"" from the dropdown.
Click Save.
Step 3: Allow Admins to Invite Users
Assign User Permissions:
Go back to the User List (Settings > Users and Permissions > Users).

For Admin A:

Click on Admin A's User entry.
Scroll to Permissions and ensure Manufacturing is checked for ""Company A.""
Click Save.
For Admin B:

Click on Admin B's User entry.
Scroll to Permissions and ensure Manufacturing is checked for ""Company B.""
Click Save.
Step 4: Admin Inviting Users
Admin A Inviting Users:

Log in as Admin A.

Go to Settings > Users and Permissions > Users.

Click on New to invite a new user.

Create User 1:

Fill in the Email (e.g., ""user1@example.com"").
Set the First Name (e.g., ""User One"").
Set the User Type as Manufacturing.
Configure a Password and ensure Enabled is checked.
Under Roles, select the appropriate roles for the user (e.g., Manufacturing User).
Scroll down to Permissions and set:
Company: Select ""Company A"" from the dropdown.
Click Save.
Create User 2:

Repeat the same steps to create another user (e.g., ""user2@example.com"").
Set the First Name (e.g., ""User Two"").
Click Save.
Admin B Inviting Users:

Log in as Admin B.
Repeat the same process as Admin A to invite two users of type Manufacturing for ""Company B"":
Create User 3 (e.g., ""user3@example.com"").
Create User 4 (e.g., ""user4@example.com"").
Step 5: Verify Users and Permissions
Check Users:

As Admin A, verify that User One and User Two are visible and have the correct roles and permissions.
As Admin B, verify that User Three and User Four are visible and have the correct roles and permissions.
Test Access:

Have each invited user log in to ensure they can access only their respective company information and functions based on the assigned permissions.

Actual:
Admin A can see all the users of Company A and Company B and vice versa.

Expected:
Admin A can see and invite user related to Company A only and same for Admin B

### Module

other

### Version

ERPNext: v15.37.0

Frappe Framework: v15.43.0

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
Not getting any logs.
```
",ashish-dentalstack,2024-10-14 12:17:14+00:00,[],2024-10-14 17:39:26+00:00,,https://github.com/frappe/erpnext/issues/43652,"[('bug', None)]",[],
2585358108,issue,closed,completed,Issued Solved,"Solved the error of grand_total.

@frappe.whitelist(allow_guest=True)
def make_payment_request(**args):
	""""""Make payment request""""""

	args = frappe._dict(args)

	ref_doc = frappe.get_doc(args.dt, args.dn)
	gateway_account = get_gateway_details(args) or frappe._dict()
	grand_total = get_amount(ref_doc, gateway_account.get(""payment_account""))
	if args.loyalty_points and args.dt == ""Sales Order"":
		from erpnext.accounts.doctype.loyalty_program.loyalty_program import validate_loyalty_points

		loyalty_amount = validate_loyalty_points(ref_doc, int(args.loyalty_points))
		frappe.db.set_value(
			""Sales Order"", args.dn, ""loyalty_points"", int(args.loyalty_points), update_modified=False
		)
		frappe.db.set_value(""Sales Order"", args.dn, ""loyalty_amount"", loyalty_amount, update_modified=False)
		grand_total = grand_total - loyalty_amount

	bank_account = (
		get_party_bank_account(args.get(""party_type""), args.get(""party"")) if args.get(""party_type"") else """"
	)

	draft_payment_request = frappe.db.get_value(
		""Payment Request"",
		{""reference_doctype"": args.dt, ""reference_name"": args.dn, ""docstatus"": 0},
	)

	# fetches existing payment request `grand_total` amount
	existing_payment_request_amount = get_existing_payment_request_amount(ref_doc.doctype, ref_doc.name)

	if existing_payment_request_amount:
		grand_total -= existing_payment_request_amount

		if not grand_total:
			frappe.throw(_(""Payment Request is already created""))

	if draft_payment_request:
		frappe.db.set_value(
			""Payment Request"", draft_payment_request, ""grand_total"", grand_total, update_modified=False
		)
		pr = frappe.get_doc(""Payment Request"", draft_payment_request)
	else:
		pr = frappe.new_doc(""Payment Request"")

		if not args.get(""payment_request_type""):
			args[""payment_request_type""] = (
				""Outward"" if args.get(""dt"") in [""Purchase Order"", ""Purchase Invoice""] else ""Inward""
			)

		party_type = args.get(""party_type"") or ""Customer""
		# party_account_currency = ref_doc.party_account_currency

		# if not party_account_currency:
		party_account = get_party_account(party_type, ref_doc.get(party_type.lower()), ref_doc.company)
		party_account_currency = get_account_currency(party_account)

		pr.update(
			{
				""payment_gateway_account"": gateway_account.get(""name""),
				""payment_gateway"": gateway_account.get(""payment_gateway""),
				""payment_account"": gateway_account.get(""payment_account""),
				""payment_channel"": gateway_account.get(""payment_channel""),
				""payment_request_type"": args.get(""payment_request_type""),
				""currency"": ref_doc.currency,
				""party_account_currency"": party_account_currency,
				""grand_total"": grand_total,
				""mode_of_payment"": args.mode_of_payment,
				""email_to"": args.recipient_id or ref_doc.owner,
				""subject"": _(""Payment Request for {0}"").format(args.dn),
				""message"": gateway_account.get(""message"") or get_dummy_message(ref_doc),
				""reference_doctype"": args.dt,
				""reference_name"": args.dn,
				""company"": ref_doc.get(""company""),
				""party_type"": party_type,
				""party"": args.get(""party"") or ref_doc.get(""customer""),
				""bank_account"": bank_account,
			}
		)

		# Update dimensions
		pr.update(
			{
				""cost_center"": ref_doc.get(""cost_center""),
				""project"": ref_doc.get(""project""),
			}
		)

		for dimension in get_accounting_dimensions():
			pr.update({dimension: ref_doc.get(dimension)})

		if args.order_type == ""Shopping Cart"" or args.mute_email:
			pr.flags.mute_email = True

		if frappe.db.get_single_value(""Accounts Settings"", ""create_pr_in_draft_status"", cache=True):
			pr.insert(ignore_permissions=True)
		if args.submit_doc:
			if pr.get(""__unsaved""):
				pr.insert(ignore_permissions=True)
			pr.submit()

	if args.order_type == ""Shopping Cart"":
		frappe.db.commit()
		frappe.local.response[""type""] = ""redirect""
		frappe.local.response[""location""] = pr.get_payment_url()

	if args.return_doc:
		return pr

	return pr.as_dict()


def get_amount(ref_doc, payment_account=None):
	""""""get amount based on doctype""""""
	dt = ref_doc.doctype
	if dt in [""Quotation"", ""Sales Order"", ""Purchase Order""]:
		grand_total = flt(ref_doc.rounded_total) or flt(ref_doc.grand_total)
	elif dt in [""Sales Invoice"", ""Purchase Invoice""]:
		if not ref_doc.get(""is_pos""):
			if ref_doc.party_account_currency == ref_doc.currency:
				grand_total = flt(ref_doc.rounded_total or ref_doc.grand_total)
			else:
				grand_total = flt(
					flt(ref_doc.base_rounded_total or ref_doc.base_grand_total) / ref_doc.conversion_rate
				)
		elif dt == ""Sales Invoice"":
			for pay in ref_doc.payments:
				if pay.type == ""Phone"" and pay.account == payment_account:
					grand_total = pay.amount
					break
	elif dt == ""POS Invoice"":
		for pay in ref_doc.payments:
			if pay.type == ""Phone"" and pay.account == payment_account:
				grand_total = pay.amount
				break
	elif dt == ""Fees"":
		grand_total = ref_doc.outstanding_amount

	print (""\n grand_total :::::::::::::"", grand_total)
	if grand_total > 0:
		return flt(grand_total, get_currency_precision())
	else:
		frappe.throw(_(""Payment Entry is already created""))
",Savan120,2024-10-14 09:13:00+00:00,[],2024-10-30 00:10:20+00:00,2024-10-15 08:06:32+00:00,https://github.com/frappe/erpnext/issues/43647,[],"[{'comment_id': 2413179088, 'issue_id': 2585358108, 'author': 'Nihantra-Patel', 'body': 'Issue resolved as per the user said.', 'created_at': datetime.datetime(2024, 10, 15, 8, 6, 32, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-10-15 08:06:32 UTC): Issue resolved as per the user said.

"
2584855610,issue,open,,Add a sorting option in Auto Email Report to get relevant data first as part of email body,"<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
Weekly, we receive a Sales Register, as an update to all Ops team, report can be viewed in the Portal, but email digest gives a quick glance in the email. But looking at number of lines in the report and email starts from 1st of April or 1st day, eventually doesn't serve  the purpose as sending data which is is too stale for this purpose.

**Describe the solution you'd like**
May be adding a sorting option, would help achieve this as we may try that with option of descending order of booking date, probably might help achieve the same. Or a toggle to send only recent updates, when number of records in the report is more.

**Describe alternatives you've considered**
Come back on Portal and look at the report.

**Additional context**
Add any other context or screenshots about the feature request here.
",gupteshwar,2024-10-14 06:02:20+00:00,[],2024-10-14 06:02:20+00:00,,https://github.com/frappe/erpnext/issues/43639,"[('feature-request', None)]",[],
2583726016,issue,open,,Sales Analytics by Brand,"**Is your feature request related to a problem? Please describe.**
Currently there is no way in ERPNext to view sales based on the brand of the item.

**Describe the solution you'd like**
Within the existing filters, under Tree Type, ""Brand"" could be added in report ""Sales Analytics""

**Describe alternatives you've considered**
I could not find any alternative within ERPNext than building a new report. But since the Sales Analytics report itself is very good, it will be better to incorporate within it.

**Additional context**
<img width=""552"" alt=""image"" src=""https://github.com/user-attachments/assets/4d980a0e-b8ae-4b00-8097-a600848685c4"">

",azharumar,2024-10-13 07:12:34+00:00,[],2024-10-13 07:12:34+00:00,,https://github.com/frappe/erpnext/issues/43635,"[('feature-request', None)]",[],
2583671809,issue,closed,completed,Upgrade to v15.35 onwards fails in site migration step : Executing erpnext.patches.v15_0.update_invoice_remarks,"### Information about bug

When upgrading to v15.35.0 or any version after that - site migration fails at step : `Executing erpnext.patches.v15_0.update_invoice_remarks`

Error stack 

```
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/database/database.py"", line 207, in sql
    self.check_transaction_status(query)
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/database/database.py"", line 429, in check_transaction_status
    raise frappe.TooManyWritesError(msg)
frappe.exceptions.TooManyWritesError: <br><br>Too many changes to database in single action.<br>The changes have been reverted.<br>
```

Our transaction volume is very high.
We typically have **~100K sales invoices per year**. 

### Possible Solutions
- Since the invoice remarks are not critical - this db migration should be optional and should be done as background job. 


Is there a way to skip this DB migration and complete the upgrade ? 

### Module

accounts

### Version

Frappe Version - 15.44

ERPNext Version - 15.35.0 

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Migrating mp360-erp.frappe.cloud
Updating DocTypes for frappe        : [========================================] 100%
Updating DocTypes for payments      : [========================================] 100%
Updating DocTypes for erpnext       : [========================================] 100%
Updating DocTypes for hrms          : [========================================] 100%
Updating DocTypes for builder       : [========================================] 100%
Updating DocTypes for india_compliance: [========================================] 100%
Updating DocTypes for insights      : [========================================] 100%
Updating DocTypes for lms           : [========================================] 100%
Updating DocTypes for wiki          : [========================================] 100%
Updating DocTypes for print_designer: [========================================] 100%
Updating DocTypes for crm           : [========================================] 100%
Updating DocTypes for mp360_erpn    : [========================================] 100%
Executing frappe.patches.v16_0.move_role_desk_settings_to_user in mp360-erp.frappe.cloud (_69258cc84ef5845e)
Success: Done in 12.834s
Executing erpnext.patches.v15_0.update_invoice_remarks in mp360-erp.frappe.cloud (_69258cc84ef5845e)

Traceback (most recent call last):
  File ""<frozen runpy>"", line 198, in _run_module_as_main
  File ""<frozen runpy>"", line 88, in _run_code
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 114, in <module>
    main()
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 20, in main
    click.Group(commands=commands)(prog_name=""bench"")
  File ""/home/frappe/frappe-bench/env/lib/python3.11/site-packages/click/core.py"", line 1157, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/env/lib/python3.11/site-packages/click/core.py"", line 1078, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/env/lib/python3.11/site-packages/click/core.py"", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/env/lib/python3.11/site-packages/click/core.py"", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/env/lib/python3.11/site-packages/click/core.py"", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/env/lib/python3.11/site-packages/click/core.py"", line 783, in invoke
    return __callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/env/lib/python3.11/site-packages/click/decorators.py"", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/commands/__init__.py"", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/commands/site.py"", line 663, in migrate
    ).run(site=site)
      ^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 186, in run
    self.run_schema_updates()
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 52, in wrapper
    raise e
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 44, in wrapper
    ret = method(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/migrate.py"", line 121, in run_schema_updates
    frappe.modules.patch_handler.run_all(
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 76, in run_all
    run_patch(patch)
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 62, in run_patch
    if not run_single(patchmodule=patch):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 152, in run_single
    return execute_patch(patchmodule, method, methodargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 188, in execute_patch
    _patch()
  File ""/home/frappe/frappe-bench/apps/erpnext/erpnext/patches/v15_0/update_invoice_remarks.py"", line 6, in execute
    update_sales_invoice_remarks()
  File ""/home/frappe/frappe-bench/apps/erpnext/erpnext/patches/v15_0/update_invoice_remarks.py"", line 23, in update_sales_invoice_remarks
    update_remarks(""Sales Invoice"", doc.name, remarks)
  File ""/home/frappe/frappe-bench/apps/erpnext/erpnext/patches/v15_0/update_invoice_remarks.py"", line 51, in update_remarks
    frappe.db.set_value(""Payment Ledger Entry"", filters, ""remarks"", remarks)
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/database/database.py"", line 987, in set_value
    query.run(debug=debug)
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/query_builder/utils.py"", line 87, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/database/database.py"", line 207, in sql
    self.check_transaction_status(query)
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/database/database.py"", line 429, in check_transaction_status
    raise frappe.TooManyWritesError(msg)
frappe.exceptions.TooManyWritesError: <br><br>Too many changes to database in single action.<br>The changes have been reverted.<br>
```
",vv-varun,2024-10-13 05:41:26+00:00,[],2025-01-31 00:10:12+00:00,2025-01-16 09:56:04+00:00,https://github.com/frappe/erpnext/issues/43634,"[('bug', None)]",[],
2587743740,issue,closed,completed,Missing DocType issues in this update. was not there previously,"## Description of the issue
I have made so many installations of frappe docker with no issues. but in the last few days whenever I do an install I see this issue. It does not create a company so  when I go to company list I get this notification:
Missing DocType
Field default_warehouse_for_sales_return is referring to non-existing doctype Warehouse.
 When I go to doctypes I do not see Warehouse DocType
When I go to selling I see this notification
Not found
DocType Item not found
The resource you are looking for is not available


## Context information (for bug reports)

## Steps to reproduce the issue

1. install via docker


### Observed result
The previous versions were fine with no issues at all. I used to install ERPNext 14 & 15 with no issues
### Expected result
Must revert to previous versions ASAP
### Stacktrace / full error message if available

```
(paste here)
```
",albatati3,2024-10-12 17:36:06+00:00,[],2025-02-01 00:11:20+00:00,2025-01-17 10:20:21+00:00,https://github.com/frappe/erpnext/issues/43656,"[('bug', None)]",[],
2581540846,issue,open,,Permission set per group,"I installed EDUCATION module and was fortunate enough to create student and instructors.
the issue is:

- The students can view other students assessment results, fees, fellow students details on their portals.
on the role permission I could not get how to fix this issue since all we need is a group base policy applied to users to only view what is considered to be their own data.
And also assessment results should be modified to list only the assessment results from the courses only.",LintonsBeauty,2024-10-11 14:37:10+00:00,[],2024-10-11 14:37:10+00:00,,https://github.com/frappe/erpnext/issues/43625,"[('feature-request', None)]",[],
2581389147,issue,open,,The group warehouse should not be visible when conducting transactions (SF Ako client),"There should be a mechanism in place to ensure that group warehouses cannot be selected in transaction doctypes. Specifically, when creating or processing transactions such as Sales Orders, Purchase Orders, Delivery Notes, Stock Entries, or any other transaction involving warehouse selection, group warehouses should be excluded from the list of available options.",betinabahati,2024-10-11 13:30:40+00:00,[],2024-10-11 13:33:15+00:00,,https://github.com/frappe/erpnext/issues/43624,"[('feature-request', None)]",[],
2580640745,issue,open,,Currency Issue on Consolidated Financial Reports for Client,"### Information about bug

The consolidate financial Statement report shows the balances in company currency, there is a filed that lets you set the currency for the report so you may view certain accounts in the currency they are set to and compare with General ledger to ensure matching. However when setting the report to a different currency it came to our attention that the amount show in the consolidated report remained in the compaies default currency regardless of what currency was selected for the report.

### Module

accounts

### Version

ERPNext: v14.72.2
Frappe Framework: v14.80.1

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",erpNari,2024-10-11 07:25:52+00:00,[],2024-10-17 08:28:40+00:00,,https://github.com/frappe/erpnext/issues/43617,"[('bug', None)]","[{'comment_id': 2410158709, 'issue_id': 2580640745, 'author': 'Nihantra-Patel', 'body': 'Share the video, and screenshot.', 'created_at': datetime.datetime(2024, 10, 14, 6, 34, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2418890205, 'issue_id': 2580640745, 'author': 'erpNari', 'body': 'As you can see changing the currency does not have an effect on the actual values in the report', 'created_at': datetime.datetime(2024, 10, 17, 8, 25, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2418897395, 'issue_id': 2580640745, 'author': 'erpNari', 'body': '![Screenshot 2024-10-17 11 21 24](https://github.com/user-attachments/assets/e1417e18-b7c8-4595-a6ae-8e68d42b8086)\r\n![Screenshot 2024-10-17 11 19 17](https://github.com/user-attachments/assets/117f0ebd-601d-4564-be19-8011061dbd2e)', 'created_at': datetime.datetime(2024, 10, 17, 8, 28, 39, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-10-14 06:34:41 UTC): Share the video, and screenshot.

erpNari (Issue Creator) on (2024-10-17 08:25:11 UTC): As you can see changing the currency does not have an effect on the actual values in the report

erpNari (Issue Creator) on (2024-10-17 08:28:39 UTC): ![Screenshot 2024-10-17 11 21 24](https://github.com/user-attachments/assets/e1417e18-b7c8-4595-a6ae-8e68d42b8086)
![Screenshot 2024-10-17 11 19 17](https://github.com/user-attachments/assets/117f0ebd-601d-4564-be19-8011061dbd2e)

"
2580590022,issue,closed,completed,Payment Entry : Unalocated Amount,"### Information about bug

![image](https://github.com/user-attachments/assets/6c438688-57f5-45c0-97ba-6267996ae404)
![image](https://github.com/user-attachments/assets/80e9d9c2-19c9-47b7-9225-1edcbccadf03)

 encountered an issue when paying less than the allocated amount, and add a deduction with a negative difference, it was added to the 'Difference Amount' field instead. Is this code correct: and self.total_allocated_amount < self.received_amount + (total_deductions / self.target_exchange_rate)? Because in my opinion, it should be using the '-' operator instead of '+'.

### Module

accounts

### Version

v13.56.3 - v13.50.5

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",incrusio21,2024-10-11 06:54:41+00:00,[],2024-10-30 00:10:21+00:00,2024-10-14 06:42:19+00:00,https://github.com/frappe/erpnext/issues/43615,"[('bug', None)]","[{'comment_id': 2410170649, 'issue_id': 2580590022, 'author': 'Nihantra-Patel', 'body': ""If it's a bug, it hasn't been fixed in version 13 because they stopped fixing bugs for that version. It might still have problems. It's best to upgrade to version 14 or 15.\r\n\r\nVersion | EOL | Branch\r\n-- | -- | --\r\nVersion 12 | End of 2022 | version-12\r\nVersion 13 | End of 2023 | version-13\r\nVersion 14 | End of 2024 (planned) | version-14\r\nVersion 15 | End of 2026 (planned) | version-15\r\nBleeding edge | N/A | develop\r\n\r\n\r\nFor more information, please refer to the [guidelines](https://github.com/frappe/erpnext/wiki/Supported-Versions).\r\n\r\nThank You!"", 'created_at': datetime.datetime(2024, 10, 14, 6, 42, 19, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-10-14 06:42:19 UTC): If it's a bug, it hasn't been fixed in version 13 because they stopped fixing bugs for that version. It might still have problems. It's best to upgrade to version 14 or 15.

Version | EOL | Branch
-- | -- | --
Version 12 | End of 2022 | version-12
Version 13 | End of 2023 | version-13
Version 14 | End of 2024 (planned) | version-14
Version 15 | End of 2026 (planned) | version-15
Bleeding edge | N/A | develop


For more information, please refer to the [guidelines](https://github.com/frappe/erpnext/wiki/Supported-Versions).

Thank You!

"
2580417516,issue,open,,Changes Required in Stock Ageing Report,"<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**Additional context**
Add any other context or screenshots about the feature request here.
",Deepakjs5665,2024-10-11 04:40:37+00:00,[],2024-10-11 04:40:37+00:00,,https://github.com/frappe/erpnext/issues/43613,"[('feature-request', None)]",[],
2580307996,issue,closed,completed,Getting math domain error upon creating Sales Order,"### Information about bug

Hi folk,

I am getting ""ValueError: math domain error. Possible source of error: erpnext (app)"" while creating new Sales Order.

I have tried ""bench update"" and ""bench migrate"" but could resolved the issue.
![image](https://github.com/user-attachments/assets/094a6e22-225c-4c60-9cb9-10a7b71e9ddd)


### Module

selling

### Version

ERPNext: v15.x.x-develop () (develop)

Framework: v15.x.x-develop () (develop)

Frappe HR: v16.0.0-dev (develop)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""erpnext"": ""16.0.0-dev"",
	""frappe"": ""16.0.0-dev"",
	""hrms"": ""16.0.0-dev""
}
```
### Route
```
Form/Sales Order/new-sales-order-udpgroetav
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 118, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1831, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 32, in wrapper
    return func(*args, **kwargs)
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 411, in save
    return self._save(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 433, in _save
    return self.insert()
  File ""apps/frappe/frappe/model/document.py"", line 364, in insert
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1198, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 1050, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1433, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1411, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 1047, in fn
    return method_object(*args, **kwargs)
  File ""apps/erpnext/erpnext/selling/doctype/sales_order/sales_order.py"", line 200, in validate
    super().validate()
  File ""apps/erpnext/erpnext/controllers/selling_controller.py"", line 29, in validate
    super().validate()
  File ""apps/erpnext/erpnext/controllers/stock_controller.py"", line 52, in validate
    super().validate()
  File ""apps/erpnext/erpnext/controllers/accounts_controller.py"", line 269, in validate
    self.set_total_in_words()
  File ""apps/erpnext/erpnext/controllers/selling_controller.py"", line 135, in set_total_in_words
    self.base_in_words = money_in_words(base_amount, self.company_currency)
  File ""apps/frappe/frappe/utils/data.py"", line 1480, in money_in_words
    fraction_length = math.ceil(math.log10(fraction_units)) or number_format.precision
ValueError: math domain error

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""doc"": ""{\""docstatus\"":0,\""doctype\"":\""Sales Order\"",\""name\"":\""new-sales-order-udpgroetav\"",\""__islocal\"":1,\""__unsaved\"":1,\""owner\"":\""Administrator\"",\""title\"":\""{customer_name}\"",\""naming_series\"":\""SAL-ORD-.YYYY.-\"",\""order_type\"":\""Sales\"",\""transaction_date\"":\""2024-10-11\"",\""company\"":\""BizOS\"",\""skip_delivery_note\"":0,\""currency\"":\""VND\"",\""selling_price_list\"":\""Standard Selling\"",\""price_list_currency\"":\""VND\"",\""ignore_pricing_rule\"":0,\""reserve_stock\"":0,\""items\"":[{\""docstatus\"":0,\""doctype\"":\""Sales Order Item\"",\""name\"":\""new-sales-order-item-vsntcsmcgs\"",\""__islocal\"":1,\""__unsaved\"":1,\""owner\"":\""Administrator\"",\""ensure_delivery_based_on_produced_serial_no\"":0,\""is_stock_item\"":1,\""reserve_stock\"":1,\""stock_uom\"":\""Box\"",\""stock_reserved_qty\"":0,\""margin_type\"":\""\"",\""is_free_item\"":0,\""grant_commission\"":1,\""delivered_by_supplier\"":0,\""against_blanket_order\"":null,\""page_break\"":0,\""parent\"":\""new-sales-order-udpgroetav\"",\""parentfield\"":\""items\"",\""parenttype\"":\""Sales Order\"",\""idx\"":1,\""qty\"":1,\""conversion_factor\"":1,\""stock_qty\"":1,\""price_list_rate\"":0,\""base_price_list_rate\"":0,\""margin_rate_or_amount\"":0,\""rate_with_margin\"":0,\""discount_amount\"":0,\""distributed_discount_amount\"":0,\""base_rate_with_margin\"":0,\""rate\"":200000,\""amount\"":200000,\""base_rate\"":200000,\""base_amount\"":200000,\""stock_uom_rate\"":200000,\""net_rate\"":200000,\""net_amount\"":200000,\""base_net_rate\"":200000,\""base_net_amount\"":200000,\""billed_amt\"":0,\""valuation_rate\"":0,\""gross_profit\"":0,\""weight_per_unit\"":0,\""total_weight\"":0,\""blanket_order_rate\"":0,\""projected_qty\"":50,\""actual_qty\"":50,\""ordered_qty\"":0,\""planned_qty\"":0,\""production_plan_qty\"":0,\""work_order_qty\"":0,\""delivered_qty\"":0,\""produced_qty\"":0,\""returned_qty\"":0,\""picked_qty\"":0,\""delivery_date\"":\""2024-10-31\"",\""item_code\"":\""Máy tính\"",\""weight_uom\"":null,\""barcode\"":null,\""pricing_rules\"":\""\"",\""item_name\"":\""Máy tính\"",\""description\"":\""Máy tính\"",\""image\"":\""\"",\""warehouse\"":\""Stores - BizOS\"",\""income_account\"":\""Sales - BizOS\"",\""expense_account\"":\""Cost of Goods Sold - BizOS\"",\""discount_account\"":null,\""provisional_expense_account\"":null,\""cost_center\"":\""Main - BizOS\"",\""has_serial_no\"":0,\""has_batch_no\"":0,\""batch_no\"":null,\""uom\"":\""Box\"",\""min_order_qty\"":\""\"",\""discount_percentage\"":0,\""update_stock\"":0,\""is_fixed_asset\"":0,\""last_purchase_rate\"":0,\""transaction_date\"":\""2024-10-11\"",\""bom_no\"":null,\""item_group\"":\""Products\"",\""brand\"":null,\""manufacturer\"":null,\""manufacturer_part_no\"":null,\""item_tax_rate\"":\""{}\"",\""customer_item_code\"":null,\""reserved_qty\"":0,\""has_margin\"":false,\""free_item_data\"":[],\""child_docname\"":\""new-sales-order-item-vsntcsmcgs\""}],\""taxes\"":[],\""disable_rounded_total\"":0,\""apply_discount_on\"":\""Grand Total\"",\""packed_items\"":[],\""pricing_rules\"":[],\""payment_schedule\"":[],\""status\"":\""Draft\"",\""delivery_status\"":\""Not Delivered\"",\""billing_status\"":\""Not Billed\"",\""advance_payment_status\"":\""Not Requested\"",\""sales_team\"":[],\""group_same_items\"":0,\""language\"":\""en\"",\""is_internal_customer\"":0,\""party_account_currency\"":\""VND\"",\""advance_paid\"":0,\""conversion_rate\"":1,\""plc_conversion_rate\"":1,\""company_address\"":null,\""company_address_display\"":null,\""base_net_total\"":200000,\""net_total\"":200000,\""base_total\"":200000,\""total\"":200000,\""total_qty\"":1,\""rounding_adjustment\"":0,\""grand_total\"":200000,\""base_grand_total\"":200000,\""total_taxes_and_charges\"":0,\""base_total_taxes_and_charges\"":0,\""base_rounding_adjustment\"":0,\""rounded_total\"":200000,\""base_rounded_total\"":200000,\""in_words\"":\""\"",\""base_in_words\"":\""\"",\""base_discount_amount\"":0,\""amount_eligible_for_commission\"":200000,\""total_commission\"":null,\""tax_id\"":null,\""customer_name\"":\""Công ty thiết bị gia dụng\"",\""represents_company\"":null,\""customer\"":\""Công ty thiết bị gia dụng\"",\""customer_address\"":\""Công ty thiết bị gia dụng-Billing\"",\""address_display\"":\""Nam Từ Liêm<br>\\nHà Nội<br>\\nVietnam<br>\\n<br>\\n\"",\""shipping_address_name\"":\""Công ty thiết bị gia dụng-Billing\"",\""shipping_address\"":\""Nam Từ Liêm<br>\\nHà Nội<br>\\nVietnam<br>\\n<br>\\n\"",\""tax_category\"":\""\"",\""contact_person\"":null,\""contact_display\"":null,\""contact_email\"":null,\""contact_mobile\"":null,\""contact_phone\"":null,\""customer_group\"":null,\""territory\"":null,\""payment_terms_template\"":null,\""delivery_date\"":\""2024-10-31\"",\""total_net_weight\"":0}"",
		""action"": ""Save""
	},
	""btn"": {
		""jQuery370055552854108579951"": {
			""events"": {
				""click"": [
					{
						""type"": ""click"",
						""origType"": ""click"",
						""guid"": 4387,
						""namespace"": """"
					}
				]
			}
		}
	},
	""freeze"": true,
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.form.save.savedocs"",
	""request_id"": null
}
```
### Response Data
```
{
	""exception"": ""ValueError: math domain error"",
	""exc_type"": ""ValueError"",
	""_exc_source"": ""erpnext (app)"",
	""_server_messages"": ""[\""{\\\""message\\\"": \\\""Item Price added for M\\\\u00e1y t\\\\u00ednh in Price List Standard Selling\\\"", \\\""title\\\"": \\\""Message\\\"", \\\""alert\\\"": 1}\""]""
}
```
```
",rnd-nguyenth,2024-10-11 02:54:58+00:00,[],2024-10-30 00:10:20+00:00,2024-10-14 06:52:23+00:00,https://github.com/frappe/erpnext/issues/43611,"[('bug', None)]","[{'comment_id': 2410184722, 'issue_id': 2580307996, 'author': 'Nihantra-Patel', 'body': ""We tested in the frappe cloud and also in locally, we haven't found the issue in the dev version. we suggest checking with the stable version because every day lots of changes are added in the develop branch and we don't suggest a Live project in the dev branch.\r\n\r\n[scrnli_Lo16MTUVqnM8vy.webm](https://github.com/user-attachments/assets/03444657-02b4-4278-b57d-09e6df537fcd)\r\n\r\n\r\nAgain update the version and check it.\r\n\r\nFirst take a backup, if important data:\r\n\r\n```\r\nbench update --rest\r\nbench --site sitename.com migrate\r\nbench build --force\r\n```"", 'created_at': datetime.datetime(2024, 10, 14, 6, 52, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2412652234, 'issue_id': 2580307996, 'author': 'rnd-nguyenth', 'body': 'Hi @Nihantra-Patel,\r\n\r\nThanks for looking into this. I just want to explore the new version. Looking forward to the official release. Thanks again.', 'created_at': datetime.datetime(2024, 10, 15, 1, 52, 1, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-10-14 06:52:24 UTC): We tested in the frappe cloud and also in locally, we haven't found the issue in the dev version. we suggest checking with the stable version because every day lots of changes are added in the develop branch and we don't suggest a Live project in the dev branch.

[scrnli_Lo16MTUVqnM8vy.webm](https://github.com/user-attachments/assets/03444657-02b4-4278-b57d-09e6df537fcd)


Again update the version and check it.

First take a backup, if important data:

```
bench update --rest
bench --site sitename.com migrate
bench build --force
```

rnd-nguyenth (Issue Creator) on (2024-10-15 01:52:01 UTC): Hi @Nihantra-Patel,

Thanks for looking into this. I just want to explore the new version. Looking forward to the official release. Thanks again.

"
2579128948,issue,open,,Tabs in doctype Project,"
**Is your feature request related to a problem? Please describe.**

The project doctype, should be rethinked with **tabs** like most doctypes.

![Captura de pantalla 2024-10-10 a la(s) 11 58 12 a  m](https://github.com/user-attachments/assets/adfe6142-ffb4-4c2f-b9b2-7d3614748f2f)


**Describe the solution you'd like**

I don't think I have a concrete design but this can be decided by anyone in Frappe.


",federicocalvo,2024-10-10 15:01:45+00:00,[],2024-10-10 15:01:45+00:00,,https://github.com/frappe/erpnext/issues/43608,"[('feature-request', None)]",[],
2578408656,issue,closed,completed,Advance amount in Accounts Payable report is incorrect,"### Information about bug

Advance amount in Accounts Payable report is not correct when the advances paid to suppliers are marked as assets and reconciled later.


https://github.com/user-attachments/assets/2eeb530c-34cd-4c8b-84d7-da7b18ad1e8d



### Module

accounts

### Version

ERPNext Version: 15+

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",venkat102,2024-10-10 10:39:54+00:00,[],2024-11-05 00:10:17+00:00,2024-10-21 06:35:58+00:00,https://github.com/frappe/erpnext/issues/43604,"[('bug', None)]","[{'comment_id': 2413667185, 'issue_id': 2578408656, 'author': 'Swethadevi-D', 'body': ""The Accounts Payable Summary Report is functioning correctly, in the Payment Entry, when you pay an advance amount, it is posted to the creditors' account. However, when you create a Journal Entry, the amount is posted to the sales account, leaving no balance in the creditors' account. When using the Payment Reconciliation Tool, it fetches unreconciled data from the Payment Entry. After reconciling, the paid amount appears as a negative value because there is no balance in the creditors' account so only it shown negative amount in report"", 'created_at': datetime.datetime(2024, 10, 15, 11, 41, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2425709497, 'issue_id': 2578408656, 'author': 'venkat102', 'body': ""@Swethadevi-D In the Payment Entry, the advance amount is posted in the advance account, not in the creditors' account\r\nthe issue happens when the reconciliation happens among advance and creditors' accounts."", 'created_at': datetime.datetime(2024, 10, 21, 6, 35, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2425710508, 'issue_id': 2578408656, 'author': 'venkat102', 'body': 'solved with PR #43728', 'created_at': datetime.datetime(2024, 10, 21, 6, 35, 58, tzinfo=datetime.timezone.utc)}]","Swethadevi-D on (2024-10-15 11:41:31 UTC): The Accounts Payable Summary Report is functioning correctly, in the Payment Entry, when you pay an advance amount, it is posted to the creditors' account. However, when you create a Journal Entry, the amount is posted to the sales account, leaving no balance in the creditors' account. When using the Payment Reconciliation Tool, it fetches unreconciled data from the Payment Entry. After reconciling, the paid amount appears as a negative value because there is no balance in the creditors' account so only it shown negative amount in report

venkat102 (Issue Creator) on (2024-10-21 06:35:15 UTC): @Swethadevi-D In the Payment Entry, the advance amount is posted in the advance account, not in the creditors' account
the issue happens when the reconciliation happens among advance and creditors' accounts.

venkat102 (Issue Creator) on (2024-10-21 06:35:58 UTC): solved with PR #43728

"
2577236335,issue,open,,Allow for automatically associating a particular print format to a customer or supplier,"For example, say we have a customer set up in the system called Customer A, and every time we create a sales invoice for Customer A, we want to automatically have a specific print format selected, which might be different from the default one being used for other customers. 
",c-l-v,2024-10-10 00:21:44+00:00,[],2024-10-10 00:21:44+00:00,,https://github.com/frappe/erpnext/issues/43598,"[('feature-request', None)]",[],
2575758118,issue,open,,Work Order - Collect quantities,"### Information about bug

* BOM - There are similar varieties but the Operation is different.
![image](https://github.com/user-attachments/assets/55edccc6-f8cc-4a39-950c-3eb7372bdabd)

* Work Order : Add the quantity together ( Each quantity should be separate because the operation is different. )
![image](https://github.com/user-attachments/assets/1bc53b27-3e75-4b48-b566-4bd6d1925ae6)

![image](https://github.com/user-attachments/assets/209ceac9-d2d2-41e0-b50e-f160456853c2)



### Module

manufacturing

### Version

ERPNext: v15.38.0 (version-15)

Frappe Framework: v15.43.0 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",tajff,2024-10-09 12:15:26+00:00,[],2024-10-09 12:15:26+00:00,,https://github.com/frappe/erpnext/issues/43596,"[('bug', None)]",[],
2573775317,issue,open,,Bug in Chart of Accounts Importer,"### Information about bug

Please check trace-back

### Module

accounts

### Version

""ecommerce_integrations"": ""1.20.1"",
	""erpnext"": ""15.38.0"",
	""frappe"": ""15.43.0"",
	""payments"": ""0.0.1"",
	""webshop"": ""0.0.1""

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""ecommerce_integrations"": ""1.20.1"",
	""erpnext"": ""15.38.0"",
	""frappe"": ""15.43.0"",
	""payments"": ""0.0.1"",
	""webshop"": ""0.0.1""
}
```
### Route
```
Form/Chart of Accounts Importer/Chart of Accounts Importer
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1775, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 337, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 373, in _save
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1091, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 962, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1322, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1304, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 959, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/accounts/doctype/chart_of_accounts_importer/chart_of_accounts_importer.py"", line 41, in validate
    get_coa(""Chart of Accounts Importer"", ""All Accounts"", file_name=self.import_file, for_validate=1)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/accounts/doctype/chart_of_accounts_importer/chart_of_accounts_importer.py"", line 174, in get_coa
    validate_accounts(file_doc, extension)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/accounts/doctype/chart_of_accounts_importer/chart_of_accounts_importer.py"", line 372, in validate_accounts
    accounts_dict.setdefault(account[""account_name""], account)
                             ~~~~~~~^^^^^^^^^^^^^^^^
KeyError: 'account_name'

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""doc"": ""{\""name\"":\""Chart of Accounts Importer\"",\""owner\"":\""Administrator\"",\""modified\"":\""2024-10-08 22:43:41.789891\"",\""modified_by\"":\""shadabfs@alazka.ai\"",\""docstatus\"":0,\""idx\"":\""0\"",\""doctype\"":\""Chart of Accounts Importer\"",\""company\"":\""MARWA IMPEX PRIVATE LIMITED (24-25)\"",\""import_file\"":\""/private/files/COA7.csv\"",\""__unsaved\"":1}"",
		""action"": ""Save""
	},
	""freeze"": true,
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.form.save.savedocs"",
	""request_id"": ""64a40c2a-5c3f-49f0-a542-ad7c0f6c7bf1""
}
```
### Response Data
```
{
	""exception"": ""KeyError: 'account_name'"",
	""exc_type"": ""KeyError"",
	""_exc_source"": ""erpnext (app)""
}
```
```
",skyasir456,2024-10-08 17:16:27+00:00,[],2024-10-09 05:30:47+00:00,,https://github.com/frappe/erpnext/issues/43582,"[('bug', None)]",[],
2573712389,issue,closed,completed,Wrong Stock Valuation ,"### Information about bug

Item Stock Valuation method - Moving Average

Purchased item -A on 1st jan 24 qty one @ 200 warehouse - rack1

Purchased item -A on 2nd jan 24 qty one @ 200 warehouse - rack1

Purchased item -A on 3rd jan 24 qty one @ 0  warehouse - rack2

Item  Stock Valuation method - Moving Average

now  item-A Valuation becomes 133.33

Stock Value Should Be 400

if i sell item from warehouse rack 2 , the stock value remains @ 400 for remaining 2 items-A

it should work out to 133.33 × 2 = 266.66

Kindly do needful

Thanks

### Module

stock

### Version

ERPNext: v14.74.3 (HEAD)
Frappe Framework: v14.81.6 (HEAD)
Frappe HR: v14.33.0 (HEAD)
India Compliance: v14.30.5 (HEAD)
Payments: v0.0.1 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Item Stock Valuation method - Moving Average

Purchased item -A on 1st jan 24 qty one @ 200 warehouse - rack1

Purchased item -A on 2nd jan 24 qty one @ 200 warehouse - rack1

Purchased item -A on 3rd jan 24 qty one @ 0  warehouse - rack2

Item  Stock Valuation method - Moving Average

now  item-A Valuation becomes 133.33

Stock Value Should Be 400

if i sell item from warehouse rack 2 , the stock value remains @ 400 for remaining 2 items-A

Stock Value in Balance Sheet is Shown As 400 instead of 266.66





Kindly do needful

Thanks
```
",bhavyajicomputers,2024-10-08 16:44:08+00:00,[],2025-01-03 00:10:25+00:00,2024-12-20 00:08:45+00:00,https://github.com/frappe/erpnext/issues/43580,"[('bug', None)]","[{'comment_id': 2555990213, 'issue_id': 2573712389, 'author': 'rohitwaghchaure', 'body': 'Valuation we calculate based on item and warehouse. So the system has calculated correct valuation rate.\r\nBetter you use inventory dimension for rack with single warehouse to achieve your use case.', 'created_at': datetime.datetime(2024, 12, 20, 0, 8, 45, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure on (2024-12-20 00:08:45 UTC): Valuation we calculate based on item and warehouse. So the system has calculated correct valuation rate.
Better you use inventory dimension for rack with single warehouse to achieve your use case.

"
2573140217,issue,closed,completed,Sales Order Trends does not include Sales Orders with status 'Closed',"### Information about bug

@Nihantra-Patel @deepeshgarg007 
Sorry for the new issue but could you please merge #41548 into v15?

The old issue and the PR are locked and I don't know if this has been forgotten or if it is being held off for some other reason.

### Module

buying, selling

### Version

erpnext 15.38.0
frappe 15.43.0

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",SvbZ3r0,2024-10-08 13:01:03+00:00,[],2024-10-26 00:10:09+00:00,2024-10-08 13:37:48+00:00,https://github.com/frappe/erpnext/issues/43576,"[('bug', None)]","[{'comment_id': 2405509077, 'issue_id': 2573140217, 'author': 'SvbZ3r0', 'body': 'Would it be possible to allow this setting to work in the charts in the Selling and Buying Workspace too?', 'created_at': datetime.datetime(2024, 10, 10, 16, 1, 14, tzinfo=datetime.timezone.utc)}]","SvbZ3r0 (Issue Creator) on (2024-10-10 16:01:14 UTC): Would it be possible to allow this setting to work in the charts in the Selling and Buying Workspace too?

"
2573097748,issue,open,,Updating Project in Payment Entry does not push change downstream to GL Entry,"### Information about bug

When updating the Project associated with a Purchase Invoice or a Journal Entry, the associated old GL Entries are cancelled and new ones are created with the updated Project. 
However, when changing the Project associated with a Payment Entry, the GL entries are not updated. This means the Payment Entry will now show up when filtering Payment Entries by Project, but the old Project will show up in the General Ledger and all financial statements.
Since the Payment Entries are successfully updated, this causes a lot of problems.

What should happen:
Updating Project in Payment Entry should function the same way as updating Project in Purchase Invoice or Journal Entry.

### Module

accounts, projects

### Version

crm 1.24.7
erpnext 15.38.0
frappe 15.43.0
hrms 15.31.0
india_compliance 15.13.3
payments 0.0.1
print_designer 1.4.3

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",SvbZ3r0,2024-10-08 12:43:03+00:00,[],2024-10-08 12:43:03+00:00,,https://github.com/frappe/erpnext/issues/43575,"[('bug', None)]",[],
2572736106,issue,open,,Please add the Egyptian Einvoice API integration ,"This integration will make ERPnext the most popular system in Egypt. 

I have no development experience, but this is the documentation by the tax authority https://sdk.invoicing.eta.gov.eg/api/ ",Mina-Geez,2024-10-08 10:09:48+00:00,[],2024-10-08 10:09:48+00:00,,https://github.com/frappe/erpnext/issues/43565,"[('feature-request', None)]",[],
2572720407,issue,open,,Disallow selection of UOM not registered in Item master,"We have a lot of items that need multiple UOM. Ofcourse everyone does.

![image](https://github.com/user-attachments/assets/ab26da43-1e97-4c41-a4ca-686baed7a022)

Here, Default unit is Box.

The problem is: 

Users select any other unit that is not set as UOM for that item. Most often, for some items, we do not create many options of UOM to make tracking easy. Sometimes, users get confused as to which UOM to use. 

For ex. for any item that has default UOM : Pieces. and secondary unit: box (conversion 30)
The user buys 2  box (30 pcs in each ) and inputs 2 **Nos** in Purchase order because they don't realize that Pieces and Nos might be different for different items. 

To solve this, would it be possible to restrict user to select only one of the registered UOM only for that item?
",ajiragroup,2024-10-08 10:02:36+00:00,[],2024-10-08 10:02:36+00:00,,https://github.com/frappe/erpnext/issues/43564,"[('feature-request', None)]",[],
2572592008,issue,closed,completed,validate component quantity according to BOM,"### Information about bug

https://github.com/frappe/erpnext/pull/43014

The above issue are fixe working fine

There should be one more validation if any Line is deleted from the row then it's not validating with the BOM.

Provision to delete the Line item from the stock entry type Manufacture OR
It should not allow to save or need to record those lines in one report so get to know we have no consumed those items in the manufacturing process.


### Module

manufacturing

### Version

V15 Latest release 

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",dineshpanchal93,2024-10-08 09:11:43+00:00,[],2025-02-07 00:10:18+00:00,2025-01-23 06:52:20+00:00,https://github.com/frappe/erpnext/issues/43561,"[('bug', None)]",[],
2572532611,issue,closed,completed,Valuation Rate | Avg Rate | FIFO Rate,"### Information about bug

As per the income tax, All the CA's are asking for the FIFO-based valuation is setup to give us the summery of how the consumption is being done FIFO or Moving Average

There is report called Stock ledger Invariant  we can see Consumption rate is based on FIFO

How we can get those in Stock balance?

### Module

accounts, stock

### Version

V15

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",dineshpanchal93,2024-10-08 08:48:52+00:00,[],2024-10-26 00:10:10+00:00,2024-10-10 06:13:32+00:00,https://github.com/frappe/erpnext/issues/43560,"[('bug', None)]","[{'comment_id': 2399350680, 'issue_id': 2572532611, 'author': 'frewper', 'body': 'Can you please be more elaborate on the question. More brief would help. Unable to understand the question', 'created_at': datetime.datetime(2024, 10, 8, 9, 34, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2404126952, 'issue_id': 2572532611, 'author': 'rohitwaghchaure', 'body': 'Stock Balance is summary of the Stock Ledger report. You better check the stock ledger report or customized it according to your requirement.', 'created_at': datetime.datetime(2024, 10, 10, 6, 13, 32, tzinfo=datetime.timezone.utc)}]","frewper on (2024-10-08 09:34:53 UTC): Can you please be more elaborate on the question. More brief would help. Unable to understand the question

rohitwaghchaure on (2024-10-10 06:13:32 UTC): Stock Balance is summary of the Stock Ledger report. You better check the stock ledger report or customized it according to your requirement.

"
2572528470,issue,open,,"Add fields to Issue : Item , Serial No","<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 




-->

**Is your feature request related to a problem? Please describe.**
My feature request does not relate to a problem

**Describe the solution you'd like**
Please may two fields be added to the ""Details"" section on ""Issue"".
Item and Serial No
These fields should be non-mandatory.


**Describe alternatives you've considered**
No alternatives considered

**Additional context**
Many times when a customer raises an  issue, an item is involved. And some items may have a serial no.
The only way to capture this currently, is in the text-box.
",johnwslongland,2024-10-08 08:47:05+00:00,[],2024-10-21 14:07:29+00:00,,https://github.com/frappe/erpnext/issues/43559,"[('feature-request', None)]","[{'comment_id': 2405425132, 'issue_id': 2572528470, 'author': 'Glitch-Trap-1', 'body': '@johnwslongland \r\n\r\nI just played with this. I made a custom item field and custom serial number field in the Issue Doctype. Then you select an Item which might have a serial number. If the Item does have a serial number, it will show you a serial number field with relevant serial numbers to the item only. If the Item doesn\'t have a serial number, you will get a notification on the bottom right side saying ""No Serial Numbers found for the selected Item"". I wrote a custom script for the client side and selected Issue as the Doctype. Both fields aren\'t mandatory. Is it close to what you were looking for?', 'created_at': datetime.datetime(2024, 10, 10, 15, 22, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2405747117, 'issue_id': 2572528470, 'author': 'johnwslongland', 'body': '@Glitch-Trap-1 \r\nThat\'s correct ! Nice touch .... the ""show_alert"" pop-up. I didn\'t think of that !!!', 'created_at': datetime.datetime(2024, 10, 10, 18, 9, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2405808557, 'issue_id': 2572528470, 'author': 'Glitch-Trap-1', 'body': '@johnwslongland \r\n\r\nAlright here are the steps\r\n\r\nStep 1: Navigate to  **Issue** and click on **Customize Form**\r\n\r\nStep 2: Create two **Link** Fields named **Item** and **Serial Number** under the details section. (double check that custom field names are **custom_item** and **custom_serial_number** respectively or else the script won\'t work)\r\n\r\nStep 3: Click on the **Item** field and scroll down to **Options** on the right side of your screen. Type in **Item** as that is the DocType you are referencing for that field. \r\n\r\nStep 4: Click on the **Serial Number** field and scroll down to **Options** on the right side of your screen. Type in **Serial No** as that is the DocType you are referencing for that field. \r\n\r\nStep 5: Save the customized form and go to the home page\r\n\r\nStep 6: Use the search bar on the top right and type in **Client Script List** and hit **enter**\r\n\r\nStep 7: Click on the **Add Client Script** button\r\n\r\nStep 8: Add your custom script name **(ex. Issue SN Script)**\r\n\r\nStep 9: Select your DocType in this case which is **Issue**. Leave **Apply To** as **Form**\r\n\r\nStep 10: Paste this custom script code into **Script** field\r\n\r\n```\r\nfrappe.ui.form.on(\'Issue\', {\r\n    refresh: function(frm) {\r\n        frm.set_query(""custom_serial_number"", function(doc) {\r\n            return {\r\n                filters: {\r\n                    \'item_code\': doc.custom_item\r\n                }\r\n            };\r\n        });\r\n    },\r\n    \r\n    custom_item: function(frm) {\r\n        frm.set_value(\'custom_serial_number\', \'\'); // Clear the custom_serial_number field when item changes\r\n        \r\n        if (frm.doc.custom_item) {\r\n            frappe.call({\r\n                method: \'frappe.client.get_list\',\r\n                args: {\r\n                    doctype: \'Serial No\',\r\n                    filters: {\r\n                        \'item_code\': frm.doc.custom_item\r\n                    },\r\n                    fields: [\'name\'],\r\n                    limit: 1\r\n                },\r\n                callback: function(response) {\r\n                    if (response.message && response.message.length > 0) {\r\n                        frm.set_df_property(\'custom_serial_number\', \'hidden\', 0); // Show the field\r\n                        frm.refresh_field(\'custom_serial_number\');\r\n                    } else {\r\n                        frm.set_df_property(\'custom_serial_number\', \'hidden\', 1); // Hide the field\r\n                        frappe.show_alert({\r\n                            message: __(\'No Serial Numbers found for the selected Item.\'),\r\n                            indicator: \'orange\'\r\n                        }, 5);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            frm.set_df_property(\'custom_serial_number\', \'hidden\', 1); // Hide the field when no item is selected\r\n        }\r\n        frm.refresh_field(\'custom_serial_number\');\r\n    }\r\n});\r\n```\r\n\r\nStep 11: Tick the **Enabled** box and save the script\r\n\r\nStep 12: Click on your profile and click on **Reload** (This will clear cache) and refresh the page for good measure\r\n\r\nNow it should filter serial numbers based on the item chosen. Make sure you create the serial numbers for the Item beforehand. Funny enough I only did this because I felt as it would be useful for the company I work at. If you need more help on how to implement this. Just let me know', 'created_at': datetime.datetime(2024, 10, 10, 18, 45, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2423561657, 'issue_id': 2572528470, 'author': 'johnwslongland', 'body': 'Nice stuff @Glitch-Trap-1 \r\nI will look at your code and add to the code I have. \r\nAnd as you say, it is usefull in your company as well. I am hoping that the developers also agree that it is a usefull thing to have on an ""Issue"" doctype and that they add this to the core-code.\r\n\r\nSurely, there are cases that an issue is related to an Item ? I agree, dont make it manadatory, because it can be argued that not all issues are related to items, but at least have the fields available if there are users that have use-cases that can use  it.\r\n\r\nGreat effort ! Thank you !', 'created_at': datetime.datetime(2024, 10, 19, 4, 24, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2426792403, 'issue_id': 2572528470, 'author': 'Glitch-Trap-1', 'body': ""@johnwslongland \r\n\r\nI do agree with that. It might not pertain to all businesses but they should have no reason not to implement this into the core logic as a function that can be enabled. Most products we sell have serial numbers and we like to record the serial number of the machine that is having issues. Tracking issues becomes much simpler if I can just type in the Serial Number of the specific product since one company might have multiple machines. Integrating the Item and Serial Number doctypes into Issues shouldn't be difficult but I do understand that having more features means a wider scope to manage. \r\n\r\nHopefully it helps you and good luck!"", 'created_at': datetime.datetime(2024, 10, 21, 14, 7, 16, tzinfo=datetime.timezone.utc)}]","Glitch-Trap-1 on (2024-10-10 15:22:42 UTC): @johnwslongland 

I just played with this. I made a custom item field and custom serial number field in the Issue Doctype. Then you select an Item which might have a serial number. If the Item does have a serial number, it will show you a serial number field with relevant serial numbers to the item only. If the Item doesn't have a serial number, you will get a notification on the bottom right side saying ""No Serial Numbers found for the selected Item"". I wrote a custom script for the client side and selected Issue as the Doctype. Both fields aren't mandatory. Is it close to what you were looking for?

johnwslongland (Issue Creator) on (2024-10-10 18:09:46 UTC): @Glitch-Trap-1 
That's correct ! Nice touch .... the ""show_alert"" pop-up. I didn't think of that !!!

Glitch-Trap-1 on (2024-10-10 18:45:03 UTC): @johnwslongland 

Alright here are the steps

Step 1: Navigate to  **Issue** and click on **Customize Form**

Step 2: Create two **Link** Fields named **Item** and **Serial Number** under the details section. (double check that custom field names are **custom_item** and **custom_serial_number** respectively or else the script won't work)

Step 3: Click on the **Item** field and scroll down to **Options** on the right side of your screen. Type in **Item** as that is the DocType you are referencing for that field. 

Step 4: Click on the **Serial Number** field and scroll down to **Options** on the right side of your screen. Type in **Serial No** as that is the DocType you are referencing for that field. 

Step 5: Save the customized form and go to the home page

Step 6: Use the search bar on the top right and type in **Client Script List** and hit **enter**

Step 7: Click on the **Add Client Script** button

Step 8: Add your custom script name **(ex. Issue SN Script)**

Step 9: Select your DocType in this case which is **Issue**. Leave **Apply To** as **Form**

Step 10: Paste this custom script code into **Script** field

```
frappe.ui.form.on('Issue', {
    refresh: function(frm) {
        frm.set_query(""custom_serial_number"", function(doc) {
            return {
                filters: {
                    'item_code': doc.custom_item
                }
            };
        });
    },
    
    custom_item: function(frm) {
        frm.set_value('custom_serial_number', ''); // Clear the custom_serial_number field when item changes
        
        if (frm.doc.custom_item) {
            frappe.call({
                method: 'frappe.client.get_list',
                args: {
                    doctype: 'Serial No',
                    filters: {
                        'item_code': frm.doc.custom_item
                    },
                    fields: ['name'],
                    limit: 1
                },
                callback: function(response) {
                    if (response.message && response.message.length > 0) {
                        frm.set_df_property('custom_serial_number', 'hidden', 0); // Show the field
                        frm.refresh_field('custom_serial_number');
                    } else {
                        frm.set_df_property('custom_serial_number', 'hidden', 1); // Hide the field
                        frappe.show_alert({
                            message: __('No Serial Numbers found for the selected Item.'),
                            indicator: 'orange'
                        }, 5);
                    }
                }
            });
        } else {
            frm.set_df_property('custom_serial_number', 'hidden', 1); // Hide the field when no item is selected
        }
        frm.refresh_field('custom_serial_number');
    }
});
```

Step 11: Tick the **Enabled** box and save the script

Step 12: Click on your profile and click on **Reload** (This will clear cache) and refresh the page for good measure

Now it should filter serial numbers based on the item chosen. Make sure you create the serial numbers for the Item beforehand. Funny enough I only did this because I felt as it would be useful for the company I work at. If you need more help on how to implement this. Just let me know

johnwslongland (Issue Creator) on (2024-10-19 04:24:58 UTC): Nice stuff @Glitch-Trap-1 
I will look at your code and add to the code I have. 
And as you say, it is usefull in your company as well. I am hoping that the developers also agree that it is a usefull thing to have on an ""Issue"" doctype and that they add this to the core-code.

Surely, there are cases that an issue is related to an Item ? I agree, dont make it manadatory, because it can be argued that not all issues are related to items, but at least have the fields available if there are users that have use-cases that can use  it.

Great effort ! Thank you !

Glitch-Trap-1 on (2024-10-21 14:07:16 UTC): @johnwslongland 

I do agree with that. It might not pertain to all businesses but they should have no reason not to implement this into the core logic as a function that can be enabled. Most products we sell have serial numbers and we like to record the serial number of the machine that is having issues. Tracking issues becomes much simpler if I can just type in the Serial Number of the specific product since one company might have multiple machines. Integrating the Item and Serial Number doctypes into Issues shouldn't be difficult but I do understand that having more features means a wider scope to manage. 

Hopefully it helps you and good luck!

"
2572359556,issue,open,,Add Barcode Validation For Items,"**Is your feature request related to a problem? Please describe.**

I'm always frustrated when a barcode with an incorrect format is mistakenly added to an item. Recently, one of my clients encountered an issue where they added a UPC-A barcode with only 11 digits instead of the required 12. This caused errors and required debugging. If the system had validated the barcode length and check digit, this problem could have been avoided, saving time and effort.

This issue can also happen with other barcode formats, such as EAN, where the required length and check digit validation are equally important.

![image](https://github.com/user-attachments/assets/adb4511d-880e-446b-a43b-9d7bd8d8d0ea)


**Describe the solution you'd like**

I would like ERPNext to implement a barcode validation feature that ensures barcodes follow the correct format before they are saved. Specifically, the system should:

Validate that the barcode has the required length (e.g., 12 digits for UPC-A and 13 digits for EAN-13).
Ensure the check digit is correctly calculated and matches the barcode for both UPC-A and EAN formats.
This would help prevent human errors during data entry and make barcode handling more reliable across the system.

**Describe alternatives you've considered**

Manually checking barcode lengths and validating check digits outside ERPNext is an option, but it is inefficient and prone to error. Having this validation built into ERPNext would greatly improve workflow and reduce the chances of mistakes.

**Additional context**

This issue occurred during the setup of an item catalog, where multiple barcodes were added. One of the barcodes had a mistake (11 digits instead of 12 for a UPC-A), which led to errors and time-consuming debugging. A similar issue could occur with EAN barcodes if length or check digits are incorrect. A screenshot of a sample UPC-A and EAN-13 barcode format with the proper check digit process could be provided if needed for better understanding.

also it was bit hard to figure out what problem in first place because typing barcode worked but scanning did not because scanner barcode already check digit include causing product not show up like example below with no error msg

https://github.com/user-attachments/assets/f8cf9978-ac1b-4bdf-80db-048da8c6c18b

",johnneijzen,2024-10-08 07:39:48+00:00,[],2024-10-08 09:07:56+00:00,,https://github.com/frappe/erpnext/issues/43556,"[('feature-request', None)]","[{'comment_id': 2399289379, 'issue_id': 2572359556, 'author': 'johnneijzen', 'body': 'this just idea how this could be implemented but i am sure there better way to do it i just want help out what i can\r\n\r\n# erpnext/utilities/barcode_helper.py\r\n\r\n```\r\nclass BarcodeHelper:\r\n    @staticmethod\r\n    def validate_check_digit_upca(barcode):\r\n        # UPC-A check digit validation\r\n        total = 0\r\n        for i, digit in enumerate(barcode[:-1]):\r\n            digit = int(digit)\r\n            total += digit * (3 if i % 2 == 0 else 1)\r\n\r\n        check_digit = (10 - (total % 10)) % 10\r\n        return check_digit == int(barcode[-1])\r\n\r\n    @staticmethod\r\n    def validate_check_digit_ean(barcode):\r\n        # EAN-8 and EAN-13 check digit validation (same logic)\r\n        total = 0\r\n        for i, digit in enumerate(barcode[:-1]):\r\n            digit = int(digit)\r\n            total += digit * (3 if i % 2 else 1)\r\n\r\n        check_digit = (10 - (total % 10)) % 10\r\n        return check_digit == int(barcode[-1])\r\n```\r\n\r\n# erpnext/stock/doctype/item_barcode/item_barcode.py\r\n```\r\nfrom frappe import _\r\nfrom frappe.model.document import Document\r\nfrom erpnext.utilities.barcode_helper import BarcodeHelper\r\n\r\nclass ItemBarcode(Document):\r\n    def validate(self):\r\n        # Call the barcode validation function\r\n        self.validate_barcode()\r\n\r\n    def validate_barcode(self):\r\n        # Dictionary to map barcode type to validation functions\r\n        barcode_validators = {\r\n            \'UPC-A\': self.validate_upca,\r\n            \'EAN-8\': self.validate_ean8,\r\n            \'EAN\': self.validate_ean13  # EAN-13\r\n        }\r\n\r\n        # If a validator for the barcode type exists, call it\r\n        if self.barcode_type in barcode_validators:\r\n            barcode_validators[self.barcode_type](self.barcode)\r\n\r\n    def validate_upca(self, barcode):\r\n        # UPC-A should be 12 digits long\r\n        if len(barcode) != 12:\r\n            frappe.throw(_(""UPC-A barcode must be 12 digits long.""))\r\n\r\n        if not barcode.isdigit():\r\n            frappe.throw(_(""UPC-A barcode must contain only digits.""))\r\n\r\n        # Validate the check digit (last digit)\r\n        if not BarcodeHelper.validate_check_digit_upca(barcode):\r\n            frappe.throw(_(""Invalid check digit for UPC-A barcode.""))\r\n\r\n    def validate_ean8(self, barcode):\r\n        # EAN-8 should be 8 digits long\r\n        if len(barcode) != 8:\r\n            frappe.throw(_(""EAN-8 barcode must be 8 digits long.""))\r\n\r\n        if not barcode.isdigit():\r\n            frappe.throw(_(""EAN-8 barcode must contain only digits.""))\r\n\r\n        # Validate the check digit (last digit)\r\n        if not BarcodeHelper.validate_check_digit_ean(barcode):\r\n            frappe.throw(_(""Invalid check digit for EAN-8 barcode.""))\r\n\r\n    def validate_ean13(self, barcode):\r\n        # EAN-13 should be 13 digits long\r\n        if len(barcode) != 13:\r\n            frappe.throw(_(""EAN-13 barcode must be 13 digits long.""))\r\n\r\n        if not barcode.isdigit():\r\n            frappe.throw(_(""EAN-13 barcode must contain only digits.""))\r\n\r\n        # Validate the check digit (last digit)\r\n        if not BarcodeHelper.validate_check_digit_ean(barcode):\r\n            frappe.throw(_(""Invalid check digit for EAN-13 barcode.""))\r\n\r\n```', 'created_at': datetime.datetime(2024, 10, 8, 9, 7, 55, tzinfo=datetime.timezone.utc)}]","johnneijzen (Issue Creator) on (2024-10-08 09:07:55 UTC): this just idea how this could be implemented but i am sure there better way to do it i just want help out what i can

# erpnext/utilities/barcode_helper.py

```
class BarcodeHelper:
    @staticmethod
    def validate_check_digit_upca(barcode):
        # UPC-A check digit validation
        total = 0
        for i, digit in enumerate(barcode[:-1]):
            digit = int(digit)
            total += digit * (3 if i % 2 == 0 else 1)

        check_digit = (10 - (total % 10)) % 10
        return check_digit == int(barcode[-1])

    @staticmethod
    def validate_check_digit_ean(barcode):
        # EAN-8 and EAN-13 check digit validation (same logic)
        total = 0
        for i, digit in enumerate(barcode[:-1]):
            digit = int(digit)
            total += digit * (3 if i % 2 else 1)

        check_digit = (10 - (total % 10)) % 10
        return check_digit == int(barcode[-1])
```

# erpnext/stock/doctype/item_barcode/item_barcode.py
```
from frappe import _
from frappe.model.document import Document
from erpnext.utilities.barcode_helper import BarcodeHelper

class ItemBarcode(Document):
    def validate(self):
        # Call the barcode validation function
        self.validate_barcode()

    def validate_barcode(self):
        # Dictionary to map barcode type to validation functions
        barcode_validators = {
            'UPC-A': self.validate_upca,
            'EAN-8': self.validate_ean8,
            'EAN': self.validate_ean13  # EAN-13
        }

        # If a validator for the barcode type exists, call it
        if self.barcode_type in barcode_validators:
            barcode_validators[self.barcode_type](self.barcode)

    def validate_upca(self, barcode):
        # UPC-A should be 12 digits long
        if len(barcode) != 12:
            frappe.throw(_(""UPC-A barcode must be 12 digits long.""))

        if not barcode.isdigit():
            frappe.throw(_(""UPC-A barcode must contain only digits.""))

        # Validate the check digit (last digit)
        if not BarcodeHelper.validate_check_digit_upca(barcode):
            frappe.throw(_(""Invalid check digit for UPC-A barcode.""))

    def validate_ean8(self, barcode):
        # EAN-8 should be 8 digits long
        if len(barcode) != 8:
            frappe.throw(_(""EAN-8 barcode must be 8 digits long.""))

        if not barcode.isdigit():
            frappe.throw(_(""EAN-8 barcode must contain only digits.""))

        # Validate the check digit (last digit)
        if not BarcodeHelper.validate_check_digit_ean(barcode):
            frappe.throw(_(""Invalid check digit for EAN-8 barcode.""))

    def validate_ean13(self, barcode):
        # EAN-13 should be 13 digits long
        if len(barcode) != 13:
            frappe.throw(_(""EAN-13 barcode must be 13 digits long.""))

        if not barcode.isdigit():
            frappe.throw(_(""EAN-13 barcode must contain only digits.""))

        # Validate the check digit (last digit)
        if not BarcodeHelper.validate_check_digit_ean(barcode):
            frappe.throw(_(""Invalid check digit for EAN-13 barcode.""))

```

"
