id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2732832455,issue,closed,completed,[V16] UI issues across multiple pages,"### Information about bug

Size of a button for selecting Serial Nos. in the POS screen
<img width=""792"" alt=""Screenshot 2024-12-12 at 12 43 19 PM"" src=""https://github.com/user-attachments/assets/8c902b06-a194-487f-9e64-09a9170d3e35"" />



Button size
<img width=""1266"" alt=""Screenshot 2024-12-11 at 5 05 35 PM"" src=""https://github.com/user-attachments/assets/8d8bd554-9128-44cc-893b-9c2760568daf"">

-

Field label very close to data entry block
<img width=""1266"" alt=""Screenshot 2024-12-11 at 5 06 11 PM"" src=""https://github.com/user-attachments/assets/f210f729-f533-413b-aa89-a86ba2ea64fd"">

-

Two primary button. Material Consumption is rarely used feature. Shouldn't get too much weightage. Rather, Job Cards auto-created against Work Order should be highlighted.
<img width=""1264"" alt=""Screenshot 2024-12-11 at 5 15 41 PM"" src=""https://github.com/user-attachments/assets/74ffba72-e5f5-43e7-83ff-fdd3d81ac52c"">

-

Button size is too big?
<img width=""1269"" alt=""Screenshot 2024-12-11 at 5 47 44 PM"" src=""https://github.com/user-attachments/assets/b751624e-34d6-4d0c-9514-261c7441d4bd"">

-

Inconsistency in field alignment, esp. due to check-box field
<img width=""811"" alt=""Screenshot 2024-12-11 at 5 48 31 PM"" src=""https://github.com/user-attachments/assets/e73f0f9b-8eed-43ff-b25a-3b46a741aaad"">

-

Inconsistent column widths. Can we re-look the default columns selected, atleast in the most used transactions of sales and purchase cycle?
<img width=""1072"" alt=""Screenshot 2024-12-11 at 5 49 29 PM"" src=""https://github.com/user-attachments/assets/54f47103-d3c9-42c1-b223-c5b5242ada37"">

-

From Item, navigated to Purchase Order form. Link got updated, but form didn't load. No error message in the console.
<img width=""1076"" alt=""Screenshot 2024-12-11 at 5 54 04 PM"" src=""https://github.com/user-attachments/assets/49bc1763-3266-4520-bad4-ead8d36e28c5"">

-

In subcontracting, if transfer isn't done, then that should be Primary. If transfer is done, then Sub-contracting receipt could be Primary. Or we can simply put both Transfer and Receipt under Create (single primary).
<img width=""1269"" alt=""Screenshot 2024-12-11 at 5 58 19 PM"" src=""https://github.com/user-attachments/assets/f8d8b8cd-fb45-4f9a-9431-cc75e81dbcc6"">



### Module

accounts, stock, buying, selling, manufacturing

### Version

V16

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",umairsy,2024-12-11 12:22:00+00:00,['iamejaaz'],2025-01-28 00:10:23+00:00,2025-01-13 06:21:56+00:00,https://github.com/frappe/erpnext/issues/44659,"[('bug', None), ('v16', '')]","[{'comment_id': 2567631885, 'issue_id': 2732832455, 'author': 'diptanilsaha', 'body': 'fixed button for selecting serial no in pos \r\n\r\n#45048', 'created_at': datetime.datetime(2025, 1, 2, 11, 28, 39, tzinfo=datetime.timezone.utc)}]","diptanilsaha on (2025-01-02 11:28:39 UTC): fixed button for selecting serial no in pos 

#45048

"
2732684456,issue,open,,Payment Schedule rows removed when creating a Credit Note from an Invoice - Missing E-Invoicing data,"### Information about bug

**Issue Description:**

**Version Details:**  
- ERPNext: v15 (Commit: 925eb44)  
- Frappe version: 15.50.0

**Steps to Reproduce:**  
1. Create an invoice with a valid Payment Schedule (child table) configured for e-invoicing.  
2. Generate a Credit Note (Credit Note = Nota di Credito) directly from that invoice.  
3. Observe that upon creating the Credit Note, the Payment Schedule child table rows are removed.

**Expected Behavior:**  
The Payment Schedule rows should remain intact, ensuring that the necessary information for e-invoicing XML generation is available in the Credit Note.

**Actual Behavior:**  
The Payment Schedule entries are deleted from the Credit Note, resulting in the following error when attempting to generate the XML for e-invoicing:  
‚ÄúE-Invoicing Information Missing. Please set the Payment Schedule from the regional module for Italy.‚Äù

**Impact:**  
Without these Payment Schedule rows, the system fails to generate the required e-invoicing XML data, blocking the proper issuance of the Credit Note in compliance with Italian e-invoicing regulations.

**Additional Details:**  
- The issue occurs even when using a clean environment without any customizations.  
- Screenshots and logs can be provided upon request.

Please investigate this issue, as it prevents proper e-invoicing for Credit Notes derived from Invoices.

### Module

accounts, selling

### Version

- ERPNext: v15 (Commit: 925eb44)  
- Frappe version: 15.50.0

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",dinoweb,2024-12-11 11:30:06+00:00,['diptanilsaha'],2025-01-30 07:26:00+00:00,,https://github.com/frappe/erpnext/issues/44658,"[('bug', None)]","[{'comment_id': 2537979945, 'issue_id': 2732684456, 'author': 'ljain112', 'body': 'This is expected behaviour.\r\nFor return invoices payment terms are not supported.', 'created_at': datetime.datetime(2024, 12, 12, 7, 6, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2538347987, 'issue_id': 2732684456, 'author': 'dinoweb', 'body': 'I understand the current behavior, but due to Italian electronic invoicing requirements, the Payment Schedule is still needed for return invoices (credit notes). The official ERPNext regional module for Italy enforces this check and raises an error if payment terms are missing. As a temporary workaround, I‚Äôve implemented a `doc_events` hook on the `validate` action that copies the Payment Schedule and Payment Terms Template from the original invoice back into the credit note:\r\n\r\n```python\r\nimport frappe\r\n\r\ndef get_original_invoice(doc):\r\n    if doc.return_against:\r\n        return frappe.get_doc(""Sales Invoice"", doc.return_against)\r\n    return None\r\n\r\ndef execute(doc, method=None):\r\n    if doc.is_return:\r\n        original_invoice = get_original_invoice(doc)\r\n        if original_invoice and original_invoice.payment_schedule:\r\n            for payment_schedule in original_invoice.payment_schedule:\r\n                # Reset references so that rows can be appended properly\r\n                payment_schedule.name = None\r\n                payment_schedule.parent = None\r\n                doc.append(""payment_schedule"", payment_schedule)\r\n        doc.payment_terms_template = original_invoice.payment_terms_template\r\n```\r\n\r\nThis ensures that the mandatory payment information required for Italian e-invoicing is retained. It‚Äôs not an ideal long-term solution, but it works until an official fix or more appropriate handling is introduced into ERPNext.', 'created_at': datetime.datetime(2024, 12, 12, 9, 28, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2600748838, 'issue_id': 2732684456, 'author': 'diptanilsaha', 'body': '@dinoweb please share screenshots.', 'created_at': datetime.datetime(2025, 1, 19, 8, 5, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607055017, 'issue_id': 2732684456, 'author': 'vorasmit', 'body': ""@dinoweb,\n\nIs Payment Schedule really mandatory for e-Invoice in Italy (especially for sales return)?\n\nWe refer to following XSD and can check that minimum occurrences for tag `DatiPagamento` is zero, meaning it‚Äôs not mandatory\nhttps://www.fatturapa.gov.it/export/documenti/fatturapa/v1.2.1/Schema_del_file_xml_FatturaPA_versione_1.2.xsd\n\nAlso, the implementation here suggests it's optional\nhttps://github.com/frappe/erpnext/blob/develop/erpnext/regional/italy/e-invoice.xml#L217\n\nOnce you confirm this, we‚Äôll better know what fix is needed for this."", 'created_at': datetime.datetime(2025, 1, 22, 11, 58, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607238482, 'issue_id': 2732684456, 'author': 'dinoweb', 'body': ""Thank you for your interest.\r\n\r\nAlthough the documentation seems to suggest that the Payment Schedule is\r\noptional, the interchange system managed by the state has rejected all\r\ncredit notes that did not include it. So yes, in my opinion, it is a\r\nmandatory piece of information.\r\n\r\nThank you for your work!\r\nLorenzo\r\n\r\nOn Wed, Jan 22, 2025 at 12:59\u202fPM Smit Vora ***@***.***> wrote:\r\n\r\n> @dinoweb <https://github.com/dinoweb>,\r\n>\r\n> Is Payment Schedule really mandatory for e-Invoice in Italy (especially\r\n> for sales return)?\r\n>\r\n> We refer to following XSD and can check that minimum occurrences for tag\r\n> DatiPagamento is zero, meaning it‚Äôs not mandatory\r\n>\r\n> https://www.fatturapa.gov.it/export/documenti/fatturapa/v1.2.1/Schema_del_file_xml_FatturaPA_versione_1.2.xsd\r\n>\r\n> Also, the implementation here suggests it's optional\r\n>\r\n> https://github.com/frappe/erpnext/blob/develop/erpnext/regional/italy/e-invoice.xml#L217\r\n>\r\n> Once you confirm this, we‚Äôll better know what fix is needed for this.\r\n>\r\n> ‚Äî\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/frappe/erpnext/issues/44658#issuecomment-2607055017>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AAE75YJPLV6OMFD3IAJGPVD2L6BZNAVCNFSM6AAAAABTNIKXRKVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDMMBXGA2TKMBRG4>\r\n> .\r\n> You are receiving this because you were mentioned.Message ID:\r\n> ***@***.***>\r\n>\r\n\r\n\r\n-- \r\nLorenzo Caldara"", 'created_at': datetime.datetime(2025, 1, 22, 13, 22, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2623733996, 'issue_id': 2732684456, 'author': 'ljain112', 'body': 'As per one of our client, payment schedule is not mandatory for return invoices,\nCan you share any documentation ?', 'created_at': datetime.datetime(2025, 1, 30, 7, 25, 58, tzinfo=datetime.timezone.utc)}]","ljain112 on (2024-12-12 07:06:44 UTC): This is expected behaviour.
For return invoices payment terms are not supported.

dinoweb (Issue Creator) on (2024-12-12 09:28:43 UTC): I understand the current behavior, but due to Italian electronic invoicing requirements, the Payment Schedule is still needed for return invoices (credit notes). The official ERPNext regional module for Italy enforces this check and raises an error if payment terms are missing. As a temporary workaround, I‚Äôve implemented a `doc_events` hook on the `validate` action that copies the Payment Schedule and Payment Terms Template from the original invoice back into the credit note:

```python
import frappe

def get_original_invoice(doc):
    if doc.return_against:
        return frappe.get_doc(""Sales Invoice"", doc.return_against)
    return None

def execute(doc, method=None):
    if doc.is_return:
        original_invoice = get_original_invoice(doc)
        if original_invoice and original_invoice.payment_schedule:
            for payment_schedule in original_invoice.payment_schedule:
                # Reset references so that rows can be appended properly
                payment_schedule.name = None
                payment_schedule.parent = None
                doc.append(""payment_schedule"", payment_schedule)
        doc.payment_terms_template = original_invoice.payment_terms_template
```

This ensures that the mandatory payment information required for Italian e-invoicing is retained. It‚Äôs not an ideal long-term solution, but it works until an official fix or more appropriate handling is introduced into ERPNext.

diptanilsaha (Assginee) on (2025-01-19 08:05:06 UTC): @dinoweb please share screenshots.

vorasmit on (2025-01-22 11:58:54 UTC): @dinoweb,

Is Payment Schedule really mandatory for e-Invoice in Italy (especially for sales return)?

We refer to following XSD and can check that minimum occurrences for tag `DatiPagamento` is zero, meaning it‚Äôs not mandatory
https://www.fatturapa.gov.it/export/documenti/fatturapa/v1.2.1/Schema_del_file_xml_FatturaPA_versione_1.2.xsd

Also, the implementation here suggests it's optional
https://github.com/frappe/erpnext/blob/develop/erpnext/regional/italy/e-invoice.xml#L217

Once you confirm this, we‚Äôll better know what fix is needed for this.

dinoweb (Issue Creator) on (2025-01-22 13:22:12 UTC): Thank you for your interest.

Although the documentation seems to suggest that the Payment Schedule is
optional, the interchange system managed by the state has rejected all
credit notes that did not include it. So yes, in my opinion, it is a
mandatory piece of information.

Thank you for your work!
Lorenzo

On Wed, Jan 22, 2025 at 12:59‚ÄØPM Smit Vora ***@***.***> wrote:



-- 
Lorenzo Caldara

ljain112 on (2025-01-30 07:25:58 UTC): As per one of our client, payment schedule is not mandatory for return invoices,
Can you share any documentation ?

"
2730054730,issue,open,,a bug with ERPNext Website that should be considered with high priority,"### Information about bug

some fields from the website ecommerce/webshop **doesnot get translated at all for all of the languages** i have put them in red rectangle. please fix it
English
![image](https://github.com/user-attachments/assets/3d5c9c4f-7f1b-4caf-980e-c36d2d165ef6)
Urdu
![image](https://github.com/user-attachments/assets/07013891-32f2-41d5-9ad0-4fd7fbbe10b6)
Turkish
![image](https://github.com/user-attachments/assets/23897af9-d050-4e0b-a693-a43df70131e8)
Arabic
![image](https://github.com/user-attachments/assets/c8028c48-e896-4cf1-9d6a-e04613b0477f)







### Module

selling, ecommerce, portal

### Version

erpnext 15.45.4
frappe 15.49.1


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",Rebaz-balisani,2024-12-10 12:57:16+00:00,[],2024-12-10 12:57:16+00:00,,https://github.com/frappe/erpnext/issues/44643,"[('bug', None)]",[],
2729572485,issue,open,,[V16] Taking Too long for saving a doc,"### Information about bug

Update value in any document, like docytpe, single doctype etc. The form is taking lot more time than usual for saving the form. This issue (if valid) , could also belong to Frappe Framework.

![buying-setting](https://github.com/user-attachments/assets/936c4716-3674-437f-a499-f25bac00decc)


### Module

accounts, stock, buying, selling

### Version

Installed Apps
ERPNext: v16.0.0-dev (HEAD)

Framework: v16.0.0-dev (HEAD)

Helpdesk: v1.0.0 (HEAD)

Frappe Insights: v2.2.9 (HEAD)

Twilio Integration: v0.0.1 (HEAD)

[Dependencies & Licenses](https://gadgetsv16.frappe.cloud/attribution)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",umairsy,2024-12-10 09:41:48+00:00,['ruthra-kumar'],2025-01-03 10:13:28+00:00,,https://github.com/frappe/erpnext/issues/44641,"[('bug', None), ('v16', '')]",[],
2729547618,issue,closed,completed,[V16] Error when converting Material Request into PO,"### Information about bug

Just trying creating a Purchase Order against this Material Request. Skip the modal for supplier selection.

Replicate in:

https://gadgetsv16.frappe.cloud/app/material-request/MAT-MR-2024-00009

### Module

buying

### Version

Installed Apps
ERPNext: v16.0.0-dev (HEAD)

Framework: v16.0.0-dev (HEAD)

Helpdesk: v1.0.0 (HEAD)

Frappe Insights: v2.2.9 (HEAD)

Twilio Integration: v0.0.1 (HEAD)

[Dependencies & Licenses](https://gadgetsv16.frappe.cloud/attribution)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Blocked aria-hidden on an element because its descendant retained focus. The focus must not be hidden from assistive technology users. Avoid using aria-hidden on a focused element or its ancestor. Consider using the inert attribute instead, which will also prevent focus. For more details, see the aria-hidden section of the WAI-ARIA specification at https://w3c.github.io/aria/#aria-hidden.
Element with focus: button
Ancestor with aria-hidden:  <div class=‚Äã""modal fade"" style=‚Äã""overflow:‚Äã auto;‚Äã display:‚Äã none;‚Äã"" tabindex=‚Äã""-1"" aria-hidden=‚Äã""true"">‚Äã<div class=‚Äã""modal-dialog"">‚Äã‚Ä¶‚Äã</div>‚Äã</div>‚Äã
```
",umairsy,2024-12-10 09:32:04+00:00,['iamejaaz'],2025-01-24 00:10:05+00:00,2025-01-09 11:11:11+00:00,https://github.com/frappe/erpnext/issues/44638,"[('bug', None), ('v16', '')]","[{'comment_id': 2579870040, 'issue_id': 2729547618, 'author': 'iamejaaz', 'body': 'The issue is fixed in the latest version.', 'created_at': datetime.datetime(2025, 1, 9, 11, 11, 11, tzinfo=datetime.timezone.utc)}]","iamejaaz (Assginee) on (2025-01-09 11:11:11 UTC): The issue is fixed in the latest version.

"
2729452967,issue,closed,completed,[v16] Error when converting Material Request into Purchase Order,"### Information about bug

Steps:

1. Created Material Request
2. Trying to convert a MR into Purchase Order

<img width=""669"" alt=""Screenshot 2024-11-27 at 3 18 04 PM"" src=""https://github.com/user-attachments/assets/1da75d1e-418e-4482-b4be-bc901dd14509"">


### Module

buying

### Version

""erpnext"": ""16.0.0-dev"",
	""frappe"": ""16.0.0-dev"",
	""hrms"": ""16.0.0-dev"",
	""india_compliance"": ""16.0.0-dev"",
	""payments"": ""0.0.1""

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""erpnext"": ""16.0.0-dev"",
	""frappe"": ""16.0.0-dev"",
	""hrms"": ""16.0.0-dev"",
	""india_compliance"": ""16.0.0-dev"",
	""payments"": ""0.0.1""
}
```
### Route
```
Form/Material Request/MAT-MR-2024-00346
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 118, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1812, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 32, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/mapper.py"", line 37, in make_mapped_doc
    return method(source_name)
           ^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 32, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/stock/doctype/material_request/material_request.py"", line 435, in make_purchase_order
    doclist = get_mapped_doc(
              ^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/mapper.py"", line 171, in get_mapped_doc
    postprocess(source_doc, target_doc)
  File ""apps/erpnext/erpnext/stock/doctype/material_request/material_request.py"", line 427, in postprocess
    set_missing_values(source, target_doc)
  File ""apps/erpnext/erpnext/stock/doctype/material_request/material_request.py"", line 375, in set_missing_values
    target_doc.run_method(""set_missing_values"")
  File ""apps/frappe/frappe/model/document.py"", line 1069, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1456, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1434, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1066, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/buying/doctype/purchase_order/purchase_order.py"", line 662, in set_missing_values
    super().set_missing_values(for_validate)
  File ""apps/erpnext/erpnext/controllers/buying_controller.py"", line 149, in set_missing_values
    self.set_missing_item_details(for_validate)
  File ""apps/erpnext/erpnext/controllers/accounts_controller.py"", line 777, in set_missing_item_details
    ret = get_item_details(ctx, self, for_validate=for_validate, overwrite_warehouse=False)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 32, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/__init__.py"", line 189, in wrapper
    return func(ctx, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/stock/get_item_details.py"", line 118, in get_item_details
    out.update(get_price_list_rate(ctx, item))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/stock/get_item_details.py"", line 862, in get_price_list_rate
    insert_item_price(ctx)
  File ""apps/erpnext/erpnext/stock/get_item_details.py"", line 928, in insert_item_price
    item_price.insert()
  File ""apps/frappe/frappe/model/document.py"", line 122, in wrapper
    raise frappe.DatabaseModificationError(error_msg)
frappe.exceptions.DatabaseModificationError: Cannot call insert in read-only document mode (doc-mapper)

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""method"": ""erpnext.stock.doctype.material_request.material_request.make_purchase_order"",
		""source_name"": ""MAT-MR-2024-00346"",
		""args"": ""{}"",
		""selected_children"": ""{}""
	},
	""freeze"": true,
	""freeze_message"": """",
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.model.mapper.make_mapped_doc"",
	""request_id"": ""14497fe3-f2c5-4ec7-8980-eb39ca5ec77a""
}
```
### Response Data
```
{
	""exception"": ""frappe.exceptions.DatabaseModificationError: Cannot call insert in read-only document mode (doc-mapper)"",
	""exc_type"": ""DatabaseModificationError"",
	""_exc_source"": ""erpnext (app)""
}
```
```
",umairsy,2024-12-10 08:59:20+00:00,['iamejaaz'],2025-01-24 00:10:04+00:00,2025-01-09 11:34:32+00:00,https://github.com/frappe/erpnext/issues/44635,"[('bug', None), ('v16', '')]","[{'comment_id': 2536558809, 'issue_id': 2729452967, 'author': 'blaggacao', 'body': ""@ruthra-kumar is this legit that a price item would be _inserted_ into the database even **before** the mapping from one document into another would have been completed? &mdash; it feels very wrong, because we can't actually know without additional assumptions what the caller would do with the target document, at all. Maybe it's not meant for persistence."", 'created_at': datetime.datetime(2024, 12, 11, 17, 0, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2537855618, 'issue_id': 2729452967, 'author': 'ruthra-kumar', 'body': ""If 'Auto Insert Item Price If Missing' is enabled, Yes. You can disable it if not needed.\r\n\r\n> it feels very wrong, because we can't actually know without additional assumptions what the caller would do with the target document, at all. Maybe it's not meant for persistence.\r\n\r\nThis is Quality-of-Life feature added upon users request, wherein system automatically creates a Price record without the need for user to manually create it first. And it is meant for persistence."", 'created_at': datetime.datetime(2024, 12, 12, 5, 34, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2537858092, 'issue_id': 2729452967, 'author': 'ruthra-kumar', 'body': ""@blaggacao \r\n\r\nI'm unclear on `DatabaseModificationError` exception. On which scenario is this thrown? Because based on the issue descripton, it looks like a normal sequence of actions where users are modifying and creating documents and the exception looks out-of-place."", 'created_at': datetime.datetime(2024, 12, 12, 5, 37, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2538151512, 'issue_id': 2729452967, 'author': 'blaggacao', 'body': ""The inner transaction span of what amounts to a type cast from one doctype to another (inside mapper control flow), i.e. the procedure of the type cast itself has been made read only, in order to add some sanity and soundness to the control flow, with the ulterior goal of avoiding intricate bugs due to complex state manipulations.\n\nSee: https://github.com/frappe/frappe/blob/develop/frappe%2Fmodel%2Fmapper.py#L106-L107\n\nNote, that this didn't break any pre-existing automated tests across the ecosystem. I checked."", 'created_at': datetime.datetime(2024, 12, 12, 8, 23, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2538181435, 'issue_id': 2729452967, 'author': 'blaggacao', 'body': '@ruthra-kumar Do you see a sane way to insert these records just after the mapping has finished so that the type cast itself can remain read-only? Maybe even by introducing a flag which holds ""insert-suggestions"" that would then be handled more transparently within the control flow of the caller.\n\nNote, how the mapper only triggers `ret_doc.run_method(""after_mapping"", source_doc)` but never an insert on the target doc, so we can\'t presume actually persistence _within_ the context of the control flow of the mapper. Imo, that\'s a very good thing and all inserts should happen within the scope in which they can be presumed.', 'created_at': datetime.datetime(2024, 12, 12, 8, 30, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2562426992, 'issue_id': 2729452967, 'author': 'yas8say', 'body': 'Revert to [v15.44.0](https://github.com/frappe/erpnext/releases/tag/v15.44.0),\r\n[v15.49.0](https://github.com/frappe/frappe/releases/tag/v15.49.0) & try again', 'created_at': datetime.datetime(2024, 12, 26, 10, 42, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2579928868, 'issue_id': 2729452967, 'author': 'iamejaaz', 'body': 'Closing this issue, it has been fixed.', 'created_at': datetime.datetime(2025, 1, 9, 11, 34, 32, tzinfo=datetime.timezone.utc)}]","blaggacao on (2024-12-11 17:00:14 UTC): @ruthra-kumar is this legit that a price item would be _inserted_ into the database even **before** the mapping from one document into another would have been completed? &mdash; it feels very wrong, because we can't actually know without additional assumptions what the caller would do with the target document, at all. Maybe it's not meant for persistence.

ruthra-kumar on (2024-12-12 05:34:33 UTC): If 'Auto Insert Item Price If Missing' is enabled, Yes. You can disable it if not needed.


This is Quality-of-Life feature added upon users request, wherein system automatically creates a Price record without the need for user to manually create it first. And it is meant for persistence.

ruthra-kumar on (2024-12-12 05:37:04 UTC): @blaggacao 

I'm unclear on `DatabaseModificationError` exception. On which scenario is this thrown? Because based on the issue descripton, it looks like a normal sequence of actions where users are modifying and creating documents and the exception looks out-of-place.

blaggacao on (2024-12-12 08:23:05 UTC): The inner transaction span of what amounts to a type cast from one doctype to another (inside mapper control flow), i.e. the procedure of the type cast itself has been made read only, in order to add some sanity and soundness to the control flow, with the ulterior goal of avoiding intricate bugs due to complex state manipulations.

See: https://github.com/frappe/frappe/blob/develop/frappe%2Fmodel%2Fmapper.py#L106-L107

Note, that this didn't break any pre-existing automated tests across the ecosystem. I checked.

blaggacao on (2024-12-12 08:30:44 UTC): @ruthra-kumar Do you see a sane way to insert these records just after the mapping has finished so that the type cast itself can remain read-only? Maybe even by introducing a flag which holds ""insert-suggestions"" that would then be handled more transparently within the control flow of the caller.

Note, how the mapper only triggers `ret_doc.run_method(""after_mapping"", source_doc)` but never an insert on the target doc, so we can't presume actually persistence _within_ the context of the control flow of the mapper. Imo, that's a very good thing and all inserts should happen within the scope in which they can be presumed.

yas8say on (2024-12-26 10:42:34 UTC): Revert to [v15.44.0](https://github.com/frappe/erpnext/releases/tag/v15.44.0),
[v15.49.0](https://github.com/frappe/frappe/releases/tag/v15.49.0) & try again

iamejaaz (Assginee) on (2025-01-09 11:34:32 UTC): Closing this issue, it has been fixed.

"
2729433382,issue,closed,completed,[V16] Company master not loading,"### Information about bug

When navigate to Company master from a Company link field, then end-up on this screen... Do note the URL as well

<img width=""998"" alt=""Screenshot 2024-12-10 at 2 19 07 PM"" src=""https://github.com/user-attachments/assets/246c48b7-3ebb-4bf8-af31-8b7c576363a9"">

Note that this site was created by restore the V15 site, where ""skip patches error"" etc. was enabled.





### Module

accounts, buying

### Version

Installed Apps
ERPNext: v16.0.0-dev (HEAD)

Framework: v16.0.0-dev (HEAD)

Frappe HR: v16.0.0-dev (HEAD)

India Compliance: v16.0.0-dev (HEAD)

Payments: v0.0.1 (HEAD)

[Dependencies & Licenses](https://spindl16.frappe.cloud/attribution)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
script_manager.js:32 setup(frm) {
        erpnext.company.set_custom_query(frm, [
            ""default_customs_expense_account"",
            { root_type: ""Expense"" },
        ]);
        erpnext.company.set_custom_query(‚Ä¶
d @ script_manager.js:32Understand this errorAI
form.js:1683 Uncaught (in promise) TypeError: Cannot read properties of undefined (reading 'grid')
    at frappe.ui.form.Form.set_query (form.js:1683:27)
    at setup (company__js:538:13)
    at d (script_manager.js:30:12)
    at n (script_manager.js:109:16)
    at script_manager.js:125:5
    at Array.forEach (<anonymous>)
    at frappe.ui.form.ScriptManager.trigger (script_manager.js:122:22)
    at frappe.ui.form.ScriptManager.setup (script_manager.js:247:8)
    at frappe.ui.form.Form.setup (form.js:116:23)
    at frappe.ui.form.Form.refresh (form.js:445:10)
```
",umairsy,2024-12-10 08:50:09+00:00,[],2024-12-25 00:10:20+00:00,2024-12-10 10:03:22+00:00,https://github.com/frappe/erpnext/issues/44634,"[('bug', None)]","[{'comment_id': 2531078543, 'issue_id': 2729433382, 'author': 'nabinhait', 'body': ""It's loading after upgrading the site"", 'created_at': datetime.datetime(2024, 12, 10, 10, 3, 43, tzinfo=datetime.timezone.utc)}]","nabinhait on (2024-12-10 10:03:43 UTC): It's loading after upgrading the site

"
2729354148,issue,open,,Could not find Row #32: Link To: Serial No Warranty Expiry,"### Information about bug

Hello , when trying to edit and remove some modules in https://talis.erpnext.com/app/stock for example (other reports) i get this Could not find Row #32: Link To: Serial No Warranty Expiry  , it also happens on other modules too.

### Module

stock

### Version

using online version of erp next

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
Could not find Row #32: Link To: Serial No Warranty Expiry
```
",webuildtech,2024-12-10 08:15:18+00:00,['diptanilsaha'],2025-01-15 18:50:31+00:00,,https://github.com/frappe/erpnext/issues/44633,"[('bug', None)]","[{'comment_id': 2546344790, 'issue_id': 2729354148, 'author': 'BleronOs', 'body': 'I am facing the same issue and wonder why there is still no patch for it. The community knows that this problem needs to be resolved urgently. Many of us work day and night with the system, driven by passion and dedication to this topic. It is truly incomprehensible why there has been no response or solution so far!', 'created_at': datetime.datetime(2024, 12, 16, 18, 26, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2546349416, 'issue_id': 2729354148, 'author': 'denis-itengineers', 'body': 'I am facing the same issue too, it is the core function which it is not stable and you can not remove it, do a solution for this!', 'created_at': datetime.datetime(2024, 12, 16, 18, 29, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2561191883, 'issue_id': 2729354148, 'author': 'Sarthik1710', 'body': 'Report with name **Serial No Warranty Expiry** does not exist in system. In Stock workspace, I tried to delete **Serial No Warranty Expiry** in **Link Cards** Section, but it gives error. Later I created report with this name and deleted link from stock workspace.\r\n\r\nFYI, @webuildtech \r\n<img width=""911"" alt=""image"" src=""https://github.com/user-attachments/assets/193e22d7-60c4-466b-af94-886a4877aa90"" />', 'created_at': datetime.datetime(2024, 12, 24, 14, 37, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2593703123, 'issue_id': 2729354148, 'author': 'SanadIT', 'body': 'solution is:\ncreate new report with name **Serial No Warranty Expiry**', 'created_at': datetime.datetime(2025, 1, 15, 18, 50, 29, tzinfo=datetime.timezone.utc)}]","BleronOs on (2024-12-16 18:26:58 UTC): I am facing the same issue and wonder why there is still no patch for it. The community knows that this problem needs to be resolved urgently. Many of us work day and night with the system, driven by passion and dedication to this topic. It is truly incomprehensible why there has been no response or solution so far!

denis-itengineers on (2024-12-16 18:29:24 UTC): I am facing the same issue too, it is the core function which it is not stable and you can not remove it, do a solution for this!

Sarthik1710 on (2024-12-24 14:37:03 UTC): Report with name **Serial No Warranty Expiry** does not exist in system. In Stock workspace, I tried to delete **Serial No Warranty Expiry** in **Link Cards** Section, but it gives error. Later I created report with this name and deleted link from stock workspace.

FYI, @webuildtech 
<img width=""911"" alt=""image"" src=""https://github.com/user-attachments/assets/193e22d7-60c4-466b-af94-886a4877aa90"" />

SanadIT on (2025-01-15 18:50:29 UTC): solution is:
create new report with name **Serial No Warranty Expiry**

"
2729091671,issue,closed,completed,Loyalty Program,"### Information about bug

The loyalty program is set and the customer loyalty point roles set, but after the customer makes the payment, the loyalty point doesn't appear.

### Module

other

### Version

ERPNext version 13.55.2

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",Zhzzz123,2024-12-10 05:51:33+00:00,['diptanilsaha'],2025-01-29 00:10:08+00:00,2025-01-14 07:24:10+00:00,https://github.com/frappe/erpnext/issues/44628,"[('to-validate', 'Old issues pending validation')]","[{'comment_id': 2589199411, 'issue_id': 2729091671, 'author': 'diptanilsaha', 'body': 'Currently, we only support version 14 and version 15.', 'created_at': datetime.datetime(2025, 1, 14, 7, 24, 10, tzinfo=datetime.timezone.utc)}]","diptanilsaha (Assginee) on (2025-01-14 07:24:10 UTC): Currently, we only support version 14 and version 15.

"
2729019052,issue,closed,completed,Homepage Issue,solved,MyWork-Dev,2024-12-10 05:06:26+00:00,[],2024-12-25 00:10:19+00:00,2024-12-10 12:16:06+00:00,https://github.com/frappe/erpnext/issues/44627,"[('bug', None)]",[],
2728972298,issue,closed,completed,"Work Order - Finishing Getting error ( Stock Entry ) Invalid ""depends_on"" expression","### Information about bug

Not able to finish the work order after updating the latest version

### Module

stock, manufacturing, regional

### Version

![Screenshot 2024-12-10 at 9 58 59‚ÄØAM](https://github.com/user-attachments/assets/e8a48a3b-c75c-4632-ab33-7cc9aadcd7d5)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Ancestor with aria-hidden:  <div class=‚Äã""modal fade"" style=‚Äã""overflow:‚Äã auto;‚Äã z-index:‚Äã 2000;‚Äã display:‚Äã none;‚Äã"" tabindex=‚Äã""-1"" aria-hidden=‚Äã""true"">‚Äã‚Ä¶‚Äã</div>‚ÄãUnderstand this errorAI
utils.js:1086 let out =  india_compliance.is_e_waybill_applicable_for_subcontracting(doc); return out
eval @ utils.js:1086Understand this errorAI
messages.js:26 Uncaught (in promise) Error: Invalid ""depends_on"" expression
    at frappe.throw (messages.js:26:8)
    at frappe.ui.form.Layout.evaluate_depends_on_value (layout.js:785:12)
    at frappe.ui.form.Layout.refresh_dependency (layout.js:698:33)
    at frappe.ui.form.Layout.refresh (layout.js:349:8)
    at p.refresh_fields (form.js:667:15)
    at form.js:611:16
```
",dineshpanchal93,2024-12-10 04:30:03+00:00,[],2024-12-25 00:10:23+00:00,2024-12-10 06:21:06+00:00,https://github.com/frappe/erpnext/issues/44624,"[('bug', None)]","[{'comment_id': 2530399626, 'issue_id': 2728972298, 'author': 'dineshpanchal93', 'body': '@rohitwaghchaure Can you please look into the issue as work is being stopped', 'created_at': datetime.datetime(2024, 12, 10, 5, 1, 12, tzinfo=datetime.timezone.utc)}]","dineshpanchal93 (Issue Creator) on (2024-12-10 05:01:12 UTC): @rohitwaghchaure Can you please look into the issue as work is being stopped

"
2728835075,issue,closed,completed,Server Script it't not working simple logs shows that the script is being triggered but my code not working,"### Information about bug

**on this script i can see the trigger on errors log**
üëáüèº
```
frappe.log_error(title=""Server Script Trigger Test"", message=f""Server script has been triggered for the document: {doc.name}"")
frappe.throw(""Server script triggered successfully."")

```
**but on this neither script is being excuted or something added to errors log**

üëáüèº

This sis the code i'm adding to server script 

```
def create_project_for_customer(doc, method):
    # Log script execution start
    frappe.log_error(title=""Debug"", message=""Server Script Triggered for Customer Creation"")

    # Construct the project name
    project_name = f""Project - {doc.customer_name}""
    frappe.log_error(title=""Debug"", message=f""Generated Project Name: {project_name}"")

    # Check if a project with this name already exists
    if frappe.db.exists(""Project"", {""project_name"": project_name}):
        frappe.log_error(title=""Debug"", message=f""Project '{project_name}' already exists."")
        return  # Exit if the project already exists

    # Attempt to create a new project
    try:
        project = frappe.get_doc({
            ""doctype"": ""Project"",
            ""project_name"": project_name,
            ""customer"": doc.name,  # Link the project to the customer
            ""status"": ""Open""  # Default status for a new project
        })
        project.insert()
        frappe.db.commit()
        frappe.log_error(title=""Debug"", message=f""Project '{project_name}' created successfully."")
    except Exception as e:
        frappe.log_error(title=""Server Script Error"", message=f""Failed to create project: {str(e)}"")
        frappe.throw(f""An error occurred while creating the project: {str(e)}"")

```

### Module

CRM, other

### Version

ERPNext: v15.45.4 (version-15)

Frappe Framework: v15.49.1 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",yahyaoudra,2024-12-10 03:05:00+00:00,[],2025-01-28 00:10:11+00:00,2025-01-13 10:20:39+00:00,https://github.com/frappe/erpnext/issues/44623,"[('bug', None)]","[{'comment_id': 2586711059, 'issue_id': 2728835075, 'author': 'nabinhait', 'body': 'Please post the query on discuss.frappe.io, the GitHub issues are only for reporting bugs or creating feature requests.', 'created_at': datetime.datetime(2025, 1, 13, 10, 20, 39, tzinfo=datetime.timezone.utc)}]","nabinhait on (2025-01-13 10:20:39 UTC): Please post the query on discuss.frappe.io, the GitHub issues are only for reporting bugs or creating feature requests.

"
2726689564,issue,open,,important Work Order & BOM,"### Information about bug

When you Alternative Item in a Work Order or delete an item and finish the work order, go to Stock Entry

Items in BOM are returned, not items worked on in the work order.

### Module

manufacturing

### Version

ERPNext: v15.45.4 (version-15)

Frappe Framework: v15.49.1 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",tajff,2024-12-09 10:55:10+00:00,[],2025-01-13 10:22:56+00:00,,https://github.com/frappe/erpnext/issues/44615,"[('to-validate', 'Old issues pending validation'), ('need-more-info', 'Provide additional context, steps to reproduce this issue.')]","[{'comment_id': 2586714868, 'issue_id': 2726689564, 'author': 'nabinhait', 'body': 'Did not understand the issue. Please explain in detail preferably with a few screenshots.', 'created_at': datetime.datetime(2025, 1, 13, 10, 22, 27, tzinfo=datetime.timezone.utc)}]","nabinhait on (2025-01-13 10:22:27 UTC): Did not understand the issue. Please explain in detail preferably with a few screenshots.

"
2724862119,issue,open,,Recording User Actions and Generating Macros for Automation,"**Is your feature request related to a problem? Please describe.**

ERPNext lacks a built-in feature for recording user actions in the system and converting these actions into reusable macros or scripts. Such functionality could significantly enhance user productivity by automating repetitive tasks and simplifying complex workflows. Similar capabilities exist in enterprise-grade systems like SAP (e.g., SAP GUI Scripting, Transaction Recorder (SHDB)), and implementing this in ERPNext would provide users with advanced tools for process automation.

**Describe the solution you'd like**
Develop a User Action Recorder module in ERPNext that:
	1.	Records User Actions:
	        ‚Ä¢	Tracks and logs user interactions within the system, such as form submissions, button clicks, field updates, and navigation.
	        ‚Ä¢	Captures these actions in a structured, exportable format.
	2.	Generates Reusable Macros or Scripts:
	        ‚Ä¢	Transforms recorded actions into a script (e.g., Python or JavaScript), compatible with ERPNext‚Äôs API and automation tools.
	        ‚Ä¢	Allows users to save and edit the scripts for customization.
	3.	Supports Execution and Automation:
	        ‚Ä¢	Enables replaying recorded macros for automating repetitive tasks.
	        ‚Ä¢	Integrates with existing Server Scripts and Custom Scripts in ERPNext for extending functionality.
	4.	User Interface:
	        ‚Ä¢	Provides a simple UI to start/stop recording, view recorded actions, and export/import scripts.
	        ‚Ä¢	Offers integration with ERPNext‚Äôs workflow automation.

Key Features:
	‚Ä¢	Recording Options:
	‚Ä¢	Record specific actions (e.g., only data input or navigation).
	‚Ä¢	Include or exclude certain modules/forms based on user preferences.
	‚Ä¢	Script Generation:
	‚Ä¢	Convert recordings into REST API calls for bulk data operations.
	‚Ä¢	Generate Custom Script templates for form events.
	‚Ä¢	Playback and Testing:
	‚Ä¢	Replay macros within the system for testing.
	‚Ä¢	Schedule automated execution of macros via background jobs.
	‚Ä¢	Integration:
	‚Ä¢	Works seamlessly with existing ERPNext tools like workflows, server scripts, and REST API.

Benefits:
	1.	Increased Productivity:
	        ‚Ä¢	Reduces manual effort for repetitive tasks.
	        ‚Ä¢	Speeds up workflow implementation for business processes.
	2.	Improved Developer Experience:
	        ‚Ä¢	Provides developers with a starting point for more complex automations.
	        ‚Ä¢	Simplifies customization for non-technical users.
	3.	Enhanced Usability:
	        ‚Ä¢	Makes ERPNext more user-friendly for companies transitioning from enterprise-grade systems like SAP.


**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**Additional context**
Add any other context or screenshots about the feature request here.
",aidemkin,2024-12-07 23:55:24+00:00,[],2025-01-10 15:01:34+00:00,,https://github.com/frappe/erpnext/issues/44596,"[('feature-request', None)]","[{'comment_id': 2582906811, 'issue_id': 2724862119, 'author': 'casesolved-co-uk', 'body': ""There already is a Recorder for web requests:\r\n/app/recorder\r\nIt could fairly easily be extended for document-level calls.\r\nBut no, it doesn't save it in reproducible 'script'.\r\n\r\nIt would be tricky to implement as a UI recorder but then I don't see the benefit of this either, the UI is just calling server-side APIs which are easily reproducible. So I could only see it becoming a server-side script.\r\n\r\nIt would also be useful if you described the intended use-case - what scenario made you request this?\r\nThere are already some automation tools that probably do some of what you need."", 'created_at': datetime.datetime(2025, 1, 10, 15, 1, 32, tzinfo=datetime.timezone.utc)}]","casesolved-co-uk on (2025-01-10 15:01:32 UTC): There already is a Recorder for web requests:
/app/recorder
It could fairly easily be extended for document-level calls.
But no, it doesn't save it in reproducible 'script'.

It would be tricky to implement as a UI recorder but then I don't see the benefit of this either, the UI is just calling server-side APIs which are easily reproducible. So I could only see it becoming a server-side script.

It would also be useful if you described the intended use-case - what scenario made you request this?
There are already some automation tools that probably do some of what you need.

"
2724576109,issue,open,,Upgrade to v15.42.2 onwards fails in site migration step : Executing erpnext.patches.v15_0.create_asset_depreciation_schedules_from_assets,"### Information about bug

Information about bug
When upgrading to v15.42.2 or any version after that - site migration fails at step : Executing erpnext.patches.v15_0.create_asset_depreciation_schedules_from_assets
```

Error stack

  File ""/home/frappe/frappe-bench/apps/frappe/frappe/database/database.py"", line 207, in sql
    self.check_transaction_status(query)
  File ""/home/frappe/frappe-bench/apps/frappe/frappe/database/database.py"", line 429, in check_transaction_status
    raise frappe.TooManyWritesError(msg)
frappe.exceptions.TooManyWritesError: <br><br>Too many changes to database in single action.<br>The changes have been reverted.<br>
```

### Module

other

### Version

erpnext 15.45.2
frappe 15.49.1

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",itsyosefali,2024-12-07 12:39:27+00:00,['khushi8112'],2025-01-13 09:25:05+00:00,,https://github.com/frappe/erpnext/issues/44595,"[('bug', None)]","[{'comment_id': 2525100785, 'issue_id': 2724576109, 'author': 'itsyosefali', 'body': 'i\'ve solved this issue by adding frappe.db.commit() after every loop\r\n\r\n```\r\nfor asset in assets:\r\n\t\tif not asset_depreciation_schedules_map.get(asset.name):\r\n\t\t\tcontinue\r\n\r\n\t\tdepreciation_schedules = asset_depreciation_schedules_map[asset.name]\r\n\r\n\t\tfor fb_row in asset_finance_books_map[asset.name]:\r\n\t\t\tasset_depr_schedule_doc = frappe.new_doc(""Asset Depreciation Schedule"")\r\n\r\n\t\t\tasset_depr_schedule_doc.set_draft_asset_depr_schedule_details(asset, fb_row)\r\n\r\n\t\t\tasset_depr_schedule_doc.insert()\r\n\r\n\t\t\tif asset.docstatus == 1:\r\n\t\t\t\tasset_depr_schedule_doc.submit()\r\n\r\n\t\t\tdepreciation_schedules_of_fb_row = [\r\n\t\t\t\tds for ds in depreciation_schedules if ds[""finance_book_id""] == str(fb_row.idx)\r\n\t\t\t]\r\n\r\n\t\t\tupdate_depreciation_schedules(depreciation_schedules_of_fb_row, asset_depr_schedule_doc.name)\r\n\r\n\t\tfrappe.db.commit()\r\n```', 'created_at': datetime.datetime(2024, 12, 7, 12, 40, 13, tzinfo=datetime.timezone.utc)}]","itsyosefali (Issue Creator) on (2024-12-07 12:40:13 UTC): i've solved this issue by adding frappe.db.commit() after every loop

```
for asset in assets:
		if not asset_depreciation_schedules_map.get(asset.name):
			continue

		depreciation_schedules = asset_depreciation_schedules_map[asset.name]

		for fb_row in asset_finance_books_map[asset.name]:
			asset_depr_schedule_doc = frappe.new_doc(""Asset Depreciation Schedule"")

			asset_depr_schedule_doc.set_draft_asset_depr_schedule_details(asset, fb_row)

			asset_depr_schedule_doc.insert()

			if asset.docstatus == 1:
				asset_depr_schedule_doc.submit()

			depreciation_schedules_of_fb_row = [
				ds for ds in depreciation_schedules if ds[""finance_book_id""] == str(fb_row.idx)
			]

			update_depreciation_schedules(depreciation_schedules_of_fb_row, asset_depr_schedule_doc.name)

		frappe.db.commit()
```

"
2724311026,issue,closed,completed,asset_maintenance_log file missing?,"### Information about bug

While running `bench migrate`, I saw this warning statement:
![image](https://github.com/user-attachments/assets/84085a9b-2bd0-41c6-a17a-442f4e5a8e16)

Clearly, it shows that the given function `update_asset_maintenance_log_status` is referenced somewhere in erpnext but is not implemented in the app, and the file containing it seems to be missing.



### Module

other

### Version

ERPNext version: v15.29.0
Frappe Framework: v15.32.0

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",sambhxv,2024-12-07 03:45:19+00:00,[],2024-12-25 00:10:21+00:00,2024-12-10 09:03:08+00:00,https://github.com/frappe/erpnext/issues/44588,"[('bug', None)]","[{'comment_id': 2525914748, 'issue_id': 2724311026, 'author': 'malikrohail', 'body': 'can i fix', 'created_at': datetime.datetime(2024, 12, 8, 13, 37, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2530872729, 'issue_id': 2724311026, 'author': 'khushi8112', 'body': 'Hey, @sambhxv @malikrohail already fixed via - https://github.com/frappe/erpnext/pull/42157', 'created_at': datetime.datetime(2024, 12, 10, 9, 1, 43, tzinfo=datetime.timezone.utc)}]","malikrohail on (2024-12-08 13:37:10 UTC): can i fix

khushi8112 on (2024-12-10 09:01:43 UTC): Hey, @sambhxv @malikrohail already fixed via - https://github.com/frappe/erpnext/pull/42157

"
2723997411,issue,open,,Streamlining Shipment Cost Allocation in ERPNext: Addressing Operational Inefficiencies and Control Challenges (landed cost voucher),"Workflow for Handling Freight Expenses and Customs Duty in ERP, as Explained by Umair Sayed
Key Methodology:
‚Ä¢	When adding freight expenses or custom duty, ensure it is applied to valuation only. This ensures the additional expense is added to the item‚Äôs valuation without creating a liability against the foreign supplier.
‚Ä¢	For additional expenses added through a Landed Cost Voucher (LCV):
o	The system automatically debits the Stock-in-Hand account and credits the Expense Included in Valuation account.
o	The credited account is located under the Direct Expense > Cost of Goods Sold (CoGS) group.
Example Accounting Entries:
1.	Valuation Adjustment for Freight/Customs:
Debit  Stock-in-Hand                        $1,000
Credit Expense Included in Valuation        $1,000
2.	At the Point of Item Delivery or Consumption:
Debit  Cost of Goods Sold (CoGS)            $1,000
Credit Stock-in-Hand                        $1,000
Impact:
This process ensures that:
‚Ä¢	Freight/custom duty expenses directly contribute to the item's valuation.
‚Ä¢	CoGS reflects the true purchase value of items without manual reconciliation.
‚Ä¢	A separate purchase invoice can be created for freight/custom expenses to record liability in the appropriate expense accounts.
________________________________________
Identified Cons of This Approach:
While the methodology ensures accounting accuracy, it introduces several operational and control challenges:
1.	Excessive Steps and Time Wastage:
o	The process requires multiple steps, which can be streamlined if such details were stored in a master table at the database level rather than being manipulated in individual transactions.
2.	Risk of User Manipulation:
o	Allowing users to modify tax fields at the purchase invoice level introduces risks:
ÔÇß	Errors due to manual entry.
ÔÇß	Fraud from intentional manipulation of tax or customs rates.
o	Tax regulations should ideally be fixed and immutable at the system level.
3.	Inadequate Control Over Customs Rates:
o	Users can set custom rates arbitrarily, even if these rates are not confirmed by the supply chain department. This undermines control and accuracy.
4.	Contradiction with Strategic Policies:
o	General policy controls, such as customs and tax rates, are delegated to individual users. This contradicts the strategic intent of centralized control and standardized practices.
5.	Limitations in Handling Item-Specific Rates:
o	Different items on the same purchase invoice cannot have distinct customs or duties rates since the process applies adjustments at the invoice level rather than the item level. This makes it impossible to accurately handle diverse rates for multiple items.
6.	Liability Tracking Challenges:
o	While valuation adjustment entries handle stock and expense accounts, there is no clear mechanism to reflect liabilities (e.g., to DHL or a freight forwarder) in the supplier account without creating a separate purchase invoice.

The way other efficient ERPs handles this workflow:

Workflow and Settings for Handling Foreign Purchases with Shipment Expenses in ERPs as per Nexgen Business solutions
Scenario:

Managing foreign purchases with shipment expenses, including costs from customs and freight forwarders (e.g., DHL).
________________________________________
Accounting Entries
1. Shipment Expenses Entry:
Prerequisites:
‚Ä¢	Types of Shipment Expense Valuation:
o	At the account level, define valuation methods for shipment expenses (e.g., by value, weight, or volume) if the account is related to shipment costs.
‚Ä¢	Stock Master and Item Screen:
o	Ensure the duties and customs percentage is fixed in the item screen. This percentage serves as a reference for each transaction. It cannot be manipulated without proper access permissions.
‚Ä¢	Landed Cost Voucher or Journal Entry:
o	A field to link the shipment code must exist.
‚Ä¢	Purchase Receipt/Invoice Screen:
o	A field to link the shipment code must exist.
‚Ä¢	Cost Calculation:
o	The system aggregates all expenses associated with the same shipment code and adds them to the Stock-in-Hand account value.
Accounting Entry:
Debit  Shipment Expenses Account      $1,000
Credit Supplier Account DHL              $1,000________________________________________
2. Cost Calculation for Purchase Receipt/Invoice (if Shipment Expenses are Involved):
Accounting Entry:
Credit Shipment Expenses (or any Expense Counter Account)   $1,000
Debit  Inventory-in-Hand                                      $1,000________________________________________
3.At the Point of Item Delivery or Consumption:
Debit  Cost of Goods Sold (CoGS)            $1,000
Credit Stock-in-Hand                        $1,000
Process Summary:
1.	Record shipment expenses using the shipment code.
2.	Use the Landed Cost Voucher or appropriate journal entry to link and allocate shipment expenses.
3.	Calculate the cost for purchase receipts/invoices by:
o	Consolidating shipment expenses using the shipment code.
o	Adjusting the inventory value based on the calculated landed cost.
________________________________________
This structure ensures clarity, compliance with accounting standards, and proper cost allocation in the ERP system. Let me know if you need further refinements!

Proposed Feature Development:

1.	Centralized Rate Management:
o	Introduce a master table for customs and freight rates, linked to item and supplier records. This ensures consistency, reduces manual intervention, and improves data integrity.
2.	Fixed Tax and Customs Fields:
o	Lock tax and customs rates at the master level, allowing only authorized personnel to update them as per regulatory changes. This reduces fraud risk and ensures compliance.
3.	Support for Item-Level Rate Allocation:
o	Enable landed cost allocation at the item level to handle diverse rates for multiple items in a single purchase transaction.
4.	Automated Liability Tracking:
o	Enhance the system to automatically generate liability entries for freight forwarders or customs agents when landed costs are processed, eliminating the need for separate manual invoices.
5.	Simplified Workflow:
o	Consolidate steps in the landed cost workflow to reduce complexity and enhance efficiency.
________________________________________
Impact of Feature Development
‚Ä¢	Efficiency: Streamlining the process will save time and reduce workload for users.
‚Ä¢	Accuracy: Centralizing rates and automating liability tracking will minimize errors.
‚Ä¢	Compliance: Locking critical fields ensures adherence to tax and customs regulations.
‚Ä¢	Flexibility: Item-level rate allocation enables more accurate cost management for diverse products.


",melhembitar,2024-12-06 21:58:39+00:00,[],2024-12-11 23:39:19+00:00,,https://github.com/frappe/erpnext/issues/44587,"[('feature-request', None)]","[{'comment_id': 2533595076, 'issue_id': 2723997411, 'author': 'JeansReal', 'body': '+1', 'created_at': datetime.datetime(2024, 12, 11, 4, 18, 48, tzinfo=datetime.timezone.utc)}]","JeansReal on (2024-12-11 04:18:48 UTC): +1

"
2722630879,issue,closed,completed,TDS Calculation issue,"### Information about bug

TDS is wrongly calculated in purchase invoice.

### Module

accounts

### Version

version 14

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",neuralaccounts,2024-12-06 10:21:49+00:00,['ljain112'],2025-01-29 10:05:52+00:00,2025-01-29 10:05:52+00:00,https://github.com/frappe/erpnext/issues/44576,"[('bug', None)]","[{'comment_id': 2525056137, 'issue_id': 2722630879, 'author': 'neuralaccounts', 'body': 'Tax Withholding tax (TDS) is calculated at wrong values, Please advise\r\n\r\n![image](https://github.com/user-attachments/assets/c1f57724-55b2-452b-9598-520de9cfb110)]\r\n\r\n\r\n![image](https://github.com/user-attachments/assets/82f708f2-0697-4228-bc23-b4ac71d5c8fc)', 'created_at': datetime.datetime(2024, 12, 7, 9, 58, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2537983726, 'issue_id': 2722630879, 'author': 'ljain112', 'body': 'Check the Tax withheld Vouchers Section for the amount on which TDS is deducted.\r\n![image](https://github.com/user-attachments/assets/4583e723-f37b-4cf6-9fd9-23e8d11e420e)', 'created_at': datetime.datetime(2024, 12, 12, 7, 9, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2579428258, 'issue_id': 2722630879, 'author': 'nisarg5900', 'body': ""I've encountered a similar issue where TDS for certain suppliers is calculated incorrectly. However, if I switch the supplier while keeping everything else unchanged, the TDS is calculated correctly. \r\n\r\nI have checked and verified everything, from Item Tax Details, to supplier Tax Settings, to Tax Withholding Category."", 'created_at': datetime.datetime(2025, 1, 9, 8, 26, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2579696750, 'issue_id': 2722630879, 'author': 'mihir-kandoi', 'body': '@neuralaccounts please explain in detail the intended behaviour.\r\n\r\nIf I am understanding the issue correctly, TDS amount should be 3000 instead of 2000 in the screenshot you provided. Correct?', 'created_at': datetime.datetime(2025, 1, 9, 10, 14, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582652914, 'issue_id': 2722630879, 'author': 'nisarg5900', 'body': 'Please find my detailed bug report posted on india-compliance\r\n\r\nhttps://github.com/resilient-tech/india-compliance/issues/2942#issue-2777335957', 'created_at': datetime.datetime(2025, 1, 10, 12, 57, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582694670, 'issue_id': 2722630879, 'author': 'ljain112', 'body': 'As per your video, There can be other documents where TDS has not been deducted like purchase invoices, and unallocated payment entries so they are also considered while calculating TDS.\r\nIf you want to see pending documents you can create a Purchase Invoice with the same amount and check the Tax Withheld Vouchers Table.\r\n\r\n![image](https://github.com/user-attachments/assets/dbff2015-e3d5-49a7-86b7-0caf2bec48d7)', 'created_at': datetime.datetime(2025, 1, 10, 13, 17, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2583405964, 'issue_id': 2722630879, 'author': 'nisarg5900', 'body': '@ljain112 I verified, and you are correct, that the system is calculating cumulative TDS based on unallocated payments. And to verify the same I tried to create a new Purchase Invoice, hoping that this Tax Withheld Vouchers Table will be populated with the list of vouchers which are used to calculate the TDS, but as you can see in the below video, the entire Tax Withheld Vouchers Table is missing from my Purchase Invoice Entry.\r\n\r\nAnd I believe TDS Deduction should be based strictly based on the voucher itself. For example, if an unallocated payment entry (advance payment) is made, TDS for the same is to be deducted in the payment entry itself, instead of it being deducted in Purchase Invoice or Purchase Order. \r\n\r\nAnd in-case if there is an adjustment voucher to be created it can always be done by passing a Journal Entry.\r\n\r\nhttps://github.com/user-attachments/assets/e138a5b0-2d2c-4a7d-b475-e8b6274158e3', 'created_at': datetime.datetime(2025, 1, 10, 18, 1, 51, tzinfo=datetime.timezone.utc)}]","neuralaccounts (Issue Creator) on (2024-12-07 09:58:54 UTC): Tax Withholding tax (TDS) is calculated at wrong values, Please advise

![image](https://github.com/user-attachments/assets/c1f57724-55b2-452b-9598-520de9cfb110)]


![image](https://github.com/user-attachments/assets/82f708f2-0697-4228-bc23-b4ac71d5c8fc)

ljain112 (Assginee) on (2024-12-12 07:09:26 UTC): Check the Tax withheld Vouchers Section for the amount on which TDS is deducted.
![image](https://github.com/user-attachments/assets/4583e723-f37b-4cf6-9fd9-23e8d11e420e)

nisarg5900 on (2025-01-09 08:26:40 UTC): I've encountered a similar issue where TDS for certain suppliers is calculated incorrectly. However, if I switch the supplier while keeping everything else unchanged, the TDS is calculated correctly. 

I have checked and verified everything, from Item Tax Details, to supplier Tax Settings, to Tax Withholding Category.

mihir-kandoi on (2025-01-09 10:14:58 UTC): @neuralaccounts please explain in detail the intended behaviour.

If I am understanding the issue correctly, TDS amount should be 3000 instead of 2000 in the screenshot you provided. Correct?

nisarg5900 on (2025-01-10 12:57:40 UTC): Please find my detailed bug report posted on india-compliance

https://github.com/resilient-tech/india-compliance/issues/2942#issue-2777335957

ljain112 (Assginee) on (2025-01-10 13:17:05 UTC): As per your video, There can be other documents where TDS has not been deducted like purchase invoices, and unallocated payment entries so they are also considered while calculating TDS.
If you want to see pending documents you can create a Purchase Invoice with the same amount and check the Tax Withheld Vouchers Table.

![image](https://github.com/user-attachments/assets/dbff2015-e3d5-49a7-86b7-0caf2bec48d7)

nisarg5900 on (2025-01-10 18:01:51 UTC): @ljain112 I verified, and you are correct, that the system is calculating cumulative TDS based on unallocated payments. And to verify the same I tried to create a new Purchase Invoice, hoping that this Tax Withheld Vouchers Table will be populated with the list of vouchers which are used to calculate the TDS, but as you can see in the below video, the entire Tax Withheld Vouchers Table is missing from my Purchase Invoice Entry.

And I believe TDS Deduction should be based strictly based on the voucher itself. For example, if an unallocated payment entry (advance payment) is made, TDS for the same is to be deducted in the payment entry itself, instead of it being deducted in Purchase Invoice or Purchase Order. 

And in-case if there is an adjustment voucher to be created it can always be done by passing a Journal Entry.

https://github.com/user-attachments/assets/e138a5b0-2d2c-4a7d-b475-e8b6274158e3

"
2720391248,issue,open,,Free Item needs to be added in seperate row,"### Information about bug

**Issue:** 
When the item is updated in two separate rows to update the batch, the free item is added in a single row, so unable to select multiple batch for the free item

**Expected Behaviour:** 
Every set of free items needs to be added in a separate row

**Promotional Scheme:**
![Screenshot from 2024-12-04 00-45-59](https://github.com/user-attachments/assets/360928f9-3e71-4645-8adc-59aefe601f6a)

![Screenshot 2024-12-04_00-45-41](https://github.com/user-attachments/assets/3f4db203-c656-42da-b3d8-1e1a887c3baf)


### Module

selling

### Version

Frappe: version-15
Erpnext: version-15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",venkat102,2024-12-05 13:15:36+00:00,[],2024-12-05 13:15:36+00:00,,https://github.com/frappe/erpnext/issues/44555,"[('bug', None)]",[],
2719601298,issue,closed,completed,ŸêPurchase order analysis report bug,"### Information about bug

Hello,
In subject report - Purchase Order Analysis, when you receive the same item in more than one line, the report will only read the first line of the Purchase receipt and ignores other lines' quantities (usually this is applies when receiving batched items).  (same case in Sales Order analysis)

### Module

buying

### Version

Frappe Framework: v15.48.1 (HEAD)
ERPNext: v15.44.0 (HEAD)
<img width=""763"" alt=""image"" src=""https://github.com/user-attachments/assets/40d563b8-9182-4d16-a040-69210acc9727"">
<img width=""784"" alt=""image"" src=""https://github.com/user-attachments/assets/08ba745a-11fe-4924-bf07-9b1f85a8da9f"">
<img width=""722"" alt=""image"" src=""https://github.com/user-attachments/assets/dfbf1b23-6578-4a32-ae91-eff401c9bbd7"">



### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",NEW-MTC-ERP1,2024-12-05 07:30:50+00:00,[],2024-12-22 00:11:24+00:00,2024-12-05 10:40:32+00:00,https://github.com/frappe/erpnext/issues/44536,"[('bug', None)]","[{'comment_id': 2519936216, 'issue_id': 2719601298, 'author': 'rohitwaghchaure', 'body': ""@NEW-MTC-ERP1 Checked on local system and it's working. It seems that the second row has no reference of PO Line item.\r\nTo fix the issue, use the duplicate button while splitting the row in the purchase receipt instead of manually adding new rows"", 'created_at': datetime.datetime(2024, 12, 5, 10, 40, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2519940983, 'issue_id': 2719601298, 'author': 'NEW-MTC-ERP1', 'body': 'Great Job, many thanks, I missed this one.', 'created_at': datetime.datetime(2024, 12, 5, 10, 42, 40, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure on (2024-12-05 10:40:33 UTC): @NEW-MTC-ERP1 Checked on local system and it's working. It seems that the second row has no reference of PO Line item.
To fix the issue, use the duplicate button while splitting the row in the purchase receipt instead of manually adding new rows

NEW-MTC-ERP1 (Issue Creator) on (2024-12-05 10:42:40 UTC): Great Job, many thanks, I missed this one.

"
2719278993,issue,closed,completed,POS : AttributeError in POS Invoice During Get Advances Received Method Call,"### Information about bug

An error occurs when attempting to call the **Get Advances Received** method on a **POS Invoice** document. The method references an attribute supplier, which does not exist for the POS Invoice doctype, causing an AttributeError.

### Module

buying

### Version

Erpnext - ""15.42.0""
Frappe - ""15.47.2""

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  ...
  File ""apps/erpnext/erpnext/controllers/accounts_controller.py"", line 1226, in get_advance_entries
    party = self.supplier
AttributeError: 'POSInvoice' object has no attribute 'supplier'
```
",krishpatel-sanskartechnolab,2024-12-05 04:22:58+00:00,['diptanilsaha'],2025-01-10 00:10:39+00:00,2024-12-26 11:04:06+00:00,https://github.com/frappe/erpnext/issues/44518,"[('bug', None), ('POS', None)]",[],
2718667499,issue,closed,completed,Debit and Credit Mismatch in Payment Entry (ERPNext V14),"### Information about bug

Summary: 
Submitting a Payment Entry where an employee is the party results in a debit-credit mismatch in the General Ledger. The GL posting logic doubles the posted amount, causing an imbalance error.

Affected Versions: ERPNext V14 (confirmed); not reproducible in V15.

Steps to Reproduce:
Create a Payment Entry where the party is an employee.
Submit the Payment Entry.
Observe the error: ""Debit and Credit not equal for Payment Entry #XXXX. Difference is XXXX.""

Root Cause:
Likely due to duplicated or incorrect GL entries in make_gl_entries or save_entries logic.

Solution: Fix GL posting logic to ensure debit and credit amounts match for Payment Entries. This issue is already resolved in V15.


### Module

accounts

### Version

ERPNext V14

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
request.js:457 Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 97, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 48, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 86, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1619, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/model/workflow.py"", line 133, in apply_workflow
    doc.submit()
  File ""apps/frappe/frappe/model/document.py"", line 1018, in submit
    return self._submit()
  File ""apps/frappe/frappe/model/document.py"", line 999, in _submit
    return self.save()
  File ""apps/frappe/frappe/model/document.py"", line 310, in save
    return self._save(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 362, in _save
    self.run_post_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1101, in run_post_save_methods
    self.run_method(""on_submit"")
  File ""apps/frappe/frappe/model/document.py"", line 931, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1283, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1265, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 928, in fn
    return method_object(*args, **kwargs)
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 102, in on_submit
    self.make_gl_entries()
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 1097, in make_gl_entries
    make_gl_entries(gl_entries, cancel=cancel, adv_adj=adv_adj)
  File ""apps/erpnext/erpnext/accounts/general_ledger.py"", line 47, in make_gl_entries
    save_entries(gl_map, adv_adj, update_outstanding, from_repost)
  File ""apps/erpnext/erpnext/accounts/general_ledger.py"", line 359, in save_entries
    process_debit_credit_difference(gl_map)
  File ""apps/erpnext/erpnext/accounts/general_ledger.py"", line 432, in process_debit_credit_difference
    raise_debit_credit_not_equal_error(debit_credit_diff, voucher_type, voucher_no)
  File ""apps/erpnext/erpnext/accounts/general_ledger.py"", line 469, in raise_debit_credit_not_equal_error
    frappe.throw(
  File ""apps/frappe/frappe/__init__.py"", line 548, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 509, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 455, in _raise_exception
    raise raise_exception(msg)
frappe.exceptions.ValidationError: Debit and Credit not equal for Payment Entry #2440PAY00008. Difference is 200000.0.

2440PAY00008:1 Uncaught (in promise) undefined
```
",CoderKal,2024-12-04 19:55:53+00:00,['diptanilsaha'],2025-01-27 09:04:20+00:00,2025-01-27 09:04:19+00:00,https://github.com/frappe/erpnext/issues/44517,"[('bug', None), (""can't-reproduce"", 'We are unable to reproduce this bug, provide more information.'), ('need-more-info', 'Provide additional context, steps to reproduce this issue.')]","[{'comment_id': 2602637735, 'issue_id': 2718667499, 'author': 'diptanilsaha', 'body': 'Please provide exact replication steps as I am not able to replicate this issue.', 'created_at': datetime.datetime(2025, 1, 20, 14, 57, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2615187394, 'issue_id': 2718667499, 'author': 'diptanilsaha', 'body': 'The issue is being closed due to a lack of response.', 'created_at': datetime.datetime(2025, 1, 27, 9, 4, 19, tzinfo=datetime.timezone.utc)}]","diptanilsaha (Assginee) on (2025-01-20 14:57:39 UTC): Please provide exact replication steps as I am not able to replicate this issue.

diptanilsaha (Assginee) on (2025-01-27 09:04:19 UTC): The issue is being closed due to a lack of response.

"
2714916309,issue,open,,Organizational Chart Not Shown In My Website,"### Information about bug

I have this project dockerized in the production server and live with the main domain It is now implemented, and the project is up and running on the production server now I have an administrator user and I have checked this organizational chart, but it is not shown on my production server, I have 8 users in this domain.


### Module

HR

### Version

![image](https://github.com/user-attachments/assets/92da70c8-7853-44a4-8c08-ee21edd49168)


### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
I have this project dockerized in the production server and live with the main domain It is now implemented, and the project is up and running on the production server now I have an administrator user and I have checked this organization chart, but it is not shown on my production server, I have 8 users in this domain.
```
",ghost,2024-12-03 12:34:56+00:00,[],2024-12-03 12:34:56+00:00,,https://github.com/frappe/erpnext/issues/44488,"[('bug', None)]",[],
2714873249,issue,closed,completed,Fields not loading in the POS Profile doctype,"### Information about bug

Only for frappe team. Check following link to replicate the issue.

Check: https://spindl16.frappe.cloud/app/pos-profile/Cashier%201


### Module

POS / selling

### Bug

<img width=""1154"" alt=""Screenshot 2024-12-03 at 5 47 31 PM"" src=""https://github.com/user-attachments/assets/7d4184c9-e756-4cad-9f8e-20fb202ee1c0"">



### Version

Installed Apps
ERPNext: v16.0.0-dev (HEAD)

Framework: v16.0.0-dev (HEAD)

Frappe HR: v16.0.0-dev (HEAD)

India Compliance: v16.0.0-dev (HEAD)

Payments: v0.0.1 (HEAD)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
Using this console may allow attackers to impersonate you and steal your information. Do not enter or paste code that you do not understand.
script_manager.js:32 ∆í (frm) {
		frm.set_query(""selling_price_list"", function () {
			return { filters: { selling: 1 } };
		});

		frm.set_query(""tc_name"", function () {
			return { filters: { selling: 1 } };
		});

		erpn‚Ä¶
d @ script_manager.js:32Understand this errorAI
request.js:309 Unable to handle success response Object
request.js:310 ReferenceError: erpnext is not defined
    at setup (pos_profile__js:19:3)
    at d (script_manager.js:30:12)
    at n (script_manager.js:109:16)
    at script_manager.js:125:5
    at Array.forEach (<anonymous>)
    at frappe.ui.form.ScriptManager.trigger (script_manager.js:122:22)
    at frappe.ui.form.ScriptManager.setup (script_manager.js:247:8)
    at frappe.ui.form.Form.setup (form.js:116:23)
    at frappe.ui.form.Form.refresh (form.js:445:10)
    at frappe.views.FormFactory.render (formview.js:107:45)
```
",umairsy,2024-12-03 12:16:26+00:00,['diptanilsaha'],2025-01-10 00:10:40+00:00,2024-12-26 06:46:36+00:00,https://github.com/frappe/erpnext/issues/44487,"[('bug', None), ('POS', None)]","[{'comment_id': 2514412002, 'issue_id': 2714873249, 'author': 'umairsy', 'body': 'Same for POS as well.\r\n\r\npoint-of-sale:1 Uncaught SyntaxError: Failed to execute \'appendChild\' on \'Node\': Unexpected token \'<\'\r\n    at Object.eval (dom.js:33:44)\r\n    at Object.js (assets.js:27:16)\r\n    at go.eval_assets (assets.js:82:33)\r\n    at assets.js:111:8\r\n    at Array.forEach (<anonymous>)\r\n    at assets.js:109:10Understand this errorAI\r\npoint_of_sale.js:11 Uncaught (in promise) TypeError: erpnext.PointOfSale.Controller is not a constructor\r\n    at point_of_sale.js:11:17\r\n    at assets.js:17:16\r\n    at assets.js:114:4\r\n\r\n<img width=""1157"" alt=""Screenshot 2024-12-03 at 5 50 01 PM"" src=""https://github.com/user-attachments/assets/77810de9-64ea-4b2d-a467-9ba8c8959e0a"">', 'created_at': datetime.datetime(2024, 12, 3, 12, 20, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2562220067, 'issue_id': 2714873249, 'author': 'diptanilsaha', 'body': 'Could not replicate the bug.', 'created_at': datetime.datetime(2024, 12, 26, 6, 46, 36, tzinfo=datetime.timezone.utc)}]","umairsy (Issue Creator) on (2024-12-03 12:20:22 UTC): Same for POS as well.

point-of-sale:1 Uncaught SyntaxError: Failed to execute 'appendChild' on 'Node': Unexpected token '<'
    at Object.eval (dom.js:33:44)
    at Object.js (assets.js:27:16)
    at go.eval_assets (assets.js:82:33)
    at assets.js:111:8
    at Array.forEach (<anonymous>)
    at assets.js:109:10Understand this errorAI
point_of_sale.js:11 Uncaught (in promise) TypeError: erpnext.PointOfSale.Controller is not a constructor
    at point_of_sale.js:11:17
    at assets.js:17:16
    at assets.js:114:4

<img width=""1157"" alt=""Screenshot 2024-12-03 at 5 50 01 PM"" src=""https://github.com/user-attachments/assets/77810de9-64ea-4b2d-a467-9ba8c8959e0a"">

diptanilsaha (Assginee) on (2024-12-26 06:46:36 UTC): Could not replicate the bug.

"
2713979058,issue,open,,Add FSSAI License fields to Company DocType for Indian compliance,"**Is your feature request related to a problem? Please describe.**
Currently, there is no dedicated field to store and display FSSAI License details in the Company DocType's registration details section. FSSAI License number is a mandatory requirement for food businesses in India and needs to be displayed on various business documents and reports. Having to manually add this information each time or store it in custom fields creates inconsistency and additional work.

**Describe the solution you'd like**
Add the following fields under Company DocType > Print Settings > Registration Details section:

FSSAI License Number (Data type: Data)
FSSAI License Valid From (Data type: Date)
FSSAI License Valid Until (Data type: Date)

These fields should:

Be available for printing on standard documents like Sales Invoice, Purchase Order, etc.
Include validation for the standard FSSAI license number format
Show a warning when the license is about to expire (30 days before expiry)

**Describe alternatives you've considered**

Using Custom Fields - While this works, it doesn't provide a standardized solution across installations

**Additional context**

FSSAI License is a regulatory requirement for food businesses in India
The license number follows a standard 14-digit format
This information needs to be printed on various business documents and packaging",azharumar,2024-12-03 04:48:10+00:00,[],2024-12-03 04:48:10+00:00,,https://github.com/frappe/erpnext/issues/44476,"[('feature-request', None)]",[],
2711728194,issue,open,,Opportunity not saving,"### Information about bug

Steps:

1. Duplicated the Opportunity
2. Changed the Lead. 
3. Tried saving but got this error.
4. Change country and somehow Lead got saved.

<img width=""1170"" alt=""Screenshot 2024-12-02 at 5 33 27 PM"" src=""https://github.com/user-attachments/assets/2eccf1ee-3856-47a7-9a46-1725b853d895"">


### Module

CRM

### Version

V. 16

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
desk.js:116 Using this console may allow attackers to impersonate you and steal your information. Do not enter or paste code that you do not understand.
BaseChart.js:78 """" is not a valid color.
(anonymous) @ BaseChart.js:78Understand this warningAI
socketio_client.js:145 throttled
new-opportunity-qgxkeoamdr:1 Blocked aria-hidden on an element because its descendant retained focus. The focus must not be hidden from assistive technology users. Avoid using aria-hidden on a focused element or its ancestor. Consider using the inert attribute instead, which will also prevent focus. For more details, see the aria-hidden section of the WAI-ARIA specification at https://w3c.github.io/aria/#aria-hidden.
Element with focus: button
Ancestor with aria-hidden:  <div class=‚Äã""modal fade"" style=‚Äã""overflow:‚Äã auto;‚Äã display:‚Äã none;‚Äã"" tabindex=‚Äã""-1"" aria-hidden=‚Äã""true"">‚Äã‚Ä¶‚Äã</div>‚ÄãUnderstand this errorAI
moment.js:287 Deprecation warning: value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.
Arguments: 
[0] _isAMomentObject: true, _isUTC: true, _useUTC: true, _l: undefined, _i: undefined, _f: undefined, _strict: undefined, _locale: [object Object]
Error
    at Function.createFromInputFallback (https://spindl16.frappe.cloud/assets/frappe/dist/js/libs.bundle.TIV7ZGVY.js:7:3)
    at jn (https://spindl16.frappe.cloud/assets/frappe/dist/js/libs.bundle.TIV7ZGVY.js:7:24628)
    at mr (https://spindl16.frappe.cloud/assets/frappe/dist/js/libs.bundle.TIV7ZGVY.js:7:28419)
    at Xi (https://spindl16.frappe.cloud/assets/frappe/dist/js/libs.bundle.TIV7ZGVY.js:7:28284)
    at Ki (https://spindl16.frappe.cloud/assets/frappe/dist/js/libs.bundle.TIV7ZGVY.js:7:28002)
    at Zn (https://spindl16.frappe.cloud/assets/frappe/dist/js/libs.bundle.TIV7ZGVY.js:7:28780)
    at Fe (https://spindl16.frappe.cloud/assets/frappe/dist/js/libs.bundle.TIV7ZGVY.js:4:112815)
    at Function.ne [as tz] (https://spindl16.frappe.cloud/assets/frappe/dist/js/libs.bundle.TIV7ZGVY.js:7:61602)
    at Object.convert_to_user_tz (https://spindl16.frappe.cloud/assets/frappe/dist/js/desk.bundle.BWT3JSG5.js:718:442)
    at sa (https://spindl16.frappe.cloud/assets/frappe/dist/js/desk.bundle.BWT3JSG5.js:712:4358)
ut @ moment.js:287Understand this warningAI
/api/method/frappe.desk.form.save.savedocs:1 
        
        
       Failed to load resource: the server responded with a status of 417 ()Understand this errorAI
request.js:473 Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1808, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 32, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 340, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 362, in _save
    return self.insert()
           ^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 293, in insert
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1117, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 969, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1352, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1330, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 966, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/crm/doctype/opportunity/opportunity.py"", line 121, in validate
    self.update_prospect()
  File ""apps/erpnext/erpnext/crm/doctype/opportunity/opportunity.py"", line 185, in update_prospect
    prospect.save()
  File ""apps/frappe/frappe/model/document.py"", line 340, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 375, in _save
    self._validate_links()
  File ""apps/frappe/frappe/model/document.py"", line 937, in _validate_links
    frappe.throw(_(""Could not find {0}"").format(msg), frappe.LinkValidationError)
  File ""apps/frappe/frappe/__init__.py"", line 681, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 646, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 597, in _raise_exception
    raise exc
frappe.exceptions.LinkValidationError: Could not find Row #1: Opportunity: CRM-OPP-2024-00002

(anonymous) @ request.js:473Understand this errorAI
/api/method/frappe.desk.form.save.savedocs:1 
        
        
       Failed to load resource: the server responded with a status of 417 ()Understand this errorAI
request.js:473 Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1808, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 32, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 340, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 362, in _save
    return self.insert()
           ^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 293, in insert
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1117, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 969, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1352, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1330, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 966, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/crm/doctype/opportunity/opportunity.py"", line 121, in validate
    self.update_prospect()
  File ""apps/erpnext/erpnext/crm/doctype/opportunity/opportunity.py"", line 185, in update_prospect
    prospect.save()
  File ""apps/frappe/frappe/model/document.py"", line 340, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 375, in _save
    self._validate_links()
  File ""apps/frappe/frappe/model/document.py"", line 937, in _validate_links
    frappe.throw(_(""Could not find {0}"").format(msg), frappe.LinkValidationError)
  File ""apps/frappe/frappe/__init__.py"", line 681, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 646, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 597, in _raise_exception
    raise exc
frappe.exceptions.LinkValidationError: Could not find Row #1: Opportunity: CRM-OPP-2024-00002

(anonymous) @ request.js:473Understand this errorAI
new-opportunity-qgxkeoamdr:1 Blocked aria-hidden on an element because its descendant retained focus. The focus must not be hidden from assistive technology users. Avoid using aria-hidden on a focused element or its ancestor. Consider using the inert attribute instead, which will also prevent focus. For more details, see the aria-hidden section of the WAI-ARIA specification at https://w3c.github.io/aria/#aria-hidden.
Element with focus: div
Ancestor with aria-hidden:  <div class=‚Äã""modal fade"" style=‚Äã""overflow:‚Äã auto;‚Äã z-index:‚Äã 2000;‚Äã display:‚Äã none;‚Äã"" tabindex=‚Äã""-1"" aria-hidden=‚Äã""true"">‚Äã‚Ä¶‚Äã</div>‚ÄãUnderstand this errorAI
/api/method/frappe.desk.form.save.savedocs:1 
        
        
       Failed to load resource: the server responded with a status of 417 ()Understand this errorAI
request.js:473 Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1808, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 32, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 340, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 362, in _save
    return self.insert()
           ^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 293, in insert
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1117, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 969, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1352, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1330, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 966, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/crm/doctype/opportunity/opportunity.py"", line 121, in validate
    self.update_prospect()
  File ""apps/erpnext/erpnext/crm/doctype/opportunity/opportunity.py"", line 185, in update_prospect
    prospect.save()
  File ""apps/frappe/frappe/model/document.py"", line 340, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 375, in _save
    self._validate_links()
  File ""apps/frappe/frappe/model/document.py"", line 937, in _validate_links
    frappe.throw(_(""Could not find {0}"").format(msg), frappe.LinkValidationError)
  File ""apps/frappe/frappe/__init__.py"", line 681, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 646, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 597, in _raise_exception
    raise exc
frappe.exceptions.LinkValidationError: Could not find Row #1: Opportunity: CRM-OPP-2024-00002

(anonymous) @ request.js:473Understand this errorAI
/api/method/frappe.desk.form.save.savedocs:1 
        
        
       Failed to load resource: the server responded with a status of 417 ()Understand this errorAI
request.js:473 Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1808, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 32, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 340, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 362, in _save
    return self.insert()
           ^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 293, in insert
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1117, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 969, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1352, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1330, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 966, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/crm/doctype/opportunity/opportunity.py"", line 121, in validate
    self.update_prospect()
  File ""apps/erpnext/erpnext/crm/doctype/opportunity/opportunity.py"", line 185, in update_prospect
    prospect.save()
  File ""apps/frappe/frappe/model/document.py"", line 340, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 375, in _save
    self._validate_links()
  File ""apps/frappe/frappe/model/document.py"", line 937, in _validate_links
    frappe.throw(_(""Could not find {0}"").format(msg), frappe.LinkValidationError)
  File ""apps/frappe/frappe/__init__.py"", line 681, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 646, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 597, in _raise_exception
    raise exc
frappe.exceptions.LinkValidationError: Could not find Row #1: Opportunity: CRM-OPP-2024-00002
```
",umairsy,2024-12-02 12:13:00+00:00,['iamejaaz'],2025-01-07 11:42:29+00:00,,https://github.com/frappe/erpnext/issues/44475,"[('bug', None), ('v16', '')]","[{'comment_id': 2575078625, 'issue_id': 2711728194, 'author': 'iamejaaz', 'body': ""Hi @umairsy \r\nCan't replicate this, Can you confirm if the issue still exists? If so, could you please share more details?"", 'created_at': datetime.datetime(2025, 1, 7, 11, 42, 28, tzinfo=datetime.timezone.utc)}]","iamejaaz (Assginee) on (2025-01-07 11:42:28 UTC): Hi @umairsy 
Can't replicate this, Can you confirm if the issue still exists? If so, could you please share more details?

"
2711697370,issue,open,,Total of the O/s Invoices at the Paid Total Field at the Payment Entry.,"We are not getting the Total of the O/s Invoices at the Paid Total

Actually in case of Multiple Bills Invoice, system should auto fetch and refresh and calculate the amount by default in the ‚ÄúPaid Total‚Äù after selecting O/s Invoices from the O/s Invoices Table. Here we are calculating manually which is a cumbersome process and chances of error also , and in case we need to change the amount we should be able to get and hence ‚ÄúPaid Amount‚Äù should get calculate automatically by adding the sum total of all the O/s Invoices.

This would be a generic requirement and it should inbuilt in the system

We have raised the Ticket-26484 against which your Support Executive

Hello,

We understand the requirement you mentioned and appreciate your detailed explanation. At the moment, the system does not support the feature where the paid amount can dynamically adjust based on outstanding invoices, as the payment can also be made in advance. This makes it challenging to establish a logic for automatic calculation tied solely to outstanding invoices.

We recommend raising this as a Feature Request on our [GitHub repository](https://github.com/frappe/erpnext/issues/new?assignees=&labels=feature-request&template=feature_request.md&title=) so our team can review it and consider it for future development. This ensures that your feedback is directly shared with the product team and helps prioritize features based on user needs

We cannot provide any timelines on the FRs as they will be taken up for development based on the development bandwidth and product feature roadmap.

Regards,
Sanjay

Refer the below Video for your references


https://github.com/user-attachments/assets/e843ca2f-4775-4498-bf58-8c77e11eeae7



",JitendraSAW,2024-12-02 12:00:18+00:00,[],2024-12-02 12:00:18+00:00,,https://github.com/frappe/erpnext/issues/44474,"[('feature-request', None)]",[],
2711674921,issue,open,,CRM > Lead > New Address,"### Information about bug

When adding a new address from Lead, Address creation is failed due to Address Title. However, when adding a new Address, the field Address title isn't there.

<img width=""1137"" alt=""Screenshot 2024-12-02 at 5 17 25 PM"" src=""https://github.com/user-attachments/assets/af0da751-6b36-48cd-8840-bfff112314b0"">


Separate issue, but the fields of India Compliance also show-up in Address, even when default country is United States. @vorasmit 

### Module

CRM

### Version

ERPNext: v16.0.0-dev (HEAD)

Frappe Framework: v16.0.0-dev (HEAD)

Frappe HR: v16.0.0-dev (HEAD)

India Compliance: v16.0.0-dev (HEAD)

Payments: v0.0.1 (HEAD)

[Dependencies & Licenses](https://spindl16.frappe.cloud/attribution)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",umairsy,2024-12-02 11:51:25+00:00,['shariquerik'],2025-01-16 04:16:44+00:00,,https://github.com/frappe/erpnext/issues/44472,"[('bug', None), ('v16', '')]","[{'comment_id': 2594443765, 'issue_id': 2711674921, 'author': 'vorasmit', 'body': ""When it comes to address with a different country, it could mean address with GST Category Overseas for Imports / Exports.\nThere is no way to determine if GST Fields in address are not necessary for one specific address (as it's not linked to company).\n\nThis will be true even for Customers / Suppliers.\n\nHow do you propose this be handled?"", 'created_at': datetime.datetime(2025, 1, 16, 4, 16, 43, tzinfo=datetime.timezone.utc)}]","vorasmit on (2025-01-16 04:16:43 UTC): When it comes to address with a different country, it could mean address with GST Category Overseas for Imports / Exports.
There is no way to determine if GST Fields in address are not necessary for one specific address (as it's not linked to company).

This will be true even for Customers / Suppliers.

How do you propose this be handled?

"
2709917106,issue,closed,completed,"Quickbooks Migrator ""Failed"" from Quickbooks Online Essentials (Canada) to ERPNext v15 self hosted on Ubuntu 24.04","### Information about bug

All the customer and vendor information transferred over fine.   Once it gets into transferring invoices, journal entries, and all other transactions it goes to ""Failed"".  I read some places that the fiscal year might have something to do with incomplete transfers.  I'm happy that at least all customer and vendor information transferred but I have some suggestions for that, and in general for this to be suitable for a business to migrate.

1 - for Customer Data: If there is a first and last name field with the customer record, this should be created as a contact as well, and all phone numbers/email addresses should be added to both the customer record, and individual contact person record associated with the customer record.  

2 - All previous fiscal years invoices, quotes, and basically all information held in QuickBooks should import over.  As a business owner we require all of the previous information on file to better serve customers.  The ""incomplete"" aka ""failed"" transfer creates all kinds of additional book keeping costs for having to review what transferred and what didn't and then everything has to be corrected and/or double checked.    It keeps us stuck in QuickBooks until all previous records for at least the last 7 years can transfer over.

If the above two items are resolved I think it would help significantly increase migration numbers.   It's something we need resolved urgently.

### Module

accounts

### Version

ERP Next v. 15 self hosted on Ubuntu 24.04

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",madewji,2024-12-01 21:36:42+00:00,[],2025-01-28 00:10:15+00:00,2025-01-13 09:19:19+00:00,https://github.com/frappe/erpnext/issues/44460,"[('bug', None)]","[{'comment_id': 2531818598, 'issue_id': 2709917106, 'author': 'Glitch-Trap-1', 'body': ""@madewji \r\n\r\nI know it sounds like a pain but you seem familiar with what you need transferred. So I would probably use the data import tool instead of the Quickbooks migrator in this case. The Quickbooks migrator is still experimental so I'm not surprised you are having issues. It'll be a little more cumbersome but I have had good success with simply importing the relevant information to the correct Doctypes."", 'created_at': datetime.datetime(2024, 12, 10, 14, 38, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2586576254, 'issue_id': 2709917106, 'author': 'nabinhait', 'body': 'We are planning to remove Quickbooks Migrator from ERPNext, it is better to import using the chart of accounts importer and opening invoice creation tool.', 'created_at': datetime.datetime(2025, 1, 13, 9, 19, 19, tzinfo=datetime.timezone.utc)}]","Glitch-Trap-1 on (2024-12-10 14:38:49 UTC): @madewji 

I know it sounds like a pain but you seem familiar with what you need transferred. So I would probably use the data import tool instead of the Quickbooks migrator in this case. The Quickbooks migrator is still experimental so I'm not surprised you are having issues. It'll be a little more cumbersome but I have had good success with simply importing the relevant information to the correct Doctypes.

nabinhait on (2025-01-13 09:19:19 UTC): We are planning to remove Quickbooks Migrator from ERPNext, it is better to import using the chart of accounts importer and opening invoice creation tool.

"
2709861557,issue,closed,completed,New Landed Cost Voucher - Applicable Charges NaN,"### Information about bug

When creating a new Landed Cost Voucher by ""+"" button from ""Connections"" tab of Purchase Receipt, after some charge was added, values in the column ""Applicable Charges"" for each item become ""NaN"".

### Module

buying

### Version

Frappe version: 15.47.2
Erpnext version: 15.42.0

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",evghenin,2024-12-01 21:18:42+00:00,[],2025-01-28 00:10:14+00:00,2025-01-13 10:05:00+00:00,https://github.com/frappe/erpnext/issues/44459,"[('bug', None)]","[{'comment_id': 2586675261, 'issue_id': 2709861557, 'author': 'nabinhait', 'body': ""Can't replicate it. If you can replicate it, please reopen the issue with steps to replicate."", 'created_at': datetime.datetime(2025, 1, 13, 10, 5, tzinfo=datetime.timezone.utc)}]","nabinhait on (2025-01-13 10:05:00 UTC): Can't replicate it. If you can replicate it, please reopen the issue with steps to replicate.

"
2709853920,issue,closed,completed,New Landed Cost Voucher doesn't fetch more than 16 items from Purchase Receipt,"### Information about bug

Purchase Receipt contain 29 items. When creating a new Landed Cost Voucher based on that Purchase Receipt after clicking the button ""Get Items From Purchase Receipts"" only 16 items being loaded to the list of items. Exploring requests I see that request to https://app.domain/api/method/run_doc_method for method ""get_items_from_purchase_receipts"" returning object with 16 items only.

### Module

buying

### Version

Frappe version: 15.47.2
Erpnext version: 15.42.0

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",evghenin,2024-12-01 21:06:23+00:00,[],2024-12-17 00:11:14+00:00,2024-12-02 20:22:21+00:00,https://github.com/frappe/erpnext/issues/44458,"[('bug', None)]","[{'comment_id': 2512722813, 'issue_id': 2709853920, 'author': 'evghenin', 'body': 'As I discovered, items must be ""maintain stock""', 'created_at': datetime.datetime(2024, 12, 2, 20, 22, 8, tzinfo=datetime.timezone.utc)}]","evghenin (Issue Creator) on (2024-12-02 20:22:08 UTC): As I discovered, items must be ""maintain stock""

"
2708743664,issue,open,,Bug in asset. I couldn't save or submit in asset ,"### Information about bug
After we've created purchase receipt for the item it automatically generate a document of assets but then from draft when I submit the document I have receive error.
 I am on the latest branch but still I have receive the error ‚ÄúInvalid Gross Purchase Amount‚Äù same as in our test site. Thank you
![image](https://github.com/user-attachments/assets/ab9929d9-56b8-44cb-903d-d64d7d66373a)
![image](https://github.com/user-attachments/assets/bf9a3fbb-91d8-4293-bfa3-9cf192a99309)
![image](https://github.com/user-attachments/assets/15bc5867-411b-4cc2-9c0c-23199a251d25)


### Module

other

### Version

Frappe Framework: v15.48.1 (HEAD)
ERPNext: v15.44.0 (HEAD)



### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1725, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 341, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 377, in _save
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1095, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 966, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1326, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1308, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 963, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/assets/doctype/asset/asset.py"", line 128, in validate
    self.validate_gross_and_purchase_amount()
  File ""apps/erpnext/erpnext/assets/doctype/asset/asset.py"", line 374, in validate_gross_and_purchase_amount
    frappe.throw(error_message, title=_(""Invalid Gross Purchase Amount""))
  File ""apps/frappe/frappe/__init__.py"", line 602, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 567, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 518, in _raise_exception
    raise exc
frappe.exceptions.ValidationError: Gross Purchase Amount should be <b>equal</b> to purchase amount of one single Asset.<br>Please do not book expense of multiple assets against one single Asset.
```
",expert369,2024-12-01 07:52:02+00:00,['khushi8112'],2025-01-31 10:48:29+00:00,,https://github.com/frappe/erpnext/issues/44454,"[('bug', None)]","[{'comment_id': 2520214459, 'issue_id': 2708743664, 'author': 'MatthK', 'body': ""I just came across the same error. I'm on Version 15.41.1.\r\n\r\nCreated a purchase order for 3 assets. The purchase order was in a different currency then the company currency. While creating the purchase receipt, 3 assets were automatically created. Now when I try to submit the draft assets, I get the same error message:\r\n\r\n`Invalid Gross Purchase Amount\r\nGross Purchase Amount should be equal to purchase amount of one single Asset.\r\nPlease do not book expense of multiple assets against one single Asset.`\r\n\r\nThe Gross Purchase Amount is $5,449.64, while the Total Purchase Receipt amount is $16,348.93. I assume the small difference in the decimals is what triggers the error message, as the Gross Purchase Amount for one would be $5,449.6433333333\r\n\r\nHow to submit those assets?"", 'created_at': datetime.datetime(2024, 12, 5, 12, 41, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2520222388, 'issue_id': 2708743664, 'author': 'MatthK', 'body': 'Ok, so I just deleted the automatically created drafts and created them manually. I could then submit the assets as expected, despite the small difference in the amount.', 'created_at': datetime.datetime(2024, 12, 5, 12, 44, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2520521473, 'issue_id': 2708743664, 'author': 'expert369', 'body': ""> Ok, so I just deleted the automatically created drafts and created them manually. I could then submit the assets as expected, despite the small difference in the amount.\r\n\r\nThank you for this, it is also one way to submit a document temporarily. But I've override the function that triggered the error and changed the frappe.throw to frappe.msgprint it provides a message but it doesn't stop you from saving, just temporarily."", 'created_at': datetime.datetime(2024, 12, 5, 14, 46, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2626909263, 'issue_id': 2708743664, 'author': 'khushi8112', 'body': 'Hello @expert369 \n\nI have tried to replicate the issue but was unable to do so. Could you help me with the replication steps?', 'created_at': datetime.datetime(2025, 1, 31, 10, 48, 29, tzinfo=datetime.timezone.utc)}]","MatthK on (2024-12-05 12:41:08 UTC): I just came across the same error. I'm on Version 15.41.1.

Created a purchase order for 3 assets. The purchase order was in a different currency then the company currency. While creating the purchase receipt, 3 assets were automatically created. Now when I try to submit the draft assets, I get the same error message:

`Invalid Gross Purchase Amount
Gross Purchase Amount should be equal to purchase amount of one single Asset.
Please do not book expense of multiple assets against one single Asset.`

The Gross Purchase Amount is $5,449.64, while the Total Purchase Receipt amount is $16,348.93. I assume the small difference in the decimals is what triggers the error message, as the Gross Purchase Amount for one would be $5,449.6433333333

How to submit those assets?

MatthK on (2024-12-05 12:44:50 UTC): Ok, so I just deleted the automatically created drafts and created them manually. I could then submit the assets as expected, despite the small difference in the amount.

expert369 (Issue Creator) on (2024-12-05 14:46:05 UTC): Thank you for this, it is also one way to submit a document temporarily. But I've override the function that triggered the error and changed the frappe.throw to frappe.msgprint it provides a message but it doesn't stop you from saving, just temporarily.

khushi8112 (Assginee) on (2025-01-31 10:48:29 UTC): Hello @expert369 

I have tried to replicate the issue but was unable to do so. Could you help me with the replication steps?

"
2711371026,issue,open,,Production of materials from work order,"In the work order some materials were Alternate Item

![image](https://github.com/user-attachments/assets/131c9b54-893c-4d75-924e-6d77504d826f)

When the Work Order process is completed Click Finish, Go to Stock entry The materials have not been replaced, Materials used in the work order process

![image](https://github.com/user-attachments/assets/dc6b2fd3-4fcc-498e-87c5-f9fad1e0a8ef)

",tajff,2024-12-01 06:49:03+00:00,[],2024-12-21 10:04:19+00:00,,https://github.com/frappe/erpnext/issues/44471,"[('bug', None)]","[{'comment_id': 2558071471, 'issue_id': 2711371026, 'author': 'parasonit', 'body': 'Use below setting and check,\r\n\r\n![image](https://github.com/user-attachments/assets/216ba2ef-3a0e-41b6-bef8-7d71a28da729)', 'created_at': datetime.datetime(2024, 12, 21, 10, 4, 18, tzinfo=datetime.timezone.utc)}]","parasonit on (2024-12-21 10:04:18 UTC): Use below setting and check,

![image](https://github.com/user-attachments/assets/216ba2ef-3a0e-41b6-bef8-7d71a28da729)

"
2707365024,issue,closed,completed,Employee Advance Status is not updating after payment Entry,"### Information about bug

After making the payment entry the status of employee advance still shows unpaid.


### Module

HR

### Version

ERPNext: v15.43.0 (version-15)

Frappe Framework: v15.48.0 (version-15)

Frappe HR: v16.0.0-dev (develop)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",DileepMedayil,2024-11-30 13:25:42+00:00,[],2024-12-17 00:11:17+00:00,2024-12-02 06:12:23+00:00,https://github.com/frappe/erpnext/issues/44452,"[('bug', None)]","[{'comment_id': 2510662729, 'issue_id': 2707365024, 'author': 'Nihantra-Patel', 'body': 'We tested in the latest version, but we haven‚Äôt found the issue. The status will update when you submit the Payment Entry.\r\n\r\nAlso, I shared a suggestion:\r\nIf you‚Äôve installed ERPNext in version 15, make sure the hrms is also in version 15 to prevent errors.\r\n\r\n[scrnli_JSwRnaQI5MTJxR.webm](https://github.com/user-attachments/assets/14c9e715-cf28-4fa6-b810-b69c3c3dfead)', 'created_at': datetime.datetime(2024, 12, 2, 6, 12, 23, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-12-02 06:12:23 UTC): We tested in the latest version, but we haven‚Äôt found the issue. The status will update when you submit the Payment Entry.

Also, I shared a suggestion:
If you‚Äôve installed ERPNext in version 15, make sure the hrms is also in version 15 to prevent errors.

[scrnli_JSwRnaQI5MTJxR.webm](https://github.com/user-attachments/assets/14c9e715-cf28-4fa6-b810-b69c3c3dfead)

"
2707131480,issue,open,,Kanban Board View,"Kanban Board should not dynamically adjust the width too much. Due to a custom field being added to the view, a single column is widening to two times the length of a regular kanban column. A simple wrap to the next line would be better visually.

Also, hardly any options for customizing.",nakul80,2024-11-30 10:30:04+00:00,[],2024-11-30 10:31:06+00:00,,https://github.com/frappe/erpnext/issues/44451,"[('feature-request', None)]",[],
2706936651,issue,open,,Tons of DB Access denied for user in output,"### Information about bug

Fresh install of Frappe+ERPNext. 

Docker log output shows tons of this:

`db_1            | 2024-11-30  7:48:28 84482 [Warning] Access denied for user '_16acc59204213ad9'@'172.19.0.3' (using password: YES)`

What's up?

### Module

other

### Version

Bench version 5.22.9
erpnext 15.44.0  ()
frappe 15.48.1  ()

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
db_1            | 2024-11-30  7:48:28 84482 [Warning] Access denied for user '_16acc59204213ad9'@'172.19.0.3' (using password: YES)
```
",charleslcso,2024-11-30 07:57:21+00:00,[],2024-12-27 10:30:55+00:00,,https://github.com/frappe/erpnext/issues/44449,"[('bug', None)]","[{'comment_id': 2539592679, 'issue_id': 2706936651, 'author': 'yousefpahang', 'body': 'I am having exactly same error on production', 'created_at': datetime.datetime(2024, 12, 12, 17, 37, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2563444520, 'issue_id': 2706936651, 'author': 'lovestaco', 'body': '> I am having exactly same error on production\r\n\r\nWere you able to solve this? @yousefpahang', 'created_at': datetime.datetime(2024, 12, 27, 8, 16, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2563559700, 'issue_id': 2706936651, 'author': 'yousefpahang', 'body': 'it seems like the issue is with --mariadb-user-host-login-scope=% when creating new site. so I used  --no-mariadb-socket (which is deprecated) and created site again and restored the backup and it worked properly. \r\n\r\non  frappe v15.47.2 seems like it is fixed:\r\nFixed an issue where the mariadb_user_host_login_scope option was not correctly applied when creating a new site using the new-site command. https://github.com/frappe/frappe/pull/28400\r\n\r\nhttps://github.com/frappe/frappe/pull/28400\r\n\r\nI did not update yet but will try and update you .', 'created_at': datetime.datetime(2024, 12, 27, 10, 30, 54, tzinfo=datetime.timezone.utc)}]","yousefpahang on (2024-12-12 17:37:14 UTC): I am having exactly same error on production

lovestaco on (2024-12-27 08:16:07 UTC): Were you able to solve this? @yousefpahang

yousefpahang on (2024-12-27 10:30:54 UTC): it seems like the issue is with --mariadb-user-host-login-scope=% when creating new site. so I used  --no-mariadb-socket (which is deprecated) and created site again and restored the backup and it worked properly. 

on  frappe v15.47.2 seems like it is fixed:
Fixed an issue where the mariadb_user_host_login_scope option was not correctly applied when creating a new site using the new-site command. https://github.com/frappe/frappe/pull/28400

https://github.com/frappe/frappe/pull/28400

I did not update yet but will try and update you .

"
2704761821,issue,open,,Error in Job Requisition Creation,"I had created a job requisition for [JR. Software Developer] in [Software Department] about a month ago. Currently, there is a need to raise another requisition for the same designation, department, and requester. However, the system is throwing an error stating that a requisition has already been created, and I cannot create another one for the same parameters.

Could you please assist in resolving this issue so that I can proceed with creating the new requisition?

![QWSdBGw](https://github.com/user-attachments/assets/62ff5b19-2adb-4b53-a4d1-a64843bac0b2)
",precihole,2024-11-29 10:54:14+00:00,[],2025-01-14 06:21:40+00:00,,https://github.com/frappe/erpnext/issues/44430,"[('feature-request', None)]",[],
2704749833,issue,closed,completed, Issue with Missing Goods Details in E-Waybill Print Format,"Hello,

When we create an E-Waybill, the goods details are not being generated in the print format of the E-Waybill.
For reference, you can check the given pdf.

Thank you!
[E-Way Bill System.pdf](https://github.com/user-attachments/files/17958048/E-Way.Bill.System.pdf)
",precihole,2024-11-29 10:48:53+00:00,[],2025-01-31 06:57:30+00:00,2025-01-31 06:57:28+00:00,https://github.com/frappe/erpnext/issues/44429,"[('feature-request', None)]","[{'comment_id': 2626440706, 'issue_id': 2704749833, 'author': 'ljain112', 'body': 'Fixed\nhttps://github.com/resilient-tech/india-compliance/pull/2986', 'created_at': datetime.datetime(2025, 1, 31, 6, 57, 28, tzinfo=datetime.timezone.utc)}]","ljain112 on (2025-01-31 06:57:28 UTC): Fixed
https://github.com/resilient-tech/india-compliance/pull/2986

"
2704040556,issue,closed,completed,404 after installation,"### Information about bug

Been manual installing v13 for a long time a few years ago.
Now I'm back to installing v15. 

Used this guide https://github.com/frappe/bench, and installed a frappe site.

`root@backoffice:/opt/frappe_docker# systemctl stop nginx
root@backoffice:/opt/frappe_docker# python3 easy-install.py --prod --email frappeadmin@email.com
 
Setting Up Production Instance
 
Please refer to .example.env file in the frappe_docker folder to know which keys to set

[+] Running 7/7
 ‚úî queue-short Pulled                                                                                                            2.2s 
 ‚úî scheduler Pulled                                                                                                              2.3s 
 ‚úî configurator Pulled                                                                                                           2.3s 
 ‚úî queue-long Pulled                                                                                                             2.3s 
 ‚úî frontend Pulled                                                                                                               2.1s 
 ‚úî websocket Pulled                                                                                                              2.3s 
 ‚úî backend Pulled                                                                                                                2.3s 
[+] Running 11/11
 ‚úî Container frappe-db-1            Healthy                                                                                      0.5s 
 ‚úî Container frappe-redis-queue-1   Running                                                                                      0.0s 
 ‚úî Container frappe-redis-cache-1   Running                                                                                      0.0s 
 ‚úî Container frappe-proxy-1         Started                                                                                      0.5s 
 ‚úî Container frappe-configurator-1  Exited                                                                                       5.9s 
 ‚úî Container frappe-queue-long-1    Started                                                                                      0.9s 
 ‚úî Container frappe-backend-1       Started                                                                                      0.8s 
 ‚úî Container frappe-websocket-1     Started                                                                                      0.7s 
 ‚úî Container frappe-scheduler-1     Started                                                                                      1.1s 
 ‚úî Container frappe-queue-short-1   Started                                                                                      0.8s 
 ‚úî Container frappe-frontend-1      Started                                                                                      0.6s 
 
Creating site: site1.localhost 
 
--no-mariadb-socket is DEPRECATED; use --mariadb-user-host-login-scope='%' (wildcard) or --mariadb-user-host-login-scope=<myhostscope>, instead. The name of this option was misleading: it had nothing to do with sockets.

Installing frappe...
Updating DocTypes for frappe        : [========================================] 100%
Updating Dashboard for frappe

Installing erpnext...
Updating DocTypes for erpnext       : [========================================] 100%
Updating customizations for Address
Updating customizations for Contact
Updating Dashboard for erpnext
site1.localhost: SystemSettings.enable_scheduler is UNSET
*** Scheduler is disabled ***
Current Site set to site1.localhost
`

First of all, why is it site1.localhost? Not just site1.local?

Next, it seems to be running:
`docker-pr 6699     root    4u  IPv4 368608575    0t0  TCP *:http (LISTEN)
docker-pr 6707     root    4u  IPv6 368603079    0t0  TCP *:http (LISTEN)
docker-pr 6713     root    4u  IPv4 368606685    0t0  TCP *:https (LISTEN)
docker-pr 6720     root    4u  IPv6 368603084    0t0  TCP *:https (LISTEN)`

Next, the log file is not under $HOME as stated in the doc. It is in the frappe install directory.

This is the content of the log:
`
root@backoffice:/opt/frappe_docker# cat easy-install.log
2024-11-29 13:55:36,819 - INFO - Running Production Setup
2024-11-29 13:55:47,350 - INFO - Docker Compose file generated at ~/frappe-compose.yml
2024-11-29 13:59:34,629 - INFO - New site creation completed
`

I hard linked site1.local and site1.localhost to IP.

Browser accepted the cert by ""TRAEFIK DEFAULT CERT"", but I get ""404 page not found"".

What now?

### Module

other

### Version

Frappe version and bench version - no idea

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
root@backoffice:/opt/frappe_docker# cat easy-install.log
2024-11-29 13:55:36,819 - INFO - Running Production Setup
2024-11-29 13:55:47,350 - INFO - Docker Compose file generated at ~/frappe-compose.yml
2024-11-29 13:59:34,629 - INFO - New site creation completed
```
",charleslcso,2024-11-29 06:19:16+00:00,[],2024-12-15 00:12:31+00:00,2024-11-30 07:58:47+00:00,https://github.com/frappe/erpnext/issues/44421,"[('bug', None)]","[{'comment_id': 2507200423, 'issue_id': 2704040556, 'author': 'charleslcso', 'body': 'Duh!\r\n\r\nI need to install docker-compose, run it inside the installation directory, then run:\r\n\r\n* docker-compose -f ./pwd.yml up\r\n\r\nThe URL is :8080, not 80!\r\n\r\nNow the login page loads!\r\n\r\nPlease revise the documentation!\r\n\r\nWhat is the administrator login email? The email I used during the above install process returns ""User does not exist""!\r\n\r\nHow do I log in?', 'created_at': datetime.datetime(2024, 11, 29, 7, 0, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2508876219, 'issue_id': 2704040556, 'author': 'maniamartial', 'body': '@charleslcso What \r\n\r\n> Duh!\r\n> \r\n> I need to install docker-compose, run it inside the installation directory, then run:\r\n> \r\n> * docker-compose -f ./pwd.yml up\r\n> \r\n> The URL is :8080, not 80!\r\n> \r\n> Now the login page loads!\r\n> \r\n> Please revise the documentation!\r\n> \r\n> What is the administrator login email? The email I used during the above install process returns ""User does not exist""!\r\n> \r\n> How do I log in?\r\n\r\nWhat about using Administrator as username, should be able to login.', 'created_at': datetime.datetime(2024, 11, 30, 7, 52, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2508877727, 'issue_id': 2704040556, 'author': 'charleslcso', 'body': 'Need to run a command to set administrator\'s password, then I can log in using ""administrator""', 'created_at': datetime.datetime(2024, 11, 30, 7, 58, 30, tzinfo=datetime.timezone.utc)}]","charleslcso (Issue Creator) on (2024-11-29 07:00:15 UTC): Duh!

I need to install docker-compose, run it inside the installation directory, then run:

* docker-compose -f ./pwd.yml up

The URL is :8080, not 80!

Now the login page loads!

Please revise the documentation!

What is the administrator login email? The email I used during the above install process returns ""User does not exist""!

How do I log in?

maniamartial on (2024-11-30 07:52:07 UTC): @charleslcso What 


What about using Administrator as username, should be able to login.

charleslcso (Issue Creator) on (2024-11-30 07:58:30 UTC): Need to run a command to set administrator's password, then I can log in using ""administrator""

"
2702956338,issue,open,,ModuleNotFoundError: No module named 'erpnext.accounts.dashboard_fixtures',https://github.com/frappe/erpnext/blame/69bd90b038e08b2348a100445acefb0d7fe7fecc/erpnext/assets/dashboard_fixtures.py#L10,blaggacao,2024-11-28 18:42:11+00:00,['ruthra-kumar'],2024-11-28 19:10:48+00:00,,https://github.com/frappe/erpnext/issues/44418,[],[],
2701609095,issue,open,,Single item with multiple tax category configured at item master level not allowed to invoice,"### Information about bug

In Item master within TAX tab multiple tax rates are allowed for same ITEM. 
if we use such items in single Purchase invoice or Sales Invoice(or any other relevant doctype) it should allow
selection of those different/multiple tax rates. It is highly possible that user want to track item purchase by groups for want of
simplicity and does not want to create item for all such consumable items

### Module

buying, selling

### Version

<img width=""520"" alt=""Screenshot 2024-11-28 at 3 42 20 PM"" src=""https://github.com/user-attachments/assets/7b53236d-ad0f-47c5-85d3-ea0134f432ee"">
<img width=""707"" alt=""Screenshot 2024-11-28 at 3 34 36 PM"" src=""https://github.com/user-attachments/assets/232bf36c-924e-46fa-8ea1-e582e3ba9a4c"">
<img width=""1209"" alt=""Screenshot 2024-11-28 at 3 33 50 PM"" src=""https://github.com/user-attachments/assets/b71117c5-d772-4434-8799-3a1d102ed946"">


### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",Pankajo76,2024-11-28 10:13:05+00:00,['ljain112'],2025-01-14 10:48:58+00:00,,https://github.com/frappe/erpnext/issues/44408,[],"[{'comment_id': 2510675707, 'issue_id': 2701609095, 'author': 'Nihantra-Patel', 'body': ""It's a validation, please check it.\r\n\r\nhttps://github.com/resilient-tech/india-compliance/blob/26cebc75871363353f67eb1e7f6168420b0fe9e4/india_compliance/gst_india/overrides/transaction.py#L629-L640 \r\n\r\nCC @sagarvora"", 'created_at': datetime.datetime(2024, 12, 2, 6, 22, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2510772798, 'issue_id': 2701609095, 'author': 'ljain112', 'body': '@Nihantra-Patel  \r\n\r\nSame Item => Different Tax Rate = Not supported.\r\nThe issue lies in the core design at ERPNext which is a little difficult to fix.\r\nIn item_wise_tax_details, taxes are saved on the basis of the item name. Due to this Item wise tax rates cannot be determined which is required for GST Reporting.', 'created_at': datetime.datetime(2024, 12, 2, 7, 31, 39, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-12-02 06:22:37 UTC): It's a validation, please check it.

https://github.com/resilient-tech/india-compliance/blob/26cebc75871363353f67eb1e7f6168420b0fe9e4/india_compliance/gst_india/overrides/transaction.py#L629-L640 

CC @sagarvora

ljain112 (Assginee) on (2024-12-02 07:31:39 UTC): @Nihantra-Patel  

Same Item => Different Tax Rate = Not supported.
The issue lies in the core design at ERPNext which is a little difficult to fix.
In item_wise_tax_details, taxes are saved on the basis of the item name. Due to this Item wise tax rates cannot be determined which is required for GST Reporting.

"
2701272896,issue,open,,Separate Doctype for Advance Payments,"Currently Payment Entry handles 2 different types of Payments.
1. Normal Payments - posted directly to Debtors or Creditors account
2. Advance Payments - posted to Receivable accounts under Liability header for Customers and Payable accounts under Assets for Purchases.

Due to design limitation, posting reverse entries for [2] is difficult. 

A Proper solution would be to introduce a new doctype for booking Advances.
",ruthra-kumar,2024-11-28 08:27:40+00:00,['ruthra-kumar'],2024-11-28 08:31:47+00:00,,https://github.com/frappe/erpnext/issues/44404,"[('feature-request', None)]",[],
2701248799,issue,closed,completed,Letter head ,"### Information about bug

When i want to do a stock entry and want to save i get a message "" could not find letter head but there is no letter head 

### Module

stock

### Version

erpnext: v15.40.0 frapper v15.46.0

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",mechaece,2024-11-28 08:15:11+00:00,[],2025-01-28 00:10:12+00:00,2025-01-13 10:06:48+00:00,https://github.com/frappe/erpnext/issues/44403,"[('bug', None)]","[{'comment_id': 2508879053, 'issue_id': 2701248799, 'author': 'maniamartial', 'body': '> ### Information about bug\r\n> When i want to do a stock entry and want to save i get a message "" could not find letter head but there is no letter head\r\n> \r\n> ### Module\r\n> stock\r\n> \r\n> ### Version\r\n> erpnext: v15.40.0 frapper v15.46.0\r\n> \r\n> ### Installation method\r\n> FrappeCloud\r\n> \r\n> ### Relevant log output / Stack trace / Full Error Message.\r\n> _No response_\r\n\r\nDid you at any point had a default letter head and deleted it or changed the name?\r\nIf so can you clear the cache because it will always pick the other default one, check on its section.\r\n![image](https://github.com/user-attachments/assets/61914450-ddd9-4c15-9692-9c44275085ff)', 'created_at': datetime.datetime(2024, 11, 30, 8, 3, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2586679683, 'issue_id': 2701248799, 'author': 'nabinhait', 'body': ""Can't replicate it. If you can replicate it, please reopen the issue with steps to replicate."", 'created_at': datetime.datetime(2025, 1, 13, 10, 6, 56, tzinfo=datetime.timezone.utc)}]","maniamartial on (2024-11-30 08:03:05 UTC): Did you at any point had a default letter head and deleted it or changed the name?
If so can you clear the cache because it will always pick the other default one, check on its section.
![image](https://github.com/user-attachments/assets/61914450-ddd9-4c15-9692-9c44275085ff)

nabinhait on (2025-01-13 10:06:56 UTC): Can't replicate it. If you can replicate it, please reopen the issue with steps to replicate.

"
2701047615,issue,closed,completed,Stock Quantity Reduced Twice for 'AXLE HOUSING RH DIFFLOCK' in Sales Invoice,"### Information about bug

When creating a sales invoice for the item 'AXLE HOUSING RH DIFFLOCK', the stock quantity of 6 is being reduced twice. This results in the inventory being minimized incorrectly.

![Screenshot 2024-11-28 111620](https://github.com/user-attachments/assets/936ced02-a84e-4d5c-bd9f-58a9f936581d)
![Screenshot 2024-11-28 121635](https://github.com/user-attachments/assets/08110449-be14-4890-926c-57f9bff1a41f)


### Module

selling

### Version

ERPNext: v15.32.1 (version-15)
Frappe Framework: v15.30.0 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",selva1-web,2024-11-28 06:53:18+00:00,[],2025-01-28 00:10:13+00:00,2025-01-13 10:06:02+00:00,https://github.com/frappe/erpnext/issues/44401,"[('bug', None)]","[{'comment_id': 2509021024, 'issue_id': 2701047615, 'author': 'rohitwaghchaure', 'body': '@selva1-web have you done customization?', 'created_at': datetime.datetime(2024, 11, 30, 16, 13, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2586677648, 'issue_id': 2701047615, 'author': 'nabinhait', 'body': ""Can't replicate it. If you can replicate it, please reopen the issue with steps to replicate."", 'created_at': datetime.datetime(2025, 1, 13, 10, 6, 2, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure on (2024-11-30 16:13:24 UTC): @selva1-web have you done customization?

nabinhait on (2025-01-13 10:06:02 UTC): Can't replicate it. If you can replicate it, please reopen the issue with steps to replicate.

"
2697920316,issue,closed,completed,Renaming of Prospect not possible.,"### Information about bug

![image](https://github.com/user-attachments/assets/5d6826d2-2900-442c-91ca-02d7ade10873)
If I try to rename the Prospect name, it says saved, but the name stays same

### Module

CRM

### Version

ERPNext: v15.38.0 (version-15)
Frappe Framework: v15.43.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",robinvolz96,2024-11-27 09:53:21+00:00,[],2024-12-17 00:11:16+00:00,2024-12-02 06:28:25+00:00,https://github.com/frappe/erpnext/issues/44381,"[('bug', None)]","[{'comment_id': 2510683249, 'issue_id': 2697920316, 'author': 'Nihantra-Patel', 'body': ""Because allow rename is not enabled, you can't rename the id.\r\n\r\n![image](https://github.com/user-attachments/assets/b49e723c-ef59-4089-b116-0d910e04bf27)\r\n\r\n\r\nIf you want to enable the allow rename then you have to use the property setter and enable it. you can find the reference in the [frappe forum](https://discuss.frappe.io)"", 'created_at': datetime.datetime(2024, 12, 2, 6, 28, 25, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-12-02 06:28:25 UTC): Because allow rename is not enabled, you can't rename the id.

![image](https://github.com/user-attachments/assets/b49e723c-ef59-4089-b116-0d910e04bf27)


If you want to enable the allow rename then you have to use the property setter and enable it. you can find the reference in the [frappe forum](https://discuss.frappe.io)

"
2697402268,issue,open,,Direct Print : POS,"We would like to request to implement Direct Print at POS after submitting 'Complete Order'.
For POS, we need to be fast avoided queuing long time.
currently, we need to go click print receipt
![image](https://github.com/user-attachments/assets/d50f8ec3-208e-48bb-b24e-0d505ccb3872)
",thida-bcn,2024-11-27 07:10:56+00:00,[],2024-12-21 10:45:08+00:00,,https://github.com/frappe/erpnext/issues/44375,"[('feature-request', None)]","[{'comment_id': 2558080601, 'issue_id': 2697402268, 'author': 'shakeelviam', 'body': 'If you are using Google Chrome you can add kiosk mode to it and it will print directly without the print dialogue. Google and see how you can activate Kiosk mode for Google Chrome', 'created_at': datetime.datetime(2024, 12, 21, 10, 45, 7, tzinfo=datetime.timezone.utc)}]","shakeelviam on (2024-12-21 10:45:07 UTC): If you are using Google Chrome you can add kiosk mode to it and it will print directly without the print dialogue. Google and see how you can activate Kiosk mode for Google Chrome

"
2697292435,issue,closed,completed,Server Script it't not working,"### Information about bug

I'm experiencing an issue where server scripts are not executing as expected in ERPNext v15. Specifically, I've created a simple server script that is intended to run on the Customer doctype with the After Insert event, but the script doesn't appear to trigger at all. I've verified the script setup and also attempted different document types and events, but none seem to work.

Environment:

ERPNext Version: 15.43.3
Frappe Version: v15.48.1

Steps to Reproduce:

Go to Settings > Server Script and create a new server script.
Script Type: Document Event
Reference Document Type: Customer
Event: After Insert

Script:
python
Copy code
```
def create_project_and_tasks(doc, method):
    frappe.log_error(title=""Server Script Trigger Test"", message=f""Server script has been triggered for the document: {doc.name}"")
    frappe.throw(""Server script triggered successfully."")
```
Save the script and ensure it is Active.
Create a new Customer from the Customer doctype.
Expected Behavior:

When a new customer is created, the server script should:
Log an entry in the Error Log with the title ""Server Script Trigger Test"".
Raise an error saying ""Server script triggered successfully.""

Actual Behavior:

No log entries are created in the Error Log.
No pop-up error is displayed after saving the customer.
It appears that the server script is not being triggered at all.
Additional Details:

I have verified that the server script feature is enabled in the site_config.json with ""server_script_enabled"": true.
I have also tried other document types (e.g., Sales Order) and different events (Before Insert, Before Save).
Client scripts are working fine, and I can confirm that client-side execution triggers as expected.
I tried restarting the bench and verified that the script is active and permissions are appropriate, but still no luck.
No relevant logs or errors appear in the Error Log or in the bench console when running the server script.

Steps Taken for Troubleshooting:

Restarted ERPNext services using bench restart.
Ensured that the server script feature is enabled.
Tested on different doctypes and events.
Verified user permissions and logged in as an administrator.
Monitored the bench console but didn't observe any related errors or logs.


### Module

selling, other

### Version

ERPNext Version: 15.43.3
Frappe Version: v15.48.1

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",yahyaoudra,2024-11-27 06:36:36+00:00,[],2024-12-25 00:10:24+00:00,2024-11-28 07:09:01+00:00,https://github.com/frappe/erpnext/issues/44374,"[('bug', None)]","[{'comment_id': 2505401422, 'issue_id': 2697292435, 'author': 'Nihantra-Patel', 'body': ""We tested it locally and also in the frappe cloud side in that version so it's worked properly. if you use server script doctype then no need to add method and import package or library.\r\n\r\n[scrnli_fXen4q499Z11Yb.webm](https://github.com/user-attachments/assets/94bf3b2a-2249-4c90-9962-c14422ea6ce5)"", 'created_at': datetime.datetime(2024, 11, 28, 7, 9, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2530118625, 'issue_id': 2697292435, 'author': 'yahyaoudra', 'body': 'Hi there,\r\nthanks For reply.I see\r\nbut on my side your script worked \r\nwhat\'s wrong with mine here please\r\n\r\n`def create_default_project(doc, method):\r\n    if not doc or not doc.name:\r\n        frappe.log_error(""Invalid customer document"")\r\n        return\r\n    \r\n    try:\r\n        frappe.log_error(f""Attempting to create project for customer: {doc.name}"")\r\n        \r\n        project = frappe.new_doc(\'Project\')\r\n        \r\n        frappe.log_error(f""New project document created: {project}"")\r\n        \r\n        project.project_name = f""Project for {doc.customer_name}""\r\n        \r\n        project.customer = doc.name\r\n        \r\n        project.status = \'Open\'\r\n        \r\n        try:\r\n            project.save(ignore_permissions=True)\r\n            frappe.log_error(f""Project saved successfully for {doc.customer_name}"")\r\n        except Exception as save_error:\r\n            frappe.log_error(f""Error saving project: {str(save_error)}"")\r\n            frappe.log_error(f""Project document details: {project.as_dict()}"")\r\n            raise\r\n        \r\n        frappe.msgprint(f""Created default project for {doc.customer_name}"")\r\n    \r\n    except Exception as e:\r\n        frappe.log_error(f""Complete error creating project for {doc.customer_name}"")\r\n        frappe.log_error(f""Error details: {str(e)}"")\r\n        frappe.log_error(f""Customer document: {doc.as_dict()}"")\r\n        frappe.throw(f""Could not create project: {str(e)}"")\r\n\r\ndef execute(doc, method):\r\n    create_default_project(doc, method)\r\n\r\ndef on_update(doc, method):\r\n    create_default_project(doc, method)`', 'created_at': datetime.datetime(2024, 12, 10, 2, 50, 2, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-28 07:09:01 UTC): We tested it locally and also in the frappe cloud side in that version so it's worked properly. if you use server script doctype then no need to add method and import package or library.

[scrnli_fXen4q499Z11Yb.webm](https://github.com/user-attachments/assets/94bf3b2a-2249-4c90-9962-c14422ea6ce5)

yahyaoudra (Issue Creator) on (2024-12-10 02:50:02 UTC): Hi there,
thanks For reply.I see
but on my side your script worked 
what's wrong with mine here please

`def create_default_project(doc, method):
    if not doc or not doc.name:
        frappe.log_error(""Invalid customer document"")
        return
    
    try:
        frappe.log_error(f""Attempting to create project for customer: {doc.name}"")
        
        project = frappe.new_doc('Project')
        
        frappe.log_error(f""New project document created: {project}"")
        
        project.project_name = f""Project for {doc.customer_name}""
        
        project.customer = doc.name
        
        project.status = 'Open'
        
        try:
            project.save(ignore_permissions=True)
            frappe.log_error(f""Project saved successfully for {doc.customer_name}"")
        except Exception as save_error:
            frappe.log_error(f""Error saving project: {str(save_error)}"")
            frappe.log_error(f""Project document details: {project.as_dict()}"")
            raise
        
        frappe.msgprint(f""Created default project for {doc.customer_name}"")
    
    except Exception as e:
        frappe.log_error(f""Complete error creating project for {doc.customer_name}"")
        frappe.log_error(f""Error details: {str(e)}"")
        frappe.log_error(f""Customer document: {doc.as_dict()}"")
        frappe.throw(f""Could not create project: {str(e)}"")

def execute(doc, method):
    create_default_project(doc, method)

def on_update(doc, method):
    create_default_project(doc, method)`

"
2697076184,issue,closed,completed,`current_invoice_start` is wrong,"### Information about bug

Step to reproduce:

1. Create a new subscription with trial period and the current date need to be in the trial period. And choose `start_date` after the `trial_end`
![image](https://github.com/user-attachments/assets/e854491e-e639-4a6a-bcc4-8b6c999d3381)

2. Save.
![image](https://github.com/user-attachments/assets/d995cd53-a857-466d-a4ca-2b172c7844e4)

As you can see, the `current_invoice_start` is `trial_period_start` which is wrong and should be the `start_date`.

So,

[1] https://github.com/frappe/erpnext/blob/123e3ef263cdf36101064fa999180425204b9963/erpnext/accounts/doctype/subscription/subscription.py#L119-L120


[2] https://github.com/frappe/erpnext/blob/123e3ef263cdf36101064fa999180425204b9963/erpnext/accounts/doctype/subscription/subscription.py#L117-L118

[1] should be honored before [2].

### Module

accounts

### Version

Frappe version: v14.77.2
ERPNext version: v14.86.0

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",kurogeek,2024-11-27 04:46:27+00:00,['diptanilsaha'],2025-02-04 00:10:16+00:00,2025-01-20 11:36:03+00:00,https://github.com/frappe/erpnext/issues/44371,"[('bug', None)]",[],
2694588488,issue,closed,completed,Error on Data Import with Tree Structure,"### Information about bug

In V15 data import I cannot import any doctype with tree structure
It always complain about not having Parent column is not exists
I already arrange the rows in hierarchical order so the parent goes to the top, and their children in lower position
Meanwhile I have to import each hierarchy using separate excel, it almost like entering it manually especially when the levels are many

### Module

stock

### Version

v15

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```
Import File Errors and Warnings
Column 2 (Parent Item Group)
The following values do not exist for Item Group: 
```",auliabismar,2024-11-26 13:02:53+00:00,[],2025-01-29 00:10:04+00:00,2025-01-14 11:19:29+00:00,https://github.com/frappe/erpnext/issues/44356,"[('bug', None)]","[{'comment_id': 2589652866, 'issue_id': 2694588488, 'author': 'nabinhait', 'body': 'The system already provides a root item group called ""All Item Groups"", you need to set it as a parent item group for your root level records.\r\nSimilarly, the system provides one root record for every tree view document.\r\nIf you are creating a custom tree view document, you need to create one root record from the backend (using code) using `ignore_mandatory` flag.', 'created_at': datetime.datetime(2025, 1, 14, 11, 19, 29, tzinfo=datetime.timezone.utc)}]","nabinhait on (2025-01-14 11:19:29 UTC): The system already provides a root item group called ""All Item Groups"", you need to set it as a parent item group for your root level records.
Similarly, the system provides one root record for every tree view document.
If you are creating a custom tree view document, you need to create one root record from the backend (using code) using `ignore_mandatory` flag.

"
2694582248,issue,closed,completed,Duplicate entry for delivery note return,"### Information about bug

When returning a delivery note, the following error shows up:
```
pymysql.err.IntegrityError: (1062, ""Duplicate entry 'GAT-02-0010' for key 'PRIMARY'"")
Possible source of error: erpnext (app)
```

We are using ERPNext since 2021, maybe some bad entries in the database of previous versions?

Ledge view of given serial number:

![Screenshot 2024-11-26 at 13 59 52](https://github.com/user-attachments/assets/606b55f3-9131-4e64-b92f-208b0f8bb71c)


### Module

stock

### Version

ERPNext: v15.43.3 (version-15)
Frappe Framework: v15.48.0 (version-15)

### Installation method

easy-install

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback with variables (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
      request = <Request 'https://example.com/api/method/frappe.desk.form.save.savedocs' [POST]>
      response = None
      rollback = True
      e = IntegrityError(1062, ""Duplicate entry 'GAT-02-0010' for key 'PRIMARY'"")
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
      request = <Request 'https://example.com/api/method/frappe.desk.form.save.savedocs' [POST]>
      endpoint = <function handle_rpc_call at 0x7f8ceddecc10>
      arguments = {'method': 'frappe.desk.form.save.savedocs'}
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
      method = 'frappe.desk.form.save.savedocs'
      frappe = <module 'frappe' from 'apps/frappe/frappe/__init__.py'>
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
      cmd = 'frappe.desk.form.save.savedocs'
      data = None
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
      cmd = 'frappe.desk.form.save.savedocs'
      from_async = False
      server_script = None
      method = <function savedocs at 0x7f8cebcc72e0>
  File ""apps/frappe/frappe/__init__.py"", line 1725, in call
    return fn(*args, **newargs)
      fn = <function savedocs at 0x7f8cebcc72e0>
      args = ()
      kwargs = {'doc': '{""name"":""MAT-DN-2024-00297"",""owner"":""test@example.com"",""creation"":""2024-11-26 13:40:20.857752"",""modified"":""2024-11-26 13:40:20.857752"",""modified_by"":""test@example.com"",""docstatus"":0,""idx"":38,""title"":""Test Customer"",""naming_series"":""MAT-DN-.YYYY.-"",""customer"":""Test Customer"",""customer_name"":""Test Customer"",""posting_date"":""2024-11-26"",""posting_time"":""13:40:20.933920"",""set_posting_time"":0,""company"":""Test GmbH"",""is_return"":1,""issue_credit_note"":0,""return_against"":""MAT-DN-2024-00263"",""currency"":""EUR"",""conversion_rate"":1,""selling_price_list"":""Standard Selling"",""price_list_currency"":""EUR"",""plc_conversion_rate"":1,""ignore_pricing_rule"":1,""total_qty"":-6,""total_net_weight"":0,""base_total"":-6450,""base_net_total"":-6450,""total"":-6450,""net_total"":-6450,""tax_category"":"""",""base_total_taxes_and_charges"":0,""total_taxes_and_charges"":0,""base_grand_total"":-6450,""base_rounding_adjustment"":0,""base_rounded_total"":0,""base_in_words"":"""",""grand_total"":-6450,""rounding_adjustment"":0,""rounded_...
      newargs = {'doc': '{""name"":""MAT-DN-2024-00297"",""owner"":""test@example.com"",""creation"":""2024-11-26 13:40:20.857752"",""modified"":""2024-11-26 13:40:20.857752"",""modified_by"":""test@example.com"",""docstatus"":0,""idx"":38,""title"":""Test Customer"",""naming_series"":""MAT-DN-.YYYY.-"",""customer"":""Test Customer"",""customer_name"":""Test Customer"",""posting_date"":""2024-11-26"",""posting_time"":""13:40:20.933920"",""set_posting_time"":0,""company"":""Test GmbH"",""is_return"":1,""issue_credit_note"":0,""return_against"":""MAT-DN-2024-00263"",""currency"":""EUR"",""conversion_rate"":1,""selling_price_list"":""Standard Selling"",""price_list_currency"":""EUR"",""plc_conversion_rate"":1,""ignore_pricing_rule"":1,""total_qty"":-6,""total_net_weight"":0,""base_total"":-6450,""base_net_total"":-6450,""total"":-6450,""net_total"":-6450,""tax_category"":"""",""base_total_taxes_and_charges"":0,""total_taxes_and_charges"":0,""base_grand_total"":-6450,""base_rounding_adjustment"":0,""base_rounded_total"":0,""base_in_words"":"""",""grand_total"":-6450,""rounding_adjustment"":0,""rounded_...
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
      args = ()
      kwargs = {'doc': '{""name"":""MAT-DN-2024-00297"",""owner"":""test@example.com"",""creation"":""2024-11-26 13:40:20.857752"",""modified"":""2024-11-26 13:40:20.857752"",""modified_by"":""test@example.com"",""docstatus"":0,""idx"":38,""title"":""Test Customer"",""naming_series"":""MAT-DN-.YYYY.-"",""customer"":""Test Customer"",""customer_name"":""Test Customer"",""posting_date"":""2024-11-26"",""posting_time"":""13:40:20.933920"",""set_posting_time"":0,""company"":""Test GmbH"",""is_return"":1,""issue_credit_note"":0,""return_against"":""MAT-DN-2024-00263"",""currency"":""EUR"",""conversion_rate"":1,""selling_price_list"":""Standard Selling"",""price_list_currency"":""EUR"",""plc_conversion_rate"":1,""ignore_pricing_rule"":1,""total_qty"":-6,""total_net_weight"":0,""base_total"":-6450,""base_net_total"":-6450,""total"":-6450,""net_total"":-6450,""tax_category"":"""",""base_total_taxes_and_charges"":0,""total_taxes_and_charges"":0,""base_grand_total"":-6450,""base_rounding_adjustment"":0,""base_rounded_total"":0,""base_in_words"":"""",""grand_total"":-6450,""rounding_adjustment"":0,""rounded_...
      apply_condition = <function whitelist.<locals>.innerfn.<locals>.<lambda> at 0x7f8cebcc7250>
      func = <function savedocs at 0x7f8cebcc71c0>
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
      doc = <DeliveryNote: MAT-DN-2024-00297>
      action = 'Save'
  File ""apps/frappe/frappe/model/document.py"", line 341, in save
    return self._save(*args, **kwargs)
      self = <DeliveryNote: MAT-DN-2024-00297>
      args = ()
      kwargs = {}
  File ""apps/frappe/frappe/model/document.py"", line 377, in _save
    self.run_before_save_methods()
      self = <DeliveryNote: MAT-DN-2024-00297>
      ignore_permissions = None
      ignore_version = None
  File ""apps/frappe/frappe/model/document.py"", line 1095, in run_before_save_methods
    self.run_method(""validate"")
      self = <DeliveryNote: MAT-DN-2024-00297>
  File ""apps/frappe/frappe/model/document.py"", line 966, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
      self = <DeliveryNote: MAT-DN-2024-00297>
      args = ()
      kwargs = {}
      fn = <function Document.run_method.<locals>.fn at 0x7f8cea047400>
      method = 'validate'
  File ""apps/frappe/frappe/model/document.py"", line 1326, in composer
    return composed(self, method, *args, **kwargs)
      self = <DeliveryNote: MAT-DN-2024-00297>
      args = ()
      kwargs = {}
      hooks = [<function validate_accounting_period_on_doc_save at 0x7f8ceb1ef910>, <function apply at 0x7f8ceac69ab0>, <function check_for_running_deletion_job at 0x7f8ceac6b640>]
      method = 'validate'
      doc_events = {'*': {'on_update': ['frappe.desk.notifications.clear_doctype_notifications', 'frappe.workflow.doctype.workflow_action.workflow_action.process_workflow_actions', 'frappe.core.doctype.file.utils.attach_files_to_document', 'frappe.automation.doctype.assignment_rule.assignment_rule.apply', 'frappe.automation.doctype.assignment_rule.assignment_rule.update_due_date', 'frappe.core.doctype.user_type.user_type.apply_permissions_for_non_standard_user_type'], 'after_rename': ['frappe.desk.notifications.clear_doctype_notifications'], 'on_cancel': ['frappe.desk.notifications.clear_doctype_notifications', 'frappe.workflow.doctype.workflow_action.workflow_action.process_workflow_actions', 'frappe.automation.doctype.assignment_rule.assignment_rule.apply'], 'on_trash': ['frappe.desk.notifications.clear_doctype_notifications', 'frappe.workflow.doctype.workflow_action.workflow_action.process_workflow_actions'], 'on_update_after_submit': ['frappe.workflow.doctype.workflow_action.workflow_action.process_w...
      handler = 'erpnext.setup.doctype.transaction_deletion_record.transaction_deletion_record.check_for_running_deletion_job'
      composed = <function Document.hook.<locals>.compose.<locals>.runner at 0x7f8cea046ef0>
      compose = <function Document.hook.<locals>.compose at 0x7f8cea046f80>
      f = <function Document.run_method.<locals>.fn at 0x7f8cea047400>
  File ""apps/frappe/frappe/model/document.py"", line 1308, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
      self = <DeliveryNote: MAT-DN-2024-00297>
      method = 'validate'
      args = ()
      kwargs = {}
      add_to_return_value = <function Document.hook.<locals>.add_to_return_value at 0x7f8cea046e60>
      fn = <function Document.run_method.<locals>.fn at 0x7f8cea047400>
      hooks = (<function validate_accounting_period_on_doc_save at 0x7f8ceb1ef910>, <function apply at 0x7f8ceac69ab0>, <function check_for_running_deletion_job at 0x7f8ceac6b640>)
  File ""apps/frappe/frappe/model/document.py"", line 963, in fn
    return method_object(*args, **kwargs)
      self = <DeliveryNote: MAT-DN-2024-00297>
      args = ()
      kwargs = {}
      method_object = <bound method DeliveryNote.validate of <DeliveryNote: MAT-DN-2024-00297>>
      method = 'validate'
  File ""apps/erpnext/erpnext/stock/doctype/delivery_note/delivery_note.py"", line 261, in validate
    self.validate_warehouse()
      self = <DeliveryNote: MAT-DN-2024-00297>
      __class__ = <class 'erpnext.stock.doctype.delivery_note.delivery_note.DeliveryNote'>
  File ""apps/erpnext/erpnext/stock/doctype/delivery_note/delivery_note.py"", line 410, in validate_warehouse
    for d in self.get_item_list():
      self = <DeliveryNote: MAT-DN-2024-00297>
      __class__ = <class 'erpnext.stock.doctype.delivery_note.delivery_note.DeliveryNote'>
  File ""apps/erpnext/erpnext/controllers/selling_controller.py"", line 336, in get_item_list
    or get_serial_and_batch_bundle(p, self),
      self = <DeliveryNote: MAT-DN-2024-00297>
      il = [{'warehouse': 'Demo Products - LY', 'item_code': 'TST-BBACK', 'qty': -1.0, 'serial_no': None, 'batch_no': None, 'uom': 'Unit', 'serial_and_batch_bundle': None, 'name': 's2emamakkb', 'target_warehouse': None, 'company': 'Test GmbH', 'voucher_type': 'Delivery Note', 'allow_zero_valuation': 0, 'sales_invoice_item': None, 'dn_detail': 'g2q0pl59p2', 'incoming_rate': 117.0, 'item_row': <PackedItem: 21n2ekra4r parent=MAT-DN-2024-00297>}, {'warehouse': 'Demo Products - LY', 'item_code': 'TST-CRO', 'qty': -2.0, 'serial_no': None, 'batch_no': None, 'uom': 'Unit', 'serial_and_batch_bundle': 'SABB-00000821', 'name': 's2emamakkb', 'target_warehouse': None, 'company': 'Test GmbH', 'voucher_type': 'Delivery Note', 'allow_zero_valuation': 0, 'sales_invoice_item': None, 'dn_detail': 'g2q0pl59p2', 'incoming_rate': 1026.31, 'item_row': <PackedItem: hrflvftbd5 parent=MAT-DN-2024-00297>}]
      d = <DeliveryNoteItem: s2emamakkb parent=MAT-DN-2024-00297>
      p = <PackedItem: 1gih43qe6k parent=MAT-DN-2024-00297>
  File ""apps/erpnext/erpnext/controllers/selling_controller.py"", line 802, in get_serial_and_batch_bundle
    doc = sn_doc.make_serial_and_batch_bundle()
      child = <PackedItem: 1gih43qe6k parent=MAT-DN-2024-00297>
      parent = <DeliveryNote: MAT-DN-2024-00297>
      SerialBatchCreation = <class 'erpnext.stock.serial_batch_bundle.SerialBatchCreation'>
      item_details = {'has_serial_no': 1, 'has_batch_no': 0}
      sn_doc = <erpnext.stock.serial_batch_bundle.SerialBatchCreation object at 0x7f8cea6ad270>
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 933, in make_serial_and_batch_bundle
    self.set_auto_serial_batch_entries_for_inward()
      self = <erpnext.stock.serial_batch_bundle.SerialBatchCreation object at 0x7f8cea6ad270>
      doc = <SerialandBatchBundle: unsaved>
      valid_columns = ['name', 'owner', 'creation', 'modified', 'modified_by', 'docstatus', 'idx', 'naming_series', 'company', 'item_name', 'has_serial_no', 'has_batch_no', 'item_code', 'warehouse', 'type_of_transaction', 'total_qty', 'item_group', 'avg_rate', 'total_amount', 'voucher_type', 'voucher_no', 'voucher_detail_no', 'posting_date', 'posting_time', 'returned_against', 'is_cancelled', 'is_rejected', 'amended_from']
      key = ********
      value = 0
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 1035, in set_auto_serial_batch_entries_for_inward
    self.serial_nos = self.get_auto_created_serial_nos()
      self = <erpnext.stock.serial_batch_bundle.SerialBatchCreation object at 0x7f8cea6ad270>
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 1212, in get_auto_created_serial_nos
    frappe.db.bulk_insert(""Serial No"", fields=fields, values=set(serial_nos_details))
      self = <erpnext.stock.serial_batch_bundle.SerialBatchCreation object at 0x7f8cea6ad270>
      sr_nos = ['GAT-02-0010']
      serial_nos_details = [('GAT-02-0010', 'GAT-02-0010', '2024-11-26 13:42:02.298938', '2024-11-26 13:42:02.299014', 'test@example.com', 'test@example.com', 'Demo Products - LY', 'Test GmbH', 'TST-GAT', 'Startschranke', 'Startschranke', 'Active', 'MAT-DN-2024-00297', None)]
      voucher_no = 'MAT-DN-2024-00297'
      _i = 0
      serial_no = 'GAT-02-0010'
      fields = ['name', 'serial_no', 'creation', 'modified', 'owner', 'modified_by', 'warehouse', 'company', 'item_code', 'item_name', 'description', 'status', 'purchase_document_no', 'batch_no']
  File ""apps/frappe/frappe/database/database.py"", line 1338, in bulk_insert
    query.insert(*value_chunk).run()
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8cea517580>
      doctype = 'Serial No'
      fields = ['name', 'serial_no', 'creation', 'modified', 'owner', 'modified_by', 'warehouse', 'company', 'item_code', 'item_name', 'description', 'status', 'purchase_document_no', 'batch_no']
      values = {('GAT-02-0010', 'GAT-02-0010', '2024-11-26 13:42:02.298938', '2024-11-26 13:42:02.299014', 'test@example.com', 'test@example.com', 'Demo Products - LY', 'Test GmbH', 'TST-GAT', 'Startschranke', 'Startschranke', 'Active', 'MAT-DN-2024-00297', None)}
      ignore_duplicates = False
      chunk_size = 10000
      table = Table('tabSerial No')
      query = 
      value_iterator = <set_iterator object at 0x7f8cea5e2940>
      value_chunk = (('GAT-02-0010', 'GAT-02-0010', '2024-11-26 13:42:02.298938', '2024-11-26 13:42:02.299014', 'test@example.com', 'test@example.com', 'Demo Products - LY', 'Test GmbH', 'TST-GAT', 'Startschranke', 'Startschranke', 'Active', 'MAT-DN-2024-00297', None),)
  File ""apps/frappe/frappe/query_builder/utils.py"", line 87, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'INSERT INTO `tabSerial No` (`name`,`serial_no`,`creation`,`modified`,`owner`,`modified_by`,`warehouse`,`company`,`item_code`,`item_name`,`description`,`status`,`purchase_document_no`,`batch_no`) VALUES (%(param1)s,%(param2)s,%(param3)s,%(param4)s,%(param5)s,%(param6)s,%(param7)s,%(param8)s,%(param9)s,%(param10)s,%(param11)s,%(param12)s,%(param13)s,NULL)'
      args = ()
      kwargs = {}
      child_queries = []
      params = {'param1': 'GAT-02-0010', 'param2': 'GAT-02-0010', 'param3': '2024-11-26 13:42:02.298938', 'param4': '2024-11-26 13:42:02.299014', 'param5': 'test@example.com', 'param6': 'test@example.com', 'param7': 'Demo Products - LY', 'param8': 'Test GmbH', 'param9': 'TST-GAT', 'param10': 'Startschranke', 'param11': 'Startschranke', 'param12': 'Active', 'param13': 'MAT-DN-2024-00297'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x7f8cea691510>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7f8cea691b40>
  File ""apps/frappe/frappe/database/database.py"", line 229, in sql
    self._cursor.execute(query, values)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f8cea517580>
      query = 'INSERT INTO `tabSerial No` (`name`,`serial_no`,`creation`,`modified`,`owner`,`modified_by`,`warehouse`,`company`,`item_code`,`item_name`,`description`,`status`,`purchase_document_no`,`batch_no`) VALUES (%(param1)s,%(param2)s,%(param3)s,%(param4)s,%(param5)s,%(param6)s,%(param7)s,%(param8)s,%(param9)s,%(param10)s,%(param11)s,%(param12)s,%(param13)s,NULL)'
      values = {'param1': 'GAT-02-0010', 'param2': 'GAT-02-0010', 'param3': '2024-11-26 13:42:02.298938', 'param4': '2024-11-26 13:42:02.299014', 'param5': 'test@example.com', 'param6': 'test@example.com', 'param7': 'Demo Products - LY', 'param8': 'Test GmbH', 'param9': 'TST-GAT', 'param10': 'Startschranke', 'param11': 'Startschranke', 'param12': 'Active', 'param13': 'MAT-DN-2024-00297'}
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = False
      as_iterator = False
      trace_id = None
  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 153, in execute
    result = self._query(query)
      self = <pymysql.cursors.Cursor object at 0x7f8cea449780>
      query = ""INSERT INTO `tabSerial No` (`name`,`serial_no`,`creation`,`modified`,`owner`,`modified_by`,`warehouse`,`company`,`item_code`,`item_name`,`description`,`status`,`purchase_document_no`,`batch_no`) VALUES ('GAT-02-0010','GAT-02-0010','2024-11-26 13:42:02.298938','2024-11-26 13:42:02.299014','test@example.com','test@example.com','Demo Products - LY','Test GmbH','TST-GAT','Startschranke','Startschranke','Active','MAT-DN-2024-00297',NULL)""
      args = {'param1': 'GAT-02-0010', 'param2': 'GAT-02-0010', 'param3': '2024-11-26 13:42:02.298938', 'param4': '2024-11-26 13:42:02.299014', 'param5': 'test@example.com', 'param6': 'test@example.com', 'param7': 'Demo Products - LY', 'param8': 'Test GmbH', 'param9': 'TST-GAT', 'param10': 'Startschranke', 'param11': 'Startschranke', 'param12': 'Active', 'param13': 'MAT-DN-2024-00297'}
  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 322, in _query
    conn.query(q)
      self = <pymysql.cursors.Cursor object at 0x7f8cea449780>
      q = ""INSERT INTO `tabSerial No` (`name`,`serial_no`,`creation`,`modified`,`owner`,`modified_by`,`warehouse`,`company`,`item_code`,`item_name`,`description`,`status`,`purchase_document_no`,`batch_no`) VALUES ('GAT-02-0010','GAT-02-0010','2024-11-26 13:42:02.298938','2024-11-26 13:42:02.299014','test@example.com','test@example.com','Demo Products - LY','Test GmbH','TST-GAT','Startschranke','Startschranke','Active','MAT-DN-2024-00297',NULL)""
      conn = <pymysql.connections.Connection object at 0x7f8cea44aef0>
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
      self = <pymysql.connections.Connection object at 0x7f8cea44aef0>
      sql = b""INSERT INTO `tabSerial No` (`name`,`serial_no`,`creation`,`modified`,`owner`,`modified_by`,`warehouse`,`company`,`item_code`,`item_name`,`description`,`status`,`purchase_document_no`,`batch_no`) VALUES ('GAT-02-0010','GAT-02-0010','2024-11-26 13:42:02.298938','2024-11-26 13:42:02.299014','test@example.com','test@example.com','Demo Products - LY','Test GmbH','TST-GAT','Startschranke','Startschranke','Active','MAT-DN-2024-00297',NULL)""
      unbuffered = False
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 825, in _read_query_result
    result.read()
      self = <pymysql.connections.Connection object at 0x7f8cea44aef0>
      unbuffered = False
      result = <pymysql.connections.MySQLResult object at 0x7f8cea653340>
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 1199, in read
    first_packet = self.connection._read_packet()
      self = <pymysql.connections.MySQLResult object at 0x7f8cea653340>
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 775, in _read_packet
    packet.raise_for_error()
      self = <pymysql.connections.Connection object at 0x7f8cea44aef0>
      packet_type = <class 'pymysql.protocol.MysqlPacket'>
      buff = bytearray(b""\xff&\x04#23000Duplicate entry \'GAT-02-0010\' for key \'PRIMARY\'"")
      packet_header = b'8\x00\x00\x01'
      btrl = 56
      btrh = 0
      packet_number = 1
      bytes_to_read = 56
      recv_data = b""\xff&\x04#23000Duplicate entry 'GAT-02-0010' for key 'PRIMARY'""
      packet = <pymysql.protocol.MysqlPacket object at 0x7f8cea651600>
  File ""env/lib/python3.10/site-packages/pymysql/protocol.py"", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
      self = <pymysql.protocol.MysqlPacket object at 0x7f8cea651600>
      errno = 1062
  File ""env/lib/python3.10/site-packages/pymysql/err.py"", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
      data = b""\xff&\x04#23000Duplicate entry 'GAT-02-0010' for key 'PRIMARY'""
      errno = 1062
      errval = ""Duplicate entry 'GAT-02-0010' for key 'PRIMARY'""
      errorclass = <class 'pymysql.err.IntegrityError'>
pymysql.err.IntegrityError: (1062, ""Duplicate entry 'GAT-02-0010' for key 'PRIMARY'"")
```
",perotom,2024-11-26 13:00:24+00:00,[],2024-12-25 00:10:22+00:00,2024-12-02 06:33:09+00:00,https://github.com/frappe/erpnext/issues/44355,"[('bug', None)]","[{'comment_id': 2510689599, 'issue_id': 2694582248, 'author': 'Nihantra-Patel', 'body': 'First, this is not a bug. If you have any doubts, you can raise an issue or start a discussion on the [[Frappe Forum](https://discuss.frappe.io/)](https://discuss.frappe.io/).\r\n\r\nFirst, find the duplicate entry, remove it, and then check again. We tested it on a fresh database, an old migrated version, and the latest version, but we did not find any issues.', 'created_at': datetime.datetime(2024, 12, 2, 6, 33, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2530805434, 'issue_id': 2694582248, 'author': 'perotom', 'body': 'To solve this problem one have to delete the serial number from the database:\r\n```\r\nDELETE FROM `tabSerial No` WHERE serial_no = ""XXXXXXX""\r\n```', 'created_at': datetime.datetime(2024, 12, 10, 8, 36, 35, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-12-02 06:33:09 UTC): First, this is not a bug. If you have any doubts, you can raise an issue or start a discussion on the [[Frappe Forum](https://discuss.frappe.io/)](https://discuss.frappe.io/).

First, find the duplicate entry, remove it, and then check again. We tested it on a fresh database, an old migrated version, and the latest version, but we did not find any issues.

perotom (Issue Creator) on (2024-12-10 08:36:35 UTC): To solve this problem one have to delete the serial number from the database:
```
DELETE FROM `tabSerial No` WHERE serial_no = ""XXXXXXX""
```

"
2694510849,issue,closed,completed,Accounts Receivable Summary Report (Customer Aging Report) having values in seperated days section is not correct for eg. 1 - 30 column values is not correct and many more,"### Information about bug

The Accounts Receivable Summary Report is not working correctly,
In this report only outstanding column data is  correct
And all the days seperated column is not correct
for eg. 0-30 days, 31-60 days, ............. etc.
**I want all values in these column calculated correctly**

### Module

accounts

### Version

I dont know the version but iam using this link for my application
http://35.170.104.156/#login

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",alaaelshamy,2024-11-26 12:33:08+00:00,['ruthra-kumar'],2024-12-19 00:11:02+00:00,2024-12-04 08:59:32+00:00,https://github.com/frappe/erpnext/issues/44352,"[('bug', None)]","[{'comment_id': 2516608696, 'issue_id': 2694510849, 'author': 'ruthra-kumar', 'body': ""@alaaelshamy \r\n\r\nit looks like you are using ERPNext v12, which reached it's [EOL on Dec 2022](https://github.com/frappe/erpnext/wiki/Supported-Versions). \r\n\r\nYou can check https://discuss.frappe.io/ for community support."", 'created_at': datetime.datetime(2024, 12, 4, 8, 59, 32, tzinfo=datetime.timezone.utc)}]","ruthra-kumar (Assginee) on (2024-12-04 08:59:32 UTC): @alaaelshamy 

it looks like you are using ERPNext v12, which reached it's [EOL on Dec 2022](https://github.com/frappe/erpnext/wiki/Supported-Versions). 

You can check https://discuss.frappe.io/ for community support.

"
2694370496,issue,closed,completed,Project template : expected dates not copied when creating project,"### Information about bug

I have set up some (template) tasks in Project Template, and I planned all the scheduling (start and end dates) in template tasks.


![image](https://github.com/user-attachments/assets/494610d2-4f30-4a57-a79c-fd3d56471999)
![image](https://github.com/user-attachments/assets/22971da3-df38-4dcc-946a-5bd1bf6709b9)

But,
When creating a project from Project Template, the project expected start and end dates don‚Äôt respect the Templates task dates. The newly created project has all tasks set to start and end today.

The following image show project scheduling of Template tasks:
![image](https://github.com/user-attachments/assets/4ae63f37-29b7-4115-a9e5-e400a55c283b)

But when I created a New Project the tasks copied from Project template do not take over the start/end dates.
![image](https://github.com/user-attachments/assets/dcc3672d-9ed5-4e8f-8ee9-01c684bae20b)

The code states otherwise, the dates must have been copied.

https://github.com/frappe/erpnext/blob/30f9b2b8060170471f327df68dfb9457696f58db/erpnext/projects/doctype/project/project.py#L129

![image](https://github.com/user-attachments/assets/2ddcf8bd-8154-4499-b3cc-e4b3aa78924c)


### Module

projects

### Version

![image](https://github.com/user-attachments/assets/17ed4675-a884-4f4e-8eb1-3b20a9b34877)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",anup-dh,2024-11-26 11:42:11+00:00,[],2025-01-30 00:10:06+00:00,2025-01-14 11:09:34+00:00,https://github.com/frappe/erpnext/issues/44348,"[('bug', None)]","[{'comment_id': 2589634391, 'issue_id': 2694370496, 'author': 'nabinhait', 'body': 'How can we define expected start and end dates in template tasks? As it\'s just a template, not a proper project, we don\'t know the dates yet.\r\nWhen we will create an actual project, the project will have an expected start date and based on that we can calculate the start and end dates of tasks. But to calculate that as well, you need to define ""Expected Hours"" in the template tasks.', 'created_at': datetime.datetime(2025, 1, 14, 11, 9, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2591775405, 'issue_id': 2694370496, 'author': 'anup-dh', 'body': 'Hello, Nice question.\n\n> How can we define expected start and end dates in template tasks?\n\nJust like the Payment schedule table/payment terms template. *I know this uses credit days to add to the current date and calculate payment schedule for each invoice.* \nThe same concept can be used to make the project module a little more robust. Please allow me to explain.\n\nIn Project template, we list out the tasks like this:\n\n![Image](https://github.com/user-attachments/assets/2dac07cf-cb2c-4a6a-99cb-afa706692cb5)\n\nFor each of these tasks, we set start and end dates. While setting dates, the first task will be set to today\'s date and subsequent tasks will be post dated based on expected work hours needed (for that ""type"" of project: we will can have different project templates for different types of projects). So, if I made a project template today, and checked the expected start dates 5 years later, it will still have today\'s date as expected start date. However, magic happens when creating a project.\n\n![Image](https://github.com/user-attachments/assets/0dabe27e-95e2-400c-86b1-6d8a8b2655cf)\n\n\nWhile creating a project, we have this field: Expected Start Date.\n\n![Image](https://github.com/user-attachments/assets/9bbaa8b8-2cef-4430-a5bc-01121a957eb0)\n\nLets assume a user creates a project today (Jan 15, 2025) and sets the Expected Start Date to 1.5 months later (assume March 1, 2025), and then selects a project template, the first task of that template (sorted by Expected start date) should be set to start at March 1 2025 and accordingly to other tasks. This way all new tasks created will maintain project timeline hierarchy. Else, all new tasks created will have this weird Gantt view which will provide no sense to project planning unless we intervene each tasks. Imagine doing this to all 20 new projects starting every month, each having more than 500 tasks. üó° üó° üó° \n\n![Image](https://github.com/user-attachments/assets/e17a8bbb-82bd-4e3b-b213-a3a1a283de8a)\n\nIf a project template looks this good, why not just copy this to each project starting with the template ?\n\n![Image](https://github.com/user-attachments/assets/e5f13710-666a-486d-9227-683f171751af)\n\n\nAlso what I am not able to understand is this line of code:\n\n![Image](https://github.com/user-attachments/assets/334fc57e-345a-47b3-b26c-031f0951e0d4)\n\nWhy put it there if it is doing nothing ?  If this one works:\n\n![Image](https://github.com/user-attachments/assets/3235d762-31fe-4d1c-8191-faf18d8bb626)\nwhy not the previous ??', 'created_at': datetime.datetime(2025, 1, 15, 6, 50, 36, tzinfo=datetime.timezone.utc)}]","nabinhait on (2025-01-14 11:09:34 UTC): How can we define expected start and end dates in template tasks? As it's just a template, not a proper project, we don't know the dates yet.
When we will create an actual project, the project will have an expected start date and based on that we can calculate the start and end dates of tasks. But to calculate that as well, you need to define ""Expected Hours"" in the template tasks.

anup-dh (Issue Creator) on (2025-01-15 06:50:36 UTC): Hello, Nice question.


Just like the Payment schedule table/payment terms template. *I know this uses credit days to add to the current date and calculate payment schedule for each invoice.* 
The same concept can be used to make the project module a little more robust. Please allow me to explain.

In Project template, we list out the tasks like this:

![Image](https://github.com/user-attachments/assets/2dac07cf-cb2c-4a6a-99cb-afa706692cb5)

For each of these tasks, we set start and end dates. While setting dates, the first task will be set to today's date and subsequent tasks will be post dated based on expected work hours needed (for that ""type"" of project: we will can have different project templates for different types of projects). So, if I made a project template today, and checked the expected start dates 5 years later, it will still have today's date as expected start date. However, magic happens when creating a project.

![Image](https://github.com/user-attachments/assets/0dabe27e-95e2-400c-86b1-6d8a8b2655cf)


While creating a project, we have this field: Expected Start Date.

![Image](https://github.com/user-attachments/assets/9bbaa8b8-2cef-4430-a5bc-01121a957eb0)

Lets assume a user creates a project today (Jan 15, 2025) and sets the Expected Start Date to 1.5 months later (assume March 1, 2025), and then selects a project template, the first task of that template (sorted by Expected start date) should be set to start at March 1 2025 and accordingly to other tasks. This way all new tasks created will maintain project timeline hierarchy. Else, all new tasks created will have this weird Gantt view which will provide no sense to project planning unless we intervene each tasks. Imagine doing this to all 20 new projects starting every month, each having more than 500 tasks. üó° üó° üó° 

![Image](https://github.com/user-attachments/assets/e17a8bbb-82bd-4e3b-b213-a3a1a283de8a)

If a project template looks this good, why not just copy this to each project starting with the template ?

![Image](https://github.com/user-attachments/assets/e5f13710-666a-486d-9227-683f171751af)


Also what I am not able to understand is this line of code:

![Image](https://github.com/user-attachments/assets/334fc57e-345a-47b3-b26c-031f0951e0d4)

Why put it there if it is doing nothing ?  If this one works:

![Image](https://github.com/user-attachments/assets/3235d762-31fe-4d1c-8191-faf18d8bb626)
why not the previous ??

"
2693985376,issue,open,,Add A Pasue Button inside the Timsheet timer,"![pasue](https://github.com/user-attachments/assets/e9ecc90d-4b43-49cc-8841-ca0793092353)


 Please we need to Add a pasue button inside the timer please add . into version -14 ",shubham9511s,2024-11-26 09:55:52+00:00,[],2024-11-26 09:55:52+00:00,,https://github.com/frappe/erpnext/issues/44344,"[('feature-request', None)]",[],
2693880074,issue,open,,Set HSN code (for India) while syncing items from Shopify,"For India, the HSN code is mandatory in Item master. Currently, the Shopify integrations does not set HSN code while syncing items from Shopify to ERPNext. It gives validation (via India Compliance app) while syncing and fails.

Proposed Solution:
In Shopify Settings, we can introduce a child table to enter default HSN code based on ""Item Group"". And while syncing items, we can set the HSN code based on Item Group.",nabinhait,2024-11-26 09:32:58+00:00,[],2024-11-26 09:32:58+00:00,,https://github.com/frappe/erpnext/issues/44340,"[('feature-request', None)]",[],
2693252933,issue,closed,completed,Parent Label is not visible on the website,"### Information about bug

I have set the parent label for the navbar but it is not showing me in the navbar

![image](https://github.com/user-attachments/assets/efd12d5b-1bff-4a3b-8bc1-f9fdb4e71d68)

![image](https://github.com/user-attachments/assets/845d8d4c-0e27-4ed0-a828-7bdaa0094c40)


### Module

ecommerce, other

### Version

ERPNext: v14.76.0 (version-14)

Frappe Framework: v14.85.1 (version-14)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Parent Label is not visible on the navbar
```
",Nandani-20,2024-11-26 05:47:31+00:00,[],2024-12-13 00:11:24+00:00,2024-11-28 07:23:25+00:00,https://github.com/frappe/erpnext/issues/44333,"[('bug', None)]","[{'comment_id': 2499962865, 'issue_id': 2693252933, 'author': 'Nandani-20', 'body': '@ruthra-kumar', 'created_at': datetime.datetime(2024, 11, 26, 8, 22, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2505420507, 'issue_id': 2693252933, 'author': 'Nihantra-Patel', 'body': ""We tested, it's worked properly, and remove Company from Parent Label from Company row.\r\n\r\n[scrnli_eb31BUd3FZLFW3.webm](https://github.com/user-attachments/assets/af940861-72b1-4f5e-9700-74db7ddc15cf)"", 'created_at': datetime.datetime(2024, 11, 28, 7, 23, 25, tzinfo=datetime.timezone.utc)}]","Nandani-20 (Issue Creator) on (2024-11-26 08:22:38 UTC): @ruthra-kumar

Nihantra-Patel on (2024-11-28 07:23:25 UTC): We tested, it's worked properly, and remove Company from Parent Label from Company row.

[scrnli_eb31BUd3FZLFW3.webm](https://github.com/user-attachments/assets/af940861-72b1-4f5e-9700-74db7ddc15cf)

"
2692215055,issue,closed,completed,Sorting leads #43968,"### Information about bug

See Sorting leads #43968

### Module

CRM

### Version

No idea?

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
See Sorting leads #43968
```
",jballaballa,2024-11-25 20:55:06+00:00,['iamejaaz'],2025-02-01 00:11:18+00:00,2025-01-17 11:10:37+00:00,https://github.com/frappe/erpnext/issues/44330,"[('bug', None)]",[],
2692016556,issue,closed,completed,Bug: Sales Invoice,"### Information about bug

fix: net_amount calculation #44231

As of this PR, Sales invoice not work

![image](https://github.com/user-attachments/assets/1c07daaf-1499-4055-91b9-239e2ec05000)

![image](https://github.com/user-attachments/assets/0ec336cb-9d90-48ba-b4c2-1cffba8506a9)



### Module

stock

### Version

Frappe Version 16.0.0-dev nvg-develop
Erpnext .29.0 nvg-develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
16:34:34 web.1         |   File ""apps/frappe/frappe/app.py"", line 118, in application
16:34:34 web.1         |     response = frappe.api.handle(request)
16:34:34 web.1         |   File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
16:34:34 web.1         |     data = endpoint(**arguments)
16:34:34 web.1         |   File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
16:34:34 web.1         |     return frappe.handler.handle()
16:34:34 web.1         |   File ""apps/frappe/frappe/handler.py"", line 49, in handle
16:34:34 web.1         |     data = execute_cmd(cmd)
16:34:34 web.1         |   File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
16:34:34 web.1         |     return frappe.call(method, **frappe.form_dict)
16:34:34 web.1         |   File ""apps/frappe/frappe/__init__.py"", line 1807, in call
16:34:34 web.1         |     return fn(*args, **newargs)
16:34:34 web.1         |   File ""apps/frappe/frappe/utils/typing_validations.py"", line 32, in wrapper
16:34:34 web.1         |     return func(*args, **kwargs)
16:34:34 web.1         |   File ""apps/erpnext/erpnext/__init__.py"", line 189, in wrapper
16:34:34 web.1         |     return func(ctx, *args, **kwargs)
16:34:34 web.1         |   File ""apps/erpnext/erpnext/stock/get_item_details.py"", line 100, in get_item_details
16:34:34 web.1         |     out.item_tax_rate = get_item_tax_map(
16:34:34 web.1         |   File ""apps/frappe/frappe/utils/typing_validations.py"", line 32, in wrapper
16:34:34 web.1         |     return func(*args, **kwargs)
16:34:34 web.1         |   File ""apps/erpnext/erpnext/stock/get_item_details.py"", line 693, in get_item_tax_map
16:34:34 web.1         |     for t in (t for t in (doc.get(""taxes"") or []) if not t.set_by_item_tax_template):
16:34:34 web.1         |   File ""apps/erpnext/erpnext/stock/get_item_details.py"", line 693, in <genexpr>
16:34:34 web.1         |     for t in (t for t in (doc.get(""taxes"") or []) if not t.set_by_item_tax_template):
16:34:34 web.1         | AttributeError: 'dict' object has no attribute 'set_by_item_tax_template'
```
",Naspleda,2024-11-25 19:40:08+00:00,['blaggacao'],2024-12-19 00:11:01+00:00,2024-12-04 13:08:52+00:00,https://github.com/frappe/erpnext/issues/44328,"[('bug', None)]","[{'comment_id': 2515404313, 'issue_id': 2692016556, 'author': 'Naspleda', 'body': ""![image](https://github.com/user-attachments/assets/adfa9b95-2bc4-49c4-8be0-b013fca62ceb)\r\n\r\nWith the new changes, still don't calculate tax and totals @barredterra"", 'created_at': datetime.datetime(2024, 12, 3, 19, 26, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2515426200, 'issue_id': 2692016556, 'author': 'Naspleda', 'body': '[\u200eerpnext/public/js/controllers/taxes_and_totals.js](https://github.com/NovigoTechnology/erpnext/commit/3732dd1b1f57b099635cc849dfe388e5b63461ba#diff-9faea27a2ac47e603914ab1813d4b3d9c26e60135d60753701603ddfad5b2e5f)\r\n\r\nIn this file, I found in line 250 ""var current_net_amount = 0.0"" was deleted but is referenced after\r\n\r\n![image](https://github.com/user-attachments/assets/572ffbaa-891e-442a-8cf0-03321575ed6f)', 'created_at': datetime.datetime(2024, 12, 3, 19, 56, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2515447657, 'issue_id': 2692016556, 'author': 'barredterra', 'body': ""I'd like to leave fixes of the logic errors to @blaggacao. I can only fix some syntax issues here."", 'created_at': datetime.datetime(2024, 12, 3, 20, 6, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2515656026, 'issue_id': 2692016556, 'author': 'blaggacao', 'body': ""Hi sorry, didn't see this before. I can have a look / provide any missing fix tomorrow.\n\nThanks for tagging me."", 'created_at': datetime.datetime(2024, 12, 3, 22, 12, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2515669853, 'issue_id': 2692016556, 'author': 'blaggacao', 'body': ""I think getting some client testing (cypress) also into erpnext would help, on the longer run.\n\nI've seen some organically grown discrepancies between some of the client side and server side calculations that already seemed accidental in nature while doing the refactor.\n\nThis is definitely a regression / oversight though."", 'created_at': datetime.datetime(2024, 12, 3, 22, 21, 31, tzinfo=datetime.timezone.utc)}]","Naspleda (Issue Creator) on (2024-12-03 19:26:20 UTC): ![image](https://github.com/user-attachments/assets/adfa9b95-2bc4-49c4-8be0-b013fca62ceb)

With the new changes, still don't calculate tax and totals @barredterra

Naspleda (Issue Creator) on (2024-12-03 19:56:31 UTC): [‚Äéerpnext/public/js/controllers/taxes_and_totals.js](https://github.com/NovigoTechnology/erpnext/commit/3732dd1b1f57b099635cc849dfe388e5b63461ba#diff-9faea27a2ac47e603914ab1813d4b3d9c26e60135d60753701603ddfad5b2e5f)

In this file, I found in line 250 ""var current_net_amount = 0.0"" was deleted but is referenced after

![image](https://github.com/user-attachments/assets/572ffbaa-891e-442a-8cf0-03321575ed6f)

barredterra on (2024-12-03 20:06:57 UTC): I'd like to leave fixes of the logic errors to @blaggacao. I can only fix some syntax issues here.

blaggacao (Assginee) on (2024-12-03 22:12:02 UTC): Hi sorry, didn't see this before. I can have a look / provide any missing fix tomorrow.

Thanks for tagging me.

blaggacao (Assginee) on (2024-12-03 22:21:31 UTC): I think getting some client testing (cypress) also into erpnext would help, on the longer run.

I've seen some organically grown discrepancies between some of the client side and server side calculations that already seemed accidental in nature while doing the refactor.

This is definitely a regression / oversight though.

"
2688296689,issue,closed,completed,Date validation not functioning in Material request ,"### Information about bug

![image](https://github.com/user-attachments/assets/9d1fb994-f492-4ca8-95be-d6d847d8c969)

After adding the transaction date 24/11/2024 and required by in  14/12/2024 , 

Result: Shows error"" required date can't be earlier than transaction date "" 

### Module

buying

### Version

15

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
"" required date can't be earlier than transaction date ""
```
",Abir-revolted,2024-11-24 20:02:37+00:00,[],2024-12-10 00:11:32+00:00,2024-11-25 14:58:57+00:00,https://github.com/frappe/erpnext/issues/44313,"[('bug', None)]",[],
2687975075,issue,closed,completed,Default User for Project is not settable,"### Information about bug

When performing timetracking for a project, you add time sheets. But a user which has the role ""project user"" is not able to set himself as an employee in the timesheets for himself. It throws an error, that the user has no access to the employee doctype.

### Module

projects

### Version

erpnext 15.43.3
frappe 15.48.0
hrms 16.0.0-dev
nl_attendance_timesheet 0.0.1

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1725, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/search.py"", line 47, in search_link
    results = search_widget(
              ^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/search.py"", line 193, in search_widget
    values = frappe.get_list(
             ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1989, in get_list
    return frappe.model.db_query.DatabaseQuery(doctype).execute(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/db_query.py"", line 114, in execute
    self.check_read_permission(self.doctype, parent_doctype=parent_doctype)
  File ""apps/frappe/frappe/model/db_query.py"", line 511, in check_read_permission
    self._set_permission_map(doctype, parent_doctype)
  File ""apps/frappe/frappe/model/db_query.py"", line 517, in _set_permission_map
    frappe.has_permission(
  File ""apps/frappe/frappe/__init__.py"", line 1047, in has_permission
    raise frappe.PermissionError
frappe.exceptions.PermissionError
2 request.js:473:14
```
",vogt31337,2024-11-24 16:38:56+00:00,[],2025-01-29 00:10:10+00:00,2025-01-14 05:59:21+00:00,https://github.com/frappe/erpnext/issues/44311,"[('bug', None)]","[{'comment_id': 2589082026, 'issue_id': 2687975075, 'author': 'nabinhait', 'body': 'How is it a bug? You can give the role ""Employee"" to that user.', 'created_at': datetime.datetime(2025, 1, 14, 5, 59, 22, tzinfo=datetime.timezone.utc)}]","nabinhait on (2025-01-14 05:59:22 UTC): How is it a bug? You can give the role ""Employee"" to that user.

"
2687966944,issue,closed,completed,Updating Roles isn't possible,"### Information about bug

## Description of the issue

Hi trying to update a Role results in an error. Basically nothing happens, no sound nothing. Only way to ""update"" a role is by creating a new one.

## Context information (for bug reports)

I'am trying to give users a project user role so that they can book there times on their projects on their own. But updating a role fails horribly...

## Steps to reproduce the issue

1. Open Role list
2. Select a role
3. Change something
4. Try to save it

### Observed result

Nothing happens, no sound nothing. Even the save button doesn't change.

### Expected result

Updating the role, getting a sound and the dialog closes.



### Module

projects

### Version

erpnext 15.43.3
frappe 15.48.0
hrms 16.0.0-dev
nl_attendance_timesheet 0.0.1

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
### Stacktrace / full error message if available


XHRPOST
http://localhost:8080/api/method/frappe.desk.form.save.savedocs
[HTTP/1.1 417 EXPECTATION FAILED 16ms]

Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1725, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 341, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 365, in _save
    self.check_if_locked()
  File ""apps/frappe/frappe/model/document.py"", line 337, in check_if_locked
    raise frappe.DocumentLockedError
frappe.exceptions.DocumentLockedError
request.js:473:14
    cleanup request.js:473
    cleanup request.js:471
    call request.js:325
    jQuery 6
    call request.js:279
    call request.js:109
    f save.js:246
    n save.js:23
    save save.js:273
    validate_and_save form.js:821
    (Async: promise callback)
    run_serially dom.js:262
    run_serially dom.js:260
    validate_and_save form.js:812
    save form.js:751
    save form.js:748
    Save toolbar.js:688
    set_action page.js:305
    jQuery 8
    set_action page.js:304
    set_primary_action page.js:319
    set_page_actions toolbar.js:705
    set_primary_action toolbar.js:618
    refresh toolbar.js:19
    refresh_header form.js:722
    render_form form.js:606
    (Async: promise callback)
    run_serially dom.js:262
    run_serially dom.js:260
    render_form form.js:603
    trigger_onload form.js:556
    refresh form.js:433
    render formview.js:107
    fetch_and_render formview.js:91
    with_doc model.js:316
    with_doc model.js:309
    fetch_and_render formview.js:80
    show_doc formview.js:75
    make formview.js:18
    show factory.js:25
    render_page router.js:326
    render router.js:305
    route router.js:157
    push_state router.js:503
    set_route router.js:379
    set_route router.js:368
    set_route router.js:579
    n router.js:46
    <anonym> router.js:78
    jQuery 2

```
```
",vogt31337,2024-11-24 16:26:25+00:00,[],2025-01-28 00:10:06+00:00,2025-01-13 11:19:40+00:00,https://github.com/frappe/erpnext/issues/44310,"[('bug', None)]","[{'comment_id': 2586835612, 'issue_id': 2687966944, 'author': 'nabinhait', 'body': ""Can't replicate the issue, please reopen it with screenshots, if you can replicate it on a clean (without any customization) frappecloud account."", 'created_at': datetime.datetime(2025, 1, 13, 11, 19, 40, tzinfo=datetime.timezone.utc)}]","nabinhait on (2025-01-13 11:19:40 UTC): Can't replicate the issue, please reopen it with screenshots, if you can replicate it on a clean (without any customization) frappecloud account.

"
2687115171,issue,open,,PDF Compress after upload,"File size affects the backup, there is compress the file when uploading it",tajff,2024-11-24 05:14:32+00:00,[],2024-11-24 05:14:32+00:00,,https://github.com/frappe/erpnext/issues/44308,"[('feature-request', None)]",[],
2685383537,issue,open,,Add The Pause button inside the timesheet timer diglog box  Most Neeed ,"
![pasue](https://github.com/user-attachments/assets/8650ff61-87ef-45d6-977f-1f6383944d25)


Please we want to need a feature stop a timer inside the timesheet timer . ",shubham9511s,2024-11-23 05:10:42+00:00,[],2024-11-23 05:10:42+00:00,,https://github.com/frappe/erpnext/issues/44301,"[('feature-request', None)]",[],
2685374372,issue,open,,The words in the search bar aren't being translated at all when changing the language,"### Information about bug

In the search bar there's a placeholder called ""Search or type a command (Ctrl + G)""
This sentence doesn't get translated at all, even when changing the language.
I also tried manually adding the sentence in the csv translation file but it was in vain.
Please update it 

### Module

other

### Version

ERPNext: v15.38.0 (version-15)

Frappe Framework: v15.43.0 (version-15)


### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",momenmedhatsalem,2024-11-23 04:56:11+00:00,[],2024-11-23 04:56:11+00:00,,https://github.com/frappe/erpnext/issues/44300,"[('bug', None)]",[],
2684718179,issue,open,,BOM Item Rate not fetched under certain conditions of UOM,"### Information about bug

Let's say you have two Units Of Measure defined (A and B), and a UOM Conversion Factor between them.
You've got an Item whose Default UOM is A.
You've saved an Item Price whose UOM is B.
Now you go to add the Item to a BOM raw materials table. Set Rate of Materials Based on = Price List
- **If you use UOM A in the BOM table, ERPNext fails to fetch a Rate for the Item.**
- If you use UOM B in the BOM table, the rate is fetched correctly and UOM Conversion Factor correctly applied.

![Image](https://github.com/user-attachments/assets/f3bb87a7-99c1-42b9-89c0-37d079537d54)

This behavior is the same regardless of these settings:
- ""Must be whole number"" field for UOMs involved
- ""Price Not UOM Dependent"" field for Price List

This contradicts the expected behavior based on the [documentation for Price List settings](https://docs.erpnext.com/docs/user/manual/en/price-lists):

> Price Not UOM Dependent: Consider an item, Tomatoes which you buy in Boxes and sell in Kilos. 1 Box = 10 Kilos and 1 Kilo buying price is 10rs. If this Box is unchecked and you select 1 Box in your transaction, the price will show up only for a Kilo since that's the only Item Price saved.
Now, if you tick this checkbox and make a transaction with a Box of Tomatoes, then the price will be automatically set as 100 since the price of 1 Box (10 Kilos) is 100. * Standard Buying and Selling Price Lists are created by default.

Also see https://discuss.frappe.io/t/bom-price-calculation-per-used-uom-conversion-not-working/66183

Why is this annoying
- It's common to buy in one UOM and consume in a different UOM. So you should be able to enter an Item Price in the UOM you buy in, and enter a BOM Item in the UOM you consume in.
- Sometimes there's an order of magnitude difference between units; like you buy something by the kilo and use it by the gram. This can force you to use very high precision / decimal places in your prices; it is better if you can rely on the nice existing UOM conversion feature to avoid rounding errors.
- The same-UOM requirement is counter intuitive and frustrating.

### Steps to Replicate
- Create ERPNext demo site with demo data (I did this with ERPNext: v15.48.3, Frappe Framework: v15.52.0)
- Create new UOM Conversion Factor: **1 Box = 10 Nos**
- Create a new BOM
  - Produced Item = any existing Item, doesn't matter
  - Cost Configuration >> Rate of Materials Based on = **Price List**
  - Cost Configuration >> Price List = **Standard Buying**
  - To the Raw Materials/Items table, add **SKU001** (a T-shirt).
    - UOM defaults to **Nos**
    - **Result: Rate of 400 fetched as expected.**
  - Change the T-shirt UOM to **Box**
    - **Result: Rate of 4,000 fetched as expected.**
So everything seems to work when the Item Price UOM = the Item's Default UOM (which is Nos in this case).
- Now open the Item Price for the T-shirt:
  - Change UOM from Nos to **Box**
  - Change Rate from 400 to **4,000**
  - I.e. the per-unit price is staying the same
- Go back to your BOM:
  - Change the T-shirt UOM to **Nos**
    - **Result: No rate fetched. Error: ""Price not found for item SKU001 in price list Standard Buying""**
  - Change the T-shirt UOM to **Box**
    - **Result: Rate of 4,000 fetched as expected.**

### Module

manufacturing

### Version

ERPNext: v15.43.0
Frappe Framework: v15.48.0

### Installation method

docker self hosted
Also tried frappe cloud demo site.

### Relevant log output / Stack trace / Full Error Message.

""Price not found for item SKU001 in price list Standard Buying""",mepoland,2024-11-22 21:57:39+00:00,[],2025-01-17 02:58:06+00:00,,https://github.com/frappe/erpnext/issues/44298,"[('bug', None)]","[{'comment_id': 2576139912, 'issue_id': 2684718179, 'author': 'toofun666', 'body': 'Shame to receive such a point in yer 2025...', 'created_at': datetime.datetime(2025, 1, 7, 20, 12, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2579712628, 'issue_id': 2684718179, 'author': 'mihir-kandoi', 'body': '@mepoland Please provide replication steps. Use any kind of example data needed.', 'created_at': datetime.datetime(2025, 1, 9, 10, 19, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2597331078, 'issue_id': 2684718179, 'author': 'mepoland', 'body': ""@mihir-kandoi I have dug into this a bit and updated the issue description, including replication steps. To summarize, the Rate fetch only fails when:\n- Item Price UOM <> Item default UOM, AND\n- BOM Item UOM <> Item Price UOM\n...and it fails regardless of all other settings that I've tried.\nThis might seem obscure, but it happens a lot when you buy and set Item Price in a large qty, but use only a small amount in the BOM of each unit produced. E.g. you buy glue by the liter but use it by the mL.\nThanks for your help!"", 'created_at': datetime.datetime(2025, 1, 17, 2, 58, 5, tzinfo=datetime.timezone.utc)}]","toofun666 on (2025-01-07 20:12:37 UTC): Shame to receive such a point in yer 2025...

mihir-kandoi on (2025-01-09 10:19:25 UTC): @mepoland Please provide replication steps. Use any kind of example data needed.

mepoland (Issue Creator) on (2025-01-17 02:58:05 UTC): @mihir-kandoi I have dug into this a bit and updated the issue description, including replication steps. To summarize, the Rate fetch only fails when:
- Item Price UOM <> Item default UOM, AND
- BOM Item UOM <> Item Price UOM
...and it fails regardless of all other settings that I've tried.
This might seem obscure, but it happens a lot when you buy and set Item Price in a large qty, but use only a small amount in the BOM of each unit produced. E.g. you buy glue by the liter but use it by the mL.
Thanks for your help!

"
2682950496,issue,open,,Deadlock Issue in Custom Payment Reconciliation RQ Job for Bulk Transactions,"### Information about bug

**Description:**
We have implemented a custom RQ job function for payment reconciliation in ERPNext. The job is derived from the trigger_reconciliation_for_queued_docs function in erpnext/accounts/doctype/process_payment_reconciliation/process_payment_reconciliation.py. In our customization, we made minor modifications by commenting out the queue_size code to process all entries at once.
Our goal is to reconcile all customer and supplier payments and invoices in a single run at 2:30 AM daily. While the process handles most of the workload efficiently, we encounter deadlock errors when reconciling high volumes of transactions. This typically occurs for 60‚Äì70 transactions, with 4‚Äì5 transactions encountering deadlock errors.


**Error Details:**
**Error Title:** erpnext.accounts.doctype.process_payment_reconciliation.process_payment_reconciliation.fetch_and_allocate
Traceback:
sql
Traceback (most recent call last):
  File ""apps/frappe/frappe/utils/background_jobs.py"", line 220, in execute_job
    retval = method(**kwargs)
  ...
  File ""apps/frappe/frappe/database/database.py"", line 240, in sql
    raise frappe.QueryDeadlockError(e) from e
frappe.exceptions.QueryDeadlockError: (1213, 'Deadlock found when trying to get lock; try restarting transaction')

**Relevant Context:**
We are using 2 workers in a single bench.
The issue arises when the job processes entries in bulk, causing some transactions to fail due to deadlocks.
The affected function is fetch_and_allocate, which leads to deadlocks while performing database operations (INSERT INTO or UPDATE queries) on tabProcess Payment Reconciliation Log Allocations.

**Steps to Reproduce:**
Implement a custom RQ job similar to trigger_reconciliation_for_queued_docs.
Process all Process Payment Reconciliation Doctype entries in a single run.
Execute the job during high transaction loads.
Observe the deadlock errors in the logs for a subset of transactions.

**References:**
ERPNext Function: trigger_reconciliation_for_queued_docs
File Path: erpnext/accounts/doctype/process_payment_reconciliation/process_payment_reconciliation.py

### Module

accounts

### Version

**Environment Details:**
ERPNext Version: 15.34.0
Frappe Version: 15.39.2
Database: MariaDB
Number of Workers: 2
Hosting: Digital Ocean

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback with variables (most recent call last):
  File ""apps/frappe/frappe/utils/background_jobs.py"", line 220, in execute_job
    retval = method(**kwargs)
      site = 'unitycement.sigzencloud.com'
      method = <function fetch_and_allocate at 0x7f819b9cc820>
      event = None
      job_name = 'process_ACC-PPR-74031_fetch_and_allocate'
      kwargs = {'doc': 'ACC-PPR-74031'}
      user = 'Administrator'
      is_async = True
      retry = 0
      retval = None
      method_name = 'erpnext.accounts.doctype.process_payment_reconciliation.process_payment_reconciliation.fetch_and_allocate'
      before_job_task = 'frappe.monitor.start'
  File ""apps/erpnext/erpnext/accounts/doctype/process_payment_reconciliation/process_payment_reconciliation.py"", line 366, in fetch_and_allocate
    reconcile_log.save()
      doc = 'ACC-PPR-74031'
      log = 'PPR-LOG-74062'
      reconcile_log = <ProcessPaymentReconciliationLog: PPR-LOG-74062>
      pr = <PaymentReconciliation: Payment Reconciliation>
      invoices = [{'name': None, 'owner': None, 'creation': None, 'modified': None, 'modified_by': None, 'docstatus': 0, 'idx': 1, 'invoice_type': 'Sales Invoice', 'invoice_number': 'PMC/24-25/5919', 'invoice_date': datetime.date(2024, 11, 18), 'amount': 128000.0, 'outstanding_amount': 0, 'currency': 'INR', 'exchange_rate': 1.0, 'parent': 'Payment Reconciliation', 'parentfield': 'invoices', 'parenttype': 'Payment Reconciliation', 'doctype': 'Payment Reconciliation Invoice', '__islocal': 1}, {'name': None, 'owner': None, 'creation': None, 'modified': None, 'modified_by': None, 'docstatus': 0, 'idx': 2, 'invoice_type': 'Sales Invoice', 'invoice_number': 'PMC/24-25/5920', 'invoice_date': datetime.date(2024, 11, 18), 'amount': 32000.0, 'outstanding_amount': 0, 'currency': 'INR', 'exchange_rate': 1.0, 'parent': 'Payment Reconciliation', 'parentfield': 'invoices', 'parenttype': 'Payment Reconciliation', 'doctype': 'Payment Reconciliation Invoice', '__islocal': 1}]
      payments = [{'name': None, 'owner': None, 'creation': None, 'modified': None, 'modified_by': None, 'docstatus': 0, 'idx': 1, 'reference_type': 'Payment Entry', 'reference_name': 'REC/24-25/2850', 'posting_date': datetime.date(2024, 11, 20), 'is_advance': None, 'reference_row': None, 'amount': 0.0, 'difference_amount': 0.0, 'remark': None, 'currency': 'INR', 'exchange_rate': 1.0, 'cost_center': None, 'parent': 'Payment Reconciliation', 'parentfield': 'payments', 'parenttype': 'Payment Reconciliation', 'doctype': 'Payment Reconciliation Payment', '__islocal': 1, 'unreconciled_amount': 160000.0}]
      x = <PaymentReconciliationAllocation: unsaved parent=Payment Reconciliation>
  File ""apps/frappe/frappe/model/document.py"", line 337, in save
    return self._save(*args, **kwargs)
      self = <ProcessPaymentReconciliationLog: PPR-LOG-74062>
      args = ()
      kwargs = {}
  File ""apps/frappe/frappe/model/document.py"", line 389, in _save
    self.update_children()
      self = <ProcessPaymentReconciliationLog: PPR-LOG-74062>
      ignore_permissions = None
      ignore_version = None
  File ""apps/frappe/frappe/model/document.py"", line 421, in update_children
    self.update_child_table(df.fieldname, df)
      self = <ProcessPaymentReconciliationLog: PPR-LOG-74062>
      df = <TableDocField: allocations parent=Process Payment Reconciliation Log>
  File ""apps/frappe/frappe/model/document.py"", line 453, in update_child_table
    d.db_update()
      self = <ProcessPaymentReconciliationLog: PPR-LOG-74062>
      fieldname = 'allocations'
      df = <TableDocField: allocations parent=Process Payment Reconciliation Log>
      all_rows = [<ProcessPaymentReconciliationLogAllocations: u63d2vbkmu parent=PPR-LOG-74062>, <ProcessPaymentReconciliationLogAllocations: u63d5ei5s6 parent=PPR-LOG-74062>]
      existing_row_names = []
      tbl = Table('tabProcess Payment Reconciliation Log Allocations')
      qry = DELETE FROM `tabProcess Payment Reconciliation Log Allocations` WHERE `parent`='PPR-LOG-74062' AND `parenttype`='Process Payment Reconciliation Log' AND `parentfield`='allocations'
      d = <ProcessPaymentReconciliationLogAllocations: u63d2vbkmu parent=PPR-LOG-74062>
  File ""apps/frappe/frappe/model/base_document.py"", line 590, in db_update
    self.db_insert()
      self = <ProcessPaymentReconciliationLogAllocations: u63d2vbkmu parent=PPR-LOG-74062>
  File ""apps/frappe/frappe/model/base_document.py"", line 550, in db_insert
    frappe.db.sql(
      self = <ProcessPaymentReconciliationLogAllocations: u63d2vbkmu parent=PPR-LOG-74062>
      ignore_if_duplicate = False
      conflict_handler = ''
      d = {'name': 'u63d2vbkmu', 'owner': 'Administrator', 'creation': '2024-11-21 02:35:57.251328', 'modified': '2024-11-21 02:36:06.095729', 'modified_by': 'Administrator', 'docstatus': 0, 'idx': 1, 'reference_type': 'Payment Entry', 'reference_name': 'REC/24-25/2850', 'reference_row': None, 'invoice_type': 'Sales Invoice', 'invoice_number': 'PMC/24-25/5919', 'allocated_amount': 128000.0, 'unreconciled_amount': 160000.0, 'amount': 160000.0, 'is_advance': None, 'difference_amount': 0.0, 'difference_account': 'Exchange Gain/Loss - PCPL', 'exchange_rate': 1.0, 'currency': 'INR', 'reconciled': 0, 'parent': 'PPR-LOG-74062', 'parentfield': 'allocations', 'parenttype': 'Process Payment Reconciliation Log'}
      columns = ['name', 'owner', 'creation', 'modified', 'modified_by', 'docstatus', 'idx', 'reference_type', 'reference_name', 'reference_row', 'invoice_type', 'invoice_number', 'allocated_amount', 'unreconciled_amount', 'amount', 'is_advance', 'difference_amount', 'difference_account', 'exchange_rate', 'currency', 'reconciled', 'parent', 'parentfield', 'parenttype']
  File ""apps/frappe/frappe/database/database.py"", line 240, in sql
    raise frappe.QueryDeadlockError(e) from e
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x7f81a1b03b20>
      query = 'INSERT INTO `tabProcess Payment Reconciliation Log Allocations` (`name`, `owner`, `creation`, `modified`, `modified_by`, `docstatus`, `idx`, `reference_type`, `reference_name`, `reference_row`, `invoice_type`, `invoice_number`, `allocated_amount`, `unreconciled_amount`, `amount`, `is_advance`, `difference_amount`, `difference_account`, `exchange_rate`, `currency`, `reconciled`, `parent`, `parentfield`, `parenttype`)\n\t\t\t\t\tVALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)'
      values = ['u63d2vbkmu', 'Administrator', '2024-11-21 02:35:57.251328', '2024-11-21 02:36:06.095729', 'Administrator', 0, 1, 'Payment Entry', 'REC/24-25/2850', None, 'Sales Invoice', 'PMC/24-25/5919', 128000.0, 160000.0, 160000.0, None, 0.0, 'Exchange Gain/Loss - PCPL', 1.0, 'INR', 0, 'PPR-LOG-74062', 'allocations', 'Process Payment Reconciliation Log']
      as_dict = 0
      as_list = 0
      debug = False
      ignore_ddl = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = False
      as_iterator = False
      trace_id = None
frappe.exceptions.QueryDeadlockError: (1213, 'Deadlock found when trying to get lock; try restarting transaction')
```
",dipenf-sigzen,2024-11-22 11:43:40+00:00,[],2024-11-22 11:43:40+00:00,,https://github.com/frappe/erpnext/issues/44291,"[('bug', None)]",[],
2682181210,issue,open,,Company wise Naming Settings,"Currently, the system has a generic Naming Settings doctype that does not differentiate between Companies.
Hence, currently, any transaction that gets created is in general sequential order even if the companies are different.
Eg:

Naming Setting Serial for Sales Invoice : SINV-###

Companies: 
Reliance Insurance
Reliance Petroleum

Invoice Number || Company

SINV-001 || Reliance Insurance
SINV-002 || Reliance Petroleum

Some companies/organizations may find this useful but a considerable few other companies will find this difficult to work with.

Hence, we would need Company selection in Naming Settings to specify the company and the transaction the Naming Sequence is applicable for.

Secondly, working with the current sequence is also a major challenge when a new company is added to the existing company and both of them are expected to have same sequence or different sequence while also maintaining the sanity and tracability.",hpotabatti,2024-11-22 07:35:06+00:00,[],2024-11-30 08:35:44+00:00,,https://github.com/frappe/erpnext/issues/44281,"[('feature-request', None)]","[{'comment_id': 2495495503, 'issue_id': 2682181210, 'author': 'azharumar', 'body': 'I support this feature too. If ERPNext is multi-company, then it should be able to handle Naming Series based on the company.', 'created_at': datetime.datetime(2024, 11, 23, 14, 21, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2495700675, 'issue_id': 2682181210, 'author': 'emm31ph', 'body': 'i see this feature https://github.com/frappe/erpnext/pull/43260 i dont know if this can help you guys', 'created_at': datetime.datetime(2024, 11, 23, 23, 57, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2508887240, 'issue_id': 2682181210, 'author': 'maniamartial', 'body': '> Currently, the system has a generic Naming Settings doctype that does not differentiate between Companies. Hence, currently, any transaction that gets created is in general sequential order even if the companies are different. Eg:\r\n> \r\n> Naming Setting Serial for Sales Invoice : SINV-###\r\n> \r\n> Companies: Reliance Insurance Reliance Petroleum\r\n> \r\n> Invoice Number || Company\r\n> \r\n> SINV-001 || Reliance Insurance SINV-002 || Reliance Petroleum\r\n> \r\n> Some companies/organizations may find this useful but a considerable few other companies will find this difficult to work with.\r\n> \r\n> Hence, we would need Company selection in Naming Settings to specify the company and the transaction the Naming Sequence is applicable for.\r\n> \r\n> Secondly, working with the current sequence is also a major challenge when a new company is added to the existing company and both of them are expected to have same sequence or different sequence while also maintaining the sanity and tracability.\r\n\r\nWhat about using Document Naming Rule to set your series as per the company?\r\n![image](https://github.com/user-attachments/assets/c9cb828b-a322-43b2-9cea-06140992ad52)', 'created_at': datetime.datetime(2024, 11, 30, 8, 34, 58, tzinfo=datetime.timezone.utc)}]","azharumar on (2024-11-23 14:21:55 UTC): I support this feature too. If ERPNext is multi-company, then it should be able to handle Naming Series based on the company.

emm31ph on (2024-11-23 23:57:52 UTC): i see this feature https://github.com/frappe/erpnext/pull/43260 i dont know if this can help you guys

maniamartial on (2024-11-30 08:34:58 UTC): What about using Document Naming Rule to set your series as per the company?
![image](https://github.com/user-attachments/assets/c9cb828b-a322-43b2-9cea-06140992ad52)

"
2681965182,issue,open,,"Add company field for doc types like customer, Item, Item group ... etc...,","<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
there's a high chance that customer, Item are not shared with other companies and belonged to one company only

**Describe the solution you'd like**
Create a company field for those doc types

**Describe alternatives you've considered**
we can have company as optional field also like we have for bank account, if selected then it belongs to selected company else it belongs to all companies

**Additional context**
Say big company with multiple Horizontals using this ERP, then items, customers, suppliers and every master is different for each company
or a CA firm using ERPNext to manage their clients then also its same

",saivineeth100,2024-11-22 06:27:25+00:00,[],2024-11-22 06:27:25+00:00,,https://github.com/frappe/erpnext/issues/44276,"[('feature-request', None)]",[],
2681714184,issue,closed,completed,Serial Number can be inputted twice with the same serial number,"### Information about bug

The issue occurs when the serial number that has been issued and used can be re-entered, causing an error in the withdrawal of the incoming rate used for COGS in the delivery note. where it should take the value of Rp197,108,648 not Rp202,280,000.
![gl entry](https://github.com/user-attachments/assets/f3784a0a-01ba-4180-b3db-2aabd25b8291)
![stock ledger 2](https://github.com/user-attachments/assets/b8d96877-9cf7-41da-a3b3-cfc0395f0aed)


### Module

stock

### Version

ERPNext : v14.72.0
Frappe : v14.81.6

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
there is no error log occurs when this error occurs
```
",aditya21y,2024-11-22 04:28:33+00:00,[],2025-01-29 00:10:09+00:00,2025-01-14 06:00:01+00:00,https://github.com/frappe/erpnext/issues/44269,"[('bug', None)]","[{'comment_id': 2498265436, 'issue_id': 2681714184, 'author': 'rohitwaghchaure', 'body': '@aditya21y Check ""Allow existing Serial No to be Manufactured/Received again"" has been enabled in the Stock Settings, if it\'s enabled then disabled it and check', 'created_at': datetime.datetime(2024, 11, 25, 15, 3, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure on (2024-11-25 15:03:00 UTC): @aditya21y Check ""Allow existing Serial No to be Manufactured/Received again"" has been enabled in the Stock Settings, if it's enabled then disabled it and check

"
2679246461,issue,open,,Currency Precision Issue in Journal Entry giving: Total Debit must be equal to Total Credit. The difference is -0.0000001,"### Information about bug

**This issue has been tracked for 3 years now**
- On the forum [here](https://discuss.frappe.io/t/total-debit-must-be-equal-to-total-credit-the-difference-is-0-009999999999990905/95779) and [here](https://discuss.frappe.io/t/multicurrency-journal-entry-debit-must-equal-credit/49301) in Version-15 AFAIK
- There's also this [related github issue which was closed without resolution](https://github.com/frappe/erpnext/issues/36698) in Version-14

### **Expected behaviour:**
Journal Entry should be able to ignore the debit credit difference if its under the standard or set currency precision.

### **Actual Behaviour**
Getting Exception Message: Total Debit must be equal to Total Credit. The difference is -0.000000XXXX

### **Workaround**
The only workaround is reducing **Currency Precision** to 1 decimal place in **System Settings**

### **Suggested Solution**
I believe we can resolve the issue by ignoring small discrepancies less than 0.01 by rounding-up one of the amounts so that there's no difference

We can change 

```
	def set_total_debit_credit(self):
		self.total_debit, self.total_credit, self.difference = 0, 0, 0
		for d in self.get(""accounts""):
			if d.debit and d.credit:
				frappe.throw(_(""You cannot credit and debit same account at the same time""))

			self.total_debit = flt(self.total_debit) + flt(d.debit, d.precision(""debit""))
			self.total_credit = flt(self.total_credit) + flt(d.credit, d.precision(""credit""))

		self.difference = flt(self.total_debit, self.precision(""total_debit"")) - flt(
			self.total_credit, self.precision(""total_credit"")
		)
```

To 

```
	def set_total_debit_credit(self):
		self.total_debit, self.total_credit, self.difference = 0, 0, 0

		# Calculate total debit and credit
		for d in self.get(""accounts""):
			if d.debit and d.credit:
				frappe.throw(_(""You cannot credit and debit the same account at the same time""))

			self.total_debit += flt(d.debit, d.precision(""debit""))
			self.total_credit += flt(d.credit, d.precision(""credit""))

		# Compute the difference with rounding
		self.difference = flt(
			flt(self.total_debit, self.precision(""total_debit"")) - 
			flt(self.total_credit, self.precision(""total_credit"")),
			self.precision(""difference"")
		)

		# Adjust for small discrepancies
		if abs(self.difference) <= 0.01:
			if self.total_debit > self.total_credit:
				self.total_credit = flt(self.total_debit, self.precision(""total_credit""))
			else:
				self.total_debit = flt(self.total_credit, self.precision(""total_debit""))

			self.difference = 0  # Ensure no discrepancy remains
```

### Module

accounts

### Version

ERPNext: v15.39.3 (version-15)
Frappe Framework: v15.45.1 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
File ""apps/frappe/frappe/model/document.py"", line 291, in insert
11:12:05 web.1         |     self.run_before_save_methods()
11:12:05 web.1         |   File ""apps/frappe/frappe/model/document.py"", line 1091, in run_before_save_methods
11:12:05 web.1         |     self.run_method(""validate"")
11:12:05 web.1         |   File ""apps/frappe/frappe/model/document.py"", line 962, in run_method
11:12:05 web.1         |     out = Document.hook(fn)(self, *args, **kwargs)
11:12:05 web.1         |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11:12:05 web.1         |   File ""apps/frappe/frappe/model/document.py"", line 1322, in composer
11:12:05 web.1         |     return composed(self, method, *args, **kwargs)
11:12:05 web.1         |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11:12:05 web.1         |   File ""apps/frappe/frappe/model/document.py"", line 1304, in runner
11:12:05 web.1         |     add_to_return_value(self, fn(self, *args, **kwargs))
11:12:05 web.1         |                               ^^^^^^^^^^^^^^^^^^^^^^^^^
11:12:05 web.1         |   File ""apps/frappe/frappe/model/document.py"", line 959, in fn
11:12:05 web.1         |     return method_object(*args, **kwargs)
11:12:05 web.1         |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
11:12:05 web.1         |   File ""apps/erpnext/erpnext/accounts/doctype/journal_entry/journal_entry.py"", line 132, in validate
11:12:05 web.1         |     self.validate_total_debit_and_credit()
11:12:05 web.1         |   File ""apps/erpnext/erpnext/accounts/doctype/journal_entry/journal_entry.py"", line 868, in validate_total_debit_and_credit
11:12:05 web.1         |     frappe.throw(
11:12:05 web.1         |   File ""apps/frappe/frappe/__init__.py"", line 655, in throw
11:12:05 web.1         |     msgprint(
11:12:05 web.1         |   File ""apps/frappe/frappe/__init__.py"", line 620, in msgprint
11:12:05 web.1         |     _raise_exception()
11:12:05 web.1         |   File ""apps/frappe/frappe/__init__.py"", line 571, in _raise_exception
11:12:05 web.1         |     raise exc
11:12:05 web.1         | frappe.exceptions.ValidationError: Total Debit must be equal to Total Credit. The difference is -0.0000001
```
",dawoodjee,2024-11-21 12:07:51+00:00,[],2024-11-21 12:07:51+00:00,,https://github.com/frappe/erpnext/issues/44265,"[('bug', None)]",[],
2678918981,issue,open,,Customize Date filters in Sales analytics Report and other Reports to include time,"**Is your feature request related to a problem? Please describe.**
I am unable to use the default reports such as sales analytics to generate reports filtered by time. As at now, the sales analytics report can be filtered by date but not by time. As such, we are unable to analyze the transactions within the day.

**Describe the solution you'd like**
Can the team change the date filters in the default reports to include time? This would solve the problem and make it possible to analyze transactions within a day and segregate by hours or minutes or seconds.

**Describe alternatives you've considered**
We have considered using the report builder to generate what we need but it is not as efficient as just having the core reports such as sales analytics report have the date filters, hence, the reason for this request.

**Additional context**
It would be great to have this request implemented for all the other core reports
",bamfo-debrah,2024-11-21 10:29:17+00:00,[],2024-11-21 10:29:17+00:00,,https://github.com/frappe/erpnext/issues/44261,"[('feature-request', None)]",[],
2676577445,issue,closed,completed,Translation is not workring only for WEBSHOP,"### Information about bug

Translation does not work for any language on webshop. I mean if i change erpnext language to any language or rewording English it reflects and gets translated/reworded very well on the DESK but when click on VIEW WEBSITE it dont sont reflect there. here is below screenshot for rewording the word of ""brand"" and it gets reworded/translated but on webshop nothing happens.

![image](https://github.com/user-attachments/assets/3258845d-2a3f-4da5-97bb-a02a144ce0d1)
![image](https://github.com/user-attachments/assets/6854bf9f-51e1-4f48-a732-be66b9964c7a)
![image](https://github.com/user-attachments/assets/c1d7ac4c-950e-49a3-a014-91de9d5a1cae)
**nothing gets translated from webshop**
![image](https://github.com/user-attachments/assets/50bb54f6-4e7f-4bed-8697-99a6411af140)
**the translation does on show also on the item cards details**
![image](https://github.com/user-attachments/assets/b7984d03-ab5b-4212-8508-4fed439ea8e0)



### Module

ecommerce

### Version

ERPNext: v15.36.4 (version-15)
ERPNext 15.43.0

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",Rebaz-balisani,2024-11-20 17:04:00+00:00,['iamejaaz'],2025-02-01 00:11:19+00:00,2025-01-17 11:00:12+00:00,https://github.com/frappe/erpnext/issues/44254,"[('bug', None)]","[{'comment_id': 2506434731, 'issue_id': 2676577445, 'author': 'Rebaz-balisani', 'body': '@Nihantra-Patel, please this is very important to be in next updates', 'created_at': datetime.datetime(2024, 11, 28, 16, 4, 35, tzinfo=datetime.timezone.utc)}]","Rebaz-balisani (Issue Creator) on (2024-11-28 16:04:35 UTC): @Nihantra-Patel, please this is very important to be in next updates

"
2675813926,issue,open,,A better Pricing Features with Tiered Pricing and Cumulative Tiered Pricing,"ERPNext‚Äôs basic pricing model doesn‚Äôt meet the needs of businesses that demand flexible, competitive, and dynamic pricing strategies. If the pricing module requires scripting to achieve even moderately complex configurations, it defeats the purpose of a user-friendly ERP.

Specifically, it lacks features for cumulative tiered pricing and tier-based flat rate pricing, which are essential for industries requiring flexible and detailed pricing models. Adding these features will significantly enhance ERPNext‚Äôs utility and competitiveness.

**Proposed Features:**

### 1. Cumulative Tiered Pricing
Definition:

Allow pricing to calculate the total cost by applying the price of each tier proportionally to the quantity within that tier.
For example:
Tier 1 (1‚Äì10 units): $10/unit
Tier 2 (11‚Äì20 units): $8/unit
Tier 3 (21+ units): $6/unit
If a customer purchases 25 units:
10 units at $10/unit = $100
10 units at $8/unit = $80
5 units at $6/unit = $30
Total = $210

Use Case:

Commonly used in wholesale, where pricing per unit decreases progressively as quantities increase.


------------------------------------------------------------------------------------------------------------------------------------------------
### 2. Tier-Based Flat Rate Pricing
Definition:

Allow flat rates to be applied for specific tiers instead of per-unit pricing, while maintaining tier-based pricing for other ranges.
For example:
From 1‚Äì10 units: $50 flat (regardless of quantity within this range).
From 11‚Äì20 units: $8/unit.
21+ units: $6/unit.
If a customer purchases 15 units:
Flat rate for the first 10 units = $50
5 units at $8/unit = $40
Total = $90
Use Case:

Ideal for scenarios where small quantities need a fixed cost (e.g., packaging fees, setup costs) but larger orders follow tiered pricing.

-------------------------------------------------------------------------------------------------------------------------------------------------

### Case Example:

Imagine having a service that is charged depending on the number of page worked on. For 1 to 10 pages, we want to charge a flat rate of $650. For 11 to 30 pages we charge $650+ $100/pages. For 31 to 100 pages we charge $650 + $100x20pages + $90/pages.

This is a very common pricing model used for wholesales companies and services based companies. It's impossible to do it with ERPnext Pricing Rules.

### Suggested implementation
Adding the Tiers directly to the Item when creating them and applying the rules using the pricing rules feature. For each tier we should be able to decide between a flat rate or an UOM based rate. 
",momardia54,2024-11-20 13:14:25+00:00,[],2024-11-20 13:29:18+00:00,,https://github.com/frappe/erpnext/issues/44252,"[('feature-request', None)]",[],
2675324497,issue,open,,Task selected error,"### Information about bug


![Capture d‚Äô√©cran(erreur)](https://github.com/user-attachments/assets/12e527e0-e5cf-4d1d-9ee6-394d47911b83)

![Capture d‚Äô√©cran(erreur)](https://github.com/user-attachments/assets/fc24a160-d720-48b2-b760-4ea566e9559c)
error when choosing task on employee count

### Module

projects

### Version

v15.5.0

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""erpnext"": ""15.6.0"",
	""frappe"": ""15.5.0"",
	""hrms"": ""15.5.0"",
	""payments"": ""0.0.1""
}
```
### Route
```
Workspaces/Gestion de t√¢ches ou Projects
```
### Traceback
```
Syntax error in query:
select distinct 
			from `tabProject`
			where `tabProject`.`status` = 'Open' 
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1715, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 880, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/reportview.py"", line 58, in get_count
    data = execute(**args)[0].get(""total_count"")
           ^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/reportview.py"", line 64, in execute
    return DatabaseQuery(doctype).execute(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/db_query.py"", line 203, in execute
    result = self.build_and_run()
             ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/db_query.py"", line 243, in build_and_run
    return frappe.db.sql(
           ^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 217, in sql
    self._cursor.execute(query, values)
  File ""env/lib/python3.11/site-packages/pymysql/cursors.py"", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/cursors.py"", line 322, in _query
    conn.query(q)
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 558, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 822, in _read_query_result
    result.read()
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 1200, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 772, in _read_packet
    packet.raise_for_error()
  File ""env/lib/python3.11/site-packages/pymysql/protocol.py"", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File ""env/lib/python3.11/site-packages/pymysql/err.py"", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.ProgrammingError: (1064, ""You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'from `tabProject`\n\t\t\twhere `tabProject`.`status` = 'Open'' at line 2"")

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""doctype"": ""Project"",
		""filters"": ""{\""status\"":\""Open\""}"",
		""fields"": ""[]"",
		""distinct"": false
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.reportview.get_count"",
	""request_id"": null
}
```
### Response Data
```
{
	""exception"": ""pymysql.err.ProgrammingError: (1064, \""You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'from `tabProject`\\n\\t\\t\\twhere `tabProject`.`status` = 'Open'' at line 2\"")"",
	""exc_type"": ""ProgrammingError""
}
```
```
",jasonjasonlife,2024-11-20 10:22:58+00:00,['nabinhait'],2025-01-14 12:51:47+00:00,,https://github.com/frappe/erpnext/issues/44248,"[('bug', None)]","[{'comment_id': 2589835171, 'issue_id': 2675324497, 'author': 'nabinhait', 'body': 'This seems like a misconfiguration, can you provide the steps to replicate the issue?', 'created_at': datetime.datetime(2025, 1, 14, 12, 51, 36, tzinfo=datetime.timezone.utc)}]","nabinhait (Assginee) on (2025-01-14 12:51:36 UTC): This seems like a misconfiguration, can you provide the steps to replicate the issue?

"
2675306989,issue,closed,not_planned,Subcontracting Receipt - To Purchase Receipt - No Validation - Only Added 1 item in Purchase Receipt - Loop,"### Information about bug

While creating a Purchase Receipt from a Subcontracting Receipt items are missing in the Purchase Receipt.

Also connection tab data in Addition Cost.

https://github.com/user-attachments/assets/88257492-c5c5-49bc-8985-9cd338e6e766 

Looping Subcontracting Receipt to Purchase Receipt 


https://github.com/user-attachments/assets/fc339a83-1626-40fe-a6c9-0800a8a2ba3b





### Module

stock, buying

### Version

ERPNext: v15.42.0 (version-15)

Frappe Framework: v15.47.2 (version-15)

Frappe Whatsapp: v1.0.7 (master)

Hr Reports: v0.0.1 (main)

Frappe HR: v15.35.1 (version-15)

InOutTrack: v0.0.1 (develop)

India Compliance: v15.14.0 (version-15)

Print Designer: v1.4.3 (main)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",dineshpanchal93,2024-11-20 10:15:14+00:00,['mihir-kandoi'],2025-01-31 00:10:14+00:00,2025-01-16 05:55:38+00:00,https://github.com/frappe/erpnext/issues/44247,"[('bug', None)]","[{'comment_id': 2490450441, 'issue_id': 2675306989, 'author': 'dineshpanchal93', 'body': '@Nihantra-Patel \r\n\r\n2nd item is not being fetch if Different PO\r\n\r\nWhile creating an Sub-Receipt - Add two diff item from two dif POs\r\nthen this will come.', 'created_at': datetime.datetime(2024, 11, 21, 9, 7, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2504416526, 'issue_id': 2675306989, 'author': 'dineshpanchal93', 'body': '@Nihantra-Patel have you checked  the issue', 'created_at': datetime.datetime(2024, 11, 27, 17, 23, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2519261056, 'issue_id': 2675306989, 'author': 'dineshpanchal93', 'body': 'any update on this - same issue anyone is facing ?', 'created_at': datetime.datetime(2024, 12, 5, 6, 6, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2527743132, 'issue_id': 2675306989, 'author': 'mihir-kandoi', 'body': 'Can you provide steps to replicate this issue? Starting from creation of Purchase Order till Subcontracting Receipt.', 'created_at': datetime.datetime(2024, 12, 9, 12, 9, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2531718139, 'issue_id': 2675306989, 'author': 'dineshpanchal93', 'body': 'ok sure', 'created_at': datetime.datetime(2024, 12, 10, 14, 0, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2589764579, 'issue_id': 2675306989, 'author': 'mihir-kandoi', 'body': '@dineshpanchal93 please provide replication steps.', 'created_at': datetime.datetime(2025, 1, 14, 12, 17, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2594595956, 'issue_id': 2675306989, 'author': 'mihir-kandoi', 'body': 'Closing as no replication steps provided. Please open a new issue if you continue to face this problem.', 'created_at': datetime.datetime(2025, 1, 16, 5, 55, 38, tzinfo=datetime.timezone.utc)}]","dineshpanchal93 (Issue Creator) on (2024-11-21 09:07:21 UTC): @Nihantra-Patel 

2nd item is not being fetch if Different PO

While creating an Sub-Receipt - Add two diff item from two dif POs
then this will come.

dineshpanchal93 (Issue Creator) on (2024-11-27 17:23:53 UTC): @Nihantra-Patel have you checked  the issue

dineshpanchal93 (Issue Creator) on (2024-12-05 06:06:41 UTC): any update on this - same issue anyone is facing ?

mihir-kandoi (Assginee) on (2024-12-09 12:09:19 UTC): Can you provide steps to replicate this issue? Starting from creation of Purchase Order till Subcontracting Receipt.

dineshpanchal93 (Issue Creator) on (2024-12-10 14:00:11 UTC): ok sure

mihir-kandoi (Assginee) on (2025-01-14 12:17:04 UTC): @dineshpanchal93 please provide replication steps.

mihir-kandoi (Assginee) on (2025-01-16 05:55:38 UTC): Closing as no replication steps provided. Please open a new issue if you continue to face this problem.

"
2673270663,issue,open,,Item Stock Level showing wrong Reserved Quantity,"### Information about bug

The Item Stock Level show a **Reserved Quantity** of **2**.
There is no material request, sales order, work order, sales invoices, stock entry, pick list that are open that could cause this demand.
![image](https://github.com/user-attachments/assets/e2821eb6-71d0-461c-b06c-8c91a25d7eae)

The **Bin** for that item also shows a **Reserved Quantity** of **2** as well as a **Projected Quantity** of **-2**.
![image](https://github.com/user-attachments/assets/aaa42753-ec8e-46d3-b036-028a06ff1f7b)

The **item** was part of a product bundle.
I created a sales order and added the product bundle as row item no1 with a quantity of 2.
After submitting the sales order, I created a Delivery Note. However, I received an error message indicating that there were no available inventory units for one of the **item** in the product bundle.
I then edited the product bundle to remove the problematic **item**.
Next, I returned to the sales order, clicked on ""Update Item,"" removed the product bundle, and then re-added it.
After doing so, a ghost reserved quantity of 2 was shown for the said **item**.



### Module

stock

### Version

Frappe Framework v15.48.0
ERPNext v15.42.0

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",SimTrudeau,2024-11-19 19:23:17+00:00,[],2024-11-19 19:23:17+00:00,,https://github.com/frappe/erpnext/issues/44227,"[('bug', None)]",[],
2671991033,issue,open,reopened,Net amount calculated incorrectly,"### Information about bug

On a Sales Invoice containing items with different tax rates, the tax net amount is not calculated correctly.

**Item Tax Template** ""7 %"":

![item_tax_templat_7](https://github.com/user-attachments/assets/23ac2b90-544e-4a8b-8f50-ac6465e95987)

**Item Tax Template** ""19 %"":

![item_tax_tenplate_19](https://github.com/user-attachments/assets/61523652-70da-4af1-adb8-a9bab15ec1d3)

**Sales Invoice**:

![sales_invoice](https://github.com/user-attachments/assets/88dad42e-52c6-4960-9131-500960ca7948)

Expected: The net amount per tax row is displayed as 100.
Actual: The net amount per tax row is displayed as 200.

### Module

accounts

### Version

develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

Likely introduced by https://github.com/frappe/erpnext/pull/43372",barredterra,2024-11-19 12:17:47+00:00,"['blaggacao', 'vorasmit']",2024-12-04 13:41:04+00:00,,https://github.com/frappe/erpnext/issues/44219,"[('bug', None)]","[{'comment_id': 2485709960, 'issue_id': 2671991033, 'author': 'blaggacao', 'body': 'Investigating...\r\n\r\nAt least `item_wise_tax_detail` is correct.\r\n\r\n```\r\nIn [4]: for t in si.taxes:\r\n   ...:     print(t.net_amount, t.item_wise_tax_detail)\r\n   ...:\r\n18403.36 {""ALMBOT1050"": {""tax_rate"": 19.0, ""tax_amount"": 1596.64, ""net_amount"": 8403.36}, ""ARAN500"": {""tax_rate"": 0.0, ""tax_amount"": 0.0, ""net_amount"": 10000.0}}\r\n18403.36 {""ALMBOT1050"": {""tax_rate"": 0.0,  ""tax_amount"": 0.0,     ""net_amount"": 8403.36}, ""ARAN500"": {""tax_rate"": 0.0, ""tax_amount"": 0.0, ""net_amount"": 10000.0}}\r\n```\r\n\r\nWith a new logger the issue becomes clearer:\r\n\r\n```log\r\n2024-11-19 15:16:35,518 DEBUG erpnext.controllers.taxes_and_totals Item 0 - ALMBOT1050\r\n2024-11-19 15:16:35,518 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 0 - IVA @ 19\r\n2024-11-19 15:16:35,519 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 16806.722689075632   tax_amount: 3193.27731092437\r\n2024-11-19 15:16:35,519 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 16806.72             tax_amount: 3193.28\r\n2024-11-19 15:16:35,519 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 1 - 240805 - IVA Descontable\r\n2024-11-19 15:16:35,521 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 16806.722689075632   tax_amount: 0.0\r\n2024-11-19 15:16:35,521 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 16806.72             tax_amount: 0.0\r\n2024-11-19 15:16:35,521 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 2 - Gastos de personal (fijo)\r\n2024-11-19 15:16:35,521 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 16806.722689075632   tax_amount: 10.071942677915228\r\n2024-11-19 15:16:35,521 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 16806.72             tax_amount: 10.07\r\n2024-11-19 15:16:35,522 DEBUG erpnext.controllers.taxes_and_totals Item 1 - ARAN500\r\n2024-11-19 15:16:35,522 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 0 - IVA @ 19\r\n2024-11-19 15:16:35,522 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 100000.0             tax_amount: 0.0\r\n2024-11-19 15:16:35,523 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 100000.0             tax_amount: 0.0\r\n2024-11-19 15:16:35,525 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 1 - 240805 - IVA Descontable\r\n2024-11-19 15:16:35,525 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 100000.0             tax_amount: 0.0\r\n2024-11-19 15:16:35,525 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 100000.0             tax_amount: 0.0\r\n2024-11-19 15:16:35,525 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 2 - Gastos de personal (fijo)\r\n2024-11-19 15:16:35,525 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 100000.0             tax_amount: 59.9280589335956\r\n2024-11-19 15:16:35,526 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 100000.0             tax_amount: 59.93\r\n```', 'created_at': datetime.datetime(2024, 11, 19, 13, 25, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2515352302, 'issue_id': 2671991033, 'author': 'barredterra', 'body': '@blaggacao as far as I can tell, this issue is still unresolved:\r\n\r\n![Bildschirmfoto 2024-12-03 um 19 56 41](https://github.com/user-attachments/assets/f732f405-26f6-4d8e-9a14-b05d6e3a2b01)', 'created_at': datetime.datetime(2024, 12, 3, 18, 58, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2515661315, 'issue_id': 2671991033, 'author': 'blaggacao', 'body': ""Hm, that is strange, indeed. There's an edge case that I had noted when the Account coincides in which case the attribution wasn't done correctly, but for different accounts this should have worked.\n\nJust to confirm: this is the value after (re-)saving? Or maybe a temporary client-js calculated value?"", 'created_at': datetime.datetime(2024, 12, 3, 22, 15, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2515715017, 'issue_id': 2671991033, 'author': 'barredterra', 'body': ""Yes, that's after saving and reloading. The tax accounts are different from each other."", 'created_at': datetime.datetime(2024, 12, 3, 22, 53, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2517270754, 'issue_id': 2671991033, 'author': 'blaggacao', 'body': '@barredterra I noticed that an Item, even if it only is eligible for `1776` has all tax set (the `0` value rate is not a niller here)  in their `item_tax_map`.\r\n\r\nBased on the presence of the key, they are (""correctly"") summed into the net amount, later on. If of any help, we could test the value for `null` / `None` respectively and interpret these value as nillers in case there\'s a reason (which I can\'t see yet) to keep the keys in that dictionary.\r\n\r\n![image](https://github.com/user-attachments/assets/95c2b557-9eb8-4ea8-ad3e-0d4bfca62766)\r\n\r\n\r\nThe same pattern is seen in the backend debug logs after save.\r\n```log\r\n==> erpnext.controllers.taxes_and_totals.log <==\r\n2024-12-04 13:55:53,720 DEBUG erpnext.controllers.taxes_and_totals Sales Invoice (ACC-SINV-2024-00006) ...\r\n2024-12-04 13:55:53,720 DEBUG erpnext.controllers.taxes_and_totals  Item 0: SKU001 - {\'1776 - Umsatzsteuer 19 % - TCD\': 19.0, \'1771 - Umsatzsteuer 7 % - TCD\': 0.0, \'1774 - Umsatzsteuer aus innergemeinschaftlichem Erwerb 19 % - TCD\': 19.0, \'1772 - Umsatzsteuer aus innergemeinschaftlichem Erwerb - TCD\': 0.0, \'1787 - Umsatzsteuer nach ¬ß 13b UStG 19 % - TCD\': 19.0, \'1785 - Umsatzsteuer nach ¬ß 13b UStG - TCD\': 0.0, \'1576 - Abziehbare Vorsteuer 19 % - TCD\': 19.0, \'1571 - Abziehbare Vorsteuer 7 % - TCD\': 0.0, \'1574 - Abziehbare Vorsteuer aus innergemeinschaftlichem Erwerb 19 % - TCD\': 19.0, \'1572 - Abziehbare Vorsteuer aus innergemeinschaftlichem Erwerb - TCD\': 0.0, \'1577 - Abziehbare Vorsteuer nach ¬ß 13b UStG 19 % - TCD\': 19.0, \'1541 - Abziehbare Vorsteuer nach ¬ß 13b UStG - TCD\': 0.0, \'1588 - Entstandene Einfuhrumsatzsteuer - TCD\': 19.0}\r\n2024-12-04 13:55:53,727 DEBUG erpnext.controllers.taxes_and_totals   net_amount: 1000.0               tax_amount: 190.0                - Umsatzsteuer 19 %\r\n2024-12-04 13:55:53,732 DEBUG erpnext.controllers.taxes_and_totals   net_amount: 1000.0               tax_amount: 0.0                  - Umsatzsteuer 7 %\r\n```', 'created_at': datetime.datetime(2024, 12, 4, 12, 54, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2517321938, 'issue_id': 2671991033, 'author': 'barredterra', 'body': 'There is no way to set a tax as not applicable, apart from setting it to zero. So the dict should likely only contain accounts where the applicable rate is not 0 for the respective item.', 'created_at': datetime.datetime(2024, 12, 4, 13, 17, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2517431899, 'issue_id': 2671991033, 'author': 'blaggacao', 'body': '> So the dict should likely only contain accounts where the applicable rate is not 0 for the respective item.\r\n\r\nThat in turn is unfortunately not possible, because `0` is a legitimate and meaningful tax rate distinct from ""no tax at all"".\r\n\r\n> There is no way to set a tax as not applicable, apart from setting it to zero\r\n\r\nI looked into the DE setup and it was genuinely news to me that the system could be used in such a way, but I can see how this is a useful feature to filter taxes based on the document\'s general tax template.\r\n\r\nThis feature also seems to be the true semantic meaning behind disabling the Account setting ""append item taxes to tax table"".\r\n\r\nSince it is, in essence an overlay data structure that was chosen to implement the feature, `nil` values become inherently significant. Their absence is a design flaw and shortcoming in the original implementation of that feature.\r\n\r\nI\'d suggest to modify the tax templates tables to add a check which signifies a nil value &mdash; potentially visible only if the respective accounting setting is disabled. When taxes from such templates are then assembled, this checkmark could cause them to be represented properly as `nil` values. Alternatively, a special sentinel value can be used (e.g. `-1`), but I could not think of one that is not also a legitimate rate.', 'created_at': datetime.datetime(2024, 12, 4, 13, 39, 58, tzinfo=datetime.timezone.utc)}]","blaggacao (Assginee) on (2024-11-19 13:25:39 UTC): Investigating...

At least `item_wise_tax_detail` is correct.

```
In [4]: for t in si.taxes:
   ...:     print(t.net_amount, t.item_wise_tax_detail)
   ...:
18403.36 {""ALMBOT1050"": {""tax_rate"": 19.0, ""tax_amount"": 1596.64, ""net_amount"": 8403.36}, ""ARAN500"": {""tax_rate"": 0.0, ""tax_amount"": 0.0, ""net_amount"": 10000.0}}
18403.36 {""ALMBOT1050"": {""tax_rate"": 0.0,  ""tax_amount"": 0.0,     ""net_amount"": 8403.36}, ""ARAN500"": {""tax_rate"": 0.0, ""tax_amount"": 0.0, ""net_amount"": 10000.0}}
```

With a new logger the issue becomes clearer:

```log
2024-11-19 15:16:35,518 DEBUG erpnext.controllers.taxes_and_totals Item 0 - ALMBOT1050
2024-11-19 15:16:35,518 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 0 - IVA @ 19
2024-11-19 15:16:35,519 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 16806.722689075632   tax_amount: 3193.27731092437
2024-11-19 15:16:35,519 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 16806.72             tax_amount: 3193.28
2024-11-19 15:16:35,519 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 1 - 240805 - IVA Descontable
2024-11-19 15:16:35,521 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 16806.722689075632   tax_amount: 0.0
2024-11-19 15:16:35,521 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 16806.72             tax_amount: 0.0
2024-11-19 15:16:35,521 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 2 - Gastos de personal (fijo)
2024-11-19 15:16:35,521 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 16806.722689075632   tax_amount: 10.071942677915228
2024-11-19 15:16:35,521 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 16806.72             tax_amount: 10.07
2024-11-19 15:16:35,522 DEBUG erpnext.controllers.taxes_and_totals Item 1 - ARAN500
2024-11-19 15:16:35,522 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 0 - IVA @ 19
2024-11-19 15:16:35,522 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 100000.0             tax_amount: 0.0
2024-11-19 15:16:35,523 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 100000.0             tax_amount: 0.0
2024-11-19 15:16:35,525 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 1 - 240805 - IVA Descontable
2024-11-19 15:16:35,525 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 100000.0             tax_amount: 0.0
2024-11-19 15:16:35,525 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 100000.0             tax_amount: 0.0
2024-11-19 15:16:35,525 DEBUG erpnext.controllers.taxes_and_totals   Tax/Charge 2 - Gastos de personal (fijo)
2024-11-19 15:16:35,525 DEBUG erpnext.controllers.taxes_and_totals   INIT : net_amount: 100000.0             tax_amount: 59.9280589335956
2024-11-19 15:16:35,526 DEBUG erpnext.controllers.taxes_and_totals   FINAL: net_amount: 100000.0             tax_amount: 59.93
```

barredterra (Issue Creator) on (2024-12-03 18:58:26 UTC): @blaggacao as far as I can tell, this issue is still unresolved:

![Bildschirmfoto 2024-12-03 um 19 56 41](https://github.com/user-attachments/assets/f732f405-26f6-4d8e-9a14-b05d6e3a2b01)

blaggacao (Assginee) on (2024-12-03 22:15:43 UTC): Hm, that is strange, indeed. There's an edge case that I had noted when the Account coincides in which case the attribution wasn't done correctly, but for different accounts this should have worked.

Just to confirm: this is the value after (re-)saving? Or maybe a temporary client-js calculated value?

barredterra (Issue Creator) on (2024-12-03 22:53:07 UTC): Yes, that's after saving and reloading. The tax accounts are different from each other.

blaggacao (Assginee) on (2024-12-04 12:54:30 UTC): @barredterra I noticed that an Item, even if it only is eligible for `1776` has all tax set (the `0` value rate is not a niller here)  in their `item_tax_map`.

Based on the presence of the key, they are (""correctly"") summed into the net amount, later on. If of any help, we could test the value for `null` / `None` respectively and interpret these value as nillers in case there's a reason (which I can't see yet) to keep the keys in that dictionary.

![image](https://github.com/user-attachments/assets/95c2b557-9eb8-4ea8-ad3e-0d4bfca62766)


The same pattern is seen in the backend debug logs after save.
```log
==> erpnext.controllers.taxes_and_totals.log <==
2024-12-04 13:55:53,720 DEBUG erpnext.controllers.taxes_and_totals Sales Invoice (ACC-SINV-2024-00006) ...
2024-12-04 13:55:53,720 DEBUG erpnext.controllers.taxes_and_totals  Item 0: SKU001 - {'1776 - Umsatzsteuer 19 % - TCD': 19.0, '1771 - Umsatzsteuer 7 % - TCD': 0.0, '1774 - Umsatzsteuer aus innergemeinschaftlichem Erwerb 19 % - TCD': 19.0, '1772 - Umsatzsteuer aus innergemeinschaftlichem Erwerb - TCD': 0.0, '1787 - Umsatzsteuer nach ¬ß 13b UStG 19 % - TCD': 19.0, '1785 - Umsatzsteuer nach ¬ß 13b UStG - TCD': 0.0, '1576 - Abziehbare Vorsteuer 19 % - TCD': 19.0, '1571 - Abziehbare Vorsteuer 7 % - TCD': 0.0, '1574 - Abziehbare Vorsteuer aus innergemeinschaftlichem Erwerb 19 % - TCD': 19.0, '1572 - Abziehbare Vorsteuer aus innergemeinschaftlichem Erwerb - TCD': 0.0, '1577 - Abziehbare Vorsteuer nach ¬ß 13b UStG 19 % - TCD': 19.0, '1541 - Abziehbare Vorsteuer nach ¬ß 13b UStG - TCD': 0.0, '1588 - Entstandene Einfuhrumsatzsteuer - TCD': 19.0}
2024-12-04 13:55:53,727 DEBUG erpnext.controllers.taxes_and_totals   net_amount: 1000.0               tax_amount: 190.0                - Umsatzsteuer 19 %
2024-12-04 13:55:53,732 DEBUG erpnext.controllers.taxes_and_totals   net_amount: 1000.0               tax_amount: 0.0                  - Umsatzsteuer 7 %
```

barredterra (Issue Creator) on (2024-12-04 13:17:10 UTC): There is no way to set a tax as not applicable, apart from setting it to zero. So the dict should likely only contain accounts where the applicable rate is not 0 for the respective item.

blaggacao (Assginee) on (2024-12-04 13:39:58 UTC): That in turn is unfortunately not possible, because `0` is a legitimate and meaningful tax rate distinct from ""no tax at all"".


I looked into the DE setup and it was genuinely news to me that the system could be used in such a way, but I can see how this is a useful feature to filter taxes based on the document's general tax template.

This feature also seems to be the true semantic meaning behind disabling the Account setting ""append item taxes to tax table"".

Since it is, in essence an overlay data structure that was chosen to implement the feature, `nil` values become inherently significant. Their absence is a design flaw and shortcoming in the original implementation of that feature.

I'd suggest to modify the tax templates tables to add a check which signifies a nil value &mdash; potentially visible only if the respective accounting setting is disabled. When taxes from such templates are then assembled, this checkmark could cause them to be represented properly as `nil` values. Alternatively, a special sentinel value can be used (e.g. `-1`), but I could not think of one that is not also a legitimate rate.

"
2671332005,issue,open,,Float or Dynamic Account Type in ERPNext,"**The importance of Float or Dynamic Account Type**
1- Accounting Standards and Industry Practices
While traditional accounting standards might not explicitly define a ‚Äúfloat account,‚Äù the concept is common in certain financial systems, particularly in sectors where accounts need to be reclassified based on their balance nature (e.g., banking, treasury management, or project-based accounting).

Many accounting software systems offer similar functionality, often under different names, to provide flexibility for businesses with unique financial reporting needs. ERPNext‚Äôs adaptability could be a competitive advantage by including this feature.

2- Automating Period-End Adjustments
Manually changing the account type before issuing a period closing voucher might work for smaller setups but becomes cumbersome for larger organizations or those with multiple accounts requiring reclassification.

3- Automating the process, as suggested, still requires initial customization, testing, and maintenance. Incorporating this feature into ERPNext natively would save effort and reduce the potential for errors.

4- Flexibility and Scalability
A float account type would empower ERPNext users to handle more dynamic business scenarios without frequent manual intervention or workarounds.

5- This feature would particularly benefit multinational or multi-industry organizations that have to comply with varied reporting requirements, where account nature changes based on regulatory or operational needs.

6- Practical Use Case
For instance, an ‚Äúadvances from customers‚Äù account might have a credit balance (liability) when customers prepay but could shift to a debit balance (asset) if overpayments occur or adjustments are made. A float account type would simplify handling such scenarios.

7- User-Centric Enhancement
ERPNext is known for its user-focused design. Adding this feature would align with that philosophy by addressing diverse accounting needs, potentially increasing adoption in industries that demand such functionality.

8- Precedents in ERP Systems
Other ERP systems like SAP, Oracle, or Sage often support dynamic reclassification of accounts, demonstrating the practicality and demand for this feature.",hameedacpa,2024-11-19 08:48:47+00:00,[],2024-11-19 08:56:58+00:00,,https://github.com/frappe/erpnext/issues/44205,"[('feature-request', None)]","[{'comment_id': 2485079804, 'issue_id': 2671332005, 'author': 'hameedacpa', 'body': '![image](https://github.com/user-attachments/assets/fe3bc741-dc71-4d61-8f0e-93add69d78c2)\r\nThe fields should be redesigned and add check box to select if it is ""Fload Account""\r\nIn case it is float/dynamic account then the classifications and types should be based on Credit and Debit, I mean here if it is Debit balance where it should show in the chart of accounts and if it is Credit where is should show in chart of accounts', 'created_at': datetime.datetime(2024, 11, 19, 8, 56, 57, tzinfo=datetime.timezone.utc)}]","hameedacpa (Issue Creator) on (2024-11-19 08:56:57 UTC): ![image](https://github.com/user-attachments/assets/fe3bc741-dc71-4d61-8f0e-93add69d78c2)
The fields should be redesigned and add check box to select if it is ""Fload Account""
In case it is float/dynamic account then the classifications and types should be based on Credit and Debit, I mean here if it is Debit balance where it should show in the chart of accounts and if it is Credit where is should show in chart of accounts

"
2669117599,issue,closed,completed,Company Name is required,"### Information about bug

If a prospect is saved, it mandates a user to punch-in organization name , even if the customer group is selected as an  'Individual' and not Entity.
![image](https://github.com/user-attachments/assets/620dbc54-f329-4f56-8aa4-ab85ec82b5e2)


### Module

CRM

### Version

ERP and Frappe bench v15



### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Company Name is required*
```
",princessfrombabylon99,2024-11-18 16:26:53+00:00,[],2024-12-06 00:11:30+00:00,2024-11-21 10:34:36+00:00,https://github.com/frappe/erpnext/issues/44200,"[('bug', None)]","[{'comment_id': 2490746883, 'issue_id': 2669117599, 'author': 'Nihantra-Patel', 'body': 'Because naming set from the company_name\r\n\r\n![image](https://github.com/user-attachments/assets/316e8d0e-8300-4c69-8c07-0bcdd14aead6)', 'created_at': datetime.datetime(2024, 11, 21, 10, 34, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2490879777, 'issue_id': 2669117599, 'author': 'princessfrombabylon99', 'body': ""@Nihantra-Patel You want me to change 'company_name' to 'customer_name'? Could you please explain it a little bit . Is there any documentation link available to read upon?"", 'created_at': datetime.datetime(2024, 11, 21, 11, 34, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2490886640, 'issue_id': 2669117599, 'author': 'Nihantra-Patel', 'body': ""It's not a bug, Prospect id will be created from the company_name so if company_name is not existed then will throw the error so you have to enter the company name."", 'created_at': datetime.datetime(2024, 11, 21, 11, 37, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2490889060, 'issue_id': 2669117599, 'author': 'princessfrombabylon99', 'body': ""@Nihantra-Patel If a prospect is saved, it mandates a user to punch-in organization name , even if the customer **group** is selected as an '**Individual**' and not Entity. @NagariaHussain Could you please clarify this?"", 'created_at': datetime.datetime(2024, 11, 21, 11, 38, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2490896719, 'issue_id': 2669117599, 'author': 'princessfrombabylon99', 'body': 'For example, if a person expresses interest in purchasing a product or service, attends a sales presentation, or fits a specific target demographic, they can be considered a prospect, it can apply to individual people as well (as in B2C).', 'created_at': datetime.datetime(2024, 11, 21, 11, 42, 36, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-21 10:34:36 UTC): Because naming set from the company_name

![image](https://github.com/user-attachments/assets/316e8d0e-8300-4c69-8c07-0bcdd14aead6)

princessfrombabylon99 (Issue Creator) on (2024-11-21 11:34:55 UTC): @Nihantra-Patel You want me to change 'company_name' to 'customer_name'? Could you please explain it a little bit . Is there any documentation link available to read upon?

Nihantra-Patel on (2024-11-21 11:37:41 UTC): It's not a bug, Prospect id will be created from the company_name so if company_name is not existed then will throw the error so you have to enter the company name.

princessfrombabylon99 (Issue Creator) on (2024-11-21 11:38:53 UTC): @Nihantra-Patel If a prospect is saved, it mandates a user to punch-in organization name , even if the customer **group** is selected as an '**Individual**' and not Entity. @NagariaHussain Could you please clarify this?

princessfrombabylon99 (Issue Creator) on (2024-11-21 11:42:36 UTC): For example, if a person expresses interest in purchasing a product or service, attends a sales presentation, or fits a specific target demographic, they can be considered a prospect, it can apply to individual people as well (as in B2C).

"
2669068028,issue,closed,completed,Country Doctype should not allow to be renamed,"### Information about bug

Since the Country doctype is used to set the regional settings.
and this is hardcoded into apps and dependencies.

The Country doctype should not be allowed to be renamed.

### Module

accounts, regional

### Version

ERPNext: v15.42.0 (HEAD)
Frappe Framework: v15.47.2 (HEAD)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",meaziz,2024-11-18 16:05:14+00:00,[],2024-12-13 00:11:23+00:00,2024-11-28 10:17:48+00:00,https://github.com/frappe/erpnext/issues/44199,"[('bug', None)]","[{'comment_id': 2483487291, 'issue_id': 2669068028, 'author': 'meaziz', 'body': 'https://github.com/lavaloon-eg/ksa_compliance/issues/175#issuecomment-2483459251', 'created_at': datetime.datetime(2024, 11, 18, 16, 10, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2505754026, 'issue_id': 2669068028, 'author': 'akhilnarang', 'body': 'Resolved with https://github.com/frappe/frappe/pull/28596', 'created_at': datetime.datetime(2024, 11, 28, 10, 17, 49, tzinfo=datetime.timezone.utc)}]","meaziz (Issue Creator) on (2024-11-18 16:10:01 UTC): https://github.com/lavaloon-eg/ksa_compliance/issues/175#issuecomment-2483459251

akhilnarang on (2024-11-28 10:17:49 UTC): Resolved with https://github.com/frappe/frappe/pull/28596

"
2669052454,issue,open,,Auth for Administrator Account,"Could we add  Google Auth for **Administrator** account @rmehta 
![image](https://github.com/user-attachments/assets/312bd9cd-3ed4-440f-b8cb-0a060c435fbe)

Should be able to 'disable' it using a bench command or something during first install. 
",princessfrombabylon99,2024-11-18 15:58:54+00:00,[],2024-11-18 15:59:19+00:00,,https://github.com/frappe/erpnext/issues/44198,"[('feature-request', None)]",[],
2668247252,issue,open,,Quantity error in Purchase Return / Invoice,"### Information about bug

Purchase return quantity is added in Total quantity purchased during creation of PI.
Creating a video to show error would be great but it crossed the file size limit so, I am illustrating with images.

This is the original Purchase Order (PO): [ Including 13% VAT, amount = 122613 ]
![image](https://github.com/user-attachments/assets/32e9200b-6529-4ffd-b387-25891f29c39f)

These items were received at two different times partially.
![image](https://github.com/user-attachments/assets/f22168bb-20b6-4167-a80e-d1f7daf26bd4)
55854.70+66758.37 =~ 122613

The PRE-24-000326 has returns filed.
![image](https://github.com/user-attachments/assets/6de71572-98db-4f5a-bbca-d89c8abc1563)
![image](https://github.com/user-attachments/assets/0516fdb8-c8c5-4af5-9fa4-5b0f55a10774)

Our workflow was: 
PO created  on 2024.07.05 -> Purchase received on 2024.07.08 and 07.12 -> Purchase return on 2024.07.22

Now we are trying to create Purchase Invoices. 

A. From PO: because we thought it would be easier.

Issue 1:  We are seeing the returned item in orange color, meaning : to be received. If we create Purchase receipt again, the exact returned quantity shows up. ERPNext thinks this quantity is returned (may be faulty item received) and will be delivered again. But this quantity was **NOT rejected** during receipt but excess (not required because initial order was over estimated) quantity was returned. I think this should be handled differently. Anyway its not a big deal. Lets move on.

When trying to create PI from that PO, this table is fetched.
![image](https://github.com/user-attachments/assets/6de3b180-9925-4a90-830d-67655b31f60d)

All quantities are okay except the first one.

In PO: 348.88 
In PI: 418.30
Difference: 69.42

This is the exact quantity that was returned. (check screen shot above).

Luckily, the PI does not get submitted. But this quantity pulled is WRONG.


B. Create PI from Purchase receipts.

Lets start with the PR which has returns filed against.: PRE-24-00326
![image](https://github.com/user-attachments/assets/47b67401-1d40-492e-9ab4-2fa57d2b41df)

PI pulls right quantity (after return)
![image](https://github.com/user-attachments/assets/240d7401-9de5-4537-bbe3-50c8c4a2b0f6)

This PI is saved and submitted.

I again go on to create PI for another PR, saved and submitted.

Then I create Debit Note (PI from Purchase Return document)
![image](https://github.com/user-attachments/assets/e7bd2edc-7b41-48eb-a2a9-4a8600f0ad7f)

This is also saved and submitted.

Now lets check the GL.

![image](https://github.com/user-attachments/assets/1fd271ea-3737-48ae-8e93-6c34548f6263)
It shows a net payable of 104563 while it should only be : 122613 - 9025 = 113588

The problem here is: PI created from Purchase receipt (that has returns) deducted the amount and quantity worth the return and if our staff would create Debit note from Purchase return, the same transaction will now be double booked.

This problem would not have occured if PI were created first from PR and then Debit note/Purchase return was filed. 

May be ERPNext must restrict such transactions entry.





















### Module

buying

### Version

![image](https://github.com/user-attachments/assets/5bdbe3b7-c7b9-4267-a96b-f70bf59630c2)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",ajiragroup,2024-11-18 11:30:11+00:00,[],2024-11-18 11:30:11+00:00,,https://github.com/frappe/erpnext/issues/44192,"[('bug', None)]",[],
2663125506,issue,open,,default_success_action,"### Information about bug

default_success_action does not get translated
PR 43295 https://github.com/frappe/erpnext/pull/43295
does not work anyway
tested on develop and v15

### Module

other

### Version

Frappe Version - develop and 15.47.2
Erpnext Version -develop  and 15.42.0

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",mahsem,2024-11-15 20:58:47+00:00,[],2024-11-15 20:58:47+00:00,,https://github.com/frappe/erpnext/issues/44168,"[('bug', None)]",[],
2662496142,issue,open,,Issue with Invoicing Partial Timesheet Details,"### Information about bug

When I create a new Sales Invoice via the Sales Workspace and load the timesheets of a project via the Fetch Timesheet, all timesheets are marked as billed, even if there are still time bookings from other projects in the same timesheets. If I create a sales invoice directly via a project, I do not have this problem.

**Steps to reproduce the bug:**
1. Create a timesheet with multiple timesheet details for different projects.
   For example:
    - Timesheet Detail 1: 10 hours for Project 1, marked as billable.
    - Timesheet Detail 2: Hours for Project 2, also marked as billable.
![image](https://github.com/user-attachments/assets/ebcf5e55-0e36-406c-88a0-ed65b38fc1af)
2. Submit the timesheet.
3. Create a sales invoice via the sales workspace and use ""Fetch Timesheets"" to get billable hours for one of the projects (e.g., Project 1) from timesheets. You get 10 hours.
![Screenshot 2024-11-15 at 5 42 02‚ÄØPM](https://github.com/user-attachments/assets/e8aa2740-3b48-4a95-9966-371e586d3246)

4. After submitting the sales invoice, observe that all the hours in the timesheet are marked as billed, rather than just the hours for the invoiced project.
5. Attempt to create a sales invoice for the second project (e.g., Project 2). Notice that the remaining 10 hours no longer appear as available to invoice, even though they haven‚Äôt been invoiced yet.

**Expected Behavior:**
Only the hours associated with the invoiced project (e.g., Project 1) should be marked as billed, leaving the hours for other projects available for invoicing.

**Actual Behavior:**
The entire timesheet is marked as billed after invoicing one project, preventing further invoicing of other projects' hours.
![Screenshot 2024-11-15 at 5 28 55‚ÄØPM](https://github.com/user-attachments/assets/6434a714-ba31-40f7-97c6-ddac2b40082d)


**This bug can become a serious problem for companies.**

### Module

projects

### Version

Frappe Framework: v15.47.1
ERPNext: v15.41.1

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",SamuelHelbling,2024-11-15 16:31:58+00:00,[],2024-11-17 09:54:20+00:00,,https://github.com/frappe/erpnext/issues/44167,"[('bug', None)]",[],
2658470107,issue,open,,"On the journal entry page, in the Accounting Entries table  Viewing the balance of the account used","The Account Balance field for the selected account on the payment entry page also should appears on the Journal Entry page. 
![image](https://github.com/user-attachments/assets/dcb2f828-0155-48e5-a8ce-25c5388ac437)
![image](https://github.com/user-attachments/assets/acf6c7d4-caa9-42e4-bfd2-df432354e9b1)
",dryk0127,2024-11-14 11:08:49+00:00,[],2024-11-14 11:08:49+00:00,,https://github.com/frappe/erpnext/issues/44146,"[('feature-request', None)]",[],
2658337117,issue,open,,Cached Print Format Coming in unrelated document. ,"### Information about bug

Steps to Reproduce:
1. Open Sales Invoice > Click on Print > Select a custom Print format. 
2. while remaining on the same tab > go to journal entry or any other document > Click on Print, I am getting the Following error.
3. 
![image](https://github.com/user-attachments/assets/7f841ab0-0661-49f3-9507-bfa90075557f)

![image](https://github.com/user-attachments/assets/d40cfb50-8c22-499f-bd53-1b55e0016a1a)


### Module

other

### Version

![image](https://github.com/user-attachments/assets/c919dcf4-d255-408a-a83a-bc348470fa46)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
request.js:473 
 Traceback (most recent call last):
  File ""apps/frappe/frappe/utils/pdf.py"", line 44, in pdf_body_html
    return template.render(args, filters={""len"": len})
  File ""env/lib/python3.10/site-packages/jinja2/environment.py"", line 1301, in render
    self.environment.handle_exception()
  File ""env/lib/python3.10/site-packages/jinja2/environment.py"", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File ""<template>"", line 410, in top-level template code
  File ""env/lib/python3.10/site-packages/jinja2/sandbox.py"", line 387, in call
    return __self.format_string(fmt, args, kwargs, __obj)
  File ""env/lib/python3.10/site-packages/jinja2/sandbox.py"", line 374, in format_string
    rv = formatter.vformat(s, args, kwargs)
  File ""/usr/lib/python3.10/string.py"", line 165, in vformat
    result, _ = self._vformat(format_string, args, kwargs, used_args, 2)
  File ""/usr/lib/python3.10/string.py"", line 218, in _vformat
    result.append(self.format_field(obj, format_spec))
  File ""/usr/lib/python3.10/string.py"", line 235, in format_field
    return format(value, format_spec)
TypeError: unsupported format string passed to DebugUndefined.__format__

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1682, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/frappe/frappe/www/printview.py"", line 300, in get_html_and_style
    html = get_rendered_template(
  File ""apps/frappe/frappe/www/printview.py"", line 212, in get_rendered_template
    html = frappe.get_attr(hook_func[-1])(
  File ""apps/frappe/frappe/utils/pdf.py"", line 47, in pdf_body_html
    frappe.throw(
  File ""apps/frappe/frappe/__init__.py"", line 578, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 550, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 501, in _raise_exception
    raise exc
frappe.exceptions.PrintFormatError: Error in print format on line 410: unsupported format string passed to DebugUndefined.__format__
```
",RAhmed-Dev,2024-11-14 10:22:56+00:00,[],2025-01-02 11:54:54+00:00,,https://github.com/frappe/erpnext/issues/44144,"[('bug', None)]","[{'comment_id': 2567662693, 'issue_id': 2658337117, 'author': 'niyazrazak', 'body': '@ankush  , do you have any solution for this? I have been experiencing it since the start of version 15.', 'created_at': datetime.datetime(2025, 1, 2, 11, 54, 53, tzinfo=datetime.timezone.utc)}]","niyazrazak on (2025-01-02 11:54:53 UTC): @ankush  , do you have any solution for this? I have been experiencing it since the start of version 15.

"
2658214549,issue,closed,completed,TypeError: get_reference_details() takes 3 positional arguments but 5 were given,"### Information about bug

I get this message everytime i click on Create > Payment . from any invoice page. and my error go like the following
### App Versions
```
{
	""ecommerce_integrations"": ""1.20.0"",
	""erpnext"": ""14.65.1"",
	""frappe"": ""14.67.1"",
	""frappe_helper"": ""0.3.3"",
	""hospitality"": ""0.0.1"",
	""hrms"": ""16.0.0-dev"",
	""payments"": ""0.0.1"",
	""posawesome"": ""6.3.0"",
	""restaurant_management"": ""1.3.7"",
	""twilio_integration"": ""0.0.1""
}
```
### Route
```
Form/Purchase Invoice/ACC-PINV-2024-00241
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 95, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 47, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1608, in call
    return fn(*args, **newargs)
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 2111, in get_payment_entry
    pe.set_missing_ref_details()
  File ""apps/hrms/hrms/overrides/employee_payment_entry.py"", line 43, in set_missing_ref_details
    ref_details = get_payment_reference_details(
  File ""apps/hrms/hrms/overrides/employee_payment_entry.py"", line 214, in get_payment_reference_details
    return get_reference_details(
TypeError: get_reference_details() takes 3 positional arguments but 5 were given

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""dt"": ""Purchase Invoice"",
		""dn"": ""ACC-PINV-2024-00241""
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/erpnext.accounts.doctype.payment_entry.payment_entry.get_payment_entry""
}
```
### Response Data
```
{
	""exc_type"": ""DoesNotExistError"",
	""exception"": ""TypeError: get_reference_details() takes 3 positional arguments but 5 were given""
}
```

### Module

accounts, buying

### Version

""erpnext"": ""14.65.1"",
	""frappe"": ""14.67.1"",

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""ecommerce_integrations"": ""1.20.0"",
	""erpnext"": ""14.65.1"",
	""frappe"": ""14.67.1"",
	""frappe_helper"": ""0.3.3"",
	""hospitality"": ""0.0.1"",
	""hrms"": ""16.0.0-dev"",
	""payments"": ""0.0.1"",
	""posawesome"": ""6.3.0"",
	""restaurant_management"": ""1.3.7"",
	""twilio_integration"": ""0.0.1""
}
```
### Route
```
Form/Purchase Invoice/ACC-PINV-2024-00241
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 95, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 47, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1608, in call
    return fn(*args, **newargs)
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 2111, in get_payment_entry
    pe.set_missing_ref_details()
  File ""apps/hrms/hrms/overrides/employee_payment_entry.py"", line 43, in set_missing_ref_details
    ref_details = get_payment_reference_details(
  File ""apps/hrms/hrms/overrides/employee_payment_entry.py"", line 214, in get_payment_reference_details
    return get_reference_details(
TypeError: get_reference_details() takes 3 positional arguments but 5 were given

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""dt"": ""Purchase Invoice"",
		""dn"": ""ACC-PINV-2024-00241""
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/erpnext.accounts.doctype.payment_entry.payment_entry.get_payment_entry""
}
```
### Response Data
```
{
	""exc_type"": ""DoesNotExistError"",
	""exception"": ""TypeError: get_reference_details() takes 3 positional arguments but 5 were given""
}
```
```
",edkiefo,2024-11-14 09:36:55+00:00,[],2024-11-30 00:10:41+00:00,2024-11-14 11:39:54+00:00,https://github.com/frappe/erpnext/issues/44143,"[('bug', None)]","[{'comment_id': 2476132594, 'issue_id': 2658214549, 'author': 'Nihantra-Patel', 'body': ""This happened because you installed develop hrms, not version 14 hrms.\r\n\r\nIf you‚Äôve installed ERPNext in version 14, make sure the hrms is also in version 14 to prevent errors.\r\n\r\nWe tested in the latest version 14 so we haven't found the issue.\r\n\r\n[scrnli_NENN45b138KKyT.webm](https://github.com/user-attachments/assets/7d7b162a-28aa-4aab-817c-b33ba8d7dcc2)"", 'created_at': datetime.datetime(2024, 11, 14, 11, 39, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2477473981, 'issue_id': 2658214549, 'author': 'edkiefo', 'body': 'I have upgraded hrms to V14.35.1...now, it has come up with a different error, everytime i try to make payment.\r\npymysql.err.OperationalError: (1054, ""Unknown column \'outstanding_amount\' in \'field list\'"")\r\n\r\n### App Versions\r\n```\r\n{\r\n\t""ecommerce_integrations"": ""1.20.0"",\r\n\t""erpnext"": ""14.75.1"",\r\n\t""frappe"": ""14.67.1"",\r\n\t""frappe_helper"": ""0.3.3"",\r\n\t""hospitality"": ""0.0.1"",\r\n\t""hrms"": ""14.35.1"",\r\n\t""payments"": ""0.0.1"",\r\n\t""posawesome"": ""6.3.0"",\r\n\t""restaurant_management"": ""1.3.7"",\r\n\t""twilio_integration"": ""0.0.1""\r\n}\r\n```\r\n### Route\r\n```\r\nForm/Purchase Invoice/ACC-PINV-2024-00241\r\n```\r\n### Traceback\r\n```\r\nTraceback (most recent call last):\r\n  File ""apps/frappe/frappe/app.py"", line 95, in application\r\n    response = frappe.api.handle()\r\n  File ""apps/frappe/frappe/api.py"", line 55, in handle\r\n    return frappe.handler.handle()\r\n  File ""apps/frappe/frappe/handler.py"", line 47, in handle\r\n    data = execute_cmd(cmd)\r\n  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd\r\n    return frappe.call(method, **frappe.form_dict)\r\n  File ""apps/frappe/frappe/__init__.py"", line 1608, in call\r\n    return fn(*args, **newargs)\r\n  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 2576, in get_payment_entry\r\n    allocate_open_payment_requests_to_references(pe.references, pe.precision(""paid_amount""))\r\n  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 2660, in allocate_open_payment_requests_to_references\r\n    references_open_payment_requests = get_open_payment_requests_for_references(references)\r\n  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 2602, in get_open_payment_requests_for_references\r\n    response = (\r\n  File ""apps/frappe/frappe/query_builder/utils.py"", line 87, in execute_query\r\n    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep\r\n  File ""apps/frappe/frappe/database/database.py"", line 244, in sql\r\n    self._cursor.execute(query, values)\r\n  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 158, in execute\r\n    result = self._query(query)\r\n  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 325, in _query\r\n    conn.query(q)\r\n  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 549, in query\r\n    self._affected_rows = self._read_query_result(unbuffered=unbuffered)\r\n  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 779, in _read_query_result\r\n    result.read()\r\n  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 1157, in read\r\n    first_packet = self.connection._read_packet()\r\n  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 729, in _read_packet\r\n    packet.raise_for_error()\r\n  File ""env/lib/python3.10/site-packages/pymysql/protocol.py"", line 221, in raise_for_error\r\n    err.raise_mysql_exception(self._data)\r\n  File ""env/lib/python3.10/site-packages/pymysql/err.py"", line 143, in raise_mysql_exception\r\n    raise errorclass(errno, errval)\r\npymysql.err.OperationalError: (1054, ""Unknown column \'outstanding_amount\' in \'field list\'"")\r\n\r\n```\r\n### Request Data\r\n```\r\n{\r\n\t""type"": ""POST"",\r\n\t""args"": {\r\n\t\t""dt"": ""Purchase Invoice"",\r\n\t\t""dn"": ""ACC-PINV-2024-00241""\r\n\t},\r\n\t""headers"": {},\r\n\t""error_handlers"": {},\r\n\t""url"": ""/api/method/erpnext.accounts.doctype.payment_entry.payment_entry.get_payment_entry""\r\n}\r\n```\r\n### Response Data\r\n```\r\n{\r\n\t""exc_type"": ""DoesNotExistError"",\r\n\t""exception"": ""pymysql.err.OperationalError: (1054, \\""Unknown column \'outstanding_amount\' in \'field list\'\\"")""\r\n}\r\n```\r\n\r\nPlease help, many thanks in advance', 'created_at': datetime.datetime(2024, 11, 14, 21, 47, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2477945730, 'issue_id': 2658214549, 'author': 'Nihantra-Patel', 'body': 'Did you migrate and build an app because of the issue in the version? We tested multiple sites, but we haven‚Äôt replicated the issue. Please try on a new site.', 'created_at': datetime.datetime(2024, 11, 15, 4, 37, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2478227009, 'issue_id': 2658214549, 'author': 'edkiefo', 'body': ""Hello Nihantra, thanks for the migrate hint. I certainly needed to execute \r\nbench --site {site} migrate \r\nnow it's smoothly working.\r\nQuestion, is it normal to be consuming up 2.8GB RAM running only frappe, erpnext and some modules?"", 'created_at': datetime.datetime(2024, 11, 15, 8, 32, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-14 11:39:54 UTC): This happened because you installed develop hrms, not version 14 hrms.

If you‚Äôve installed ERPNext in version 14, make sure the hrms is also in version 14 to prevent errors.

We tested in the latest version 14 so we haven't found the issue.

[scrnli_NENN45b138KKyT.webm](https://github.com/user-attachments/assets/7d7b162a-28aa-4aab-817c-b33ba8d7dcc2)

edkiefo (Issue Creator) on (2024-11-14 21:47:36 UTC): I have upgraded hrms to V14.35.1...now, it has come up with a different error, everytime i try to make payment.
pymysql.err.OperationalError: (1054, ""Unknown column 'outstanding_amount' in 'field list'"")

### App Versions
```
{
	""ecommerce_integrations"": ""1.20.0"",
	""erpnext"": ""14.75.1"",
	""frappe"": ""14.67.1"",
	""frappe_helper"": ""0.3.3"",
	""hospitality"": ""0.0.1"",
	""hrms"": ""14.35.1"",
	""payments"": ""0.0.1"",
	""posawesome"": ""6.3.0"",
	""restaurant_management"": ""1.3.7"",
	""twilio_integration"": ""0.0.1""
}
```
### Route
```
Form/Purchase Invoice/ACC-PINV-2024-00241
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 95, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 47, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1608, in call
    return fn(*args, **newargs)
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 2576, in get_payment_entry
    allocate_open_payment_requests_to_references(pe.references, pe.precision(""paid_amount""))
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 2660, in allocate_open_payment_requests_to_references
    references_open_payment_requests = get_open_payment_requests_for_references(references)
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 2602, in get_open_payment_requests_for_references
    response = (
  File ""apps/frappe/frappe/query_builder/utils.py"", line 87, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
  File ""apps/frappe/frappe/database/database.py"", line 244, in sql
    self._cursor.execute(query, values)
  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 158, in execute
    result = self._query(query)
  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 325, in _query
    conn.query(q)
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 549, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 779, in _read_query_result
    result.read()
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 1157, in read
    first_packet = self.connection._read_packet()
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 729, in _read_packet
    packet.raise_for_error()
  File ""env/lib/python3.10/site-packages/pymysql/protocol.py"", line 221, in raise_for_error
    err.raise_mysql_exception(self._data)
  File ""env/lib/python3.10/site-packages/pymysql/err.py"", line 143, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, ""Unknown column 'outstanding_amount' in 'field list'"")

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""dt"": ""Purchase Invoice"",
		""dn"": ""ACC-PINV-2024-00241""
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/erpnext.accounts.doctype.payment_entry.payment_entry.get_payment_entry""
}
```
### Response Data
```
{
	""exc_type"": ""DoesNotExistError"",
	""exception"": ""pymysql.err.OperationalError: (1054, \""Unknown column 'outstanding_amount' in 'field list'\"")""
}
```

Please help, many thanks in advance

Nihantra-Patel on (2024-11-15 04:37:42 UTC): Did you migrate and build an app because of the issue in the version? We tested multiple sites, but we haven‚Äôt replicated the issue. Please try on a new site.

edkiefo (Issue Creator) on (2024-11-15 08:32:00 UTC): Hello Nihantra, thanks for the migrate hint. I certainly needed to execute 
bench --site {site} migrate 
now it's smoothly working.
Question, is it normal to be consuming up 2.8GB RAM running only frappe, erpnext and some modules?

"
2657960582,issue,closed,completed,Payment Entry In Words is wrong if not company currency,"### Information about bug

When the payment made is not in company currency, the base_in_words and the in_words field have the same value. When I checked the code, it seems to be incorrect.

If you look at the code below, you can see that if the payment type is Receive, then the amount used to print is received_amount and vice versa for paid. Please check the below screenshots

![image](https://github.com/user-attachments/assets/d8fb7370-b291-46ab-8b5d-bfbe71c2d4f1)

As you can see if it is Receive, then the amount actually comes in paid_amount and base_paid_amount but the function takes received_amount and base_received_amount and vice versa for Pay.
Hence the In words comes like this

![image](https://github.com/user-attachments/assets/032b1a58-9c57-4fb5-9ba1-e4b8f762fea0)

Both company currency and the other in words are the same data.

### Module

accounts

### Version

Frappe Version: v15.47.2 (version-15)
ERPNext Version: v15.41.1 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
def set_total_in_words(self):
		from frappe.utils import money_in_words

		if self.payment_type in (""Pay"", ""Internal Transfer""):
			base_amount = abs(self.base_paid_amount)
			amount = abs(self.paid_amount)
			currency = self.paid_from_account_currency
		elif self.payment_type == ""Receive"":
			base_amount = abs(self.base_received_amount)
			amount = abs(self.received_amount)
			currency = self.paid_to_account_currency

		self.base_in_words = money_in_words(base_amount, self.company_currency)
		self.in_words = money_in_words(amount, currency)
```
",JesTom94,2024-11-14 08:01:58+00:00,[],2024-11-30 00:10:42+00:00,2024-11-15 05:03:46+00:00,https://github.com/frappe/erpnext/issues/44141,"[('bug', None)]","[{'comment_id': 2477968008, 'issue_id': 2657960582, 'author': 'Nihantra-Patel', 'body': 'The code you‚Äôre using for showing the amount in words is set up correctly. It works like this: when you make a payment, the code checks if the payment type is ""Pay"" or ""Receive."" If it‚Äôs ""Pay,"" it uses the amount from the ""paid"" fields and the currency of the account where the money is coming from. If it‚Äôs ""Receive,"" it uses the amount from the ""received"" fields and the currency of the account where the money is going.\r\n\r\nThe code then creates two versions of the amount in words:\r\n- One in the company‚Äôs currency.\r\n- One in the currency of the account used in the transaction.\r\n\r\nThe text in words might look the same even though they‚Äôre actually in different currencies. This is normal and doesn‚Äôt mean there‚Äôs an error in the code.', 'created_at': datetime.datetime(2024, 11, 15, 5, 3, 46, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-15 05:03:46 UTC): The code you‚Äôre using for showing the amount in words is set up correctly. It works like this: when you make a payment, the code checks if the payment type is ""Pay"" or ""Receive."" If it‚Äôs ""Pay,"" it uses the amount from the ""paid"" fields and the currency of the account where the money is coming from. If it‚Äôs ""Receive,"" it uses the amount from the ""received"" fields and the currency of the account where the money is going.

The code then creates two versions of the amount in words:
- One in the company‚Äôs currency.
- One in the currency of the account used in the transaction.

The text in words might look the same even though they‚Äôre actually in different currencies. This is normal and doesn‚Äôt mean there‚Äôs an error in the code.

"
2657814863,issue,open,,"Unreconciling a Payment Entry Removes the Reconciliation Entry, Affecting Trial Balance","### Information about bug

When a payment entry is unreconciled, the original entry which is created after reconciliation is removed from the system, which causes an issue in the trial balance. This behavior is incorrect as it impacts the accuracy of financial reports. The system should create a separate cancellation entry on the same date to ensure that the trial balance remains accurate.

Below example shows the issue, We have posted the payment entry on 13/09/24 and reconciled it on 09/11/24. When we unreconciled it the entry posted on 09/11/24 is got removed and Trial balance get changed.

![image](https://github.com/user-attachments/assets/919e8579-cd8c-41ae-bbd3-74d7ec564d73)
![image](https://github.com/user-attachments/assets/c554e44f-b2dc-48a7-9657-3d96ce2369dd)
![image](https://github.com/user-attachments/assets/c4555550-e402-47a2-9163-b1748216a5e6)
![image](https://github.com/user-attachments/assets/5bc315e7-d6ff-418b-a2c9-6284d57e2aaf)

**Steps to Reproduce:**
1.	Create a payment entry and reconcile it with an invoice.
2.	Unreconcile the payment entry.
3.	Check the trial balance or the related financial reports.
4.	Notice that the original payment entry is removed, affecting the trial balance.

**Expected Behavior:** When a payment entry is unreconciled, the system should not remove the entry. Instead, it should create a separate cancellation entry on the same date to keep the trial balance accurate.

**Actual Behavior:** The payment entry is removed when unreconciled, which leads to discrepancies in the trial balance.




### Module

accounts

### Version

ERPNext: v15.41.1 (version-15)

Frappe Framework: v15.47.1 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",parasonit,2024-11-14 06:56:33+00:00,['ruthra-kumar'],2024-11-18 12:35:23+00:00,,https://github.com/frappe/erpnext/issues/44135,"[('bug', None)]","[{'comment_id': 2481979711, 'issue_id': 2657814863, 'author': 'ruthra-kumar', 'body': '[Internal Ref](https://support.frappe.io/helpdesk/tickets/25442)', 'created_at': datetime.datetime(2024, 11, 18, 5, 20, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2482920119, 'issue_id': 2657814863, 'author': 'parasonit', 'body': ""**Clarification on Payment Reconciliation Entry and Trial Balance Impact**\r\nI would like to clarify the situation regarding the payment reconciliation for October 24 and its impact on the Trial Balance report.\r\n1.\t**Payment Reconciliation in October:** When the payment reconciliation was posted on October 24, the system created a below GL entry:\r\no\tDebit: Advance Account\r\no\tCredit: Customer Account.\r\n2.\t**Freeze of October Period:** After posting the reconciliation, the October period was frozen.\r\n3.\tIssue Identified in November: Upon review in November, it was noticed that the payment was incorrectly reconciled with the wrong invoice.\r\n4.\t**Impact of Cancelling the Entry:** To correct this, when we attempt to unreconcile the entry in November, the system automatically cancels the payment reconciliation entry created in October. This cancellation leads to an incorrect Trial Balance report. Specifically, the system shows the customer outstanding (asset) and the advance (liability) entries as open, which causes discrepancies in the report.\r\n5.\t**Proposed Solution:** Instead of cancelling the entry from October, the correct approach would be to post a reversal entry in November. This reversal entry would involve:\r\no\tDebit: Customer Account\r\no\tCredit: Advance Account.\r\nThis way, the Trial Balance report will remain accurate, reflecting the correct balances for both the closed period (October) and the current period (November).\r\n6.\t**Reason for Corrective Action:** As we are required to submit the Trial Balance report to the bank every month, cancelling the entry in the closed period (October) would create discrepancies in the report, which could lead to confusion or errors in our financial reporting.\r\nI hope this clarifies the situation. Please let me know if you need further details or if there's anything else we should address."", 'created_at': datetime.datetime(2024, 11, 18, 12, 35, 22, tzinfo=datetime.timezone.utc)}]","ruthra-kumar (Assginee) on (2024-11-18 05:20:19 UTC): [Internal Ref](https://support.frappe.io/helpdesk/tickets/25442)

parasonit (Issue Creator) on (2024-11-18 12:35:22 UTC): **Clarification on Payment Reconciliation Entry and Trial Balance Impact**
I would like to clarify the situation regarding the payment reconciliation for October 24 and its impact on the Trial Balance report.
1.	**Payment Reconciliation in October:** When the payment reconciliation was posted on October 24, the system created a below GL entry:
o	Debit: Advance Account
o	Credit: Customer Account.
2.	**Freeze of October Period:** After posting the reconciliation, the October period was frozen.
3.	Issue Identified in November: Upon review in November, it was noticed that the payment was incorrectly reconciled with the wrong invoice.
4.	**Impact of Cancelling the Entry:** To correct this, when we attempt to unreconcile the entry in November, the system automatically cancels the payment reconciliation entry created in October. This cancellation leads to an incorrect Trial Balance report. Specifically, the system shows the customer outstanding (asset) and the advance (liability) entries as open, which causes discrepancies in the report.
5.	**Proposed Solution:** Instead of cancelling the entry from October, the correct approach would be to post a reversal entry in November. This reversal entry would involve:
o	Debit: Customer Account
o	Credit: Advance Account.
This way, the Trial Balance report will remain accurate, reflecting the correct balances for both the closed period (October) and the current period (November).
6.	**Reason for Corrective Action:** As we are required to submit the Trial Balance report to the bank every month, cancelling the entry in the closed period (October) would create discrepancies in the report, which could lead to confusion or errors in our financial reporting.
I hope this clarifies the situation. Please let me know if you need further details or if there's anything else we should address.

"
2657046402,issue,open,,[Geolocation Field] Add address / search for address control,"**Is your feature request related to a problem? Please describe.**
Current Location feature in Asset management does not allow fetching geolocation from Address.

**Describe the solution you'd like**
The geolocation field can utilise a search feature such as https://developers.arcgis.com/esri-leaflet/samples/geocoding-control/
Or it should allow converting the Address into Geolocation",fzhan,2024-11-13 22:52:11+00:00,[],2024-11-13 22:52:11+00:00,,https://github.com/frappe/erpnext/issues/44131,"[('feature-request', None)]",[],
2654955779,issue,open,,Payment Reconciliation Program Does Not Consider Journal Voucher Entries for Reconciliation,"### Information about bug

**Description:**
In our business scenario, we are using Journal Vouchers (JVs) for recording bank charges and advance received from Customer. However, the standard Payment Reconciliation program in ERPNext does not consider Journal Voucher (JV) type documents during reconciliation.
This is causing discrepancies in the reconciliation process as the JV entries are not being included, resulting in incomplete or incorrect reconciliation.

**Steps to Reproduce:**
1.	Create a Journal Voucher (JV) for bank charges.
2.	Attempt to run the Payment Reconciliation program.
3.	Observe that the JV entry is not considered in the reconciliation process.
![image](https://github.com/user-attachments/assets/ad05b007-ee3b-43b8-8f42-9e5216d09aa4)
![image](https://github.com/user-attachments/assets/972d030e-32f2-4d50-9d87-5b40570dd1c4)

**Expected Behaviour:**
The Payment Reconciliation program should consider Journal Voucher entries (such as bank charges) during reconciliation so that the process completes correctly and accurately.
**Actual Behaviour:**
Journal Voucher entries are not considered in the Payment Reconciliation program, causing incomplete or incorrect reconciliation.
**Suggested Solution:**
Include Journal Voucher (JV) type documents in the Payment Reconciliation program logic so that all related transactions, including bank charges recorded via JVs, are included in the reconciliation 

**Additional Information:**
‚Ä¢	We are using Journal Vouchers specifically for recording bank charges, but the system currently ignores them during the reconciliation process.
‚Ä¢	Including the JV entries in the reconciliation would resolve this issue and ensure accurate accounting for bank charges.



### Module

accounts

### Version

ERPNext: v15.38.4 (version-15)

Frappe Framework: v15.35.0 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",parasonit,2024-11-13 10:19:19+00:00,['ruthra-kumar'],2024-11-18 05:11:32+00:00,,https://github.com/frappe/erpnext/issues/44121,"[('bug', None)]","[{'comment_id': 2481970624, 'issue_id': 2654955779, 'author': 'ruthra-kumar', 'body': '[Internal Ref](https://support.frappe.io/helpdesk/tickets/25383)', 'created_at': datetime.datetime(2024, 11, 18, 5, 11, 30, tzinfo=datetime.timezone.utc)}]","ruthra-kumar (Assginee) on (2024-11-18 05:11:30 UTC): [Internal Ref](https://support.frappe.io/helpdesk/tickets/25383)

"
2654911651,issue,open,,Payment Entry Cleared with Incorrect Date (Sales Invoice Date Instead of Current Date),"### Information about bug

We have posted a payment entry on 20-09-2024 and a sales invoice on 05-10-24, the system is incorrectly using the sales invoice date for the clearing process, rather than the current date or the user-defined date.
**Steps to Reproduce:**
1.	Create a Payment Entry on 20-09-24.
![image](https://github.com/user-attachments/assets/62baa418-e37d-4cfb-b485-e92743041edb)
2.	Create a Sales Invoice on 05-10-24
![image](https://github.com/user-attachments/assets/4e525d5b-ac35-4e69-a2e6-02ec41d63dbd)
3.	Attempt to clear the payment entry by linking it to the sales invoice.
5.	The system picks the sales invoice date (05-10-24) for the clearing entry, instead of using the current date(13-11-24) or the date specified by the user.
![image](https://github.com/user-attachments/assets/ff1e94eb-55cf-49e1-bfaa-2b3f331ee23d)

**Expected Result:** The clearing process should use the current date or a date that is manually selected by the user for the clearing, not the sales invoice date.

**Actual Result:** The system automatically uses the sales invoice date for the clearing process. This is resulting in incorrect accounting process.

**Suggested Fix:** Modify the logic to ensure that the date used for the clearing process is either the current date or a user-defined date, rather than defaulting to the sales invoice date.
@ruth

### Module

accounts

### Version

ERPNext: v15.38.4 (version-15)

Frappe Framework: v15.35.0 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",parasonit,2024-11-13 10:01:20+00:00,['ruthra-kumar'],2024-11-18 05:22:16+00:00,,https://github.com/frappe/erpnext/issues/44118,"[('bug', None)]","[{'comment_id': 2481981776, 'issue_id': 2654911651, 'author': 'ruthra-kumar', 'body': '[Internal Ref](https://support.frappe.io/helpdesk/tickets/25380)', 'created_at': datetime.datetime(2024, 11, 18, 5, 22, 14, tzinfo=datetime.timezone.utc)}]","ruthra-kumar (Assginee) on (2024-11-18 05:22:14 UTC): [Internal Ref](https://support.frappe.io/helpdesk/tickets/25380)

"
2652585870,issue,closed,completed,Submitting Work Order with connected Serial Number generates a second Serial Number.,"### Information about bug

1. Create Work Order for quantity (1) for an Item that Has Serial No and Save.
2. On Connections sheet, select Serial No and Add Serial No.
3. Enter information for new Serial No and Save.
4. Return to previous Work Order and inspect Connection sheet to see new Serial Number is connected to Work Order.
5. Submit Work Order.
6. Another Serial Number is created and connected to the Work Order.

This bug affects importing Work Orders and Serial Numbers from another ERP system.  After Work Orders are imported without being submitted, Serial Numbers are imported with the connected Work Order mentioned in the work_order field.  However, when the Work Orders are then submitted, a second Serial Number is created and connected to the Work Order.

System should check for existing number of connected Serial Numbers and only generate Serial Numbers if needed.

### Module

manufacturing

### Version

Frappe: v15.47.1
ERPNext: v15.41.1

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",northern-concrete,2024-11-12 15:46:06+00:00,[],2024-12-06 00:11:29+00:00,2024-11-21 16:04:48+00:00,https://github.com/frappe/erpnext/issues/44110,"[('bug', None)]","[{'comment_id': 2491647307, 'issue_id': 2652585870, 'author': 'rohitwaghchaure', 'body': '@northern-concrete If you don\'t want the system to create the serial nos automatically on submission of the work order, then disable the checkbox ""Make Serial No / Batch from Work Order"" in the manufacturing settings.', 'created_at': datetime.datetime(2024, 11, 21, 16, 4, 48, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure on (2024-11-21 16:04:48 UTC): @northern-concrete If you don't want the system to create the serial nos automatically on submission of the work order, then disable the checkbox ""Make Serial No / Batch from Work Order"" in the manufacturing settings.

"
2651391702,issue,open,,Production Plan Connections Not Updating,"Production Plan connections link not updating in Transaction for Material Request. But noted proper updates on Work Order.

ERPNext: v14.74.8 (version-14)
Frappe Framework: v14.84.0 (version-14)",jcagbay,2024-11-12 08:12:28+00:00,[],2024-11-12 08:12:28+00:00,,https://github.com/frappe/erpnext/issues/44101,"[('feature-request', None)]",[],
2651168126,issue,open,,Document Shared With field for filtering,"Currently, the system records the data of the user the document is assigned to.
In many cases, the documents are also 'Shared with' users and this is not filterable or the data is not extractable.

Assigned to user:
![Screenshot 2024-11-12 at 11 51 36](https://github.com/user-attachments/assets/6f95e29c-505c-4cf0-88d3-19b569107d00)


Shared with User:
![image](https://github.com/user-attachments/assets/29c63098-d895-4a04-9255-7264d60ce89d)

Not filterable:
![image](https://github.com/user-attachments/assets/b435f3af-862f-44c8-be02-f52872d5efa0)

",hpotabatti,2024-11-12 06:23:50+00:00,[],2024-11-13 06:08:04+00:00,,https://github.com/frappe/erpnext/issues/44099,"[('feature-request', None)]","[{'comment_id': 2472483595, 'issue_id': 2651168126, 'author': 'drthilina', 'body': '... was looking how to do this for days...', 'created_at': datetime.datetime(2024, 11, 13, 6, 8, 3, tzinfo=datetime.timezone.utc)}]","drthilina on (2024-11-13 06:08:03 UTC): ... was looking how to do this for days...

"
2650972488,issue,open,,[feature request] [feat] : Repack and Transfer for Manufacture,"### Use Case : 
In Manufacturing there are several cases when one item (RM) is **_cut_** (operation)  to generate multiple pieces (FG) which are used for the manufacturing.

As we know when the FG are multiple the only option is to use **Repack**.

e.g. it is defined in the BOM 
Sheet A - 5kg  ( Raw Material- One Input ) as  Batch item with Batch =  General 
but in the item description  specification is defined as below ( multiple Semi Finished Good - Multiple Output)
| Item    | Batch-Specification | Qty  
| -------- | ------- |------- |
| Sheet A  | B1 - 600mm X1200 mm |  2Kg 
| Sheet A  |  B2- 400mm x 1000mm  |3Kg

Option should be given in the Job Card for Stock Entry ( Material Transfer for Manufacture with Repack ) 

<img width=""1297"" alt=""Pasted Graphic"" src=""https://github.com/user-attachments/assets/d47c3f69-486b-4de5-b689-0b26248aedcf"">
which will help to supply Sheet A - 5kg by converting 5Kg in  two batches as below

| Item    | Batch-Specification | Qty  
| -------- | ------- |------- |
| Sheet A  | B1- 600mm X1200 mm |  2Kg 
| Sheet A  |  B2 -400mm x 1000mm  |3Kg


Design : Under the hood it is same purpose :  Repack   , but  it allows  two things in one go
Repack and Transfer for Manufacturing
",jigneshpshah,2024-11-12 04:20:56+00:00,[],2024-11-12 04:20:56+00:00,,https://github.com/frappe/erpnext/issues/44097,"[('feature-request', None)]",[],
2650869954,issue,open,,Consolidated Sales Analytics Report for Parent and Child Companies,"<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
A request to develop a Consolidated Sales Analytics report, reporting across all child companies under a parent company. This report shall allow users to quickly compare sales and identify which child companies are performing well or need attention.

**Describe the solution you'd like**
Consolidated Sales Analytics in which if a parent company is chosen, the analytics data would also include all the child company transactions or refactor the existing Sales Analytics report while solving its permission issues (43935) and also include this feature.

**Describe alternatives you've considered**
Currently, users must generate separate reports for each child company and manually combine them for analysis.",Vigneshsekar,2024-11-12 02:57:41+00:00,[],2024-11-12 02:57:41+00:00,,https://github.com/frappe/erpnext/issues/44096,"[('feature-request', None)]",[],
2649252592,issue,open,,Add Operations Support in BOM Creator Tool for Subassemblies,"
**Description:**

Currently, the **BOM Creator** in ERPNext only allows creating BOMs without operations. However, in multi-level BOMs, some subassemblies may require operations, while the main BOM does not. 

**Requested Enhancement:**
Please add the ability in the **BOM Creator Tool** to include operations specifically for subassemblies in multi-level BOMs. This would make the tool more flexible and efficient for users with complex assembly needs.

**Benefits:**
   **Flexibility:** Allows selective operations in multi-level BOMs.
   **Efficiency:** Reduces manual effort by allowing users to add operations directly when creating the BOM.",Akash8682,2024-11-11 12:51:09+00:00,[],2024-11-11 12:51:09+00:00,,https://github.com/frappe/erpnext/issues/44094,"[('feature-request', None)]",[],
2648471971,issue,open,,Accounting Dimension - Allow on Submit (For Repost Accounting Ledger Efficiency),"Accounting Dimension in every DocType is not all editable after submission.
Repost Accounting Entries only works perfectly in DocType like Purchase Invoice and Sales Invoice.

The Accounting Dimension that created from Accounting Dimension DocType is not editable in Journal Entry DocType
![image](https://github.com/user-attachments/assets/0f8074a1-1ae2-4285-a23b-94b8c8797f81)

All Accounting Dimension (Both default n custom) are not editable in Expense Claim DocType
![image](https://github.com/user-attachments/assets/d65dc4a9-24a5-4f0d-a098-0554e863c1a7)


Goals:
**All Accounting Dimension** both default (Cost Center, & Project) and Custom Accounting Dimension from Accounting Dimension DocType is all editable after submit and can have Repost Accounting Entries features
",Adhitya18,2024-11-11 07:44:34+00:00,[],2024-11-11 07:44:34+00:00,,https://github.com/frappe/erpnext/issues/44085,"[('feature-request', None)]",[],
2648386375,issue,closed,completed,Tax rate does not appear in tax table when product tax category is used,"### Information about bug

When I create a product tax category and use the template on a product line on my purchase invoice, the tax rate does not appear in the tax table. However, I specify the tax rate when setting the product tax category. Although the transaction is made at the rate specified in the category on the invoice, the tax rate does not appear in the tax table.
![image](https://github.com/user-attachments/assets/17dfc3da-71ca-472f-a4ba-7cb32f08c188)
![image](https://github.com/user-attachments/assets/a89f1ce5-c49e-457d-880a-cbf25b868bc8)
![image](https://github.com/user-attachments/assets/34db0b68-c824-48fd-812a-0dbf2f4427fc)



### Module

buying, selling

### Version

ERPNext: v15.x.x-develop () (develop)
Framework: v15.x.x-develop () (develop)
AND
ERPNext: v15.32.1
Frappe Framework: v15.37.0

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
{
    ""docs"": [
        {
            ""name"": ""ACC-PINV-2024-00120"",
            ""owner"": ""********"",
            ""creation"": ""2024-11-10 22:46:30.291164"",
            ""modified"": ""2024-11-10 22:46:30.291164"",
            ""modified_by"": ""********"",
            ""docstatus"": 0,
            ""idx"": 0,
            ""title"": """",
            ""naming_series"": ""ACC-PINV-.YYYY.-"",
            ""supplier"": ""********"",
            ""supplier_name"": ""********"",
            ""tax_id"": ""********"",
            ""company"": ""********"",
            ""posting_date"": ""2024-11-10"",
            ""posting_time"": ""22:46:30.704602"",
            ""set_posting_time"": 0,
            ""due_date"": ""2024-11-11"",
            ""is_paid"": 0,
            ""is_return"": 0,
            ""update_outstanding_for_self"": 1,
            ""update_billed_amount_in_purchase_order"": 0,
            ""update_billed_amount_in_purchase_receipt"": 1,
            ""apply_tds"": 0,
            ""currency"": ""TRY"",
            ""conversion_rate"": 1.0,
            ""use_transaction_date_exchange_rate"": 0,
            ""buying_price_list"": ""Standart Al\u0131m"",
            ""price_list_currency"": ""TRY"",
            ""plc_conversion_rate"": 1.0,
            ""ignore_pricing_rule"": 0,
            ""custom_estimated_sales_time"": ""0"",
            ""custom_estimated_profit_margin"": 0.0,
            ""update_stock"": 0,
            ""is_subcontracted"": 0,
            ""total_qty"": 1.0,
            ""total_net_weight"": 0.0,
            ""base_total"": 1000.0,
            ""base_net_total"": 1000.0,
            ""total"": 1000.0,
            ""net_total"": 1000.0,
            ""tax_withholding_net_total"": 1000.0,
            ""base_tax_withholding_net_total"": 1000.0,
            ""tax_category"": """",
            ""base_taxes_and_charges_added"": 200.0,
            ""base_taxes_and_charges_deducted"": 0.0,
            ""base_total_taxes_and_charges"": 200.0,
            ""taxes_and_charges_added"": 200.0,
            ""taxes_and_charges_deducted"": 0.0,
            ""total_taxes_and_charges"": 200.0,
            ""base_grand_total"": 1200.0,
            ""base_rounding_adjustment"": 0.0,
            ""base_rounded_total"": 1200.0,
            ""base_in_words"": ""TL Binikiy\u00fcz only."",
            ""grand_total"": 1200.0,
            ""rounding_adjustment"": 0.0,
            ""use_company_roundoff_cost_center"": 0,
            ""rounded_total"": 1200.0,
            ""in_words"": ""TL Binikiy\u00fcz only."",
            ""total_advance"": 0.0,
            ""outstanding_amount"": 1200.0,
            ""disable_rounded_total"": 0,
            ""apply_discount_on"": ""Grand Total"",
            ""base_discount_amount"": 0.0,
            ""additional_discount_percentage"": 0.0,
            ""discount_amount"": 0.0,
            ""other_charges_calculation"": ""<div class=\""tax-break-up\"" style=\""overflow-x: auto;\"">\n\t<table class=\""table table-bordered table-hover\"">\n\t\t<thead>\n\t\t\t<tr>\n\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t<th class=\""text-left\"">\u00dcr\u00fcn</th>\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t<th class=\""text-right\"">Vergiye Tabi Tutar</th>\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\t<th class=\""text-right\"">191.01.04 - % 20 KDV</th>\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t</tr>\n\t\t</thead>\n\t\t<tbody>\n\t\t\t\n\t\t\t\t<tr>\n\t\t\t\t\t<td>C27006-MANN</td>\n\t\t\t\t\t<td class=\""text-right\"">\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t\u20ba 1.000,00\n\t\t\t\t\t\t\n\t\t\t\t\t</td>\n\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<td class=\""text-right\"">\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t(20.0%)\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\u20ba 200,00\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t</tr>\n\t\t\t\n\t\t</tbody>\n\t</table>\n</div>"",
            ""base_paid_amount"": 0.0,
            ""paid_amount"": 0.0,
            ""allocate_advances_automatically"": 0,
            ""only_include_allocated_payments"": 0,
            ""write_off_amount"": 0.0,
            ""base_write_off_amount"": 0.0,
            ""shipping_address"": ""\u015eirket Adresi-Billing-2"",
            ""shipping_address_display"": ""********"",
            ""billing_address"": ""\u015eirket Adresi-Billing-2"",
            ""billing_address_display"": ""********"",
            ""ignore_default_payment_terms_template"": 0,
            ""status"": ""Draft"",
            ""per_received"": 0.0,
            ""credit_to"": ""320.01.B01 - ********"",
            ""party_account_currency"": ""TRY"",
            ""is_opening"": ""No"",
            ""against_expense_account"": ""940.02 - SEVK \u0130RSAL\u0130YES\u0130 KES\u0130LEN ANCAK FATURALANDIRILMAYAN - EG"",
            ""group_same_items"": 0,
            ""language"": ""tr"",
            ""on_hold"": 0,
            ""is_internal_supplier"": 0,
            ""represents_company"": """",
            ""is_old_subcontracting_flow"": 0,
            ""remarks"": ""A\u00e7\u0131klama yok"",
            ""doctype"": ""Purchase Invoice"",
            ""payment_schedule"": [
                {
                    ""name"": ""********"",
                    ""owner"": ""********"",
                    ""creation"": ""2024-11-10 22:46:33.827231"",
                    ""modified"": ""2024-11-10 22:46:33.827231"",
                    ""modified_by"": ""********"",
                    ""docstatus"": 0,
                    ""idx"": 1,
                    ""due_date"": ""2024-11-11"",
                    ""invoice_portion"": 100.0,
                    ""discount"": 0.0,
                    ""payment_amount"": 1200.0,
                    ""outstanding"": 1200.0,
                    ""paid_amount"": 0.0,
                    ""discounted_amount"": 0.0,
                    ""base_payment_amount"": 1200.0,
                    ""parent"": ""ACC-PINV-2024-00120"",
                    ""parentfield"": ""payment_schedule"",
                    ""parenttype"": ""Purchase Invoice"",
                    ""doctype"": ""Payment Schedule""
                }
            ],
            ""advance_tax"": [],
            ""supplied_items"": [],
            ""items"": [
                {
                    ""name"": ""14m3f9cbao"",
                    ""owner"": ""********"",
                    ""creation"": ""2024-11-10 22:46:30.291164"",
                    ""modified"": ""2024-11-10 22:46:30.291164"",
                    ""modified_by"": ""********"",
                    ""docstatus"": 0,
                    ""idx"": 1,
                    ""item_code"": ""C27006-MANN"",
                    ""item_name"": ""MERCEDES OM642 HAVA F\u0130LTRES\u0130 SA\u011e"",
                    ""description"": ""MERCEDES OM642 HAVA F\u0130LTRES\u0130 SA\u011e"",
                    ""brand"": ""MANN"",
                    ""item_group"": ""MERCEDES"",
                    ""image"": """",
                    ""received_qty"": 0.0,
                    ""qty"": 1.0,
                    ""rejected_qty"": 0.0,
                    ""uom"": ""Nos"",
                    ""conversion_factor"": 1.0,
                    ""stock_uom"": ""Nos"",
                    ""stock_qty"": 1.0,
                    ""price_list_rate"": 1000.0,
                    ""custom_kdv_dahil"": 0.0,
                    ""base_price_list_rate"": 1000.0,
                    ""margin_type"": """",
                    ""margin_rate_or_amount"": 0.0,
                    ""rate_with_margin"": 0.0,
                    ""discount_percentage"": 0.0,
                    ""discount_amount"": 0.0,
                    ""base_rate_with_margin"": 0.0,
                    ""custom_discount_percentage_1"": 0.0,
                    ""custom_discount_amount_1"": 0.0,
                    ""custom_discount_percentage_2"": 0.0,
                    ""custom_discount_amount_2"": 0.0,
                    ""custom_discount_percentage_3"": 0.0,
                    ""custom_discount_amount_3"": 0.0,
                    ""custom_discount_percentage_4"": 0.0,
                    ""custom_discount_amount_4"": 0.0,
                    ""custom_total_discount"": 0.0,
                    ""rate"": 1000.0,
                    ""amount"": 1000.0,
                    ""item_tax_template"": ""%20 KDV - EG"",
                    ""base_rate"": 1000.0,
                    ""base_amount"": 1000.0,
                    ""pricing_rules"": """",
                    ""stock_uom_rate"": 1000.0,
                    ""is_free_item"": 0,
                    ""apply_tds"": 1,
                    ""net_rate"": 1000.0,
                    ""net_amount"": 1000.0,
                    ""base_net_rate"": 1000.0,
                    ""base_net_amount"": 1000.0,
                    ""valuation_rate"": 1000.0,
                    ""item_tax_amount"": 0.0,
                    ""landed_cost_voucher_amount"": 0.0,
                    ""rm_supp_cost"": 0.0,
                    ""warehouse"": ""MERCEDES-BENZ YEDEK PAR\u00c7A DEPOSU - EG"",
                    ""use_serial_batch_fields"": 1,
                    ""expense_account"": ""940.02 - SEVK \u0130RSAL\u0130YES\u0130 KES\u0130LEN ANCAK FATURALANDIRILMAYAN - EG"",
                    ""is_fixed_asset"": 0,
                    ""enable_deferred_expense"": 0,
                    ""allow_zero_valuation_rate"": 0,
                    ""item_tax_rate"": ""{\""191.01.04 - % 20 KDV - EG\"": 20.0}"",
                    ""include_exploded_items"": 0,
                    ""weight_per_unit"": 0.0,
                    ""total_weight"": 0.0,
                    ""cost_center"": ""Main - EG"",
                    ""page_break"": 0,
                    ""parent"": ""ACC-PINV-2024-00120"",
                    ""parentfield"": ""items"",
                    ""parenttype"": ""Purchase Invoice"",
                    ""doctype"": ""Purchase Invoice Item""
                }
            ],
            ""advances"": [],
            ""pricing_rules"": [],
            ""taxes"": [
                {
                    ""name"": ""14m3ihhqbn"",
                    ""owner"": ""********"",
                    ""creation"": ""2024-11-10 22:46:30.291164"",
                    ""modified"": ""2024-11-10 22:46:30.291164"",
                    ""modified_by"": ""********m"",
                    ""docstatus"": 0,
                    ""idx"": 1,
                    ""category"": ""Total"",
                    ""add_deduct_tax"": ""Add"",
                    ""charge_type"": ""On Net Total"",
                    ""included_in_print_rate"": 0,
                    ""included_in_paid_amount"": 0,
                    ""account_head"": ""191.01.04 - % 20 KDV - EG"",
                    ""description"": ""191.01.04 - % 20 KDV"",
                    ""is_tax_withholding_account"": 0,
                    ""rate"": 0.0,
                    ""cost_center"": ""Main - EG"",
                    ""account_currency"": ""TRY"",
                    ""tax_amount"": 200.0,
                    ""tax_amount_after_discount_amount"": 200.0,
                    ""total"": 1200.0,
                    ""base_tax_amount"": 200.0,
                    ""base_total"": 1200.0,
                    ""base_tax_amount_after_discount_amount"": 200.0,
                    ""item_wise_tax_detail"": ""{\""C27006-MANN\"":[20.0,200.0]}"",
                    ""parent"": ""ACC-PINV-2024-00120"",
                    ""parentfield"": ""taxes"",
                    ""parenttype"": ""Purchase Invoice"",
                    ""doctype"": ""Purchase Taxes and Charges""
                }
            ],
            ""tax_withheld_vouchers"": [],
            ""__onload"": {
                ""make_payment_via_journal_entry"": 0,
                ""backflush_based_on"": ""BOM"",
                ""supplier_tds"": null
            }
        }
    ],
    ""docinfo"": {
        ""user_info"": {},
        ""comments"": [],
        ""shared"": [],
        ""assignment_logs"": [],
        ""attachment_logs"": [],
        ""info_logs"": [],
        ""like_logs"": [],
        ""workflow_logs"": [],
        ""doctype"": ""Purchase Invoice"",
        ""name"": ""ACC-PINV-2024-00120"",
        ""attachments"": [],
        ""communications"": [],
        ""automated_messages"": [],
        ""versions"": [],
        ""assignments"": [],
        ""permissions"": {
            ""if_owner"": {},
            ""has_if_owner_enabled"": false,
            ""select"": 0,
            ""read"": 1,
            ""write"": 1,
            ""create"": 1,
            ""delete"": 1,
            ""submit"": 1,
            ""cancel"": 1,
            ""amend"": 1,
            ""print"": 1,
            ""email"": 1,
            ""report"": 1,
            ""import"": 0,
            ""export"": 0,
            ""share"": 1
        },
        ""views"": [],
        ""energy_point_logs"": [],
        ""additional_timeline_content"": [],
        ""milestones"": [],
        ""is_document_followed"": null,
        ""tags"": """",
        ""document_email"": null
    },
    ""_link_titles"": {}
}
```
",dryk0127,2024-11-11 07:07:02+00:00,[],2024-12-03 00:12:24+00:00,2024-11-18 11:40:26+00:00,https://github.com/frappe/erpnext/issues/44079,"[('bug', None)]","[{'comment_id': 2482797805, 'issue_id': 2648386375, 'author': 'Nihantra-Patel', 'body': ""If the Sales/Purchase Taxes and Charges Template does not have a rate, but the Item Tax Template has a rate, the system will not apply it to the Sales Taxes and Charges. For example, if Item A has a 9% tax rate and Item B has a 12% tax rate, the system cannot decide which rate to use. This causes confusion, making it difficult for the system to determine the correct rate. It's merge the rate according to the Item Tax Template but as a result, no rate will be set, and it will appear in the **Taxes and Charges Calculation** with a tax rate. Please check all the images for more details.\r\n\r\n![image](https://github.com/user-attachments/assets/837576d3-e847-4d12-953d-c5780873bdfe)\r\n\r\n![image](https://github.com/user-attachments/assets/5749698f-f3b6-4f22-8974-f774cd9c6650)\r\n\r\n![image](https://github.com/user-attachments/assets/37bcacc3-bcab-41b3-8f52-df4980e2968e)"", 'created_at': datetime.datetime(2024, 11, 18, 11, 40, 26, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-11-18 11:40:26 UTC): If the Sales/Purchase Taxes and Charges Template does not have a rate, but the Item Tax Template has a rate, the system will not apply it to the Sales Taxes and Charges. For example, if Item A has a 9% tax rate and Item B has a 12% tax rate, the system cannot decide which rate to use. This causes confusion, making it difficult for the system to determine the correct rate. It's merge the rate according to the Item Tax Template but as a result, no rate will be set, and it will appear in the **Taxes and Charges Calculation** with a tax rate. Please check all the images for more details.

![image](https://github.com/user-attachments/assets/837576d3-e847-4d12-953d-c5780873bdfe)

![image](https://github.com/user-attachments/assets/5749698f-f3b6-4f22-8974-f774cd9c6650)

![image](https://github.com/user-attachments/assets/37bcacc3-bcab-41b3-8f52-df4980e2968e)

"
2648369578,issue,open,,Landed cost Voucher with Multi-Currency ,"Hi there,

If we could generate the landed cost voucher using invoices and receipts for multi-currency purchases, that would be fantastic. 


<img width=""1192"" alt=""Screenshot 2024-11-11 at 1 40 00 PM"" src=""https://github.com/user-attachments/assets/1caf55b0-c973-49e8-b052-c1743b785772"">

",thiyaguvignesh,2024-11-11 06:56:58+00:00,[],2024-11-11 08:16:52+00:00,,https://github.com/frappe/erpnext/issues/44076,"[('feature-request', None)]","[{'comment_id': 2467500416, 'issue_id': 2648369578, 'author': 'thiyaguvignesh', 'body': '@viralkansodiya', 'created_at': datetime.datetime(2024, 11, 11, 8, 16, 51, tzinfo=datetime.timezone.utc)}]","thiyaguvignesh (Issue Creator) on (2024-11-11 08:16:51 UTC): @viralkansodiya

"
