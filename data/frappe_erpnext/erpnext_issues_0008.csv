id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2385078349,issue,closed,completed,Executing erpnext.patches.v15_0.update_total_number_of_booked_depreciations,"### Information about bug

Executing erpnext.patches.v15_0.update_total_number_of_booked_depreciations

### Module

accounts

### Version

version-15 

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Updating DocTypes for frappe        : [========================================] 100%
Updating DocTypes for erpnext       : [========================================] 100%
Updating DocTypes for hrms          : [========================================] 100%
Updating DocTypes for india_compliance: [========================================] 100%
Updating DocTypes for reports       : [========================================] 100%
Updating DocTypes for addons_boms   : [========================================] 100%
Updating DocTypes for addon_s_stocks: [========================================] 100%
Updating DocTypes for hr_reports    : [========================================] 100%
Executing erpnext.patches.v15_0.update_total_number_of_booked_depreciations in blissteringepl.com (_289b398fca2e679f)
Queued rebuilding of search index for blissteringepl.com

Traceback with variables (most recent call last):
  File ""/usr/lib/python3.10/runpy.py"", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
      mod_name = 'frappe.utils.bench_helper'
      alter_argv = True
      mod_spec = ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7fdb3e7dd870>, origin='/home/blisstering/frappe-bench/apps/frappe/frappe/utils/bench_helper.py')
      code = <code object <module> at 0x7fdb3d1ad8f0, file ""/home/blisstering/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 1>
      main_globals = {'__name__': '__main__', '__doc__': None, '__package__': 'frappe.utils', '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x7fdb3e7dd870>, '__spec__': ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7fdb3e7dd870>, origin='/home/blisstering/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'), '__annotations__': {}, '__builtins__': <module 'builtins' (built-in)>, '__file__': '/home/blisstering/frappe-bench/apps/frappe/frappe/utils/bench_helper.py', '__cached__': '/home/blisstering/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc', 'importlib': <module 'importlib' from '/usr/lib/python3.10/importlib/__init__.py'>, 'json': <module 'json' from '/usr/lib/python3.10/json/__init__.py'>, 'os': <module 'os' from '/usr/lib/python3.10/os.py'>, 'traceback': <module 'traceback' from '/usr/lib/python3.10/traceback.py'>, 'warnings': <module 'warnings' from '/usr/lib/python3.10/warnings.py...
  File ""/usr/lib/python3.10/runpy.py"", line 86, in _run_code
    exec(code, run_globals)
      code = <code object <module> at 0x7fdb3d1ad8f0, file ""/home/blisstering/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 1>
      run_globals = {'__name__': '__main__', '__doc__': None, '__package__': 'frappe.utils', '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x7fdb3e7dd870>, '__spec__': ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7fdb3e7dd870>, origin='/home/blisstering/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'), '__annotations__': {}, '__builtins__': <module 'builtins' (built-in)>, '__file__': '/home/blisstering/frappe-bench/apps/frappe/frappe/utils/bench_helper.py', '__cached__': '/home/blisstering/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc', 'importlib': <module 'importlib' from '/usr/lib/python3.10/importlib/__init__.py'>, 'json': <module 'json' from '/usr/lib/python3.10/json/__init__.py'>, 'os': <module 'os' from '/usr/lib/python3.10/os.py'>, 'traceback': <module 'traceback' from '/usr/lib/python3.10/traceback.py'>, 'warnings': <module 'warnings' from '/usr/lib/python3.10/warnings.py...
      init_globals = None
      mod_name = '__main__'
      mod_spec = ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7fdb3e7dd870>, origin='/home/blisstering/frappe-bench/apps/frappe/frappe/utils/bench_helper.py')
      pkg_name = 'frappe.utils'
      script_name = None
      loader = <_frozen_importlib_external.SourceFileLoader object at 0x7fdb3e7dd870>
      fname = '/home/blisstering/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'
      cached = '/home/blisstering/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc'
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 114, in <module>
    main()
      ...skipped... 27 vars
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 20, in main
    click.Group(commands=commands)(prog_name=""bench"")
      commands = {'frappe': <Group frappe>, 'get-frappe-commands': <Command get-frappe-commands>, 'get-frappe-help': <Command get-frappe-help>}
  File ""/home/blisstering/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1157, in __call__
    return self.main(*args, **kwargs)
      self = <Group None>
      args = ()
      kwargs = {'prog_name': 'bench'}
  File ""/home/blisstering/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1078, in main
    rv = self.invoke(ctx)
      self = <Group None>
      args = ['frappe', '--site', 'blissteringepl.com', 'migrate']
      prog_name = 'bench'
      complete_var = None
      standalone_mode = True
      windows_expand_args = True
      extra = {}
      ctx = <click.core.Context object at 0x7fdb3d7f9b10>
  File ""/home/blisstering/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
      _process_result = <function MultiCommand.invoke.<locals>._process_result at 0x7fdb3d1d4940>
      args = ['migrate']
      cmd_name = 'frappe'
      cmd = <Group frappe>
      sub_ctx = <click.core.Context object at 0x7fdb3d079c30>
      ctx = <click.core.Context object at 0x7fdb3d7f9b10>
      self = <Group None>
      __class__ = <class 'click.core.MultiCommand'>
  File ""/home/blisstering/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
      _process_result = <function MultiCommand.invoke.<locals>._process_result at 0x7fdb3d26bb50>
      args = []
      cmd_name = 'migrate'
      cmd = <Command migrate>
      sub_ctx = <click.core.Context object at 0x7fdb3d07a4a0>
      ctx = <click.core.Context object at 0x7fdb3d079c30>
      self = <Group frappe>
      __class__ = <class 'click.core.MultiCommand'>
  File ""/home/blisstering/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
      self = <Command migrate>
      ctx = <click.core.Context object at 0x7fdb3d07a4a0>
  File ""/home/blisstering/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 783, in invoke
    return __callback(*args, **kwargs)
      _Context__self = <click.core.Context object at 0x7fdb3d07a4a0>
      _Context__callback = <function migrate at 0x7fdb3d234430>
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      ctx = <click.core.Context object at 0x7fdb3d07a4a0>
  File ""/home/blisstering/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py"", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      f = <function migrate at 0x7fdb3d2341f0>
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/commands/__init__.py"", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
      ctx = <click.core.Context object at 0x7fdb3d07a4a0>
      args = ()
      kwargs = {'skip_failing': False, 'skip_search_index': False}
      profile = False
      f = <function migrate at 0x7fdb3d234160>
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/commands/site.py"", line 613, in migrate
    SiteMigration(
      context = {'sites': ['blissteringepl.com'], 'force': False, 'verbose': False, 'profile': False}
      skip_failing = False
      skip_search_index = False
      activate_by_import = <module 'traceback_with_variables.activate_by_import' from '/home/blisstering/frappe-bench/env/lib/python3.10/site-packages/traceback_with_variables/activate_by_import.py'>
      SiteMigration = <class 'frappe.migrate.SiteMigration'>
      site = 'blissteringepl.com'
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/migrate.py"", line 186, in run
    self.run_schema_updates()
      self = <frappe.migrate.SiteMigration object at 0x7fdb3d07a5c0>
      site = 'blissteringepl.com'
      filelock = <function filelock at 0x7fdb3c766d40>
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/migrate.py"", line 52, in wrapper
    raise e
      args = (<frappe.migrate.SiteMigration object at 0x7fdb3d07a5c0>,)
      kwargs = {}
      method = <function SiteMigration.run_schema_updates at 0x7fdb3c766950>
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/migrate.py"", line 44, in wrapper
    ret = method(*args, **kwargs)
      args = (<frappe.migrate.SiteMigration object at 0x7fdb3d07a5c0>,)
      kwargs = {}
      method = <function SiteMigration.run_schema_updates at 0x7fdb3c766950>
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/migrate.py"", line 121, in run_schema_updates
    frappe.modules.patch_handler.run_all(
      self = <frappe.migrate.SiteMigration object at 0x7fdb3d07a5c0>
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 76, in run_all
    run_patch(patch)
      patch_type = <PatchType.post_model_sync: 'post_model_sync'>
      executed = {""execute:frappe.reload_doc('core', 'doctype', 'doctype_state', force=True) #2021-12-15"", 'execute:frappe.reload_doc(""erpnext_integrations"", ""doctype"", ""TaxJar Settings"")', 'hrms.patches.post_install.update_allocate_on_in_leave_type', 'erpnext.patches.v14_0.update_zero_asset_quantity_field', 'frappe.patches.v13_0.update_newsletter_content_type', 'erpnext.patches.v13_0.update_schedule_type_in_loans', ""execute:frappe.reload_doc('desk', 'doctype', 'number_card_link')"", ""execute:frappe.reload_doc('core', 'doctype', 'error_snapshot')"", 'india_compliance.patches.post_install.update_payment_entry_fields', 'execute:frappe.db.sql(""delete from `tabWeb Page` where ifnull(template_path, \'\')!=\'\'"")', 'frappe.patches.v13_0.rename_custom_client_script', 'frappe.patches.v12_0.move_form_attachments_to_attachments_folder', 'erpnext.patches.v14_0.create_accounting_dimensions_in_sales_order_item', 'erpnext.patches.v11_1.move_customer_lead_to_dynamic_column', 'execute:frappe.reload_doc(""desk"", ""doctype""...
      run_patch = <function run_all.<locals>.run_patch at 0x7fdb2ee0cb80>
      patches = [""execute:frappe.get_doc('Role', 'Guest').save() # remove desk access"", 'frappe.core.doctype.role.patches.v13_set_default_desk_properties', 'frappe.patches.v14_0.update_workspace2 # 06.06.2023', 'frappe.patches.v14_0.drop_data_import_legacy', 'frappe.patches.v14_0.copy_mail_data #08.03.21', 'frappe.patches.v14_0.update_github_endpoints #08-11-2021', 'frappe.patches.v14_0.remove_db_aggregation', 'frappe.patches.v14_0.update_color_names_in_kanban_board_column', 'frappe.patches.v14_0.update_is_system_generated_flag', 'frappe.patches.v14_0.update_auto_account_deletion_duration', 'frappe.patches.v14_0.update_integration_request', 'frappe.patches.v14_0.set_document_expiry_default', 'frappe.patches.v14_0.delete_data_migration_tool', 'frappe.patches.v14_0.set_suspend_email_queue_default', 'frappe.patches.v14_0.different_encryption_key', 'frappe.patches.v14_0.update_multistep_webforms', ""execute:frappe.delete_doc('Page', 'background_jobs', ignore_missing=True, force=True)"", 'frappe.patches.v14_...
      patch = 'erpnext.patches.v15_0.update_total_number_of_booked_depreciations'
      skip_failing = False
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 62, in run_patch
    if not run_single(patchmodule=patch):
      patch = 'erpnext.patches.v15_0.update_total_number_of_booked_depreciations'
      skip_failing = False
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 152, in run_single
    return execute_patch(patchmodule, method, methodargs)
      patchmodule = 'erpnext.patches.v15_0.update_total_number_of_booked_depreciations'
      method = None
      methodargs = None
      force = False
      conf = <LocalProxy unbound>
  File ""/home/blisstering/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 188, in execute_patch
    _patch()
      patchmodule = 'erpnext.patches.v15_0.update_total_number_of_booked_depreciations'
      method = None
      methodargs = None
      has_patch_file = True
      patch = 'erpnext.patches.v15_0.update_total_number_of_booked_depreciations.execute'
      docstring = ''
      _patch = <function execute at 0x7fdb2ed0c280>
      start_time = 1032686.359322773
  File ""/home/blisstering/frappe-bench/apps/erpnext/erpnext/patches/v15_0/update_total_number_of_booked_depreciations.py"", line 21, in execute
    for je in depr_schedule:
      assets = [{'name': 'ASS/2024-2024/00019', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00018', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00017', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00016', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00015', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00014', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00013', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00012', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00011', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00010', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00009', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00008', 'opening_number_of_booked_depreciations': 0}, {'name': 'ASS/2024-2024/00007', 'opening_number_of_booked_depre...
      asset = {'name': 'ASS/2023-2024/00056', 'opening_number_of_booked_depreciations': 0}
      asset_doc = <Asset: ASS/2023-2024/00056 docstatus=1>
      fb_row = <AssetFinanceBook: 19c8ec9e14 docstatus=1 parent=ASS/2023-2024/00056>
      depr_schedule = None
      total_number_of_booked_depreciations = 0
      je = <DepreciationSchedule: ae23069876 docstatus=1 parent=ACC-ADS-2024-00050>
```
",dineshpanchal93,2024-07-02 02:46:21+00:00,[],2024-07-25 00:09:03+00:00,2024-07-09 09:50:00+00:00,https://github.com/frappe/erpnext/issues/42137,"[('bug', None)]","[{'comment_id': 2202633779, 'issue_id': 2385078349, 'author': 'dineshpanchal93', 'body': 'ASS/2023-2024/00056 - asset is already sold', 'created_at': datetime.datetime(2024, 7, 2, 10, 6, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2213746542, 'issue_id': 2385078349, 'author': 'sagarvora', 'body': ""@dineshpanchal93 This is not the full traceback. It doesn't show the error at all."", 'created_at': datetime.datetime(2024, 7, 8, 11, 20, 32, tzinfo=datetime.timezone.utc)}]","dineshpanchal93 (Issue Creator) on (2024-07-02 10:06:09 UTC): ASS/2023-2024/00056 - asset is already sold

sagarvora on (2024-07-08 11:20:32 UTC): @dineshpanchal93 This is not the full traceback. It doesn't show the error at all.

"
2384464830,issue,closed,completed,Creation of Sales Order from Quotation Error when quotation_to is not Lead,"### Information about bug

The following lines need to be updated to match the new options for `quotation_to`, i.e. Prospect:

https://github.com/frappe/erpnext/blob/99f2735ad3440aa3690bb514b32d7d9610753041/erpnext/selling/doctype/quotation/quotation.py#L516-L523

@ruthra-kumar 
Related: #41040

### Module

selling, CRM

### Version

ERPNext: v15.22.2

![Screen Shot 2024-07-01 at 19 09 40](https://github.com/frappe/erpnext/assets/110036763/906c94be-9efa-4457-a2d3-9efe822c5f4c)


### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
{""exc_type"":""DoesNotExistError"",""_server_messages"":""[\""{\\\""message\\\"": \\\""Lead REDACTED not found\\\"", \\\""title\\\"": \\\""Message\\\"", \\\""indicator\\\"": \\\""red\\\"", \\\""raise_exception\\\"": 1, \\\""__frappe_exc_id\\\"": \\\""94a9bc1b8e4484bf38f08b1b6b958fba5b07ddd98795be65bd52871c\\\""}\""]""}
```
",casesolved-co-uk,2024-07-01 18:19:56+00:00,[],2024-09-06 00:09:39+00:00,2024-08-20 05:10:45+00:00,https://github.com/frappe/erpnext/issues/42136,"[('bug', None), ('valid', ''), ('released', None)]","[{'comment_id': 2202546627, 'issue_id': 2384464830, 'author': 'Nihantra-Patel', 'body': 'Kindly upgrade your version 15 because everything is working fine. No problems were encountered in the latest version 15.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/06bf00bb-15eb-41e5-8d8e-0356ebb8b5b6', 'created_at': datetime.datetime(2024, 7, 2, 9, 28, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202609861, 'issue_id': 2384464830, 'author': 'casesolved-co-uk', 'body': 'You tested from a LEAD not a PROSPECT\r\n\r\n@Nihantra-Patel', 'created_at': datetime.datetime(2024, 7, 2, 9, 59, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202614318, 'issue_id': 2384464830, 'author': 'Nihantra-Patel', 'body': 'share the video, or process flow and first update your version and then test it.', 'created_at': datetime.datetime(2024, 7, 2, 10, 0, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202621329, 'issue_id': 2384464830, 'author': 'casesolved-co-uk', 'body': '1. Create Prospect\r\n2. Create Quotation\r\n3. Create Sales Order', 'created_at': datetime.datetime(2024, 7, 2, 10, 2, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202627309, 'issue_id': 2384464830, 'author': 'casesolved-co-uk', 'body': ""I don't need to test it, the above referenced code is from v16 develop and does not cater for Prospects.\r\n\r\n@Nihantra-Patel"", 'created_at': datetime.datetime(2024, 7, 2, 10, 3, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202629415, 'issue_id': 2384464830, 'author': 'Nihantra-Patel', 'body': 'issue is in v15 or v16?', 'created_at': datetime.datetime(2024, 7, 2, 10, 4, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202632591, 'issue_id': 2384464830, 'author': 'casesolved-co-uk', 'body': 'All versions', 'created_at': datetime.datetime(2024, 7, 2, 10, 5, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202635266, 'issue_id': 2384464830, 'author': 'Nihantra-Patel', 'body': 'All version üòÖ\r\n\r\nLet me check!', 'created_at': datetime.datetime(2024, 7, 2, 10, 6, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2301155735, 'issue_id': 2384464830, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.33.3 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.33.3)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 8, 21, 5, 23, 47, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-07-02 09:28:25 UTC): Kindly upgrade your version 15 because everything is working fine. No problems were encountered in the latest version 15.


https://github.com/frappe/erpnext/assets/141945075/06bf00bb-15eb-41e5-8d8e-0356ebb8b5b6

casesolved-co-uk (Issue Creator) on (2024-07-02 09:59:41 UTC): You tested from a LEAD not a PROSPECT

@Nihantra-Patel

Nihantra-Patel on (2024-07-02 10:00:39 UTC): share the video, or process flow and first update your version and then test it.

casesolved-co-uk (Issue Creator) on (2024-07-02 10:02:01 UTC): 1. Create Prospect
2. Create Quotation
3. Create Sales Order

casesolved-co-uk (Issue Creator) on (2024-07-02 10:03:15 UTC): I don't need to test it, the above referenced code is from v16 develop and does not cater for Prospects.

@Nihantra-Patel

Nihantra-Patel on (2024-07-02 10:04:05 UTC): issue is in v15 or v16?

casesolved-co-uk (Issue Creator) on (2024-07-02 10:05:32 UTC): All versions

Nihantra-Patel on (2024-07-02 10:06:49 UTC): All version üòÖ

Let me check!

frappe-pr-bot on (2024-08-21 05:23:47 UTC): :tada: This issue has been resolved in version 15.33.3 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.33.3)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2383556355,issue,closed,completed,Create Quotation from web site,"### Information about bug

choose items at website
![image](https://github.com/frappe/erpnext/assets/62122640/7e0d6353-62be-40f6-961b-db22f802618a)

>> click add to quote 
>> go to quote
![image](https://github.com/frappe/erpnext/assets/62122640/fd6badeb-4dc0-49f4-90ed-ac2508b6af36)
>>request for quote
![image](https://github.com/frappe/erpnext/assets/62122640/8b4819d4-04c0-44bd-9abf-169823bfc208)
>>
![image](https://github.com/frappe/erpnext/assets/62122640/aae7a6dc-ac08-496b-8e78-00144951f736)

Traceback (most recent call last):
  File ""apps/frappe/frappe/website/serve.py"", line 20, in get_response
    response = renderer_instance.render()
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 84, in render
    html = self.get_html()
  File ""apps/frappe/frappe/website/utils.py"", line 523, in cache_html_decorator
    html = func(*args, **kwargs)
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 95, in get_html
    self.update_context()
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 163, in update_context
    data = self.run_pymodule_method(""get_context"")
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 223, in run_pymodule_method
    return method(self.context)
  File ""apps/webshop/webshop/templates/pages/order.py"", line 43, in get_context
    ""Customer"", context.doc.customer, ""loyalty_program""
AttributeError: 'Quotation' object has no attribute 'customer'

### Module

selling, ecommerce

### Version

ERPNext: v15.27.1 (version-15)

Frappe Framework: v15.29.1 (version-15)

Frappe HR: v15.22.1 (version-15)

Payments: v0.0.1 (version-15)

Webshop: v0.0.1 (version-15)



### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-07-01 11:14:10+00:00,[],2024-07-16 00:10:04+00:00,2024-07-01 11:44:37+00:00,https://github.com/frappe/erpnext/issues/42129,"[('bug', None)]","[{'comment_id': 2199926927, 'issue_id': 2383556355, 'author': 'Nihantra-Patel', 'body': 'Issue already raised in webshop app: https://github.com/frappe/webshop/issues/146 & https://github.com/frappe/webshop/issues/114\r\n\r\nPR already raised: https://github.com/frappe/webshop/pull/139', 'created_at': datetime.datetime(2024, 7, 1, 11, 44, 37, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-07-01 11:44:37 UTC): Issue already raised in webshop app: https://github.com/frappe/webshop/issues/146 & https://github.com/frappe/webshop/issues/114

PR already raised: https://github.com/frappe/webshop/pull/139

"
2383520063,issue,closed,completed,"In Pick List, Pick Manually can allow to pick excess quantity than available quantity in warehouse for batches","### Information about bug

Creating Pick List from Sales Order, available quantity will be fetched from warehouse based on availability. In this case, if we want to pick batches manually, the system will allow to enter excess quantity than available quantity. Also pick list was submitted and delivery note created for. While submitting the delivery note only shows us to stock not available in warehouse.
![image (2)](https://github.com/frappe/erpnext/assets/93510095/4e867f80-77be-425a-9a9c-51722f053249)
![image (1)](https://github.com/frappe/erpnext/assets/93510095/87b27558-45e4-46ed-97b6-995481a2c259)

### Module

stock

### Version

Frappe Version - v15.31.0 (version-15)
ERPNext Version - v15.28.2 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",PraveenkumarSubramani,2024-07-01 10:57:13+00:00,[],2024-07-25 00:08:55+00:00,2024-07-03 08:03:18+00:00,https://github.com/frappe/erpnext/issues/42128,"[('bug', None), ('released', None)]","[{'comment_id': 2208084553, 'issue_id': 2383520063, 'author': 'PraveenkumarSubramani', 'body': '@rohitwaghchaure Thanks!!!', 'created_at': datetime.datetime(2024, 7, 4, 4, 9, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2220173016, 'issue_id': 2383520063, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.70.10 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.10)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 7, 10, 10, 44, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2220175876, 'issue_id': 2383520063, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.29.3 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.3)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 7, 10, 10, 46, 3, tzinfo=datetime.timezone.utc)}]","PraveenkumarSubramani (Issue Creator) on (2024-07-04 04:09:28 UTC): @rohitwaghchaure Thanks!!!

frappe-pr-bot on (2024-07-10 10:44:54 UTC): :tada: This issue has been resolved in version 14.70.10 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.10)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

frappe-pr-bot on (2024-07-10 10:46:03 UTC): :tada: This issue has been resolved in version 15.29.3 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.3)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2383447936,issue,open,,POS should not allow to submit without full settlement,"### Information about bug

Total Sales Amount 1000
User Paid Amount 500
Currently System allow user to Submit
for Point of Sales, we should not allow user to made credit sales
POS didn‚Äôt allow user to settle outstanding payment
![image](https://github.com/frappe/erpnext/assets/62122640/a11e8832-5903-40bb-8fb2-9987deb27fe2)

after fixing the code, it was working well
apps/erpnext/erpnext/selling/page/point_of_sale/pos_payment.js
this.$component.on('click', '.submit-order-btn', () => {
			const doc = this.events.get_frm().doc;
			const paid_amount = doc.paid_amount;
			const items = doc.items;
			const out_stand = doc.outstanding_amount
			if (paid_amount == 0 || !items.length) {
				const message = items.length ? __(""You cannot submit the order without payment."") : __(""You cannot submit empty order."");
				frappe.show_alert({ message, indicator: ""orange"" });
				frappe.utils.play_sound(""error"");
				return;
			}
			if (out_stand > 0){
				const message = __(""You cannot submit the order with  Outstanding payment."")
				frappe.show_alert({ message, indicator: ""red"" });
				frappe.utils.play_sound(""error"");
				return;
			}

			
			this.events.submit_invoice();
		});


### Module

selling

### Version

ERPNext: v15.27.1 (version-15)

Frappe Framework: v15.29.1 (version-15)

Frappe HR: v15.22.1 (version-15)

Payments: v0.0.1 (version-15)

Webshop: v0.0.1 (version-15)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-07-01 10:23:38+00:00,[],2024-11-07 15:56:18+00:00,,https://github.com/frappe/erpnext/issues/42125,"[('bug', None)]","[{'comment_id': 2429650047, 'issue_id': 2383447936, 'author': 'uc77', 'body': '@thida-bcn Has this been resolved please?', 'created_at': datetime.datetime(2024, 10, 22, 15, 48, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2454319344, 'issue_id': 2383447936, 'author': 'Navin-S-R', 'body': 'Raised PR for this issue #43966', 'created_at': datetime.datetime(2024, 11, 4, 10, 18, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2455651529, 'issue_id': 2383447936, 'author': 'uc77', 'body': 'Thank you!', 'created_at': datetime.datetime(2024, 11, 4, 20, 36, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2455777589, 'issue_id': 2383447936, 'author': 'JeansReal', 'body': 'Thanks!\r\n\r\nThe ERPNext POS has been forgotten :(', 'created_at': datetime.datetime(2024, 11, 4, 21, 53, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2462598595, 'issue_id': 2383447936, 'author': 'uc77', 'body': 'In which release will this be rectified ?', 'created_at': datetime.datetime(2024, 11, 7, 15, 56, 16, tzinfo=datetime.timezone.utc)}]","uc77 on (2024-10-22 15:48:55 UTC): @thida-bcn Has this been resolved please?

Navin-S-R on (2024-11-04 10:18:22 UTC): Raised PR for this issue #43966

uc77 on (2024-11-04 20:36:04 UTC): Thank you!

JeansReal on (2024-11-04 21:53:53 UTC): Thanks!

The ERPNext POS has been forgotten :(

uc77 on (2024-11-07 15:56:16 UTC): In which release will this be rectified ?

"
2383126038,issue,closed,completed,Pricing Rules Not Applying to Delivery Notes Marked as Return,"### Information about bug

I'm facing an issue where the pricing rules in ERPNext are not applying to delivery notes marked as returns. I've checked the configuration, and the rules apply to all relevant transactions. Despite this, the rules are not triggered for return delivery notes.

Has anyone else faced this issue? Any suggestions or custom scripts that could help apply pricing rules to return delivery notes would be greatly appreciated.

Thank you!


### Module

stock

### Version

ERPNext: v15.28.0 (version-15)

Expense Request: v0.0.1 (main)

Frappe Framework: v15.31.0 (version-15)



### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",hassan-youssef,2024-07-01 07:57:24+00:00,[],2024-07-16 00:10:05+00:00,2024-07-01 08:37:10+00:00,https://github.com/frappe/erpnext/issues/42121,"[('bug', None)]","[{'comment_id': 2199564623, 'issue_id': 2383126038, 'author': 'Nihantra-Patel', 'body': ""pricing rule isn't applied in the return invoice. This behavior is by design and not considered a bug. If you wish to override this and apply pricing rules to return delivery notes, you can implement custom logic in your custom app. Otherwise, the default behavior where pricing rules do not apply to return delivery notes will remain unchanged."", 'created_at': datetime.datetime(2024, 7, 1, 8, 37, 10, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-07-01 08:37:10 UTC): pricing rule isn't applied in the return invoice. This behavior is by design and not considered a bug. If you wish to override this and apply pricing rules to return delivery notes, you can implement custom logic in your custom app. Otherwise, the default behavior where pricing rules do not apply to return delivery notes will remain unchanged.

"
2382773691,issue,closed,completed,Issue while creating a pick list with promotional scheme,"### Information about bug

**Information about bug**
While creating Picklist from Sales order with promotional scheme with Product Discount Slabs if the stock is not available the free qty combination is not selected. Just available qty is selected and after creating delivery note the sales order qty is fetched and throwing warning Serial No / Batch No are mandatory for Item.

**Steps to Reproduce:**
1. Create Item with Batch number & Expiry Date enabled (Only Batch Enabled)
2. Make a Stock receipt or Purchase Receipt for 100 Qty
3. Create Sales Order with promotional scheme with Product Discount Slab (10 + 1 Scheme - 100 qty SO 10 Qty free)
4. Create Picklist Insufficient Stock warning will show - Only available stock is fetched in Picklist
5. Create Delivery Note, Full SO qty is taken in Delivery note and throwing warning Serial No / Batch No are mandatory for Item.
![Scheme picklist bug](https://github.com/frappe/erpnext/assets/9102676/60a37e90-96ed-49d5-90f3-c8dd14406510)


### Module

selling

### Version

ERPNext: v15.28.2 (HEAD)

Frappe Framework: v15.32.0 (HEAD)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",rknroot,2024-07-01 04:21:45+00:00,[],2024-07-16 00:10:07+00:00,2024-07-01 06:40:28+00:00,https://github.com/frappe/erpnext/issues/42117,"[('bug', None)]","[{'comment_id': 2199356750, 'issue_id': 2382773691, 'author': 'rohitwaghchaure', 'body': ""Ideally free item should be available otherwise there is no point to run promotional schemes. If you don't want to give free item in the delivery note then remove free item and enable ignore pricing rule"", 'created_at': datetime.datetime(2024, 7, 1, 6, 40, 28, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure on (2024-07-01 06:40:28 UTC): Ideally free item should be available otherwise there is no point to run promotional schemes. If you don't want to give free item in the delivery note then remove free item and enable ignore pricing rule

"
2382325722,issue,open,,Item Tax Template NOT Filter Properly in Sales Invoice,"### Information about bug

I go throw the code for the filtration of Item Tax Template in Sales Invoice and encounter a function called **is_within_valid_range** in _apps/erpnext/erpnext/stock/get_item_details.py_

The implementation for function:
```python
def is_within_valid_range(args, tax):
	if not flt(tax.maximum_net_rate):
		# No range specified, just ignore
		return True
	elif flt(tax.minimum_net_rate) <= flt(args.get(""base_net_rate"")) <= flt(tax.maximum_net_rate):
		return True

	return False
```
In the **elif** block the system compare the _tax.minimum_net_rate_ and _tax.maximum_net_rate_ with _args.get(""base_net_rate"")_ but when I see if **base_net_rate** in args dict I found that the key never there and never put in the args dict from the first call to filter function

**Code Flow**:

1. [sales_common.js](https://github.com/frappe/erpnext/blob/fb76daaf9ee59a415af3017c5628659b04524549/erpnext/public/js/utils/sales_common.js#L73)
2. [transaction.js](https://github.com/frappe/erpnext/blob/fb76daaf9ee59a415af3017c5628659b04524549/erpnext/public/js/controllers/transaction.js#L2316)
3. [queries.py](https://github.com/frappe/erpnext/blob/8b0de4aaf73bbc255c8dd19b5223e9ea6012c015/erpnext/controllers/queries.py#L793)
4. [get_item_details.py](https://github.com/frappe/erpnext/blob/8b0de4aaf73bbc255c8dd19b5223e9ea6012c015/erpnext/stock/get_item_details.py#L596)
5. [get_item_details.py](https://github.com/frappe/erpnext/blob/8b0de4aaf73bbc255c8dd19b5223e9ea6012c015/erpnext/stock/get_item_details.py#L646)
---
So, When I have to choose an Item Tax Template for an Item in Sales Invoice there nothing to choose from.

**I suggest to add new key in filters variable in transaction.js called base_net_rate and handle this key to be part of args that passed to _get_item_tax_template in get_tax_template**

_**I can create PR by this**_

### Module

stock

### Version

**Frappe Framework: v15.32.0 (version-15)**
**ERPNext: v15.28.2 (version-15)**

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",osman-yasser,2024-06-30 16:20:44+00:00,['ljain112'],2025-02-06 14:17:40+00:00,,https://github.com/frappe/erpnext/issues/42115,"[('bug', None)]","[{'comment_id': 2199361179, 'issue_id': 2382325722, 'author': 'Nihantra-Patel', 'body': ""Please submit the PR. If it's valid, it will be accepted. Also, include a video showing the issue before and after the update."", 'created_at': datetime.datetime(2024, 7, 1, 6, 43, 38, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-07-01 06:43:38 UTC): Please submit the PR. If it's valid, it will be accepted. Also, include a video showing the issue before and after the update.

"
2382301440,issue,closed,completed,Bank Reconciliation Tool Cost Center All Company Cost center Showing,"### Information about bug

Bank Reconciliation Tool Cost Center Showing All Company, Not Showing Selected Company in Bank Reconciliation Tool Company
![Screenshot from 2024-06-30 20-45-30](https://github.com/frappe/erpnext/assets/101092028/710bf335-8b69-4936-8be6-5bce43c49450)
 

### Module

accounts

### Version

ERPNext: v15.24.0 (version-15)
Frappe Framework: v15.27.0 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",creative-paramu,2024-06-30 15:18:44+00:00,[],2024-09-04 00:09:46+00:00,2024-08-20 13:56:14+00:00,https://github.com/frappe/erpnext/issues/42113,"[('bug', None)]",[],
2382286402,issue,open,,Process Deferred Accounting inconsistent with discounts or negative Item Amount,"### Information about bug

## description

Posting a *Purchase Invoice* where one of the *Items* is, say, a discount, such that the **Amount** field has a negative value, and **Enable Deferred Expense** is `checked`, the ""deferred discount"" will be incorrectly accounted, such that the full value of the **Amount** will be posted in full at the end of the *Service Period* ***and*** pro-rated at the beginning of the *Service Period*, resulting in a NON-ZERO TOTAL.

## steps to reproduce

1. Create *Purchase Invoice*.
2. Add at least one item to said *Purchase Invoice* with:
    - a positive **Amount**
    - **Enable Deferred Expense** `checked`
    - **Service Start Date** to e.g. 2024-06-18
    - **Service End Date** to e.g. 2024-07-17
3. Add at least one *Item* to said *Purchase Invoice* with:
    - a ***negative*** **Amount**
    - the same other parameters as above
4. Post said *Purchas Invoice*.
5. Post a *Process Deferred Accounting* with appropriate dates, e.g.:
    - **Posting Date** `2024-12-31`
    - **Service Start Date** `2024-01-01`
    - **Service End Date** `2024-12-31`
6. Analyse the General Ledger with filters set to the corresponding deferred account and grouping `disabled`.

The result should be as described above.

## example

Example from CSV export:

<img width=""1561"" alt=""Screenshot 2024-06-30 at 16 33 43 annotated"" src=""https://github.com/frappe/erpnext/assets/28401247/53749348-9bc3-4a8e-9e8c-f704f6ca1ea7"">

### Module

accounts

### Version

```
bench 5.17.2
erpnext 15.27.6
erpnextswiss 1.23.3
frappe 15.29.2
hrms 15.22.2
payments 0.0.1
```

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",konradbr,2024-06-30 14:41:57+00:00,[],2024-06-30 14:44:24+00:00,,https://github.com/frappe/erpnext/issues/42112,"[('bug', None)]","[{'comment_id': 2198585804, 'issue_id': 2382286402, 'author': 'konradbr', 'body': '**NOTE:** the negative **Amount** in the *Purchase Invoice* *Item* was in this case `EUR (5.00)`.', 'created_at': datetime.datetime(2024, 6, 30, 14, 44, 16, tzinfo=datetime.timezone.utc)}]","konradbr (Issue Creator) on (2024-06-30 14:44:16 UTC): **NOTE:** the negative **Amount** in the *Purchase Invoice* *Item* was in this case `EUR (5.00)`.

"
2382209717,issue,open,,Landed cost Voucher (Manual Distribution),"### Information about bug

Hello 

Why in ERPNext V15, in LCV, you can only choose ‚Äúone‚Äù chargeable account when ‚ÄúManual‚Äù distribution is selected. But when QTY/Amount distribution is selected, you can add more than one chargeable account? although it was working fine in V14...
![image](https://github.com/frappe/erpnext/assets/114433956/e7a7f2b1-f8d6-42b6-a862-5a84b704786e)

BRs
Hadi

### Module

buying

### Version

Frappe Builder: v1.10.0 (HEAD)

ERPNext: v15.28.2 (HEAD)

Erpnext Telegram Integration: v1.2.0 (HEAD)

Frappe Framework: v15.32.0 (HEAD)

Frappe HR: v15.23.0 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",NEW-MTC-ERP1,2024-06-30 11:22:31+00:00,[],2024-06-30 11:22:31+00:00,,https://github.com/frappe/erpnext/issues/42110,"[('bug', None)]",[],
2382179166,issue,closed,completed,Issue in Sales Order for creating Order with Promotional Scheme,"### Information about bug

**Information about bug**
While creating Sales order with promotional scheme with Product Discount Slabs free item is added for only first item, for next consecutive items fetching after save without HSN code.

**Steps to Reproduce:**
1. Create a Promotional Scheme for 10 + 1 Free Item for all Items
<img width=""1474"" alt=""image"" src=""https://github.com/frappe/erpnext/assets/9102676/8cf1c639-e08f-4487-b9c5-439bdfbf6263"">

2. Create sales order for 2 or 3 items, for 1st item free qty will be fetched, from 2nd item free qty will not be fetched and after save free qty will be fetched without HSN code.
![Sales Order Scheme Issue](https://github.com/frappe/erpnext/assets/9102676/6e6908be-8ea3-4dd9-b1b1-64e50e977876)


### Module

selling

### Version

ERPNext: v15.28.2 (HEAD)

Frappe Framework: v15.32.0 (HEAD)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
transaction.js:1768 Uncaught (in promise) TypeError: Cannot set properties of undefined (setting 'item_code')
    at transaction.js:1768:19
    at Array.forEach (<anonymous>)
    at frappe.ui.form.Controller.apply_product_discount (transaction.js:1755:23)
    at frappe.ui.form.Controller._set_values_for_item_list (transaction.js:1713:10)
    at s.exc.frappe.run_serially.a.in_apply_price_list (transaction.js:1804:12)
(anonymous) @ transaction.js:1768
apply_product_discount @ transaction.js:1755
_set_values_for_item_list @ transaction.js:1713
s.exc.frappe.run_serially.a.in_apply_price_list @ transaction.js:1804
Promise.then (async)
(anonymous) @ dom.js:262
frappe.run_serially @ dom.js:260
callback @ transaction.js:1799
e.doc.e.callback @ form.js:1734
e @ request.js:85
200 @ request.js:133
(anonymous) @ request.js:305
I @ jquery.js:3213
fireWith @ jquery.js:3343
en @ jquery.js:9617
(anonymous) @ jquery.js:9878
load (async)
send @ jquery.js:9897
ajax @ jquery.js:9511
frappe.request.call @ request.js:279
frappe.call @ request.js:109
call @ form.js:1744
apply_price_list @ transaction.js:1794
(anonymous) @ transaction.js:1255
Promise.then (async)
(anonymous) @ dom.js:262
frappe.run_serially @ dom.js:260
qty @ transaction.js:1252
qty @ sales_common.js:347
o @ script_manager.js:106
(anonymous) @ script_manager.js:136
Promise.then (async)
(anonymous) @ dom.js:262
frappe.run_serially @ dom.js:260
trigger @ script_manager.js:141
(anonymous) @ form.js:317
(anonymous) @ model.js:604
Promise.then (async)
(anonymous) @ dom.js:262
frappe.run_serially @ dom.js:260
trigger @ model.js:622
(anonymous) @ model.js:565
Promise.then (async)
(anonymous) @ dom.js:262
frappe.run_serially @ dom.js:260
set_value @ model.js:574
set_model_value @ base_control.js:271
(anonymous) @ base_control.js:233
Promise.then (async)
(anonymous) @ dom.js:262
frappe.run_serially @ dom.js:260
l @ base_control.js:231
validate_and_set_in_model @ base_control.js:254
parse_validate_and_set_in_model @ base_control.js:209
e @ data.js:168
dispatch @ jquery.js:5135
Rt.handle @ jquery.js:4939
Show 8 more frames
Show less
request.js:308 Unable to handle success response {message: Array(1)}
request.js:309 TypeError: Cannot set properties of undefined (setting 'item_code')
    at transaction.js:1768:19
    at Array.forEach (<anonymous>)
    at frappe.ui.form.Controller.apply_product_discount (transaction.js:1755:23)
    at frappe.ui.form.Controller._set_values_for_item_list (transaction.js:1713:10)
    at Object.callback [as original_callback] (transaction.js:1590:9)
    at e.doc.e.callback (form.js:1734:36)
    at Object.e [as success_callback] (request.js:85:16)
    at 200 (request.js:133:34)
    at Object.<anonymous> (request.js:305:6)
    at I (jquery.js:3213:31)
```
",rknroot,2024-06-30 09:52:27+00:00,[],2024-07-25 00:08:57+00:00,2024-07-03 12:27:30+00:00,https://github.com/frappe/erpnext/issues/42109,"[('bug', None), ('released', None)]","[{'comment_id': 2220172919, 'issue_id': 2382179166, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.70.10 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.10)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 7, 10, 10, 44, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2220175628, 'issue_id': 2382179166, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.29.3 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.3)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 7, 10, 10, 45, 57, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-07-10 10:44:51 UTC): :tada: This issue has been resolved in version 14.70.10 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.10)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

frappe-pr-bot on (2024-07-10 10:45:57 UTC): :tada: This issue has been resolved in version 15.29.3 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.3)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2381594160,issue,open,,Plaid: development environment decommissioned,"### Information about bug

Since June 24, the development environment off Plaid is not working anymore and integrated in the production environment. However, when changing to this production environment it is not working. It leads to a ""Invaled request error"" and ""authentication error"". Development environment is replaced by limited production environment

### Module

integrations

### Version

[v15.28.1](https://github.com/frappe/erpnext/releases/tag/v15.28.1)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
plaid.errors.APIError: As of June 20, 2024, the Development environment is no longer available and Development Items have been deleted. Migrate API activity to Production or Sandbox instead.

frappe.exceptions.ValidationError: provided access token is for the wrong Plaid environment. expected ""production"", got ""development""

'error_code': 'INVALID_FIELD', 'error_message': 'Please see https://plaid.com/global for a list of supported country codes or file a support ticket to get access to a specific country https://dashboard.plaid.com/support/new/product-and-development/product-troubleshooting/request-product-access', 'error_type': 'INVALID_REQUEST', 'request_id': 'GdHdgvLem5nD8zf', 'suggested_action': None}
plaid.errors.InvalidRequestError: Please see https://plaid.com/global for a list of supported country codes or file a support ticket to get access to a specific country https://dashboard.plaid.com/support/new/product-and-development/product-troubleshooting/request-product-access
```
",mrPauwHaan,2024-06-29 09:03:56+00:00,[],2024-10-09 19:43:22+00:00,,https://github.com/frappe/erpnext/issues/42102,"[('bug', None)]","[{'comment_id': 2325987134, 'issue_id': 2381594160, 'author': 'vcavel', 'body': 'I am facing the same issue, any update on this ?', 'created_at': datetime.datetime(2024, 9, 3, 9, 5, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2403299278, 'issue_id': 2381594160, 'author': 'ZeWaren', 'body': 'Is anyone already working on this bug?', 'created_at': datetime.datetime(2024, 10, 9, 19, 43, 21, tzinfo=datetime.timezone.utc)}]","vcavel on (2024-09-03 09:05:51 UTC): I am facing the same issue, any update on this ?

ZeWaren on (2024-10-09 19:43:21 UTC): Is anyone already working on this bug?

"
2380329419,issue,closed,completed,Batch Items Valuation Rate calculation difference in v14 vs V15,"### Information about bug

First of all I am not sure this is a bug or not. My issue is we were using 'Moving Average' on v14 and we had batch items.

During Manufacturing entries, the system use to pick the average valuation rate for the raw materials (not aware of the backend procedure).

Once I upgraded to V15, the similar exact entry once done on it, the raw material valuation rate is completely different. Again I do not know how these calculations are done.

Also during the creation of this record the value appears correct, it is only after saving/submitting that the valuation or this raw material gets changed to another number.

How to tackle this, as prod system is up and the process is getting affected.


@rohitwaghchaure  Sorry I am tagging you but I saw your videos for the batch and some posts, still it is very unclear to me.


### Module

stock, manufacturing

### Version

ERPNext: v15.28.1 (version-15)

Frappe Framework: v15.32.0 (version-15)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",moizsami,2024-06-28 12:30:33+00:00,[],2024-07-19 00:08:48+00:00,2024-07-04 12:00:09+00:00,https://github.com/frappe/erpnext/issues/42072,"[('bug', None)]","[{'comment_id': 2202194130, 'issue_id': 2380329419, 'author': 'rohitwaghchaure', 'body': '@moizsami we have forced Use Batch-wise Valuation for the batches from the version 15. Is this causing the issue? In my opinion for the batched item the valuation rate should be based on the Batch-wise', 'created_at': datetime.datetime(2024, 7, 2, 7, 42, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202213923, 'issue_id': 2380329419, 'author': 'moizsami', 'body': ""@rohitwaghchaure  Yes, the issue is from client side, that suddenly the manufactured items are having different valuation rates. It is affecting their profit calculations.\r\n\r\nCan you explain how the batch wise calculation is done so I could propose them the idea? I had chosen FIFO in stock batch setting, so is it taking the FIFO calculation?\r\n\r\nAlso, I would suggest if there is an option where user can select what how the calculation of batch Items should be calculated. As new users might not have an issue, but those coming from older versions are use to something else.\r\n\r\nFor now I had no choice but to rollback client's environment to v14 as they were not accepting the change in valuation rate during manufacturing entry."", 'created_at': datetime.datetime(2024, 7, 2, 7, 49, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202229019, 'issue_id': 2380329419, 'author': 'rohitwaghchaure', 'body': ""@moizsami I am still not able to understand the problem, maybe can you explain with the example what customer is expected. Also if you have purchased support plan, please create a support ticket so that I can able to see the customer's data as well."", 'created_at': datetime.datetime(2024, 7, 2, 7, 55, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202246446, 'issue_id': 2380329419, 'author': 'moizsami', 'body': ""@rohitwaghchaure  we are on the 25 USD plan so unfortunately I cannot open a ticket.\r\n\r\nOn v14. although we had multiple batches, but during the manufacturing entry when raw material were consumed, they used to have the average rate of the Item which can be seen on stock balance report as well.\r\n\r\nOn v15: During creation of the manufacturing entry it fetches the average rate of the Item, but then according to the batches selected. while saving it changes the valuation rate (I am assuming its taking the FIFO calculation into consideration)\r\n\r\nSo suppose the Item A has valuation rate: 80 EGP on stock balance report under Raw Material warehouse\r\nIn the manufacturing entry, that item's rate will be changed while saving to 127 EGP as maybe a certain batch's valuation rate was higher than others.\r\n\r\nProviding figures for all batches will be a bit difficult as there are multiple batches with different qty and price variations. but let me know what exactly is needed and i will surely provide."", 'created_at': datetime.datetime(2024, 7, 2, 8, 3, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202268310, 'issue_id': 2380329419, 'author': 'rohitwaghchaure', 'body': 'Can you share the site name and stock entry id', 'created_at': datetime.datetime(2024, 7, 2, 8, 11, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202331865, 'issue_id': 2380329419, 'author': 'moizsami', 'body': '@rohitwaghchaure \r\n\r\nI still have the v15 environment and v14 also sharing both details:\r\n\r\nV15:\r\nURL: https://glabels.frappe.cloud/\r\nstock entry: MAT-STE-2024-00210\r\n\r\nNow I created v14 url for them to work on:\r\nURL: https://glabels14.frappe.cloud/\r\nstock entry: MAT-STE-2024-00211\r\n\r\ncheck the Item SG103 as an example..how the valuation rate is different in both.', 'created_at': datetime.datetime(2024, 7, 2, 8, 40, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2208791475, 'issue_id': 2380329419, 'author': 'rohitwaghchaure', 'body': ""@moizsami We have [fixed](https://github.com/frappe/erpnext/pull/42186/files) the issue and we'll release the fix in the next week (Wednesday). After the release, kindly update your site and do reposting of items using Repost Item Valuation having incorrect valuation rate."", 'created_at': datetime.datetime(2024, 7, 4, 12, 0, 9, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure on (2024-07-02 07:42:44 UTC): @moizsami we have forced Use Batch-wise Valuation for the batches from the version 15. Is this causing the issue? In my opinion for the batched item the valuation rate should be based on the Batch-wise

moizsami (Issue Creator) on (2024-07-02 07:49:16 UTC): @rohitwaghchaure  Yes, the issue is from client side, that suddenly the manufactured items are having different valuation rates. It is affecting their profit calculations.

Can you explain how the batch wise calculation is done so I could propose them the idea? I had chosen FIFO in stock batch setting, so is it taking the FIFO calculation?

Also, I would suggest if there is an option where user can select what how the calculation of batch Items should be calculated. As new users might not have an issue, but those coming from older versions are use to something else.

For now I had no choice but to rollback client's environment to v14 as they were not accepting the change in valuation rate during manufacturing entry.

rohitwaghchaure on (2024-07-02 07:55:40 UTC): @moizsami I am still not able to understand the problem, maybe can you explain with the example what customer is expected. Also if you have purchased support plan, please create a support ticket so that I can able to see the customer's data as well.

moizsami (Issue Creator) on (2024-07-02 08:03:18 UTC): @rohitwaghchaure  we are on the 25 USD plan so unfortunately I cannot open a ticket.

On v14. although we had multiple batches, but during the manufacturing entry when raw material were consumed, they used to have the average rate of the Item which can be seen on stock balance report as well.

On v15: During creation of the manufacturing entry it fetches the average rate of the Item, but then according to the batches selected. while saving it changes the valuation rate (I am assuming its taking the FIFO calculation into consideration)

So suppose the Item A has valuation rate: 80 EGP on stock balance report under Raw Material warehouse
In the manufacturing entry, that item's rate will be changed while saving to 127 EGP as maybe a certain batch's valuation rate was higher than others.

Providing figures for all batches will be a bit difficult as there are multiple batches with different qty and price variations. but let me know what exactly is needed and i will surely provide.

rohitwaghchaure on (2024-07-02 08:11:42 UTC): Can you share the site name and stock entry id

moizsami (Issue Creator) on (2024-07-02 08:40:12 UTC): @rohitwaghchaure 

I still have the v15 environment and v14 also sharing both details:

V15:
URL: https://glabels.frappe.cloud/
stock entry: MAT-STE-2024-00210

Now I created v14 url for them to work on:
URL: https://glabels14.frappe.cloud/
stock entry: MAT-STE-2024-00211

check the Item SG103 as an example..how the valuation rate is different in both.

rohitwaghchaure on (2024-07-04 12:00:09 UTC): @moizsami We have [fixed](https://github.com/frappe/erpnext/pull/42186/files) the issue and we'll release the fix in the next week (Wednesday). After the release, kindly update your site and do reposting of items using Repost Item Valuation having incorrect valuation rate.

"
2380271045,issue,open,,Work Order Status Not Updating,"### Information about bug

A work order was created with three operations, and a job card was created against that work order. Out of the three job cards, two job cards are completed, but the status of the work order is not changing to 'Work In Progress'; it is still showing 'Not Started'.
[Screencast from 28-06-24 05:20:47 PM IST.webm](https://github.com/frappe/erpnext/assets/95607404/b3a527ff-6dc3-4ad5-89c7-439850430924)




### Module

manufacturing

### Version

ERPNEXT - VERSION 15
FRAPPE - VERSION-15

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",Nandhinidevi123,2024-06-28 11:59:26+00:00,[],2024-06-28 11:59:26+00:00,,https://github.com/frappe/erpnext/issues/42070,"[('bug', None)]",[],
2379912335,issue,closed,completed,Select wrong batch in pick list,"### Information about bug

As I understand it, when I create the pick list, it should select the batch that were received first according to the existing FIFO settings.

But as shown in the screenshot below:
I have 1600 products in the same batch but in different warehouses. When I create a pick list of 800 items, this systems does not follow the batch order pick rules as i mention above. The correct order should be to pick all from batch 1 before moving to batch 2. 

![image](https://github.com/frappe/erpnext/assets/174099651/15ad3311-bf42-4f1c-9bd9-0b532ff2e1fc)

![image](https://github.com/frappe/erpnext/assets/174099651/434d2ad3-3f76-420f-b80b-9dcc1c382745)

Is it a bug? And how can i fix that? Plz i need a response for this issue!





### Module

stock

### Version

ERPNext: v15.28.0 (HEAD)
Frappe Framework: v15.32.0 (HEAD)



### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",chiph21,2024-06-28 08:43:29+00:00,[],2024-07-19 00:08:55+00:00,2024-07-02 07:52:59+00:00,https://github.com/frappe/erpnext/issues/42067,"[('bug', None), ('released', None)]","[{'comment_id': 2205110604, 'issue_id': 2379912335, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.29.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 7, 3, 5, 8, 33, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-07-03 05:08:33 UTC): :tada: This issue has been resolved in version 15.29.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2378496204,issue,open,,Payment Entry: Allocated Amount cannot be greater than outstanding amount,"### Information about bug

Payment entry shows pop up message for Allocated Amount cannot be greater than outstanding amount when creating payments for expense claim. Not yet tested if the pop up message also shows up for purchase order and purchase invoice.

<img width=""951"" alt=""image"" src=""https://github.com/frappe/erpnext/assets/60758795/a74d1c7c-ef47-426d-8faa-04b70e1f528f"">


### Module

accounts

### Version

ERPNext: v14.70.7 (HEAD)
Frappe Framework: v14.77.1 (HEAD)


### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 97, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 48, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 86, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1619, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/model/workflow.py"", line 131, in apply_workflow
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 310, in save
    return self._save(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 345, in _save
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1061, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 931, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1283, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1265, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 928, in fn
    return method_object(*args, **kwargs)
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 89, in validate
    self.validate_allocated_amount()
  File ""apps/erpnext/erpnext/accounts/doctype/payment_entry/payment_entry.py"", line 173, in validate_allocated_amount
    frappe.throw(fail_message.format(d.idx))
  File ""apps/frappe/frappe/__init__.py"", line 548, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 509, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 455, in _raise_exception
    raise raise_exception(msg)
frappe.exceptions.ValidationError: Row #1: Allocated Amount cannot be greater than outstanding amount.
```
",Ponyooooo,2024-06-27 15:40:00+00:00,['ruthra-kumar'],2025-01-28 03:52:10+00:00,,https://github.com/frappe/erpnext/issues/42062,"[('bug', None)]","[{'comment_id': 2195934297, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'this is a bug from the recent version update. We do not usually experience this one.', 'created_at': datetime.datetime(2024, 6, 28, 1, 30, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2197879717, 'issue_id': 2378496204, 'author': 'quebn', 'body': 'Also Experiencing this also on latest version of version-15, message shows up on journal entry as references.', 'created_at': datetime.datetime(2024, 6, 29, 3, 35, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2201581159, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'This is still not resolved', 'created_at': datetime.datetime(2024, 7, 2, 0, 59, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2205258042, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'Any update on this? We cannot process payment entries due to the message :(', 'created_at': datetime.datetime(2024, 7, 3, 7, 13, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2209765901, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'any update on this?', 'created_at': datetime.datetime(2024, 7, 5, 1, 7, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2211504397, 'issue_id': 2378496204, 'author': 'szufisher', 'body': 'added precision parameter in flt function solved the problem.\r\n![image](https://github.com/frappe/erpnext/assets/12823863/aa2afbd0-5bb9-46fc-bccb-d74ccfbad460)', 'created_at': datetime.datetime(2024, 7, 5, 23, 33, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2213103952, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'how can we add this when using frappecloud? looks like this bug is still not added to the latest version update', 'created_at': datetime.datetime(2024, 7, 8, 6, 9, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2219304304, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'Any update on this?', 'created_at': datetime.datetime(2024, 7, 10, 1, 33, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2222072298, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': '@ruthra-kumar how can we fix the bug when using a frappecloud?', 'created_at': datetime.datetime(2024, 7, 11, 5, 33, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2222144178, 'issue_id': 2378496204, 'author': 'ruthra-kumar', 'body': '@Ponyooooo If you are in FrappeCloud, would suggest you to raise a support ticket on this.', 'created_at': datetime.datetime(2024, 7, 11, 6, 35, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2223433318, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'Hi @szufisher how can we integrate your solution using client script or server script since frappecloud does not allow us to edit the backcodes of the erpnext. Our only way is to use client or server script only unless your solution will be included on the next version update. :(', 'created_at': datetime.datetime(2024, 7, 11, 16, 57, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2236890323, 'issue_id': 2378496204, 'author': 'Ramesh-Udhyam', 'body': 'It looks like this issue is still not solved. Is this not impacting many people? How come it is not a P0 issue?', 'created_at': datetime.datetime(2024, 7, 18, 15, 41, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2242132573, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'Still no progress on this one', 'created_at': datetime.datetime(2024, 7, 22, 5, 42, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2257294372, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'Any progress? This is not possible to be added on the client script', 'created_at': datetime.datetime(2024, 7, 30, 1, 36, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2272471095, 'issue_id': 2378496204, 'author': 'quebn', 'body': ""Found the issue why this Bug happens.\r\nin our case it's Because if the Journal Entry has the following Entries shown below:\r\n![image](https://github.com/user-attachments/assets/fbc29cb0-33d3-49cc-b396-d79cc7163fca)\r\n- if the accounting entries have a payable entry credited on a party. but has also an entry debited on the same party.\r\nwhen we set them as references in the payment entry the system will calculated the outstanding by subtracting the debited entry on the credited entry despite the accounts of those entry clearly being different. so the payment entry will only show the difference as the outstanding show below\r\n![image](https://github.com/user-attachments/assets/678e6d71-a2fa-4fbb-beb3-995919e909ef)\r\nhence the error message below when we try to save/submit the payment entry\r\n![image](https://github.com/user-attachments/assets/eb4e3841-5e32-4074-8c46-59b3c246ed8b)"", 'created_at': datetime.datetime(2024, 8, 7, 1, 55, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2425730560, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'can the fix be included for version 14? journal entry cannot close any invoices and expense claims for this bug.', 'created_at': datetime.datetime(2024, 10, 21, 6, 46, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2425737997, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'current version: Bug still not resolved.\r\n\r\nERPNext: v14.74.6 (HEAD)\r\nFrappe Framework: v14.82.2 (HEAD)', 'created_at': datetime.datetime(2024, 10, 21, 6, 48, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2461900982, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'any fix for version 14?', 'created_at': datetime.datetime(2024, 11, 7, 10, 43, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2564734768, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'any fix for \r\nERPNext: v14.78.5 (HEAD)\r\nFrappe Framework: v14.89.0 (HEAD)?', 'created_at': datetime.datetime(2024, 12, 29, 14, 1, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2589148605, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'any fix for version 14?', 'created_at': datetime.datetime(2025, 1, 14, 6, 41, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2617786799, 'issue_id': 2378496204, 'author': 'Ponyooooo', 'body': 'found some previous fixes that can integrate to fix this bug for ERPNext: v14.80.0 (HEAD), Frappe Framework: v14.92.0 (HEAD)??? \n\nhttps://github.com/frappe/erpnext/pull/36030, https://github.com/frappe/erpnext/pull/36011', 'created_at': datetime.datetime(2025, 1, 28, 3, 52, 9, tzinfo=datetime.timezone.utc)}]","Ponyooooo (Issue Creator) on (2024-06-28 01:30:35 UTC): this is a bug from the recent version update. We do not usually experience this one.

quebn on (2024-06-29 03:35:59 UTC): Also Experiencing this also on latest version of version-15, message shows up on journal entry as references.

Ponyooooo (Issue Creator) on (2024-07-02 00:59:09 UTC): This is still not resolved

Ponyooooo (Issue Creator) on (2024-07-03 07:13:01 UTC): Any update on this? We cannot process payment entries due to the message :(

Ponyooooo (Issue Creator) on (2024-07-05 01:07:55 UTC): any update on this?

szufisher on (2024-07-05 23:33:32 UTC): added precision parameter in flt function solved the problem.
![image](https://github.com/frappe/erpnext/assets/12823863/aa2afbd0-5bb9-46fc-bccb-d74ccfbad460)

Ponyooooo (Issue Creator) on (2024-07-08 06:09:52 UTC): how can we add this when using frappecloud? looks like this bug is still not added to the latest version update

Ponyooooo (Issue Creator) on (2024-07-10 01:33:05 UTC): Any update on this?

Ponyooooo (Issue Creator) on (2024-07-11 05:33:57 UTC): @ruthra-kumar how can we fix the bug when using a frappecloud?

ruthra-kumar (Assginee) on (2024-07-11 06:35:44 UTC): @Ponyooooo If you are in FrappeCloud, would suggest you to raise a support ticket on this.

Ponyooooo (Issue Creator) on (2024-07-11 16:57:32 UTC): Hi @szufisher how can we integrate your solution using client script or server script since frappecloud does not allow us to edit the backcodes of the erpnext. Our only way is to use client or server script only unless your solution will be included on the next version update. :(

Ramesh-Udhyam on (2024-07-18 15:41:02 UTC): It looks like this issue is still not solved. Is this not impacting many people? How come it is not a P0 issue?

Ponyooooo (Issue Creator) on (2024-07-22 05:42:35 UTC): Still no progress on this one

Ponyooooo (Issue Creator) on (2024-07-30 01:36:53 UTC): Any progress? This is not possible to be added on the client script

quebn on (2024-08-07 01:55:14 UTC): Found the issue why this Bug happens.
in our case it's Because if the Journal Entry has the following Entries shown below:
![image](https://github.com/user-attachments/assets/fbc29cb0-33d3-49cc-b396-d79cc7163fca)
- if the accounting entries have a payable entry credited on a party. but has also an entry debited on the same party.
when we set them as references in the payment entry the system will calculated the outstanding by subtracting the debited entry on the credited entry despite the accounts of those entry clearly being different. so the payment entry will only show the difference as the outstanding show below
![image](https://github.com/user-attachments/assets/678e6d71-a2fa-4fbb-beb3-995919e909ef)
hence the error message below when we try to save/submit the payment entry
![image](https://github.com/user-attachments/assets/eb4e3841-5e32-4074-8c46-59b3c246ed8b)

Ponyooooo (Issue Creator) on (2024-10-21 06:46:12 UTC): can the fix be included for version 14? journal entry cannot close any invoices and expense claims for this bug.

Ponyooooo (Issue Creator) on (2024-10-21 06:48:15 UTC): current version: Bug still not resolved.

ERPNext: v14.74.6 (HEAD)
Frappe Framework: v14.82.2 (HEAD)

Ponyooooo (Issue Creator) on (2024-11-07 10:43:43 UTC): any fix for version 14?

Ponyooooo (Issue Creator) on (2024-12-29 14:01:31 UTC): any fix for 
ERPNext: v14.78.5 (HEAD)
Frappe Framework: v14.89.0 (HEAD)?

Ponyooooo (Issue Creator) on (2025-01-14 06:41:20 UTC): any fix for version 14?

Ponyooooo (Issue Creator) on (2025-01-28 03:52:09 UTC): found some previous fixes that can integrate to fix this bug for ERPNext: v14.80.0 (HEAD), Frappe Framework: v14.92.0 (HEAD)??? 

https://github.com/frappe/erpnext/pull/36030, https://github.com/frappe/erpnext/pull/36011

"
2378220948,issue,open,,Qty coming wrong in pick list ,"### Information about bug

When creating a pick list from material request of type material transfer and has items whose UOM is other than EACH and have conversion factor other than 1 like 2,4,6 etc for these items the stock qty in the pick list is taken as the qty from the material request items table which causes the qty in picklist to go into float like 0.146,1.333 etc after getting divided by the conversion factor which is incorrect. if the material request had passed on the stock qty to the pick list as the pick list stock qty then it would had worked out but that isnt happening . And this is the method where it is doing that in erpnext->picklist.py def get_items_with_location_and_quantity(item_doc, item_location_map, docstatus): 

**The material request**
![image](https://github.com/frappe/erpnext/assets/11851156/c232990e-be9f-44da-8ab7-bc4593b3e6d3)

**The pick list which was tried to create from it**
![image](https://github.com/frappe/erpnext/assets/11851156/8181a83d-1b93-4a44-b9f5-df7dec4cf02f)



### Module

stock

### Version

Frappe Framework: v15.12.0 (version-15) ERPNext: v15.27.7 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",asoral,2024-06-27 13:52:19+00:00,[],2024-08-14 08:52:32+00:00,,https://github.com/frappe/erpnext/issues/42061,"[('bug', None)]","[{'comment_id': 2288212084, 'issue_id': 2378220948, 'author': 'asoral', 'body': '+1', 'created_at': datetime.datetime(2024, 8, 14, 8, 52, 31, tzinfo=datetime.timezone.utc)}]","asoral (Issue Creator) on (2024-08-14 08:52:31 UTC): +1

"
2377729229,issue,open,,Unable to Post Exchange Rate Revaluation Entry for Zero Balance in Account Currency,"### Information about bug

### Issue Description
When the Balance in Account Currency is zero but there is an amount in base currency, ERPNext does not handle the exchange rate revaluation entry correctly. This prevents posting the revaluation entry for the difference amount.

### Steps to Reproduce
1. Create a foreign currency transaction.
2. Ensure that the Balance in Account Currency is zero.
3. Verify that there is an amount in the base currency.
4. Attempt to post an Exchange Rate Revaluation Entry for the difference amount.

### Expected Result
The system should allow posting the revaluation entry and correctly handle the difference amount between the account currency and the base currency.

### Actual Result
We have posted one transaction with a balance in the Account and Base currency. system posted the revaluation for this correctly but when there is zero balance in account currency the system throws an error or does not handle the revaluation entry properly. Please refer below screenshot


### Screenshots
![Exchange Gain loss Error](https://github.com/frappe/erpnext/assets/118710551/8a2e5559-a53c-42f9-bf37-6d326e81d0ff)


### Suggested Fix
Review the handling of exchange rate revaluation entries when the balance in the account currency is zero but there is a balance in the base currency. Ensure the system can post the revaluation entry correctly.


### Module

accounts

### Version

Frappe Framework: v15.29.0 (version-15)
ERPNext: v15.27.2 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",parasonit,2024-06-27 10:06:36+00:00,[],2024-06-27 10:06:36+00:00,,https://github.com/frappe/erpnext/issues/42052,"[('bug', None)]",[],
2377179368,issue,open,,Work Order Cannot Be Created From Material Request while using Template BOMs.,"### Information about bug

While creating Work Order from Material Request it is showing error that ""Row 1: Bill of Materials not found for the Item shirt"" which shouldn't show as there is template made and from that template bom should be made . Creating Variant BOMs will take lot of unnecessary space.

### Module

stock

### Version

ERPNext: v15.28.0 (version-15)

Frappe Framework: v15.31.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",Shantanu-mishra,2024-06-27 05:33:22+00:00,[],2024-06-27 12:12:20+00:00,,https://github.com/frappe/erpnext/issues/42049,"[('bug', None)]","[{'comment_id': 2194525276, 'issue_id': 2377179368, 'author': 'Shantanu-mishra', 'body': 'Made a Pull Request On possible solution on this problem', 'created_at': datetime.datetime(2024, 6, 27, 12, 12, 20, tzinfo=datetime.timezone.utc)}]","Shantanu-mishra (Issue Creator) on (2024-06-27 12:12:20 UTC): Made a Pull Request On possible solution on this problem

"
2375072486,issue,open,,Feature Request: Issue with Opening Invoice Creation Tool,"Description:
The current implementation of the Opening Invoice creation tool in our system poses a significant challenge for users. Specifically, when using this tool to generate invoices, it does not prompt for item selection. As a result, invoices are created without any items linked to them.

Impact:
This lack of item selection during invoice creation creates complications for users who are restricted to specific item groups by user permissions. Since these invoices do not include any items, they cannot be used effectively in sales processes. Users encounter difficulties when attempting to integrate these invoices into sales invoices due to the absence of relevant item groups in the system.

User Experience:
This issue undermines the usability of the tool, as it forces users to manually correct invoices or find alternative workflows to accommodate for missing item data. It also complicates compliance with user permissions set on item groups, leading to potential errors and inefficiencies in our operations.

Request:
I am requesting a review and consideration for enhancements to the Opening Invoice creation tool. Specifically, improvements are needed to ensure that item selection is incorporated during invoice creation, aligning with user permissions on item groups and improving overall usability of the tool.

Thank you for reviewing this request.",Gurukrupa-Export,2024-06-26 11:23:41+00:00,[],2024-06-26 11:23:41+00:00,,https://github.com/frappe/erpnext/issues/42044,"[('feature-request', None)]",[],
2375021838,issue,closed,completed,Show account balance optionally in Journal Entry based on a checkbox on the parent,"Show account balance optionally in Journal Entry based on a checkbox on the parent, because it takes time unnecessarily and very few people use it. By default, the checkbox should remain unchecked.
",nabinhait,2024-06-26 10:56:43+00:00,[],2024-07-12 00:10:58+00:00,2024-06-26 11:19:29+00:00,https://github.com/frappe/erpnext/issues/42041,"[('accounts', ''), ('feature-request', None)]",[],
2374796896,issue,closed,completed,Default Bank Account,"### Information about bug

When bank account is created for a Supplier (party) and default is checked in that bank account, at the time of creating a Payment Entry the party default bank account appears in field ""Company Bank Account"" instead of ""Party Bank Account"". 

### Module

accounts

### Version

latest version 15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",usman-alikhan,2024-06-26 09:11:22+00:00,[],2024-07-12 00:10:59+00:00,2024-06-26 09:43:38+00:00,https://github.com/frappe/erpnext/issues/42039,"[('bug', None)]","[{'comment_id': 2191266227, 'issue_id': 2374796896, 'author': 'Nihantra-Patel', 'body': ""I know this isn't a bug.\r\n\r\nIt's defined properly. If you want to set the party account, create a new bank account and select it when you create a payment entry. Otherwise, set it as default, and when you create the payment entry, it will automatically appear.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/459ee84a-6841-42b7-9b48-66620a210bf7"", 'created_at': datetime.datetime(2024, 6, 26, 9, 43, 38, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-26 09:43:38 UTC): I know this isn't a bug.

It's defined properly. If you want to set the party account, create a new bank account and select it when you create a payment entry. Otherwise, set it as default, and when you create the payment entry, it will automatically appear.


https://github.com/frappe/erpnext/assets/141945075/459ee84a-6841-42b7-9b48-66620a210bf7

"
2374682527,issue,open,,Restore asset issue in Asset,"### Information about bug

While clicking 'Restore Asset' in Asset, an error is displayed.
![Screenshot from 2024-06-26 13-30-38](https://github.com/frappe/erpnext/assets/166362542/da5319e3-d6ba-4248-8952-49f1ecaae5d8)
[Screencast from 26-06-24 01:38:59 PM IST.webm](https://github.com/frappe/erpnext/assets/166362542/f203df55-67f9-474f-adb1-7fee5aedb66e)



### Module

assets

### Version

erpnext 15.27.6
frappe 15.28.0
hrms 15.0.0
india_compliance 15.7.5

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""cleartax"": ""0.0.1"",
	""cleartax_integration"": ""0.0.1"",
	""erpnext"": ""15.27.6"",
	""frappe"": ""15.28.0"",
	""hrms"": ""15.0.0"",
	""india_compliance"": ""15.7.5"",
	""om_logistics"": ""0.0.1""
}
```
### Route
```
Form/Asset/ACC-ASS-2024-00120
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 115, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1768, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/erpnext/erpnext/assets/doctype/asset/depreciation.py"", line 487, in restore_asset
    reset_depreciation_schedule(asset, asset.disposal_date, notes)
  File ""apps/erpnext/erpnext/assets/doctype/asset/depreciation.py"", line 528, in reset_depreciation_schedule
    modify_depreciation_schedule_for_asset_repairs(asset_doc, notes)
  File ""apps/erpnext/erpnext/assets/doctype/asset/depreciation.py"", line 541, in modify_depreciation_schedule_for_asset_repairs
    asset_repair.modify_depreciation_schedule()
  File ""apps/erpnext/erpnext/assets/doctype/asset_repair/asset_repair.py"", line 368, in modify_depreciation_schedule
    for row in self.asset_doc.finance_books:
AttributeError: 'AssetRepair' object has no attribute 'asset_doc'

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""asset_name"": ""ACC-ASS-2024-00120""
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/erpnext.assets.doctype.asset.depreciation.restore_asset"",
	""request_id"": null
}
```
### Response Data
```
{
	""exception"": ""AttributeError: 'AssetRepair' object has no attribute 'asset_doc'"",
	""exc_type"": ""AttributeError"",
	""_exc_source"": ""erpnext (app)""
}
```
```
",Nandhini8848,2024-06-26 08:18:51+00:00,[],2024-06-26 08:18:51+00:00,,https://github.com/frappe/erpnext/issues/42038,"[('bug', None)]",[],
2372747786,issue,open,,Job Card remains Not Saved,"### Information about bug

If I start and complete a job card for the Job Card form, I am unable to submit because the status remains Not Saved.

### Module

manufacturing

### Version

ERPNext: v15.27.7

Frappe Framework: v15.30.0

Frappe HR: v15.22.3

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",akkrause,2024-06-25 13:46:06+00:00,[],2024-11-18 03:20:42+00:00,,https://github.com/frappe/erpnext/issues/42036,"[('bug', None)]","[{'comment_id': 2190936448, 'issue_id': 2372747786, 'author': 'Nihantra-Patel', 'body': ""We tested but we haven't found the issue. Can you share the gif/video with the process?"", 'created_at': datetime.datetime(2024, 6, 26, 6, 44, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2200104747, 'issue_id': 2372747786, 'author': 'akkrause', 'body': '![firefox_YdvDd5nhdh](https://github.com/frappe/erpnext/assets/9866357/bd8aa93e-1434-4d72-9287-3dd8e8342928)', 'created_at': datetime.datetime(2024, 7, 1, 13, 10, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2233312978, 'issue_id': 2372747786, 'author': 'akkrause', 'body': 'This only happens with Job Cards that have Scheduled Time Logs.', 'created_at': datetime.datetime(2024, 7, 17, 13, 21, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2245278275, 'issue_id': 2372747786, 'author': 'akkrause', 'body': 'My workaround is to select Disable Capacity Planning in Manufacturing Settings and delete all records in the Job Card Scheduled Time table.', 'created_at': datetime.datetime(2024, 7, 23, 13, 35, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2481863005, 'issue_id': 2372747786, 'author': 'lansgt', 'body': 'Same issue here...', 'created_at': datetime.datetime(2024, 11, 18, 3, 20, 41, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-26 06:44:33 UTC): We tested but we haven't found the issue. Can you share the gif/video with the process?

akkrause (Issue Creator) on (2024-07-01 13:10:54 UTC): ![firefox_YdvDd5nhdh](https://github.com/frappe/erpnext/assets/9866357/bd8aa93e-1434-4d72-9287-3dd8e8342928)

akkrause (Issue Creator) on (2024-07-17 13:21:48 UTC): This only happens with Job Cards that have Scheduled Time Logs.

akkrause (Issue Creator) on (2024-07-23 13:35:07 UTC): My workaround is to select Disable Capacity Planning in Manufacturing Settings and delete all records in the Job Card Scheduled Time table.

lansgt on (2024-11-18 03:20:41 UTC): Same issue here...

"
2371939688,issue,closed,completed,Serial No Ledger,"### Information about bug

<img width=""1071"" alt=""image"" src=""https://github.com/frappe/erpnext/assets/64956588/2589e349-f331-446c-82f4-300b6c78933e"">

Why does a regular user need 'DocType' permission for viewing serial no ledger? This user has rights as Stock Manager

### Module

accounts, stock

### Version

ERPNext: v15.27.7 (HEAD)
Frappe Framework: v15.30.0 (HEAD)
India Compliance: v15.8.1 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1768, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 921, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/query_report.py"", line 223, in run
    result = generate_report_result(report, filters, user, custom_columns, is_tree, parent_field)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 921, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/query_report.py"", line 109, in generate_report_result
    result = get_filtered_data(report.ref_doctype, columns, result, user)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/query_report.py"", line 590, in get_filtered_data
    match_filters_per_doctype = get_user_match_filters(linked_doctypes, user=user)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/query_report.py"", line 777, in get_user_match_filters
    filter_list = frappe.desk.reportview.build_match_conditions(dt, user, False)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/reportview.py"", line 684, in build_match_conditions
    match_conditions = DatabaseQuery(doctype, user=user).build_match_conditions(as_condition=as_condition)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/db_query.py"", line 937, in build_match_conditions
    frappe.throw(_(""No permission to read {0}"").format(_(self.doctype)), frappe.PermissionError)
  File ""apps/frappe/frappe/__init__.py"", line 645, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 610, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 561, in _raise_exception
    raise exc
frappe.exceptions.PermissionError: No permission to read DocType

(anonymous) @ request.js:473Understand this error",nakul80,2024-06-25 07:42:40+00:00,[],2024-07-10 00:09:05+00:00,2024-06-25 10:14:34+00:00,https://github.com/frappe/erpnext/issues/42022,"[('bug', None)]","[{'comment_id': 2188518881, 'issue_id': 2371939688, 'author': 'Nihantra-Patel', 'body': 'We tested. Everything is working fine. No problems were encountered in the latest version 15.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/3c0f7373-25e4-453a-86f2-8fd90fe560ef\r\n\r\nAgain, check your user rights or any changes added, then revert it, because we checked in the new installed version.', 'created_at': datetime.datetime(2024, 6, 25, 10, 14, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2188584136, 'issue_id': 2371939688, 'author': 'nakul80', 'body': 'Tried everything you said. Please note one difference. The code for error shows that the error msg will show name of the DocType giving the error. It seems its asking for DocType (core) to be accessible. This error goes away for admin ac which has access to Doctype(core) \r\n\r\n_frappe.throw((""No permission to read **{0}**"").format((self.doctype)), frappe.PermissionError)_', 'created_at': datetime.datetime(2024, 6, 25, 10, 46, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2188592084, 'issue_id': 2371939688, 'author': 'nakul80', 'body': 'Also, this user is able to view Serial No and Serial and Batch Bundle. Also can view Stock Ledger. Only Serial No Ledger is an error.', 'created_at': datetime.datetime(2024, 6, 25, 10, 51, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2188631412, 'issue_id': 2371939688, 'author': 'Nihantra-Patel', 'body': 'We tested, please check the video that i provided again. We just added the sales user role and checked the report to see if it was working properly.', 'created_at': datetime.datetime(2024, 6, 25, 11, 0, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2188654933, 'issue_id': 2371939688, 'author': 'nakul80', 'body': 'Reset all permissions for doctype serial no and serial and batch bundle and set user exactly like you. Logged in with that user and all light theme screenshots from that user\r\n\r\n<img width=""1000"" alt=""SCR-20240625-opox"" src=""https://github.com/frappe/erpnext/assets/64956588/ce0eb51f-a2d1-40ce-86b0-9fc45d0c48d3"">\r\n\r\n<img width=""1000"" alt=""SCR-20240625-oprc"" src=""https://github.com/frappe/erpnext/assets/64956588/b49627b5-06b8-49ed-9735-3fc9fd89995c"">\r\n\r\n<img width=""1000"" alt=""SCR-20240625-opzp"" src=""https://github.com/frappe/erpnext/assets/64956588/5cdba2b9-bd2f-4018-9129-4a6dfad9c973"">\r\n\r\n<img width=""1000"" alt=""SCR-20240625-oqbf"" src=""https://github.com/frappe/erpnext/assets/64956588/dbf1dcda-fdab-4bd4-9b39-5d1c485d1ebc"">\r\n\r\n<img width=""1000"" alt=""SCR-20240625-oqdu"" src=""https://github.com/frappe/erpnext/assets/64956588/16be1a11-2bc5-4f46-9249-fd61371a684e"">\r\n\r\n<img width=""1000"" alt=""SCR-20240625-oqhk"" src=""https://github.com/frappe/erpnext/assets/64956588/97a9a00d-5c7b-436c-b62b-74304dc8cf45"">\r\n\r\n<img width=""1000"" alt=""SCR-20240625-oqjs"" src=""https://github.com/frappe/erpnext/assets/64956588/470046c1-7bf6-4068-a57a-8b09fee88379"">', 'created_at': datetime.datetime(2024, 6, 25, 11, 12, 42, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-25 10:14:34 UTC): We tested. Everything is working fine. No problems were encountered in the latest version 15.


https://github.com/frappe/erpnext/assets/141945075/3c0f7373-25e4-453a-86f2-8fd90fe560ef

Again, check your user rights or any changes added, then revert it, because we checked in the new installed version.

nakul80 (Issue Creator) on (2024-06-25 10:46:41 UTC): Tried everything you said. Please note one difference. The code for error shows that the error msg will show name of the DocType giving the error. It seems its asking for DocType (core) to be accessible. This error goes away for admin ac which has access to Doctype(core) 

_frappe.throw((""No permission to read **{0}**"").format((self.doctype)), frappe.PermissionError)_

nakul80 (Issue Creator) on (2024-06-25 10:51:03 UTC): Also, this user is able to view Serial No and Serial and Batch Bundle. Also can view Stock Ledger. Only Serial No Ledger is an error.

Nihantra-Patel on (2024-06-25 11:00:52 UTC): We tested, please check the video that i provided again. We just added the sales user role and checked the report to see if it was working properly.

nakul80 (Issue Creator) on (2024-06-25 11:12:42 UTC): Reset all permissions for doctype serial no and serial and batch bundle and set user exactly like you. Logged in with that user and all light theme screenshots from that user

<img width=""1000"" alt=""SCR-20240625-opox"" src=""https://github.com/frappe/erpnext/assets/64956588/ce0eb51f-a2d1-40ce-86b0-9fc45d0c48d3"">

<img width=""1000"" alt=""SCR-20240625-oprc"" src=""https://github.com/frappe/erpnext/assets/64956588/b49627b5-06b8-49ed-9735-3fc9fd89995c"">

<img width=""1000"" alt=""SCR-20240625-opzp"" src=""https://github.com/frappe/erpnext/assets/64956588/5cdba2b9-bd2f-4018-9129-4a6dfad9c973"">

<img width=""1000"" alt=""SCR-20240625-oqbf"" src=""https://github.com/frappe/erpnext/assets/64956588/dbf1dcda-fdab-4bd4-9b39-5d1c485d1ebc"">

<img width=""1000"" alt=""SCR-20240625-oqdu"" src=""https://github.com/frappe/erpnext/assets/64956588/16be1a11-2bc5-4f46-9249-fd61371a684e"">

<img width=""1000"" alt=""SCR-20240625-oqhk"" src=""https://github.com/frappe/erpnext/assets/64956588/97a9a00d-5c7b-436c-b62b-74304dc8cf45"">

<img width=""1000"" alt=""SCR-20240625-oqjs"" src=""https://github.com/frappe/erpnext/assets/64956588/470046c1-7bf6-4068-a57a-8b09fee88379"">

"
2371485482,issue,closed,completed,Missing Letter Head >> Sales Invoice Batch Print,"### Information about bug

Sales Invoice Print format
![image](https://github.com/frappe/erpnext/assets/62122640/4e4b4b34-7522-4cd6-8369-ac5368a3651c)
Select multi invoices >> click action >> click print >> download pdf
missing letter head
![image](https://github.com/frappe/erpnext/assets/62122640/f0045b7b-4eb5-4b0f-b4b5-1b8b433bc29e)
![image](https://github.com/frappe/erpnext/assets/62122640/6235d771-d235-4472-a526-249ede05a77c)
![image](https://github.com/frappe/erpnext/assets/62122640/ea9fe573-f83c-4260-9822-94f128df1178)


### Module

selling

### Version

ERPNext: v15.27.1 (version-15)

Frappe Framework: v15.29.1 (version-15)

Frappe HR: v15.22.1 (version-15)

Payments: v0.0.1 (version-15)

Webshop: v0.0.1 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-06-25 02:21:38+00:00,[],2024-07-10 00:09:06+00:00,2024-06-25 10:20:30+00:00,https://github.com/frappe/erpnext/issues/42019,"[('bug', None)]","[{'comment_id': 2188536252, 'issue_id': 2371485482, 'author': 'Nihantra-Patel', 'body': 'Everything is working fine. No problems were encountered in the latest version 15.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/4c288137-e0cb-484e-994a-0721f1922fd5\r\n\r\nMaybe issue is in the wkhtmltopdf.\r\n\r\nplease install the correct / latest version of **wkhtmltopdf with qt patched**\r\n\r\nhttps://wkhtmltopdf.org/downloads.html', 'created_at': datetime.datetime(2024, 6, 25, 10, 20, 30, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-25 10:20:30 UTC): Everything is working fine. No problems were encountered in the latest version 15.


https://github.com/frappe/erpnext/assets/141945075/4c288137-e0cb-484e-994a-0721f1922fd5

Maybe issue is in the wkhtmltopdf.

please install the correct / latest version of **wkhtmltopdf with qt patched**

https://wkhtmltopdf.org/downloads.html

"
2370383902,issue,closed,completed,Import Log is not shown in Bank Statement Import,"### Information about bug

No import log preview in Bank Statment Import

### Module

accounts

### Version

Frappe Version: develop
ERPNext Version: develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",ljain112,2024-06-24 14:19:50+00:00,[],2024-07-25 00:08:59+00:00,2024-07-09 04:39:33+00:00,https://github.com/frappe/erpnext/issues/42017,"[('bug', None), ('released', None)]","[{'comment_id': 2220175360, 'issue_id': 2370383902, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.29.3 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.3)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 7, 10, 10, 45, 51, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-07-10 10:45:51 UTC): :tada: This issue has been resolved in version 15.29.3 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.3)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2370130728,issue,open,,UAE VAT 201 report is not considering multicurrency,"### Information about bug

If the transactions happened in another currency, the tax amount in item table is captured in transaction currency and is simply getting added to report without considering the currency:
![image](https://github.com/frappe/erpnext/assets/67686213/e7680ca3-7832-4767-99c4-9ec695e84848)
![image](https://github.com/frappe/erpnext/assets/67686213/16162e46-8660-4b97-8633-782beabb1d76)


### Module

accounts, regional

### Version

ERPNext: v14.70.6 (HEAD)

Frappe Framework: v14.76.2 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",Craftint,2024-06-24 12:30:54+00:00,[],2024-06-24 12:30:54+00:00,,https://github.com/frappe/erpnext/issues/42016,"[('bug', None)]",[],
2370112128,issue,open,,Tax Amount in sales invoice item table is not getting reset on deletion of sales taxes and charges,"### Information about bug

While adding sales taxes and charges template or table, the tax amount in item table is getting updated properly. But when we delete the taxes and the total taxes and charges as zero, it is not updating the tax amount in item table. 
It is affecting the UAE VAT 201 report

### Module

accounts, regional

### Version

ERPNext: v14.70.6 (HEAD)

Frappe Framework: v14.76.2 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",Craftint,2024-06-24 12:21:58+00:00,[],2024-06-24 12:21:58+00:00,,https://github.com/frappe/erpnext/issues/42015,"[('bug', None)]",[],
2369654087,issue,closed,completed,Add Workspace button is missing,"### Information about bug

When going to Build from the side bar and opening WORK SPACE list, its expected to show ""add workspace"" button, but its missing
![image](https://github.com/frappe/erpnext/assets/84542451/6adbc772-3dbe-4a9e-b0c5-5f0a04e4ea8f)


### Module

stock, buying, selling

### Version

ERPNext v15

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",Rebaz-balisani,2024-06-24 08:59:44+00:00,[],2024-07-10 00:09:07+00:00,2024-06-24 10:41:40+00:00,https://github.com/frappe/erpnext/issues/42010,"[('bug', None)]","[{'comment_id': 2186245733, 'issue_id': 2369654087, 'author': 'Nihantra-Patel', 'body': ""I know this isn't a bug.\r\n\r\nCheck the documentation for Workspace 2.0.\r\nhttps://frappeframework.com/docs/v14/user/en/desk/workspace#customization\r\nDo not use the workspace doctype to add or update the blocks on the workspace; check the above link.\r\n\r\nYou have to create a workspace from the desk view.\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/682140bd-0d8d-4946-b3db-59b18ffe1680)\r\n\r\nIf have a doubt, then please raise the issue on the [Frappe Forum](https://discuss.frappe.io/new). There are lots of thread in the forum"", 'created_at': datetime.datetime(2024, 6, 24, 10, 41, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2186597149, 'issue_id': 2369654087, 'author': 'Rebaz-balisani', 'body': '@Nihantra-Patel , the tutorials i was following is all v13 or v14 and yet and on the other side yet ERPNexts documentation not updated to mach the expresso version, thats why i thought it could be a bug. anyways thank you', 'created_at': datetime.datetime(2024, 6, 24, 13, 33, 36, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-24 10:41:40 UTC): I know this isn't a bug.

Check the documentation for Workspace 2.0.
https://frappeframework.com/docs/v14/user/en/desk/workspace#customization
Do not use the workspace doctype to add or update the blocks on the workspace; check the above link.

You have to create a workspace from the desk view.

![image](https://github.com/frappe/erpnext/assets/141945075/682140bd-0d8d-4946-b3db-59b18ffe1680)

If have a doubt, then please raise the issue on the [Frappe Forum](https://discuss.frappe.io/new). There are lots of thread in the forum

Rebaz-balisani (Issue Creator) on (2024-06-24 13:33:36 UTC): @Nihantra-Patel , the tutorials i was following is all v13 or v14 and yet and on the other side yet ERPNexts documentation not updated to mach the expresso version, thats why i thought it could be a bug. anyways thank you

"
2369514173,issue,closed,completed,Unable to create opportunity ,"### Information about bug

create lead with mobile number
![image](https://github.com/frappe/erpnext/assets/62122640/dc62fdc7-90e3-4a6b-bc3d-19a277cf4f82)

then create Opportunity
![image](https://github.com/frappe/erpnext/assets/62122640/7b2f6206-6175-4c67-af35-633d42ebe535)

system give message and unable to create it
![image](https://github.com/frappe/erpnext/assets/62122640/d745b885-9cf6-4cac-9726-d40f2b702b66)

after refresh lead then create opportunity will be working




### Module

CRM

### Version

Version : 15

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-06-24 07:56:31+00:00,[],2024-07-16 00:10:06+00:00,2024-07-01 07:35:42+00:00,https://github.com/frappe/erpnext/issues/42009,"[('bug', None)]",[],
2369063296,issue,closed,completed,Custom default letterhead not being used when 'attach document print' from email dialog,"### Information about bug

Even after setting the custom default letterhead via client script

frappe.ui.form.on('Doctype', {
    refresh(frm) {
        frm.doc.letter_head = ""CustomDefault"";
    }
});

Attached document print PDF is not being generated with the correct letterhead.


### Module

accounts

### Version

erpnext v15.27.7
frappe v15.30.0

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",lansgt,2024-06-24 02:27:45+00:00,[],2024-07-10 00:09:09+00:00,2024-06-24 06:04:53+00:00,https://github.com/frappe/erpnext/issues/42003,"[('bug', None)]","[{'comment_id': 2185681269, 'issue_id': 2369063296, 'author': 'Nihantra-Patel', 'body': 'First, you need to save the letterhead in the Doctype. To do this, you have to apply the client script and save the letterhead in the the field.\r\n\r\nPlease use it.\r\n\r\n\r\n```\r\nfrappe.ui.form.on(\'Doctype\', {\r\n    before_save: function(frm) {\r\n        frm.set_value(""letter_head"", ""CustomDefault"");\r\n    }\r\n});\r\n```', 'created_at': datetime.datetime(2024, 6, 24, 6, 4, 53, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-24 06:04:53 UTC): First, you need to save the letterhead in the Doctype. To do this, you have to apply the client script and save the letterhead in the the field.

Please use it.


```
frappe.ui.form.on('Doctype', {
    before_save: function(frm) {
        frm.set_value(""letter_head"", ""CustomDefault"");
    }
});
```

"
2368742517,issue,closed,completed,TCS calculation is not working,"### Information about bug

TCS is calclualted against the accumalated sales invoice value exceddeing 50,00,000.

Example - First I have received advance of 30,00,000 from customer. Now I am making the invoice of 30,00,000 for the same customer. I am getting the advance amonunt in the sales invoice so that the outstanding should be zero.

I want to calculate the TCS. When I made such etry ideally there should not be the TCS as TCS is only applicable when we cross the sales invoice value to 50 Lakh. In this case, system is calculating the TCS on 10 lakh as it is considering the sales invoice 30Lakh + advance amount 30Lakh and calculating as total of 60 Lakh and calculating TCS on 10 Lakh amount. Which is incorrect.

TCS set up is done as threshold value is 50,00,000 and cumulative value is 50,00,000. Rate applicable is 0.1%

This is tested on version 14 and version 15 and having the same issue. Also raised in office hour query and this is found as bug.

### Module

accounts

### Version

Frappe Version - 14
ERPNExt Version - 14.70

Also having the same issue with version 15 as well

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",Quantbittech,2024-06-23 17:19:26+00:00,[],2024-10-26 00:10:11+00:00,2024-10-08 12:04:31+00:00,https://github.com/frappe/erpnext/issues/42001,"[('bug', None), ('released', None)]","[{'comment_id': 2194460362, 'issue_id': 2368742517, 'author': 'parasonit', 'body': '> ### Information about bug\r\n> TCS is calclualted against the accumalated sales invoice value exceddeing 50,00,000.\r\n> \r\n> Example - First I have received advance of 30,00,000 from customer. Now I am making the invoice of 30,00,000 for the same customer. I am getting the advance amonunt in the sales invoice so that the outstanding should be zero.\r\n> \r\n> I want to calculate the TCS. When I made such etry ideally there should not be the TCS as TCS is only applicable when we cross the sales invoice value to 50 Lakh. In this case, system is calculating the TCS on 10 lakh as it is considering the sales invoice 30Lakh + advance amount 30Lakh and calculating as total of 60 Lakh and calculating TCS on 10 Lakh amount. Which is incorrect.\r\n> \r\n> TCS set up is done as threshold value is 50,00,000 and cumulative value is 50,00,000. Rate applicable is 0.1%\r\n> \r\n> This is tested on version 14 and version 15 and having the same issue. Also raised in office hour query and this is found as bug.\r\n> \r\n> ### Module\r\n> accounts\r\n> \r\n> ### Version\r\n> Frappe Version - 14 ERPNExt Version - 14.70\r\n> \r\n> Also having the same issue with version 15 as well\r\n> \r\n> ### Installation method\r\n> FrappeCloud\r\n> \r\n> ### Relevant log output / Stack trace / Full Error Message.\r\n> _No response_\r\n\r\nWe are also facing same issue', 'created_at': datetime.datetime(2024, 6, 27, 11, 43, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2403681485, 'issue_id': 2368742517, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.74.4 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.4)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 10, 10, 0, 48, 31, tzinfo=datetime.timezone.utc)}]","parasonit on (2024-06-27 11:43:02 UTC): We are also facing same issue

frappe-pr-bot on (2024-10-10 00:48:31 UTC): :tada: This issue has been resolved in version 14.74.4 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.74.4)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2367863822,issue,open,reopened,Need Picklist function in reserve qty against sales order case,"Currently, if we reserve Qty against SO, the system is not allowing to create picklist. It should allow to create picklist and on the basis of picking logic it should give batch i.e. stock details on picklist. It is very difficult now to pick the Qty as picklist function is not available. Can we consider the new functionality to ease the picking process? ",smbcatalyst,2024-06-22 14:57:25+00:00,[],2024-07-27 08:45:15+00:00,,https://github.com/frappe/erpnext/issues/41994,"[('feature-request', None)]","[{'comment_id': 2252953126, 'issue_id': 2367863822, 'author': 's-aga-r', 'body': '@smbcatalyst you can reserve the stock against the pick list instead of a sales order.\r\n\r\ndoc: https://docs.erpnext.com/docs/user/manual/en/stock-reservation#3-stock-reservation-from-pick-list', 'created_at': datetime.datetime(2024, 7, 26, 15, 1, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2253759988, 'issue_id': 2367863822, 'author': 'smbcatalyst', 'body': 'Currently, once we reserve the Qty on Sales order, the system will not allow to create Pick List and the system goes directly to Delivery Note. The system should allow to create Pick list when we reserve stock on sales order. \r\n\r\n1. If we are not allow to create pick list, how the team will pick material?\r\n2. If we create pick list, then it will difficult to get correct details on sales order as Sales order team and Pick list team (warehouse team) both are different and work on different time period.', 'created_at': datetime.datetime(2024, 7, 27, 4, 48, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2253764082, 'issue_id': 2367863822, 'author': 'smbcatalyst', 'body': 'Hi,\r\n\r\nWe request to reopen the ticket and reason is as follows:\r\n\r\nCurrently, once we reserve the Qty on Sales order, the system will not\r\nallow us to create a Pick List and the system goes directly to Delivery\r\nNote. The system should allow us to create a Pick list when we reserve\r\nstock on sales order.\r\n\r\n   1. If we are not allowed to create a pick list, how will the team pick\r\n   material?\r\n   2. If we create a pick list, then it will be difficult to get correct\r\n   details on sales order as the Sales order team and Pick list team\r\n   (warehouse team) both are different and work on different time periods.\r\n\r\n\r\nThanks and Regards,\r\nPrashant Jaybhaye\r\nDelivery Head\r\nMob. No. 70211 76496\r\n\r\n\r\nOn Fri, 26 Jul 2024 at 20:32, s-aga-r ***@***.***> wrote:\r\n\r\n> @smbcatalyst <https://github.com/smbcatalyst> you can reserve the stock\r\n> against the pick list instead of a sales order.\r\n>\r\n> doc:\r\n> https://docs.erpnext.com/docs/user/manual/en/stock-reservation#3-stock-reservation-from-pick-list\r\n>\r\n> ‚Äî\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/frappe/erpnext/issues/41994#issuecomment-2252953126>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/A3FPCBZQPJHOHUW2HGBLXVLZOJQGRAVCNFSM6AAAAABJXP7FHOVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDENJSHE2TGMJSGY>\r\n> .\r\n> You are receiving this because you were mentioned.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 7, 27, 4, 52, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2253783426, 'issue_id': 2367863822, 'author': 's-aga-r', 'body': '@smbcatalyst \r\n\r\nStock Reservation and Pick List are doing similar work. Stock Reservation blocks the stock from being used elsewhere, whereas the Pick List allows it. \r\n\r\nWhy do you want to create both? In case you want the stock to be reserved as per the pick list selection then you should reserve stock against the same instead of reserving it from a sales order.', 'created_at': datetime.datetime(2024, 7, 27, 5, 34, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2253791318, 'issue_id': 2367863822, 'author': 'smbcatalyst', 'body': ""Hi,\r\n\r\nFor most of the companies, the Order management team and warehouse\r\nmanagement teams are different. If we don't reserve stock on sales order\r\nand wait for the warehouse team to reserve the same which leads to hold\r\norder management till the warehouse team reserves the stock. As without\r\nreservation the system will show wrong stock available to order management\r\nteam.\r\n\r\nAlso, as mentioned in earlier mail, if we reserve stock on sales order, the\r\nsystem is not allowed to create a pick list and this will not help the\r\nwarehouse team to pick the stock from location.\r\n\r\nThanks and Regards,\r\nPrashant Jaybhaye\r\nDelivery Head\r\nMob. No. 70211 76496\r\n\r\n\r\nOn Sat, 27 Jul 2024 at 11:04, s-aga-r ***@***.***> wrote:\r\n\r\n> @smbcatalyst <https://github.com/smbcatalyst>\r\n>\r\n> Stock Reservation and Pick List are doing similar work. Stock Reservation\r\n> blocks the stock from being used elsewhere, whereas the Pick List allows it.\r\n>\r\n> Why do you want to create both? In case you want the stock to be reserved\r\n> as per the pick list selection then you should reserve stock against the\r\n> same instead of reserving it from a sales order.\r\n>\r\n> ‚Äî\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/frappe/erpnext/issues/41994#issuecomment-2253783426>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/A3FPCBZZRYSYAG455T5A4GTZOMWPTAVCNFSM6AAAAABJXP7FHOVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDENJTG44DGNBSGY>\r\n> .\r\n> You are receiving this because you were mentioned.Message ID:\r\n> ***@***.***>\r\n>"", 'created_at': datetime.datetime(2024, 7, 27, 5, 54, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2253847902, 'issue_id': 2367863822, 'author': 's-aga-r', 'body': '@smbcatalyst \r\n\r\nCorrect me if I am wrong. \r\n\r\nYou want the behaviour where one (order management team) can reserve the stock (based on qty only) against the Sales Order to ensure the availability and the other (warehouse management team) will create a pick list to exactly pick the serial and batch details. \r\n\r\nFor a workaround (for now) you can reserve the qty against the sales order. The warehouse management team will unreserve the same and create a pick list with serial and batch details.', 'created_at': datetime.datetime(2024, 7, 27, 6, 46, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2253860427, 'issue_id': 2367863822, 'author': 'smbcatalyst', 'body': '*You want the behaviour where one (order management team) can reserve the\r\nstock (based on qty only) against the Sales Order to ensure the\r\navailability and the other (warehouse management team) will create a pick\r\nlist to exactly pick the serial and batch details. - *Yes\r\n\r\n*For a workaround (for now) you can reserve the qty against the sales\r\norder. The warehouse management team will unreserve the same and create a\r\npick list with serial and batch details. - *We tried the same, it created\r\nconfusion when order creation and picklist creation was happening same time.\r\n\r\n\r\nThanks and Regards,\r\nPrashant Jaybhaye\r\nDelivery Head\r\nMob. No. 70211 76496\r\n\r\n\r\nOn Sat, 27 Jul 2024 at 12:17, s-aga-r ***@***.***> wrote:\r\n\r\n> @smbcatalyst <https://github.com/smbcatalyst>\r\n>\r\n> Correct me if I am wrong.\r\n>\r\n> You want the behaviour where one (order management team) can reserve the\r\n> stock (based on qty only) against the Sales Order to ensure the\r\n> availability and the other (warehouse management team) will create a pick\r\n> list to exactly pick the serial and batch details.\r\n>\r\n> For a workaround (for now) you can reserve the qty against the sales\r\n> order. The warehouse management team will unreserve the same and create a\r\n> pick list with serial and batch details.\r\n>\r\n> ‚Äî\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/frappe/erpnext/issues/41994#issuecomment-2253847902>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/A3FPCBZSYCIIMWLLCHRLCPLZOM665AVCNFSM6AAAAABJXP7FHOVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDENJTHA2DOOJQGI>\r\n> .\r\n> You are receiving this because you were mentioned.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 7, 27, 7, 8, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2254051039, 'issue_id': 2367863822, 'author': 's-aga-r', 'body': '@smbcatalyst \n\n- Disable Auto Reserve Serial and Batch from Stock Settings (Stock Reservation tab).\n- Add a server script to unreserve the stock reserved against the sales order (if any) on submit of the pick list.', 'created_at': datetime.datetime(2024, 7, 27, 8, 24, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2254071937, 'issue_id': 2367863822, 'author': 'smbcatalyst', 'body': 'Hi,\r\n\r\n\r\n   - *Disable Auto Reserve Serial and Batch from Stock Settings (Stock\r\n   Reservation tab).*\r\n   - *Add a server script to unreserve the stock reserved against the sales\r\n   order (if any) on submit of the pick list.*\r\n\r\n                          - To do this, the system is not allowed to create\r\na picklist if we reserve the stock against sales order. The whole issue had\r\ncome into picture due to this only.\r\n\r\nThanks and Regards,\r\nPrashant Jaybhaye\r\nDelivery Head\r\nMob. No. 70211 76496\r\n\r\n\r\nOn Sat, 27 Jul 2024 at 13:55, s-aga-r ***@***.***> wrote:\r\n\r\n> @smbcatalyst <https://github.com/smbcatalyst>\r\n>\r\n>    - Disable Auto Reserve Serial and Batch from Stock Settings (Stock\r\n>    Reservation tab).\r\n>    - Add a server script to unreserve the stock reserved against the\r\n>    sales order (if any) on submit of the pick list.\r\n>\r\n> ‚Äî\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/frappe/erpnext/issues/41994#issuecomment-2254051039>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/A3FPCBYRFGSUKOWMK5SMREDZONKOBAVCNFSM6AAAAABJXP7FHOVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDENJUGA2TCMBTHE>\r\n> .\r\n> You are receiving this because you were mentioned.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 7, 27, 8, 45, 13, tzinfo=datetime.timezone.utc)}]","s-aga-r on (2024-07-26 15:01:38 UTC): @smbcatalyst you can reserve the stock against the pick list instead of a sales order.

doc: https://docs.erpnext.com/docs/user/manual/en/stock-reservation#3-stock-reservation-from-pick-list

smbcatalyst (Issue Creator) on (2024-07-27 04:48:35 UTC): Currently, once we reserve the Qty on Sales order, the system will not allow to create Pick List and the system goes directly to Delivery Note. The system should allow to create Pick list when we reserve stock on sales order. 

1. If we are not allow to create pick list, how the team will pick material?
2. If we create pick list, then it will difficult to get correct details on sales order as Sales order team and Pick list team (warehouse team) both are different and work on different time period.

smbcatalyst (Issue Creator) on (2024-07-27 04:52:15 UTC): Hi,

We request to reopen the ticket and reason is as follows:

Currently, once we reserve the Qty on Sales order, the system will not
allow us to create a Pick List and the system goes directly to Delivery
Note. The system should allow us to create a Pick list when we reserve
stock on sales order.

   1. If we are not allowed to create a pick list, how will the team pick
   material?
   2. If we create a pick list, then it will be difficult to get correct
   details on sales order as the Sales order team and Pick list team
   (warehouse team) both are different and work on different time periods.


Thanks and Regards,
Prashant Jaybhaye
Delivery Head
Mob. No. 70211 76496


On Fri, 26 Jul 2024 at 20:32, s-aga-r ***@***.***> wrote:

s-aga-r on (2024-07-27 05:34:28 UTC): @smbcatalyst 

Stock Reservation and Pick List are doing similar work. Stock Reservation blocks the stock from being used elsewhere, whereas the Pick List allows it. 

Why do you want to create both? In case you want the stock to be reserved as per the pick list selection then you should reserve stock against the same instead of reserving it from a sales order.

smbcatalyst (Issue Creator) on (2024-07-27 05:54:48 UTC): Hi,

For most of the companies, the Order management team and warehouse
management teams are different. If we don't reserve stock on sales order
and wait for the warehouse team to reserve the same which leads to hold
order management till the warehouse team reserves the stock. As without
reservation the system will show wrong stock available to order management
team.

Also, as mentioned in earlier mail, if we reserve stock on sales order, the
system is not allowed to create a pick list and this will not help the
warehouse team to pick the stock from location.

Thanks and Regards,
Prashant Jaybhaye
Delivery Head
Mob. No. 70211 76496


On Sat, 27 Jul 2024 at 11:04, s-aga-r ***@***.***> wrote:

s-aga-r on (2024-07-27 06:46:49 UTC): @smbcatalyst 

Correct me if I am wrong. 

You want the behaviour where one (order management team) can reserve the stock (based on qty only) against the Sales Order to ensure the availability and the other (warehouse management team) will create a pick list to exactly pick the serial and batch details. 

For a workaround (for now) you can reserve the qty against the sales order. The warehouse management team will unreserve the same and create a pick list with serial and batch details.

smbcatalyst (Issue Creator) on (2024-07-27 07:08:28 UTC): *You want the behaviour where one (order management team) can reserve the
stock (based on qty only) against the Sales Order to ensure the
availability and the other (warehouse management team) will create a pick
list to exactly pick the serial and batch details. - *Yes

*For a workaround (for now) you can reserve the qty against the sales
order. The warehouse management team will unreserve the same and create a
pick list with serial and batch details. - *We tried the same, it created
confusion when order creation and picklist creation was happening same time.


Thanks and Regards,
Prashant Jaybhaye
Delivery Head
Mob. No. 70211 76496


On Sat, 27 Jul 2024 at 12:17, s-aga-r ***@***.***> wrote:

s-aga-r on (2024-07-27 08:24:42 UTC): @smbcatalyst 

- Disable Auto Reserve Serial and Batch from Stock Settings (Stock Reservation tab).
- Add a server script to unreserve the stock reserved against the sales order (if any) on submit of the pick list.

smbcatalyst (Issue Creator) on (2024-07-27 08:45:13 UTC): Hi,


   - *Disable Auto Reserve Serial and Batch from Stock Settings (Stock
   Reservation tab).*
   - *Add a server script to unreserve the stock reserved against the sales
   order (if any) on submit of the pick list.*

                          - To do this, the system is not allowed to create
a picklist if we reserve the stock against sales order. The whole issue had
come into picture due to this only.

Thanks and Regards,
Prashant Jaybhaye
Delivery Head
Mob. No. 70211 76496


On Sat, 27 Jul 2024 at 13:55, s-aga-r ***@***.***> wrote:

"
2367462028,issue,open,,Valuation price ,"How can I edit basic price in warehouse to warehouse stock transfer. Or branch to branch stock transfer. 
I think it's better to add or get journal entry for the stock transfer. Please basic rate change option enable ",cytecharabia,2024-06-22 02:14:38+00:00,[],2024-06-22 02:14:38+00:00,,https://github.com/frappe/erpnext/issues/41990,"[('feature-request', None)]",[],
2366924485,issue,open,,Item Valuation Rate docfield has no currency field reference,"### Information about bug

I believe the value in options should be set to `Company:company:default_currency`

![Screen Shot 2024-06-21 at 17 55 44](https://github.com/frappe/erpnext/assets/110036763/b3ea9926-c150-432d-825e-57eccce29b4c)


### Module

accounts, stock

### Version

ERPNext v15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-06-21 16:59:43+00:00,[],2024-06-21 16:59:43+00:00,,https://github.com/frappe/erpnext/issues/41988,"[('bug', None)]",[],
2366477799,issue,open,,Account Balance in Trial Balance Report Does Not Match Balance in General Ledger,"### Information about bug

The closing balance of certain accounts in the Trial Balance report are different from the balances of the same accounts in the General Ledger report. This is in hosted site on Frappe Cloud. Here are 3 GL accounts:

**Trial Balance Report**
<img width=""811"" alt=""Trial Balance Report"" src=""https://github.com/frappe/erpnext/assets/67414153/120c190f-80f5-4515-9689-580fdf7b9e52"">

General Ledger Report - First Account:
<img width=""789"" alt=""General Ledger Balance Acct1"" src=""https://github.com/frappe/erpnext/assets/67414153/55ae969d-2321-490f-8c4d-d4764e0b19e9"">

General Ledger Report - Second Account:
<img width=""786"" alt=""General Ledger Balance Acct2"" src=""https://github.com/frappe/erpnext/assets/67414153/0319e72f-a079-41d8-b57f-81186ef49e0b"">

General Ledger Report - Third Account:
<img width=""773"" alt=""General Ledger Balance Acct3"" src=""https://github.com/frappe/erpnext/assets/67414153/f5cc940d-5815-466e-bc0e-314d3183d575"">


### Module

accounts

### Version

Frappe Version: v14.77.0 (HEAD)
ERPNext Version: v14.70.7 (HEAD)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",THEOSKaris,2024-06-21 12:47:01+00:00,[],2024-06-21 12:47:01+00:00,,https://github.com/frappe/erpnext/issues/41986,"[('bug', None)]",[],
2366326059,issue,closed,completed,"Charge Type ""Actual"" is not supported in Bill of Entry","### Information about bug

**Describe the bug**
The Bill of Entry in ERPNext does not support the charge type ""Actual"". This limitation affects the accurate recording of actual GST charges in the Bill of Entry.

**To Reproduce**
Steps to reproduce the behavior:
1. Go to the 'Bill of Entry' form in ERPNext.
2. Try to add a charge with the type set to ""Actual"".
3. Observe that the system does not allow or recognize this charge type.

**Expected behavior**
The Bill of Entry should support the charge type ""Actual"" to allow for the proper entry and accounting of actual GST charges.

**Screenshots**
![image](https://github.com/frappe/erpnext/assets/118710551/60dadcf0-87d4-4230-9413-85c69781a5fe)
![image](https://github.com/frappe/erpnext/assets/118710551/e0669702-3d8f-4f1c-ac84-a0beaccce10f)

**Additional context**
Supporting the charge type ""Actual"" in the Bill of Entry is crucial for businesses that need to record actual incurred GST charges accurately. This feature would enhance the accuracy and functionality of the Bill of Entry module.

@vo

### Module

accounts

### Version

ERPNext: v15.27.2 (version-15)

Frappe Framework: v15.29.0 (version-15)

India Compliance: v15.7.5 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",parasonit,2024-06-21 11:18:52+00:00,[],2024-07-10 00:09:08+00:00,2024-06-24 06:09:17+00:00,https://github.com/frappe/erpnext/issues/41980,"[('bug', None)]","[{'comment_id': 2185687010, 'issue_id': 2366326059, 'author': 'Nihantra-Patel', 'body': ""It's an india-compliance issue, not ERPNext!\r\n\r\nSame issue: https://github.com/resilient-tech/india-compliance/issues/2275"", 'created_at': datetime.datetime(2024, 6, 24, 6, 9, 17, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-24 06:09:17 UTC): It's an india-compliance issue, not ERPNext!

Same issue: https://github.com/resilient-tech/india-compliance/issues/2275

"
2366236726,issue,closed,completed,Dashboard count for supplier and customer doesnt consider party_type for bank account and payment entry,"### Information about bug

If we have the same name for the customer and supplier both will considered in the count of connections.

### Module

buying, selling

### Version

Frappe Version - develop
ERPNext Version - develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",ljain112,2024-06-21 10:27:45+00:00,[],2024-07-19 00:08:56+00:00,2024-06-28 06:34:24+00:00,https://github.com/frappe/erpnext/issues/41978,"[('bug', None), ('released', None)]","[{'comment_id': 2205106160, 'issue_id': 2366236726, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.70.8 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.8)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 7, 3, 5, 3, 35, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-07-03 05:03:35 UTC): :tada: This issue has been resolved in version 14.70.8 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.8)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2366202821,issue,open,,error wkhtmltopdf library when converting HTML to PDF (email receipt on POS),"### Information about bug

Hello,

I encountered an issue when trying to send an email receipt from POS, and I found this error in the Email Queue List.

Thank you.

### Module

selling

### Version

- ERPNext: v15.17.0
- Frappe Framework: v15.28.0
- Docker Debian 12
- Bench: 5.22.3
- wkhtmltopdf 0.12.6.1 (with patched qt)

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
File ""/workspace/frappe-dev-toko-ac/apps/frappe/frappe/email/doctype/email_queue/email_queue.py"", line 167, in send
    message = ctx.build_message(recipient.recipient)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/workspace/frappe-dev-toko-ac/apps/frappe/frappe/email/doctype/email_queue/email_queue.py"", line 314, in build_message
    message = self.include_attachments(message)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/workspace/frappe-dev-toko-ac/apps/frappe/frappe/email/doctype/email_queue/email_queue.py"", line 387, in include_attachments
    print_format_file = frappe.attach_print(**attachment)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/workspace/frappe-dev-toko-ac/apps/frappe/frappe/__init__.py"", line 2225, in attach_print
    else get_print(doctype, name, **kwargs)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/workspace/frappe-dev-toko-ac/apps/frappe/frappe/__init__.py"", line 2184, in get_print
    return get_pdf(html, options=pdf_options, output=output) if as_pdf else html
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/workspace/frappe-dev-toko-ac/apps/frappe/frappe/utils/pdf.py"", line 90, in get_pdf
    filedata = pdfkit.from_string(html, options=options or {}, verbose=True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/workspace/frappe-dev-toko-ac/env/lib/python3.11/site-packages/pdfkit/api.py"", line 75, in from_string
    return r.to_pdf(output_path)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/workspace/frappe-dev-toko-ac/env/lib/python3.11/site-packages/pdfkit/pdfkit.py"", line 201, in to_pdf
    self.handle_error(exit_code, stderr)
  File ""/workspace/frappe-dev-toko-ac/env/lib/python3.11/site-packages/pdfkit/pdfkit.py"", line 155, in handle_error
    raise IOError('wkhtmltopdf reported an error:\n' + stderr)
```
",Nyuuk,2024-06-21 10:09:49+00:00,[],2024-06-21 11:00:06+00:00,,https://github.com/frappe/erpnext/issues/41974,"[('bug', None)]","[{'comment_id': 2182476001, 'issue_id': 2366202821, 'author': 'Nyuuk', 'body': 'here is log from `Error Log`:\r\n```\r\nTraceback with variables (most recent call last):\r\n  File ""apps/frappe/frappe/email/queue.py"", line 150, in flush\r\n    email_queue.send()\r\n      EmailQueue = <class \'frappe.email.doctype.email_queue.email_queue.EmailQueue\'>\r\n      email_queue_batch = [{\'name\': \'9kvdu2gk51\', \'sender\': \'Administrator <admin@example.com>\'}]\r\n      failed_email_queues = []\r\n      row = {\'name\': \'9kvdu2gk51\', \'sender\': \'Administrator <admin@example.com>\'}\r\n      email_queue = <EmailQueue: 9kvdu2gk51>\r\n  File ""apps/frappe/frappe/email/doctype/email_queue/email_queue.py"", line 167, in send\r\n    message = ctx.build_message(recipient.recipient)\r\n      self = <EmailQueue: 9kvdu2gk51>\r\n      smtp_server_instance = None\r\n      ctx = <frappe.email.doctype.email_queue.email_queue.SendMailContext object at 0x7f408c157b90>\r\n      message = None\r\n      recipient = <EmailQueueRecipient: 9kvdmc0c7t parent=9kvdu2gk51>\r\n  File ""apps/frappe/frappe/email/doctype/email_queue/email_queue.py"", line 314, in build_message\r\n    message = self.include_attachments(message)\r\n      self = <frappe.email.doctype.email_queue.email_queue.SendMailContext object at 0x7f408c157b90>\r\n      recipient_email = \'adnankhafabi@gmail.com\'\r\n      message = \'Content-Type: multipart/mixed; boundary=""===============5075836870118577313==""\\r\\nMIME-Version: 1.0\\r\\nMessage-Id: <171896227500.76.2347418120423753195@dev.toko-ac.com>\\r\\nX-Original-From: Administrator <admin@example.com>\\r\\nSubject: POS Invoice: ACC-PSINV-2024-00008\\r\\nFrom: Administrator <admin@example.com>\\r\\nTo: adnankhafabi@gmail.com\\r\\nDate: Fri, 21 Jun 2024 09:31:16 -0000\\r\\nReply-To: admin@example.com\\r\\nX-Frappe-Site: http://dev-ac-shop.incenter.id:8003\\r\\n\\r\\n--===============5075836870118577313==\\r\\nContent-Type: multipart/alternative; boundary=""===============5377778225347484015==""\\r\\nMIME-Version: 1.0\\r\\n\\r\\n--===============5377778225347484015==\\r\\nContent-Type: text/plain; charset=""utf-8""\\r\\nMIME-Version: 1.0\\r\\nContent-Transfer-Encoding: quoted-printable\\r\\n\\r\\nPOS Invoice: ACC-PSINV-2024-00008 [View this in your browser](http://dev-ac=\\r\\n-shop.incenter.id:8003/POS\\r\\nInvoice/ACC-PSINV-2024-00008?format=3DPOS%20Invoice&key=3D3bc12905cd8bfc846=\\r\\n7f2d4c55)\\r\\n\\r\\n\\r\\...\r\n  File ""apps/frappe/frappe/email/doctype/email_queue/email_queue.py"", line 387, in include_attachments\r\n    print_format_file = frappe.attach_print(**attachment)\r\n      self = <frappe.email.doctype.email_queue.email_queue.SendMailContext object at 0x7f408c157b90>\r\n      message = \'Content-Type: multipart/mixed; boundary=""===============5075836870118577313==""\\r\\nMIME-Version: 1.0\\r\\nMessage-Id: <171896227500.76.2347418120423753195@dev.toko-ac.com>\\r\\nX-Original-From: Administrator <admin@example.com>\\r\\nSubject: POS Invoice: ACC-PSINV-2024-00008\\r\\nFrom: Administrator <admin@example.com>\\r\\nTo: adnankhafabi@gmail.com\\r\\nDate: Fri, 21 Jun 2024 09:31:16 -0000\\r\\nReply-To: admin@example.com\\r\\nX-Frappe-Site: http://dev-ac-shop.incenter.id:8003\\r\\n\\r\\n--===============5075836870118577313==\\r\\nContent-Type: multipart/alternative; boundary=""===============5377778225347484015==""\\r\\nMIME-Version: 1.0\\r\\n\\r\\n--===============5377778225347484015==\\r\\nContent-Type: text/plain; charset=""utf-8""\\r\\nMIME-Version: 1.0\\r\\nContent-Transfer-Encoding: quoted-printable\\r\\n\\r\\nPOS Invoice: ACC-PSINV-2024-00008 [View this in your browser](http://dev-ac=\\r\\n-shop.incenter.id:8003/POS\\r\\nInvoice/ACC-PSINV-2024-00008?format=3DPOS%20Invoice&key=3D3bc12905cd8bfc846=\\r\\n7f2d4c55)\\r\\n\\r\\n\\r\\...\r\n      message_obj = <email.message.EmailMessage object at 0x7f408964e610>\r\n      attachments = [{\'print_format\': \'POS Invoice\', \'html\': None, \'doctype\': \'POS Invoice\', \'name\': \'ACC-PSINV-2024-00008\', \'lang\': \'en\', \'print_letterhead\': True}]\r\n      attachment = {\'print_format\': \'POS Invoice\', \'html\': None, \'doctype\': \'POS Invoice\', \'name\': \'ACC-PSINV-2024-00008\', \'lang\': \'en\', \'print_letterhead\': True}\r\n      file_filters = {}\r\n  File ""apps/frappe/frappe/__init__.py"", line 2225, in attach_print\r\n    else get_print(doctype, name, **kwargs)\r\n      doctype = \'POS Invoice\'\r\n      name = \'ACC-PSINV-2024-00008\'\r\n      file_name = None\r\n      print_format = \'POS Invoice\'\r\n      style = None\r\n      html = None\r\n      doc = None\r\n      lang = \'en\'\r\n      print_letterhead = True\r\n      password = ********\r\n      letterhead = None\r\n      print_language = <function print_language at 0x7f408a0b6700>\r\n      scrub_urls = <function scrub_urls at 0x7f408d8d0e00>\r\n      get_pdf = <function get_pdf at 0x7f40896d3060>\r\n      print_settings = {\'add_draft_heading\': \'1\', \'allow_page_break_inside_tables\': \'0\', \'allow_print_for_cancelled\': \'0\', \'allow_print_for_draft\': \'1\', \'creation\': None, \'docstatus\': \'0\', \'enable_print_server\': \'0\', \'enable_raw_printing\': \'0\', \'font\': \'Default\', \'font_size\': \'0\', \'idx\': \'0\', \'modified\': \'2024-06-12 07:43:09.846416\', \'modified_by\': \'Administrator\', \'name\': \'Print Settings\', \'owner\': \'Administrator\', \'pdf_page_height\': \'0\', \'pdf_page_size\': \'A4\', \'pdf_page_width\': \'0\', \'print_style\': \'Redesign\', \'repeat_header_footer\': \'1\', \'send_print_as_pdf\': \'1\', \'with_letterhead\': \'1\'}\r\n      kwargs = {\'print_format\': \'POS Invoice\', \'style\': None, \'doc\': None, \'no_letterhead\': False, \'letterhead\': None, \'password\': \'********\', \'as_pdf\': True}\r\n      content = \'\'\r\n      ext = \'.pdf\'\r\n  File ""apps/frappe/frappe/__init__.py"", line 2184, in get_print\r\n    return get_pdf(html, options=pdf_options, output=output) if as_pdf else html\r\n      doctype = \'POS Invoice\'\r\n      name = \'ACC-PSINV-2024-00008\'\r\n      print_format = \'POS Invoice\'\r\n      style = None\r\n      as_pdf = True\r\n      doc = None\r\n      output = None\r\n      no_letterhead = False\r\n      password = ********\r\n      pdf_options = {}\r\n      letterhead = None\r\n      get_pdf = <function get_pdf at 0x7f40896d3060>\r\n      get_response_without_exception_handling = <function get_response_without_exception_handling at 0x7f408964a3e0>\r\n      original_form_dict = {}\r\n      response = <Response 7303 bytes [200 OK]>\r\n      html = \'<!DOCTYPE html>\\n<html lang=""en"" dir=""ltr"">\\n<head>\\n\\t<meta charset=""utf-8"">\\n\\t<meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">\\n\\t<title>Adnan</title>\\n\\t<meta name=""generator"" content=""frappe"">\\n\\t<link type=""text/css"" rel=""stylesheet"" href=""/assets/frappe/dist/css/print.bundle.B6AKYMV4.css"">\\n\\t\\n\\t\\t<style>\\n\\t\\t@media screen {\\n\\t.print-format-gutter {\\n\\t\\tbackground-color: #d1d8dd;\\n\\t\\tpadding: 30px 0px;\\n\\t}\\n\\t.print-format {\\n\\t\\tbackground-color: white;\\n\\t\\tborder-radius: 8px;\\n\\t\\tmax-width: 8.3in;\\n\\t\\tmin-height: 11.69in;\\n\\t\\tpadding: 0.75in;\\n\\t\\tmargin: auto;\\n\\t\\tcolor: var(--gray-900);\\n\\t}\\n\\n\\t.print-format.landscape {\\n\\t\\tmax-width: 11.69in;\\n\\t\\tpadding: 0.2in;\\n\\t}\\n\\n\\t.page-break {\\n\\t\\t/* padding: 15px 0px; */\\n\\t\\tborder-bottom: 1px dashed #888;\\n\\t}\\n\\n\\t/* .page-break:first-child {\\n\\t\\tpadding-top: 0px;\\n\\t} */\\n\\n\\t.page-break:last-child {\\n\\t\\tborder-bottom: 0px;\\n\\t}\\n\\n\\t/* mozilla hack for images in table */\\n\\tbody:last-c...\r\n  File ""apps/frappe/frappe/utils/pdf.py"", line 90, in get_pdf\r\n    filedata = pdfkit.from_string(html, options=options or {}, verbose=True)\r\n      html = \'<!DOCTYPE html>\\n\\n<html dir=""ltr"" lang=""en""><head>\\n<meta charset=""utf-8""/>\\n<meta content=""width=device-width, initial-scale=1.0"" name=""viewport""/>\\n<title>Adnan</title>\\n<meta content=""frappe"" name=""generator""/>\\n<link href=""http://dev.toko-ac.com:8003/assets/frappe/dist/css/print.bundle.B6AKYMV4.css"" rel=""stylesheet"" type=""text/css""/>\\n<style>\\n\\t\\t@media screen {\\n\\t.print-format-gutter {\\n\\t\\tbackground-color: #d1d8dd;\\n\\t\\tpadding: 30px 0px;\\n\\t}\\n\\t.print-format {\\n\\t\\tbackground-color: white;\\n\\t\\tborder-radius: 8px;\\n\\t\\tmax-width: 8.3in;\\n\\t\\tmin-height: 11.69in;\\n\\t\\tpadding: 0.75in;\\n\\t\\tmargin: auto;\\n\\t\\tcolor: var(--gray-900);\\n\\t}\\n\\n\\t.print-format.landscape {\\n\\t\\tmax-width: 11.69in;\\n\\t\\tpadding: 0.2in;\\n\\t}\\n\\n\\t.page-break {\\n\\t\\t/* padding: 15px 0px; */\\n\\t\\tborder-bottom: 1px dashed #888;\\n\\t}\\n\\n\\t/* .page-break:first-child {\\n\\t\\tpadding-top: 0px;\\n\\t} */\\n\\n\\t.page-break:last-child {\\n\\t\\tborder-bottom: 0px;\\n\\t}\\n\\n\\t/* mozilla hack for images in table */\\n...\r\n      options = {\'print-media-type\': None, \'background\': None, \'images\': None, \'quiet\': None, \'encoding\': \'UTF-8\', \'margin-right\': \'15mm\', \'margin-left\': \'15mm\', \'margin-top\': \'15mm\', \'margin-bottom\': \'15mm\', \'page-size\': \'A4\', \'disable-javascript\': \'\', \'disable-local-file-access\': \'\', \'disable-smart-shrinking\': \'\'}\r\n      output = None\r\n      filedata = \'\'\r\n  File ""env/lib/python3.11/site-packages/pdfkit/api.py"", line 75, in from_string\r\n    return r.to_pdf(output_path)\r\n      input = \'<!DOCTYPE html>\\n\\n<html dir=""ltr"" lang=""en""><head>\\n<meta charset=""utf-8""/>\\n<meta content=""width=device-width, initial-scale=1.0"" name=""viewport""/>\\n<title>Adnan</title>\\n<meta content=""frappe"" name=""generator""/>\\n<link href=""http://dev.toko-ac.com:8003/assets/frappe/dist/css/print.bundle.B6AKYMV4.css"" rel=""stylesheet"" type=""text/css""/>\\n<style>\\n\\t\\t@media screen {\\n\\t.print-format-gutter {\\n\\t\\tbackground-color: #d1d8dd;\\n\\t\\tpadding: 30px 0px;\\n\\t}\\n\\t.print-format {\\n\\t\\tbackground-color: white;\\n\\t\\tborder-radius: 8px;\\n\\t\\tmax-width: 8.3in;\\n\\t\\tmin-height: 11.69in;\\n\\t\\tpadding: 0.75in;\\n\\t\\tmargin: auto;\\n\\t\\tcolor: var(--gray-900);\\n\\t}\\n\\n\\t.print-format.landscape {\\n\\t\\tmax-width: 11.69in;\\n\\t\\tpadding: 0.2in;\\n\\t}\\n\\n\\t.page-break {\\n\\t\\t/* padding: 15px 0px; */\\n\\t\\tborder-bottom: 1px dashed #888;\\n\\t}\\n\\n\\t/* .page-break:first-child {\\n\\t\\tpadding-top: 0px;\\n\\t} */\\n\\n\\t.page-break:last-child {\\n\\t\\tborder-bottom: 0px;\\n\\t}\\n\\n\\t/* mozilla hack for images in table */\\n...\r\n      output_path = None\r\n      options = {\'print-media-type\': None, \'background\': None, \'images\': None, \'quiet\': None, \'encoding\': \'UTF-8\', \'margin-right\': \'15mm\', \'margin-left\': \'15mm\', \'margin-top\': \'15mm\', \'margin-bottom\': \'15mm\', \'page-size\': \'A4\', \'disable-javascript\': \'\', \'disable-local-file-access\': \'\', \'disable-smart-shrinking\': \'\'}\r\n      toc = None\r\n      cover = None\r\n      css = None\r\n      configuration = None\r\n      cover_first = False\r\n      verbose = True\r\n      r = <pdfkit.pdfkit.PDFKit object at 0x7f4088c31d10>\r\n  File ""env/lib/python3.11/site-packages/pdfkit/pdfkit.py"", line 201, in to_pdf\r\n    self.handle_error(exit_code, stderr)\r\n      self = <pdfkit.pdfkit.PDFKit object at 0x7f4088c31d10>\r\n      path = None\r\n      args = [\'/usr/local/bin/wkhtmltopdf\', \'--print-media-type\', \'--background\', \'--images\', \'--quiet\', \'--encoding\', \'UTF-8\', \'--margin-right\', \'15mm\', \'--margin-left\', \'15mm\', \'--margin-top\', \'15mm\', \'--margin-bottom\', \'15mm\', \'--page-size\', \'A4\', \'--disable-javascript\', \'--disable-local-file-access\', \'--disable-smart-shrinking\', \'-\', \'-\']\r\n      result = <Popen: returncode: 1 args: [\'/usr/local/bin/wkhtmltopdf\', \'--print-media-ty...>\r\n      input = b\'<!DOCTYPE html>\\n\\n<html dir=""ltr"" lang=""en""><head>\\n<meta charset=""utf-8""/>\\n<meta content=""width=device-width, initial-scale=1.0"" name=""viewport""/>\\n<title>Adnan</title>\\n<meta content=""frappe"" name=""generator""/>\\n<link href=""http://dev.toko-ac.com:8003/assets/frappe/dist/css/print.bundle.B6AKYMV4.css"" rel=""stylesheet"" type=""text/css""/>\\n<style>\\n\\t\\t@media screen {\\n\\t.print-format-gutter {\\n\\t\\tbackground-color: #d1d8dd;\\n\\t\\tpadding: 30px 0px;\\n\\t}\\n\\t.print-format {\\n\\t\\tbackground-color: white;\\n\\t\\tborder-radius: 8px;\\n\\t\\tmax-width: 8.3in;\\n\\t\\tmin-height: 11.69in;\\n\\t\\tpadding: 0.75in;\\n\\t\\tmargin: auto;\\n\\t\\tcolor: var(--gray-900);\\n\\t}\\n\\n\\t.print-format.landscape {\\n\\t\\tmax-width: 11.69in;\\n\\t\\tpadding: 0.2in;\\n\\t}\\n\\n\\t.page-break {\\n\\t\\t/* padding: 15px 0px; */\\n\\t\\tborder-bottom: 1px dashed #888;\\n\\t}\\n\\n\\t/* .page-break:first-child {\\n\\t\\tpadding-top: 0px;\\n\\t} */\\n\\n\\t.page-break:last-child {\\n\\t\\tborder-bottom: 0px;\\n\\t}\\n\\n\\t/* mozilla hack for images in table */\\...\r\n      stdout = b\'%PDF-1.4\\n1 0 obj\\n<<\\n/Title (\\xfe\\xff\\x00A\\x00d\\x00n\\x00a\\x00n)\\n/Creator (\\xfe\\xff\\x00w\\x00k\\x00h\\x00t\\x00m\\x00l\\x00t\\x00o\\x00p\\x00d\\x00f\\x00 \\x000\\x00.\\x001\\x002\\x00.\\x006\\x00.\\x001)\\n/Producer (\\xfe\\xff\\x00Q\\x00t\\x00 \\x004\\x00.\\x008\\x00.\\x007)\\n/CreationDate (D:20240621164409+07\\\'00\\\')\\n>>\\nendobj\\n3 0 obj\\n<<\\n/Type /ExtGState\\n/SA true\\n/SM 0.02\\n/ca 1.0\\n/CA 1.0\\n/AIS false\\n/SMask /None>>\\nendobj\\n4 0 obj\\n[/Pattern /DeviceRGB]\\nendobj\\n8 0 obj\\n<<\\n/Type /Annot\\n/Subtype /Link\\n/Rect [80.2500000  785  129  799.250000 ]\\n/Border [0 0 0]\\n/A <<\\n/Type /Action\\n/S /URI\\n/URI (http://dev.toko-ac.com:8003/api/method/frappe.utils.print_format.download_pdf?doctype=POS%20Invoice&name=ACC-PSINV-2024-00008&key=None)\\n>>\\n>>\\nendobj\\n9 0 obj\\n<<\\n/Type /Catalog\\n/Pages 2 0 R\\n>>\\nendobj\\n5 0 obj\\n<<\\n/Type /Page\\n/Parent 2 0 R\\n/Contents 10 0 R\\n/Resources 12 0 R\\n/Annots 13 0 R\\n/MediaBox [0 0 595 842]\\n>>\\nendobj\\n12 0 obj\\n<<\\n/ColorSpace <<\\n/PCSp 4 0 R\\n/CSp /DeviceRGB\\n/CSpg /De...\r\n      stderr = \'Exit with code 1 due to network error: HostNotFoundError\\n\'\r\n      exit_code = 1\r\n  File ""env/lib/python3.11/site-packages/pdfkit/pdfkit.py"", line 155, in handle_error\r\n    raise IOError(\'wkhtmltopdf reported an error:\\n\' + stderr)\r\n      exit_code = 1\r\n      stderr = \'Exit with code 1 due to network error: HostNotFoundError\\n\'\r\n      stderr_lines = [\'Exit with code 1 due to network error: HostNotFoundError\']\r\nbuiltins.OSError: wkhtmltopdf reported an error:\r\nExit with code 1 due to network error: HostNotFoundError\r\n```', 'created_at': datetime.datetime(2024, 6, 21, 10, 26, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2182527762, 'issue_id': 2366202821, 'author': 'Nyuuk', 'body': 'where i can edit this host\r\n```text\r\nReply-To: admin@example.com\\r\\nX-Frappe-Site: http://dev-ac-shop.incenter.id:8003\\r\\n\\r\\n\r\n```\r\ni want to remove port `:8003`', 'created_at': datetime.datetime(2024, 6, 21, 11, 0, 5, tzinfo=datetime.timezone.utc)}]","Nyuuk (Issue Creator) on (2024-06-21 10:26:50 UTC): here is log from `Error Log`:
```
Traceback with variables (most recent call last):
  File ""apps/frappe/frappe/email/queue.py"", line 150, in flush
    email_queue.send()
      EmailQueue = <class 'frappe.email.doctype.email_queue.email_queue.EmailQueue'>
      email_queue_batch = [{'name': '9kvdu2gk51', 'sender': 'Administrator <admin@example.com>'}]
      failed_email_queues = []
      row = {'name': '9kvdu2gk51', 'sender': 'Administrator <admin@example.com>'}
      email_queue = <EmailQueue: 9kvdu2gk51>
  File ""apps/frappe/frappe/email/doctype/email_queue/email_queue.py"", line 167, in send
    message = ctx.build_message(recipient.recipient)
      self = <EmailQueue: 9kvdu2gk51>
      smtp_server_instance = None
      ctx = <frappe.email.doctype.email_queue.email_queue.SendMailContext object at 0x7f408c157b90>
      message = None
      recipient = <EmailQueueRecipient: 9kvdmc0c7t parent=9kvdu2gk51>
  File ""apps/frappe/frappe/email/doctype/email_queue/email_queue.py"", line 314, in build_message
    message = self.include_attachments(message)
      self = <frappe.email.doctype.email_queue.email_queue.SendMailContext object at 0x7f408c157b90>
      recipient_email = 'adnankhafabi@gmail.com'
      message = 'Content-Type: multipart/mixed; boundary=""===============5075836870118577313==""\r\nMIME-Version: 1.0\r\nMessage-Id: <171896227500.76.2347418120423753195@dev.toko-ac.com>\r\nX-Original-From: Administrator <admin@example.com>\r\nSubject: POS Invoice: ACC-PSINV-2024-00008\r\nFrom: Administrator <admin@example.com>\r\nTo: adnankhafabi@gmail.com\r\nDate: Fri, 21 Jun 2024 09:31:16 -0000\r\nReply-To: admin@example.com\r\nX-Frappe-Site: http://dev-ac-shop.incenter.id:8003\r\n\r\n--===============5075836870118577313==\r\nContent-Type: multipart/alternative; boundary=""===============5377778225347484015==""\r\nMIME-Version: 1.0\r\n\r\n--===============5377778225347484015==\r\nContent-Type: text/plain; charset=""utf-8""\r\nMIME-Version: 1.0\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nPOS Invoice: ACC-PSINV-2024-00008 [View this in your browser](http://dev-ac=\r\n-shop.incenter.id:8003/POS\r\nInvoice/ACC-PSINV-2024-00008?format=3DPOS%20Invoice&key=3D3bc12905cd8bfc846=\r\n7f2d4c55)\r\n\r\n\r\...
  File ""apps/frappe/frappe/email/doctype/email_queue/email_queue.py"", line 387, in include_attachments
    print_format_file = frappe.attach_print(**attachment)
      self = <frappe.email.doctype.email_queue.email_queue.SendMailContext object at 0x7f408c157b90>
      message = 'Content-Type: multipart/mixed; boundary=""===============5075836870118577313==""\r\nMIME-Version: 1.0\r\nMessage-Id: <171896227500.76.2347418120423753195@dev.toko-ac.com>\r\nX-Original-From: Administrator <admin@example.com>\r\nSubject: POS Invoice: ACC-PSINV-2024-00008\r\nFrom: Administrator <admin@example.com>\r\nTo: adnankhafabi@gmail.com\r\nDate: Fri, 21 Jun 2024 09:31:16 -0000\r\nReply-To: admin@example.com\r\nX-Frappe-Site: http://dev-ac-shop.incenter.id:8003\r\n\r\n--===============5075836870118577313==\r\nContent-Type: multipart/alternative; boundary=""===============5377778225347484015==""\r\nMIME-Version: 1.0\r\n\r\n--===============5377778225347484015==\r\nContent-Type: text/plain; charset=""utf-8""\r\nMIME-Version: 1.0\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nPOS Invoice: ACC-PSINV-2024-00008 [View this in your browser](http://dev-ac=\r\n-shop.incenter.id:8003/POS\r\nInvoice/ACC-PSINV-2024-00008?format=3DPOS%20Invoice&key=3D3bc12905cd8bfc846=\r\n7f2d4c55)\r\n\r\n\r\...
      message_obj = <email.message.EmailMessage object at 0x7f408964e610>
      attachments = [{'print_format': 'POS Invoice', 'html': None, 'doctype': 'POS Invoice', 'name': 'ACC-PSINV-2024-00008', 'lang': 'en', 'print_letterhead': True}]
      attachment = {'print_format': 'POS Invoice', 'html': None, 'doctype': 'POS Invoice', 'name': 'ACC-PSINV-2024-00008', 'lang': 'en', 'print_letterhead': True}
      file_filters = {}
  File ""apps/frappe/frappe/__init__.py"", line 2225, in attach_print
    else get_print(doctype, name, **kwargs)
      doctype = 'POS Invoice'
      name = 'ACC-PSINV-2024-00008'
      file_name = None
      print_format = 'POS Invoice'
      style = None
      html = None
      doc = None
      lang = 'en'
      print_letterhead = True
      password = ********
      letterhead = None
      print_language = <function print_language at 0x7f408a0b6700>
      scrub_urls = <function scrub_urls at 0x7f408d8d0e00>
      get_pdf = <function get_pdf at 0x7f40896d3060>
      print_settings = {'add_draft_heading': '1', 'allow_page_break_inside_tables': '0', 'allow_print_for_cancelled': '0', 'allow_print_for_draft': '1', 'creation': None, 'docstatus': '0', 'enable_print_server': '0', 'enable_raw_printing': '0', 'font': 'Default', 'font_size': '0', 'idx': '0', 'modified': '2024-06-12 07:43:09.846416', 'modified_by': 'Administrator', 'name': 'Print Settings', 'owner': 'Administrator', 'pdf_page_height': '0', 'pdf_page_size': 'A4', 'pdf_page_width': '0', 'print_style': 'Redesign', 'repeat_header_footer': '1', 'send_print_as_pdf': '1', 'with_letterhead': '1'}
      kwargs = {'print_format': 'POS Invoice', 'style': None, 'doc': None, 'no_letterhead': False, 'letterhead': None, 'password': '********', 'as_pdf': True}
      content = ''
      ext = '.pdf'
  File ""apps/frappe/frappe/__init__.py"", line 2184, in get_print
    return get_pdf(html, options=pdf_options, output=output) if as_pdf else html
      doctype = 'POS Invoice'
      name = 'ACC-PSINV-2024-00008'
      print_format = 'POS Invoice'
      style = None
      as_pdf = True
      doc = None
      output = None
      no_letterhead = False
      password = ********
      pdf_options = {}
      letterhead = None
      get_pdf = <function get_pdf at 0x7f40896d3060>
      get_response_without_exception_handling = <function get_response_without_exception_handling at 0x7f408964a3e0>
      original_form_dict = {}
      response = <Response 7303 bytes [200 OK]>
      html = '<!DOCTYPE html>\n<html lang=""en"" dir=""ltr"">\n<head>\n\t<meta charset=""utf-8"">\n\t<meta name=""viewport"" content=""width=device-width, initial-scale=1.0"">\n\t<title>Adnan</title>\n\t<meta name=""generator"" content=""frappe"">\n\t<link type=""text/css"" rel=""stylesheet"" href=""/assets/frappe/dist/css/print.bundle.B6AKYMV4.css"">\n\t\n\t\t<style>\n\t\t@media screen {\n\t.print-format-gutter {\n\t\tbackground-color: #d1d8dd;\n\t\tpadding: 30px 0px;\n\t}\n\t.print-format {\n\t\tbackground-color: white;\n\t\tborder-radius: 8px;\n\t\tmax-width: 8.3in;\n\t\tmin-height: 11.69in;\n\t\tpadding: 0.75in;\n\t\tmargin: auto;\n\t\tcolor: var(--gray-900);\n\t}\n\n\t.print-format.landscape {\n\t\tmax-width: 11.69in;\n\t\tpadding: 0.2in;\n\t}\n\n\t.page-break {\n\t\t/* padding: 15px 0px; */\n\t\tborder-bottom: 1px dashed #888;\n\t}\n\n\t/* .page-break:first-child {\n\t\tpadding-top: 0px;\n\t} */\n\n\t.page-break:last-child {\n\t\tborder-bottom: 0px;\n\t}\n\n\t/* mozilla hack for images in table */\n\tbody:last-c...
  File ""apps/frappe/frappe/utils/pdf.py"", line 90, in get_pdf
    filedata = pdfkit.from_string(html, options=options or {}, verbose=True)
      html = '<!DOCTYPE html>\n\n<html dir=""ltr"" lang=""en""><head>\n<meta charset=""utf-8""/>\n<meta content=""width=device-width, initial-scale=1.0"" name=""viewport""/>\n<title>Adnan</title>\n<meta content=""frappe"" name=""generator""/>\n<link href=""http://dev.toko-ac.com:8003/assets/frappe/dist/css/print.bundle.B6AKYMV4.css"" rel=""stylesheet"" type=""text/css""/>\n<style>\n\t\t@media screen {\n\t.print-format-gutter {\n\t\tbackground-color: #d1d8dd;\n\t\tpadding: 30px 0px;\n\t}\n\t.print-format {\n\t\tbackground-color: white;\n\t\tborder-radius: 8px;\n\t\tmax-width: 8.3in;\n\t\tmin-height: 11.69in;\n\t\tpadding: 0.75in;\n\t\tmargin: auto;\n\t\tcolor: var(--gray-900);\n\t}\n\n\t.print-format.landscape {\n\t\tmax-width: 11.69in;\n\t\tpadding: 0.2in;\n\t}\n\n\t.page-break {\n\t\t/* padding: 15px 0px; */\n\t\tborder-bottom: 1px dashed #888;\n\t}\n\n\t/* .page-break:first-child {\n\t\tpadding-top: 0px;\n\t} */\n\n\t.page-break:last-child {\n\t\tborder-bottom: 0px;\n\t}\n\n\t/* mozilla hack for images in table */\n...
      options = {'print-media-type': None, 'background': None, 'images': None, 'quiet': None, 'encoding': 'UTF-8', 'margin-right': '15mm', 'margin-left': '15mm', 'margin-top': '15mm', 'margin-bottom': '15mm', 'page-size': 'A4', 'disable-javascript': '', 'disable-local-file-access': '', 'disable-smart-shrinking': ''}
      output = None
      filedata = ''
  File ""env/lib/python3.11/site-packages/pdfkit/api.py"", line 75, in from_string
    return r.to_pdf(output_path)
      input = '<!DOCTYPE html>\n\n<html dir=""ltr"" lang=""en""><head>\n<meta charset=""utf-8""/>\n<meta content=""width=device-width, initial-scale=1.0"" name=""viewport""/>\n<title>Adnan</title>\n<meta content=""frappe"" name=""generator""/>\n<link href=""http://dev.toko-ac.com:8003/assets/frappe/dist/css/print.bundle.B6AKYMV4.css"" rel=""stylesheet"" type=""text/css""/>\n<style>\n\t\t@media screen {\n\t.print-format-gutter {\n\t\tbackground-color: #d1d8dd;\n\t\tpadding: 30px 0px;\n\t}\n\t.print-format {\n\t\tbackground-color: white;\n\t\tborder-radius: 8px;\n\t\tmax-width: 8.3in;\n\t\tmin-height: 11.69in;\n\t\tpadding: 0.75in;\n\t\tmargin: auto;\n\t\tcolor: var(--gray-900);\n\t}\n\n\t.print-format.landscape {\n\t\tmax-width: 11.69in;\n\t\tpadding: 0.2in;\n\t}\n\n\t.page-break {\n\t\t/* padding: 15px 0px; */\n\t\tborder-bottom: 1px dashed #888;\n\t}\n\n\t/* .page-break:first-child {\n\t\tpadding-top: 0px;\n\t} */\n\n\t.page-break:last-child {\n\t\tborder-bottom: 0px;\n\t}\n\n\t/* mozilla hack for images in table */\n...
      output_path = None
      options = {'print-media-type': None, 'background': None, 'images': None, 'quiet': None, 'encoding': 'UTF-8', 'margin-right': '15mm', 'margin-left': '15mm', 'margin-top': '15mm', 'margin-bottom': '15mm', 'page-size': 'A4', 'disable-javascript': '', 'disable-local-file-access': '', 'disable-smart-shrinking': ''}
      toc = None
      cover = None
      css = None
      configuration = None
      cover_first = False
      verbose = True
      r = <pdfkit.pdfkit.PDFKit object at 0x7f4088c31d10>
  File ""env/lib/python3.11/site-packages/pdfkit/pdfkit.py"", line 201, in to_pdf
    self.handle_error(exit_code, stderr)
      self = <pdfkit.pdfkit.PDFKit object at 0x7f4088c31d10>
      path = None
      args = ['/usr/local/bin/wkhtmltopdf', '--print-media-type', '--background', '--images', '--quiet', '--encoding', 'UTF-8', '--margin-right', '15mm', '--margin-left', '15mm', '--margin-top', '15mm', '--margin-bottom', '15mm', '--page-size', 'A4', '--disable-javascript', '--disable-local-file-access', '--disable-smart-shrinking', '-', '-']
      result = <Popen: returncode: 1 args: ['/usr/local/bin/wkhtmltopdf', '--print-media-ty...>
      input = b'<!DOCTYPE html>\n\n<html dir=""ltr"" lang=""en""><head>\n<meta charset=""utf-8""/>\n<meta content=""width=device-width, initial-scale=1.0"" name=""viewport""/>\n<title>Adnan</title>\n<meta content=""frappe"" name=""generator""/>\n<link href=""http://dev.toko-ac.com:8003/assets/frappe/dist/css/print.bundle.B6AKYMV4.css"" rel=""stylesheet"" type=""text/css""/>\n<style>\n\t\t@media screen {\n\t.print-format-gutter {\n\t\tbackground-color: #d1d8dd;\n\t\tpadding: 30px 0px;\n\t}\n\t.print-format {\n\t\tbackground-color: white;\n\t\tborder-radius: 8px;\n\t\tmax-width: 8.3in;\n\t\tmin-height: 11.69in;\n\t\tpadding: 0.75in;\n\t\tmargin: auto;\n\t\tcolor: var(--gray-900);\n\t}\n\n\t.print-format.landscape {\n\t\tmax-width: 11.69in;\n\t\tpadding: 0.2in;\n\t}\n\n\t.page-break {\n\t\t/* padding: 15px 0px; */\n\t\tborder-bottom: 1px dashed #888;\n\t}\n\n\t/* .page-break:first-child {\n\t\tpadding-top: 0px;\n\t} */\n\n\t.page-break:last-child {\n\t\tborder-bottom: 0px;\n\t}\n\n\t/* mozilla hack for images in table */\...
      stdout = b'%PDF-1.4\n1 0 obj\n<<\n/Title (\xfe\xff\x00A\x00d\x00n\x00a\x00n)\n/Creator (\xfe\xff\x00w\x00k\x00h\x00t\x00m\x00l\x00t\x00o\x00p\x00d\x00f\x00 \x000\x00.\x001\x002\x00.\x006\x00.\x001)\n/Producer (\xfe\xff\x00Q\x00t\x00 \x004\x00.\x008\x00.\x007)\n/CreationDate (D:20240621164409+07\'00\')\n>>\nendobj\n3 0 obj\n<<\n/Type /ExtGState\n/SA true\n/SM 0.02\n/ca 1.0\n/CA 1.0\n/AIS false\n/SMask /None>>\nendobj\n4 0 obj\n[/Pattern /DeviceRGB]\nendobj\n8 0 obj\n<<\n/Type /Annot\n/Subtype /Link\n/Rect [80.2500000  785  129  799.250000 ]\n/Border [0 0 0]\n/A <<\n/Type /Action\n/S /URI\n/URI (http://dev.toko-ac.com:8003/api/method/frappe.utils.print_format.download_pdf?doctype=POS%20Invoice&name=ACC-PSINV-2024-00008&key=None)\n>>\n>>\nendobj\n9 0 obj\n<<\n/Type /Catalog\n/Pages 2 0 R\n>>\nendobj\n5 0 obj\n<<\n/Type /Page\n/Parent 2 0 R\n/Contents 10 0 R\n/Resources 12 0 R\n/Annots 13 0 R\n/MediaBox [0 0 595 842]\n>>\nendobj\n12 0 obj\n<<\n/ColorSpace <<\n/PCSp 4 0 R\n/CSp /DeviceRGB\n/CSpg /De...
      stderr = 'Exit with code 1 due to network error: HostNotFoundError\n'
      exit_code = 1
  File ""env/lib/python3.11/site-packages/pdfkit/pdfkit.py"", line 155, in handle_error
    raise IOError('wkhtmltopdf reported an error:\n' + stderr)
      exit_code = 1
      stderr = 'Exit with code 1 due to network error: HostNotFoundError\n'
      stderr_lines = ['Exit with code 1 due to network error: HostNotFoundError']
builtins.OSError: wkhtmltopdf reported an error:
Exit with code 1 due to network error: HostNotFoundError
```

Nyuuk (Issue Creator) on (2024-06-21 11:00:05 UTC): where i can edit this host
```text
Reply-To: admin@example.com\r\nX-Frappe-Site: http://dev-ac-shop.incenter.id:8003\r\n\r\n
```
i want to remove port `:8003`

"
2366018979,issue,open,,Supplier Quotation Comparison,"Currently the system has a Supplier Quotation Comparison but the same appears in a row wise fashion.. 

A columnar view is far more effective and the current implementation seems severely basic. Example of one kind of comparison is as below.

<img width=""1126"" alt=""image"" src=""https://github.com/frappe/erpnext/assets/64956588/ad101a13-c800-467e-ba33-ba5e23df0a78"">
",nakul80,2024-06-21 08:31:17+00:00,[],2024-06-21 08:31:17+00:00,,https://github.com/frappe/erpnext/issues/41973,"[('feature-request', None)]",[],
2365962144,issue,open,,Calculation for Workers Wages,"
We have workers for our factory unit. Their wages calculation is different from the employees calculation.

Their wages are decided on the number of days they are present in the factory.

So if per day wages is 1200 & they have worked for 27 days then the Basic salary is 1200√ó27. = 32400

Also their overtime needs to be calculated which is decided per month. 8 hours is daily working hours & other hours apart from this is considered as overtime.

Overtime is calculated as daily wages*no: of hrs/month*2, i.e. if he has worked for 70 hrs more in whole month then OT = 1200√ó70√ó2

This need to be added to the salary & PF,PT & Gratuity & ESIC all are also calculated on basis of Basic Salary.

eg.

Salary inhand = (32400 + OT )-(PF +PT+GRATUITY+ESIC)
Provision for Calculation of workers wages with the above points included.

<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**Additional context**
Add any other context or screenshots about the feature request here.
",delta2023,2024-06-21 08:00:01+00:00,[],2024-06-21 08:21:14+00:00,,https://github.com/frappe/erpnext/issues/41971,"[('feature-request', None)]","[{'comment_id': 2182252755, 'issue_id': 2365962144, 'author': 'muchai', 'body': 'I think report this on: https://github.com/frappe/hrms\r\n\r\nAlso, we did something similar. See if it can work for your case, probably with some modifications.\r\n\r\nhttps://github.com/navariltd/nl-piece-rate-pay\r\n\r\nhttps://github.com/navariltd/nl-attendance-timesheet', 'created_at': datetime.datetime(2024, 6, 21, 8, 20, 51, tzinfo=datetime.timezone.utc)}]","muchai on (2024-06-21 08:20:51 UTC): I think report this on: https://github.com/frappe/hrms

Also, we did something similar. See if it can work for your case, probably with some modifications.

https://github.com/navariltd/nl-piece-rate-pay

https://github.com/navariltd/nl-attendance-timesheet

"
2365042757,issue,open,,Allow Quality Inspection for each quantity of a line Item in Purchase Receipt/Delivery Note,"**Is your feature request related to a problem? Please describe.**
Currently, in ERPNext, once a Quality Inspection (QI) report is submitted for an item in a Purchase Receipt, it prevents the creation of additional QI reports for the same item. This limitation poses a challenge when multiple inspections are needed for the same item, especially when the total quantity received needs to be individually inspected in separate batches or serial numbers.

**Describe the solution you'd like**
Allow the creation of individual Quality Inspection reports for every single quantity of line item in a Purchase Receipt until the total quantity is inspected. This feature would enhance the flexibility and accuracy of the quality control process, particularly for items managed with batches or serial numbers.


**Benefits**
‚Ä¢	Allows for more granular and accurate quality control processes.
‚Ä¢	Supports scenarios where individual items or batches need separate inspection reports.
‚Ä¢	Enhances the flexibility of the quality inspection process, particularly in industries requiring detailed inspections for each unit, batch, or serial number received.
",HUMENTH,2024-06-20 18:43:59+00:00,[],2024-07-21 05:52:46+00:00,,https://github.com/frappe/erpnext/issues/41969,"[('feature-request', None)]",[],
2364804848,issue,open,,ŸÉŸäŸÅ ÿπŸÖŸÑ Ÿàÿßÿ¨Ÿáÿßÿ™ ÿ¨ÿØŸäÿØŸá ŸÅŸä erpnext,ŸÉŸäŸÅ ÿπŸÖŸÑ Ÿàÿßÿ¨Ÿáÿßÿ™ ÿ¨ÿØŸäÿØŸá ŸÅŸä erpnext,Odai100,2024-06-20 16:09:44+00:00,[],2024-06-20 16:48:17+00:00,,https://github.com/frappe/erpnext/issues/41968,"[('feature-request', None)]","[{'comment_id': 2181129880, 'issue_id': 2364804848, 'author': 'agritheory', 'body': ""Maybe this is what you're looking for? \r\n\r\nhttps://frappeframework.com/docs/user/en/guides/app-development/how-to-improve-a-standard-control"", 'created_at': datetime.datetime(2024, 6, 20, 16, 48, 16, tzinfo=datetime.timezone.utc)}]","agritheory on (2024-06-20 16:48:16 UTC): Maybe this is what you're looking for? 

https://frappeframework.com/docs/user/en/guides/app-development/how-to-improve-a-standard-control

"
2364456004,issue,open,,Switch between reopen or creating new issue for answers to closed issues,"**Is your feature request related to a problem? Please describe.**
Some customers answers to very old, long time ago closed issues with a new problem. This leads to a reopened old issue.

**Describe the solution you'd like**
Having the choice in Support Settings to activate ""create new issue instead of reopen a closed issue"" and a time field as threshold for creating the new issue (e.g. after 10 days closed)

**Additional context**
It is a standard function in other helpdesk/support tools like freshdesk.
",bastelfeak,2024-06-20 13:28:03+00:00,[],2024-07-17 13:04:36+00:00,,https://github.com/frappe/erpnext/issues/41967,"[('feature-request', None)]",[],
2363630764,issue,closed,completed,Issue migrating from 15.20.6 -> 15.27.5 MYSQL date error,"### Information about bug

When running migrate the included error occurs.

Im able to work around it by allowing INVALID_DATES in the sql_mode on the MYSQL server then reverting it back after the migration but i am not sure if there is any repercussions/issues with this.

### Module

other

### Version

frappe/erpnext:v15.27.7

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
pymysql.err.OperationalError: (1292, ""Incorrect datetime value: '19/09/2023'"")

Updating DocTypes for erpnext       : [==                                      ] 5%Failed to alter schema using query: ALTER TABLE `tabSales Invoice` MODIFY `base_paid_amount` decimal(21,9) not null default 0, MODIFY `rounding_adjustment` decimal(21,9) not null default 0,
 MODIFY `base_change_amount` decimal(21,9) not null default 0, MODIFY `total_taxes_and_charges` decimal(21,9) not null default 0, MODIFY `base_net_total` decimal(21,9) not null default 0, MODIFY `additional_discount_percentage` decimal(21,9) not null default 0, MODIFY `to
tal` decimal(21,9) not null default 0, MODIFY `base_write_off_amount` decimal(21,9) not null default 0, MODIFY `total_commission` decimal(21,9) not null default 0, MODIFY `net_total` decimal(21,9) not null default 0, MODIFY `custom_external_creation_date` date, MODIFY `gr
and_total` decimal(21,9) not null default 0, MODIFY `outstanding_amount` decimal(21,9) not null default 0, MODIFY `discount_amount` decimal(21,9) not null default 0, MODIFY `rounded_total` decimal(21,9) not null default 0, MODIFY `conversion_rate` decimal(21,9) not null d
efault 0, MODIFY `base_rounded_total` decimal(21,9) not null default 0, MODIFY `sector_sinv` varchar(140), MODIFY `due_date` date, MODIFY `write_off_amount` decimal(21,9) not null default 0, MODIFY `total_advance` decimal(21,9) not null default 0, MODIFY `loyalty_amount`
decimal(21,9) not null default 0, MODIFY `commission_rate` decimal(21,9) not null default 0, MODIFY `amount_eligible_for_commission` decimal(21,9) not null default 0, MODIFY `base_discount_amount` decimal(21,9) not null default 0, MODIFY `print_format_selector` varchar(14
0), MODIFY `plc_conversion_rate` decimal(21,9) not null default 0, MODIFY `base_rounding_adjustment` decimal(21,9) not null default 0, MODIFY `total_billing_hours` decimal(21,9) not null default 0, MODIFY `debit_to` varchar(140), MODIFY `base_total` decimal(21,9) not null
 default 0, MODIFY `paid_amount` decimal(21,9) not null default 0, MODIFY `change_amount` decimal(21,9) not null default 0, MODIFY `base_grand_total` decimal(21,9) not null default 0, MODIFY `total_net_weight` decimal(21,9) not null default 0, MODIFY `base_total_taxes_and
_charges` decimal(21,9) not null default 0, MODIFY `total_qty` decimal(21,9) not null default 0


There was an issue while migrating the DocType: Sales Invoice
```
",dmateos,2024-06-20 06:30:54+00:00,[],2024-07-19 00:08:49+00:00,2024-07-04 07:37:45+00:00,https://github.com/frappe/erpnext/issues/41955,"[('bug', None)]","[{'comment_id': 2208314995, 'issue_id': 2363630764, 'author': 'Nihantra-Patel', 'body': 'We tested and migrated the older version to the newer one. Everything is working fine. No problems were encountered in the latest version 15. However, if any custom date or datetime fields were added, there might be issues.', 'created_at': datetime.datetime(2024, 7, 4, 7, 37, 45, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-07-04 07:37:45 UTC): We tested and migrated the older version to the newer one. Everything is working fine. No problems were encountered in the latest version 15. However, if any custom date or datetime fields were added, there might be issues.

"
2363490347,issue,closed,completed,Send email from quotation send multiple time,"### Information about bug

send quotation to 2 receivers
![image](https://github.com/frappe/erpnext/assets/62122640/b8be89db-9918-4312-ae45-0aa6698edfb0)
system send out 3 email to each receiver
![image](https://github.com/frappe/erpnext/assets/62122640/aec5a098-05e0-469b-90da-5455e5a4b95c)



### Module

accounts

### Version

Frappe : 14.68.2
ERPNext : 14.65.8


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-06-20 04:37:41+00:00,[],2024-07-06 00:08:24+00:00,2024-06-20 05:39:15+00:00,https://github.com/frappe/erpnext/issues/41953,"[('bug', None)]","[{'comment_id': 2179800815, 'issue_id': 2363490347, 'author': 'Nihantra-Patel', 'body': ""Hey, but how do you send mail? Triggered automatically, whether you send it yourself or send it from Communication.\r\nWe checked, but we didn't find anything like this, so please provide the step."", 'created_at': datetime.datetime(2024, 6, 20, 4, 48, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179817010, 'issue_id': 2363490347, 'author': 'thida-bcn', 'body': ""> Hey, but how do you send mail? Triggered automatically, whether you send it yourself or send it from Communication. We checked, but we didn't find anything like this, so please provide the step.\r\n\r\nfrom quotation >> email \r\n![image](https://github.com/frappe/erpnext/assets/62122640/4ac0ba36-fcbc-4106-ae2a-890b17ba27d8)"", 'created_at': datetime.datetime(2024, 6, 20, 5, 4, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179853582, 'issue_id': 2363490347, 'author': 'Nihantra-Patel', 'body': 'Kindly upgrade your version 14 because everything is working fine. No problems were encountered in the latest version 14.\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/9a7860c3-122c-44af-a78f-d9146dbea599)\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/4e35caac-1a07-4a4e-ad80-693eb411722d)\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/3e9a9037-aa4c-41f7-ba5f-a009f5585ca7)\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/92c869f5-c94b-4f5f-8259-6e2625f3e30c)\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/973a208c-d3df-4322-b50c-9896489d4954)\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/431b2f9e-2b03-4bb1-8268-748d386decdb)\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/4a15af52-daec-481f-ad95-7590a1ad0561)', 'created_at': datetime.datetime(2024, 6, 20, 5, 39, 15, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-20 04:48:16 UTC): Hey, but how do you send mail? Triggered automatically, whether you send it yourself or send it from Communication.
We checked, but we didn't find anything like this, so please provide the step.

thida-bcn (Issue Creator) on (2024-06-20 05:04:20 UTC): from quotation >> email 
![image](https://github.com/frappe/erpnext/assets/62122640/4ac0ba36-fcbc-4106-ae2a-890b17ba27d8)

Nihantra-Patel on (2024-06-20 05:39:15 UTC): Kindly upgrade your version 14 because everything is working fine. No problems were encountered in the latest version 14.

![image](https://github.com/frappe/erpnext/assets/141945075/9a7860c3-122c-44af-a78f-d9146dbea599)

![image](https://github.com/frappe/erpnext/assets/141945075/4e35caac-1a07-4a4e-ad80-693eb411722d)

![image](https://github.com/frappe/erpnext/assets/141945075/3e9a9037-aa4c-41f7-ba5f-a009f5585ca7)

![image](https://github.com/frappe/erpnext/assets/141945075/92c869f5-c94b-4f5f-8259-6e2625f3e30c)

![image](https://github.com/frappe/erpnext/assets/141945075/973a208c-d3df-4322-b50c-9896489d4954)

![image](https://github.com/frappe/erpnext/assets/141945075/431b2f9e-2b03-4bb1-8268-748d386decdb)

![image](https://github.com/frappe/erpnext/assets/141945075/4a15af52-daec-481f-ad95-7590a1ad0561)

"
2361907013,issue,open,,manufacturing for large number of variants,"Problem Statement:
In manufacturing organization where large amount of variants are created and there is a need to subcontract parts of the process to job work vendor ERPNext current manufacturing makes it too complex
e.g:  we have a scenario where we have to manufacture 
Mens Shirts (2 Color, 4 Sizes)
Each Color will consume different Fabric Material 
and Different size will consume different quantity of fabric/materials. so S will consume less than XL.
If we use erpnext for this scenario
1) we create 1 production plan
2) we create (8 work orders, 8 BOMs)
3) Each work order will create 3 JOB CARD (Assume we have 3 operations)
4) one or more of these JOB CARD will have to be tied up with subcontracting process.


this scenario is very regular in Footwear or other industries where number of SKUs is high with low qty
using ERPnext in current situation isnt helpful. it is too much of complexity


",Pankajo76,2024-06-19 09:51:31+00:00,['rohitwaghchaure'],2024-12-11 09:52:53+00:00,,https://github.com/frappe/erpnext/issues/41950,"[('feature-request', None)]",[],
2361779194,issue,closed,completed,Wrong Delete Batch on Purchase Receipt,"### Information about bug

When I selected the batch to delete, it deleted the wrong batch.

![batch delete](https://github.com/frappe/erpnext/assets/1784964/61c5a2ad-4058-48a7-8f3f-7f8b2194866d)


### Module

stock

### Version

ERPNext: v15.27.7 (version-15)

Frappe Framework: v15.30.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",xhijack,2024-06-19 08:56:58+00:00,[],2024-07-19 00:08:53+00:00,2024-06-24 09:26:09+00:00,https://github.com/frappe/erpnext/issues/41948,"[('bug', None), ('valid', ''), ('released', None)]","[{'comment_id': 2205110681, 'issue_id': 2361779194, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.29.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 7, 3, 5, 8, 39, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-07-03 05:08:39 UTC): :tada: This issue has been resolved in version 15.29.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2356266007,issue,closed,completed,Asset Depreciation Ledger Report Issue: Missing Data Without Financial Book Filter,"### Information about bug

In the Asset Depreciation Ledger report, the ""financial book"" filter is optional. However, if this filter is not specified, the report fails to fetch any values and displays ""nothing to show."" This issue occurs despite the filter being non-mandatory, resulting in no data appearing in the report when left unfilled.
Find the SS attached below:
![image](https://github.com/frappe/erpnext/assets/75359186/7c8354d7-8c5a-4d68-84ad-261802980bfc)
![image](https://github.com/frappe/erpnext/assets/75359186/37f7634e-5158-444e-af39-602722ba79b8)

Thank You.

### Module

accounts

### Version
Frappe Framework: v15.29.2
ERPNext: v15.27.6

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",Subramani830,2024-06-17 03:23:57+00:00,['khushi8112'],2024-07-06 00:08:26+00:00,2024-06-19 07:31:17+00:00,https://github.com/frappe/erpnext/issues/41915,"[('bug', None)]","[{'comment_id': 2177797517, 'issue_id': 2356266007, 'author': 'khushi8112', 'body': 'Hi,\r\nThe issue arises because, when the financial book filter is left unfilled, the current functionality of the report attempts to find assets that do not have any financial book specified at the time of depreciation. In your case, there are no assets without a financial book, which is why the report returns no data.', 'created_at': datetime.datetime(2024, 6, 19, 5, 45, 22, tzinfo=datetime.timezone.utc)}]","khushi8112 (Assginee) on (2024-06-19 05:45:22 UTC): Hi,
The issue arises because, when the financial book filter is left unfilled, the current functionality of the report attempts to find assets that do not have any financial book specified at the time of depreciation. In your case, there are no assets without a financial book, which is why the report returns no data.

"
2354845967,issue,closed,completed,"""Unknown column 'tabPurchase Invoice.item_code' in 'where clause'"" in Item-wise Purchase Register Report","### Information about bug

When choosing an Item from the standard filter in this report we get the following server error:

pymysql.err.OperationalError: (1054, ""Unknown column 'tabPurchase Invoice.item_code' in 'where clause'"")
Possible source of error: erpnext (app)

Here is a screen recording of it.

https://github.com/frappe/erpnext/assets/23268734/751940f2-dbef-41df-9416-c676f3b8802f






### Module

accounts

### Version

### App Versions
```
{
	""erpnext"": ""15.27.6"",
	""frappe"": ""15.29.2"",
	""hrms"": ""15.22.2"",
	""payments"": ""0.0.1""
}
```

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
### Route

query-report/Item-wise Purchase Register
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 114, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1768, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 921, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/query_report.py"", line 220, in run
    result = generate_report_result(report, filters, user, custom_columns, is_tree, parent_field)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 921, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/query_report.py"", line 81, in generate_report_result
    res = get_report_result(report, filters) or []
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/query_report.py"", line 62, in get_report_result
    res = report.execute_script_report(filters)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/core/doctype/report/report.py"", line 162, in execute_script_report
    res = self.execute_module(filters)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/core/doctype/report/report.py"", line 179, in execute_module
    return frappe.get_attr(method_name)(frappe._dict(filters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/accounts/report/item_wise_purchase_register/item_wise_purchase_register.py"", line 23, in execute
    return _execute(filters)
           ^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/accounts/report/item_wise_purchase_register/item_wise_purchase_register.py"", line 33, in _execute
    item_list = get_items(filters, additional_table_columns)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/accounts/report/item_wise_purchase_register/item_wise_purchase_register.py"", line 370, in get_items
    return query.run(as_dict=True)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/query_builder/utils.py"", line 87, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 234, in sql
    self._cursor.execute(query, values)
  File ""env/lib/python3.11/site-packages/pymysql/cursors.py"", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/cursors.py"", line 322, in _query
    conn.query(q)
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 825, in _read_query_result
    result.read()
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pymysql/connections.py"", line 775, in _read_packet
    packet.raise_for_error()
  File ""env/lib/python3.11/site-packages/pymysql/protocol.py"", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File ""env/lib/python3.11/site-packages/pymysql/err.py"", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1054, ""Unknown column 'tabPurchase Invoice.item_code' in 'where clause'"")

```
### Request Data
```
{
	""type"": ""GET"",
	""args"": {
		""report_name"": ""Item-wise Purchase Register"",
		""filters"": ""{\""from_date\"":\""2024-05-15\"",\""to_date\"":\""2024-06-15\"",\""item_code\"":\""PP-CP\"",\""company\"":\""Fresh To Go\""}"",
		""ignore_prepared_report"": false,
		""are_default_filters"": false
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.query_report.run"",
	""request_id"": ""e1e7ac1b-eed2-4347-be56-7df3da4eccd5""
}
```
### Response Data
```
{
	""exception"": ""pymysql.err.OperationalError: (1054, \""Unknown column 'tabPurchase Invoice.item_code' in 'where clause'\"")"",
	""exc_type"": ""OperationalError"",
	""_exc_source"": ""erpnext (app)""
}
```
```
",jayfiro,2024-06-15 13:08:00+00:00,[],2024-07-06 00:08:29+00:00,2024-06-17 08:31:07+00:00,https://github.com/frappe/erpnext/issues/41910,"[('bug', None), ('released', None)]","[{'comment_id': 2171765301, 'issue_id': 2354845967, 'author': 'exar888', 'body': 'yes, i also experience the same bug', 'created_at': datetime.datetime(2024, 6, 16, 16, 36, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2177850621, 'issue_id': 2354845967, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.27.7 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.27.7)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 6, 19, 6, 29, 35, tzinfo=datetime.timezone.utc)}]","exar888 on (2024-06-16 16:36:54 UTC): yes, i also experience the same bug

frappe-pr-bot on (2024-06-19 06:29:35 UTC): :tada: This issue has been resolved in version 15.27.7 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.27.7)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2354639968,issue,closed,completed,Batch No of an Item has negative stock of quantity -30.0 in the warehouse,"### Information about bug

While Submitting the Delivery Note, the following warning occurs. ""Batch No EET-2405459 of an Item  has negative stock of quantity -30.0 in the warehouse Mother Warehouse - ELPL""

<img width=""807"" alt=""Screenshot 2024-06-15 at 12 59 51‚ÄØPM"" src=""https://github.com/frappe/erpnext/assets/93510095/a1ed56a0-5e12-43ae-bd19-b64dcaf200ee"">
<img width=""1331"" alt=""Screenshot 2024-06-15 at 1 41 44‚ÄØPM"" src=""https://github.com/frappe/erpnext/assets/93510095/39dec927-b14f-4937-93ad-e92796cdcf31"">


### Module

stock, selling

### Version

Frappe Version - v15.29.2
ERPNext Version - v15.27.6

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",PraveenkumarSubramani,2024-06-15 08:14:15+00:00,[],2024-07-06 00:08:25+00:00,2024-06-20 03:55:05+00:00,https://github.com/frappe/erpnext/issues/41909,"[('bug', None)]","[{'comment_id': 2172632849, 'issue_id': 2354639968, 'author': 'Nihantra-Patel', 'body': 'Please check the time of your last stock purchase and the time on your delivery note. If the time of your last stock purchase is before you create the delivery note, then this will happen.', 'created_at': datetime.datetime(2024, 6, 17, 8, 28, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2173042218, 'issue_id': 2354639968, 'author': 'PraveenkumarSubramani', 'body': '@Nihantra-Patel We ensured it. But the purchase is not done after delivery note and we are creating the delivery note for current date.', 'created_at': datetime.datetime(2024, 6, 17, 10, 44, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2174845944, 'issue_id': 2354639968, 'author': 'thida-bcn', 'body': '> @Nihantra-Patel We ensured it. But the purchase is not done after delivery note and we are creating the delivery note for current date.\r\n\r\ncan you share me stock ledger', 'created_at': datetime.datetime(2024, 6, 18, 2, 38, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2178382567, 'issue_id': 2354639968, 'author': 'rohitwaghchaure', 'body': '@PraveenkumarSubramani do you have submitted serial and batch bundles with no Voucher No?', 'created_at': datetime.datetime(2024, 6, 19, 10, 56, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2178678201, 'issue_id': 2354639968, 'author': 'thida-bcn', 'body': '> ### Information about bug\r\n> While Submitting the Delivery Note, the following warning occurs. ""Batch No EET-2405459 of an Item has negative stock of quantity -30.0 in the warehouse Mother Warehouse - ELPL""\r\n> \r\n> <img alt=""Screenshot 2024-06-15 at 12 59 51\u202fPM"" width=""807"" src=""https://private-user-images.githubusercontent.com/93510095/339966619-a1ed56a0-5e12-43ae-bd19-b64dcaf200ee.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTg4MDI1NDksIm5iZiI6MTcxODgwMjI0OSwicGF0aCI6Ii85MzUxMDA5NS8zMzk5NjY2MTktYTFlZDU2YTAtNWUxMi00M2FlLWJkMTktYjY0ZGNhZjIwMGVlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA2MTklMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNjE5VDEzMDQwOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPThmZTMyMjE5MjJkYjJjOWU4OWZhNzU1ZTI0ODNmZTkyZDlkMTBlZTdhYjM5ZmU3YTA1OWRlNTAwYWM1MjQwMzEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.NqoLQ0EM4MWcvtjuJt8xCLtchqwLAutyuV8sS3y2Z-k""> <img alt=""Screenshot 2024-06-15 at 1 41 44\u202fPM"" width=""1331"" src=""https://private-user-images.githubusercontent.com/93510095/339966764-39dec927-b14f-4937-93ad-e92796cdcf31.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTg4MDI1NDksIm5iZiI6MTcxODgwMjI0OSwicGF0aCI6Ii85MzUxMDA5NS8zMzk5NjY3NjQtMzlkZWM5MjctYjE0Zi00OTM3LTkzYWQtZTkyNzk2Y2RjZjMxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA2MTklMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNjE5VDEzMDQwOVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTAxZTNmMzg1Yjk3ODAwNWUxNmU1ZDQ0MzgxM2M3MDk5YmQ3NmE1ZWM0ZjNmMTViOWZhY2MxMmY1NTk0YjEyY2MmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.-pBDfeZKykXbdfDptArkhexmy7u5Xo4-VEW3-lclzVQ"">\r\n> ### Module\r\n> stock, selling\r\n> \r\n> ### Version\r\n> Frappe Version - v15.29.2 ERPNext Version - v15.27.6\r\n> \r\n> ### Installation method\r\n> None\r\n> \r\n> ### Relevant log output / Stack trace / Full Error Message.\r\n> _No response_\r\n\r\nyou need to check time of purchase receipt / purchase invoice\r\nsales invoice or delivery date time should be after the time of purchase receipt / purchase invoice', 'created_at': datetime.datetime(2024, 6, 19, 13, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179757215, 'issue_id': 2354639968, 'author': 'PraveenkumarSubramani', 'body': '@rohitwaghchaure Yeah we have submitted serial and batch bundles without voucher no. After Cancel those serial and batch bundles, this issue solved.', 'created_at': datetime.datetime(2024, 6, 20, 3, 54, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179757351, 'issue_id': 2354639968, 'author': 'PraveenkumarSubramani', 'body': '@rohitwaghchaure Thanks!!!', 'created_at': datetime.datetime(2024, 6, 20, 3, 54, 15, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-17 08:28:23 UTC): Please check the time of your last stock purchase and the time on your delivery note. If the time of your last stock purchase is before you create the delivery note, then this will happen.

PraveenkumarSubramani (Issue Creator) on (2024-06-17 10:44:32 UTC): @Nihantra-Patel We ensured it. But the purchase is not done after delivery note and we are creating the delivery note for current date.

thida-bcn on (2024-06-18 02:38:52 UTC): can you share me stock ledger

rohitwaghchaure on (2024-06-19 10:56:48 UTC): @PraveenkumarSubramani do you have submitted serial and batch bundles with no Voucher No?

thida-bcn on (2024-06-19 13:06:00 UTC): you need to check time of purchase receipt / purchase invoice
sales invoice or delivery date time should be after the time of purchase receipt / purchase invoice

PraveenkumarSubramani (Issue Creator) on (2024-06-20 03:54:03 UTC): @rohitwaghchaure Yeah we have submitted serial and batch bundles without voucher no. After Cancel those serial and batch bundles, this issue solved.

PraveenkumarSubramani (Issue Creator) on (2024-06-20 03:54:15 UTC): @rohitwaghchaure Thanks!!!

"
2354619246,issue,closed,not_planned,Negative stock of quantity in the warehouse,"### Information about bug

While Submitting the Delivery Note, Error shows like ""Batch No of an Item has negative stock of quantity -30.0 in the warehouse""

<img width=""1304"" alt=""Screenshot 2024-06-15 at 1 01 37‚ÄØPM"" src=""https://github.com/frappe/erpnext/assets/93510095/6277a8d9-3513-4a2d-be16-4694a4fe8235"">
<img width=""807"" alt=""Screenshot 2024-06-15 at 12 59 51‚ÄØPM"" src=""https://github.com/frappe/erpnext/assets/93510095/91760085-7606-4be9-a1ca-2fcd3bcfcabc"">


### Module

stock, selling

### Version

Frappe Version - v15.29.2
ERPNext Version - v15.27.6 

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",PraveenkumarSubramani,2024-06-15 07:34:44+00:00,[],2024-07-02 00:08:53+00:00,2024-06-15 07:35:45+00:00,https://github.com/frappe/erpnext/issues/41908,"[('bug', None)]",[],
2353046922,issue,closed,completed,"Set ""Advance Payment Status"" in Order based on actual payment amount instead of Payment Request","Set ""Advance Payment Status"" in Order based on the actual payment amount against the Sales Order/Purchase Order, instead of Payment Request.

Ref Code: https://github.com/frappe/erpnext/blob/develop/erpnext/controllers/accounts_controller.py#L1945",nabinhait,2024-06-14 10:19:06+00:00,['nabinhait'],2024-07-26 00:08:43+00:00,2024-07-11 14:59:40+00:00,https://github.com/frappe/erpnext/issues/41906,"[('bug', None)]",[],
2353025853,issue,closed,not_planned,Don't allow negative amount on Payment Request,Don't allow negative amount on Payment Request,nabinhait,2024-06-14 10:08:17+00:00,['nabinhait'],2024-07-26 00:08:44+00:00,2024-07-11 13:21:20+00:00,https://github.com/frappe/erpnext/issues/41905,"[('bug', None)]","[{'comment_id': 2222928121, 'issue_id': 2353025853, 'author': 'sagarvora', 'body': 'Working on this in https://github.com/frappe/erpnext/issues/42280', 'created_at': datetime.datetime(2024, 7, 11, 13, 21, 20, tzinfo=datetime.timezone.utc)}]","sagarvora on (2024-07-11 13:21:20 UTC): Working on this in https://github.com/frappe/erpnext/issues/42280

"
2352981434,issue,closed,completed,Incorrect validation: total payment request amount cannot be greater than ref doc grand total,"https://github.com/frappe/erpnext/blob/develop/erpnext/accounts/doctype/payment_request/payment_request.py#L113

This validation seems wrong for Sales/Purchase Orders.",nabinhait,2024-06-14 09:45:52+00:00,['nabinhait'],2024-07-26 00:08:42+00:00,2024-07-11 15:05:08+00:00,https://github.com/frappe/erpnext/issues/41904,"[('bug', None)]",[],
2352969715,issue,open,,Create Payment Request against Payment Term and update paid amount on reference document against that term.,"- If a payment term is selected in the reference document while creating a Payment Request, the user should be able to select the payment term against which the payment is needed.
- Then the selected Term should be mapped to Payment Entry, on the creation of payment entry against the Payment Request.
- Update the paid amount against the term on the reference document ",nabinhait,2024-06-14 09:39:40+00:00,['nabinhait'],2024-06-14 10:41:18+00:00,,https://github.com/frappe/erpnext/issues/41902,"[('feature-request', None)]",[],
2352957861,issue,closed,not_planned,Incorrect Status of Payment Request,"### Issue

If we create a payment request and make the payment of the amount mentioned in Payment request then too it shows Partially Paid.

Steps to reproduce -

Create a Purchase Order of any Supplier for INR 10,000.

Submit the Purchase Order

Create Payment Request of INR 2,000 and submit it.

Create Payment Entry for the above mentioned Payment Request.

Now check the status of Payment Request, it shows as Partially Paid which should be Paid, as the complete payment against the request is done.

### Investigation

Currently, the status is shown based on payment status of reference document. Payment Entry is not linked directly to Payment Request, hence it's difficult to update status of Payment Request.


### Expected Solution

Maintain a link of Payment Request inside Payment Entry and update status based on it.",nabinhait,2024-06-14 09:33:33+00:00,['nabinhait'],2024-07-26 00:08:45+00:00,2024-07-11 13:05:39+00:00,https://github.com/frappe/erpnext/issues/41901,"[('bug', None)]","[{'comment_id': 2222891786, 'issue_id': 2352957861, 'author': 'sagarvora', 'body': 'Working on this in https://github.com/frappe/erpnext/issues/42280', 'created_at': datetime.datetime(2024, 7, 11, 13, 5, 40, tzinfo=datetime.timezone.utc)}]","sagarvora on (2024-07-11 13:05:40 UTC): Working on this in https://github.com/frappe/erpnext/issues/42280

"
2352574838,issue,open,, Apply Tax Withholding Amount Checkmark of the Payment Entry,"### Information about bug

Apply Tax Withholding Amount checkmark calculation is not working if the payment reference is from Purchase Invoice. But it is working fine if payment reference is blank or if payment reference is Purchase Order. 

I hope it also works with payment reference for Purchase Invoice if purchase order haven't applied tax withhold amount on it yet or the purchase invoice.

### Module

accounts

### Version

ERPNext: v14.70.6 (HEAD)
Frappe Framework: v14.76.2 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
none because the checkmark is not working or do not have any action.
```
",Ponyooooo,2024-06-14 05:54:43+00:00,[],2024-06-14 05:54:43+00:00,,https://github.com/frappe/erpnext/issues/41897,"[('bug', None)]",[],
2351213204,issue,closed,completed,Receipt Qty not updated in Material Request,"### Information about bug

Hi Team,

Steps to recreate the issue

1. Create material request
2. create a PO from material request
3. create purchase invoice with update stock check box against the Purchase Order
4. check ""Received Qty"" in material request
5. This field ""Received Qty"" is not getting updated



### Module

buying

### Version

ERPNext: v15.20.5 (version-15)
Frappe Framework: v15.23.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",satisharalkar,2024-06-13 13:50:01+00:00,[],2024-07-06 00:08:28+00:00,2024-06-17 06:05:37+00:00,https://github.com/frappe/erpnext/issues/41895,"[('bug', None), ('released', None)]","[{'comment_id': 2177850691, 'issue_id': 2351213204, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.27.7 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.27.7)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 6, 19, 6, 29, 38, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-06-19 06:29:38 UTC): :tada: This issue has been resolved in version 15.27.7 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.27.7)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2350966203,issue,closed,completed,"Return/ Credit Note against the Sales Invoice is not allowed, if decrease the Item Max Discount (%) of Item master","### Information about bug

    Item Mater Detail

    Item ID - SKU007

    Max Discount (%) = 25%

    Created Sales Invoice Detail

    Sales Invoice ID- ACC-SINV-2024-00010

    25% manual discount applied

    Change the Item (SKU007) Max Discount (%) = 10%

    Return/ Credit Note against Sales Invoice - ACC-SINV-2024-00010

    Click on Save - system showing error

Expected Result - The current Max Discount (%) of Item master should not validate when creating a Return/ Credit Note against the Sales Invoice
![image](https://github.com/frappe/erpnext/assets/108322669/558c6bd4-8067-40c0-8852-af7f64d17b9e)
![image](https://github.com/frappe/erpnext/assets/108322669/aee05568-1a2f-4528-9184-04fe6c80ef81)


### Module

selling

### Version

ERPNext: develop
Frappe Framework: develop 

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_


Internal Support Ticket: https://support.frappe.io/app/hd-ticket/16627",ljain112,2024-06-13 12:02:34+00:00,[],2024-07-25 00:09:00+00:00,2024-07-10 07:00:05+00:00,https://github.com/frappe/erpnext/issues/41893,"[('bug', None), ('released', None)]","[{'comment_id': 2220172816, 'issue_id': 2350966203, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.70.10 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.10)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 7, 10, 10, 44, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2220174942, 'issue_id': 2350966203, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.29.3 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.3)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 7, 10, 10, 45, 42, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-07-10 10:44:48 UTC): :tada: This issue has been resolved in version 14.70.10 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.10)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

frappe-pr-bot on (2024-07-10 10:45:42 UTC): :tada: This issue has been resolved in version 15.29.3 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.29.3)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2350787775,issue,open,,Include Item Tax Template in Update Item Tab,"**Feature Request**
The Update Item tab in ERPNext currently does not contain the Item Tax Template field. This field is essential for managing item-specific taxes and should be included in the item update form.

![image](https://github.com/frappe/erpnext/assets/118710551/dbb34f8a-1961-48a5-b115-0ccd91f18742)
![image](https://github.com/frappe/erpnext/assets/118710551/3296f07a-326e-4f52-9d7c-f97c0027a6fd)
![image](https://github.com/frappe/erpnext/assets/118710551/5e503990-b8b7-43c1-b147-5fe90078700a)
![image](https://github.com/frappe/erpnext/assets/118710551/7ef201a1-b481-4e42-912d-4874f1e4e4a0)

**Proposed Solution**
Add the 'Item Tax Template' field to the 'Update Item' tab in the Item doctype. This will allow users to easily update item-specific tax templates directly from the item update form.

**Benefits**
- Streamlines the process of managing item-specific taxes.
- Ensures consistency across item records.
- Enhances the user experience by providing a comprehensive set of fields in the item update form.
- We will not need to cancel and amend the PO for the updation.

**Additional Context**
This feature is important for businesses that manage complex tax structures and need to apply specific tax templates to different items. Including this field will significantly improve tax management capabilities in ERPNext.




Thank you for considering this feature request.
",parasonit,2024-06-13 10:31:05+00:00,[],2024-06-13 11:28:11+00:00,,https://github.com/frappe/erpnext/issues/41892,"[('feature-request', None)]","[{'comment_id': 2165382888, 'issue_id': 2350787775, 'author': 'Nihantra-Patel', 'body': 'Check FR: https://github.com/frappe/erpnext/issues/38548', 'created_at': datetime.datetime(2024, 6, 13, 11, 28, 10, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-13 11:28:10 UTC): Check FR: https://github.com/frappe/erpnext/issues/38548

"
2350517587,issue,closed,completed,Employee list not updated,"
![Screenshot_20240613-102943_Chrome](https://github.com/frappe/erpnext/assets/172584998/d3b14480-8c87-46a7-a9e6-e91dd90b070a)
![Screenshot_20240613-103029_Chrome](https://github.com/frappe/erpnext/assets/172584998/884c78e8-9eba-4e55-8d6c-48e2f16c1b11)
### Information about bug

I have two employees but they don't reflect on the HR dashboard under total employees. The dashboard says zero employees. Yet when I click on the total employees' button, the employees are there.

### Module

HR

### Version

version 15

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",Smokinjoint,2024-06-13 08:25:52+00:00,[],2024-07-02 00:09:00+00:00,2024-06-13 08:35:30+00:00,https://github.com/frappe/erpnext/issues/41891,"[('bug', None)]","[{'comment_id': 2165001414, 'issue_id': 2350517587, 'author': 'Nihantra-Patel', 'body': 'Kindly upgrade your version 15 because everything is working fine. No problems were encountered in the latest version 15.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/df2a2aff-2713-4c11-a501-c7802270ed26', 'created_at': datetime.datetime(2024, 6, 13, 8, 35, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2165092428, 'issue_id': 2350517587, 'author': 'Smokinjoint', 'body': 'noted tha\r\n\r\n> Kindly upgrade your version 15 because everything is working fine. No problems were encountered in the latest version 15.\r\n> \r\n>  scrnli_13_06_2024_14-04-45.mp4\r\n\r\nnoted thank you', 'created_at': datetime.datetime(2024, 6, 13, 9, 17, 19, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-13 08:35:30 UTC): Kindly upgrade your version 15 because everything is working fine. No problems were encountered in the latest version 15.


https://github.com/frappe/erpnext/assets/141945075/df2a2aff-2713-4c11-a501-c7802270ed26

Smokinjoint (Issue Creator) on (2024-06-13 09:17:19 UTC): noted tha


noted thank you

"
2349375591,issue,closed,completed,Purchase Order Update Items button does not add Supplier Codes,"### Information about bug

1. Submit Purchase Order
2. Use Update Items button
3. Added Items are not added with their Supplier Codes - the Supplier Codes are missing in printed documents even though they exist for given Items. Originally added items do have the Supplier Codes.

### Module

buying

### Version

Frappe Framework: v14.43.1 (version-14)
ERPNext: v14.33.2 (version-14)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",Codeaview,2024-06-12 17:49:59+00:00,[],2024-07-02 00:09:01+00:00,2024-06-13 05:14:41+00:00,https://github.com/frappe/erpnext/issues/41887,"[('bug', None)]","[{'comment_id': 2164394211, 'issue_id': 2349375591, 'author': 'Nihantra-Patel', 'body': 'The purpose of the update item feature after submission is to enable faster future entries. However, it does not update everything, and maintaining this feature has become very difficult. Therefore, the team is considering whether to remove this feature altogether. Many requests have been received to update various aspects such as XYZ, but not all items get updated. Additionally, people need to update pricing rules and discounts. Managing all these updates has become very challenging and is no longer feasible.', 'created_at': datetime.datetime(2024, 6, 13, 5, 14, 41, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-13 05:14:41 UTC): The purpose of the update item feature after submission is to enable faster future entries. However, it does not update everything, and maintaining this feature has become very difficult. Therefore, the team is considering whether to remove this feature altogether. Many requests have been received to update various aspects such as XYZ, but not all items get updated. Additionally, people need to update pricing rules and discounts. Managing all these updates has become very challenging and is no longer feasible.

"
2348485358,issue,closed,completed,Remove Validation to Prevent Foreign Currency Advance Accounts,"### Feature Request: Remove Validation to Prevent Foreign Currency Advance Accounts

**Context:**
We need to remove the validation that prevents using foreign currency advance accounts in ERPNext because we have EEFC accounts and frequently receive amounts in foreign currency as advances.

**Problem:**
The current validation in ERPNext does not allow using foreign currency advance accounts. This limitation causes issues for companies like ours that operate with EEFC accounts and need to process foreign currency advances efficiently.

![image](https://github.com/frappe/erpnext/assets/118710551/0ef8bf15-63c1-4b93-bc59-bbb9c0a7d8e7)
![image](https://github.com/frappe/erpnext/assets/118710551/c7445efc-bd03-4dfb-a258-fe877dfe5c83)
![image](https://github.com/frappe/erpnext/assets/118710551/94bebfd4-db1f-4460-bd69-277db248d7c8)


**Proposed Solution:**
Introduce a configuration option to allow specific foreign currency advance accounts. This could be done by:
1. Allowing users to specify which accounts can be used for foreign currency advances.
2. Implementing a customizable validation logic to bypass the default restriction for specified accounts.

![image](https://github.com/frappe/erpnext/assets/118710551/8700f482-9d82-481a-b52b-07f7ce3b0117)


**Benefits:**
- This feature will help businesses operating with EEFC accounts and handling foreign currency advances.
- It will improve the flexibility and usability of the Payment Entry process in ERPNext.

**Additional Information:**
We currently have EEFC accounts and need to receive and manage advances in foreign currency without facing validation issues. Implementing this feature will greatly enhance our workflow and ensure compliance with our financial operations.

This feature request. We believe it will be beneficial for many ERPNext users handling foreign currencies.
",parasonit,2024-06-12 11:05:28+00:00,['ruthra-kumar'],2024-07-13 00:09:27+00:00,2024-06-28 05:50:37+00:00,https://github.com/frappe/erpnext/issues/41878,"[('feature-request', None)]","[{'comment_id': 2165191160, 'issue_id': 2348485358, 'author': 'Nihantra-Patel', 'body': 'refactor: allow foreign currency advance accounts : https://github.com/frappe/erpnext/pull/41844', 'created_at': datetime.datetime(2024, 6, 13, 10, 1, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2196190167, 'issue_id': 2348485358, 'author': 'ruthra-kumar', 'body': 'Support added in https://github.com/frappe/erpnext/pull/41844', 'created_at': datetime.datetime(2024, 6, 28, 5, 50, 37, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-13 10:01:48 UTC): refactor: allow foreign currency advance accounts : https://github.com/frappe/erpnext/pull/41844

ruthra-kumar (Assginee) on (2024-06-28 05:50:37 UTC): Support added in https://github.com/frappe/erpnext/pull/41844

"
2347973543,issue,closed,completed,Accounting Dimension on Journal Entry is not Fetched from Invoices/Payments when Invoice Reconciled against Credit Note using Payment Reconciliation,"### Information about bug

Payment Reconciliation with Credit Note create Journal Entry that it seems has bug, Accounting Dimension other than Cost Center on newly created Journal Entry is blank although the Invoices/Payments have Accounting Dimension other than Cost Center. So allocated credit/debit has no tag on GL Report

Invoices reconciled against Credit Note using Payment Reconciliation
![image](https://github.com/frappe/erpnext/assets/80461903/49abf23e-1530-4d0d-a247-e18565a9818b)

Journal Entry created has no Accounting Dimension other than Cost Center
![image](https://github.com/frappe/erpnext/assets/80461903/93f6726a-ff98-4f90-be34-cbb533f52f97)


### Module

accounts

### Version

Frappe v14.62.4
ERPNext v14.46.7

### Installation method

manual install",landersaga,2024-06-12 06:58:35+00:00,[],2024-06-27 00:08:47+00:00,2024-06-12 09:47:58+00:00,https://github.com/frappe/erpnext/issues/41866,"[('bug', None)]","[{'comment_id': 2162582389, 'issue_id': 2347973543, 'author': 'Nihantra-Patel', 'body': 'Worked properly in the latest version 14. please check it.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/ae686ea2-ddc6-43d4-9e5b-4ffe09dd6a06', 'created_at': datetime.datetime(2024, 6, 12, 9, 47, 58, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-12 09:47:58 UTC): Worked properly in the latest version 14. please check it.


https://github.com/frappe/erpnext/assets/141945075/ae686ea2-ddc6-43d4-9e5b-4ffe09dd6a06

"
2346799295,issue,closed,completed,Server Error when not selected any warehouse in filter while Downloading Material request plan with where no wherehouse is selected,"### Information about bug

Getting the Server Error when **not selected any warehouse** in filter.
[Screencast from 10-06-24 09:12:09 PM IST.webm](https://github.com/frappe/erpnext/assets/117427350/71ac26bd-f3c2-49ee-8f0f-5085b05e22f7)

### Module

manufacturing

### Version

ERPNext: v15.27.1 (version-15)

Frappe Framework: v15.29.1 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
`Traceback (most recent call last): File ""apps/frappe/frappe/app.py"", line 111, in application frappe.handler.handle() File ""apps/frappe/frappe/handler.py"", line 49, in handle data = execute_cmd(cmd) File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd return frappe.call(method, **frappe.form_dict) File ""apps/frappe/frappe/__init__.py"", line 1768, in call return fn(*args, **newargs) File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper return func(*args, **kwargs) File ""apps/erpnext/erpnext/manufacturing/doctype/production_plan/production_plan.py"", line 1054, in download_raw_materials items = get_items_for_material_requests(doc, warehouses=warehouses, get_parent_warehouse_data=True) File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper return func(*args, **kwargs) File ""apps/erpnext/erpnext/manufacturing/doctype/production_plan/production_plan.py"", line 1451, in get_items_for_material_requests warehouses = list(set(get_warehouse_list(warehouses))) File ""apps/erpnext/erpnext/manufacturing/doctype/production_plan/production_plan.py"", line 1433, in get_warehouse_list warehouses = json.loads(warehouses) File ""/usr/lib/python3.10/json/__init__.py"", line 346, in loads return _default_decoder.decode(s) File ""/usr/lib/python3.10/json/decoder.py"", line 337, in decode obj, end = self.raw_decode(s, idx=_w(s, 0).end()) File ""/usr/lib/python3.10/json/decoder.py"", line 355, in raw_decode raise JSONDecodeError(""Expecting value"", s, err.value) from None json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)`
```
",Kishan0330,2024-06-11 16:06:10+00:00,[],2024-07-06 00:08:27+00:00,2024-06-12 07:32:08+00:00,https://github.com/frappe/erpnext/issues/41862,"[('bug', None), ('released', None)]","[{'comment_id': 2177850755, 'issue_id': 2346799295, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.27.7 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.27.7)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 6, 19, 6, 29, 41, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-06-19 06:29:41 UTC): :tada: This issue has been resolved in version 15.27.7 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.27.7)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2346420468,issue,open,,Unable to Submit Transaction : After Period Closing,"### Information about bug

We used to close period monthly.
![image](https://github.com/frappe/erpnext/assets/62122640/4776e8fc-57ee-4195-91e5-f016313d584c)
After closing period, unable to submit transactions.
![image](https://github.com/frappe/erpnext/assets/62122640/7a0d0020-4c2d-4e63-9d13-7658a253a37c)






### Module

stock

### Version

Frappe : 15.29.1
ERPNext : 15.27.1

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-06-11 13:19:20+00:00,[],2024-06-11 13:19:20+00:00,,https://github.com/frappe/erpnext/issues/41861,"[('bug', None)]",[],
2346267393,issue,closed,completed,Work Order - Closed - Error in Return Components,"### Information about bug


https://github.com/frappe/erpnext/assets/21578167/cc806811-8dd9-4f28-b1db-42f42d213155



### Module

manufacturing

### Version

Version - 15 Latest All

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
request.js:473 Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 115, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1768, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/erpnext/erpnext/manufacturing/doctype/work_order/work_order.py"", line 1705, in make_stock_return_entry
    stock_entry.add_transfered_raw_materials_in_items()
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 2167, in add_transfered_raw_materials_in_items
    self.update_item_in_stock_entry_detail(row, item, qty)
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 2206, in update_item_in_stock_entry_detail
    ""serial_and_batch_bundle"": create_serial_and_batch_bundle(self, row, item, ""Outward"")
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 3183, in create_serial_and_batch_bundle
    return doc.insert(ignore_permissions=True).name
  File ""apps/frappe/frappe/model/document.py"", line 292, in insert
    self._validate()
  File ""apps/frappe/frappe/model/document.py"", line 574, in _validate
    self._validate_mandatory()
  File ""apps/frappe/frappe/model/document.py"", line 911, in _validate_mandatory
    raise frappe.MandatoryError(
frappe.exceptions.MandatoryError: [Serial and Batch Bundle, SABB-00115080]: entries
```
",dineshpanchal93,2024-06-11 12:13:48+00:00,[],2024-07-02 00:08:52+00:00,2024-06-17 10:08:13+00:00,https://github.com/frappe/erpnext/issues/41859,"[('bug', None)]","[{'comment_id': 2172958140, 'issue_id': 2346267393, 'author': 'Nihantra-Patel', 'body': 'Duplicate issue: https://github.com/frappe/erpnext/issues/41800', 'created_at': datetime.datetime(2024, 6, 17, 10, 8, 13, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-17 10:08:13 UTC): Duplicate issue: https://github.com/frappe/erpnext/issues/41800

"
2345961415,issue,closed,completed,General Ledger includes entries from two different accounts instead of the one selected in filter,"### Information about bug

In one instance, two accounts seem ""merged"" in the General Ledger: selecting either one of them in the filter (manually or by going to the account in _Chart of Accounts_ then clicking on _View_ ‚Üí _General Ledger_) returns the same set of entries:

Selected account: **LI-TP-UVF**:

<img width=""915"" alt=""Screenshot 2024-06-11 at 11 34 08"" src=""https://github.com/frappe/erpnext/assets/28401247/c48efe5f-4ad3-4b7c-9dc5-5e9bdde55e33"">

Selected account: **LI-NT-AP-AKBG**:

<img width=""915"" alt=""Screenshot 2024-06-11 at 11 36 44"" src=""https://github.com/frappe/erpnext/assets/28401247/849ba60f-661a-404e-804e-e736bc476464"">

The entries **do show up correctly** in the _Balance Sheet_:

<img width=""602"" alt=""Screenshot 2024-06-11 at 11 44 26"" src=""https://github.com/frappe/erpnext/assets/28401247/73ee9628-5347-4773-a7a3-4b57855016a1"">

`1222.28 = 1166.28 + 56.00`

<img width=""545"" alt=""Screenshot 2024-06-11 at 11 44 43"" src=""https://github.com/frappe/erpnext/assets/28401247/f45bd617-801c-4090-beb3-277f00869ab3"">

`2518.04 = 588.04 + 1930.00`

The entries **also show up correctly** in the _General Ledger_ if using the _table ""Account"" filter_:

<img width=""901"" alt=""Screenshot 2024-06-11 at 11 50 39"" src=""https://github.com/frappe/erpnext/assets/28401247/0ef8fd76-fe3d-42b6-baf7-eff2d0fa78f4"">

<img width=""905"" alt=""Screenshot 2024-06-11 at 11 51 21"" src=""https://github.com/frappe/erpnext/assets/28401247/597644ac-242a-403b-8d10-467d0d30e357"">


### Module

accounts

### Version

```
bench 5.17.2
erpnext 15.27.2
erpnextswiss 1.23.3
frappe 15.29.1
hrms 15.22.1
payments 0.0.1
```

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",konradbr,2024-06-11 09:52:16+00:00,[],2024-07-27 00:08:36+00:00,2024-07-12 13:02:06+00:00,https://github.com/frappe/erpnext/issues/41858,"[('bug', None)]","[{'comment_id': 2167413887, 'issue_id': 2345961415, 'author': 'konradbr', 'body': 'Adding that this might have to do with caching... after a similar behaviour, after performing an update, the tables displayed correctly again. However logging in with different browsers does not seem to have any effect (log in > go to the concerned _General Ledger_; perform the same on different browser; effect is the same).', 'created_at': datetime.datetime(2024, 6, 14, 7, 32, 46, tzinfo=datetime.timezone.utc)}]","konradbr (Issue Creator) on (2024-06-14 07:32:46 UTC): Adding that this might have to do with caching... after a similar behaviour, after performing an update, the tables displayed correctly again. However logging in with different browsers does not seem to have any effect (log in > go to the concerned _General Ledger_; perform the same on different browser; effect is the same).

"
2345944720,issue,closed,completed,Permission Error while creating new company,"### Information about bug

I have a user with Accounts Manager role. When I am creating new Company from that User Account I am getting Permission error
[Permission Error.pdf](https://github.com/user-attachments/files/15785906/Permission.Error.pdf)



### Module

accounts

### Version

Frappe Version - v15.29.1
ERPNext Version - v15.27.2

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Not allowed for Company: None
User info@milliyant.com does not have access to this document: Company - None

Insufficient Permission for Company (create)
```
",tejasmarvania,2024-06-11 09:46:31+00:00,[],2024-06-27 00:08:48+00:00,2024-06-12 07:47:41+00:00,https://github.com/frappe/erpnext/issues/41857,"[('bug', None)]","[{'comment_id': 2162337314, 'issue_id': 2345944720, 'author': 'Nihantra-Patel', 'body': 'Please check the role permissions for the Company doctype. If any user permissions have been applied to the Company, please remove them.\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/7628aef7-b31d-44aa-b641-5934032f1c13)\r\n\r\n\r\nEverything is working fine. No problems were encountered in the latest version 15.', 'created_at': datetime.datetime(2024, 6, 12, 7, 47, 41, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-12 07:47:41 UTC): Please check the role permissions for the Company doctype. If any user permissions have been applied to the Company, please remove them.

![image](https://github.com/frappe/erpnext/assets/141945075/7628aef7-b31d-44aa-b641-5934032f1c13)


Everything is working fine. No problems were encountered in the latest version 15.

"
2343853136,issue,open,,Currency Rate not fetched,"### Information about bug

Currency rate is not fetched when
- Material Request -> Create -> Supplier Quotation
- Quotation -> Create -> Sales Order

Currency rates are fetched correctly if we manually create new Supplier Quotation or Sales Order.

https://github.com/frappe/erpnext/assets/710051/dee95b52-6689-444e-b200-1ff23c5896c0

### Module

buying, selling

### Version

ERPNext: v15.17.0 (HEAD)
Frappe Framework: v15.17.3 (HEAD)

ERPNext: v14.63.0 (version-14)
Frappe Framework: v14.66.2 (version-14)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
It doesn't generate any error in the console. It just didn't check for rates.
```
",TurkerTunali,2024-06-10 12:57:30+00:00,[],2024-06-10 12:59:42+00:00,,https://github.com/frappe/erpnext/issues/41841,"[('bug', None)]",[],
2343379761,issue,open,,when using Opening Invoice creation Import exception seen,"### Information about bug

1) try downloading TEMPLATE in OPENING INVOICE CREATION IMPORT menu
2) exception seen

### Module

accounts

### Version

ERPnext Version 15

Uploading import invoice tool error.mov‚Ä¶



### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
Server Error
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 115, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1768, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/core/doctype/data_import/data_import.py"", line 171, in download_template
    e = Exporter(
        ^^^^^^^^^
  File ""apps/frappe/frappe/core/doctype/data_import/exporter.py"", line 50, in __init__
    self.add_data()
  File ""apps/frappe/frappe/core/doctype/data_import/exporter.py"", line 228, in add_data
    self.csv_array += self.data
  File ""apps/frappe/frappe/core/doctype/data_import/exporter.py"", line 118, in get_data_to_export
    for doc in data:
  File ""apps/frappe/frappe/core/doctype/data_import/exporter.py"", line 163, in get_data_as_docs
    parent_data = frappe.db.get_list(
                  ^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 765, in get_list
    return frappe.get_list(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 2032, in get_list
    return frappe.model.db_query.DatabaseQuery(doctype).execute(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/db_query.py"", line 185, in execute
    self.columns = self.get_table_columns()
                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/db_query.py"", line 546, in get_table_columns
    return get_table_columns(self.doctype)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/meta.py"", line 73, in get_table_columns
    return frappe.db.get_table_columns(doctype)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/database/database.py"", line 1197, in get_table_columns
    raise self.TableMissingError(""DocType"", doctype)
pymysql.err.ProgrammingError: ('DocType', 'Opening Invoice Creation Tool')
```
",Pankajo76,2024-06-10 09:22:27+00:00,[],2024-07-12 13:18:53+00:00,,https://github.com/frappe/erpnext/issues/41838,"[('bug', None)]","[{'comment_id': 2225575865, 'issue_id': 2343379761, 'author': 'ljain112', 'body': 'Not able to replicate the issue.\r\nCan you share App versions and also try bench migrate?', 'created_at': datetime.datetime(2024, 7, 12, 13, 18, 52, tzinfo=datetime.timezone.utc)}]","ljain112 on (2024-07-12 13:18:52 UTC): Not able to replicate the issue.
Can you share App versions and also try bench migrate?

"
2342334815,issue,closed,completed,"In LIST VIEw, Actions Tab after Selection of Items, is not available in new Update ","### Information about bug

In earlier erpnext 15 Versions, in LIST VIEW, when you select a list of entries, Actions tab used to become active to perform actions such as Export, Cancel, Delete, etc.

But after the last update, now when you select a list of entries, there is no actions tab so we cannot export or delete multiple entries. Now we have to individually open the entry and then delete it.

![image](https://github.com/frappe/erpnext/assets/172197899/c92b45e3-1b76-4ad4-9e8a-320628f10bc2)


### Module

accounts, stock, buying, selling, ecommerce, manufacturing, HR, projects, support, CRM, assets, integrations, quality, regional, portal, agriculture, education, non-profit, other

### Version

15.29.1-15.27.1

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",CandidSolution,2024-06-09 15:23:39+00:00,[],2024-06-25 00:08:37+00:00,2024-06-10 06:07:25+00:00,https://github.com/frappe/erpnext/issues/41830,"[('bug', None)]","[{'comment_id': 2157340138, 'issue_id': 2342334815, 'author': 'Nihantra-Patel', 'body': 'We tested it with multiple users. Everything is working fine. No problems were encountered in the latest version 15.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/53bef350-df73-45bb-9ee3-f9c40ab1774c\r\n\r\nMaybe, there is a permissions or rights issue, please check with another user.', 'created_at': datetime.datetime(2024, 6, 10, 6, 7, 25, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-10 06:07:25 UTC): We tested it with multiple users. Everything is working fine. No problems were encountered in the latest version 15.


https://github.com/frappe/erpnext/assets/141945075/53bef350-df73-45bb-9ee3-f9c40ab1774c

Maybe, there is a permissions or rights issue, please check with another user.

"
2340173481,issue,open,,Goods Issue Pending Against Work Order,"
[Goods issue pending against Work order.pdf](https://github.com/user-attachments/files/15737893/Goods.issue.pending.against.Work.order.pdf)
### **Goods Issue Pending Against Work Order**
**Description:**

We propose adding functionality in ERPNext to allow for the consumption of BOM materials after a work order is completed. This feature is essential for scenarios where BOM components (SFG or bought-out items) are physically available but have not been entered into the system due to pending purchase receipt entries. As a result, the material is not available in the system's stock.
In SAP, there is a functionality to consume materials afterwards. We need a similar feature in ERPNext where, after completing the work order and producing the finished goods for delivery, users can consume the BOM materials once they become available in the system. This ensures that the cost is loaded onto the parent material.

**Use Cases:**
1.	Delayed Documentation: When BOM components are physically available but not documented in the system, allowing for their subsequent consumption.
2.	Work Order Completion: Enabling the completion of work orders and production of finished goods without waiting for all documentation to be completed.
3.	Cost Allocation: Ensuring that the cost of BOM materials is correctly allocated to the parent material, even if the materials are consumed post work order completion.

**Detailed Workflow:**
1.	Complete Work Order: Remove BOM components that are not available in the system but physically available. Post the manufacture entry to produce the finished goods.
![image](https://github.com/frappe/erpnext/assets/118710551/cbf04bb2-75b1-400a-84e8-97ef9465e640)
3.	Post Consumption Entry: Once the missing BOM materials become available in the system, post a stock entry ‚ÄúMaterial consumption for Manufacture‚Äù using the same work order. Untick the BOM option to avoid producing the finished good again. This ensures only the remaining material is consumed, and the cost is loaded onto the parent material.

![image](https://github.com/frappe/erpnext/assets/118710551/9e930b43-c025-4805-b297-44a511cdb128)


**Benefits:**
‚Ä¢	Flexibility: Provides flexibility in managing and documenting BOM components, accommodating real-world delays and issues.
‚Ä¢	Accurate Costing: Ensures accurate cost allocation to the parent material, maintaining financial integrity.
‚Ä¢	Efficiency: Allows for smoother operations by enabling the completion of work orders and subsequent documentation and consumption of materials.
Reason for Activation:
This feature addresses practical challenges where documentation delays prevent BOM components from being immediately available in the system. By allowing post-completion consumption of materials, businesses can maintain operational efficiency and accurate cost tracking.

",parasonit,2024-06-07 10:51:29+00:00,[],2024-06-07 14:38:58+00:00,,https://github.com/frappe/erpnext/issues/41822,"[('feature-request', None)]","[{'comment_id': 2154983765, 'issue_id': 2340173481, 'author': 'szufisher', 'body': 'I understand the business case, it can be real,but it will be too complicated to make ERPNext supporting such business case.', 'created_at': datetime.datetime(2024, 6, 7, 14, 38, 58, tzinfo=datetime.timezone.utc)}]","szufisher on (2024-06-07 14:38:58 UTC): I understand the business case, it can be real,but it will be too complicated to make ERPNext supporting such business case.

"
2339721060,issue,closed,completed,Error while updating Employee Record,"### Information about bug

I have an employee left and I am trying to update the record with relieving date and status and I am getting the following error. 
""Could not find Row #50: Role: Moderator"". It dosen't have any other information. 

### Module

HR

### Version

Frappe Version - 15.29.1
ERPNext Version - 15.27.1

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Could not find Row #50: Role: Moderator
```
",tejasmarvania,2024-06-07 06:50:35+00:00,[],2024-06-22 00:08:45+00:00,2024-06-07 10:37:25+00:00,https://github.com/frappe/erpnext/issues/41820,"[('bug', None)]","[{'comment_id': 2154568178, 'issue_id': 2339721060, 'author': 'Nihantra-Patel', 'body': 'Everything is working fine. No problems were encountered in the latest version 15.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/9172631b-f799-4198-afd9-d1fbae3eb393\r\n\r\nIf any customizations or scripts have been added, check them. Also, open the console log to identify and locate any errors.', 'created_at': datetime.datetime(2024, 6, 7, 10, 37, 25, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-07 10:37:25 UTC): Everything is working fine. No problems were encountered in the latest version 15.


https://github.com/frappe/erpnext/assets/141945075/9172631b-f799-4198-afd9-d1fbae3eb393

If any customizations or scripts have been added, check them. Also, open the console log to identify and locate any errors.

"
2339667694,issue,open,,Cannot Resubmit Ledger entries for vouchers in Closed [Re-Opened] fiscal year.,"### Information about bug

ERPnext occasionally requires some Journal Entries to be re-posted. Here, two entries belonging to a closed fiscal year were marked to be reposted. Upon receiving the message ""Cannot Resubmit Ledger entries for vouchers in Closed fiscal year."", the concerned closed fiscal year has been re-opened. Nonetheless, the same message appears when trying to re-post these Journal Entries.

Screenshots provided below made _already after_ the closed fiscal year has been re-opened:

<img width=""910"" alt=""Screenshot 2024-06-07 at 07 48 42"" src=""https://github.com/frappe/erpnext/assets/28401247/e944682a-ed47-4efc-be26-9dc22b703fae"">

<img width=""895"" alt=""Screenshot 2024-06-07 at 07 48 09 safe"" src=""https://github.com/frappe/erpnext/assets/28401247/eb7099e4-5175-443f-9705-d22233d778ce"">

<img width=""596"" alt=""Screenshot 2024-06-07 at 07 50 42"" src=""https://github.com/frappe/erpnext/assets/28401247/f44e49f1-86a8-4243-a402-16368e02f079"">

### Module

accounts

### Version

```
bench 5.17.2
erpnext 15.27.0
erpnextswiss 1.23.3
frappe 15.29.1
hrms 15.22.0
payments 0.0.1
```

### Installation method

manual

### Relevant log output / Stack trace / Full Error Message.

```shell
""Cannot Resubmit Ledger entries for vouchers in Closed fiscal year.""
```
",konradbr,2024-06-07 06:16:11+00:00,[],2024-06-12 10:50:24+00:00,,https://github.com/frappe/erpnext/issues/41819,"[('bug', None)]","[{'comment_id': 2162699614, 'issue_id': 2339667694, 'author': 'konradbr', 'body': '## steps to reproduce\r\n\r\nThis issue happened today again and might be reproducible by following these steps:\r\n\r\n1. Create new _Fiscal Year_.\r\n2. Create a new _Purchase Invoice_ (incl. corresponding _Supplier_).\r\n3. Save and submit said _Purchase Invoice_.\r\n4. Close said _Fiscal Year_ using new _Period Closing Voucher_.\r\n5. Cancel said _Period Closing Voucher_.\r\n6. Cancel and resubmit said _Purchase Invoice_.\r\n7. Create new _Journal Entry_ (with default settings) such that at least one row corresponds to a _debit_ against said _Supplier_.\r\n8. Use the _Payment Reconciliation_ tool to allocate and reconcile said _Journal Entry_ with said _Purchase Invoice_.\r\n9. Said _Journal Entry_ should now display a yellow **""Repost Accounting Entries""** button.\r\n10. Click on said button: **""Cannot Resubmit Ledger entries for vouchers in Closed fiscal year.""** message should appear.', 'created_at': datetime.datetime(2024, 6, 12, 10, 50, 24, tzinfo=datetime.timezone.utc)}]","konradbr (Issue Creator) on (2024-06-12 10:50:24 UTC): ## steps to reproduce

This issue happened today again and might be reproducible by following these steps:

1. Create new _Fiscal Year_.
2. Create a new _Purchase Invoice_ (incl. corresponding _Supplier_).
3. Save and submit said _Purchase Invoice_.
4. Close said _Fiscal Year_ using new _Period Closing Voucher_.
5. Cancel said _Period Closing Voucher_.
6. Cancel and resubmit said _Purchase Invoice_.
7. Create new _Journal Entry_ (with default settings) such that at least one row corresponds to a _debit_ against said _Supplier_.
8. Use the _Payment Reconciliation_ tool to allocate and reconcile said _Journal Entry_ with said _Purchase Invoice_.
9. Said _Journal Entry_ should now display a yellow **""Repost Accounting Entries""** button.
10. Click on said button: **""Cannot Resubmit Ledger entries for vouchers in Closed fiscal year.""** message should appear.

"
2339667671,issue,open,,Activate Open Item Management for GL Account,"**### Activate Open Item Management for GL Account**
**[Activate open item management for GL account.pdf](https://github.com/user-attachments/files/15711037/Activate.open.item.management.for.GL.account.pdf)**
We propose adding a feature to activate open item management for GL accounts in ERPNext. This feature would allow users to view and manage open and cleared items within the General Ledger (GL) report. Specifically, we suggest implementing three selection options within the General Ledger report for viewing Open, Cleared, and All Items.

‚Ä¢	Open Items View: Displays only the open items.
‚Ä¢	Cleared Items View: Displays only the cleared items.
‚Ä¢	All Items View: Displays all items, both open and cleared.

In these views, open items would be shown with a ‚ÄúRed‚Äù indicator, and cleared items would be shown with a ‚ÄúGreen‚Äù indicator. This visual differentiation will help users quickly identify and reconcile transactions.
![image](https://github.com/frappe/erpnext/assets/118710551/b76ac43d-2a84-4ff9-8575-7b77698ee04e)

Use Cases:
1.	GL Reconciliation: Easily identify and reconcile outstanding transactions.
2.	Accounts Payable: Match supplier invoices with payments.
3.	Accounts Receivable: Match customer invoices with receipts.
4.	Bank Reconciliation: Match bank transactions with entries in the GL.

Benefits:
‚Ä¢	Improved Reconciliation: Simplifies the process of reconciling accounts by allowing users to match specific transactions.
‚Ä¢	Enhanced Tracking: Provides better visibility into outstanding items, aiding in financial management.
‚Ä¢	Efficiency: Reduces time spent on manual reconciliation and tracking of transactions.

Reason for Activation:
This feature will aid in GL reconciliation purposes. Open Item Management allows users to display the open and cleared items and amounts in an account, which is crucial when an offsetting entry is made for every line item posted in the account. This feature is particularly useful for accounts such as salary clearing accounts and GR/IR clearing accounts, where reconciliation and clearing against another account are necessary.

",parasonit,2024-06-07 06:16:10+00:00,[],2024-06-07 06:16:10+00:00,,https://github.com/frappe/erpnext/issues/41818,"[('feature-request', None)]",[],
2339417651,issue,closed,completed,Profit and Loss >> Pick Column Orders,"### Information about bug

is this possible to show original order by month 
![image](https://github.com/frappe/erpnext/assets/62122640/57cf04ae-fffc-459f-8eee-b072de3219b3)
Expected 
Jan
Feb
March
ERPNext Result
Apr
Aug
Dec


### Module

accounts

### Version

Frappe : 15.29.1
ERPNext : 15.27.0

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-06-07 01:36:34+00:00,[],2024-06-22 00:08:46+00:00,2024-06-07 10:27:45+00:00,https://github.com/frappe/erpnext/issues/41815,"[('bug', None)]","[{'comment_id': 2154553747, 'issue_id': 2339417651, 'author': 'Nihantra-Patel', 'body': ""i know this isn't a bug.\r\nIt defines the whole printing report, not just one report, and it works based on alphabetical order."", 'created_at': datetime.datetime(2024, 6, 7, 10, 27, 45, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-07 10:27:45 UTC): i know this isn't a bug.
It defines the whole printing report, not just one report, and it works based on alphabetical order.

"
2338463342,issue,open,reopened,On Submit-is not getting triggered from the Server Script,"### Information about bug

Hi Team,

We are using below code to create Purchase Invoice from Purchase Receipt.  This code is working fine and its create the Purchase Invocie in a submitted state on submission of Purchase Receipt but system does not create GL entries against the submitted purchase Invocie.

This code was working properly in V14 and GL entries were generating properly. 

After migrating to V15, we have started facing issue of GL entries not created for purchase Invoice.






### Module

accounts

### Version

ERPNext: v15.21.2 (version-15)

Frappe Framework: v15.24.1 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
if doc and doc.docstatus == 1:
    new_purchase_invoice = frappe.get_doc({
            ""doctype"": ""Purchase Invoice"",
            ""supplier"": doc.supplier,
            ""posting_date"": doc.posting_date,
            ""due_date"": frappe.utils.add_days(doc.posting_date, 60),
            ""company"": doc.company,
            ""business_unit"": doc.business_unit,
            ""is_return"": 0,
            ""bill_no"": doc.bill_no,
            ""supplier_invoice_copy"": doc.supplier_invoice_scan_copy_,
            ""bill_date"": doc.bill_date,
            ""update_stock"": 0,
            ""items"": [],
            ""taxes"": []
        })
    for item in doc.items:
        new_purchase_invoice.append(""items"", {
            ""item_code"": item.item_code,
            ""item_name"": item.item_name,
            ""description"": item.description,
            ""qty"": item.qty,
            ""uom"": item.uom,
            ""rate"": item.rate,
            ""amount"": item.amount,
            ""purchase_receipt"": doc.name,
            ""purchase_order"": item.purchase_order
        })
    for tax in doc.taxes:
        new_purchase_invoice.append(""taxes"", {
            ""category"": tax.category,
            ""add_deduct_tax"": tax.add_deduct_tax,
            ""charge_type"": tax.charge_type,
            ""account_head"": tax.account_head,
            ""description"": tax.description,
            ""rate"": tax.rate,
            ""tax_amount"": tax.tax_amount,
            ""purchase_receipt"": doc.name
        })

    new_purchase_invoice.append(""payment_schedule"", {
        ""due_date"": doc.posting_date,
        ""invoice_portion"": 100,
        ""payment_amount"": doc.grand_total
    })
    try:
        new_purchase_invoice.submit()
    except Exception as e:
        frappe.log_error(f""Error creating and submitting Purchase Invoice: {e}"")
```
",satisharalkar,2024-06-06 14:53:14+00:00,[],2024-06-08 13:54:37+00:00,,https://github.com/frappe/erpnext/issues/41813,"[('bug', None), ('accounts', '')]","[{'comment_id': 2154907635, 'issue_id': 2338463342, 'author': 's-aga-r', 'body': '@satisharalkar \r\n\r\nsave/insert the purchase invoice before submitting.\r\n\r\n```python\r\ntry:\r\n        new_purchase_invoice.insert()\r\n        new_purchase_invoice.submit()\r\n    except Exception as e:\r\n        frappe.log_error(f""Error creating and submitting Purchase Invoice: {e}"")\r\n```', 'created_at': datetime.datetime(2024, 6, 7, 14, 0, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2156013782, 'issue_id': 2338463342, 'author': 'satisharalkar', 'body': 'Hi Sagar,\r\n\r\nThanks for your reply. Still this is not working. Can you please check and update please.', 'created_at': datetime.datetime(2024, 6, 8, 12, 15, 25, tzinfo=datetime.timezone.utc)}]","s-aga-r on (2024-06-07 14:00:12 UTC): @satisharalkar 

save/insert the purchase invoice before submitting.

```python
try:
        new_purchase_invoice.insert()
        new_purchase_invoice.submit()
    except Exception as e:
        frappe.log_error(f""Error creating and submitting Purchase Invoice: {e}"")
```

satisharalkar (Issue Creator) on (2024-06-08 12:15:25 UTC): Hi Sagar,

Thanks for your reply. Still this is not working. Can you please check and update please.

"
2337451862,issue,closed,not_planned,Payment reference in Journal entry with different Exchange rate,"### Information about bug

### Information about bug

when Invoice is created at one exchange rate and the payment entry is done at ddifferent exchange rate
While doing payment reconciliation with foreign currencies the system is throwing followiing error,

Row #2: Reference Type cannot be ""Payment Entry"". It should be one of """", ""Sales Invoice"", ""Purchase Invoice"", ""Journal Entry"", ""Sales Order"", ""Purchase Order"", ""Expense Claim"", ""Asset"", ""Loan"", ""Payroll Entry"", ""Employee Advance"", ""Exchange Rate Revaluation"", ""Invoice Discounting"", ""Fees"", ""Full and Final Statement"", ""Petty Cash""


![image](https://github.com/frappe/erpnext/assets/112148467/7f58ee93-21e1-4694-8f58-f769db1388ba)


### Module

accounts



### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 97, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 48, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 86, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1619, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/handler.py"", line 312, in run_doc_method
    response = doc.run_method(method)
  File ""apps/frappe/frappe/model/document.py"", line 931, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1283, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1265, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 928, in fn
    return method_object(*args, **kwargs)
  File ""apps/erpnext/erpnext/accounts/doctype/payment_reconciliation/payment_reconciliation.py"", line 467, in reconcile
    self.reconcile_allocations()
  File ""apps/erpnext/erpnext/accounts/doctype/payment_reconciliation/payment_reconciliation.py"", line 441, in reconcile_allocations
    reconcile_against_document(entry_list, skip_ref_details_update_for_pe, self.dimensions)
  File ""apps/erpnext/erpnext/accounts/utils.py"", line 473, in reconcile_against_document
    referenced_row = update_reference_in_payment_entry(
  File ""apps/erpnext/erpnext/accounts/utils.py"", line 691, in update_reference_in_payment_entry
    payment_entry.make_exchange_gain_loss_journal(
  File ""apps/erpnext/erpnext/controllers/accounts_controller.py"", line 1306, in make_exchange_gain_loss_journal
    je = create_gain_loss_journal(
  File ""apps/erpnext/erpnext/accounts/utils.py"", line 2045, in create_gain_loss_journal
    journal_entry.save()
  File ""apps/frappe/frappe/model/document.py"", line 310, in save
    return self._save(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 332, in _save
    return self.insert()
  File ""apps/frappe/frappe/model/document.py"", line 266, in insert
    self._validate()
  File ""apps/frappe/frappe/model/document.py"", line 558, in _validate
    d._validate_selects()
  File ""apps/frappe/frappe/model/base_document.py"", line 849, in _validate_selects
    frappe.throw(
  File ""apps/frappe/frappe/__init__.py"", line 548, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 509, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 455, in _raise_exception
    raise raise_exception(msg)
frappe.exceptions.ValidationError: Row #2: Reference Type cannot be ""Payment Entry"". It should be one of """", ""Sales Invoice"", ""Purchase Invoice"", ""Journal Entry"", ""Sales Order"", ""Purchase Order"", ""Expense Claim"", ""Asset"", ""Loan"", ""Payroll Entry"", ""Employee Advance"", ""Exchange Rate Revaluation"", ""Invoice Discounting"", ""Fees"", ""Full and Final Statement"", ""Petty Cash""
2 request.js:457:14
```


### Module

accounts

### Version

ERPNext: v14.70.2 (HEAD)
Frappe Framework: v14.75.0 (HEAD)
gte: v1.1.12 (HEAD)
Frappe HR: v14.28.1 (HEAD)


### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",maveezmh,2024-06-06 06:42:28+00:00,[],2024-06-22 00:08:50+00:00,2024-06-06 07:38:15+00:00,https://github.com/frappe/erpnext/issues/41803,"[('bug', None)]",[],
2336493048,issue,closed,completed,"Finishing Work Order, Error: Data missing in table: None, MandatoryError","### Information about bug

See tests reproducing the issue: https://github.com/frappe/erpnext/pull/41814

It is possible for the Stock Entry `create_serial_and_batch_bundle` to be called with no serial number and empty `row.batches_to_be_consume` thus resulting in an unpopulated Serial and Batch Bundle, causing `frappe.exceptions.MandatoryError: [Serial and Batch Bundle, SABB-00001343]: entries`

https://github.com/frappe/erpnext/blob/c76f466528e2e6651df5d72e14f9418b8d5bec65/erpnext/stock/doctype/stock_entry/stock_entry.py#L3156

EDIT:
It appears to be caused by the check for negative quantity (which all Outward SABBs are) which prevents the `batches_to_be_consume` being updated:

https://github.com/frappe/erpnext/blob/c76f466528e2e6651df5d72e14f9418b8d5bec65/erpnext/stock/doctype/stock_entry/stock_entry.py#L2192-L2198

![Screen Shot 2024-06-05 at 14 34 34](https://github.com/frappe/erpnext/assets/110036763/93bbc8e9-4c20-4cd6-84c7-d5b45804cb56)

### Module

stock, manufacturing

### Version

ERPNext: v15.22.2

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1768, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/erpnext/erpnext/manufacturing/doctype/work_order/work_order.py"", line 1393, in make_stock_entry
    stock_entry.get_items()
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 1751, in get_items
    self.add_transfered_raw_materials_in_items()
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 2170, in add_transfered_raw_materials_in_items
    self.update_item_in_stock_entry_detail(row, item, qty)
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 2209, in update_item_in_stock_entry_detail
    ""serial_and_batch_bundle"": create_serial_and_batch_bundle(self, row, item, ""Outward"")
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 3186, in create_serial_and_batch_bundle
    return doc.insert(ignore_permissions=True).name
  File ""apps/frappe/frappe/model/document.py"", line 292, in insert
    self._validate()
  File ""apps/frappe/frappe/model/document.py"", line 574, in _validate
    self._validate_mandatory()
  File ""apps/frappe/frappe/model/document.py"", line 911, in _validate_mandatory
    raise frappe.MandatoryError(
frappe.exceptions.MandatoryError: [Serial and Batch Bundle, SABB-00001343]: entries
```
",casesolved-co-uk,2024-06-05 17:51:29+00:00,['rohitwaghchaure'],2024-10-16 00:10:11+00:00,2024-09-29 05:40:25+00:00,https://github.com/frappe/erpnext/issues/41800,"[('bug', None)]","[{'comment_id': 2172959427, 'issue_id': 2336493048, 'author': 'Nihantra-Patel', 'body': 'Same issue: https://github.com/frappe/erpnext/issues/41859#issue-2346267393\r\n\r\nhttps://github.com/frappe/erpnext/assets/21578167/cc806811-8dd9-4f28-b1db-42f42d213155', 'created_at': datetime.datetime(2024, 6, 17, 10, 8, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2247659068, 'issue_id': 2336493048, 'author': 'casesolved-co-uk', 'body': '@rohitwaghchaure Looks like this was caused by https://github.com/frappe/erpnext/pull/34564 and untested. Now a blocking issue for an ERPNext customer.', 'created_at': datetime.datetime(2024, 7, 24, 11, 23, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2247675967, 'issue_id': 2336493048, 'author': 'casesolved-co-uk', 'body': '@rohitwaghchaure These tests reproduce the issue and have been ignored and closed: https://github.com/frappe/erpnext/pull/41814', 'created_at': datetime.datetime(2024, 7, 24, 11, 32, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2247677014, 'issue_id': 2336493048, 'author': 'casesolved-co-uk', 'body': '@nabinhait Please can you get @rohitwaghchaure to look at this?', 'created_at': datetime.datetime(2024, 7, 24, 11, 32, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2376642159, 'issue_id': 2336493048, 'author': 'casesolved-co-uk', 'body': '@toofun666 Can you confirm you have seen this?', 'created_at': datetime.datetime(2024, 9, 26, 11, 9, 6, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-17 10:08:54 UTC): Same issue: https://github.com/frappe/erpnext/issues/41859#issue-2346267393

https://github.com/frappe/erpnext/assets/21578167/cc806811-8dd9-4f28-b1db-42f42d213155

casesolved-co-uk (Issue Creator) on (2024-07-24 11:23:55 UTC): @rohitwaghchaure Looks like this was caused by https://github.com/frappe/erpnext/pull/34564 and untested. Now a blocking issue for an ERPNext customer.

casesolved-co-uk (Issue Creator) on (2024-07-24 11:32:02 UTC): @rohitwaghchaure These tests reproduce the issue and have been ignored and closed: https://github.com/frappe/erpnext/pull/41814

casesolved-co-uk (Issue Creator) on (2024-07-24 11:32:37 UTC): @nabinhait Please can you get @rohitwaghchaure to look at this?

casesolved-co-uk (Issue Creator) on (2024-09-26 11:09:06 UTC): @toofun666 Can you confirm you have seen this?

"
2336258817,issue,closed,completed,"In Quotation, the totals are not recalculated when the item quantity/rate is changed, it only updates when saved","### Information about bug

When editing a quotation, the totals are not updated when the quantity/rate of the items are changed
Although it updates properly on save

![Animation](https://github.com/frappe/erpnext/assets/45218102/69933e47-1c3c-44df-802c-0cb88bcbbf91)


### Module

selling

### Version

ERPNext: v15.27.0 (HEAD)
Frappe Framework: v15.29.1 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",kehwar,2024-06-05 15:48:08+00:00,[],2024-06-25 00:08:36+00:00,2024-06-10 09:47:29+00:00,https://github.com/frappe/erpnext/issues/41799,"[('bug', None)]",[],
2335896016,issue,closed,completed,Finishing Work Order with serial numbers results in ValueError,"### Information about bug

See tests reproducing the issue: https://github.com/frappe/erpnext/pull/41814

It appears `get_available_materials` has been poorly written and not properly tested.

The code on inspection tries to remove a serial number from a list that has not been populated.

`item_data.serial_nos.remove(serial_no)`
and yet serial_nos is initialised above to an empty list:
`{""item_details"": row, ""batch_details"": defaultdict(float), ""qty"": 0, ""serial_nos"": []}`

### Module

stock, manufacturing

### Version

""erpnext"": ""15.22.2"",
""frappe"": ""15.26.0"",

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""erpnext"": ""15.22.2"",
	""frappe"": ""15.26.0"",
	""hrms"": ""15.14.1"",
	""payments"": ""0.0.1"",
	""quickfile_sync"": ""15.0.1"",
	""uk"": ""14.3.1""
}
```
### Route
```
Form/Work Order/MFG-WO-2024-00010
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1768, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/erpnext/erpnext/manufacturing/doctype/work_order/work_order.py"", line 1393, in make_stock_entry
    stock_entry.get_items()
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 1751, in get_items
    self.add_transfered_raw_materials_in_items()
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 2137, in add_transfered_raw_materials_in_items
    available_materials = get_available_materials(self.work_order)
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 3068, in get_available_materials
    item_data.serial_nos.remove(serial_no)
ValueError: list.remove(x): x not in list

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""work_order_id"": ""MFG-WO-2024-00010"",
		""purpose"": ""Manufacture"",
		""qty"": 2
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/erpnext.manufacturing.doctype.work_order.work_order.make_stock_entry"",
	""request_id"": null
}
```
### Response Data
```
{
	""exception"": ""ValueError: list.remove(x): x not in list"",
	""exc_type"": ""ValueError"",
	""_exc_source"": ""erpnext (app)""
}
```
```
",casesolved-co-uk,2024-06-05 13:19:29+00:00,[],2024-10-16 00:10:12+00:00,2024-09-29 05:40:26+00:00,https://github.com/frappe/erpnext/issues/41798,"[('bug', None)]","[{'comment_id': 2149922057, 'issue_id': 2335896016, 'author': 'casesolved-co-uk', 'body': 'Appears to be introduced here:\r\nhttps://github.com/frappe/erpnext/commit/333c62de72b1e47a15285b463ec6715cbf46bc40\r\n@rohitwaghchaure', 'created_at': datetime.datetime(2024, 6, 5, 13, 27, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2376641833, 'issue_id': 2335896016, 'author': 'casesolved-co-uk', 'body': '@toofun666 Can you confirm you have seen this?', 'created_at': datetime.datetime(2024, 9, 26, 11, 8, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2376698648, 'issue_id': 2335896016, 'author': 'toofun666', 'body': ""> @toofun666 Can you confirm you have seen this?\r\n\r\nSure thing. A few glitches remain but mostly the mystery's been solved. Need more effort though but we can push this."", 'created_at': datetime.datetime(2024, 9, 26, 11, 38, 44, tzinfo=datetime.timezone.utc)}]","casesolved-co-uk (Issue Creator) on (2024-06-05 13:27:11 UTC): Appears to be introduced here:
https://github.com/frappe/erpnext/commit/333c62de72b1e47a15285b463ec6715cbf46bc40
@rohitwaghchaure

casesolved-co-uk (Issue Creator) on (2024-09-26 11:08:55 UTC): @toofun666 Can you confirm you have seen this?

toofun666 on (2024-09-26 11:38:44 UTC): Sure thing. A few glitches remain but mostly the mystery's been solved. Need more effort though but we can push this.

"
2335676299,issue,open,,JS TX Controller: d.item_code can be `$CODE: $DESC` which breaks a lot of assumptions,"### Information about bug

```js
	_get_item_list(item) {
		var item_list = [];
		var append_item = function(d) {
			if (d.item_code) {
				item_list.push({
					""doctype"": d.doctype,
					""name"": d.name,
					""child_docname"": d.name,
					""item_code"": d.item_code,
					""item_group"": d.item_group,
					""brand"": d.brand,
					""qty"": d.qty,
					""stock_qty"": d.stock_qty,
					""uom"": d.uom,
					""stock_uom"": d.stock_uom,
					""parenttype"": d.parenttype,
					""parent"": d.parent,
					""pricing_rules"": d.pricing_rules,
					""is_free_item"": d.is_free_item,
					""warehouse"": d.warehouse,
					""serial_no"": d.serial_no,
					""batch_no"": d.batch_no,
					""price_list_rate"": d.price_list_rate,
					""conversion_factor"": d.conversion_factor || 1.0
				});

				// if doctype is Quotation Item / Sales Order Iten then add Margin Type and rate in item_list
				if (in_list([""Quotation Item"", ""Sales Order Item"", ""Delivery Note Item"", ""Sales Invoice Item"",  ""Purchase Invoice Item"", ""Purchase Order Item"", ""Purchase Receipt Item""]), d.doctype) {
					item_list[0][""margin_type""] = d.margin_type;
					item_list[0][""margin_rate_or_amount""] = d.margin_rate_or_amount;
				}
			}
		};
```

Produces:

**Note**: `CODE: DESCRIPTION` as `item_code`. You can validate this representation in the frontend (see screenshot below).

```python
{'doctype': 'Delivery Note Item',
  'name': '62623ea51a',
  'child_docname': '62623ea51a',
  'item_code': 'C-4-LECHES-4C: Combo 4 Leches-4C',
  'item_group': 'Products',
  'brand': None,
  'qty': 1,
  'stock_qty': 1,
  'uom': 'Nos',
  'stock_uom': 'Bolsa AA',
  'parenttype': 'Delivery Note',
  'parent': 'MAT-DN-2024-08395',
  'pricing_rules': '',
  'is_free_item': 0,
  'warehouse': 'Finished Goods - P',
  'batch_no': None,
  'price_list_rate': 0,
  'conversion_factor': 1,
  'margin_type': '',
  'margin_rate_or_amount': 0}
```

![image](https://github.com/frappe/erpnext/assets/7548295/e126ed66-0e90-4f4a-9de8-2215f0eb4d6a)


But `frappe.get_doc(""Item"", ""C-4-LECHES-4C: Combo 4 Leches-4C"")` will return `None` which fully explains the error below.


### Module

other

### Version

Erpnext: `public/js/controllers/transaction.js`

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback with variables (most recent call last):
  File ""/nix/store/phbagqihhypxcckm8in4yd683ps6a4xs-python3-3.11.8-env/lib/python3.11/site-packages/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
      request = <Request 'https://sistema.pristina.la/api/method/erpnext.stock.get_item_details.apply_price_list' [POST]>
      response = None
      rollback = True
      e = AttributeError(""'NoneType' object has no attribute 'name'"")
  File ""/nix/store/phbagqihhypxcckm8in4yd683ps6a4xs-python3-3.11.8-env/lib/python3.11/site-packages/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
      request = <Request 'https://sistema.pristina.la/api/method/erpnext.stock.get_item_details.apply_price_list' [POST]>
      endpoint = <function handle_rpc_call at 0x7f3cdabaa020>
      arguments = {'method': 'erpnext.stock.get_item_details.apply_price_list'}
  File ""/nix/store/phbagqihhypxcckm8in4yd683ps6a4xs-python3-3.11.8-env/lib/python3.11/site-packages/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
      method = 'erpnext.stock.get_item_details.apply_price_list'
      frappe = <module 'frappe' from '/nix/store/phbagqihhypxcckm8in4yd683ps6a4xs-python3-3.11.8-env/lib/python3.11/site-packages/frappe/__init__.py'>
  File ""/nix/store/phbagqihhypxcckm8in4yd683ps6a4xs-python3-3.11.8-env/lib/python3.11/site-packages/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
      cmd = 'erpnext.stock.get_item_details.apply_price_list'
      data = None
  File ""/nix/store/phbagqihhypxcckm8in4yd683ps6a4xs-python3-3.11.8-env/lib/python3.11/site-packages/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
      cmd = 'erpnext.stock.get_item_details.apply_price_list'
      from_async = False
      server_script = None
      method = <function apply_price_list at 0x7f3cb47cc900>
  File ""/nix/store/phbagqihhypxcckm8in4yd683ps6a4xs-python3-3.11.8-env/lib/python3.11/site-packages/frappe/__init__.py"", line 1744, in call
    return fn(*args, **newargs)
      fn = <function apply_price_list at 0x7f3cb47cc900>
      args = ()
      kwargs = {'args': '{""items"":[{""doctype"":""Delivery Note Item"",""name"":""62623ea51a"",""child_docname"":""62623ea51a"",""item_code"":""C-4-LECHES-4C: Combo 4 Leches-4C"",""item_group"":""Products"",""brand"":null,""qty"":1,""stock_qty"":1,""uom"":""Nos"",""stock_uom"":""Bolsa AA"",""parenttype"":""Delivery Note"",""parent"":""MAT-DN-2024-08395"",""pricing_rules"":"""",""is_free_item"":0,""warehouse"":""Finished Goods - P"",""batch_no"":null,""price_list_rate"":0,""conversion_factor"":1,""margin_type"":"""",""margin_rate_or_amount"":0}],""customer"":""CUST-2024-01321"",""customer_group"":""Individual"",""currency"":""COP"",""conversion_rate"":1,""price_list"":""Ecommerce Integrations - Ignore"",""price_list_currency"":""COP"",""plc_conversion_rate"":1,""company"":""Pristina"",""transaction_date"":""2024-05-27"",""ignore_pricing_rule"":0,""doctype"":""Delivery Note"",""name"":""MAT-DN-2024-08395"",""is_return"":0,""update_stock"":0,""pos_profile"":""""}', 'cmd': 'erpnext.stock.get_item_details.apply_price_list'}
      newargs = {'args': '{""items"":[{""doctype"":""Delivery Note Item"",""name"":""62623ea51a"",""child_docname"":""62623ea51a"",""item_code"":""C-4-LECHES-4C: Combo 4 Leches-4C"",""item_group"":""Products"",""brand"":null,""qty"":1,""stock_qty"":1,""uom"":""Nos"",""stock_uom"":""Bolsa AA"",""parenttype"":""Delivery Note"",""parent"":""MAT-DN-2024-08395"",""pricing_rules"":"""",""is_free_item"":0,""warehouse"":""Finished Goods - P"",""batch_no"":null,""price_list_rate"":0,""conversion_factor"":1,""margin_type"":"""",""margin_rate_or_amount"":0}],""customer"":""CUST-2024-01321"",""customer_group"":""Individual"",""currency"":""COP"",""conversion_rate"":1,""price_list"":""Ecommerce Integrations - Ignore"",""price_list_currency"":""COP"",""plc_conversion_rate"":1,""company"":""Pristina"",""transaction_date"":""2024-05-27"",""ignore_pricing_rule"":0,""doctype"":""Delivery Note"",""name"":""MAT-DN-2024-08395"",""is_return"":0,""update_stock"":0,""pos_profile"":""""}'}
  File ""/nix/store/phbagqihhypxcckm8in4yd683ps6a4xs-python3-3.11.8-env/lib/python3.11/site-packages/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
      args = ()
      kwargs = {'args': '{""items"":[{""doctype"":""Delivery Note Item"",""name"":""62623ea51a"",""child_docname"":""62623ea51a"",""item_code"":""C-4-LECHES-4C: Combo 4 Leches-4C"",""item_group"":""Products"",""brand"":null,""qty"":1,""stock_qty"":1,""uom"":""Nos"",""stock_uom"":""Bolsa AA"",""parenttype"":""Delivery Note"",""parent"":""MAT-DN-2024-08395"",""pricing_rules"":"""",""is_free_item"":0,""warehouse"":""Finished Goods - P"",""batch_no"":null,""price_list_rate"":0,""conversion_factor"":1,""margin_type"":"""",""margin_rate_or_amount"":0}],""customer"":""CUST-2024-01321"",""customer_group"":""Individual"",""currency"":""COP"",""conversion_rate"":1,""price_list"":""Ecommerce Integrations - Ignore"",""price_list_currency"":""COP"",""plc_conversion_rate"":1,""company"":""Pristina"",""transaction_date"":""2024-05-27"",""ignore_pricing_rule"":0,""doctype"":""Delivery Note"",""name"":""MAT-DN-2024-08395"",""is_return"":0,""update_stock"":0,""pos_profile"":""""}'}
      apply_condition = <function whitelist.<locals>.innerfn.<locals>.<lambda> at 0x7f3cb47cc860>
      func = <function apply_price_list at 0x7f3cb47cc7c0>
  File ""/nix/store/phbagqihhypxcckm8in4yd683ps6a4xs-python3-3.11.8-env/lib/python3.11/site-packages/erpnext/stock/get_item_details.py"", line 1238, in apply_price_list
    item_details = apply_price_list_on_item(args_copy)
      args = {'items': [{'doctype': 'Delivery Note Item', 'name': '62623ea51a', 'child_docname': '62623ea51a', 'item_code': 'C-4-LECHES-4C: Combo 4 Leches-4C', 'item_group': 'Products', 'brand': None, 'qty': 1, 'stock_qty': 1, 'uom': 'Nos', 'stock_uom': 'Bolsa AA', 'parenttype': 'Delivery Note', 'parent': 'MAT-DN-2024-08395', 'pricing_rules': '', 'is_free_item': 0, 'warehouse': 'Finished Goods - P', 'batch_no': None, 'price_list_rate': 0, 'conversion_factor': 1, 'margin_type': '', 'margin_rate_or_amount': 0}], 'customer': 'CUST-2024-01321', 'customer_group': 'Individual', 'currency': 'COP', 'conversion_rate': 1, 'price_list': 'Ecommerce Integrations - Ignore', 'price_list_currency': 'COP', 'plc_conversion_rate': 1, 'company': 'Pristina', 'transaction_date': '2024-05-27', 'ignore_pricing_rule': 0, 'doctype': 'Delivery Note', 'name': 'MAT-DN-2024-08395', 'is_return': 0, 'update_stock': 0, 'pos_profile': '', 'transaction_type': 'selling', 'exchange_rate': 'for_selling', 'price_list_uom_dependant': Non...
      as_doc = False
      parent = {'price_list_currency': 'COP', 'price_list_uom_dependant': None, 'plc_conversion_rate': 1}
      children = []
      item_list = [{'doctype': 'Delivery Note Item', 'name': '62623ea51a', 'child_docname': '62623ea51a', 'item_code': 'C-4-LECHES-4C: Combo 4 Leches-4C', 'item_group': 'Products', 'brand': None, 'qty': 1, 'stock_qty': 1, 'uom': 'Nos', 'stock_uom': 'Bolsa AA', 'parenttype': 'Delivery Note', 'parent': 'MAT-DN-2024-08395', 'pricing_rules': '', 'is_free_item': 0, 'warehouse': 'Finished Goods - P', 'batch_no': None, 'price_list_rate': 0, 'conversion_factor': 1, 'margin_type': '', 'margin_rate_or_amount': 0}]
      item = {'doctype': 'Delivery Note Item', 'name': '62623ea51a', 'child_docname': '62623ea51a', 'item_code': 'C-4-LECHES-4C: Combo 4 Leches-4C', 'item_group': 'Products', 'brand': None, 'qty': 1, 'stock_qty': 1, 'uom': 'Nos', 'stock_uom': 'Bolsa AA', 'parenttype': 'Delivery Note', 'parent': 'MAT-DN-2024-08395', 'pricing_rules': '', 'is_free_item': 0, 'warehouse': 'Finished Goods - P', 'batch_no': None, 'price_list_rate': 0, 'conversion_factor': 1, 'margin_type': '', 'margin_rate_or_amount': 0}
      args_copy = {'items': [{'doctype': 'Delivery Note Item', 'name': '62623ea51a', 'child_docname': '62623ea51a', 'item_code': 'C-4-LECHES-4C: Combo 4 Leches-4C', 'item_group': 'Products', 'brand': None, 'qty': 1, 'stock_qty': 1, 'uom': 'Nos', 'stock_uom': 'Bolsa AA', 'parenttype': 'Delivery Note', 'parent': 'MAT-DN-2024-08395', 'pricing_rules': '', 'is_free_item': 0, 'warehouse': 'Finished Goods - P', 'batch_no': None, 'price_list_rate': 0, 'conversion_factor': 1, 'margin_type': '', 'margin_rate_or_amount': 0}], 'customer': 'CUST-2024-01321', 'customer_group': 'Individual', 'currency': 'COP', 'conversion_rate': 1.0, 'price_list': 'Ecommerce Integrations - Ignore', 'price_list_currency': 'COP', 'plc_conversion_rate': 1.0, 'company': 'Pristina', 'transaction_date': '2024-05-27', 'ignore_pricing_rule': 0, 'doctype': 'Delivery Note Item', 'name': '62623ea51a', 'is_return': 0, 'update_stock': 0, 'pos_profile': '', 'transaction_type': 'selling', 'exchange_rate': 'for_selling', 'price_list_uom_dependant': N...
  File ""/nix/store/phbagqihhypxcckm8in4yd683ps6a4xs-python3-3.11.8-env/lib/python3.11/site-packages/erpnext/stock/get_item_details.py"", line 1258, in apply_price_list_on_item
    item_details = get_price_list_rate(args, item_doc)
      args = {'items': [{'doctype': 'Delivery Note Item', 'name': '62623ea51a', 'child_docname': '62623ea51a', 'item_code': 'C-4-LECHES-4C: Combo 4 Leches-4C', 'item_group': 'Products', 'brand': None, 'qty': 1, 'stock_qty': 1, 'uom': 'Nos', 'stock_uom': 'Bolsa AA', 'parenttype': 'Delivery Note', 'parent': 'MAT-DN-2024-08395', 'pricing_rules': '', 'is_free_item': 0, 'warehouse': 'Finished Goods - P', 'batch_no': None, 'price_list_rate': 0, 'conversion_factor': 1, 'margin_type': '', 'margin_rate_or_amount': 0}], 'customer': 'CUST-2024-01321', 'customer_group': 'Individual', 'currency': 'COP', 'conversion_rate': 1.0, 'price_list': 'Ecommerce Integrations - Ignore', 'price_list_currency': 'COP', 'plc_conversion_rate': 1.0, 'company': 'Pristina', 'transaction_date': '2024-05-27', 'ignore_pricing_rule': 0, 'doctype': 'Delivery Note Item', 'name': '62623ea51a', 'is_return': 0, 'update_stock': 0, 'pos_profile': '', 'transaction_type': 'selling', 'exchange_rate': 'for_selling', 'price_list_uom_dependant': N...
      item_doc = None
  File ""/nix/store/phbagqihhypxcckm8in4yd683ps6a4xs-python3-3.11.8-env/lib/python3.11/site-packages/erpnext/stock/get_item_details.py"", line 812, in get_price_list_rate
    price_list_rate = get_price_list_rate_for(args, item_doc.name)
      args = {'items': [{'doctype': 'Delivery Note Item', 'name': '62623ea51a', 'child_docname': '62623ea51a', 'item_code': 'C-4-LECHES-4C: Combo 4 Leches-4C', 'item_group': 'Products', 'brand': None, 'qty': 1, 'stock_qty': 1, 'uom': 'Nos', 'stock_uom': 'Bolsa AA', 'parenttype': 'Delivery Note', 'parent': 'MAT-DN-2024-08395', 'pricing_rules': '', 'is_free_item': 0, 'warehouse': 'Finished Goods - P', 'batch_no': None, 'price_list_rate': 0, 'conversion_factor': 1, 'margin_type': '', 'margin_rate_or_amount': 0}], 'customer': 'CUST-2024-01321', 'customer_group': 'Individual', 'currency': 'COP', 'conversion_rate': 1.0, 'price_list': 'Ecommerce Integrations - Ignore', 'price_list_currency': 'COP', 'plc_conversion_rate': 1.0, 'company': 'Pristina', 'transaction_date': '2024-05-27', 'ignore_pricing_rule': 0, 'doctype': 'Delivery Note Item', 'name': '62623ea51a', 'is_return': 0, 'update_stock': 0, 'pos_profile': '', 'transaction_type': 'selling', 'exchange_rate': 'for_selling', 'price_list_uom_dependant': N...
      item_doc = None
      out = {}
      meta = <Meta: Delivery Note>
builtins.AttributeError: 'NoneType' object has no attribute 'name'
```
```
",blaggacao,2024-06-05 11:42:38+00:00,[],2024-06-05 11:42:38+00:00,,https://github.com/frappe/erpnext/issues/41796,"[('bug', None)]",[],
2335673465,issue,open,,Replace BOM ID with Item Code and Enable Edit Option for BOM,"**### Summary**
Replace the BOM ID with the Item Code and provide an edit option for the BOM in ERPNext. This change will streamline the BOM update process, ensuring that child components and costs are updated automatically without the need to manually update each parent BOM.
### **Problem Statement**
Currently, ERPNext uses a separate BOM ID and Routing ID. This setup requires users to manually update each parent BOM whenever there is a change in the child components. Additionally, there is no direct edit option available for the BOM, making it cumbersome to update and manage BOMs efficiently. This process is time-consuming and error-prone.
See the below example, we have two versions of BOM for the below item ‚Äú1234267‚Äù. 

![image](https://github.com/frappe/erpnext/assets/118710551/dddced1f-8b81-499d-8b2c-96b0022bbed6)
And the above item is used in the another BOM as a child component. So, whenever we create a new version of the BOM, we need to update it in the parent BOM(1234260). But there is no edit option so we need to create new version of the Parent BOM also.

![image](https://github.com/frappe/erpnext/assets/118710551/196192c8-714a-4c2c-9c05-d4016c28f20f)

### **Proposed Solution**
1.	Replace BOM ID with Item Code:
o	Use the Item Code as the unique identifier for BOMs instead of a separate BOM ID.
o	Update the BOM Doctype to include Item Code as the primary identifier.
2.	Enable Edit Option for BOM:
o	Provide an option to edit BOMs directly from the BOM form.
o	Ensure that changes to child components are automatically reflected in parent BOMs.
o	Automatically update the cost of the BOM whenever changes are made.
Benefits
‚Ä¢	Efficiency: Reduces the time and effort required to update BOMs.
‚Ä¢	Accuracy: Minimizes the risk of errors by automating the update process.
‚Ä¢	User-Friendly: Simplifies BOM management for users, making it more intuitive and accessible.

@rohitwaghchaure 

[BOM Item ID.pdf](https://github.com/user-attachments/files/15586254/BOM.Item.ID.pdf)


",parasonit,2024-06-05 11:41:09+00:00,[],2024-06-05 11:41:09+00:00,,https://github.com/frappe/erpnext/issues/41795,"[('feature-request', None)]",[],
2335559594,issue,closed,completed,Payment reference in Journal entry,"### Information about bug

While doing payment reconciliation with foreign currencies the system is throwing followiing error,


Row #2: Reference Type cannot be ""Payment Entry"". It should be one of """", ""Sales Invoice"", ""Purchase Invoice"", ""Journal Entry"", ""Sales Order"", ""Purchase Order"", ""Expense Claim"", ""Asset"", ""Loan"", ""Payroll Entry"", ""Employee Advance"", ""Exchange Rate Revaluation"", ""Invoice Discounting"", ""Fees"", ""Full and Final Statement"", ""Petty Cash""


![image](https://github.com/frappe/erpnext/assets/112148467/7f58ee93-21e1-4694-8f58-f769db1388ba)


### Module

accounts

### Version

ERPNext: v14.70.2 (HEAD)

Frappe Framework: v14.75.0 (HEAD)

gte: v1.1.12 (HEAD)

Frappe HR: v14.28.1 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 97, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 48, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 86, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1619, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/handler.py"", line 312, in run_doc_method
    response = doc.run_method(method)
  File ""apps/frappe/frappe/model/document.py"", line 931, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1283, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1265, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 928, in fn
    return method_object(*args, **kwargs)
  File ""apps/erpnext/erpnext/accounts/doctype/payment_reconciliation/payment_reconciliation.py"", line 467, in reconcile
    self.reconcile_allocations()
  File ""apps/erpnext/erpnext/accounts/doctype/payment_reconciliation/payment_reconciliation.py"", line 441, in reconcile_allocations
    reconcile_against_document(entry_list, skip_ref_details_update_for_pe, self.dimensions)
  File ""apps/erpnext/erpnext/accounts/utils.py"", line 473, in reconcile_against_document
    referenced_row = update_reference_in_payment_entry(
  File ""apps/erpnext/erpnext/accounts/utils.py"", line 691, in update_reference_in_payment_entry
    payment_entry.make_exchange_gain_loss_journal(
  File ""apps/erpnext/erpnext/controllers/accounts_controller.py"", line 1306, in make_exchange_gain_loss_journal
    je = create_gain_loss_journal(
  File ""apps/erpnext/erpnext/accounts/utils.py"", line 2045, in create_gain_loss_journal
    journal_entry.save()
  File ""apps/frappe/frappe/model/document.py"", line 310, in save
    return self._save(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 332, in _save
    return self.insert()
  File ""apps/frappe/frappe/model/document.py"", line 266, in insert
    self._validate()
  File ""apps/frappe/frappe/model/document.py"", line 558, in _validate
    d._validate_selects()
  File ""apps/frappe/frappe/model/base_document.py"", line 849, in _validate_selects
    frappe.throw(
  File ""apps/frappe/frappe/__init__.py"", line 548, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 509, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 455, in _raise_exception
    raise raise_exception(msg)
frappe.exceptions.ValidationError: Row #2: Reference Type cannot be ""Payment Entry"". It should be one of """", ""Sales Invoice"", ""Purchase Invoice"", ""Journal Entry"", ""Sales Order"", ""Purchase Order"", ""Expense Claim"", ""Asset"", ""Loan"", ""Payroll Entry"", ""Employee Advance"", ""Exchange Rate Revaluation"", ""Invoice Discounting"", ""Fees"", ""Full and Final Statement"", ""Petty Cash""
2 request.js:457:14
```
",maveezmh,2024-06-05 10:46:52+00:00,[],2024-06-22 00:08:49+00:00,2024-06-05 13:02:40+00:00,https://github.com/frappe/erpnext/issues/41794,"[('bug', None)]","[{'comment_id': 2149820689, 'issue_id': 2335559594, 'author': 'Nihantra-Patel', 'body': 'Everything is working fine. No problems were encountered in the latest version 14.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/d623cefe-dfd5-43b9-8934-09a9fdc7228a', 'created_at': datetime.datetime(2024, 6, 5, 13, 2, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2151516012, 'issue_id': 2335559594, 'author': 'maveezmh', 'body': '@Nihantra-Patel its not happening. the entries above is working because there is no change in exchange rate during payment entry.', 'created_at': datetime.datetime(2024, 6, 6, 6, 37, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2151518605, 'issue_id': 2335559594, 'author': 'Nihantra-Patel', 'body': 'Can you share the video? for the better understanding.', 'created_at': datetime.datetime(2024, 6, 6, 6, 39, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2151591867, 'issue_id': 2335559594, 'author': 'maveezmh', 'body': '@Nihantra-Patel you can refer to below recording\r\n\r\nhttps://github.com/frappe/erpnext/assets/112148467/b7266b11-8e48-496c-b14f-01702e646d2e', 'created_at': datetime.datetime(2024, 6, 6, 7, 30, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2151619819, 'issue_id': 2335559594, 'author': 'Nihantra-Patel', 'body': 'Option of Payment Entry is available, and I think you have done some customization. Because there is a message even in the pop pop of reconciliation.\r\n\r\nPlease check the json of Journal Entry Account table\r\nhttps://github.com/frappe/erpnext/blob/b6648eebfaf348e62e16806c91d0bde6f9390a1f/erpnext/accounts/doctype/journal_entry_account/journal_entry_account.json#L185-L185\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/e5cbac25-2915-4062-91a5-ef23dad70f62', 'created_at': datetime.datetime(2024, 6, 6, 7, 45, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2151672458, 'issue_id': 2335559594, 'author': 'maveezmh', 'body': '@Nihantra-Patel Thanks for your feedback Will chack with the developer if one of the app is creating issue', 'created_at': datetime.datetime(2024, 6, 6, 8, 11, 30, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-05 13:02:40 UTC): Everything is working fine. No problems were encountered in the latest version 14.


https://github.com/frappe/erpnext/assets/141945075/d623cefe-dfd5-43b9-8934-09a9fdc7228a

maveezmh (Issue Creator) on (2024-06-06 06:37:30 UTC): @Nihantra-Patel its not happening. the entries above is working because there is no change in exchange rate during payment entry.

Nihantra-Patel on (2024-06-06 06:39:32 UTC): Can you share the video? for the better understanding.

maveezmh (Issue Creator) on (2024-06-06 07:30:05 UTC): @Nihantra-Patel you can refer to below recording

https://github.com/frappe/erpnext/assets/112148467/b7266b11-8e48-496c-b14f-01702e646d2e

Nihantra-Patel on (2024-06-06 07:45:25 UTC): Option of Payment Entry is available, and I think you have done some customization. Because there is a message even in the pop pop of reconciliation.

Please check the json of Journal Entry Account table
https://github.com/frappe/erpnext/blob/b6648eebfaf348e62e16806c91d0bde6f9390a1f/erpnext/accounts/doctype/journal_entry_account/journal_entry_account.json#L185-L185

https://github.com/frappe/erpnext/assets/141945075/e5cbac25-2915-4062-91a5-ef23dad70f62

maveezmh (Issue Creator) on (2024-06-06 08:11:30 UTC): @Nihantra-Patel Thanks for your feedback Will chack with the developer if one of the app is creating issue

"
2335148223,issue,closed,completed,"The customer is not recognized in Get Items From - Healthcare Services when creating the patient, it is not linked to the customer (Check box in Healthcare Seetings - Link Patient to Customer) not activated. ","### Information about bug

When creating a patient, it is not linked to the customer, so you can choose any other customer at the time of payment, when doing get items from - healthcare services, it does not recognize the customer we selected in the customer field of the sales invoice , that is, it is only accepted when the patient is directly linked to the client.

### Module

stock, other

### Version

Frappe Framework: v15.29.0 (HEAD)

Frappe Health: v16.0.0-dev (HEAD)

ERPNext: v15.26.0 (HEAD)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",Keynes25,2024-06-05 07:43:28+00:00,[],2024-06-22 00:08:52+00:00,2024-06-05 07:45:07+00:00,https://github.com/frappe/erpnext/issues/41790,"[('bug', None)]",[],
2335094651,issue,closed,completed,Error when completing Job Card in Workstation dashboard,"### Information about bug

When I want to complete a Job Card with the complete button in the Workstation dashboard, I get an error that the Item None is not found.
<img width=""587"" alt=""Bildschirmfoto 2024-06-05 um 09 01 24"" src=""https://github.com/frappe/erpnext/assets/42201209/eca0d26a-3ba2-4aba-ab9c-000c3fcb5ba3"">

The cause of the problem is the newly implemented feature of @rohitwaghchaure https://github.com/frappe/erpnext/pull/38341 to track semi-finished goods. The problem is that the production_item is None in the function [add_finished_good in the file stock_entry_type.py](https://github.com/frappe/erpnext/blob/c76f466528e2e6651df5d72e14f9418b8d5bec65/erpnext/stock/doctype/stock_entry_type/stock_entry_type.py#L135). The function add_finished_good is called by [make_stock_entry_for_semi_fg_item in the file job_card.py.](https://github.com/frappe/erpnext/blob/c76f466528e2e6651df5d72e14f9418b8d5bec65/erpnext/manufacturing/doctype/job_card/job_card.py#L1233)


### Module

stock, manufacturing

### Version

Local Dev Environment
Frappe: v15.29.1 (version-15)
ERPNext: Commit c76f466528e2e6651df5d72e14f9418b8d5bec65


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",SamuelHelbling,2024-06-05 07:15:23+00:00,[],2024-08-08 00:09:05+00:00,2024-07-23 19:29:38+00:00,https://github.com/frappe/erpnext/issues/41789,"[('bug', None)]",[],
2334007640,issue,closed,completed,Additional States for Job Cards,"
**Is your feature request related to a problem? Please describe.**
The Workstation Dashboard, which shows the not completed Job Cards, is great.
<img width=""1071"" alt=""Bildschirmfoto 2024-06-04 um 19 01 54"" src=""https://github.com/frappe/erpnext/assets/42201209/e3c42d02-3530-418f-be04-0d6ba2f83c5e"">

But an employee has no chance to see, which open Job Card is the next in the sequence. Only if he tries to start a Job Card, which is not the next in line, he gets a message. But to get to this point, he had already field out the form and this very frustrating. 
<img width=""582"" alt=""Bildschirmfoto 2024-06-04 um 18 56 43"" src=""https://github.com/frappe/erpnext/assets/42201209/fe783aa7-473c-4e19-a5d3-a423c87f9980"">

**Describe the solution you'd like**
I therefore suggest an additional status for job cards that are ready to be processed/started. I would also suggest an additional status for Job Cards that still need material before they can be started.
![State_Diagram_JobCards drawio](https://github.com/frappe/erpnext/assets/42201209/34be7e5f-25a3-45a7-a799-15df920d9026)

Are there such plans? If not, I would implement this and create a pull request.

**Describe alternatives you've considered**
The overview could also only show the job cards that can be started without implementing an additional status. However, I would prefer the other option.



",SamuelHelbling,2024-06-04 17:13:40+00:00,[],2024-07-02 00:08:59+00:00,2024-06-13 13:10:01+00:00,https://github.com/frappe/erpnext/issues/41786,"[('feature-request', None)]","[{'comment_id': 2149046596, 'issue_id': 2334007640, 'author': 'SamuelHelbling', 'body': '@rohitwaghchaure', 'created_at': datetime.datetime(2024, 6, 5, 7, 11, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2165626513, 'issue_id': 2334007640, 'author': 'SamuelHelbling', 'body': 'Integrated in the newest version', 'created_at': datetime.datetime(2024, 6, 13, 13, 10, 1, tzinfo=datetime.timezone.utc)}]","SamuelHelbling (Issue Creator) on (2024-06-05 07:11:41 UTC): @rohitwaghchaure

SamuelHelbling (Issue Creator) on (2024-06-13 13:10:01 UTC): Integrated in the newest version

"
2333151351,issue,closed,completed,Onl load Net total is not being Updated PR,"### Information about bug


https://github.com/frappe/erpnext/assets/21578167/a02490f8-d140-47d4-a61d-6d9e216985d4



### Module

stock

### Version

ERPNext: v15.26.1 (version-15)

Frappe Framework: v15.29.0 (version-15)

Helpdesk: v0.10.0 (main)

Frappe HR: v15.22.0 (version-15)

India Compliance: v15.7.5 (version-15)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",dineshpanchal93,2024-06-04 10:24:51+00:00,[],2024-06-26 00:08:36+00:00,2024-06-10 09:47:29+00:00,https://github.com/frappe/erpnext/issues/41779,"[('bug', None), ('released', None)]","[{'comment_id': 2160749608, 'issue_id': 2333151351, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.27.4 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.27.4)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 6, 11, 13, 19, 42, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-06-11 13:19:42 UTC): :tada: This issue has been resolved in version 15.27.4 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.27.4)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2332950029,issue,closed,completed,Support foreign currency accounts for Advances that are booked in separate party account,"Advance as an Asset or Liability is currently limited to company currency accounts. Allowing accounts that are of foreign currency should allow this feature to be used for Customers that are billed in foreign currencies.

extends: https://github.com/frappe/erpnext/pull/35609",ruthra-kumar,2024-06-04 08:53:31+00:00,['ruthra-kumar'],2024-07-07 00:09:41+00:00,2024-06-22 23:56:53+00:00,https://github.com/frappe/erpnext/issues/41771,"[('feature-request', None)]",[],
2332836176,issue,closed,completed,Error showing incorrect - For Zero Stocks,"### Information about bug

We have made one material Request from one warehouse to another someone else is trying to transfer the material against that material request (The item Is not available in the source warehouse ) 

Getting below error 

valuation rate error


https://github.com/frappe/erpnext/assets/21578167/9eca43d1-a4e8-4f3a-94a2-3994b0fefcac



### Module

stock

### Version

<img width=""1195"" alt=""Screenshot 2024-06-04 at 1 33 53‚ÄØPM"" src=""https://github.com/frappe/erpnext/assets/21578167/50670e00-7efe-4d69-a0c7-a75dbea112ac"">


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""addon_s_stocks"": ""0.0.1"",
	""addons_boms"": ""0.0.1"",
	""addons_buying"": ""0.0.1"",
	""bliss_employee"": ""0.0.1"",
	""erpnext"": ""15.26.1"",
	""frappe"": ""15.29.0"",
	""hr_reports"": ""0.0.1"",
	""hrms"": ""15.22.0"",
	""india_compliance"": ""15.7.5"",
	""qrcode_generator"": ""0.0.1"",
	""reports"": ""0.0.1""
}
```
### Route
```
Form/Stock Entry/STE/2406/00457
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 115, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1768, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/frappe/frappe/desk/form/save.py"", line 37, in savedocs
    doc.submit()
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1048, in submit
    return self._submit()
  File ""apps/frappe/frappe/model/document.py"", line 1031, in _submit
    return self.save()
  File ""apps/frappe/frappe/model/document.py"", line 337, in save
    return self._save(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 390, in _save
    self.run_post_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1131, in run_post_save_methods
    self.run_method(""on_submit"")
  File ""apps/frappe/frappe/model/document.py"", line 962, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1322, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1304, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 959, in fn
    return method_object(*args, **kwargs)
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 243, in on_submit
    self.update_stock_ledger()
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 1350, in update_stock_ledger
    self.make_sl_entries(sl_entries)
  File ""apps/erpnext/erpnext/controllers/stock_controller.py"", line 855, in make_sl_entries
    make_sl_entries(sl_entries, allow_negative_stock, via_landed_cost_voucher)
  File ""apps/erpnext/erpnext/stock/stock_ledger.py"", line 95, in make_sl_entries
    sle_doc = make_entry(sle, allow_negative_stock, via_landed_cost_voucher)
  File ""apps/erpnext/erpnext/stock/stock_ledger.py"", line 224, in make_entry
    sle.submit()
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1048, in submit
    return self._submit()
  File ""apps/frappe/frappe/model/document.py"", line 1031, in _submit
    return self.save()
  File ""apps/frappe/frappe/model/document.py"", line 337, in save
    return self._save(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 359, in _save
    return self.insert()
  File ""apps/frappe/frappe/model/document.py"", line 315, in insert
    self.run_post_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1131, in run_post_save_methods
    self.run_method(""on_submit"")
  File ""apps/frappe/frappe/model/document.py"", line 962, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1322, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1304, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 959, in fn
    return method_object(*args, **kwargs)
  File ""apps/erpnext/erpnext/stock/doctype/stock_ledger_entry/stock_ledger_entry.py"", line 184, in on_submit
    SerialBatchBundle(
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 23, in __init__
    self.process_serial_and_batch_bundle()
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 33, in process_serial_and_batch_bundle
    self.process_batch_no()
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 224, in process_batch_no
    self.make_serial_batch_no_bundle()
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 116, in make_serial_batch_no_bundle
    self.set_serial_and_batch_bundle(sn_doc)
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 194, in set_serial_and_batch_bundle
    frappe.db.set_value(self.child_doctype, self.sle.voucher_detail_no, values_to_update)
  File ""apps/frappe/frappe/database/database.py"", line 994, in set_value
    query.run(debug=debug)
  File ""apps/frappe/frappe/query_builder/utils.py"", line 87, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
  File ""apps/frappe/frappe/database/database.py"", line 234, in sql
    self._cursor.execute(query, values)
  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 153, in execute
    result = self._query(query)
  File ""env/lib/python3.10/site-packages/pymysql/cursors.py"", line 322, in _query
    conn.query(q)
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 825, in _read_query_result
    result.read()
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 1199, in read
    first_packet = self.connection._read_packet()
  File ""env/lib/python3.10/site-packages/pymysql/connections.py"", line 775, in _read_packet
    packet.raise_for_error()
  File ""env/lib/python3.10/site-packages/pymysql/protocol.py"", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File ""env/lib/python3.10/site-packages/pymysql/err.py"", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.IntegrityError: (1048, ""Column 'valuation_rate' cannot be null"")

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""doc"": ""{\""name\"":\""STE/2406/00457\"",\""owner\"":\""Administrator\"",\""creation\"":\""2024-06-04 13:30:05.688631\"",\""modified\"":\""2024-06-04 13:30:05.688631\"",\""modified_by\"":\""Administrator\"",\""docstatus\"":0,\""idx\"":0,\""workflow_state\"":null,\""naming_series\"":\""STE/.YY.MM./.#####\"",\""stock_entry_type\"":\""Material Transfer\"",\""outgoing_stock_entry\"":null,\""purpose\"":\""Material Transfer\"",\""add_to_transit\"":0,\""is_fg_transfer\"":0,\""work_order\"":null,\""purchase_order\"":null,\""subcontracting_order\"":null,\""delivery_note_no\"":null,\""sales_invoice_no\"":null,\""pick_list\"":null,\""purchase_receipt_no\"":null,\""company\"":\""Blisstering Electronics Private Limited\"",\""posting_date\"":\""2024-06-04\"",\""posting_time\"":\""13:30:05.707706\"",\""set_posting_time\"":0,\""inspection_required\"":0,\""apply_putaway_rule\"":0,\""from_bom\"":0,\""use_multi_level_bom\"":1,\""bom_no\"":null,\""fg_completed_qty\"":0,\""process_loss_percentage\"":0,\""process_loss_qty\"":0,\""from_warehouse\"":\""MI OQC 24-25 - BEPL\"",\""source_warehouse_address\"":null,\""source_address_display\"":null,\""to_warehouse\"":\""Finished Goods - BEPL\"",\""target_warehouse_address\"":null,\""target_address_display\"":null,\""scan_barcode\"":null,\""total_outgoing_value\"":116999.7883902,\""total_incoming_value\"":116999.7883902,\""value_difference\"":0,\""total_additional_costs\"":0,\""supplier\"":null,\""supplier_name\"":null,\""supplier_address\"":null,\""address_display\"":null,\""project\"":null,\""select_print_heading\"":null,\""letter_head\"":null,\""is_opening\"":\""No\"",\""remarks\"":null,\""per_transferred\"":0,\""total_amount\"":116999.7883902,\""job_card\"":null,\""amended_from\"":null,\""credit_note\"":null,\""is_return\"":0,\""doctype\"":\""Stock Entry\"",\""items\"":[{\""name\"":\""7nppo7nsm2\"",\""owner\"":\""Administrator\"",\""creation\"":\""2024-06-04 13:30:05.688631\"",\""modified\"":\""2024-06-04 13:30:05.688631\"",\""modified_by\"":\""Administrator\"",\""docstatus\"":0,\""idx\"":1,\""barcode\"":null,\""has_item_scanned\"":0,\""s_warehouse\"":\""MI OQC 24-25 - BEPL\"",\""t_warehouse\"":\""Finished Goods - BEPL\"",\""item_code\"":\""AM4085600GF\"",\""item_name\"":\""FIGHTERPROLD15/220-240/350 CS MAXIC INOSRAM\"",\""is_finished_item\"":0,\""is_scrap_item\"":0,\""quality_inspection\"":null,\""subcontracted_item\"":null,\""description\"":\""FIGHTERPROLD15/220-240/350 CS MAXIC INOSRAM\"",\""item_group\"":\""CC Driver\"",\""image\"":null,\""qty\"":1720,\""transfer_qty\"":1720,\""retain_sample\"":0,\""uom\"":\""Nos\"",\""stock_uom\"":\""Nos\"",\""conversion_factor\"":1,\""sample_quantity\"":0,\""basic_rate\"":68.023132785,\""additional_cost\"":0,\""valuation_rate\"":68.023132785,\""allow_zero_valuation_rate\"":0,\""set_basic_rate_manually\"":0,\""basic_amount\"":116999.7883902,\""amount\"":116999.7883902,\""use_serial_batch_fields\"":0,\""serial_and_batch_bundle\"":null,\""serial_no\"":null,\""batch_no\"":null,\""expense_account\"":\""5111 - Cost of Goods Sold - BEPL\"",\""cost_center\"":\""Main - BEPL\"",\""project\"":null,\""actual_qty\"":0,\""transferred_qty\"":0,\""bom_no\"":null,\""allow_alternative_item\"":0,\""material_request\"":\""MAT-MR-2024-01461\"",\""material_request_item\"":\""t2chmndkrk\"",\""original_item\"":null,\""against_stock_entry\"":null,\""ste_detail\"":null,\""po_detail\"":null,\""sco_rm_detail\"":null,\""putaway_rule\"":null,\""reference_purchase_receipt\"":null,\""job_card_item\"":null,\""parent\"":\""STE/2406/00457\"",\""parentfield\"":\""items\"",\""parenttype\"":\""Stock Entry\"",\""doctype\"":\""Stock Entry Detail\"",\""__unsaved\"":1}],\""additional_costs\"":[],\""__last_sync_on\"":\""2024-06-04T08:00:05.697Z\"",\""customer_address\"":null,\""customer_name\"":null,\""customer\"":null}"",
		""action"": ""Submit""
	},
	""btn"": {
		""jQuery370050036404590031051"": {
			""events"": {
				""click"": [
					{
						""type"": ""click"",
						""origType"": ""click"",
						""guid"": 3519,
						""namespace"": """"
					}
				]
			}
		}
	},
	""freeze"": true,
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.form.save.savedocs"",
	""request_id"": null
}
```
### Response Data
```
{
	""exception"": ""pymysql.err.IntegrityError: (1048, \""Column 'valuation_rate' cannot be null\"")"",
	""exc_type"": ""IntegrityError"",
	""_exc_source"": ""erpnext (app)""
}
```
```
",dineshpanchal93,2024-06-04 08:04:34+00:00,[],2024-06-25 00:08:38+00:00,2024-06-05 10:43:24+00:00,https://github.com/frappe/erpnext/issues/41770,"[('bug', None)]","[{'comment_id': 2149477340, 'issue_id': 2332836176, 'author': 'Nihantra-Patel', 'body': 'Kindly upgrade your version 15 because everything is working fine. No problems were encountered in the latest version 15.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/1ec6c060-6260-4855-8339-8923eca2fb2e', 'created_at': datetime.datetime(2024, 6, 5, 10, 43, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2149492242, 'issue_id': 2332836176, 'author': 'Nihantra-Patel', 'body': 'And Item have a Zero stock then check it.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/4da85315-efdf-4c4b-bdca-c1f269035b6a', 'created_at': datetime.datetime(2024, 6, 5, 10, 51, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2155803710, 'issue_id': 2332836176, 'author': 'dineshpanchal93', 'body': 'Its already on Version 15 with latest updates\n\nLast week i was not able to face this issue. After and recently updated then got an error', 'created_at': datetime.datetime(2024, 6, 8, 4, 32, 29, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-05 10:43:24 UTC): Kindly upgrade your version 15 because everything is working fine. No problems were encountered in the latest version 15.


https://github.com/frappe/erpnext/assets/141945075/1ec6c060-6260-4855-8339-8923eca2fb2e

Nihantra-Patel on (2024-06-05 10:51:20 UTC): And Item have a Zero stock then check it.


https://github.com/frappe/erpnext/assets/141945075/4da85315-efdf-4c4b-bdca-c1f269035b6a

dineshpanchal93 (Issue Creator) on (2024-06-08 04:32:29 UTC): Its already on Version 15 with latest updates

Last week i was not able to face this issue. After and recently updated then got an error

"
2331757754,issue,closed,completed,"Enable ""Allow on Submit"" on ""Supplier Delivers to Customer"" (Quick Fix Issue)","<!--
Welcome to ERPNext issue tracker! Before creating an issue, please heed the following:

1. This tracker should only be used to report bugs and request features / enhancements to ERPNext
    - For questions and general support, checkout the manual https://erpnext.com/docs/user/manual/en or use https://discuss.erpnext.com
2. Use the search function before creating a new issue. Duplicates will be closed and directed to
   the original discussion.
3. When making a feature request, make sure to be as verbose as possible. The better you convey your message, the greater the drive to make it happen.


Please keep in mind that we get many many requests and we can't possibly work on all of them, we prioritize development based on the goals of the product and organization. Feature requests are still welcome as it helps us in research when we do decide to work on the requested feature. 

If you're in urgent need to a feature, please try the following channels to get paid developments done quickly:
1. Certified ERPNext partners: https://erpnext.com/partners 
2. Developer community on ERPNext forums: https://discuss.erpnext.com/c/developers/5 
3. Telegram group for ERPNext/Frappe development work: https://t.me/erpnext_opps 

-->

**Is your feature request related to a problem? Please describe.**
Supplier Delivers to Customer field is one of the fields that are frequently updated. To avoid cancelling and amending a Sales Order, this field has to be editable after Submitting the Sales Order.

**Describe the solution you'd like**
Make the Field ""Supplier Delivers to Customer"" that's located on the Sales Order Item child table as ""Allow on Submit"" = 1
 
**Describe alternatives you've considered**
Alternative is to cancel the Sales Order, make the changes then resubmit as a new amended Sales Order. However this takes a lot of time and creates too many cancelled Sales Order for no good reason

**Additional context**
A reliable solution is to Enable ""Allow on Submit"" on ""Supplier Delivers to Customer""
",NassimBentarka,2024-06-03 18:10:35+00:00,[],2024-06-19 00:08:54+00:00,2024-06-04 06:51:28+00:00,https://github.com/frappe/erpnext/issues/41754,"[('feature-request', None)]","[{'comment_id': 2146743494, 'issue_id': 2331757754, 'author': 'Nihantra-Patel', 'body': 'You can easily set using the property setter, so please check it and apply it.\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/cef9272d-4cef-461e-9f9a-9bf1dbf344b0)', 'created_at': datetime.datetime(2024, 6, 4, 6, 51, 28, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-04 06:51:28 UTC): You can easily set using the property setter, so please check it and apply it.

![image](https://github.com/frappe/erpnext/assets/141945075/cef9272d-4cef-461e-9f9a-9bf1dbf344b0)

"
2331451152,issue,open,,"Item Reordering: reorder code assumes the reorder warehouse is in the warehouse group, but this is not validated","### Information about bug

The Item Automatic Material Request reordering (erpnext.stock.reorder_item.reorder_item) assumes the set `warehouse` in `Item Reorder` is inside the set `warehouse_group` to determine whether a material request should be created based on the warehouse_group projected quantity, however this is not validated on item save, which could cause unwanted material requests.

### Module

stock

### Version

v16 develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-06-03 15:26:31+00:00,[],2024-06-03 15:26:31+00:00,,https://github.com/frappe/erpnext/issues/41753,"[('bug', None)]",[],
2331419342,issue,open,,Dunning - fce resolve_dunning wrongly resolves Dunning,"### Information about bug

Hello,
after Payment Entry submit we have resolved Dunning with unpaid Sales Invoice:
Items of Dunning: 

![Screenshot from 2024-06-03 15-45-51](https://github.com/frappe/erpnext/assets/121026420/58128bce-1f0b-4c55-9d16-93f9e5f74dc1)

This code part in dunning.py tests state of each Sales Invoice in Dunning. Variable ""resolve"" is changed every time in loop => For first SI from picture above is resolved = False (OK). For second one is True (OK) BUT this last step is used as final result for variable ""resolve"" and it is not good. 
What about use AND operation here => previous_resolve AND actual_resolve => one FALSE in loop == False in final resolve

https://github.com/frappe/erpnext/blob/a2039bae109c9a9a0b813db127bb4ddca2e71b38/erpnext/accounts/doctype/dunning/dunning.py#L185C1-L199C19

```
#resolve = False if (outstanding_ps > 0 and outstanding_inv > 0) else True
resolve = resolve and (False if (outstanding_ps > 0 and outstanding_inv > 0) else True)  #use this instead of row above
```

Can I kindly ask @barredterra for review, please? I can make PR for that if there will be ""go"" :-)

Thank you.

### Module

accounts

### Version

ERPNext: v15.26.0 (HEAD)

Frappe Framework: v15.29.0 (HEAD)

Frappe HR: v15.21.2 (HEAD)

Payments: v0.0.1 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",tonspar,2024-06-03 15:12:42+00:00,[],2024-06-03 15:12:42+00:00,,https://github.com/frappe/erpnext/issues/41752,"[('bug', None)]",[],
2330272533,issue,open,,Enhancement Request: Gantt Chart Configuration in ERP,"We would like to request the addition of Gantt chart configuration in our ERP system as a future enhancement. This feature would greatly enhance our project management capabilities by providing a visual representation of project timelines and dependencies.

And We need the Futures like following points.
1. Colors to be Shown in each Sub Assy based on the completion
            Red- Not Started
            Orange - On going
            Yellow- Hold
            Green- Completed
2.Pending Hours to be Shown in each sub Assy's
3. Consolidate report of Pending Status to be get For each Project 
4. Lead time to be Shown in each project
5. Consolidate Projects Chart to be shown in Gantt chart( All WIP machines in one Report )
",sowndharya998,2024-06-03 06:21:49+00:00,[],2024-06-03 06:21:49+00:00,,https://github.com/frappe/erpnext/issues/41732,"[('feature-request', None)]",[],
2330235326,issue,closed,completed,TItle: ERPNext is Picking the System Settings Number Format over the Format Specified in the Currency DocType,"### Information about bug

## Steps to Reproduce
 - Set a number format in the System Settings of the application instance
 ![Screenshot from 2024-05-29 08-23-40](https://github.com/frappe/frappe/assets/82759762/8f27ec0e-d482-4eee-9bb9-f28b145b04c9)
 - Go to a Sales Invoice or Purchase Invoice DocType
 - In the Currency and Price List Section. Select a Currency you want.
 ![Screenshot from 2024-05-29 08-23-48](https://github.com/frappe/frappe/assets/82759762/f2a3ccd0-a7e9-476f-a3e6-2e61fa6c71d3)

## Actual behavior

 - The amount or grand total field picks and displays in the number format provided in the System Settings rather than Currency type selected.
 
 ## Expected behavior

I expect the application to pick the format specified by the Currency and display them in this format.

Like for the screenshots below I expect the grand total to be displayed in INR number format (#,##,###.##) but the system is choosing the System Settings format (#,###.##)

## Screenshots:

![Screenshot from 2024-05-29 08-23-32](https://github.com/frappe/frappe/assets/82759762/261c7283-fdc9-4831-a9b8-f31a5d360bdb)


### Module

accounts, buying, selling

### Version

ERPNext: v15.26.1 (HEAD)

Frappe Framework: v15.29.0 (HEAD)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",emmanuel-mwendwa,2024-06-03 05:54:35+00:00,[],2024-06-18 00:09:25+00:00,2024-06-03 06:59:06+00:00,https://github.com/frappe/erpnext/issues/41730,"[('bug', None)]","[{'comment_id': 2144419578, 'issue_id': 2330235326, 'author': 'Nihantra-Patel', 'body': 'Duplicate issue: https://github.com/frappe/frappe/issues/26584', 'created_at': datetime.datetime(2024, 6, 3, 6, 59, 6, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-03 06:59:06 UTC): Duplicate issue: https://github.com/frappe/frappe/issues/26584

"
2330206548,issue,closed,completed,Issue with Configured DAS Formula in Supplier Scorecard,"### Information about bug

We have configured the DAS(Delivery, Accuracy, and Service) formula in our supplier scorecard, but it appears that the formula is not working as expected. Despite following the configuration steps, the results are not being calculated correctly.

![Screenshot 2024-06-03 102009](https://github.com/frappe/erpnext/assets/75109236/ac16199e-8362-460b-8412-32170f4c532f)

And we got the result like very poor for all suppliers.
![q](https://github.com/frappe/erpnext/assets/75109236/dc3d890a-dcea-4793-aaaa-5de9bfff6e94)

For Your reference,
We would like to rate our vendors based on :
Delivery Adherence Score (DAS): DAS = (Promised delivery time (days) / Actual delivery time¬†(days))¬†*¬†100

Instead of these, what variables can I use? These variables are not successful for us.

kindly provide us, the correct formula for this.


### Module

buying

### Version

Frappe version- v15.8.0
ERPnext version-  v15.8.3

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",sowndharya998,2024-06-03 05:29:26+00:00,[],2024-06-18 00:09:22+00:00,2024-06-03 09:12:53+00:00,https://github.com/frappe/erpnext/issues/41728,"[('bug', None)]","[{'comment_id': 2144430860, 'issue_id': 2330206548, 'author': 'Nihantra-Patel', 'body': ""If you haven't checked, then please check the [documentation](https://docs.erpnext.com/docs/user/manual/en/supplier-scorecard). \r\n\r\nAlso, check out the video.\r\n\r\nhttps://www.youtube.com/watch?v=2w_psd-IqlM"", 'created_at': datetime.datetime(2024, 6, 3, 7, 5, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2144690044, 'issue_id': 2330206548, 'author': 'nabinhait', 'body': ""This is not a bug, it's a configuration issue. Please post your query on https://discuss.frappe.io/"", 'created_at': datetime.datetime(2024, 6, 3, 9, 12, 39, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-06-03 07:05:47 UTC): If you haven't checked, then please check the [documentation](https://docs.erpnext.com/docs/user/manual/en/supplier-scorecard). 

Also, check out the video.

https://www.youtube.com/watch?v=2w_psd-IqlM

nabinhait on (2024-06-03 09:12:39 UTC): This is not a bug, it's a configuration issue. Please post your query on https://discuss.frappe.io/

"
