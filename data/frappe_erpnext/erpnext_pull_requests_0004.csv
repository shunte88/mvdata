id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2802706154,pull_request,closed,,fix: sync translations from crowdin,,frappe-pr-bot,2025-01-21 20:04:49+00:00,['ruthra-kumar'],2025-02-06 00:10:32+00:00,2025-01-22 06:42:44+00:00,https://github.com/frappe/erpnext/pull/45363,"[('translation', None)]",[],
2802063946,pull_request,closed,,fix: precision on work order total qty (backport #45341),Internal ticket: https://support.frappe.io/helpdesk/my-tickets/29769<hr>This is an automatic backport of pull request #45341 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-21 14:49:24+00:00,[],2025-02-06 00:10:23+00:00,2025-01-22 11:55:51+00:00,https://github.com/frappe/erpnext/pull/45361,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2801486061,pull_request,closed,,fix: include pos invoice in modifing key for returned item validation (backport #45242),"**Issue:**
 get_ref_item_dict return key in `(item_code, name)` format, but since the POS Invoice is not part of the validation, `item_code` is compared with `(item_code, name)`
**ref:** [29094](https://support.frappe.io/helpdesk/tickets/29094)

**Before:**

https://github.com/user-attachments/assets/3b0ec642-807e-4c66-a90c-3e5147e95010

**After:**

https://github.com/user-attachments/assets/7790d998-537f-4c6f-8ec4-aa52f02966d8

**Backport needed for v14 & v15**<hr>This is an automatic backport of pull request #45242 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-21 11:06:19+00:00,[],2025-02-05 00:10:26+00:00,2025-01-21 11:28:21+00:00,https://github.com/frappe/erpnext/pull/45360,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2801485446,pull_request,closed,,fix: include pos invoice in modifing key for returned item validation (backport #45242),"**Issue:**
 get_ref_item_dict return key in `(item_code, name)` format, but since the POS Invoice is not part of the validation, `item_code` is compared with `(item_code, name)`
**ref:** [29094](https://support.frappe.io/helpdesk/tickets/29094)

**Before:**

https://github.com/user-attachments/assets/3b0ec642-807e-4c66-a90c-3e5147e95010

**After:**

https://github.com/user-attachments/assets/7790d998-537f-4c6f-8ec4-aa52f02966d8

**Backport needed for v14 & v15**<hr>This is an automatic backport of pull request #45242 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-21 11:06:04+00:00,[],2025-02-06 00:10:39+00:00,2025-01-21 11:28:14+00:00,https://github.com/frappe/erpnext/pull/45359,"[('needs-tests', 'This PR needs automated unit-tests.'), ('released', None)]","[{'comment_id': 2606214899, 'issue_id': 2801485446, 'author': 'frappe-pr-bot', 'body': ':tada: This PR is included in version 14.80.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2025, 1, 22, 3, 34, 49, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2025-01-22 03:34:49 UTC): :tada: This PR is included in version 14.80.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2801234424,pull_request,closed,,chore: release v14,Automated weekly release.,frappe-pr-bot,2025-01-21 09:34:43+00:00,[],2025-02-06 00:10:40+00:00,2025-01-22 03:33:17+00:00,https://github.com/frappe/erpnext/pull/45358,"[('accounts', ''), ('released', None)]","[{'comment_id': 2606214859, 'issue_id': 2801234424, 'author': 'frappe-pr-bot', 'body': ':tada: This PR is included in version 14.80.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2025, 1, 22, 3, 34, 46, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot (Issue Creator) on (2025-01-22 03:34:46 UTC): :tada: This PR is included in version 14.80.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2801234391,pull_request,closed,,chore: release v15,Automated weekly release.,frappe-pr-bot,2025-01-21 09:34:42+00:00,[],2025-02-06 00:10:41+00:00,2025-01-22 03:31:35+00:00,https://github.com/frappe/erpnext/pull/45357,"[('accounts', ''), ('stock', None)]",[],
2801054655,pull_request,closed,,fix: calculate AED exchange rate based on pegged value with USD (backport #45215),"**Issue:** Unable to get exchange rate for AED using frankfurter API

**Solution:** 
As the frankfurter API doesn't provide exchange rate for AED. Considering that AED is pegged to USD at the exchange rate of 
3.6725 AED , have hardcoded the value in exchange rate utils function.

**Ref**: [28900](https://support.frappe.io/helpdesk/tickets/28900)

**Before:**

[AED exchange rate issue.webm](https://github.com/user-attachments/assets/e269c771-bed1-4f39-8fd5-c7594f83e1df)

**After:**

[AED exchange rate fixed.webm](https://github.com/user-attachments/assets/8fd0d7cc-1a77-480c-bb8f-0bf7feba6280)

Backport Needed: v15<hr>This is an automatic backport of pull request #45215 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-21 08:29:29+00:00,[],2025-02-05 00:10:28+00:00,2025-01-21 09:25:27+00:00,https://github.com/frappe/erpnext/pull/45356,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2801022894,pull_request,closed,,perf: Ignore is_opening column in GL Queries (backport #45327),"`Is Opening` column allows users to add opening entries irrespective of posting date and fiscal year.
This should not ideally be allowed after the balance sheet is frozen for the first fiscal year in the system.

This column is used in all queries for getting opening balance, one more side effect this column has is since the posting date can be any date, the tables cannot be logically partitioned based on the posting date to make queries efficient. Once the user reaches large volume of data in GL Entry, these queries take a lot of time to execute and sometimes more than the report timeout limit.

Added a check to ignore this column in queries, once the user has imported all opening entries with posting date before the date system actually came to use with live entries, this column becomes irrelevant.

![image](https://github.com/user-attachments/assets/ee8fa42c-b4e4-4ba3-a013-aaef2888ca34)
<hr>This is an automatic backport of pull request #45327 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-21 08:20:22+00:00,['deepeshgarg007'],2025-02-05 00:10:29+00:00,2025-01-21 09:04:09+00:00,https://github.com/frappe/erpnext/pull/45355,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2800859422,pull_request,closed,,feat: Added difference_posting_date field in Sales Invoice Advance and Purchase Invoice Advance (backport #44808),"**Issue:**
unable to select posting date of the exchange gain/loss journal while linking advance  payment in invoice

**Solution:**
Added difference_posting_date field in Sales Invoice Advance and Purchase Invoice Advance

**Before:**

[before.webm](https://github.com/user-attachments/assets/9c1b5f64-7626-426f-b36c-4be14913593a)

**After:**

[after.webm](https://github.com/user-attachments/assets/6cbc6791-1a7a-4896-b5ab-7ed2f3099b83)

**Backport needed for v15**<hr>This is an automatic backport of pull request #44808 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-21 06:54:26+00:00,['ruthra-kumar'],2025-02-06 00:10:38+00:00,2025-01-21 09:18:27+00:00,https://github.com/frappe/erpnext/pull/45351,"[('accounts', ''), ('released', None)]","[{'comment_id': 2603800171, 'issue_id': 2800859422, 'author': 'mergify[bot]', 'body': 'Cherry-pick of 225e56cbcae5c30172b52aa2e6cbc04a5ec01d43 has failed:\n```\nOn branch mergify/bp/version-14-hotfix/pr-44808\nYour branch is up to date with \'origin/version-14-hotfix\'.\n\nYou are currently cherry-picking commit 225e56cbca.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/accounts/doctype/purchase_invoice_advance/purchase_invoice_advance.json\n\tboth modified:   erpnext/accounts/doctype/purchase_invoice_advance/purchase_invoice_advance.py\n\tboth modified:   erpnext/accounts/doctype/sales_invoice_advance/sales_invoice_advance.json\n\tboth modified:   erpnext/accounts/doctype/sales_invoice_advance/sales_invoice_advance.py\n\nno changes added to commit (use ""git add"" and/or ""git commit -a"")\n```\n\n\nCherry-pick of c14a2d73bf10fd910e319bc62c2d8e117cce73f1 has failed:\n```\nOn branch mergify/bp/version-14-hotfix/pr-44808\nYour branch is ahead of \'origin/version-14-hotfix\' by 2 commits.\n  (use ""git push"" to publish your local commits)\n\nYou are currently cherry-picking commit c14a2d73bf.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/controllers/tests/test_accounts_controller.py\n\nno changes added to commit (use ""git add"" and/or ""git commit -a"")\n```\n\n\nTo fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally', 'created_at': datetime.datetime(2025, 1, 21, 6, 54, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2606214931, 'issue_id': 2800859422, 'author': 'frappe-pr-bot', 'body': ':tada: This PR is included in version 14.80.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2025, 1, 22, 3, 34, 52, tzinfo=datetime.timezone.utc)}]","mergify[bot] (Issue Creator) on (2025-01-21 06:54:28 UTC): Cherry-pick of 225e56cbcae5c30172b52aa2e6cbc04a5ec01d43 has failed:
```
On branch mergify/bp/version-14-hotfix/pr-44808
Your branch is up to date with 'origin/version-14-hotfix'.

You are currently cherry-picking commit 225e56cbca.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/accounts/doctype/purchase_invoice_advance/purchase_invoice_advance.json
	both modified:   erpnext/accounts/doctype/purchase_invoice_advance/purchase_invoice_advance.py
	both modified:   erpnext/accounts/doctype/sales_invoice_advance/sales_invoice_advance.json
	both modified:   erpnext/accounts/doctype/sales_invoice_advance/sales_invoice_advance.py

no changes added to commit (use ""git add"" and/or ""git commit -a"")
```


Cherry-pick of c14a2d73bf10fd910e319bc62c2d8e117cce73f1 has failed:
```
On branch mergify/bp/version-14-hotfix/pr-44808
Your branch is ahead of 'origin/version-14-hotfix' by 2 commits.
  (use ""git push"" to publish your local commits)

You are currently cherry-picking commit c14a2d73bf.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/controllers/tests/test_accounts_controller.py

no changes added to commit (use ""git add"" and/or ""git commit -a"")
```


To fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally

frappe-pr-bot on (2025-01-22 03:34:52 UTC): :tada: This PR is included in version 14.80.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2799204695,pull_request,closed,,fix: fix creating documents from sales invoice,"Hello everyone :)

there are some bugs when creating documents from sales invoice:

1. create dunning with + button in tab Connections -> doesn't add the sales invoice in the sales invoice table in dunning doc
2. Button Create -> Invoice Discounting does nothing
3. Button Create -> Maintenance Schedule does nothing

I also added a before video and a after video with the fixed bugs for a better understanding.

Before (current develop branch)
[before.webm](https://github.com/user-attachments/assets/d367e6ab-d199-4996-b3ee-93b0f17966cf)

After (with my code changes)
[after.webm](https://github.com/user-attachments/assets/ca4a94ce-9202-40fd-9e1e-23960cc0f679)

And please backport to v15 and v14 if possible.

Best regards
Meike
",meike289,2025-01-20 12:57:19+00:00,[],2025-02-07 00:10:25+00:00,2025-01-23 12:24:00+00:00,https://github.com/frappe/erpnext/pull/45346,"[('backport version-14-hotfix', 'backport to version 14'), ('backport version-15-hotfix', '')]",[],
2799143817,pull_request,closed,,fix:  maintain existing discounts in get_pricing_rule_for_item,"closes : [Support Ticket  - 29277](https://support.frappe.io/helpdesk/tickets/29277)

Related PR: https://github.com/frappe/erpnext/pull/44708

Issue:
The previous PR caused the discount amount to always be set to 0.

Fix:
This change has been reverted. Clearing the discount amount is now handled in the remove_pricing_rule function.",Sanket322,2025-01-20 12:30:47+00:00,['ruthra-kumar'],2025-01-27 10:31:46+00:00,2025-01-27 10:31:46+00:00,https://github.com/frappe/erpnext/pull/45345,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-14-hotfix', 'backport to version 14'), ('backport version-15-hotfix', '')]",[],
2799128263,pull_request,closed,,fix: broken image issue in BOM Tree,"Closes #45147 

> Screenshots/GIFs

- When Images are not set
![image](https://github.com/user-attachments/assets/30ca663d-2a62-4550-871e-10b039bd94f5)

- When Images are set
![image](https://github.com/user-attachments/assets/6bf903b5-a9c2-46d3-914e-5991dafb86f3)

",iamejaaz,2025-01-20 12:23:56+00:00,[],2025-02-04 00:10:19+00:00,2025-01-20 17:18:06+00:00,https://github.com/frappe/erpnext/pull/45344,[],[],
2799027743,pull_request,closed,,fix: set invoice start date to subscription start date (backport #45342),"Fix: The variable `current_start_invoice` is assigned the value of `start_date` when `trial_period_start` is used instead of `trial_start_date`.

fixes #44371 <hr>This is an automatic backport of pull request #45342 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-20 11:38:30+00:00,['diptanilsaha'],2025-02-04 00:10:20+00:00,2025-01-20 12:04:20+00:00,https://github.com/frappe/erpnext/pull/45343,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2798981272,pull_request,closed,,fix: set invoice start date to subscription start date,"Fix: The variable `current_start_invoice` is assigned the value of `start_date` when `trial_period_start` is used instead of `trial_start_date`.

fixes #44371 ",diptanilsaha,2025-01-20 11:19:22+00:00,[],2025-02-04 00:10:21+00:00,2025-01-20 11:36:02+00:00,https://github.com/frappe/erpnext/pull/45342,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2798747452,pull_request,closed,,fix: precision on work order total qty,Internal ticket: https://support.frappe.io/helpdesk/my-tickets/29769,rtdany10,2025-01-20 09:47:14+00:00,[],2025-02-05 00:10:24+00:00,2025-01-21 14:48:27+00:00,https://github.com/frappe/erpnext/pull/45341,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport develop', 'instructs mergify to frontport PR to develop branch')]",[],
2798425986,pull_request,closed,,fix: added item_group filter in item_code field in stock balance report,"In response to support ticket [29705](https://support.frappe.io/helpdesk/tickets/29705)

Previous behaviour: In the Stock Balance Report, when selecting item_group filter, it was not being applied to the item_code filter.

New behaviour: Now if item_group is selected, the item_code field will be filtered according to it.

`no-docs`",mihir-kandoi,2025-01-20 07:30:12+00:00,[],2025-02-07 00:10:49+00:00,2025-01-23 05:47:35+00:00,https://github.com/frappe/erpnext/pull/45340,"[('backport version-15-hotfix', '')]",[],
2798332855,pull_request,closed,,fix: translation fixes (backport #45334),Backport to version-15<hr>This is an automatic backport of pull request #45334 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-20 06:42:04+00:00,[],2025-02-04 00:10:22+00:00,2025-01-20 07:41:35+00:00,https://github.com/frappe/erpnext/pull/45339,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2798328550,pull_request,closed,,feat: Create Syscohada charts of accounts (backport #44453),"New PR to replace #43999 as per maintainers' request.
-
SYSCOHADA is the accounting system and financial reporting currently adopted by 17 African countries. It provides a standardized framework to enhance transparency and comparability in financial statements for businesses in these regions.

This PR aims at adding this standardized chart of accounts into ERPNext so it is usable by said countries.
If possible, these changes should be backported.

References : 
- https://fr.wikipedia.org/wiki/Plan_comptable_(OHADA)
- https://www.droit-afrique.com/uploads/OHADA-Plan-comptable-2017.pdf


Files added:
-
1. **Generic chart of accounts with code**
`erpnext/accounts/doctype/account/chart_of_accounts/verified/syscohada_plan_comptable_avec_code.json`

2. **Generic chart of accounts**
`erpnext/accounts/doctype/account/chart_of_accounts/verified/syscohada_plan_comptable.json`

3. **Helper to generate individual files for all affiliated countries by specifying country name where applicable**
`erpnext/accounts/doctype/account/chart_of_accounts/verified/syscohada_chart_of_accounts.py`

The files generated for each country will look like: **country**_plan_comptable.json or **country**_plan_comptable_avec_code.json

Files deleted :
-
**Unverified chart file for syscohada**
`erpnext/accounts/doctype/account/chart_of_accounts/unverified/syscohada_syscohada_chart_template.json`


Screenshots :
-
Setup Wizard:

![setup_wizard](https://github.com/user-attachments/assets/6ee50a10-b101-4bda-bc55-a7207d5e173a)


Company:

![societe_1](https://github.com/user-attachments/assets/29bee1f6-a10a-4a7e-924f-c51879ce0d6e)

![societe_2](https://github.com/user-attachments/assets/b39498ed-7d1f-4e96-bb2f-9eb65e39f846)

![societe_3](https://github.com/user-attachments/assets/69e8e6c1-eaca-4a41-b33a-b7b3d219240d)


no-docs<hr>This is an automatic backport of pull request #44453 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-20 06:39:14+00:00,['ruthra-kumar'],2025-02-05 00:10:35+00:00,2025-01-21 07:47:17+00:00,https://github.com/frappe/erpnext/pull/45338,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2798297351,pull_request,closed,,fix: validate linked sales person (backport #45167),"Issue: Showing Disabled Sales Person

Ref: [28327](https://support.frappe.io/helpdesk/tickets/28327)

Before:


https://github.com/user-attachments/assets/9af54798-934c-48ed-bad7-9ceaf15208dc

After:


https://github.com/user-attachments/assets/08304062-5864-4f3c-aa22-4bba19007e59

Backport needed for v14 & v15


<hr>This is an automatic backport of pull request #45167 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-20 06:20:31+00:00,[],2025-02-04 00:10:25+00:00,2025-01-20 06:38:27+00:00,https://github.com/frappe/erpnext/pull/45337,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2798297247,pull_request,closed,,fix: validate linked sales person (backport #45167),"Issue: Showing Disabled Sales Person

Ref: [28327](https://support.frappe.io/helpdesk/tickets/28327)

Before:


https://github.com/user-attachments/assets/9af54798-934c-48ed-bad7-9ceaf15208dc

After:


https://github.com/user-attachments/assets/08304062-5864-4f3c-aa22-4bba19007e59

Backport needed for v14 & v15


<hr>This is an automatic backport of pull request #45167 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-20 06:20:27+00:00,[],2025-02-06 00:10:35+00:00,2025-01-20 06:40:39+00:00,https://github.com/frappe/erpnext/pull/45336,"[('needs-tests', 'This PR needs automated unit-tests.'), ('released', None)]","[{'comment_id': 2606215059, 'issue_id': 2798297247, 'author': 'frappe-pr-bot', 'body': ':tada: This PR is included in version 14.80.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2025, 1, 22, 3, 35, 1, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2025-01-22 03:35:01 UTC): :tada: This PR is included in version 14.80.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2798171725,pull_request,closed,,fix: valuation for batch,,rohitwaghchaure,2025-01-20 04:43:25+00:00,[],2025-02-08 00:10:27+00:00,2025-01-24 07:20:55+00:00,https://github.com/frappe/erpnext/pull/45335,"[('stock', None), ('backport version-15-hotfix', '')]",[],
2797801352,pull_request,closed,,fix: translation fixes,Backport to version-15,mahsem,2025-01-19 19:53:56+00:00,['ruthra-kumar'],2025-02-04 00:10:23+00:00,2025-01-20 06:41:32+00:00,https://github.com/frappe/erpnext/pull/45334,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2797740346,pull_request,closed,,chore: quickbooks migrator integration removal (#45240),resolve conflict,diptanilsaha,2025-01-19 17:31:11+00:00,[],2025-02-03 00:10:39+00:00,2025-01-19 17:40:01+00:00,https://github.com/frappe/erpnext/pull/45333,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2797581772,pull_request,closed,,fix: pos return total amount using default mode of payment,"Resolved the issue where the POS system automatically selected the default payment method and paid amount during returns, despite the user choosing a different payment method.

Requires backport in both version-15 and version-14.",diptanilsaha,2025-01-19 11:46:41+00:00,[],2025-02-06 00:10:13+00:00,2025-01-22 17:35:02+00:00,https://github.com/frappe/erpnext/pull/45332,"[('accounts', ''), ('needs-tests', 'This PR needs automated unit-tests.')]",[],
2797527885,pull_request,closed,,chore: update POT file,,frappe-pr-bot,2025-01-19 09:34:53+00:00,[],2025-02-03 00:10:40+00:00,2025-01-19 10:47:50+00:00,https://github.com/frappe/erpnext/pull/45331,[],[],
2797066239,pull_request,closed,,perf: Ignore is_opening column in GL Queries,"`Is Opening` column allows users to add opening entries irrespective of posting date and fiscal year.
This should not ideally be allowed after the balance sheet is frozen for the first fiscal year in the system.

This column is used in all queries for getting opening balance, one more side effect this column has is since the posting date can be any date, the tables cannot be logically partitioned based on the posting date to make queries efficient. Once the user reaches large volume of data in GL Entry, these queries take a lot of time to execute and sometimes more than the report timeout limit.

Added a check to ignore this column in queries, once the user has imported all opening entries with posting date before the date system actually came to use with live entries, this column becomes irrelevant.

![image](https://github.com/user-attachments/assets/ee8fa42c-b4e4-4ba3-a013-aaef2888ca34)
",deepeshgarg007,2025-01-18 16:34:59+00:00,['ruthra-kumar'],2025-02-07 10:05:17+00:00,2025-01-21 08:15:25+00:00,https://github.com/frappe/erpnext/pull/45327,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-14-hotfix', 'backport to version 14'), ('backport version-15-hotfix', '')]",[],
2796899146,pull_request,closed,,fix: do not reset picked items (backport #44783),"If the picked qty has set then don't override the picked batches or qty


https://github.com/user-attachments/assets/f739dedb-1e6a-4d7e-8801-fb674d2fd82a

<hr>This is an automatic backport of pull request #44783 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-18 10:15:25+00:00,['rohitwaghchaure'],2025-02-06 00:10:34+00:00,2025-01-19 09:37:01+00:00,https://github.com/frappe/erpnext/pull/45326,"[('released', None)]","[{'comment_id': 2599658128, 'issue_id': 2796899146, 'author': 'mergify[bot]', 'body': 'Cherry-pick of 34a80bfcd30b4f03be5886a286b2c8056a9931e1 has failed:\n```\nOn branch mergify/bp/version-14-hotfix/pr-44783\nYour branch is up to date with \'origin/version-14-hotfix\'.\n\nYou are currently cherry-picking commit 34a80bfcd3.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nChanges to be committed:\n\tmodified:   erpnext/stock/doctype/pick_list/pick_list.py\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/stock/doctype/pick_list/test_pick_list.py\n\n```\n\n\nTo fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally', 'created_at': datetime.datetime(2025, 1, 18, 10, 15, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2606215108, 'issue_id': 2796899146, 'author': 'frappe-pr-bot', 'body': ':tada: This PR is included in version 14.80.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2025, 1, 22, 3, 35, 4, tzinfo=datetime.timezone.utc)}]","mergify[bot] (Issue Creator) on (2025-01-18 10:15:27 UTC): Cherry-pick of 34a80bfcd30b4f03be5886a286b2c8056a9931e1 has failed:
```
On branch mergify/bp/version-14-hotfix/pr-44783
Your branch is up to date with 'origin/version-14-hotfix'.

You are currently cherry-picking commit 34a80bfcd3.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Changes to be committed:
	modified:   erpnext/stock/doctype/pick_list/pick_list.py

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/stock/doctype/pick_list/test_pick_list.py

```


To fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally

frappe-pr-bot on (2025-01-22 03:35:04 UTC): :tada: This PR is included in version 14.80.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2796863109,pull_request,closed,,fix: do not reset picked items (backport #44783),"If the picked qty has set then don't override the picked batches or qty


https://github.com/user-attachments/assets/f739dedb-1e6a-4d7e-8801-fb674d2fd82a

<hr>This is an automatic backport of pull request #44783 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-18 08:54:07+00:00,['rohitwaghchaure'],2025-02-03 00:10:41+00:00,2025-01-19 08:19:08+00:00,https://github.com/frappe/erpnext/pull/45325,[],[],
2796800134,pull_request,closed,,fix: company in quality inspection (backport #45298),"<img width=""822"" alt=""Screenshot 2025-01-16 at 5 16 38 PM"" src=""https://github.com/user-attachments/assets/c3511cff-de8f-44ce-b8ff-fd460c68d7ba"" />
<hr>This is an automatic backport of pull request #45298 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-18 06:46:00+00:00,['rohitwaghchaure'],2025-02-02 00:11:13+00:00,2025-01-18 07:19:00+00:00,https://github.com/frappe/erpnext/pull/45324,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2796124751,pull_request,closed,,fix: sync translations from crowdin,,frappe-pr-bot,2025-01-17 19:03:42+00:00,[],2025-02-04 00:10:18+00:00,2025-01-20 21:57:22+00:00,https://github.com/frappe/erpnext/pull/45323,"[('translation', None)]",[],
2795648886,pull_request,closed,,fix: System was allowing to save payment schedule amount less than grand total,"### Example about how to simulate

- [ ] Create a Sales Invoice with total 1000.00
![image](https://github.com/user-attachments/assets/e7163064-04ef-4a7b-a033-aed77d0820fc)

- [ ] In the Payment Therms, create a therm with amount 900.00 and try to save (and even submit)
![image](https://github.com/user-attachments/assets/3bb78102-908d-4bbc-9b78-b03986a53084)

You will see that the system will allow you to do that, but it should not, because the Payments total should be equal to the grand total of the invoice ([reference](https://github.com/frappe/erpnext/blob/97e37708728691f60f61789a131e567736040d2a/erpnext/controllers/accounts_controller.py#L2445)).

The validation that should block only works if the payments total is more than the grand total. This commit fixes that adding abs function to the validation.",devdiogenes,2025-01-17 14:46:05+00:00,[],2025-02-06 00:10:19+00:00,2025-01-22 12:22:27+00:00,https://github.com/frappe/erpnext/pull/45322,"[('accounts', ''), ('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2795308959,pull_request,closed,,fix: fixed typo in manufacturing settings and field rename (backport #45238),fixed typo as mentioned in #45110 and field renamed<hr>This is an automatic backport of pull request #45238 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-17 11:56:46+00:00,['diptanilsaha'],2025-02-01 00:11:26+00:00,2025-01-17 14:20:56+00:00,https://github.com/frappe/erpnext/pull/45321,[],[],
2795279040,pull_request,closed,,fix: set preferred email in Employee via backend controller,"> Noticed when Employee was bulk updated from list view for `prefered_contact_email` to ""Company Email"" did not set the appropriate values under `preferred_email` because the respective code was in the desk script ðŸ˜„

Set ""Preferred Email"" for Employee via validate based on ""Preferred Contact Email"" value which can be either ""Company Email"", ""Personal Email"" or ""User ID"".

Additional change to note: Unset `preferred_email` when `prefered_contact_email` is also unset.
",gavindsouza,2025-01-17 11:40:12+00:00,[],2025-02-06 00:10:21+00:00,2025-01-22 12:11:41+00:00,https://github.com/frappe/erpnext/pull/45320,"[('backport version-14-hotfix', 'backport to version 14'), ('backport version-15-hotfix', '')]",[],
2795264960,pull_request,closed,,fix!: ensure multiple PCVs in same fiscal year are considered in patch (backport #44811),Tested Locally âœ… <hr>This is an automatic backport of pull request #44811 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-17 11:32:09+00:00,['sagarvora'],2025-02-01 00:11:27+00:00,2025-01-17 11:59:53+00:00,https://github.com/frappe/erpnext/pull/45319,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2795248568,pull_request,closed,,chore: quickbooks migrator integration removal (backport #45240),Removal of QuickBooks Migrator Feature from ERPNext Integration.<hr>This is an automatic backport of pull request #45240 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-17 11:25:08+00:00,['diptanilsaha'],2025-02-07 00:10:40+00:00,2025-01-19 17:36:12+00:00,https://github.com/frappe/erpnext/pull/45318,"[('needs-tests', 'This PR needs automated unit-tests.'), ('conflicts', None)]","[{'comment_id': 2598150872, 'issue_id': 2795248568, 'author': 'mergify[bot]', 'body': 'Cherry-pick of d13c03676b0c7a6c895cf1a7f48e9d5685c2a6f7 has failed:\n```\nOn branch mergify/bp/version-15-hotfix/pr-45240\nYour branch is up to date with \'origin/version-15-hotfix\'.\n\nYou are currently cherry-picking commit d13c03676b.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nChanges to be committed:\n\tdeleted:    erpnext/erpnext_integrations/doctype/quickbooks_migrator/__init__.py\n\tdeleted:    erpnext/erpnext_integrations/doctype/quickbooks_migrator/quickbooks_migrator.js\n\tdeleted:    erpnext/erpnext_integrations/doctype/quickbooks_migrator/quickbooks_migrator.py\n\nUnmerged paths:\n  (use ""git add/rm <file>..."" as appropriate to mark resolution)\n\tdeleted by them: erpnext/erpnext_integrations/doctype/quickbooks_migrator/quickbooks_migrator.json\n\tdeleted by them: erpnext/erpnext_integrations/doctype/quickbooks_migrator/test_quickbooks_migrator.py\n\n```\n\n\nTo fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally', 'created_at': datetime.datetime(2025, 1, 17, 11, 25, 10, tzinfo=datetime.timezone.utc)}]","mergify[bot] (Issue Creator) on (2025-01-17 11:25:10 UTC): Cherry-pick of d13c03676b0c7a6c895cf1a7f48e9d5685c2a6f7 has failed:
```
On branch mergify/bp/version-15-hotfix/pr-45240
Your branch is up to date with 'origin/version-15-hotfix'.

You are currently cherry-picking commit d13c03676b.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Changes to be committed:
	deleted:    erpnext/erpnext_integrations/doctype/quickbooks_migrator/__init__.py
	deleted:    erpnext/erpnext_integrations/doctype/quickbooks_migrator/quickbooks_migrator.js
	deleted:    erpnext/erpnext_integrations/doctype/quickbooks_migrator/quickbooks_migrator.py

Unmerged paths:
  (use ""git add/rm <file>..."" as appropriate to mark resolution)
	deleted by them: erpnext/erpnext_integrations/doctype/quickbooks_migrator/quickbooks_migrator.json
	deleted by them: erpnext/erpnext_integrations/doctype/quickbooks_migrator/test_quickbooks_migrator.py

```


To fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally

"
2795246224,pull_request,closed,,fix: fetching items from blanket order to sales/purchase order (backport #45262),Resolved issue #44880 and implemented validation to prevent negative item quantities.<hr>This is an automatic backport of pull request #45262 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-17 11:24:10+00:00,['diptanilsaha'],2025-02-05 00:10:32+00:00,2025-01-21 08:25:51+00:00,https://github.com/frappe/erpnext/pull/45317,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2795241515,pull_request,closed,,fix: Ambiguous column error while creating Sales Return (backport #45275),Closes https://github.com/frappe/erpnext/issues/45194<hr>This is an automatic backport of pull request #45275 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-17 11:22:26+00:00,['nabinhait'],2025-02-04 00:10:24+00:00,2025-01-20 06:43:39+00:00,https://github.com/frappe/erpnext/pull/45316,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2795241410,pull_request,closed,,fix: updated modified timestamp for stock entry type (backport #45280),Closes https://github.com/frappe/erpnext/issues/43215<hr>This is an automatic backport of pull request #45280 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-17 11:22:23+00:00,['nabinhait'],2025-02-05 00:10:23+00:00,2025-01-21 14:51:01+00:00,https://github.com/frappe/erpnext/pull/45315,"[('conflicts', None)]","[{'comment_id': 2598142706, 'issue_id': 2795241410, 'author': 'mergify[bot]', 'body': 'Cherry-pick of 2d45d0e5d5b136e287040fe2716f362ab4ae9ba8 has failed:\n```\nOn branch mergify/bp/version-15-hotfix/pr-45280\nYour branch is up to date with \'origin/version-15-hotfix\'.\n\nYou are currently cherry-picking commit 2d45d0e5d5.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/stock/doctype/stock_entry_type/stock_entry_type.json\n\nno changes added to commit (use ""git add"" and/or ""git commit -a"")\n```\n\n\nTo fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally', 'created_at': datetime.datetime(2025, 1, 17, 11, 22, 25, tzinfo=datetime.timezone.utc)}]","mergify[bot] (Issue Creator) on (2025-01-17 11:22:25 UTC): Cherry-pick of 2d45d0e5d5b136e287040fe2716f362ab4ae9ba8 has failed:
```
On branch mergify/bp/version-15-hotfix/pr-45280
Your branch is up to date with 'origin/version-15-hotfix'.

You are currently cherry-picking commit 2d45d0e5d5.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/stock/doctype/stock_entry_type/stock_entry_type.json

no changes added to commit (use ""git add"" and/or ""git commit -a"")
```


To fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally

"
2795238440,pull_request,closed,,fix: round off tax withholding amount (backport #45271),"Issue - The TCS Amount is not getting rounded off even though *round_off_tax_amount* is checked when the Charge Type is ""On Net Total"" or  ""On Previous Row Total"".

Steps to Replicate:

- Create a Tax withholding category with ""round_off_tax_amount"" as checked and threshold limit as 1.
- Create a Customer and set the tax withholding category.
- Now create a Sales Invoice. TCS will be deducted as Actual.
- Now create a Second Sales Invoice, TCS will be deducted from the Net Total but the amount will not be rounded off.

Note: Currently it is required only for Sales Invoice(TCS).

backport-version-14
backport-version-15

Frappe Support Issue: https://support.frappe.io/app/hd-ticket/28906


Note: Currently it is required only for Sales Invoice(TCS).
<hr>This is an automatic backport of pull request #45271 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-17 11:21:19+00:00,['ljain112'],2025-02-05 00:10:33+00:00,2025-01-21 08:25:03+00:00,https://github.com/frappe/erpnext/pull/45314,"[('accounts', ''), ('needs-tests', 'This PR needs automated unit-tests.')]",[],
2795238252,pull_request,closed,,fix: round off tax withholding amount (backport #45271),"Issue - The TCS Amount is not getting rounded off even though *round_off_tax_amount* is checked when the Charge Type is ""On Net Total"" or  ""On Previous Row Total"".

Steps to Replicate:

- Create a Tax withholding category with ""round_off_tax_amount"" as checked and threshold limit as 1.
- Create a Customer and set the tax withholding category.
- Now create a Sales Invoice. TCS will be deducted as Actual.
- Now create a Second Sales Invoice, TCS will be deducted from the Net Total but the amount will not be rounded off.

Note: Currently it is required only for Sales Invoice(TCS).

backport-version-14
backport-version-15

Frappe Support Issue: https://support.frappe.io/app/hd-ticket/28906


Note: Currently it is required only for Sales Invoice(TCS).
<hr>This is an automatic backport of pull request #45271 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-17 11:21:12+00:00,['ljain112'],2025-02-06 00:10:36+00:00,2025-01-21 08:25:19+00:00,https://github.com/frappe/erpnext/pull/45313,"[('accounts', ''), ('needs-tests', 'This PR needs automated unit-tests.'), ('released', None)]","[{'comment_id': 2606215017, 'issue_id': 2795238252, 'author': 'frappe-pr-bot', 'body': ':tada: This PR is included in version 14.80.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2025, 1, 22, 3, 34, 58, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2025-01-22 03:34:58 UTC): :tada: This PR is included in version 14.80.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2795232660,pull_request,closed,,fix(Project): re-phrase welcome email (backport #45175),"Before:
![image](https://github.com/user-attachments/assets/b0e95d7b-4499-42e4-b7eb-fc4c25beac64)

After:
![image](https://github.com/user-attachments/assets/6a868160-71b9-4a23-9f93-98a63aef086a)
<hr>This is an automatic backport of pull request #45175 done by [Mergify](https://mergify.com).

Todo (in backports only): avoid changes to translatable string",mergify[bot],2025-01-17 11:19:13+00:00,['ruthra-kumar'],2025-02-05 00:10:31+00:00,2025-01-21 08:26:51+00:00,https://github.com/frappe/erpnext/pull/45312,"[('squash', 'Meant to tell reviewers that this PR should be squashed into a single commit while merging.')]","[{'comment_id': 2598399188, 'issue_id': 2795232660, 'author': 'barredterra', 'body': 'Semgrep failures are not related to this PR.', 'created_at': datetime.datetime(2025, 1, 17, 13, 44, 25, tzinfo=datetime.timezone.utc)}]","barredterra on (2025-01-17 13:44:25 UTC): Semgrep failures are not related to this PR.

"
2795232559,pull_request,closed,,fix(Project): re-phrase welcome email (backport #45175),"Before:
![image](https://github.com/user-attachments/assets/b0e95d7b-4499-42e4-b7eb-fc4c25beac64)

After:
![image](https://github.com/user-attachments/assets/6a868160-71b9-4a23-9f93-98a63aef086a)
<hr>This is an automatic backport of pull request #45175 done by [Mergify](https://mergify.com).

Todo (in backports only): avoid changes to translatable string",mergify[bot],2025-01-17 11:19:10+00:00,[],2025-02-06 00:10:37+00:00,2025-01-21 08:26:30+00:00,https://github.com/frappe/erpnext/pull/45311,"[('squash', 'Meant to tell reviewers that this PR should be squashed into a single commit while merging.'), ('released', None)]","[{'comment_id': 2598132364, 'issue_id': 2795232559, 'author': 'mergify[bot]', 'body': 'Cherry-pick of 8d661428651fa1ce47f5f3b217cfadad47e060a6 has failed:\n```\nOn branch mergify/bp/version-14-hotfix/pr-45175\nYour branch is up to date with \'origin/version-14-hotfix\'.\n\nYou are currently cherry-picking commit 8d66142865.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/projects/doctype/project/project.py\n\nno changes added to commit (use ""git add"" and/or ""git commit -a"")\n```\n\n\nTo fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally', 'created_at': datetime.datetime(2025, 1, 17, 11, 19, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2598399582, 'issue_id': 2795232559, 'author': 'barredterra', 'body': 'Semgrep failures are not related to this PR.', 'created_at': datetime.datetime(2025, 1, 17, 13, 44, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2606214980, 'issue_id': 2795232559, 'author': 'frappe-pr-bot', 'body': ':tada: This PR is included in version 14.80.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2025, 1, 22, 3, 34, 56, tzinfo=datetime.timezone.utc)}]","mergify[bot] (Issue Creator) on (2025-01-17 11:19:12 UTC): Cherry-pick of 8d661428651fa1ce47f5f3b217cfadad47e060a6 has failed:
```
On branch mergify/bp/version-14-hotfix/pr-45175
Your branch is up to date with 'origin/version-14-hotfix'.

You are currently cherry-picking commit 8d66142865.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/projects/doctype/project/project.py

no changes added to commit (use ""git add"" and/or ""git commit -a"")
```


To fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally

barredterra on (2025-01-17 13:44:37 UTC): Semgrep failures are not related to this PR.

frappe-pr-bot on (2025-01-22 03:34:56 UTC): :tada: This PR is included in version 14.80.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.80.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2795212684,pull_request,closed,,feat: add option to update modified on communication recieved (backport #45307),"Closes #44330 

> Please provide enough information so that others can review your pull request:

Related to #43968 


- Add a field in CRM Settings to select whether to update the modified timestamp when new communication is received.
![image](https://github.com/user-attachments/assets/4b6cc858-94cf-4d23-a3f7-ea87eaab3263)

- Add a `doc` event of `after_insert` which updates the modified timestamp when a communication is received.


`no-docs`
<hr>This is an automatic backport of pull request #45307 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-17 11:11:45+00:00,"['ruthra-kumar', 'iamejaaz']",2025-02-05 00:10:22+00:00,2025-01-21 14:51:47+00:00,https://github.com/frappe/erpnext/pull/45310,"[('CRM', None), ('needs-tests', 'This PR needs automated unit-tests.')]","[{'comment_id': 2598109111, 'issue_id': 2795212684, 'author': 'mergify[bot]', 'body': 'Cherry-pick of aa38895caf2748caff492c6eccb58100e1795f0c has failed:\n```\nOn branch mergify/bp/version-15-hotfix/pr-45307\nYour branch is up to date with \'origin/version-15-hotfix\'.\n\nYou are currently cherry-picking commit aa38895caf.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nChanges to be committed:\n\tmodified:   erpnext/crm/doctype/crm_settings/crm_settings.py\n\tmodified:   erpnext/crm/utils.py\n\tmodified:   erpnext/hooks.py\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/crm/doctype/crm_settings/crm_settings.json\n\n```\n\n\nTo fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally', 'created_at': datetime.datetime(2025, 1, 17, 11, 11, 49, tzinfo=datetime.timezone.utc)}]","mergify[bot] (Issue Creator) on (2025-01-17 11:11:49 UTC): Cherry-pick of aa38895caf2748caff492c6eccb58100e1795f0c has failed:
```
On branch mergify/bp/version-15-hotfix/pr-45307
Your branch is up to date with 'origin/version-15-hotfix'.

You are currently cherry-picking commit aa38895caf.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Changes to be committed:
	modified:   erpnext/crm/doctype/crm_settings/crm_settings.py
	modified:   erpnext/crm/utils.py
	modified:   erpnext/hooks.py

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/crm/doctype/crm_settings/crm_settings.json

```


To fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally

"
2795202395,pull_request,closed,,fix: sales return for multi-uom (backport #45303),"Sales return with multi UOM throwing ""qty mismatch"" error <hr>This is an automatic backport of pull request #45303 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-17 11:08:03+00:00,['rohitwaghchaure'],2025-02-01 00:11:26+00:00,2025-01-17 13:11:04+00:00,https://github.com/frappe/erpnext/pull/45309,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2795167103,pull_request,closed,,feat: add option to update modified on communication recieved,"Closes #44330 

> Please provide enough information so that others can review your pull request:

Related to #43968 


- Add a field in CRM Settings to select whether to update the modified timestamp when new communication is received.
![image](https://github.com/user-attachments/assets/4b6cc858-94cf-4d23-a3f7-ea87eaab3263)

- Add a `doc` event of `after_insert` which updates the modified timestamp when a communication is received.


`no-docs`
",iamejaaz,2025-01-17 10:54:57+00:00,['nabinhait'],2025-02-01 00:11:41+00:00,2025-01-17 11:10:36+00:00,https://github.com/frappe/erpnext/pull/45307,"[('CRM', None), ('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2795041123,pull_request,closed,,fix: validate non-stock item for exchange loss/gain,"**Issue:**
creating exchange loss/gain for non-stock items
ref: [27256](https://support.frappe.io/helpdesk/tickets/27256)

**Solution:**
added condition to create only for stock item

**Before:**

[before.webm](https://github.com/user-attachments/assets/942e8a41-9780-40c8-9a91-36591903191c)


**After:**

[after.webm](https://github.com/user-attachments/assets/ed413055-0666-4f1e-9b65-fd47ae5fee34)

**Backport needed for v14 & v15**
",rs-rethik,2025-01-17 10:00:15+00:00,[],2025-02-06 00:10:20+00:00,2025-01-22 12:14:53+00:00,https://github.com/frappe/erpnext/pull/45306,"[('backport version-15-hotfix', '')]",[],
2795004885,pull_request,closed,,feat: fetch taxes table if taxes template supplied,"Reference issue #44900 

Current behaviour: If user creates a Sales Invoice through REST API, Sales Taxes and Charges Template is not fetched.

New behaviour: If user passes a Sales Taxes and Charges Template, the relevant taxes will be fetched.

Note: If user wants to make changes to the taxes table, they would have to first clear the template field. If not done, the taxes will be refetched on save and overwrite user inputted data.

`no-docs`",mihir-kandoi,2025-01-17 09:42:21+00:00,['ruthra-kumar'],2025-01-29 09:56:59+00:00,2025-01-29 09:04:06+00:00,https://github.com/frappe/erpnext/pull/45305,"[('needs-tests', 'This PR needs automated unit-tests.')]","[{'comment_id': 2621071652, 'issue_id': 2795004885, 'author': 'ruthra-kumar', 'body': 'Accidental branch pollution.\r\n\r\nCreating new PR https://github.com/frappe/erpnext/pull/45585', 'created_at': datetime.datetime(2025, 1, 29, 9, 12, 29, tzinfo=datetime.timezone.utc)}]","ruthra-kumar (Assginee) on (2025-01-29 09:12:29 UTC): Accidental branch pollution.

Creating new PR https://github.com/frappe/erpnext/pull/45585

"
2794782226,pull_request,closed,,fix: sales return for multi-uom,"Sales return with multi UOM throwing ""qty mismatch"" error ",rohitwaghchaure,2025-01-17 07:35:46+00:00,[],2025-02-01 00:11:41+00:00,2025-01-17 11:05:59+00:00,https://github.com/frappe/erpnext/pull/45303,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2794673537,pull_request,closed,,feat: add company level validation for accounting dimension,"Issue:
Accounting Dimension Validations are not happening as per Company

ref: [22387](https://support.frappe.io/helpdesk/tickets/22387)

Before:

[company_validation_bfr.webm](https://github.com/user-attachments/assets/7589b38c-1caf-4e47-9f69-89ed53547e9b)


After:

[company_validation_af.webm](https://github.com/user-attachments/assets/2b8efa9a-34fd-4a33-b2a9-7a67e6d41ac1)

no-docs",Sugesh393,2025-01-17 06:19:47+00:00,['ruthra-kumar'],2025-01-27 09:23:49+00:00,2025-01-27 09:23:49+00:00,https://github.com/frappe/erpnext/pull/45302,"[('accounts', ''), ('backport version-14-hotfix', 'backport to version 14'), ('backport version-15-hotfix', '')]",[],
2793738844,pull_request,closed,,fix: prevent unnecessary db.commit for contact insert,"We have ERPNext integrated with another system, when retrieving data from the other system, the following is created:
Customer
Addresses
Contacts
The link between the two systems has been created

When we synchronize, a for loop is performed and the customer, address and contact are inserted, but there may be errors in the process...

When there are errors, a rollback must be performed, but when inserting the contact, ERPNext executes an ""after_insert"" hook event calling the erpnext.telephony.doctype.call_log.call_log.link_existing_conversations method
thus executing frappe.db.commit()

Two improvements were made:
1. Only perform frappe.db.commit if there is an impact record returned by the select above.

2. Created an ""ignore_auto_link_call_log"" flag to ignore this method when we do not want it to execute, as this commit may break the code.",HarryPaulo,2025-01-16 20:47:25+00:00,['ruthra-kumar'],2025-01-27 06:48:08+00:00,2025-01-27 06:48:07+00:00,https://github.com/frappe/erpnext/pull/45300,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2793537232,pull_request,closed,,fix: sync translations from crowdin,,frappe-pr-bot,2025-01-16 19:01:35+00:00,[],2025-01-31 00:10:15+00:00,2025-01-16 21:49:23+00:00,https://github.com/frappe/erpnext/pull/45299,"[('translation', None)]",[],
2792537620,pull_request,closed,,fix: company in quality inspection,"<img width=""822"" alt=""Screenshot 2025-01-16 at 5 16 38 PM"" src=""https://github.com/user-attachments/assets/c3511cff-de8f-44ce-b8ff-fd460c68d7ba"" />
",rohitwaghchaure,2025-01-16 12:03:59+00:00,[],2025-02-02 00:11:14+00:00,2025-01-18 06:44:55+00:00,https://github.com/frappe/erpnext/pull/45298,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2792519372,pull_request,closed,,POS full payment,"Issue:
POS Invoices can be submitted with partial payments.

ref: 20857",Sugesh393,2025-01-16 11:57:13+00:00,[],2025-02-07 00:10:44+00:00,2025-01-23 07:17:20+00:00,https://github.com/frappe/erpnext/pull/45297,"[('accounts', '')]","[{'comment_id': 2609031050, 'issue_id': 2792519372, 'author': 'nabinhait', 'body': '@Sugesh393 @Navin-S-R @venkat102  @Vigneshsekar \r\nI am closing this PR, there are another 2/3 open PRs related to write-off and payment. We are taking it internally, @diptanilsaha will consolidate all these PRs and fix all the payments-related issues in one PR.\r\nWe will surely refer your PR while working on it.\r\nThanks for your PR.', 'created_at': datetime.datetime(2025, 1, 23, 7, 17, 20, tzinfo=datetime.timezone.utc)}]","nabinhait on (2025-01-23 07:17:20 UTC): @Sugesh393 @Navin-S-R @venkat102  @Vigneshsekar 
I am closing this PR, there are another 2/3 open PRs related to write-off and payment. We are taking it internally, @diptanilsaha will consolidate all these PRs and fix all the payments-related issues in one PR.
We will surely refer your PR while working on it.
Thanks for your PR.

"
2792165345,pull_request,closed,,fix: Does not allow to create Sub-Asseblies of Sub Assemblies (backport #45283),Fixed https://github.com/frappe/erpnext/issues/45219<hr>This is an automatic backport of pull request #45283 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-16 09:28:52+00:00,['rohitwaghchaure'],2025-01-31 00:10:18+00:00,2025-01-16 11:28:27+00:00,https://github.com/frappe/erpnext/pull/45293,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2792072489,pull_request,closed,,fix: don't update party-type on change of cost center in Journal Entry,"Issue: [Support Ticket - 29524](https://support.frappe.io/helpdesk/tickets/29524)

Before https://github.com/frappe/erpnext/pull/37477, the balance was updating based on the cost center. However, after https://github.com/frappe/erpnext/pull/37477, the cost center is not required in that function, and changing the cost center does not require a function call anymore.",Sanket322,2025-01-16 08:47:15+00:00,[],2025-02-07 00:10:21+00:00,2025-01-17 11:12:09+00:00,https://github.com/frappe/erpnext/pull/45291,"[('backport version-15-hotfix', '')]",[],
2791950186,pull_request,open,,refactor: use 'name' to identify trigger for free item,"Fixes: https://github.com/frappe/erpnext/issues/44929

todo:
 - [ ] handle client-side and server-side reactivity
 - [ ] temp -> permanent name mapping should be indempotent
",ruthra-kumar,2025-01-16 07:51:48+00:00,[],2025-01-28 10:29:14+00:00,,https://github.com/frappe/erpnext/pull/45290,"[('needs-tests', 'This PR needs automated unit-tests.'), ('WIP', '')]",[],
2791822346,pull_request,closed,,perf: optimize DB calls with frappe.get_all,Replaced multiple calls to frappe.db.get_value for fetching individual items with a single call to frappe.get_all.,Sanket322,2025-01-16 06:35:05+00:00,[],2025-02-07 00:10:47+00:00,2025-01-23 05:59:41+00:00,https://github.com/frappe/erpnext/pull/45289,"[('selling', None), ('backport version-15-hotfix', '')]",[],
2791746018,pull_request,closed,,fix: validate items against selling settings,"Issue: [Support Ticket  - 29465](https://support.frappe.io/helpdesk/tickets/29465)

Before:
It used to allow adding multiple identical items even if `Allow Item to be Added Multiple Times in a Transaction` in Selling Settings was unchecked.

After:
It validates items based on Selling Settings and checks for duplicate items.",Sanket322,2025-01-16 05:34:28+00:00,[],2025-02-08 00:10:15+00:00,2025-01-24 09:40:43+00:00,https://github.com/frappe/erpnext/pull/45288,"[('accounts', ''), ('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2790631354,pull_request,closed,,fix: translations,Backport to version-15,mahsem,2025-01-15 19:07:12+00:00,[],2025-02-03 00:10:38+00:00,2025-01-19 17:07:48+00:00,https://github.com/frappe/erpnext/pull/45286,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2790540755,pull_request,closed,,fix: sync translations from crowdin,,frappe-pr-bot,2025-01-15 18:19:27+00:00,[],2025-01-31 00:10:24+00:00,2025-01-16 05:40:32+00:00,https://github.com/frappe/erpnext/pull/45285,"[('translation', None)]",[],
2789865448,pull_request,closed,,fix: set party_account_currency for pos_invoice returns,"Issue:
Unable to return POS Invoice with same amount in payments table while using foreign currency.

ref: [29091](https://support.frappe.io/helpdesk/tickets/29091)

Before:

[party_account_currency_bfr.webm](https://github.com/user-attachments/assets/4ae8afb7-ef93-49bf-b16e-1ae7f4c14911)

After:

[party_account_currency_afr.webm](https://github.com/user-attachments/assets/22a77d7e-009c-41ca-821d-9df3819cbf3a)
",Sugesh393,2025-01-15 13:33:26+00:00,['ruthra-kumar'],2025-01-27 08:57:41+00:00,2025-01-27 08:57:41+00:00,https://github.com/frappe/erpnext/pull/45284,"[('backport version-15-hotfix', '')]",[],
2789756907,pull_request,closed,,fix: Does not allow to create Sub-Asseblies of Sub Assemblies,Fixed https://github.com/frappe/erpnext/issues/45219,rohitwaghchaure,2025-01-15 12:46:20+00:00,[],2025-01-31 00:10:19+00:00,2025-01-16 09:27:56+00:00,https://github.com/frappe/erpnext/pull/45283,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2789754248,pull_request,closed,,feat: Add corrective job card operating cost as additional costs in sâ€¦,"Reference issue #44976 

This PR does two new things:

The operating cost of corrective job cards will now be added to the additional costs table of Manufacture Stock Entry.
Newly created corrective job cards will now have raw materials table pre-filled based on the job card it is being created from.

`no-docs`",mihir-kandoi,2025-01-15 12:45:30+00:00,[],2025-01-27 12:02:20+00:00,2025-01-20 17:18:46+00:00,https://github.com/frappe/erpnext/pull/45282,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2789753182,pull_request,closed,,fix: status of the serial no for the raw materials (backport #45278),Fixed https://github.com/frappe/erpnext/issues/45246<hr>This is an automatic backport of pull request #45278 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-15 12:45:13+00:00,['rohitwaghchaure'],2025-01-31 00:10:21+00:00,2025-01-16 06:24:50+00:00,https://github.com/frappe/erpnext/pull/45281,"[('stock', None)]","[{'comment_id': 2592749625, 'issue_id': 2789753182, 'author': 'mergify[bot]', 'body': 'Cherry-pick of 9607b16dcf38088cb8e499992b617834e97251e6 has failed:\n```\nOn branch mergify/bp/version-15-hotfix/pr-45278\nYour branch is up to date with \'origin/version-15-hotfix\'.\n\nYou are currently cherry-picking commit 9607b16dcf.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nChanges to be committed:\n\tmodified:   erpnext/manufacturing/doctype/work_order/test_work_order.py\n\tmodified:   erpnext/stock/doctype/serial_no/serial_no.py\n\tmodified:   erpnext/stock/doctype/stock_entry/test_stock_entry.py\n\tmodified:   erpnext/stock/serial_batch_bundle.py\n\tmodified:   erpnext/stock/stock_ledger.py\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/stock/doctype/serial_no/serial_no.json\n\n```\n\n\nTo fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally', 'created_at': datetime.datetime(2025, 1, 15, 12, 45, 15, tzinfo=datetime.timezone.utc)}]","mergify[bot] (Issue Creator) on (2025-01-15 12:45:15 UTC): Cherry-pick of 9607b16dcf38088cb8e499992b617834e97251e6 has failed:
```
On branch mergify/bp/version-15-hotfix/pr-45278
Your branch is up to date with 'origin/version-15-hotfix'.

You are currently cherry-picking commit 9607b16dcf.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Changes to be committed:
	modified:   erpnext/manufacturing/doctype/work_order/test_work_order.py
	modified:   erpnext/stock/doctype/serial_no/serial_no.py
	modified:   erpnext/stock/doctype/stock_entry/test_stock_entry.py
	modified:   erpnext/stock/serial_batch_bundle.py
	modified:   erpnext/stock/stock_ledger.py

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/stock/doctype/serial_no/serial_no.json

```


To fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally

"
2789584669,pull_request,closed,,fix: updated modified timestamp for stock entry type,Closes https://github.com/frappe/erpnext/issues/43215,nabinhait,2025-01-15 11:45:25+00:00,[],2025-02-01 00:11:37+00:00,2025-01-17 11:20:43+00:00,https://github.com/frappe/erpnext/pull/45280,"[('backport version-15-hotfix', '')]",[],
2789481942,pull_request,closed,,Supplier custom fields error,"<!--

Some key notes before you open a PR:

 1. Select which branch should this PR be merged in?
 2. PR name follows [convention](http://karma-runner.github.io/4.0/dev/git-commit-msg.html)
 3. All tests pass locally, UI and Unit tests
 4. All business logic and validations must be on the server-side
 5. Update necessary Documentation
 6. Put `closes #XXXX` in your comment to auto-close the issue that your PR fixes


Also, if you're new here

- Documentation Guidelines => https://github.com/frappe/erpnext/wiki/Updating-Documentation

- Contribution Guide => https://github.com/frappe/erpnext/blob/develop/.github/CONTRIBUTING.md

- Pull Request Checklist => https://github.com/frappe/erpnext/wiki/Pull-Request-Checklist

-->

> Please provide enough information so that others can review your pull request:

<!-- You can skip this if you're fixing a typo or updating existing documentation -->

> Explain the **details** for making this change. What existing problem does the pull request solve?

<!-- Example: When ""Adding a function to do X"", explain why it is necessary to have a way to do X. -->

> Screenshots/GIFs

<!-- Add images/recordings to better visualize the change: expected/current behviour -->
",8848jay,2025-01-15 10:57:26+00:00,[],2025-01-30 00:10:18+00:00,2025-01-15 10:59:04+00:00,https://github.com/frappe/erpnext/pull/45279,"[('accounts', ''), ('stock', None), ('CRM', None), ('selling', None), ('buying', None), ('assets', ''), ('projects', 'projects module related issue / PR')]",[],
2789446645,pull_request,closed,,fix: status of the serial no for the raw materials,Fixed https://github.com/frappe/erpnext/issues/45246,rohitwaghchaure,2025-01-15 10:43:26+00:00,[],2025-01-30 00:10:07+00:00,2025-01-15 12:43:35+00:00,https://github.com/frappe/erpnext/pull/45278,"[('stock', None), ('backport version-15-hotfix', '')]",[],
2789355772,pull_request,closed,,fix: check if tds deducted based on Purchase Taxes and Charges (backport #45161),"Issue: When an account is changed in a Tax withholding account in the middle of period, Tax Deducted at Source (TDS) is deducted on all invoices, including those on which TDS has already been deducted.

Steps to Replicate:
- Create a Tax Withholding Category with a limit of 10,000 and rate = 10%.
- Create a supplier with the same Tax Withholding Category.
- Create a Purchase Invoice with an amount of â‚¹15,000. The expected TDS is â‚¹1,500 (calculated as â‚¹15,000 * 10%).
- Change the TDS Account in the Tax Withholding Category.
-  Create another Purchase Invoice with an amount of â‚¹10,000.

The TDS for the second invoice should be â‚¹1,000 (calculated as â‚¹10,000 * 10%). However, due to the current system logic, TDS is recalculated based on the new account change, resulting in a total deduction of â‚¹2,500 (calculated as (â‚¹15,000 + â‚¹10,000) * 10%).


Proposed Solution:

- Utilize the ""is_tax_withholding_account"" checkbox in the Purchase Taxes and Charges table to determine if TDS has already been deducted.


Note: This field is only available in Purchase Taxes and Charges Table

Frappe Support Issue: 
https://support.frappe.io/app/hd-ticket/28665
https://support.frappe.io/app/hd-ticket/28660

backport-version-14
backport-version-15



<hr>This is an automatic backport of pull request #45161 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-15 10:03:22+00:00,['ljain112'],2025-01-30 00:10:09+00:00,2025-01-15 12:38:18+00:00,https://github.com/frappe/erpnext/pull/45277,[],[],
2789355685,pull_request,closed,,fix: check if tds deducted based on Purchase Taxes and Charges (backport #45161),"Issue: When an account is changed in a Tax withholding account in the middle of period, Tax Deducted at Source (TDS) is deducted on all invoices, including those on which TDS has already been deducted.

Steps to Replicate:
- Create a Tax Withholding Category with a limit of 10,000 and rate = 10%.
- Create a supplier with the same Tax Withholding Category.
- Create a Purchase Invoice with an amount of â‚¹15,000. The expected TDS is â‚¹1,500 (calculated as â‚¹15,000 * 10%).
- Change the TDS Account in the Tax Withholding Category.
-  Create another Purchase Invoice with an amount of â‚¹10,000.

The TDS for the second invoice should be â‚¹1,000 (calculated as â‚¹10,000 * 10%). However, due to the current system logic, TDS is recalculated based on the new account change, resulting in a total deduction of â‚¹2,500 (calculated as (â‚¹15,000 + â‚¹10,000) * 10%).


Proposed Solution:

- Utilize the ""is_tax_withholding_account"" checkbox in the Purchase Taxes and Charges table to determine if TDS has already been deducted.


Note: This field is only available in Purchase Taxes and Charges Table

Frappe Support Issue: 
https://support.frappe.io/app/hd-ticket/28665
https://support.frappe.io/app/hd-ticket/28660

backport-version-14
backport-version-15



<hr>This is an automatic backport of pull request #45161 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-15 10:03:20+00:00,['ljain112'],2025-01-30 00:10:19+00:00,2025-01-15 10:33:29+00:00,https://github.com/frappe/erpnext/pull/45276,[],[],
2789352388,pull_request,closed,,fix: Ambiguous column error while creating Sales Return,Closes https://github.com/frappe/erpnext/issues/45194,nabinhait,2025-01-15 10:01:50+00:00,[],2025-02-01 00:11:36+00:00,2025-01-17 11:21:07+00:00,https://github.com/frappe/erpnext/pull/45275,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2789297640,pull_request,closed,,fix: Skip WIP Warehouse transfer (backport #45270),"Reference support ticket: [29053](https://support.frappe.io/helpdesk/tickets/29053)

WIP warehouse field was not being removed even when ""Skip Material Transfer to WIP Warehouse"" was enabled. This simple PR fixes that.

`no-docs`<hr>This is an automatic backport of pull request #45270 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-15 09:37:07+00:00,['mihir-kandoi'],2025-01-30 00:10:17+00:00,2025-01-15 12:07:33+00:00,https://github.com/frappe/erpnext/pull/45274,[],[],
2789269905,pull_request,closed,,fix: use currency defined in plan for subscription invoice (backport #45104),"Issue: Subscription Invoice is not based on plan currency.

Steps to replicate:

- Allow ""allow_multi_currency_invoices_against_single_party_account"" from account settings.
- Create a customer with defualt_billing_currency that is different from Company Currency.
- Create a Subscription Plan in Customer Currency.
- Create a Subscription.

The invoice will be in company default receivable account currency because no default account is set in the Party.


Frappe Support Issue: https://support.frappe.io/app/hd-ticket/28511

backport-version-15
backport-version-14
<hr>This is an automatic backport of pull request #45104 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-15 09:24:03+00:00,['ljain112'],2025-01-30 00:10:08+00:00,2025-01-15 12:39:02+00:00,https://github.com/frappe/erpnext/pull/45273,[],[],
2789268013,pull_request,closed,,fix: use currency defined in plan for subscription invoice (backport #45104),"Issue: Subscription Invoice is not based on plan currency.

Steps to replicate:

- Allow ""allow_multi_currency_invoices_against_single_party_account"" from account settings.
- Create a customer with defualt_billing_currency that is different from Company Currency.
- Create a Subscription Plan in Customer Currency.
- Create a Subscription.

The invoice will be in company default receivable account currency because no default account is set in the Party.


Frappe Support Issue: https://support.frappe.io/app/hd-ticket/28511

backport-version-15
backport-version-14
<hr>This is an automatic backport of pull request #45104 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-15 09:23:11+00:00,['ljain112'],2025-01-30 00:10:20+00:00,2025-01-15 10:33:15+00:00,https://github.com/frappe/erpnext/pull/45272,"[('conflicts', None)]","[{'comment_id': 2592097439, 'issue_id': 2789268013, 'author': 'mergify[bot]', 'body': 'Cherry-pick of a4453fb77b458dfde91b5330a798d44024da722f has failed:\n```\nOn branch mergify/bp/version-14-hotfix/pr-45104\nYour branch is up to date with \'origin/version-14-hotfix\'.\n\nYou are currently cherry-picking commit a4453fb77b.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/accounts/doctype/subscription/subscription.py\n\tboth modified:   erpnext/accounts/doctype/subscription/test_subscription.py\n\nno changes added to commit (use ""git add"" and/or ""git commit -a"")\n```\n\n\nTo fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally', 'created_at': datetime.datetime(2025, 1, 15, 9, 23, 13, tzinfo=datetime.timezone.utc)}]","mergify[bot] (Issue Creator) on (2025-01-15 09:23:13 UTC): Cherry-pick of a4453fb77b458dfde91b5330a798d44024da722f has failed:
```
On branch mergify/bp/version-14-hotfix/pr-45104
Your branch is up to date with 'origin/version-14-hotfix'.

You are currently cherry-picking commit a4453fb77b.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/accounts/doctype/subscription/subscription.py
	both modified:   erpnext/accounts/doctype/subscription/test_subscription.py

no changes added to commit (use ""git add"" and/or ""git commit -a"")
```


To fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally

"
2789155184,pull_request,closed,,fix: round off tax withholding amount,"Issue - The TCS Amount is not getting rounded off even though *round_off_tax_amount* is checked when the Charge Type is ""On Net Total"" or  ""On Previous Row Total"".

Steps to Replicate:

- Create a Tax withholding category with ""round_off_tax_amount"" as checked and threshold limit as 1.
- Create a Customer and set the tax withholding category.
- Now create a Sales Invoice. TCS will be deducted as Actual.
- Now create a Second Sales Invoice, TCS will be deducted from the Net Total but the amount will not be rounded off.

Note: Currently it is required only for Sales Invoice(TCS).

backport-version-14
backport-version-15

Frappe Support Issue: https://support.frappe.io/app/hd-ticket/28906


Note: Currently it is required only for Sales Invoice(TCS).
",ljain112,2025-01-15 08:35:38+00:00,[],2025-02-01 00:11:39+00:00,2025-01-17 11:20:15+00:00,https://github.com/frappe/erpnext/pull/45271,"[('accounts', ''), ('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-14-hotfix', 'backport to version 14'), ('backport version-15-hotfix', '')]",[],
2789128985,pull_request,closed,,fix: Skip WIP Warehouse transfer,"Reference support ticket: [29053](https://support.frappe.io/helpdesk/tickets/29053)

WIP warehouse field was not being removed even when ""Skip Material Transfer to WIP Warehouse"" was enabled. This simple PR fixes that.

`no-docs`",mihir-kandoi,2025-01-15 08:21:34+00:00,[],2025-01-30 00:10:22+00:00,2025-01-15 09:35:50+00:00,https://github.com/frappe/erpnext/pull/45270,"[('backport version-15-hotfix', '')]",[],
2787081518,pull_request,closed,,fix: incorrect valuation for sales return with different warhouse (backport #45259),"- Create the delivery note with batch
- Create the sales return with different warehouse
- Check the valuation rate it's showing zero <hr>This is an automatic backport of pull request #45259 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-14 13:04:39+00:00,['rohitwaghchaure'],2025-01-29 00:10:11+00:00,2025-01-14 15:05:45+00:00,https://github.com/frappe/erpnext/pull/45268,[],"[{'comment_id': 2589862241, 'issue_id': 2787081518, 'author': 'mergify[bot]', 'body': 'Cherry-pick of 3a2e8167597c06523f94f32843668164ab3eaca8 has failed:\n```\nOn branch mergify/bp/version-15-hotfix/pr-45259\nYour branch is up to date with \'origin/version-15-hotfix\'.\n\nYou are currently cherry-picking commit 3a2e816759.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nChanges to be committed:\n\tmodified:   erpnext/stock/doctype/serial_and_batch_bundle/serial_and_batch_bundle.py\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/stock/doctype/delivery_note/test_delivery_note.py\n\n```\n\n\nTo fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally', 'created_at': datetime.datetime(2025, 1, 14, 13, 4, 41, tzinfo=datetime.timezone.utc)}]","mergify[bot] (Issue Creator) on (2025-01-14 13:04:41 UTC): Cherry-pick of 3a2e8167597c06523f94f32843668164ab3eaca8 has failed:
```
On branch mergify/bp/version-15-hotfix/pr-45259
Your branch is up to date with 'origin/version-15-hotfix'.

You are currently cherry-picking commit 3a2e816759.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Changes to be committed:
	modified:   erpnext/stock/doctype/serial_and_batch_bundle/serial_and_batch_bundle.py

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/stock/doctype/delivery_note/test_delivery_note.py

```


To fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally

"
2786932529,pull_request,closed,,refactor: allow users to configure interval for Semi-Auto payment reconciliation (backport #45211),"# Limitation
Semi-Auto Payment Reconciliation was hard coded to run every 15 min processing only 5 unique `Process Payment Reconciliation` documents. Initial requirement was to handle small number of parties will large volume of unreconciled invoices.

But, for the inverse scenario - thousands of parties but only a dozen or so unreconciled invoices, this interval and queue size is not ideal.

# Solution
Making Trigger interval and Queue size configurable.

ToDo:
- [x] better field names(?)


upstream dependency: https://github.com/frappe/frappe/pull/29122<hr>This is an automatic backport of pull request #45211 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-14 11:46:51+00:00,['ruthra-kumar'],2025-01-31 00:10:22+00:00,2025-01-14 12:05:56+00:00,https://github.com/frappe/erpnext/pull/45267,"[('accounts', ''), ('needs-tests', 'This PR needs automated unit-tests.')]",[],
2786703021,pull_request,closed,,refactor: configurable reconciliation dates for Advance Payments (backport #45182),"`Advance Payments` (booked in separate party account) can be configured to have it's reconciliation take effect on the date of reconciliation.

todo:
- [x] Test cases
- [x] store reconciliation dates on references; helps on reposting

Deprecated checkbox will be dropped in a later release.<hr>This is an automatic backport of pull request #45182 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-14 09:50:53+00:00,['ruthra-kumar'],2025-01-29 00:10:15+00:00,2025-01-14 11:27:57+00:00,https://github.com/frappe/erpnext/pull/45265,"[('accounts', '')]","[{'comment_id': 2589468037, 'issue_id': 2786703021, 'author': 'mergify[bot]', 'body': 'Cherry-pick of 8b2c981fc3241a6cd48663e80089993e02adff76 has failed:\n```\nOn branch mergify/bp/version-15-hotfix/pr-45182\nYour branch is up to date with \'origin/version-15-hotfix\'.\n\nYou are currently cherry-picking commit 8b2c981fc3.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nChanges to be committed:\n\tmodified:   erpnext/accounts/doctype/payment_entry/payment_entry.json\n\tmodified:   erpnext/setup/doctype/company/company.json\n\tmodified:   erpnext/setup/doctype/company/company.py\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/accounts/doctype/payment_entry/payment_entry.py\n\n```\n\n\nCherry-pick of a8a8ac71b62b14617cb19ef8ca2596c77a56fac9 has failed:\n```\nOn branch mergify/bp/version-15-hotfix/pr-45182\nYour branch is ahead of \'origin/version-15-hotfix\' by 1 commit.\n  (use ""git push"" to publish your local commits)\n\nYou are currently cherry-picking commit a8a8ac71b6.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nChanges to be committed:\n\tnew file:   erpnext/patches/v15_0/migrate_checkbox_to_select_for_reconciliation_effect.py\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/patches.txt\n\n```\n\n\nTo fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally', 'created_at': datetime.datetime(2025, 1, 14, 9, 50, 55, tzinfo=datetime.timezone.utc)}]","mergify[bot] (Issue Creator) on (2025-01-14 09:50:55 UTC): Cherry-pick of 8b2c981fc3241a6cd48663e80089993e02adff76 has failed:
```
On branch mergify/bp/version-15-hotfix/pr-45182
Your branch is up to date with 'origin/version-15-hotfix'.

You are currently cherry-picking commit 8b2c981fc3.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Changes to be committed:
	modified:   erpnext/accounts/doctype/payment_entry/payment_entry.json
	modified:   erpnext/setup/doctype/company/company.json
	modified:   erpnext/setup/doctype/company/company.py

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/accounts/doctype/payment_entry/payment_entry.py

```


Cherry-pick of a8a8ac71b62b14617cb19ef8ca2596c77a56fac9 has failed:
```
On branch mergify/bp/version-15-hotfix/pr-45182
Your branch is ahead of 'origin/version-15-hotfix' by 1 commit.
  (use ""git push"" to publish your local commits)

You are currently cherry-picking commit a8a8ac71b6.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Changes to be committed:
	new file:   erpnext/patches/v15_0/migrate_checkbox_to_select_for_reconciliation_effect.py

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/patches.txt

```


To fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally

"
2786669660,pull_request,closed,,chore: release v14,Automated weekly release.,frappe-pr-bot,2025-01-14 09:34:23+00:00,[],2025-01-30 00:10:16+00:00,2025-01-15 12:07:57+00:00,https://github.com/frappe/erpnext/pull/45264,"[('accounts', ''), ('released', None)]","[{'comment_id': 2592611020, 'issue_id': 2786669660, 'author': 'frappe-pr-bot', 'body': ':tada: This PR is included in version 14.79.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.79.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2025, 1, 15, 12, 9, 27, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot (Issue Creator) on (2025-01-15 12:09:27 UTC): :tada: This PR is included in version 14.79.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.79.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2786669655,pull_request,closed,,chore: release v15,Automated weekly release.,frappe-pr-bot,2025-01-14 09:34:23+00:00,[],2025-01-30 00:10:10+00:00,2025-01-15 12:27:26+00:00,https://github.com/frappe/erpnext/pull/45263,"[('stock', None)]",[],
2786644589,pull_request,closed,,fix: fetching items from blanket order to sales/purchase order,Resolved issue #44880 and implemented validation to prevent negative item quantities.,diptanilsaha,2025-01-14 09:22:19+00:00,[],2025-02-01 00:11:35+00:00,2025-01-17 11:23:07+00:00,https://github.com/frappe/erpnext/pull/45262,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2786536281,pull_request,closed,,fix: incorrect label in Item-wise sales register (backport #45260),introduced: https://github.com/frappe/erpnext/pull/44816<hr>This is an automatic backport of pull request #45260 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-14 08:26:10+00:00,['ruthra-kumar'],2025-01-29 00:10:17+00:00,2025-01-14 08:35:58+00:00,https://github.com/frappe/erpnext/pull/45261,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2786508440,pull_request,closed,,fix: incorrect label in Item-wise sales register,introduced: https://github.com/frappe/erpnext/pull/44816,ruthra-kumar,2025-01-14 08:09:51+00:00,[],2025-01-29 00:10:18+00:00,2025-01-14 08:25:21+00:00,https://github.com/frappe/erpnext/pull/45260,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-15-hotfix', '')]",[],
2786423575,pull_request,closed,,fix: incorrect valuation for sales return with different warhouse,"- Create the delivery note with batch
- Create the sales return with different warehouse
- Check the valuation rate it's showing zero ",rohitwaghchaure,2025-01-14 07:12:29+00:00,[],2025-01-29 00:10:12+00:00,2025-01-14 13:03:35+00:00,https://github.com/frappe/erpnext/pull/45259,"[('backport version-15-hotfix', '')]",[],
2786415606,pull_request,closed,,fix: auto fetch batch and serial no for draft stock transactions (backport #45241),"**Issue**

https://github.com/user-attachments/assets/77720323-43b9-478e-8144-86e458116177



**After Fix**

https://github.com/user-attachments/assets/9d52ab7c-aa1e-4afb-86ca-a0788da35277


<hr>This is an automatic backport of pull request #45241 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-14 07:06:34+00:00,['rohitwaghchaure'],2025-01-29 00:10:13+00:00,2025-01-14 13:03:09+00:00,https://github.com/frappe/erpnext/pull/45258,"[('accounts', ''), ('stock', None)]","[{'comment_id': 2589177062, 'issue_id': 2786415606, 'author': 'mergify[bot]', 'body': 'Cherry-pick of 88ab9be79c5e094769645b142e71c6e5a2241409 has failed:\n```\nOn branch mergify/bp/version-15-hotfix/pr-45241\nYour branch is up to date with \'origin/version-15-hotfix\'.\n\nYou are currently cherry-picking commit 88ab9be79c.\n  (fix conflicts and run ""git cherry-pick --continue"")\n  (use ""git cherry-pick --skip"" to skip this patch)\n  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)\n\nChanges to be committed:\n\tmodified:   erpnext/controllers/accounts_controller.py\n\tmodified:   erpnext/public/js/controllers/transaction.js\n\tmodified:   erpnext/stock/doctype/batch/batch.py\n\tmodified:   erpnext/stock/doctype/delivery_note/test_delivery_note.py\n\nUnmerged paths:\n  (use ""git add <file>..."" to mark resolution)\n\tboth modified:   erpnext/stock/get_item_details.py\n\n```\n\n\nTo fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally', 'created_at': datetime.datetime(2025, 1, 14, 7, 6, 36, tzinfo=datetime.timezone.utc)}]","mergify[bot] (Issue Creator) on (2025-01-14 07:06:36 UTC): Cherry-pick of 88ab9be79c5e094769645b142e71c6e5a2241409 has failed:
```
On branch mergify/bp/version-15-hotfix/pr-45241
Your branch is up to date with 'origin/version-15-hotfix'.

You are currently cherry-picking commit 88ab9be79c.
  (fix conflicts and run ""git cherry-pick --continue"")
  (use ""git cherry-pick --skip"" to skip this patch)
  (use ""git cherry-pick --abort"" to cancel the cherry-pick operation)

Changes to be committed:
	modified:   erpnext/controllers/accounts_controller.py
	modified:   erpnext/public/js/controllers/transaction.js
	modified:   erpnext/stock/doctype/batch/batch.py
	modified:   erpnext/stock/doctype/delivery_note/test_delivery_note.py

Unmerged paths:
  (use ""git add <file>..."" to mark resolution)
	both modified:   erpnext/stock/get_item_details.py

```


To fix up this pull request, you can check it out locally. See documentation: https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally

"
2786365670,pull_request,closed,,fix: change string to be able to translate (backport #45090),Backport to version-15<hr>This is an automatic backport of pull request #45090 done by [Mergify](https://mergify.com).,mergify[bot],2025-01-14 06:26:53+00:00,[],2025-01-29 00:10:19+00:00,2025-01-14 08:05:13+00:00,https://github.com/frappe/erpnext/pull/45257,[],[],
2786231369,pull_request,closed,,fix: don't create invoice if `current_invoice_start ` is in future (backport #45078),"Issue: [Support Ticket  - 27883](https://support.frappe.io/helpdesk/tickets/27883)

If `current_invoice_start` is in the future, then we don't need to create an invoice.<hr>This is an automatic backport of pull request #45078 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-14 04:43:31+00:00,[],2025-01-29 00:10:23+00:00,2025-01-14 05:13:19+00:00,https://github.com/frappe/erpnext/pull/45256,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2786220808,pull_request,closed,,fix: set billing and shipping address on change of company (backport #45074),"Issue: [Support Ticket  - 20620](https://support.frappe.io/helpdesk/tickets/20620)

In the Purchase Invoice, the shipping address was not updating when the company was changed.<hr>This is an automatic backport of pull request #45074 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-14 04:35:31+00:00,[],2025-01-29 00:10:24+00:00,2025-01-14 04:52:42+00:00,https://github.com/frappe/erpnext/pull/45255,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2786218550,pull_request,closed,,fix: deduct tds on excess amount if checked (backport #45001),"Issue: TDS gets deducted on the whole amount even if tax_on_excess_amount is checked in the tax withholding category.

If consider_party_ledger_amount is checked in the tax withholding category, the threshold is checked based on grand total of the invoice. But while checking tax_on_excess_amount, again threshold is checked based on the net amount of the invoice and if the threshold has not been breached tds is deducted from the whole amount.

Steps to replicate:
- Create a tax withholding category with cumulative threshold 10,00,000/-  and check tax_on_excess_amount and consider_party_ledger_amount.
- Create a supplier with the above category.
- Create a Purchase invoice with item amount 800000 and add taxes of 80,000.
- Create another Purchase Invoice with item amount 130000.


Before:
TDS will be deducted on 9,30,000 even though tax_on_excess_amount is checked.


Solution:
Do not deduct tax if the threshold has not breached the net amount total.


After: 
Tax will not be deducted because the threshold has not breached the net amount total.


Frappe Support Issue: https://support.frappe.io/app/hd-ticket/28268

backport-version-15
backport-version-14<hr>This is an automatic backport of pull request #45001 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-14 04:33:45+00:00,[],2025-01-29 00:10:25+00:00,2025-01-14 04:51:57+00:00,https://github.com/frappe/erpnext/pull/45254,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2786218043,pull_request,closed,,fix: deduct tds on excess amount if checked (backport #45001),"Issue: TDS gets deducted on the whole amount even if tax_on_excess_amount is checked in the tax withholding category.

If consider_party_ledger_amount is checked in the tax withholding category, the threshold is checked based on grand total of the invoice. But while checking tax_on_excess_amount, again threshold is checked based on the net amount of the invoice and if the threshold has not been breached tds is deducted from the whole amount.

Steps to replicate:
- Create a tax withholding category with cumulative threshold 10,00,000/-  and check tax_on_excess_amount and consider_party_ledger_amount.
- Create a supplier with the above category.
- Create a Purchase invoice with item amount 800000 and add taxes of 80,000.
- Create another Purchase Invoice with item amount 130000.


Before:
TDS will be deducted on 9,30,000 even though tax_on_excess_amount is checked.


Solution:
Do not deduct tax if the threshold has not breached the net amount total.


After: 
Tax will not be deducted because the threshold has not breached the net amount total.


Frappe Support Issue: https://support.frappe.io/app/hd-ticket/28268

backport-version-15
backport-version-14<hr>This is an automatic backport of pull request #45001 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-14 04:33:11+00:00,[],2025-01-30 00:10:15+00:00,2025-01-14 04:58:20+00:00,https://github.com/frappe/erpnext/pull/45253,"[('needs-tests', 'This PR needs automated unit-tests.'), ('released', None)]","[{'comment_id': 2592611170, 'issue_id': 2786218043, 'author': 'frappe-pr-bot', 'body': ':tada: This PR is included in version 14.79.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.79.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2025, 1, 15, 12, 9, 30, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2025-01-15 12:09:30 UTC): :tada: This PR is included in version 14.79.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.79.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2786213807,pull_request,closed,,fix: update  discounting on mixed conditions (backport #44798),"Issue:
The rate is not updating properly on other items when the mixed condition is enabled

ref: [20888](https://support.frappe.io/helpdesk/tickets/20888)
reverting this  #43064  due to regression

**Solution:** updating fields based on rate_or_discount in Pricing Rule
**Before:**

[Screencast from 24-12-24 01:51:39 PM IST.webm](https://github.com/user-attachments/assets/8df38f55-c319-4b66-9797-503df6908f39)

**After:**

[Screencast from 24-12-24 01:53:56 PM IST.webm](https://github.com/user-attachments/assets/9823926f-1d5e-4afd-a376-60db467617a1)


Backport needed for v15

<hr>This is an automatic backport of pull request #44798 done by [Mergify](https://mergify.com).",mergify[bot],2025-01-14 04:29:09+00:00,[],2025-01-29 00:10:27+00:00,2025-01-14 04:39:52+00:00,https://github.com/frappe/erpnext/pull/45252,[],[],
2785310949,pull_request,open,,refactor: Asset module code for better readability,"# Asset Module Refactor PR

This PR refactors the asset module to improve code structure, fix bugs, and enhance maintainability. Testing is a priority to ensure no regressions are introduced.

## Refactoring Tasks
### Asset Repair
- [x] Asset Repair Depreciation
- [x] Asset Repair (UI)
- [ ] Test cases

### Asset Value Adjustment
- [x] Refactored and improved logic
- [ ] Test cases

### Depreciation Methods
- [x] Shift-Based Depreciation
- [x] Straight-Line Method (70%)
- [x] Daily Pro-Rata Depreciation
- [x] Written Down Value Method
- [x] Journal Entry for Depreciation
- [ ] Test cases

### Asset Disposal
- [x] Asset Selling
- [x] Scraping Asset
- [ ] Test cases

### Asset Splitting and Shift Allocation
- [x] Code cleanup and improvements
- [ ] Test cases

### Asset Capitalization
- [ ] Code cleanup and improvements
- [ ] Test cases

### Misc
- [ ] Fix failing test cases (In progress)
- [ ] Write additional test cases for better coverage (focus on edge cases)
- [ ] Update documentation to reflect changes in the refactored code",khushi8112,2025-01-13 20:27:02+00:00,[],2025-02-05 16:34:42+00:00,,https://github.com/frappe/erpnext/pull/45251,[],[],
2784849868,pull_request,closed,,fix: sync translations from crowdin,,frappe-pr-bot,2025-01-13 18:09:58+00:00,['ruthra-kumar'],2025-01-29 00:10:22+00:00,2025-01-14 05:47:27+00:00,https://github.com/frappe/erpnext/pull/45249,"[('translation', None)]",[],
2784426734,pull_request,closed,,chore: consider currency precision in bank clearance,`no-docs`,niyazrazak,2025-01-13 15:54:25+00:00,['ruthra-kumar'],2025-02-07 00:10:28+00:00,2025-01-23 11:27:28+00:00,https://github.com/frappe/erpnext/pull/45248,"[('needs-tests', 'This PR needs automated unit-tests.')]","[{'comment_id': 2606540365, 'issue_id': 2784426734, 'author': 'niyazrazak', 'body': '@ruthra-kumar ðŸ‘€', 'created_at': datetime.datetime(2025, 1, 22, 8, 4, 59, tzinfo=datetime.timezone.utc)}]","niyazrazak (Issue Creator) on (2025-01-22 08:04:59 UTC): @ruthra-kumar ðŸ‘€

"
2784221377,pull_request,closed,,feat: show item name alongside item code in the update items dialog,"
### PR Description:
This update addresses the ux issue by displaying the item name next to the item code in the ""update items"" dialog. users no longer need to hover over the item code to see the name.


fixes #45245  (Partially resolved for the Update Items dialog)
### **Demo Video**

[Screencast from 13-01-25 08:22:32 PM IST.webm](https://github.com/user-attachments/assets/2a503438-34a7-4096-85b2-4cd68431b8e4)

`no-docs`
",UmakanthKaspa,2025-01-13 14:54:15+00:00,['ruthra-kumar'],2025-02-03 11:23:21+00:00,2025-02-03 11:23:21+00:00,https://github.com/frappe/erpnext/pull/45247,[],[],
2783716622,pull_request,closed,,fix: Skip WIP Warehouse transfer,"Reference support ticket: [29053](https://support.frappe.io/helpdesk/tickets/29053)

WIP warehouse field was not being removed even when ""Skip Material Transfer to WIP Warehouse"" was enabled. This simple PR fixes that.

`no-docs`",mihir-kandoi,2025-01-13 11:36:29+00:00,[],2025-01-30 00:10:24+00:00,2025-01-15 08:21:15+00:00,https://github.com/frappe/erpnext/pull/45244,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
2783708007,pull_request,closed,,fix: include pos invoice in modifing key for returned item validation,"**Issue:**
 get_ref_item_dict return key in `(item_code, name)` format, but since the POS Invoice is not part of the validation, `item_code` is compared with `(item_code, name)`
**ref:** [29094](https://support.frappe.io/helpdesk/tickets/29094)

**Before:**

https://github.com/user-attachments/assets/3b0ec642-807e-4c66-a90c-3e5147e95010

**After:**

https://github.com/user-attachments/assets/7790d998-537f-4c6f-8ec4-aa52f02966d8

**Backport needed for v14 & v15**",venkat102,2025-01-13 11:32:19+00:00,['ruthra-kumar'],2025-02-05 00:10:27+00:00,2025-01-21 11:04:59+00:00,https://github.com/frappe/erpnext/pull/45242,"[('needs-tests', 'This PR needs automated unit-tests.'), ('backport version-14-hotfix', 'backport to version 14'), ('backport version-15-hotfix', '')]",[],
2783673195,pull_request,closed,,fix: auto fetch batch and serial no for draft stock transactions,"**Issue**

https://github.com/user-attachments/assets/77720323-43b9-478e-8144-86e458116177



**After Fix**

https://github.com/user-attachments/assets/9d52ab7c-aa1e-4afb-86ca-a0788da35277


",rohitwaghchaure,2025-01-13 11:15:31+00:00,[],2025-01-29 00:10:20+00:00,2025-01-14 07:05:17+00:00,https://github.com/frappe/erpnext/pull/45241,"[('accounts', ''), ('stock', None), ('backport version-15-hotfix', '')]",[],
2783485422,pull_request,closed,,chore: quickbooks migrator integration removal,Removal of QuickBooks Migrator Feature from ERPNext Integration.,diptanilsaha,2025-01-13 09:50:13+00:00,[],2025-02-01 00:11:34+00:00,2025-01-17 11:23:36+00:00,https://github.com/frappe/erpnext/pull/45240,"[('backport version-15-hotfix', '')]",[],
2783387454,pull_request,closed,,fix: get invoice without apply_tds when Consider Entire Party Ledger Amount is enabled,"**Issue:**
when Consider Entire Party Ledger Amount is ticked in the tds category, invoices without apply_tds are not fetched
**ref:** [29142](https://support.frappe.io/helpdesk/tickets/29142)

**Tax Withholding Category:**
![image](https://github.com/user-attachments/assets/669de45a-2836-4c5f-9954-9af34c8ade23)

**Before:**

https://github.com/user-attachments/assets/adeba8b0-7298-4506-83ba-3e5615a90d60

**After:** 

https://github.com/user-attachments/assets/b9205b80-74c7-4096-b9d7-10abe260b146

**Backport needed for v14 & v15**",venkat102,2025-01-13 09:04:47+00:00,[],2025-01-30 00:10:26+00:00,2025-01-15 04:37:47+00:00,https://github.com/frappe/erpnext/pull/45239,"[('needs-tests', 'This PR needs automated unit-tests.')]",[],
