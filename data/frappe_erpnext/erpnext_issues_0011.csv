id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2242003612,issue,open,,"Would like to have a possibility to add ""waiting times"" in my manufacturing process","
**Is your feature request related to a problem? Please describe.**

I'm always frustrated when I deal with manufacturing items which have waiting times

**Describe the solution you'd like**
1. Possibility to add ""something"" which covers the waiting time, ""something"" could be actually a job card, just don't need an employee.
2. Functionality which brings the corresponding work order in a ""wait"" state and wake up the work order at the correct time
3. Optional: Coz of loosing the overview if there are many work order and job cards open <- a (maybe the above mentioned) ""waiting state"", for filtering .... like in progress (with employees), waiting (without employees)

**Describe alternatives you've considered**
Using normal Jobcards, creating fake employee's, adding custom fields to simulate waitings in Jobcards and work orders

",schmutzfuss42,2024-04-14 06:35:45+00:00,[],2024-04-14 07:03:18+00:00,,https://github.com/frappe/erpnext/issues/40999,"[('feature-request', None)]",[],
2241660620,issue,closed,completed,Trend Report issue in loading the report,"### Information about bug

when trying to open one of the ""Trend"" reports for example like ""Sales Invoice Trends"", ""Sales Order Trends"",  ""Purchase Order Trends""...and the rest.
some times it will load fine, and some times it will give the below error.
take note I did not remove the fiscal year this is the first load for the report. you need to reload the page couple of times so it will load the page fully. 

Maybe the system is trying to load the report before building the fiscal year field filter

![image](https://github.com/frappe/erpnext/assets/29341232/d219ca17-bd03-4d45-859a-1cd16a89a91a)

here when it load fine:

![image](https://github.com/frappe/erpnext/assets/29341232/222b62e6-e158-4da1-912d-bb13fde323f9)

so it seam the system is trying to load the report before building the fiscal year filter


### Module

other

### Version

Email Delivery Service: v0.0.1 (HEAD)

ERPNext: v15.18.3 (HEAD)

Frappe Framework: v15.20.0 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1718, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 878, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/query_report.py"", line 219, in run
    result = generate_report_result(report, filters, user, custom_columns, is_tree, parent_field)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 878, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/query_report.py"", line 81, in generate_report_result
    res = get_report_result(report, filters) or []
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/query_report.py"", line 62, in get_report_result
    res = report.execute_script_report(filters)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/core/doctype/report/report.py"", line 162, in execute_script_report
    res = self.execute_module(filters)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/core/doctype/report/report.py"", line 179, in execute_module
    return frappe.get_attr(method_name)(frappe._dict(filters))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/selling/report/sales_order_trends/sales_order_trends.py"", line 14, in execute
    conditions = get_columns(filters, ""Sales Order"")
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/controllers/trends.py"", line 11, in get_columns
    validate_filters(filters)
  File ""apps/erpnext/erpnext/controllers/trends.py"", line 50, in validate_filters
    frappe.throw(_(""{0} is mandatory"").format(f))
  File ""apps/frappe/frappe/__init__.py"", line 602, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 567, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 518, in _raise_exception
    raise exc
frappe.exceptions.ValidationError: Fiscal Year is mandatory",moaazmf90,2024-04-13 17:10:12+00:00,[],2024-06-14 00:08:37+00:00,2024-05-20 09:16:00+00:00,https://github.com/frappe/erpnext/issues/40998,"[('bug', None)]","[{'comment_id': 2095625360, 'issue_id': 2241660620, 'author': 'donnieferdian', 'body': 'Same Problem,\r\n\r\n```\r\nTraceback with variables (most recent call last):\r\n  File ""apps/frappe/frappe/desk/query_report.py"", line 220, in run\r\n    result = generate_report_result(report, filters, user, custom_columns, is_tree, parent_field)\r\n      report_name = \'Sales Invoice Trends\'\r\n      filters = \'{}\'\r\n      user = \'admin@example.com\'\r\n      ignore_prepared_report = \'false\'\r\n      custom_columns = None\r\n      is_tree = False\r\n      parent_field = None\r\n      are_default_filters = \'true\'\r\n      report = <Report: Sales Invoice Trends>\r\n      result = None\r\n  File ""apps/frappe/frappe/__init__.py"", line 921, in wrapper_fn\r\n    retval = fn(*args, **get_newargs(fn, kwargs))\r\n      args = (<Report: Sales Invoice Trends>, \'{}\', \'admin@example.com\', None, False, None)\r\n      kwargs = {}\r\n      switched_connection = False\r\n      fn = <function generate_report_result at 0x7fa6f53437e0>\r\n  File ""apps/frappe/frappe/desk/query_report.py"", line 81, in generate_report_result\r\n    res = get_report_result(report, filters) or []\r\n      report = <Report: Sales Invoice Trends>\r\n      filters = {}\r\n      user = \'admin@example.com\'\r\n      custom_columns = None\r\n      is_tree = False\r\n      parent_field = None\r\n  File ""apps/frappe/frappe/desk/query_report.py"", line 62, in get_report_result\r\n    res = report.execute_script_report(filters)\r\n      report = <Report: Sales Invoice Trends>\r\n      filters = {}\r\n      res = None\r\n  File ""apps/frappe/frappe/core/doctype/report/report.py"", line 162, in execute_script_report\r\n    res = self.execute_module(filters)\r\n      self = <Report: Sales Invoice Trends>\r\n      filters = {}\r\n      threshold = 15\r\n      res = []\r\n      start_time = datetime.datetime(2024, 5, 6, 17, 49, 27, 97106)\r\n  File ""apps/frappe/frappe/core/doctype/report/report.py"", line 179, in execute_module\r\n    return frappe.get_attr(method_name)(frappe._dict(filters))\r\n      self = <Report: Sales Invoice Trends>\r\n      filters = {}\r\n      module = \'Accounts\'\r\n      method_name = \'erpnext.accounts.report.sales_invoice_trends.sales_invoice_trends.execute\'\r\n  File ""apps/erpnext/erpnext/accounts/report/sales_invoice_trends/sales_invoice_trends.py"", line 12, in execute\r\n    conditions = get_columns(filters, ""Sales Invoice"")\r\n      filters = {}\r\n      data = []\r\n  File ""apps/erpnext/erpnext/controllers/trends.py"", line 11, in get_columns\r\n    validate_filters(filters)\r\n      filters = {}\r\n      trans = \'Sales Invoice\'\r\n  File ""apps/erpnext/erpnext/controllers/trends.py"", line 50, in validate_filters\r\n    frappe.throw(_(""{0} is mandatory"").format(f))\r\n      filters = {}\r\n      f = \'Fiscal Year\'\r\n  File ""apps/frappe/frappe/__init__.py"", line 645, in throw\r\n    msgprint(\r\n      msg = \'Fiscal Year is mandatory\'\r\n      exc = <class \'frappe.exceptions.ValidationError\'>\r\n      title = None\r\n      is_minimizable = False\r\n      wide = False\r\n      as_list = False\r\n      primary_action = None\r\n  File ""apps/frappe/frappe/__init__.py"", line 610, in msgprint\r\n    _raise_exception()\r\n      msg = \'Fiscal Year is mandatory\'\r\n      title = None\r\n      raise_exception = <class \'frappe.exceptions.ValidationError\'>\r\n      as_table = False\r\n      as_list = False\r\n      indicator = \'red\'\r\n      alert = False\r\n      primary_action = None\r\n      is_minimizable = False\r\n      wide = False\r\n      realtime = False\r\n      sys = <module \'sys\' (built-in)>\r\n      _raise_exception = <function msgprint.<locals>._raise_exception at 0x7fa6f5102f20>\r\n      inspect = <module \'inspect\' from \'/usr/lib/python3.11/inspect.py\'>\r\n      out = {\'message\': \'Fiscal Year is mandatory\', \'title\': \'Message\', \'indicator\': \'red\', \'raise_exception\': 1, \'__frappe_exc_id\': \'939991e034644daf5a2677ea11fae756420567d49c2ee2f0607c146b\'}\r\n  File ""apps/frappe/frappe/__init__.py"", line 561, in _raise_exception\r\n    raise exc\r\n      exc = ValidationError(\'Fiscal Year is mandatory\')\r\n      inspect = <module \'inspect\' from \'/usr/lib/python3.11/inspect.py\'>\r\n      msg = \'Fiscal Year is mandatory\'\r\n      out = {\'message\': \'Fiscal Year is mandatory\', \'title\': \'Message\', \'indicator\': \'red\', \'raise_exception\': 1, \'__frappe_exc_id\': \'939991e034644daf5a2677ea11fae756420567d49c2ee2f0607c146b\'}\r\n      raise_exception = <class \'frappe.exceptions.ValidationError\'>\r\nfrappe.exceptions.ValidationError: Fiscal Year is mandatory\r\n```\r\n\r\n@deepeshgarg007   @ruthra-kumar', 'created_at': datetime.datetime(2024, 5, 6, 10, 8, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2110493768, 'issue_id': 2241660620, 'author': 'oguzbilgic', 'body': 'Feedback: Not able to view ""Sales Order Trend"" report. Even after setting FY in session defaults.', 'created_at': datetime.datetime(2024, 5, 14, 15, 10, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2117241639, 'issue_id': 2241660620, 'author': 'Sunil-Codes', 'body': 'Same issue facing not able to load any trend report this issue is with every trend report', 'created_at': datetime.datetime(2024, 5, 17, 10, 20, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2120029486, 'issue_id': 2241660620, 'author': 'Nihantra-Patel', 'body': 'Issue has been fixed: https://github.com/frappe/erpnext/pull/41544\r\n\r\nUpcoming update will resolve your issue.', 'created_at': datetime.datetime(2024, 5, 20, 9, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2139523361, 'issue_id': 2241660620, 'author': 'Nihantra-Patel', 'body': 'Tested, worked properly.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/d9a9cc15-b9d8-4a91-84f8-0b8ae18df166', 'created_at': datetime.datetime(2024, 5, 30, 13, 9, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2139529814, 'issue_id': 2241660620, 'author': 'pro-nature', 'body': 'Yes. Bench Build fixed the issue. Thanks', 'created_at': datetime.datetime(2024, 5, 30, 13, 13, 20, tzinfo=datetime.timezone.utc)}]","donnieferdian on (2024-05-06 10:08:22 UTC): Same Problem,

```
Traceback with variables (most recent call last):
  File ""apps/frappe/frappe/desk/query_report.py"", line 220, in run
    result = generate_report_result(report, filters, user, custom_columns, is_tree, parent_field)
      report_name = 'Sales Invoice Trends'
      filters = '{}'
      user = 'admin@example.com'
      ignore_prepared_report = 'false'
      custom_columns = None
      is_tree = False
      parent_field = None
      are_default_filters = 'true'
      report = <Report: Sales Invoice Trends>
      result = None
  File ""apps/frappe/frappe/__init__.py"", line 921, in wrapper_fn
    retval = fn(*args, **get_newargs(fn, kwargs))
      args = (<Report: Sales Invoice Trends>, '{}', 'admin@example.com', None, False, None)
      kwargs = {}
      switched_connection = False
      fn = <function generate_report_result at 0x7fa6f53437e0>
  File ""apps/frappe/frappe/desk/query_report.py"", line 81, in generate_report_result
    res = get_report_result(report, filters) or []
      report = <Report: Sales Invoice Trends>
      filters = {}
      user = 'admin@example.com'
      custom_columns = None
      is_tree = False
      parent_field = None
  File ""apps/frappe/frappe/desk/query_report.py"", line 62, in get_report_result
    res = report.execute_script_report(filters)
      report = <Report: Sales Invoice Trends>
      filters = {}
      res = None
  File ""apps/frappe/frappe/core/doctype/report/report.py"", line 162, in execute_script_report
    res = self.execute_module(filters)
      self = <Report: Sales Invoice Trends>
      filters = {}
      threshold = 15
      res = []
      start_time = datetime.datetime(2024, 5, 6, 17, 49, 27, 97106)
  File ""apps/frappe/frappe/core/doctype/report/report.py"", line 179, in execute_module
    return frappe.get_attr(method_name)(frappe._dict(filters))
      self = <Report: Sales Invoice Trends>
      filters = {}
      module = 'Accounts'
      method_name = 'erpnext.accounts.report.sales_invoice_trends.sales_invoice_trends.execute'
  File ""apps/erpnext/erpnext/accounts/report/sales_invoice_trends/sales_invoice_trends.py"", line 12, in execute
    conditions = get_columns(filters, ""Sales Invoice"")
      filters = {}
      data = []
  File ""apps/erpnext/erpnext/controllers/trends.py"", line 11, in get_columns
    validate_filters(filters)
      filters = {}
      trans = 'Sales Invoice'
  File ""apps/erpnext/erpnext/controllers/trends.py"", line 50, in validate_filters
    frappe.throw(_(""{0} is mandatory"").format(f))
      filters = {}
      f = 'Fiscal Year'
  File ""apps/frappe/frappe/__init__.py"", line 645, in throw
    msgprint(
      msg = 'Fiscal Year is mandatory'
      exc = <class 'frappe.exceptions.ValidationError'>
      title = None
      is_minimizable = False
      wide = False
      as_list = False
      primary_action = None
  File ""apps/frappe/frappe/__init__.py"", line 610, in msgprint
    _raise_exception()
      msg = 'Fiscal Year is mandatory'
      title = None
      raise_exception = <class 'frappe.exceptions.ValidationError'>
      as_table = False
      as_list = False
      indicator = 'red'
      alert = False
      primary_action = None
      is_minimizable = False
      wide = False
      realtime = False
      sys = <module 'sys' (built-in)>
      _raise_exception = <function msgprint.<locals>._raise_exception at 0x7fa6f5102f20>
      inspect = <module 'inspect' from '/usr/lib/python3.11/inspect.py'>
      out = {'message': 'Fiscal Year is mandatory', 'title': 'Message', 'indicator': 'red', 'raise_exception': 1, '__frappe_exc_id': '939991e034644daf5a2677ea11fae756420567d49c2ee2f0607c146b'}
  File ""apps/frappe/frappe/__init__.py"", line 561, in _raise_exception
    raise exc
      exc = ValidationError('Fiscal Year is mandatory')
      inspect = <module 'inspect' from '/usr/lib/python3.11/inspect.py'>
      msg = 'Fiscal Year is mandatory'
      out = {'message': 'Fiscal Year is mandatory', 'title': 'Message', 'indicator': 'red', 'raise_exception': 1, '__frappe_exc_id': '939991e034644daf5a2677ea11fae756420567d49c2ee2f0607c146b'}
      raise_exception = <class 'frappe.exceptions.ValidationError'>
frappe.exceptions.ValidationError: Fiscal Year is mandatory
```

@deepeshgarg007   @ruthra-kumar

oguzbilgic on (2024-05-14 15:10:01 UTC): Feedback: Not able to view ""Sales Order Trend"" report. Even after setting FY in session defaults.

Sunil-Codes on (2024-05-17 10:20:28 UTC): Same issue facing not able to load any trend report this issue is with every trend report

Nihantra-Patel on (2024-05-20 09:16:00 UTC): Issue has been fixed: https://github.com/frappe/erpnext/pull/41544

Upcoming update will resolve your issue.

Nihantra-Patel on (2024-05-30 13:09:48 UTC): Tested, worked properly.


https://github.com/frappe/erpnext/assets/141945075/d9a9cc15-b9d8-4a91-84f8-0b8ae18df166

pro-nature on (2024-05-30 13:13:20 UTC): Yes. Bench Build fixed the issue. Thanks

"
2241625538,issue,closed,completed,Split Asset Quantity Error (not functional),"### Information about bug

1. create an asset with quantity. (4 as example).
2. save and submit the asset.
3. select the asset > manage > split asset.
4. input some quantity.
5. click split  = the below error will appear.

note: the asset will not be split.

### Module

assets

### Version

Email Delivery Service: v0.0.1 (HEAD)
ERPNext: v15.18.3 (HEAD)
Frappe Framework: v15.20.0 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""email_delivery_service"": ""0.0.1"",
	""erpnext"": ""15.18.3"",
	""frappe"": ""15.20.0""
}
```
### Route
```
Form/Asset/ACC-ASS-2024-00001
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1718, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/assets/doctype/asset/asset.py"", line 1057, in split_asset
    new_asset = create_new_asset_after_split(asset, split_qty)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/assets/doctype/asset/asset.py"", line 1171, in create_new_asset_after_split
    new_asset_depr_schedule_doc = frappe.copy_doc(current_asset_depr_schedule_doc)
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1834, in copy_doc
    d = doc.as_dict()
        ^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'as_dict'

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""asset_name"": ""ACC-ASS-2024-00001"",
		""split_qty"": 1
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/erpnext.assets.doctype.asset.asset.split_asset"",
	""request_id"": ""393c06ba-af3d-4c4e-b1fd-d22d9a1d688d""
}
```
### Response Data
```
{
	""exception"": ""AttributeError: 'NoneType' object has no attribute 'as_dict'"",
	""exc_type"": ""AttributeError"",
	""_exc_source"": ""erpnext (app)""
}
```
```
",moaazmf90,2024-04-13 15:33:01+00:00,[],2024-06-22 00:08:59+00:00,2024-06-04 09:35:42+00:00,https://github.com/frappe/erpnext/issues/40995,"[('bug', None), ('released', None)]","[{'comment_id': 2148688110, 'issue_id': 2241625538, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.27.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.27.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 6, 5, 1, 22, 24, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-06-05 01:22:24 UTC): :tada: This issue has been resolved in version 15.27.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.27.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2240812492,issue,open,,Add fields for First Name and Last Name in the New Customer dialog,"**Is your feature request related to a problem? Please describe.**
This is related to Issue #9854. Please reopen Issue #9854.

**Describe the solution you'd like**
Would like to have Full Name renamed to Company Name and add two more fields: First Name and Last Name during Customer creation.

**Describe alternatives you've considered**
See: https://github.com/frappe/erpnext/issues/9854#issue-242817403

**Additional context**
See: https://github.com/frappe/erpnext/issues/9854#issue-242817403",NassimBentarka,2024-04-12 20:00:14+00:00,[],2024-04-12 20:00:14+00:00,,https://github.com/frappe/erpnext/issues/40989,"[('feature-request', None)]",[],
2239663631,issue,closed,completed,Date Range wrong at Balance Sheet,"### Information about bug

![image](https://github.com/frappe/erpnext/assets/62122640/e79584cb-252a-4362-a78e-771b6e52f371)
Start / End Date is showing current fiscal year

### Module

accounts

### Version

![image](https://github.com/frappe/erpnext/assets/62122640/4222c232-8711-44b2-b270-2305a22b7f3f)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-04-12 10:06:03+00:00,[],2024-12-28 00:10:19+00:00,2024-12-13 10:08:39+00:00,https://github.com/frappe/erpnext/issues/40984,"[('bug', None)]","[{'comment_id': 2074627522, 'issue_id': 2239663631, 'author': 'Poorvi-R-Bhat', 'body': 'Balance Sheet Report is showing the proper Fiscal Year based on the Fiscal Year set. \r\n![image](https://github.com/frappe/erpnext/assets/27720465/38730597-41f9-40da-b412-6194872ad80c)\r\n\r\nFilter Based on Date Range ( Start Date and End Date) is also showing properly\r\n![image](https://github.com/frappe/erpnext/assets/27720465/39ae63fb-318a-4c2a-890f-5636d75f55e9)\r\n\r\n**Fiscal Year DocType**\r\n![image](https://github.com/frappe/erpnext/assets/27720465/43345693-b4e1-463e-b291-1409279e728f)\r\n\r\nNeed the steps to replicate the issue.', 'created_at': datetime.datetime(2024, 4, 24, 10, 27, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2074861914, 'issue_id': 2239663631, 'author': 'thida-bcn', 'body': 'Fiscal Year\r\n![image](https://github.com/frappe/erpnext/assets/62122640/b874c3bd-72e1-48a9-a4fe-0524b5187767)\r\nBalance Sheet\r\n![image](https://github.com/frappe/erpnext/assets/62122640/836fe32d-7cc8-4673-badf-3c6513680d17)\r\nReport\r\n![image](https://github.com/frappe/erpnext/assets/62122640/d9de74a9-230b-455e-bda2-8744d62b1f18)\r\nFor Date what we had been chosen were under FS 2023-2024\r\nReport should show\r\nStart Year - 2023-2024\r\nEnd Year - 2023-2024', 'created_at': datetime.datetime(2024, 4, 24, 12, 43, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2076342794, 'issue_id': 2239663631, 'author': 'Poorvi-R-Bhat', 'body': 'Though the Date Range is proper in the Balance Sheet Report, In the Prepared report, it shows the wrong Fiscal Year.\r\n**Balance Sheet Report Date Range:**\r\n![image](https://github.com/frappe/erpnext/assets/27720465/7486da22-586e-4f6a-858d-1874ea4ecdbc)\r\n\r\n**Prepared Report:**\r\n![image](https://github.com/frappe/erpnext/assets/27720465/839b3835-6d5b-4c3e-9e8f-e3c8cc580719)', 'created_at': datetime.datetime(2024, 4, 25, 4, 37, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147055211, 'issue_id': 2239663631, 'author': 'nabinhait', 'body': 'Even though From Fiscal Year is showing wrong year, it does not use while running the report. It uses actual from and to dates if ""Filter Based On"" is ""Date Range"".', 'created_at': datetime.datetime(2024, 6, 4, 9, 30, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147095722, 'issue_id': 2239663631, 'author': 'thida-bcn', 'body': 'there was still issue with pick column\r\nfor end user ""presentation"" is very important, they just know what they see\r\n![image](https://github.com/frappe/erpnext/assets/62122640/e0e07ba7-20cb-4332-9771-6f61c5702902)\r\n\r\nhttps://github.com/frappe/erpnext/assets/62122640/2da08266-ffd7-47c4-a40a-71d1df7d221f', 'created_at': datetime.datetime(2024, 6, 4, 9, 45, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2220851963, 'issue_id': 2239663631, 'author': 'thida-bcn', 'body': '@rmehta \r\nhello sir, help me check\r\nthanks', 'created_at': datetime.datetime(2024, 7, 10, 15, 37, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2540960606, 'issue_id': 2239663631, 'author': 'ljain112', 'body': 'Fixed: https://github.com/frappe/frappe/pull/28331', 'created_at': datetime.datetime(2024, 12, 13, 9, 20, 9, tzinfo=datetime.timezone.utc)}]","Poorvi-R-Bhat on (2024-04-24 10:27:33 UTC): Balance Sheet Report is showing the proper Fiscal Year based on the Fiscal Year set. 
![image](https://github.com/frappe/erpnext/assets/27720465/38730597-41f9-40da-b412-6194872ad80c)

Filter Based on Date Range ( Start Date and End Date) is also showing properly
![image](https://github.com/frappe/erpnext/assets/27720465/39ae63fb-318a-4c2a-890f-5636d75f55e9)

**Fiscal Year DocType**
![image](https://github.com/frappe/erpnext/assets/27720465/43345693-b4e1-463e-b291-1409279e728f)

Need the steps to replicate the issue.

thida-bcn (Issue Creator) on (2024-04-24 12:43:53 UTC): Fiscal Year
![image](https://github.com/frappe/erpnext/assets/62122640/b874c3bd-72e1-48a9-a4fe-0524b5187767)
Balance Sheet
![image](https://github.com/frappe/erpnext/assets/62122640/836fe32d-7cc8-4673-badf-3c6513680d17)
Report
![image](https://github.com/frappe/erpnext/assets/62122640/d9de74a9-230b-455e-bda2-8744d62b1f18)
For Date what we had been chosen were under FS 2023-2024
Report should show
Start Year - 2023-2024
End Year - 2023-2024

Poorvi-R-Bhat on (2024-04-25 04:37:32 UTC): Though the Date Range is proper in the Balance Sheet Report, In the Prepared report, it shows the wrong Fiscal Year.
**Balance Sheet Report Date Range:**
![image](https://github.com/frappe/erpnext/assets/27720465/7486da22-586e-4f6a-858d-1874ea4ecdbc)

**Prepared Report:**
![image](https://github.com/frappe/erpnext/assets/27720465/839b3835-6d5b-4c3e-9e8f-e3c8cc580719)

nabinhait on (2024-06-04 09:30:58 UTC): Even though From Fiscal Year is showing wrong year, it does not use while running the report. It uses actual from and to dates if ""Filter Based On"" is ""Date Range"".

thida-bcn (Issue Creator) on (2024-06-04 09:45:49 UTC): there was still issue with pick column
for end user ""presentation"" is very important, they just know what they see
![image](https://github.com/frappe/erpnext/assets/62122640/e0e07ba7-20cb-4332-9771-6f61c5702902)

https://github.com/frappe/erpnext/assets/62122640/2da08266-ffd7-47c4-a40a-71d1df7d221f

thida-bcn (Issue Creator) on (2024-07-10 15:37:23 UTC): @rmehta 
hello sir, help me check
thanks

ljain112 on (2024-12-13 09:20:09 UTC): Fixed: https://github.com/frappe/frappe/pull/28331

"
2239241297,issue,closed,completed,Production plan summary is not updating with completed purchase order quantity,"### Information about bug

after making purchase order complete production plan summary is not updating completed purchase order quantity

### Module

manufacturing

### Version

ERP next version 15

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",alwinmartis,2024-04-12 07:03:53+00:00,[],2024-05-09 00:08:34+00:00,2024-04-23 05:14:06+00:00,https://github.com/frappe/erpnext/issues/40977,"[('bug', None)]","[{'comment_id': 2071423066, 'issue_id': 2239241297, 'author': 'Nihantra-Patel', 'body': 'When the final stock entry for manufacturing is made from the work order, the Produced/Received Quantity and Pending Quantity will be updated. However, these updates are not based on the Purchase Order quantity.\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/f959d4d2-199b-4d4b-a0f2-a664752db048)', 'created_at': datetime.datetime(2024, 4, 23, 5, 14, 6, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-04-23 05:14:06 UTC): When the final stock entry for manufacturing is made from the work order, the Produced/Received Quantity and Pending Quantity will be updated. However, these updates are not based on the Purchase Order quantity.

![image](https://github.com/frappe/erpnext/assets/141945075/f959d4d2-199b-4d4b-a0f2-a664752db048)

"
2239142435,issue,closed,completed,Unable to Submit Sales Invoice due to TypeError: EmployeePaymentEntry.set_missing_ref_details(),"### Information about bug

Hello,

I am trying to Submit a Sales Invoice, which was created from a Sales Order.
I'm getting the following error while submitting the document:

Server Error
TypeError: EmployeePaymentEntry.set_missing_ref_details() got an unexpected keyword argument 'ref_exchange_rate'

Requesting urgent support as this is a Production account and I'm unable to conduct regular business due to this.

### Module

selling

### Version

""erpnext"": ""14.66.4"",
	""frappe"": ""14.71.0"",
	""hrms"": ""14.25.0"",
	""india_compliance"": ""14.26.2"",
	""payments"": ""0.0.1""

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
### App Versions

{
	""erpnext"": ""14.66.4"",
	""frappe"": ""14.71.0"",
	""hrms"": ""14.25.0"",
	""india_compliance"": ""14.26.2"",
	""payments"": ""0.0.1""
}
```
### Route
```
Form/Sales Invoice/IN/24-25/0001
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 95, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 48, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 86, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1611, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/desk/form/save.py"", line 31, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 307, in save
    return self._save(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 359, in _save
    self.run_post_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1098, in run_post_save_methods
    self.run_method(""on_submit"")
  File ""apps/frappe/frappe/model/document.py"", line 928, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1280, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1262, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 925, in fn
    return method_object(*args, **kwargs)
  File ""apps/erpnext/erpnext/accounts/doctype/sales_invoice/sales_invoice.py"", line 292, in on_submit
    self.update_against_document_in_jv()
  File ""apps/erpnext/erpnext/controllers/accounts_controller.py"", line 1418, in update_against_document_in_jv
    reconcile_against_document(lst, active_dimensions=active_dimensions)
  File ""apps/erpnext/erpnext/accounts/utils.py"", line 485, in reconcile_against_document
    referenced_row = update_reference_in_payment_entry(
  File ""apps/erpnext/erpnext/accounts/utils.py"", line 685, in update_reference_in_payment_entry
    payment_entry.set_missing_ref_details(ref_exchange_rate=d.exchange_rate or None)
TypeError: EmployeePaymentEntry.set_missing_ref_details() got an unexpected keyword argument 'ref_exchange_rate'

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""doc"": ""{\""name\"":\""IN/24-25/0001\"",\""owner\"":\""abhishek@innomalous.com\"",\""creation\"":\""2024-04-11 18:16:57.900445\"",\""modified\"":\""2024-04-12 11:15:18.740611\"",\""modified_by\"":\""abhishek@innomalous.com\"",\""docstatus\"":0,\""idx\"":0,\""title\"":\""EcomHeat\"",\""naming_series\"":\""IN/24-25/.####\"",\""customer\"":\""CN-00000084\"",\""customer_name\"":\""EcomHeat\"",\""e_waybill_status\"":\""\"",\""company\"":\""Innomalous Technologies Private Limited\"",\""posting_date\"":\""2024-04-11\"",\""posting_time\"":\""18:15:34.500084\"",\""set_posting_time\"":1,\""due_date\"":\""2024-05-09\"",\""is_pos\"":0,\""is_consolidated\"":0,\""is_return\"":0,\""update_outstanding_for_self\"":1,\""reason_for_issuing_document\"":\""\"",\""update_billed_amount_in_sales_order\"":0,\""update_billed_amount_in_delivery_note\"":1,\""is_debit_note\"":0,\""is_reverse_charge\"":0,\""is_export_with_gst\"":0,\""currency\"":\""INR\"",\""conversion_rate\"":1,\""selling_price_list\"":\""B2B OEM Sales Price List\"",\""price_list_currency\"":\""INR\"",\""plc_conversion_rate\"":1,\""ignore_pricing_rule\"":0,\""update_stock\"":0,\""total_qty\"":540,\""total_net_weight\"":104,\""base_total\"":131413.5,\""base_net_total\"":131413.5,\""total\"":131413.5,\""net_total\"":131413.5,\""tax_category\"":\""\"",\""taxes_and_charges\"":\""Output GST Out-state - ITPL\"",\""incoterm\"":\""EXW\"",\""named_place\"":\""Noida\"",\""base_total_taxes_and_charges\"":23654.43,\""total_taxes_and_charges\"":23654.43,\""base_grand_total\"":155067.93,\""base_rounding_adjustment\"":0.07,\""base_rounded_total\"":155068,\""base_in_words\"":\""\"",\""grand_total\"":155067.93,\""rounding_adjustment\"":0.07,\""use_company_roundoff_cost_center\"":0,\""rounded_total\"":155068,\""in_words\"":\""\"",\""total_advance\"":73424,\""outstanding_amount\"":81644,\""disable_rounded_total\"":0,\""apply_discount_on\"":\""Grand Total\"",\""base_discount_amount\"":0,\""is_cash_or_non_trade_discount\"":0,\""additional_discount_percentage\"":0,\""discount_amount\"":0,\""other_charges_calculation\"":\""<div class=\\\""tax-break-up\\\"" style=\\\""overflow-x: auto;\\\"">\\n\\t<table class=\\\""table table-bordered table-hover\\\"">\\n\\t\\t<thead>\\n\\t\\t\\t<tr>\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t<th class=\\\""text-left\\\"">HSN/SAC</th>\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t<th class=\\\""text-right\\\"">Taxable Amount</th>\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t<th class=\\\""text-right\\\"">IGST</th>\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\n\\t\\t\\t</tr>\\n\\t\\t</thead>\\n\\t\\t<tbody>\\n\\t\\t\\t\\n\\t\\t\\t\\t<tr>\\n\\t\\t\\t\\t\\t<td>23091000</td>\\n\\t\\t\\t\\t\\t<td class=\\\""text-right\\\"">\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t₹ 1,25,580.00\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t<td class=\\\""text-right\\\"">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t(18.0%)\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t₹ 22,604.40\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t</tr>\\n\\t\\t\\t\\n\\t\\t\\t\\t<tr>\\n\\t\\t\\t\\t\\t<td>998540</td>\\n\\t\\t\\t\\t\\t<td class=\\\""text-right\\\"">\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t₹ 3,697.50\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t<td class=\\\""text-right\\\"">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t(18.0%)\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t₹ 665.55\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t</tr>\\n\\t\\t\\t\\n\\t\\t\\t\\t<tr>\\n\\t\\t\\t\\t\\t<td>9968</td>\\n\\t\\t\\t\\t\\t<td class=\\\""text-right\\\"">\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t₹ 2,136.00\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t<td class=\\\""text-right\\\"">\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t(18.0%)\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t₹ 384.48\\n\\t\\t\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\t\\t</td>\\n\\t\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t\\t\\n\\t\\t\\t\\t</tr>\\n\\t\\t\\t\\n\\t\\t</tbody>\\n\\t</table>\\n</div>\"",\""gst_breakup_table\"":\""<div class=\\\""tax-break-up\\\"" style=\\\""overflow-x: auto\\\""><table class=\\\""table table-bordered table-hover\\\""><thead><tr><th class=\\\""text-left\\\"">HSN/SAC</th><th class=\\\""text-right\\\"">Taxable Amount</th><th class=\\\""text-right\\\"">IGST</th></tr></thead><tbody><tr><td class=\\\""text-left\\\"">23091000</td><td class=\\\""text-right\\\"">₹ 1,25,580.00</td><td class=\\\""text-right\\\"">(18.0%)&nbsp;₹ 22,604.40</td></tr><tr><td class=\\\""text-left\\\"">998540</td><td class=\\\""text-right\\\"">₹ 3,697.50</td><td class=\\\""text-right\\\"">(18.0%)&nbsp;₹ 665.55</td></tr><tr><td class=\\\""text-left\\\"">9968</td><td class=\\\""text-right\\\"">₹ 2,136.00</td><td class=\\\""text-right\\\"">(18.0%)&nbsp;₹ 384.48</td></tr></tbody></table></div>\"",\""total_billing_hours\"":0,\""total_billing_amount\"":0,\""base_paid_amount\"":0,\""paid_amount\"":0,\""base_change_amount\"":0,\""change_amount\"":0,\""allocate_advances_automatically\"":0,\""only_include_allocated_payments\"":0,\""write_off_amount\"":0,\""base_write_off_amount\"":0,\""write_off_outstanding_amount_automatically\"":0,\""redeem_loyalty_points\"":0,\""loyalty_points\"":0,\""loyalty_amount\"":0,\""dont_create_loyalty_points\"":0,\""customer_address\"":\""CN-00000084-Billing-3\"",\""address_display\"":\""HD-143, WeWork Enam Sambhav, C - 20, Bandra Kurla Complex<br>G Block Rd, G Block BKC, Mumbai<br>Mumbai Suburban<br>\\nMaharashtra, State Code: 27<br>Pincode: 400051<br>India<br>\\nGSTIN: 27EIAPP1496K1ZS<br>\"",\""billing_address_gstin\"":\""27EIAPP1496K1ZS\"",\""gst_category\"":\""Registered Regular\"",\""place_of_supply\"":\""27-Maharashtra\"",\""contact_person\"":\""Aman Patial\"",\""contact_display\"":\""Aman Patial\"",\""contact_mobile\"":\""6395119426\"",\""contact_email\"":\""hello@k9vitality.in\"",\""territory\"":\""India\"",\""shipping_address_name\"":\""CN-00000084-Warehouse\"",\""shipping_address\"":\""Gala No. 4 &amp; 5, Building E, Prathamesh Complex<br>Saravli Village, Off Mumbai-Nasik Highway, Opp Vatika Restaurant<br>Bhiwandi, Thane<br>\\nMaharashtra, State Code: 27<br>Pincode: 421302<br>India<br>\\n\"",\""company_address\"":\""Innomalous Technologies Private Limited-Shipping\"",\""company_gstin\"":\""09AAECI1177P1Z1\"",\""company_address_display\"":\""E-197, Sector 63<br>Noida<br>Gautam Buddha Nagar<br>\\nUttar Pradesh, State Code: 09<br>Pincode: 201309<br>India<br>\\nGSTIN: 09AAECI1177P1Z1<br>\"",\""ignore_default_payment_terms_template\"":0,\""payment_terms_template\"":\""Standard OEM Order Terms\"",\""tc_name\"":\""Sales Invoice Terms\"",\""terms\"":\""<div class=\\\""ql-editor read-mode\\\""><ol><li data-list=\\\""ordered\\\""><span class=\\\""ql-ui\\\"" contenteditable=\\\""false\\\""></span>E. &amp; O. E.</li><li data-list=\\\""ordered\\\""><span class=\\\""ql-ui\\\"" contenteditable=\\\""false\\\""></span>T&amp;Cs apply as per Custom Work Order Agreement.</li></ol></div>\"",\""po_no\"":\""\"",\""debit_to\"":\""Debtors/Receivables - ITPL\"",\""party_account_currency\"":\""INR\"",\""is_opening\"":\""No\"",\""against_income_account\"":\""Sales - ITPL\"",\""amount_eligible_for_commission\"":131413.5,\""commission_rate\"":0,\""total_commission\"":0,\""letter_head\"":\""ITPL New\"",\""group_same_items\"":0,\""invoice_copy\"":\""Original for Recipient\"",\""language\"":\""en\"",\""transporter\"":\""Delhivery Limited\"",\""gst_transporter_id\"":\""06AAPCS9575E1ZR\"",\""distance\"":0,\""transporter_name\"":\""Delhivery Limited\"",\""mode_of_transport\"":\""Road\"",\""lr_date\"":\""2024-04-11\"",\""gst_vehicle_type\"":\""Regular\"",\""status\"":\""Draft\"",\""einvoice_status\"":\""Not Applicable\"",\""customer_group\"":\""Startup\"",\""is_internal_customer\"":0,\""is_discounted\"":0,\""remarks\"":\""No Remarks\"",\""repost_required\"":0,\""doctype\"":\""Sales Invoice\"",\""advances\"":[{\""name\"":\""65128ae721\"",\""owner\"":\""abhishek@innomalous.com\"",\""creation\"":\""2024-04-11 18:16:57.900445\"",\""modified\"":\""2024-04-12 11:15:18.740611\"",\""modified_by\"":\""abhishek@innomalous.com\"",\""docstatus\"":0,\""idx\"":1,\""reference_type\"":\""Payment Entry\"",\""reference_name\"":\""PYMT/24-00108\"",\""remarks\"":\""Amount INR 327447 received from CN-00000084\\nTransaction reference no 408905425719 dated 2024-03-29\\nAmount INR 73424 against Sales Order SO/23-24/00027\\nAmount INR 254023 against Sales Invoice IN/23-24/0028\"",\""reference_row\"":\""d662e0fd06\"",\""advance_amount\"":73424,\""allocated_amount\"":73424,\""exchange_gain_loss\"":0,\""ref_exchange_rate\"":1,\""parent\"":\""IN/24-25/0001\"",\""parentfield\"":\""advances\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Sales Invoice Advance\""}],\""payments\"":[],\""payment_schedule\"":[{\""name\"":\""b771fbd9fc\"",\""owner\"":\""abhishek@innomalous.com\"",\""creation\"":\""2024-04-12 11:15:19.551101\"",\""modified\"":\""2024-04-12 11:15:19.551101\"",\""modified_by\"":\""abhishek@innomalous.com\"",\""docstatus\"":0,\""idx\"":1,\""payment_term\"":\""Advance due at Order Confirmation\"",\""description\"":\""\"",\""due_date\"":\""2024-04-11\"",\""invoice_portion\"":50,\""discount_type\"":\""Percentage\"",\""discount_date\"":\""2024-04-11\"",\""discount\"":0,\""payment_amount\"":40822,\""outstanding\"":40822,\""paid_amount\"":0,\""discounted_amount\"":0,\""base_payment_amount\"":40822,\""parent\"":\""IN/24-25/0001\"",\""parentfield\"":\""payment_schedule\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Payment Schedule\""},{\""name\"":\""03e1b70a2d\"",\""owner\"":\""abhishek@innomalous.com\"",\""creation\"":\""2024-04-12 11:15:19.551667\"",\""modified\"":\""2024-04-12 11:15:19.551667\"",\""modified_by\"":\""abhishek@innomalous.com\"",\""docstatus\"":0,\""idx\"":2,\""payment_term\"":\""Balance due before Inventory Dispatch\"",\""due_date\"":\""2024-05-09\"",\""invoice_portion\"":50,\""discount_type\"":\""Percentage\"",\""discount_date\"":\""2024-04-11\"",\""discount\"":0,\""payment_amount\"":40822,\""outstanding\"":40822,\""paid_amount\"":0,\""discounted_amount\"":0,\""base_payment_amount\"":40822,\""parent\"":\""IN/24-25/0001\"",\""parentfield\"":\""payment_schedule\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Payment Schedule\""}],\""taxes\"":[{\""name\"":\""9d4542ecec\"",\""owner\"":\""abhishek@innomalous.com\"",\""creation\"":\""2024-04-11 18:16:57.900445\"",\""modified\"":\""2024-04-12 11:15:18.740611\"",\""modified_by\"":\""abhishek@innomalous.com\"",\""docstatus\"":0,\""idx\"":1,\""charge_type\"":\""On Net Total\"",\""account_head\"":\""Output Tax IGST - ITPL\"",\""description\"":\""IGST\"",\""included_in_print_rate\"":0,\""included_in_paid_amount\"":0,\""cost_center\"":\""Main - ITPL\"",\""rate\"":18,\""account_currency\"":\""INR\"",\""tax_amount\"":23654.43,\""total\"":155067.93,\""tax_amount_after_discount_amount\"":23654.43,\""base_tax_amount\"":23654.43,\""base_total\"":155067.93,\""base_tax_amount_after_discount_amount\"":23654.43,\""item_wise_tax_detail\"":\""{\\\""IT/P31-001002\\\"":[18,9949.68],\\\""IT/P31-001003\\\"":[18,12654.72],\\\""IT/SV2-001001\\\"":[18,665.55],\\\""IT/SV0-000001\\\"":[18,384.48]}\"",\""dont_recompute_tax\"":0,\""parent\"":\""IN/24-25/0001\"",\""parentfield\"":\""taxes\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Sales Taxes and Charges\""}],\""pricing_rules\"":[],\""sales_team\"":[],\""items\"":[{\""name\"":\""f6e84e50fa\"",\""owner\"":\""abhishek@innomalous.com\"",\""creation\"":\""2024-04-11 18:16:57.900445\"",\""modified\"":\""2024-04-12 11:15:18.740611\"",\""modified_by\"":\""abhishek@innomalous.com\"",\""docstatus\"":0,\""idx\"":1,\""has_item_scanned\"":0,\""item_code\"":\""IT/P31-001002\"",\""item_name\"":\""Digestive & Gut Health Supplement for Dogs\"",\""description\"":\""Digestive &amp; Gut Health Supplement for Dogs\"",\""gst_hsn_code\"":\""23091000\"",\""item_group\"":\""Meal Boosters\"",\""image\"":\""\"",\""qty\"":52,\""stock_uom\"":\""Kg\"",\""uom\"":\""Kg\"",\""conversion_factor\"":1,\""stock_qty\"":52,\""price_list_rate\"":1236,\""base_price_list_rate\"":1236,\""margin_type\"":\""\"",\""margin_rate_or_amount\"":0,\""rate_with_margin\"":0,\""discount_percentage\"":13.997,\""discount_amount\"":173,\""base_rate_with_margin\"":0,\""rate\"":1063,\""amount\"":55276,\""item_tax_template\"":\""GST 18% - ITPL\"",\""gst_treatment\"":\""Taxable\"",\""base_rate\"":1063,\""base_amount\"":55276,\""stock_uom_rate\"":1063,\""is_free_item\"":0,\""grant_commission\"":1,\""net_rate\"":1063,\""net_amount\"":55276,\""base_net_rate\"":1063,\""base_net_amount\"":55276,\""taxable_value\"":55276,\""igst_rate\"":18,\""cgst_rate\"":0,\""sgst_rate\"":0,\""cess_rate\"":0,\""cess_non_advol_rate\"":0,\""igst_amount\"":9949.68,\""cgst_amount\"":0,\""sgst_amount\"":0,\""cess_amount\"":0,\""cess_non_advol_amount\"":0,\""delivered_by_supplier\"":0,\""income_account\"":\""Sales - ITPL\"",\""is_fixed_asset\"":0,\""expense_account\"":\""Cost of Goods Sold - ITPL\"",\""enable_deferred_revenue\"":0,\""weight_per_unit\"":1,\""total_weight\"":52,\""weight_uom\"":\""Kg\"",\""warehouse\"":\""Stores - ITPL\"",\""incoming_rate\"":0,\""allow_zero_valuation_rate\"":0,\""item_tax_rate\"":\""{\\\""Output Tax SGST - ITPL\\\"": 9.0, \\\""Output Tax CGST - ITPL\\\"": 9.0, \\\""Output Tax IGST - ITPL\\\"": 18.0, \\\""Input Tax SGST - ITPL\\\"": 9.0, \\\""Input Tax CGST - ITPL\\\"": 9.0, \\\""Input Tax IGST - ITPL\\\"": 18.0, \\\""Input Tax SGST RCM - ITPL\\\"": 9.0, \\\""Input Tax CGST RCM - ITPL\\\"": 9.0, \\\""Input Tax IGST RCM - ITPL\\\"": 18.0}\"",\""actual_batch_qty\"":0,\""actual_qty\"":0,\""sales_order\"":\""SO/23-24/00027\"",\""so_detail\"":\""3adcd0d619\"",\""delivered_qty\"":0,\""cost_center\"":\""Main - ITPL\"",\""page_break\"":0,\""parent\"":\""IN/24-25/0001\"",\""parentfield\"":\""items\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Sales Invoice Item\""},{\""name\"":\""cefc71d239\"",\""owner\"":\""abhishek@innomalous.com\"",\""creation\"":\""2024-04-11 18:16:57.900445\"",\""modified\"":\""2024-04-12 11:15:18.740611\"",\""modified_by\"":\""abhishek@innomalous.com\"",\""docstatus\"":0,\""idx\"":2,\""has_item_scanned\"":0,\""item_code\"":\""IT/P31-001003\"",\""item_name\"":\""Hip, Bone & Joint Health Supplement for Dogs\"",\""description\"":\""Hip, Bone &amp; Joint Health Supplement for Dogs\"",\""gst_hsn_code\"":\""23091000\"",\""item_group\"":\""Meal Boosters\"",\""image\"":\""\"",\""qty\"":52,\""stock_uom\"":\""Kg\"",\""uom\"":\""Kg\"",\""conversion_factor\"":1,\""stock_qty\"":52,\""price_list_rate\"":1352,\""base_price_list_rate\"":1352,\""margin_type\"":\""\"",\""margin_rate_or_amount\"":0,\""rate_with_margin\"":0,\""discount_percentage\"":0,\""discount_amount\"":0,\""base_rate_with_margin\"":0,\""rate\"":1352,\""amount\"":70304,\""item_tax_template\"":\""GST 18% - ITPL\"",\""gst_treatment\"":\""Taxable\"",\""base_rate\"":1352,\""base_amount\"":70304,\""stock_uom_rate\"":1352,\""is_free_item\"":0,\""grant_commission\"":1,\""net_rate\"":1352,\""net_amount\"":70304,\""base_net_rate\"":1352,\""base_net_amount\"":70304,\""taxable_value\"":70304,\""igst_rate\"":18,\""cgst_rate\"":0,\""sgst_rate\"":0,\""cess_rate\"":0,\""cess_non_advol_rate\"":0,\""igst_amount\"":12654.72,\""cgst_amount\"":0,\""sgst_amount\"":0,\""cess_amount\"":0,\""cess_non_advol_amount\"":0,\""delivered_by_supplier\"":0,\""income_account\"":\""Sales - ITPL\"",\""is_fixed_asset\"":0,\""expense_account\"":\""Cost of Goods Sold - ITPL\"",\""enable_deferred_revenue\"":0,\""weight_per_unit\"":1,\""total_weight\"":52,\""weight_uom\"":\""Kg\"",\""warehouse\"":\""Stores - ITPL\"",\""incoming_rate\"":0,\""allow_zero_valuation_rate\"":0,\""item_tax_rate\"":\""{\\\""Output Tax SGST - ITPL\\\"": 9.0, \\\""Output Tax CGST - ITPL\\\"": 9.0, \\\""Output Tax IGST - ITPL\\\"": 18.0, \\\""Input Tax SGST - ITPL\\\"": 9.0, \\\""Input Tax CGST - ITPL\\\"": 9.0, \\\""Input Tax IGST - ITPL\\\"": 18.0, \\\""Input Tax SGST RCM - ITPL\\\"": 9.0, \\\""Input Tax CGST RCM - ITPL\\\"": 9.0, \\\""Input Tax IGST RCM - ITPL\\\"": 18.0}\"",\""actual_batch_qty\"":0,\""actual_qty\"":0,\""sales_order\"":\""SO/23-24/00027\"",\""so_detail\"":\""4a8d0604dc\"",\""delivered_qty\"":0,\""cost_center\"":\""Main - ITPL\"",\""page_break\"":0,\""parent\"":\""IN/24-25/0001\"",\""parentfield\"":\""items\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Sales Invoice Item\""},{\""name\"":\""ebc172bd8b\"",\""owner\"":\""abhishek@innomalous.com\"",\""creation\"":\""2024-04-11 18:16:57.900445\"",\""modified\"":\""2024-04-12 11:15:18.740611\"",\""modified_by\"":\""abhishek@innomalous.com\"",\""docstatus\"":0,\""idx\"":3,\""has_item_scanned\"":0,\""item_code\"":\""IT/SV2-001001\"",\""item_name\"":\""Retail Pouch Packing Service\"",\""description\"":\""Retail Pouch Packing Service\"",\""gst_hsn_code\"":\""998540\"",\""item_group\"":\""Job Work\"",\""image\"":\""\"",\""qty\"":435,\""stock_uom\"":\""Nos\"",\""uom\"":\""Nos\"",\""conversion_factor\"":1,\""stock_qty\"":435,\""price_list_rate\"":0,\""base_price_list_rate\"":0,\""margin_type\"":\""\"",\""margin_rate_or_amount\"":0,\""rate_with_margin\"":0,\""discount_percentage\"":0,\""discount_amount\"":0,\""base_rate_with_margin\"":0,\""rate\"":8.5,\""amount\"":3697.5,\""gst_treatment\"":\""Taxable\"",\""base_rate\"":8.5,\""base_amount\"":3697.5,\""stock_uom_rate\"":8.5,\""is_free_item\"":0,\""grant_commission\"":1,\""net_rate\"":8.5,\""net_amount\"":3697.5,\""base_net_rate\"":8.5,\""base_net_amount\"":3697.5,\""taxable_value\"":3697.5,\""igst_rate\"":18,\""cgst_rate\"":0,\""sgst_rate\"":0,\""cess_rate\"":0,\""cess_non_advol_rate\"":0,\""igst_amount\"":665.55,\""cgst_amount\"":0,\""sgst_amount\"":0,\""cess_amount\"":0,\""cess_non_advol_amount\"":0,\""delivered_by_supplier\"":0,\""income_account\"":\""Sales - ITPL\"",\""is_fixed_asset\"":0,\""expense_account\"":\""Cost of Goods Sold - ITPL\"",\""enable_deferred_revenue\"":0,\""weight_per_unit\"":0,\""total_weight\"":0,\""warehouse\"":\""Stores - ITPL\"",\""incoming_rate\"":0,\""allow_zero_valuation_rate\"":0,\""item_tax_rate\"":\""{}\"",\""actual_batch_qty\"":0,\""actual_qty\"":0,\""sales_order\"":\""SO/23-24/00027\"",\""so_detail\"":\""15fdfbc22b\"",\""delivered_qty\"":0,\""cost_center\"":\""Main - ITPL\"",\""page_break\"":0,\""parent\"":\""IN/24-25/0001\"",\""parentfield\"":\""items\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Sales Invoice Item\""},{\""name\"":\""f1b58c2e8e\"",\""owner\"":\""abhishek@innomalous.com\"",\""creation\"":\""2024-04-11 18:16:57.900445\"",\""modified\"":\""2024-04-12 11:15:18.740611\"",\""modified_by\"":\""abhishek@innomalous.com\"",\""docstatus\"":0,\""idx\"":4,\""has_item_scanned\"":0,\""item_code\"":\""IT/SV0-000001\"",\""item_name\"":\""Loading, Forwarding & Shipping\"",\""description\"":\""Loading, Forwarding &amp; Shipping\"",\""gst_hsn_code\"":\""9968\"",\""item_group\"":\""Services\"",\""image\"":\""\"",\""qty\"":1,\""stock_uom\"":\""Nos\"",\""uom\"":\""Nos\"",\""conversion_factor\"":1,\""stock_qty\"":1,\""price_list_rate\"":0,\""base_price_list_rate\"":0,\""margin_type\"":\""\"",\""margin_rate_or_amount\"":0,\""rate_with_margin\"":0,\""discount_percentage\"":0,\""discount_amount\"":0,\""base_rate_with_margin\"":0,\""rate\"":2136,\""amount\"":2136,\""gst_treatment\"":\""Taxable\"",\""base_rate\"":2136,\""base_amount\"":2136,\""pricing_rules\"":\""\"",\""stock_uom_rate\"":2136,\""is_free_item\"":0,\""grant_commission\"":1,\""net_rate\"":2136,\""net_amount\"":2136,\""base_net_rate\"":2136,\""base_net_amount\"":2136,\""taxable_value\"":2136,\""igst_rate\"":18,\""cgst_rate\"":0,\""sgst_rate\"":0,\""cess_rate\"":0,\""cess_non_advol_rate\"":0,\""igst_amount\"":384.48,\""cgst_amount\"":0,\""sgst_amount\"":0,\""cess_amount\"":0,\""cess_non_advol_amount\"":0,\""delivered_by_supplier\"":0,\""income_account\"":\""Sales - ITPL\"",\""is_fixed_asset\"":0,\""expense_account\"":\""Freight and Forwarding Charges - ITPL\"",\""enable_deferred_revenue\"":0,\""weight_per_unit\"":0,\""total_weight\"":0,\""warehouse\"":\""Stores - ITPL\"",\""incoming_rate\"":0,\""allow_zero_valuation_rate\"":0,\""item_tax_rate\"":\""{}\"",\""actual_batch_qty\"":0,\""actual_qty\"":0,\""delivered_qty\"":0,\""cost_center\"":\""Main - ITPL\"",\""page_break\"":0,\""parent\"":\""IN/24-25/0001\"",\""parentfield\"":\""items\"",\""parenttype\"":\""Sales Invoice\"",\""doctype\"":\""Sales Invoice Item\""}],\""timesheets\"":[],\""packed_items\"":[],\""__onload\"":{\""make_payment_via_journal_entry\"":0},\""__last_sync_on\"":\""2024-04-12T05:49:45.028Z\"",\""_submitted_from_ui\"":1}"",
		""action"": ""Submit""
	},
	""btn"": {
		""jQuery3600323810040232154431"": {
			""events"": {
				""click"": [
					{
						""type"": ""click"",
						""origType"": ""click"",
						""guid"": 603,
						""namespace"": """"
					}
				]
			}
		}
	},
	""freeze"": true,
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.form.save.savedocs""
}
```
### Response Data
```
{
	""exception"": ""TypeError: EmployeePaymentEntry.set_missing_ref_details() got an unexpected keyword argument 'ref_exchange_rate'""
}
```
```
",innomalous,2024-04-12 05:56:35+00:00,[],2024-05-24 00:09:09+00:00,2024-05-07 06:01:13+00:00,https://github.com/frappe/erpnext/issues/40976,"[('bug', None)]","[{'comment_id': 2051062321, 'issue_id': 2239142435, 'author': 'innomalous', 'body': 'So I deleted the Advance Payments added to the Sales Invoice. And I was able to Submit the document.\r\nBut once I go to Payment Reconciliation Tool to allocate the payment, the same error is thrown.', 'created_at': datetime.datetime(2024, 4, 12, 6, 19, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2078583234, 'issue_id': 2239142435, 'author': 'Poorvi-R-Bhat', 'body': 'This has been fixed in the v14.67.0. Reference : [09cda60](https://github.com/frappe/erpnext/commit/09cda60bdf11444bb05d6ec8968deffee59559f7)', 'created_at': datetime.datetime(2024, 4, 26, 3, 51, 55, tzinfo=datetime.timezone.utc)}]","innomalous (Issue Creator) on (2024-04-12 06:19:29 UTC): So I deleted the Advance Payments added to the Sales Invoice. And I was able to Submit the document.
But once I go to Payment Reconciliation Tool to allocate the payment, the same error is thrown.

Poorvi-R-Bhat on (2024-04-26 03:51:55 UTC): This has been fixed in the v14.67.0. Reference : [09cda60](https://github.com/frappe/erpnext/commit/09cda60bdf11444bb05d6ec8968deffee59559f7)

"
2237710558,issue,open,,Description of each Variants should be based on the attribute_value instead of abbr,"When Creating Variants from a Template, the default behavior is adding a description exactly the same as the item name and attribute abbreviations. This is redudant and pretty useless as then the Description is often unreadable both internally and externally for Shop visitors.


When creating Multiple Variants, the Description of the Variants should be based on the attribute_value instead of abbr.
This will give a much more clear ""Description"" and explanation on what the attribute abbr are about.


Someone already posted a client script that does this correctly, but only works when creating one Variant and saving it. 
There should be a solution to do it also for Create -> Multiple Variants. Which is a background job.

Here is the code that works onle for one Variant at the time:

```
frappe.ui.form.on('Item', {
    validate: function(frm) {
        // Triggered when the Item form is validated (before saving)
        updateItemDescription(frm);
    }
});

function updateItemDescription(frm) {
    // Construct the item description with attribute values
    var item_description = frm.doc.item_name + ' / ';
    frm.doc.attributes.forEach(function(attribute) {
        // Access attribute value and append to the description
        item_description += attribute.attribute_value + ' ';
    });

    // Update the item description field
    frm.set_value('description', item_description);
}
```

Please let me know a solution, even if temporary, it's unthinkable to me to customize manually the description of more than 3000 variations of a product.",SmoothPlay,2024-04-11 13:18:46+00:00,[],2024-04-11 13:19:12+00:00,,https://github.com/frappe/erpnext/issues/40972,"[('feature-request', None)]",[],
2236903176,issue,open,,Tally Migration Error : ,"### Information about bug

I tried to import data from Tally Prime. I exported all master data in master.xml from Tally Prime, Then I zip it and upload to tally migration list in ERPNext.

Similar problem on Issue Id : https://github.com/frappe/erpnext/issues/35472

Please Help to resolve this issue..
Thanks

### Module

integrations

### Version

Installed Apps
Email Delivery Service: v0.0.1 (HEAD)

ERPNext: v15.18.3 (HEAD)

Frappe Framework: v15.20.0 (HEAD)

India Compliance: v15.7.0 (HEAD)

Payments: v0.0.1 (HEAD)

Print Designer: v1.0.0 (HEAD)

Webshop: v0.0.1 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Tally Migration Error

Error
Data:
""Processing Master Data""
----------------------------------------------------------------------------------------------------

Exception:
Traceback (most recent call last):
  File ""/home/frappe/frappe-bench/apps/erpnext/erpnext/erpnext_integrations/doctype/tally_migration/tally_migration.py"", line 309, in _process_master_data
    chart_of_accounts, customers, suppliers = get_coa_customers_suppliers(collection)
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/frappe/frappe-bench/apps/erpnext/erpnext/erpnext_integrations/doctype/tally_migration/tally_migration.py"", line 164, in get_coa_customers_suppliers
    for account in coa:
                   ^^^
UnboundLocalError: cannot access local variable 'coa' where it is not associated with a value
```
",Sunitsarode,2024-04-11 04:48:14+00:00,[],2024-04-11 04:48:14+00:00,,https://github.com/frappe/erpnext/issues/40952,"[('bug', None)]",[],
2235238000,issue,closed,completed,"When creating a quality inspection from a purchase receipt while the quality inspection is in draft, the status of the purchase receipt changes to ""Quality Inspection Pending","### Information about bug

When creating a quality inspection from a purchase receipt while the quality inspection is in draft, the status of the purchase receipt changes to ""Quality Inspection Pending and while the quality inspection is submitted then the status of receipt changes to ""Quality Inspection Completed
![Screenshot_186](https://github.com/frappe/erpnext/assets/107920741/ceed6a3b-008d-4f7c-80e8-cc00dc246a12)
""

### Module

stock

### Version

Frappe Version - v15.17.3 (version-15)
ERPNext Version - v15.17.1 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",aditya3366,2024-04-10 10:17:10+00:00,[],2024-04-27 00:08:35+00:00,2024-04-12 06:35:28+00:00,https://github.com/frappe/erpnext/issues/40942,"[('bug', None)]","[{'comment_id': 2051083632, 'issue_id': 2235238000, 'author': 'Nihantra-Patel', 'body': 'Hi @aditya3366,\r\n\r\nThis is a feature request rather than a bug. However, you can address it by modifying a client script. It\'s not particularly challenging. Alternatively, you could also adjust the status server script or client script. Below, I\'ve included the client script for your reference.\r\n\r\nclient script:\r\n\r\n```js\r\nfrappe.ui.form.on(\'Purchase Receipt\', {\r\n    refresh: function(frm) {\r\n        if (frm.doc.docstatus === 0) {\r\n            $.each(frm.doc.items,  function(i,  d) {\r\n                frappe.db.get_value(""Item"",\r\n                {""name"": d.item_code},\r\n                ""inspection_required_before_purchase"",\r\n                function(i_val) {\r\n                    if (i_val.inspection_required_before_purchase === 1) {\r\n                        frappe.db.get_value(""Quality Inspection"", \r\n                        {""reference_type"": ""Purchase Receipt"", ""reference_name"": frm.doc.name}, \r\n                        ""docstatus"", function(qc_val) {\r\n                            if (qc_val.docstatus === 0) {\r\n                                frm.page.clear_indicator();\r\n                                frm.page.set_indicator(__(""Quality Inspection Pending""), \'orange\');\r\n                            } else if (qc_val.docstatus === 1) {\r\n                                frm.page.clear_indicator();\r\n                                frm.page.set_indicator(__(""Quality Inspection Completed""), \'green\');\r\n                            } else {\r\n                                frm.page.clear_indicator();\r\n                                frm.page.set_indicator(__(""Quality Inspection Not Created""), \'red\');\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    }\r\n});\r\n```\r\n\r\n**Output:**\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/de6f6740-8a11-40e8-a64a-8bf00cc23684\r\n\r\nYou can modify the code according to the requirement, you can also apply the same thing for delivery note time (Quality Inspection).\r\n\r\nHope this helps!', 'created_at': datetime.datetime(2024, 4, 12, 6, 35, 28, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-04-12 06:35:28 UTC): Hi @aditya3366,

This is a feature request rather than a bug. However, you can address it by modifying a client script. It's not particularly challenging. Alternatively, you could also adjust the status server script or client script. Below, I've included the client script for your reference.

client script:

```js
frappe.ui.form.on('Purchase Receipt', {
    refresh: function(frm) {
        if (frm.doc.docstatus === 0) {
            $.each(frm.doc.items,  function(i,  d) {
                frappe.db.get_value(""Item"",
                {""name"": d.item_code},
                ""inspection_required_before_purchase"",
                function(i_val) {
                    if (i_val.inspection_required_before_purchase === 1) {
                        frappe.db.get_value(""Quality Inspection"", 
                        {""reference_type"": ""Purchase Receipt"", ""reference_name"": frm.doc.name}, 
                        ""docstatus"", function(qc_val) {
                            if (qc_val.docstatus === 0) {
                                frm.page.clear_indicator();
                                frm.page.set_indicator(__(""Quality Inspection Pending""), 'orange');
                            } else if (qc_val.docstatus === 1) {
                                frm.page.clear_indicator();
                                frm.page.set_indicator(__(""Quality Inspection Completed""), 'green');
                            } else {
                                frm.page.clear_indicator();
                                frm.page.set_indicator(__(""Quality Inspection Not Created""), 'red');
                            }
                        });
                    }
                });
            });
        }
    }
});
```

**Output:**


https://github.com/frappe/erpnext/assets/141945075/de6f6740-8a11-40e8-a64a-8bf00cc23684

You can modify the code according to the requirement, you can also apply the same thing for delivery note time (Quality Inspection).

Hope this helps!

"
2235105925,issue,open,,Proposal for M-Pesa C2B Payments Integration with ERPNext,"[M-Pesa Express](https://developer.safaricom.co.ke/APIs/MpesaExpressSimulate) is integrated with ERPNext, and implemented to work with Standard ERPNext POS.

[M-Pesa Express](https://developer.safaricom.co.ke/APIs/MpesaExpressSimulate) and [Customer to Business (C2B)](https://developer.safaricom.co.ke/APIs/CustomerToBusinessRegisterURL), are integrated with ERPNext, and implemented to work with POS Awesome.

This is a proposal to integrate M-Pesa [Customer to Business (C2B)](https://developer.safaricom.co.ke/APIs/CustomerToBusinessRegisterURL) payments with ERPNext’ s Standard Point of Sale (POS) system, to facilitate processing of customer Till and Paybill payments.

This integration will allow customers to make mpesa payments to a M-pesa till or paybill of a vendor/merchant, these payments will be received into ERPNext, and there-after will be used to reconcile against sales invoices, and POS invoices.

PRs for this effort will be made against, [Payments](https://github.com/frappe/payments), where the custom doctypes and associated code will reside, and [ERPNext](https://github.com/frappe/erpnext), for POS specific customizations.

These C2B payments, will be received in a custom M-Pesa Transaction Record Doctype, for each M-pesa till/paybill number (a business can have more than one M-pesa till/paybill number, and from here, these received payments will be reconciled against Sales Invoices in the below options:

-   _[Implemented on POS Awesome]_ The M-Pesa Transaction Record will be linked to a particular customer, a Payment Entry is created, and the Payment Entry will be reconciled against the relevant Sales Invoices. _**Note:**_ This will be a manual effort by the user, since there’s no way of knowing exactly from which customer/payer the payment was received from, since the customer/payer phone number is masked, and only the first name is shared by [Safaricom Mpesa Daraja](https://developer.safaricom.co.ke/APIs/CustomerToBusinessRegisterURL)
    
-   _[Implemented on POS Awesome]_ For POS, a POS Profile will be linked to M-Pesa C2B as one of the modes of payment. If a POS Profile has C2B has one of the modes of payment, then, on POS Payments screen, Mpesa Payments received against the till/paybill number, will be availed on a search dialog, and the user will select, one or more, to reconcile/pay the POS Invoice with.
    
    -   _[Not Implemented on POS Awesome]_ An enhancement on above, is to auto display M-Pesa Payment Register matching amount with POS Invoice, and have the user confirm with customer, if the name displayed is theirs, and by clicking confirm, the payment is used to reconcile/pay the said POS Invoice. This is usually standard on other POS systems in supermarkets, to facilitate speedy service to customers.
        
-   _[Implemented on POS Awesome]_ Third option, and this is a somewhat additional implementation in away, is have a separate payments tab/screen from the Items picker one on POS.
![WhatsApp Image 2024-04-10 at 13 40 21](https://github.com/frappe/erpnext/assets/60258622/18e0a76e-a2d4-4aff-8fea-47a7571d2fdd)

    
    -   Display past sales invoices/pos invoices, for a selected customer on one section.
        
    -   Display draft received Mpesa Payments on another section
        
    -   Display unreconciled payment entries for the customer.
        
        -   Then avail feature to reconcile this. Basically, a screen on POS that’s similar to Payment Reconcialition. If anything, the background implementation calls Payment Reconcialition, for the actual Reconciliation.
            

  
  

  
  

## Implementation Plan

### 1. Existing Doctypes Utilization

-   Payment Entry
    
-   POS Invoice
    
-   Sales Invoice
    
-   Customer
    
-   Payment Request
    
-   Payment Gateway
    
-   Payment Gateway Account
    
-   Account
    
-   Point of Sale (POS) page
    
-   M-Pesa Settings
    
-   Mode of Payment
    
-   POS Profile
![Screenshot from 2024-04-09 14-56-57](https://github.com/frappe/erpnext/assets/60258622/1d603499-847b-438d-bf49-b9a3627be5d4)

    

2. ### New Doctypes Creation

-   **Mpesa C2B Payment Register URL**
    
![Screenshot from 2024-04-10 18-30-17](https://github.com/frappe/erpnext/assets/60258622/901ecd97-4a09-4b49-bb4c-086a94b7fff0)



Define payment mode and link it with M-Pesa settings. This is similar to Mpesa C2B Register URL and plays similar role. Manage callback notifications for transaction updates.

Fields: mpesa settings, company, mode of payments.

  

-   #### Mpesa C2B Payment Register
    
![test2](https://github.com/frappe/erpnext/assets/60258622/a6b9c18f-1aff-4394-8641-cbca00fc99a8)

Store transaction details post successful M-Pesa payment. This is similar to Mpesa Payment Register found in POS awesome and plays the same functionality.

Fields: Full Name, Transaction type, Posting Date, date, Transa ID, Transa Time, Trans Amount, Business Short code, invoice Number, Default Currency, Customer, Mode of Payment, Submit payment, First name, Org Account Balance.

  

  
  

### Affected Repositories

-   **erpnext**
    
-   **payments**
    

This integration will primarily impact the ERPNext app and the payments app within the ERPNext framework.

Changes related to the standard POS will be made and pushed to the ERPNext repository.

Integration functionalities with the new doctypes will be implemented within the payments app to streamline M-Pesa payment processing.

Also, any relevant report related to mpesa payments will go in the payment app.

### Conclusion

This proposal outlines the integration of M-Pesa payments into ERPNext’ s POS system, leveraging existing and new doctypes to streamline payment processing and reconciliation. The goal is to enhance ERPNext’ s functionality by providing an efficient and user-friendly payment solution for M-Pesa users.

Please review this proposal for the integration of M-Pesa C2B payments into ERPNext POS. This detailed plan aims to improve payment workflows and expand ERPNext’ s capabilities in the retail sector. We welcome feedback and collaboration to implement this feature effectively.",maniamartial,2024-04-10 09:06:40+00:00,[],2024-04-10 15:32:42+00:00,,https://github.com/frappe/erpnext/issues/40939,"[('feature-request', None)]",[],
2234730434,issue,closed,completed,"valuation is not correct (Serial Item), Stock Transfer , add to transit with additional cost ","### Information about bug

Stock Transfer with additional cost (for serial items)
![image](https://github.com/frappe/erpnext/assets/62122640/8c6cd394-1864-4e10-acf1-761ad1f42d6c)
![image](https://github.com/frappe/erpnext/assets/62122640/5be95213-5a42-4611-b855-26b298594e29)
![image](https://github.com/frappe/erpnext/assets/62122640/06a900d8-98b2-4fc8-8dce-0191e64aaa21)
costing is correct at transit warehouse
end transit, valuation is not correct
![image](https://github.com/frappe/erpnext/assets/62122640/a785fb2a-5d13-49e5-8f30-16c2d135d70c)
![image](https://github.com/frappe/erpnext/assets/62122640/3ca29b4d-f789-42d5-83ee-0a0487bfcefd)![image](https://github.com/frappe/erpnext/assets/62122640/3988c7c8-fb88-471d-835f-9d8b89f54948)

### Module

stock

### Version

![image](https://github.com/frappe/erpnext/assets/62122640/aecfbd74-7d5c-44a8-bc3f-af2e670e2f4f)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-04-10 04:26:02+00:00,[],2024-06-19 00:08:36+00:00,2024-06-04 08:52:08+00:00,https://github.com/frappe/erpnext/issues/40933,"[('bug', None)]","[{'comment_id': 2079234575, 'issue_id': 2234730434, 'author': 'Poorvi-R-Bhat', 'body': 'Not able to replicate. Screenshots are attached.\r\nStock Entry\r\n![image](https://github.com/frappe/erpnext/assets/27720465/11e2c98d-ecf7-4e39-915c-71b39a65dafe)\r\nAdditional Cost:\r\n![image](https://github.com/frappe/erpnext/assets/27720465/d140aa0b-c84c-42c9-a311-a46065f191a6)\r\nValuation Rate\r\n![image](https://github.com/frappe/erpnext/assets/27720465/b0020fbe-3e60-41ef-bb72-4e7c7bff87f7)', 'created_at': datetime.datetime(2024, 4, 26, 11, 50, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079266237, 'issue_id': 2234730434, 'author': 'thida-bcn', 'body': '> Not able to replicate. Screenshots are attached. Stock Entry ![image](https://private-user-images.githubusercontent.com/27720465/325965791-11e2c98d-ecf7-4e39-915c-71b39a65dafe.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTQxMzM3MzMsIm5iZiI6MTcxNDEzMzQzMywicGF0aCI6Ii8yNzcyMDQ2NS8zMjU5NjU3OTEtMTFlMmM5OGQtZWNmNy00ZTM5LTkxNWMtNzFiMzlhNjVkYWZlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDI2VDEyMTAzM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTFlMDc3MDFiYTQ4MjkzNGFjNzNhMDRjNzA1ZWEwYjc3YjI5ZjNiYzY1NWQ0MGFkNWM3NWU5YzQwNGM1Mjc3ZjUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.hckH8QOcbpwv8pWIuEb4L5MTxNip416WmSsYWEvZnAc) Additional Cost: ![image](https://private-user-images.githubusercontent.com/27720465/325965998-d140aa0b-c84c-42c9-a311-a46065f191a6.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTQxMzM3MzMsIm5iZiI6MTcxNDEzMzQzMywicGF0aCI6Ii8yNzcyMDQ2NS8zMjU5NjU5OTgtZDE0MGFhMGItYzg0Yy00MmM5LWEzMTEtYTQ2MDY1ZjE5MWE2LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDI2VDEyMTAzM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWEzZmMwNjE2OWE2M2FhNjYyZjVmMTUwMDE0MTQ4YjQ4ZWMxNzNhZGFmNTEzYTkyOTg1MWZhZWRmMGIyNDA3ZWYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.VLimUBi8cWzUa8D1KG3wYEhVPRy_SXj4UPePdwBIBko) Valuation Rate ![image](https://private-user-images.githubusercontent.com/27720465/325966147-b0020fbe-3e60-41ef-bb72-4e7c7bff87f7.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTQxMzM3MzMsIm5iZiI6MTcxNDEzMzQzMywicGF0aCI6Ii8yNzcyMDQ2NS8zMjU5NjYxNDctYjAwMjBmYmUtM2U2MC00MWVmLWJiNzItNGU3YzdiZmY4N2Y3LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDI2VDEyMTAzM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTk3Yzc1YzBhYmEyOWU2YjkwMTdkNGFlYzQyOTg3MzM4M2JiN2Y3OTkxYjc4NTZkOTAxMDgxMmNjNDdjMzZiOGMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.c5Jdyi5LnWkWQEZnJF-NUYwOG6m7F_W7OI7uaMNRpBs)\r\n\r\nplease let me know the version you are using?', 'created_at': datetime.datetime(2024, 4, 26, 12, 11, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079274186, 'issue_id': 2234730434, 'author': 'Poorvi-R-Bhat', 'body': 'Tried replicating the issue  in both v15.18.3  and v14.61.1. Its working fine. Please check.', 'created_at': datetime.datetime(2024, 4, 26, 12, 17, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079281293, 'issue_id': 2234730434, 'author': 'thida-bcn', 'body': 'Step to reproduce\r\n\r\n1. Stock Entry\r\n  2. Material Transfer with ""Add to Transit"" with additional cost(Stock Ledger is correct)\r\n  3. Make ""End Transit"", check at stock ledger , additional cost didn\'t include in stock value', 'created_at': datetime.datetime(2024, 4, 26, 12, 21, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079283315, 'issue_id': 2234730434, 'author': 'thida-bcn', 'body': '> Tried replicating the issue in both v15.18.3 and v14.61.1. Its working fine. Please check.\r\nfor me 14.65.8 is working but version 14.66.3 is not working', 'created_at': datetime.datetime(2024, 4, 26, 12, 23, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2080390040, 'issue_id': 2234730434, 'author': 'thida-bcn', 'body': '> Tried replicating the issue in both v15.18.3 and v14.61.1. Its working fine. Please check.\r\n\r\ni forgot to mention that it was problems for serial items', 'created_at': datetime.datetime(2024, 4, 27, 6, 48, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2146970065, 'issue_id': 2234730434, 'author': 'nabinhait', 'body': ""It's working properly for serialised items as well in v15."", 'created_at': datetime.datetime(2024, 6, 4, 8, 52, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147159048, 'issue_id': 2234730434, 'author': 'thida-bcn', 'body': ""> It's working properly for serialised items as well in v15.\r\n\r\nversion 15 is working well, we had upgraded urgently to v15\r\ni will recheck with v14 latest at that time latest version had problems and decided to upgrade v15"", 'created_at': datetime.datetime(2024, 6, 4, 10, 16, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147319223, 'issue_id': 2234730434, 'author': 'thida-bcn', 'body': 'hello sir I had retest with v14 latest version\r\nplease check following link, i hope it will help\r\nhttps://1drv.ms/v/s!ApZZW_p_lZ549ElyOuhi_Yoil25B?e=Poicuc', 'created_at': datetime.datetime(2024, 6, 4, 11, 41, 20, tzinfo=datetime.timezone.utc)}]","Poorvi-R-Bhat on (2024-04-26 11:50:37 UTC): Not able to replicate. Screenshots are attached.
Stock Entry
![image](https://github.com/frappe/erpnext/assets/27720465/11e2c98d-ecf7-4e39-915c-71b39a65dafe)
Additional Cost:
![image](https://github.com/frappe/erpnext/assets/27720465/d140aa0b-c84c-42c9-a311-a46065f191a6)
Valuation Rate
![image](https://github.com/frappe/erpnext/assets/27720465/b0020fbe-3e60-41ef-bb72-4e7c7bff87f7)

thida-bcn (Issue Creator) on (2024-04-26 12:11:49 UTC): please let me know the version you are using?

Poorvi-R-Bhat on (2024-04-26 12:17:12 UTC): Tried replicating the issue  in both v15.18.3  and v14.61.1. Its working fine. Please check.

thida-bcn (Issue Creator) on (2024-04-26 12:21:48 UTC): Step to reproduce

1. Stock Entry
  2. Material Transfer with ""Add to Transit"" with additional cost(Stock Ledger is correct)
  3. Make ""End Transit"", check at stock ledger , additional cost didn't include in stock value

thida-bcn (Issue Creator) on (2024-04-26 12:23:07 UTC): for me 14.65.8 is working but version 14.66.3 is not working

thida-bcn (Issue Creator) on (2024-04-27 06:48:29 UTC): i forgot to mention that it was problems for serial items

nabinhait on (2024-06-04 08:52:08 UTC): It's working properly for serialised items as well in v15.

thida-bcn (Issue Creator) on (2024-06-04 10:16:40 UTC): version 15 is working well, we had upgraded urgently to v15
i will recheck with v14 latest at that time latest version had problems and decided to upgrade v15

thida-bcn (Issue Creator) on (2024-06-04 11:41:20 UTC): hello sir I had retest with v14 latest version
please check following link, i hope it will help
https://1drv.ms/v/s!ApZZW_p_lZ549ElyOuhi_Yoil25B?e=Poicuc

"
2233278398,issue,open,,Valuation Rate is not correct for Serial Item,"### Information about bug

when transfer item using good in transit with additional cost, valuation rate is not correct
buying rate is 1000
![image](https://github.com/frappe/erpnext/assets/62122640/06fbdc95-4b10-4666-ad2c-a8dc12fd9c10)
for transfer with additional cost (valuation rate correct)
![image](https://github.com/frappe/erpnext/assets/62122640/bb4b522e-04a7-448d-bfcc-fd2c6aa77894)
end transit valuation rate was wrong, after repost item valuation, valuation rate is correct for receiving warehouse
![image](https://github.com/frappe/erpnext/assets/62122640/c3f9c2b6-af4b-46a9-a981-dca85596a495)
when we mad sales invoice, valuation rate was not correct, even after repost item calculation
![image](https://github.com/frappe/erpnext/assets/62122640/4b7e3739-a89b-4173-91fe-38be630406e6)
![image](https://github.com/frappe/erpnext/assets/62122640/932dfe09-5a35-4fd2-a686-3d12e86e0b54)







### Module

accounts, stock, selling

### Version

![image](https://github.com/frappe/erpnext/assets/62122640/fd4828cb-259c-44d1-b279-c825ffbaca13)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-04-09 11:59:13+00:00,[],2024-04-09 11:59:13+00:00,,https://github.com/frappe/erpnext/issues/40925,"[('bug', None)]",[],
2233084870,issue,closed,completed,Wrong pricelist when invoice created from timesheet,"### Information about bug

When an invoice is created from a timesheet, the pricelist for the invoice is set to the default price list instead of the price list defined in the customer.

Creating an invoice from scratch uses the correct price list for the customer.

### Module

selling, projects

### Version

ERPNext: v15.19.2 (version-15)
Frappe Framework: v15.20.0 (version-15)

### Installation method

easy-install

### Relevant log output / Stack trace / Full Error Message.

_No response_",joni1993,2024-04-09 10:06:54+00:00,[],2024-08-30 00:09:39+00:00,2024-08-13 11:40:50+00:00,https://github.com/frappe/erpnext/issues/40921,"[('bug', None), ('released', None)]","[{'comment_id': 2288102115, 'issue_id': 2233084870, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.33.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.33.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 8, 14, 8, 4, 3, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-08-14 08:04:03 UTC): :tada: This issue has been resolved in version 15.33.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.33.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2232603918,issue,open,,Deboning process- manufacturing module,"<!--
Does anyone know how to do the deboning process with a production batch in Erpnext?

We have a chicken farm. We source whole chicken as raw material and output product is 5 finished products. Like breast meat, leg, thigh and wings.

Can this process be done in a single production order?

normally we can create BOM like several inputs (raw materials) and one output(finished goods).

cant we make? like one input (whole chicken ) and several output (breast meat , wings , leg)
",kumuduraj,2024-04-09 04:59:10+00:00,[],2024-04-30 13:15:33+00:00,,https://github.com/frappe/erpnext/issues/40914,"[('feature-request', None)]","[{'comment_id': 2068639067, 'issue_id': 2232603918, 'author': 'frewper', 'body': 'If you really want a feature to be added on any product, you should give a detailed requirement, inclusing use case and other flows. \r\n\r\nJust giving a title is not going to get you anywhere', 'created_at': datetime.datetime(2024, 4, 22, 7, 5, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2069099275, 'issue_id': 2232603918, 'author': 'kumuduraj', 'body': 'We have a chicken farm. We source whole chicken as raw material and output product is 5 finished products. Like breast meat, leg, thigh and wings.\r\n\r\nCan this process be done in a single production order?\r\n\r\nnormally we can create BOM like several inputs (raw materials) and one output(finished goods).\r\n\r\ncant we make? like one input (whole chicken ) and several output (breast meat , wings , leg)', 'created_at': datetime.datetime(2024, 4, 22, 10, 59, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2071939468, 'issue_id': 2232603918, 'author': 'frewper', 'body': 'Yes you can do it. \r\n\r\nBut do note that, erpnext is more of a dicrete manufacturing process, which in itself has its limitations on BOM revision management and BOM change management. \r\n\r\nSo in case you use if to manage your chicken farm, you will have to create and follow some processes which will not be the ideal, but still you should be able to make it work, by accepting some limitations. \r\n\r\nIf you dont have a vialble alternative to ERPNext in terms of costs, then you can use ERPNext. Otherwise it should suit your needs.', 'created_at': datetime.datetime(2024, 4, 23, 10, 18, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2078573864, 'issue_id': 2232603918, 'author': 'kumuduraj', 'body': 'Thanks for highlighting those points. It is true that ERPNext is primarily designed for unique production processes, which can pose some challenges in managing a poultry farm. Although it may not provide a perfect fit, with some adaptation and acceptance of some limitations, it can still be used effectively.\r\n\r\n\r\nERPNext is close enough to our requirements except for the deboning process. If we can manage the deboning process, Erpnext will be the right solution for our business.\r\nSo if you have any suggestion for deboning process with Erpnext module it will be very helpful for us.', 'created_at': datetime.datetime(2024, 4, 26, 3, 36, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2085309578, 'issue_id': 2232603918, 'author': 'frewper', 'body': 'As far as i can see, you can still achieve 90% of you business process on the system. You can deboning process on the discreet manufacturnig with slight over calculated results and then keep a note of the differences and then pass stock entries to correct them. This is the best I can think of right now. \r\n\r\nThis you can continue until you think you are ready to spend money on customizing the system and achieve the exact deboning process replication on the system. \r\n\r\nYou will have to do some customization to achieve what you what.', 'created_at': datetime.datetime(2024, 4, 30, 13, 15, 32, tzinfo=datetime.timezone.utc)}]","frewper on (2024-04-22 07:05:37 UTC): If you really want a feature to be added on any product, you should give a detailed requirement, inclusing use case and other flows. 

Just giving a title is not going to get you anywhere

kumuduraj (Issue Creator) on (2024-04-22 10:59:40 UTC): We have a chicken farm. We source whole chicken as raw material and output product is 5 finished products. Like breast meat, leg, thigh and wings.

Can this process be done in a single production order?

normally we can create BOM like several inputs (raw materials) and one output(finished goods).

cant we make? like one input (whole chicken ) and several output (breast meat , wings , leg)

frewper on (2024-04-23 10:18:54 UTC): Yes you can do it. 

But do note that, erpnext is more of a dicrete manufacturing process, which in itself has its limitations on BOM revision management and BOM change management. 

So in case you use if to manage your chicken farm, you will have to create and follow some processes which will not be the ideal, but still you should be able to make it work, by accepting some limitations. 

If you dont have a vialble alternative to ERPNext in terms of costs, then you can use ERPNext. Otherwise it should suit your needs.

kumuduraj (Issue Creator) on (2024-04-26 03:36:26 UTC): Thanks for highlighting those points. It is true that ERPNext is primarily designed for unique production processes, which can pose some challenges in managing a poultry farm. Although it may not provide a perfect fit, with some adaptation and acceptance of some limitations, it can still be used effectively.


ERPNext is close enough to our requirements except for the deboning process. If we can manage the deboning process, Erpnext will be the right solution for our business.
So if you have any suggestion for deboning process with Erpnext module it will be very helpful for us.

frewper on (2024-04-30 13:15:32 UTC): As far as i can see, you can still achieve 90% of you business process on the system. You can deboning process on the discreet manufacturnig with slight over calculated results and then keep a note of the differences and then pass stock entries to correct them. This is the best I can think of right now. 

This you can continue until you think you are ready to spend money on customizing the system and achieve the exact deboning process replication on the system. 

You will have to do some customization to achieve what you what.

"
2231818896,issue,closed,completed,"Contact details not Fetch in Lead, only mail id and customer name fetched","### Information about bug

When an email is sent to the ERP mail, contact details should also be fetched. Currently, only the name and email are fetched. We require the capability to fetch contact details as well as some additional content when an email is sent to the ERP mail account

### Module

CRM

### Version

Frappe Version -  v15.17.3 (version-15)
ERPNext Version - v15.17.1 (version-15)

![Screenshot_185](https://github.com/frappe/erpnext/assets/107920741/325fdf1d-9af6-48d5-a31d-e420041c8444)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",aditya3366,2024-04-08 18:11:45+00:00,[],2024-04-27 00:08:36+00:00,2024-04-12 05:55:52+00:00,https://github.com/frappe/erpnext/issues/40912,"[('bug', None)]","[{'comment_id': 2051031446, 'issue_id': 2231818896, 'author': 'Nihantra-Patel', 'body': 'Hi @aditya3366,\r\n\r\nYou can only configure the Sender Email Field, Sender Name Field, and Subject Field. Thus, when an email arrives in the system, only these three fields can be configured. Currently, there is no option available to set other content. The main limitation lies in determining where and how to set the content.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/d263bd01-aa7b-4e64-9a82-52d8a522b6dc', 'created_at': datetime.datetime(2024, 4, 12, 5, 55, 52, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-04-12 05:55:52 UTC): Hi @aditya3366,

You can only configure the Sender Email Field, Sender Name Field, and Subject Field. Thus, when an email arrives in the system, only these three fields can be configured. Currently, there is no option available to set other content. The main limitation lies in determining where and how to set the content.


https://github.com/frappe/erpnext/assets/141945075/d263bd01-aa7b-4e64-9a82-52d8a522b6dc

"
2230860197,issue,open,,Pause button not working in Job Card,"### Information about bug

The pause button which appears once we start the Job Card, is not working and throwing “Error: Job Card Time Log Row #5: Value missing for: Completed Qty” error.

Possible source is [[erpnext/manufacturing/doctype/job_card/job_card.py](url) 1][]((https://erpnext/manufacturing/doctype/job_card/job_card.py)), in line 491
`if last_row and args.get(""complete_time""):
			for row in self.time_logs:
				if not row.to_time:
					row.update(
						{
							""to_time"": get_datetime(args.get(""complete_time"")),
							""operation"": args.get(""sub_operation""),
							**""completed_qty"": (args.get(""completed_qty"") if last_row.idx == row.idx else 0.0)**,
						}
					)`


I think in the older version the same line was ‘completed_qty"": args.get(“completed_qty”) or 0.0,’


### Module

manufacturing

### Version

Frappe version - 15.x.x
ERPNext version - 14.x.x

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Error: Job Card Time Log Row #1: Value missing for: Completed Qty
```
",Krish-Vyas,2024-04-08 10:42:38+00:00,[],2024-04-08 10:43:07+00:00,,https://github.com/frappe/erpnext/issues/40908,"[('bug', None)]",[],
2229604682,issue,open,,Raising Error while using Return Components from closed Work Order,"### Information about bug

After closing work order, the Return Components button is shown
after pressing it creates stock entry with ""Material Transfer for manufacture"" type
it takes the same batches that I transferred for manufacturing before.
but on save it this Error is raised
![image](https://github.com/frappe/erpnext/assets/77942121/2515bf08-caa1-46b5-8e5d-4c879214e5f1)
I tried this process several times and returns the same issue.
if I removed batches from batch no field it will be submitted but without the original batches (it uses another batches)
Settings: 
    Items have batch nos = 1
    automatically create batch = 1
    Auto Create Serial and Batch Bundle For Outward = 1

### Module

stock, manufacturing

### Version

Frappe: v15.20.0
ERPNext: v15.19.1

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1718, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 37, in savedocs
    doc.submit()
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1046, in submit
    return self._submit()
           ^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1029, in _submit
    return self.save()
           ^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 335, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 388, in _save
    self.run_post_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1129, in run_post_save_methods
    self.run_method(""on_submit"")
  File ""apps/frappe/frappe/model/document.py"", line 960, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1320, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1302, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 957, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 233, in on_submit
    self.update_stock_ledger()
  File ""apps/erpnext/erpnext/stock/doctype/stock_entry/stock_entry.py"", line 1325, in update_stock_ledger
    self.make_sl_entries(sl_entries)
  File ""apps/erpnext/erpnext/controllers/stock_controller.py"", line 708, in make_sl_entries
    make_sl_entries(sl_entries, allow_negative_stock, via_landed_cost_voucher)
  File ""apps/erpnext/erpnext/stock/stock_ledger.py"", line 96, in make_sl_entries
    sle_doc = make_entry(sle, allow_negative_stock, via_landed_cost_voucher)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/stock/stock_ledger.py"", line 224, in make_entry
    sle.submit()
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1046, in submit
    return self._submit()
           ^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1029, in _submit
    return self.save()
           ^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 335, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 357, in _save
    return self.insert()
           ^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 313, in insert
    self.run_post_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1129, in run_post_save_methods
    self.run_method(""on_submit"")
  File ""apps/frappe/frappe/model/document.py"", line 960, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1320, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1302, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 957, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/stock/doctype/stock_ledger_entry/stock_ledger_entry.py"", line 180, in on_submit
    SerialBatchBundle(
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 28, in __init__
    self.post_process()
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 241, in post_process
    self.submit_serial_and_batch_bundle()
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 264, in submit_serial_and_batch_bundle
    self.validate_actual_qty(doc)
  File ""apps/erpnext/erpnext/stock/serial_batch_bundle.py"", line 96, in validate_actual_qty
    frappe.throw(_(msg), title=_(""Incorrect Type of Transaction""))
  File ""apps/frappe/frappe/__init__.py"", line 602, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 567, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 518, in _raise_exception
    raise exc
frappe.exceptions.ValidationError: The type of transaction of Serial and Batch Bundle <a href=""https://smartdemo15.frappe.cloud/app/serial-and-batch-bundle/SABB-00000052"">SABB-00000052</a> is <strong>Inward</strong> but as per the Actual Qty -40.0 for the item <strong>Test with Batch 1</strong> in the Stock Entry MAT-STE-2024-00020 the type of transaction should be <strong>Outward</strong>
```
",Islamation,2024-04-07 07:16:31+00:00,['rohitwaghchaure'],2025-01-17 10:05:08+00:00,,https://github.com/frappe/erpnext/issues/40896,"[('bug', None)]","[{'comment_id': 2543849523, 'issue_id': 2229604682, 'author': 'AlaaL', 'body': 'I have the same error, this really makes the manufacture module unusable\r\n@Islamation did you find any work around ?', 'created_at': datetime.datetime(2024, 12, 15, 12, 13, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2558233277, 'issue_id': 2229604682, 'author': 'Islamation', 'body': '> I have the same error, this really makes the manufacture module unusable @Islamation did you find any work around ?\r\n\r\nI enter each row then the Serial and batch bundle and change it to Inward\r\nI make that in every Serial and Batch Bundle mentioned in the Items table', 'created_at': datetime.datetime(2024, 12, 21, 20, 33, 35, tzinfo=datetime.timezone.utc)}]","AlaaL on (2024-12-15 12:13:16 UTC): I have the same error, this really makes the manufacture module unusable
@Islamation did you find any work around ?

Islamation (Issue Creator) on (2024-12-21 20:33:35 UTC): I enter each row then the Serial and batch bundle and change it to Inward
I make that in every Serial and Batch Bundle mentioned in the Items table

"
2229590330,issue,closed,completed,Opening Entry is wrongly fetched in Payment Entry,"### Information about bug

Opening Entry is wrongly fetched in Payment Entry
If we create opening entry for all customer and try to make a payment entry, the total opening balance is considered as outstanding amount for the customer and the first line of Journal Entry is considered as the customer's opening balance.

**Step to replicate :** 
Create 4-5 customers and make opening entry in Journal entry.
Create a Sales invoice for one customer except first customer in journal.
make a payment entry for any of the customer except first customer in journal.

![Greenshot 2024-04-07 11 52 57](https://github.com/frappe/erpnext/assets/9102676/b3d809b3-e2ea-427f-badf-a63e7e360bdb)
![Greenshot 2024-04-07 11 54 13](https://github.com/frappe/erpnext/assets/9102676/30a345c0-4aac-4bdd-91bf-93496e782e93)



### Module

accounts

### Version

ERPNext: v15.19.1 (version-15)

Frappe Framework: v15.20.0 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",rknroot,2024-04-07 06:30:58+00:00,['nabinhait'],2024-05-29 07:53:35+00:00,2024-04-11 05:34:06+00:00,https://github.com/frappe/erpnext/issues/40890,"[('bug', None), ('accounts', ''), ('released', None)]","[{'comment_id': 2042354713, 'issue_id': 2229590330, 'author': 'nabinhait', 'body': ""@rknroot Couldn't replicate the issue in my local test instance."", 'created_at': datetime.datetime(2024, 4, 8, 10, 5, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2049114642, 'issue_id': 2229590330, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.20.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.20.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 4, 11, 7, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2126827021, 'issue_id': 2229590330, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.70.2 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.2)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 5, 23, 11, 2, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2136773874, 'issue_id': 2229590330, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.70.3 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.3)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 5, 29, 7, 53, 34, tzinfo=datetime.timezone.utc)}]","nabinhait (Assginee) on (2024-04-08 10:05:49 UTC): @rknroot Couldn't replicate the issue in my local test instance.

frappe-pr-bot on (2024-04-11 07:41:00 UTC): :tada: This issue has been resolved in version 15.20.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.20.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

frappe-pr-bot on (2024-05-23 11:02:04 UTC): :tada: This issue has been resolved in version 14.70.2 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.2)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

frappe-pr-bot on (2024-05-29 07:53:34 UTC): :tada: This issue has been resolved in version 14.70.3 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.70.3)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2229298621,issue,open,,Wrong qty in delivery note - Using different UOM than a stock UOM,"### Information about bug

Hello,

I have an item handled in stock in Unit, and in sales in Box. 1 Box = 4 Units.
When I create a sales order then I reserve it, after that I create the delivery note for the order, the quantity which appear is wrong, the system multiply the quantity in order by the UOM conversion, so instead to make 1 box is showing 16 box (1 * 4 * 4), if the customer orders 6 boxes, in the delivery note it makes 96 (6 * 4 * 4).

But if I don't reserve a stock the quantities are correct.

### Module

stock, selling

### Version

ERPNext: v15.18.1 (version-15)

Frappe Framework: v15.19.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",WavesSkipper,2024-04-06 15:35:04+00:00,[],2024-04-06 17:10:57+00:00,,https://github.com/frappe/erpnext/issues/40885,"[('bug', None)]",[],
2229231426,issue,closed,completed,Default Value for Field not Updating ,"### Information about bug

Default Value for Field not Updating, I created custom small text field in Item doctype with Default text, after save it's showing in current items

when i change default text it's not updating in current item, in new creation item it's updated text



### Module

stock

### Version

ERPNext: v15.19.1 (version-15)
Frappe Framework: v15.20.0 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",nilpatel42,2024-04-06 12:57:24+00:00,[],2024-04-25 00:10:56+00:00,2024-04-09 07:23:11+00:00,https://github.com/frappe/erpnext/issues/40884,"[('bug', None)]","[{'comment_id': 2044309906, 'issue_id': 2229231426, 'author': 'Nihantra-Patel', 'body': ""Hi @nilpatel42,\r\n\r\nWhen you change the defaul value, it will apply to the upcoming new creation document; it will not affect the older or current transaction. If changed, then you don't know, it will break the lots of older transaction and default value feature only worked on the new creation document or new transaction."", 'created_at': datetime.datetime(2024, 4, 9, 7, 23, 11, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-04-09 07:23:11 UTC): Hi @nilpatel42,

When you change the defaul value, it will apply to the upcoming new creation document; it will not affect the older or current transaction. If changed, then you don't know, it will break the lots of older transaction and default value feature only worked on the new creation document or new transaction.

"
2229144896,issue,open,,Asset Repair Capitalization Adversely Effect Asset Depreciation ,"### Information about bug

When making asset repair and further capitalize it and increase its life, It create new depreciation schedule with enhance number of depreciation but unfortunately in depreciation schedule it wrongly calculate depreciations (it divide repair cost or remaining cost of asset with total number of depreciation in finance book). Actual treatment is that it divide the repair cost or remaining asset value to remaining number of depreciations. Furthermore the last depreciation calculation is also wrong and when we sold asset it wrongly calculate accumulated depreciation and also not include repair cost in asset value.
Before Repair
![image](https://github.com/frappe/erpnext/assets/130208382/2f6898f9-f992-4cda-82ba-cef3ca623f7a)

After Repair
![image](https://github.com/frappe/erpnext/assets/130208382/50e4a0ef-c23f-4549-8d26-a24165dfe66f)

 

### Module

assets

### Version

Erpnext V15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",maamiracma,2024-04-06 08:38:08+00:00,[],2024-04-09 09:43:42+00:00,,https://github.com/frappe/erpnext/issues/40882,"[('bug', None), ('assets', '')]",[],
2229069397,issue,closed,completed,General Ledger - Wrong voucher subtype,"### Information about bug

@deepeshgarg007 the accounting impact might be same, but a Sales Invoice is not really Debit Note as it has a different meaning. So is the case of Purchase Invoice and Credit Note. Maybe we should keep the subtype column empty for normal invoices?

_Originally posted by @rtdany10 in https://github.com/frappe/erpnext/issues/40646#issuecomment-2024810247_

### Module

accounts

### Version

v15, v14

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",rtdany10,2024-04-06 04:26:36+00:00,[],2025-02-07 07:51:09+00:00,2025-02-07 07:51:08+00:00,https://github.com/frappe/erpnext/issues/40880,"[('bug', None)]","[{'comment_id': 2642169301, 'issue_id': 2229069397, 'author': 'ljain112', 'body': 'Fixed: https://github.com/frappe/erpnext/pull/43273', 'created_at': datetime.datetime(2025, 2, 7, 7, 51, 8, tzinfo=datetime.timezone.utc)}]","ljain112 on (2025-02-07 07:51:08 UTC): Fixed: https://github.com/frappe/erpnext/pull/43273

"
2228562732,issue,closed,completed,No attribute customer_query in version 15,"### Information about bug

![image](https://github.com/frappe/erpnext/assets/35832293/0dcf41d6-f648-433b-ac46-3ba553b53f4e)
Getting this error in both v15.19.1 (version-15-hotfix) and v15.19.1 (version-15)

### Module

selling

### Version

Frappe V15
Erpnext V15 and V15 hotfix

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
request.js:473  Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1718, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/frappe/frappe/desk/search.py"", line 47, in search_link
    results = search_widget(
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
  File ""apps/frappe/frappe/desk/search.py"", line 93, in search_widget
    is_whitelisted(frappe.get_attr(query))
  File ""apps/frappe/frappe/__init__.py"", line 1708, in get_attr
    return getattr(get_module(modulename), methodname)
AttributeError: module 'erpnext.controllers.queries' has no attribute 'customer_query'
```
",maveeshah,2024-04-05 18:12:33+00:00,[],2024-04-21 00:08:52+00:00,2024-04-05 18:33:50+00:00,https://github.com/frappe/erpnext/issues/40879,"[('bug', None)]","[{'comment_id': 2040406756, 'issue_id': 2228562732, 'author': 'maveeshah', 'body': 'fixed by bench update --reset', 'created_at': datetime.datetime(2024, 4, 5, 18, 33, 50, tzinfo=datetime.timezone.utc)}]","maveeshah (Issue Creator) on (2024-04-05 18:33:50 UTC): fixed by bench update --reset

"
2227585931,issue,open,,In v15  can able to allocated payment more then invoice amount,"### Information about bug

<img width=""819"" alt=""Screenshot 2024-04-05 at 3 24 54 PM"" src=""https://github.com/frappe/erpnext/assets/21578167/21e6a223-90c4-48bb-b4ee-d6f7f0722eb6"">


We make the payment fetching the outstanding invoice it show the correct invoice but when submit the payment entries auto invoice being alllocated

### Module

accounts

### Version

ERPNext: v15.19.0 (version-15)

Frappe Framework: v15.20.0 (version-15)

Frappe HR: v15.16.0 (version-15)

India Compliance: v15.7.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",dineshpanchal93,2024-04-05 09:57:32+00:00,[],2024-04-05 09:57:43+00:00,,https://github.com/frappe/erpnext/issues/40877,"[('bug', None)]",[],
2227327478,issue,open,,Depriciation after Asset Value Adjustment ,"### Information about bug

As I have created a new asset and posted an entry of a new asset the depreciation is working fine.

Ex. 12 months depreciation so every month depreciation is 1000 which is correct
![Screenshot from 2024-04-05 13-20-12](https://github.com/frappe/erpnext/assets/132448343/cf98f83f-8501-4b2d-9fb4-2c44b44a3980)
 
Here every month depreciation needs to be 750 but we get 692.31 Rs.
 
After that When I do the Asset value adjustment process and change the valuation the depreciation calculation is changed.
![image](https://github.com/frappe/erpnext/assets/132448343/c5b03dc4-1128-48b8-967f-7c6b8f45e761)

 

### Module

assets

### Version

ERPNext: v15.18.1 (version-15)

Frappe Framework: v15.19.0 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",harsh9864,2024-04-05 07:57:01+00:00,[],2024-04-09 09:43:42+00:00,,https://github.com/frappe/erpnext/issues/40874,"[('bug', None), ('assets', '')]",[],
2227173440,issue,open,,Need a provision to Get the reference of Dunning Invoice in Journal Entry,"The user made a Dunning invoice for last year and now the settle the amount in the next new financial year. Now the user do not want to carry forward and do not want to book any transaction against the dunning.

![image](https://github.com/frappe/erpnext/assets/108865344/4e715bc9-6e45-42c3-9c87-18b4d0680039)


Expectation:
The user want a provision to adjust those dunning invoice through Journal Entry and they should able to get the reference for Dunning document as like others.
![Screenshot 2024-04-05 at 11 58 50 AM](https://github.com/frappe/erpnext/assets/108865344/bd9fbb80-be70-4721-9799-8cfb13ce9fd9)
",sanjay141986,2024-04-05 06:29:16+00:00,[],2024-04-05 08:14:04+00:00,,https://github.com/frappe/erpnext/issues/40872,"[('feature-request', None)]","[{'comment_id': 2039220552, 'issue_id': 2227173440, 'author': 'cdiethelm', 'body': 'Its pretty important to get those booking out of the receivables.\r\n\r\nSometimes dunnings are losses when customers dont pay up. \r\n\r\nAdditionally, when there is more than one dunning present, there is no way to create a payment and mark it as a loss. \r\n\r\nExample: \r\nDunning 1 - 5 USD\r\nDunning 2 - 25 USD\r\n\r\nWhen i mark the payment for dunning 2, the dunning 1 is still present and needs to be booked out. Like a reverse booking with the current date.', 'created_at': datetime.datetime(2024, 4, 5, 8, 14, 3, tzinfo=datetime.timezone.utc)}]","cdiethelm on (2024-04-05 08:14:03 UTC): Its pretty important to get those booking out of the receivables.

Sometimes dunnings are losses when customers dont pay up. 

Additionally, when there is more than one dunning present, there is no way to create a payment and mark it as a loss. 

Example: 
Dunning 1 - 5 USD
Dunning 2 - 25 USD

When i mark the payment for dunning 2, the dunning 1 is still present and needs to be booked out. Like a reverse booking with the current date.

"
2227171711,issue,open,,Work Order Operation time isn't calculated correct,"### Information about bug

Hi,

Szenario:
I created a BOM with:
- amount 100 
- one operation with time 100

Means (from my understanding) ... if I produce ten, would cost ten minutes, if i produce 1 cost one minute etc.

If my understanding is correct, then there's a bug ->

I create a work order (using the BOM above) and want to produce 100. then the work order shows me that the Operation time is one minute .... if I would produce 10000 then the time is hundred.



### Module

manufacturing

### Version

erpnext 15.19.1

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
---
```
",schmutzfuss42,2024-04-05 06:27:59+00:00,[],2024-04-13 04:31:43+00:00,,https://github.com/frappe/erpnext/issues/40871,"[('bug', None)]","[{'comment_id': 2039437374, 'issue_id': 2227171711, 'author': 'JeanWLC', 'body': ""@schmutzfuss42 I logged a similar issue yesterday. Maybe you can check it and see if it's the same issue: #40862 \r\n\r\nI think believe uncovered the root cause and documented it in my issue."", 'created_at': datetime.datetime(2024, 4, 5, 10, 24, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2051496367, 'issue_id': 2227171711, 'author': 'Nihantra-Patel', 'body': ""Worked properly @schmutzfuss42,\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/5010d504-a40d-4a3a-a463-d2a766eb5696\r\n\r\nIf I'm wrong, then explain the process and share the video documentary, if possible."", 'created_at': datetime.datetime(2024, 4, 12, 10, 30, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2051511560, 'issue_id': 2227171711, 'author': 'JeanWLC', 'body': ""@Nihantra-Patel @schmutzfuss42 It worked because you've set the Production Item quantity to 1 on the BOM. I use that as a workaround (setting BOM qty to 1). Once the BOM qty > 1, things seem to go wrong. Please see #40862 for a detailed explanation - the issue I logged seems to be the same issue as this one."", 'created_at': datetime.datetime(2024, 4, 12, 10, 40, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2053416680, 'issue_id': 2227171711, 'author': 'schmutzfuss42', 'body': ""### Workaround idea\r\n\r\nOur workaround is only possible as long as the quantity is smaller or similar to the batch size, if it's bigger, the system will create jobcards which have fulltime for every jobcard, instead a divided time\r\nQuantity in BOM 1, time one minute, batch size 200 -> create a work order for 401 pcs -> getting three job cards, every job card has 40,1 Minutes (instead of the whole jobcards together should have 401 Minutes, JC1: 200, JC2: 200, JC3: 1)\r\n\r\nOur current workarond:\r\n.../frappe-bench/apps/erpnext/erpnext/manufacturing/doctype/work_order/work_order.py\r\n\r\nLine 858:\r\nOLD: d.time_in_mins = flt(d.time_in_mins) * (flt(self.qty) / flt(d.batch_size))\r\nNEW: d.time_in_mins = flt(d.time_in_mins) * flt(self.qty)\r\n\r\nat least until the max batch size it works for us, waiting for a professional developer here ... to find the correct solution for that :-)"", 'created_at': datetime.datetime(2024, 4, 13, 4, 30, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2053423955, 'issue_id': 2227171711, 'author': 'schmutzfuss42', 'body': ""> @Nihantra-Patel @schmutzfuss42 It worked because you've set the Production Item quantity to 1 on the BOM. I use that as a workaround (setting BOM qty to 1). Once the BOM qty > 1, things seem to go wrong. Please see #40862 for a detailed explanation - the issue I logged seems to be the same issue as this one.\r\n\r\n\r\n\r\n> Worked properly @schmutzfuss42,\r\n> \r\n>  scrnli_12_04_2024_15-58-38.mp4 \r\n> If I'm wrong, then explain the process and share the video documentary, if possible.\r\n\r\npluase Just change BOM quantity from 1 to another, higher value .... our BOM's are regularly about 100 items, .... but you will see, whenever the BOM Quantity isn't one anymore, you will face issues"", 'created_at': datetime.datetime(2024, 4, 13, 4, 31, 43, tzinfo=datetime.timezone.utc)}]","JeanWLC on (2024-04-05 10:24:28 UTC): @schmutzfuss42 I logged a similar issue yesterday. Maybe you can check it and see if it's the same issue: #40862 

I think believe uncovered the root cause and documented it in my issue.

Nihantra-Patel on (2024-04-12 10:30:09 UTC): Worked properly @schmutzfuss42,


https://github.com/frappe/erpnext/assets/141945075/5010d504-a40d-4a3a-a463-d2a766eb5696

If I'm wrong, then explain the process and share the video documentary, if possible.

JeanWLC on (2024-04-12 10:40:23 UTC): @Nihantra-Patel @schmutzfuss42 It worked because you've set the Production Item quantity to 1 on the BOM. I use that as a workaround (setting BOM qty to 1). Once the BOM qty > 1, things seem to go wrong. Please see #40862 for a detailed explanation - the issue I logged seems to be the same issue as this one.

schmutzfuss42 (Issue Creator) on (2024-04-13 04:30:02 UTC): ### Workaround idea

Our workaround is only possible as long as the quantity is smaller or similar to the batch size, if it's bigger, the system will create jobcards which have fulltime for every jobcard, instead a divided time
Quantity in BOM 1, time one minute, batch size 200 -> create a work order for 401 pcs -> getting three job cards, every job card has 40,1 Minutes (instead of the whole jobcards together should have 401 Minutes, JC1: 200, JC2: 200, JC3: 1)

Our current workarond:
.../frappe-bench/apps/erpnext/erpnext/manufacturing/doctype/work_order/work_order.py

Line 858:
OLD: d.time_in_mins = flt(d.time_in_mins) * (flt(self.qty) / flt(d.batch_size))
NEW: d.time_in_mins = flt(d.time_in_mins) * flt(self.qty)

at least until the max batch size it works for us, waiting for a professional developer here ... to find the correct solution for that :-)

schmutzfuss42 (Issue Creator) on (2024-04-13 04:31:43 UTC): pluase Just change BOM quantity from 1 to another, higher value .... our BOM's are regularly about 100 items, .... but you will see, whenever the BOM Quantity isn't one anymore, you will face issues

"
2227073071,issue,closed,completed,Account is not set for the dashboard chart Bank Balance,"### Information about bug

Account is not set for the dashboard chart Bank Balance

![image](https://github.com/frappe/erpnext/assets/135511086/bc03ed6d-3d19-4161-8985-fccd18922601)


### Module

accounts

### Version

ERPNext: v15.19.0 (version-15)
Frappe Framework: v15.20.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",nilpatel42,2024-04-05 05:24:45+00:00,[],2024-04-25 00:10:55+00:00,2024-04-09 07:41:51+00:00,https://github.com/frappe/erpnext/issues/40870,"[('bug', None)]","[{'comment_id': 2044349565, 'issue_id': 2227073071, 'author': 'Nihantra-Patel', 'body': 'If not added then add it.\r\n\r\n```\r\nlocals["":Company""][frappe.defaults.get_user_default(""Company"")][""default_bank_account""]\r\n```\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/f0eb668f-2310-4c1d-b044-6e191ea3b871', 'created_at': datetime.datetime(2024, 4, 9, 7, 41, 51, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-04-09 07:41:51 UTC): If not added then add it.

```
locals["":Company""][frappe.defaults.get_user_default(""Company"")][""default_bank_account""]
```


https://github.com/frappe/erpnext/assets/141945075/f0eb668f-2310-4c1d-b044-6e191ea3b871

"
2227016732,issue,closed,completed,"Promotional Scheme is not working as expected for the ""is recurring"" option","### Information about bug

Promotional Scheme is not working as expected for the ""is recurring"" option. 
For example, I want to set up a Promotion for Buy 10 Nos. get 1 Nos. Free and want to setup ""is recurring"".
Expected Result:
If customer Buys 10 Nos. there should be 1 Nos. Free (Working Properly)
If customer Buys 20 Nos. there should be 2 Nos. Free (Working Properly)
If customer Buys 15 Nos. there should be 1 Nos. Free (Not working - System is giving 1.5 Nos. as free, which is incorrect)
if customer Buys 25 Nos. there should be 2 Nos. Free (Not working - System is giving 2.5 Nos. as free, which is incorrect)

Steps to re-produce:

1. Create a Promotional Scheme ""Apply on"" Item Code
2. Define the Product Discount Slab as below:
    Min. Qty. - 10
    Max Qty. - 0
    Same Item - True
    Free Qty. - 1
    ""is recurring"" - True
3. Save the promotional Scheme and test it.

    

> 


### Module

selling

### Version

ERPNext: v14.54.2 (version-14)
Frappe Framework: v14.59.0 (version-14)
Frappe HR: v14.19.0 (version-14)
Payments: v0.0.1 (develop)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",paavaninfotech,2024-04-05 04:45:05+00:00,[],2024-12-07 00:11:05+00:00,2024-11-22 05:52:07+00:00,https://github.com/frappe/erpnext/issues/40867,"[('bug', None)]","[{'comment_id': 2492925324, 'issue_id': 2227016732, 'author': 'paavaninfotech', 'body': 'Issue is fixed in https://github.com/frappe/erpnext/pull/44266', 'created_at': datetime.datetime(2024, 11, 22, 5, 52, 2, tzinfo=datetime.timezone.utc)}]","paavaninfotech (Issue Creator) on (2024-11-22 05:52:02 UTC): Issue is fixed in https://github.com/frappe/erpnext/pull/44266

"
2226757886,issue,closed,completed,POS Closing Entry not able to create sales invoice in a multi company instance,"### Information about bug

POS Invoice & POS Closing Entry belongs to Company B,

When we submit POS Closing Entry, it try to creates Sales invoices for same comany (B), but the change amount accout is getting picked of company A (thats the error), it should pick account of company B.

I think is just automatically picking company A defaults cash change account on every transaction, instead it should use same company default account.

### Module

accounts, selling

### Version

V14

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
Sales Invoice ACC-SINV-2024-00001: Account 1110 - Cash - PSAR does not belong to Company A
```
",avaiskhatri,2024-04-05 00:47:34+00:00,[],2024-04-25 00:10:54+00:00,2024-04-09 08:51:34+00:00,https://github.com/frappe/erpnext/issues/40866,"[('bug', None)]","[{'comment_id': 2044479241, 'issue_id': 2226757886, 'author': 'Nihantra-Patel', 'body': 'Your reference: https://discuss.frappe.io/t/pos-closing-entry-multi-company/120498/6?u=ncp', 'created_at': datetime.datetime(2024, 4, 9, 8, 51, 34, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-04-09 08:51:34 UTC): Your reference: https://discuss.frappe.io/t/pos-closing-entry-multi-company/120498/6?u=ncp

"
2225970032,issue,closed,completed,PDF Generation / PDF Sending gives error,"### Information about bug

Hey guys,

I hope someone can help me. I have a freshly installed ERPNext Docker instance without Traefik and behind an nginx reverse proxy (Nginx Proxy Manager). Everything seems to work fine except generating and sending PDFs (same error for both). I scoured the ERPNext Github issues and Frappe Forum but none of the propose remedies seem to work. Does anyone know what I could try? Setting the host_name parameter in the site settings file (in any proposed variation) does yield any better results. 

Any help is greatly appeciated. 

### Module

selling

### Version

15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1718, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/print_format.py"", line 234, in download_pdf
    pdf_file = frappe.get_print(
               ^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 2134, in get_print
    return get_pdf(html, options=pdf_options, output=output) if as_pdf else html
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/pdf.py"", line 89, in get_pdf
    filedata = pdfkit.from_string(html, options=options or {}, verbose=True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pdfkit/api.py"", line 75, in from_string
    return r.to_pdf(output_path)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""env/lib/python3.11/site-packages/pdfkit/pdfkit.py"", line 201, in to_pdf
    self.handle_error(exit_code, stderr)
  File ""env/lib/python3.11/site-packages/pdfkit/pdfkit.py"", line 155, in handle_error
    raise IOError('wkhtmltopdf reported an error:\n' + stderr)
OSError: wkhtmltopdf reported an error:
Exit with code 1 due to network error: ConnectionRefusedError
```
",danielslyman,2024-04-04 16:18:48+00:00,[],2024-04-27 00:08:34+00:00,2024-04-12 10:31:22+00:00,https://github.com/frappe/erpnext/issues/40864,"[('bug', None)]","[{'comment_id': 2047725109, 'issue_id': 2225970032, 'author': '0xD0M1M0', 'body': 'Please check here: https://github.com/frappe/frappe/issues/23958', 'created_at': datetime.datetime(2024, 4, 10, 14, 34, 14, tzinfo=datetime.timezone.utc)}]","0xD0M1M0 on (2024-04-10 14:34:14 UTC): Please check here: https://github.com/frappe/frappe/issues/23958

"
2225358406,issue,open,,Inconsistent calculation of operational cost from BOM to Work Order,"### Information about bug

When the cost of an operation is calculated for a Work Order, it doesn't correspond to (is not what is expected) when taking into account what is calculated on the Costing tab of the BOM

The problem seems to lie with how the operational cost is calculated for the BOM using the quantity set on the Production Items tab.

Assume the following values are set on the BOM (to manufacture 5 items):
- Production Item tab:
  - Quantity: 5
  - Operations tab:
    - Operation properties:
      - Operation time: 60 minutes
      - Hour rate: 68
      - Batch size: 10
      - Set Operating Cost Based On BOM Quantity: checked (sets operation cost to be calculated per item)
	
![image](https://github.com/frappe/erpnext/assets/146828315/ffc06772-cded-4799-b48c-68e1532bdef5)


  When the Costing tab is viewed, operating cost will be 34.00. This seems to be calculated as follows:
		
  Hour rate * (Operation time / 60) * Quantity / Batch size = Total Operating Cost
  68 * (60 / 60) * 5 / 10 = 34 

![image](https://github.com/frappe/erpnext/assets/146828315/b64bb6de-2dba-4816-999c-fb673a5e578f)

  This is as expected

When creating a new Work Order for a quantity of 20, operating cost seems to be calculated as follows:
		
  Hour rate * (Operation time / 60) / Quantity / Batch size * Work Order qty to manufacture = Operating Cost
  68 * (60 / 60)  / 5 / 10 * 20 = 27.2

![image](https://github.com/frappe/erpnext/assets/146828315/b5fb6155-8e2e-48ab-95e2-5436c09d4f13)


This is not what is expected taking into account the operational cost per unit on the BOM Costing tab:
Operation cost per unit according to BOM:
Hour rate * (Operation time / 60)  / Batch size = Operating Cost per unit
68 * (60 / 60)  / 10 = 6.8

Thus the operation cost on a Work Order for 20 should be:
6.8 * 20 = 136

While the BOM Costing tab times cost per unit with quantity set on the BOM, the Work Order divides by that quantity and multiplies with quantity set for the Work Order

So it seems that the Work Order calculation assumes that the operation time set on the BOM is the time it takes to manufacture the quantity set on the Production Item tab, but the BOM Costing tab use the production time as time per unit to manufacture. This is supported by looking at the production time calculated on the Word Order too: the production time is lower than expected by a factor = to BOM quantity


### Module

manufacturing

### Version

ERPNext: v14.27.12
Frappe Framework: v14.40.0

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",JeanWLC,2024-04-04 12:26:53+00:00,[],2024-06-12 10:47:51+00:00,,https://github.com/frappe/erpnext/issues/40862,"[('bug', None)]","[{'comment_id': 2039445261, 'issue_id': 2225358406, 'author': 'JeanWLC', 'body': ""As a workaround, I'm setting the quantity of the BOM on the Production Item tab to 1, and the quantity of the raw materials to correspond to that"", 'created_at': datetime.datetime(2024, 4, 5, 10, 29, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2053371037, 'issue_id': 2225358406, 'author': 'schmutzfuss42', 'body': ""I answer here, coz my bug is mentioned as duplicated to this one (I'm focussed on time issue from BOM->WO->JC):\r\n\r\nThe workaround is only possible as long as the quantity is smaller or similar to the batch size, if it's bigger, the system will create jobcards which have fulltime for every jobcard, instead a divided time\r\nQuantity in BOM 1, time one minute, batch size 200 -> create a work order for 401 pcs -> getting three job cards, every job card has 40,1 Minutes (instead of the whole jobcards together should have 401 Minutes, JC1: 200, JC2: 200, JC3: 1)\r\n\r\nOur current workarond:\r\n.../frappe-bench/apps/erpnext/erpnext/manufacturing/doctype/work_order/work_order.py\r\n\r\nLine 858:\r\nOLD:  d.time_in_mins = flt(d.time_in_mins) * (flt(self.qty) / flt(d.batch_size))\r\nNEW: d.time_in_mins = flt(d.time_in_mins) * flt(self.qty)\r\n\r\nat least until the max batch size it works for us, waiting for a professional developer here ... to find the correct solution for that :-)"", 'created_at': datetime.datetime(2024, 4, 13, 4, 17, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2053768056, 'issue_id': 2225358406, 'author': 'JeanWLC', 'body': ""> I answer here, coz my bug is mentioned as duplicated to this one (I'm focussed on time issue from BOM->WO->JC):\r\n> \r\n> The workaround is only possible as long as the quantity is smaller or similar to the batch size, if it's bigger, the system will create jobcards which have fulltime for every jobcard, instead a divided time Quantity in BOM 1, time one minute, batch size 200 -> create a work order for 401 pcs -> getting three job cards, every job card has 40,1 Minutes (instead of the whole jobcards together should have 401 Minutes, JC1: 200, JC2: 200, JC3: 1)\r\n> \r\n> Our current workarond: .../frappe-bench/apps/erpnext/erpnext/manufacturing/doctype/work_order/work_order.py\r\n> \r\n> Line 858: OLD: d.time_in_mins = flt(d.time_in_mins) * (flt(self.qty) / flt(d.batch_size)) NEW: d.time_in_mins = flt(d.time_in_mins) * flt(self.qty)\r\n> \r\n> at least until the max batch size it works for us, waiting for a professional developer here ... to find the correct solution for that :-)\r\n\r\n@schmutzfuss42 It seems we may have two separate, but related, issues. I tried replicating your findings, but always got a single job card. Can you please share your exact BOM settings and work order through screenshots so I can confirm whether we do indeed have the exact same issue?"", 'created_at': datetime.datetime(2024, 4, 13, 21, 42, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2053771534, 'issue_id': 2225358406, 'author': 'JeanWLC', 'body': '> > I answer here, coz my bug is mentioned as duplicated to this one (I\'m focussed on time issue from BOM->WO->JC):\r\n> > The workaround is only possible as long as the quantity is smaller or similar to the batch size, if it\'s bigger, the system will create jobcards which have fulltime for every jobcard, instead a divided time Quantity in BOM 1, time one minute, batch size 200 -> create a work order for 401 pcs -> getting three job cards, every job card has 40,1 Minutes (instead of the whole jobcards together should have 401 Minutes, JC1: 200, JC2: 200, JC3: 1)\r\n> > Our current workarond: .../frappe-bench/apps/erpnext/erpnext/manufacturing/doctype/work_order/work_order.py\r\n> > Line 858: OLD: d.time_in_mins = flt(d.time_in_mins) * (flt(self.qty) / flt(d.batch_size)) NEW: d.time_in_mins = flt(d.time_in_mins) * flt(self.qty)\r\n> > at least until the max batch size it works for us, waiting for a professional developer here ... to find the correct solution for that :-)\r\n> \r\n> @schmutzfuss42 It seems we may have two separate, but related, issues. I tried replicating your findings, but always got a single job card. Can you please share your exact BOM settings and work order through screenshots so I can confirm whether we do indeed have the exact same issue?\r\n\r\n@schmutzfuss42 Ignore my previous comment. Just realized my operation wasn\'t set with ""Create Job Card based on Batch Size"" enabled. @Nihantra-Patel   I was able to replicate @schmutzfuss42 findings that operation times are not divided up correctly between job cards', 'created_at': datetime.datetime(2024, 4, 13, 21, 58, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2053789422, 'issue_id': 2225358406, 'author': 'schmutzfuss42', 'body': '> > > I answer here, coz my bug is mentioned as duplicated to this one (I\'m focussed on time issue from BOM->WO->JC):\r\n> > > The workaround is only possible as long as the quantity is smaller or similar to the batch size, if it\'s bigger, the system will create jobcards which have fulltime for every jobcard, instead a divided time Quantity in BOM 1, time one minute, batch size 200 -> create a work order for 401 pcs -> getting three job cards, every job card has 40,1 Minutes (instead of the whole jobcards together should have 401 Minutes, JC1: 200, JC2: 200, JC3: 1)\r\n> > > Our current workarond: .../frappe-bench/apps/erpnext/erpnext/manufacturing/doctype/work_order/work_order.py\r\n> > > Line 858: OLD: d.time_in_mins = flt(d.time_in_mins) * (flt(self.qty) / flt(d.batch_size)) NEW: d.time_in_mins = flt(d.time_in_mins) * flt(self.qty)\r\n> > > at least until the max batch size it works for us, waiting for a professional developer here ... to find the correct solution for that :-)\r\n> > \r\n> > \r\n> > @schmutzfuss42 It seems we may have two separate, but related, issues. I tried replicating your findings, but always got a single job card. Can you please share your exact BOM settings and work order through screenshots so I can confirm whether we do indeed have the exact same issue?\r\n> \r\n> @schmutzfuss42 Ignore my previous comment. Just realized my operation wasn\'t set with ""Create Job Card based on Batch Size"" enabled. @nihantra I was able to replicate @schmutzfuss42 findings that operation times are not divided up correctly between job cards\r\n\r\nhttps://github.com/frappe/erpnext/assets/150498137/0e66ab24-97f6-4959-b449-ba06b49c890b\r\n\r\nShould\'nt be one minute in the work order, should\'nt be two times one minute in the jobcard.\r\nShould be 100 Minute in the work order, should be two times 50 minutes in the jobcard (together 100 minutes)', 'created_at': datetime.datetime(2024, 4, 13, 23, 5, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2054135127, 'issue_id': 2225358406, 'author': 'JeanWLC', 'body': ""@Nihantra-Patel what's the difference between batch size set for an operation in the BOM settings\r\n![image](https://github.com/frappe/erpnext/assets/146828315/06612e1c-a6a6-4f96-9306-4ce14accf910)\r\n\r\nand batch size set on the operation itself outside the BOM\r\n![image](https://github.com/frappe/erpnext/assets/146828315/348ddd02-9228-485c-ae97-78e2a1148a90)\r\n\r\nWhich would take precedence? Doesn't seem like the second is being used."", 'created_at': datetime.datetime(2024, 4, 14, 17, 58, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2054145121, 'issue_id': 2225358406, 'author': 'JeanWLC', 'body': '> > > > I answer here, coz my bug is mentioned as duplicated to this one (I\'m focussed on time issue from BOM->WO->JC):\r\n> > > > The workaround is only possible as long as the quantity is smaller or similar to the batch size, if it\'s bigger, the system will create jobcards which have fulltime for every jobcard, instead a divided time Quantity in BOM 1, time one minute, batch size 200 -> create a work order for 401 pcs -> getting three job cards, every job card has 40,1 Minutes (instead of the whole jobcards together should have 401 Minutes, JC1: 200, JC2: 200, JC3: 1)\r\n> > > > Our current workarond: .../frappe-bench/apps/erpnext/erpnext/manufacturing/doctype/work_order/work_order.py\r\n> > > > Line 858: OLD: d.time_in_mins = flt(d.time_in_mins) * (flt(self.qty) / flt(d.batch_size)) NEW: d.time_in_mins = flt(d.time_in_mins) * flt(self.qty)\r\n> > > > at least until the max batch size it works for us, waiting for a professional developer here ... to find the correct solution for that :-)\r\n> > > \r\n> > > \r\n> > > @schmutzfuss42 It seems we may have two separate, but related, issues. I tried replicating your findings, but always got a single job card. Can you please share your exact BOM settings and work order through screenshots so I can confirm whether we do indeed have the exact same issue?\r\n> > \r\n> > \r\n> > @schmutzfuss42 Ignore my previous comment. Just realized my operation wasn\'t set with ""Create Job Card based on Batch Size"" enabled. @nihantra I was able to replicate @schmutzfuss42 findings that operation times are not divided up correctly between job cards\r\n> \r\n>  BOM-WorkOrder-JobCard_withoutPatch.mp4 \r\n> Should\'nt be one minute in the work order, should\'nt be two times one minute in the jobcard. Should be 100 Minute in the work order, should be two times 50 minutes in the jobcard (together 100 minutes)\r\n\r\nThis is definitely the the sam issue as I described when I opened this issue. Using the calculations there explains why the operation time is one minute, but the distributions of operating times of the work order to job cards being incorrect I didn\'t notice before, because I didn\'t create job cards per batch size. I was able to replicate this issue too.', 'created_at': datetime.datetime(2024, 4, 14, 18, 20, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162695363, 'issue_id': 2225358406, 'author': 'JeanWLC', 'body': '@schmutzfuss42 Can you please confirm whether this is considered a bug or not, or if you need more info to clarify something?', 'created_at': datetime.datetime(2024, 6, 12, 10, 47, 50, tzinfo=datetime.timezone.utc)}]","JeanWLC (Issue Creator) on (2024-04-05 10:29:25 UTC): As a workaround, I'm setting the quantity of the BOM on the Production Item tab to 1, and the quantity of the raw materials to correspond to that

schmutzfuss42 on (2024-04-13 04:17:56 UTC): I answer here, coz my bug is mentioned as duplicated to this one (I'm focussed on time issue from BOM->WO->JC):

The workaround is only possible as long as the quantity is smaller or similar to the batch size, if it's bigger, the system will create jobcards which have fulltime for every jobcard, instead a divided time
Quantity in BOM 1, time one minute, batch size 200 -> create a work order for 401 pcs -> getting three job cards, every job card has 40,1 Minutes (instead of the whole jobcards together should have 401 Minutes, JC1: 200, JC2: 200, JC3: 1)

Our current workarond:
.../frappe-bench/apps/erpnext/erpnext/manufacturing/doctype/work_order/work_order.py

Line 858:
OLD:  d.time_in_mins = flt(d.time_in_mins) * (flt(self.qty) / flt(d.batch_size))
NEW: d.time_in_mins = flt(d.time_in_mins) * flt(self.qty)

at least until the max batch size it works for us, waiting for a professional developer here ... to find the correct solution for that :-)

JeanWLC (Issue Creator) on (2024-04-13 21:42:29 UTC): @schmutzfuss42 It seems we may have two separate, but related, issues. I tried replicating your findings, but always got a single job card. Can you please share your exact BOM settings and work order through screenshots so I can confirm whether we do indeed have the exact same issue?

JeanWLC (Issue Creator) on (2024-04-13 21:58:15 UTC): @schmutzfuss42 Ignore my previous comment. Just realized my operation wasn't set with ""Create Job Card based on Batch Size"" enabled. @Nihantra-Patel   I was able to replicate @schmutzfuss42 findings that operation times are not divided up correctly between job cards

schmutzfuss42 on (2024-04-13 23:05:51 UTC): https://github.com/frappe/erpnext/assets/150498137/0e66ab24-97f6-4959-b449-ba06b49c890b

Should'nt be one minute in the work order, should'nt be two times one minute in the jobcard.
Should be 100 Minute in the work order, should be two times 50 minutes in the jobcard (together 100 minutes)

JeanWLC (Issue Creator) on (2024-04-14 17:58:26 UTC): @Nihantra-Patel what's the difference between batch size set for an operation in the BOM settings
![image](https://github.com/frappe/erpnext/assets/146828315/06612e1c-a6a6-4f96-9306-4ce14accf910)

and batch size set on the operation itself outside the BOM
![image](https://github.com/frappe/erpnext/assets/146828315/348ddd02-9228-485c-ae97-78e2a1148a90)

Which would take precedence? Doesn't seem like the second is being used.

JeanWLC (Issue Creator) on (2024-04-14 18:20:28 UTC): This is definitely the the sam issue as I described when I opened this issue. Using the calculations there explains why the operation time is one minute, but the distributions of operating times of the work order to job cards being incorrect I didn't notice before, because I didn't create job cards per batch size. I was able to replicate this issue too.

JeanWLC (Issue Creator) on (2024-06-12 10:47:50 UTC): @schmutzfuss42 Can you please confirm whether this is considered a bug or not, or if you need more info to clarify something?

"
2224509165,issue,open,,Asset creation with any particular PR with some quantity & Asset inventory,"### Information about bug

when i create an asset with particular Purchase Receipt with fixed quantity.
Let's say i have one purchase receipt with asset quantity 10.So i will create 10 assets manually. but when i create 11th asset with same purchase receipt it's still getting created.

also where is the record of the total purchased asset quantities. 
let's say i buy 10 asset but i am creating just 5 asset in system. where is the record of other 5 quantities of that asset item.

### Module

assets

### Version

Frappe Framework: v15.7.0(version-15)
ERPNext: v15.7.0 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",Srushti132,2024-04-04 05:08:16+00:00,[],2024-04-09 09:43:41+00:00,,https://github.com/frappe/erpnext/issues/40851,"[('bug', None), ('assets', '')]",[],
2222432980,issue,open,,Keep orginial so refs on pe of adv payment after move to si,"https://github.com/frappe/erpnext/pull/40643#issuecomment-2034059364

Cc @ruthra-kumar 


- Keep references to SO on PE after conversion to an Invoice (edit: in a new field)
- Copy references instead (edit: to that new field, eg: `previous_references`)
- thereby: Allow the Advance Payment status info to be updated on the SO upon cancel modification of PE
- thereby: also update the PR status when PE is modified (currently not happening, cause references are ""lost"", PR still links SO)",blaggacao,2024-04-03 09:41:01+00:00,[],2024-04-03 09:56:57+00:00,,https://github.com/frappe/erpnext/issues/40847,"[('bug', None)]","[{'comment_id': 2034098635, 'issue_id': 2222432980, 'author': 'ruthra-kumar', 'body': ""> * Keep references to SO on PE after conversion to an Invoice\r\n\r\nI don't think it is possible. Because,\r\n1. Every reference in Payment Entry reflects in Ledger, which in turn updates the 'Advance Paid' in Sales/Purchase Orders and 'Outstanding Amount' in Sales/Purchase Invoices\r\n2. Total allocated amount shouldn't be greater than the paid amount. \r\n\r\nIf you allow duplicate references (reference to SO and it's SI), it breaks both of the above. Which essentially leads to overallocation."", 'created_at': datetime.datetime(2024, 4, 3, 9, 49, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2034108753, 'issue_id': 2222432980, 'author': 'blaggacao', 'body': 'I see, so we\'d have to some how ""triangulate"" and recover the references from the SI.\r\n\r\nOr:\r\n\r\nWe copy the old references to the SO to a new field `<xyz>_references` that is then solely used for the purpose to triangulate the status of the PR and the advanced payment status of the SO, but without modifying any other existing logic. :shrug: \r\n\r\nThis latter solution would also hold the added benefit that the link to the PE would remain visible from the SO links page (from where it currently is removed - and we had user complaints about this in the beginning).', 'created_at': datetime.datetime(2024, 4, 3, 9, 53, 24, tzinfo=datetime.timezone.utc)}]","ruthra-kumar on (2024-04-03 09:49:27 UTC): I don't think it is possible. Because,
1. Every reference in Payment Entry reflects in Ledger, which in turn updates the 'Advance Paid' in Sales/Purchase Orders and 'Outstanding Amount' in Sales/Purchase Invoices
2. Total allocated amount shouldn't be greater than the paid amount. 

If you allow duplicate references (reference to SO and it's SI), it breaks both of the above. Which essentially leads to overallocation.

blaggacao (Issue Creator) on (2024-04-03 09:53:24 UTC): I see, so we'd have to some how ""triangulate"" and recover the references from the SI.

Or:

We copy the old references to the SO to a new field `<xyz>_references` that is then solely used for the purpose to triangulate the status of the PR and the advanced payment status of the SO, but without modifying any other existing logic. :shrug: 

This latter solution would also hold the added benefit that the link to the PE would remain visible from the SO links page (from where it currently is removed - and we had user complaints about this in the beginning).

"
2222106735,issue,open,,Inbuilt variable for naming illogical,"Inbuilt variable for fiscal year is illogical compared to the warning given by the system regarding limitation of numbers for GST. I feel .FY. should be in 2 digit year form.

The system itself previews generating invoice numbers as 19 digits if one simply puts SINV-.FY. as the format whereas the warning on the top says maximum 16 allowed in GST. If we try to combine with fields or more customised naming, the variable .FY. leaves no room for any other variables or fields.


![image](https://github.com/frappe/erpnext/assets/64956588/2c2557e4-ad5a-4fd9-8dae-636183a7cc50)
",nakul80,2024-04-03 07:19:31+00:00,[],2024-04-23 10:38:54+00:00,,https://github.com/frappe/erpnext/issues/40846,"[('feature-request', None)]","[{'comment_id': 2071972915, 'issue_id': 2222106735, 'author': 'nakul80', 'body': 'Anyone can pick this up?', 'created_at': datetime.datetime(2024, 4, 23, 10, 38, 53, tzinfo=datetime.timezone.utc)}]","nakul80 (Issue Creator) on (2024-04-23 10:38:53 UTC): Anyone can pick this up?

"
2221501078,issue,open,,map_current_doc: relies on item_code which is not mandatory for Sales Invoice,"### Information about bug

The Sales Invoice in ERPNext has been designed to have a non-mandatory item_code for good reason: you may not want to use Items and the stock module at all and may just want to invoice arbitrary lines.

Except the first thing that `map_current_doc` does is check for the existence of an item_code on a line and remove the line if it doesn't exist.

https://github.com/frappe/erpnext/blob/c3b2ed57f653fd859a754e4bf551062206bf0f71/erpnext/public/js/utils.js#L845

### Module

accounts

### Version

v16 develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-04-02 21:37:59+00:00,[],2024-04-02 21:37:59+00:00,,https://github.com/frappe/erpnext/issues/40843,"[('bug', None)]",[],
2221052464,issue,open,,"Item consumed during manufacturing - Qty is getting in negative in ""Manufacture"" Entry","### Information about bug

Hi Team,

We are using V15 instance for Manufacturing Process where consumption of material from Work in process Warehouse, Qty is coming Negative in ""manufacturing Entry.

We have taken 11 Nos of item ""0701-01-0001"" using below consumption entry

<img width=""1136"" alt=""image"" src=""https://github.com/frappe/erpnext/assets/17386166/89950e61-6b8d-4307-be4c-5d0323164d54"">

<img width=""1137"" alt=""image"" src=""https://github.com/frappe/erpnext/assets/17386166/19d3dfc0-3888-4dec-b534-8c450120dbfc"">


Please find here Manufacturing Setting.

<img width=""1135"" alt=""image"" src=""https://github.com/frappe/erpnext/assets/17386166/8c43d81d-2e90-4f4f-be17-ae75701b3fec"">


Not able to identify why 11 qty is coming in negative in Manufacturing entry.

Regards
Satish Aralkar







### Module

manufacturing

### Version

ERPNext: v15.17.1 (version-15)

Frappe Framework: v15.17.3 (version-15)

Frappe HR: v15.14.1 (version-15)

India Compliance: v15.5.7 (version-15)



### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
.
```
",satisharalkar,2024-04-02 17:25:37+00:00,[],2024-04-02 17:25:37+00:00,,https://github.com/frappe/erpnext/issues/40840,"[('bug', None)]",[],
2220208690,issue,closed,completed,Issue while selecting supplier in Purchase Order ,"### Information about bug

While creating a new PO from Material request, I selected a supplier name. Then I get this warning message:

![image](https://github.com/frappe/erpnext/assets/108009061/165d0e0b-580a-4b5d-a01b-03e230016d3f)


### Module

buying

### Version

erpnext 15.16.2
frappe 15.17.1


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",ajiragroup,2024-04-02 10:59:41+00:00,[],2024-04-21 00:09:04+00:00,2024-04-03 08:37:46+00:00,https://github.com/frappe/erpnext/issues/40829,"[('bug', None)]","[{'comment_id': 2032767179, 'issue_id': 2220208690, 'author': 'Nihantra-Patel', 'body': ""Hi @ajiragroup,\r\n\r\nWe checked in the latest version 15, so we haven't found any type of issue. so please check it.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/026c5b3d-bfad-4c64-94e8-f4a9b0a1751f\r\n\r\n\r\nThank You!"", 'created_at': datetime.datetime(2024, 4, 2, 18, 28, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2034436760, 'issue_id': 2220208690, 'author': 'ajiragroup', 'body': '@Nihantra-Patel Thanks! Will check again after updating the apps.', 'created_at': datetime.datetime(2024, 4, 3, 12, 22, 13, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-04-02 18:28:11 UTC): Hi @ajiragroup,

We checked in the latest version 15, so we haven't found any type of issue. so please check it.


https://github.com/frappe/erpnext/assets/141945075/026c5b3d-bfad-4c64-94e8-f4a9b0a1751f


Thank You!

ajiragroup (Issue Creator) on (2024-04-03 12:22:13 UTC): @Nihantra-Patel Thanks! Will check again after updating the apps.

"
2220072184,issue,open,,Disable Quotation Lost Reasons that are not in use.,"There are often scenarios where the user had to create custom Quotation Lost Reasons in Quotation Lost Reason List. 
But as these are no longer needed, we would need to disable them so the user's don't accidently use them further.
At the same time we would not want to delete them as there are already a few transactions with the reason selected OR we foresee the reason being active again after a while.
",hpotabatti,2024-04-02 09:56:52+00:00,[],2024-04-02 09:56:52+00:00,,https://github.com/frappe/erpnext/issues/40823,"[('feature-request', None)]",[],
2219767083,issue,closed,completed,"Taxes Not added Automatically after selecting a supplier, Added Tax Rule to the Supplier (for In State, Out State Rule)","### Information about bug

Taxes are Not Added Automatically After Selecting a Supplier, and one more thing the supplier had a Tax Rule for Different Locations


### Module

buying

### Version

ERPNext Version - v15.18.1
Frappe Version - v15.19.0

Screenshot after Selecting Supplier
<img width=""1148"" alt=""Screenshot 2024-04-02 at 12 51 54 PM"" src=""https://github.com/frappe/erpnext/assets/47274625/50039b10-8efc-409f-8a08-59c9c3f38fe4"">


### Installation method

easy-install

### Relevant log output / Stack trace / Full Error Message.

_No response_",zafar26,2024-04-02 07:29:27+00:00,['khushi8112'],2024-04-21 00:09:02+00:00,2024-04-04 09:44:11+00:00,https://github.com/frappe/erpnext/issues/40819,"[('bug', None)]","[{'comment_id': 2036242700, 'issue_id': 2219767083, 'author': 'khushi8112', 'body': 'Hey @zafar26 \r\n\r\nI tried to replicate your issue but for me it is working fine.\r\n\r\n<img width=""1115"" alt=""Screenshot 2024-04-04 at 12 24 01 AM"" src=""https://github.com/frappe/erpnext/assets/142375893/799c3d23-a9c0-43cc-a01a-25a142b8b5ab"">\r\n\r\nCan you elaborate how you are creating tax rule for the supplier.\r\n[You can refer this doc if it\'s needed.](https://docs.erpnext.com/docs/user/manual/en/tax-rule)', 'created_at': datetime.datetime(2024, 4, 4, 5, 52, 23, tzinfo=datetime.timezone.utc)}]","khushi8112 (Assginee) on (2024-04-04 05:52:23 UTC): Hey @zafar26 

I tried to replicate your issue but for me it is working fine.

<img width=""1115"" alt=""Screenshot 2024-04-04 at 12 24 01 AM"" src=""https://github.com/frappe/erpnext/assets/142375893/799c3d23-a9c0-43cc-a01a-25a142b8b5ab"">

Can you elaborate how you are creating tax rule for the supplier.
[You can refer this doc if it's needed.](https://docs.erpnext.com/docs/user/manual/en/tax-rule)

"
2219687885,issue,closed,completed,Issue with Gantt Chart,"### Information about bug

Gantt is an important tool for project management. In ERPNext, I have seen some slight malfunction in the way it behaves. When editing the chart by using the handles at the edge, it works fine until we refresh the view and the time automatically snaps to 12. See the video. (edit: please use chrome to view the video, apparently Firefox is not playing the video.) 

Edit: The problem occurs in Quarter day view. 

https://github.com/frappe/erpnext/assets/108009061/c6960e44-ec52-4cf4-8c67-d5f871835172




### Module

projects

### Version

erpnext 15.16.2
frappe 15.17.1

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",ajiragroup,2024-04-02 06:42:49+00:00,[],2024-04-29 00:08:16+00:00,2024-04-12 10:54:40+00:00,https://github.com/frappe/erpnext/issues/40818,"[('bug', None)]","[{'comment_id': 2048139970, 'issue_id': 2219687885, 'author': 'safwansamsudeen', 'body': '@ankush could you transfer over to the gantt repo?', 'created_at': datetime.datetime(2024, 4, 10, 17, 49, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2051532586, 'issue_id': 2219687885, 'author': 'Nihantra-Patel', 'body': 'Kindly upgrade to version 15, everything is working fine. No problems were encountered in the latest version 15.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/cf5cac6b-d83b-4423-918a-121999482337', 'created_at': datetime.datetime(2024, 4, 12, 10, 54, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2054016301, 'issue_id': 2219687885, 'author': 'ajiragroup', 'body': 'We are running v15. I request you to view the video we attached again. The problem comes not in day view but in quarter day view.', 'created_at': datetime.datetime(2024, 4, 14, 11, 25, 8, tzinfo=datetime.timezone.utc)}]","safwansamsudeen on (2024-04-10 17:49:54 UTC): @ankush could you transfer over to the gantt repo?

Nihantra-Patel on (2024-04-12 10:54:41 UTC): Kindly upgrade to version 15, everything is working fine. No problems were encountered in the latest version 15.


https://github.com/frappe/erpnext/assets/141945075/cf5cac6b-d83b-4423-918a-121999482337

ajiragroup (Issue Creator) on (2024-04-14 11:25:08 UTC): We are running v15. I request you to view the video we attached again. The problem comes not in day view but in quarter day view.

"
2219547450,issue,open,,Cash Flow to add  beginning and ending balance,"### Information about bug

![image](https://github.com/frappe/erpnext/assets/62122640/01195b51-5112-4c1d-b8ee-c61fe09a7d2d)
is this possible to add 

Cash and cash equivalents at beginning of period 
Cash and cash equivalents at end of period

for the cash flow report


### Module

accounts

### Version

![image](https://github.com/frappe/erpnext/assets/62122640/e723be3b-1268-4b2d-85bd-16082a1974d5)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-04-02 04:37:31+00:00,[],2024-04-02 04:37:31+00:00,,https://github.com/frappe/erpnext/issues/40815,"[('bug', None)]",[],
2218524970,issue,open,,Import Not Started,"### Information about bug

I cannot import data through the Data Import Tool. I get no errors. Only ""Not Started"" status.
Steps to reproduce error:

* Create Data import
* Document Type: Territory (tried many different ones, but the most basic one is Territory)
* Select Import Type > Insert new records
* I downloaded a template and updated the content to the new entries I want to add (I did this just to double check my content. I have all my imports ready from previous instances)
* Select my CSV file
* In preview my Columns are mapped correctly
* Start import

**Expected result:** Reload page and import was successful, or even failed
**Actual result:** Nothing happens. Import status remains ""Not Started""
Checking the console in dev mode - nothing happens
Just get:
 POST https://admin.website.tld/api/method/frappe.core.doctype.data_import.data_import.form_start_import

I urgently need to import my data. I have done this process many times on different versions (V13 and 14) and this is a fresh install of version 15.18.1. I notice 2 new updates, but I cannot confirm if this issue gets fixed in these updates.

### Module

other

### Version

ERPNext version: 15.18.1

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
POST https://admin.website.tld/api/method/frappe.core.doctype.data_import.data_import.form_start_import
```
",Rolinevdm,2024-04-01 15:41:15+00:00,[],2024-10-07 03:50:30+00:00,,https://github.com/frappe/erpnext/issues/40811,"[('bug', None)]","[{'comment_id': 2394980066, 'issue_id': 2218524970, 'author': 'konradbr', 'body': 'Anyone else get this as well? Any update? I can confirm this still happens in current version (see below) and also **using the Template file** from ERPnext.\r\n\r\n```\r\nerpnext 15.38.0\r\nfrappe 15.43.0\r\nhrms 15.30.0\r\npayments 0.0.1\r\n```', 'created_at': datetime.datetime(2024, 10, 5, 8, 28, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2394985722, 'issue_id': 2218524970, 'author': 'konradbr', 'body': ""OK so here's some further tracing — in my case, the error can be traced (courtesy of https://discuss.frappe.io/t/importing-data-does-not-start/89278/6) to the following Exception:\r\n\r\n`PermissionError: [Errno 13] Permission denied: './erp.praefabrica.com/public/files/the-file-being-imported.csv'`"", 'created_at': datetime.datetime(2024, 10, 5, 8, 51, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2394995607, 'issue_id': 2218524970, 'author': 'konradbr', 'body': '#### Progress update & bug trace\r\n\r\nTraced issue to (all) files getting assigned root:root ownership (with corresponding permissions) on upload.\r\n\r\n#### Temporary workaround\r\n\r\nManually reset file permissions:\r\n\r\n_(Change **erpnext:erpnext** to **frappe:frappe** or whatever user your instance is / should be running as...)_\r\n\r\n`chown erpnext:erpnext /opt/erpnext/frappe-bench -R`\r\n\r\n...then click on **Start Import**.', 'created_at': datetime.datetime(2024, 10, 5, 9, 29, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2395837891, 'issue_id': 2218524970, 'author': 'konradbr', 'body': '### Final bug trace & solution\r\n\r\n#### Bug trace\r\n\r\nThe identified issue was that newly uploaded files were assigned `root:root` ownership. This did not preclude files being uploaded and accessed e.g. in Tasks or other DocTypes from the user interface, but caused trouble whenever a background job had to interact with them, as is the case when uploading bank statements.\r\n\r\nThe underlying issue causing the above was that the instance was running as `root` on the server, due to a misconfiguration of `/opt/erpnext/frappe-bench/config/supervisor.conf` (`user=root` instead of `user=erpnext`) (we use `erpnext` as instance user, common is also `frappe`). The source of the misconfiguration has not been identified, but might have been caused by an overriding update earlier that day.\r\n\r\n#### Implemented solution\r\n\r\nThe problem was solved by replacing all `user=root` with `user=erpnext` in `/opt/erpnext/frappe-bench/config/supervisor.conf` and running `chown erpnext:erpnext /opt/erpnext/frappe-bench -R`.', 'created_at': datetime.datetime(2024, 10, 7, 3, 49, 53, tzinfo=datetime.timezone.utc)}]","konradbr on (2024-10-05 08:28:57 UTC): Anyone else get this as well? Any update? I can confirm this still happens in current version (see below) and also **using the Template file** from ERPnext.

```
erpnext 15.38.0
frappe 15.43.0
hrms 15.30.0
payments 0.0.1
```

konradbr on (2024-10-05 08:51:07 UTC): OK so here's some further tracing — in my case, the error can be traced (courtesy of https://discuss.frappe.io/t/importing-data-does-not-start/89278/6) to the following Exception:

`PermissionError: [Errno 13] Permission denied: './erp.praefabrica.com/public/files/the-file-being-imported.csv'`

konradbr on (2024-10-05 09:29:27 UTC): #### Progress update & bug trace

Traced issue to (all) files getting assigned root:root ownership (with corresponding permissions) on upload.

#### Temporary workaround

Manually reset file permissions:

_(Change **erpnext:erpnext** to **frappe:frappe** or whatever user your instance is / should be running as...)_

`chown erpnext:erpnext /opt/erpnext/frappe-bench -R`

...then click on **Start Import**.

konradbr on (2024-10-07 03:49:53 UTC): ### Final bug trace & solution

#### Bug trace

The identified issue was that newly uploaded files were assigned `root:root` ownership. This did not preclude files being uploaded and accessed e.g. in Tasks or other DocTypes from the user interface, but caused trouble whenever a background job had to interact with them, as is the case when uploading bank statements.

The underlying issue causing the above was that the instance was running as `root` on the server, due to a misconfiguration of `/opt/erpnext/frappe-bench/config/supervisor.conf` (`user=root` instead of `user=erpnext`) (we use `erpnext` as instance user, common is also `frappe`). The source of the misconfiguration has not been identified, but might have been caused by an overriding update earlier that day.

#### Implemented solution

The problem was solved by replacing all `user=root` with `user=erpnext` in `/opt/erpnext/frappe-bench/config/supervisor.conf` and running `chown erpnext:erpnext /opt/erpnext/frappe-bench -R`.

"
2218422827,issue,closed,completed,"[bug] when item code not same as name/id of item, item code filter not work in projected qty report","### Information about bug

![image](https://github.com/frappe/erpnext/assets/12823863/9a549b81-26a6-435a-97e4-b97feaa09c9e)

above line 296 
item.item_code == item_code

should be 

item.name == item_code

### Module

stock

### Version

v13,v14, v15

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",szufisher,2024-04-01 14:46:02+00:00,[],2024-05-15 00:08:50+00:00,2024-04-30 06:10:03+00:00,https://github.com/frappe/erpnext/issues/40807,"[('bug', None)]","[{'comment_id': 2036620697, 'issue_id': 2218422827, 'author': 'Nihantra-Patel', 'body': ""Hi @szufisher,\r\n\r\nIt's worked properly, please check it.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/287ddc2a-00cd-4367-b402-0a2c79bdb7e2"", 'created_at': datetime.datetime(2024, 4, 4, 9, 12, 45, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-04-04 09:12:45 UTC): Hi @szufisher,

It's worked properly, please check it.


https://github.com/frappe/erpnext/assets/141945075/287ddc2a-00cd-4367-b402-0a2c79bdb7e2

"
2217967272,issue,open,,Remind Me - Notifications by email,"Hello
I have seen new feature added in ERPNext V15 called Remind Me which is conceptionally can be very useful. However I was informed today by Tech Support that notifications are make through Bill Icon which we don't use or look at it. For better functionally we kindly ask you to implement email notifications to the reminder feature as soon as possible.
Thanks",amrelewa24,2024-04-01 10:10:24+00:00,[],2024-04-01 10:10:24+00:00,,https://github.com/frappe/erpnext/issues/40805,"[('feature-request', None)]",[],
2217566638,issue,closed,completed,Customize form_Sales Invoice error,"### Information about bug

While creating New Financial year naming series, we are unable to save the form as we are getting error "" Invalid Option"" and message says ""Option Company for field address is not child table.
Below is error for your reference.
![image](https://github.com/frappe/erpnext/assets/165632021/4c0e3e75-00af-4fcb-a2a0-033e6fca93d8)


### Module

accounts

### Version

ERPNext: v14.66.1 (HEAD)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",tvharishbabu,2024-04-01 05:38:16+00:00,[],2024-04-21 00:09:06+00:00,2024-04-03 10:42:58+00:00,https://github.com/frappe/erpnext/issues/40802,"[('bug', None)]",[],
2217499545,issue,open,,Payment Reconciliation: Pull Cheque/Reference No through from Payment Entries,"It is common for customers to reference your invoice numbers in their payment reference. So this information would be very useful in the payment reconciliation which currently only shows:

![Screen Shot 2024-04-01 at 05 35 35](https://github.com/frappe/erpnext/assets/110036763/d8e648c0-523b-4466-a31b-750514bd6df2)
",casesolved-co-uk,2024-04-01 04:36:49+00:00,[],2024-04-01 04:36:49+00:00,,https://github.com/frappe/erpnext/issues/40801,"[('feature-request', None)]",[],
2217395138,issue,open,,Bank Reconciliation: does not cater for multiple Journal Entry Account lines to the same account,"### Information about bug

The Bank Reconciliation Tool assumes there is only a single Account line on a Journal Entry to reconcile multiple Bank Transactions against.

If there are multiple lines, the sum of those lines is not calculated when showing the `Remaining` amount on the `Vouchers to Match` i.e. the output of `subtract_allocations` uses the individual Journal Entry Bank line amount to calculate `voucher[""paid_amount""] -= amount`, [Journal Entry Amount - Bank Transaction total allocated against Journal Entry]

Instead it should really sum a total amount to the associated Bank gl_account from all lines on the Journal Entry

https://github.com/frappe/erpnext/blob/b542f21eea5222a9f29303c65c0f779216889a25/erpnext/accounts/doctype/bank_reconciliation_tool/bank_reconciliation_tool.py#L480

### Module

accounts

### Version

v16 develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-04-01 02:45:34+00:00,[],2024-04-01 02:49:43+00:00,,https://github.com/frappe/erpnext/issues/40800,"[('bug', None)]",[],
2217251218,issue,open,,UX: Margin and Discount confusing,"### Information about bug

The Margin and Discount calculator seems confusing and not intuitive:

What I would expect:

- Margin operates the same as discount, you either enter a percentage or an amount and the other value is calculated for you
- Entered values are always preserved
- The rate is calculated by adding the margin amount and subtracting the discount amount to the price list rate
- Both margin and discount are calculated on net (not gross) rate, so a 10% margin and 10% discount result in no rate change
- A warning if rate drops below price list rate

What happens:

- Both percentages are removed/altered
- Margin type is automatically set to Amount after a percentage is entered
- If margin percentage is reselected a new rate is calculated assuming the previous value was a percentage (which it isn't!)
- Margin amount is overwritten by subtracting the discount, even though there is a separate 'Rate with Margin' field
- Discount is applied to the gross rate if there is a margin, but net rate if there is no margin; so a 10% margin and 10% discount result in an overall discount
- The discount percentage is always set to 0% if there is a margin, but is positive if discount exceeds margin

This is very counter-intuitive

![Margin Discount2](https://github.com/frappe/erpnext/assets/110036763/92725ab1-fa50-4cad-9813-3e10006a379c)



### Module

selling

### Version

ERPNext v15 latest

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-03-31 23:46:10+00:00,[],2024-04-01 05:02:00+00:00,,https://github.com/frappe/erpnext/issues/40799,"[('bug', None)]","[{'comment_id': 2029162508, 'issue_id': 2217251218, 'author': 'casesolved-co-uk', 'body': 'Vaguely related: https://github.com/frappe/erpnext/pull/40785', 'created_at': datetime.datetime(2024, 4, 1, 5, 1, 59, tzinfo=datetime.timezone.utc)}]","casesolved-co-uk (Issue Creator) on (2024-04-01 05:01:59 UTC): Vaguely related: https://github.com/frappe/erpnext/pull/40785

"
2217125678,issue,closed,completed,"Cannot update Project Form: ""Company (company) cannot be hidden and mandatory without any default value""","### Information about bug

We upgraded from ERPNext 13 to 15, now adding a new field to the project form does not work anymore.

When trying to change the form (Projects > Project > Edit) via. `/app/customize-form ` clicking on update results in an error:

![image](https://github.com/frappe/erpnext/assets/8775880/dee9c0ef-ddea-4781-a42c-fa27e5f93373)

I tried to update the company field (setting hidden to false, setting a default value), but the changes are not being updated. The presented error always occurrs.


### Module

projects

### Version

ERPNext: v15.18.3 (version-15)

Frappe Framework: v15.19.1 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",RANSoftRA,2024-03-31 18:27:52+00:00,[],2024-04-21 00:08:58+00:00,2024-04-04 09:22:40+00:00,https://github.com/frappe/erpnext/issues/40798,"[('bug', None)]","[{'comment_id': 2036650370, 'issue_id': 2217125678, 'author': 'Nihantra-Patel', 'body': ""Hi @RANSoftRA,\r\n\r\nIt's not an issue 😄, it's validation. If a field is mandatory, you can't hide it without setting a default value first. To hide it, set a default value, update the form, then hide it again and save. Hope that clarifies things."", 'created_at': datetime.datetime(2024, 4, 4, 9, 22, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2036679692, 'issue_id': 2217125678, 'author': 'RANSoftRA', 'body': 'Hi @Nihantra-Patel \r\n\r\nthank you for your response.\r\n\r\nThe thing is I cannot update the hidden property or add a default value for the field. The error still occurrs.\r\n\r\nhttps://github.com/frappe/erpnext/assets/8775880/93a2ee6c-48ab-4bc2-9ca3-08b0f5d25caf\r\n\r\nFields are in german\r\n- ""Versteckt"" = hidden\r\n- ""Standard"" = Default value', 'created_at': datetime.datetime(2024, 4, 4, 9, 34, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2036737564, 'issue_id': 2217125678, 'author': 'Nihantra-Patel', 'body': 'You are going to be wrong.\r\n\r\nPlease check the steps.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/assets/141945075/1087dd19-90f3-468b-995f-e69b94f64c36', 'created_at': datetime.datetime(2024, 4, 4, 10, 0, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2036832105, 'issue_id': 2217125678, 'author': 'RANSoftRA', 'body': 'Thank you for the video, but as already mentioned - I receive an error when doing this. Maybe it has to do with the migration from 13 to 14 than 15. I dont know.\r\n\r\nI have resolved the issue by resetting all customizations:\r\n\r\n`Actions > Reset all Customizations` in the Customize-Form page.', 'created_at': datetime.datetime(2024, 4, 4, 10, 49, 38, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-04-04 09:22:40 UTC): Hi @RANSoftRA,

It's not an issue 😄, it's validation. If a field is mandatory, you can't hide it without setting a default value first. To hide it, set a default value, update the form, then hide it again and save. Hope that clarifies things.

RANSoftRA (Issue Creator) on (2024-04-04 09:34:48 UTC): Hi @Nihantra-Patel 

thank you for your response.

The thing is I cannot update the hidden property or add a default value for the field. The error still occurrs.

https://github.com/frappe/erpnext/assets/8775880/93a2ee6c-48ab-4bc2-9ca3-08b0f5d25caf

Fields are in german
- ""Versteckt"" = hidden
- ""Standard"" = Default value

Nihantra-Patel on (2024-04-04 10:00:02 UTC): You are going to be wrong.

Please check the steps.


https://github.com/frappe/erpnext/assets/141945075/1087dd19-90f3-468b-995f-e69b94f64c36

RANSoftRA (Issue Creator) on (2024-04-04 10:49:38 UTC): Thank you for the video, but as already mentioned - I receive an error when doing this. Maybe it has to do with the migration from 13 to 14 than 15. I dont know.

I have resolved the issue by resetting all customizations:

`Actions > Reset all Customizations` in the Customize-Form page.

"
2216974033,issue,closed,completed,Event Doctype Naming Error,"### Information about bug

My employee created event in calendar, which is only available to him

now when i am creating new event as administrator
its showing error this error

![image](https://github.com/frappe/erpnext/assets/135511086/59a1ab37-17af-4d7b-9267-bfd00f2c27ae)


### Module

other

### Version

ERPNext: v14.66.2 (version-14)
Frappe Framework: v14.69.0 (version-14)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",nilpatel42,2024-03-31 13:24:21+00:00,[],2024-04-21 00:09:03+00:00,2024-04-04 09:23:44+00:00,https://github.com/frappe/erpnext/issues/40795,"[('bug', None)]","[{'comment_id': 2036653805, 'issue_id': 2216974033, 'author': 'Nihantra-Patel', 'body': 'Reference: https://discuss.frappe.io/t/event-doctype-naming-error/120144', 'created_at': datetime.datetime(2024, 4, 4, 9, 23, 45, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-04-04 09:23:45 UTC): Reference: https://discuss.frappe.io/t/event-doctype-naming-error/120144

"
2216943679,issue,open,,Item Price and Price List per Company,"Hello,

When we have multi company in ERPNext, I'm facing problem to handle prices for each company, it will be great if you make it possible to create price list and item price per company.

Best regards",WavesSkipper,2024-03-31 12:21:22+00:00,[],2024-04-06 15:21:53+00:00,,https://github.com/frappe/erpnext/issues/40794,"[('feature-request', None)]","[{'comment_id': 2038715752, 'issue_id': 2216943679, 'author': 'thida-bcn', 'body': 'you can use user permission to limit price list', 'created_at': datetime.datetime(2024, 4, 5, 2, 52, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2041117225, 'issue_id': 2216943679, 'author': 'WavesSkipper', 'body': ""Thanks for your response, but the option to make price list and item price per company it doesn't exist. To handle the same price used in 2 companies but the rate is not the same"", 'created_at': datetime.datetime(2024, 4, 6, 15, 21, 52, tzinfo=datetime.timezone.utc)}]","thida-bcn on (2024-04-05 02:52:58 UTC): you can use user permission to limit price list

WavesSkipper (Issue Creator) on (2024-04-06 15:21:52 UTC): Thanks for your response, but the option to make price list and item price per company it doesn't exist. To handle the same price used in 2 companies but the rate is not the same

"
2216933587,issue,open,,Need to add a weight for serial nos,"
Scenario is like the item may have more than one batch and each batch may contain more than 1 serial no and each serial no has different weight. So have to add a weight qty for each serial nos.",AravindPranera,2024-03-31 12:02:50+00:00,[],2024-03-31 12:02:50+00:00,,https://github.com/frappe/erpnext/issues/40793,"[('feature-request', None)]",[],
2216931714,issue,open,,Wrong Gross profit calculation in sales order,"### Information about bug

Hello,

I have an item with UOM is ""UNIT"" and for sales is BOX. 1 BOX = 4 UNITS

When I create sales order, the price is shown correctly but the gross margin is calculated wrongly. But When I extend the line and I change the UOM to UNIT then return it to BOX it will calculation will be correct. I notice also when a field ""Rate of Stock UOM"" appear the calculation is correct.

I checked the child table ""Sales Order Item"" in Sales Order Form and I found in depend on parameter of the field ""stock_uom_rate"" the following ""eval: doc.uom != doc.stock_uom"", but it's not working until I change manually the UOM.

However the gross profit report shows a correct values even if in the order is wrong. 

Could you help me to solve this or if it could be fixed soon 



Thanks
![Correct_01](https://github.com/frappe/erpnext/assets/153442964/dc9ddc24-92f5-4d85-9046-9500705568a5)
![Correct_02](https://github.com/frappe/erpnext/assets/153442964/a2a554a2-f47d-47a4-b8b6-82f16f1778f0)
![Wrong_01](https://github.com/frappe/erpnext/assets/153442964/b8b494f5-b869-43e0-923d-01955ef9e68c)
![Wrong_02](https://github.com/frappe/erpnext/assets/153442964/e054ac0b-904c-44ae-9087-7fa920f1140b)


### Module

stock, selling

### Version

**ERPNext:** v15.18.1 (version-15)
**Frappe Framework:** v15.19.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",WavesSkipper,2024-03-31 12:00:10+00:00,[],2024-03-31 12:02:59+00:00,,https://github.com/frappe/erpnext/issues/40791,"[('bug', None)]",[],
2216789635,issue,closed,completed,Stock Reco Issue,"### Information about bug

Batch Qty Should not allow to put the 0 Qty


https://github.com/frappe/erpnext/assets/21578167/b4e65300-5890-48a2-a16e-00da154e6205



### Module

stock

### Version

ERPNext: v15.18.1 (version-15)

Frappe Framework: v15.19.0 (version-15)

Frappe HR: v15.15.0 (version-15)

India Compliance: v15.6.0 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",dineshpanchal93,2024-03-31 05:31:10+00:00,[],2025-01-26 10:29:13+00:00,2025-01-26 10:29:13+00:00,https://github.com/frappe/erpnext/issues/40788,"[('bug', None)]",[],
2216255520,issue,open,,Custom Child Table not delete using company master - delete transaction,"### Information about bug

I have added a Custom Child table to the Sales Invoice. when I used delete transactions in the company doctype the custom child table did not get truncated. I have changed some code using override_doctype_class and it's done. I have shared my code

![Screenshot_3](https://github.com/frappe/erpnext/assets/165454262/6bbb0f3a-f5ea-4cad-878a-80e2598a9808)


### Module

other

### Version

Frappe version - 15 
ERPNext Version - v15.17.1

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",Ashish-r-Rathod,2024-03-30 05:23:03+00:00,[],2024-03-30 13:37:38+00:00,,https://github.com/frappe/erpnext/issues/40782,"[('bug', None)]","[{'comment_id': 2028015851, 'issue_id': 2216255520, 'author': 'adityanarayanm095', 'body': '@Ashish-r-Rathod I want to work on this issue. please assign!', 'created_at': datetime.datetime(2024, 3, 30, 11, 12, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2028070705, 'issue_id': 2216255520, 'author': 'Ashish-r-Rathod', 'body': '@adityanarayanm095  I have no permission to add an assignee', 'created_at': datetime.datetime(2024, 3, 30, 13, 33, 33, tzinfo=datetime.timezone.utc)}]","adityanarayanm095 on (2024-03-30 11:12:02 UTC): @Ashish-r-Rathod I want to work on this issue. please assign!

Ashish-r-Rathod (Issue Creator) on (2024-03-30 13:33:33 UTC): @adityanarayanm095  I have no permission to add an assignee

"
2215266807,issue,open,,Side Panel not Displaying in Kanban View,"### Information about bug

I need to be able to filter tasks in my Kanban board by users. However, the side panel where one would usually do that is missing in the Kanban view.

### Module

projects

### Version

ERPNext: v15.17.1

Frappe Framework: v15.8.1

Frappe HR: v15.9.2

Payments: v0.0.1

Scrum: v0.0.1








Here are screenshots. Notice the Side Panel is missing for the Kanban View.

![2024-03-29-083436_screenshot](https://github.com/frappe/erpnext/assets/6234038/aea7b141-bc68-4c61-9faa-4509e0e57166)

![2024-03-29-083403_screenshot](https://github.com/frappe/erpnext/assets/6234038/bd8433d2-762d-46ef-b768-dcced8b038a6)


### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",clayrisser,2024-03-29 12:40:00+00:00,[],2024-04-10 14:20:04+00:00,,https://github.com/frappe/erpnext/issues/40771,"[('bug', None)]","[{'comment_id': 2047681300, 'issue_id': 2215266807, 'author': 'clayrisser', 'body': '@deepeshgarg007 @ruthra-kumar @s-aga-r any suggestions?', 'created_at': datetime.datetime(2024, 4, 10, 14, 18, 37, tzinfo=datetime.timezone.utc)}]","clayrisser (Issue Creator) on (2024-04-10 14:18:37 UTC): @deepeshgarg007 @ruthra-kumar @s-aga-r any suggestions?

"
2214973965,issue,open,,"Issue with Pricing rule Scheme. ""is recursive"" not working properly.","### Information about bug


UOM is Nos and its already set to whole number.

Steps to reproduce:

1. Set up a pricing rule scheme on the Item code for the product Slab for Buy 10 Nos. get 1 Nos. Free for same item and tick ""is recursive"" option.

2. The minimum threshold for free processing is 10 Nos. 3. Expectation: - If a customer is placing an order for 15 Nos. the customer should get the 1 Nos. as free, if a customer places an order for 20 Nos. customer should get the 2 Nos. as free.

3. Outcome:- If the customer is placing an order for 15 Nos. ERPNext is giving 1.5 Nos. as free qty.


![image](https://github.com/frappe/erpnext/assets/100684294/87a52534-97e9-4043-9768-9f8192449f30)


![image](https://github.com/frappe/erpnext/assets/100684294/5e159fa2-185d-43da-8eea-b77cf8a0082e)


### Module

accounts, stock

### Version

v15

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",dharmeshchitroda,2024-03-29 09:09:40+00:00,[],2024-06-17 06:23:47+00:00,,https://github.com/frappe/erpnext/issues/40768,"[('bug', None)]","[{'comment_id': 2172381863, 'issue_id': 2214973965, 'author': 'Sunil-Codes', 'body': 'any update on this facing the same issue', 'created_at': datetime.datetime(2024, 6, 17, 6, 23, 46, tzinfo=datetime.timezone.utc)}]","Sunil-Codes on (2024-06-17 06:23:46 UTC): any update on this facing the same issue

"
2214842169,issue,open,,Stock Actual Quanity Not Updating,"### Information about bug

We are facing an issue when selecting items for a transaction such as a ""Sales Order."" Initially, the actual quantity displayed in Item table row., fetched by the ERP based on the company and any warehouse selected, is not updating after changing the company or warehouse.

For instance, if we select Company ""A"" with multiple warehouses like ""Warehouse A,"" ""Warehouse B,"" etc., the initial display might show that ""Warehouse B"" has 10 items in stock. However, if we then select ""Warehouse A,"" the quantity still shows as 10. Even if we switch to ""Company C"" and its warehouse, where the actual stock balance is 15, the displayed quantity in the transaction (such as the sales order) remains unchanged.

Despite saving the form, the quantity does not update. We kindly request assistance in resolving this issue.
![erpissue](https://github.com/frappe/erpnext/assets/17941025/2970b17b-89fa-4ec1-99cd-08db1c51669e)


### Module

stock

### Version

ERPNext: v15.17.6 (version-15)

Frappe Framework: v15.18.2 (version-15)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",ptpratul2,2024-03-29 07:38:13+00:00,[],2024-09-20 03:26:12+00:00,,https://github.com/frappe/erpnext/issues/40764,"[('bug', None)]","[{'comment_id': 2027940060, 'issue_id': 2214842169, 'author': 'jeshani', 'body': '+1\r\n\r\nIt is not just a stock, we have observed that it happens with the account and cost center details as well. \r\nAfter changing the company and warehouse details, it doesnt refresh the child item table data accordingly.', 'created_at': datetime.datetime(2024, 3, 30, 6, 23, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2362684062, 'issue_id': 2214842169, 'author': 'Utesar72', 'body': 'Hi, Same issue here. Is this bug solved??? Thks in advance.', 'created_at': datetime.datetime(2024, 9, 20, 3, 26, 11, tzinfo=datetime.timezone.utc)}]","jeshani on (2024-03-30 06:23:50 UTC): +1

It is not just a stock, we have observed that it happens with the account and cost center details as well. 
After changing the company and warehouse details, it doesnt refresh the child item table data accordingly.

Utesar72 on (2024-09-20 03:26:11 UTC): Hi, Same issue here. Is this bug solved??? Thks in advance.

"
2213836464,issue,open,,“Allow Rename Attribute Value” does not work,"### Information about bug

“Allow Rename Attribute Value” setting under “Item Variant Settings” does not allow users to modify attribute name and values for existing Item Variants

So Variant attributes and values are permanent and can not be modified once they are added into the system.

### Module

stock, ecommerce

### Version

Frappe version 15.18.0
ERPNext Version 15.18.0

![IMG_7183](https://github.com/frappe/erpnext/assets/71740113/86c152ef-203b-46af-85e1-22eb1359f649)
![IMG_7184](https://github.com/frappe/erpnext/assets/71740113/9fba7ff5-8750-4057-a0af-a3af8abadaaf)

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

_No response_",GeoCommander,2024-03-28 18:09:08+00:00,[],2024-03-28 18:09:08+00:00,,https://github.com/frappe/erpnext/issues/40753,"[('bug', None)]",[],
2213597742,issue,closed,completed,Sales Analytics Report: incompatible with Dashboard Chart,"### Information about bug

Because the dataset for the Sales Analytics report is compiled in js after the checkboxes are ticked, and other non-standard data, this report cannot be used on a Workspace or Dashboard Chart which is an essential use-case.

Related:
https://github.com/frappe/erpnext/issues/40729

### Module

selling

### Version

v16 develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-03-28 16:04:31+00:00,[],2024-06-11 00:08:31+00:00,2024-05-27 09:01:03+00:00,https://github.com/frappe/erpnext/issues/40751,"[('bug', None)]",[],
2212666537,issue,open,,Purchase Return entry not posting against Purchase receipt (Rejected Material Return to Supplier),"### Information about bug

Purchase Return entry not posting against Purchase receipt (Rejected Material Return to Supplier) against same Purchase receipt, We have using Serial & Batch No functionality, system does not allow to return rejected partial material to supplier by same batch. Error is showing on all V15 sites

<img width=""773"" alt=""image"" src=""https://github.com/frappe/erpnext/assets/119041865/85a9fcb1-e857-4e0b-92a5-b6853e55272a"">


### Module

accounts, stock, buying, manufacturing

### Version

ERPNext: v15.16.2
Frappe Framework: v15.17.1

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

```shell
request.js:473 Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1716, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 335, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 357, in _save
    return self.insert()
           ^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 289, in insert
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1088, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 959, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1319, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1301, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 956, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/stock/doctype/purchase_receipt/purchase_receipt.py"", line 230, in validate
    super(PurchaseReceipt, self).validate()
  File ""apps/erpnext/erpnext/controllers/buying_controller.py"", line 64, in validate
    self.set_serial_and_batch_bundle()
  File ""apps/erpnext/erpnext/controllers/stock_controller.py"", line 566, in set_serial_and_batch_bundle
    frappe.get_doc(""Serial and Batch Bundle"", row.get(field)).set_serial_and_batch_values(
  File ""apps/erpnext/erpnext/stock/doctype/serial_and_batch_bundle/serial_and_batch_bundle.py"", line 388, in set_serial_and_batch_values
    self.validate_quantity(row, qty_field=qty_field)
  File ""apps/erpnext/erpnext/stock/doctype/serial_and_batch_bundle/serial_and_batch_bundle.py"", line 499, in validate_quantity
    self.throw_error_message(
  File ""apps/erpnext/erpnext/stock/doctype/serial_and_batch_bundle/serial_and_batch_bundle.py"", line 197, in throw_error_message
    frappe.throw(_(message), exception, title=_(""Error""))
  File ""apps/frappe/frappe/__init__.py"", line 600, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 565, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 516, in _raise_exception
    raise exc
frappe.exceptions.ValidationError: Total quantity 200.0 in the Serial and Batch Bundle <strong>SABB-00000144</strong> does not match with the quantity 10.0 for the Item <strong>Batch Item</strong> in the Purchase Receipt # PR-24-00057

(anonymous) @ request.js:473
request.js:279 
        
        
       POST https://demo.mannlowe.com/api/method/frappe.desk.form.save.savedocs 417 (Expectation Failed)
send @ jquery.js:9930
ajax @ jquery.js:9511
frappe.request.call @ request.js:279
frappe.call @ request.js:109
f @ save.js:246
n @ save.js:23
frappe.ui.form.save @ save.js:273
(anonymous) @ form.js:820
Promise.then (async)
(anonymous) @ dom.js:262
frappe.run_serially @ dom.js:260
validate_and_save @ form.js:811
(anonymous) @ form.js:750
save @ form.js:747
Save @ toolbar.js:687
(anonymous) @ page.js:305
dispatch @ jquery.js:5135
Rt.handle @ jquery.js:4939
Show 4 more frames
Show less
request.js:473 Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1716, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/desk/form/save.py"", line 39, in savedocs
    doc.save()
  File ""apps/frappe/frappe/model/document.py"", line 335, in save
    return self._save(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 357, in _save
    return self.insert()
           ^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 289, in insert
    self.run_before_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1088, in run_before_save_methods
    self.run_method(""validate"")
  File ""apps/frappe/frappe/model/document.py"", line 959, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1319, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1301, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 956, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/stock/doctype/purchase_receipt/purchase_receipt.py"", line 230, in validate
    super(PurchaseReceipt, self).validate()
  File ""apps/erpnext/erpnext/controllers/buying_controller.py"", line 64, in validate
    self.set_serial_and_batch_bundle()
  File ""apps/erpnext/erpnext/controllers/stock_controller.py"", line 566, in set_serial_and_batch_bundle
    frappe.get_doc(""Serial and Batch Bundle"", row.get(field)).set_serial_and_batch_values(
  File ""apps/erpnext/erpnext/stock/doctype/serial_and_batch_bundle/serial_and_batch_bundle.py"", line 388, in set_serial_and_batch_values
    self.validate_quantity(row, qty_field=qty_field)
  File ""apps/erpnext/erpnext/stock/doctype/serial_and_batch_bundle/serial_and_batch_bundle.py"", line 499, in validate_quantity
    self.throw_error_message(
  File ""apps/erpnext/erpnext/stock/doctype/serial_and_batch_bundle/serial_and_batch_bundle.py"", line 197, in throw_error_message
    frappe.throw(_(message), exception, title=_(""Error""))
  File ""apps/frappe/frappe/__init__.py"", line 600, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 565, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 516, in _raise_exception
    raise exc
frappe.exceptions.ValidationError: Total quantity 200.0 in the Serial and Batch Bundle <strong>SABB-00000144</strong> does not match with the quantity 10.0 for the Item <strong>Batch Item</strong> in the Purchase Receipt # PR-24-00057
```
",RJMHASKE,2024-03-28 08:46:12+00:00,[],2024-03-28 08:46:12+00:00,,https://github.com/frappe/erpnext/issues/40740,"[('bug', None)]",[],
2212371155,issue,open,,Opening Loyalty Points Updating To Customer,"Company Wise Loyalty Points Updating to Customer When Customer Creation
",creative-paramu,2024-03-28 05:15:48+00:00,[],2024-03-28 05:15:48+00:00,,https://github.com/frappe/erpnext/issues/40732,"[('feature-request', None)]",[],
2212310455,issue,open,,Feature for Unread email,"The user has been adapting a functionality called “Add to this activity by mailing” and it is very useful to them as shown in the first screenshot. However, there is the major flow which is the lack of visibility to several emails being added to a given document as well as the number of unread emails. Accordingly, the user would like to implement functionality as shown in the second screenshot mockup that shows how many emails are added to the activity of each document and the number of unread emails based on ERP visibility of read/unread and not the actual email read/unread visibility

![image](https://github.com/frappe/erpnext/assets/108865344/5f8511a0-f38e-42ea-aa53-2c3cd67e69b9)

![image](https://github.com/frappe/erpnext/assets/108865344/0291e421-eef0-4918-8103-bbe67023969d)
",sanjay141986,2024-03-28 04:12:02+00:00,[],2024-03-31 14:20:18+00:00,,https://github.com/frappe/erpnext/issues/40730,"[('feature-request', None)]","[{'comment_id': 2028766744, 'issue_id': 2212310455, 'author': 'amrelewa24', 'body': '@sanjay141986 we would appreciate expediting the implication of this feature as it will be very useful to our team as well as complimenting the Add to activity existed feature.', 'created_at': datetime.datetime(2024, 3, 31, 14, 20, 18, tzinfo=datetime.timezone.utc)}]","amrelewa24 on (2024-03-31 14:20:18 UTC): @sanjay141986 we would appreciate expediting the implication of this feature as it will be very useful to our team as well as complimenting the Add to activity existed feature.

"
2212282860,issue,closed,completed,Sales Analytics Report: Chart datasets is empty,"### Information about bug

The Sales Analytics report generates table data, but the chart dataset has not been finished:

![Screen Shot 2024-03-28 at 03 34 36](https://github.com/frappe/erpnext/assets/110036763/454fe4f3-88b7-4715-abcf-134b57a5ee77)

![Screen Shot 2024-03-28 at 03 34 51](https://github.com/frappe/erpnext/assets/110036763/c4393a32-a2f6-4830-a4bc-d0b4570fa1c9)


https://github.com/frappe/erpnext/blob/9709a18ef5cd25ca01e97983a873c8b1f4675a8a/erpnext/selling/report/sales_analytics/sales_analytics.py#L404

### Module

selling

### Version

ERPNext: v16 develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-03-28 03:37:35+00:00,[],2024-04-12 00:08:18+00:00,2024-03-28 08:42:21+00:00,https://github.com/frappe/erpnext/issues/40729,"[('bug', None)]","[{'comment_id': 2024459569, 'issue_id': 2212282860, 'author': 'Nihantra-Patel', 'body': 'Hi @casesolved-co-uk,\r\n\r\nTo view the chart, you need to select the checkbox first.\r\n\r\n![image](https://github.com/frappe/erpnext/assets/141945075/b7d5f18f-3459-4ef3-b36e-a8e44ccb740a)\r\n\r\nThank You!', 'created_at': datetime.datetime(2024, 3, 28, 5, 57, 1, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-03-28 05:57:01 UTC): Hi @casesolved-co-uk,

To view the chart, you need to select the checkbox first.

![image](https://github.com/frappe/erpnext/assets/141945075/b7d5f18f-3459-4ef3-b36e-a8e44ccb740a)

Thank You!

"
2212143059,issue,open,,BOM in ERPNext v14.21 is still blank even after update to latest.,"

I followed steps in issue 36204. However, when i add a new BOM, the issue is still the same, no fields i can edit.

Validated that my erpnext version is now:

ERPNext: v14.21.0 (version-14)

Frappe Framework: v14.32.1 (version-14)

Frappe HR: v14.24.1 (version-14)
              Yes, upgraded and the BOM is working now.  Thank you for your help.

_Originally posted by @daxwilder in https://github.com/frappe/erpnext/issues/36204#issuecomment-1881017828_
            ",ammiole,2024-03-28 00:58:14+00:00,[],2024-03-28 00:59:31+00:00,,https://github.com/frappe/erpnext/issues/40728,[],"[{'comment_id': 2024218690, 'issue_id': 2212143059, 'author': 'ammiole', 'body': '<img width=""875"" alt=""Screenshot 2024-03-28 085916"" src=""https://github.com/frappe/erpnext/assets/78841852/f2b35583-9fe9-47bd-8825-5910bf60ff93"">', 'created_at': datetime.datetime(2024, 3, 28, 0, 59, 30, tzinfo=datetime.timezone.utc)}]","ammiole (Issue Creator) on (2024-03-28 00:59:30 UTC): <img width=""875"" alt=""Screenshot 2024-03-28 085916"" src=""https://github.com/frappe/erpnext/assets/78841852/f2b35583-9fe9-47bd-8825-5910bf60ff93"">

"
2212047991,issue,open,,Birthday Event is created based on Date of Birth specified in the Employee master - Documentation issue - Wrong documentation,"### Information about bug

In the documentation: 

it is saying:

1.3. Birthday Event 

Birthday Event is created based on Date of Birth specified in the Employee master.


But this is wrong, this feature was removed 9+ years ago with this commit: 

https://github.com/frappe/erpnext/commit/5bceebc6a1a763bca957a3cdc3dabfc4124a2ed6

What is the proper / easiest way nowadays to get such feature back? 



### Module

HR

### Version

newest
newest

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",tinodj,2024-03-27 23:12:46+00:00,[],2024-06-04 07:34:18+00:00,,https://github.com/frappe/erpnext/issues/40726,"[('bug', None)]","[{'comment_id': 2146817403, 'issue_id': 2212047991, 'author': 'aheart', 'body': 'I wanted to figure out how this feature works and found this issue. Thanks for saving me a lot of time. Would be nice to fix this or at least hide it from the documentation.', 'created_at': datetime.datetime(2024, 6, 4, 7, 34, 17, tzinfo=datetime.timezone.utc)}]","aheart on (2024-06-04 07:34:17 UTC): I wanted to figure out how this feature works and found this issue. Thanks for saving me a lot of time. Would be nice to fix this or at least hide it from the documentation.

"
2210328611,issue,closed,completed,PR submit: maximum recursion depth exceeded in comparison,"### Information about bug

When PR submit: maximum recursion depth exceeded in comparison


### Module

stock

### Version

Frappe Framework: v14.64.0
ERPNext: v14.61.3

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

```shell
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 95, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 47, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1620, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/model/workflow.py"", line 137, in apply_workflow
    doc.submit()
  File ""apps/frappe/frappe/model/document.py"", line 1006, in submit
    return self._submit()
  File ""apps/frappe/frappe/model/document.py"", line 985, in _submit
    return self.save()
  File ""apps/frappe/frappe/model/document.py"", line 309, in save
    return self._save(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 361, in _save
    self.run_post_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1091, in run_post_save_methods
    self.run_method(""on_submit"")
  File ""apps/frappe/frappe/model/document.py"", line 915, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1277, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1259, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 912, in fn
    return method_object(*args, **kwargs)
  File ""apps/erpnext/erpnext/stock/doctype/purchase_receipt/purchase_receipt.py"", line 264, in on_submit
    self.update_stock_ledger()
  File ""apps/erpnext/erpnext/controllers/buying_controller.py"", line 589, in update_stock_ledger
    self.make_sl_entries(
  File ""apps/erpnext/erpnext/controllers/stock_controller.py"", line 506, in make_sl_entries
    make_sl_entries(sl_entries, allow_negative_stock, via_landed_cost_voucher)
  File ""apps/erpnext/erpnext/stock/stock_ledger.py"", line 68, in make_sl_entries
    sle_doc = make_entry(sle, allow_negative_stock, via_landed_cost_voucher)
  File ""apps/erpnext/erpnext/stock/stock_ledger.py"", line 166, in make_entry
    sle.submit()
  File ""apps/frappe/frappe/model/document.py"", line 1006, in submit
    return self._submit()
  File ""apps/frappe/frappe/model/document.py"", line 985, in _submit
    return self.save()
  File ""apps/frappe/frappe/model/document.py"", line 309, in save
    return self._save(*args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 331, in _save
    return self.insert()
  File ""apps/frappe/frappe/model/document.py"", line 289, in insert
    self.run_post_save_methods()
  File ""apps/frappe/frappe/model/document.py"", line 1091, in run_post_save_methods
    self.run_method(""on_submit"")
  File ""apps/frappe/frappe/model/document.py"", line 915, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1277, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1259, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 912, in fn
    return method_object(*args, **kwargs)
  File ""apps/erpnext/erpnext/stock/doctype/stock_ledger_entry/stock_ledger_entry.py"", line 128, in on_submit
    process_serial_no(self)
  File ""apps/erpnext/erpnext/stock/doctype/serial_no/serial_no.py"", line 274, in process_serial_no
    update_serial_nos(sle, item_det)
  File ""apps/erpnext/erpnext/stock/doctype/serial_no/serial_no.py"", line 578, in update_serial_nos
    serial_nos = get_auto_serial_nos(item_det.serial_no_series, sle.actual_qty)
  File ""apps/erpnext/erpnext/stock/doctype/serial_no/serial_no.py"", line 588, in get_auto_serial_nos
    serial_nos.append(get_new_serial_number(serial_no_series))
  File ""apps/erpnext/erpnext/stock/doctype/serial_no/serial_no.py"", line 596, in get_new_serial_number
    sr_no = get_new_serial_number(series)
  File ""apps/erpnext/erpnext/stock/doctype/serial_no/serial_no.py"", line 596, in get_new_serial_number
    sr_no = get_new_serial_number(series)
  File ""apps/erpnext/erpnext/stock/doctype/serial_no/serial_no.py"", line 596, in get_new_serial_number
    sr_no = get_new_serial_number(series)
  [Previous line repeated 919 more times]
  File ""apps/erpnext/erpnext/stock/doctype/serial_no/serial_no.py"", line 595, in get_new_serial_number
    if frappe.db.exists(""Serial No"", sr_no):
  File ""apps/frappe/frappe/database/database.py"", line 1156, in exists
    return self.get_value(dt, dn, ignore=True, cache=cache)
  File ""apps/frappe/frappe/database/database.py"", line 554, in get_value
    result = self.get_values(
  File ""apps/frappe/frappe/database/database.py"", line 651, in get_values
    out = self._get_values_from_table(
  File ""apps/frappe/frappe/database/database.py"", line 867, in _get_values_from_table
    query = frappe.qb.get_query(
  File ""apps/frappe/frappe/query_builder/utils.py"", line 61, in get_query
    return Engine().get_query(*args, **kwargs)
  File ""apps/frappe/frappe/database/query.py"", line 73, in get_query
    self.apply_fields(fields)
  File ""apps/frappe/frappe/database/query.py"", line 101, in apply_fields
    self.fields = self.parse_fields(fields)
  File ""apps/frappe/frappe/database/query.py"", line 305, in parse_fields
    fields = self.sanitize_fields(fields)
  File ""apps/frappe/frappe/database/query.py"", line 282, in sanitize_fields
    return [_sanitize_field(field) for field in fields]
  File ""apps/frappe/frappe/database/query.py"", line 282, in <listcomp>
    return [_sanitize_field(field) for field in fields]
  File ""apps/frappe/frappe/database/query.py"", line 276, in _sanitize_field
    stripped_field = sqlparse.format(field, strip_comments=True, keyword_case=""lower"")
  File ""env/lib/python3.10/site-packages/sqlparse/__init__.py"", line 59, in format
    return ''.join(stack.run(sql, encoding))
  File ""env/lib/python3.10/site-packages/sqlparse/engine/filter_stack.py"", line 39, in run
    filter_.process(stmt)
  File ""env/lib/python3.10/site-packages/sqlparse/filters/others.py"", line 54, in process
    [self.process(sgroup) for sgroup in stmt.get_sublists()]
  File ""env/lib/python3.10/site-packages/sqlparse/filters/others.py"", line 54, in <listcomp>
    [self.process(sgroup) for sgroup in stmt.get_sublists()]
  File ""env/lib/python3.10/site-packages/sqlparse/filters/others.py"", line 55, in process
    StripCommentsFilter._process(stmt)
  File ""env/lib/python3.10/site-packages/sqlparse/filters/others.py"", line 34, in _process
    tidx, token = get_next_comment()
  File ""env/lib/python3.10/site-packages/sqlparse/filters/others.py"", line 20, in get_next_comment
    return tlist.token_next_by(i=sql.Comment, t=T.Comment)
  File ""env/lib/python3.10/site-packages/sqlparse/sql.py"", line 266, in token_next_by
    return self._token_matching(lambda tk: imt(tk, i, m, t), idx, end)
  File ""env/lib/python3.10/site-packages/sqlparse/sql.py"", line 245, in _token_matching
    if func(token):
  File ""env/lib/python3.10/site-packages/sqlparse/sql.py"", line 266, in <lambda>
    return self._token_matching(lambda tk: imt(tk, i, m, t), idx, end)
  File ""env/lib/python3.10/site-packages/sqlparse/utils.py"", line 99, in imt
    elif types and any(token.ttype in ttype for ttype in types):
  File ""env/lib/python3.10/site-packages/sqlparse/utils.py"", line 99, in <genexpr>
    elif types and any(token.ttype in ttype for ttype in types):
  File ""env/lib/python3.10/site-packages/sqlparse/tokens.py"", line 19, in __contains__
    return item is not None and (self is item or item[:len(self)] == self)
RecursionError: maximum recursion depth exceeded in comparison
```
",mohsinalimat,2024-03-27 09:48:30+00:00,[],2024-04-12 00:08:23+00:00,2024-03-27 11:34:09+00:00,https://github.com/frappe/erpnext/issues/40709,"[('bug', None)]",[],
2210128357,issue,closed,completed,Bank transaction delete bug,"### Information about bug

When deleting bank transactions in bulk, the system shows that the selected entries are deleted but actually they aren't. 

After repeated tries, I came to know that first I have to cancel the transaction and only then delete it. This was a UX bug and should be fixed. 


### Module

accounts

### Version

ERPNext Version 15

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",NehaSan16,2024-03-27 08:06:32+00:00,['khushi8112'],2024-04-21 00:09:01+00:00,2024-04-04 09:54:17+00:00,https://github.com/frappe/erpnext/issues/40701,"[('bug', None)]","[{'comment_id': 2023038900, 'issue_id': 2210128357, 'author': 'NehaSan16', 'body': ""@deepeshgarg007 kind of noticed this issue recently. \r\n\r\n1. Firstly due to some UX issue, bank data got uploaded thrice\r\n2. Secondly, bulk delete didn't work. Later came to know that first I have to cancel and only then the entries can be deleted. This error message was not very clear.\r\n3."", 'created_at': datetime.datetime(2024, 3, 27, 15, 19, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2024909630, 'issue_id': 2210128357, 'author': 'khushi8112', 'body': '<img width=""1224"" alt=""Screenshot 2024-03-28 at 4 14 32 PM"" src=""https://github.com/frappe/erpnext/assets/142375893/1e4d69b6-438b-4c8a-a6e3-3a4c48a411fa"">\r\n\r\nWe encounter this message when attempting to delete. I believe this message is clear enough for the situation.', 'created_at': datetime.datetime(2024, 3, 28, 10, 55, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2028001727, 'issue_id': 2210128357, 'author': 'NehaSan16', 'body': '@khushi8112 Can you try if the message appears when you try bulk delete?\r\n\r\nThe issue was happening in bulk delete and not single transaction delete.', 'created_at': datetime.datetime(2024, 3, 30, 10, 11, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2028217707, 'issue_id': 2210128357, 'author': 'khushi8112', 'body': 'Okay, so I have tried to delete 4 transactions at once and for me it encountered the same message I have shared above.\r\nAlso in the screenshot you can check that I tried to delete 2 transactions and the shown message is also for 2 different transaction not for single transaction.\r\n@NehaSan16  Could you please attach the screenshot of message which you are getting.', 'created_at': datetime.datetime(2024, 3, 30, 16, 22, 50, tzinfo=datetime.timezone.utc)}]","NehaSan16 (Issue Creator) on (2024-03-27 15:19:16 UTC): @deepeshgarg007 kind of noticed this issue recently. 

1. Firstly due to some UX issue, bank data got uploaded thrice
2. Secondly, bulk delete didn't work. Later came to know that first I have to cancel and only then the entries can be deleted. This error message was not very clear.
3.

khushi8112 (Assginee) on (2024-03-28 10:55:36 UTC): <img width=""1224"" alt=""Screenshot 2024-03-28 at 4 14 32 PM"" src=""https://github.com/frappe/erpnext/assets/142375893/1e4d69b6-438b-4c8a-a6e3-3a4c48a411fa"">

We encounter this message when attempting to delete. I believe this message is clear enough for the situation.

NehaSan16 (Issue Creator) on (2024-03-30 10:11:38 UTC): @khushi8112 Can you try if the message appears when you try bulk delete?

The issue was happening in bulk delete and not single transaction delete.

khushi8112 (Assginee) on (2024-03-30 16:22:50 UTC): Okay, so I have tried to delete 4 transactions at once and for me it encountered the same message I have shared above.
Also in the screenshot you can check that I tried to delete 2 transactions and the shown message is also for 2 different transaction not for single transaction.
@NehaSan16  Could you please attach the screenshot of message which you are getting.

"
2209648371,issue,closed,completed,Supplier Quotation Tax Breakup not displaying properly,"### Information about bug

Supplier Quotation Tax Breakup not displaying properly and instead displays the HTML code as show below.
![image](https://github.com/frappe/erpnext/assets/93438531/d9f083b1-0c49-4570-9ab5-49816ec697ca)

Other Doctype's Tax Breakup is working as intended as shown below.
![image](https://github.com/frappe/erpnext/assets/93438531/b45add29-f6a6-4c3a-b90a-719c968d229d)



### Module

buying

### Version

Frappe Framework: v15.18.2 - ERPNext: v15.17.6

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",quebn,2024-03-27 01:43:23+00:00,[],2024-04-21 00:09:07+00:00,2024-03-28 07:14:46+00:00,https://github.com/frappe/erpnext/issues/40694,"[('bug', None), ('released', None)]","[{'comment_id': 2022369351, 'issue_id': 2209648371, 'author': 'Nihantra-Patel', 'body': 'Already raised the PR: #40563', 'created_at': datetime.datetime(2024, 3, 27, 10, 4, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2022914212, 'issue_id': 2209648371, 'author': 'quebn', 'body': '> Already raised the PR: #40563\n\nBug is still present in latest version of version-15, the field is still a MarkdownEditor rather TextEditor.', 'created_at': datetime.datetime(2024, 3, 27, 14, 29, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2024402677, 'issue_id': 2209648371, 'author': 'Nihantra-Patel', 'body': 'We again raised the PR for that.', 'created_at': datetime.datetime(2024, 3, 28, 5, 6, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2034199145, 'issue_id': 2209648371, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 14.66.3 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.66.3)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 4, 3, 10, 33, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2034201042, 'issue_id': 2209648371, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.19.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.19.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 4, 3, 10, 34, 26, tzinfo=datetime.timezone.utc)}]","Nihantra-Patel on (2024-03-27 10:04:18 UTC): Already raised the PR: #40563

quebn (Issue Creator) on (2024-03-27 14:29:29 UTC): Bug is still present in latest version of version-15, the field is still a MarkdownEditor rather TextEditor.

Nihantra-Patel on (2024-03-28 05:06:36 UTC): We again raised the PR for that.

frappe-pr-bot on (2024-04-03 10:33:33 UTC): :tada: This issue has been resolved in version 14.66.3 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v14.66.3)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

frappe-pr-bot on (2024-04-03 10:34:26 UTC): :tada: This issue has been resolved in version 15.19.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.19.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2209496474,issue,closed,completed,Uncaught Server Exception - There was an error building this page,"### Information about bug

Hello,

I run those comamd:
/frappe-bench/apps/erpnext$ git pull
/frappe-bench$ sudo bench --site [My site name] migrate

Then I can't login to the site and got this error, could you help me to solve that, it's urgent. Thanks

![image](https://github.com/frappe/erpnext/assets/153442964/94994f8c-83bd-4a87-8642-82114a217af7)


Traceback (most recent call last):
  File ""apps/frappe/frappe/www/app.py"", line 27, in get_context
    boot = frappe.sessions.get()
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/sessions.py"", line 167, in get
    frappe.get_attr(hook)(bootinfo=bootinfo)
    ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1673, in get_attr
    return getattr(get_module(modulename), methodname)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'erpnext.startup.boot' has no attribute 'bootinfo'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""apps/frappe/frappe/website/serve.py"", line 18, in get_response
    response = renderer_instance.render()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 84, in render
    html = self.get_html()
           ^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/website/utils.py"", line 524, in cache_html_decorator
    html = func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 95, in get_html
    self.update_context()
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 162, in update_context
    data = self.run_pymodule_method(""get_context"")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/website/page_renderers/template_page.py"", line 224, in run_pymodule_method
    return method(self.context)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/www/app.py"", line 29, in get_context
    raise frappe.SessionBootFailed from e
frappe.exceptions.SessionBootFailed

### Module

integrations

### Version

Frappe Framework: v15.2.1 
ERPNext: v15.3.0 

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",WavesSkipper,2024-03-26 23:05:10+00:00,[],2024-04-12 00:08:19+00:00,2024-03-28 08:33:07+00:00,https://github.com/frappe/erpnext/issues/40693,"[('bug', None)]","[{'comment_id': 2024666642, 'issue_id': 2209496474, 'author': 'WavesSkipper', 'body': ""Hello,\r\n\r\nIt's solved accidentally, I installed a new site where I restarted supervisor and nginx, so the old sites begin working with the last release."", 'created_at': datetime.datetime(2024, 3, 28, 8, 32, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2024667453, 'issue_id': 2209496474, 'author': 'WavesSkipper', 'body': ""It's solved as described above"", 'created_at': datetime.datetime(2024, 3, 28, 8, 33, 30, tzinfo=datetime.timezone.utc)}]","WavesSkipper (Issue Creator) on (2024-03-28 08:32:52 UTC): Hello,

It's solved accidentally, I installed a new site where I restarted supervisor and nginx, so the old sites begin working with the last release.

WavesSkipper (Issue Creator) on (2024-03-28 08:33:30 UTC): It's solved as described above

"
2209302752,issue,open,,Payment Request: needs amount selection from payment schedule,"### Information about bug

The client button `Create Payment Request` assumes you want to request payment for the whole Order/Invoice. However, there may be a payment schedule.

So before triggering the payment request creation, there should be a dialog to choose the amount.

https://github.com/frappe/erpnext/blob/533627df3be88e5e909bbadc517cd58fc6db614b/erpnext/public/js/controllers/transaction.js#L360

### Module

selling

### Version

ERPNext v16 develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-03-26 20:50:34+00:00,[],2024-03-26 20:50:34+00:00,,https://github.com/frappe/erpnext/issues/40692,"[('bug', None)]",[],
2208450059,issue,closed,completed,[develop] Item: move UOM conversion table to new form tab,"I see that @barredterra is making some much needed refactors to the UOM system, thank you.

In the `Item` form, the UOM table is currently in the ""Inventory"" section, which is **not shown when `is_stock_item` is not checked**.  
I think this table should be moved to a new tab in the Item form, at least somewhere where it's always accessible.

related to PR https://github.com/frappe/erpnext/pull/40586",cogk,2024-03-26 14:39:18+00:00,[],2024-05-21 00:08:21+00:00,2024-05-06 16:51:39+00:00,https://github.com/frappe/erpnext/issues/40690,"[('feature-request', None)]",[],
2208196262,issue,closed,completed,Pick List Batch selection issue,"### Information about bug

**Information about bug**
After creating pick list form sales order while selecting batch child table is adding the different batch in one row.

**Steps to Reproduce**
1. Create Item with at least three batches
2. add stock in all the batch
3. create sales order for the item (I have created for 1200 qty)
<img width=""1618"" alt=""image"" src=""https://github.com/frappe/erpnext/assets/9102676/b4d493c0-45c9-40c9-8527-37a93601315b"">
4. Create Pick list and change qty and batch by adding additional row.


![Mar-26-2024 18-29-10](https://github.com/frappe/erpnext/assets/9102676/e5e4220a-6862-4460-9cca-b804f790d926)


### Module

stock, selling

### Version

ERPNext: v15.17.6 (version-15)
Frappe Framework: v15.18.2 (version-15)

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",rknroot,2024-03-26 13:06:33+00:00,[],2024-04-17 00:08:16+00:00,2024-04-02 16:43:51+00:00,https://github.com/frappe/erpnext/issues/40686,"[('feature-request', None)]","[{'comment_id': 2021984867, 'issue_id': 2208196262, 'author': 'rohitwaghchaure', 'body': ""This is not a bug, it's a feature request. We even not allowing to change the batch in v14"", 'created_at': datetime.datetime(2024, 3, 27, 5, 37, 57, tzinfo=datetime.timezone.utc)}]","rohitwaghchaure on (2024-03-27 05:37:57 UTC): This is not a bug, it's a feature request. We even not allowing to change the batch in v14

"
2208108379,issue,closed,completed,Error in migrate from version 13 to version 14,"### Information about bug

I am trying to migrate from version 13 to version 14.
The switch to Version 15 bench switch-to-branch version-15 frappe erpnext --upgrade was done with no issues.
Then I ran bench --site [YOUR SITE] migrate. This gave me an error in the migration between [‘tabPayment Ledger Entry’, ‘tabGL Entry’].
It ran patches until it reached 85000 records, then gave an error of duplicate key in ‘tabPayment Ledger Entry’.
So I deleted the inserted record in ‘tabPayment Ledger Entry’ and ran migrate again, but still have the same error.

The steps I followed:
a- Installation
1-Installed a new machine with Ubuntu 22.04.4 LTS.
2-Installed ERPNext version 13 manually.
3-Restored my backup, which is also ERPNext version 13.
---------All successful so far ---------
b- Migration from version 13 to version 14

1-cd /path/to/your/frappe-bench
2-curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
3-wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
4-source ~/.bashrc
5-nvm install 18
6-nvm alias default 18
7-bench switch-to-branch version-15 frappe erpnext --upgrade
-------All successful so far ------
8-bench --site [YOUR SITE] migrate
Error in the migration between [‘tabPayment Ledger Entry’, ‘tabGL Entry’].

### Module

other

### Version

13

### Installation method

manual install

----Error Log
Traceback with variables (most recent call last):
  File ""/usr/lib/python3.10/runpy.py"", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
      mod_name = 'frappe.utils.bench_helper'
      alter_argv = True
      mod_spec = ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7342326d2bf0>, origin='/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/bench_helper.py')
      code = <code object <module> at 0x7342317b3cb0, file ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 1>
      main_globals = {'__name__': '__main__', '__doc__': None, '__package__': 'frappe.utils', '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x7342326d2bf0>, '__spec__': ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7342326d2bf0>, origin='/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'), '__annotations__': {}, '__builtins__': <module 'builtins' (built-in)>, '__file__': '/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/bench_helper.py', '__cached__': '/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc', 'importlib': <module 'importlib' from '/usr/lib/python3.10/importlib/__init__.py'>, 'json': <module 'json' from '/usr/lib/python3.10/json/__init__.py'>, 'os': <module 'os' from '/usr/lib/python3.10/os.py'>, 'traceback': <module 'traceback' from '/usr/lib/python3.10/traceback.py'>, 'warnings': <module 'warnings' from '/usr/lib/python3.10/warni...
  File ""/usr/lib/python3.10/runpy.py"", line 86, in _run_code
    exec(code, run_globals)
      code = <code object <module> at 0x7342317b3cb0, file ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 1>
      run_globals = {'__name__': '__main__', '__doc__': None, '__package__': 'frappe.utils', '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x7342326d2bf0>, '__spec__': ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7342326d2bf0>, origin='/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'), '__annotations__': {}, '__builtins__': <module 'builtins' (built-in)>, '__file__': '/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/bench_helper.py', '__cached__': '/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc', 'importlib': <module 'importlib' from '/usr/lib/python3.10/importlib/__init__.py'>, 'json': <module 'json' from '/usr/lib/python3.10/json/__init__.py'>, 'os': <module 'os' from '/usr/lib/python3.10/os.py'>, 'traceback': <module 'traceback' from '/usr/lib/python3.10/traceback.py'>, 'warnings': <module 'warnings' from '/usr/lib/python3.10/warni...
      init_globals = None
      mod_name = '__main__'
      mod_spec = ModuleSpec(name='frappe.utils.bench_helper', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7342326d2bf0>, origin='/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/bench_helper.py')
      pkg_name = 'frappe.utils'
      script_name = None
      loader = <_frozen_importlib_external.SourceFileLoader object at 0x7342326d2bf0>
      fname = '/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/bench_helper.py'
      cached = '/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/__pycache__/bench_helper.cpython-310.pyc'
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 109, in <module>
    main()
      ...skipped... 25 vars
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/utils/bench_helper.py"", line 18, in main
    click.Group(commands=commands)(prog_name=""bench"")
      commands = {'frappe': <Group frappe>, 'get-frappe-commands': <Command get-frappe-commands>, 'get-frappe-help': <Command get-frappe-help>}
  File ""/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 829, in __call__
    return self.main(*args, **kwargs)
      self = <Group None>
      args = ()
      kwargs = {'prog_name': 'bench'}
  File ""/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 782, in main
    rv = self.invoke(ctx)
      self = <Group None>
      args = ['frappe', '--site', 'erp-migration', 'migrate', '--skip-failing']
      prog_name = 'bench'
      complete_var = None
      standalone_mode = True
      extra = {}
      ctx = <click.core.Context object at 0x7342317cd4b0>
  File ""/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
      _process_result = <function MultiCommand.invoke.<locals>._process_result at 0x7342317d3250>
      args = ['migrate', '--skip-failing']
      cmd_name = 'frappe'
      cmd = <Group frappe>
      sub_ctx = <click.core.Context object at 0x734231631ea0>
      ctx = <click.core.Context object at 0x7342317cd4b0>
      self = <Group None>
  File ""/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
      _process_result = <function MultiCommand.invoke.<locals>._process_result at 0x73423162e710>
      args = []
      cmd_name = 'migrate'
      cmd = <Command migrate>
      sub_ctx = <click.core.Context object at 0x734231632020>
      ctx = <click.core.Context object at 0x734231631ea0>
      self = <Group frappe>
  File ""/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
      self = <Command migrate>
      ctx = <click.core.Context object at 0x734231632020>
  File ""/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/click/core.py"", line 610, in invoke
    return callback(*args, **kwargs)
      args = ()
      kwargs = {'skip_failing': True, 'skip_search_index': False}
      self = <click.core.Context object at 0x734231632020>
      callback = <function migrate at 0x7342315deb00>
      ctx = <click.core.Context object at 0x734231632020>
  File ""/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/click/decorators.py"", line 21, in new_func
    return f(get_current_context(), *args, **kwargs)
      args = ()
      kwargs = {'skip_failing': True, 'skip_search_index': False}
      f = <function migrate at 0x7342315de8c0>
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/commands/__init__.py"", line 29, in _func
    ret = f(frappe._dict(ctx.obj), *args, **kwargs)
      ctx = <click.core.Context object at 0x734231632020>
      args = ()
      kwargs = {'skip_failing': True, 'skip_search_index': False}
      profile = False
      f = <function migrate at 0x7342315de830>
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/commands/site.py"", line 671, in migrate
    SiteMigration(
      context = {'sites': ['erp-migration'], 'force': False, 'verbose': False, 'profile': False}
      skip_failing = True
      skip_search_index = False
      activate_by_import = <module 'traceback_with_variables.activate_by_import' from '/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/traceback_with_variables/activate_by_import.py'>
      SiteMigration = <class 'frappe.migrate.SiteMigration'>
      site = 'erp-migration'
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/migrate.py"", line 182, in run
    self.run_schema_updates()
      self = <frappe.migrate.SiteMigration object at 0x734231632320>
      site = 'erp-migration'
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/migrate.py"", line 52, in wrapper
    raise e
      args = (<frappe.migrate.SiteMigration object at 0x734231632320>,)
      kwargs = {}
      method = <function SiteMigration.run_schema_updates at 0x73422979e950>
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/migrate.py"", line 44, in wrapper
    ret = method(*args, **kwargs)
      args = (<frappe.migrate.SiteMigration object at 0x734231632320>,)
      kwargs = {}
      method = <function SiteMigration.run_schema_updates at 0x73422979e950>
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/migrate.py"", line 121, in run_schema_updates
    frappe.modules.patch_handler.run_all(
      self = <frappe.migrate.SiteMigration object at 0x734231632320>
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 76, in run_all
    run_patch(patch)
      patch_type = <PatchType.post_model_sync: 'post_model_sync'>
      executed = {'erpnext.patches.v10_0.set_currency_in_pricing_rule', 'execute:frappe.db.set_value(""Accounts Settings"", ""Accounts Settings"", ""service_provider"", ""frankfurter.app"")', 'erpnext.patches.v12_0.add_gst_category_in_delivery_note', 'frappe.patches.v14_0.setup_likes_from_feedback', 'erpnext.patches.v12_0.set_published_in_hub_tracked_item', 'erpnext.patches.v11_1.set_status_for_material_request_type_manufacture', 'erpnext.patches.v11_0.create_department_records_for_each_company', 'erpnext.patches.v13_0.delete_old_purchase_reports', ""execute:frappe.reload_doc('custom', 'doctype', 'custom_field')"", 'erpnext.patches.v11_0.skip_user_permission_check_for_department', 'erpnext.patches.v13_0.create_accounting_dimensions_for_asset_repair', 'frappe.patches.v12_0.remove_feedback_rating', 'frappe.patches.v14_0.save_ratings_in_fraction #23-12-2021', 'frappe.patches.v15_0.set_file_type', 'erpnext.patches.v11_0.rename_asset_adjustment_doctype', 'erpnext.patches.v12_0.update_item_tax_template_company', 'erpn...
      run_patch = <function run_all.<locals>.run_patch at 0x734228952f80>
      patches = [""execute:frappe.get_doc('Role', 'Guest').save() # remove desk access"", 'frappe.core.doctype.role.patches.v13_set_default_desk_properties', 'frappe.patches.v14_0.update_workspace2 # 06.06.2023', 'frappe.patches.v14_0.drop_data_import_legacy', 'frappe.patches.v14_0.copy_mail_data #08.03.21', 'frappe.patches.v14_0.update_github_endpoints #08-11-2021', 'frappe.patches.v14_0.remove_db_aggregation', 'frappe.patches.v14_0.update_color_names_in_kanban_board_column', 'frappe.patches.v14_0.update_is_system_generated_flag', 'frappe.patches.v14_0.update_auto_account_deletion_duration', 'frappe.patches.v14_0.update_integration_request', 'frappe.patches.v14_0.set_document_expiry_default', 'frappe.patches.v14_0.delete_data_migration_tool', 'frappe.patches.v14_0.set_suspend_email_queue_default', 'frappe.patches.v14_0.different_encryption_key', 'frappe.patches.v14_0.update_multistep_webforms', 'frappe.patches.v14_0.drop_unused_indexes', 'frappe.patches.v14_0.disable_email_accounts_with_oauth', 'frappe...
      patch = 'erpnext.patches.v14_0.migrate_gl_to_payment_ledger'
      skip_failing = True
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 70, in run_patch
    update_patch_log(patch, skipped=True)
      patch = 'erpnext.patches.v14_0.migrate_gl_to_payment_ledger'
      skip_failing = True
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/modules/patch_handler.py"", line 210, in update_patch_log
    patch = frappe.get_doc({""doctype"": ""Patch Log"", ""patch"": patchmodule})
      patchmodule = 'erpnext.patches.v14_0.migrate_gl_to_payment_ledger'
      skipped = True
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/__init__.py"", line 1192, in get_doc
    doc = frappe.model.document.get_doc(*args, **kwargs)
      args = ({'doctype': 'Patch Log', 'patch': 'erpnext.patches.v14_0.migrate_gl_to_payment_ledger'},)
      kwargs = {}
      frappe = <module 'frappe' from '/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/__init__.py'>
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/model/document.py"", line 73, in get_doc
    controller = get_controller(doctype)
      args = ({'doctype': 'Patch Log', 'patch': 'erpnext.patches.v14_0.migrate_gl_to_payment_ledger'},)
      kwargs = {'doctype': 'Patch Log', 'patch': 'erpnext.patches.v14_0.migrate_gl_to_payment_ledger'}
      doctype = 'Patch Log'
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/model/base_document.py"", line 90, in get_controller
    return _get_controller()
      _get_controller = <function get_controller.<locals>._get_controller at 0x734228953520>
      doctype = 'Patch Log'
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/model/base_document.py"", line 60, in _get_controller
    module_name, custom = frappe.db.get_value(
      Document = <class 'frappe.model.document.Document'>
      NestedSet = <class 'frappe.utils.nestedset.NestedSet'>
      doctype = 'Patch Log'
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/database/database.py"", line 568, in get_value
    result = self.get_values(
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x734229747c10>
      doctype = 'DocType'
      filters = 'Patch Log'
      fieldname = ('module', 'custom')
      ignore = None
      as_dict = False
      debug = False
      order_by = 'KEEP_DEFAULT_ORDERING'
      cache = False
      for_update = False
      run = True
      pluck = False
      distinct = False
      skip_locked = False
      wait = True
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/database/database.py"", line 672, in get_values
    out = self._get_values_from_table(
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x734229747c10>
      doctype = 'DocType'
      filters = 'Patch Log'
      fieldname = ('module', 'custom')
      ignore = None
      as_dict = False
      debug = False
      order_by = 'modified'
      update = None
      cache = False
      for_update = False
      run = True
      pluck = False
      distinct = False
      limit = 1
      skip_locked = False
      wait = True
      out = None
      fields = ('module', 'custom')
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/database/database.py"", line 910, in _get_values_from_table
    return query.run(as_dict=as_dict, debug=debug, update=update, run=run, pluck=pluck)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x734229747c10>
      fields = ('module', 'custom')
      filters = 'Patch Log'
      doctype = 'DocType'
      as_dict = False
      debug = False
      order_by = 'modified'
      update = None
      for_update = False
      skip_locked = False
      wait = True
      run = True
      pluck = False
      distinct = False
      limit = 1
      query = SELECT `module`,`custom` FROM `tabDocType` WHERE `name`='Patch Log' ORDER BY `modified` DESC LIMIT 1
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/query_builder/utils.py"", line 87, in execute_query
    result = frappe.db.sql(query, params, *args, **kwargs)  # nosemgrep
      query = 'SELECT `module`,`custom` FROM `tabDocType` WHERE `name`=%(param1)s ORDER BY `modified` DESC LIMIT 1'
      args = ()
      kwargs = {'as_dict': False, 'debug': False, 'update': None, 'run': True, 'pluck': False}
      child_queries = []
      params = {'param1': 'Patch Log'}
      execute_child_queries = <function patch_query_execute.<locals>.execute_child_queries at 0x73422979e5f0>
      prepare_query = <function patch_query_execute.<locals>.prepare_query at 0x7342297ac280>
  File ""/home/m_abdelhameed/frappe-bench/apps/frappe/frappe/database/database.py"", line 244, in sql
    self._cursor.execute(query, values)
      self = <frappe.database.mariadb.database.MariaDBDatabase object at 0x734229747c10>
      query = 'SELECT `module`,`custom` FROM `tabDocType` WHERE `name`=%(param1)s ORDER BY `modified` DESC LIMIT 1'
      values = {'param1': 'Patch Log'}
      as_dict = False
      as_list = 0
      formatted = 0
      debug = False
      ignore_ddl = 0
      as_utf8 = 0
      auto_commit = 0
      update = None
      explain = False
      run = True
      pluck = False
      as_iterator = False
      trace_id = None
  File ""/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/pymysql/cursors.py"", line 158, in execute
    result = self._query(query)
      self = <pymysql.cursors.Cursor object at 0x734228baa4a0>
      query = ""SELECT `module`,`custom` FROM `tabDocType` WHERE `name`='Patch Log' ORDER BY `modified` DESC LIMIT 1""
      args = {'param1': 'Patch Log'}
  File ""/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/pymysql/cursors.py"", line 325, in _query
    conn.query(q)
      self = <pymysql.cursors.Cursor object at 0x734228baa4a0>
      q = ""SELECT `module`,`custom` FROM `tabDocType` WHERE `name`='Patch Log' ORDER BY `modified` DESC LIMIT 1""
      conn = <pymysql.connections.Connection object at 0x734228baa3e0>
  File ""/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/pymysql/connections.py"", line 548, in query
    self._execute_command(COMMAND.COM_QUERY, sql)
      self = <pymysql.connections.Connection object at 0x734228baa3e0>
      sql = b""SELECT `module`,`custom` FROM `tabDocType` WHERE `name`='Patch Log' ORDER BY `modified` DESC LIMIT 1""
      unbuffered = False
  File ""/home/m_abdelhameed/frappe-bench/env/lib/python3.10/site-packages/pymysql/connections.py"", line 797, in _execute_command
    raise err.InterfaceError(0, """")
      self = <pymysql.connections.Connection object at 0x734228baa3e0>
      command = 3
      sql = b""SELECT `module`,`custom` FROM `tabDocType` WHERE `name`='Patch Log' ORDER BY `modified` DESC LIMIT 1""
pymysql.err.InterfaceError: (0, '')

_No response_",Mahs-takwene,2024-03-26 12:25:57+00:00,[],2024-04-12 00:08:14+00:00,2024-03-28 08:57:02+00:00,https://github.com/frappe/erpnext/issues/40682,"[('bug', None)]","[{'comment_id': 2024702165, 'issue_id': 2208108379, 'author': 'deepeshgarg007', 'body': '@Mahs-takwene Patch timed out, your MYSQL connection died.', 'created_at': datetime.datetime(2024, 3, 28, 8, 57, 2, tzinfo=datetime.timezone.utc)}]","deepeshgarg007 on (2024-03-28 08:57:02 UTC): @Mahs-takwene Patch timed out, your MYSQL connection died.

"
2207656835,issue,closed,completed,fix: Indicate correct currency code for the payment,"### Information about bug

When customer pays into your USD account while the customer has INR party account, the message reads
""Amount INR 4436 received from ABCD LIMITED
Transaction reference no IT240853160 dated 2024-03-25""

It should be 
""Amount USD 4436 received from ABCD LIMITED
Transaction reference no IT240853160 dated 2024-03-25""

https://github.com/frappe/erpnext/blob/064127935b0ebd21fe268dfcabdf30dd0ec2dbb8/erpnext/accounts/doctype/payment_entry/payment_entry.py#L1114C8-L1114C35


Instead of self.party_account_currency it should be self.paid_to_account_currency if it is ""Receive"" or self.paid_from_currency if it is ""Pay""

### Module

accounts

### Version

ERPNext: v14.62.3 (version-14)
Frappe Framework: v14.65.0 (version-14)



### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",miteshpc,2024-03-26 09:11:25+00:00,['khushi8112'],2024-04-25 00:10:51+00:00,2024-04-10 16:52:30+00:00,https://github.com/frappe/erpnext/issues/40676,"[('bug', None)]",[],
2207644107,issue,open,,Discount % and Margin % Issue,"Hello Frappe Team,

Use Case:

When we do any Purchasing Transaction or Selling Transaction and enter 1 Rate Say 100 and it gets updated in the Price List rate

When we make any changes in the Rate again say from Rs 100 to 2000 or reduce the same, the amount shows in the Discount % or Margin %. of Rs 1900 and it shows both- Margin and Discount also

This is causing a lot of confusion for the user

Can we have settings in the Buying to enable and disable this Type of Discount/Margin Section

This should be applicable when the User himself want to enter any discount % or Margin % by itself. Here the system is itself creating a discount or Margin% which causes a lot of confusion and thereby gets non-confidence in the Product or they consider this as a bug

My Suggestion is that we should have an option to enable this system-generated Discount/Margin %. In case the user wants to have that Option- then it will enable the same and this would be manual method where the user will enter in case it require

https://sawipl.frappe.cloud/app/purchase-invoice/PINV-24-00027

Hello Frappe Team,

Use Case:

When we do any Purchasing Transaction or Selling Transaction and enter 1 Rate Say 100 and it gets updated in the Price List rate

When we make any changes in the Rate again say from Rs 100 to 2000 or reduce the same, the amount shows in the Discount % or Margin %. of Rs 1900 and it shows both- Margin and Discount also

This is causing a lot of confusion for the user

Can we have settings in the Buying to enable and disable this Type of Discount/Margin Section

This should be applicable when the User himself want to enter any discount % or Margin % by itself. Here the system is itself creating a discount or Margin% which causes a lot of confusion and thereby gets non-confidence in the Product or they consider this as a bug

My Suggestion is that we should have an option to enable this system-generated Discount/Margin %. In case the user wants to have that Option- then it will enable the same and this would be manual method where the user will enter in case it require

https://sawipl.frappe.cloud/app/purchase-invoice/PINV-24-00027

Hello Frappe Team,

Use Case:

When we do any Purchasing Transaction or Selling Transaction and enter 1 Rate Say 100 and it gets updated in the Price List rate

When we make any changes in the Rate again say from Rs 100 to 2000 or reduce the same, the amount shows in the Discount % or Margin %. of Rs 1900 and it shows both- Margin and Discount also

This is causing a lot of confusion for the user

Can we have settings in the Buying to enable and disable this Type of Discount/Margin Section

This should be applicable when the User himself want to enter any discount % or Margin % by itself. Here the system is itself creating a discount or Margin% which causes a lot of confusion and thereby gets non-confidence in the Product or they consider this as a bug

My Suggestion is that we should have an option to enable this system-generated Discount/Margin %. In case the user wants to have that Option- then it will enable the same and this would be manual method where the user will enter in case it require

https://sawipl.frappe.cloud/app/purchase-invoice/PINV-24-00027

![image](https://github.com/frappe/erpnext/assets/30833692/909615b6-60d5-4e33-ad3d-e66e7a93c580)


",tailorraj,2024-03-26 09:05:20+00:00,[],2024-10-27 04:12:51+00:00,,https://github.com/frappe/erpnext/issues/40675,"[('feature-request', None)]","[{'comment_id': 2019919352, 'issue_id': 2207644107, 'author': 'szufisher', 'body': 'I agree.', 'created_at': datetime.datetime(2024, 3, 26, 9, 25, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2022113064, 'issue_id': 2207644107, 'author': 'rohitwaghchaure', 'body': ""Instead of changing the Rate, change the price list rate then discount wouldn't be applied"", 'created_at': datetime.datetime(2024, 3, 27, 7, 24, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2439837425, 'issue_id': 2207644107, 'author': 'amrit-citrusleaf', 'body': '> Instead of changing the Rate, change the price list rate then discount wouldn\'t be applied\n\nIt\'s not very intuitive for the user to change the price list rate, honestly. \n\nMost users understands the word ""rate"" easily and change it.', 'created_at': datetime.datetime(2024, 10, 27, 4, 12, 50, tzinfo=datetime.timezone.utc)}]","szufisher on (2024-03-26 09:25:02 UTC): I agree.

rohitwaghchaure on (2024-03-27 07:24:28 UTC): Instead of changing the Rate, change the price list rate then discount wouldn't be applied

amrit-citrusleaf on (2024-10-27 04:12:50 UTC): It's not very intuitive for the user to change the price list rate, honestly. 

Most users understands the word ""rate"" easily and change it.

"
2207337013,issue,open,, There is no provision to create a Standlone Sales Return against the Delivery Note,"Hello Frappe Team,

There is a use case as below steps

We do the Delivery Note Multiple Times for Multiple Dispatch

Sales invoice are recorded at the end of the Month

Client Returns the Goods and at that time we does not know against which Delivery Note it got returned as this happens in a Bulk Qty and without any DN Reference by the Customer

Now we want to do the Return Entry but we cannot do against the Particular Delivery Note as we do not know DN No and Customer returns the Goods in a Bulk

So We do not have a provision to create the Delivery Note standalone as this “Is Return” is a Read Only. Can you make open then we can do standlone Returns like at the Sales Invoice you have given an Opion to Click of Is Return, same way we need at the Delivery Note , presently at the DN it is ready Only

![image](https://github.com/frappe/erpnext/assets/30833692/43d4e0d7-d1d1-43f2-ace8-f322db4a0850)



",tailorraj,2024-03-26 06:05:01+00:00,[],2024-03-26 07:03:10+00:00,,https://github.com/frappe/erpnext/issues/40671,"[('feature-request', None)]","[{'comment_id': 2019529020, 'issue_id': 2207337013, 'author': 'tailorraj', 'body': 'In case you provide the Standlone Return Option at the Delivery Note, the Implication on the below would happen\r\n\r\nAs per the Stock Ledger, the Valuation Rate should be as per the Batch Valuation Rate in case the Item is enabled with a Batch and in case the Item is not under the Batch the Stock should get valued as per the Valuation Rate as on the Delivery Note Date.\r\n\r\nAccounting Implication: COGS should also be reversed Credited as since COGS is calculated based on the Valuation Rate and Stock In Hand should be Debited.\r\n\r\nLet us just check the above validation and update us.', 'created_at': datetime.datetime(2024, 3, 26, 7, 3, 9, tzinfo=datetime.timezone.utc)}]","tailorraj (Issue Creator) on (2024-03-26 07:03:09 UTC): In case you provide the Standlone Return Option at the Delivery Note, the Implication on the below would happen

As per the Stock Ledger, the Valuation Rate should be as per the Batch Valuation Rate in case the Item is enabled with a Batch and in case the Item is not under the Batch the Stock should get valued as per the Valuation Rate as on the Delivery Note Date.

Accounting Implication: COGS should also be reversed Credited as since COGS is calculated based on the Valuation Rate and Stock In Hand should be Debited.

Let us just check the above validation and update us.

"
2207310265,issue,open,,Stock balance is showing different in different reports for batched items,"### Information about bug

the stock balance of certain items shows different in different reports in the system for batch wise items, 

we selected one item with multiple batches and multiple transactions. 

Batch wise report shows  6839 Qty
![image](https://github.com/frappe/erpnext/assets/112148467/1513e0f7-151e-43fd-9982-0aec3976f5ec)

Stock Ledger shows 1635 Qty Overall
![image](https://github.com/frappe/erpnext/assets/112148467/bfbd44df-2c0d-427a-b338-a689ee511ac4)

Stock balance shows 6839 again. 

and once we try to do stock reconciliation the system throws error saying 
![image](https://github.com/frappe/erpnext/assets/112148467/88d80bbc-bcd9-4913-85e7-24d1f86e4a4f)

unable to fix the issue
because of this am unable to do the delivery notes

### Module

stock

### Version

Tested on both v13 and v15 
not working on both sites. 

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",maveezmh,2024-03-26 05:42:58+00:00,[],2024-08-22 14:15:11+00:00,,https://github.com/frappe/erpnext/issues/40670,"[('bug', None)]","[{'comment_id': 2033677422, 'issue_id': 2207310265, 'author': 'KhadijaAMH', 'body': 'I am facing the same error. This is a major stopping point, as we are not able to deliver the available stock because of the error being thrown regarding the stock ledger.', 'created_at': datetime.datetime(2024, 4, 3, 6, 42, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2304776048, 'issue_id': 2207310265, 'author': 'jayfiro', 'body': 'Can you please share a screenshot of the same reports you posted where we can see the report filters? I am not able to reproduce this bug on v14.72.1 nor on v15.32.0.\r\n\r\nAlso, please post a screenshot of your Available Batch Report for this item.', 'created_at': datetime.datetime(2024, 8, 22, 14, 11, 3, tzinfo=datetime.timezone.utc)}]","KhadijaAMH on (2024-04-03 06:42:18 UTC): I am facing the same error. This is a major stopping point, as we are not able to deliver the available stock because of the error being thrown regarding the stock ledger.

jayfiro on (2024-08-22 14:11:03 UTC): Can you please share a screenshot of the same reports you posted where we can see the report filters? I am not able to reproduce this bug on v14.72.1 nor on v15.32.0.

Also, please post a screenshot of your Available Batch Report for this item.

"
2206636556,issue,open,,Bank Clearance Date error will prevent further corrections unless page is refreshed,"### Information about bug

When using the `Bank Clearance` module, if a mistake is made when entering the clearance date and after the error message pops up, **it is not possible to correct the mistake and update again.** You need to refresh the whole page and start over. This is time consuming when updating a lot of entries.

More specifically, if the date entered for the clearance is before the date of the cheque, this issue would arise.


### Module

other

### Version

ERPNext: v15.15.0
Frappe Framework: v15.17.0

### Installation method

docker

### Relevant log output / Stack trace / Full Error Message.

```shell
request.js:473 Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 110, in application
    response = frappe.api.handle(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/__init__.py"", line 49, in handle
    data = endpoint(**arguments)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/api/v1.py"", line 36, in handle_rpc_call
    return frappe.handler.handle()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 49, in handle
    data = execute_cmd(cmd)
           ^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/__init__.py"", line 1716, in call
    return fn(*args, **newargs)
           ^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/handler.py"", line 327, in run_doc_method
    response = doc.run_method(method)
               ^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 959, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1319, in composer
    return composed(self, method, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 1301, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/model/document.py"", line 956, in fn
    return method_object(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""apps/frappe/frappe/utils/typing_validations.py"", line 31, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File ""apps/erpnext/erpnext/accounts/doctype/bank_clearance/bank_clearance.py"", line 98, in update_clearance_date
    frappe.throw(
  File ""apps/frappe/frappe/__init__.py"", line 600, in throw
    msgprint(
  File ""apps/frappe/frappe/__init__.py"", line 565, in msgprint
    _raise_exception()
  File ""apps/frappe/frappe/__init__.py"", line 516, in _raise_exception
    raise exc
frappe.exceptions.ValidationError: Row #2: Clearance date 2024-02-11 cannot be before Cheque Date 2024-02-12
```
```
",bynicolas,2024-03-25 20:24:27+00:00,[],2024-03-25 20:24:27+00:00,,https://github.com/frappe/erpnext/issues/40662,"[('bug', None)]",[],
2206555547,issue,open,,Payment Request: message needs to be rendered with PR added as context,"### Information about bug

A PR email message is currently rendered with only the reference document and payment url as context.

For example, if you raised a PR from a Sales Order, you could have a payment schedule and require that the PR amount is not the grand total of the SO.

Therefore the message needs the PR amount as context.

https://github.com/frappe/erpnext/blob/e04a3b107af863f5fc6e822ad5effda0f54c6121/erpnext/accounts/doctype/payment_request/payment_request.py#L392

### Module

accounts

### Version

v16 develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-03-25 19:42:36+00:00,[],2024-03-25 19:42:36+00:00,,https://github.com/frappe/erpnext/issues/40661,"[('bug', None)]",[],
2206430773,issue,closed,not_planned,Payment Request: Inconsistency in message,"### Information about bug

The first expression in the line retrieves an unrendered message which will later be rendered in certain circumstances with the PR.
The second expression first renders a hard-coded template with the reference document.

It would make more sense if both were left unrendered to be populated later with the PR doc context.

https://github.com/frappe/erpnext/blob/e04a3b107af863f5fc6e822ad5effda0f54c6121/erpnext/accounts/doctype/payment_request/payment_request.py#L508


### Module

accounts

### Version

v16 develop

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",casesolved-co-uk,2024-03-25 18:40:52+00:00,[],2024-04-09 00:08:22+00:00,2024-03-25 19:30:44+00:00,https://github.com/frappe/erpnext/issues/40660,"[('bug', None)]",[],
2206076291,issue,open,,Scrap Items doesn't show when Finishing work order,"### Information about bug

After separating BOM Scrap Item from BOM Item.
When a Manufacture User tries to Finish a Work Order.

The created Stock Entry (Manufacture) doesn't show the Scrap Items configured in the BOM.



### Module

manufacturing

### Version

Frappe Framework: v15.18.2
ERPNext: v15.17.6 

### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",meaziz,2024-03-25 15:46:13+00:00,[],2024-03-25 16:05:34+00:00,,https://github.com/frappe/erpnext/issues/40658,"[('bug', None)]","[{'comment_id': 2018361091, 'issue_id': 2206076291, 'author': 'meaziz', 'body': 'We traced the issue to this Method get_scrap_items_from_sub_assemblies\r\n\r\nIdeally it should reference the BOM Scrap Item.\r\n\r\nYet the recursive logic needs to be reviewed since the data structure changed.\r\n\r\n\r\nhttps://github.com/frappe/erpnext/blob/22f39350240ffbf2ac2b5527ba68859137291024/erpnext/manufacturing/doctype/bom/bom.py#L1510', 'created_at': datetime.datetime(2024, 3, 25, 16, 5, 32, tzinfo=datetime.timezone.utc)}]","meaziz (Issue Creator) on (2024-03-25 16:05:32 UTC): We traced the issue to this Method get_scrap_items_from_sub_assemblies

Ideally it should reference the BOM Scrap Item.

Yet the recursive logic needs to be reviewed since the data structure changed.


https://github.com/frappe/erpnext/blob/22f39350240ffbf2ac2b5527ba68859137291024/erpnext/manufacturing/doctype/bom/bom.py#L1510

"
2205850309,issue,open,,Change the link fields filter dynamically via script (without the need of a manual full page refresh),"### Information about bug

On a client script when we try to dynamically change the filtering on a link type field, via overriding the default set_query method of the field by specifying new filter values, we can't do so dynamically.
I've tried both refreshing just the field, and refreshing the entire doctype, but it doesn't work.
The new filter value is however applied only after a full manual browser page refresh.

```javascript
frm.set_query('fieldName', 'doctype', function() {
    return {
        filters: { 'filterField': 'value' }
    };
});

// Refresh the field
frm.refresh_field('fieldName');

// Refresh all fields in the form
frm.refresh_fields();

// Refresh the doc
frm.refresh();

// None of them work, the filters are updated only after hard manual refresh
```

Is there any other method one could use to achieve this expected functionality?

### Module

other

### Version

Frappe Framework: v14.47.2 (version-14)
ERPNext: v14.37.1 (version-14)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",GeorgeDeac,2024-03-25 14:07:22+00:00,[],2024-07-16 11:26:40+00:00,,https://github.com/frappe/erpnext/issues/40656,"[('bug', None)]","[{'comment_id': 2027946129, 'issue_id': 2205850309, 'author': 'jeshani', 'body': '@GeorgeDeac \r\nYou can achieve directly setting the query within the onload_post_render event, eliminating the need for the refresh event. \r\n\r\n```javascript\r\nfrappe.ui.form.on(""doctype"", {\r\n    onload_post_render: function(frm) {\r\n        frm.set_query(""field"", {\r\n            filters: {\r\n                ""field1"": 1,\r\n                ""field2"": 2\r\n            }\r\n        });\r\n    }\r\n});', 'created_at': datetime.datetime(2024, 3, 30, 6, 58, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2112993789, 'issue_id': 2205850309, 'author': 'GeorgeDeac', 'body': '> @GeorgeDeac You can achieve directly setting the query within the onload_post_render event, eliminating the need for the refresh event.\r\n> \r\n> ```js\r\n> frappe.ui.form.on(""doctype"", {\r\n>     onload_post_render: function(frm) {\r\n>         frm.set_query(""field"", {\r\n>             filters: {\r\n>                 ""field1"": 1,\r\n>                 ""field2"": 2\r\n>             }\r\n>         });\r\n>     }\r\n> });\r\n> ```\r\n\r\nYes, but I need to change the filter dynamically by script interaction, depending on how other field/s are changing in real time, not just set it once at page load. The only workaround I found was using autocomplete fields and a custom script to fetch values from the server depending on the parameters taken from the other fields. Is this also possible directly with the link fields by changing the filter in real time?', 'created_at': datetime.datetime(2024, 5, 15, 16, 34, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2230656678, 'issue_id': 2205850309, 'author': 'krunal1904', 'body': ""```\r\nfrm.set_query('fieldName', 'doctype', function() {\r\n    return {\r\n        filters: { 'filterField': 'value' }\r\n    };\r\n});\r\n```\r\nis applying filter to link field but when i use order_by,limit  etc. after the filters that are not applying on link field filter. \r\nhere is my code: - \r\n```\r\nfrm.set_query('fieldName', 'doctype', function() {\r\n    return {\r\n        filters: { 'filterField': 'value' },\r\n        order_by='date desc',\r\n        limit = 20\r\n    };\r\n}); \r\n```"", 'created_at': datetime.datetime(2024, 7, 16, 11, 26, 39, tzinfo=datetime.timezone.utc)}]","jeshani on (2024-03-30 06:58:26 UTC): @GeorgeDeac 
You can achieve directly setting the query within the onload_post_render event, eliminating the need for the refresh event. 

```javascript
frappe.ui.form.on(""doctype"", {
    onload_post_render: function(frm) {
        frm.set_query(""field"", {
            filters: {
                ""field1"": 1,
                ""field2"": 2
            }
        });
    }
});

GeorgeDeac (Issue Creator) on (2024-05-15 16:34:22 UTC): Yes, but I need to change the filter dynamically by script interaction, depending on how other field/s are changing in real time, not just set it once at page load. The only workaround I found was using autocomplete fields and a custom script to fetch values from the server depending on the parameters taken from the other fields. Is this also possible directly with the link fields by changing the filter in real time?

krunal1904 on (2024-07-16 11:26:39 UTC): ```
frm.set_query('fieldName', 'doctype', function() {
    return {
        filters: { 'filterField': 'value' }
    };
});
```
is applying filter to link field but when i use order_by,limit  etc. after the filters that are not applying on link field filter. 
here is my code: - 
```
frm.set_query('fieldName', 'doctype', function() {
    return {
        filters: { 'filterField': 'value' },
        order_by='date desc',
        limit = 20
    };
}); 
```

"
2205391618,issue,open,,Automatic creation of main product price for bundle products,"When bidding on products created in the product package, the price of the main product must be the sum of the prices of the sub-products. Because price entry is made for the main product as well as for the sub-product. For example, when the offer is created, only the price of the main product is shown in the total amount, sub-products are not included in the price calculation.",fzozyurt,2024-03-25 10:23:01+00:00,[],2024-03-25 10:23:01+00:00,,https://github.com/frappe/erpnext/issues/40654,"[('feature-request', None)]",[],
2204849558,issue,closed,completed,General Ledger Voucher Subtype Issue,"### Information about bug

In General Ledger report, voucher subtype is interchanged Sales Invoice Subtype is Debit Note and Purchase Invoice Subtype is Credit Note.

Voucher  Type = Sales Invoice
![image](https://github.com/frappe/erpnext/assets/91895505/e50c308f-88e1-4ac0-95a9-4c5d9079fc11)

Voucher Type = Purchase Invoice
![image](https://github.com/frappe/erpnext/assets/91895505/dbaf9c93-5e90-4c8a-b7d5-0666ab329529)


### Module

accounts

### Version

Frappe Framework: v15.18.2 (HEAD)
ERPNext: v15.17.5 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",Gubbu77,2024-03-25 04:15:37+00:00,[],2024-04-12 00:08:11+00:00,2024-03-28 08:44:12+00:00,https://github.com/frappe/erpnext/issues/40646,"[('bug', None)]","[{'comment_id': 2024682646, 'issue_id': 2204849558, 'author': 'deepeshgarg007', 'body': '@Gubbu77 a Sales Invoice is a Debit note and Purchase Invoice is a credit note. A sales invoice return is a Credit Note and a purchase invoice return is Debit note.', 'created_at': datetime.datetime(2024, 3, 28, 8, 44, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2024810247, 'issue_id': 2204849558, 'author': 'rtdany10', 'body': '@deepeshgarg007 the accounting impact might be same, but a Sales Invoice is not really Debit Note as it has a different meaning. So is the case of Purchase Invoice and Credit Note. Maybe we should keep the subtype column empty for normal invoices?', 'created_at': datetime.datetime(2024, 3, 28, 9, 56, 52, tzinfo=datetime.timezone.utc)}]","deepeshgarg007 on (2024-03-28 08:44:12 UTC): @Gubbu77 a Sales Invoice is a Debit note and Purchase Invoice is a credit note. A sales invoice return is a Credit Note and a purchase invoice return is Debit note.

rtdany10 on (2024-03-28 09:56:52 UTC): @deepeshgarg007 the accounting impact might be same, but a Sales Invoice is not really Debit Note as it has a different meaning. So is the case of Purchase Invoice and Credit Note. Maybe we should keep the subtype column empty for normal invoices?

"
2204503314,issue,closed,completed,Wrong advance payment status in edge case,"### Information about bug

** Prepare Diff **
```diff
diff --git a/erpnext/controllers/status_updater.py b/erpnext/controllers/status_updater.py
index e5f341fc25..70124a8584 100644
--- a/erpnext/controllers/status_updater.py
+++ b/erpnext/controllers/status_updater.py
@@ -201,6 +201,8 @@ class StatusUpdater(Document):
 						},
 					):
 						self.status = s[0]
+						if self.status == ""To Pay"" and self.doctype == ""Sales Order"":
+							import pdb; pdb. set_trace() 
 						break
 				elif getattr(self, s[1])():
 					self.status = s[0]
```

**Trigger Diff**

```ipython
In [1]: pr = frappe.get_doc(""Payment Request"", ""ACC-PRQ-2024-02549"")

In [2]: pr.set_as_paid()

-> break
(Pdb) w

-> pr.set_as_paid()
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/erpnext/erpnext/accounts/doctype/payment_request/payment_request.py(289)set_as_paid()
-> self.make_invoice()
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/erpnext/erpnext/accounts/doctype/payment_request/payment_request.py(233)make_invoice()
-> si.submit()
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/frappe/frappe/utils/typing_validations.py(31)wrapper()
-> return func(*args, **kwargs)
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/frappe/frappe/model/document.py(1045)submit()
-> return self._submit()
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/frappe/frappe/model/document.py(1028)_submit()
-> return self.save()
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/frappe/frappe/model/document.py(335)save()
-> return self._save(*args, **kwargs)
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/frappe/frappe/model/document.py(388)_save()
-> self.run_post_save_methods()
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/frappe/frappe/model/document.py(1128)run_post_save_methods()
-> self.run_method(""on_submit"")
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/frappe/frappe/model/document.py(959)run_method()
-> out = Document.hook(fn)(self, *args, **kwargs)
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/frappe/frappe/model/document.py(1319)composer()
-> return composed(self, method, *args, **kwargs)
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/frappe/frappe/model/document.py(1301)runner()
-> add_to_return_value(self, fn(self, *args, **kwargs))
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/frappe/frappe/model/document.py(956)fn()
-> return method_object(*args, **kwargs)
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/erpnext/erpnext/accounts/doctype/sales_invoice/sales_invoice.py(468)on_submit()
-> self.update_against_document_in_jv()
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/erpnext/erpnext/controllers/accounts_controller.py(1498)update_against_document_in_jv()
-> reconcile_against_document(lst, active_dimensions=active_dimensions)
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/erpnext/erpnext/accounts/utils.py(543)reconcile_against_document()
-> frappe.get_doc(t, n).set_total_advance_paid()
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/erpnext/erpnext/controllers/accounts_controller.py(1904)set_total_advance_paid()
-> self.set_advance_payment_status(advance_paid, order_total)
  /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/erpnext/erpnext/controllers/accounts_controller.py(1932)set_advance_payment_status()
-> self.set_status(update=True)
> /home/blaggacao/src/gitlab.com/pristina/infraestructura/apps/erpnext/erpnext/controllers/status_updater.py(206)set_status()
-> break
```

### Observed

- `set_as_paid` does end up setting the originating SO as ""To Pay""

### Expected

- `set_as_paid` does **not** end up setting the originating SO as ""To Pay""",blaggacao,2024-03-24 18:55:29+00:00,['ruthra-kumar'],2024-04-21 00:09:08+00:00,2024-04-03 09:35:26+00:00,https://github.com/frappe/erpnext/issues/40642,"[('bug', None)]","[{'comment_id': 2016914625, 'issue_id': 2204503314, 'author': 'blaggacao', 'body': 'This issue surfaced after https://github.com/frappe/erpnext/pull/37069 (which is a legit fix on its own right)', 'created_at': datetime.datetime(2024, 3, 24, 19, 27, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2016917466, 'issue_id': 2204503314, 'author': 'blaggacao', 'body': 'The solution is to completely reset to `None` the advance payment status once payment control has been passed on to the Invoice, because - regardless of how the invoice came to be - we\'ll just assume that now eventual missing payments will be tracked by ""Accounts Due"" (post factum) and not anymore by ""Sales"" (pre-delivery)', 'created_at': datetime.datetime(2024, 3, 24, 19, 37, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2032205260, 'issue_id': 2204503314, 'author': 'ruthra-kumar', 'body': ""@blaggacao \r\n\r\nhttps://github.com/frappe/erpnext/pull/37069 was merged way before this feature https://github.com/frappe/erpnext/pull/38560 was merged in develop. I'm unclear on why you identify that as a cause."", 'created_at': datetime.datetime(2024, 4, 2, 14, 32, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2032317875, 'issue_id': 2204503314, 'author': 'blaggacao', 'body': '@ruthra-kumar This is because of a triangulation where:\r\n\r\n- In our private code base prior to incorporating latest upstream changes, #37069 was not yet present\r\n- Therefore, our (private) ""backported version"" of #38560 behaved normally in our production environment\r\n- Now, upon updating our code base, it turned out that #38560 was and continues to be flawed in the presence of #37069\r\n\r\nNote that the tests in #38560 did not catch the error on the basis of unintended (absence of) side effects of the test setup.', 'created_at': datetime.datetime(2024, 4, 2, 15, 10, 16, tzinfo=datetime.timezone.utc)}]","blaggacao (Issue Creator) on (2024-03-24 19:27:23 UTC): This issue surfaced after https://github.com/frappe/erpnext/pull/37069 (which is a legit fix on its own right)

blaggacao (Issue Creator) on (2024-03-24 19:37:12 UTC): The solution is to completely reset to `None` the advance payment status once payment control has been passed on to the Invoice, because - regardless of how the invoice came to be - we'll just assume that now eventual missing payments will be tracked by ""Accounts Due"" (post factum) and not anymore by ""Sales"" (pre-delivery)

ruthra-kumar (Assginee) on (2024-04-02 14:32:20 UTC): @blaggacao 

https://github.com/frappe/erpnext/pull/37069 was merged way before this feature https://github.com/frappe/erpnext/pull/38560 was merged in develop. I'm unclear on why you identify that as a cause.

blaggacao (Issue Creator) on (2024-04-02 15:10:16 UTC): @ruthra-kumar This is because of a triangulation where:

- In our private code base prior to incorporating latest upstream changes, #37069 was not yet present
- Therefore, our (private) ""backported version"" of #38560 behaved normally in our production environment
- Now, upon updating our code base, it turned out that #38560 was and continues to be flawed in the presence of #37069

Note that the tests in #38560 did not catch the error on the basis of unintended (absence of) side effects of the test setup.

"
2204278775,issue,open,,No verification when merging customer or supplier (receivable or payable account with currency,"### Information about bug

Create a customer ""hassan"" and create an invoice in one currency Create a client and create an invoice in one currency USD
receivable account USD
and Create a customer ""HASSAN"" and create an invoice in one currency Create a client and create an invoice in one currency EGP receivable account EGP
Merge the two customers
The merge is done !!!!!!!!!
Here there is a problem
Please make it not merging



### Module

accounts

### Version

ERPNext: v15.8.0
or ERPNext: v14


### Installation method

None

### Relevant log output / Stack trace / Full Error Message.

_No response_",hassan-youssef,2024-03-24 10:14:04+00:00,[],2024-03-24 10:14:04+00:00,,https://github.com/frappe/erpnext/issues/40636,"[('bug', None)]",[],
2203801024,issue,open,,Unable to Submit Stock Related Transactions with back date after Period Closing,"### Information about bug

Fiscal Year _ 2023-2024 ( April 2023 to March 2024)
Period Closing for the date of 31/01/2023
![image](https://github.com/frappe/erpnext/assets/62122640/8041b9db-2c1c-426f-ba23-8248e06aebea)
Last Stock Transaction for the date of 11/03/2024
![image](https://github.com/frappe/erpnext/assets/62122640/1fd523ad-163e-42b0-a949-f37e35f30808)
When we added stock issue for the date of 01/03/2024
![image](https://github.com/frappe/erpnext/assets/62122640/c877cfaa-38de-4c2b-a44b-3d08ae740c99)
Unable to submit
![image](https://github.com/frappe/erpnext/assets/62122640/76da0329-e139-4071-bb71-84241d342af1)
![image](https://github.com/frappe/erpnext/assets/62122640/30b52534-1736-4ba5-895f-5079e0fb4e19)

Account Settings
![image](https://github.com/frappe/erpnext/assets/62122640/64eabed2-c97d-442e-8056-8aa0540141fb)
Stock Settings
![image](https://github.com/frappe/erpnext/assets/62122640/9f86b6f3-0bde-48fb-b200-ba1554ab0a38)
Transaction after Last Date able to submit
![image](https://github.com/frappe/erpnext/assets/62122640/29cc6d99-7154-42d0-9a0f-1d15c6cc365c)
![image](https://github.com/frappe/erpnext/assets/62122640/44a8a85e-0b7d-46ba-9b99-9829572fa72e)




### Module

stock

### Version

![image](https://github.com/frappe/erpnext/assets/62122640/370da177-dceb-4885-9edd-71dfd64c62a4)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",thida-bcn,2024-03-23 09:55:52+00:00,[],2024-07-13 04:50:33+00:00,,https://github.com/frappe/erpnext/issues/40632,"[('bug', None)]","[{'comment_id': 2226771916, 'issue_id': 2203801024, 'author': 'thida-bcn', 'body': '@ruchamahabal', 'created_at': datetime.datetime(2024, 7, 13, 4, 50, 31, tzinfo=datetime.timezone.utc)}]","thida-bcn (Issue Creator) on (2024-07-13 04:50:31 UTC): @ruchamahabal

"
2203795281,issue,closed,completed,POS >> 100 % Discount can't submit,"### Information about bug

![image](https://github.com/frappe/erpnext/assets/62122640/dc7895b7-d404-4b2e-adc8-94d78ebe610b) 
when give 100 % discount, can't made submit

### Module

selling

### Version

![image](https://github.com/frappe/erpnext/assets/62122640/3fece490-f930-4c65-a9e2-20eed4f2adb9)


### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

```shell
self hosted
```
",thida-bcn,2024-03-23 09:39:40+00:00,['diptanilsaha'],2025-01-21 00:09:59+00:00,2025-01-06 05:13:52+00:00,https://github.com/frappe/erpnext/issues/40631,"[('bug', None), ('POS', None)]","[{'comment_id': 2017443346, 'issue_id': 2203795281, 'author': 'Bowrna', 'body': 'I am a new contributor to Frappe. Could I explore about this bug and fix it?', 'created_at': datetime.datetime(2024, 3, 25, 8, 17, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2029828298, 'issue_id': 2203795281, 'author': 'Bowrna', 'body': '@ruthra-kumar @deepeshgarg007 I have to setup the bench CLI to start running the code in dev mode to fix the issue, am I right?', 'created_at': datetime.datetime(2024, 4, 1, 14, 16, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2029837335, 'issue_id': 2203795281, 'author': 'Bowrna', 'body': 'Also, I could see from the old PR that this issue seems to be fixed. https://github.com/frappe/erpnext/pull/37411', 'created_at': datetime.datetime(2024, 4, 1, 14, 22, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2029901085, 'issue_id': 2203795281, 'author': 'ruthra-kumar', 'body': '> @ruthra-kumar @deepeshgarg007 I have to setup the bench CLI to start running the code in dev mode to fix the issue, am I right?\r\n\r\nIf you are new to Frappe, start here https://frappeframework.com/docs/user/en/introduction\r\nWould suggest to first get comfortable setting up Frappe & ERPNext on local system.', 'created_at': datetime.datetime(2024, 4, 1, 15, 1, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2134786040, 'issue_id': 2203795281, 'author': 'Bowrna', 'body': 'I could see that the problem is somewhere around here. @thida-bcn could you tell me if the issue still persists and what is the discount percentage that you tried to apply?\r\n\r\nhttps://github.com/frappe/erpnext/blob/d3bdd413586b5a227ef5e453dd34748507012957/erpnext/selling/page/point_of_sale/pos_payment.js#L207-L214', 'created_at': datetime.datetime(2024, 5, 28, 9, 43, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2199770636, 'issue_id': 2203795281, 'author': 'thida-bcn', 'body': '> I could see that the problem is somewhere around here. @thida-bcn could you tell me if the issue still persists and what is the discount percentage that you tried to apply?\r\n> \r\n> https://github.com/frappe/erpnext/blob/d3bdd413586b5a227ef5e453dd34748507012957/erpnext/selling/page/point_of_sale/pos_payment.js#L207-L214\r\n\r\nstill having problems\r\n1 item with 100 % discount\r\n![image](https://github.com/frappe/erpnext/assets/62122640/db551bc8-9b97-49bc-b863-3d57ab1e51df)', 'created_at': datetime.datetime(2024, 7, 1, 10, 19, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2565400284, 'issue_id': 2203795281, 'author': 'diptanilsaha', 'body': '@thida-bcn Are you still experiencing the issue?', 'created_at': datetime.datetime(2024, 12, 30, 12, 8, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2572290571, 'issue_id': 2203795281, 'author': 'diptanilsaha', 'body': 'closing due to lack of response', 'created_at': datetime.datetime(2025, 1, 6, 5, 13, 52, tzinfo=datetime.timezone.utc)}]","Bowrna on (2024-03-25 08:17:54 UTC): I am a new contributor to Frappe. Could I explore about this bug and fix it?

Bowrna on (2024-04-01 14:16:47 UTC): @ruthra-kumar @deepeshgarg007 I have to setup the bench CLI to start running the code in dev mode to fix the issue, am I right?

Bowrna on (2024-04-01 14:22:36 UTC): Also, I could see from the old PR that this issue seems to be fixed. https://github.com/frappe/erpnext/pull/37411

ruthra-kumar on (2024-04-01 15:01:35 UTC): If you are new to Frappe, start here https://frappeframework.com/docs/user/en/introduction
Would suggest to first get comfortable setting up Frappe & ERPNext on local system.

Bowrna on (2024-05-28 09:43:41 UTC): I could see that the problem is somewhere around here. @thida-bcn could you tell me if the issue still persists and what is the discount percentage that you tried to apply?

https://github.com/frappe/erpnext/blob/d3bdd413586b5a227ef5e453dd34748507012957/erpnext/selling/page/point_of_sale/pos_payment.js#L207-L214

thida-bcn (Issue Creator) on (2024-07-01 10:19:46 UTC): still having problems
1 item with 100 % discount
![image](https://github.com/frappe/erpnext/assets/62122640/db551bc8-9b97-49bc-b863-3d57ab1e51df)

diptanilsaha (Assginee) on (2024-12-30 12:08:50 UTC): @thida-bcn Are you still experiencing the issue?

diptanilsaha (Assginee) on (2025-01-06 05:13:52 UTC): closing due to lack of response

"
2203715882,issue,closed,completed,Billed Items To Be Received - Wrong Report,"### Information about bug
Case 1
PR and PI Qty is matched still showing as to be received

When I am trying to make PR from PI There no Qty to receive

https://github.com/frappe/erpnext/assets/21578167/aa545741-74ce-4436-8597-833d00724900



### Module

accounts

### Version

ERPNext: v14.64.0 (version-14)

Frappe Framework: v14.66.3 (version-14)

Frappe HR: v14.22.0 (version-14)

India Compliance: v14.24.5 (version-14)

### Installation method

manual install

### Relevant log output / Stack trace / Full Error Message.

_No response_",dineshpanchal93,2024-03-23 06:00:09+00:00,[],2025-01-26 10:29:34+00:00,2025-01-26 10:29:34+00:00,https://github.com/frappe/erpnext/issues/40629,"[('bug', None)]","[{'comment_id': 2016371912, 'issue_id': 2203715882, 'author': 'dineshpanchal93', 'body': 'Case 2\r\n\r\nIn the report received Qty is 0\r\nEntry is booked perfect\r\n\r\nhttps://github.com/frappe/erpnext/assets/21578167/62fce78c-4952-4c1b-bee8-6cd2aff693c8', 'created_at': datetime.datetime(2024, 3, 23, 6, 17, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2016372147, 'issue_id': 2203715882, 'author': 'dineshpanchal93', 'body': '@ankush can you please suggest whats wrong very basic entries.', 'created_at': datetime.datetime(2024, 3, 23, 6, 18, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2037247406, 'issue_id': 2203715882, 'author': 'dineshpanchal93', 'body': 'any update ?', 'created_at': datetime.datetime(2024, 4, 4, 13, 35, 42, tzinfo=datetime.timezone.utc)}]","dineshpanchal93 (Issue Creator) on (2024-03-23 06:17:22 UTC): Case 2

In the report received Qty is 0
Entry is booked perfect

https://github.com/frappe/erpnext/assets/21578167/62fce78c-4952-4c1b-bee8-6cd2aff693c8

dineshpanchal93 (Issue Creator) on (2024-03-23 06:18:15 UTC): @ankush can you please suggest whats wrong very basic entries.

dineshpanchal93 (Issue Creator) on (2024-04-04 13:35:42 UTC): any update ?

"
2203035778,issue,closed,completed,Workstation Job Card Start/Complete Error Message,"### Information about bug

Completing a Job Card from the workstation doc raises and error
Steps to Reproduce Error
1 - Create a Work Order with Job cards
2 - Go to Workstation -> Job Card ->Start, enter employee ID and Start Job, resulting screen changes from Open to Work in Progress
<img width=""1204"" alt=""Screenshot 2024-03-22 at 12 53 31 PM"" src=""https://github.com/frappe/erpnext/assets/100143426/3143816c-c14b-4c5b-8f8b-e4a45f69079a"">
<img width=""1204"" alt=""Screenshot 2024-03-22 at 12 53 49 PM"" src=""https://github.com/frappe/erpnext/assets/100143426/95ae2a14-0633-495b-bf33-58698fd72a8e"">
<img width=""1204"" alt=""Screenshot 2024-03-22 at 12 53 57 PM"" src=""https://github.com/frappe/erpnext/assets/100143426/37a2bc54-7e1c-405a-ba0c-f7c07ae105bc"">

3 - Complete the Job Card by clicking Complete - > Enter the Qty and Submit
<img width=""1204"" alt=""Screenshot 2024-03-22 at 12 54 06 PM"" src=""https://github.com/frappe/erpnext/assets/100143426/d77e6a58-c795-4bb5-a7e5-1aa965772c15"">

4 - Error - Document has been modified....
<img width=""1204"" alt=""Screenshot 2024-03-22 at 12 54 12 PM"" src=""https://github.com/frappe/erpnext/assets/100143426/4d487383-5d3a-48a9-8fd6-ccc530c455e8"">

""X' the Error and Hit Reload from the Menu, now the Job Card can be Completed as Expected.

### Module

manufacturing

### Version

Frappe 15.18.0
ERPNext 15.17.1

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",JRoyDC,2024-03-22 18:02:51+00:00,[],2024-04-26 00:08:06+00:00,2024-04-04 06:20:25+00:00,https://github.com/frappe/erpnext/issues/40626,"[('bug', None), ('released', None)]","[{'comment_id': 2049114727, 'issue_id': 2203035778, 'author': 'frappe-pr-bot', 'body': ':tada: This issue has been resolved in version 15.20.0 :tada:\n\nThe release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.20.0)\n\nYour **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:', 'created_at': datetime.datetime(2024, 4, 11, 7, 41, 3, tzinfo=datetime.timezone.utc)}]","frappe-pr-bot on (2024-04-11 07:41:03 UTC): :tada: This issue has been resolved in version 15.20.0 :tada:

The release is available on [GitHub release](https://github.com/frappe/erpnext/releases/tag/v15.20.0)

Your **[semantic-release](https://github.com/semantic-release/semantic-release)** bot :package::rocket:

"
2202339895,issue,open,,"How to Transfer User Permissions, Roles, and Document Access from existing User to a New User?","I’m encountering a challenge in ERPNext regarding transferring user permissions, roles, and document access from an employee who has left the organization to a new user. When an employee exits the organization, it’s crucial to smoothly transition their responsibilities to a replacement. This involves duplicating their role, permissions, and document access to maintain workflow continuity, including conditions such as “doc.user == frappe.session.user” at the document level.",mansi31199,2024-03-22 12:02:31+00:00,[],2024-03-27 04:16:12+00:00,,https://github.com/frappe/erpnext/issues/40623,"[('feature-request', None)]","[{'comment_id': 2015280216, 'issue_id': 2202339895, 'author': 'ankush', 'body': 'Roles - make role profiles', 'created_at': datetime.datetime(2024, 3, 22, 14, 55, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2016424074, 'issue_id': 2202339895, 'author': 'thida-bcn', 'body': 'duplicate user and change user information\r\nthen inactive previous user', 'created_at': datetime.datetime(2024, 3, 23, 9, 25, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2016683411, 'issue_id': 2202339895, 'author': 'mansi31199', 'body': '> Roles - make role profiles\r\n\r\n@ankush  \r\nThere is a hierarchical structure in place as follows:\r\n- Group Head\r\n- Group Head PA\r\n- Team Leader\r\n- Manager\r\n- Deputy Manager\r\n\r\nIf a Group Head is absent, their documents can be accessed and approved by their PA, or the Group Head can designate another individual (i.e. Team Leader or Manager) for this authority. \r\nThis functionality should include a workflow condition where the doc.user == frappe.session.user.\r\n\r\nFurthermore, once the Group Head returns from leave, no other user should be able to access the same document.', 'created_at': datetime.datetime(2024, 3, 24, 3, 52, 17, tzinfo=datetime.timezone.utc)}]","ankush on (2024-03-22 14:55:36 UTC): Roles - make role profiles

thida-bcn on (2024-03-23 09:25:23 UTC): duplicate user and change user information
then inactive previous user

mansi31199 (Issue Creator) on (2024-03-24 03:52:17 UTC): @ankush  
There is a hierarchical structure in place as follows:
- Group Head
- Group Head PA
- Team Leader
- Manager
- Deputy Manager

If a Group Head is absent, their documents can be accessed and approved by their PA, or the Group Head can designate another individual (i.e. Team Leader or Manager) for this authority. 
This functionality should include a workflow condition where the doc.user == frappe.session.user.

Furthermore, once the Group Head returns from leave, no other user should be able to access the same document.

"
2201908413,issue,closed,completed,AttributeError: 'int' object has no attribute 'items',"### Information about bug

Getting below error on deletion of invoices, downloading reports..etc

### App Versions
```
{
	""XXXX"": ""0.0.1"",
	""erpnext"": ""14.65.5"",
	""frappe"": ""14.68.1"",
	""hrms"": ""14.24.0""
}
```
### Route
```
query-report/Warehouse wise Item Balance Age and Value - Custom
```
### Traceback
```
Traceback (most recent call last):
  File ""apps/frappe/frappe/app.py"", line 95, in application
    response = frappe.api.handle()
  File ""apps/frappe/frappe/api.py"", line 55, in handle
    return frappe.handler.handle()
  File ""apps/frappe/frappe/handler.py"", line 47, in handle
    data = execute_cmd(cmd)
  File ""apps/frappe/frappe/handler.py"", line 85, in execute_cmd
    return frappe.call(method, **frappe.form_dict)
  File ""apps/frappe/frappe/__init__.py"", line 1611, in call
    return fn(*args, **newargs)
  File ""apps/frappe/frappe/desk/query_report.py"", line 151, in background_enqueue_run
    return make_prepared_report(report_name, filters)
  File ""apps/frappe/frappe/core/doctype/prepared_report/prepared_report.py"", line 105, in make_prepared_report
    prepared_report = frappe.get_doc(
  File ""apps/frappe/frappe/model/document.py"", line 277, in insert
    self.run_method(""after_insert"")
  File ""apps/frappe/frappe/model/document.py"", line 926, in run_method
    out = Document.hook(fn)(self, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1278, in composer
    return composed(self, method, *args, **kwargs)
  File ""apps/frappe/frappe/model/document.py"", line 1260, in runner
    add_to_return_value(self, fn(self, *args, **kwargs))
  File ""apps/frappe/frappe/model/document.py"", line 923, in fn
    return method_object(*args, **kwargs)
  File ""apps/frappe/frappe/core/doctype/prepared_report/prepared_report.py"", line 41, in after_insert
    enqueue(
  File ""apps/frappe/frappe/utils/background_jobs.py"", line 104, in enqueue
    q = get_queue(queue, is_async=is_async)
  File ""apps/frappe/frappe/utils/background_jobs.py"", line 345, in get_queue
    validate_queue(qtype)
  File ""apps/frappe/frappe/utils/background_jobs.py"", line 351, in validate_queue
    default_queue_list = list(get_queues_timeout())
  File ""apps/frappe/frappe/utils/background_jobs.py"", line 52, in get_queues_timeout
    worker: config.get(""timeout"", default_timeout) for worker, config in custom_workers_config.items()
AttributeError: 'int' object has no attribute 'items'

```
### Request Data
```
{
	""type"": ""POST"",
	""args"": {
		""report_name"": ""Warehouse wise Item Balance Age and Value - Custom"",
		""filters"": ""{\""from_date\"":\""2024-02-22\"",\""to_date\"":\""2024-03-22\"",\""warehouse\"":\""AJMAN - DITD\"",\""filter_total_zero_qty\"":1}""
	},
	""headers"": {},
	""error_handlers"": {},
	""url"": ""/api/method/frappe.desk.query_report.background_enqueue_run""
}
```
### Response Data
```
{
	""exception"": ""AttributeError: 'int' object has no attribute 'items'""
}
```

### Module

stock, buying, selling

### Version

ERPNext: v14.65.5 (HEAD)

Frappe Framework: v14.68.1 (HEAD)

### Installation method

FrappeCloud

### Relevant log output / Stack trace / Full Error Message.

_No response_",Craftint,2024-03-22 07:56:23+00:00,[],2024-04-06 00:09:43+00:00,2024-03-22 08:59:43+00:00,https://github.com/frappe/erpnext/issues/40614,"[('bug', None)]","[{'comment_id': 2014644700, 'issue_id': 2201908413, 'author': 'Craftint', 'body': 'Issue was because of ""workers"" : 0 configuration in common_site_config.json in frappe cloud bench.\r\nWe have removed the same and the issue is resolved.', 'created_at': datetime.datetime(2024, 3, 22, 8, 59, 4, tzinfo=datetime.timezone.utc)}]","Craftint (Issue Creator) on (2024-03-22 08:59:04 UTC): Issue was because of ""workers"" : 0 configuration in common_site_config.json in frappe cloud bench.
We have removed the same and the issue is resolved.

"
2201784336,issue,closed,completed,Need a change in Subcontracting Cycle,"ERPNext has a subcontracting process where user transfer material to subcontractor warehouse through Stock Entry and accept the FG against the SO on separate docype. In this process, GST calculation is missing, e-waybill generation is missing, ITC-04 is missing. These points force users to work manually for everything and there is nom use of subcontracting cycle in ERPNext. As material is dispatched to supplier, it should show GST calculations i.e. GST Rate, CGST, SGST or IGST, there should be a provision to generate e-waybill as transaction fulfils e-waybill criteria. Also, when user wants to file ITC04, there is report or details available in the system as they are not captured anywhere.

Kindly consider the feature on priority.",smbcatalyst,2024-03-22 06:21:22+00:00,[],2024-11-20 00:10:35+00:00,2024-11-05 09:02:57+00:00,https://github.com/frappe/erpnext/issues/40611,"[('feature-request', None)]",[],
2201754791,issue,open,,Need a Rep[ort on SO V/s Work Order and Balance Work Order Qty,"Hello Frappe Team,

We need a Report where against the Sales Order Qty, How Much the Work Order Qty is done and it's pending.

Columns Required

Sales Order No Item Code Sales Order Qty Work Order Qty Produced Work Order Pending Qty (Against the SO)
",JitendraSAW,2024-03-22 05:53:58+00:00,[],2024-03-22 05:53:58+00:00,,https://github.com/frappe/erpnext/issues/40610,"[('feature-request', None)]",[],
