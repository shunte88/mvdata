id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2835616307,issue,open,,"[17.0] account: Posted invoice values are updated when the tax is modified after confirmation, leading to inconsistencies in the amount_total field","### Odoo Version

- [ ] 16.0
- [x] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Current behavior: 
When an invoice is confirmed and later the tax applied to the invoice is modified for any reason, the invoice values are updated automatically. This leads to inconsistencies in the amount_total field and the tax_totals['amount_total']. These discrepancies cause issues when generating a credit note, as the amounts are partially reconciled due to this inconsistency.

Expected behavior: 
It should not be allowed to modify the tax on invoices that have already been confirmed or posted. If a change is necessary, it should only be allowed in draft status, or the invoice values, including amount_total and tax_totals['amount_total'], should remain unchanged after posting. This will prevent partial reconciliation issues when generating credit notes.

Video/Screenshot link (optional):
https://drive.google.com/file/d/1zUNMhMADvBnprUns5N55G_F4gqI1I0br/view

Steps to reproduce:
1.Create and confirm an invoice with a tax applied.
2.After confirming the invoice, go to the tax settings and modify the tax applied to the invoice.
3.Observe that the values in the invoice, particularly the amount_total field and tax_totals['amount_total'], are updated automatically.
4.Create a credit note for the invoice.
5.Notice that the amounts in the credit note are partially reconciled due to the inconsistencies in the amount_total and tax_totals['amount_total'] fields.


### Log Output

```shell

```

### Support Ticket

_No response_",rov-adhoc,2025-02-06 13:58:58+00:00,[],2025-02-06 13:58:58+00:00,,https://github.com/odoo/odoo/issues/196816,[],[],
2834062918,issue,open,,[17.0] account_peppol: check selection value according to user language,"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Issue: 
- Have account_peppol installed
- Set a different langage than english as your user language
- Open invoices, bills or contacts views
- See your cache invalidated, every time

Analysis:
- It seems that fields_get method of res.partner and account.move models does not take user language into account before clearing cache as selection values are in the user language (which is not necessarily english)

![Image](https://github.com/user-attachments/assets/c13e8ba5-6e58-4621-bb21-b98fc66ed476)

![Image](https://github.com/user-attachments/assets/f572ea49-0db8-40ed-a9d5-b9c1fd013bc4)



### Log Output

```shell

```

### Support Ticket

_No response_",dwa-idealis,2025-02-05 22:10:27+00:00,[],2025-02-05 22:10:27+00:00,,https://github.com/odoo/odoo/issues/196714,[],[],
2833112193,issue,open,,[17.0] Expenses: Cannot create new Expense Categories,"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

It occurs after I upgraded from 17.0-20241118 to 17.0-20250131.

- Go to Expenses
- Go to Configuration -> Expense Cataglories
- Click ""NEW""
- Input Product Name
   (Note: I couldn't see the ""unit of measure"" input field)
- Save
- It shows the error message below.



### Log Output

```shell
Validation Error

The operation cannot be completed:
- Create/update: a mandatory field is not set.
- Delete: another model requires the record being deleted. If possible, archive it instead.

Model: Product (product.template)
Field: Purchase UoM (uom_po_id)
```

### Support Ticket

_No response_",dannyfai,2025-02-05 14:30:58+00:00,[],2025-02-05 14:35:20+00:00,,https://github.com/odoo/odoo/issues/196644,[],[],
2832687158,issue,open,,[18.0] module: hr.employee: working schedule per day is still used for time off with flexible hours ticked,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Current behaviour:
I noticed that even when having ticked on ""flexible working hours"" in the employee working schedules, pauses get cut into attendance tracking (we sign out and back in for pauses). 

To fix this, I unticked the flexible working hours, deleted all the preset slots, and ticked flexible working hours again. Attendance tracking worked fine now, but time for accepted time off periods got set to zero. When trying to issue a new time off request, the days remained at 0, and when approving, there was a validation error that the employee was not supposed to work on that day.

I confirmed this on runbot.

My fix was to untick flexible hours, re-apply the monday-friday slots (2 a day, from 00:00 to 12:00 and 12:00 to 24:00), retick and reset the time off requests. [Actually I drew up a new schedule without pauses with the average hours per day because 24/7 had some other side effects like calendar entries adding a day - fingers crossed that this covers all bases]

Expected behavior:
ticking flexible working hours should remove any restrictions / time periods (since they also vanish from the user interface). Maybe assign a temp working schedule of 24x7?

### Log Output

```shell

```

### Support Ticket

_No response_",BernhardHH,2025-02-05 11:36:53+00:00,[],2025-02-07 12:52:32+00:00,,https://github.com/odoo/odoo/issues/196606,[],[],
2832406047,issue,open,,[18.0] eccommerce: fetch varient,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

When I want to fetch products varient on home page (website), Odoo are load all varient and then remove similar product variants and then show anything remaind. But, we want to show products (only 1 variant of product) in number 16 (for example). On current way, it isn't show 16, because it fetch 16 number of variants then remove similars in product.

### Log Output

```shell
There is no log. The bug is on algorithm.
```

### Support Ticket

_No response_",nasermars,2025-02-05 09:35:23+00:00,[],2025-02-05 09:35:23+00:00,,https://github.com/odoo/odoo/issues/196579,[],[],
2832375675,issue,open,,[18.0] hr_maintenance: Stock module is not in the dependencies but is required to create new equipment,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

1. Install hr_maintenance
2. Go to Maintenance -> Equipment
3. Try to create a new equipment

### Log Output

```shell
RPC_ERROR

Odoo Server Error

Occured on localhost:8069 on model maintenance.equipment and id 10 on 2025-02-05 09:18:10 GMT

Traceback (most recent call last):
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\http.py"", line 1954, in _transactioning
    return service_model.retrying(func, env=self.env)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\service\model.py"", line 137, in retrying
    result = func()
             ^^^^^^
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\http.py"", line 1921, in _serve_ir_http
    response = self.dispatcher.dispatch(rule.endpoint, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\http.py"", line 2168, in dispatch
    result = self.request.registry['ir.http']._dispatch(endpoint)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\addons\base\models\ir_http.py"", line 330, in _dispatch
    result = endpoint(**request.params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\http.py"", line 728, in route_wrapper
    result = endpoint(self, *args, **params_ok)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""c:\users\-\dev\odoo18\odoo\addons\web\controllers\dataset.py"", line 35, in call_kw
    return call_kw(request.env[model], method, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\api.py"", line 517, in call_kw
    result = getattr(recs, name)(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""c:\users\-\dev\odoo18\odoo\addons\web\models\models.py"", line 1014, in onchange
    snapshot1 = RecordSnapshot(record, fields_spec)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""c:\users\-\dev\odoo18\odoo\addons\web\models\models.py"", line 1101, in __init__
    self.fetch(name)
  File ""c:\users\-\dev\odoo18\odoo\addons\web\models\models.py"", line 1116, in fetch
    self[field_name] = self.record[field_name]
                       ~~~~~~~~~~~^^^^^^^^^^^^
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\models.py"", line 7000, in __getitem__
    return self._fields[key].__get__(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\fields.py"", line 1287, in __get__
    self.compute_value(recs)
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\fields.py"", line 1469, in compute_value
    records._compute_field_value(self)
  File ""c:\users\-\dev\odoo18\odoo\addons\mail\models\mail_thread.py"", line 427, in _compute_field_value
    return super()._compute_field_value(field)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\models.py"", line 5243, in _compute_field_value
    fields.determine(field.compute, self)
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\fields.py"", line 109, in determine
    return needle(*args)
           ^^^^^^^^^^^^^
  File ""c:\users\-\dev\odoo18\odoo\addons\maintenance\models\maintenance.py"", line 163, in _compute_match_serial
    matched_serial_data = self.env['stock.lot']._read_group(
                          ~~~~~~~~^^^^^^^^^^^^^
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\api.py"", line 596, in __getitem__
    return self.registry[model_name](self, (), ())
           ~~~~~~~~~~~~~^^^^^^^^^^^^
  File ""C:\Users\-\dev\Odoo18\odoo\odoo\modules\registry.py"", line 244, in __getitem__
    return self.models[model_name]
           ~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'stock.lot'

The above server error caused the following client error:
OwlError: An error occured in the owl lifecycle (see this Error's ""cause"" property)
    Error: An error occured in the owl lifecycle (see this Error's ""cause"" property)
        at handleError (http://localhost:8069/web/assets/548e893/web.assets_web.min.js:947:101)
        at App.handleError (http://localhost:8069/web/assets/548e893/web.assets_web.min.js:1579:29)
        at ComponentNode.initiateRender (http://localhost:8069/web/assets/548e893/web.assets_web.min.js:1037:19)

Caused by: RPC_ERROR: Odoo Server Error
    RPC_ERROR
        at makeErrorFromResponse (http://localhost:8069/web/assets/548e893/web.assets_web.min.js:3056:163)
        at XMLHttpRequest.<anonymous> (http://localhost:8069/web/assets/548e893/web.assets_web.min.js:3061:13)
```

### Support Ticket

_No response_",montanariandrea,2025-02-05 09:22:28+00:00,[],2025-02-05 09:22:58+00:00,,https://github.com/odoo/odoo/issues/196577,[],[],
2830374259,issue,open,,[18.0] Purchase: Cost is incorrect for BOM product with AVCO and Automated,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

## **1. Create a Product Category**
1. Navigate to **Inventory → Configuration → Product Categories**.
2. Click **Create** to define a new product category.
3. Set the following values:
   - **Category Name**: `ACA`
   - **Costing Method**: **AVCO (Average Costing)**
   - **Inventory Valuation**: **Automated**
4. Click **Save**.

---

## **2. Create Products**
### **2.1 Create Product: Table**
1. Navigate to **Inventory → Products → Products**.
2. Click **Create** and set:
   - **Product Name**: `Table`
   - **Product Type**: `Goods`
   - **Product Category**: `ACA`
   - **Cost**: `€130`
3. Click **Save**.

### **2.2 Create Product: Glass Table Top**
1. Click **Create** again and set:
   - **Product Name**: `Glass Table Top`
   - **Product Type**: `Goods`
   - **Product Category**: `ACA`
   - **Cost**: `€50`
2. Click **Save**.

### **2.3 Create Product: Wood Table Legs**
1. Click **Create** again and set:
   - **Product Name**: `Wood Table Legs`
   - **Product Type**: `Goods`
   - **Product Category**: `ACA`
   - **Cost**: `€20`
2. Click **Save**.

---

## **3. Create a New Bill of Materials (BoM)**
1. Navigate to **Manufacturing → Products → Bill of Materials**.
2. Click **Create** and set:
   - **Product**: `Table`
   - **BoM Type**: `Kit`
   - **Components**:
     - **Glass Table Top** Number: 1
     - **Wood Table Legs** Number: 4
3. Click **Save**.

---

## **4. Create a New Purchase Order**
1. Navigate to **Purchase → Purchase Orders**.
2. Click **Create** and add:
   - **Vendor**: Select a vendor.
   - **Product**: `Table`
   - **Quantity**: `10`
   - **Unit Price**: `€130`
3. Click **Confirm Order**.

---

## **5. Receive Products**
1. Navigate to **Inventory → Receipts**.
2. Open the related incoming shipment.
3. Click **Receive Products**.
4. Set the received quantity to **10**.
5. Click **Validate**.

---

## **6. Verify Product Cost**

<img width=""857"" alt=""Image"" src=""https://github.com/user-attachments/assets/fb27b7e7-0573-45b5-8d81-8c1e3f061938"" />

<img width=""857"" alt=""Image"" src=""https://github.com/user-attachments/assets/29bf5ccc-8e3f-42b5-88db-e91af8a8e845"" />

<img width=""857"" alt=""Image"" src=""https://github.com/user-attachments/assets/50abcf89-6c2b-4f00-ba6a-e9828b10321c"" />

<img width=""857"" alt=""Image"" src=""https://github.com/user-attachments/assets/029a786c-d018-4a9c-9c13-8dae1b6ba2fb"" />

<img width=""927"" alt=""Image"" src=""https://github.com/user-attachments/assets/75b356bb-6f0a-405f-9d9e-e1756229e38d"" />

### Log Output

```shell

```

### Support Ticket

_No response_",Linsen-Mao,2025-02-04 14:05:40+00:00,[],2025-02-04 14:05:40+00:00,,https://github.com/odoo/odoo/issues/196444,[],[],
2829641811,issue,open,,[18.0] Accounting: Reversed Invoice amount is incorrect when rounding method changed,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Step to reproduce:

1. Set Rounding Method to ""Round per Line""
	1.1 **Cash Rounding** feature is enabled
	1.2 **Rounding Method: Round per Line**
2. Enable Discounts on Sales Orders
3. Create a 15% Sales Tax
	3.1 **Tax Name**: 15% Sales Tax
	3.2 **Tax Computation**: Percentage
	3.3 Amount: 15%
4. Create the Sales Order
	4.1 Add the First Product Line:

	Set Quantity to 10.

	Set the Unit Price to 30.75.

	In the Discount field, enter 5 to represent a 5% discount.

	In the Taxes field, select 15% Sales Tax.

	4.2 Add the Second Product Line:

	Click Add a product to insert another line.

	Select the Product.

	Set Quantity to 1.

	Set the Unit Price to 70.00.

	Enter 5 in the Discount field for a 5% discount.

	In the Taxes field, select 15% Sales Tax.

	4.3 Check

	Untaxed Amount 358.63

	Taxes 53.80

	Total 412.43

5. Create a invoice from the sales order
	5.1 Check

	Untaxed Amount 358.63

	Taxes 53.80

	Total 412.43
6. Change the Rounding Method to ""Round Globally"" and save
 6.1 	check: Untaxed Amount 358.63

	Taxes 53.80

	Total 412.43

7. reverse the invoice in step 5
8.  The amount of the reverse invoice is incorrect, and the invoice itself has 0.01 due.

<img width=""900"" alt=""Image"" src=""https://github.com/user-attachments/assets/c26f49e1-92c5-4832-bcbb-8789d81fd0e0"" />

<img width=""804"" alt=""Image"" src=""https://github.com/user-attachments/assets/4b156e5a-84fb-4e67-9ac3-823850c4634b"" />

### Log Output

```shell

```

### Support Ticket

_No response_",Linsen-Mao,2025-02-04 09:48:35+00:00,[],2025-02-06 15:31:16+00:00,,https://github.com/odoo/odoo/issues/196382,[],"[{'comment_id': 2640152710, 'issue_id': 2829641811, 'author': 'intero-chz', 'body': 'How often do you change the rounding method so that this becomes a problem in accounting? I can understand if you have to do this once because Odoo was originally configured incorrectly. Of course also when laws change. But how often will that happen?', 'created_at': datetime.datetime(2025, 2, 6, 15, 31, 14, tzinfo=datetime.timezone.utc)}]","intero-chz on (2025-02-06 15:31:14 UTC): How often do you change the rounding method so that this becomes a problem in accounting? I can understand if you have to do this once because Odoo was originally configured incorrectly. Of course also when laws change. But how often will that happen?

"
2827758780,issue,open,,[15.0] module: product.product | Issue Importing product.product in Odoo 15 | Savepoint Error,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [ ] 18.0
- [x] Other (specify)

### Steps to Reproduce

Hello everyone,

I'm facing an issue while importing products via an Excel file in Odoo 15. The problem occurs when I import a product on Sales > Product > Product variants. product.product model, and the error logs show messages related to missing savepoints and transaction rollbacks. Here is the relevant error output:

What I’ve tried so far:

- Checked my custom code: The only modifications to product.product involve updating WooCommerce prices and reassigning duplicate products.
- Tested importing a single product manually: Creating a product via the UI works fine.
- Restarted PostgreSQL and Odoo: The issue persists.
- Checked database locks: No active transactions blocking imports.

### Log Output

```shell
odoo.addons.base_import.models.base_import: importing 1 rows...

2025-02-03 14:22:19,864 26276 ERROR import_error odoo.sql_db: bad query: RELEASE SAVEPOINT ""46ec9370e23a11efa851612a4112352d416""

ERROR: no existe el �savepoint� �46ed155125d41b8112d416�

2025-02-03 14:22:19,865 26276 ERROR import_error odoo.sql_db: bad query: SELECT value FROM ir_translation

                       WHERE lang='es_ES' AND type in ('code') AND src='Unknown database error: ''%s''' AND md5(src)=md5('Unknown database error: ''%s''')

ERROR: transacci�n abortada, las �rdenes ser�n ignoradas hasta el fin de bloque de transacci�n



2025-02-03 14:22:19,865 26276 ERROR import_error odoo.sql_db: bad query: ROLLBACK TO SAVEPOINT model_load

ERROR: no existe el �savepoint� �model_load�



2025-02-03 14:22:19,865 26276 ERROR import_error odoo.http: Exception during JSON request handling.

Traceback (most recent call last):

  File ""C:\Program Files\Odoo 15\server\odoo\addons\base\models\ir_http.py"", line 242, in _dispatch

    result = request.dispatch()

  File ""C:\Program Files\Odoo 15\server\odoo\"", line 702, in dispatchhttp.py

    result = self._call_function(**self.params)

  File ""C:\Program Files\Odoo 15\server\odoo\http.py"", line 368, in _call_function

    return checked_call(self.db, *args, **kwargs)

  File ""C:\Program Files\Odoo 15\server\odoo\service\model.py"", line 94, in wrapper

    return f(dbname, *args, **kwargs)

  File ""C:\Program Files\Odoo 15\server\odoo\http.py"", line 357, in checked_call

    result = self.endpoint(*a, **kw)

  File ""C:\Program Files\Odoo 15\server\odoo\http.py"", line 925, in __call__

    return self.method(*args, **kw)

  File ""C:\Program Files\Odoo 15\server\odoo\http.py"", line 546, in response_wrap

    response = f(*args, **kw)

  File ""C:\Program Files\Odoo 15\server\odoo\addons\web\controllers\main.py"", line 1324, in call_kw

    return self._call_kw(model, method, args, kwargs)

  File ""C:\Program Files\Odoo 15\server\odoo\addons\web\controllers\main.py"", line 1316, in _call_kw

    return call_kw(request.env[model], method, args, kwargs)

  File ""C:\Program Files\Odoo 15\server\odoo\api.py"", line 471, in call_kw

    result = _call_kw_multi(method, model, args, kwargs)

  File ""C:\Program Files\Odoo 15\server\odoo\api.py"", line 456, in _call_kw_multi

    result = method(recs, *args, **kwargs)

  File ""C:\Program Files\Odoo 15\server\odoo\addons\base_import\models\base_import.py"", line 1387, in execute_import

    import_result = model.load(import_fields, merged_data)

  File ""C:\Program Files\Odoo 15\server\odoo\"", line 1218, in loadmodels.py

    cr.execute('ROLLBACK TO SAVEPOINT model_load')

  File ""<decorator-gen-5>"", line 2, in execute

  File ""C:\Program Files\Odoo 15\server\odoo\sql_db.py"", line 90, in check

    return f(self, *args, **kwargs)

  File ""C:\Program Files\Odoo 15\server\odoo\sql_db.py"", line 311, in execute

    res = self._obj.execute(query, params)

Exception



The above exception was the direct cause of the following exception:



Traceback (most recent call last):

  File ""C:\Program Files\Odoo 15\server\odoo\"", line 658, in _handle_exception

    return super(JsonRequest, self)._handle_exception(exception)

  File ""C:\Program Files\Odoo 15\server.py"", line 301, in _handle_exception

    raise exception.with_traceback(None) from new_cause

psycopg2.errors.InvalidSavepointSpecification: no existe el �savepoint� �model_load�
```

### Support Ticket

_No response_",maaaarin,2025-02-03 14:58:17+00:00,[],2025-02-03 14:58:17+00:00,,https://github.com/odoo/odoo/issues/196247,[],[],
2827392493,issue,open,,[16.0] website_sale: _get_search_order function to render products,"### Odoo Version

- [x] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

I want to sort my e-commerce products by brands (a product attribute).

I want that through a predefined list of brands, the query that returns the products will sort first by the products that contain brands that are in this list.

To render these products I inherit the “shop” function from the website_sale controller which uses the _shop_lookup_products function to return the products, this function internally calls the _get_search_order function to sort them:

![Image](https://github.com/user-attachments/assets/20428f28-7f8d-49fa-9193-b224fd45bc5e)",alvaro2203,2025-02-03 12:36:45+00:00,[],2025-02-03 12:36:58+00:00,,https://github.com/odoo/odoo/issues/196184,[],[],
2827319701,issue,open,,[18.0] Salesinvoices: specify rounding method per invoice,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Current behaviour 
- create an invoice through the external api (json-rpc)
- specify the rounding method using the tax_calculation_rounding_method
- problem: the global setting is always used, not the one specified on invoicelevel

Expected behaviour
- override the global setting and take the invoices tax_calculation_rounding_method value into account instead

When sales invoices are generated by different sources (each having their own rounding methods) the global tax_calculation_rounding_method is not a solution for such situation. 
When uploading such invoices through json-rpc, one can specify the tax_calculation_rounding_method but it's value is not used, instead the global setting is always used. I guess the tax_calculation_rounding_method field on invoicelevel is read-only and specifies for an existing invoice what method was used at creation.


### Log Output

```shell

```

### Support Ticket

_No response_",PascalDeclercq1964,2025-02-03 12:04:24+00:00,[],2025-02-03 12:04:24+00:00,,https://github.com/odoo/odoo/issues/196178,[],[],
2827170385,issue,open,,[18.0] module: description Not able to open pos session,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- Go to POS application

### Log Output

```shell
point_of_sale.assets_prod.min.js:6073 Error: decimals must be provided
    at floatCompare (point_of_sale.assets_prod.min.js:8335:98)
    at lt (point_of_sale.assets_prod.min.js:8341:55)
    at point_of_sale.assets…rod.min.js:8875:217
    at Proxy.every (<anonymous>)
    at get taxTotals (point_of_sale.assets…rod.min.js:8875:206)
    at Reflect.get (<anonymous>)
    at Object.get (point_of_sale.assets_prod.min.js:1042:71)
    at Proxy.get_total_with_tax (point_of_sale.assets_prod.min.js:8945:34)
    at Proxy.getCustomerDisplayData (point_of_sale.assets…rod.min.js:9001:248)
    at Proxy.getCustomerDisplayData (point_of_sale.assets…od.min.js:16594:364)

2
point_of_sale.assets_prod.min.js:6073 OwlError: An error occured in the owl lifecycle (see this Error's ""cause"" property)
    Error: An error occured in the owl lifecycle (see this Error's ""cause"" property)
        at handleError (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:975:101)
        at App.handleError (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:1626:29)
        at Fiber._render (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:1000:19)
        at Fiber.render (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:998:6)
        at ComponentNode.initiateRender (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:1068:47)

Caused by: Error: decimals must be provided
    at floatCompare (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:8335:98)
    at lt (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:8341:55)
    at https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:8875:217
    at Proxy.every (<anonymous>)
    at get taxTotals (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:8875:206)
    at Reflect.get (<anonymous>)
    at Object.get (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:1042:71)
    at OrderSummary.template (eval at compile (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:1578:421), <anonymous>:110:119)
    at Fiber._render (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:999:96)
    at Fiber.render (https://unitedsections-staging-17299005.dev.odoo.com/web/assets/0d092eb/point_of_sale.assets_prod.min.js:998:6)
```

### Support Ticket

_No response_",Bhupendra-tnc,2025-02-03 10:57:10+00:00,[],2025-02-03 10:57:10+00:00,,https://github.com/odoo/odoo/issues/196157,[],[],
2826697695,issue,open,,"[18.0] module: description: Missing Record  Record does not exist or has been deleted. (Record: stock.move(325,), User: 1)","### Odoo Version

- [ ] 16.0
- [x] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

1、If the finished BOM includes component 01 and part 01, and the BOM for component 01 includes part 01, an error will be reported during sales order confirmation

### Log Output

```shell

```

### Support Ticket

_No response_",Bonainifo,2025-02-03 08:06:12+00:00,[],2025-02-03 08:06:12+00:00,,https://github.com/odoo/odoo/issues/196129,[],[],
2823371277,issue,open,,"[PERF][16.0] account: wkhtmltopdf called twice on ""Send & print"" button","### Odoo Version

- [x] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- Tested on runbot ->
- Go to Accounting/Customers/invoices
- Create basic invoice with one line
- Click on Send and print

![Image](https://github.com/user-attachments/assets/6cee4eb5-5eb6-4b6b-b8d4-0e0f206b7636)

- Odoo takes more than 5 seconds to get the result.
- With the profiler we can see that wkhtmltopdf is called twice

[Speedscope.speedscope (5).json](https://github.com/user-attachments/files/18618401/Speedscope.speedscope.5.json)

### Log Output

```shell

```

### Support Ticket

opw-4535934",adrienpeiffer,2025-01-31 12:45:40+00:00,[],2025-01-31 16:08:51+00:00,,https://github.com/odoo/odoo/issues/195992,[],"[{'comment_id': 2627706438, 'issue_id': 2823371277, 'author': 'adrienpeiffer', 'body': '@pivi-odoo', 'created_at': datetime.datetime(2025, 1, 31, 16, 8, 50, tzinfo=datetime.timezone.utc)}]","adrienpeiffer (Issue Creator) on (2025-01-31 16:08:50 UTC): @pivi-odoo

"
2823141255,issue,open,,[17.0] sale: Error Detected in Odoo when Consolidating Billing,"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

When selecting multiple orders for invoicing, we encountered a case where, for example, selecting four orders—two with a payment mode and two without—causes an error when attempting to create a consolidated invoice. The following error appears:  

**TypeError: '<' not supported between instances of 'NoneType' and 'int'**  

This is the code that needs to be corrected:  

```python
invoice_grouping_keys = self._get_invoice_grouping_keys()
invoice_vals_list = sorted(
    invoice_vals_list,
    key=lambda x: [
        x.get(grouping_key) for grouping_key in invoice_grouping_keys
    ]
)
```

If `invoice_grouping_keys` contains keys that are not present in the records of `invoice_vals_list`, the error occurs.  

Instead of raising a Traceback, a **ValidationError** or a similar error should be triggered.  

Thank you.

### Log Output

```shell
RPC_ERROR
Odoo Server Error
Traceback (most recent call last):
  File ""/opt/odoo/custom/src/odoo/odoo/http.py"", line 1783, in _serve_db
    return service_model.retrying(self._serve_ir_http, self.env)
  File ""/opt/odoo/custom/src/odoo/odoo/service/model.py"", line 133, in retrying
    result = func()
  File ""/opt/odoo/custom/src/odoo/odoo/http.py"", line 1810, in _serve_ir_http
    response = self.dispatcher.dispatch(rule.endpoint, args)
  File ""/opt/odoo/custom/src/odoo/odoo/http.py"", line 2014, in dispatch
    result = self.request.registry['ir.http']._dispatch(endpoint)
  File ""/opt/odoo/auto/addons/website/models/ir_http.py"", line 235, in _dispatch
    response = super()._dispatch(endpoint)
  File ""/opt/odoo/custom/src/odoo/odoo/addons/base/models/ir_http.py"", line 221, in _dispatch
    result = endpoint(**request.params)
  File ""/opt/odoo/custom/src/odoo/odoo/http.py"", line 757, in route_wrapper
    result = endpoint(self, *args, **params_ok)
  File ""/opt/odoo/auto/addons/web/controllers/dataset.py"", line 28, in call_button
    action = self._call_kw(model, method, args, kwargs)
  File ""/opt/odoo/auto/addons/web/controllers/dataset.py"", line 20, in _call_kw
    return call_kw(request.env[model], method, args, kwargs)
  File ""/opt/odoo/custom/src/odoo/odoo/api.py"", line 468, in call_kw
    result = _call_kw_multi(method, model, args, kwargs)
  File ""/opt/odoo/custom/src/odoo/odoo/api.py"", line 453, in _call_kw_multi
    result = method(recs, *args, **kwargs)
  File ""/opt/odoo/auto/addons/sale/wizard/sale_make_invoice_advance.py"", line 180, in create_invoices
    invoices = self._create_invoices(self.sale_order_ids)
  File ""/opt/odoo/auto/addons/sale_timesheet_enterprise/wizard/sale_make_invoice_advance.py"", line 42, in _create_invoices
    return super()._create_invoices(sale_orders)
  File ""/opt/odoo/auto/addons/sale_timesheet/wizard/sale_make_invoice_advance.py"", line 51, in _create_invoices
    return super()._create_invoices(sale_orders)
  File ""/opt/odoo/auto/addons/sale/wizard/sale_make_invoice_advance.py"", line 198, in _create_invoices
    return sale_orders._create_invoices(final=self.deduct_down_payments, grouped=not self.consolidated_billing)
  File ""/opt/odoo/auto/addons/sale_timesheet/models/sale_order.py"", line 155, in _create_invoices
    moves = super()._create_invoices(grouped=grouped, final=final, date=date)
  File ""/opt/odoo/auto/addons/sale/models/sale_order.py"", line 1332, in _create_invoices
    invoice_vals_list = sorted(
TypeError: '<' not supported between instances of 'NoneType' and 'int'
```

### Support Ticket

_No response_",polqubiq,2025-01-31 11:27:53+00:00,[],2025-01-31 11:34:34+00:00,,https://github.com/odoo/odoo/issues/195978,[],[],
2822784714,issue,open,,[18.0] pos_hr: Error on select employee if there is no other employee than the user,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- If the user is the only employee
- PoS configuration has Log in with Employees set
- Start pos session
- Click on the user (select cashier)

### Possible cause

In [here](https://github.com/odoo/odoo/blob/d83f5c0b3075e4e7516602ba24b73450d026a63f/addons/pos_hr/static/src/app/select_cashier_mixin.js#L95) `this` object doesn't have a dialog set.

Either use the global constant defined in the mixin or set it in the correct component.

This is working fine from the login screen in case there is really no employee (not even the user).

### Runbot video

https://github.com/user-attachments/assets/dea01ce9-8af5-47ad-9c71-5643c4647bea

### Log Output

```shell
TypeError: can't access property ""add"", dialog is undefined
    ask/<@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:88281:9 (/point_of_sale/static/src/app/store/make_awaitable_dialog.js:40)
    ask@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:88280:12 (/point_of_sale/static/src/app/store/make_awaitable_dialog.js:39)
    selectCashier@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:153153:19 (/pos_hr/static/src/app/select_cashier_mixin.js:95)
    selectCashier@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:153258:27 (/pos_hr/static/src/overrides/components/cashier_name/cashier_name.js:29)
    template/hdlr1<@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js line 13899 > Function:14:25 (/web/static/lib/owl/owl.js:5699)
    mainEventHandler@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:14233:25 (/web/static/lib/owl/owl.js:6033)
    listener@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:8557:20 (/web/static/lib/owl/owl.js:357)
    EventListener.handleEvent*setup@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:8561:18 (/web/static/lib/owl/owl.js:361)
    mount@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9271:37 (/web/static/lib/owl/owl.js:1071)
    mount@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:8636:27 (/web/static/lib/owl/owl.js:436)
    mount@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:10773:18 (/web/static/lib/owl/owl.js:2573)
    mount@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9284:35 (/web/static/lib/owl/owl.js:1084)
    mount@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:10773:18 (/web/static/lib/owl/owl.js:2573)
    mount@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9284:35 (/web/static/lib/owl/owl.js:1084)
    mount@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:8636:27 (/web/static/lib/owl/owl.js:436)
    mount$1@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9732:15 (/web/static/lib/owl/owl.js:1532)
    complete@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:10036:32 (/web/static/lib/owl/owl.js:1836)
    processFiber@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:13988:27 (/web/static/lib/owl/owl.js:5788)
    processTasks@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:13963:22 (/web/static/lib/owl/owl.js:5763)
    flush/this.frame<@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:13949:68 (/web/static/lib/owl/owl.js:5749)
    FrameRequestCallback*flush@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:13949:35 (/web/static/lib/owl/owl.js:5749)
    setCounter@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:10010:41 (/web/static/lib/owl/owl.js:1810)
    _render@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9934:22 (/web/static/lib/owl/owl.js:1734)
    render@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9921:18 (/web/static/lib/owl/owl.js:1721)
    initiateRender@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:10601:23 (/web/static/lib/owl/owl.js:2401)
    async*createComponent/<@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:14177:36 (/web/static/lib/owl/owl.js:5977)
    template@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js line 13899 > Function:51:12 (/web/static/lib/owl/owl.js:5699)
    _render@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9929:38 (/web/static/lib/owl/owl.js:1729)
    render@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9921:18 (/web/static/lib/owl/owl.js:1721)
    initiateRender@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:10601:23 (/web/static/lib/owl/owl.js:2401)
    async*createComponent/<@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:14177:36 (/web/static/lib/owl/owl.js:5977)
    slot1@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js line 13899 > Function:15:27 (/web/static/lib/owl/owl.js:5699)
    callSlot@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:11196:37 (/web/static/lib/owl/owl.js:2996)
    template@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js line 13899 > Function:8:12 (/web/static/lib/owl/owl.js:5699)
    _render@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9929:38 (/web/static/lib/owl/owl.js:1729)
    render@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9921:18 (/web/static/lib/owl/owl.js:1721)
    initiateRender@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:10601:23 (/web/static/lib/owl/owl.js:2401)
    async*createComponent/<@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:14177:36 (/web/static/lib/owl/owl.js:5977)
    template@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js line 13899 > Function:32:30 (/web/static/lib/owl/owl.js:5699)
    _render@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9929:38 (/web/static/lib/owl/owl.js:1729)
    render@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9921:18 (/web/static/lib/owl/owl.js:1721)
    initiateRender@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:10601:23 (/web/static/lib/owl/owl.js:2401)
    async*createComponent/<@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:14177:36 (/web/static/lib/owl/owl.js:5977)
    template@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js line 13899 > Function:22:21 (/web/static/lib/owl/owl.js:5699)
    _render@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9929:38 (/web/static/lib/owl/owl.js:1729)
    render@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:9921:18 (/web/static/lib/owl/owl.js:1721)
    initiateRender@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:10601:23 (/web/static/lib/owl/owl.js:2401)
    async*mountComponent@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:10585:18 (/web/static/lib/owl/owl.js:2385)
    mountNode@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:14102:18 (/web/static/lib/owl/owl.js:5902)
    mount@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:14067:39 (/web/static/lib/owl/owl.js:5867)
    mount@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:14041:25 (/web/static/lib/owl/owl.js:5841)
    mountComponent@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:42602:28 (/web/static/src/env.js:194)
    async*startPosApp@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:153730:23 (/point_of_sale/static/src/app/main.js:27)
    async*@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:153758:3 (/point_of_sale/static/src/app/main.js:55)
    startModule@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:207:34 (/web/static/src/module_loader.js:202)
    startModules@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:194:22 (/web/static/src/module_loader.js:189)
    addJob@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:45:18 (/web/static/src/module_loader.js:40)
    define@http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:70:22 (/web/static/src/module_loader.js:65)
    @http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:153701:6 (http://localhost:10182/web/assets/1/debug/point_of_sale.assets_prod.js:153701)
```

### Support Ticket

_No response_",razvanioan,2025-01-31 08:38:03+00:00,[],2025-01-31 08:41:06+00:00,,https://github.com/odoo/odoo/issues/195943,[],[],
2820749875,issue,closed,completed,"[16.0] web_editor, wysiwyg component, add more font size options for texts","### Odoo Version

- [x] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Current behaviour: 

![Image](https://github.com/user-attachments/assets/6f0aea0c-77bd-47e8-8d5c-47f3104b38c1)

Expected behaviour: I want to add more font size options in the curtomize tab of the hysiwyg component when editing mi web module.

I have tried the solution of the following repo: https://github.com/jwaes/jt_webeditor_extras.
But this didnt work for me.",alvaro2203,2025-01-30 12:47:59+00:00,[],2025-02-03 12:35:23+00:00,2025-02-03 12:35:23+00:00,https://github.com/odoo/odoo/issues/195772,[],[],
2820696180,issue,closed,completed,[16.0] web_editor - losing image quality due to extreme optimization in all areas of web editor,"### Odoo Version

- [x] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

try adding content with  image with a gradient background and you see it that it has completed distorted the images 
so much that it looks like a new graphic design.

![Image](https://github.com/user-attachments/assets/9eeff1bf-69a3-4edc-91fa-2cbbebdb9a47)

Request to please suggest how we can fix this

### Log Output

```shell

```

### Support Ticket

_No response_",ICTRV,2025-01-30 12:24:28+00:00,[],2025-01-30 14:06:29+00:00,2025-01-30 14:06:27+00:00,https://github.com/odoo/odoo/issues/195766,[],"[{'comment_id': 2624597598, 'issue_id': 2820696180, 'author': 'ByteMeAsap', 'body': ""@ICTRV , this happens because Odoo by default optimises/resizes all the images(of png,jpeg,bmp,tiff format) uploaded. You can disable this by adding a key 'base.image_autoresize_max_px' and set its values as '0' in System Parameters Under Settings/Technical.\n\nYou can also set the formats for which you want the optimisation/resizing to take place by adding the key 'base.image_autoresize_extensions' and setting the extensions of the formats as the value. For ex: 'png,jpeg', if you want only the png and jpeg format images to be optimized/resized.By default(if this parameter is not added) Odoo optimizes/resizes 'png','jpeg','bmp','tiff' format images"", 'created_at': datetime.datetime(2025, 1, 30, 14, 0, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2624611893, 'issue_id': 2820696180, 'author': 'ICTRV', 'body': 'fantastic input and thanks for the quick revert @ByteMeAsap\n\nI just tried it and it works really well\n\n![Image](https://github.com/user-attachments/assets/a8c3d07e-ca8b-4e9c-bda0-732391d28e24)\n\nI have managed to re-upload all the images on the slider. it really works . Thanks!', 'created_at': datetime.datetime(2025, 1, 30, 14, 6, 27, tzinfo=datetime.timezone.utc)}]","ByteMeAsap on (2025-01-30 14:00:43 UTC): @ICTRV , this happens because Odoo by default optimises/resizes all the images(of png,jpeg,bmp,tiff format) uploaded. You can disable this by adding a key 'base.image_autoresize_max_px' and set its values as '0' in System Parameters Under Settings/Technical.

You can also set the formats for which you want the optimisation/resizing to take place by adding the key 'base.image_autoresize_extensions' and setting the extensions of the formats as the value. For ex: 'png,jpeg', if you want only the png and jpeg format images to be optimized/resized.By default(if this parameter is not added) Odoo optimizes/resizes 'png','jpeg','bmp','tiff' format images

ICTRV (Issue Creator) on (2025-01-30 14:06:27 UTC): fantastic input and thanks for the quick revert @ByteMeAsap

I just tried it and it works really well

![Image](https://github.com/user-attachments/assets/a8c3d07e-ca8b-4e9c-bda0-732391d28e24)

I have managed to re-upload all the images on the slider. it really works . Thanks!

"
2818268658,issue,open,,[17.0+e] l10n_cl_edi_stock: Show client's commercial partner in report,"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- Create a stock move with a child contact with a name different from the parent contact.
- Print a ""Guía Despacho SII DTE CL (52)"".

Current behaviour: The child contact name is shown.
Expected behaviour: The parent contact name must be shown due to legal reasons; it's the exact same issue as https://github.com/odoo/odoo/pull/172793

### Log Output

```shell

```

### Support Ticket

4526948",jota2rz,2025-01-29 13:45:37+00:00,[],2025-01-29 13:45:37+00:00,,https://github.com/odoo/odoo/issues/195602,[],[],
2817795533,issue,open,,[18.0] external API RPC call: expected singleton error when reading all calendar.event records without the fields argument,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

When calling:
```
ids = [1, 2, 3]
try:
   records = models.execute_kw(db, uid, password, 'calendar.event', 'read', [ids])
except xmlrpc.client.Fault as e:
    raise ValueError(f""XML-RPC Fault: {e.faultString}"")
```
Even though the call is correct as per docs, the RPC will fail because it is unable to get the videocall_redirection field of calendar.event model for the list of ids provided.
I would expect to get all the fields for events with ids 1, 2, and 3.

This will work just fine:
```
ids = [1, 2, 3]
fields = {'fields': ['start', 'stop', 'duration']}
try:
   records = models.execute_kw(db, uid, password, 'calendar.event', 'read', [ids], fields)
except xmlrpc.client.Fault as e:
    raise ValueError(f""XML-RPC Fault: {e.faultString}"")
```

### Log Output

```shell
ValueError: XML-RPC Fault: Traceback (most recent call last):
  File ""/home/odoo/src/odoo/odoo/models.py"", line 6209, in ensure_one
    _id, = self._ids
    ^^^^
ValueError: too many values to unpack (expected 1)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/home/odoo/src/odoo/odoo/addons/base/controllers/rpc.py"", line 161, in xmlrpc_2
    response = self._xmlrpc(service)
               ^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/odoo/addons/base/controllers/rpc.py"", line 139, in _xmlrpc
    result = dispatch_rpc(service, method, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/odoo/http.py"", line 398, in dispatch_rpc
    return dispatch(method, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/odoo/service/model.py"", line 39, in dispatch
    res = execute_kw(db, uid, *params[3:])
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/odoo/service/model.py"", line 61, in execute_kw
    return execute(db, uid, obj, method, *args, **kw or {})
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/odoo/service/model.py"", line 68, in execute
    res = execute_cr(cr, uid, obj, method, *args, **kw)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/odoo/service/model.py"", line 52, in execute_cr
    result = retrying(partial(odoo.api.call_kw, recs, method, args, kw), env)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/odoo/service/model.py"", line 137, in retrying
    result = func()
             ^^^^^^
  File ""/home/odoo/src/odoo/odoo/api.py"", line 517, in call_kw
    result = getattr(recs, name)(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/odoo/models.py"", line 3801, in read
    return self._read_format(fnames=fields, load=load)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/odoo/models.py"", line 4032, in _read_format
    vals[name] = convert(record[name], record, use_display_name)
                         ~~~~~~^^^^^^
  File ""/home/odoo/src/odoo/odoo/models.py"", line 6999, in __getitem__
    return self._fields[key].__get__(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/odoo/fields.py"", line 1291, in __get__
    self.compute_value(recs)
  File ""/home/odoo/src/odoo/odoo/fields.py"", line 1473, in compute_value
    records._compute_field_value(self)
  File ""/home/odoo/src/odoo/addons/calendar/models/calendar_event.py"", line 603, in _compute_field_value
    return super()._compute_field_value(field)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/addons/mail/models/mail_thread.py"", line 428, in _compute_field_value
    return super()._compute_field_value(field)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/odoo/models.py"", line 5238, in _compute_field_value
    fields.determine(field.compute, self)
  File ""/home/odoo/src/odoo/odoo/fields.py"", line 110, in determine
    return needle(*args)
           ^^^^^^^^^^^^^
  File ""/home/odoo/src/enterprise/appointment/models/calendar_event.py"", line 184, in _compute_videocall_redirection
    event.videocall_redirection = f""{self.get_base_url()}/calendar/videocall/{self.access_token}""
                                     ^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/addons/website/models/ir_model.py"", line 26, in get_base_url
    self.ensure_one()
  File ""/home/odoo/src/odoo/odoo/models.py"", line 6212, in ensure_one
    raise ValueError(""Expected singleton: %s"" % self)
ValueError: Expected singleton: calendar.event(1, 2, 3)
```

### Support Ticket

_No response_",Tritomit-AP,2025-01-29 10:24:53+00:00,[],2025-02-02 13:08:26+00:00,,https://github.com/odoo/odoo/issues/195570,[],"[{'comment_id': 2629386042, 'issue_id': 2817795533, 'author': '0yik', 'body': '`File ""/home/odoo/src/enterprise/appointment/models/calendar_event.py"", line 184, in _compute_videocall_redirection\n    event.videocall_redirection = f""{self.get_base_url()}/calendar/videocall/{self.access_token}""\n                                     ^^^^^^^^^^^^^^^^^^^\n  File ""/home/odoo/src/odoo/addons/website/models/ir_model.py"", line 26, in get_base_url\n    self.ensure_one()`\n\nthe function **get_base_url** have **ensure_one()**\nso only 1 record/id allowed when call from external api\n\ntry this code\n```\nids = [1, 2, 3]\nfields = {\'fields\': [\'start\', \'stop\', \'duration\']}\nrecords = []\ntry:\n   for id in ids:\n      records.append(models.execute_kw(db, uid, password, \'calendar.event\', \'read\', [id], fields))\n   print(records)\nexcept xmlrpc.client.Fault as e:\n    raise ValueError(f""XML-RPC Fault: {e.faultString}"")\n```', 'created_at': datetime.datetime(2025, 2, 2, 12, 57, 4, tzinfo=datetime.timezone.utc)}]","0yik on (2025-02-02 12:57:04 UTC): `File ""/home/odoo/src/enterprise/appointment/models/calendar_event.py"", line 184, in _compute_videocall_redirection
    event.videocall_redirection = f""{self.get_base_url()}/calendar/videocall/{self.access_token}""
                                     ^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/addons/website/models/ir_model.py"", line 26, in get_base_url
    self.ensure_one()`

the function **get_base_url** have **ensure_one()**
so only 1 record/id allowed when call from external api

try this code
```
ids = [1, 2, 3]
fields = {'fields': ['start', 'stop', 'duration']}
records = []
try:
   for id in ids:
      records.append(models.execute_kw(db, uid, password, 'calendar.event', 'read', [id], fields))
   print(records)
except xmlrpc.client.Fault as e:
    raise ValueError(f""XML-RPC Fault: {e.faultString}"")
```

"
2817740400,issue,open,,[16.0] module: Website. Product images (Inventory module) lose quality when I display them on the web.,"### Odoo Version

- [x] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Current behaviour: I have a product in the Inventory module, to which I have added an image. In my module when I want to show the information of this product, this image has lost a lot of quality with respect to the one I have uploaded.

Expected behaviour: I would like the quality of the image I have uploaded to be maintained when displaying the product.

This is a screenshot of the template that im using to render de image

![Image](https://github.com/user-attachments/assets/c8207424-c561-4139-b221-b05b28bf7acb)",alvaro2203,2025-01-29 10:01:38+00:00,[],2025-01-29 10:01:51+00:00,,https://github.com/odoo/odoo/issues/195568,[],[],
2815957398,issue,closed,completed,"[18.0] sale: ""User: Own Documents Only"" group not working as expected","### Odoo Version

- [x] 16.0
- [x] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

1. Navigate to the user's settings.
2. Enable the role: ""**User: Own Documents Only**"".

**Expected Behavior:** The user should be able to view all their orders and bills in the personal area.
Additionally, accessing specific orders directly via the URL (e.g., `/my/orders/<order_id>`) should work without any restrictions.

**Actual Behavior:** The user cannot see any of their orders or bills in the personal area.
Furthermore, attempting to access a specific order directly using the URL `/my/orders/<order_id>` results in a 403 (Forbidden) error.

**Proposed Solution:** Modify the domain of the `ir.rule` `sale.sale_order_personal_rule` from:

```python
['|', ('user_id', '=', user.id), ('user_id', '=', False)]
```
to:

```python
['|', '|', ('user_id', '=', user.id), ('user_id', '=', False), ('partner_id.user_ids', 'in', [user.id])]
```

### Log Output

```shell

```

### Support Ticket

_No response_",remarcoble,2025-01-28 15:06:19+00:00,[],2025-02-03 22:58:18+00:00,2025-02-03 22:58:18+00:00,https://github.com/odoo/odoo/issues/195470,[],[],
2815762462,issue,open,,[18.0] account: payable_id and receiveable_id on child partners,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Hello, we are having issues when creating contacts for our partners when the account module is installed.

Steps:  
- Create a partner
- Create a sub contact for the partner
- Go to sub contact view and change any field
- Save the contact

Expected behavior: Save the new contact details
Actual behavior: 
Error message saying
The following fields are invalid : 
- Account Receivable 
- Account Payable

I've looked up the database and the contacts with this issue have 

`{""1"": null}` - property_account_payable_id
`{""1"": null}` - property_account_receivable_id
 
but the parent partner has NULL for both of these fields.

We are using Turkish localization for account module.

Thanks

### Log Output

```shell

```

### Support Ticket

4522943",okb1100,2025-01-28 13:59:02+00:00,[],2025-01-28 13:59:02+00:00,,https://github.com/odoo/odoo/issues/195452,[],[],
2815197967,issue,open,,[18.0] hr_attendance: Error Promise on Push Button on List,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- Go to Attendance
- Go to List View of Attendance
- Select an Item
- Press Any Button from Approve/Refuse Extra Hours

### Log Output

```shell
UncaughtPromiseError > TypeError

Uncaught Promise > Cannot read properties of undefined (reading 'some')

Occured on growetest.odoo.com on 2025-01-28 10:08:11 GMT

TypeError: Cannot read properties of undefined (reading 'some')
    at Proxy.load (https://growetest.odoo.com/web/assets/8f1ae45/web.assets_web.min.js:18849:979)
    at Object.reload (https://growetest.odoo.com/web/assets/8f1ae45/web.assets_web.min.js:9006:4848)
    at onClose (https://growetest.odoo.com/web/assets/8f1ae45/web.assets_web.min.js:9419:243)
    at _executeCloseAction (https://growetest.odoo.com/web/assets/8f1ae45/web.assets_web.min.js:9796:19)
    at doAction (https://growetest.odoo.com/web/assets/8f1ae45/web.assets_web.min.js:9799:89)
    at async Object.doActionButton (https://growetest.odoo.com/web/assets/8f1ae45/web.assets_web.min.js:9810:202)
    at async execute (https://growetest.odoo.com/web/assets/8f1ae45/web.assets_web.min.js:9419:266)
    at async executeButtonCallback (https://growetest.odoo.com/web/assets/8f1ae45/web.assets_web.min.js:9412:34)
```

### Support Ticket

_No response_",PaoloGrower,2025-01-28 10:14:33+00:00,[],2025-01-28 10:18:14+00:00,,https://github.com/odoo/odoo/issues/195404,[],"[{'comment_id': 2618573280, 'issue_id': 2815197967, 'author': 'PaoloGrower', 'body': 'I was able to bypass the error by checking if params.domain is correctly defined as an array by changing in hr_attendance\\static\\src\\views\\attendance_list_views.js\nCurrent Code:\nexport class AttendanceListModel extends listView.Model {\n\n    /** @override **/\n    async load(params = {}) {\n        const activeDomainParam = params.domain.some((index) => Array.isArray(index) && index[0] == ""employee_id.active"");\n        if (!activeDomainParam) {\n            params.domain.push([""employee_id.active"", ""="", true]);\n        }\n        return super.load(params);\n    }\n}\n\nUpdated Code with Fix:\nexport class AttendanceListModel extends listView.Model {\n\n    /** @override **/\n    async load(params = {}) {\n        // Ensure params.domain is defined and is an array\n        if (!Array.isArray(params.domain)) {\n            params.domain = [];\n        }\n\n        const activeDomainParam = params.domain.some(\n            (index) => Array.isArray(index) && index[0] == ""employee_id.active""\n        );\n\n        if (!activeDomainParam) {\n            params.domain.push([""employee_id.active"", ""="", true]);\n        }\n\n        return super.load(params);\n    }\n}', 'created_at': datetime.datetime(2025, 1, 28, 10, 18, 14, tzinfo=datetime.timezone.utc)}]","PaoloGrower (Issue Creator) on (2025-01-28 10:18:14 UTC): I was able to bypass the error by checking if params.domain is correctly defined as an array by changing in hr_attendance\static\src\views\attendance_list_views.js
Current Code:
export class AttendanceListModel extends listView.Model {

    /** @override **/
    async load(params = {}) {
        const activeDomainParam = params.domain.some((index) => Array.isArray(index) && index[0] == ""employee_id.active"");
        if (!activeDomainParam) {
            params.domain.push([""employee_id.active"", ""="", true]);
        }
        return super.load(params);
    }
}

Updated Code with Fix:
export class AttendanceListModel extends listView.Model {

    /** @override **/
    async load(params = {}) {
        // Ensure params.domain is defined and is an array
        if (!Array.isArray(params.domain)) {
            params.domain = [];
        }

        const activeDomainParam = params.domain.some(
            (index) => Array.isArray(index) && index[0] == ""employee_id.active""
        );

        if (!activeDomainParam) {
            params.domain.push([""employee_id.active"", ""="", true]);
        }

        return super.load(params);
    }
}

"
2813570221,issue,open,,[16.0] Mail: Invoice marked as sent even when email delivery fails,"### Odoo Version

- [x] 16.0
- [x] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Steps to Reproduce:
1. Configure an Outgoing Mail Server incorrectly (e.g., invalid SMTP settings) or exceed the daily email sending limit (200 emails per day, the default in Odoo).
2. Go to Accounting > Customers > Invoices.
3. Apply a filter: ""is_move_sent = False"" to list invoices that have not been marked as sent.
4. Select all filtered invoices.
5. Click ""Send & Print"" to attempt sending emails.
6. Go to the affected invoices and check:
  The status of the sent emails under ""Emails"" (in the chatter or in Technical > Emails).
  If the is_move_sent field changed from False to True.
  The chatter log to see if it posted a message simulating that the email was sent.

Current Behaviour:
The invoice is marked as ""Sent"", even though the email was not successfully delivered.
The chatter logs a message as if the email was successfully sent.
No error message or notification is shown to indicate the failure.

Expected Behaviour:
The invoice should not be marked as ""Sent"" if the email fails.
A clear error message should inform the user about the email delivery failure.
Optionally, notify the user in a way that prompts them to take action (e.g., retry sending the email or check email settings).

Video/Screenshot Link (optional):
https://drive.google.com/file/d/1puhb4mmqy3EvdzhyqBaCwg6_1ocJIr2f/view

### Log Output

```shell

```

### Support Ticket

_No response_",rov-adhoc,2025-01-27 17:05:57+00:00,[],2025-01-27 17:05:57+00:00,,https://github.com/odoo/odoo/issues/195327,[],[],
2813013782,issue,open,,[17.0+e] pdf417gen incompatibility with Odoo.sh,"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Some enterprise modules require pdf417gen python module.
Such as those required by Chile Fiscal Localization.
https://www.odoo.com/documentation/17.0/applications/finance/fiscal_localizations/chile.html

The documentation says you need to manually install ""pdf417gen"" without giving a specific version, so this implies the latest version will work fine.
The following was tested under Odoo.sh with Odoo 17.0+e.

By adding to the repository:
requirements.txt
- pdf417gen

It will install the latest pdf417gen version being 0.8.1 as of now.
The installation will success, but Odoo will fail to load it when required.

The attached Log Output shows an electronic invoice failing to generate the bottom PDF417 barcode and leaving the space empty in the invoice PDF generation.

The fix is to downgrade to pdf417gen 0.7.1.
requirements.txt
- pdf417gen==0.7.1

Please look into it as new users may have a really bad time trying to figure this out.



### Log Output

```shell
Installing collected packages: pdf417gen
Successfully installed pdf417gen-0.8.1
odoo.addons.l10n_cl_edi.models.account_move: Could not import library pdf417gen
```

### Support Ticket

4526996",jota2rz,2025-01-27 13:19:59+00:00,[],2025-01-29 13:54:30+00:00,,https://github.com/odoo/odoo/issues/195271,[],[],
2812949484,issue,open,reopened,[18.0] module: description,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Odoo-bin start 2 times with worker > 0

Download Odoo 18 community
and try to launch it with Odoo-bin





### Log Output

```shell
13:47:03 root@ODOO-BIN-V18-TEMPLATE:/data/git/odoo# python3 ./odoo-bin -c odoo.conf


2025-01-27 12:47:09,677 30473 INFO ? odoo: Odoo version 18.0
2025-01-27 12:47:09,678 30473 INFO ? odoo: Using configuration file at /data/git/odoo/odoo.conf
2025-01-27 12:47:09,678 30473 INFO ? odoo: addons paths: ['/data/git/odoo/odoo/addons', '/data/odoo/filestore/addons/18.0', '/data/odoo/addons']
2025-01-27 12:47:09,678 30473 INFO ? odoo: database: odoo@10.0.5.3:default
2025-01-27 12:47:09,908 30473 INFO ? odoo.addons.base.models.ir_actions_report: Will use the Wkhtmltopdf binary at /usr/bin/wkhtmltopdf
2025-01-27 12:47:09,947 30473 INFO ? odoo.addons.base.models.ir_actions_report: Will use the Wkhtmltoimage binary at /usr/bin/wkhtmltoimage
2025-01-27 12:47:10,216 30473 INFO ? odoo.service.server: HTTP service (werkzeug) running on 0.0.0.0:8069
2025-01-27 12:47:10,296 30473 INFO odoo odoo.modules.loading: loading 1 modules...
2025-01-27 12:47:10,320 30473 INFO odoo odoo.modules.loading: 1 modules loaded in 0.02s, 0 queries (+0 extra)
2025-01-27 12:47:10,387 30473 INFO odoo odoo.modules.loading: loading 37 modules...
2025-01-27 12:47:11,256 30473 INFO odoo odoo.modules.loading: 37 modules loaded in 0.87s, 0 queries (+0 extra)
2025-01-27 12:47:11,364 30473 INFO odoo odoo.modules.loading: Modules loaded.
2025-01-27 12:47:11,368 30473 INFO odoo odoo.modules.registry: Registry loaded in 1.151s
2025-01-27 12:47:11,369 30473 INFO odoo odoo.sql_db: ConnectionPool(read/write;used=0/count=0/max=64): Closed 1 connections
2025-01-27 12:47:11,376 30476 INFO odoo odoo.service.server: Worker WorkerHTTP (30476) alive
2025-01-27 12:47:11,381 30477 INFO odoo odoo.service.server: Worker WorkerHTTP (30477) alive
2025-01-27 12:47:11,386 30479 INFO odoo odoo.service.server: Worker WorkerHTTP (30479) alive
2025-01-27 12:47:11,390 30481 INFO odoo odoo.service.server: Worker WorkerHTTP (30481) alive
2025-01-27 12:47:11,396 30483 INFO odoo odoo.service.server: Worker WorkerHTTP (30483) alive
2025-01-27 12:47:11,401 30485 INFO odoo odoo.service.server: Worker WorkerHTTP (30485) alive
2025-01-27 12:47:11,406 30487 INFO odoo odoo.service.server: Worker WorkerHTTP (30487) alive
2025-01-27 12:47:11,410 30489 INFO odoo odoo.service.server: Worker WorkerHTTP (30489) alive
2025-01-27 12:47:11,418 30493 INFO odoo odoo.service.server: Worker WorkerCron (30493) alive
2025-01-27 12:47:11,422 30494 INFO odoo odoo.service.server: Worker WorkerCron (30494) alive
2025-01-27 12:47:12,956 30491 INFO ? odoo: Odoo version 18.0
2025-01-27 12:47:12,956 30491 INFO ? odoo: Using configuration file at /data/git/odoo/odoo.conf
2025-01-27 12:47:12,956 30491 INFO ? odoo: addons paths: ['/data/git/odoo/odoo/addons', '/data/odoo/filestore/addons/18.0', '/data/odoo/addons']
2025-01-27 12:47:12,956 30491 INFO ? odoo: database: odoo@10.0.5.3:default
2025-01-27 12:47:13,356 30491 INFO ? odoo.addons.base.models.ir_actions_report: Will use the Wkhtmltopdf binary at /usr/bin/wkhtmltopdf
2025-01-27 12:47:13,472 30491 INFO ? odoo.addons.base.models.ir_actions_report: Will use the Wkhtmltoimage binary at /usr/bin/wkhtmltoimage
2025-01-27 12:47:14,026 30491 INFO ? odoo.service.server: Evented Service (longpolling) running on 0.0.0.0:8072
2025-01-27 12:47:35,466 30481 INFO odoo odoo.addons.base.models.ir_http: Generating routing map for key 1
2025-01-27 12:47:35,828 30481 ERROR odoo odoo.http: Exception during request handling.
Traceback (most recent call last):
  File ""/data/odoo/addons/bus/websocket.py"", line 914, in open_connection
    socket = request.httprequest._HTTPRequest__environ['socket']
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
KeyError: 'socket'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/data/git/odoo/odoo/http.py"", line 2366, in __call__
    response = request._serve_db()
               ^^^^^^^^^^^^^^^^^^^
  File ""/data/git/odoo/odoo/http.py"", line 1894, in _serve_db
    return self._transactioning(
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/data/git/odoo/odoo/http.py"", line 1957, in _transactioning
    return service_model.retrying(func, env=self.env)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/git/odoo/odoo/service/model.py"", line 137, in retrying
    result = func()
             ^^^^^^
  File ""/data/git/odoo/odoo/http.py"", line 1924, in _serve_ir_http
    response = self.dispatcher.dispatch(rule.endpoint, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/git/odoo/odoo/http.py"", line 2084, in dispatch
    return self.request.registry['ir.http']._dispatch(endpoint)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/git/odoo/odoo/addons/base/models/ir_http.py"", line 329, in _dispatch
    result = endpoint(**request.params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/git/odoo/odoo/http.py"", line 727, in route_wrapper
    result = endpoint(self, *args, **params_ok)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/odoo/addons/bus/controllers/websocket.py"", line 20, in websocket
    return WebsocketConnectionHandler.open_connection(request, version)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/odoo/addons/bus/websocket.py"", line 927, in open_connection
    raise RuntimeError(
RuntimeError: Couldn't bind the websocket. Is the connection opened on the evented port (8072)?
2025-01-27 12:47:35,839 30481 INFO odoo werkzeug: 172.16.8.4 - - [27/Jan/2025 12:47:35] ""GET /websocket?version=18.0-3 HTTP/1.1"" 500 - 8 0.025 0.437
```

### Support Ticket

_No response_",AlexandreMagnat,2025-01-27 12:52:39+00:00,[],2025-02-04 21:32:19+00:00,,https://github.com/odoo/odoo/issues/195259,[],"[{'comment_id': 2628938406, 'issue_id': 2812949484, 'author': 'AlexandreMagnat', 'body': 'find solution:\n\n# Port pour les notifications en temps réel\ngevent_port = 8072\nproxy_mode = True\nlongpolling_port = False', 'created_at': datetime.datetime(2025, 2, 1, 12, 41, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2635122308, 'issue_id': 2812949484, 'author': 'AlexandreMagnat', 'body': 'wrong..\nsame problem with this configuration...\n\n\n\n2025-02-04 21:31:12,564 926 ERROR odoo odoo.http: Exception during request handling.\nTraceback (most recent call last):\n  File ""/data/odoo/addons/bus/websocket.py"", line 914, in open_connection\n    socket = request.httprequest._HTTPRequest__environ[\'socket\']\n             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^\nKeyError: \'socket\'\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File ""/data/odoo/odoo/http.py"", line 2366, in __call__\n    response = request._serve_db()\n               ^^^^^^^^^^^^^^^^^^^\n  File ""/data/odoo/odoo/http.py"", line 1894, in _serve_db\n    return self._transactioning(\n           ^^^^^^^^^^^^^^^^^^^^^\n  File ""/data/odoo/odoo/http.py"", line 1957, in _transactioning\n    return service_model.retrying(func, env=self.env)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/data/odoo/odoo/service/model.py"", line 137, in retrying\n    result = func()\n             ^^^^^^\n  File ""/data/odoo/odoo/http.py"", line 1924, in _serve_ir_http\n    response = self.dispatcher.dispatch(rule.endpoint, args)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/data/odoo/odoo/http.py"", line 2084, in dispatch\n    return self.request.registry[\'ir.http\']._dispatch(endpoint)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/data/odoo/odoo/addons/base/models/ir_http.py"", line 329, in _dispatch\n    result = endpoint(**request.params)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/data/odoo/odoo/http.py"", line 727, in route_wrapper\n    result = endpoint(self, *args, **params_ok)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/data/odoo/addons/bus/controllers/websocket.py"", line 20, in websocket\n    return WebsocketConnectionHandler.open_connection(request, version)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/data/odoo/addons/bus/websocket.py"", line 927, in open_connection\n    raise RuntimeError(\nRuntimeError: Couldn\'t bind the websocket. Is the connection opened on the evented port (8072)?', 'created_at': datetime.datetime(2025, 2, 4, 21, 32, 18, tzinfo=datetime.timezone.utc)}]","AlexandreMagnat (Issue Creator) on (2025-02-01 12:41:29 UTC): find solution:

# Port pour les notifications en temps réel
gevent_port = 8072
proxy_mode = True
longpolling_port = False

AlexandreMagnat (Issue Creator) on (2025-02-04 21:32:18 UTC): wrong..
same problem with this configuration...



2025-02-04 21:31:12,564 926 ERROR odoo odoo.http: Exception during request handling.
Traceback (most recent call last):
  File ""/data/odoo/addons/bus/websocket.py"", line 914, in open_connection
    socket = request.httprequest._HTTPRequest__environ['socket']
             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
KeyError: 'socket'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/data/odoo/odoo/http.py"", line 2366, in __call__
    response = request._serve_db()
               ^^^^^^^^^^^^^^^^^^^
  File ""/data/odoo/odoo/http.py"", line 1894, in _serve_db
    return self._transactioning(
           ^^^^^^^^^^^^^^^^^^^^^
  File ""/data/odoo/odoo/http.py"", line 1957, in _transactioning
    return service_model.retrying(func, env=self.env)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/odoo/odoo/service/model.py"", line 137, in retrying
    result = func()
             ^^^^^^
  File ""/data/odoo/odoo/http.py"", line 1924, in _serve_ir_http
    response = self.dispatcher.dispatch(rule.endpoint, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/odoo/odoo/http.py"", line 2084, in dispatch
    return self.request.registry['ir.http']._dispatch(endpoint)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/odoo/odoo/addons/base/models/ir_http.py"", line 329, in _dispatch
    result = endpoint(**request.params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/odoo/odoo/http.py"", line 727, in route_wrapper
    result = endpoint(self, *args, **params_ok)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/odoo/addons/bus/controllers/websocket.py"", line 20, in websocket
    return WebsocketConnectionHandler.open_connection(request, version)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/odoo/addons/bus/websocket.py"", line 927, in open_connection
    raise RuntimeError(
RuntimeError: Couldn't bind the websocket. Is the connection opened on the evented port (8072)?

"
2812464347,issue,open,,[16.0] portal: street2 field is not displayed in the portal.portal_my_details HTML view,"### Odoo Version

- [x] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- Version: 16.0

- Current behaviour: The street2 field is missing from the portal.portal_my_details view, preventing users from entering or editing their secondary address line. Since street2 is displayed at /shop/address (website_sale.address) but not in portal.portal_my_details, users may become confused.

- Expected behaviour: The street2 field should be present in the portal.portal_my_details view, allowing users to input or edit their secondary address line.

- The relevant [PR #162355](https://github.com/odoo/odoo/pull/162355/files) has already been merged into Odoo version 17.3.

- Screenshot:

<img width=""579"" alt=""Image"" src=""https://github.com/user-attachments/assets/49e74a44-178d-4674-90ae-9475447ef2d1"" />",nobuQuartile,2025-01-27 09:14:40+00:00,[],2025-01-28 07:10:24+00:00,,https://github.com/odoo/odoo/issues/195215,[],[],
2812206189,issue,open,,[18.0] Delivery: Check Availability Button Issue,"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [x] 18.0
- [ ] Other (specify)

### Current behaviour:

After creating and confirming a sales order with multiple products, if the quantity of one product is updated to zero in the Operations tab, the Check Availability and Validate buttons are visible. Clicking on the Validate button and closing the popup without making any changes causes the Check Availability button to disappear. This prevents users from matching the Demand and Quantity for multiple products.

### Steps to Reproduce

- Create a sales order with multiple products.
- Confirm the sales order.
- Update the quantity of a product to zero in the Operations tab.
- Ensure the Check Availability and Validate buttons are visible.
- Click on the Validate button and close the popup without making any changes.
- The Check Availability button gets hidden.

### Expected Behavior:

The Check Availability button should remain visible even after clicking the Validate button and closing the popup without making changes. Users should be able to match the Demand and Quantity for multiple products regardless of any incomplete or unchanged validations.

### Screenshots:

![Image](https://github.com/user-attachments/assets/6f6f5572-f751-4155-ac9e-8d7683e5c738)
![Image](https://github.com/user-attachments/assets/987dd29c-12f5-4d5d-8638-7d74c2230c74)
![Image](https://github.com/user-attachments/assets/8c0ebe59-68ff-4177-8622-a13e34352261)

### Log Output

```shell

```

### Support Ticket

_No response_",Ali-PITS,2025-01-27 06:44:08+00:00,[],2025-01-27 06:50:42+00:00,,https://github.com/odoo/odoo/issues/195201,[],[],
2811706520,issue,open,,[18.0] invoice product label,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

steps to reproduce

1 remove your own brain
2 create a service product service ""international transportation lower priority customer""
3 create an invoice and add in the description ""route Paris->Berlin->your mom""
4 export the invoice to pdf the invoice line has 2 lines
""international transportation lower priority customer""
 ""route Paris->Berlin->your mom""

![Image](https://github.com/user-attachments/assets/7a4c15bd-8c91-4168-8443-9e3313ca96fd)

why we got this while in version 17 label was working just fine? who knows, brain removals have consequences 
do i want the product name  ""international transportation lower priority customer"" in the invoice ? nope, new V18 anti-features
do i want the description to be the only thing show in the invoice ? yes
the label approach from version 17 was better because allowed the user to have one product dont have to spam thousands of product for every combinations of cities 

also if the label is removed why there is a toggle for it?
![Image](https://github.com/user-attachments/assets/d62723fd-3f47-4733-9b4f-663bb15ede49)



> Chesterton's Fence; Understanding past decisions. Chesterton's Fence is a principle that says change should not be made until the reasoning behind the current state of affairs is understood.

### Log Output

```shell

```

### Support Ticket

_No response_",icf20,2025-01-26 18:05:43+00:00,[],2025-01-26 18:05:43+00:00,,https://github.com/odoo/odoo/issues/195190,[],[],
2810907396,issue,open,,[18.0] web: code editor value is [object Object],"Hi
I'm developing a module and I need to show API call response to the user.
In fact I will be the user who need to see the API call response.

### Odoo Version

- [ ] 16.0
- [x] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- Add a json Field: `response_body = fields.Json()`
- Add your field whit code widget js mode: `<field name=""response_body"" widget=""code"" options=""{'mode': 'javascript'}"" groups=""base.group_no_one""/>`
- On the page it will show you `[object Object]`
   ![Image](https://github.com/user-attachments/assets/08e28dd8-855b-4904-8b4d-c2a3222a0a10)
- Same thing happens with `text` widget

In fact, you can't show json data to user.",Heshmatkhah,2025-01-25 10:16:41+00:00,[],2025-01-29 10:58:17+00:00,,https://github.com/odoo/odoo/issues/195178,[],"[{'comment_id': 2614164917, 'issue_id': 2810907396, 'author': 'skj-skj', 'body': 'use `JSON.stringify()` to convert the object to json string', 'created_at': datetime.datetime(2025, 1, 26, 1, 33, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2614308464, 'issue_id': 2810907396, 'author': 'zwanski2019', 'body': 'Hi! I can help with a solution for the JSON display issue. Here\'s a complete fix that properly handles JSON data in the code widget:\n\n1. Create a new JavaScript file for the custom widget (e.g., `static/src/js/json_code_widget.js`):\n\n```javascript\nodoo.define(\'custom_json_widget.JsonCodeWidget\', function (require) {\n    ""use strict"";\n\n    var AbstractField = require(\'web.AbstractField\');\n    var registry = require(\'web.field_registry\');\n\n    var JsonCodeWidget = AbstractField.extend({\n        template: \'JsonCodeWidget\',\n        \n        init: function () {\n            this._super.apply(this, arguments);\n            this.mode = this.nodeOptions.mode || \'javascript\';\n        },\n        \n        _renderReadonly: function () {\n            try {\n                // Handle both string and object JSON\n                let value = this.value;\n                if (typeof value === \'object\') {\n                    value = JSON.stringify(value, null, 2);\n                } else if (typeof value === \'string\') {\n                    // Try to parse and re-stringify to format\n                    value = JSON.stringify(JSON.parse(value), null, 2);\n                }\n                this.$el.text(value);\n            } catch (e) {\n                this.$el.text(this.value || \'\');\n            }\n        },\n        \n        _renderEdit: function () {\n            this._renderReadonly();\n        }\n    });\n\n    registry.add(\'json_code\', JsonCodeWidget);\n    return JsonCodeWidget;\n});\n\n2. Add the template XML (e.g., `static/src/xml/json_code_widget.xml`):\n\n\n```xml\n\n```\n\n<?xml version=""1.0"" encoding=""UTF-8""?>\n<templates xml:space=""preserve"">\n    <t t-name=""JsonCodeWidget"">\n        <pre class=""o_json_code"" />\n    </t>\n</templates>\n\n3. Update your form view to use the new widget:\n\n\n```xml\n\n```\n\n<field name=""response_body"" widget=""json_code"" options=""{\'mode\': \'javascript\'}"" groups=""base.group_no_one""/>\n\nThis solution:\n\n- Properly formats JSON data using `JSON.stringify(value, null, 2)`\n- Handles both string and object JSON inputs\n- Maintains the existing security group restriction\n- Preserves code editor styling\n- Works in both readonly and edit modes\n\n\nThe widget will now display formatted JSON instead of [object Object]. For example:\n{\n  ""key"": ""value"",\n  ""nested"": {\n    ""data"": ""example""\n  }\n}', 'created_at': datetime.datetime(2025, 1, 26, 10, 6, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2614999586, 'issue_id': 2810907396, 'author': 'Heshmatkhah', 'body': 'Hi @zwanski2019 \nThank you for your response.\nI want to test your code, but the markdown format of your comment is not correct (missing some ` ``` ` after codes).\nCan you please fix that?\n\nAlso, there is no `web.field_registry` and `web.AbstractField` in Odoo 18.\n\nAnother question is that I want the use ace editor to modify the JSON data, do you has any Idea on how to fix the `[object Object]` problme?\n\nDear @skj-skj, can you provide more information on how/where to use `JSON.stringify()`?\n\nThe problem is that the `value` prop that is passed by Odoo to the widget is `[object Object]` not the actual value of the object!', 'created_at': datetime.datetime(2025, 1, 27, 7, 17, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2615376835, 'issue_id': 2810907396, 'author': 'zwanski2019', 'body': '/** @odoo-module **/\n\nimport { Component } from ""@odoo/owl"";\nimport { registry } from ""@web/core/registry"";\nimport { standardFieldProps } from ""@web/views/fields/standard_field_props"";\n\nexport class JsonEditorField extends Component {\n    static template = ""custom_module.JsonEditor"";\n    static props = {\n        ...standardFieldProps,\n    };\n\n    setup() {\n        this.editor = null;\n    }\n\n    mounted() {\n        this.initAceEditor();\n    }\n\n    willUnmount() {\n        if (this.editor) {\n            this.editor.destroy();\n        }\n    }\n\n    initAceEditor() {\n        const editorElement = this.el.querySelector(\'#aceEditor\');\n        this.editor = ace.edit(editorElement);\n        this.editor.setTheme(""ace/theme/monokai"");\n        this.editor.session.setMode(""ace/mode/json"");\n        \n        // Format and set the initial value\n        let jsonValue = this.props.value;\n        try {\n            if (typeof jsonValue === \'object\') {\n                jsonValue = JSON.stringify(jsonValue, null, 2);\n            } else if (typeof jsonValue === \'string\') {\n                jsonValue = JSON.stringify(JSON.parse(jsonValue), null, 2);\n            }\n        } catch (e) {\n            jsonValue = String(jsonValue || \'\');\n        }\n        \n        this.editor.setValue(jsonValue);\n        \n        // Handle changes\n        this.editor.on(\'change\', () => {\n            try {\n                const value = this.editor.getValue();\n                const parsedValue = JSON.parse(value);\n                this.props.update(parsedValue);\n            } catch (e) {\n                console.warn(\'Invalid JSON:\', e);\n            }\n        });\n    }\n}\n\nregistry.category(""fields"").add(""json_editor"", JsonEditorField);\n\nSave this as `static/src/components/json_editor/json_editor.js` in your module.\n\nThen create the template file `static/src/components/json_editor/json_editor.xml`:\n\n<?xml version=""1.0"" encoding=""UTF-8""?>\n<templates xml:space=""preserve"">\n    <t t-name=""custom_module.JsonEditor"">\n        <div class=""o_field_json_editor"" t-att-class=""{ o_field_invalid: props.isInvalid }"">\n            <div id=""aceEditor"" style=""width: 100%; height: 300px;""></div>\n        </div>\n    </t>\n</templates>\n\nUpdate your module\'s `__manifest__.py`:\n\n{\n    \'name\': \'Custom JSON Editor\',\n    \'version\': \'1.0\',\n    \'depends\': [\'base\', \'web\'],\n    \'assets\': {\n        \'web.assets_backend\': [\n            \'https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.0/ace.js\',\n            \'custom_module/static/src/components/json_editor/**/*\',\n        ],\n    },\n}\n\n\nFinally, in your form view:\n\n\n<field name=""response_body"" widget=""json_editor"" groups=""base.group_no_one""/>\n\nAfter implementing these changes:\n\n1. Update your module\n2. Restart your Odoo server\n3. Upgrade your module in Odoo', 'created_at': datetime.datetime(2025, 1, 27, 10, 30, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2616549156, 'issue_id': 2810907396, 'author': 'skj-skj', 'body': '> Hi [@zwanski2019](https://github.com/zwanski2019) Thank you for your response. I want to test your code, but the markdown format of your comment is not correct (missing some `` ``` `` after codes). Can you please fix that?\n> \n> Also, there is no `web.field_registry` and `web.AbstractField` in Odoo 18.\n> \n> Another question is that I want the use ace editor to modify the JSON data, do you has any Idea on how to fix the `[object Object]` problme?\n> \n> Dear [@skj-skj](https://github.com/skj-skj), can you provide more information on how/where to use `JSON.stringify()`?\n> \n> The problem is that the `value` prop that is passed by Odoo to the widget is `[object Object]` not the actual value of the object!\n\nhey sorry, I didn\'t provided any example there\n\nthe reason you are seeing `[object Object]` because you are converting the object directly to string either by contacting, using template or using `.toString()`\n\nin order to see the object as json you have to use `JSON.stringify()`\n\nheres an example\n```javascript\nconst myObject = { name: ""Alice"", age: 30 };\n\n// this will print ""[object Object]"" in console\nconsole.log(`My object: ${myObject}`);\nconsole.log(myObject.toString())\n\n// this will print ""{""name"":""Alice"",""age"":30}"" in console\nconsole.log(`json: ${JSON.stringify(myObject)}`)\nconsole.log(JSON.stringify(myObject))\n```\n[try it online here](https://tio.run/##dY7BCoJAEIbvPsUwdHChVPASKx26BuXBYwSabLay7oq7GCI@u2lmIORpGOaf//vypE50WvHS7Op936dKagNFE95zlho4QAsyKRgFPAqeMtxCkg2b70EXWJbrgnlyDS8uBJQVlwbwqqbXqeGGwCWMrUow6zsdoTI7PjcwRSls2pnYxSRYxOaDY1RkBkJmE/If3OJoinQ2xcEUqe916wq5VnKkn6Lw4uhPPX80PyYZbBYPaznS928 ""JavaScript (V8) – Try It Online"")\n\nI hope this helps also in understanding why @zwanski2019 code is works for you.', 'created_at': datetime.datetime(2025, 1, 27, 18, 11, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2621268992, 'issue_id': 2810907396, 'author': 'Heshmatkhah', 'body': 'Hi @skj-skj,\nThank you for your reply.\n\n> the reason you are seeing `[object Object]` because you are converting the object directly to string either by contacting, using template or using `.toString()`\n\nmy code is  this:\n``` xml\n<field name=""response_body"" widget=""code"" options=""{\'mode\': \'javascript\'}"" groups=""base.group_no_one""/>\n```\nand my model is:\n```python\n# ...\n    response_body = fields.Json()\n# ...\n```\n\nAs, you can see, I\'m not writing JS code at all, I\'m using Odoo and that `[object Object]` is what Odoo passes to the widget as **value**!\nSo, where should I use `JSON.stringify()`', 'created_at': datetime.datetime(2025, 1, 29, 10, 39, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2621313493, 'issue_id': 2810907396, 'author': 'skj-skj', 'body': '> Hi [@skj-skj](https://github.com/skj-skj), Thank you for your reply.\n> \n> > the reason you are seeing `[object Object]` because you are converting the object directly to string either by contacting, using template or using `.toString()`\n> \n> my code is this:\n> \n> <field name=""response_body"" widget=""code"" options=""{\'mode\': \'javascript\'}"" groups=""base.group_no_one""/>\n> and my model is:\n> \n> # ...\n>     response_body = fields.Json()\n> # ...\n> As, you can see, I\'m not writing JS code at all, I\'m using Odoo and that `[object Object]` is what Odoo passes to the widget as **value**! So, where should I use `JSON.stringify()`\n\nI am not sure about the details of odoo here, as I haven\'t used odoo.\n\nmy guess will be wrapping `fileds.Json()` with `JSON.stringify()`\n\n```javascript\n// ...\n    response_body = JSON.stringify(fields.Json())\n// ...\n```\n\nyou can also confirm that if `fields.Json()` is returning an js object or string by printing the `typeof` like this\n\n`console.log(typeof fields.Json())` if in console the output is `\'object\'` it means the value of `fields.Json()` is of type object and in order to read this as string you have to use `JSON.stringify`\n\nif updating there is not possible, you can check where `response_body` is been used in the code and wrap the response body with `JSON.stringify()`', 'created_at': datetime.datetime(2025, 1, 29, 10, 58, 15, tzinfo=datetime.timezone.utc)}]","skj-skj on (2025-01-26 01:33:48 UTC): use `JSON.stringify()` to convert the object to json string

zwanski2019 on (2025-01-26 10:06:29 UTC): Hi! I can help with a solution for the JSON display issue. Here's a complete fix that properly handles JSON data in the code widget:

1. Create a new JavaScript file for the custom widget (e.g., `static/src/js/json_code_widget.js`):

```javascript
odoo.define('custom_json_widget.JsonCodeWidget', function (require) {
    ""use strict"";

    var AbstractField = require('web.AbstractField');
    var registry = require('web.field_registry');

    var JsonCodeWidget = AbstractField.extend({
        template: 'JsonCodeWidget',
        
        init: function () {
            this._super.apply(this, arguments);
            this.mode = this.nodeOptions.mode || 'javascript';
        },
        
        _renderReadonly: function () {
            try {
                // Handle both string and object JSON
                let value = this.value;
                if (typeof value === 'object') {
                    value = JSON.stringify(value, null, 2);
                } else if (typeof value === 'string') {
                    // Try to parse and re-stringify to format
                    value = JSON.stringify(JSON.parse(value), null, 2);
                }
                this.$el.text(value);
            } catch (e) {
                this.$el.text(this.value || '');
            }
        },
        
        _renderEdit: function () {
            this._renderReadonly();
        }
    });

    registry.add('json_code', JsonCodeWidget);
    return JsonCodeWidget;
});

2. Add the template XML (e.g., `static/src/xml/json_code_widget.xml`):


```xml

```

<?xml version=""1.0"" encoding=""UTF-8""?>
<templates xml:space=""preserve"">
    <t t-name=""JsonCodeWidget"">
        <pre class=""o_json_code"" />
    </t>
</templates>

3. Update your form view to use the new widget:


```xml

```

<field name=""response_body"" widget=""json_code"" options=""{'mode': 'javascript'}"" groups=""base.group_no_one""/>

This solution:

- Properly formats JSON data using `JSON.stringify(value, null, 2)`
- Handles both string and object JSON inputs
- Maintains the existing security group restriction
- Preserves code editor styling
- Works in both readonly and edit modes


The widget will now display formatted JSON instead of [object Object]. For example:
{
  ""key"": ""value"",
  ""nested"": {
    ""data"": ""example""
  }
}

Heshmatkhah (Issue Creator) on (2025-01-27 07:17:46 UTC): Hi @zwanski2019 
Thank you for your response.
I want to test your code, but the markdown format of your comment is not correct (missing some ` ``` ` after codes).
Can you please fix that?

Also, there is no `web.field_registry` and `web.AbstractField` in Odoo 18.

Another question is that I want the use ace editor to modify the JSON data, do you has any Idea on how to fix the `[object Object]` problme?

Dear @skj-skj, can you provide more information on how/where to use `JSON.stringify()`?

The problem is that the `value` prop that is passed by Odoo to the widget is `[object Object]` not the actual value of the object!

zwanski2019 on (2025-01-27 10:30:31 UTC): /** @odoo-module **/

import { Component } from ""@odoo/owl"";
import { registry } from ""@web/core/registry"";
import { standardFieldProps } from ""@web/views/fields/standard_field_props"";

export class JsonEditorField extends Component {
    static template = ""custom_module.JsonEditor"";
    static props = {
        ...standardFieldProps,
    };

    setup() {
        this.editor = null;
    }

    mounted() {
        this.initAceEditor();
    }

    willUnmount() {
        if (this.editor) {
            this.editor.destroy();
        }
    }

    initAceEditor() {
        const editorElement = this.el.querySelector('#aceEditor');
        this.editor = ace.edit(editorElement);
        this.editor.setTheme(""ace/theme/monokai"");
        this.editor.session.setMode(""ace/mode/json"");
        
        // Format and set the initial value
        let jsonValue = this.props.value;
        try {
            if (typeof jsonValue === 'object') {
                jsonValue = JSON.stringify(jsonValue, null, 2);
            } else if (typeof jsonValue === 'string') {
                jsonValue = JSON.stringify(JSON.parse(jsonValue), null, 2);
            }
        } catch (e) {
            jsonValue = String(jsonValue || '');
        }
        
        this.editor.setValue(jsonValue);
        
        // Handle changes
        this.editor.on('change', () => {
            try {
                const value = this.editor.getValue();
                const parsedValue = JSON.parse(value);
                this.props.update(parsedValue);
            } catch (e) {
                console.warn('Invalid JSON:', e);
            }
        });
    }
}

registry.category(""fields"").add(""json_editor"", JsonEditorField);

Save this as `static/src/components/json_editor/json_editor.js` in your module.

Then create the template file `static/src/components/json_editor/json_editor.xml`:

<?xml version=""1.0"" encoding=""UTF-8""?>
<templates xml:space=""preserve"">
    <t t-name=""custom_module.JsonEditor"">
        <div class=""o_field_json_editor"" t-att-class=""{ o_field_invalid: props.isInvalid }"">
            <div id=""aceEditor"" style=""width: 100%; height: 300px;""></div>
        </div>
    </t>
</templates>

Update your module's `__manifest__.py`:

{
    'name': 'Custom JSON Editor',
    'version': '1.0',
    'depends': ['base', 'web'],
    'assets': {
        'web.assets_backend': [
            'https://cdnjs.cloudflare.com/ajax/libs/ace/1.23.0/ace.js',
            'custom_module/static/src/components/json_editor/**/*',
        ],
    },
}


Finally, in your form view:


<field name=""response_body"" widget=""json_editor"" groups=""base.group_no_one""/>

After implementing these changes:

1. Update your module
2. Restart your Odoo server
3. Upgrade your module in Odoo

skj-skj on (2025-01-27 18:11:09 UTC): hey sorry, I didn't provided any example there

the reason you are seeing `[object Object]` because you are converting the object directly to string either by contacting, using template or using `.toString()`

in order to see the object as json you have to use `JSON.stringify()`

heres an example
```javascript
const myObject = { name: ""Alice"", age: 30 };

// this will print ""[object Object]"" in console
console.log(`My object: ${myObject}`);
console.log(myObject.toString())

// this will print ""{""name"":""Alice"",""age"":30}"" in console
console.log(`json: ${JSON.stringify(myObject)}`)
console.log(JSON.stringify(myObject))
```
[try it online here](https://tio.run/##dY7BCoJAEIbvPsUwdHChVPASKx26BuXBYwSabLay7oq7GCI@u2lmIORpGOaf//vypE50WvHS7Op936dKagNFE95zlho4QAsyKRgFPAqeMtxCkg2b70EXWJbrgnlyDS8uBJQVlwbwqqbXqeGGwCWMrUow6zsdoTI7PjcwRSls2pnYxSRYxOaDY1RkBkJmE/If3OJoinQ2xcEUqe916wq5VnKkn6Lw4uhPPX80PyYZbBYPaznS928 ""JavaScript (V8) – Try It Online"")

I hope this helps also in understanding why @zwanski2019 code is works for you.

Heshmatkhah (Issue Creator) on (2025-01-29 10:39:09 UTC): Hi @skj-skj,
Thank you for your reply.


my code is  this:
``` xml
<field name=""response_body"" widget=""code"" options=""{'mode': 'javascript'}"" groups=""base.group_no_one""/>
```
and my model is:
```python
# ...
    response_body = fields.Json()
# ...
```

As, you can see, I'm not writing JS code at all, I'm using Odoo and that `[object Object]` is what Odoo passes to the widget as **value**!
So, where should I use `JSON.stringify()`

skj-skj on (2025-01-29 10:58:15 UTC): I am not sure about the details of odoo here, as I haven't used odoo.

my guess will be wrapping `fileds.Json()` with `JSON.stringify()`

```javascript
// ...
    response_body = JSON.stringify(fields.Json())
// ...
```

you can also confirm that if `fields.Json()` is returning an js object or string by printing the `typeof` like this

`console.log(typeof fields.Json())` if in console the output is `'object'` it means the value of `fields.Json()` is of type object and in order to read this as string you have to use `JSON.stringify`

if updating there is not possible, you can check where `response_body` is been used in the code and wrap the response body with `JSON.stringify()`

"
2810709896,issue,open,,[18.1] inventory: Unit of Measure -  Allows selection of Purchase UoMs but cannot convert quantity,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

I added feet as a Supplier UoM 

<img width=""808"" alt=""Image"" src=""https://github.com/user-attachments/assets/196c799b-7018-44c7-87b2-eee002133d6f"" />

I added this product to a Purchase Order and I can select feet as the UoM.  The Receipts Transfer is in Units and it multiplies the purchase quantity by 304.80

<img width=""678"" alt=""Image"" src=""https://github.com/user-attachments/assets/5abf6a27-9ba5-46d2-9057-fd7fa64baa7d"" />

The 304.80 seems to come from the UoM definition:

<img width=""424"" alt=""Image"" src=""https://github.com/user-attachments/assets/1cc060f1-1738-4bc6-871d-b4feb88b791a"" />

Is there any documentation to explain how this is supposed to work?  


### Log Output

```shell

```

### Support Ticket

_No response_",ctringham,2025-01-25 02:42:45+00:00,[],2025-01-25 02:43:25+00:00,,https://github.com/odoo/odoo/issues/195167,[],[],
2809986829,issue,open,,[18.1] module: POS,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [ ] 18.0
- [x] Other (specify)

### Steps to Reproduce

When I tried the Weight barcode in Odoo 18.1, I found a problem, as you can see in the video.
https://www.youtube.com/watch?v=muevWVnjwU4

### Log Output

```shell

```

### Support Ticket

_No response_",waddi-net,2025-01-24 17:32:38+00:00,[],2025-01-24 17:33:13+00:00,,https://github.com/odoo/odoo/issues/195117,[],[],
2809108274,issue,open,,error when uploading invoice #4512697,"when uploading invoice there is an error:

```
RPC_ERROR
Odoo Server Error
Traceback (most recent call last):
  File ""/home/odoo/src/odoo/odoo/http.py"", line 1783, in _serve_db
    return service_model.retrying(self._serve_ir_http, self.env)
  File ""/home/odoo/src/odoo/odoo/service/model.py"", line 133, in retrying
    result = func()
  File ""/home/odoo/src/odoo/odoo/http.py"", line 1810, in _serve_ir_http
    response = self.dispatcher.dispatch(rule.endpoint, args)
  File ""/home/odoo/src/odoo/odoo/http.py"", line 2014, in dispatch
    result = self.request.registry['ir.http']._dispatch(endpoint)
  File ""/home/odoo/src/odoo/odoo/addons/base/models/ir_http.py"", line 221, in _dispatch
    result = endpoint(**request.params)
  File ""/home/odoo/src/odoo/odoo/http.py"", line 757, in route_wrapper
    result = endpoint(self, *args, **params_ok)
  File ""/home/odoo/src/odoo/addons/web/controllers/dataset.py"", line 24, in call_kw
    return self._call_kw(model, method, args, kwargs)
  File ""/home/odoo/src/odoo/addons/web/controllers/dataset.py"", line 20, in _call_kw
    return call_kw(request.env[model], method, args, kwargs)
  File ""/home/odoo/src/odoo/odoo/api.py"", line 466, in call_kw
    result = _call_kw_model_create(method, model, args, kwargs)
  File ""/home/odoo/src/odoo/odoo/api.py"", line 444, in _call_kw_model_create
    result = method(recs, *args, **kwargs)
  File ""<decorator-gen-310>"", line 2, in create
  File ""/home/odoo/src/odoo/odoo/api.py"", line 415, in _model_create_multi
    return create(self, arg)
  File ""/home/odoo/src/enterprise/documents_account/models/ir_attachment.py"", line 8, in create
    attachments = super().create(vals_list)
  File ""<decorator-gen-288>"", line 2, in create
  File ""/home/odoo/src/odoo/odoo/api.py"", line 415, in _model_create_multi
    return create(self, arg)
  File ""/home/odoo/src/odoo/addons/hr_expense/models/ir_attachment.py"", line 9, in create
    attachments = super().create(vals_list)
  File ""<decorator-gen-262>"", line 2, in create
  File ""/home/odoo/src/odoo/odoo/api.py"", line 415, in _model_create_multi
    return create(self, arg)
  File ""/home/odoo/src/enterprise/documents/models/ir_attachment.py"", line 76, in create
    attachments = super().create(vals_list)
  File ""<decorator-gen-186>"", line 2, in create
  File ""/home/odoo/src/odoo/odoo/api.py"", line 415, in _model_create_multi
    return create(self, arg)
  File ""/home/odoo/src/odoo/addons/product/models/ir_attachment.py"", line 12, in create
    attachments = super().create(vals_list)
  File ""<decorator-gen-61>"", line 2, in create
  File ""/home/odoo/src/odoo/odoo/api.py"", line 415, in _model_create_multi
    return create(self, arg)
  File ""/home/odoo/src/odoo/odoo/addons/base/models/ir_attachment.py"", line 667, in create
    return super().create(vals_list)
  File ""<decorator-gen-214>"", line 2, in create
  File ""/home/odoo/src/odoo/odoo/api.py"", line 415, in _model_create_multi
    return create(self, arg)
  File ""/home/odoo/src/user/tracking_manager/models/models.py"", line 160, in create
    records = super().create(list_vals)
  File ""<decorator-gen-12>"", line 2, in create
  File ""/home/odoo/src/odoo/odoo/api.py"", line 415, in _model_create_multi
    return create(self, arg)
  File ""/home/odoo/src/odoo/odoo/models.py"", line 4646, in create
    records = self._create(data_list)
  File ""/home/odoo/src/odoo/odoo/models.py"", line 4813, in _create
    colval = field.convert_to_column(stored[fname], self, stored)
  File ""/home/odoo/src/odoo/odoo/fields.py"", line 2830, in convert_to_column
    value = self.convert_to_cache(value, record)
  File ""/home/odoo/src/odoo/odoo/fields.py"", line 2840, in convert_to_cache
    raise ValueError(""Wrong value for %s: %r"" % (self, value))
ValueError: Wrong value for ir.attachment.type: 'purchase'

The above server error caused the following client error:
RPC_ERROR: Odoo Server Error
    RPC_ERROR
        at makeErrorFromResponse (https://match-trade.odoo.com/web/assets/60d6fc5/web.assets_web.min.js:2918:163)
        at XMLHttpRequest.<anonymous> (https://match-trade.odoo.com/web/assets/60d6fc5/web.assets_web.min.js:2922:13)
```


this is happening when you  open purchase journal tree *from kanban only* - this opens a view of all purchase invoices in a tree view with search context set (type = 'purchase')

then in javascript, account.journal search context is being used while uploading ir.attachment:

https://github.com/odoo/odoo/blob/86d8b3c55073175a229286fa8a51684d3c72f038/addons/account/static/src/components/bills_upload/bills_upload.js#L39


```
const [att_id] = await this.orm.create(""ir.attachment"", [att_data], {
            context: { ...this.extraContext, ...this.env.searchModel.context },
        });
```

this is causing en error above

reported to support as #4512697 ",jerzyk,2025-01-24 10:35:46+00:00,[],2025-01-24 10:35:46+00:00,,https://github.com/odoo/odoo/issues/195002,[],[],
2804993411,issue,open,,[17.0] l10n_cl: OwlError: Invalid props for component 'SettingsBlock': 'slots' is missing (should be a object),"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- Install `l10n_cl`
- Go with CL Company
- Activate debug mode
- Go to Settings -> Invoicing

Current behaviour:

![Image](https://github.com/user-attachments/assets/24b5d4cd-4c2b-453b-91c5-bdbb779645f7)

Expected behaviour:

Be able to enter Invoicing settings while developer mode is activated.

### Log Output

```shell
UncaughtPromiseError > OwlError
Uncaught Promise > Invalid props for component 'SettingsBlock': 'slots' is missing (should be a object)
OwlError: Invalid props for component 'SettingsBlock': 'slots' is missing (should be a object)
    Error: Invalid props for component 'SettingsBlock': 'slots' is missing (should be a object)
        at Object.validateProps (https://73779121-17-0.runbot172.odoo.com/web/assets/789be36/web.assets_web.min.js:1152:67)
        at SettingsFormRenderer.slot97 (eval at compile (https://73779121-17-0.runbot172.odoo.com/web/assets/789be36/web.assets_web.min.js:1528:421), <anonymous>:1483:15)
        at callSlot (https://73779121-17-0.runbot172.odoo.com/web/assets/789be36/web.assets_web.min.js:1119:25)
        at SettingsApp.template (eval at compile (https://73779121-17-0.runbot172.odoo.com/web/assets/789be36/web.assets_web.min.js:1528:421), <anonymous>:23:12)
        at Fiber._render (https://73779121-17-0.runbot172.odoo.com/web/assets/789be36/web.assets_web.min.js:949:96)
        at Fiber.render (https://73779121-17-0.runbot172.odoo.com/web/assets/789be36/web.assets_web.min.js:948:6)
        at ComponentNode.updateAndRender (https://73779121-17-0.runbot172.odoo.com/web/assets/789be36/web.assets_web.min.js:1038:29)
```

### Support Ticket

_No response_",sergiobstoj,2025-01-22 17:45:43+00:00,[],2025-01-23 08:18:22+00:00,,https://github.com/odoo/odoo/issues/194746,[],"[{'comment_id': 2608992319, 'issue_id': 2804993411, 'author': 'Ramil001', 'body': 'The issue is likely caused by incorrect inheritance of res.config.settings. It often happens when someone modifies the XML and accidentally hides the wrong element, leading to an error', 'created_at': datetime.datetime(2025, 1, 23, 6, 48, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2609129823, 'issue_id': 2804993411, 'author': 'sergiobstoj', 'body': ""Thanks, I'll try to fix it myself when I get the time."", 'created_at': datetime.datetime(2025, 1, 23, 8, 18, 22, tzinfo=datetime.timezone.utc)}]","Ramil001 on (2025-01-23 06:48:49 UTC): The issue is likely caused by incorrect inheritance of res.config.settings. It often happens when someone modifies the XML and accidentally hides the wrong element, leading to an error

sergiobstoj (Issue Creator) on (2025-01-23 08:18:22 UTC): Thanks, I'll try to fix it myself when I get the time.

"
2804574841,issue,open,,"[16.0] sale_project: AmbiguousColumn: column reference ""analytic_distribution"" is ambiguous","### Odoo Version

- [x] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

This happens when the `invoice_count` field is shown, but specifically, I could see this one happening and easy to reproduce, when a project computes the mentioned field.

1. Go to Projects
2. Click the 3 dots to open dropdown menu
3. Click ""Project updates""

### Log Output

```shell
File ""/opt/odoo/addons/sale_project/models/project.py"", line 111, in _compute_invoice_count
    self._cr.execute(query_string, query_param)
  File ""/opt/odoo/odoo/sql_db.py"", line 321, in execute
    res = self._obj.execute(query, params)
psycopg2.errors.AmbiguousColumn: column reference ""analytic_distribution"" is ambiguous LINE 1: ... OR ""account_move_line"".""company_id"" IS NULL) AND analytic_d...



2025-01-22 13:03:38,697 3479916 ERROR odoo odoo.sql_db: bad query: SELECT jsonb_object_keys(account_move_line.analytic_distribution) as account_id, COUNT(DISTINCT move_id) as move_count FROM ""account_move_line"" LEFT JOIN ""account_move"" AS ""account_move_line__move_id"" ON (""account_move_line"".""move_id"" = ""account_move_line__move_id"".""id"") WHERE (""account_move_line__move_id"".""move_type"" in ('out_invoice', 'out_refund')) AND ((""account_move_line"".""company_id"" in (1)) OR ""account_move_line"".""company_id"" IS NULL) AND analytic_distribution ?| ARRAY['4375'] GROUP BY jsonb_object_keys(account_move_line.analytic_distribution)
```

### Support Ticket

_No response_",hnavarro-kernet,2025-01-22 14:42:01+00:00,[],2025-01-31 07:33:26+00:00,,https://github.com/odoo/odoo/issues/194727,[],"[{'comment_id': 2607435243, 'issue_id': 2804574841, 'author': 'hnavarro-kernet', 'body': ""I'll provide a patch to [fix the reference here](https://github.com/odoo/odoo/blob/89b59f23e5db66c1c7a469cb06424264a275a5e8/addons/sale_project/models/project.py#L104) when possible, but if anyone wants to take it feel free to do so."", 'created_at': datetime.datetime(2025, 1, 22, 14, 43, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2609271184, 'issue_id': 2804574841, 'author': 'hnavarro-kernet', 'body': 'Noticed another 2 references:\n[action_open_project_invoices](https://github.com/odoo/odoo/blob/89b59f23e5db66c1c7a469cb06424264a275a5e8/addons/sale_project/models/project.py#L187)\n[action_open_project_vendor_bills](https://github.com/odoo/odoo/blob/89b59f23e5db66c1c7a469cb06424264a275a5e8/addons/sale_project/models/project.py#L603)', 'created_at': datetime.datetime(2025, 1, 23, 9, 17, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2624178127, 'issue_id': 2804574841, 'author': 'Paulius11', 'body': 'I also encounter this in 17.0 in project module, when clicking ""Project Status""\n@hnavarro-kernet  do you have any idea causing this?\n\n![Image](https://github.com/user-attachments/assets/9ba84a89-6a9c-47c1-9553-b61ec7b86b5f)', 'created_at': datetime.datetime(2025, 1, 30, 11, 3, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2626484634, 'issue_id': 2804574841, 'author': 'Paulius11', 'body': 'this fix can be done\n\n```\n def _compute_invoice_count(self):\n        _logger.info(""Starting invoice count computation for projects: %s"", self.mapped(\'name\'))\n        \n        try:\n            # Build list of analytic account IDs\n            analytic_ids = [str(project.analytic_account_id.id) for project in self if project.analytic_account_id]\n            _logger.info(""Analytic account IDs: %s"", analytic_ids)\n            \n            if not analytic_ids:\n                _logger.info(""No analytic accounts found. Setting all invoice counts to 0"")\n                for project in self:\n                    project.invoice_count = 0\n                return\n\n            # Correct query with array operator\n            query = """"""\n                SELECT aml.analytic_distribution::text as dist, COUNT(DISTINCT aml.move_id) as count\n                FROM account_move_line aml\n                JOIN account_move am ON am.id = aml.move_id\n                WHERE am.move_type IN (\'out_invoice\', \'out_refund\')\n                AND aml.analytic_distribution ?| array[%s]\n                GROUP BY aml.analytic_distribution\n            """""" % \',\'.join([\'%s\'] * len(analytic_ids))\n\n            _logger.info(""Executing query with params: %s"", analytic_ids)\n            self.env.cr.execute(query, analytic_ids)\n            result = self.env.cr.dictfetchall()\n            _logger.info(""Query result: %s"", result)\n\n            # Process results\n            counts = {str(project.analytic_account_id.id): 0 for project in self if project.analytic_account_id}\n            for row in result:\n                for analytic_id in analytic_ids:\n                    if analytic_id in row[\'dist\']:\n                        counts[analytic_id] = row[\'count\']\n\n            # Set counts on projects\n            for project in self:\n                if project.analytic_account_id:\n                    count = counts.get(str(project.analytic_account_id.id), 0)\n                    _logger.info(""Setting invoice count for project %s: %s"", project.name, count)\n                    project.invoice_count = count\n                else:\n                    project.invoice_count = 0\n\n        except Exception as e:\n            _logger.error(""Error in _compute_invoice_count: %s"", str(e), exc_info=True)\n            for project in self:\n                project.invoice_count = 0\n\n        _logger.info(""Completed invoice count computation"")\n```', 'created_at': datetime.datetime(2025, 1, 31, 7, 32, 58, tzinfo=datetime.timezone.utc)}]","hnavarro-kernet (Issue Creator) on (2025-01-22 14:43:22 UTC): I'll provide a patch to [fix the reference here](https://github.com/odoo/odoo/blob/89b59f23e5db66c1c7a469cb06424264a275a5e8/addons/sale_project/models/project.py#L104) when possible, but if anyone wants to take it feel free to do so.

hnavarro-kernet (Issue Creator) on (2025-01-23 09:17:25 UTC): Noticed another 2 references:
[action_open_project_invoices](https://github.com/odoo/odoo/blob/89b59f23e5db66c1c7a469cb06424264a275a5e8/addons/sale_project/models/project.py#L187)
[action_open_project_vendor_bills](https://github.com/odoo/odoo/blob/89b59f23e5db66c1c7a469cb06424264a275a5e8/addons/sale_project/models/project.py#L603)

Paulius11 on (2025-01-30 11:03:43 UTC): I also encounter this in 17.0 in project module, when clicking ""Project Status""
@hnavarro-kernet  do you have any idea causing this?

![Image](https://github.com/user-attachments/assets/9ba84a89-6a9c-47c1-9553-b61ec7b86b5f)

Paulius11 on (2025-01-31 07:32:58 UTC): this fix can be done

```
 def _compute_invoice_count(self):
        _logger.info(""Starting invoice count computation for projects: %s"", self.mapped('name'))
        
        try:
            # Build list of analytic account IDs
            analytic_ids = [str(project.analytic_account_id.id) for project in self if project.analytic_account_id]
            _logger.info(""Analytic account IDs: %s"", analytic_ids)
            
            if not analytic_ids:
                _logger.info(""No analytic accounts found. Setting all invoice counts to 0"")
                for project in self:
                    project.invoice_count = 0
                return

            # Correct query with array operator
            query = """"""
                SELECT aml.analytic_distribution::text as dist, COUNT(DISTINCT aml.move_id) as count
                FROM account_move_line aml
                JOIN account_move am ON am.id = aml.move_id
                WHERE am.move_type IN ('out_invoice', 'out_refund')
                AND aml.analytic_distribution ?| array[%s]
                GROUP BY aml.analytic_distribution
            """""" % ','.join(['%s'] * len(analytic_ids))

            _logger.info(""Executing query with params: %s"", analytic_ids)
            self.env.cr.execute(query, analytic_ids)
            result = self.env.cr.dictfetchall()
            _logger.info(""Query result: %s"", result)

            # Process results
            counts = {str(project.analytic_account_id.id): 0 for project in self if project.analytic_account_id}
            for row in result:
                for analytic_id in analytic_ids:
                    if analytic_id in row['dist']:
                        counts[analytic_id] = row['count']

            # Set counts on projects
            for project in self:
                if project.analytic_account_id:
                    count = counts.get(str(project.analytic_account_id.id), 0)
                    _logger.info(""Setting invoice count for project %s: %s"", project.name, count)
                    project.invoice_count = count
                else:
                    project.invoice_count = 0

        except Exception as e:
            _logger.error(""Error in _compute_invoice_count: %s"", str(e), exc_info=True)
            for project in self:
                project.invoice_count = 0

        _logger.info(""Completed invoice count computation"")
```

"
2804054596,issue,open,,[18.0] module: description,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

2~3 days ago I contented an error once I tried to open a product page. A message appears saying that an error happened and the user should contact the support team.

THE ERROR ONLY APPEARS WHEN I VISIT THE WEBSITE WITHOUT LOGIN.

I can just close the msg and continue what I'm doing. But for professional reasons  I would like to stop this message.

I also noticed that when I'm logged the id o_wsale_cta_wrapper is there and has been called from the wish list:

<div id=""o_wsale_cta_wrapper"" class=""d-flex flex-wrap align-items-center"">


but once I'm not logged the wish list is logically not there and on the debugger I can find the error here:
const $addQtyInput=$parent.find('input[name=""add_qty""]');let qty=$addQtyInput.val();let ctaWrapper=$parent[0].querySelector('#o_wsale_cta_wrapper');ctaWrapper.classList.replace('d-none','d-flex');ctaWrapper.classList.remove('out_of_stock');if(combination.is_storable&&!combination.allow_out_of_stock_order){combination.free_qty-=parseInt(combination.cart_qty);$addQtyInput.data('max',combination.free_qty||1);if(combination.free_qty<0){combination.free_qty=0;}

### Log Output

```shell
Something went wrong... If you really are stuck, share the report with your friendly support service

UncaughtPromiseError > TypeError


Uncaught Promise > ctaWrapper is null


Occured on [sedessi.de](http://sedessi.de/) on 2025-01-22 10:34:45 GMT


TypeError: ctaWrapper is null

    VariantMixin._onChangeCombinationStock@https://sedessi.de/web/assets/1/e82251d/web.assets_frontend_lazy.min.js:11856:149

    VariantMixin._onChangeCombinationStock@https://sedessi.de/web/assets/1/e82251d/web.assets_frontend_lazy.min.js:11892:464

    VariantMixin._onChangeCombinationStock@https://sedessi.de/web/assets/1/e82251d/web.assets_frontend_lazy.min.js:11934:558

    _onChangeCombination@https://sedessi.de/web/assets/1/e82251d/web.assets_frontend_lazy.min.js:11860:512

    OdooClass.extend/Class.include/</prototype[name]@https://sedessi.de/web/assets/1/e82251d/web.assets_frontend_lazy.min.js:3068:375

    _onChangeCombination@https://sedessi.de/web/assets/1/e82251d/web.assets_frontend_lazy.min.js:11896:390

    OdooClass.extend/Class.include/</prototype[name]@https://sedessi.de/web/assets/1/e82251d/web.assets_frontend_lazy.min.js:3068:375

    _getCombinationInfo/<@https://sedessi.de/web/assets/1/e82251d/web.assets_frontend_lazy.min.js:8887:6
```

### Support Ticket

_No response_",U-L-M-S,2025-01-22 10:52:40+00:00,[],2025-01-22 11:44:24+00:00,,https://github.com/odoo/odoo/issues/194679,[],[],
2803903624,issue,open,,[17.0] point_of_sale: PoS Config ValueError: Expected singleton (while generating multiple pos.config at once),"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Hello,
When I try to create multiple pos. configs at once I get an error
ValueError(""Expected singleton: %s"" % self)


The method that causes the problem is:

@api.constrains('payment_method_ids')
    def _check_payment_method_ids_journal(self):
        for cash_method in self.payment_method_ids.filtered(lambda m: m.journal_id.type == 'cash'):
            ...

Please update the method so it will start looping through configs first.

It should be something like this.

@api.constrains('payment_method_ids')
    def _check_payment_method_ids_journal(self):
        for config in self:
            for cash_method in config.payment_method_ids.filtered(lambda m: m.journal_id.type == 'cash'):
                ...

Best regards



### Log Output

```shell

```

### Support Ticket

_No response_",erkin-rozimuradov,2025-01-22 09:48:00+00:00,[],2025-01-22 09:48:00+00:00,,https://github.com/odoo/odoo/issues/194668,[],[],
2802709409,issue,open,,[16.0] web: Custom footer expires the second time a user opens the form view of a X2many field in create mode,"### Odoo Version

- [x] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

## Steps to Reproduce
Make a form view like this
```xml
<form>
    <field
        name=""line_ids""
        nolabel=""1""
        readonly=""1""
    >
        <tree>
            <field name=""field_1"" />
            <field name=""field_2"" />
        </tree>
        <form>
            <header>
            </header>
            <sheet>
                <field name=""line_field_1"" />
                <field name=""line_field_2"" />
            </sheet>
            <footer />
        </form>
    </field>
</form>
```
## Current behaviour
If you open the form view dialog of a record in the One2many/Many2many, the first time the footer is empty, the second time has the action buttons
## Expected behaviour
The footer should always be empty

## Possible problem
I think the problem can be in these lines because from the javascript debugger i saw that the second time the record is opened the ```<footer />``` tag is not in this.archInfo anymore:
https://github.com/odoo/odoo/blob/fa066bcd1bb4d69ef1474764a77a2e7bd7019c23/addons/web/static/src/views/fields/relational_utils.js#L469-L480

Video/Screenshot link (optional):

https://github.com/user-attachments/assets/6c164bcd-6b65-4827-9473-304c7d2b21bb

### Log Output

```shell

```

### Support Ticket

_No response_",TheClaud99,2025-01-21 20:06:28+00:00,[],2025-01-21 20:09:06+00:00,,https://github.com/odoo/odoo/issues/194636,[],[],
2801811397,issue,open,,[17.0] The community version has modules with an enterprise license,"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Hello,

In modules `account_payment_term` and `l10n_it_edi_website_sale`  their  `__manifest__.py` contains : 'OEEL-1' (Enterprise Edition) License.
Is that normal?

Best regards

### Log Output

```shell

```

### Support Ticket

_No response_",JohnDev831,2025-01-21 13:09:32+00:00,[],2025-01-25 19:02:45+00:00,,https://github.com/odoo/odoo/issues/194532,[],"[{'comment_id': 2614067571, 'issue_id': 2801811397, 'author': 'Ewetoye', 'body': 'It should have been `LGPL-3`', 'created_at': datetime.datetime(2025, 1, 25, 19, 2, 44, tzinfo=datetime.timezone.utc)}]","Ewetoye on (2025-01-25 19:02:44 UTC): It should have been `LGPL-3`

"
2801534047,issue,open,,[18.0] module: Error when updating schedule date on a manufacture order,"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

whiile updating schedule date on an MO the error in the log output is given.
the update on 906 in mr_production.py file in mrp module as below can fix this:

date_format = ""%d/%m/%Y %H:%M:%S""
            date_start_map = {
                prod: datetime.strptime(vals['date_start'], date_format) - datetime.timedelta(days=prod.bom_id.produce_delay)
                if prod.bom_id else vals['date_start']
                for prod in self
            }

### Log Output

```shell
Odoo Server Error

RPC_ERROR
Odoo Server Error

Occured on 73697685-18-0-all.runbot117.odoo.com on model mrp.production and id 16 on 2025-01-21 11:21:45 GMT

Traceback (most recent call last):
  File ""/data/build/odoo/odoo/http.py"", line 1957, in _transactioning
    return service_model.retrying(func, env=self.env)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/build/odoo/odoo/service/model.py"", line 137, in retrying
    result = func()
             ^^^^^^
  File ""/data/build/odoo/odoo/http.py"", line 1924, in _serve_ir_http
    response = self.dispatcher.dispatch(rule.endpoint, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/build/odoo/odoo/http.py"", line 2171, in dispatch
    result = self.request.registry['ir.http']._dispatch(endpoint)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/build/odoo/odoo/addons/base/models/ir_http.py"", line 329, in _dispatch
    result = endpoint(**request.params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/build/odoo/odoo/http.py"", line 727, in route_wrapper
    result = endpoint(self, *args, **params_ok)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/build/odoo/addons/web/controllers/dataset.py"", line 35, in call_kw
    return call_kw(request.env[model], method, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/build/odoo/odoo/api.py"", line 517, in call_kw
    result = getattr(recs, name)(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/data/build/odoo/addons/web/models/models.py"", line 70, in web_save
    self.write(vals)
  File ""/data/build/odoo/addons/project_mrp_account/models/mrp_production.py"", line 28, in write
    res = super().write(vals)
          ^^^^^^^^^^^^^^^^^^^
  File ""/data/build/odoo/addons/mrp_subcontracting/models/mrp_production.py"", line 52, in write
    return super().write(vals)
           ^^^^^^^^^^^^^^^^^^^
  File ""/data/build/odoo/addons/mrp_account/models/mrp_production.py"", line 21, in write
    res = super().write(vals)
          ^^^^^^^^^^^^^^^^^^^
  File ""/data/build/odoo/addons/mrp/models/mrp_production.py"", line 907, in write
    prod: vals['date_start'] - datetime.timedelta(days=prod.bom_id.produce_delay)
          ~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'str' and 'datetime.timedelta'

The above server error caused the following client error:
RPC_ERROR: Odoo Server Error
    RPC_ERROR
        at makeErrorFromResponse (https://73697685-18-0-all.runbot117.odoo.com/web/assets/6f76221/web.assets_web.min.js:3124:163)
        at XMLHttpRequest.<anonymous> (https://73697685-18-0-all.runbot117.odoo.com/web/assets/6f76221/web.assets_web.min.js:3129:13)
```

### Support Ticket

_No response_",oplt,2025-01-21 11:25:23+00:00,[],2025-01-21 19:38:08+00:00,,https://github.com/odoo/odoo/issues/194502,[],"[{'comment_id': 2604514658, 'issue_id': 2801534047, 'author': 'oplt', 'body': 'fix can be found here:\nhttps://github.com/odoo/odoo/commit/865858b8b03551f8512fd5d4503139c308ca1a91', 'created_at': datetime.datetime(2025, 1, 21, 11, 52, 1, tzinfo=datetime.timezone.utc)}]","oplt (Issue Creator) on (2025-01-21 11:52:01 UTC): fix can be found here:
https://github.com/odoo/odoo/commit/865858b8b03551f8512fd5d4503139c308ca1a91

"
2800384123,issue,open,,[17.0] appointment: User can not create an appointment when not logged in,"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

When I create an appointment through the website, and i am NOT logged in, I get the error, that I need to log in in order to create an appointment.

ERROR: Please connect to book the appointment

Here is the bug:

file: appointment/controllers/appointment.py  

  if customer:
            if customer.user_ids:
                if request.env.user._is_public() or request.env.user not in customer.user_ids:
                    raise UserError(_('Please connect to book the appointment'))


You need to tell the user first to register & login or accept anonymous bookings. The way ODOO works here is just confusing!

### Log Output

```shell

```

### Support Ticket

_No response_",AquaMCU,2025-01-20 22:59:07+00:00,[],2025-01-20 22:59:07+00:00,,https://github.com/odoo/odoo/issues/194455,[],[],
2799883432,issue,open,,[18.0] module: description,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

[requirements.txt](https://github.com/odoo/odoo/commit/2bb7d9bc619b93b26f8685d9537764a022c79736)

In this particular merge the `rl-renderPM` package is not included in the `requirements.txt` file any more (for Linux machines running python 3.12 or later).
This causes errors when creating a virtual environment and not installing the `rl-renderPM` package manually after installing using requirements.txt.

Is it possible to re-add this package again to the requirements?
Or what is the reasoning for not including it in the requirements for Linux?

### Log Output

```shell

```

### Support Ticket

_No response_",SonoDavid,2025-01-20 16:51:42+00:00,[],2025-01-20 16:51:42+00:00,,https://github.com/odoo/odoo/issues/194418,[],[],
2799083184,issue,open,,"[16.0] account: When converting an invoice to a credit note, the Fiscal Position is not carried over","### Odoo Version

- [x] 16.0
- [x] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

**Current behaviour:**
When converting an invoice to a credit note, all data is transferred except for the Fiscal Position, which is not carried over.

**Expected behaviour:**
The Fiscal Position should be retained when converting an invoice to a credit note, ensuring consistency in tax application.

**Video/Screenshot link (optional):**
https://drive.google.com/file/d/17ilmwOHmEK5TCNHdflVOeFXn65D0xEzy/view


**Steps to Reproduce:**

1 - Go to Customer Invoices and create a new invoice.
2 - Fill in all the necessary details, including the Fiscal Position.
3 - Click on Switch into Invoice/Credit Note to convert the invoice into a credit note.
4 - Observe that all data is transferred except for the Fiscal Position, which is missing.

### Log Output

```shell

```

### Support Ticket

_No response_",rov-adhoc,2025-01-20 12:04:02+00:00,[],2025-01-20 12:04:18+00:00,,https://github.com/odoo/odoo/issues/194357,[],[],
2798905705,issue,open,,[18.0] products: attributes auto populate all available values,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

What are the steps to reproduce your errors?
Add attribute to product

What is the current behavior you observe?
All available values for attribute are auto populated

Without the issue, what would you expect the behavior/result to be?
No attributes preselected, to chose the one needed (as in 17/17.4)

Go to sales -> configuration -> Attributes, add attribute with values and Variant Creation set to Never.
Go to sales -> products -> add the newly created attribute to a product, all values are automatic added.

If you use attributes for filtering in ecommerce or use it for listing data on website  for example MPN (Manufacturer part number) this is not an behavior that is not wanted / expected.
I can't think of a case where there is a logical use where all values for a attribute should be added if the ""variant creation"" is never. 
To add several values if needed you could use the check box in ""search more"" to add all values.
To delete all those values could take for ever.


I tried reporting this to support (#4,467,063), but I feel they don't have the user experience and competence to understand the usage, and I just got an answer that this is a new feature in V18:
> This is a new feature introduced in Odoo designed to enhance user efficiency. When the ""Variant Creation"" option is set to ""Never,"" the system automatically assigns all available attribute values to a product template. This feature is particularly useful for businesses with extensive attribute lists, where manually adding or removing hundreds of values individually would be time-consuming. With this functionality, users can apply all attribute values to a product template simultaneously, saving significant time and effort.
>


### Log Output

```shell

```

### Support Ticket

4467063",oewean,2025-01-20 10:48:32+00:00,[],2025-02-06 09:21:00+00:00,,https://github.com/odoo/odoo/issues/194346,[],[],
2798648840,issue,open,,[17.0] mrp: fix error unsupported operand type(s) for -: 'str' and 'datetime.timedelta',"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Changing the date on production this error appears
`unsupported operand type(s) for -: 'str' and 'datetime.timedelta'`



This is the fix https://github.com/odoo/odoo/pull/194325

",micheledic,2025-01-20 09:07:21+00:00,[],2025-01-20 09:07:30+00:00,,https://github.com/odoo/odoo/issues/194327,[],[],
2797787155,issue,open,,[18.0] module: description,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

1- Install an e-commerce app and load demo data or create a product to sell on the website.
2- Go to the website / shop and open a product page.
3- Go to Edit mode and then open the ""CUSTOMIZE"" tab, and then enable ""Rating"" to add the ""Customer Reviews"" section at the bottom of the product page. And exit Edit mode.
4- Write a sample review for the product and send it.
5- Log out from the website and view that product page as a normal website visitor (public user).
6- If you hover your mouse over that sample product review to reveal the emoji icon.
7- Click on an emoji in any previously sent Customer Reviews as a public website visitor, and boom; you will face the server error.

### Log Output

```shell
RPC_ERROR

404: Not Found

Occured on demo4.odoo.com on 2025-01-19 19:10:54 GMT

Traceback (most recent call last):
  File ""/home/odoo/src/odoo/18.0/odoo/http.py"", line 1957, in _transactioning
    return service_model.retrying(func, env=self.env)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/18.0/odoo/service/model.py"", line 137, in retrying
    result = func()
             ^^^^^^
  File ""/home/odoo/src/odoo/18.0/odoo/http.py"", line 1924, in _serve_ir_http
    response = self.dispatcher.dispatch(rule.endpoint, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/18.0/odoo/http.py"", line 2171, in dispatch
    result = self.request.registry['ir.http']._dispatch(endpoint)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/18.0/odoo/addons/base/models/ir_http.py"", line 329, in _dispatch
    result = endpoint(**request.params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/18.0/odoo/http.py"", line 727, in route_wrapper
    result = endpoint(self, *args, **params_ok)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/18.0/addons/mail/models/discuss/mail_guest.py"", line 38, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/home/odoo/src/odoo/18.0/addons/mail/controllers/message_reaction.py"", line 20, in mail_message_reaction
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.

The above server error caused the following client error:
RPC_ERROR: 404: Not Found
    RPC_ERROR
        at makeErrorFromResponse (https://demo4.odoo.com/web/assets/1/8d7413f/web.assets_frontend_lazy.min.js:4492:163)
        at XMLHttpRequest.<anonymous> (https://demo4.odoo.com/web/assets/1/8d7413f/web.assets_frontend_lazy.min.js:4497:13)
```

### Support Ticket

_No response_",hajkhurus,2025-01-19 19:19:33+00:00,[],2025-01-19 19:19:33+00:00,,https://github.com/odoo/odoo/issues/194309,[],[],
2797707612,issue,open,,TypeError: 'NoneType' object is not subscriptable when validating stock move,"Missing check for None before subscribing result of `self.carrier_id.send_shipping`:

https://github.com/odoo/odoo/blob/ff3ed3bdd5c9ab5b0606037916db36ddad4a8045/addons/stock_delivery/models/stock_picking.py#L148

If a carrier does not implement the `send_shipping` method (such as websites_sale_collect) this results in an exception (see details below), as `send_shipping` in `DeliveryCarrier` base does not return anything (i.e. None) in that case:

https://github.com/odoo/odoo/blob/ff3ed3bdd5c9ab5b0606037916db36ddad4a8045/addons/stock_delivery/models/delivery_carrier.py#L35-L48

<details><summary>Details</summary>
<p>

```
RPC_ERROR

Odoo Server Error

Occured on test.hola-colombia.eu on model stock.picking and id 10 on 2025-01-19 13:41:54 GMT

Traceback (most recent call last):
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/http.py"", line 1957, in _transactioning
    return service_model.retrying(func, env=self.env)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/service/model.py"", line 137, in retrying
    result = func()
             ^^^^^^
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/http.py"", line 1924, in _serve_ir_http
    response = self.dispatcher.dispatch(rule.endpoint, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/http.py"", line 2171, in dispatch
    result = self.request.registry['ir.http']._dispatch(endpoint)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/addons/base/models/ir_http.py"", line 329, in _dispatch
    result = endpoint(**request.params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/http.py"", line 727, in route_wrapper
    result = endpoint(self, *args, **params_ok)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/addons/web/controllers/dataset.py"", line 40, in call_button
    action = call_kw(request.env[model], method, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/api.py"", line 517, in call_kw
    result = getattr(recs, name)(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/hola-colombia-addons/stock_picking_auto_create_lot/models/stock_picking.py"", line 38, in button_validate
    return super().button_validate()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/addons/stock/models/stock_picking.py"", line 1415, in button_validate
    pickings_to_backorder.with_context(cancel_backorder=False)._action_done()
  File ""/opt/odoo/hola-colombia-addons/excise_duty/models/stock_picking.py"", line 101, in _action_done
    res = super()._action_done()
          ^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/addons/sale_stock/models/stock.py"", line 120, in _action_done
    res = super()._action_done()
          ^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/hola-colombia-addons/stock_picking_auto_create_lot/models/stock_picking.py"", line 34, in _action_done
    return super()._action_done()
           ^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/addons/point_of_sale/models/stock_picking.py"", line 123, in _action_done
    res = super()._action_done()
          ^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/addons/stock/models/stock_picking.py"", line 1251, in _action_done
    self._send_confirmation_email()
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/addons/stock_delivery/models/stock_picking.py"", line 82, in _send_confirmation_email
    pick.sudo().send_to_shipper()
  File ""/opt/odoo/odoo-18.0+e.20250112/odoo/addons/stock_delivery/models/stock_picking.py"", line 148, in send_to_shipper
    res = self.carrier_id.send_shipping(self)[0]
          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
TypeError: 'NoneType' object is not subscriptable

The above server error caused the following client error:
RPC_ERROR: Odoo Server Error
    RPCError@https://test.hola-colombia.eu/web/assets/39cab8d/web.assets_web.min.js:3113:343
    makeErrorFromResponse@https://test.hola-colombia.eu/web/assets/39cab8d/web.assets_web.min.js:3116:175
    @https://test.hola-colombia.eu/web/assets/39cab8d/web.assets_web.min.js:3121:34
```
</p>
</details>  ",8191,2025-01-19 16:20:26+00:00,[],2025-01-31 11:06:58+00:00,,https://github.com/odoo/odoo/issues/194306,[],"[{'comment_id': 2626945268, 'issue_id': 2797707612, 'author': 'bharmal4devnet', 'body': 'same error is their any solution', 'created_at': datetime.datetime(2025, 1, 31, 11, 6, 57, tzinfo=datetime.timezone.utc)}]","bharmal4devnet on (2025-01-31 11:06:57 UTC): same error is their any solution

"
2797220546,issue,closed,completed,[18.0] account Asset: create asset model raise an error,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

 
- Make sure your Odoo 18.0 code is updated to latest bug fix.
- Go to asset model and create a new once.
- Try to save it, ""You cannot add or remove bills when the asset is already running or closed"" error prevent you to save the asset model.



### Support Ticket
4497376
",MohsenWaleed,2025-01-18 21:47:48+00:00,[],2025-01-26 14:35:47+00:00,2025-01-22 14:21:25+00:00,https://github.com/odoo/odoo/issues/194293,[],"[{'comment_id': 2600922351, 'issue_id': 2797220546, 'author': 'eng-sultanHanga', 'body': 'same problem with every odoo online database i created', 'created_at': datetime.datetime(2025, 1, 19, 16, 0, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2600922484, 'issue_id': 2797220546, 'author': 'eng-sultanHanga', 'body': 'any fix yet', 'created_at': datetime.datetime(2025, 1, 19, 16, 0, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2602159559, 'issue_id': 2797220546, 'author': 'ripon3641', 'body': 'Same Problem in my database.', 'created_at': datetime.datetime(2025, 1, 20, 11, 22, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2602174950, 'issue_id': 2797220546, 'author': 'MohsenWaleed', 'body': '@ripon3641 @eng-sultanHanga \nYes, this is a bug for all Odoo 18.0 EE customers who have the update of 20-01-2025.\n\nI will open a ticket and update you.', 'created_at': datetime.datetime(2025, 1, 20, 11, 30, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603533054, 'issue_id': 2797220546, 'author': 'michaelsusanto81', 'body': 'encountered same problem with Odoo 16.0 EE database 🙏', 'created_at': datetime.datetime(2025, 1, 21, 3, 9, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603741847, 'issue_id': 2797220546, 'author': 'ahioz', 'body': 'Same problem\nOdoo 17.0+e (Enterprise Edition)', 'created_at': datetime.datetime(2025, 1, 21, 6, 8, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603782095, 'issue_id': 2797220546, 'author': 'jidariat', 'body': 'Hi, I face this problem but I am trying to import the assets model without accounts after that I added the accounts manually and working', 'created_at': datetime.datetime(2025, 1, 21, 6, 40, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2604306355, 'issue_id': 2797220546, 'author': 'MohsenWaleed', 'body': 'I sent a support ticket and got the below reply:\n\n> Thank you for contacting Odoo support. \n> \n> Thank you for your feedback regarding the issue you encountered. I want to assure you that our team is aware of the problem and is actively working on a solution.\n> \n> I will keep you informed as soon as I receive any updates or further information from our team.', 'created_at': datetime.datetime(2025, 1, 21, 10, 22, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607294019, 'issue_id': 2797220546, 'author': 'Kwame-Abew', 'body': '> Hi, I face this problem but I am trying to import the assets model without accounts after that I added the accounts manually and working\n\ncan you send your asset model so i can use it to update mine, been struggling with it for days', 'created_at': datetime.datetime(2025, 1, 22, 13, 46, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607319694, 'issue_id': 2797220546, 'author': 'Kwame-Abew', 'body': '> > Hi, I face this problem but I am trying to import the assets model without accounts after that I added the accounts manually and working\n> \n> thanks that was really helpful, it worked', 'created_at': datetime.datetime(2025, 1, 22, 13, 57, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607379144, 'issue_id': 2797220546, 'author': 'vava-odoo', 'body': 'Hi @MohsenWaleed \nThe fix was merged in 16.0 earlier today and will be applied to more recent versions shortly.\nSorry for the inconvenience.', 'created_at': datetime.datetime(2025, 1, 22, 14, 21, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607384563, 'issue_id': 2797220546, 'author': 'MohsenWaleed', 'body': 'Hi @vava-odoo \nThanks for your efforts and update.', 'created_at': datetime.datetime(2025, 1, 22, 14, 23, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607501344, 'issue_id': 2797220546, 'author': 'abdtrust19991', 'body': 'i have same issue in odoo V17,\n how can resolve this issue?\n\nthanks', 'created_at': datetime.datetime(2025, 1, 22, 15, 8, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2614450487, 'issue_id': 2797220546, 'author': 'ahmedgetup', 'body': ""upload model by xlsx it's work"", 'created_at': datetime.datetime(2025, 1, 26, 14, 35, 46, tzinfo=datetime.timezone.utc)}]","eng-sultanHanga on (2025-01-19 16:00:13 UTC): same problem with every odoo online database i created

eng-sultanHanga on (2025-01-19 16:00:29 UTC): any fix yet

ripon3641 on (2025-01-20 11:22:58 UTC): Same Problem in my database.

MohsenWaleed (Issue Creator) on (2025-01-20 11:30:15 UTC): @ripon3641 @eng-sultanHanga 
Yes, this is a bug for all Odoo 18.0 EE customers who have the update of 20-01-2025.

I will open a ticket and update you.

michaelsusanto81 on (2025-01-21 03:09:43 UTC): encountered same problem with Odoo 16.0 EE database 🙏

ahioz on (2025-01-21 06:08:13 UTC): Same problem
Odoo 17.0+e (Enterprise Edition)

jidariat on (2025-01-21 06:40:14 UTC): Hi, I face this problem but I am trying to import the assets model without accounts after that I added the accounts manually and working

MohsenWaleed (Issue Creator) on (2025-01-21 10:22:12 UTC): I sent a support ticket and got the below reply:

Kwame-Abew on (2025-01-22 13:46:35 UTC): can you send your asset model so i can use it to update mine, been struggling with it for days

Kwame-Abew on (2025-01-22 13:57:35 UTC): 

vava-odoo on (2025-01-22 14:21:25 UTC): Hi @MohsenWaleed 
The fix was merged in 16.0 earlier today and will be applied to more recent versions shortly.
Sorry for the inconvenience.

MohsenWaleed (Issue Creator) on (2025-01-22 14:23:37 UTC): Hi @vava-odoo 
Thanks for your efforts and update.

abdtrust19991 on (2025-01-22 15:08:17 UTC): i have same issue in odoo V17,
 how can resolve this issue?

thanks

ahmedgetup on (2025-01-26 14:35:46 UTC): upload model by xlsx it's work

"
2796322315,issue,open,,[16.0] mrp: Cannot create / save production when user can access mrp.workorder but workorder_ids is invisible,"### Odoo Version

- [x] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- Activate routing in settings
- Create a new res.group that can create and access mrp.production, mrp.workorder, etc
- Create a new user being in this group
- Log in with this user and try to create a new production
 

### Log Output

```shell
Notes:
- Overriding the default mrp.production view and setting workorder_ids to visible allows to create the production without problem. However it is needed for a user just to be able to create productions without being allowed to view routing details.
```

### Support Ticket

_No response_",diggy128,2025-01-17 21:18:12+00:00,[],2025-01-17 21:18:18+00:00,,https://github.com/odoo/odoo/issues/194254,[],[],
2794880540,issue,open,,Odoo not working - no CSS on login page and blank screen post-login,"### Odoo Version

- [x] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

I cloned a project from GitLab that uses Docker to set up multiple services, including Odoo 16, PostgreSQL, a FastAPI backend, and a Next.js frontend.

The project works perfectly on my colleague's machine, but on my setup (macOS), and on another colleague's machine, we are facing the same issue:

The containers start successfully, and I can configure the database connection without any issues. However, when I try to access Odoo at http://localhost:8069/, I encounter the following problem:

  - The login page loads without CSS.
  - After entering valid credentials, I'am redirected to http://localhost:8069/web, but the page is completely blank.

What I Tried:

I attempted several fixes, but none resolved the issue:

1- Regenerating Odoo assets:

``` 
docker exec -it odoo bash
odoo --update=all --stop-after-init
docker-compose restart odoo
```

2- Checking permissions for mounted volumes:

```
sudo chmod -R 777 odoo_data
sudo chmod -R 777 odoo_source
sudo chmod -R 777 odoo_custom_addons
```
3- Clearing browser cache and trying in incognito mode.
4- Verifying Docker logs for errors (nothing unusual found).

docker-compose.yml (Relevant parts):

``` 
services:
  postgres_db:
    image: postgres:15
    container_name: postgres_db
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
      POSTGRES_DB: xiptelecom
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init_postgres_odoo.sql:/docker-entrypoint-initdb.d/init_postgres_odoo.sql
    ports:
      - ""5432:5432""

  pgadmin:
    image: dpage/pgadmin4
    container_name: pgadmin4_container
    restart: always
    ports:
      - ""5050:80""
    environment:
      PGADMIN_DEFAULT_EMAIL: admin@admin.com
      PGADMIN_DEFAULT_PASSWORD: admin
    volumes:
      - pgadmin_data:/var/lib/pgadmin

  backend:
    build:
      context: ./Backend
    container_name: backend
    command: uvicorn main:app --host 0.0.0.0 --port 8080 --reload
    volumes:
      - ./Backend:/app
    ports:
      - ""8080:8080""
    depends_on:
      - postgres_db

  frontend:
    build:
      context: ./Frontend
    container_name: frontend
    command: ""npm run dev""
    volumes:
      - ./Frontend:/app
    ports:
      - ""3000:3000""
    depends_on:
      - backend

  odoo:
    image: odoo:16
    container_name: odoo
    depends_on:
      - postgres_db
    ports:
      - ""8069:8069""
    environment:
      HOST: postgres_db
      USER: odoo_user # utilisateur postgres sql
      PASSWORD: odoo_password # mot de passe postgres sql
      DATABASE: odoo # nom de la bdd pour Odoo
      MASTER_PASSWORD: admin
    volumes:
      - odoo_data:/var/lib/odoo
      - ./odoo_source:/mnt/odoo_source # monte le dossier local
      - ./odoo.conf:/etc/odoo/odoo.conf # Ajout de la configuration locale
      - ./odoo_custom_addons:/mnt/extra-addons # répertoire local pour les modules Odoo personnalisés


volumes:
  postgres_data:
  pgadmin_data:
  odoo_data:
```

odoo.conf:

```
[options]
; Infos de connexion à la bdd
db_host = postgres_db
db_port = 5432
db_user = odoo_user
db_password = odoo_password
db_name = odoo

; Configuration des modules
addons_path = /mnt/odoo_source/addons,/mnt/extra-addons

; Autres paramètres
data_dir = /var/lib/odoo
admin_passwd = $pbkdf2-sha512$600000$DAEAQKjV2jsHYKwVIoQwpg$ScuSHwYyRuGfJqbi65UUajG/kN7E5DxptFq1S.hwATMA7o/Mfx7M2dftb4VLDYmR5T1SVgCRaAcd8iHZCJ2QKQ
xmlrpc_port = 8069
longpolling_port = 8072
logfile = /var/log/odoo/odoo.log
```

==> Logs & Errors:

No critical errors appear in the logs. The Odoo service starts without issues, and I can even configure the database.

Questions:

1. Why is the login page missing CSS? 
2. Why do I get a blank page after login (http://localhost:8069/web)? 
3. How can I debug and resolve this issue?

Any insights or troubleshooting steps would be greatly appreciated!

<img width=""459"" alt=""Image"" src=""https://github.com/user-attachments/assets/fe792f74-ea39-4311-bec0-72ec12cf62f5"" />

<img width=""459"" alt=""Image"" src=""https://github.com/user-attachments/assets/8519c6fc-69dd-4132-9e3f-455d648b39a3"" />



### Log Output

```shell

```

### Support Ticket

_No response_",McAchoox94,2025-01-17 08:36:40+00:00,[],2025-01-18 22:41:33+00:00,,https://github.com/odoo/odoo/issues/194073,[],"[{'comment_id': 2600225091, 'issue_id': 2794880540, 'author': 'john5000', 'body': 'Could be a out of date browser or incompatible browser.\nCheck the browser dev-tools to see what trouble it has pulling the assets.', 'created_at': datetime.datetime(2025, 1, 18, 22, 41, 32, tzinfo=datetime.timezone.utc)}]","john5000 on (2025-01-18 22:41:32 UTC): Could be a out of date browser or incompatible browser.
Check the browser dev-tools to see what trouble it has pulling the assets.

"
2794735984,issue,open,,Add Sinhala language,"### Odoo Version

- [x] 18.0

[HelaBasa](https://helabasa.yalu.lk) is a Translation & Localization service in Sri Lanka. We would like to translate the Odoo platform into Sinhala language. Can you please enable Sinhala for the following projects?

Our profile: https://app.transifex.com/user/profile/HelaBasa/

**Projects**
https://explore.transifex.com/odoo/odoo-s18-1/
https://explore.transifex.com/odoo/odoo-18/
https://explore.transifex.com/odoo/odoo-com/
https://explore.transifex.com/odoo/odoo-mobile/
https://explore.transifex.com/odoo/odoo-18-doc/

**Details**
Language: Sinhala (සිංහල)
Script: Sinhala (සිංහල)
Code: si (සිං)
Country: Sri Lanka (ශ්‍රී ලංකාව)

https://github.com/odoo/odoo/wiki/Translations
https://www.odoo.com/forum/help-1/where-to-submit-suggestion-for-new-features-for-next-versions-180040",wnilanka,2025-01-17 07:04:38+00:00,['oomsveta'],2025-01-29 17:12:38+00:00,,https://github.com/odoo/odoo/issues/194062,"[('Internationalization', 'about translations')]","[{'comment_id': 2597631109, 'issue_id': 2794735984, 'author': 'Yenthe666', 'body': '@mart-e :-)', 'created_at': datetime.datetime(2025, 1, 17, 7, 51, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2622253720, 'issue_id': 2794735984, 'author': 'wnilanka', 'body': '@oomsveta Would you kindly give me an update? If you add this language, we can move forward!', 'created_at': datetime.datetime(2025, 1, 29, 17, 12, 36, tzinfo=datetime.timezone.utc)}]","Yenthe666 on (2025-01-17 07:51:32 UTC): @mart-e :-)

wnilanka (Issue Creator) on (2025-01-29 17:12:36 UTC): @oomsveta Would you kindly give me an update? If you add this language, we can move forward!

"
2793082331,issue,closed,completed,[18.0] auth_oauth: werkzeug.http.parse_www_authenticate_header not present in werkzeug 3,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

The method `werkzeug.http.parse_www_authenticate_header` has been removed in werkzeug 3 and later.

For python 3.12, Odoo 18's requirements.txt uses werkzeug 3.0.1 that does not have that method.

It is used in auth_oauth, causing a misleading error `auth_signup not installed on database` when authenticating a new user with an oauth provider

https://github.com/odoo/odoo/blob/0faf168bbcbc66daeb58999a6222cd2c6d41134c/addons/auth_oauth/models/res_users.py#L36-L37


### Log Output

```shell

```

### Support Ticket

4489661",sbidoul,2025-01-16 15:27:04+00:00,[],2025-01-21 13:17:43+00:00,2025-01-21 13:17:42+00:00,https://github.com/odoo/odoo/issues/194002,[],[],
2792581771,issue,closed,completed,[17.0] Unmet dependencies error during migration,"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

The symptoms are basically the same as documented in issue https://github.com/odoo/odoo/issues/72703.

During migration of a database from v14 to v17, multiple custom modules have picked up additional dependencies. For example module ""account_move_line_purchase_info"" (OCA account-financial-tools) now depends additionally on module ""base_view_inheritance_extension"".
During migration of the custom modules, the pre-requisite module ""base_view_inheritance_extension"" does not automatically install failing the migration.

In short; 
1. Have active database
1. Install custom module *second*
1. Upgrade database (upgrade.odoo.com)
1. Create custom module *first*
1. Update module *second* having it depend on *first* in manifest
1. Finish migration of custom modules on migrated database from step 3.

Notice warning in upgrade log
```
28774 INFO ? odoo.modules.graph: module <second>: Unmet dependencies: <first>
ERROR <db> odoo.modules.loading: Some modules are not loaded, some dependencies or manifest may be missing: ['<second>', '<other modules that depend on *second* to be installed>'] 
```
The problematic thing being;
* inconsistent database information about the modules; *second* will be marked as state ""installed"" + i cannot install missing modules from command line
* incomplete migrated data of module *second*; old version of views/models are inside the database
* **missing** migration of all modules that depend on *second* being installed; the migration process is serial, the first error stops migration of everything after

I expect Odoo to automatically install and update dependencies of modules marked with state ""to upgrade"" during migration, in the proper dependency order.

### Log Output

```shell

```

Edit; The migration and odoo code i'm testing with uses these commits;
``` 
- repo: odoo/odoo.git
  branch: 41fdb024f348a0fdf05e16aec47ecbea93ebaacb
- repo: odoo/enterprise.git
  branch: ac7a4da627459c3eec10186317f269051d0ab5be
- repo: odoo/odoo-themes.git
  branch: 2743bb92769e1ed94b0527d9a5dd6729a2b9860f
```

### Support Ticket

https://www.odoo.com/my/tasks/4488814",Bert-Proesmans,2025-01-16 12:20:02+00:00,[],2025-01-17 10:18:57+00:00,2025-01-16 15:56:23+00:00,https://github.com/odoo/odoo/issues/193949,[],"[{'comment_id': 2596098476, 'issue_id': 2792581771, 'author': 'Bert-Proesmans', 'body': 'This eventually got resolved by paying more attention to the details.\n\n* Specifically use the upgrade action (-u) to update custom modules.\n  * Specifically name **all** the modules that introduce new dependencies as upgrade argument! (\\<second\\> in the snippet below)\n* Also check your server-wide modules for problems.\n\nEvery issue described above is now resolved, I can finish custom module migration. The example command automatically installs module *first*, also migrates module *second*, and finishes migration of all other custom modules that require *second* to be installed.\n```\n<odoo-path>/odoo-bin -d <database> -u <second>,<...>\n```', 'created_at': datetime.datetime(2025, 1, 16, 15, 56, 23, tzinfo=datetime.timezone.utc)}]","Bert-Proesmans (Issue Creator) on (2025-01-16 15:56:23 UTC): This eventually got resolved by paying more attention to the details.

* Specifically use the upgrade action (-u) to update custom modules.
  * Specifically name **all** the modules that introduce new dependencies as upgrade argument! (\<second\> in the snippet below)
* Also check your server-wide modules for problems.

Every issue described above is now resolved, I can finish custom module migration. The example command automatically installs module *first*, also migrates module *second*, and finishes migration of all other custom modules that require *second* to be installed.
```
<odoo-path>/odoo-bin -d <database> -u <second>,<...>
```

"
2792380048,issue,open,,[18.0] auth_passkey: 'rp.id' cannot be used with the current origin,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

18.0 - Odoo online. No studio configurations or custom code.

**Current behaviour:**
1. Installed auth_passkey
2. Try to create passkey in Firefox, Chrome, Safari (no extensions)
3. No User error shown. Only in browser logs do I see something is going wrong.

**Expected behaviour:**
3. I can use my new YubiKey and be a secure boy

**Video/Screenshot link (optional):**

![Image](https://github.com/user-attachments/assets/3e811c16-424c-43cb-af83-182da93af4c8)

### Log Output

```shell
Error: 'rp.id' cannot be used with the current origin
    request moz-extension://390856b7-4466-46e4-b896-3519714cc716/content/fido2-page-script.js:294
    fulfilled moz-extension://390856b7-4466-46e4-b896-3519714cc716/content/fido2-page-script.js:230
    promise callback*step moz-extension://390856b7-4466-46e4-b896-3519714cc716/content/fido2-page-script.js:232
    __awaiter moz-extension://390856b7-4466-46e4-b896-3519714cc716/content/fido2-page-script.js:233
    __awaiter moz-extension://390856b7-4466-46e4-b896-3519714cc716/content/fido2-page-script.js:229
    request moz-extension://390856b7-4466-46e4-b896-3519714cc716/content/fido2-page-script.js:278
    createWebAuthnCredential moz-extension://390856b7-4466-46e4-b896-3519714cc716/content/fido2-page-script.js:463
    fido2_page_script_awaiter moz-extension://390856b7-4466-46e4-b896-3519714cc716/content/fido2-page-script.js:378
    fido2_page_script_awaiter moz-extension://390856b7-4466-46e4-b896-3519714cc716/content/fido2-page-script.js:374
    createWebAuthnCredential moz-extension://390856b7-4466-46e4-b896-3519714cc716/content/fido2-page-script.js:454
    startRegistration https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:23759
    beforeExecuteActionButton https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:23725
    execute https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:9620
    executeButtonCallback https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:9616
    onClickViewButton https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:9626
    onClick https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:9605
    onClick https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:24196
    mainEventHandler https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:1611
    listener https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:762
web.assets_web.min.js:23725:146
    registration https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:23725
    (Async: promise callback)
    beforeExecuteActionButton https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:23725
    execute https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:9620
    executeButtonCallback https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:9616
    onClickViewButton https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:9626
    onClick https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:9605
    onClick https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:24196
    mainEventHandler https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:1611
    listener https://redacted.odoo.com/web/assets/6c6beba/web.assets_web.min.js:762
```

### Support Ticket

#4488576",JochenVanSeveren,2025-01-16 10:51:30+00:00,[],2025-01-16 10:52:33+00:00,,https://github.com/odoo/odoo/issues/193932,[],[],
2790710310,issue,closed,completed,[SEC] CVE-2024-12368 - Improper access control in the auth_oauth mod...,"# Security Advisory - [CVE-2024-12368](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-12368) 

 
**Affects**: Odoo 15.0 (Community and Enterprise Editions)
**CVE ID**: [CVE-2024-12368](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-12368)
**Component**: auth_oauth module
**Credits**: Rafael Fedler, MGB (Migros-Genossenschafts-Bund)

Improper access control in the auth_oauth module of Odoo Community 15.0 and
Odoo Enterprise 15.0 allows an internal user to export the OAuth tokens of
other users.


## I.   Background

OAuth authentication is provided by the auth_oauth module. This feature allows
administrators to configure external OAuth providers for integration with other
systems. During the authentication process, the OAuth provider generates a token
with limited validity, which the Odoo server will receive and verify with the
OAuth provider, before granting access to the user.

Odoo also features an export functionality available across all types of
documents. It allows internal users to export data from records they have access
to, into CSV or Excel files. Users need to be granted access to the feature via
a special group, but it is generally enabled by default on the pre-defined user
templates.


## II.  Problem Description

A flaw in the access control of the auth_oauth module allowed any internal user
with access to the export feature to extract the OAuth tokens of other users who
logged in via an OAuth provider recently.


## III. Impact

**Attack Vector**: Network exploitable
**Authentication**: Authenticated employee with Access to export feature
**CVSS3 Score**: High :: 8.1
**CVSS3 Vector**: [CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N)

Databases with OAuth enabled are vulnerable to session hijacking by malicious
internal users, limited to the users who are actually authenticated via OAuth.
This exploit is only possible within the brief window of the OAuth token's
validity, which is controlled by the OAuth provider. During this window
a user could hijack the session of a more privileged user, resulting in a
privilege escalation.

Odoo S.A. is not aware of any use of this vulnerability in the wild.


## IV.  Workaround

It is strongly recommended to update to the latest version as described below.

Until then, several options are possible to block the vulnerability:
- Remove the export permissions for untrusted internal users. This can be done
  by an administrator in developer mode, by unchecking
  the ""Access to export feature"" checkbox on the user's access rights form, or
  more globally by removing all users from
  the ""Technical/Access to export feature"" group.
- Alternatively, if users have other ways to login into the system, uninstall
  the auth_oauth module entirely. This will prevent users from using OAuth,
  and therefore their OAuth tokens cannot be captured.

Odoo Cloud servers (SaaS and SH) have been patched as soon as the correction
was available.

## V.   Solution

Update to the latest revision, either via GitHub or by downloading it:
  https://www.odoo.com/page/download

For the actual update procedure, please refer to our update instructions:
  https://www.odoo.com/r/update-instructions


## VI. Correction details

As of the date of this advisory, the latest versions of the following stable
series contain the correction:
- Odoo Community 15.0
- Odoo Enterprise 15.0

Other versions are not impacted.

",odony,2025-01-15 19:52:13+00:00,[],2025-01-15 19:52:14+00:00,2025-01-15 19:52:13+00:00,https://github.com/odoo/odoo/issues/193854,"[('Security', 'security announcements')]",[],
2789779059,issue,closed,completed,NameError: name 'GEOIP_EMPTY_COUNTRY' is not defined [Odoo 17],"### Odoo Version

- [ ] 16.0
- [x] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

On odoo 17 community after installation of **website** app facing the internal server error 



### Log Output

```shell
below are the logs;

Traceback (most recent call last):
  File ""C:\Users\x1\Desktop\odoo-17.0\odoo\http.py"", line 2207, in __call__
    response = request._serve_db()
  File ""C:\Users\x1\Desktop\odoo-17.0\odoo\http.py"", line 1787, in _serve_db
    exc.error_response = self.registry['ir.http']._handle_error(exc)
  File ""c:\users\x1\desktop\odoo-17.0\addons\http_routing\models\ir_http.py"", line 641, in _handle_error
    cls._frontend_pre_dispatch()
  File ""c:\users\x1\desktop\odoo-17.0\addons\website\models\ir_http.py"", line 206, in _frontend_pre_dispatch
    request.update_context(tz=pytz.timezone(request.geoip.location.time_zone).zone)
  File ""C:\Users\x1\Desktop\odoo-17.0\odoo\http.py"", line 1148, in __getattr__
    if hasattr(GEOIP_EMPTY_COUNTRY, attr):
NameError: name 'GEOIP_EMPTY_COUNTRY' is not defined
```

### Support Ticket

_No response_",atifcs67,2025-01-15 12:54:48+00:00,[],2025-01-20 06:36:07+00:00,2025-01-20 06:36:07+00:00,https://github.com/odoo/odoo/issues/193744,[],"[{'comment_id': 2597280085, 'issue_id': 2789779059, 'author': 'ndd-odoo', 'body': ""geoip2 lib is in requirement file so maybe you haven't install enough the requirement.txt"", 'created_at': datetime.datetime(2025, 1, 17, 2, 3, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2601481615, 'issue_id': 2789779059, 'author': 'atifcs67', 'body': 'Thank you for the response, actually i was using python 3.10, after upgrading python version to 3.11 the issues has been fixed.', 'created_at': datetime.datetime(2025, 1, 20, 6, 36, 3, tzinfo=datetime.timezone.utc)}]","ndd-odoo on (2025-01-17 02:03:12 UTC): geoip2 lib is in requirement file so maybe you haven't install enough the requirement.txt

atifcs67 (Issue Creator) on (2025-01-20 06:36:03 UTC): Thank you for the response, actually i was using python 3.10, after upgrading python version to 3.11 the issues has been fixed.

"
2789639341,issue,open,,[18.0] Discuss: ghost permanent notification after changing domain,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

When creating a DB and accessing Odoo through a web browser, we have a permanent notification until we accept to receive notification.

We have an explanation for that, and a message suggesting to activate notifications.
Once it's done, it goes away.

But then if we change domain, the notifications comes back, and we have no messages to indicates what to do.
We should show again this messages to suggest to allow notifications from the new domain.

### Log Output

```shell

```

### Support Ticket

_No response_",jeromeMercierTakePart,2025-01-15 12:05:51+00:00,[],2025-01-19 14:50:12+00:00,,https://github.com/odoo/odoo/issues/193737,[],"[{'comment_id': 2600892493, 'issue_id': 2789639341, 'author': 'sibebleuze', 'body': 'I experienced something very similar.\n\n### Issue\n\nI only recently started working with Odoo and on first login, I clicked away the message asking to enable notifications.\n<img width=""475"" alt=""Image"" src=""https://github.com/user-attachments/assets/a9575227-e82c-4c55-bb8a-33b540fb1888"" />\n\nHowever, after that the notification icon kept indicating I had 1 notification, but the dropdown did not show the notification again.\n<img width=""475"" alt=""Image"" src=""https://github.com/user-attachments/assets/13c2042c-f09f-475f-a54b-6085f55f2ee7"" />\n\n### Workaround\n\nI found the ""solution"" after finding this issue and opening Odoo in a different browser, where the message did show again.\nFirefox:\n- Follow instructions [here](https://support.mozilla.org/en-US/kb/push-notifications-firefox#w_upgraded-notifications) to change the ""Send notifications"" setting.\n- Either ""Allow"" or ""Block"" works, so long as you disable ""Use default"".\n\nChrome:\n- Open chrome://settings/privacy, then pick ""Site settings"".\n- Open ""Notifications"" and find Odoo.\n- Navigate to the settings for Odoo with the arrowhead to the right of the URL and set ""Notifications"" to something different than the default (either ""Allow"" or ""Block"" will do).\n\n### Solution\n\nWith regards to a permanent solution from the Odoo side (as opposed to the browser side), I think there are 2 options.\n- Make the notification counter show 0 when the ""Turn on notifications"" message is clicked away. In this case clicking away the message is the same as denying notifications (situation where in the workaround above the option ""Block"" is chosen).\n- Make the ""Turn on notifications"" message show a button for not enabling notifications (Block) as well as the current one for Enable (Allow). Clicking the message away could then optionally be considered as ""Ask again next time"".\n\nIn the end, what should be achieved is that the notification counter shows 1 when there is a message and 0 when there is no message. This [test](https://github.com/odoo/odoo/blob/ff3ed3bdd5c9ab5b0606037916db36ddad4a8045/addons/mail/static/tests/messaging_menu/messaging_menu.test.js#L101) can probably be altered and/or extended to make sure it keeps working that way.\n\nI am open to discussing the desired behaviour as I realize I\'m only one out of many users. I do think we can agree that the current situation, where the counter shows 1 message and the dropdown shows 0, is confusing and hence not the desired behaviour.', 'created_at': datetime.datetime(2025, 1, 19, 14, 50, 11, tzinfo=datetime.timezone.utc)}]","sibebleuze on (2025-01-19 14:50:11 UTC): I experienced something very similar.

### Issue

I only recently started working with Odoo and on first login, I clicked away the message asking to enable notifications.
<img width=""475"" alt=""Image"" src=""https://github.com/user-attachments/assets/a9575227-e82c-4c55-bb8a-33b540fb1888"" />

However, after that the notification icon kept indicating I had 1 notification, but the dropdown did not show the notification again.
<img width=""475"" alt=""Image"" src=""https://github.com/user-attachments/assets/13c2042c-f09f-475f-a54b-6085f55f2ee7"" />

### Workaround

I found the ""solution"" after finding this issue and opening Odoo in a different browser, where the message did show again.
Firefox:
- Follow instructions [here](https://support.mozilla.org/en-US/kb/push-notifications-firefox#w_upgraded-notifications) to change the ""Send notifications"" setting.
- Either ""Allow"" or ""Block"" works, so long as you disable ""Use default"".

Chrome:
- Open chrome://settings/privacy, then pick ""Site settings"".
- Open ""Notifications"" and find Odoo.
- Navigate to the settings for Odoo with the arrowhead to the right of the URL and set ""Notifications"" to something different than the default (either ""Allow"" or ""Block"" will do).

### Solution

With regards to a permanent solution from the Odoo side (as opposed to the browser side), I think there are 2 options.
- Make the notification counter show 0 when the ""Turn on notifications"" message is clicked away. In this case clicking away the message is the same as denying notifications (situation where in the workaround above the option ""Block"" is chosen).
- Make the ""Turn on notifications"" message show a button for not enabling notifications (Block) as well as the current one for Enable (Allow). Clicking the message away could then optionally be considered as ""Ask again next time"".

In the end, what should be achieved is that the notification counter shows 1 when there is a message and 0 when there is no message. This [test](https://github.com/odoo/odoo/blob/ff3ed3bdd5c9ab5b0606037916db36ddad4a8045/addons/mail/static/tests/messaging_menu/messaging_menu.test.js#L101) can probably be altered and/or extended to make sure it keeps working that way.

I am open to discussing the desired behaviour as I realize I'm only one out of many users. I do think we can agree that the current situation, where the counter shows 1 message and the dropdown shows 0, is confusing and hence not the desired behaviour.

"
2789238781,issue,open,,[18.0] portal: Update My Account with new Portal User,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Steps:
1. Set a fresh database, with just Website and Contacts apps installed.
2. Enable Developer Mode.
3. Create a new Portal User, save and set a password.
4. In the Contacts app, create a new contact of type company and save (withtout any other info).
5. In the Contacts app, navigate to the automatically created contact of the Portal User we just created (at step 3).
6. Set the parent_id (Related Company) of this user contact to be the company contact we just created (at step 4) and save.
7. Log in with the Portal User we created (at step 3).
8. Navigate to My Account (/my/home) and click Edit information (/my/account).
9. Without making any changes to the form (or even with changes, it's the same), click SAVE, 500: Internal Server Error will appear and the log will be:

odoo.addons.base.models.ir_qweb.QWebException: Error while render the template
ValueError: invalid literal for int() with base 10: 'False'
Template: portal.portal_my_details_fields
Path: /t/div[15]/select/t/option
Node: <option t-att-value=""country.id"" t-att-selected=""country.id == int(country_id) if country_id else country.id == partner.country_id.id""/>

I've tried this on my local instance, odoo.sh, and odoo hosted, is the same everywhere.
It seems like if you didn't fully fill all the info on a company contact, there are issues when trying to update a contact child of this company. The frontend validation is skipped and the country_id error will be shown.

I know you should fill everything etc.., but this was a real scenario and something that we really stumbled upon in our app. Is this normal?

### Log Output

```shell
2025-01-15 08:59:11,439 61087 ERROR o18_test odoo.http: Exception during request handling. 
Traceback (most recent call last):
  File ""<471>"", line 504, in template_471
  File ""<471>"", line 464, in template_471_content
ValueError: invalid literal for int() with base 10: 'False'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "".../odoo18/odoo-18.0/odoo/http.py"", line 2364, in __call__
    response = request._serve_db()
               ^^^^^^^^^^^^^^^^^^^
  File "".../odoo18/odoo-18.0/odoo/http.py"", line 1891, in _serve_db
    return self._transactioning(
           ^^^^^^^^^^^^^^^^^^^^^
  File "".../odoo18/odoo-18.0/odoo/http.py"", line 1954, in _transactioning
    return service_model.retrying(func, env=self.env)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "".../odoo18/odoo-18.0/odoo/service/model.py"", line 137, in retrying
    result = func()
             ^^^^^^
  File "".../odoo18/odoo-18.0/odoo/http.py"", line 1921, in _serve_ir_http
    response = self.dispatcher.dispatch(rule.endpoint, args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "".../odoo18/odoo-18.0/odoo/http.py"", line 2081, in dispatch
    return self.request.registry['ir.http']._dispatch(endpoint)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "".../odoo18/odoo-18.0/odoo/addons/base/models/ir_http.py"", line 332, in _dispatch
    result.flatten()
  File "".../odoo18/odoo-18.0/odoo/http.py"", line 1389, in flatten
    self.response.append(self.render())
                         ^^^^^^^^^^^^^
  File "".../odoo18/odoo-18.0/odoo/http.py"", line 1381, in render
    return request.env[""ir.ui.view""]._render_template(self.template, self.qcontext)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "".../odoo18/odoo-18.0/addons/website/models/ir_ui_view.py"", line 449, in _render_template
    return super()._render_template(template, values=values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "".../odoo18/odoo-18.0/odoo/addons/base/models/ir_ui_view.py"", line 2183, in _render_template
    return self.env['ir.qweb']._render(template, values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "".../odoo18/odoo-18.0/odoo/tools/profiler.py"", line 304, in _tracked_method_render
    return method_render(self, template, values, **options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "".../odoo18/odoo-18.0/odoo/addons/base/models/ir_qweb.py"", line 600, in _render
    result = ''.join(rendering)
             ^^^^^^^^^^^^^^^^^^
  File ""<472>"", line 82, in template_472
  File ""<472>"", line 64, in template_472_content
  File ""<472>"", line 41, in template_472_t_call_0
  File ""<471>"", line 512, in template_471
odoo.addons.base.models.ir_qweb.QWebException: Error while render the template
ValueError: invalid literal for int() with base 10: 'False'
Template: portal.portal_my_details_fields
Path: /t/div[15]/select/t/option
Node: <option t-att-value=""country.id"" t-att-selected=""country.id == int(country_id) if country_id else country.id == partner.country_id.id""/>
```

### Support Ticket

_No response_",Tritomit-AP,2025-01-15 09:09:50+00:00,[],2025-01-15 09:09:50+00:00,,https://github.com/odoo/odoo/issues/193697,[],[],
2789195816,issue,open,,"[18.0, 17.0, 16.0] sale_mrp : BOM change updating wrong quantity on delivery order.","### Odoo Version

- [x] 16.0
- [x] 17.0
- [x] 18.0
- [ ] Other (specify)

### Steps to Reproduce

 Works fine
1. Create BOM for 'Product A' (kit type) with component 'Product B' = 2 Quantity 
2. Create Sale order for product 'Product A'  = 1 quantity 
3. Confirm Sale order which create delivery order for 'Product B' with 2 quantity that is correct.

Issue here
A. After above process change that BOM you created and update component 'Product B' quantity to 3 
B. Go to that confirmed sales order and change sold quantity to 2 and check delivery.


Current Behaviour:
It changes the delivery order's 'Product B' quantity to 8 as It calculated based on new updated BOM quantity but also added quantity existing delivery product quantity which was 2. so, 2 + (2 * 3) = 8 

Expected Behaviour:
Delivery order quantity for 'Product B' should be 2 * 3 = 6 



Of course Odoo does not recommend to update BOMs that frequent but here for us we can't just create new BOM all the time so, we have to change existing. And delivery department don't know what has been change and no way they can confirm what exactly they have to deliver. 
They just deliver when someone changes something on sale order even the calculation is wrong as you can see in above scenario. 

Can you explain why that calculation like that? which is totally wrong.

",sprintitviki,2025-01-15 08:52:34+00:00,[],2025-01-15 08:53:44+00:00,,https://github.com/odoo/odoo/issues/193695,[],[],
2787399713,issue,open,,[16.0] mail.fetchmail: Wrong log severity,"### Odoo Version

- [x] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

If an email cannot be imported from the configured mailserver, then odoo logs this as INFO which is wrong. Must be logged as ERROR:

![Image](https://github.com/user-attachments/assets/35f2a5a0-0205-458e-b555-5ce39b5f2ea3)


### Log Output

```shell
INFO odoo odoo.addons.mail.models.fetchmail: Failed to process mail from outlook server foo@bar.de
```

### Support Ticket

_No response_",p24-max,2025-01-14 14:58:17+00:00,[],2025-01-14 14:59:45+00:00,,https://github.com/odoo/odoo/issues/193586,[],[],
2786618140,issue,open,,[All] [Wishlist] Account : Enhancing Account Selection Flexibility for Specific Business Needs in Odoo,"### Odoo Version

- [x] 16.0
- [x] 17.0
- [X] 18.0
- [X] Master

#### **Problem**
In Odoo's account management model, the domain restrictions on the following fields limit the types of accounts that can be selected:  
- **`property_account_receivable_id`** and **`property_account_payable_id`** (on partner forms) are limited to accounts of type `asset_receivable` and `liability_payable`, respectively.  

These restrictions do not cover certain specific business needs:  
**Simplified compensation**: In some cases, it is desirable to use the same account for simplifying compensations between customer and supplier invoices.  

Currently, the system does not provide flexibility to accommodate these requirements, limiting customization options and leaving these use cases unsupported.

---

#### **Proposed Solution**
1. **Add fields to the `account.account` model**:  
   - Add a checkbox **`usable_as_partner_account`** to indicate if an account can be used as a receivable or payable account for partners.  
     - Visible only for accounts of type `asset_receivable` or `liability_payable`.  

2. **Modify domain restrictions**:  
   - **For partner forms**:  
     - Adjust the Python domain of the `property_account_receivable_id` and `property_account_payable_id` fields to include accounts marked as `usable_as_partner_account`.  


3. **Add additional validations**:  
   - Update the **`_check_payable_receivable()`** method in the `account.move.line` model to accept accounts marked as `usable_on_product` or `usable_as_partner_account`.  

4. **Review impacts on existing behaviors**:  
   - **`display_type`**: Ensure that account customization does not disrupt the display type of invoice lines.  
   - **Tax calculation based on payments**: Verify that tax computation remains functional when customized accounts are used.  
   - **Existing account type validations**: Validate that no business rules or constraints are broken by these changes.  

---

#### **Expected Benefits**
- Increased flexibility to address specific business needs related to intermediation and simplified compensation processes.  
- A generic, extensible solution that can be implemented without compromising accounting rules or standard processes.  
- Improved adaptability of Odoo to complex use cases without breaking existing controls.  ``

",rpinset,2025-01-14 09:08:44+00:00,[],2025-01-15 07:33:18+00:00,,https://github.com/odoo/odoo/issues/193513,[],"[{'comment_id': 2591275672, 'issue_id': 2786618140, 'author': 'gdgellatly', 'body': 'Can you not already do this with the various account netting modules? e.g. https://odoo-community.org/shop/account-netting-369#attr=940317', 'created_at': datetime.datetime(2025, 1, 14, 22, 57, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2591662092, 'issue_id': 2786618140, 'author': 'rpinset', 'body': '> Can you not already do this with the various account netting modules? e.g. https://odoo-community.org/shop/account-netting-369#attr=940317\n\nthanks for the suggestion @gdgellatly it is not a periodic review of accounts for netting.\n\nIn certain professions, such as property rental management, it is necessary to record in purchase the rents to be paid to the owner and on the other hand in sale the maintenance and restoration costs.\nThus each month/invoicing, it is necessary to easily be able to compensate purchases and sales.\n\nBy using the same account (when this is permitted by the accounting rules) this allows you to directly use the ""payment widget"" present at the bottom of the invoice, warning messages, a simple lettering.', 'created_at': datetime.datetime(2025, 1, 15, 5, 6, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2591663621, 'issue_id': 2786618140, 'author': 'rpinset', 'body': '**work in progress**\nI still have the translation to manage on Friday to make a first pull request', 'created_at': datetime.datetime(2025, 1, 15, 5, 8, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2591832808, 'issue_id': 2786618140, 'author': 'gdgellatly', 'body': ""Well it would seem then the easiest thing to do would be to use Credit Notes / Invoices or Bills / Refunds. On my rentals all I get each month is a single buyer created invoice with Rent less deductions. \n\nBut anyway if you do the code, I personally wouldn't bother with the PR into Odoo directly, it is too narrow a use case, I have zero say in anything but can't see it being accepted ever, let alone in any timeframe you would need. Best to just make it a separate module, and maybe contribute to OCA.\n\nThere is even a rental repo plus the account-financial-tools where account-netting lives."", 'created_at': datetime.datetime(2025, 1, 15, 7, 33, 17, tzinfo=datetime.timezone.utc)}]","gdgellatly on (2025-01-14 22:57:04 UTC): Can you not already do this with the various account netting modules? e.g. https://odoo-community.org/shop/account-netting-369#attr=940317

rpinset (Issue Creator) on (2025-01-15 05:06:55 UTC): thanks for the suggestion @gdgellatly it is not a periodic review of accounts for netting.

In certain professions, such as property rental management, it is necessary to record in purchase the rents to be paid to the owner and on the other hand in sale the maintenance and restoration costs.
Thus each month/invoicing, it is necessary to easily be able to compensate purchases and sales.

By using the same account (when this is permitted by the accounting rules) this allows you to directly use the ""payment widget"" present at the bottom of the invoice, warning messages, a simple lettering.

rpinset (Issue Creator) on (2025-01-15 05:08:34 UTC): **work in progress**
I still have the translation to manage on Friday to make a first pull request

gdgellatly on (2025-01-15 07:33:17 UTC): Well it would seem then the easiest thing to do would be to use Credit Notes / Invoices or Bills / Refunds. On my rentals all I get each month is a single buyer created invoice with Rent less deductions. 

But anyway if you do the code, I personally wouldn't bother with the PR into Odoo directly, it is too narrow a use case, I have zero say in anything but can't see it being accepted ever, let alone in any timeframe you would need. Best to just make it a separate module, and maybe contribute to OCA.

There is even a rental repo plus the account-financial-tools where account-netting lives.

"
2779699224,issue,open,,[16.0] AVCO product price incorrect when billed before reception,"### Odoo Version

- [X] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Create a PO with unit price 2. Receive 1 unit. Create bill with unit price 3 for the complete PO quantity. Receive remaining products. Cost is 2 instead of 3 for products received after bill.

[AVCO.webm](https://github.com/user-attachments/assets/8bf37a02-99e8-49bc-83af-8435cc134a26)


### Log Output

_No response_

### Support Ticket

_No response_",jbaudoux,2025-01-10 09:28:29+00:00,[],2025-01-29 11:30:43+00:00,,https://github.com/odoo/odoo/issues/193180,[],"[{'comment_id': 2605899629, 'issue_id': 2779699224, 'author': 'ossimantylahti', 'body': ""So essentially you are testing an edge case when the vendor bill has a different product price than what was in the purchase order?\n\nThis is interesting. I'm not even sure this is a defect."", 'created_at': datetime.datetime(2025, 1, 21, 22, 49, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2621300448, 'issue_id': 2779699224, 'author': 'jbaudoux', 'body': ""> So essentially you are testing an edge case when the vendor bill has a different product price than what was in the purchase order?\n> \n> This is interesting. I'm not even sure this is a defect.\n\nYou can place a PO without knowing the price. The exact price will be given by the supplier invoice."", 'created_at': datetime.datetime(2025, 1, 29, 10, 52, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2621348647, 'issue_id': 2779699224, 'author': 'ossimantylahti', 'body': ""> > So essentially you are testing an edge case when the vendor bill has a different product price than what was in the purchase order?\n> > This is interesting. I'm not even sure this is a defect.\n> \n> You can place a PO without knowing the price. The exact price will be given by the supplier invoice.\n\nReally?? I'd like to do this kind of business as well. :). \n\nSeriously, I do not think Odoo supports this. In Odoo the purchase price must be known at the time of recording a purchase order."", 'created_at': datetime.datetime(2025, 1, 29, 11, 10, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2621389554, 'issue_id': 2779699224, 'author': 'jbaudoux', 'body': '> Seriously, I do not think Odoo supports this. In Odoo the purchase price must be known at the time of recording a purchase order.\n\nThis is working fine (likely since ages) when the bill is created after the reception of the goods.\n\nFor the reported issue, need to test on older version if this is not a regression of recent changes.', 'created_at': datetime.datetime(2025, 1, 29, 11, 30, 43, tzinfo=datetime.timezone.utc)}]","ossimantylahti on (2025-01-21 22:49:48 UTC): So essentially you are testing an edge case when the vendor bill has a different product price than what was in the purchase order?

This is interesting. I'm not even sure this is a defect.

jbaudoux (Issue Creator) on (2025-01-29 10:52:08 UTC): You can place a PO without knowing the price. The exact price will be given by the supplier invoice.

ossimantylahti on (2025-01-29 11:10:55 UTC): Really?? I'd like to do this kind of business as well. :). 

Seriously, I do not think Odoo supports this. In Odoo the purchase price must be known at the time of recording a purchase order.

jbaudoux (Issue Creator) on (2025-01-29 11:30:43 UTC): This is working fine (likely since ages) when the bill is created after the reception of the goods.

For the reported issue, need to test on older version if this is not a regression of recent changes.

"
2778432937,issue,open,,[18.0] mail: Bug in mass mail sending,"### Odoo Version

- [X] 16.0
- [ ] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Steps to Reproduce:

1- Go to the list of customer invoices.
2- Select more than one invoice from the list.
3- Apply the ""Send and Print"" action.
4- Open one of the selected invoices and observe that it was sent as an internal note, not as a message/email (this is evident because it does not appear in green).

### Log Output

```shell
Current behaviour:
When selecting more than one invoice to send at once, the invoices are not sent as messages but instead as internal notes. The subtype_id is sent as False, which prevents the recipients from receiving the email properly. However, when an invoice is sent individually, the email is correctly delivered to the recipients.

Expected behaviour:
When sending multiple invoices at once, they should be sent as messages (not internal notes) with the correct subtype_id, ensuring that the recipients receive the emails as expected.

Video/Screenshot link (optional): https://drive.google.com/file/d/1KupXrX1sGj-pbUawqdU3LeW786g2LXJu/view
```


### Support Ticket

_No response_",rov-adhoc,2025-01-09 17:50:00+00:00,[],2025-01-12 18:59:24+00:00,,https://github.com/odoo/odoo/issues/193124,"[('Accounting', ''), ('16.0', '')]",[],
2776595356,issue,closed,completed,[18.0] project: Odoo tests creates two columns automatically and leave them there,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

What are the steps to reproduce your errors?
On Odoo v18
Run the tests on a Odoo sh dev branch. Then look for the columns on the project_project table, you will see these two fields ""x_plan2_id"",a nd ""x_plan3_id""

On Odoo v17
These two columns are not present.

What is the current behavior you observe?
On the Dev branches:
At the end of the tests I got these two new columns on the project_project table on the Database. These are added maybe by the tests, but in any case they are added by the system. And that wasn't my intention.

x_plan2_id
x_plan3_id

<img width=""1512"" alt=""Screenshot 2025-01-08 at 6 08 36 p m"" src=""https://github.com/user-attachments/assets/348e5929-d79d-4203-8284-b01bfcd1da68"" />


On the Staging and Production branches these columns are not present.

Without the issue, what would you expect the behavior/result to be?

That the table will not have these unintended columns.


### Log Output

_No response_

### Support Ticket

_No response_",FerCalatayud,2025-01-09 00:26:53+00:00,[],2025-01-13 16:48:13+00:00,2025-01-13 16:48:13+00:00,https://github.com/odoo/odoo/issues/192996,[],"[{'comment_id': 2580415470, 'issue_id': 2776595356, 'author': 'william-andre', 'body': 'These are very likely to be demo data. Did you activate the demo in your test environment?\r\n\r\nWhich test would be causing the issue otherwise?', 'created_at': datetime.datetime(2025, 1, 9, 14, 38, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2580527677, 'issue_id': 2776595356, 'author': 'FerCalatayud', 'body': 'Yes, I also think it is the demo data. The tests run always when you first create a dev branch. So yes they are active at least on the first run.\r\n\r\nMaybe they run but do not do a good job at cleaning up after they are done.\r\n\r\nI think this next script is the one creating the columns:\r\n\r\nhttps://github.com/odoo/odoo/blob/08f0c6481a190349369ead5ab9328886392ddbeb/addons/analytic/tests/test_analytic_account.py', 'created_at': datetime.datetime(2025, 1, 9, 15, 12, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2581721709, 'issue_id': 2776595356, 'author': 'william-andre', 'body': ""If it is demo data it has nothing to do with tests.\r\nThe script you linked doesn't correspond to the columns you mentioned and is correctly rolled back.\r\n\r\nNote that if those columns are annoying, you can remove them by deleting the corresponding analytic plans."", 'created_at': datetime.datetime(2025, 1, 10, 4, 32, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2583263994, 'issue_id': 2776595356, 'author': 'FerCalatayud', 'body': 'ok, thanks. So whether it is the demo data or the test itself it is still a bug, I think.\r\n\r\nAnd yes a solution would be to just delete them, but I think that is not the right approach, right? The system should not create columns randomly. Especially if some part of the code creates them and then just leaves them there, assuming this is the case.', 'created_at': datetime.datetime(2025, 1, 10, 16, 57, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2583298138, 'issue_id': 2776595356, 'author': 'william-andre', 'body': 'Having demo data in a demo database is expected.', 'created_at': datetime.datetime(2025, 1, 10, 17, 16, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2583304305, 'issue_id': 2776595356, 'author': 'FerCalatayud', 'body': 'Oh yes, you are right. I thought about it as if the demo data we were talking about was data created by the test.\r\n\r\nBut if it is just demo data that is loaded not for testing but for other purposes, like to use the system and understand it through the UI, then it is expected, and it is the right approach.', 'created_at': datetime.datetime(2025, 1, 10, 17, 20, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2587645339, 'issue_id': 2776595356, 'author': 'william-andre', 'body': 'I suppose we both agree then :+1: \r\nIf not, please reopen or continue the discussion', 'created_at': datetime.datetime(2025, 1, 13, 16, 48, 13, tzinfo=datetime.timezone.utc)}]","william-andre on (2025-01-09 14:38:21 UTC): These are very likely to be demo data. Did you activate the demo in your test environment?

Which test would be causing the issue otherwise?

FerCalatayud (Issue Creator) on (2025-01-09 15:12:24 UTC): Yes, I also think it is the demo data. The tests run always when you first create a dev branch. So yes they are active at least on the first run.

Maybe they run but do not do a good job at cleaning up after they are done.

I think this next script is the one creating the columns:

https://github.com/odoo/odoo/blob/08f0c6481a190349369ead5ab9328886392ddbeb/addons/analytic/tests/test_analytic_account.py

william-andre on (2025-01-10 04:32:13 UTC): If it is demo data it has nothing to do with tests.
The script you linked doesn't correspond to the columns you mentioned and is correctly rolled back.

Note that if those columns are annoying, you can remove them by deleting the corresponding analytic plans.

FerCalatayud (Issue Creator) on (2025-01-10 16:57:07 UTC): ok, thanks. So whether it is the demo data or the test itself it is still a bug, I think.

And yes a solution would be to just delete them, but I think that is not the right approach, right? The system should not create columns randomly. Especially if some part of the code creates them and then just leaves them there, assuming this is the case.

william-andre on (2025-01-10 17:16:58 UTC): Having demo data in a demo database is expected.

FerCalatayud (Issue Creator) on (2025-01-10 17:20:43 UTC): Oh yes, you are right. I thought about it as if the demo data we were talking about was data created by the test.

But if it is just demo data that is loaded not for testing but for other purposes, like to use the system and understand it through the UI, then it is expected, and it is the right approach.

william-andre on (2025-01-13 16:48:13 UTC): I suppose we both agree then :+1: 
If not, please reopen or continue the discussion

"
2776586338,issue,closed,completed,[18.0] project_todo: Consistent test failure in Odoo.sh,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

When on Odoo.sh and run full tests, it will  fail with the error message written bellow.

Condition when the error shows up (Only on Odoo v18):
- Adding any custom module, only with the `__manifest__.py` and the `__init__.py` files. In the `__manifest__.py `the atribute `installable` is set to True, and `depends` is set to nothing.
- When there IS custom module. and the atribute `installable` is set to True in the `__manifest__.py`. And the branch settings are set to ""Install a list of modules (project)""
-  When there IS custom module. and the atribute `installable` is set to True, and `depends` is set to `project` in the `__manifest__.py`. And the branch settings are set to ""Install only my modules""
- When there IS custom module. and the atribute `installable` is set to False in the `__manifest__.py`. And the branch settings are set to ""Install a list of modules (project_todo)""
- When there IS custom module. and the atribute `installable` is set to False in the `__manifest__.py`. And the branch settings are set to ""Install a list of modules (project)""

Conditions when the error DO NOT shows up (Only on Odoo v18):
- When there is NO custom module. And the branch settings are set to ""Install only my modules""
- When there is NO custom module. And the branch settings are set to ""Install a list of modules (project)""
- When there IS custom module. and the atribute `installable` is set to False in the `__manifest__.py`. And the branch settings are set to ""Install a list of modules (project)"" (this is weird because there is an exact same test that gets the error)
- When there IS custom module. and the atribute `installable` is set to False in the `__manifest__.py`. And the branch settings are set to ""Install only my modules""
- **When there IS custom module. and the atribute `installable` is set to True, and `depends` is set to `project` in the `__manifest__.py`. And the branch settings are set to ""Install only my modules"". BUT I also skip this test with the next syntax on the branch settings `-/project_todo:TestTodoUi.test_tour_project_task_activities_split`**




### ERROR MESSAGE:

```
08/01/2025 16:31:44 | ERROR | server | FAILED: [4/7] Tour project_task_activities_split → Step Task ""New Sub-Task!"" is listed in the activity view (trigger: .o_activity_record .d-block:contains(""New Sub-Task!"")). Element (.o_activity_record .d-block:contains(""New Sub-Task!"")) has not been found. TIMEOUT: The step failed to complete within 10000 ms.
-- | -- | -- | --
08/01/2025 16:31:44 | ERROR | server | FAIL: Subtest TestTodoUi.test_tour_project_task_activities_split (login='admin') Traceback (most recent call last):   File ""<decorator-gen-257>"", line 2, in test_tour_project_task_activities_split   File ""/home/odoo/src/odoo/odoo/tests/common.py"", line 2142, in _users     func(*args, **kwargs)   File ""/home/odoo/src/odoo/addons/project_todo/tests/test_todo_ui.py"", line 51, in test_tour_project_task_activities_split     self.start_tour(""/odoo"", 'project_task_activities_split', login=""admin"")   File ""/home/odoo/src/odoo/odoo/tests/common.py"", line 2076, in start_tour     return self.browser_js(url_path=url_path, code=code, ready=ready, timeout=timeout, success_signal=""tour succeeded"", **kwargs)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File ""/home/odoo/src/odoo/odoo/tests/common.py"", line 2052, in browser_js     self.fail('%s\n\n%s' % (message, error)) AssertionError: The test code ""odoo.startTour('project_task_activities_split', {""stepDelay"": 0, ""keepWatchBrowser"": false, ""debug"": false, ""startUrl"": ""/odoo"", ""delayToCheckUndeterminisms"": 0})"" failed  FAILED: [4/7] Tour project_task_activities_split → Step Task ""New Sub-Task!"" is listed in the activity view (trigger: .o_activity_record .d-block:contains(""New Sub-Task!"")). Element (.o_activity_record .d-block:contains(""New Sub-Task!"")) has not been found. TIMEOUT: The step failed to complete within 10000 ms.
08/01/2025 16:31:55 | ERROR | server | 1 failed, 0 error(s) of 1904 tests when loading database 'avant-odoo-main-subtarea-doc-permisos-17539164'
```


### Support Ticket

No response



### Log Output

```shell
08/01/2025 16:31:44 | ERROR | server | FAILED: [4/7] Tour project_task_activities_split → Step Task ""New Sub-Task!"" is listed in the activity view (trigger: .o_activity_record .d-block:contains(""New Sub-Task!"")). Element (.o_activity_record .d-block:contains(""New Sub-Task!"")) has not been found. TIMEOUT: The step failed to complete within 10000 ms.
-- | -- | -- | --
08/01/2025 16:31:44 | ERROR | server | FAIL: Subtest TestTodoUi.test_tour_project_task_activities_split (login='admin') Traceback (most recent call last):   File ""<decorator-gen-257>"", line 2, in test_tour_project_task_activities_split   File ""/home/odoo/src/odoo/odoo/tests/common.py"", line 2142, in _users     func(*args, **kwargs)   File ""/home/odoo/src/odoo/addons/project_todo/tests/test_todo_ui.py"", line 51, in test_tour_project_task_activities_split     self.start_tour(""/odoo"", 'project_task_activities_split', login=""admin"")   File ""/home/odoo/src/odoo/odoo/tests/common.py"", line 2076, in start_tour     return self.browser_js(url_path=url_path, code=code, ready=ready, timeout=timeout, success_signal=""tour succeeded"", **kwargs)            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   File ""/home/odoo/src/odoo/odoo/tests/common.py"", line 2052, in browser_js     self.fail('%s\n\n%s' % (message, error)) AssertionError: The test code ""odoo.startTour('project_task_activities_split', {""stepDelay"": 0, ""keepWatchBrowser"": false, ""debug"": false, ""startUrl"": ""/odoo"", ""delayToCheckUndeterminisms"": 0})"" failed  FAILED: [4/7] Tour project_task_activities_split → Step Task ""New Sub-Task!"" is listed in the activity view (trigger: .o_activity_record .d-block:contains(""New Sub-Task!"")). Element (.o_activity_record .d-block:contains(""New Sub-Task!"")) has not been found. TIMEOUT: The step failed to complete within 10000 ms.
08/01/2025 16:31:55 | ERROR | server | 1 failed, 0 error(s) of 1904 tests when loading database 'avant-odoo-main-subtarea-doc-permisos-17539164'
```
```


### Support Ticket

4,462,934",FerCalatayud,2025-01-09 00:19:00+00:00,['xavierbol'],2025-01-10 12:07:39+00:00,2025-01-10 10:39:54+00:00,https://github.com/odoo/odoo/issues/192995,"[('Services', 'Project, timesheet, helpdesk,...'), ('18.0', '')]","[{'comment_id': 2582559084, 'issue_id': 2776586338, 'author': 'xavierbol', 'body': 'Hello @FerCalatayud \r\n\r\nThanks for your feedback! \r\n\r\nNormally #193066 should fix the issue. 🙂 \r\n\r\nHave a nice day!', 'created_at': datetime.datetime(2025, 1, 10, 12, 7, 38, tzinfo=datetime.timezone.utc)}]","xavierbol (Assginee) on (2025-01-10 12:07:38 UTC): Hello @FerCalatayud 

Thanks for your feedback! 

Normally #193066 should fix the issue. 🙂 

Have a nice day!

"
2775744972,issue,closed,completed,[17.0] crm: bug when merging opportunities,"### Odoo Version

- [X] 16.0
- [X] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

**What are the steps to reproduce your errors?**
1. Open CRM Opportunity you want to merge with another
2. Click Smart Button to view customers ""Similar Leads""
3. Switch to List View if not your default (because you can't merge from Kanban)
4. Select the two(or more) Opportunities you want to merge
5. Actions > Merge
6. Sometimes Odoo grabs all the opportunities you had selected for merging, sometimes it misses some of them

**What is the current behavior you observe?**
Sometimes Odoo grabs all the opportunities you had selected for merging, sometimes it misses some of them. It should not fail to prepopulate the list correctly.

**Without the issue, what would you expect the behavior/result to be?**
Bring in all of the selected opportunities for merging.

VIDEO showing the bug can be replicated on Official RUNBOT:
https://youtu.be/gLpJWdtQxTM

### Log Output

_No response_

### Support Ticket

4461943",cliffkujala,2025-01-08 15:55:29+00:00,[],2025-01-10 17:09:06+00:00,2025-01-10 17:09:06+00:00,https://github.com/odoo/odoo/issues/192926,[],"[{'comment_id': 2580016449, 'issue_id': 2775744972, 'author': 'intero-chz', 'body': 'When the Merge Wizard is created, the selected leads are pre-filtered. The behavior therefore appears to be intentional.\r\n\r\nhttps://github.com/odoo/odoo/blob/8421a86cfef6a7a6cfaaefe93aac3663dfabec90/addons/crm/wizard/crm_merge_opportunities.py#L30', 'created_at': datetime.datetime(2025, 1, 9, 12, 17, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2583285143, 'issue_id': 2775744972, 'author': 'cliffkujala', 'body': '> When the Merge Wizard is created, the selected leads are pre-filtered. The behavior therefore appears to be intentional.\r\n> \r\n> https://github.com/odoo/odoo/blob/8421a86cfef6a7a6cfaaefe93aac3663dfabec90/addons/crm/wizard/crm_merge_opportunities.py#L30\r\n\r\nYes this is repeatable.  When you select Opportunities with 100% probability they are excluded from the merge wizard. \r\n\r\nThat is the behavior I was experiencing.  Thank you for identifying why this was happening.  I can now train the staff to expect this behavior, or decide if we need to make a module to override and always include all the selected opportunities for merging.\r\n\r\nI will close this since it is expected behavior in the base code.', 'created_at': datetime.datetime(2025, 1, 10, 17, 9, 6, tzinfo=datetime.timezone.utc)}]","intero-chz on (2025-01-09 12:17:34 UTC): When the Merge Wizard is created, the selected leads are pre-filtered. The behavior therefore appears to be intentional.

https://github.com/odoo/odoo/blob/8421a86cfef6a7a6cfaaefe93aac3663dfabec90/addons/crm/wizard/crm_merge_opportunities.py#L30

cliffkujala (Issue Creator) on (2025-01-10 17:09:06 UTC): Yes this is repeatable.  When you select Opportunities with 100% probability they are excluded from the merge wizard. 

That is the behavior I was experiencing.  Thank you for identifying why this was happening.  I can now train the staff to expect this behavior, or decide if we need to make a module to override and always include all the selected opportunities for merging.

I will close this since it is expected behavior in the base code.

"
2775084073,issue,open,,"[18.0] Export Dialog Performance Enhancement: Add ""All Records"" Option","### Odoo Version

- [X] 16.0
- [X] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

## Current Behavior
When exporting records from a list view, the export dialog pre-loads and displays individual checkboxes for all matching records. For large datasets (15k+ records), this causes significant performance issues:
- Browser becomes unresponsive while loading record selections
- UI interactions are sluggish when selecting/arranging export fields
- High memory usage due to many DOM elements
- Poor user experience when working with field selections

## Expected Behavior
Add an ""All Records"" checkbox option in the export dialog that would:
- Skip loading individual record selections
- Avoid creating individual record checkboxes in the DOM
- Process the full dataset only when executing the export
- Allow users to focus on field selection without performance degradation

## Proposed Solution
Modify the export dialog to include:
1. A radio button selection:
   - Selected Records (current behavior)
   - All Records (new option)
2. When ""All Records"" is selected:
   - Hide/disable the individual record selection area
   - Use the current search domain for the final export
   - Only process record selection during actual export

## Technical Notes
- This would require modifications to:
  - Export dialog view
  - Export controller logic
  - Export processing workflow
- The feature would maintain compatibility with existing export functionality
- Similar to how Odoo handles other bulk operations

## Benefits
1. Improved performance for large datasets
2. Better user experience when selecting export fields
3. Reduced browser memory usage
4. More efficient workflow for bulk exports

## Version
- Odoo xx - 18.0

## Additional Notes
This enhancement would be particularly beneficial for:
- Companies with large datasets
- Regular bulk export operations
- Resource-constrained client devices

### Log Output

_No response_

### Support Ticket

_No response_",kimasplund,2025-01-08 10:55:48+00:00,[],2025-01-08 10:55:48+00:00,,https://github.com/odoo/odoo/issues/192856,[],[],
2774712819,issue,open,,[17.0] Accounting: Change Account in a posted Journal Entry does not sync into Analytic Items,"### Odoo Version

- [ ] 16.0
- [X] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

1. Create a new database with demo data
2. Activate Accounting app
3. Go to Accounting->Configuration->Settings
4. Enable(check) Analytic Accounting then save
5. Goto Dashboard->Miscellaneous Operations->new Entry
6. Input into journal items: 
    101401 Bank, Azure Interior, label 1, (Active account, Administrative), $100, $0
    101501 Cash, Azure Interior, label 1, (Active account, Administrative), $0, $100
7. Click ‘Post’
8. Copy the url, open a new tab then paste-enter the url
9. Click button ‘Reset to Draft’ then refresh both tabs
10. Open second tab, click ‘Post’
11. Switch to first tab, notice the Status is still Draft and the Post button still exist, and **you can still edit everything**
12. Change the first Journal Items from 101401 Bank -> 101402 Bank Suspense Account, click Save Icon
13. Goto Accounting->Analytic Items: **it has 4 row (should be only 2)**

<img width=""1435"" alt=""Screenshot 2025-01-08 at 15 47 46"" src=""https://github.com/user-attachments/assets/9b44109c-f818-4a52-b258-40f87aae97cb"" />

<img width=""1438"" alt=""Screenshot 2025-01-08 at 15 46 39"" src=""https://github.com/user-attachments/assets/0c2a035e-bfd0-4c0e-9646-3f1e9460fd41"" />



### Log Output

_No response_

### Support Ticket

_No response_",aryono-mcm,2025-01-08 08:48:33+00:00,[],2025-02-04 09:36:35+00:00,,https://github.com/odoo/odoo/issues/192835,[],[],
2774584113,issue,closed,completed,[18.0] Issue UPGRADE SCRIPT (TREE -> LIST),"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [X] 18.0
- [ ] Other (specify)


## Issue: Properties of `list` tag misplaced after upgrade from Odoo 17 to Odoo 18

``` ./odoo/odoo-bin upgrade_code   --addons-path $PATH --from 17.0 ```

**Description:**
When upgrading from Odoo 17 to Odoo 18, the `tree` views in the XML files are not correctly replaced with `list` views. During the upgrade, the properties of the `list` view (such as `create`, `delete`, `editable`, and `default_order`) are placed outside the `list` tag, causing malformed XML and rendering issues.

**Example:**

Before the upgrade (Odoo 17):
```xml
<field name=""line_ids"">
    <tree create=""false"" delete=""false"" editable=""bottom"" default_order=""date asc"">
        <field name=""date""/>
        <field name=""check_name""/>
        <field name=""check_number""/>
        <field name=""due_date""/>
        <field name=""check_amount""/>
        <field name=""currency""/>
        <field name=""blocked"" widget=""boolean_toggle""/>
    </tree>
</field>
```


### After the upgrade (incorrect transformation):

```
<field name=""line_ids""> 
    list<create=""false"" delete=""false"" editable=""bottom"" default_order=""date asc"">
        <field name=""date""/>
        <field name=""check_name""/>
        <field name=""check_number""/>
        <field name=""due_date""/>
        <field name=""check_amount""/>
        <field name=""currency""/>
        <field name=""blocked"" widget=""boolean_toggle""/>
    <list/>
</field>
```


### Expected Outcome:
The upgrade script should correctly replace the `tree` tag with the `list` tag and ensure that all attributes (e.g., `create`, `delete`, `editable`, `default_order`) are placed inside the `list` tag. The properties should not be placed outside or misplaced.

### Correct transformation should look like this:

```xml
<field name=""line_ids""> 
    <list create=""false"" delete=""false"" editable=""bottom"" default_order=""date asc"">
        <field name=""date""/>
        <field name=""check_name""/>
        <field name=""check_number""/>
        <field name=""due_date""/>
        <field name=""check_amount""/>
        <field name=""currency""/>
        <field name=""blocked"" widget=""boolean_toggle""/>
    </list>
</field>
```





### Log Output

_No response_

### Support Ticket

_No response_",moneebalalfi,2025-01-08 07:59:38+00:00,['Gorash'],2025-01-23 12:58:13+00:00,2025-01-23 12:58:13+00:00,https://github.com/odoo/odoo/issues/192829,"[('18.0', '')]","[{'comment_id': 2580528622, 'issue_id': 2774584113, 'author': 'Feyensv', 'body': 'cc: @Gorash', 'created_at': datetime.datetime(2025, 1, 9, 15, 12, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2596024015, 'issue_id': 2774584113, 'author': 'fbndsprz', 'body': ""Error is coming from `reg_tree_to_list_tag` defined in [odoo/upgrade_code/17.5-01-tree-to-list.py](https://github.com/odoo/odoo/blob/0faf168bbcbc66daeb58999a6222cd2c6d41134c/odoo/upgrade_code/17.5-01-tree-to-list.py)\n\nI could successfully run the upgrade_code on some addons using the following fix. Not sure though it covers all the cases the initial regExp was made for.\n\n`    reg_tree_to_list_tag = re.compile(r'(<[/]?)tree(\\s?[^>]*>)')\n`"", 'created_at': datetime.datetime(2025, 1, 16, 15, 26, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2601818624, 'issue_id': 2774584113, 'author': 'Gorash', 'body': ""Thanks for the report. (sorry I didn't see it before). I made a PR to fix this."", 'created_at': datetime.datetime(2025, 1, 20, 9, 5, 22, tzinfo=datetime.timezone.utc)}]","Feyensv on (2025-01-09 15:12:45 UTC): cc: @Gorash

fbndsprz on (2025-01-16 15:26:07 UTC): Error is coming from `reg_tree_to_list_tag` defined in [odoo/upgrade_code/17.5-01-tree-to-list.py](https://github.com/odoo/odoo/blob/0faf168bbcbc66daeb58999a6222cd2c6d41134c/odoo/upgrade_code/17.5-01-tree-to-list.py)

I could successfully run the upgrade_code on some addons using the following fix. Not sure though it covers all the cases the initial regExp was made for.

`    reg_tree_to_list_tag = re.compile(r'(<[/]?)tree(\s?[^>]*>)')
`

Gorash (Assginee) on (2025-01-20 09:05:22 UTC): Thanks for the report. (sorry I didn't see it before). I made a PR to fix this.

"
2773342128,issue,open,,[18.0] account: Incorrect technical currency rate set when creating a company with a currency that has undefined company-specific exchange rates,"### Odoo Version

- [X] 16.0
- [X] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

1 - Select a currency (e.g., AED) that has existing exchange rates but no company assigned in the ""Company"" field.
Example: AED has an exchange rate of 0.80 USD/AED for the date 01/01/2020, with the ""Company"" field left blank.

2 - Create a new company, such as ""Test Company"" and set AED as its primary currency. Also load the chart of accounts for this company.

3 - In ""Test Company"" define a new exchange rate for USD relative to AED. For example, set the exchange rate to 160 USD/AED for the date 01/01/2025.

4 - Review the automatically calculated technical rate.The technical rate is incorrectly set to 2, which is erroneous.

5 -  From ""Test Company"" create an invoice dated 01/01/2025 for an amount of 10 USD.

6 - Create a new company, sush as ""US TEST COMPANY"" and set USD as its primary currency.

7 - In ""US TEST COMPANY"" define a new exchange rate for AED relative to USD. For example, set the exchange rate to 	0.00625 AED/USD  (160 USD/AED) for the date 01/01/2025.

8 -  From ""US TEST COMPANY"" with the other company selected (""Test Company"") navigate to the Partner Ledger (with using CTA for Currency Translation) and verify that the entry for the invoice of 10 USD from ""Test Company"" now appears to be 9.60 USD.

### Log Output

Current behaviour:
Incorrect Technical Rate: When creating a new company (""Test Company"") and setting AED as its primary currency, the technical rate is incorrectly calculated as 2, due to pre-existing, without companies exchange rates for AED. This lead to inconsistents in the res currency rate table (because of this method _get_last_rates_for_companies)

Expected behaviour:
The technical rate should be correctly calculated based on the new exchange rates defined for the specific company, without being influenced by pre-existing, without companies rates.

Video/Screenshot link (optional):
https://drive.google.com/file/d/1gpUPdx9dlXPnFBL8wbjYaJJEhOCu_7lb/view



### Support Ticket

_No response_",rov-adhoc,2025-01-07 17:06:42+00:00,[],2025-01-07 17:07:11+00:00,,https://github.com/odoo/odoo/issues/192763,[],[],
2772141627,issue,open,,[ALL] web_editor: Leaflet map embedded on website breaks on mobile ,"### Odoo Version

- [X] 16.0
- [X] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Steps to reproduce: https://github.com/Leaflet/Leaflet/issues/9566
Root cause: https://github.com/odoo/odoo/blob/ffaaae1d941774af95e8d172ef8fdad775d5e403/addons/web_editor/static/src/scss/web_editor.frontend.scss#L4

When Odoo implemented Leaflet Map view for backend, this CSS rule was removed from the backend assets: https://github.com/odoo/odoo/commit/515fb62fc499b269e3461f7023bc257419ce8804

Could it be removed from the frontend assets as well, or at least limited so that it does not apply to **every** `<img>` tag?

### Log Output

_No response_

### Support Ticket

[#4456556](https://www.odoo.com/my/tasks/4456556)",elmeriniemela,2025-01-07 07:57:44+00:00,[],2025-01-07 08:05:16+00:00,,https://github.com/odoo/odoo/issues/192627,[],[],
2770601968,issue,open,,[18.0] delivery_mondialrelay: JS error when trying to add shipping (jQuery is not defined),"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- configure Mondial relay delivery provider
- create a Sale Order
- press _Add Shipping_
- try to select _Mondial Relay_

Tested on runbot fresh instance.

### Log Output

```
Uncaught ReferenceError: jQuery is not defined
    at widget.mondialrelay.com/parcelshop-picker/jquery.plugin.mondialrelay.parcelshoppicker.min.js:1:22
    at widget.mondialrelay.com/parcelshop-picker/jquery.plugin.mondialrelay.parcelshoppicker.min.js:1:725
2web.assets_web.min.js:2550 OwlError: An error occured in the owl lifecycle (see this Error's ""cause"" property)
    Error: An error occured in the owl lifecycle (see this Error's ""cause"" property)
        at handleError (https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:952:101)
        at App.handleError (https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:1595:29)
        at RootFiber.complete (https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:984:28)
        at Scheduler.processFiber (https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:1562:43)
        at Scheduler.processTasks (https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:1556:62)
        at https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:1553:67

Caused by: ReferenceError: $ is not defined
    at https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:23264:6
    at MondialRelayField.<anonymous> (https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:1611:9)
    at RootFiber.complete (https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:982:146)
    at Scheduler.processFiber (https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:1562:43)
    at Scheduler.processTasks (https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:1556:62)
    at https://72895905-18-0-all.runbot147.odoo.com/web/assets/f5da9d7/web.assets_web.min.js:1553:67
```


### Support Ticket

_No response_",Rad0van,2025-01-06 12:54:04+00:00,[],2025-01-06 12:56:37+00:00,,https://github.com/odoo/odoo/issues/192494,[],[],
2769985133,issue,open,,[All] [Wishlist] portal: allow dynamic portal menu items and which data is showing,"### Odoo Version

- [X] 16.0
- [X] 17.0
- [X] 18.0
- [ ] Other (specify)


Hi there,

Let me first start by explaining the problem and then proposing a solution later on.

**The problem:**
By default Odoo has the portal for portal users/customers available on https://yourinstance.com/my.
In this overview your customer can see all items and data such as for historic orders, invoices, projects and many more (which is great):
<img width=""984"" alt=""image"" src=""https://github.com/user-attachments/assets/2cd67954-c65e-4bd3-90a0-3c8a7daf86cb"" />

However, there is a very big limitation and issue with this portal setup.
All of the blocks shown here are fully hardcoded and are by default just installed/activated when the app is installed without any way to modify this.
_note: For the ease of this ticket I will call every item a block (e.g ""Appointments"" is a block, ""Your Orders"" is a block, ..)._

On a lot of projects we however see that we need to do customizations on this. Some of the cases we see happening a lot for our projects:
- Some blocks should by default be hidden
- The title (and translations) from some of the blocks needs to change
- The data which is shown after clicking on a block should be limited (the domain)
- The icons of the blocks need to change
- ...

Every single time we get these requests we need to build a custom app to inherit the controller or the view to modify titles, icons, domains and such. This has to be done for every single menu one by one and even worse: it adds a big `dependency` list if we need to do this for e.g 5 blocks.
This is a costly matter and brings nobody anything besides of delay and frustration and should not be in a modern and flexible ERP system such as Odoo.
Since Odoo has always been built in a way to try and be as dynamic as possible I believe we lack flexibility here and it is time we change this! :-)


**The solution:**
In order to avoid all this overhead and make the portal truly dynamic I believe a good solution would be to link blocks to a new Odoo module in which we can configure the blocks dynamically.
Here is a short mockup that I built in Studio to show the idea visually:
<img width=""829"" alt=""image"" src=""https://github.com/user-attachments/assets/70899767-7487-4944-9593-aef909035e56"" />

A new menu under for example Website > Configuration named ""Portal Blocks"" could give access to this:
<img width=""742"" alt=""image"" src=""https://github.com/user-attachments/assets/3b5dcd5e-425c-4b53-afc2-2473763708b8"" />

With this small mock-up as a reference you can already see how much stronger the portal from Odoo would be as it would allow to make dynamic blocks on the `/my` portal overview to both modify existing ones and creates new ones in a no-code solution.
Let me shortly explain the things I have added one by one:
- **description:** the description that is shown in a block under `/my` and is by default translatable,
- **Visible on portal:** a quick checkbox that can be toggled on/off to quickly hide or show a block on the website. Quite some projects for example do not want to show the timesheets for example
- **model:** our technical mapping to know on which model the whole configuration needs to be build and to feed the form view with insights to know which fields can be set and so on
- **default sort by:** defines on which field the `controller` will sort by default and thus in which sorting order the data in the list view is shown to the end customers
- **sort order:**: to define if data should be sorted descending or ascending in the portal,
- **records per page:** to show how many records should be shown in the list view per page
- **searchbar sorting:** as in Odoo the `controller` feeds the searchby sortings with a simple `'searchbar_sortings': searchbar_sortings` that takes a `JSON` we could simply add a text field which takes a `JSON` to directly allow dynamically configuring searchbars
- **domain:**: this defines which data is loaded by the `controller` based on the condition set. As this is also a `JSON` we can here too do a textfield which takes `JSON` and directly passes it to the `controller`.
- **fields to show:** by adding an in-between table here with a domain set on the configured model at the top we can allow users/customers to build dynamic list views for the current model. That way we get full flexibility on these pages too (e.g for `/my/orders`)

This is only a small mock-up to see if something like this would be accepted or not. If yes I could work out the idea further and perhaps even propose the framework in code to build this into the core of Odoo SA.
If any of the Odoo product owners would want to discuss this let me know :)",Yenthe666,2025-01-06 07:04:11+00:00,[],2025-01-17 14:05:43+00:00,,https://github.com/odoo/odoo/issues/192439,"[('Wishlist', '')]","[{'comment_id': 2572571488, 'issue_id': 2769985133, 'author': 'inspiredbusiness', 'body': 'Yes please!', 'created_at': datetime.datetime(2025, 1, 6, 8, 38, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2572644464, 'issue_id': 2769985133, 'author': 'intero-chz', 'body': 'I am also not a fan of the current implementation of sorting, filtering, etc. in the controllers. Making it adjustable would greatly enhance the portal.\r\n\r\nThe two typical requirements of our customers for the portal: Firstly, do not show all portal entries (blocks) and secondly, filter the entries differently (not via followers). Both requirements were addressed directly with this proposal.', 'created_at': datetime.datetime(2025, 1, 6, 9, 14, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2572771496, 'issue_id': 2769985133, 'author': 'scigghia', 'body': '👍', 'created_at': datetime.datetime(2025, 1, 6, 10, 2, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2575072814, 'issue_id': 2769985133, 'author': 'brahminor', 'body': 'Excellent initiative, I am 100% for it. Indeed, we had to do development to personalize the portal.', 'created_at': datetime.datetime(2025, 1, 7, 11, 39, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2594592022, 'issue_id': 2769985133, 'author': 'miaoxiaofu', 'body': ""This is a great proposal and, like many social media accounts, it clearly shows items relevant to the user such as account security, personalization, My orders, etc. The current portal account page is really hard to view. Maybe the odoo team doesn't care much about external user access needs,"", 'created_at': datetime.datetime(2025, 1, 16, 5, 52, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2597645212, 'issue_id': 2769985133, 'author': 'Yenthe666', 'body': '@mart-e heyhey! How can we get something like this moving and get feedback from Odoo or the OK to start building this? :)', 'created_at': datetime.datetime(2025, 1, 17, 8, 1, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2597684820, 'issue_id': 2769985133, 'author': 'mart-e', 'body': 'Hi @Yenthe666 ! I am not really involved in such feedbacks (nor in translations btw) but I think what you want is already worked of at #184148', 'created_at': datetime.datetime(2025, 1, 17, 8, 25, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2598280856, 'issue_id': 2769985133, 'author': 'Yenthe666', 'body': ""Thanks a lot @mart-e :-) Would be nice if we could get a general point of contact to bounce all these ideas with.\nI'd love to get us work together to implement nice things that are often asked by many partners/customers."", 'created_at': datetime.datetime(2025, 1, 17, 12, 39, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2598319192, 'issue_id': 2769985133, 'author': 'intero-chz', 'body': '> Hi [@Yenthe666](https://github.com/Yenthe666) ! I am not really involved in such feedbacks (nor in translations btw) but I think what you want is already worked of at [#184148](https://github.com/odoo/odoo/pull/184148)\n\nThis reads as cosmetic customization options and would only be a small fraction of the topics requested here.', 'created_at': datetime.datetime(2025, 1, 17, 13, 1, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2598441837, 'issue_id': 2769985133, 'author': 'composercodes', 'body': '@Yenthe666 \nCan you take a look at this new portal UI ?\n\nhttps://www.youtube.com/watch?v=SnG5RItY9fQ', 'created_at': datetime.datetime(2025, 1, 17, 14, 5, 41, tzinfo=datetime.timezone.utc)}]","inspiredbusiness on (2025-01-06 08:38:21 UTC): Yes please!

intero-chz on (2025-01-06 09:14:58 UTC): I am also not a fan of the current implementation of sorting, filtering, etc. in the controllers. Making it adjustable would greatly enhance the portal.

The two typical requirements of our customers for the portal: Firstly, do not show all portal entries (blocks) and secondly, filter the entries differently (not via followers). Both requirements were addressed directly with this proposal.

scigghia on (2025-01-06 10:02:07 UTC): 👍

brahminor on (2025-01-07 11:39:04 UTC): Excellent initiative, I am 100% for it. Indeed, we had to do development to personalize the portal.

miaoxiaofu on (2025-01-16 05:52:04 UTC): This is a great proposal and, like many social media accounts, it clearly shows items relevant to the user such as account security, personalization, My orders, etc. The current portal account page is really hard to view. Maybe the odoo team doesn't care much about external user access needs,

Yenthe666 (Issue Creator) on (2025-01-17 08:01:15 UTC): @mart-e heyhey! How can we get something like this moving and get feedback from Odoo or the OK to start building this? :)

mart-e on (2025-01-17 08:25:59 UTC): Hi @Yenthe666 ! I am not really involved in such feedbacks (nor in translations btw) but I think what you want is already worked of at #184148

Yenthe666 (Issue Creator) on (2025-01-17 12:39:59 UTC): Thanks a lot @mart-e :-) Would be nice if we could get a general point of contact to bounce all these ideas with.
I'd love to get us work together to implement nice things that are often asked by many partners/customers.

intero-chz on (2025-01-17 13:01:31 UTC): This reads as cosmetic customization options and would only be a small fraction of the topics requested here.

composercodes on (2025-01-17 14:05:41 UTC): @Yenthe666 
Can you take a look at this new portal UI ?

https://www.youtube.com/watch?v=SnG5RItY9fQ

"
2769287154,issue,closed,completed,[18.0] website: Social Media Snippet doesn't work.,"### Odoo Version

- [X] 16.0
- [X] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Current behavior:

- Go to the Website Editor;
- Add any block;
-  Add Inner Content Social Media;
- Write any url;
-  All Social media snippets will have the same URL for that site;
- Confirm that all point to the last url set;

Expected behavior:

Able to edit each Social Media snippet individually. Odoo has a Big Team Detail snippet with 6 Social Media snippets that basically don't work.

Related to this files:
https://github.com/odoo/odoo/blob/31d1be3de895d9e6667a35468b4be716127d17b3/addons/website/static/src/snippets/s_social_media/options.js
https://github.com/odoo/odoo/blob/31d1be3de895d9e6667a35468b4be716127d17b3/addons/website/views/snippets/s_social_media.xml


![Screenshot From 2025-01-05 13-50-50](https://github.com/user-attachments/assets/3250983b-3a7d-4341-a56a-6641d20f3a71)
Doesn't work


### Log Output

_No response_

### Support Ticket

#4451564",vvro,2025-01-05 13:57:41+00:00,[],2025-01-05 18:33:18+00:00,2025-01-05 18:33:17+00:00,https://github.com/odoo/odoo/issues/192435,[],"[{'comment_id': 2571713726, 'issue_id': 2769287154, 'author': 'vvro', 'body': 'Just have to add more, instead of using the existing boxes.', 'created_at': datetime.datetime(2025, 1, 5, 18, 33, 17, tzinfo=datetime.timezone.utc)}]","vvro (Issue Creator) on (2025-01-05 18:33:17 UTC): Just have to add more, instead of using the existing boxes.

"
2768885027,issue,open,,[18.0] amount_to_text result is not correct for some languages,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

Open Odoo. Go to configuration, accounting and enable ""Total amount of invoice in letters"".
Change your odoo language to Lithuanian.
Display any Invoice in PDF.

For amount 493.08 example output will be:
Suma žodžiais:
Keturi Šimtai Devyniasdešimt Trys Euros and Aštuoni Cents

as you see ""Euros"", ""and"" and ""Cents"" are in English.
It should be:
Keturi Šimtai Devyniasdešimt Trys Eurai ir Aštuoni Centai

but, even output from num2words is correct:
num2words --to currency -l lt 493.08
keturi šimtai devyniasdešimt trys eurai, aštuoni centai

So your method below is doing some unnecessary stuff for lithuanian language (and probably for most languages that num2words supports):

odoo/odoo/addons/base/models/res_currency.py

Class Currency
method on line 172
def amount_to_text(self, amount):


### Log Output

_No response_

### Support Ticket

_No response_",alenas,2025-01-04 15:08:03+00:00,[],2025-01-04 15:08:03+00:00,,https://github.com/odoo/odoo/issues/192432,[],[],
2768669468,issue,open,,"[17.0] module:purchase,manufacturing. BOM Update Not Removing Deleted Items from RFQ in Purchase Orders","### Odoo Version

- [ ] 16.0
- [X] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

### Bug Report: BOM Update Not Removing Deleted Items from RFQ in Purchase Orders

**Odoo Version**: Odoo17

**Steps to Reproduce**:
1. Create a Manufacturing Order for a product with Make To Order (MTO) settings.
2. Confirm the Manufacturing Order, which automatically generates a Purchase RFQ.
3. Update the BOM for the product by replacing one item and deleting another.
4. Click the ""Update BOM"" button.

**Expected Behavior**:
The updated RFQ should remove the deleted item and replace the item that was changed.

**Actual Behavior**:
The RFQ correctly adds any new items, but the deleted and replaced items remain in the RFQ.

**Additional Information**:
2. Confirm the Manufacturing Order, which automatically generates a Purchase RFQ.
3. Update the BOM for the product by replacing one item and deleting another.
4. Click the ""Update BOM"" button.

**Expected Behavior**:
The updated RFQ should remove the deleted item and replace the item that was changed.

**Actual Behavior**:
The RFQ correctly adds any new items, but the deleted and replaced items remain in the RFQ.

**Additional Information**:
![Snipaste_2025-01-04_16-52-50](https://github.com/user-attachments/assets/607dd226-7c05-41b3-a850-2fc9af2c9a55)
![Snipaste_2025-01-04_16-53-07](https://github.com/user-attachments/assets/8c0ceb97-8462-4de7-8fee-98cdf48c1e02)
![Snipaste_2025-01-04_16-53-25](https://github.com/user-attachments/assets/fbf63c2d-5370-4d29-a0b0-1f9dbb32f588)
![Snipaste_2025-01-04_16-53-53](https://github.com/user-attachments/assets/7cdb41f6-fc40-4651-bd22-4d33a847e696)
![Snipaste_2025-01-04_16-54-15](https://github.com/user-attachments/assets/5ee91517-e18b-4b65-9aa7-fca6d1f2de27)
![Snipaste_2025-01-04_16-54-43](https://github.com/user-attachments/assets/5fe91e58-34b9-40a7-918c-b700b20313ef)

### Log Output

_No response_

### Support Ticket

_No response_",Ernesto-Gzr,2025-01-04 08:57:50+00:00,[],2025-01-04 09:06:12+00:00,,https://github.com/odoo/odoo/issues/192428,[],[],
2768391903,issue,open,,[17.0] module: sale. selection_add on sale.order.state affect query speed,"### Odoo Version

- [ ] 16.0
- [X] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

SQL is very slow on state field when add new selection on sale.order.state
Index on the field is correct
Postgresql Version: 14.1
```
state = fields.Selection(selection_add=[
    ('done', 'Locked')
])
```

1. Query state summary
select state, count(1) from sale_order group by state;
 state  |  count
--------+---------
 cancel |    2665
 done   |  236251
 draft  | 3554172
(3 rows)

2. Query state = 'draft'
explain analyze select id, name, state, ship_state from sale_order
where state = 'draft'
order by id desc limit 10;

QUERY PLAN

 Limit  (cost=0.43..1.69 rows=10 width=31) (actual time=34.292..34.299 rows=10 loops=1)
   ->  Index Scan Backward using sale_order_pkey on sale_order  (cost=0.43..446343.75 rows=3551342 width=31) (actual time=34.291..34.296 rows=10
loops=1)
         Filter: ((state)::text = 'draft'::text)
 Planning Time: 0.455 ms
 Execution Time: 34.331 ms
(5 rows)

3. Query state = 'done'
explain analyze select id, name, state, ship_state from sale_order
where state = 'done'
order by id desc limit 10;

QUERY PLAN

 Limit  (cost=0.43..19.06 rows=10 width=31) (actual time=137318.229..137329.397 rows=10 loops=1)
   ->  Index Scan Backward using sale_order_pkey on sale_order  (cost=0.43..446343.75 rows=239597 width=31) (actual time=137318.227..137329.392 r
ows=10 loops=1)
         Filter: ((state)::text = 'done'::text)
         Rows Removed by Filter: 3554172
 Planning Time: 0.353 ms
 Execution Time: 137329.434 ms
(6 rows)

----------------------------------------

I had checked database settings and can not find any problem.
So, what's the problem?


### Log Output

_No response_

### Support Ticket

_No response_",bizslink-calon,2025-01-04 03:18:10+00:00,[],2025-01-11 18:21:43+00:00,,https://github.com/odoo/odoo/issues/192427,[],[],
2767406429,issue,open,,[16.0] web: Widget many2many_binary will not set res_id correctly for IrAttachment model,"### Odoo Version

- [X] 16.0
- [X] 17.0
- [ ] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- Create new many2many ir.attachment field to Quality Worksheet Template
- Change widget to many2many_binary
- Next create Quality Control, add type worksheet and required fields and then click Worksheet.
- Add attachment and then saving the Quality Check Worksheet to database
- The created attachment will be without res_id or res_field, which is **wrong**. It needs to have created quality check worksheet **res_id**.
- If we now open the existing QC worksheet and add a new attachment, then it will have res_id! So if QC Worksheet already has database ID it will work.

### Log Output

_No response_

### Support Ticket

_No response_",MartinAavastik,2025-01-03 11:20:34+00:00,[],2025-01-03 11:20:34+00:00,,https://github.com/odoo/odoo/issues/192306,[],[],
2767072879,issue,open,,[18.0] backend URL data does not persist after refresh,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- Open any record and click on smartbox, then reload the same url.
- In result you will get all data instead of filtered data.


### Log Output

```shell
see this video:- https://webkul.chatwhizz.com/share/view-recording/677788faee1b4e073aed4c9a

- As odoo 18 have capability to maintain action data in url path so this should work. it'll be very helpful for backend users.
```


### Support Ticket

_No response_",ravi-webkul,2025-01-03 06:53:53+00:00,[],2025-01-03 06:53:53+00:00,,https://github.com/odoo/odoo/issues/192282,[],[],
2766794619,issue,open,,[18.0/master] point_of_sale: local customer display not translated,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

The bug happens in odoo versions 18, saas-18.1 and master. The bug is NOT present on odoo version 17.0.
Steps to reproduce :
1) connect on runbot
2) load another language (french for example) and switch to French
3) In the point of sale dashbord, start a pos session on ""Furniture Shop"" (which is configured by default with customer_display_type = 'local')
=> make sure POS frontend is in French
4) launch the customer display
=> the messages in the customer display are all in English : ""Welcome."", ""Change"" (when you pay by cash), ""Thank you."" (when you switch to the next order), etc.

![bug_pos_18](https://github.com/user-attachments/assets/b9db9c7e-1f95-4afb-bcb5-f2d01b7e70ec)


When you look at the fr.po file of the point_of_sale module, you will see that the terms used in the customer display are properly translated, for example ""Welcome."" is translated to ""Bienvenue."", cf : 
https://github.com/odoo/odoo/blob/18.0/addons/point_of_sale/i18n/fr.po#L8751


### Log Output

_No response_

### Support Ticket

_No response_",alexis-via,2025-01-02 23:43:06+00:00,[],2025-01-03 00:51:17+00:00,,https://github.com/odoo/odoo/issues/192275,[],"[{'comment_id': 2568531239, 'issue_id': 2766794619, 'author': 'alexis-via', 'body': 'Screenshot that shows that Odoo v17 is NOT affected by the bug:\r\n\r\n![odoo_v17_ok](https://github.com/user-attachments/assets/263e269a-4050-4646-a0ad-027083c6d4bd)', 'created_at': datetime.datetime(2025, 1, 2, 23, 51, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2568568455, 'issue_id': 2766794619, 'author': 'alexis-via', 'body': 'I made a ""dirty fix"" that make translation work in the customer display:\r\n\r\nhttps://pastecode.io/s/bdyczg2z\r\n\r\nThe cause of the problem is in the controller of the customer display: the session_info dict contains {\'translationURL\': \'/website/translations\'}. If you remove that key, translation works!\r\n\r\nHere is the commit that introduced the regression: https://github.com/odoo/odoo/commit/acf78c27b12cf014cd80d20ea5853e63ab9ca03f#diff-594bdbbfca5d6ffd94f98fc3b1b587106984bfedb4e64fd5aca1fdd9500af958\r\n\r\nResult:\r\n\r\n![odoo_v18_fixed](https://github.com/user-attachments/assets/4cd2884e-c6a5-4fcd-8113-959eef025afe)', 'created_at': datetime.datetime(2025, 1, 3, 0, 51, 16, tzinfo=datetime.timezone.utc)}]","alexis-via (Issue Creator) on (2025-01-02 23:51:26 UTC): Screenshot that shows that Odoo v17 is NOT affected by the bug:

![odoo_v17_ok](https://github.com/user-attachments/assets/263e269a-4050-4646-a0ad-027083c6d4bd)

alexis-via (Issue Creator) on (2025-01-03 00:51:16 UTC): I made a ""dirty fix"" that make translation work in the customer display:

https://pastecode.io/s/bdyczg2z

The cause of the problem is in the controller of the customer display: the session_info dict contains {'translationURL': '/website/translations'}. If you remove that key, translation works!

Here is the commit that introduced the regression: https://github.com/odoo/odoo/commit/acf78c27b12cf014cd80d20ea5853e63ab9ca03f#diff-594bdbbfca5d6ffd94f98fc3b1b587106984bfedb4e64fd5aca1fdd9500af958

Result:

![odoo_v18_fixed](https://github.com/user-attachments/assets/4cd2884e-c6a5-4fcd-8113-959eef025afe)

"
2766692005,issue,open,,[18.0] module: Circular Import Error in Calendar Module with Python 3.10,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

1. Create new Odoo 18 installation with Python 3.10
2. Install dependencies via pip install -r requirements.txt
3. Start Odoo server

Error Message:
ImportError: cannot import name '_has_surrogates' from partially initialized module 'email.utils' (most likely due to a circular import)

Workaround:
Currently working around this by:
1. Renaming the calendar module folder
2. Using server_wide_modules = base,web in odoo.conf

This prevents the module from loading at startup but is not a proper solution.

### Log Output

```shell
G:\DEV\Odoo\Odoo18Tutorial\venv\Scripts\python.exe G:\DEV\Odoo\Odoo18Tutorial\odoo\odoo-bin -c odoo.conf 
Traceback (most recent call last):
  File ""G:\DEV\Odoo\Odoo18Tutorial\odoo\odoo-bin"", line 5, in <module>
    import odoo
  File ""G:\DEV\Odoo\Odoo18Tutorial\odoo\odoo\__init__.py"", line 49, in <module>
    _monkeypatches.patch_all()
  File ""G:\DEV\Odoo\Odoo18Tutorial\odoo\odoo\_monkeypatches\__init__.py"", line 30, in patch_all
    from .werkzeug_urls import patch_werkzeug
  File ""G:\DEV\Odoo\Odoo18Tutorial\odoo\odoo\_monkeypatches\werkzeug_urls.py"", line 14, in <module>
    from werkzeug import urls
  File ""G:\DEV\Odoo\Odoo18Tutorial\venv\lib\site-packages\werkzeug\__init__.py"", line 1, in <module>
    from .serving import run_simple as run_simple
  File ""G:\DEV\Odoo\Odoo18Tutorial\venv\lib\site-packages\werkzeug\serving.py"", line 26, in <module>
    from http.server import BaseHTTPRequestHandler
  File ""C:\Users\steve\AppData\Local\Programs\Python\Python310\lib\http\server.py"", line 92, in <module>
    import email.utils
  File ""C:\Users\steve\AppData\Local\Programs\Python\Python310\lib\email\utils.py"", line 33, in <module>
    from email._parseaddr import quote
  File ""C:\Users\steve\AppData\Local\Programs\Python\Python310\lib\email\_parseaddr.py"", line 16, in <module>
    import time, calendar
  File ""G:\DEV\Odoo\Odoo18Tutorial\odoo\addons\calendar\__init__.py"", line 4, in <module>
    from . import controllers
  File ""G:\DEV\Odoo\Odoo18Tutorial\odoo\addons\calendar\controllers\__init__.py"", line 4, in <module>
    from . import main
  File ""G:\DEV\Odoo\Odoo18Tutorial\odoo\addons\calendar\controllers\main.py"", line 4, in <module>
    import odoo.http as http
  File ""G:\DEV\Odoo\Odoo18Tutorial\odoo\odoo\http.py"", line 173, in <module>
    import werkzeug.datastructures
  File ""G:\DEV\Odoo\Odoo18Tutorial\venv\lib\site-packages\werkzeug\datastructures.py"", line 3059, in <module>
    from . import http
  File ""G:\DEV\Odoo\Odoo18Tutorial\venv\lib\site-packages\werkzeug\http.py"", line 17, in <module>
    from urllib.request import parse_http_list as _parse_list_header
  File ""C:\Users\steve\AppData\Local\Programs\Python\Python310\lib\urllib\request.py"", line 88, in <module>
    import http.client
  File ""C:\Users\steve\AppData\Local\Programs\Python\Python310\lib\http\client.py"", line 71, in <module>
    import email.parser
  File ""C:\Users\steve\AppData\Local\Programs\Python\Python310\lib\email\parser.py"", line 12, in <module>
    from email.feedparser import FeedParser, BytesFeedParser
  File ""C:\Users\steve\AppData\Local\Programs\Python\Python310\lib\email\feedparser.py"", line 27, in <module>
    from email._policybase import compat32
  File ""C:\Users\steve\AppData\Local\Programs\Python\Python310\lib\email\_policybase.py"", line 9, in <module>
    from email.utils import _has_surrogates
ImportError: cannot import name '_has_surrogates' from partially initialized module 'email.utils' (most likely due to a circular import) (C:\Users\steve\AppData\Local\Programs\Python\Python310\lib\email\utils.py)

Process finished with exit code 1
```


### Support Ticket

_No response_",githubkitchens,2025-01-02 21:54:33+00:00,[],2025-01-02 21:54:33+00:00,,https://github.com/odoo/odoo/issues/192272,[],[],
2766643429,issue,open,,"[18.0] Database creation error: psycopg2.errors.UndefinedTable: relation ""ir_model"" does not exist","### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

When you create a new database with Spanish (CR) / Español (CR) as a language you receive the following error (image):
![image](https://github.com/user-attachments/assets/b0b8136a-e817-47ce-9fc2-d22d07f3ac77)

I will copy the log output on the correct field. If you create the database with English (US) the process will be completed without errors.

### Log Output

```shell
2025-01-02 21:04:43,218 830 ERROR None odoo.service.db: CREATE DATABASE failed:
Traceback (most recent call last):
  File ""/opt/odoo/odoo/tools/convert.py"", line 537, in _tag_root
    f(rec)
  File ""/opt/odoo/odoo/tools/convert.py"", line 437, in _tag_record
    record = model._load_records([data], self.mode == 'update')
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo/models.py"", line 5444, in _load_records
    data['record']._load_records_write(data['values'])
  File ""/opt/odoo/odoo/models.py"", line 5362, in _load_records_write
    self.write(values)
  File ""/opt/odoo/odoo/addons/base/models/res_lang.py"", line 358, in write
    self.env.flush_all()
  File ""/opt/odoo/odoo/api.py"", line 833, in flush_all
    self[model_name].flush_model()
  File ""/opt/odoo/odoo/models.py"", line 6697, in flush_model
    self._flush(fnames)
  File ""/opt/odoo/odoo/models.py"", line 6774, in _flush
    model.browse(some_ids)._write_multi(vals_list)
  File ""/opt/odoo/odoo/models.py"", line 4874, in _write_multi
    self.env.execute_query(SQL(
  File ""/opt/odoo/odoo/api.py"", line 962, in execute_query
    self.cr.execute(query)
  File ""/opt/odoo/odoo/sql_db.py"", line 354, in execute
    res = self._obj.execute(query, params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint ""res_lang_url_code_uniq""
DETAIL:  Key (url_code)=(es) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File ""/opt/odoo/odoo/service/db.py"", line 72, in _initialize_db
    registry = odoo.modules.registry.Registry.new(db_name, demo, None, update_module=True)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/.local/lib/python3.11/site-packages/decorator.py"", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo/tools/func.py"", line 97, in locked
    return func(inst, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo/modules/registry.py"", line 127, in new
    odoo.modules.load_modules(registry, force_demo, status, update_module)
  File ""/opt/odoo/odoo/modules/loading.py"", line 422, in load_modules
    loaded_modules, processed_modules = load_module_graph(
                                        ^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo/modules/loading.py"", line 227, in load_module_graph
    load_data(env, idref, mode, kind='data', package=package)
  File ""/opt/odoo/odoo/modules/loading.py"", line 71, in load_data
    tools.convert_file(env, package.name, filename, idref, mode, noupdate, kind)
  File ""/opt/odoo/odoo/tools/convert.py"", line 608, in convert_file
    convert_xml_import(env, module, fp, idref, mode, noupdate)
  File ""/opt/odoo/odoo/tools/convert.py"", line 679, in convert_xml_import
    obj.parse(doc.getroot())
  File ""/opt/odoo/odoo/tools/convert.py"", line 594, in parse
    self._tag_root(de)
  File ""/opt/odoo/odoo/tools/convert.py"", line 537, in _tag_root
    f(rec)
  File ""/opt/odoo/odoo/tools/convert.py"", line 550, in _tag_root
    raise ParseError('while parsing %s:%s, somewhere inside\n%s' % (
odoo.tools.convert.ParseError: while parsing /opt/odoo/odoo/addons/base/data/res_lang_data.xml:17, somewhere inside
<record id=""base.lang_es_419"" model=""res.lang"">
            <field name=""url_code"">es</field>
        </record>
2025-01-02 21:04:43,223 830 INFO None odoo.modules.loading: loading 1 modules...
2025-01-02 21:04:43,227 830 INFO None odoo.modules.loading: 1 modules loaded in 0.00s, 0 queries (+0 extra)
2025-01-02 21:04:43,228 830 ERROR None odoo.sql_db: bad query: b""SELECT *, name->>'en_US' AS name FROM ir_model WHERE state = 'manual'""
ERROR: relation ""ir_model"" does not exist
LINE 1: SELECT *, name->>'en_US' AS name FROM ir_model WHERE state =...
                                              ^

2025-01-02 21:04:43,229 830 WARNING None odoo.modules.loading: Transient module states were reset
2025-01-02 21:04:43,229 830 ERROR None odoo.modules.registry: Failed to load registry
2025-01-02 21:04:43,230 830 ERROR None odoo.addons.web.controllers.database: Database creation error.
Traceback (most recent call last):
  File ""/opt/odoo/odoo/modules/registry.py"", line 104, in __new__
    return cls.registries[db_name]
           ~~~~~~~~~~~~~~^^^^^^^^^
  File ""/opt/odoo/.local/lib/python3.11/site-packages/decorator.py"", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo/tools/func.py"", line 97, in locked
    return func(inst, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo/tools/lru.py"", line 33, in __getitem__
    a = self.d[obj]
        ~~~~~~^^^^^
KeyError: 'machote_spa'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""/opt/odoo/addons/web/controllers/database.py"", line 83, in create
    request.session.authenticate(name, credential)
  File ""/opt/odoo/odoo/http.py"", line 1042, in authenticate
    registry = Registry(dbname)
               ^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo/modules/registry.py"", line 106, in __new__
    return cls.new(db_name)
           ^^^^^^^^^^^^^^^^
  File ""/opt/odoo/.local/lib/python3.11/site-packages/decorator.py"", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo/tools/func.py"", line 97, in locked
    return func(inst, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo/modules/registry.py"", line 127, in new
    odoo.modules.load_modules(registry, force_demo, status, update_module)
  File ""/opt/odoo/odoo/modules/loading.py"", line 429, in load_modules
    registry.setup_models(cr)
  File ""/opt/odoo/.local/lib/python3.11/site-packages/decorator.py"", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo/tools/func.py"", line 97, in locked
    return func(inst, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/opt/odoo/odoo/modules/registry.py"", line 333, in setup_models
    env['ir.model']._add_manual_models()
  File ""/opt/odoo/odoo/addons/base/models/ir_model.py"", line 501, in _add_manual_models
    cr.execute(""SELECT *, name->>'en_US' AS name FROM ir_model WHERE state = 'manual'"")
  File ""/opt/odoo/odoo/sql_db.py"", line 354, in execute
    res = self._obj.execute(query, params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UndefinedTable: relation ""ir_model"" does not exist
LINE 1: SELECT *, name->>'en_US' AS name FROM ir_model WHERE state =...
                                              ^

2025-01-02 21:04:43,579 830 INFO None odoo.sql_db: ConnectionPool(read/write;used=2/count=3/max=64): Closed 1 connections to 'user=odoo password=xxx dbname=machote_spa host=192.168.122.84 port=5432 application_name=odoo-830 sslmode=prefer'
2025-01-02 21:04:43,607 830 INFO None werkzeug: 192.168.122.1 - - [02/Jan/2025 21:04:43] ""POST /web/database/create HTTP/1.1"" 200 - 6684 2.393 1.374
```


### Support Ticket

_No response_",EstebanMonge,2025-01-02 21:06:34+00:00,[],2025-01-10 11:51:55+00:00,,https://github.com/odoo/odoo/issues/192270,[],"[{'comment_id': 2582525321, 'issue_id': 2766643429, 'author': 'dimi-odoo', 'body': 'I created a new database using the mentioned language Spanish (CR) / Español (CR) but was unable to reproduce or find any errors during the process.\r\n\r\n![image](https://github.com/user-attachments/assets/0433145d-9ada-4657-b6dc-a976cce67129)', 'created_at': datetime.datetime(2025, 1, 10, 11, 49, 46, tzinfo=datetime.timezone.utc)}]","dimi-odoo on (2025-01-10 11:49:46 UTC): I created a new database using the mentioned language Spanish (CR) / Español (CR) but was unable to reproduce or find any errors during the process.

![image](https://github.com/user-attachments/assets/0433145d-9ada-4657-b6dc-a976cce67129)

"
2765335830,issue,open,,Any new?,"Any new?

_Originally posted by @geniustep in https://github.com/odoo/odoo/issues/181974#issuecomment-2567203500_",geniustep,2025-01-02 00:49:02+00:00,[],2025-01-02 00:49:02+00:00,,https://github.com/odoo/odoo/issues/192137,[],[],
2765227143,issue,open,,[18.0] account: payement validation displays an error,"### Odoo Version

- [ ] 16.0
- [ ] 17.0
- [X] 18.0
- [ ] Other (specify)

### Steps to Reproduce

- Create a customer payment
- Select a customer and put an amount, eg: 152, next choose Bank journal (with outstanding account configured)
- Confirm the payment
- Validate the payment
- Current behaviour: an error displayed: **The entry PBNK1/2025/00002 (id 386) must be in draft.**
- Expected behaviour: the payment might be validated
- Video/Screenshot link (optional): 
![image](https://github.com/user-attachments/assets/7c891ed1-a841-4688-94f4-e83706931bdc)

### Log Output

_No response_

### Support Ticket
#4445889",youcef04,2025-01-01 19:34:51+00:00,[],2025-01-07 21:49:18+00:00,,https://github.com/odoo/odoo/issues/192136,[],"[{'comment_id': 2573488556, 'issue_id': 2765227143, 'author': 'william-andre', 'body': 'Here is the fix https://github.com/odoo/odoo/pull/192563\r\n\r\nIt is actually hiding the button since it should only be necessary to use it when no journal entry is created.', 'created_at': datetime.datetime(2025, 1, 6, 16, 42, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2576152884, 'issue_id': 2765227143, 'author': 'youcef04', 'body': '@william-andre with this fix the error is no longer displayed and the payment has been validated normally, could you merge with the branch 18.0 ?', 'created_at': datetime.datetime(2025, 1, 7, 20, 21, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2576289139, 'issue_id': 2765227143, 'author': 'william-andre', 'body': '@youcef04 it will be merged but just to make sure: you should not click on that button', 'created_at': datetime.datetime(2025, 1, 7, 21, 49, 17, tzinfo=datetime.timezone.utc)}]","william-andre on (2025-01-06 16:42:07 UTC): Here is the fix https://github.com/odoo/odoo/pull/192563

It is actually hiding the button since it should only be necessary to use it when no journal entry is created.

youcef04 (Issue Creator) on (2025-01-07 20:21:31 UTC): @william-andre with this fix the error is no longer displayed and the payment has been validated normally, could you merge with the branch 18.0 ?

william-andre on (2025-01-07 21:49:17 UTC): @youcef04 it will be merged but just to make sure: you should not click on that button

"
