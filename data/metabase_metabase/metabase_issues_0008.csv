id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2353717707,issue,open,,SQLite shouldn't appear on Cloud,"### Describe the bug

In admin/databases it is possible to select SQLite driver, but it doesn't make sense as users can't upload files to their Cloud instances.

### To Reproduce

1. Go to admin/databases
2. Click on ""Add database""
3. See SQLite as an option


### Expected behavior

It shouldn't be possible to add a SQLite database on Cloud

### Logs

_No response_

### Information about your Metabase installation

```JSON
- master
```


### Severity

P3

### Additional context

_No response_",luizarakaki,2024-06-14 16:33:25+00:00,[],2024-06-20 14:33:16+00:00,,https://github.com/metabase/metabase/issues/44233,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Database/SQLite', None), ('.Backend', ''), ('Administration/Databases', ''), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Deployment/MetabaseCloud', 'Issue only affects users of Metabase Cloud')]",[],
2353657198,issue,closed,completed,"Value of an empty datetime column is a string ""null"" instead of an actual `null`","### Describe the bug

When you click on an empty cell in a datetime column, the value is a string ""null"" instead of an actual `null`.
As @bshepherdson explained to me, this is happening because we're not converting the keyword `:null` to a JS value `null`. The implicit conversion that happens sends out a string.

### To Reproduce

> [!Important]
> You need to set the breakpoint inside `getActionOverrides` from `frontend/src/metabase/querying/utils/drills/quick-filter-drill/quick-filter-drill.tsx` 

1. Open ""Accounts"" table
2. Find an empty cell in a ""Cancelled At"" column
3. Click on it
4. The breakpoint should now be active in the debugger
5. Observe the scope and you'll see that the `value` is a string ""null""

![Screenshot 2024-06-14 at 17 52 15](https://github.com/metabase/metabase/assets/31325167/be265f4d-1b41-4ffc-bbe3-973dd603692f)



### Expected behavior

`value` should be actual JS `null`

### Logs

_No response_

### Information about your Metabase installation

local dev, `master` @6d87ed2, H2, Sample Database


### Severity

P2

### Additional context

Fixing this bug is a prerequisite for implementing #44101",nemanjaglumac,2024-06-14 15:53:52+00:00,['nemanjaglumac'],2024-08-28 02:09:56+00:00,2024-06-18 13:56:38+00:00,https://github.com/metabase/metabase/issues/44232,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.metabase-lib', 'Label for tracking all issues related to the shared CLJC metabase-lib'), ('Querying/Drill Thrus', 'Refining existing queries with Drill Thrus'), ('.Team/Querying', '')]",[],
2353630648,issue,closed,completed,Field values remapping with mixed PK and a FK targeting the same PK is broken in public dashboards,"### Describe the bug

https://metaboat.slack.com/archives/C01LQQ2UW03/p1718352501337109

Remapped field values are not shown in public dashboards when a parameter is mapped to a FK field.

### To Reproduce

#### Bug 1

When:
- A parameter is mapped to a PK and to a FK targeting this PK (different questions)
- In the PK table there is a field with the semantic type set to `type/Name`
- For the PK column `has_field_values` is set to `list`

Then:
- Parameter values are not shown in public dashboards

#### Bug 2

When:
- Same as 1, but set `has_field_values` for the FK field to `list` as well

Then:
- Dropdown values would not appear even in regular dashboards

### Expected behavior

- The parameter values endpoint should not throw an exception because it cannot combine remapped and non-remapped values. Values from multiple fields should be merged in one list.
- It should be possible to use remapped values in public dashboards as in the app.

### Logs

- 

### Information about your Metabase installation

```JSON
v50
```


### Severity

P1/P2

### Additional context

_No response_",ranquild,2024-06-14 15:37:46+00:00,"['snoe', 'ranquild']",2024-08-28 02:09:55+00:00,2024-06-20 01:19:32+00:00,https://github.com/metabase/metabase/issues/44231,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Querying/Remapping', 'Remapped display values, whether human-readable values or Field->Field remappings'), ('.Team/Querying', ''), ('Sharing/Public', '')]","[{'comment_id': 2178682975, 'issue_id': 2353630648, 'author': 'ranquild', 'body': ""Still doesn't work for one of the public dashboards https://metaboat.slack.com/archives/C01LQQ2UW03/p1718799272431319?thread_ts=1718352501.337109&cid=C01LQQ2UW03. The problem is that we only fixed it when both PK and FK columns come from questions and not from models. These lines likely cause issues https://github.com/metabase/metabase/blob/337dbbe074c9dcc06926c395607780568ea59c7d/src/metabase/api/dashboard.clj#L961 and https://github.com/metabase/metabase/blob/337dbbe074c9dcc06926c395607780568ea59c7d/src/metabase/models/params.clj#L225 It relies on integer-based field refs which is not that case with models. The BE should use the proper way of matching field references to columns (MBQL lib?).\r\n\r\nUpdated e2e test to catch the issue https://github.com/metabase/metabase/pull/44412"", 'created_at': datetime.datetime(2024, 6, 19, 13, 8, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179648089, 'issue_id': 2353630648, 'author': 'ranquild', 'body': 'Closed by https://github.com/metabase/metabase/pull/44440', 'created_at': datetime.datetime(2024, 6, 20, 1, 19, 33, tzinfo=datetime.timezone.utc)}]","ranquild (Issue Creator) on (2024-06-19 13:08:28 UTC): Still doesn't work for one of the public dashboards https://metaboat.slack.com/archives/C01LQQ2UW03/p1718799272431319?thread_ts=1718352501.337109&cid=C01LQQ2UW03. The problem is that we only fixed it when both PK and FK columns come from questions and not from models. These lines likely cause issues https://github.com/metabase/metabase/blob/337dbbe074c9dcc06926c395607780568ea59c7d/src/metabase/api/dashboard.clj#L961 and https://github.com/metabase/metabase/blob/337dbbe074c9dcc06926c395607780568ea59c7d/src/metabase/models/params.clj#L225 It relies on integer-based field refs which is not that case with models. The BE should use the proper way of matching field references to columns (MBQL lib?).

Updated e2e test to catch the issue https://github.com/metabase/metabase/pull/44412

ranquild (Issue Creator) on (2024-06-20 01:19:33 UTC): Closed by https://github.com/metabase/metabase/pull/44440

"
2353602806,issue,open,,Granular permissions for Downloads,"**Is your feature request related to a problem? Please describe.**
You might want to set a value different from 10K or 1MM rows
<img width=""177"" alt=""Screenshot 2024-06-14 at 12 20 51 PM"" src=""https://github.com/metabase/metabase/assets/132273646/ad537113-f53c-44c4-bc57-421b774a634f"">

**Describe the solution you'd like**
Ability to set a custom value to download permissions

**Describe alternatives you've considered**
n/a

**How important is this feature to you?**
Requested by a customer

**Additional context**
n/a
",ignacio-mb,2024-06-14 15:22:09+00:00,[],2025-02-04 20:30:55+00:00,,https://github.com/metabase/metabase/issues/44229,"[('Type:New Feature', ''), ('Administration/Permissions', 'Collection or Data permissions')]",[],
2353595030,issue,open,,Ability to create Public links for a specific tab,"**Is your feature request related to a problem? Please describe.**
Right now, you can create a public link for the whole dashboard
<img width=""910"" alt=""Screenshot 2024-06-14 at 12 14 34 PM"" src=""https://github.com/metabase/metabase/assets/132273646/5d0d46f8-ecc5-41be-8e83-93f7ca6d42e2"">

**Describe the solution you'd like**
Ability to create a public link for a specific tab.

**Describe alternatives you've considered**
n/a

**How important is this feature to you?**
Requested by a customer

**Additional context**
May be related to https://github.com/metabase/metabase/issues/40967, https://github.com/metabase/metabase/issues/39225 and probably https://github.com/metabase/metabase/issues/39225
",ignacio-mb,2024-06-14 15:17:26+00:00,[],2024-06-14 15:19:57+00:00,,https://github.com/metabase/metabase/issues/44228,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('.Team/Embedding', ''), ('Sharing/Public', '')]",[],
2353521281,issue,closed,completed,Missing padding from cartesian chart item labels in embedding SDK,"Chart padding was removed due to the `isEmbeddingSdk` check in `getChartPadding`, which makes it so that there is no padding between cartesian chart item labels and the dashboard card container.

```ts
const getChartPadding = ({
  isEmbeddingSdk,
  isQueryBuilder,
}: CartesianChartRootProps) => {
  if (isEmbeddingSdk) {
    return ""0rem"";
  }
  if (isQueryBuilder) {
    return ""1rem 1rem 1rem 2rem"";
  }

  return ""0.5rem 1rem"";
};
```

<img src=""https://github.com/metabase/metabase/assets/4714175/3290de30-d397-4e52-8310-82de5c4b74d8"" width=""400"">


",heypoom,2024-06-14 14:37:23+00:00,['heypoom'],2024-06-20 12:15:10+00:00,2024-06-20 12:14:59+00:00,https://github.com/metabase/metabase/issues/44226,"[('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2180524615, 'issue_id': 2353521281, 'author': 'heypoom', 'body': 'Closed by https://github.com/metabase/metabase/pull/44283', 'created_at': datetime.datetime(2024, 6, 20, 12, 15, 9, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2024-06-20 12:15:09 UTC): Closed by https://github.com/metabase/metabase/pull/44283

"
2353472509,issue,closed,completed,Restoring a bookmarked entity (dashboard/question/metric) leads to application crash,"### Describe the bug

Restoring a bookmarked metric results in an application crash (js).

https://github.com/metabase/metabase/assets/1250185/6af9bb64-ce1a-4a83-b243-06144e82120f



### To Reproduce

1. Navigate to a metric
2. Bookmark the metric
3. Move the metric to trash
4. Restore the metric



### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-06-12"",
      ""src_hash"": ""7a87e1a1173927a489fc70b6fc3e9bded123a326"",
      ""tag"": ""v1.2.0-SNAPSHOT"",
      ""hash"": ""3afe482""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P2

### Additional context

_No response_",romeovs,2024-06-14 14:11:37+00:00,['npfitz'],2024-06-20 11:59:53+00:00,2024-06-20 11:59:26+00:00,https://github.com/metabase/metabase/issues/44224,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Organization/', ''), ('.Frontend', ''), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2176047598, 'issue_id': 2353472509, 'author': 'NevRA', 'body': '@dpsutton is not related to the Metricsv2, so re-assigned AdminWebApp', 'created_at': datetime.datetime(2024, 6, 18, 13, 1, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2176145536, 'issue_id': 2353472509, 'author': 'perivamsi', 'body': 'https://github.com/metabase/metabase/assets/127636/a0d48015-a377-42c5-8095-66109d7ccf4c', 'created_at': datetime.datetime(2024, 6, 18, 13, 45, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179678081, 'issue_id': 2353472509, 'author': 'ranquild', 'body': '@npfitz can we close this issue since your PR is merged?', 'created_at': datetime.datetime(2024, 6, 20, 1, 59, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2180497896, 'issue_id': 2353472509, 'author': 'npfitz', 'body': 'Yup. PR is merged in release branch. PR to master is up and pending.', 'created_at': datetime.datetime(2024, 6, 20, 11, 59, 52, tzinfo=datetime.timezone.utc)}]","NevRA on (2024-06-18 13:01:12 UTC): @dpsutton is not related to the Metricsv2, so re-assigned AdminWebApp

perivamsi on (2024-06-18 13:45:44 UTC): https://github.com/metabase/metabase/assets/127636/a0d48015-a377-42c5-8095-66109d7ccf4c

ranquild on (2024-06-20 01:59:06 UTC): @npfitz can we close this issue since your PR is merged?

npfitz (Assginee) on (2024-06-20 11:59:52 UTC): Yup. PR is merged in release branch. PR to master is up and pending.

"
2353466091,issue,closed,completed,Saved metric didn’t appear in the list of recent items after a click on “search”,"### Describe the bug

A newly created metric does not show up in the recent items when clicking on search.

<img width=""1474"" alt=""Screenshot 2024-06-14 at 16 07 32"" src=""https://github.com/metabase/metabase/assets/1250185/22ba5dd1-8cf3-4982-aefa-f8b031a8181b"">


### To Reproduce

1. Create a new metric
2. Click on the search bar in the top menu

The new metric does not display in recent items


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-06-12"",
      ""src_hash"": ""7a87e1a1173927a489fc70b6fc3e9bded123a326"",
      ""tag"": ""v1.2.0-SNAPSHOT"",
      ""hash"": ""3afe482""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-06-14 14:08:13+00:00,['iethree'],2024-10-08 16:19:31+00:00,2024-07-26 14:37:55+00:00,https://github.com/metabase/metabase/issues/44223,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Organization/Search', ''), ('.Frontend', ''), ('.Reproduced', 'Issues reproduced in test (usually Cypress)'), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Querying/Metrics', 'v2')]","[{'comment_id': 2236264053, 'issue_id': 2353466091, 'author': 'nemanjaglumac', 'body': 'Some more context\r\nThe recents API doesn\'t return the new metric.\r\n<img width=""2056"" alt=""image"" src=""https://github.com/user-attachments/assets/3b116f51-a979-4196-960e-36f75661163b"">\r\n\r\nhttps://metaboat.slack.com/archives/C0645JP1W81/p1721300382482059', 'created_at': datetime.datetime(2024, 7, 18, 11, 25, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2248382030, 'issue_id': 2353466091, 'author': 'iethree', 'body': ""this is caused because metrics don't GET after the POST to create them, unlike questions and models:\r\n\r\nrepro: https://www.loom.com/share/1a7f078fda5f47a5a729b58f73305d99"", 'created_at': datetime.datetime(2024, 7, 24, 16, 1, 19, tzinfo=datetime.timezone.utc)}]","nemanjaglumac on (2024-07-18 11:25:44 UTC): Some more context
The recents API doesn't return the new metric.
<img width=""2056"" alt=""image"" src=""https://github.com/user-attachments/assets/3b116f51-a979-4196-960e-36f75661163b"">

https://metaboat.slack.com/archives/C0645JP1W81/p1721300382482059

iethree (Assginee) on (2024-07-24 16:01:19 UTC): this is caused because metrics don't GET after the POST to create them, unlike questions and models:

repro: https://www.loom.com/share/1a7f078fda5f47a5a729b58f73305d99

"
2353460924,issue,closed,completed,Apply font size scaling and themeable color to remaining viz types in embedding SDK,"- Funnel title color is hard-coded as ""black"", should be themeable.
- Font size scaling should apply to pivot table cell, funnel title, gauge label and chart legend item title.",heypoom,2024-06-14 14:05:23+00:00,['heypoom'],2024-10-08 17:06:45+00:00,2024-06-20 12:14:11+00:00,https://github.com/metabase/metabase/issues/44222,"[('Embedding/SDK', 'Embedding SDK for React')]",[],
2353459326,issue,closed,completed,"Submit button in ""Duplicate entity"" modal is not styled as primary","### Describe the bug

The submit button in the modal should be styled as primary on the duplicate metric modal.

<img width=""1474"" alt=""Screenshot 2024-06-14 at 16 03 01"" src=""https://github.com/metabase/metabase/assets/1250185/5bdfdcb7-7dec-4ed6-95f3-736742a8f53d"">


### To Reproduce

1. Go to a metric
2. Click on the ""..."" -> duplicate metric option

The submit button is not styled with primary

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-06-12"",
      ""src_hash"": ""7a87e1a1173927a489fc70b6fc3e9bded123a326"",
      ""tag"": ""v1.2.0-SNAPSHOT"",
      ""hash"": ""3afe482""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-06-14 14:04:31+00:00,['nemanjaglumac'],2024-07-08 15:50:11+00:00,2024-07-08 14:56:50+00:00,https://github.com/metabase/metabase/issues/44221,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]","[{'comment_id': 2214082176, 'issue_id': 2353459326, 'author': 'nemanjaglumac', 'body': 'This has nothing to do with metrics per se.\r\nThe styling of that button is the same for all entities in the duplicate modal.', 'created_at': datetime.datetime(2024, 7, 8, 13, 29, 18, tzinfo=datetime.timezone.utc)}]","nemanjaglumac (Assginee) on (2024-07-08 13:29:18 UTC): This has nothing to do with metrics per se.
The styling of that button is the same for all entities in the duplicate modal.

"
2353448347,issue,closed,completed,"""Add to dashboard"" not available for metrics ","### Describe the bug

Adding a metric to a dashboard is not available from the ""..."" menu on the metrics page

<img width=""1474"" alt=""Screenshot 2024-06-14 at 15 57 15"" src=""https://github.com/metabase/metabase/assets/1250185/dc8f905f-965e-4b16-b589-23aac8e1d1f1"">


### To Reproduce

1. Navigate to any metric
2. Click on the ""..."" button in the top right corner
3. There is no ""Add to dashboard"" option


### Expected behavior

Adding a metric to a dashboard should be possible

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-06-12"",
      ""src_hash"": ""7a87e1a1173927a489fc70b6fc3e9bded123a326"",
      ""tag"": ""v1.2.0-SNAPSHOT"",
      ""hash"": ""3afe482""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-06-14 13:58:51+00:00,['nemanjaglumac'],2024-10-08 17:04:56+00:00,2024-07-09 11:58:06+00:00,https://github.com/metabase/metabase/issues/44220,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/Querying', ''), ('Querying/Metrics', 'v2')]",[],
2353361834,issue,closed,completed,Integrate metabase with AI models,"**Describe the solution you'd like**
 * 1rst stage
Learn how the dataware house is structured. Generate information schema from the data field. Allow admins to help it understand (training).
Allow to build query in natural langage: ""I want to get all my orders of the last year"" 
 * 2nd stage
Help users to present their data using natural language: ""I want in a bar chart the number of order each month""
 * 3nd stage
Mix them all: ""I want a chart with the number of order by month this year compared with last year.""

**Describe alternatives you've considered**
SQLAI. Excel Copilote. PandsAI. MindsDB.

**How important is this feature to you?**
Ready to pay for, while now we are on Free on promise system.
",e-gaulue,2024-06-14 13:15:26+00:00,[],2024-12-30 15:43:32+00:00,2024-12-30 15:43:30+00:00,https://github.com/metabase/metabase/issues/44214,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2395068438, 'issue_id': 2353361834, 'author': 'samtuke', 'body': 'I would guess most Metabase users want AI features. Any news?', 'created_at': datetime.datetime(2024, 10, 5, 14, 0, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2395949622, 'issue_id': 2353361834, 'author': 'paoliniluis', 'body': 'Please check our roadmap', 'created_at': datetime.datetime(2024, 10, 7, 5, 37, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2407266271, 'issue_id': 2353361834, 'author': 'mjftw', 'body': 'Just to add to this - this is also a feature my company is likely to be willing to pay for!', 'created_at': datetime.datetime(2024, 10, 11, 12, 1, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2565641462, 'issue_id': 2353361834, 'author': 'brunobergher', 'body': 'Duplicate of #38272', 'created_at': datetime.datetime(2024, 12, 30, 15, 43, 30, tzinfo=datetime.timezone.utc)}]","samtuke on (2024-10-05 14:00:58 UTC): I would guess most Metabase users want AI features. Any news?

paoliniluis on (2024-10-07 05:37:09 UTC): Please check our roadmap

mjftw on (2024-10-11 12:01:54 UTC): Just to add to this - this is also a feature my company is likely to be willing to pay for!

brunobergher on (2024-12-30 15:43:30 UTC): Duplicate of #38272

"
2353234019,issue,closed,completed,Edit question option on dashboard card for metrics does not make sense ,"### Describe the bug

The context menu for metrics on a dashboard contains the option ""Edit question"", this does not make sense.

<img width=""643"" alt=""Screenshot 2024-06-14 at 14 06 11"" src=""https://github.com/metabase/metabase/assets/1250185/669ccfd3-10f3-4fcf-9977-215ab51b43b0"">


### To Reproduce

1. Create a metric and add it to a dashboard
2. Visit the 
4. Click the ""..."" context menu on the dashboard card
5. It has the ""Edit question"" option


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-06-12"",
      ""src_hash"": ""7a87e1a1173927a489fc70b6fc3e9bded123a326"",
      ""tag"": ""v1.2.0-SNAPSHOT"",
      ""hash"": ""3afe482""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-06-14 12:08:53+00:00,[],2024-10-08 16:13:42+00:00,2024-10-03 07:12:03+00:00,https://github.com/metabase/metabase/issues/44211,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Product Input Needed', ''), ('.Team/Querying', ''), ('Querying/Metrics', 'v2')]","[{'comment_id': 2390687065, 'issue_id': 2353234019, 'author': 'romeovs', 'body': 'Closing this as a dupe of https://github.com/metabase/metabase/issues/44168', 'created_at': datetime.datetime(2024, 10, 3, 7, 12, 3, tzinfo=datetime.timezone.utc)}]","romeovs (Issue Creator) on (2024-10-03 07:12:03 UTC): Closing this as a dupe of https://github.com/metabase/metabase/issues/44168

"
2353221034,issue,open,,Metrics do not have caching policy on Enterprise,"### Describe the bug

Metrics do not have a caching policy option when editing the info.

### To Reproduce

1. Create a metric
2. Navigate to the created metric
3. Click the ""i"" info icon
4. There is no ""Caching policy"" option like for questions.

![image](https://github.com/metabase/metabase/assets/1250185/101b4bd7-1663-492c-81bf-5dd9af2eaebc)


https://github.com/metabase/metabase/assets/1250185/3f48ae77-53b1-4667-9616-286890e17eca




### Expected behavior

Metrics should have a caching policy.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-06-12"",
      ""src_hash"": ""7a87e1a1173927a489fc70b6fc3e9bded123a326"",
      ""tag"": ""v1.2.0-SNAPSHOT"",
      ""hash"": ""3afe482""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```




### Severity

P2

### Additional context

_No response_",romeovs,2024-06-14 12:01:29+00:00,[],2025-02-04 20:29:26+00:00,,https://github.com/metabase/metabase/issues/44210,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Difficulty:Hard', ''), ('.Backend', ''), ('.Team/Querying', ''), ('Querying/Metrics', 'v2'), ('Semantic Model', '')]","[{'comment_id': 2340779318, 'issue_id': 2353221034, 'author': 'romeovs', 'body': 'Seems like this is no longer an issue on `master` at `82b13c25306e96df71340ec9337ddc0491a9b5be`.\r\n\r\n<img width=""1474"" alt=""Screenshot 2024-09-10 at 15 25 26"" src=""https://github.com/user-attachments/assets/4fe5e0b3-9301-4d51-a95a-8b4457f997c6"">', 'created_at': datetime.datetime(2024, 9, 10, 13, 25, 54, tzinfo=datetime.timezone.utc)}]","romeovs (Issue Creator) on (2024-09-10 13:25:54 UTC): Seems like this is no longer an issue on `master` at `82b13c25306e96df71340ec9337ddc0491a9b5be`.

<img width=""1474"" alt=""Screenshot 2024-09-10 at 15 25 26"" src=""https://github.com/user-attachments/assets/4fe5e0b3-9301-4d51-a95a-8b4457f997c6"">

"
2353204366,issue,closed,completed,Refreshing the page takes us to visualisation instead of back to the query builder when creating a metric,"### Describe the bug


https://github.com/metabase/metabase/assets/1250185/b99024ee-648d-4809-91f7-876a0899c1f8



### To Reproduce

- Create a metric and save it as “Metric A”
- Click “+ New” → “Metric”
- In the query builder, refresh the page
- After refreshing, select the metric you just saved as starting data
- The query builder closes and we end up on the metric’s viz page

### Expected behavior

The query builder should remain open.

### Logs

_No response_

### Information about your Metabase installation

```JSON
- `master` at `d7a1e86798ba01c8c013d1f5cd855f7c4f1b1870`

{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-06-12"",
      ""src_hash"": ""7a87e1a1173927a489fc70b6fc3e9bded123a326"",
      ""tag"": ""v1.2.0-SNAPSHOT"",
      ""hash"": ""3afe482""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-06-14 11:51:30+00:00,[],2024-06-21 01:02:29+00:00,2024-06-21 01:02:17+00:00,https://github.com/metabase/metabase/issues/44209,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Team/Querying', ''), ('Querying/Metrics', 'v2')]","[{'comment_id': 2181799739, 'issue_id': 2353204366, 'author': 'ranquild', 'body': 'This is how it works in all other cases', 'created_at': datetime.datetime(2024, 6, 21, 1, 2, 28, tzinfo=datetime.timezone.utc)}]","ranquild on (2024-06-21 01:02:28 UTC): This is how it works in all other cases

"
2353175850,issue,closed,not_planned,Drills are shown for native models,"### Describe the bug

https://github.com/metabase/metabase/assets/6830683/6aa5a72a-d755-47c2-ad89-a770e0e6df60



### To Reproduce

1. Create a native model, `select 1 as A, 2 as B, 3 as C`, run it, save it
2. Edit model's metadata
3. Map all 3 fields to the same db field (e.g. Orders > Id)
4. Give fields unique names to make it easy to spot the issue (e.g. ID1, ID2, ID3)
5. Save metadata


### Expected behavior

Drills are not shown for native models

### Information about your Metabase installation

master, a8d5ea6437


### Severity

P2
",kamilmielnik,2024-06-14 11:33:57+00:00,[],2025-01-16 20:53:15+00:00,2025-01-16 20:53:13+00:00,https://github.com/metabase/metabase/issues/44207,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/MBQL', ''), ('.Backend', ''), ('Querying/Models', 'aka Datasets'), ('Querying/Drill Thrus', 'Refining existing queries with Drill Thrus'), ('.Team/Querying', ''), ('Semantic Model', ''), ('Semantic Model/Models', '')]","[{'comment_id': 2596867642, 'issue_id': 2353175850, 'author': 'ranquild', 'body': 'Totally expected now', 'created_at': datetime.datetime(2025, 1, 16, 20, 53, 13, tzinfo=datetime.timezone.utc)}]","ranquild on (2025-01-16 20:53:13 UTC): Totally expected now

"
2352960193,issue,closed,not_planned,[Flaky Test]: Modal should automatically switch to the search tab when a search query is provided,"Last Flake: https://github.com/metabase/metabase/actions/runs/9495280900
Last Flake Time: 2024-06-13T00:27:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 2
Flakes in the last 7d: 5",github-automation-metabase,2024-06-14 09:34:46+00:00,[],2024-12-13 16:44:00+00:00,2024-12-13 16:44:00+00:00,https://github.com/metabase/metabase/issues/44202,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2352906090,issue,closed,completed,Fix failures due to false positives on reserved SQL keywords,"An example issue that is affecting a number of Cards on the Stats server, is that `FINAL` is a reserved word for Oracle, but is being used as an alias in some Postgres queries.

1. Identify which sometimes-reserved keywords are not relevant for the given query.
2. Escape those keywords using sentinels.
3. ... do the things
4. Replace the sentinels with the original identifiers.

For now we can hard code some keywords, then the next step is to make that a static driver multimethod, then the last step would be to use the version number, or an active database connection, to determine the 100% current reserved words for the corresponding database.",crisptrutski,2024-06-14 09:06:23+00:00,[],2024-06-27 10:38:52+00:00,2024-06-26 11:36:34+00:00,https://github.com/metabase/metabase/issues/44200,"[('.Backend', ''), ('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]",[],
2352903149,issue,closed,completed,[ParseSQL] Robustness of Query Analysis,"### Description

While we catch all errors encountered during analysis, the first prize is to not have the errors in the first place.

There are a few prongs to our defense:
 
### 1. Don't analyze things we know we can't support, e.g. MongoDB queries.

```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/pull/44350
```

### 2. Identify and fix bugs due to problems with our grammar.

These may require workarounds for now since we are using a 3rd party grammar, e.g. by de-then-re-sugaring with sentinels.

```[tasklist]
- [ ] https://github.com/metabase/metabase/issues/44062
- [ ] https://github.com/metabase/macaw/issues/72
- [ ] https://github.com/metabase/macaw/issues/42
- [ ] https://github.com/metabase/metabase/issues/44200
```

#### Deferred

- https://github.com/metabase/macaw/issues/76 (unlikely to be used by customers)
- https://github.com/metabase/macaw/issues/73 (affects only small percent of queries using)
- https://github.com/metabase/macaw/issues/75

### 3. Identify and fix bugs due to problems with our analysis.

Thankfully nothing like this has come up yet, but here's an empty section so we remember to look out for it.

```[tasklist]
- [x] Found some NPEs and fixed them
```",crisptrutski,2024-06-14 09:04:51+00:00,['crisptrutski'],2024-07-30 20:19:56+00:00,2024-07-24 12:18:04+00:00,https://github.com/metabase/metabase/issues/44199,"[('.Epic', 'Feature Implementation or Project'), ('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]",[],
2352648632,issue,closed,not_planned,Data Sync Issue - Scheduled Job Sync Fails  - 'Triggers for metabase.task.sync-and-analyse.job',"**Description:**
Data is not syncing as per scheduled timing from the database to Metabase, resulting in the latest data not being updated in the reports and dashboards. This issue also leads to a slowdown in Metabase performance. Monitoring shows no CPU or memory issues, but restarting the service resolves the problem temporarily. This recurring issue is impacting Metabase usage, making it difficult to restart the service every time. 

**Expected Behavior:**
The latest data should sync from the database to Metabase according to the schedule, and the reports and dashboards should be updated without any performance degradation.

**Actual Behavior:**
Data does not sync as scheduled.
Reports and dashboards do not reflect the latest data.
Metabase performance degrades.
Issue temporarily resolves upon restarting the service.

**Screenshots:**
![image](https://github.com/metabase/metabase/assets/172746072/74960663-fec9-44a3-9e23-bad66264e152)
As per the attached screenshot, the job with the key metabase.task.sync-and-analyze.job is reflecting a state of 'Blocked', while other job states are normal. If this is causing the issue, please guide us on how to resolve it.

**Severity:**
How severe an issue is this bug to you? 
It is blocking our usage of Metabase due to Performance Degradation.

**Note:**
Screenshots, logs, or additional context can be provided if needed.

**Metabase Diagnostic Info:**
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""Java(TM) SE Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+9-LTS-219"",
    ""java.vendor"": ""Oracle Corporation"",
    ""java.vendor.url"": ""https://openjdk.java.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""Java HotSpot(TM) 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+9-LTS-219"",
    ""os.name"": ""Linux"",
    ""os.version"": ""3.10.0-1062.9.1.el7.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Asia/Kolkata""
  },
  ""metabase-info"": {
    ""databases"": [
      ""sqlserver"",
      ""postgres"",
      ""oracle"",
      ""mysql"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.8""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.5.4""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2023-09-07"",
      ""tag"": ""v0.47.1"",
      ""branch"": ""release-x.47.x"",
      ""hash"": ""bd278b9""
    },
    ""settings"": {
      ""report-timezone"": ""Asia/Calcutta""
    }
  }
}



",Suchithra-Suresh,2024-06-14 06:45:51+00:00,['qnkhuat'],2024-07-31 02:21:41+00:00,2024-07-31 02:21:41+00:00,https://github.com/metabase/metabase/issues/44194,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Performance', ''), ('Administration/Metadata & Sync', ''), ('.Backend', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2167594175, 'issue_id': 2352648632, 'author': 'darksciencebase', 'body': '@Suchithra-Suresh could you see if the issue is still there with a newer version like 49.16?', 'created_at': datetime.datetime(2024, 6, 14, 9, 8, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2167660265, 'issue_id': 2352648632, 'author': 'Suchithra-Suresh', 'body': ""We haven't checked it yet, but we have been facing this issue recently. Could you please guide us on how to troubleshoot this.\r\nIs this a known issue? If yes, could you please explain it to us?"", 'created_at': datetime.datetime(2024, 6, 14, 9, 45, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2167754156, 'issue_id': 2352648632, 'author': 'qnkhuat', 'body': ""It's often hard for us to debug an older version, especially when you're 3 major versions apart from the latest. \r\n\r\nIf feels like what you're seeing here is this issue: https://github.com/quartz-scheduler/quartz/issues/145.\r\n\r\nCould you give us a dump of this query?\r\n\r\n```sql\r\nselect * from qrtz_triggers where job_name = 'metabase.task.sync-and-analyze.job';\r\n```\r\nBefore and after you restart Metabase?\r\n\r\nAnd also another dump of the task history.\r\n\r\n```sql\r\n select * from task_history where started_at > current_date - interval '14 days' order by started_at desc;\r\n```"", 'created_at': datetime.datetime(2024, 6, 14, 10, 41, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168246545, 'issue_id': 2352648632, 'author': 'Suchithra-Suresh', 'body': 'Hi ,\r\nPlease do find the Dump details here ,\r\n[Metabase Trigger job details.xlsx](https://github.com/user-attachments/files/15839973/Metabase.Trigger.job.details.xlsx)', 'created_at': datetime.datetime(2024, 6, 14, 15, 12, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2172334672, 'issue_id': 2352648632, 'author': 'qnkhuat', 'body': ""I suspect this is a performance issue. Here is what I see:\r\n- You have 49 dbs, out of which, 36 dbs are being synced on the 14th. So it crosses out the quartz#145 bug.\r\n- On 13th, your instance ran 68 hours of background jobs in total\r\n- You also mentioned the overall performance of Metabase is degraded\r\n\r\nSo it's possible that some DBs are not being synced because the background thread pool is too busy.\r\n\r\nI suggest you try these options:\r\n- Upgrade to the latest MB version, we have lots of performance improvements on 49\r\n- Scale up your instance\r\n- Give quartz a bigger thread pool by running with `-Dorg.quartz.threadPool.threadCount=20` (the default is 10)"", 'created_at': datetime.datetime(2024, 6, 17, 5, 43, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2172468253, 'issue_id': 2352648632, 'author': 'Suchithra-Suresh', 'body': ""Thank you for the suggestions! I appreciate the guidance.\r\n\r\nI will proceed with upgrading to the latest MB version to leverage the performance improvements in version 49. \r\nAdditionally, I will scale up the instance and give Quartz a bigger thread pool by running with -Dorg.quartz.threadPool.threadCount=20.\r\n\r\nI'll let you know how it works post-upgrade.\r\n\r\nThanks again!"", 'created_at': datetime.datetime(2024, 6, 17, 7, 12, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2181944113, 'issue_id': 2352648632, 'author': 'qnkhuat', 'body': '@Suchithra-Suresh how is it going?', 'created_at': datetime.datetime(2024, 6, 21, 3, 41, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2186148353, 'issue_id': 2352648632, 'author': 'Suchithra-Suresh', 'body': 'Hi Team, \r\n\r\nWe have installed version 49 and are currently testing it. In the meantime, could we get information on the basic database configuration and instance setup for version 49? This information will help us scale up our instance.', 'created_at': datetime.datetime(2024, 6, 24, 10, 5, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2186430456, 'issue_id': 2352648632, 'author': 'qnkhuat', 'body': 'Please take a look at https://www.metabase.com/learn/administration/metabase-in-production ?', 'created_at': datetime.datetime(2024, 6, 24, 12, 10, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2217866491, 'issue_id': 2352648632, 'author': 'qnkhuat', 'body': '@Suchithra-Suresh any progress?', 'created_at': datetime.datetime(2024, 7, 9, 14, 18, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2220368618, 'issue_id': 2352648632, 'author': 'Suchithra-Suresh', 'body': 'Hi Team, \r\n\r\nThank you for inquiring. Currently, we are monitoring version 0.49 with an increased pool size and threads. We need some more time for testing and will reach out if we encounter any issues.', 'created_at': datetime.datetime(2024, 7, 10, 12, 20, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2259514420, 'issue_id': 2352648632, 'author': 'qnkhuat', 'body': ""I'll close this, as it's been a while. Please re-open if you encounter this issue again."", 'created_at': datetime.datetime(2024, 7, 31, 2, 21, 41, tzinfo=datetime.timezone.utc)}]","darksciencebase on (2024-06-14 09:08:34 UTC): @Suchithra-Suresh could you see if the issue is still there with a newer version like 49.16?

Suchithra-Suresh (Issue Creator) on (2024-06-14 09:45:21 UTC): We haven't checked it yet, but we have been facing this issue recently. Could you please guide us on how to troubleshoot this.
Is this a known issue? If yes, could you please explain it to us?

qnkhuat (Assginee) on (2024-06-14 10:41:55 UTC): It's often hard for us to debug an older version, especially when you're 3 major versions apart from the latest. 

If feels like what you're seeing here is this issue: https://github.com/quartz-scheduler/quartz/issues/145.

Could you give us a dump of this query?

```sql
select * from qrtz_triggers where job_name = 'metabase.task.sync-and-analyze.job';
```
Before and after you restart Metabase?

And also another dump of the task history.

```sql
 select * from task_history where started_at > current_date - interval '14 days' order by started_at desc;
```

Suchithra-Suresh (Issue Creator) on (2024-06-14 15:12:22 UTC): Hi ,
Please do find the Dump details here ,
[Metabase Trigger job details.xlsx](https://github.com/user-attachments/files/15839973/Metabase.Trigger.job.details.xlsx)

qnkhuat (Assginee) on (2024-06-17 05:43:59 UTC): I suspect this is a performance issue. Here is what I see:
- You have 49 dbs, out of which, 36 dbs are being synced on the 14th. So it crosses out the quartz#145 bug.
- On 13th, your instance ran 68 hours of background jobs in total
- You also mentioned the overall performance of Metabase is degraded

So it's possible that some DBs are not being synced because the background thread pool is too busy.

I suggest you try these options:
- Upgrade to the latest MB version, we have lots of performance improvements on 49
- Scale up your instance
- Give quartz a bigger thread pool by running with `-Dorg.quartz.threadPool.threadCount=20` (the default is 10)

Suchithra-Suresh (Issue Creator) on (2024-06-17 07:12:48 UTC): Thank you for the suggestions! I appreciate the guidance.

I will proceed with upgrading to the latest MB version to leverage the performance improvements in version 49. 
Additionally, I will scale up the instance and give Quartz a bigger thread pool by running with -Dorg.quartz.threadPool.threadCount=20.

I'll let you know how it works post-upgrade.

Thanks again!

qnkhuat (Assginee) on (2024-06-21 03:41:15 UTC): @Suchithra-Suresh how is it going?

Suchithra-Suresh (Issue Creator) on (2024-06-24 10:05:01 UTC): Hi Team, 

We have installed version 49 and are currently testing it. In the meantime, could we get information on the basic database configuration and instance setup for version 49? This information will help us scale up our instance.

qnkhuat (Assginee) on (2024-06-24 12:10:23 UTC): Please take a look at https://www.metabase.com/learn/administration/metabase-in-production ?

qnkhuat (Assginee) on (2024-07-09 14:18:43 UTC): @Suchithra-Suresh any progress?

Suchithra-Suresh (Issue Creator) on (2024-07-10 12:20:24 UTC): Hi Team, 

Thank you for inquiring. Currently, we are monitoring version 0.49 with an increased pool size and threads. We need some more time for testing and will reach out if we encounter any issues.

qnkhuat (Assginee) on (2024-07-31 02:21:41 UTC): I'll close this, as it's been a while. Please re-open if you encounter this issue again.

"
2352389559,issue,closed,completed,Fix spaces in dashboard move toast,"

![Image](https://github.com/metabase/metabase/assets/130925/7ddcf6c8-df55-44ca-93e6-6ed213916599)

",rafpaf,2024-06-14 03:01:18+00:00,[],2024-06-17 07:07:48+00:00,2024-06-14 21:18:00+00:00,https://github.com/metabase/metabase/issues/44192,"[('.Frontend', '')]",[],
2352381791,issue,closed,not_planned,"Prototype a simpler cache overrides table: a list of links to questions and dashboards, where each link is a deeplink to the cache settings sidebar",,rafpaf,2024-06-14 02:53:20+00:00,[],2024-06-14 02:53:36+00:00,2024-06-14 02:53:28+00:00,https://github.com/metabase/metabase/issues/44190,[],[],
2352313189,issue,closed,not_planned,"Table doesn't sync if a JSON field has the same name as a column, with JSON unfolding on","**Describe the bug**
We currently use pgvector (https://github.com/pgvector/pgvector) in our postgres database, adding the fields `vector` and `aggregated_vector` to several tables, along with the HNSW indexes. I've noticed that these tables are not importing their fields schema at all, while our other tables are loading fine  There's a lot of errors logged like the ones below.

I'm guessing we just need a way to exclude/ignore the vector fields and their indexes from the schema import.

**Logs**
Linked as they are too long for github issues
https://docs.google.com/document/d/1KPBglnkIitEEELmtk4bg2agn2add7fgrBKx6wfNybr8/edit?usp=sharing

**To Reproduce**
Steps to reproduce the behavior:
1. Set up Metabase
2. Set up a postgres database with pgvector
3. Add `vector` fields and include calculated vectors.
4. Connect database to metabase.

**Expected behavior**
Tables should import correctly for use in metabase

**Severity**
This is entirely blocking our metabase usage as the vectorized tables are critical for our use case.

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""4.4.0"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""12.17""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-13"",
      ""tag"": ""v0.50.3"",
      ""hash"": ""855535b""
    },
    ""settings"": {
      ""report-timezone"": ""US/Eastern""
    }
  }
}
```",dustinblanchard,2024-06-14 01:38:21+00:00,[],2024-07-09 00:16:42+00:00,2024-07-09 00:16:42+00:00,https://github.com/metabase/metabase/issues/44188,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Database/Postgres', None), ('Administration/Metadata & Sync', ''), ('.Backend', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2168697197, 'issue_id': 2352313189, 'author': 'calherries', 'body': '@dustinblanchard I tested pgvector 0.7.2 with version 50.3, and the table metadata sync works just fine. This is what I did to set up a table before syncing it:\r\n\r\n```\r\nCREATE EXTENSION IF NOT EXISTS vector;\r\nCREATE TABLE items (id bigserial PRIMARY KEY, embedding vector(3));\r\nINSERT INTO items (embedding) VALUES (\'[1,2,3]\'), (\'[4,5,6]\');\r\nCREATE INDEX items_embedding_idx ON items USING hnsw (embedding vector_l2_ops);\r\n```\r\n\r\nCan you confirm you can create such a table and sync its metadata with Metabase correctly?\r\n\r\nIn the logs you attached, I notice Metabase is picking up two instances of a column name ""vector"":\r\n```\r\nError checking if Fields (""vector"" ""aggregate_vector"" ""vector"" ""ai_processing_status"" ""name"" ""pg_vector"" ""vector_uuid"" ""id"" ""pg_aggregate_vector"") need to be created or reactivated\r\n```\r\nMetabase doesn\'t allow syncing tables with duplicate column names for obvious reasons: there\'s no way to disambiguate them. So, can you help explain why Metabase might be picking up on two ""vector"" columns in the same table? Maybe there\'s something to the table beyond what I\'ve demonstrated above.', 'created_at': datetime.datetime(2024, 6, 14, 20, 13, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168703031, 'issue_id': 2352313189, 'author': 'calherries', 'body': ""(I'm lowering this to P2, because it's doesn't seem to be an issue with pgvector in general, only this particular setup)"", 'created_at': datetime.datetime(2024, 6, 14, 20, 15, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168749107, 'issue_id': 2352313189, 'author': 'dustinblanchard', 'body': 'That is extremely strange as we don\'t have any tables with two columns named ""vector"", and this seems to be happening on all models where the vector fields are present. \r\n\r\nIs there anything else that could cause metabase to load in a column name that doesn\'t explicitly exist like that?', 'created_at': datetime.datetime(2024, 6, 14, 20, 53, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2169003762, 'issue_id': 2352313189, 'author': 'calherries', 'body': 'Okay thanks, I\'ve had a closer look again at your stack trace and I see now that you have a column called ""vector"" with a JSONB type and JSON unfolding is enabled on that field. When JSON unfolding is enabled Metabase considers each field inside the JSON values as a separate column. And it looks like we\'ve detected a field _inside_ the JSONB column called ""vector"", which we\'re pulling out and trying to make a separate column out of.\r\n\r\nHaving a field in a JSON structure with the same name as a column in the table is indeed a thorny edge-case with JSON unfolding, and we\'ll have to fix that.\r\n\r\nBut for your case, if you can get away with turning off JSON unfolding, it should fix your issue. There are two workarounds you can try: either (a) disable JSON unfolding for the database, or (b) disable JSON unfolding for each JSON column with ""vector"" as one of the fields in the values. [The docs](https://www.metabase.com/docs/latest/data-modeling/json-unfolding#toggling-json-unfolding-for-a-database) on working with JSON might be helpful.', 'created_at': datetime.datetime(2024, 6, 15, 0, 51, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2169092542, 'issue_id': 2352313189, 'author': 'dustinblanchard', 'body': 'Thank you! Disabling Unfolding did the trick! Sorry for the initial false assumption about the cause.', 'created_at': datetime.datetime(2024, 6, 15, 3, 50, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2181954153, 'issue_id': 2352313189, 'author': 'qnkhuat', 'body': '@calherries do you think this is the same bug as https://github.com/metabase/metabase/issues/44459 ?', 'created_at': datetime.datetime(2024, 6, 21, 3, 55, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2183077776, 'issue_id': 2352313189, 'author': 'calherries', 'body': 'Yeah good spotting, Dustin\'s issue was created by the fact that there was a value in a JSON array that had the name ""vector"". But it\'s still possible for a JSON field to have the same name as a column, and to cause the same error. I think it\'s worth keeping this issue open until that\'s solved.', 'created_at': datetime.datetime(2024, 6, 21, 16, 36, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2215671421, 'issue_id': 2352313189, 'author': 'calherries', 'body': '> But it\'s still possible for a JSON field to have the same name as a column, and to cause the same error. \r\n\r\nActually, I assumed wrong. I just tested this exact case and it\'s so unlikely I think we can just ignore it for now. A JSON field has a `:name` value that has arrows in it mimicking the path, e.g. ""a → b"". Because of these arrows it seems unlikely that there will be a top-level column with the same name.', 'created_at': datetime.datetime(2024, 7, 9, 0, 15, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2215678375, 'issue_id': 2352313189, 'author': 'calherries', 'body': ""Closing this because the original issue is solved. It's a dupe of https://github.com/metabase/metabase/issues/44459"", 'created_at': datetime.datetime(2024, 7, 9, 0, 16, 42, tzinfo=datetime.timezone.utc)}]","calherries on (2024-06-14 20:13:11 UTC): @dustinblanchard I tested pgvector 0.7.2 with version 50.3, and the table metadata sync works just fine. This is what I did to set up a table before syncing it:

```
CREATE EXTENSION IF NOT EXISTS vector;
CREATE TABLE items (id bigserial PRIMARY KEY, embedding vector(3));
INSERT INTO items (embedding) VALUES ('[1,2,3]'), ('[4,5,6]');
CREATE INDEX items_embedding_idx ON items USING hnsw (embedding vector_l2_ops);
```

Can you confirm you can create such a table and sync its metadata with Metabase correctly?

In the logs you attached, I notice Metabase is picking up two instances of a column name ""vector"":
```
Error checking if Fields (""vector"" ""aggregate_vector"" ""vector"" ""ai_processing_status"" ""name"" ""pg_vector"" ""vector_uuid"" ""id"" ""pg_aggregate_vector"") need to be created or reactivated
```
Metabase doesn't allow syncing tables with duplicate column names for obvious reasons: there's no way to disambiguate them. So, can you help explain why Metabase might be picking up on two ""vector"" columns in the same table? Maybe there's something to the table beyond what I've demonstrated above.

calherries on (2024-06-14 20:15:41 UTC): (I'm lowering this to P2, because it's doesn't seem to be an issue with pgvector in general, only this particular setup)

dustinblanchard (Issue Creator) on (2024-06-14 20:53:08 UTC): That is extremely strange as we don't have any tables with two columns named ""vector"", and this seems to be happening on all models where the vector fields are present. 

Is there anything else that could cause metabase to load in a column name that doesn't explicitly exist like that?

calherries on (2024-06-15 00:51:08 UTC): Okay thanks, I've had a closer look again at your stack trace and I see now that you have a column called ""vector"" with a JSONB type and JSON unfolding is enabled on that field. When JSON unfolding is enabled Metabase considers each field inside the JSON values as a separate column. And it looks like we've detected a field _inside_ the JSONB column called ""vector"", which we're pulling out and trying to make a separate column out of.

Having a field in a JSON structure with the same name as a column in the table is indeed a thorny edge-case with JSON unfolding, and we'll have to fix that.

But for your case, if you can get away with turning off JSON unfolding, it should fix your issue. There are two workarounds you can try: either (a) disable JSON unfolding for the database, or (b) disable JSON unfolding for each JSON column with ""vector"" as one of the fields in the values. [The docs](https://www.metabase.com/docs/latest/data-modeling/json-unfolding#toggling-json-unfolding-for-a-database) on working with JSON might be helpful.

dustinblanchard (Issue Creator) on (2024-06-15 03:50:13 UTC): Thank you! Disabling Unfolding did the trick! Sorry for the initial false assumption about the cause.

qnkhuat on (2024-06-21 03:55:24 UTC): @calherries do you think this is the same bug as https://github.com/metabase/metabase/issues/44459 ?

calherries on (2024-06-21 16:36:10 UTC): Yeah good spotting, Dustin's issue was created by the fact that there was a value in a JSON array that had the name ""vector"". But it's still possible for a JSON field to have the same name as a column, and to cause the same error. I think it's worth keeping this issue open until that's solved.

calherries on (2024-07-09 00:15:31 UTC): Actually, I assumed wrong. I just tested this exact case and it's so unlikely I think we can just ignore it for now. A JSON field has a `:name` value that has arrows in it mimicking the path, e.g. ""a → b"". Because of these arrows it seems unlikely that there will be a top-level column with the same name.

calherries on (2024-07-09 00:16:42 UTC): Closing this because the original issue is solved. It's a dupe of https://github.com/metabase/metabase/issues/44459

"
2351986898,issue,closed,completed,Waterfall tool-tips do not correctly apply column value scaling,"Tool-tip values are being displayed without the column value scaling applied. This results in data labels being inconsistent with tooltip values.

```SQL
select 'Apples' as product, 10 as profit
union all
select 'Bananas' as product, -4 as profit
union all
select 'Oranges' as product, 15 as profit
union all
select 'Peaches' as product, -7 as profit
union all
select 'Mangos' as product, 2 as profit
```


![image](https://github.com/metabase/metabase/assets/22608765/10329d58-ead6-4dd7-9aff-5334845aee0b)
",JesseSDevaney,2024-06-13 20:22:02+00:00,['JesseSDevaney'],2024-06-15 01:38:49+00:00,2024-06-15 00:12:55+00:00,https://github.com/metabase/metabase/issues/44176,"[('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2351894594,issue,closed,completed,Do not set visualization_settings coming from adhoc query execution for the metric itself,"From the [metrics bug bash](https://www.notion.so/metabase/Metrics-Bug-Bash-3ae3613f4fff4d82ba95f187b9e4361c#000cc21d3c6d41f2aee010e6e5d99622):

Cannot combine metrics in a dashboard - broken viz settings
  - New → Metric, Orders, Count, Created At → Save as Metric 1 **without previewing**
  - New → Metric, Orders, Count, Created At → Save as Metric 2 without previewing
  - Now click on the run button and see the results for Metric 2
  - Click “Edit query definition” and change “Count” to “Sum of Total” and save the query **without previewing**
  - Create a dashboard and add Metric 1
  - Hover → Add series → See you don’t have Metric 2 in the list
  - The problem is that visualization_settings for an ad-hoc question created for Metric 2 got saved for the metric itself",ranquild,2024-06-13 19:21:19+00:00,['romeovs'],2024-10-15 12:49:23+00:00,2024-10-14 14:18:29+00:00,https://github.com/metabase/metabase/issues/44171,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Team/Querying', ''), ('Querying/Metrics', 'v2')]",[],
2351894531,issue,closed,completed,Fix bookmarking and trashing metrics,https://www.notion.so/metabase/Metrics-Bug-Bash-3ae3613f4fff4d82ba95f187b9e4361c?pvs=4#c6cc07d13e034e889a8062bda041ae7e,ranquild,2024-06-13 19:21:16+00:00,[],2024-10-01 15:34:58+00:00,2024-10-01 15:34:58+00:00,https://github.com/metabase/metabase/issues/44170,[],"[{'comment_id': 2386346306, 'issue_id': 2351894531, 'author': 'romeovs', 'body': 'This one was closed in https://github.com/metabase/metabase/pull/44414', 'created_at': datetime.datetime(2024, 10, 1, 15, 34, 58, tzinfo=datetime.timezone.utc)}]","romeovs on (2024-10-01 15:34:58 UTC): This one was closed in https://github.com/metabase/metabase/pull/44414

"
2351894451,issue,closed,completed,“Add to dashboard” button not available for models and metrics in “…” menu on /metric/:id page,,ranquild,2024-06-13 19:21:13+00:00,[],2024-10-04 17:01:52+00:00,2024-10-04 17:01:50+00:00,https://github.com/metabase/metabase/issues/44169,"[('.Frontend', '')]","[{'comment_id': 2392043183, 'issue_id': 2351894451, 'author': 'romeovs', 'body': 'I can no longer reproduce this on `master` at 0d27f8749c066be1711d60a2e61829510d97c166', 'created_at': datetime.datetime(2024, 10, 3, 18, 20, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2394143027, 'issue_id': 2351894451, 'author': 'mngr', 'body': ""Doesn't reproduce"", 'created_at': datetime.datetime(2024, 10, 4, 17, 1, 50, tzinfo=datetime.timezone.utc)}]","romeovs on (2024-10-03 18:20:18 UTC): I can no longer reproduce this on `master` at 0d27f8749c066be1711d60a2e61829510d97c166

mngr on (2024-10-04 17:01:50 UTC): Doesn't reproduce

"
2351894237,issue,closed,completed,"Dashcard > “…” > Edit question - it does not make sense for models and metrics, we should navigate user to edit query definition instead",,ranquild,2024-06-13 19:21:04+00:00,['romeovs'],2024-10-08 16:13:41+00:00,2024-10-03 13:34:48+00:00,https://github.com/metabase/metabase/issues/44168,"[('Reporting/Dashboards', '')]",[],
2351892789,issue,closed,completed,[Epic] Fix metrics v2 FE issues,"Doc https://www.notion.so/metabase/Metrics-Bug-Bash-3ae3613f4fff4d82ba95f187b9e4361c

Please note that not everything from the doc needs ""fixing""

```[tasklist]
- [ ] https://github.com/metabase/metabase/issues/44168
- [ ] https://github.com/metabase/metabase/issues/44169
- [ ] https://github.com/metabase/metabase/issues/44170
- [ ] https://github.com/metabase/metabase/issues/44171
```",ranquild,2024-06-13 19:20:04+00:00,[],2025-01-06 14:44:08+00:00,2025-01-06 14:44:08+00:00,https://github.com/metabase/metabase/issues/44167,"[('.Frontend', ''), ('.Epic', 'Feature Implementation or Project'), ('.Team/Querying', ''), ('Querying/Metrics', 'v2'), ('Semantic Model', '')]",[],
2351751153,issue,closed,completed,StreamingResponse cannot be cast to class clojure.lang.Associative,"### Describe the bug

After upgrading I tried to subscribe to a dashboard and send an email. It said ""Sending failed"".

### To Reproduce

1. Go to a dashboard
2. Click Subscriptions
3. Enter a user in the To field
4. Click ""Send email now""


### Expected behavior

Expected results: Email is sent to the user.
Actual results: ""Sending failed"" and the logs below.

### Logs

```
[06e25852-228b-4ffe-9899-6c185d1bae52] 2024-06-13T13:34:02-04:00 ERROR metabase.server.middleware.log POST /api/pulse/test 500 2.5 s (327 DB calls) {:metabase-user-id 1} 
{:via
 [{:type java.lang.ClassCastException,
   :message
   ""class metabase.async.streaming_response.StreamingResponse cannot be cast to class clojure.lang.Associative (metabase.async.streaming_response.StreamingResponse and clojure.lang.Associative are in unnamed module of loader 'app')"",
   :at [clojure.lang.RT assoc ""RT.java"" 827]}],
 :trace
 [[clojure.lang.RT assoc ""RT.java"" 827]
  [clojure.core$assoc__5481 invokeStatic ""core.clj"" 193]
  [clojure.core$update_in$up__6922 invoke ""core.clj"" 6220]
  [clojure.core$update_in invokeStatic ""core.clj"" 6222]
  [clojure.core$update_in doInvoke ""core.clj"" 6208]
  [clojure.lang.RestFn invoke ""RestFn.java"" 445]
  [metabase.pulse.render$render_pulse_card invokeStatic ""render.clj"" 171]
  [metabase.pulse.render$render_pulse_card invoke ""render.clj"" 156]
  [metabase.pulse.render$render_pulse_section$fn__73963 invoke ""render.clj"" 213]
  [metabase.pulse.render$render_pulse_section invokeStatic ""render.clj"" 211]
  [metabase.pulse.render$render_pulse_section invoke ""render.clj"" 207]
  [metabase.email.messages$render_part invokeStatic ""messages.clj"" 442]
  [metabase.email.messages$render_part invoke ""messages.clj"" 438]
  [metabase.email.messages$render_message_body$fn__74931$fn__74932 invoke ""messages.clj"" 495]
  [clojure.core$mapv$fn__8535 invoke ""core.clj"" 6980]
  [clojure.core.protocols$fn__8249 invokeStatic ""protocols.clj"" 168]
  [clojure.core.protocols$fn__8249 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$mapv invokeStatic ""core.clj"" 6971]
  [clojure.core$mapv invoke ""core.clj"" 6971]
  [metabase.email.messages$render_message_body$fn__74931 invoke ""messages.clj"" 495]
  [metabase.email.messages$render_message_body invokeStatic ""messages.clj"" 494]
  [metabase.email.messages$render_message_body invoke ""messages.clj"" 492]
  [metabase.email.messages$render_pulse_email invokeStatic ""messages.clj"" 521]
  [metabase.email.messages$render_pulse_email invoke ""messages.clj"" 518]
  [metabase.pulse$fn__100530 invokeStatic ""pulse.clj"" 403]
  [metabase.pulse$fn__100530 invoke ""pulse.clj"" 392]
  [clojure.lang.MultiFn invoke ""MultiFn.java"" 239]
  [metabase.pulse$parts__GT_notifications$iter__100605__100609$fn__100610$fn__100611 invoke ""pulse.clj"" 474]
  [metabase.pulse$parts__GT_notifications$iter__100605__100609$fn__100610 invoke ""pulse.clj"" 472]
  [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
  [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
  [clojure.lang.RT seq ""RT.java"" 535]
  [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
  [clojure.core$seq__5467 invoke ""core.clj"" 139]
  [metabase.pulse$send_notifications_BANG_ invokeStatic ""pulse.clj"" 527]
  [metabase.pulse$send_notifications_BANG_ invoke ""pulse.clj"" 526]
  [metabase.pulse$send_pulse_BANG_ invokeStatic ""pulse.clj"" 555]
  [metabase.pulse$send_pulse_BANG_ doInvoke ""pulse.clj"" 535]
  [clojure.lang.RestFn invoke ""RestFn.java"" 410]
  [metabase.api.pulse$fn__102920 invokeStatic ""pulse.clj"" 349]
  [metabase.api.pulse$fn__102920 invoke ""pulse.clj"" 331]
  [compojure.core$wrap_response$fn__52844 invoke ""core.clj"" 160]
  [compojure.core$wrap_route_middleware$fn__52828 invoke ""core.clj"" 132]
  [compojure.core$wrap_route_info$fn__52833 invoke ""core.clj"" 139]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 151]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 152]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856 invoke ""core.clj"" 200]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [metabase.pulse.preview$style_tag_nonce_middleware$fn__100952 invoke ""preview.clj"" 165]
  [metabase.server.middleware.auth$enforce_authentication$fn__97094 invoke ""auth.clj"" 18]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__52884 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 300]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [metabase.api.routes$fn__103529$fn__103532 invoke ""routes.clj"" 73]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856 invoke ""core.clj"" 200]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [metabase.server.routes$fn__103809$fn__103810 doInvoke ""routes.clj"" 73]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__52884 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [metabase.server.routes$fn__103792$fn__103794 invoke ""routes.clj"" 47]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856 invoke ""core.clj"" 200]
  [metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__99959 invoke ""exceptions.clj"" 107]
  [metabase.server.middleware.exceptions$catch_api_exceptions$fn__99956 invoke ""exceptions.clj"" 96]
  [metabase.server.middleware.log$log_api_call$fn__104089$fn__104090$fn__104091 invoke ""log.clj"" 236]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invokeStatic ""diagnostic.clj"" 18]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invoke ""diagnostic.clj"" 12]
  [metabase.server.middleware.log$log_api_call$fn__104089$fn__104090 invoke ""log.clj"" 227]
  [toucan2.execute$do_with_call_counts invokeStatic ""execute.clj"" 112]
  [toucan2.execute$do_with_call_counts invoke ""execute.clj"" 103]
  [metabase.server.middleware.log$log_api_call$fn__104089 invoke ""log.clj"" 226]
  [metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__107377 invoke ""browser_cookie.clj"" 40]
  [metabase.server.middleware.security$add_security_headers$fn__99915 invoke ""security.clj"" 238]
  [ring.middleware.json$wrap_json_body$fn__107636 invoke ""json.clj"" 64]
  [metabase.server.middleware.offset_paging$handle_paging$fn__86415 invoke ""offset_paging.clj"" 43]
  [metabase.server.middleware.json$wrap_streamed_json_response$fn__54299 invoke ""json.clj"" 83]
  [ring.middleware.keyword_params$wrap_keyword_params$fn__107725 invoke ""keyword_params.clj"" 55]
  [ring.middleware.params$wrap_params$fn__107744 invoke ""params.clj"" 77]
  [metabase.server.middleware.misc$maybe_set_site_url$fn__69704 invoke ""misc.clj"" 60]
  [metabase.server.middleware.session$reset_session_timeout$fn__76848 invoke ""session.clj"" 552]
  [metabase.server.middleware.session$bind_current_user$fn__76814$fn__76815 invoke ""session.clj"" 446]
  [metabase.server.middleware.session$do_with_current_user invokeStatic ""session.clj"" 425]
  [metabase.server.middleware.session$do_with_current_user invoke ""session.clj"" 408]
  [metabase.server.middleware.session$bind_current_user$fn__76814 invoke ""session.clj"" 445]
  [metabase.server.middleware.session$wrap_current_user_info$fn__76795 invoke ""session.clj"" 383]
  [metabase.server.middleware.session$wrap_session_id$fn__76767 invoke ""session.clj"" 259]
  [metabase.server.middleware.auth$wrap_static_api_key$fn__97102 invoke ""auth.clj"" 32]
  [ring.middleware.cookies$wrap_cookies$fn__107564 invoke ""cookies.clj"" 200]
  [metabase.server.middleware.misc$add_content_type$fn__69686 invoke ""misc.clj"" 28]
  [metabase.server.middleware.misc$disable_streaming_buffering$fn__69712 invoke ""misc.clj"" 77]
  [ring.middleware.gzip$wrap_gzip$fn__107606 invoke ""gzip.clj"" 86]
  [metabase.server.middleware.misc$bind_request$fn__69715 invoke ""misc.clj"" 94]
  [metabase.server.middleware.ssl$redirect_to_https_middleware$fn__107393 invoke ""ssl.clj"" 51]
  [metabase.server$async_proxy_handler$fn__70050 invoke ""server.clj"" 77]
  [metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a handle nil -1]
  [org.eclipse.jetty.server.handler.StatisticsHandler handle ""StatisticsHandler.java"" 173]
  [org.eclipse.jetty.server.handler.HandlerWrapper handle ""HandlerWrapper.java"" 122]
  [org.eclipse.jetty.server.Server handle ""Server.java"" 563]
  [org.eclipse.jetty.server.HttpChannel$RequestDispatchable dispatch ""HttpChannel.java"" 1598]
  [org.eclipse.jetty.server.HttpChannel dispatch ""HttpChannel.java"" 753]
  [org.eclipse.jetty.server.HttpChannel handle ""HttpChannel.java"" 501]
  [org.eclipse.jetty.server.HttpConnection onFillable ""HttpConnection.java"" 287]
  [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded ""AbstractConnection.java"" 314]
  [org.eclipse.jetty.io.FillInterest fillable ""FillInterest.java"" 100]
  [org.eclipse.jetty.io.SelectableChannelEndPoint$1 run ""SelectableChannelEndPoint.java"" 53]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy runTask ""AdaptiveExecutionStrategy.java"" 421]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy consumeTask ""AdaptiveExecutionStrategy.java"" 390]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy tryProduce ""AdaptiveExecutionStrategy.java"" 277]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy run ""AdaptiveExecutionStrategy.java"" 199]
  [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run ""ReservedThreadExecutor.java"" 411]
  [org.eclipse.jetty.util.thread.QueuedThreadPool runJob ""QueuedThreadPool.java"" 969]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner doRunJob ""QueuedThreadPool.java"" 1194]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run ""QueuedThreadPool.java"" 1149]
  [java.lang.Thread run ""Thread.java"" 829]],
 :cause
 ""class metabase.async.streaming_response.StreamingResponse cannot be cast to class clojure.lang.Associative (metabase.async.streaming_response.StreamingResponse and clojure.lang.Associative are in unnamed module of loader 'app')"",
 :message
 ""class metabase.async.streaming_response.StreamingResponse cannot be cast to class clojure.lang.Associative (metabase.async.streaming_response.StreamingResponse and clojure.lang.Associative are in unnamed module of loader 'app')""}
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-CA"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9-LTS"",
    ""java.vendor"": ""Red Hat, Inc."",
    ""java.vendor.url"": ""https://www.redhat.com/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""4.18.0-553.5.1.el8_10.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""America/Toronto""
  },
  ""metabase-info"": {
    ""databases"": [
      ""googleanalytics"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.3""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-10"",
      ""tag"": ""v0.50.0"",
      ""hash"": ""4fe42d3""
    },
    ""settings"": {
      ""report-timezone"": ""US/Eastern""
    }
  }
}
```


### Severity

Blocking use of subscriptions

### Additional context

""Send test email"" from the admin page for email configuration does successfully send a test email.",landreville,2024-06-13 17:59:01+00:00,"['snoe', 'adam-james-v']",2024-06-17 19:01:32+00:00,2024-06-17 18:29:58+00:00,https://github.com/metabase/metabase/issues/44160,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Pulses', 'Now called Subscriptions'), ('.Backend', ''), ('Visualization/Tables/old-pivoted', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2166626711, 'issue_id': 2351751153, 'author': 'adam-james-v', 'body': 'Hi @landreville , thanks for reporting. \r\n\r\nAre you able to provide some details regarding the  dashboard you tried this with? For instance, what kinds of cards are included in the dashboard?\r\n\r\nif you create a new dashboard and add just one question, say a table or a simple line chart, does the same error occur? It could help me narrow down a cause', 'created_at': datetime.datetime(2024, 6, 13, 19, 34, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166665292, 'issue_id': 2351751153, 'author': 'landreville', 'body': ""It's a complicated dashboard with pivot tables, bar charts, line charts, combo line/bar charts. I'll try making some new simpler dashboards and see if this also happens."", 'created_at': datetime.datetime(2024, 6, 13, 20, 0, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166676705, 'issue_id': 2351751153, 'author': 'landreville', 'body': 'This only happens if the dashboard includes a question with a Pivot Table visualization.', 'created_at': datetime.datetime(2024, 6, 13, 20, 7, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166712819, 'issue_id': 2351751153, 'author': 'adam-james-v', 'body': ""That's quite helpful, thanks! \r\nIs the subscription set to include csv and/or xlsx attachments? That may be a contributing factor as well."", 'created_at': datetime.datetime(2024, 6, 13, 20, 32, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166896389, 'issue_id': 2351751153, 'author': 'paoliniluis', 'body': 'Also, can you move to the AdoptOpenJDK Java runtime?', 'created_at': datetime.datetime(2024, 6, 13, 22, 28, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2167950116, 'issue_id': 2351751153, 'author': 'landreville', 'body': '> That\'s quite helpful, thanks! Is the subscription set to include csv and/or xlsx attachments? That may be a contributing factor as well.\r\n\r\nI had unselected ""attach results"".', 'created_at': datetime.datetime(2024, 6, 14, 12, 41, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168267948, 'issue_id': 2351751153, 'author': 'landreville', 'body': ""> Also, can you move to the AdoptOpenJDK Java runtime?\r\n\r\nWe've also switched to AdoptOpenJDK now with the same result."", 'created_at': datetime.datetime(2024, 6, 14, 15, 25, 7, tzinfo=datetime.timezone.utc)}]","adam-james-v (Assginee) on (2024-06-13 19:34:57 UTC): Hi @landreville , thanks for reporting. 

Are you able to provide some details regarding the  dashboard you tried this with? For instance, what kinds of cards are included in the dashboard?

if you create a new dashboard and add just one question, say a table or a simple line chart, does the same error occur? It could help me narrow down a cause

landreville (Issue Creator) on (2024-06-13 20:00:27 UTC): It's a complicated dashboard with pivot tables, bar charts, line charts, combo line/bar charts. I'll try making some new simpler dashboards and see if this also happens.

landreville (Issue Creator) on (2024-06-13 20:07:48 UTC): This only happens if the dashboard includes a question with a Pivot Table visualization.

adam-james-v (Assginee) on (2024-06-13 20:32:12 UTC): That's quite helpful, thanks! 
Is the subscription set to include csv and/or xlsx attachments? That may be a contributing factor as well.

paoliniluis on (2024-06-13 22:28:32 UTC): Also, can you move to the AdoptOpenJDK Java runtime?

landreville (Issue Creator) on (2024-06-14 12:41:34 UTC): I had unselected ""attach results"".

landreville (Issue Creator) on (2024-06-14 15:25:07 UTC): We've also switched to AdoptOpenJDK now with the same result.

"
2351710529,issue,closed,completed,Error while exporting a pivot table without columns in v50.x,"### Describe the bug

Exporting a pivot as csv table without columns exports an export file. Used to work prior to 50

### To Reproduce

1. Create a GUI question from Orders, Count of Product Category, Product Vendor and Orders Created At
2. Set visualization to Pivot table
3. Go to chart settings, move all the fields to columns (picture 1)
4. Save, export as csv
5. See error `error:""Wrong   number of args (0) passed to: clojure.core/juxt""`

My csv downloaded with the error:
[orders__count__grouped_by_subtotal__auto_binned_and_product_→_category_and_product_→_vendor_and_user_→_state_2024-06-13T14_28_47.902585-03_00.csv](https://github.com/user-attachments/files/15826325/orders__count__grouped_by_subtotal__auto_binned_and_product_._category_and_product_._vendor_and_user_._state_2024-06-13T14_28_47.902585-03_00.csv)


![Screenshot 2024-06-13 at 2 28 29 PM](https://github.com/metabase/metabase/assets/132273646/e4e128c1-a8e9-4411-bba2-03ab3aabff85)

Picture 1

### Expected behavior

Should export the pivot table with the values

### Logs

_No response_

### Information about your Metabase installation

```JSON
- v50.x
```


### Severity

p2

### Additional context

_No response_",ignacio-mb,2024-06-13 17:33:32+00:00,['adam-james-v'],2024-06-18 20:20:02+00:00,2024-06-18 20:20:01+00:00,https://github.com/metabase/metabase/issues/44159,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Export', ''), ('.Backend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('Visualization/Download', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2176496747, 'issue_id': 2351710529, 'author': 'escherize', 'body': '> 3. Go to chart settings, move all the fields to columns (picture 1)\r\n\r\nIn that screenshot, all the fields are in rows.\r\n\r\nAnd @adam-james-v when I run this on your branch, with all the fields in rows: I get the same `error:""Wrong number of args (0) passed to: clojure.core/juxt""` in my csv download. Putting all the fields in columns works.\r\n\r\n(attached): [query_result_2024-06-18T16_14_34.646573Z.csv](https://github.com/user-attachments/files/15889579/query_result_2024-06-18T16_14_34.646573Z.csv)\r\n\r\n\r\nTo reiterate, it works when all the fields are in rows, and doesn\'t work when all the fields are in columns.', 'created_at': datetime.datetime(2024, 6, 18, 16, 19, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2176499710, 'issue_id': 2351710529, 'author': 'escherize', 'body': 'The logs:\r\n\r\n```\r\n2024-06-18 16:14:35,906 ERROR middleware.catch-exceptions :: Error processing query: Wrong number of args (0) passed to: clojure.core/juxt\r\n{:database_id 1,\r\n :started_at #t ""2024-06-18T16:14:34.699195Z[UTC]"",\r\n :action_id nil,\r\n :json_query\r\n {:constraints {:max-results 10000, :max-results-bare-rows 2000},\r\n  :lib/type :mbql/query,\r\n  :pivot-cols [1 2 0],\r\n  :qp.pivot/breakout-combination [0 1 2],\r\n  :lib/metadata\r\n  (metabase.lib.metadata.invocation-tracker/invocation-tracker-provider (metabase.lib.metadata.cached-provider/cached-metadata-provider (metabase.lib.metadata.jvm/->UncachedApplicationDatabaseMetadataProvider 1))),\r\n  :stages\r\n  [{:lib/type :mbql.stage/mbql,\r\n    :source-table 5,\r\n    :aggregation [[:count {:lib/uuid ""ee8ce355-4827-4b36-9e7f-2d0904112dd9""}]],\r\n    :breakout\r\n    [[:field\r\n      {:base-type :type/Text,\r\n       :source-field 40,\r\n       :lib/uuid ""d574ca25-aab5-4140-822a-bed500b04ef1"",\r\n       :effective-type :type/Text}\r\n      58]\r\n     [:field\r\n      {:base-type :type/Text,\r\n       :source-field 40,\r\n       :lib/uuid ""fb8a98b1-478f-4335-94a0-4f505051ae21"",\r\n       :effective-type :type/Text}\r\n      60]\r\n     [:field\r\n      {:base-type :type/DateTime,\r\n       :temporal-unit :month,\r\n       :lib/uuid ""7d78ddfb-078f-412a-9a82-dedc65b52c1b"",\r\n       :effective-type :type/DateTime}\r\n      41]\r\n     [:expression\r\n      {:lib/uuid ""dd58c80e-dfe2-4f53-a980-c235888c649a"", :base-type :type/Integer, :effective-type :type/Integer}\r\n      ""pivot-grouping""]],\r\n    :expressions [[:abs {:lib/uuid ""541e475c-b206-42bd-aa17-5f39a5e632ae"", :lib/expression-name ""pivot-grouping""} 0]]}],\r\n  :middleware\r\n  {:pivot-options {:pivot-cols [1 2 0]},\r\n   :process-viz-settings? true,\r\n   :skip-results-metadata? true,\r\n   :format-rows? true,\r\n   :userland-query? true,\r\n   :add-default-userland-constraints? true},\r\n  :viz-settings\r\n  {:pivot.show_column_totals true,\r\n   :pivot_table.column_split\r\n   {:rows [],\r\n    :columns\r\n    [[""field"" 60 {:base-type ""type/Text"", :source-field 40}]\r\n     [""field"" 41 {:base-type ""type/DateTime"", :temporal-unit ""month""}]\r\n     [""field"" 58 {:base-type ""type/Text"", :source-field 40}]],\r\n    :values [[""aggregation"" 0]]},\r\n   :metabase.shared.models.visualization-settings/column-settings {},\r\n   :pivot_table.collapsed_rows {:value [], :rows []},\r\n   :table.columns nil,\r\n   :pivot_table.column_widths {:leftHeaderWidths [], :totalLeftHeaderWidths 0, :valueHeaderWidths {}},\r\n   :table.column_formatting [],\r\n   :pivot.show_row_totals true},\r\n  :database 1},\r\n :status :failed,\r\n :class clojure.lang.ArityException,\r\n :stacktrace\r\n [""clojure.lang.AFn.throwArity(AFn.java:429)""\r\n  ""clojure.lang.RestFn.invoke(RestFn.java:399)""\r\n  ""clojure.lang.AFn.applyToHelper(AFn.java:152)""\r\n  ""clojure.lang.RestFn.applyTo(RestFn.java:132)""\r\n  ""clojure.core$apply.invokeStatic(core.clj:667)""\r\n  ""clojure.core$apply.invoke(core.clj:662)""\r\n  ""--> query_processor.pivot.postprocess$fn__121865$_AMPERSAND_f__121867.invoke(postprocess.clj:121)""\r\n  ""query_processor.pivot.postprocess$fn__121865$fn__121884.invoke(postprocess.clj:108)""\r\n  ""query_processor.pivot.postprocess$fn__121916$_AMPERSAND_f__121918.invoke(postprocess.clj:203)""\r\n  ""query_processor.pivot.postprocess$fn__121916$fn__121929.invoke(postprocess.clj:191)""\r\n  ""query_processor.pivot.postprocess$fn__121936$_AMPERSAND_f__121937.invoke(postprocess.clj:224)""\r\n  ""query_processor.pivot.postprocess$fn__121936$fn__121939.invoke(postprocess.clj:217)""\r\n  ""query_processor.streaming.csv$eval122033$fn$reify__122037.finish_BANG_(csv.clj:73)""\r\n  ""query_processor.streaming$fn__122999$_AMPERSAND_f__123000$result__123001$fn__123002.invoke(streaming.clj:144)""\r\n  ""query_processor.streaming$fn__122999$_AMPERSAND_f__123000$result__123001.invoke(streaming.clj:143)""\r\n  ""query_processor.pivot$fn__134171$_AMPERSAND_f__134172$multiple_reducing__134174.invoke(pivot.clj:316)""\r\n  ""query_processor.pipeline$_STAR_run_STAR_$respond__93923.invoke(pipeline.clj:86)""\r\n  ""query_processor.pivot$fn__134163$_AMPERSAND_f__134164$multiple_execute__134165.invoke(pivot.clj:280)""\r\n  ""query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:88)""\r\n  ""query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:81)""\r\n  ""query_processor.execute$run.invokeStatic(execute.clj:60)""\r\n  ""query_processor.execute$run.invoke(execute.clj:54)""\r\n  ""query_processor.middleware.update_used_cards$fn__100426$_AMPERSAND_f__100427$_AMPERSAND_f__100428.invoke(update_used_cards.clj:40)""\r\n  ""query_processor.middleware.update_used_cards$fn__100426$_AMPERSAND_f__100427$fn__100432.invoke(update_used_cards.clj:35)""\r\n  ""query_processor.execute$add_native_form_to_result_metadata$fn__100444.invoke(execute.clj:23)""\r\n  ""query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__100449.invoke(execute.clj:34)""\r\n  ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___100404.invoke(cache.clj:242)""\r\n  ""query_processor.middleware.permissions$check_query_permissions$fn__99414.invoke(permissions.clj:118)""\r\n  ""metabase_enterprise.advanced_permissions.query_processor.middleware.permissions$eval177365$check_download_permissions__177366$fn__177367.invoke(permissions.clj:90)""\r\n  ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__95191.invoke(enterprise.clj:51)""\r\n  ""metabase_enterprise.sandbox.query_processor.middleware.column_level_perms_check$eval177563$maybe_apply_column_level_perms_check__177564$fn__177565.invoke(column_level_perms_check.clj:38)""\r\n  ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__95201.invoke(enterprise.clj:64)""\r\n  ""query_processor.execute$fn__100478$_AMPERSAND_f__100479$fn__100480.invoke(execute.clj:92)""\r\n  ""query_processor.setup$fn__99973$_AMPERSAND_f__99974.invoke(setup.clj:225)""\r\n  ""query_processor.setup$fn__99973$fn__99978.invoke(setup.clj:216)""\r\n  ""query_processor.execute$fn__100478$_AMPERSAND_f__100479.invoke(execute.clj:91)""\r\n  ""query_processor.execute$fn__100478$fn__100483.invoke(execute.clj:87)""\r\n  ""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:47)""\r\n  ""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:43)""\r\n  ""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$eval177522$handle_audit_app_internal_queries__177523$fn__177524.invoke(handle_audit_queries.clj:145)""\r\n  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__95229.invoke(enterprise.clj:103)""\r\n  ""query_processor.middleware.process_userland_query$fn__100868$_AMPERSAND_f__100869$_AMPERSAND_f__100870.invoke(process_userland_query.clj:182)""\r\n  ""query_processor.middleware.process_userland_query$fn__100868$_AMPERSAND_f__100869$fn__100876.invoke(process_userland_query.clj:166)""\r\n  ""query_processor.middleware.catch_exceptions$fn__100572$_AMPERSAND_f__100573$_AMPERSAND_f__100574.invoke(catch_exceptions.clj:128)""\r\n  ""query_processor.middleware.catch_exceptions$fn__100572$_AMPERSAND_f__100573$fn__100586.invoke(catch_exceptions.clj:118)""\r\n  ""query_processor$fn__101213$_AMPERSAND_f__101214$fn__101215.invoke(query_processor.clj:78)""\r\n  ""query_processor.setup$fn__99973$_AMPERSAND_f__99974.invoke(setup.clj:225)""\r\n  ""query_processor.setup$fn__99973$fn__99978.invoke(setup.clj:216)""\r\n  ""query_processor$fn__101213$_AMPERSAND_f__101214.invoke(query_processor.clj:76)""\r\n  ""query_processor$fn__101213$fn__101219.invoke(query_processor.clj:69)""\r\n  ""query_processor.pivot$fn__134193$_AMPERSAND_f__134195.invoke(pivot.clj:339)""\r\n  ""query_processor.pivot$fn__134193$fn__134205.invoke(pivot.clj:329)""\r\n  ""query_processor.pivot$fn__134249$_AMPERSAND_f__134250$fn__134251.invoke(pivot.clj:469)""\r\n  ""query_processor.setup$fn__99965$_AMPERSAND_f__99966$fn__99967.invoke(setup.clj:189)""\r\n  ""query_processor.setup$fn__99955$_AMPERSAND_f__99956$fn__99957.invoke(setup.clj:181)""\r\n  ""query_processor.setup$fn__99945$_AMPERSAND_f__99946$fn__99947$fn__99948.invoke(setup.clj:166)""\r\n  ""driver$do_with_driver.invokeStatic(driver.clj:104)""\r\n  ""driver$do_with_driver.invoke(driver.clj:99)""\r\n  ""query_processor.setup$fn__99945$_AMPERSAND_f__99946$fn__99947.invoke(setup.clj:165)""\r\n  ""query_processor.setup$fn__99933$_AMPERSAND_f__99934$fn__99935$fn__99938.invoke(setup.clj:151)""\r\n  ""query_processor.store$fn__87051$_AMPERSAND_f__87052.invoke(store.clj:171)""\r\n  ""query_processor.store$fn__87051$fn__87055.invoke(store.clj:151)""\r\n  ""query_processor.store$fn__87051$_AMPERSAND_f__87052.invoke(store.clj:160)""\r\n  ""query_processor.store$fn__87051$fn__87055.invoke(store.clj:151)""\r\n  ""query_processor.setup$fn__99933$_AMPERSAND_f__99934$fn__99935.invoke(setup.clj:150)""\r\n  ""query_processor.setup$fn__99915$_AMPERSAND_f__99916$_AMPERSAND_f__99917.invoke(setup.clj:128)""\r\n  ""query_processor.setup$fn__99915$_AMPERSAND_f__99916$fn__99920.invoke(setup.clj:122)""\r\n  ""query_processor.setup$fn__99973$_AMPERSAND_f__99974.invoke(setup.clj:232)""\r\n  ""query_processor.setup$fn__99973$fn__99978.invoke(setup.clj:216)""\r\n  ""query_processor.pivot$fn__134249$_AMPERSAND_f__134250.invoke(pivot.clj:460)""\r\n  ""query_processor.pivot$fn__134249$fn__134258.invoke(pivot.clj:450)""\r\n  ""api.dataset$fn__148982$_AMPERSAND_f__148985$fn__148989.invoke(dataset.clj:80)""\r\n  ""query_processor.streaming$_streaming_response$fn__123016$fn__123017$fn__123018.invoke(streaming.clj:175)""\r\n  ""query_processor.streaming$_streaming_response$fn__123016$fn__123017.invoke(streaming.clj:174)""\r\n  ""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:165)""\r\n  ""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:152)""\r\n  ""query_processor.streaming$_streaming_response$fn__123016.invoke(streaming.clj:171)""\r\n  ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:68)""\r\n  ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:66)""\r\n  ""async.streaming_response$do_f_async$task__66485.invoke(streaming_response.clj:87)""],\r\n :card_id nil,\r\n :context :csv-download,\r\n :error ""Wrong number of args (0) passed to: clojure.core/juxt"",\r\n :row_count 0,\r\n :running_time 0,\r\n :data {:rows [], :cols []}}\r\n ```', 'created_at': datetime.datetime(2024, 6, 18, 16, 20, 58, tzinfo=datetime.timezone.utc)}]","escherize on (2024-06-18 16:19:15 UTC): In that screenshot, all the fields are in rows.

And @adam-james-v when I run this on your branch, with all the fields in rows: I get the same `error:""Wrong number of args (0) passed to: clojure.core/juxt""` in my csv download. Putting all the fields in columns works.

(attached): [query_result_2024-06-18T16_14_34.646573Z.csv](https://github.com/user-attachments/files/15889579/query_result_2024-06-18T16_14_34.646573Z.csv)


To reiterate, it works when all the fields are in rows, and doesn't work when all the fields are in columns.

escherize on (2024-06-18 16:20:58 UTC): The logs:

```
2024-06-18 16:14:35,906 ERROR middleware.catch-exceptions :: Error processing query: Wrong number of args (0) passed to: clojure.core/juxt
{:database_id 1,
 :started_at #t ""2024-06-18T16:14:34.699195Z[UTC]"",
 :action_id nil,
 :json_query
 {:constraints {:max-results 10000, :max-results-bare-rows 2000},
  :lib/type :mbql/query,
  :pivot-cols [1 2 0],
  :qp.pivot/breakout-combination [0 1 2],
  :lib/metadata
  (metabase.lib.metadata.invocation-tracker/invocation-tracker-provider (metabase.lib.metadata.cached-provider/cached-metadata-provider (metabase.lib.metadata.jvm/->UncachedApplicationDatabaseMetadataProvider 1))),
  :stages
  [{:lib/type :mbql.stage/mbql,
    :source-table 5,
    :aggregation [[:count {:lib/uuid ""ee8ce355-4827-4b36-9e7f-2d0904112dd9""}]],
    :breakout
    [[:field
      {:base-type :type/Text,
       :source-field 40,
       :lib/uuid ""d574ca25-aab5-4140-822a-bed500b04ef1"",
       :effective-type :type/Text}
      58]
     [:field
      {:base-type :type/Text,
       :source-field 40,
       :lib/uuid ""fb8a98b1-478f-4335-94a0-4f505051ae21"",
       :effective-type :type/Text}
      60]
     [:field
      {:base-type :type/DateTime,
       :temporal-unit :month,
       :lib/uuid ""7d78ddfb-078f-412a-9a82-dedc65b52c1b"",
       :effective-type :type/DateTime}
      41]
     [:expression
      {:lib/uuid ""dd58c80e-dfe2-4f53-a980-c235888c649a"", :base-type :type/Integer, :effective-type :type/Integer}
      ""pivot-grouping""]],
    :expressions [[:abs {:lib/uuid ""541e475c-b206-42bd-aa17-5f39a5e632ae"", :lib/expression-name ""pivot-grouping""} 0]]}],
  :middleware
  {:pivot-options {:pivot-cols [1 2 0]},
   :process-viz-settings? true,
   :skip-results-metadata? true,
   :format-rows? true,
   :userland-query? true,
   :add-default-userland-constraints? true},
  :viz-settings
  {:pivot.show_column_totals true,
   :pivot_table.column_split
   {:rows [],
    :columns
    [[""field"" 60 {:base-type ""type/Text"", :source-field 40}]
     [""field"" 41 {:base-type ""type/DateTime"", :temporal-unit ""month""}]
     [""field"" 58 {:base-type ""type/Text"", :source-field 40}]],
    :values [[""aggregation"" 0]]},
   :metabase.shared.models.visualization-settings/column-settings {},
   :pivot_table.collapsed_rows {:value [], :rows []},
   :table.columns nil,
   :pivot_table.column_widths {:leftHeaderWidths [], :totalLeftHeaderWidths 0, :valueHeaderWidths {}},
   :table.column_formatting [],
   :pivot.show_row_totals true},
  :database 1},
 :status :failed,
 :class clojure.lang.ArityException,
 :stacktrace
 [""clojure.lang.AFn.throwArity(AFn.java:429)""
  ""clojure.lang.RestFn.invoke(RestFn.java:399)""
  ""clojure.lang.AFn.applyToHelper(AFn.java:152)""
  ""clojure.lang.RestFn.applyTo(RestFn.java:132)""
  ""clojure.core$apply.invokeStatic(core.clj:667)""
  ""clojure.core$apply.invoke(core.clj:662)""
  ""--> query_processor.pivot.postprocess$fn__121865$_AMPERSAND_f__121867.invoke(postprocess.clj:121)""
  ""query_processor.pivot.postprocess$fn__121865$fn__121884.invoke(postprocess.clj:108)""
  ""query_processor.pivot.postprocess$fn__121916$_AMPERSAND_f__121918.invoke(postprocess.clj:203)""
  ""query_processor.pivot.postprocess$fn__121916$fn__121929.invoke(postprocess.clj:191)""
  ""query_processor.pivot.postprocess$fn__121936$_AMPERSAND_f__121937.invoke(postprocess.clj:224)""
  ""query_processor.pivot.postprocess$fn__121936$fn__121939.invoke(postprocess.clj:217)""
  ""query_processor.streaming.csv$eval122033$fn$reify__122037.finish_BANG_(csv.clj:73)""
  ""query_processor.streaming$fn__122999$_AMPERSAND_f__123000$result__123001$fn__123002.invoke(streaming.clj:144)""
  ""query_processor.streaming$fn__122999$_AMPERSAND_f__123000$result__123001.invoke(streaming.clj:143)""
  ""query_processor.pivot$fn__134171$_AMPERSAND_f__134172$multiple_reducing__134174.invoke(pivot.clj:316)""
  ""query_processor.pipeline$_STAR_run_STAR_$respond__93923.invoke(pipeline.clj:86)""
  ""query_processor.pivot$fn__134163$_AMPERSAND_f__134164$multiple_execute__134165.invoke(pivot.clj:280)""
  ""query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:88)""
  ""query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:81)""
  ""query_processor.execute$run.invokeStatic(execute.clj:60)""
  ""query_processor.execute$run.invoke(execute.clj:54)""
  ""query_processor.middleware.update_used_cards$fn__100426$_AMPERSAND_f__100427$_AMPERSAND_f__100428.invoke(update_used_cards.clj:40)""
  ""query_processor.middleware.update_used_cards$fn__100426$_AMPERSAND_f__100427$fn__100432.invoke(update_used_cards.clj:35)""
  ""query_processor.execute$add_native_form_to_result_metadata$fn__100444.invoke(execute.clj:23)""
  ""query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__100449.invoke(execute.clj:34)""
  ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___100404.invoke(cache.clj:242)""
  ""query_processor.middleware.permissions$check_query_permissions$fn__99414.invoke(permissions.clj:118)""
  ""metabase_enterprise.advanced_permissions.query_processor.middleware.permissions$eval177365$check_download_permissions__177366$fn__177367.invoke(permissions.clj:90)""
  ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__95191.invoke(enterprise.clj:51)""
  ""metabase_enterprise.sandbox.query_processor.middleware.column_level_perms_check$eval177563$maybe_apply_column_level_perms_check__177564$fn__177565.invoke(column_level_perms_check.clj:38)""
  ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__95201.invoke(enterprise.clj:64)""
  ""query_processor.execute$fn__100478$_AMPERSAND_f__100479$fn__100480.invoke(execute.clj:92)""
  ""query_processor.setup$fn__99973$_AMPERSAND_f__99974.invoke(setup.clj:225)""
  ""query_processor.setup$fn__99973$fn__99978.invoke(setup.clj:216)""
  ""query_processor.execute$fn__100478$_AMPERSAND_f__100479.invoke(execute.clj:91)""
  ""query_processor.execute$fn__100478$fn__100483.invoke(execute.clj:87)""
  ""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:47)""
  ""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:43)""
  ""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$eval177522$handle_audit_app_internal_queries__177523$fn__177524.invoke(handle_audit_queries.clj:145)""
  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__95229.invoke(enterprise.clj:103)""
  ""query_processor.middleware.process_userland_query$fn__100868$_AMPERSAND_f__100869$_AMPERSAND_f__100870.invoke(process_userland_query.clj:182)""
  ""query_processor.middleware.process_userland_query$fn__100868$_AMPERSAND_f__100869$fn__100876.invoke(process_userland_query.clj:166)""
  ""query_processor.middleware.catch_exceptions$fn__100572$_AMPERSAND_f__100573$_AMPERSAND_f__100574.invoke(catch_exceptions.clj:128)""
  ""query_processor.middleware.catch_exceptions$fn__100572$_AMPERSAND_f__100573$fn__100586.invoke(catch_exceptions.clj:118)""
  ""query_processor$fn__101213$_AMPERSAND_f__101214$fn__101215.invoke(query_processor.clj:78)""
  ""query_processor.setup$fn__99973$_AMPERSAND_f__99974.invoke(setup.clj:225)""
  ""query_processor.setup$fn__99973$fn__99978.invoke(setup.clj:216)""
  ""query_processor$fn__101213$_AMPERSAND_f__101214.invoke(query_processor.clj:76)""
  ""query_processor$fn__101213$fn__101219.invoke(query_processor.clj:69)""
  ""query_processor.pivot$fn__134193$_AMPERSAND_f__134195.invoke(pivot.clj:339)""
  ""query_processor.pivot$fn__134193$fn__134205.invoke(pivot.clj:329)""
  ""query_processor.pivot$fn__134249$_AMPERSAND_f__134250$fn__134251.invoke(pivot.clj:469)""
  ""query_processor.setup$fn__99965$_AMPERSAND_f__99966$fn__99967.invoke(setup.clj:189)""
  ""query_processor.setup$fn__99955$_AMPERSAND_f__99956$fn__99957.invoke(setup.clj:181)""
  ""query_processor.setup$fn__99945$_AMPERSAND_f__99946$fn__99947$fn__99948.invoke(setup.clj:166)""
  ""driver$do_with_driver.invokeStatic(driver.clj:104)""
  ""driver$do_with_driver.invoke(driver.clj:99)""
  ""query_processor.setup$fn__99945$_AMPERSAND_f__99946$fn__99947.invoke(setup.clj:165)""
  ""query_processor.setup$fn__99933$_AMPERSAND_f__99934$fn__99935$fn__99938.invoke(setup.clj:151)""
  ""query_processor.store$fn__87051$_AMPERSAND_f__87052.invoke(store.clj:171)""
  ""query_processor.store$fn__87051$fn__87055.invoke(store.clj:151)""
  ""query_processor.store$fn__87051$_AMPERSAND_f__87052.invoke(store.clj:160)""
  ""query_processor.store$fn__87051$fn__87055.invoke(store.clj:151)""
  ""query_processor.setup$fn__99933$_AMPERSAND_f__99934$fn__99935.invoke(setup.clj:150)""
  ""query_processor.setup$fn__99915$_AMPERSAND_f__99916$_AMPERSAND_f__99917.invoke(setup.clj:128)""
  ""query_processor.setup$fn__99915$_AMPERSAND_f__99916$fn__99920.invoke(setup.clj:122)""
  ""query_processor.setup$fn__99973$_AMPERSAND_f__99974.invoke(setup.clj:232)""
  ""query_processor.setup$fn__99973$fn__99978.invoke(setup.clj:216)""
  ""query_processor.pivot$fn__134249$_AMPERSAND_f__134250.invoke(pivot.clj:460)""
  ""query_processor.pivot$fn__134249$fn__134258.invoke(pivot.clj:450)""
  ""api.dataset$fn__148982$_AMPERSAND_f__148985$fn__148989.invoke(dataset.clj:80)""
  ""query_processor.streaming$_streaming_response$fn__123016$fn__123017$fn__123018.invoke(streaming.clj:175)""
  ""query_processor.streaming$_streaming_response$fn__123016$fn__123017.invoke(streaming.clj:174)""
  ""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:165)""
  ""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:152)""
  ""query_processor.streaming$_streaming_response$fn__123016.invoke(streaming.clj:171)""
  ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:68)""
  ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:66)""
  ""async.streaming_response$do_f_async$task__66485.invoke(streaming_response.clj:87)""],
 :card_id nil,
 :context :csv-download,
 :error ""Wrong number of args (0) passed to: clojure.core/juxt"",
 :row_count 0,
 :running_time 0,
 :data {:rows [], :cols []}}
 ```

"
2351698809,issue,open,,Followups for auto-wire improvements,"Tech debt:
```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/issues/44433
- [ ] https://github.com/metabase/metabase/issues/44486
- [ ] https://github.com/metabase/metabase/issues/44423
- [ ] https://github.com/metabase/metabase/issues/44542
```
- issue links: followups to https://github.com/metabase/metabase/issues/43182

",uladzimirdev,2024-06-13 17:27:17+00:00,['uladzimirdev'],2024-06-21 13:21:00+00:00,,https://github.com/metabase/metabase/issues/44158,"[('Type:Tech Debt', 'or Refactoring'), ('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2351604476,issue,closed,completed,"[Browse] Hide recents based on the number of models in the instance (verified and unverified), not the number of models visible",,rafpaf,2024-06-13 16:45:42+00:00,['rafpaf'],2024-06-16 12:23:47+00:00,2024-06-16 12:23:46+00:00,https://github.com/metabase/metabase/issues/44157,[],"[{'comment_id': 2171499247, 'issue_id': 2351604476, 'author': 'rafpaf', 'body': 'This code change is already in master', 'created_at': datetime.datetime(2024, 6, 16, 12, 23, 46, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-06-16 12:23:46 UTC): This code change is already in master

"
2351485717,issue,closed,completed,Automatically send useful release slack messages,"Update in the same slack thread:
- pre-release test result (success or failure)
- publish start message
- release complete message",iethree,2024-06-13 15:46:01+00:00,['iethree'],2024-10-08 17:07:33+00:00,2024-06-14 11:35:31+00:00,https://github.com/metabase/metabase/issues/44154,"[('.Building & Releasing', '')]",[],
2351395011,issue,closed,completed,Add interactive dashboards to embedding SDK,"**Context**
Recently we added static dashboard component to the Embedding SDK - https://github.com/metabase/metabase/pull/41973

Now we want to add dashboard component that also allows drill down - InteractiveDashboard

",deniskaber,2024-06-13 15:05:26+00:00,['deniskaber'],2024-10-08 17:05:57+00:00,2024-06-19 18:05:21+00:00,https://github.com/metabase/metabase/issues/44153,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2351273685,issue,closed,completed,Remove help@metabase.com from Error Diagnostic Modal,"We want to avoid getting a deluge of emails from customers without support plans.

see [discussion](https://metaboat.slack.com/archives/C013N8XL286/p1718285213011609?thread_ts=1718284371.001519&cid=C013N8XL286)
",iethree,2024-06-13 14:15:25+00:00,[],2024-06-15 04:22:04+00:00,2024-06-15 03:36:05+00:00,https://github.com/metabase/metabase/issues/44150,"[('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2166574001, 'issue_id': 2351273685, 'author': 'rafpaf', 'body': '@iethree Should the diagnostic modal just say: `Click the button below to download diagnostic information`?', 'created_at': datetime.datetime(2024, 6, 13, 19, 4, tzinfo=datetime.timezone.utc)}]","rafpaf on (2024-06-13 19:04:00 UTC): @iethree Should the diagnostic modal just say: `Click the button below to download diagnostic information`?

"
2351268145,issue,closed,not_planned,[Flaky Test]: should load a question given a questionId,"Last Flake: https://github.com/metabase/metabase/actions/runs/9487934240
Last Flake Time: 2024-06-12T12:03:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-13 14:13:02+00:00,[],2024-12-13 16:44:00+00:00,2024-12-13 16:44:00+00:00,https://github.com/metabase/metabase/issues/44149,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2351268076,issue,closed,completed,[Flaky Test]: update-db-to-never-scan-values-on-demand-test,"Last Flake: https://github.com/metabase/metabase/actions/runs/9487638443
Last Flake Time: 2024-06-12T11:42:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-13 14:13:00+00:00,[],2024-10-08 17:06:11+00:00,2024-06-25 12:26:31+00:00,https://github.com/metabase/metabase/issues/44148,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Workflows', 'aka BEC')]",[],
2351268044,issue,closed,not_planned,[Flaky Test]: Feedback modal should send feedback when submitting the modal,"Last Flake: https://github.com/metabase/metabase/actions/runs/9488427595
Last Flake Time: 2024-06-12T12:40:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-13 14:12:59+00:00,[],2024-12-13 16:45:38+00:00,2024-12-13 16:45:38+00:00,https://github.com/metabase/metabase/issues/44147,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Embedding', '')]",[],
2351267980,issue,closed,completed,[Flaky Test]: should open the same dashboard when a custom URL click behavior points to the same dashboard (metabase#22702),"Last Flake: https://github.com/metabase/metabase/actions/runs/9468524002
Last Flake Time: 2024-06-11T09:09:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 4
Flakes in the last 7d: 4",github-automation-metabase,2024-06-13 14:12:57+00:00,[],2024-06-19 19:16:50+00:00,2024-06-19 19:16:49+00:00,https://github.com/metabase/metabase/issues/44146,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2179341529, 'issue_id': 2351267980, 'author': 'JesseSDevaney', 'body': 'Closing this as it was fixed by:\r\n- https://github.com/metabase/metabase/pull/44016', 'created_at': datetime.datetime(2024, 6, 19, 19, 16, 50, tzinfo=datetime.timezone.utc)}]","JesseSDevaney on (2024-06-19 19:16:50 UTC): Closing this as it was fixed by:
- https://github.com/metabase/metabase/pull/44016

"
2351267936,issue,closed,not_planned,[Flaky Test]: scenarios > alert > types goal based alerts should work for timeseries questions with a set goal,"Last Flake: https://github.com/metabase/metabase/actions/runs/9489592622
Last Flake Time: 2024-06-12T14:43:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 4
Flakes in the last 7d: 4",github-automation-metabase,2024-06-13 14:12:56+00:00,[],2024-12-13 16:43:59+00:00,2024-12-13 16:43:59+00:00,https://github.com/metabase/metabase/issues/44145,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2178799263, 'issue_id': 2351267936, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9555343945\nLast Flake Time: 2024-06-18T17:59:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 6\nFlakes in the last 7d: 10', 'created_at': datetime.datetime(2024, 6, 19, 14, 2, 25, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-19 14:02:25 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9555343945
Last Flake Time: 2024-06-18T17:59:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 6
Flakes in the last 7d: 10

"
2351267907,issue,closed,completed,[Flaky Test]: should not allow cards to be resized smaller than min height,"Last Flake: https://github.com/metabase/metabase/actions/runs/9487485391
Last Flake Time: 2024-06-12T11:45:00-07:00
Flakes in the last day: 2
Flakes in the last 3d: 5
Flakes in the last 7d: 6",github-automation-metabase,2024-06-13 14:12:55+00:00,[],2024-06-19 19:37:14+00:00,2024-06-19 19:37:14+00:00,https://github.com/metabase/metabase/issues/44144,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2179363875, 'issue_id': 2351267907, 'author': 'JesseSDevaney', 'body': 'Closing as I cannot find any recent runs that still have this test failing, so there is nothing to be able to reproduce the flake and fix it\r\n![image](https://github.com/metabase/metabase/assets/22608765/c3505086-f417-49c6-b4c3-3462c2f46f11)', 'created_at': datetime.datetime(2024, 6, 19, 19, 37, 14, tzinfo=datetime.timezone.utc)}]","JesseSDevaney on (2024-06-19 19:37:14 UTC): Closing as I cannot find any recent runs that still have this test failing, so there is nothing to be able to reproduce the flake and fix it
![image](https://github.com/metabase/metabase/assets/22608765/c3505086-f417-49c6-b4c3-3462c2f46f11)

"
2351252877,issue,closed,completed,Remove animation from buttons,,rafpaf,2024-06-13 14:06:40+00:00,[],2024-06-13 16:52:43+00:00,2024-06-13 16:10:35+00:00,https://github.com/metabase/metabase/issues/44142,[],[],
2351251497,issue,closed,completed,Make each tab in Admin / Performance a distinct route,,rafpaf,2024-06-13 14:06:02+00:00,[],2024-06-14 00:38:34+00:00,2024-06-14 00:38:34+00:00,https://github.com/metabase/metabase/issues/44141,"[('.Frontend', '')]",[],
2351227500,issue,closed,completed,Metric (v2) `visualization_settings` can sometimes contain the metric name instead of an aggregation,"### Describe the bug

When we create a new ad-hoc question based on a metric (v2), the visualization settings will contain that metric name in the `visualization_settings` instead of the aggregation metric. This leads to a lot of problems down the line, each of which will be documented separately.

Each of those should link to this issue as the cause.

### To Reproduce

Let's use: Orders, count of rows broken down by month - let's call it  ""Foo Metric""

1. Either create a new metric or open a saved one
2. Click on the `i` icon (More info)
3. Edit a metric description and blur
4. This should trigger the `PUT` request because we just edited the metric

Check out the network tab for the response of that request, and you'll see the following:
```js
visualization_settings: {
  ""graph.dimensions"": [
    ""CREATED_AT""
  ],
  ""graph.metrics"": [
    ""Foo Metric"" // this should've been [""count""]
  ]
}
```


### Expected behavior

Keep the aggregation metric (such as ""count"", ""average of"", etc.) in the viz_settings for metrics.

### Logs

_No response_

### Information about your Metabase installation

```JSON
local dev, master @ 68bd978, H2, Sample Database
```


### Severity

P2 or P1 since this can lead to crashes

### Additional context

_No response_",nemanjaglumac,2024-06-13 13:55:48+00:00,['uladzimirdev'],2024-10-21 14:57:45+00:00,2024-10-21 14:57:43+00:00,https://github.com/metabase/metabase/issues/44140,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature'), ('.Team/Querying', ''), ('Querying/Metrics', 'v2')]","[{'comment_id': 2394096717, 'issue_id': 2351227500, 'author': 'mngr', 'body': 'From the product point of view, it rather should always be a metric name', 'created_at': datetime.datetime(2024, 10, 4, 16, 45, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2394105646, 'issue_id': 2351227500, 'author': 'mngr', 'body': '""When we create a new ad-hoc question based on a metric (v2), the visualization settings will contain that metric name in the visualization_settings instead of the aggregation metric.""\nI can\'t reproduce this', 'created_at': datetime.datetime(2024, 10, 4, 16, 51, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2426932888, 'issue_id': 2351227500, 'author': 'ranquild', 'body': ""Can't reproduce; was fixed by recent BE changes"", 'created_at': datetime.datetime(2024, 10, 21, 14, 57, 43, tzinfo=datetime.timezone.utc)}]","mngr on (2024-10-04 16:45:15 UTC): From the product point of view, it rather should always be a metric name

mngr on (2024-10-04 16:51:01 UTC): ""When we create a new ad-hoc question based on a metric (v2), the visualization settings will contain that metric name in the visualization_settings instead of the aggregation metric.""
I can't reproduce this

ranquild on (2024-10-21 14:57:43 UTC): Can't reproduce; was fixed by recent BE changes

"
2351179197,issue,closed,completed,Indexed Entities lack visual context in command palette,"### Describe the bug

<img width=""1198"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6377293/37551cdb-eada-422c-9915-0cad84bf1e6c"">

The indexed entities in the command palette lack visual information

Contrast with 49's search results:
<img width=""1383"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6377293/ee2ad800-7736-4419-845c-a65144b4ec22"">

and the full page results
<img width=""1535"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6377293/9dea1d98-0df4-42c4-9320-9f9ca29200b8"">


### To Reproduce

on a 50 or master version, create a model on Products, edit it's metadata and create an index on the title

![image](https://github.com/metabase/metabase/assets/6377293/23bb7dd9-3d9d-44f0-8448-b3404d76ab2f)

Then use command palette to search for some of the products (""rustic"" is a great search term)

### Expected behavior

Some visual indicator that these are _rows_ in a model rather than just tables or cards themselves.

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```


### Severity

p3

### Additional context

_No response_",dpsutton,2024-06-13 13:35:49+00:00,['npfitz'],2024-07-09 17:36:03+00:00,2024-07-09 16:46:31+00:00,https://github.com/metabase/metabase/issues/44136,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Organization/Search', ''), ('.Frontend', ''), ('Querying/Models', 'aka Datasets'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2166526639, 'issue_id': 2351179197, 'author': 'mazameli', 'body': 'My suggested solution is for this to take the form: `{Indexed entity name} — a record in {table/model display name}`, e.g.:\r\n\r\n**Rustic Paper Bench** —\xa0a record in Products', 'created_at': datetime.datetime(2024, 6, 13, 18, 36, 56, tzinfo=datetime.timezone.utc)}]","mazameli on (2024-06-13 18:36:56 UTC): My suggested solution is for this to take the form: `{Indexed entity name} — a record in {table/model display name}`, e.g.:

**Rustic Paper Bench** — a record in Products

"
2351144553,issue,closed,completed,Bar chart is taking goal line and y-axis (probably x-axis as well) as decimals,"### Describe the bug

In https://embedding-demo.metabase.com/ the first chart has the goal line and the y-axis way off its normal limits:
- goal line (9 thousand when it's at 90)
- y axis (10 thousand when it's 100)

### To Reproduce

Go to embedding demo
see the first chart

### Expected behavior

It should display the axis and goal lines to what it was set

### Logs

NA

### Information about your Metabase installation

```JSON
v50
```


### Severity

P2

### Additional context

_No response_",paoliniluis,2024-06-13 13:22:06+00:00,['JesseSDevaney'],2024-06-17 20:44:44+00:00,2024-06-17 20:44:44+00:00,https://github.com/metabase/metabase/issues/44135,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Chart Settings', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2351144258,issue,closed,completed,"""New metric"" action does not exist in a command palette","### Describe the bug

We have a very useful command palette that a lot of people use as a shortcut. The ""New metric"" action is missing.

### To Reproduce

1. Type `CMD + K` or `CTRL + K`
2. Notice there's no ""New metric""

![image](https://github.com/metabase/metabase/assets/31325167/b4f4c9db-c089-4a22-a658-8242741b6749)


### Expected behavior

""New metric"" exists in the ""Actions"" section of the command palette.

### Logs

_No response_

### Information about your Metabase installation

local dev, `master` @ 68bd978, H2, Sample Database



### Severity

P3

### Additional context

_No response_",nemanjaglumac,2024-06-13 13:21:58+00:00,['romeovs'],2024-10-08 16:14:02+00:00,2024-10-01 09:21:59+00:00,https://github.com/metabase/metabase/issues/44134,"[('Type:Bug', 'Product defects'), ('Type:UX', ''), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature'), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Querying/Metrics', 'v2')]",[],
2351111090,issue,closed,completed,"v0.50.x - ""scale: Timeseries"" not working with Oracle database - ""invalid time zone in DateTimeFormat(): +00:00""","### Describe the bug

Since v0.50.x visualizations using `scale: Timeseries` (Bar, Line, Area, Combo) are not working with **Oracle Databases** any more.

![grafik](https://github.com/metabase/metabase/assets/2795336/c499cac7-c18b-47ae-b29e-178dd9339833)





### To Reproduce

1. Set up a new metabse-Instance with docker putting an `oracle-jdbc-driver` into the plugins folder.
2. Connect metabase to the an Oracle Database
3. Make a SQL-Querry against the Oracle Database to receive some testdata with a Date:
```
SELECT CURRENT_DATE, 10 AS VALUE FROM DUAL
UNION ALL
SELECT CURRENT_DATE+1, 20 AS VALUE FROM DUAL
UNION ALL
SELECT CURRENT_DATE+2, 5 AS VALUE FROM DUAL
```
4. Try to visualize the testdata in a `Line` chart using `CURRENT_DATE` as `scale:Timeseries`

I used the latest [ojdbc11.jar](https://download.oracle.com/otn-pub/otn_software/jdbc/234/ojdbc11.jar) as jdbc driver.
To reproduce the error i used the latest [Oracle Database XE Release 21c](https://container-registry.oracle.com/ords/f?p=113:4:116595847545161:::4:P4_REPOSITORY,AI_REPOSITORY,AI_REPOSITORY_NAME,P4_REPOSITORY_NAME,P4_EULA_ID,P4_BUSINESS_AREA_ID:803,803,Oracle%20Database%20Express%20Edition,Oracle%20Database%20Express%20Edition,1,0&cs=31RJ2Qrbu6s3cv9VTJmRigJuIm2BglixteP4I7m8uBo7s1uurGg1td0jk0Lhlme1etvT9Qc-v5-O6uA1el6SuSA)

In my setup to reproduce the error i started a fresh metabase with a fresh oracle-xe Database with the following docker compose file:
```
version: ""2""


services:
  metabase:
    image: metabase/metabase:v0.50.3
    depends_on:
      - oracle-xe
    ports:
      - 3000:3000
    volumes:
      - type: bind
        source: ./plugins
        target: /plugins

  oracle-xe:
    image: container-registry.oracle.com/database/express:21.3.0-xe
    ports:
      - 1521:1521
      - 5500:5500
    environment:
      - ORACLE_PWD=test
```
Make sure u have a `plugins` folder with the ojdbc.jar in the folder you have the docker compose.yml.
Start it with `docker compose up`.
You can connect to the oracle database on:
- url: oracle-xe
- port: 1521
- service: XE
- user: system
- password: test


### Expected behavior

The Line Chart should be rendered using `scale: Timeseries` 

### Logs

Browser Console log:
```
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database],\n    :schema #object[Object [object Object]],\n    :value nil,\n    :type :malli.core/missing-key}\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\n    :in [:stages 0], \n    :schema #object[Object [object Object]], \n    :value {:lib/type :mbql.stage/mbql}})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database],\n    :schema #object[Object [object Object]],\n    :value nil,\n    :type :malli.core/missing-key}\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\n    :in [:stages 0], \n    :schema #object[Object [object Object]], \n    :value {:lib/type :mbql.stage/mbql}})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
RangeError: invalid time zone in DateTimeFormat(): +00:00
    tz Angular
    toEChartsAxisValue axis.ts:677
    fn dataset.ts:757
    _ dataset.ts:271
    x dataset.ts:227
    x dataset.ts:225
    x dataset.ts:224
    N dataset.ts:733
    r_ index.ts:130
    w use-models-and-option.ts:68
    React 2
    <anonymous> use-models-and-option.ts:58
    iI CartesianChart.tsx:49
    React 7
    unstable_runWithPriority scheduler.production.min.js:18
    React 4
    Redux 9
    em querying.js:211
    Redux 2
    eo querying.js:139
    promise callback*83402/eo/< querying.js:130
    Redux 2
    runQuery NativeQueryEditor.tsx:388
    React 11
    unstable_runWithPriority scheduler.production.min.js:18
    React 11
    m4 app.js:68
    m6 app.js:99
    71017 app-main.js:24
    Webpack 6
[console.js:13:4](webpack:///lib/errors/console.js)
invalid time zone in DateTimeFormat(): +00:00 [console.js:13:4](webpack:///lib/errors/console.js)
    error console.js:13
    onRenderError Visualization.jsx:325
    componentDidCatch ChartRenderingErrorBoundary.tsx:14
    React 4
    unstable_runWithPriority scheduler.production.min.js:18
    React 4
    unstable_runWithPriority scheduler.production.min.js:18
    React 4
    Redux 9
    em querying.js:211
    Redux 2
    eo querying.js:139
    (Async: promise callback)
    eo querying.js:130
    Redux 2
    runQuery NativeQueryEditor.tsx:388
    React 11
    unstable_runWithPriority scheduler.production.min.js:18
    React 11
    m4 app.js:68
    m6 app.js:99
    71017 app-main.js:24
    Webpack 6

```
Metabase Log:
```
[5ae29451-85d7-4b59-98f5-365ec77fc147] 2024-06-13T14:17:48+02:00 INFO metabase.core 
Metabase v0.50.3 (855535b) 

Copyright © 2024 Metabase, Inc. 

Metabase Enterprise Edition extensions are NOT PRESENT.
[5ae29451-85d7-4b59-98f5-365ec77fc147] 2024-06-13T14:17:48+02:00 INFO metabase.core Starting Metabase in STANDALONE mode
[5ae29451-85d7-4b59-98f5-365ec77fc147] 2024-06-13T14:17:48+02:00 INFO metabase.server Launching Embedded Jetty Webserver with config:
 {:port 3000, :host ""0.0.0.0""}

[5ae29451-85d7-4b59-98f5-365ec77fc147] 2024-06-13T14:17:48+02:00 INFO metabase.core Starting Metabase version v0.50.3 (855535b) ...
[5ae29451-85d7-4b59-98f5-365ec77fc147] 2024-06-13T14:17:48+02:00 INFO metabase.core System info:
 {""file.encoding"" ""UTF-8"",
 ""java.runtime.name"" ""OpenJDK Runtime Environment"",
 ""java.runtime.version"" ""11.0.23+9"",
 ""java.vendor"" ""Eclipse Adoptium"",
 ""java.vendor.url"" ""https://adoptium.net/"",
 ""java.version"" ""11.0.23"",
 ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",
 ""java.vm.version"" ""11.0.23+9"",
 ""os.name"" ""Linux"",
 ""os.version"" ""4.19.128-microsoft-standard"",
 ""user.language"" ""en"",
 ""user.timezone"" ""GMT""}
...
```

No Errors here Error is in Frontend.





### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""de"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""4.19.128-microsoft-standard"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""oracle""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-13"",
      ""tag"": ""v0.50.3"",
      ""hash"": ""855535b""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Workaround exits using `scale:Ordinal`

### Additional context

Error only seen using an Oracle Database. Using H2-DB works fine

Using `scale: Ordinal` works as expected.
![grafik](https://github.com/metabase/metabase/assets/2795336/2b1f3e7c-d3bb-4920-8d51-ed2e43e1ad89)

Request to database works fine and result set is shown.:
![grafik](https://github.com/metabase/metabase/assets/2795336/c89d1ee4-342f-4af5-bf0b-06bc4c0c36c7)

Error is thrown in frontend while rendering the chart:
![grafik](https://github.com/metabase/metabase/assets/2795336/6c5a4955-50e4-4bf6-8583-68396f2e9051)

",itgkarl,2024-06-13 13:08:20+00:00,['alxnddr'],2024-06-14 20:17:44+00:00,2024-06-14 20:17:44+00:00,https://github.com/metabase/metabase/issues/44128,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Oracle', None), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Escalation', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2165652652, 'issue_id': 2351111090, 'author': 'paoliniluis', 'body': 'thanks, this worked in v49 right?', 'created_at': datetime.datetime(2024, 6, 13, 13, 19, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2165693629, 'issue_id': 2351111090, 'author': 'itgkarl', 'body': '@paoliniluis Last version we used `scale:Timestamp` wit Oracle successfully was `v0.49.13`.\r\nSo yes. v49 seems to work.', 'created_at': datetime.datetime(2024, 6, 13, 13, 34, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2165732425, 'issue_id': 2351111090, 'author': 'itgkarl', 'body': '@paoliniluis I just retested it with the same local setup i showed the error in v0.50.3.\r\nI can confirm, that it worked in v0.49.16 with the same setup. No error in v0.49.16', 'created_at': datetime.datetime(2024, 6, 13, 13, 48, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166730076, 'issue_id': 2351111090, 'author': 'alxnddr', 'body': '**upd: please ignore the ask below, I managed to reproduce it but only in Safari on non-IANA timezones** \r\n\r\n@itgkarl could you please provide the backend response for the sql query you provided?\r\nIn order to do that, you need to \r\n\r\n- new -> SQL query\r\n- paste your query\r\n- open browser developer tools\r\n- navigate to the ""Network"" tab\r\n- run the query\r\n- find a request `http://*your_host*/api/dataset`\r\n- share the response of the server which should look like\r\n\r\n```\r\n{\r\n    ""data"": {\r\n        ""rows"": [\r\n            [\r\n                ""2024-06-13T17:38:41Z"",\r\n                10\r\n            ],\r\n            [\r\n                ""2024-06-14T17:38:41Z"",\r\n                20\r\n            ],\r\n            [\r\n                ""2024-06-15T17:38:41Z"",\r\n                5\r\n            ]\r\n        ],\r\n        ""cols"": [....],\r\n        ""native_form"": {...},\r\n        ""format-rows?"": true,\r\n        ""results_timezone"": ""+00:00"",\r\n    }\r\n}\r\n```', 'created_at': datetime.datetime(2024, 6, 13, 20, 40, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2167335430, 'issue_id': 2351111090, 'author': 'itgkarl', 'body': '@alxnddr \r\nHappy you could reproduce it. I looked into the response anyways. Maybe it still helps to validate the fix.\r\nI get the error on `Firefox 115-12-0esr` with following response:\r\n```\r\n{\r\n   ""data"":{\r\n      ""rows"":[\r\n         [\r\n            ""2024-06-14T06:36:36Z"",\r\n            10\r\n         ],\r\n         [\r\n            ""2024-06-15T06:36:36Z"",\r\n            20\r\n         ],\r\n         [\r\n            ""2024-06-16T06:36:36Z"",\r\n            5\r\n         ]\r\n      ],\r\n      ""cols"":[\r\n         {\r\n            ""display_name"":""CURRENT_DATE"",\r\n            ""source"":""native"",\r\n            ""field_ref"":[\r\n               ""field"",\r\n               ""CURRENT_DATE"",\r\n               {\r\n                  ""base-type"":""type/Date""\r\n               }\r\n            ],\r\n            ""name"":""CURRENT_DATE"",\r\n            ""base_type"":""type/Date"",\r\n            ""effective_type"":""type/Date""\r\n         },\r\n         {\r\n            ""display_name"":""VALUE"",\r\n            ""source"":""native"",\r\n            ""field_ref"":[\r\n               ""field"",\r\n               ""VALUE"",\r\n               {\r\n                  ""base-type"":""type/Decimal""\r\n               }\r\n            ],\r\n            ""name"":""VALUE"",\r\n            ""base_type"":""type/Decimal"",\r\n            ""effective_type"":""type/Decimal""\r\n         }\r\n      ],\r\n      ""native_form"":{\r\n         ""params"":null,\r\n         ""query"":""SELECT CURRENT_DATE, 10 AS VALUE FROM DUAL\\nUNION ALL\\nSELECT CURRENT_DATE+1, 20 AS VALUE FROM DUAL\\nUNION ALL\\nSELECT CURRENT_DATE+2, 5 AS VALUE FROM DUAL""\r\n      },\r\n      ""format-rows?"":true,\r\n      ""results_timezone"":""+00:00"",\r\n      ""results_metadata"":{\r\n         ""columns"":[\r\n            {\r\n               ""display_name"":""CURRENT_DATE"",\r\n               ""field_ref"":[\r\n                  ""field"",\r\n                  ""CURRENT_DATE"",\r\n                  {\r\n                     ""base-type"":""type/Date""\r\n                  }\r\n               ],\r\n               ""name"":""CURRENT_DATE"",\r\n               ""base_type"":""type/Date"",\r\n               ""effective_type"":""type/Date"",\r\n               ""semantic_type"":null,\r\n               ""fingerprint"":{\r\n                  ""global"":{\r\n                     ""distinct-count"":3,\r\n                     ""nil%"":0.0\r\n                  },\r\n                  ""type"":{\r\n                     ""type/DateTime"":{\r\n                        ""earliest"":""2024-06-14T06:36:36Z"",\r\n                        ""latest"":""2024-06-16T06:36:36Z""\r\n                     }\r\n                  }\r\n               }\r\n            },\r\n            {\r\n               ""display_name"":""VALUE"",\r\n               ""field_ref"":[\r\n                  ""field"",\r\n                  ""VALUE"",\r\n                  {\r\n                     ""base-type"":""type/Decimal""\r\n                  }\r\n               ],\r\n               ""name"":""VALUE"",\r\n               ""base_type"":""type/Decimal"",\r\n               ""effective_type"":""type/Decimal"",\r\n               ""semantic_type"":null,\r\n               ""fingerprint"":{\r\n                  ""global"":{\r\n                     ""distinct-count"":3,\r\n                     ""nil%"":0.0\r\n                  },\r\n                  ""type"":{\r\n                     ""type/Number"":{\r\n                        ""min"":5.0,\r\n                        ""q1"":6.25,\r\n                        ""q3"":17.5,\r\n                        ""max"":20.0,\r\n                        ""sd"":7.637626158259733,\r\n                        ""avg"":11.666666666666666\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n         ]\r\n      },\r\n      ""insights"":[\r\n         {\r\n            ""previous-value"":20,\r\n            ""unit"":""day"",\r\n            ""offset"":49734.85520833334,\r\n            ""last-change"":-0.75,\r\n            ""col"":""VALUE"",\r\n            ""slope"":-2.5,\r\n            ""last-value"":5,\r\n            ""best-fit"":[\r\n               ""+"",\r\n               49734.85520833334,\r\n               [\r\n                  ""*"",\r\n                  -2.5,\r\n                  ""x""\r\n               ]\r\n            ]\r\n         }\r\n      ]\r\n   },\r\n   ""cached"":false,\r\n   ""database_id"":2,\r\n   ""started_at"":""2024-06-14T06:36:36.578501Z"",\r\n   ""json_query"":{\r\n      ""type"":""native"",\r\n      ""native"":{\r\n         ""query"":""SELECT CURRENT_DATE, 10 AS VALUE FROM DUAL\\nUNION ALL\\nSELECT CURRENT_DATE+1, 20 AS VALUE FROM DUAL\\nUNION ALL\\nSELECT CURRENT_DATE+2, 5 AS VALUE FROM DUAL"",\r\n         ""template-tags"":{\r\n            \r\n         }\r\n      },\r\n      ""database"":2,\r\n      ""middleware"":{\r\n         ""js-int-to-string?"":true,\r\n         ""userland-query?"":true,\r\n         ""add-default-userland-constraints?"":true\r\n      }\r\n   },\r\n   ""average_execution_time"":null,\r\n   ""status"":""completed"",\r\n   ""context"":""ad-hoc"",\r\n   ""row_count"":3,\r\n   ""running_time"":16\r\n}\r\n```', 'created_at': datetime.datetime(2024, 6, 14, 6, 44, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168573158, 'issue_id': 2351111090, 'author': 'alxnddr', 'body': '@itgkarl thank you for additional information! We will include the fix in the next maintenance version', 'created_at': datetime.datetime(2024, 6, 14, 18, 44, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168625385, 'issue_id': 2351111090, 'author': 'alxnddr', 'body': 'Reopen until the backport PR gets merged', 'created_at': datetime.datetime(2024, 6, 14, 19, 20, 44, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-13 13:19:12 UTC): thanks, this worked in v49 right?

itgkarl (Issue Creator) on (2024-06-13 13:34:08 UTC): @paoliniluis Last version we used `scale:Timestamp` wit Oracle successfully was `v0.49.13`.
So yes. v49 seems to work.

itgkarl (Issue Creator) on (2024-06-13 13:48:47 UTC): @paoliniluis I just retested it with the same local setup i showed the error in v0.50.3.
I can confirm, that it worked in v0.49.16 with the same setup. No error in v0.49.16

alxnddr (Assginee) on (2024-06-13 20:40:40 UTC): **upd: please ignore the ask below, I managed to reproduce it but only in Safari on non-IANA timezones** 

@itgkarl could you please provide the backend response for the sql query you provided?
In order to do that, you need to 

- new -> SQL query
- paste your query
- open browser developer tools
- navigate to the ""Network"" tab
- run the query
- find a request `http://*your_host*/api/dataset`
- share the response of the server which should look like

```
{
    ""data"": {
        ""rows"": [
            [
                ""2024-06-13T17:38:41Z"",
                10
            ],
            [
                ""2024-06-14T17:38:41Z"",
                20
            ],
            [
                ""2024-06-15T17:38:41Z"",
                5
            ]
        ],
        ""cols"": [....],
        ""native_form"": {...},
        ""format-rows?"": true,
        ""results_timezone"": ""+00:00"",
    }
}
```

itgkarl (Issue Creator) on (2024-06-14 06:44:33 UTC): @alxnddr 
Happy you could reproduce it. I looked into the response anyways. Maybe it still helps to validate the fix.
I get the error on `Firefox 115-12-0esr` with following response:
```
{
   ""data"":{
      ""rows"":[
         [
            ""2024-06-14T06:36:36Z"",
            10
         ],
         [
            ""2024-06-15T06:36:36Z"",
            20
         ],
         [
            ""2024-06-16T06:36:36Z"",
            5
         ]
      ],
      ""cols"":[
         {
            ""display_name"":""CURRENT_DATE"",
            ""source"":""native"",
            ""field_ref"":[
               ""field"",
               ""CURRENT_DATE"",
               {
                  ""base-type"":""type/Date""
               }
            ],
            ""name"":""CURRENT_DATE"",
            ""base_type"":""type/Date"",
            ""effective_type"":""type/Date""
         },
         {
            ""display_name"":""VALUE"",
            ""source"":""native"",
            ""field_ref"":[
               ""field"",
               ""VALUE"",
               {
                  ""base-type"":""type/Decimal""
               }
            ],
            ""name"":""VALUE"",
            ""base_type"":""type/Decimal"",
            ""effective_type"":""type/Decimal""
         }
      ],
      ""native_form"":{
         ""params"":null,
         ""query"":""SELECT CURRENT_DATE, 10 AS VALUE FROM DUAL\nUNION ALL\nSELECT CURRENT_DATE+1, 20 AS VALUE FROM DUAL\nUNION ALL\nSELECT CURRENT_DATE+2, 5 AS VALUE FROM DUAL""
      },
      ""format-rows?"":true,
      ""results_timezone"":""+00:00"",
      ""results_metadata"":{
         ""columns"":[
            {
               ""display_name"":""CURRENT_DATE"",
               ""field_ref"":[
                  ""field"",
                  ""CURRENT_DATE"",
                  {
                     ""base-type"":""type/Date""
                  }
               ],
               ""name"":""CURRENT_DATE"",
               ""base_type"":""type/Date"",
               ""effective_type"":""type/Date"",
               ""semantic_type"":null,
               ""fingerprint"":{
                  ""global"":{
                     ""distinct-count"":3,
                     ""nil%"":0.0
                  },
                  ""type"":{
                     ""type/DateTime"":{
                        ""earliest"":""2024-06-14T06:36:36Z"",
                        ""latest"":""2024-06-16T06:36:36Z""
                     }
                  }
               }
            },
            {
               ""display_name"":""VALUE"",
               ""field_ref"":[
                  ""field"",
                  ""VALUE"",
                  {
                     ""base-type"":""type/Decimal""
                  }
               ],
               ""name"":""VALUE"",
               ""base_type"":""type/Decimal"",
               ""effective_type"":""type/Decimal"",
               ""semantic_type"":null,
               ""fingerprint"":{
                  ""global"":{
                     ""distinct-count"":3,
                     ""nil%"":0.0
                  },
                  ""type"":{
                     ""type/Number"":{
                        ""min"":5.0,
                        ""q1"":6.25,
                        ""q3"":17.5,
                        ""max"":20.0,
                        ""sd"":7.637626158259733,
                        ""avg"":11.666666666666666
                     }
                  }
               }
            }
         ]
      },
      ""insights"":[
         {
            ""previous-value"":20,
            ""unit"":""day"",
            ""offset"":49734.85520833334,
            ""last-change"":-0.75,
            ""col"":""VALUE"",
            ""slope"":-2.5,
            ""last-value"":5,
            ""best-fit"":[
               ""+"",
               49734.85520833334,
               [
                  ""*"",
                  -2.5,
                  ""x""
               ]
            ]
         }
      ]
   },
   ""cached"":false,
   ""database_id"":2,
   ""started_at"":""2024-06-14T06:36:36.578501Z"",
   ""json_query"":{
      ""type"":""native"",
      ""native"":{
         ""query"":""SELECT CURRENT_DATE, 10 AS VALUE FROM DUAL\nUNION ALL\nSELECT CURRENT_DATE+1, 20 AS VALUE FROM DUAL\nUNION ALL\nSELECT CURRENT_DATE+2, 5 AS VALUE FROM DUAL"",
         ""template-tags"":{
            
         }
      },
      ""database"":2,
      ""middleware"":{
         ""js-int-to-string?"":true,
         ""userland-query?"":true,
         ""add-default-userland-constraints?"":true
      }
   },
   ""average_execution_time"":null,
   ""status"":""completed"",
   ""context"":""ad-hoc"",
   ""row_count"":3,
   ""running_time"":16
}
```

alxnddr (Assginee) on (2024-06-14 18:44:01 UTC): @itgkarl thank you for additional information! We will include the fix in the next maintenance version

alxnddr (Assginee) on (2024-06-14 19:20:44 UTC): Reopen until the backport PR gets merged

"
2351108646,issue,closed,completed,Appytown is failing on question 6,"### Describe the bug

Our Appytown demo has a failing question:
https://appytown.metabase.com/

In https://appytown.metabaseapp.com/api/public/dashboard/ea8c2738-2518-422f-b497-d21d5418a166/dashcard/4/card/6?parameters=%5B%7B%22type%22%3A%22string%2F%3D%22%2C%22value%22%3Anull%2C%22id%22%3A%22531be19c%22%2C%22target%22%3A%5B%22dimension%22%2C%5B%22field%22%2C1267%2Cnull%5D%5D%7D%2C%7B%22type%22%3A%22string%2F%3D%22%2C%22value%22%3Anull%2C%22id%22%3A%2226c7f5a8%22%2C%22target%22%3A%5B%22dimension%22%2C%5B%22field%22%2C1268%2Cnull%5D%5D%7D%5D

it returns:
```
{
    ""status"": ""failed"",
    ""error"": ""An error occurred while running the query."",
    ""error_type"": ""invalid-query""
}
```

### To Reproduce

1) go to https://appytown.metabase.com/
2) see the dashboard

### Expected behavior

Questions should work

### Logs

NA

### Information about your Metabase installation

```JSON
v50.3
```


### Severity

P1

### Additional context

_No response_",paoliniluis,2024-06-13 13:07:17+00:00,['snoe'],2024-08-28 02:09:55+00:00,2024-07-18 20:07:19+00:00,https://github.com/metabase/metabase/issues/44127,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Dashboards', ''), ('Querying/Processor', ''), ('.Backend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/Querying', '')]","[{'comment_id': 2167872741, 'issue_id': 2351108646, 'author': 'bshepherdson', 'body': ""The big link is broken (at least for me), and I can't see any errors now on loading the main page [https://appytown.metabase.com/](https://appytown.metabase.com/).\r\n\r\nI also don't see any requests for question 6 - has it been removed to prevent the error from bringing down the whole dashboard? If so, where can I see that query and trigger the error?\r\n\r\nI do see `org.eclipse.jetty.io.EofException`s while streaming query results in the logs from around when this issue was raised. But the error log indicates that it was executing question 5, which is now working (the stacked bar chart of top-earning developers). I actually still see the same error logs now, even though that question is working."", 'created_at': datetime.datetime(2024, 6, 14, 12, 1, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2167906064, 'issue_id': 2351108646, 'author': 'paoliniluis', 'body': '@bshepherdson the question is now removed, if you access the instance you will be able to see it', 'created_at': datetime.datetime(2024, 6, 14, 12, 19, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168165325, 'issue_id': 2351108646, 'author': 'bshepherdson', 'body': ""Okay, I have visibility now.\r\n\r\nThis is failing to validate the query because the argument to `:sum` isn't a number. That's wrong; it's clearly a numeric column (1266, weekly active users) and all the metadata agrees it's `:type/BigInteger`.\r\n\r\nI'm going to try reproducing this locally with a similar CSV upload, model and query."", 'created_at': datetime.datetime(2024, 6, 14, 14, 26, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168205728, 'issue_id': 2351108646, 'author': 'bshepherdson', 'body': 'I can\'t reproduce this directly. Also if I duplicate the query on the Appytown instance, it works fine.\r\n\r\nLooking at those two queries, the obvious difference is that the original broken one uses `[:sum [:field 1266 {...}]]` and the new working one uses `[:sum [:field ""weekly_active_users"" {...}]]`. The latter (using the model\'s column names rather than Field IDs) is what I\'d expect to see for queries against a model.\r\n\r\nHypothesis: This `Apps` model used to be either a saved question, or a direct table reference, and then its source was changed to the model, but the refs stayed broken.\r\n\r\nI\'ll see if I can reproduce it like that.', 'created_at': datetime.datetime(2024, 6, 14, 14, 49, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168222881, 'issue_id': 2351108646, 'author': 'bshepherdson', 'body': ""No repro with those two paths.\r\n\r\n- Changing the data source from the table to the model dropped everything from the rest of the query; the rebuilt aggregation used a correct ref.\r\n- Starting with a SQ and then turning that into a model did keep the ID refs, but the query still works. So that probably was the path but it doesn't repro locally.\r\n\r\nWithout a repro on master, I'm not sure what else to say here. I think dropping that aggregation and replacing it will fix the Appytown question, and if that doesn't work then a duplicate of the query works fine."", 'created_at': datetime.datetime(2024, 6, 14, 14, 58, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2203623805, 'issue_id': 2351108646, 'author': 'bshepherdson', 'body': ""@paoliniluis This one is sort of ambiguous. I suspect it was fixed by something like #44418, but I'm not certain of that.\r\n\r\nIs it worth debugging further, or should we just duplicate the question and move on?"", 'created_at': datetime.datetime(2024, 7, 2, 15, 50, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2207195357, 'issue_id': 2351108646, 'author': 'paoliniluis', 'body': 'Duplicating the query doesn\'t work, recreating does the trick\r\n\r\nthere are some major differences between the old question and recreating this in 50:\r\nv50:\r\n```\r\n{\r\n    ""cache_invalidated_at"": null,\r\n    ""description"": null,\r\n    ""archived"": false,\r\n    ""view_count"": 1,\r\n    ""collection_position"": null,\r\n    ""table_id"": 54,\r\n    ""can_run_adhoc_query"": true,\r\n    ""result_metadata"": [\r\n        {\r\n            ""description"": ""The team who developed it."",\r\n            ""semantic_type"": ""type/Category"",\r\n            ""name"": ""developer"",\r\n            ""field_ref"": [\r\n                ""field"",\r\n                ""developer"",\r\n                {\r\n                    ""base-type"": ""type/Text""\r\n                }\r\n            ],\r\n            ""effective_type"": ""type/Text"",\r\n            ""id"": 1267,\r\n            ""visibility_type"": ""normal"",\r\n            ""display_name"": ""Developer"",\r\n            ""fingerprint"": {\r\n                ""global"": {\r\n                    ""distinct-count"": 10,\r\n                    ""nil%"": 0\r\n                },\r\n                ""type"": {\r\n                    ""type/Text"": {\r\n                        ""percent-json"": 0,\r\n                        ""percent-url"": 0,\r\n                        ""percent-email"": 0,\r\n                        ""percent-state"": 0,\r\n                        ""average-length"": 12.4\r\n                    }\r\n                }\r\n            },\r\n            ""base_type"": ""type/Text""\r\n        },\r\n        {\r\n            ""display_name"": ""Sum of Weekly Active Users"",\r\n            ""semantic_type"": ""type/Quantity"",\r\n            ""field_ref"": [\r\n                ""aggregation"",\r\n                0\r\n            ],\r\n            ""name"": ""sum"",\r\n            ""base_type"": ""type/Decimal"",\r\n            ""effective_type"": ""type/Decimal"",\r\n            ""fingerprint"": {\r\n                ""global"": {\r\n                    ""distinct-count"": 10,\r\n                    ""nil%"": 0\r\n                },\r\n                ""type"": {\r\n                    ""type/Number"": {\r\n                        ""min"": 190,\r\n                        ""q1"": 321,\r\n                        ""q3"": 3155,\r\n                        ""max"": 4803,\r\n                        ""sd"": 1704.2764805694592,\r\n                        ""avg"": 1419.9\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    ],\r\n    ""creator"": {\r\n        ""email"": ""dahyei@metabase.com"",\r\n        ""first_name"": ""Dahyei "",\r\n        ""last_login"": ""2024-07-03T17:43:05.874549Z"",\r\n        ""is_qbnewb"": false,\r\n        ""is_superuser"": true,\r\n        ""id"": 35,\r\n        ""last_name"": ""Kim"",\r\n        ""date_joined"": ""2024-03-15T18:49:38.326395Z"",\r\n        ""common_name"": ""Dahyei  Kim""\r\n    },\r\n    ""initially_published_at"": null,\r\n    ""can_write"": true,\r\n    ""database_id"": 2,\r\n    ""enable_embedding"": false,\r\n    ""collection_id"": null,\r\n    ""query_type"": ""query"",\r\n    ""name"": ""Luis test"",\r\n    ""last_query_start"": null,\r\n    ""dashboard_count"": 0,\r\n    ""last_used_at"": null,\r\n    ""type"": ""question"",\r\n    ""average_query_time"": null,\r\n    ""creator_id"": 35,\r\n    ""moderation_reviews"": [],\r\n    ""updated_at"": ""2024-07-03T17:58:55.346292Z"",\r\n    ""made_public_by_id"": null,\r\n    ""embedding_params"": null,\r\n    ""cache_ttl"": null,\r\n    ""dataset_query"": {\r\n        ""database"": 2,\r\n        ""type"": ""query"",\r\n        ""query"": {\r\n            ""aggregation"": [\r\n                [\r\n                    ""sum"",\r\n                    [\r\n                        ""field"",\r\n                        ""weekly_active_users"",\r\n                        {\r\n                            ""base-type"": ""type/BigInteger""\r\n                        }\r\n                    ]\r\n                ]\r\n            ],\r\n            ""breakout"": [\r\n                [\r\n                    ""field"",\r\n                    ""developer"",\r\n                    {\r\n                        ""base-type"": ""type/Text""\r\n                    }\r\n                ]\r\n            ],\r\n            ""order-by"": [\r\n                [\r\n                    ""desc"",\r\n                    [\r\n                        ""aggregation"",\r\n                        0\r\n                    ]\r\n                ]\r\n            ],\r\n            ""source-table"": ""card__1""\r\n        }\r\n    },\r\n    ""id"": 142,\r\n    ""parameter_mappings"": [],\r\n    ""display"": ""bar"",\r\n    ""entity_id"": ""Js2m-6kDEWUJ2pBfp033c"",\r\n    ""collection_preview"": true,\r\n    ""last-edit-info"": {\r\n        ""id"": 35,\r\n        ""email"": ""xxxxxx@metabase.com"",\r\n        ""first_name"": ""xxxx "",\r\n        ""last_name"": ""xxxx"",\r\n        ""timestamp"": ""2024-07-03T17:58:55.35857Z""\r\n    },\r\n    ""visualization_settings"": {\r\n        ""graph.dimensions"": [\r\n            ""developer""\r\n        ],\r\n        ""graph.metrics"": [\r\n            ""sum""\r\n        ]\r\n    },\r\n    ""collection"": {\r\n        ""metabase.models.collection.root/is-root?"": true,\r\n        ""authority_level"": null,\r\n        ""name"": ""Our analytics"",\r\n        ""is_personal"": false,\r\n        ""id"": ""root"",\r\n        ""can_write"": true\r\n    },\r\n    ""metabase_version"": ""v1.50.3 (855535b)"",\r\n    ""parameters"": [],\r\n    ""created_at"": ""2024-07-03T17:58:55.346292Z"",\r\n    ""parameter_usage_count"": 0,\r\n    ""public_uuid"": null\r\n}\r\n```\r\n\r\nversion unknown:\r\n```\r\n{\r\n    ""cache_invalidated_at"": null,\r\n    ""description"": ""How many weekly active users a developer has across all their apps."",\r\n    ""archived"": false,\r\n    ""view_count"": 18419,\r\n    ""collection_position"": null,\r\n    ""table_id"": 54,\r\n    ""can_run_adhoc_query"": true,\r\n    ""result_metadata"": [\r\n        {\r\n            ""description"": ""The team who developed it."",\r\n            ""semantic_type"": ""type/Category"",\r\n            ""table_id"": 54,\r\n            ""coercion_strategy"": null,\r\n            ""name"": ""developer"",\r\n            ""settings"": null,\r\n            ""source"": ""breakout"",\r\n            ""fk_target_field_id"": null,\r\n            ""field_ref"": [\r\n                ""field"",\r\n                1267,\r\n                {\r\n                    ""base-type"": ""type/Text""\r\n                }\r\n            ],\r\n            ""effective_type"": ""type/Text"",\r\n            ""nfc_path"": null,\r\n            ""parent_id"": null,\r\n            ""id"": 1267,\r\n            ""position"": 5,\r\n            ""visibility_type"": ""normal"",\r\n            ""display_name"": ""Developer"",\r\n            ""fingerprint"": {\r\n                ""global"": {\r\n                    ""distinct-count"": 10,\r\n                    ""nil%"": 0.0\r\n                },\r\n                ""type"": {\r\n                    ""type/Text"": {\r\n                        ""percent-json"": 0.0,\r\n                        ""percent-url"": 0.0,\r\n                        ""percent-email"": 0.0,\r\n                        ""percent-state"": 0.0,\r\n                        ""average-length"": 12.4\r\n                    }\r\n                }\r\n            },\r\n            ""base_type"": ""type/Text""\r\n        },\r\n        {\r\n            ""settings"": null,\r\n            ""semantic_type"": null,\r\n            ""base_type"": ""type/BigInteger"",\r\n            ""name"": ""sum"",\r\n            ""display_name"": ""Sum of Weekly Active Users"",\r\n            ""source"": ""aggregation"",\r\n            ""field_ref"": [\r\n                ""aggregation"",\r\n                0\r\n            ],\r\n            ""aggregation_index"": 0\r\n        }\r\n    ],\r\n    ""creator"": {\r\n        ""email"": ""xxxxxx@metabase.com"",\r\n        ""first_name"": ""Alex"",\r\n        ""last_login"": ""2024-03-15T18:41:26.21811Z"",\r\n        ""is_qbnewb"": false,\r\n        ""is_superuser"": true,\r\n        ""id"": 2,\r\n        ""last_name"": ""xxxxx"",\r\n        ""date_joined"": ""2023-06-30T21:37:03.441437Z"",\r\n        ""common_name"": ""xxxxx""\r\n    },\r\n    ""initially_published_at"": null,\r\n    ""can_write"": true,\r\n    ""database_id"": 2,\r\n    ""enable_embedding"": false,\r\n    ""collection_id"": null,\r\n    ""query_type"": ""query"",\r\n    ""name"": ""Weekly Active Users by Developer"",\r\n    ""last_query_start"": ""2024-06-13T12:34:57.927862Z"",\r\n    ""dashboard_count"": 0,\r\n    ""last_used_at"": null,\r\n    ""type"": ""question"",\r\n    ""average_query_time"": 71.3750725825733511,\r\n    ""creator_id"": 2,\r\n    ""moderation_reviews"": [],\r\n    ""updated_at"": ""2024-05-28T18:29:20.074683Z"",\r\n    ""made_public_by_id"": null,\r\n    ""embedding_params"": null,\r\n    ""cache_ttl"": null,\r\n    ""dataset_query"": {\r\n        ""database"": 2,\r\n        ""type"": ""query"",\r\n        ""query"": {\r\n            ""aggregation"": [\r\n                [\r\n                    ""sum"",\r\n                    [\r\n                        ""field"",\r\n                        1266,\r\n                        {\r\n                            ""base-type"": ""type/BigInteger""\r\n                        }\r\n                    ]\r\n                ]\r\n            ],\r\n            ""breakout"": [\r\n                [\r\n                    ""field"",\r\n                    1267,\r\n                    {\r\n                        ""base-type"": ""type/Text""\r\n                    }\r\n                ]\r\n            ],\r\n            ""order-by"": [\r\n                [\r\n                    ""desc"",\r\n                    [\r\n                        ""aggregation"",\r\n                        0\r\n                    ]\r\n                ]\r\n            ],\r\n            ""source-table"": ""card__1""\r\n        }\r\n    },\r\n    ""id"": 6,\r\n    ""parameter_mappings"": [],\r\n    ""display"": ""bar"",\r\n    ""entity_id"": ""WVNMC7Oqmq_L3aphXN7hC"",\r\n    ""collection_preview"": true,\r\n    ""last-edit-info"": {\r\n        ""id"": 34,\r\n        ""email"": ""xxxxxx@metabase.com"",\r\n        ""first_name"": ""xxxxx"",\r\n        ""last_name"": ""xxxxx"",\r\n        ""timestamp"": ""2024-05-28T18:29:20.140203Z""\r\n    },\r\n    ""visualization_settings"": {\r\n        ""graph.dimensions"": [\r\n            ""developer""\r\n        ],\r\n        ""series_settings"": {\r\n            ""sum"": {\r\n                ""color"": ""#F2A86F""\r\n            }\r\n        },\r\n        ""graph.metrics"": [\r\n            ""sum""\r\n        ]\r\n    },\r\n    ""collection"": {\r\n        ""metabase.models.collection.root/is-root?"": true,\r\n        ""authority_level"": null,\r\n        ""name"": ""Our analytics"",\r\n        ""is_personal"": false,\r\n        ""id"": ""root"",\r\n        ""can_write"": true\r\n    },\r\n    ""metabase_version"": null,\r\n    ""parameters"": [],\r\n    ""created_at"": ""2023-07-05T18:28:56.80812Z"",\r\n    ""parameter_usage_count"": 0,\r\n    ""public_uuid"": null\r\n}\r\n```\r\n\r\nso in order to reproduce this we need for sure to create the card in a very old version and then move to v50', 'created_at': datetime.datetime(2024, 7, 3, 20, 27, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2237450167, 'issue_id': 2351108646, 'author': 'snoe', 'body': '@paoliniluis \n\nSo this happening because the ""Weekly Active Users"" Field has an `effective-type` of `type/Text` and base-type of `type/BigInteger` Fingerprinting is also still marked as `type/Text`. The aggregation blows up because it\'s picking this up due to the field id being used rather than the field name we use if we rebuild the query.\n\nThis data seems to have come from a spreadsheet, I wonder if it was initially imported as a Text and switched to integer later. The other way it gets set is if a coersion strategy was (incorrectly) allowed to be set on the int field and then switched off - but that should go back to base-type.\n\nThis should be fixable in appytown by setting a coercion on the table and setting it back. I\'d also think that sync should solve it but we\'d need to see logs.\n\n![Image](https://github.com/user-attachments/assets/062ed1ac-2ba4-4af2-b3bf-7964cda1370d)', 'created_at': datetime.datetime(2024, 7, 18, 19, 51, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2237472987, 'issue_id': 2351108646, 'author': 'snoe', 'body': 'Spoke with @paoliniluis  and this is ok to close', 'created_at': datetime.datetime(2024, 7, 18, 20, 7, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2244302012, 'issue_id': 2351108646, 'author': 'Somtom', 'body': 'Might be related to #45938', 'created_at': datetime.datetime(2024, 7, 23, 5, 46, 25, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2024-06-14 12:01:09 UTC): The big link is broken (at least for me), and I can't see any errors now on loading the main page [https://appytown.metabase.com/](https://appytown.metabase.com/).

I also don't see any requests for question 6 - has it been removed to prevent the error from bringing down the whole dashboard? If so, where can I see that query and trigger the error?

I do see `org.eclipse.jetty.io.EofException`s while streaming query results in the logs from around when this issue was raised. But the error log indicates that it was executing question 5, which is now working (the stacked bar chart of top-earning developers). I actually still see the same error logs now, even though that question is working.

paoliniluis (Issue Creator) on (2024-06-14 12:19:48 UTC): @bshepherdson the question is now removed, if you access the instance you will be able to see it

bshepherdson on (2024-06-14 14:26:58 UTC): Okay, I have visibility now.

This is failing to validate the query because the argument to `:sum` isn't a number. That's wrong; it's clearly a numeric column (1266, weekly active users) and all the metadata agrees it's `:type/BigInteger`.

I'm going to try reproducing this locally with a similar CSV upload, model and query.

bshepherdson on (2024-06-14 14:49:13 UTC): I can't reproduce this directly. Also if I duplicate the query on the Appytown instance, it works fine.

Looking at those two queries, the obvious difference is that the original broken one uses `[:sum [:field 1266 {...}]]` and the new working one uses `[:sum [:field ""weekly_active_users"" {...}]]`. The latter (using the model's column names rather than Field IDs) is what I'd expect to see for queries against a model.

Hypothesis: This `Apps` model used to be either a saved question, or a direct table reference, and then its source was changed to the model, but the refs stayed broken.

I'll see if I can reproduce it like that.

bshepherdson on (2024-06-14 14:58:56 UTC): No repro with those two paths.

- Changing the data source from the table to the model dropped everything from the rest of the query; the rebuilt aggregation used a correct ref.
- Starting with a SQ and then turning that into a model did keep the ID refs, but the query still works. So that probably was the path but it doesn't repro locally.

Without a repro on master, I'm not sure what else to say here. I think dropping that aggregation and replacing it will fix the Appytown question, and if that doesn't work then a duplicate of the query works fine.

bshepherdson on (2024-07-02 15:50:44 UTC): @paoliniluis This one is sort of ambiguous. I suspect it was fixed by something like #44418, but I'm not certain of that.

Is it worth debugging further, or should we just duplicate the question and move on?

paoliniluis (Issue Creator) on (2024-07-03 20:27:29 UTC): Duplicating the query doesn't work, recreating does the trick

there are some major differences between the old question and recreating this in 50:
v50:
```
{
    ""cache_invalidated_at"": null,
    ""description"": null,
    ""archived"": false,
    ""view_count"": 1,
    ""collection_position"": null,
    ""table_id"": 54,
    ""can_run_adhoc_query"": true,
    ""result_metadata"": [
        {
            ""description"": ""The team who developed it."",
            ""semantic_type"": ""type/Category"",
            ""name"": ""developer"",
            ""field_ref"": [
                ""field"",
                ""developer"",
                {
                    ""base-type"": ""type/Text""
                }
            ],
            ""effective_type"": ""type/Text"",
            ""id"": 1267,
            ""visibility_type"": ""normal"",
            ""display_name"": ""Developer"",
            ""fingerprint"": {
                ""global"": {
                    ""distinct-count"": 10,
                    ""nil%"": 0
                },
                ""type"": {
                    ""type/Text"": {
                        ""percent-json"": 0,
                        ""percent-url"": 0,
                        ""percent-email"": 0,
                        ""percent-state"": 0,
                        ""average-length"": 12.4
                    }
                }
            },
            ""base_type"": ""type/Text""
        },
        {
            ""display_name"": ""Sum of Weekly Active Users"",
            ""semantic_type"": ""type/Quantity"",
            ""field_ref"": [
                ""aggregation"",
                0
            ],
            ""name"": ""sum"",
            ""base_type"": ""type/Decimal"",
            ""effective_type"": ""type/Decimal"",
            ""fingerprint"": {
                ""global"": {
                    ""distinct-count"": 10,
                    ""nil%"": 0
                },
                ""type"": {
                    ""type/Number"": {
                        ""min"": 190,
                        ""q1"": 321,
                        ""q3"": 3155,
                        ""max"": 4803,
                        ""sd"": 1704.2764805694592,
                        ""avg"": 1419.9
                    }
                }
            }
        }
    ],
    ""creator"": {
        ""email"": ""dahyei@metabase.com"",
        ""first_name"": ""Dahyei "",
        ""last_login"": ""2024-07-03T17:43:05.874549Z"",
        ""is_qbnewb"": false,
        ""is_superuser"": true,
        ""id"": 35,
        ""last_name"": ""Kim"",
        ""date_joined"": ""2024-03-15T18:49:38.326395Z"",
        ""common_name"": ""Dahyei  Kim""
    },
    ""initially_published_at"": null,
    ""can_write"": true,
    ""database_id"": 2,
    ""enable_embedding"": false,
    ""collection_id"": null,
    ""query_type"": ""query"",
    ""name"": ""Luis test"",
    ""last_query_start"": null,
    ""dashboard_count"": 0,
    ""last_used_at"": null,
    ""type"": ""question"",
    ""average_query_time"": null,
    ""creator_id"": 35,
    ""moderation_reviews"": [],
    ""updated_at"": ""2024-07-03T17:58:55.346292Z"",
    ""made_public_by_id"": null,
    ""embedding_params"": null,
    ""cache_ttl"": null,
    ""dataset_query"": {
        ""database"": 2,
        ""type"": ""query"",
        ""query"": {
            ""aggregation"": [
                [
                    ""sum"",
                    [
                        ""field"",
                        ""weekly_active_users"",
                        {
                            ""base-type"": ""type/BigInteger""
                        }
                    ]
                ]
            ],
            ""breakout"": [
                [
                    ""field"",
                    ""developer"",
                    {
                        ""base-type"": ""type/Text""
                    }
                ]
            ],
            ""order-by"": [
                [
                    ""desc"",
                    [
                        ""aggregation"",
                        0
                    ]
                ]
            ],
            ""source-table"": ""card__1""
        }
    },
    ""id"": 142,
    ""parameter_mappings"": [],
    ""display"": ""bar"",
    ""entity_id"": ""Js2m-6kDEWUJ2pBfp033c"",
    ""collection_preview"": true,
    ""last-edit-info"": {
        ""id"": 35,
        ""email"": ""xxxxxx@metabase.com"",
        ""first_name"": ""xxxx "",
        ""last_name"": ""xxxx"",
        ""timestamp"": ""2024-07-03T17:58:55.35857Z""
    },
    ""visualization_settings"": {
        ""graph.dimensions"": [
            ""developer""
        ],
        ""graph.metrics"": [
            ""sum""
        ]
    },
    ""collection"": {
        ""metabase.models.collection.root/is-root?"": true,
        ""authority_level"": null,
        ""name"": ""Our analytics"",
        ""is_personal"": false,
        ""id"": ""root"",
        ""can_write"": true
    },
    ""metabase_version"": ""v1.50.3 (855535b)"",
    ""parameters"": [],
    ""created_at"": ""2024-07-03T17:58:55.346292Z"",
    ""parameter_usage_count"": 0,
    ""public_uuid"": null
}
```

version unknown:
```
{
    ""cache_invalidated_at"": null,
    ""description"": ""How many weekly active users a developer has across all their apps."",
    ""archived"": false,
    ""view_count"": 18419,
    ""collection_position"": null,
    ""table_id"": 54,
    ""can_run_adhoc_query"": true,
    ""result_metadata"": [
        {
            ""description"": ""The team who developed it."",
            ""semantic_type"": ""type/Category"",
            ""table_id"": 54,
            ""coercion_strategy"": null,
            ""name"": ""developer"",
            ""settings"": null,
            ""source"": ""breakout"",
            ""fk_target_field_id"": null,
            ""field_ref"": [
                ""field"",
                1267,
                {
                    ""base-type"": ""type/Text""
                }
            ],
            ""effective_type"": ""type/Text"",
            ""nfc_path"": null,
            ""parent_id"": null,
            ""id"": 1267,
            ""position"": 5,
            ""visibility_type"": ""normal"",
            ""display_name"": ""Developer"",
            ""fingerprint"": {
                ""global"": {
                    ""distinct-count"": 10,
                    ""nil%"": 0.0
                },
                ""type"": {
                    ""type/Text"": {
                        ""percent-json"": 0.0,
                        ""percent-url"": 0.0,
                        ""percent-email"": 0.0,
                        ""percent-state"": 0.0,
                        ""average-length"": 12.4
                    }
                }
            },
            ""base_type"": ""type/Text""
        },
        {
            ""settings"": null,
            ""semantic_type"": null,
            ""base_type"": ""type/BigInteger"",
            ""name"": ""sum"",
            ""display_name"": ""Sum of Weekly Active Users"",
            ""source"": ""aggregation"",
            ""field_ref"": [
                ""aggregation"",
                0
            ],
            ""aggregation_index"": 0
        }
    ],
    ""creator"": {
        ""email"": ""xxxxxx@metabase.com"",
        ""first_name"": ""Alex"",
        ""last_login"": ""2024-03-15T18:41:26.21811Z"",
        ""is_qbnewb"": false,
        ""is_superuser"": true,
        ""id"": 2,
        ""last_name"": ""xxxxx"",
        ""date_joined"": ""2023-06-30T21:37:03.441437Z"",
        ""common_name"": ""xxxxx""
    },
    ""initially_published_at"": null,
    ""can_write"": true,
    ""database_id"": 2,
    ""enable_embedding"": false,
    ""collection_id"": null,
    ""query_type"": ""query"",
    ""name"": ""Weekly Active Users by Developer"",
    ""last_query_start"": ""2024-06-13T12:34:57.927862Z"",
    ""dashboard_count"": 0,
    ""last_used_at"": null,
    ""type"": ""question"",
    ""average_query_time"": 71.3750725825733511,
    ""creator_id"": 2,
    ""moderation_reviews"": [],
    ""updated_at"": ""2024-05-28T18:29:20.074683Z"",
    ""made_public_by_id"": null,
    ""embedding_params"": null,
    ""cache_ttl"": null,
    ""dataset_query"": {
        ""database"": 2,
        ""type"": ""query"",
        ""query"": {
            ""aggregation"": [
                [
                    ""sum"",
                    [
                        ""field"",
                        1266,
                        {
                            ""base-type"": ""type/BigInteger""
                        }
                    ]
                ]
            ],
            ""breakout"": [
                [
                    ""field"",
                    1267,
                    {
                        ""base-type"": ""type/Text""
                    }
                ]
            ],
            ""order-by"": [
                [
                    ""desc"",
                    [
                        ""aggregation"",
                        0
                    ]
                ]
            ],
            ""source-table"": ""card__1""
        }
    },
    ""id"": 6,
    ""parameter_mappings"": [],
    ""display"": ""bar"",
    ""entity_id"": ""WVNMC7Oqmq_L3aphXN7hC"",
    ""collection_preview"": true,
    ""last-edit-info"": {
        ""id"": 34,
        ""email"": ""xxxxxx@metabase.com"",
        ""first_name"": ""xxxxx"",
        ""last_name"": ""xxxxx"",
        ""timestamp"": ""2024-05-28T18:29:20.140203Z""
    },
    ""visualization_settings"": {
        ""graph.dimensions"": [
            ""developer""
        ],
        ""series_settings"": {
            ""sum"": {
                ""color"": ""#F2A86F""
            }
        },
        ""graph.metrics"": [
            ""sum""
        ]
    },
    ""collection"": {
        ""metabase.models.collection.root/is-root?"": true,
        ""authority_level"": null,
        ""name"": ""Our analytics"",
        ""is_personal"": false,
        ""id"": ""root"",
        ""can_write"": true
    },
    ""metabase_version"": null,
    ""parameters"": [],
    ""created_at"": ""2023-07-05T18:28:56.80812Z"",
    ""parameter_usage_count"": 0,
    ""public_uuid"": null
}
```

so in order to reproduce this we need for sure to create the card in a very old version and then move to v50

snoe (Assginee) on (2024-07-18 19:51:19 UTC): @paoliniluis 

So this happening because the ""Weekly Active Users"" Field has an `effective-type` of `type/Text` and base-type of `type/BigInteger` Fingerprinting is also still marked as `type/Text`. The aggregation blows up because it's picking this up due to the field id being used rather than the field name we use if we rebuild the query.

This data seems to have come from a spreadsheet, I wonder if it was initially imported as a Text and switched to integer later. The other way it gets set is if a coersion strategy was (incorrectly) allowed to be set on the int field and then switched off - but that should go back to base-type.

This should be fixable in appytown by setting a coercion on the table and setting it back. I'd also think that sync should solve it but we'd need to see logs.

![Image](https://github.com/user-attachments/assets/062ed1ac-2ba4-4af2-b3bf-7964cda1370d)

snoe (Assginee) on (2024-07-18 20:07:19 UTC): Spoke with @paoliniluis  and this is ok to close

Somtom on (2024-07-23 05:46:25 UTC): Might be related to #45938

"
2351010257,issue,closed,completed,Generate changelog before releasing,"Once we have a commit sha to release from, we can generate changelog text, we don't have to wait for the publish step, that way, we can start editing them while other things chug along

Where to put text of draft release notes?
- txt file artifact?
- slack?",iethree,2024-06-13 12:24:12+00:00,['iethree'],2024-07-16 14:29:07+00:00,2024-07-10 10:39:32+00:00,https://github.com/metabase/metabase/issues/44123,"[('.Building & Releasing', '')]","[{'comment_id': 2220160029, 'issue_id': 2351010257, 'author': 'iethree', 'body': 'handled a little differently by https://github.com/metabase/metabase/pull/44980', 'created_at': datetime.datetime(2024, 7, 10, 10, 39, 32, tzinfo=datetime.timezone.utc)}]","iethree (Issue Creator) on (2024-07-10 10:39:32 UTC): handled a little differently by https://github.com/metabase/metabase/pull/44980

"
2350717297,issue,closed,completed,Bar graph failing,"### Describe the bug

When clicking on the bar chart option it fails, opening the console shows an error not communicated to the front-end. Other expected options do work. I checked the server logs but do not see an error on that end.

### Data
| Seller| Count|
|--------|--------|
| Name 1 | 1 |
| Name 2 | 2 |
| Name 3 | 3 | 




### To Reproduce

1. Go to SQL query
2. Click on Visualization
3. Choose bar graph
4. Nothing happens


### Expected behavior

_No response_

### Logs

### Error
```
Uncaught TypeError: Cannot assign to read only property 'stackable.stack_display' of object '#<Object>'
    at lK.onDisplayUpdate (BarChart.jsx:50:42)
    at ChartTypeSidebar.tsx:105:49
    at onClick (ChartTypeSidebar.tsx:135:31)
    at Object.A (react-dom.production.min.js:14:84)
    at v (react-dom.production.min.js:14:238)
    at react-dom.production.min.js:14:292
    at w (react-dom.production.min.js:14:393)
    at to (react-dom.production.min.js:52:170)
    at tn (react-dom.production.min.js:51:255)
    at ti (react-dom.production.min.js:52:334)
```

### Information about your Metabase installation

```JSON
### Diagnostic info

{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 OPR/109.0.0.0"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.8.0-31-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""bigquery-cloud-sdk"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.1 (Debian 16.1-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-28"",
      ""tag"": ""v0.49.13"",
      ""hash"": ""de28e83""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```
```


### Severity

Blocking display of one query

### Additional context

_No response_",diegorolf,2024-06-13 09:57:57+00:00,['alxnddr'],2024-06-14 19:30:29+00:00,2024-06-14 19:30:29+00:00,https://github.com/metabase/metabase/issues/44121,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2165223734, 'issue_id': 2350717297, 'author': 'diegorolf', 'body': 'Issue is solved, but I think this error should be handled so I will leave it open. The problem was I did not give the header an alias. And when I changed ```count(credit_id)```  to ```count(credit_id) as total``` it worked again.\r\n\r\nSame case for ```avg(amount) as amount``` to ```avg(amount) as total```', 'created_at': datetime.datetime(2024, 6, 13, 10, 15, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2165238128, 'issue_id': 2350717297, 'author': 'diegorolf', 'body': 'Hm, it seems that my solution was a nice idea, but not the real issue. As I had already used total in another query, which also failed. But when I changed it to a random string it worked. So the issue is fixed by changing the alias...', 'created_at': datetime.datetime(2024, 6, 13, 10, 20, 43, tzinfo=datetime.timezone.utc)}]","diegorolf (Issue Creator) on (2024-06-13 10:15:08 UTC): Issue is solved, but I think this error should be handled so I will leave it open. The problem was I did not give the header an alias. And when I changed ```count(credit_id)```  to ```count(credit_id) as total``` it worked again.

Same case for ```avg(amount) as amount``` to ```avg(amount) as total```

diegorolf (Issue Creator) on (2024-06-13 10:20:43 UTC): Hm, it seems that my solution was a nice idea, but not the real issue. As I had already used total in another query, which also failed. But when I changed it to a random string it worked. So the issue is fixed by changing the alias...

"
2350709649,issue,closed,not_planned,java.io.EOFException,"### Describe the bug

Fiz uma atualização da versão 0.47.2 para versão 0.50.1 e não estou conseguindo fazer conexão com o meu banco de dados postgreSQL o erro que está acometendo é:

```
[c9b5bde9-114a-4a63-8a8c-52242c6a7ddc] 2024-06-13T06:32:11-03:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: The connection attempt failed.
{:database_id 2,
 :started_at #t ""2024-06-13T09:31:40.661697Z[UTC]"",
 :via
 [{:status :failed,
   :class org.postgresql.util.PSQLException,
   :error ""The connection attempt failed."",
   :stacktrace
   [""org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:358)""
    ""org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54)""
    ""org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:273)""
    ""org.postgresql.Driver.makeConnection(Driver.java:446)""
    ""org.postgresql.Driver.connect(Driver.java:298)""
    ""java.sql/java.sql.DriverManager.getConnection(DriverManager.java:677)""
    ""java.sql/java.sql.DriverManager.getConnection(DriverManager.java:189)""
    ""--> connection_pool$proxy_data_source$reify__42125.getConnection(connection_pool.clj:29)""],
   :state ""08001""}
  {:status :failed,
  ```

### To Reproduce

1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error


### Expected behavior

o certo seria não dar esse erro ja que a versão anterior estava funcionando, atualizei o driver do dremio, por que minha conexão do metabase é com o dremio e mesmo assim nada foi resolvido.

### Logs

_No response_

### Information about your Metabase installation

```JSON
estavamos usando a versão 0.47.2 e baixamos a versão 0.50.1 direto na nossa instancia da aws e colocamos na nossa pasta do metabase o nosso arquivo metabase.jar e iniciamos o serviço.
```


### Severity

importante

### Additional context

Estamos sem saber o que fazer para esse problema.",Geronimonetto,2024-06-13 09:54:58+00:00,[],2024-08-28 02:09:55+00:00,2024-06-14 09:10:29+00:00,https://github.com/metabase/metabase/issues/44120,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2165424250, 'issue_id': 2350709649, 'author': 'paoliniluis', 'body': 'Please post:\r\n1) full logs\r\n2) diagnostic info\r\n3) how you’re connecting to the app db', 'created_at': datetime.datetime(2024, 6, 13, 11, 46, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2165901004, 'issue_id': 2350709649, 'author': 'Geronimonetto', 'body': '{\r\n""browser-info"": {\r\n""language"": ""pt-BR"",\r\n""platform"": ""Win32"",\r\n""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36\r\n(KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36"",\r\n""vendor"": ""Google Inc.""\r\n},\r\n""system-info"": {\r\n""file.encoding"": ""UTF-8"",\r\n""java.runtime.name"": ""OpenJDK Runtime Environment"",\r\n""java.runtime.version"": ""11.0.20.1+9-LTS"",\r\n""java.vendor"": ""Amazon.com Inc."",\r\n""java.vendor.url"": ""https://aws.amazon.com/corretto/"",\r\n""java.version"": ""11.0.20.1"",\r\n""java.vm.name"": ""OpenJDK 64-Bit Server VM"",\r\n""java.vm.version"": ""11.0.20.1+9-LTS"",\r\n""os.name"": ""Linux"",\r\n""os.version"": ""6.1.52-71.125.amzn2023.x86_64"",\r\n""user.language"": ""en"",\r\n""user.timezone"": ""UTC""\r\n},\r\n""metabase-info"": {\r\n""databases"": [\r\n""dremio""\r\n],\r\n""hosting-env"": ""unknown"",\r\n""application-database"": ""postgres"",\r\n""application-database-details"": {\r\n""database"": {\r\n""name"": ""PostgreSQL"",\r\n""version"": ""15.4""\r\n},\r\n""jdbc-driver"": {\r\n""name"": ""PostgreSQL JDBC Driver"",\r\n""version"": ""42.7.3""\r\n}\r\n},\r\n""run-mode"": ""prod"",\r\n""version"": {\r\n""date"": ""2024-06-13"",\r\n""tag"": ""v0.50.3"",\r\n""hash"": ""855535b""\r\n},\r\n""settings"": {\r\n""report-timezone"": null\r\n}\r\n}\r\n}\r\n\r\nEm qui., 13 de jun. de 2024 às 08:46, Luis Paolini ***@***.***>\r\nescreveu:\r\n\r\n> Please post:\r\n>\r\n>    1. full logs\r\n>    2. diagnostic info\r\n>    3. how you’re connecting to the app db\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/metabase/metabase/issues/44120#issuecomment-2165424250>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AZZV7XAD4KPAE64VSZXAYXDZHGBBXAVCNFSM6AAAAABJIBK4ZKVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDCNRVGQZDIMRVGA>\r\n> .\r\n> You are receiving this because you authored the thread.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 6, 13, 14, 49, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166127841, 'issue_id': 2350709649, 'author': 'paoliniluis', 'body': 'So you can’t connect to a new Postgres database, is that correct?', 'created_at': datetime.datetime(2024, 6, 13, 16, 12, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166176339, 'issue_id': 2350709649, 'author': 'Geronimonetto', 'body': 'Não estou conseguindo conectar com nenhum banco de dados na verdade\r\n\r\n\r\nEm qui., 13 de jun. de 2024 às 13:13, Luis Paolini ***@***.***>\r\nescreveu:\r\n\r\n> So you can’t connect to a new Postgres database, is that correct?\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/metabase/metabase/issues/44120#issuecomment-2166127841>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AZZV7XEF7KOI3GHZA5X4PU3ZHHAJJAVCNFSM6AAAAABJIBK4ZKVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDCNRWGEZDOOBUGE>\r\n> .\r\n> You are receiving this because you authored the thread.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 6, 13, 16, 33, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166260599, 'issue_id': 2350709649, 'author': 'paoliniluis', 'body': ""ok so it's definitely the dremio driver, please remove it or downgrade"", 'created_at': datetime.datetime(2024, 6, 13, 16, 57, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2167597673, 'issue_id': 2350709649, 'author': 'darksciencebase', 'body': 'closing, will reopen if the problem persists with dremio out of the equation.', 'created_at': datetime.datetime(2024, 6, 14, 9, 10, 29, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-13 11:46:14 UTC): Please post:
1) full logs
2) diagnostic info
3) how you’re connecting to the app db

Geronimonetto (Issue Creator) on (2024-06-13 14:49:43 UTC): {
""browser-info"": {
""language"": ""pt-BR"",
""platform"": ""Win32"",
""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
(KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36"",
""vendor"": ""Google Inc.""
},
""system-info"": {
""file.encoding"": ""UTF-8"",
""java.runtime.name"": ""OpenJDK Runtime Environment"",
""java.runtime.version"": ""11.0.20.1+9-LTS"",
""java.vendor"": ""Amazon.com Inc."",
""java.vendor.url"": ""https://aws.amazon.com/corretto/"",
""java.version"": ""11.0.20.1"",
""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
""java.vm.version"": ""11.0.20.1+9-LTS"",
""os.name"": ""Linux"",
""os.version"": ""6.1.52-71.125.amzn2023.x86_64"",
""user.language"": ""en"",
""user.timezone"": ""UTC""
},
""metabase-info"": {
""databases"": [
""dremio""
],
""hosting-env"": ""unknown"",
""application-database"": ""postgres"",
""application-database-details"": {
""database"": {
""name"": ""PostgreSQL"",
""version"": ""15.4""
},
""jdbc-driver"": {
""name"": ""PostgreSQL JDBC Driver"",
""version"": ""42.7.3""
}
},
""run-mode"": ""prod"",
""version"": {
""date"": ""2024-06-13"",
""tag"": ""v0.50.3"",
""hash"": ""855535b""
},
""settings"": {
""report-timezone"": null
}
}
}

Em qui., 13 de jun. de 2024 às 08:46, Luis Paolini ***@***.***>
escreveu:

paoliniluis on (2024-06-13 16:12:47 UTC): So you can’t connect to a new Postgres database, is that correct?

Geronimonetto (Issue Creator) on (2024-06-13 16:33:34 UTC): Não estou conseguindo conectar com nenhum banco de dados na verdade


Em qui., 13 de jun. de 2024 às 13:13, Luis Paolini ***@***.***>
escreveu:

paoliniluis on (2024-06-13 16:57:05 UTC): ok so it's definitely the dremio driver, please remove it or downgrade

darksciencebase on (2024-06-14 09:10:29 UTC): closing, will reopen if the problem persists with dremio out of the equation.

"
2350386000,issue,closed,completed,Make lineage (Query Validator Tool) an EE-only feature,,tsmacdonald,2024-06-13 07:34:17+00:00,[],2024-08-06 14:16:01+00:00,2024-08-06 14:16:00+00:00,https://github.com/metabase/metabase/issues/44118,"[('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2265519248, 'issue_id': 2350386000, 'author': 'crisptrutski', 'body': '@tsmacdonald I believe this was resolved by https://github.com/metabase/metabase/pull/45137 - if not can you clarify what else is needed here?', 'created_at': datetime.datetime(2024, 8, 2, 14, 27, 37, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-08-02 14:27:37 UTC): @tsmacdonald I believe this was resolved by https://github.com/metabase/metabase/pull/45137 - if not can you clarify what else is needed here?

"
2350320502,issue,closed,completed,Automate ee-extra PR Creation,,iethree,2024-06-13 06:57:18+00:00,['iethree'],2024-06-17 13:04:16+00:00,2024-06-17 13:04:16+00:00,https://github.com/metabase/metabase/issues/44117,[],"[{'comment_id': 2173347069, 'issue_id': 2350320502, 'author': 'iethree', 'body': 'closed by https://github.com/metabase/metabase/pull/44138', 'created_at': datetime.datetime(2024, 6, 17, 13, 4, 16, tzinfo=datetime.timezone.utc)}]","iethree (Issue Creator) on (2024-06-17 13:04:16 UTC): closed by https://github.com/metabase/metabase/pull/44138

"
2350139295,issue,closed,completed,Revert use of CSS variables in SVGs in static viz due to Batik errors,"Color migration was breaking static viz because the Batik CSS engine (which handles SVGs) does not support CSS variables.

```
org.w3c.dom.DOMException: file:/fake.svg:
The attribute ""fill"" represents an invalid CSS value (""var(--mb-color-text-white)"").
Original message:
Unexpected token: 0 (see LexicalUnits).
	at org.apache.batik.css.engine.CSSEngine.getCascadedStyleMap(CSSEngine.java:775)
	at org.apache.batik.css.engine.CSSEngine.getComputedStyle(CSSEngine.java:867)
	at org.apache.batik.bridge.CSSUtilities.getComputedStyle(CSSUtilities.java:81)
	at org.apache.batik.bridge.CSSUtilities.convertDisplay(CSSUtilities.java:563)
	at org.apache.batik.bridge.GVTBuilder.buildGraphicsNode(GVTBuilder.java:206)
	at org.apache.batik.bridge.GVTBuilder.buildComposite(GVTBuilder.java:171)
	at org.apache.batik.bridge.GVTBuilder.buildGraphicsNode(GVTBuilder.java:219)
	at org.apache.batik.bridge.GVTBuilder.buildComposite(GVTBuilder.java:171)
	at org.apache.batik.bridge.GVTBuilder.buildGraphicsNode(GVTBuilder.java:219)
	at org.apache.batik.bridge.GVTBuilder.buildComposite(GVTBuilder.java:171)
	at org.apache.batik.bridge.GVTBuilder.build(GVTBuilder.java:82)
	at org.apache.batik.transcoder.SVGAbstractTranscoder.transcode(SVGAbstractTranscoder.java:210)
	at org.apache.batik.transcoder.image.ImageTranscoder.transcode(ImageTranscoder.java:92)
	at org.apache.batik.transcoder.XMLAbstractTranscoder.transcode(XMLAbstractTranscoder.java:142)
	at org.apache.batik.transcoder.SVGAbstractTranscoder.transcode(SVGAbstractTranscoder.java:158)
	at metabase.pulse.render.js_svg$render_svg.invokeStatic(js_svg.clj:117)
	at metabase.pulse.render.js_svg$render_svg.invoke(js_svg.clj:106)
	at metabase.pulse.render.js_svg$svg_string__GT_bytes.invokeStatic(js_svg.clj:123)
	at metabase.pulse.render.js_svg$svg_string__GT_bytes.invoke(js_svg.clj:120)
	at metabase.pulse.render.js_svg$progress.invokeStatic(js_svg.clj:177)
	at metabase.pulse.render.js_svg$progress.invoke(js_svg.clj:169)
	at metabase.pulse.render.body$eval91103$_AMPERSAND_f__91105.invoke(body.clj:449)
	at metabase.pulse.render.body$eval91103$fn__91108.invoke(body.clj:432)
```",heypoom,2024-06-13 04:47:01+00:00,['heypoom'],2024-10-08 17:07:43+00:00,2024-06-13 20:04:16+00:00,https://github.com/metabase/metabase/issues/44115,"[('Visualization/Static', 'Subscriptions/pulse generated image'), ('.Team/Embedding', '')]",[],
2350044338,issue,closed,completed,Command Palette docs url is wrong,"### Describe the bug

Query Param is wrong

### To Reproduce

Open the palette and enter a query.

### Expected behavior

Clicking the docs item should open the metabase docs with the query populated

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```


### Severity

p2

### Additional context

_No response_",npfitz,2024-06-13 03:06:58+00:00,['npfitz'],2024-06-14 08:24:33+00:00,2024-06-14 02:49:45+00:00,https://github.com/metabase/metabase/issues/44112,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Organization/', ''), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2349979640,issue,closed,completed,Add skeletons to Browse models,,rafpaf,2024-06-13 02:02:49+00:00,['rafpaf'],2024-10-08 17:07:40+00:00,2024-06-14 00:33:57+00:00,https://github.com/metabase/metabase/issues/44111,[],[],
2349901725,issue,open,,Lines order should define their z-index,"### Describe the bug

On multiseries line charts their order in settings should define their z-index. It worked like that in the previous dc.js implementation but now changing the order of line series works only the first time and all the subsequent changes won't be visible until the page refresh.

### To Reproduce

```sql
select 'foo' x, 10 y1, 20 y2, 30 y3
union all select 'bar', 30, 20, 15
union all select 'baz', 20, 10, 30
```

1. Create a line chart with the query above
2. Reorder series
3. Z-indices of series does not change

### Expected behavior

Z-indices of series should change

### Logs

_No response_

### Information about your Metabase installation

```JSON
>= v50
```

### Severity

Blocking users according to https://github.com/metabase/metabase/issues/43998

### Additional context

_No response_",alxnddr,2024-06-13 00:38:58+00:00,['alxnddr'],2025-02-04 20:31:24+00:00,,https://github.com/metabase/metabase/issues/44110,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Reproduced', 'Issues reproduced in test (usually Cypress)'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2349891589,issue,closed,completed,"Support CLOB types (again), or at least don't provide errors on the update-field-values step","### Describe the bug

For some reason it seems that CLOBs are a problem in Oracle: logs say that we're having problems with those.

### To Reproduce

1) run
```
create table table2 (

    number_col NUMBER,

    clob_col   CLOB

);

insert into table2 values ( 1, TO_CLOB('...looong text in clob 1....'));

insert into table2 values ( 2, TO_CLOB('...looong text in clob 2....'));

insert into table2 values ( 3, TO_CLOB('...looong text in clob 3....'));

insert into table2 values (11, TO_CLOB('...looong text in clob 11....'));

insert into table2 values (12, TO_CLOB('...looong text in clob 12....'));

insert into table2 values (13, TO_CLOB('...looong text in clob 13....'));

insert into table2 values (14, TO_CLOB('...looong text in clob 14....'));



commit;
```
2) add the db and sync
3) see the error

### Expected behavior

We shouldn't generate any errors with CLOB types, we supposedly support those since v32 (https://github.com/metabase/metabase/issues/9026 and https://github.com/metabase/metabase/pull/9309)

### Logs

```
2024-06-13 00:07:28,094 INFO sync.util :: STARTING: step ''update-field-values'' for oracle Database 3 ''oracle-18''
2024-06-13 00:07:28,125 ERROR models.field-values :: Error fetching field values
clojure.lang.ExceptionInfo: Error executing query: ORA-00932: inconsistent datatypes: expected - got CLOB
 {:driver :oracle, :sql [""-- Metabase"" ""SELECT"" ""  *"" ""FROM"" ""  ("" ""    SELECT"" ""      \""METABASE\"".\""TABLE2\"".\""CLOB_COL\"" \""CLOB_COL\"""" ""    FROM"" ""      \""METABASE\"".\""TABLE2\"""" ""    GROUP BY"" ""      \""METABASE\"".\""TABLE2\"".\""CLOB_COL\"""" ""    ORDER BY"" ""      \""METABASE\"".\""TABLE2\"".\""CLOB_COL\"" ASC"" ""  )"" ""WHERE"" ""  rownum <= 1000""], :params nil, :type :invalid-query}
	at metabase.driver.sql_jdbc.execute$execute_reducible_query$fn__81066$fn__81067.invoke(execute.clj:716)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query$fn__81066.invoke(execute.clj:713)
	at metabase.driver.sql_jdbc.execute$fn__80859$fn__80860.invoke(execute.clj:397)
	at metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:337)
	at metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:320)
	at metabase.driver.sql_jdbc.execute$fn__80859.invokeStatic(execute.clj:391)
	at metabase.driver.sql_jdbc.execute$fn__80859.invoke(execute.clj:389)
	at clojure.lang.MultiFn.invoke(MultiFn.java:244)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:707)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:693)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:704)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:693)
	at metabase.driver.sql_jdbc$fn__114623.invokeStatic(sql_jdbc.clj:78)
	at metabase.driver.sql_jdbc$fn__114623.invoke(sql_jdbc.clj:76)
	at metabase.driver.oracle$fn__124272.invokeStatic(oracle.clj:506)
	at metabase.driver.oracle$fn__124272.invoke(oracle.clj:504)
	at clojure.lang.MultiFn.invoke(MultiFn.java:244)
	at metabase.query_processor.pipeline$_STAR_execute_STAR_.invokeStatic(pipeline.clj:47)
	at metabase.query_processor.pipeline$_STAR_execute_STAR_.invoke(pipeline.clj:34)
	at metabase.query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:88)
	at metabase.query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:81)
	at metabase.query_processor.execute$run.invokeStatic(execute.clj:60)
	at metabase.query_processor.execute$run.invoke(execute.clj:54)
	at metabase.query_processor.middleware.update_used_cards$update_used_cards_BANG_$fn__69565.invoke(update_used_cards.clj:40)
	at metabase.query_processor.execute$add_native_form_to_result_metadata$fn__69574.invoke(execute.clj:23)
	at metabase.query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__69579.invoke(execute.clj:34)
	at metabase.query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___69551.invoke(cache.clj:242)
	at metabase.query_processor.middleware.permissions$check_query_permissions$fn__63710.invoke(permissions.clj:118)
	at metabase.query_processor.middleware.enterprise$check_download_permissions_middleware$fn__64286.invoke(enterprise.clj:51)
	at metabase.query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__64296.invoke(enterprise.clj:64)
	at metabase.query_processor.execute$execute$fn__69606.invoke(execute.clj:92)
	at metabase.query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:225)
	at metabase.query_processor.setup$do_with_qp_setup.invoke(setup.clj:216)
	at metabase.query_processor.execute$execute.invokeStatic(execute.clj:91)
	at metabase.query_processor.execute$execute.invoke(execute.clj:87)
	at metabase.query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:47)
	at metabase.query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:43)
	at metabase.query_processor.middleware.enterprise$fn__64313$handle_audit_app_internal_queries__64314$fn__64316.invoke(enterprise.clj:96)
	at metabase.query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__64324.invoke(enterprise.clj:103)
	at metabase.query_processor.middleware.process_userland_query$process_userland_query_middleware$fn__75424.invoke(process_userland_query.clj:169)
	at metabase.query_processor.middleware.catch_exceptions$catch_exceptions$fn__75493.invoke(catch_exceptions.clj:121)
	at metabase.query_processor$process_query$fn__75530.invoke(query_processor.clj:78)
	at metabase.query_processor.setup$do_with_canceled_chan$fn__64728.invoke(setup.clj:189)
	at metabase.query_processor.setup$do_with_database_local_settings$fn__64723.invoke(setup.clj:181)
	at metabase.query_processor.setup$do_with_driver$fn__64718$fn__64719.invoke(setup.clj:166)
	at metabase.driver$do_with_driver.invokeStatic(driver.clj:104)
	at metabase.driver$do_with_driver.invoke(driver.clj:99)
	at metabase.query_processor.setup$do_with_driver$fn__64718.invoke(setup.clj:165)
	at metabase.query_processor.setup$do_with_metadata_provider$fn__64711$fn__64714.invoke(setup.clj:151)
	at metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:171)
	at metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:151)
	at metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:160)
	at metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:151)
	at metabase.query_processor.setup$do_with_metadata_provider$fn__64711.invoke(setup.clj:150)
	at metabase.query_processor.setup$do_with_resolved_database$fn__64705.invoke(setup.clj:128)
	at metabase.query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:232)
	at metabase.query_processor.setup$do_with_qp_setup.invoke(setup.clj:216)
	at metabase.query_processor$process_query.invokeStatic(query_processor.clj:76)
	at metabase.query_processor$process_query.invoke(query_processor.clj:69)
	at metabase.query_processor$process_query.invokeStatic(query_processor.clj:72)
	at metabase.query_processor$process_query.invoke(query_processor.clj:69)
	at metabase.db.metadata_queries$qp_query$fn__75540.invoke(metadata_queries.clj:22)
	at metabase.db.metadata_queries$qp_query.invokeStatic(metadata_queries.clj:21)
	at metabase.db.metadata_queries$qp_query.invoke(metadata_queries.clj:18)
	at metabase.db.metadata_queries$field_query.invokeStatic(metadata_queries.clj:79)
	at metabase.db.metadata_queries$field_query.invoke(metadata_queries.clj:75)
	at metabase.db.metadata_queries$field_distinct_values.invokeStatic(metadata_queries.clj:109)
	at metabase.db.metadata_queries$field_distinct_values.invoke(metadata_queries.clj:102)
	at metabase.db.metadata_queries$field_distinct_values.invokeStatic(metadata_queries.clj:106)
	at metabase.db.metadata_queries$field_distinct_values.invoke(metadata_queries.clj:102)
	at metabase.models.field_values$distinct_values.invokeStatic(field_values.clj:349)
	at metabase.models.field_values$distinct_values.invoke(field_values.clj:335)
	at metabase.models.field_values$create_or_update_full_field_values_BANG_.invokeStatic(field_values.clj:401)
	at metabase.models.field_values$create_or_update_full_field_values_BANG_.doInvoke(field_values.clj:392)
	at clojure.lang.RestFn.invoke(RestFn.java:410)
	at metabase.sync.field_values$update_field_values_for_field_BANG_.invokeStatic(field_values.clj:32)
	at metabase.sync.field_values$update_field_values_for_field_BANG_.invoke(field_values.clj:25)
	at metabase.sync.field_values$update_field_values_for_table_BANG_$fn__84778$fn__84779.invoke(field_values.clj:57)
	at metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:188)
	at metabase.sync.util$do_with_error_handling.invoke(util.clj:181)
	at metabase.sync.field_values$update_field_values_for_table_BANG_$fn__84778.invoke(field_values.clj:55)
	at clojure.lang.PersistentVector.reduce(PersistentVector.java:343)
	at clojure.core$reduce.invokeStatic(core.clj:6886)
	at clojure.core$reduce.invoke(core.clj:6869)
	at metabase.sync.field_values$update_field_values_for_table_BANG_.invokeStatic(field_values.clj:54)
	at metabase.sync.field_values$update_field_values_for_table_BANG_.invoke(field_values.clj:51)
	at clojure.core$map$fn__5935.invoke(core.clj:2770)
	at clojure.lang.LazySeq.sval(LazySeq.java:42)
	at clojure.lang.LazySeq.seq(LazySeq.java:51)
	at clojure.lang.Cons.next(Cons.java:39)
	at clojure.lang.RT.boundedLength(RT.java:1790)
	at clojure.lang.RestFn.applyTo(RestFn.java:130)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.sync.field_values$update_field_values_for_database_BANG_.invokeStatic(field_values.clj:66)
	at metabase.sync.field_values$update_field_values_for_database_BANG_.invoke(field_values.clj:63)
	at metabase.sync.field_values$make_sync_field_values_steps$fn__84801.invoke(field_values.clj:115)
	at clojure.lang.AFn.applyToHelper(AFn.java:154)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.sync.util$run_step_with_metadata$fn__57395$fn__57398.invoke(util.clj:470)
	at metabase.models.task_history$do_with_task_history.invokeStatic(task_history.clj:116)
	at metabase.models.task_history$do_with_task_history.invoke(task_history.clj:105)
	at metabase.sync.util$run_step_with_metadata$fn__57395.doInvoke(util.clj:464)
	at clojure.lang.RestFn.invoke(RestFn.java:397)
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:129)
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:123)
	at metabase.sync.util$with_start_and_finish_debug_logging.invokeStatic(util.clj:147)
	at metabase.sync.util$with_start_and_finish_debug_logging.invoke(util.clj:143)
	at metabase.sync.util$run_step_with_metadata.invokeStatic(util.clj:459)
	at metabase.sync.util$run_step_with_metadata.invoke(util.clj:454)
	at metabase.sync.util$run_sync_operation$fn__57437$fn__57445.invoke(util.clj:543)
	at metabase.sync.util$run_sync_operation$fn__57437.invoke(util.clj:541)
	at metabase.models.task_history$do_with_task_history.invokeStatic(task_history.clj:116)
	at metabase.models.task_history$do_with_task_history.invoke(task_history.clj:105)
	at metabase.sync.util$run_sync_operation.invokeStatic(util.clj:538)
	at metabase.sync.util$run_sync_operation.invoke(util.clj:533)
	at metabase.sync.field_values$update_field_values_BANG_$fn__84804.invoke(field_values.clj:125)
	at metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:188)
	at metabase.sync.util$do_with_error_handling.invoke(util.clj:181)
	at clojure.core$partial$fn__5910.invoke(core.clj:2647)
	at metabase.driver$fn__55248.invokeStatic(driver.clj:801)
	at metabase.driver$fn__55248.invoke(driver.clj:801)
	at clojure.lang.MultiFn.invoke(MultiFn.java:239)
	at metabase.sync.util$sync_in_context$fn__57307.invoke(util.clj:164)
	at metabase.sync.util$with_db_logging_disabled$fn__57304.invoke(util.clj:156)
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:129)
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:123)
	at metabase.sync.util$with_start_and_finish_logging$fn__57291.invoke(util.clj:141)
	at metabase.sync.util$with_sync_events$fn__57286.invoke(util.clj:115)
	at metabase.sync.util$with_duplicate_ops_prevented$fn__57273.invoke(util.clj:87)
	at metabase.sync.util$do_sync_operation.invokeStatic(util.clj:213)
	at metabase.sync.util$do_sync_operation.invoke(util.clj:207)
	at metabase.sync.field_values$update_field_values_BANG_.invokeStatic(field_values.clj:122)
	at metabase.sync.field_values$update_field_values_BANG_.invoke(field_values.clj:118)
	at metabase.sync$sync_database_BANG_$fn__85091.invoke(sync.clj:55)
	at metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:188)
	at metabase.sync.util$do_with_error_handling.invoke(util.clj:181)
	at clojure.core$partial$fn__5910.invoke(core.clj:2647)
	at metabase.driver$fn__55248.invokeStatic(driver.clj:801)
	at metabase.driver$fn__55248.invoke(driver.clj:801)
	at clojure.lang.MultiFn.invoke(MultiFn.java:239)
	at metabase.sync.util$sync_in_context$fn__57307.invoke(util.clj:164)
	at metabase.sync.util$with_db_logging_disabled$fn__57304.invoke(util.clj:156)
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:129)
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:123)
	at metabase.sync.util$with_start_and_finish_logging$fn__57291.invoke(util.clj:141)
	at metabase.sync.util$with_sync_events$fn__57286.invoke(util.clj:115)
	at metabase.sync.util$with_duplicate_ops_prevented$fn__57273.invoke(util.clj:87)
	at metabase.sync.util$do_sync_operation.invokeStatic(util.clj:213)
	at metabase.sync.util$do_sync_operation.invoke(util.clj:207)
	at metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:51)
	at metabase.sync$sync_database_BANG_.invoke(sync.clj:37)
	at metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:46)
	at metabase.sync$sync_database_BANG_.invoke(sync.clj:37)
	at metabase.events.sync_database$publish_event_BANG__primary_method_metabase_events_sync_database_event$fn__112428.invoke(sync_database.clj:23)
	at clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047)
	at clojure.lang.AFn.call(AFn.java:18)
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.sql.SQLSyntaxErrorException: ORA-00932: inconsistent datatypes: expected - got CLOB

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:509)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:461)
	at oracle.jdbc.driver.T4C8Oall.processError(T4C8Oall.java:1104)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:550)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:268)
	at oracle.jdbc.driver.T4C8Oall.doOALL(T4C8Oall.java:655)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:229)
	at oracle.jdbc.driver.T4CStatement.doOall8(T4CStatement.java:41)
	at oracle.jdbc.driver.T4CStatement.executeForDescribe(T4CStatement.java:765)
	at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:983)
	at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1168)
	at oracle.jdbc.driver.OracleStatement.executeInternal(OracleStatement.java:1823)
	at oracle.jdbc.driver.OracleStatement.execute(OracleStatement.java:1778)
	at oracle.jdbc.driver.OracleStatementWrapper.execute(OracleStatementWrapper.java:303)
	at com.mchange.v2.c3p0.impl.NewProxyStatement.execute(NewProxyStatement.java:75)
	at metabase.driver.sql_jdbc.execute$fn__80985.invokeStatic(execute.clj:569)
	at metabase.driver.sql_jdbc.execute$fn__80985.invoke(execute.clj:567)
	at clojure.lang.MultiFn.invoke(MultiFn.java:239)
	at metabase.driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invokeStatic(execute.clj:577)
	at metabase.driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invoke(execute.clj:574)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query$fn__81066$fn__81067.invoke(execute.clj:714)
	... 162 more
Caused by: Error : 932, Position : 110, Sql = -- Metabase
SELECT * FROM (SELECT ""METABASE"".""TABLE2"".""CLOB_COL"" ""CLOB_COL"" FROM ""METABASE"".""TABLE2"" GROUP BY ""METABASE"".""TABLE2"".""CLOB_COL"" ORDER BY ""METABASE"".""TABLE2"".""CLOB_COL"" ASC) WHERE rownum <= 1000, OriginalSql = -- Metabase
SELECT * FROM (SELECT ""METABASE"".""TABLE2"".""CLOB_COL"" ""CLOB_COL"" FROM ""METABASE"".""TABLE2"" GROUP BY ""METABASE"".""TABLE2"".""CLOB_COL"" ORDER BY ""METABASE"".""TABLE2"".""CLOB_COL"" ASC) WHERE rownum <= 1000, Error Msg = ORA-00932: inconsistent datatypes: expected - got CLOB

	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:513)
	... 182 more

```

### Information about your Metabase installation

```JSON
using metabase v1.50.2 and oracle 18 from gvenzl/oracle-xe:18-slim
```


### Severity

P2

### Additional context

You can still do operations on the fields, which seems that we're coercing to a text type?",paoliniluis,2024-06-13 00:28:11+00:00,['calherries'],2024-12-24 11:37:59+00:00,2024-07-23 21:19:32+00:00,https://github.com/metabase/metabase/issues/44109,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Administration/Metadata & Sync', ''), ('Database/Oracle', None), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2187763182, 'issue_id': 2349891589, 'author': 'calherries', 'body': ""@cbalusek I'm removing the regression label because I can't see any evidence storing field values for CLOB types ever worked. Let me know if you have evidence otherwise and I'll add it back"", 'created_at': datetime.datetime(2024, 6, 25, 1, 42, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2187816331, 'issue_id': 2349891589, 'author': 'calherries', 'body': ""Also de-escalating this to a P3 because I don't think we want to support getting field values for CLOB types anyway, so this bug is really just a distracting error message. Similar to https://github.com/metabase/metabase/pull/43563, we want to skip fingerprinting and getting field values for any column that may contain values in the gigabytes and is likely to store values that are unhelpful for features built on field values and fingerprints."", 'created_at': datetime.datetime(2024, 6, 25, 2, 11, 2, tzinfo=datetime.timezone.utc)}]","calherries (Assginee) on (2024-06-25 01:42:32 UTC): @cbalusek I'm removing the regression label because I can't see any evidence storing field values for CLOB types ever worked. Let me know if you have evidence otherwise and I'll add it back

calherries (Assginee) on (2024-06-25 02:11:02 UTC): Also de-escalating this to a P3 because I don't think we want to support getting field values for CLOB types anyway, so this bug is really just a distracting error message. Similar to https://github.com/metabase/metabase/pull/43563, we want to skip fingerprinting and getting field values for any column that may contain values in the gigabytes and is likely to store values that are unhelpful for features built on field values and fingerprints.

"
2349839555,issue,open,,"Re-scan this field button appear (and works) if field is set to ""plain input box""","### Describe the bug

It doesn't make sense to make the button appear and/or work if the field will always appear as an input box

### To Reproduce

1) go to any field in table metadata, set it to a plain input box
2) click on the ""re-scan this field"" button
3) see Metabase firing the query to the DB

### Expected behavior

We should hide the button completely

### Logs

NA

### Information about your Metabase installation

```JSON
it has always been like that
```


### Severity

P3

### Additional context

NA",paoliniluis,2024-06-12 23:29:32+00:00,[],2025-02-04 20:24:42+00:00,,https://github.com/metabase/metabase/issues/44108,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Administration/Metadata & Sync', ''), ('Administration/Table Metadata', ''), ('.Frontend', ''), ('.Product Input Needed', ''), ('.Team/Querying', '')]","[{'comment_id': 2596812983, 'issue_id': 2349839555, 'author': 'ranquild', 'body': 'I think hiding the button could bring even more confusion. It works correctly but the values are not used in most cases because of the other setting.', 'created_at': datetime.datetime(2025, 1, 16, 20, 17, 44, tzinfo=datetime.timezone.utc)}]","ranquild on (2025-01-16 20:17:44 UTC): I think hiding the button could bring even more confusion. It works correctly but the values are not used in most cases because of the other setting.

"
2349813661,issue,closed,completed,Click behavior to a second tab will generate additional history events on the browser,"### Describe the bug

When you send the user to a second tab via a click behavior then the browser history contains an additional event so you can't use the browser back button to go back to the previous dashboard

### To Reproduce

1) create a question
2) create 2 dashboards, on one, create 2 tabs
3) add a question to the one that has only 1 tab and modify the click behaviour of the question to go to the dashboard with 2 tabs so it goes to the second tab
4) now click the link and it should take you to the second tab
5) now click on the back button, it will take you nowhere... when it should take you to the previous dashboard

### Expected behavior

It should take you to the dashboard that you used to go to the second dashboard, but it didn't, since it generated an additional event on the browser history

### Logs

NA

### Information about your Metabase installation

```JSON
v49.x
```


### Severity

P2

### Additional context

NA",paoliniluis,2024-06-12 23:02:59+00:00,['kulyk'],2024-07-18 10:33:24+00:00,2024-07-18 10:30:59+00:00,https://github.com/metabase/metabase/issues/44106,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('Reporting/Dashboards/Click Behavior', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2221349341, 'issue_id': 2349813661, 'author': 'paoliniluis', 'body': ""Sending this to a P1 since you get really angry when this doesn't work"", 'created_at': datetime.datetime(2024, 7, 10, 20, 12, tzinfo=datetime.timezone.utc)}]","paoliniluis (Issue Creator) on (2024-07-10 20:12:00 UTC): Sending this to a P1 since you get really angry when this doesn't work

"
2349810159,issue,closed,completed,Grouping by Description Semantic Type Breaks Pivot Table,"### Describe the bug

In the query builder if you take an aggregate and group it by multiple fields, one of which has a semantic type of ""Description"" - the description typed field gets stuck as a measure in the Pivot viz settings.

### To Reproduce

1. In the ""Products"" table change ""Vendor"" to a semantic type of ""Description""
2. Create a question that takes a count (or another aggregate) grouped by ""Vendor"" and another field
3. Switch the viz to a pivot type
4. Look in visualization settings and see the ""Vendor"" field is there but it's stuck in the ""Measure"" section

Note: If you make a pivot using non description fields and then add this in with an edit it works fine.


### Expected behavior

The description field should be a dimension 

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.133.1-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""athena"",
      ""h2"",
      ""postgres"",
      ""snowflake""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.22 (Debian 11.22-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-28"",
      ""tag"": ""v1.49.13"",
      ""hash"": ""de28e83""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Annoying

### Additional context

_No response_",ixipixi,2024-06-12 22:59:04+00:00,[],2024-08-07 13:08:47+00:00,2024-08-07 13:08:47+00:00,https://github.com/metabase/metabase/issues/44105,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2272140349, 'issue_id': 2349810159, 'author': 'cdeweyx', 'body': ""Having trouble repro'ing this [here](https://stats.metabase.com/question#eyJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoxLCJ0eXBlIjoicXVlcnkiLCJxdWVyeSI6eyJzb3VyY2UtdGFibGUiOjMsImFnZ3JlZ2F0aW9uIjpbWyJjb3VudCJdLFsiYXZnIixbImZpZWxkIiwyNCx7ImJhc2UtdHlwZSI6InR5cGUvRmxvYXQifV1dXSwiYnJlYWtvdXQiOltbImZpZWxkIiwyOSx7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWUiLCJ0ZW1wb3JhbC11bml0IjoibW9udGgifV0sWyJmaWVsZCIsMjAseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV1dfX0sImRpc3BsYXkiOiJwaXZvdCIsImRpc3BsYXlJc0xvY2tlZCI6dHJ1ZSwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6eyJwaXZvdF90YWJsZS5jb2x1bW5fc3BsaXQiOnsicm93cyI6W1siZmllbGQiLDIwLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dXSwiY29sdW1ucyI6W1siZmllbGQiLDI5LHsiYmFzZS10eXBlIjoidHlwZS9EYXRlVGltZSIsInRlbXBvcmFsLXVuaXQiOiJtb250aCJ9XV0sInZhbHVlcyI6W1siYWdncmVnYXRpb24iLDBdLFsiYWdncmVnYXRpb24iLDFdXX0sInBpdm90X3RhYmxlLmNvbHVtbl93aWR0aHMiOnsibGVmdEhlYWRlcldpZHRocyI6WzE4N10sInRvdGFsTGVmdEhlYWRlcldpZHRocyI6MTg3LCJ2YWx1ZUhlYWRlcldpZHRocyI6e319fSwidHlwZSI6InF1ZXN0aW9uIn0=), tried private browser and other tips outlined in [the ticket](https://metabase.zendesk.com/agent/tickets/27818)."", 'created_at': datetime.datetime(2024, 8, 6, 20, 57, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2272240972, 'issue_id': 2349810159, 'author': 'ixipixi', 'body': ""@cdeweyx I have a local copy of 50.18 running so I checked there. This doesn't occur in 50.18 (still happens in 49.21). So I imagine this was fixed at some point in 50 by proxy of another bug fix."", 'created_at': datetime.datetime(2024, 8, 6, 22, 14, 55, tzinfo=datetime.timezone.utc)}]","cdeweyx on (2024-08-06 20:57:53 UTC): Having trouble repro'ing this [here](https://stats.metabase.com/question#eyJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoxLCJ0eXBlIjoicXVlcnkiLCJxdWVyeSI6eyJzb3VyY2UtdGFibGUiOjMsImFnZ3JlZ2F0aW9uIjpbWyJjb3VudCJdLFsiYXZnIixbImZpZWxkIiwyNCx7ImJhc2UtdHlwZSI6InR5cGUvRmxvYXQifV1dXSwiYnJlYWtvdXQiOltbImZpZWxkIiwyOSx7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWUiLCJ0ZW1wb3JhbC11bml0IjoibW9udGgifV0sWyJmaWVsZCIsMjAseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV1dfX0sImRpc3BsYXkiOiJwaXZvdCIsImRpc3BsYXlJc0xvY2tlZCI6dHJ1ZSwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6eyJwaXZvdF90YWJsZS5jb2x1bW5fc3BsaXQiOnsicm93cyI6W1siZmllbGQiLDIwLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dXSwiY29sdW1ucyI6W1siZmllbGQiLDI5LHsiYmFzZS10eXBlIjoidHlwZS9EYXRlVGltZSIsInRlbXBvcmFsLXVuaXQiOiJtb250aCJ9XV0sInZhbHVlcyI6W1siYWdncmVnYXRpb24iLDBdLFsiYWdncmVnYXRpb24iLDFdXX0sInBpdm90X3RhYmxlLmNvbHVtbl93aWR0aHMiOnsibGVmdEhlYWRlcldpZHRocyI6WzE4N10sInRvdGFsTGVmdEhlYWRlcldpZHRocyI6MTg3LCJ2YWx1ZUhlYWRlcldpZHRocyI6e319fSwidHlwZSI6InF1ZXN0aW9uIn0=), tried private browser and other tips outlined in [the ticket](https://metabase.zendesk.com/agent/tickets/27818).

ixipixi (Issue Creator) on (2024-08-06 22:14:55 UTC): @cdeweyx I have a local copy of 50.18 running so I checked there. This doesn't occur in 50.18 (still happens in 49.21). So I imagine this was fixed at some point in 50 by proxy of another bug fix.

"
2349792452,issue,closed,not_planned,Click behavior to a tab no longer works,"### Describe the bug

Create a dashboard with 2 tabs and then from another dashboard direct the click to the second tab. It will always go to the first tab

### To Reproduce

1) Create a question and then a dashboard with 2 tabs
2) create another dashboard and add the question
3) Alter the click behaviour of the question and send the click to the second tab of the first dashboard
4) click the link

see that it's taking you to the first tab of the dashboard

### Expected behavior

We should take the user to the 2nd tab

### Logs

NA

### Information about your Metabase installation

```JSON
v50
```


### Severity

P1

### Additional context

_No response_",paoliniluis,2024-06-12 22:42:04+00:00,['kulyk'],2024-06-14 17:33:59+00:00,2024-06-14 17:33:58+00:00,https://github.com/metabase/metabase/issues/44104,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Dashboards', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('Reporting/Dashboards/Click Behavior', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2165739117, 'issue_id': 2349792452, 'author': 'perivamsi', 'body': '@paoliniluis please add a link to stats whenever possible. that way we can cut down on the back and forth of ""I can\'t repro this"".', 'created_at': datetime.datetime(2024, 6, 13, 13, 51, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168441953, 'issue_id': 2349792452, 'author': 'cdeweyx', 'body': 'Dupe of https://github.com/metabase/metabase/issues/34447', 'created_at': datetime.datetime(2024, 6, 14, 17, 8, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168475050, 'issue_id': 2349792452, 'author': 'paoliniluis', 'body': ""amazing that I did the first one as well and I didn't remember it"", 'created_at': datetime.datetime(2024, 6, 14, 17, 33, 59, tzinfo=datetime.timezone.utc)}]","perivamsi on (2024-06-13 13:51:29 UTC): @paoliniluis please add a link to stats whenever possible. that way we can cut down on the back and forth of ""I can't repro this"".

cdeweyx on (2024-06-14 17:08:55 UTC): Dupe of https://github.com/metabase/metabase/issues/34447

paoliniluis (Issue Creator) on (2024-06-14 17:33:59 UTC): amazing that I did the first one as well and I didn't remember it

"
2349754929,issue,closed,completed,Rename date/time empty filter options in the simple mode,"[Product doc](https://www.notion.so/metabase/Elevate-include-this-period-in-time-filter-b828dcca50b7491c9f1719d2bf6c60a0?pvs=4)

### The Task
When we click on an empty cell in the date/time column in simple mode, the quick filter options displayed are:
- On
- Not on

These should be renamed to
- Is empty
- Not empty",nemanjaglumac,2024-06-12 22:04:15+00:00,['nemanjaglumac'],2024-06-19 08:35:23+00:00,2024-06-19 08:35:22+00:00,https://github.com/metabase/metabase/issues/44101,"[('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2349710906,issue,closed,completed,"Remove ""is/not empty"" filter options from time-series chrome","[Product doc](https://www.notion.so/metabase/Elevate-include-this-period-in-time-filter-b828dcca50b7491c9f1719d2bf6c60a0?pvs=4)

### The task
The product team doesn't find ""is empty"" and ""not empty"" date/time filter options useful within the context of the time-series chrome (the bottom of the screen in some charts). They should be removed.

![image](https://github.com/metabase/metabase/assets/31325167/12019e79-36c3-47cd-96a8-6b4564c1b429)
",nemanjaglumac,2024-06-12 21:28:14+00:00,['nemanjaglumac'],2024-06-14 09:01:00+00:00,2024-06-14 09:00:59+00:00,https://github.com/metabase/metabase/issues/44098,"[('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Querying', '')]",[],
2349694930,issue,closed,completed,[Epic] Elevate “include this period” in time filters,"**Links**
- [Product doc](https://www.notion.so/metabase/Elevate-include-this-period-in-time-filter-b828dcca50b7491c9f1719d2bf6c60a0?pvs=4)
- Eng doc - TDB
- Feature branch:  `qc-proj-elevate-include-this-period`
- [Figma](https://www.figma.com/design/ofKULr1X7TQf5MZCkbJZvx/Elevate-%E2%80%9Cinclude-this-period%E2%80%9D-in-time-filter?node-id=1-286&t=vXLIPw5F50pJoQyr-0)
- Testing plan: #44323

# Implementation Plan
This should be fairly self-contained epic that most likely doesn't need more than one milestone. It has three distinct places in the UI that need to be updated. Maybe it makes sense to merge them all together to `master`, or maybe they are distinct enough which allows merging them individually. I'll know this when I dig into the code.

## Milestone 1
Update and re-work the existing frontend/src/metabase/querying/components/DatePicker/RelativeDatePicker/DateIntervalPicker/DateIntervalPicker.tsx component.
```[tasklist]
- [x] Add the new option to the filter in the notebook mode (#44179)
- [x] Add the new option to the filter modal in the simple mode (#44179)
- [x] Add the new option to the filter in the drill-through context menu (simple mode) (#44179)
- [x] Elevate the ""Starting from "" icon/action (#44242)
- [x] Merge milestone 1 to `master` (#44279)
```

## Milestone 2
Time-series chrome component.
Implementing this will resolve #42220

```[tasklist]
- [x] Add the new option to the time-series chrome in the charts/data visualizations (#44247)
- [x] Cover new changes with more tests (#44247)
```

## Milestone 3
Milestone 1 and Milestone 2 follow-ups.
> [!Note]
> I propose we merge the Milestone 1 and 2 to `master` to give product and design teams a few days to feel the new changes before we start polishing them.
```[tasklist]
- [x] Update copy (Past -> Previous) ([Slack context](https://metaboat.slack.com/archives/C02H619CJ8K/p1718358798489699)) (#44299)
- [x] Tweak the design (#44554)
```

### Additional Notes
The related issue/feature request: https://github.com/metabase/metabase/issues/42220
",nemanjaglumac,2024-06-12 21:16:32+00:00,['nemanjaglumac'],2024-06-27 10:18:01+00:00,2024-06-24 14:18:23+00:00,https://github.com/metabase/metabase/issues/44096,"[('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('.Epic', 'Feature Implementation or Project'), ('.Team/Querying', '')]",[],
2349624105,issue,closed,not_planned,where is model cache and cache scheduler? ,"### Describe the bug

after upgrading to v0.50.0 and v0.50.1 the caching tab doesn't exist anymore under settings
![image](https://github.com/metabase/metabase/assets/145304304/5d2b2f31-42b6-4e4c-9861-6a8109a51505)

also Model persistence doesn't exist also
![image](https://github.com/metabase/metabase/assets/145304304/df593f96-55aa-459d-b430-7fa184cd48ee)
![image](https://github.com/metabase/metabase/assets/145304304/41159fc5-5e28-489c-a5e8-e1b5d5e052df)

and nothing under performance tab like the [documentation](https://www.metabase.com/docs/latest/data-modeling/model-persistence#turn-on-model-persistence-for-your-metabase) says
![image](https://github.com/metabase/metabase/assets/145304304/be4edb3f-bb8e-423e-b3af-2937b4c1b9bf)

and I can't rollback to v0.49.15 also, so what should i do now, all our models are dependent on this feature. 

### To Reproduce

Go to settings - admin settings and you will find no cache setting for model.
Also go to performance and you will not find Model persistence

### Expected behavior

this setting should exist
![image](https://github.com/metabase/metabase/assets/145304304/9b91c4b1-69c3-4f21-9557-47082daa60ca)


### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.146.1-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres"",
      ""mysql""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.3 (Debian 16.3-1.pgdg120+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-12"",
      ""tag"": ""v0.50.1"",
      ""hash"": ""cc4ca82""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Extremely Severe and annoying, all our models are dependent on this feature

### Additional context

_No response_",mohamed-montaser91,2024-06-12 20:27:00+00:00,[],2024-06-13 07:26:38+00:00,2024-06-13 07:26:38+00:00,https://github.com/metabase/metabase/issues/44094,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2164815096, 'issue_id': 2349624105, 'author': 'paoliniluis', 'body': 'Move to 50.2', 'created_at': datetime.datetime(2024, 6, 13, 7, 26, 38, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-13 07:26:38 UTC): Move to 50.2

"
2349601712,issue,closed,completed,Cannot access snippets if you don't have view permissions to Our Analytics,"### Describe the bug

After migrating to v50, if you do not have at least view access to Our Analytics, then you are shown an error in the snippets sidebar when opening

### To Reproduce

1. Create some snippets
2. log in as a user without access to our analytics
3. New -> SQL Query -> Open the snippets sidebar


### Expected behavior

The Sidebar should open and you should have access to snippets. What's happening here is `GET /api/collection/id` we no longer support adding query params, so the `namespace=snippets` is being dropped.

### Logs

_No response_

### Information about your Metabase installation

```JSON
v50
```


### Severity

p2

### Additional context

_No response_",npfitz,2024-06-12 20:11:45+00:00,['npfitz'],2024-10-10 00:46:14+00:00,2024-06-13 22:01:59+00:00,https://github.com/metabase/metabase/issues/44092,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Administration/Permissions', 'Collection or Data permissions'), ('.Frontend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Escalation', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2349554101,issue,open,,Longer filter values overrun the screen when a single value is selected,"**Is your feature request related to a problem? Please describe.**
In the case you have a field with a longer than usual amount of characters, and have disabled filters from automatically being applied, the filter value will overrun the screen and make the Apply filter button inaccessible. 

<img width=""1419"" alt=""1"" src=""https://github.com/metabase/metabase/assets/17398657/8a7b1d91-c22b-4d56-be37-eddc9230ce82"">

<br>

<img width=""1266"" alt=""2"" src=""https://github.com/metabase/metabase/assets/17398657/b804f697-ba36-4751-8f2f-91116260210b"">

<br>
<br>

Until you select at least a second value for the filter.

<img width=""1073"" alt=""3"" src=""https://github.com/metabase/metabase/assets/17398657/d9e45e59-e0e4-4376-9eab-98ccc7fccd6b"">

<br>
<br>

**Describe the solution you'd like**
An option to abbreviate these types of field values or make the Apply button viewable when a single value for the filter is selected.

**Describe alternatives you've considered**
Referencing another field that is joined to this column to make it viewable under these circumstances.



",FilmonK,2024-06-12 19:41:27+00:00,[],2025-02-04 20:29:06+00:00,,https://github.com/metabase/metabase/issues/44090,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Dashboards', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('.Team/Querying', '')]","[{'comment_id': 2229456256, 'issue_id': 2349554101, 'author': 'nemanjaglumac', 'body': ""Almost a duplicate of https://github.com/metabase/metabase/issues/44435, but let's treat it as a related issue since this once is about the Apply button."", 'created_at': datetime.datetime(2024, 7, 15, 21, 16, 6, tzinfo=datetime.timezone.utc)}]","nemanjaglumac on (2024-07-15 21:16:06 UTC): Almost a duplicate of https://github.com/metabase/metabase/issues/44435, but let's treat it as a related issue since this once is about the Apply button.

"
2349475367,issue,closed,completed,slices and legends are missing colors sometimes,"https://metaboat.slack.com/archives/C077SMHSUTV/p1718206017063079

5977
4916
1610
13646
13647
1569
4879
14963

use `getPreferredColor` function in `frontend/src/metabase/lib/colors/groups.ts`, update this for cartesian charts as well",EmmadUsmani,2024-06-12 18:50:14+00:00,['EmmadUsmani'],2024-06-24 18:32:36+00:00,2024-06-24 18:32:35+00:00,https://github.com/metabase/metabase/issues/44087,[],"[{'comment_id': 2187170790, 'issue_id': 2349475367, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/e1857d372d5cb61a07b404ed4e53d2e74da9abb1', 'created_at': datetime.datetime(2024, 6, 24, 18, 32, 36, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-24 18:32:36 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/e1857d372d5cb61a07b404ed4e53d2e74da9abb1

"
2349467223,issue,closed,completed,missing currency formatting in total and legend,"https://metaboat.slack.com/archives/C077SMHSUTV/p1718206028712739

15468
17846
1262
15469
17855",EmmadUsmani,2024-06-12 18:44:40+00:00,['EmmadUsmani'],2024-06-18 20:41:18+00:00,2024-06-18 20:41:18+00:00,https://github.com/metabase/metabase/issues/44086,[],"[{'comment_id': 2176935367, 'issue_id': 2349467223, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/956315475814d69712f47e06054072fb32b59d60', 'created_at': datetime.datetime(2024, 6, 18, 20, 41, 18, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-18 20:41:18 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/956315475814d69712f47e06054072fb32b59d60

"
2349465608,issue,closed,completed,some charts are crashing,"https://metaboat.slack.com/archives/C077SMHSUTV/p1718206097023199

- [x] 14106
- [x] 13259
- [x] 13193
- [x] 15807
- [x] 13338
- [x] 8156

Above are from first bug bash

---

These are from second bug bash

- [ ] 14506
```
ERROR: relation ""metabase_cache_754bd_26.model_14080_<redacted_A>_"" does not exist
  Position: 207
```
- [ ] 14499
_same cache model does not exist_
- [ ] 11652
_same cache model does not exist_
- [ ] 13591
_same cache model does not exist_
- [ ] 12662
_different cache model does not exist: `metabase_cache_754bd_26.model_<readacted_B>`_
- [ ] 13646
_first cache model (redacted_A) does not exist_
- [ ] 13647
_first cache model does not exist_",EmmadUsmani,2024-06-12 18:43:36+00:00,['EmmadUsmani'],2024-07-04 19:51:40+00:00,2024-07-04 19:51:40+00:00,https://github.com/metabase/metabase/issues/44085,[],"[{'comment_id': 2187511991, 'issue_id': 2349465608, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/4a62d7a6e4b3605b859b064ebdfe177c74025a4a', 'created_at': datetime.datetime(2024, 6, 24, 22, 23, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2209505235, 'issue_id': 2349465608, 'author': 'EmmadUsmani', 'body': ""Since all of the current crashes are due to issues with tables not existing, I'm closing this issue again as none of these are caused by the pie chart code."", 'created_at': datetime.datetime(2024, 7, 4, 19, 51, 40, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-24 22:23:54 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/4a62d7a6e4b3605b859b064ebdfe177c74025a4a

EmmadUsmani (Issue Creator) on (2024-07-04 19:51:40 UTC): Since all of the current crashes are due to issues with tables not existing, I'm closing this issue again as none of these are caused by the pie chart code.

"
2349449083,issue,closed,completed,[Databricks] Cleanup,"~~Driver's most recent implementation is currently [databricks-hive-like](https://github.com/metabase/metabase/tree/databricks-hive-like) branch. Code contains lot of `TODOs` and some tests we commented out. This should be resolved prior merging.~~

- [x] Logging exception. It does not affect the driver functionality but is rendered close to driver initialization once per Metabase process run.
- [x] Make the CI job required (after merging).
- [x] Separate CI and development at least to different catalogs.
- [x] Disable the database creation for the CI run (as in Athena driver; after merging).",lbrdnk,2024-06-12 18:32:48+00:00,['lbrdnk'],2024-11-25 13:39:05+00:00,2024-11-25 13:39:05+00:00,https://github.com/metabase/metabase/issues/44083,"[('.Team/Querying', '')]","[{'comment_id': 2305505735, 'issue_id': 2349449083, 'author': 'jschwendt', 'body': 'I tried the databricks-hive-like branch and ran into an issue when attempting to connect to Azure hosted Databricks.\r\nSteps to reproduce:\r\n1. bin/build-drivers.sh\r\n2. yarn dev\r\n3. Add connection in frontend and click ""Save"" button.  Got an error that hive_like class wasn\'t found\r\n4. Copied the hive_like.clj and hive_like folder (with contents) to the same folder under databricks-jdbc\r\n5. bin/build-drivers.sh \r\n6. yarn dev\r\n\r\nGot the attached error in the console (included everything from the second run of ""yarn dev"" so you can see the full env).\r\n\r\nHappy to help debug this with you as I\'m trying my best to make it work.  I know it\'s not ready for prime time yet, but thought the early testing could be a help.\r\n[console.txt](https://github.com/user-attachments/files/16716825/console.txt)', 'created_at': datetime.datetime(2024, 8, 22, 19, 44, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2310480649, 'issue_id': 2349449083, 'author': 'jschwendt', 'body': '@lbrdnk do you have any suggestions?', 'created_at': datetime.datetime(2024, 8, 26, 15, 24, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2315927940, 'issue_id': 2349449083, 'author': 'lbrdnk', 'body': 'Hey @jschwendt. Thank you for ""trying out"" the driver, development is still in progress :)\r\n\r\nReading through the log you posted I see 2 main issues. \r\n\r\n1. Exception on logging that starts at line 329. I\'m aware of this one and I\'m trying to address that. This one seems not to affect the driver functionality.\r\n2. Exception related to database connection at line 2936. I haven\'t encountered this one before. What version of java are you using? Would you be able to confirm whether it occurs using java 11?\r\n\r\nAlso, please use the [databricks-jdbc](https://github.com/metabase/metabase/tree/databricks-jdbc) branch that contains latest development.', 'created_at': datetime.datetime(2024, 8, 28, 17, 43, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2318037051, 'issue_id': 2349449083, 'author': 'jschwendt', 'body': 'Thanks @lbrdnk!  I was running openjdk 22 on Macos previously.  I just pulled your latest changes from the databricks-jdbc branch and ran it under openjdk 11.  Note that I ran into the same issue as before where I ran ""bin/build-drivers.sh"" followed by ""yarn dev"" and got the following error on startup.  To resolve this last time, I had to copy the hive files over from the sqlspark driver using the following command:\r\ncp -R modules/drivers/sparksql/src/metabase/driver/hive_like* modules/drivers/databricks-jdbc/src/metabase/driver\r\n\r\nThat said, it didn\'t work this time.  Here\'s the error I got on startup:\r\n[backend] 2024-08-29 10:29:11,454 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :databricks-jdbc...\r\n[backend] 2024-08-29 10:29:11,456 ERROR driver.impl :: Error loading driver namespace\r\nclojure.lang.ExceptionInfo: Could not locate metabase/driver/hive_like__init.class, metabase/driver/hive_like.clj or metabase/driver/hive_like.cljc on classpath. Please check that namespaces with dashes use underscores in the Clojure file name. {:classloader #object[clojure.lang.DynamicClassLoader 0x1538d8e5 ""clojure.lang.DynamicClassLoader@1538d8e5""], :classpath-urls (), :system-classpath (""/Users/a4532252/.gitlibs/libs/io.github.eerohele/pp/a4287519bdbddaf25e4e480a73caa8055f375b48/src"" ""/Users/a4532252/.m2/repository/amalloy/ring-buffer/1.3.1/ring-buffer-1.3.1.jar"" ""/Users/a4532252/.m2/repository/amalloy/ring-gzip-middleware/0.1.4/ring-gzip-middleware-0.1.4.jar"" ""/Users/a4532252/.m2/repository/babashka/fs/0.5.20/fs-0.5.20.jar"" ""/Users/a4532252/.m2/repository/better-cond/better-cond/2.1.5/better-cond-2.1.5.jar"" ""/Users/a4532252/.m2/repository/bigml/histogram/4.1.4/histogram-4.1.4.jar"" ""/Users/a4532252/.m2/repository/borkdude/dynaload/0.3.5/dynaload-0.3.5.jar"" ""/Users/a4532252/.m2/repository/borkdude/edamame/1.4.25/edamame-1.4.25.jar"" ""/Users/a4532252/.m2/repository/buddy/buddy-core/1.11.423/buddy-core-1.11.423.jar"" ""/Users/a4532252/.m2/repository/buddy/buddy-sign/3.5.351/buddy-sign-3.5.351.jar"" ""/Users/a4532252/.m2/repository/camel-snake-kebab/camel-snake-kebab/0.4.3/camel-snake-kebab-0.4.3.jar"" ""/Users/a4532252/.m2/repository/cheshire/cheshire/5.12.0/cheshire-5.12.0.jar"" ""/Users/a4532252/.m2/repository/clj-bom/clj-bom/0.1.2/clj-bom-0.1.2.jar"" ""/Users/a4532252/.m2/repository/clj-commons/clj-yaml/1.0.27/clj-yaml-1.0.27.jar"" ""/Users/a4532252/.m2/repository/clj-commons/iapetos/0.1.13/iapetos-0.1.13.jar"" ""/Users/a4532252/.m2/repository/clj-http/clj-http/3.12.3/clj-http-3.12.3.jar"" ""/Users/a4532252/.m2/repository/clj-time/clj-time/0.15.2/clj-time-0.15.2.jar"" ""/Users/a4532252/.m2/repository/clojure/java-time/clojure.java-time/1.4.2/clojure.java-time-1.4.2.jar"" ""/Users/a4532252/.m2/repository/clojurewerkz/quartzite/2.2.0/quartzite-2.2.0.jar"" ""/Users/a4532252/.m2/repository/clout/clout/2.2.1/clout-2.2.1.jar"" ""/Users/a4532252/.m2/repository/colorize/colorize/0.1.1/colorize-0.1.1.jar"" ""/Users/a4532252/.m2/repository/com/andrewmcveigh/cljs-time/0.5.2/cljs-time-0.5.2.jar"" ""/Users/a4532252/.m2/repository/com/clearspring/analytics/stream/2.9.8/stream-2.9.8.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-clj/1.0.324/transit-clj-1.0.324.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-cljs/0.8.269/transit-cljs-0.8.269.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-java/1.0.343/transit-java-1.0.343.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-js/0.8.874/transit-js-0.8.874.jar"" ""/Users/a4532252/.m2/repository/com/draines/postal/2.0.5/postal-2.0.5.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.17.0/jackson-annotations-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.17.0/jackson-core-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.17.0/jackson-databind-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-cbor/2.15.2/jackson-dataformat-cbor-2.15.2.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-smile/2.15.2/jackson-dataformat-smile-2.15.2.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/woodstox/woodstox-core/6.6.1/woodstox-core-6.6.1.jar"" ""/Users/a4532252/.m2/repository/com/gfredericks/test.chuck/0.2.14/test.chuck-0.2.14.jar"" ""/Users/a4532252/.m2/repository/com/github/jsqlparser/jsqlparser/4.9/jsqlparser-4.9.jar"" ""/Users/a4532252/.m2/repository/com/github/oliyh/martian-hato/0.1.24/martian-hato-0.1.24.jar"" ""/Users/a4532252/.m2/repository/com/github/oliyh/martian/0.1.24/martian-0.1.24.jar"" ""/Users/a4532252/.m2/repository/com/github/seancorfield/honeysql/2.6.1126/honeysql-2.6.1126.jar"" ""/Users/a4532252/.m2/repository/com/github/seancorfield/next.jdbc/1.3.925/next.jdbc-1.3.925.jar"" ""/Users/a4532252/.m2/repository/com/github/steffan-westcott/clj-otel-api/0.2.6/clj-otel-api-0.2.6.jar"" ""/Users/a4532252/.m2/repository/com/github/vertical-blank/sql-formatter/2.0.4/sql-formatter-2.0.4.jar"" ""/Users/a4532252/.m2/repository/com/github/virtuald/curvesapi/1.08/curvesapi-1.08.jar"" ""/Users/a4532252/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar"" ""/Users/a4532252/.m2/repository/com/google/errorprone/error_prone_annotations/2.26.1/error_prone_annotations-2.26.1.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/failureaccess/1.0.2/failureaccess-1.0.2.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/guava/33.1.0-jre/guava-33.1.0-jre.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar"" ""/Users/a4532252/.m2/repository/com/google/j2objc/j2objc-annotations/3.0.0/j2objc-annotations-3.0.0.jar"" ""/Users/a4532252/.m2/repository/com/googlecode/json-simple/json-simple/1.1.1/json-simple-1.1.1.jar"" ""/Users/a4532252/.m2/repository/com/h2database/h2/2.1.214/h2-2.1.214.jar"" ""/Users/a4532252/.m2/repository/com/ibm/icu/icu4j/71.1/icu4j-71.1.jar"" ""/Users/a4532252/.m2/repository/com/mchange/c3p0/0.9.5.5/c3p0-0.9.5.5.jar"" ""/Users/a4532252/.m2/repository/com/mchange/mchange-commons-java/0.2.19/mchange-commons-java-0.2.19.jar"" ""/Users/a4532252/.m2/repository/com/onelogin/java-saml-core/2.9.0/java-saml-core-2.9.0.jar"" ""/Users/a4532252/.m2/repository/com/onelogin/java-saml/2.9.0/java-saml-2.9.0.jar"" ""/Users/a4532252/.m2/repository/com/opencsv/opencsv/5.9/opencsv-5.9.jar"" ""/Users/a4532252/.m2/repository/com/snowplowanalytics/snowplow-java-tracker/1.0.1/snowplow-java-tracker-1.0.1.jar"" ""/Users/a4532252/.m2/repository/com/sun/activation/jakarta.activation/1.2.1/jakarta.activation-1.2.1.jar"" ""/Users/a4532252/.m2/repository/com/sun/mail/jakarta.mail/1.6.5/jakarta.mail-1.6.5.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/encore/3.112.0/encore-3.112.0.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/nippy/3.4.2/nippy-3.4.2.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/truss/1.11.0/truss-1.11.0.jar"" ""/Users/a4532252/.m2/repository/com/tdunning/t-digest/3.2/t-digest-3.2.jar"" ""/Users/a4532252/.m2/repository/com/unboundid/unboundid-ldapsdk/5.1.1/unboundid-ldapsdk-5.1.1.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-ext-autolink/0.64.8/flexmark-ext-autolink-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-ast/0.64.8/flexmark-util-ast-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-builder/0.64.8/flexmark-util-builder-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-collection/0.64.8/flexmark-util-collection-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-data/0.64.8/flexmark-util-data-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-dependency/0.64.8/flexmark-util-dependency-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-format/0.64.8/flexmark-util-format-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-html/0.64.8/flexmark-util-html-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-misc/0.64.8/flexmark-util-misc-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-options/0.64.8/flexmark-util-options-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-sequence/0.64.8/flexmark-util-sequence-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-visitor/0.64.8/flexmark-util-visitor-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util/0.64.8/flexmark-util-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark/0.64.8/flexmark-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/zaxxer/HikariCP-java7/2.4.13/HikariCP-java7-2.4.13.jar"" ""/Users/a4532252/.m2/repository/com/zaxxer/SparseBitSet/1.3/SparseBitSet-1.3.jar"" ""/Users/a4532252/.m2/repository/commons-codec/commons-codec/1.16.1/commons-codec-1.16.1.jar"" ""/Users/a4532252/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar"" ""/Users/a4532252/.m2/repository/commons-fileupload/commons-fileupload/1.5/commons-fileupload-1.5.jar"" ""/Users/a4532252/.m2/repository/commons-io/commons-io/2.15.1/commons-io-2.15.1.jar"" ""/Users/a4532252/.m2/repository/commons-logging/commons-logging/1.3.0/commons-logging-1.3.0.jar"" ""/Users/a4532252/.m2/repository/commons-net/commons-net/3.10.0/commons-net-3.10.0.jar"" ""/Users/a4532252/.m2/repository/commons-validator/commons-validator/1.8.0/commons-validator-1.8.0.jar"" ""/Users/a4532252/.m2/repository/compojure/compojure/1.7.1/compojure-1.7.1.jar"" ""/Users/a4532252/.m2/repository/crypto-equality/crypto-equality/1.0.1/crypto-equality-1.0.1.jar"" ""/Users/a4532252/.m2/repository/crypto-random/crypto-random/1.2.1/crypto-random-1.2.1.jar"" ""/Users/a4532252/.m2/repository/dk/ative/docjure/1.19.0/docjure-1.19.0.jar"" ""/Users/a4532252/.m2/repository/environ/environ/1.2.0/environ-1.2.0.jar"" ""/Users/a4532252/.m2/repository/fipp/fipp/0.6.26/fipp-0.6.26.jar"" ""/Users/a4532252/.m2/repository/frankiesardo/tripod/0.2.0/tripod-0.2.0.jar"" ""/Users/a4532252/.m2/repository/hato/hato/0.8.2/hato-0.8.2.jar"" ""/Users/a4532252/.m2/repository/hiccup/hiccup/1.0.5/hiccup-1.0.5.jar"" ""/Users/a4532252/.m2/repository/inflections/inflections/0.14.1/inflections-0.14.1.jar"" ""/Users/a4532252/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar"" ""/Users/a4532252/.m2/repository/io/airlift/aircompressor/0.27/aircompressor-0.27.jar"" ""/Users/a4532252/.m2/repository/io/dropwizard/metrics/metrics-core/4.2.9/metrics-core-4.2.9.jar"" ""/Users/a4532252/.m2/repository/io/github/camsaul/toucan2/1.0.538/toucan2-1.0.538.jar"" ""/Users/a4532252/.m2/repository/io/github/metabase/macaw/0.2.6/macaw-0.2.6.jar"" ""/Users/a4532252/.m2/repository/io/github/resilience4j/resilience4j-core/1.7.1/resilience4j-core-1.7.1.jar"" ""/Users/a4532252/.m2/repository/io/github/resilience4j/resilience4j-retry/1.7.1/resilience4j-retry-1.7.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/opentelemetry-api/1.34.1/opentelemetry-api-1.34.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/opentelemetry-context/1.34.1/opentelemetry-context-1.34.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/semconv/opentelemetry-semconv/1.23.1-alpha/opentelemetry-semconv-1.23.1-alpha.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_common/0.12.0/simpleclient_common-0.12.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_pushgateway/0.12.0/simpleclient_pushgateway-0.12.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/vavr/vavr-match/0.10.2/vavr-match-0.10.2.jar"" ""/Users/a4532252/.m2/repository/io/vavr/vavr/0.10.2/vavr-0.10.2.jar"" ""/Users/a4532252/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/3.0.1/jakarta.xml.bind-api-3.0.1.jar"" ""/Users/a4532252/.m2/repository/javax/annotation/jsr250-api/1.0/jsr250-api-1.0.jar"" ""/Users/a4532252/.m2/repository/javax/servlet/servlet-api/2.5/servlet-api-2.5.jar"" ""/Users/a4532252/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar"" ""/Users/a4532252/.m2/repository/joda-time/joda-time/2.10.6/joda-time-2.10.6.jar"" ""/Users/a4532252/.m2/repository/junegunn/grouper/0.1.1/grouper-0.1.1.jar"" ""/Users/a4532252/.m2/repository/kixi/stats/0.5.5/stats-0.5.5.jar"" ""/Users/a4532252/.m2/repository/lambdaisland/uri/1.19.155/uri-1.19.155.jar"" ""/Users/a4532252/.m2/repository/medley/medley/1.4.0/medley-1.4.0.jar"" ""/Users/a4532252/.m2/repository/metabase/connection-pool/1.2.0/connection-pool-1.2.0.jar"" ""/Users/a4532252/.m2/repository/metabase/saml20-clj/2.2.7.172/saml20-clj-2.2.7.172.jar"" ""/Users/a4532252/.m2/repository/metabase/throttle/1.0.2/throttle-1.0.2.jar"" ""/Users/a4532252/.m2/repository/methodical/methodical/0.15.1/methodical-0.15.1.jar"" ""/Users/a4532252/.m2/repository/metosin/malli/0.16.3/malli-0.16.3.jar"" ""/Users/a4532252/.m2/repository/metosin/schema-tools/0.12.3/schema-tools-0.12.3.jar"" ""/Users/a4532252/.m2/repository/metosin/spec-tools/0.10.5/spec-tools-0.10.5.jar"" ""/Users/a4532252/.m2/repository/mvxcvi/arrangement/2.1.0/arrangement-2.1.0.jar"" ""/Users/a4532252/.m2/repository/mvxcvi/puget/1.3.4/puget-1.3.4.jar"" ""/Users/a4532252/.m2/repository/nano-id/nano-id/1.1.0/nano-id-1.1.0.jar"" ""/Users/a4532252/.m2/repository/net/bytebuddy/byte-buddy/1.14.9/byte-buddy-1.14.9.jar"" ""/Users/a4532252/.m2/repository/net/cgrand/macrovich/0.2.2/macrovich-0.2.2.jar"" ""/Users/a4532252/.m2/repository/net/clojars/wkok/openai-clojure/0.16.0/openai-clojure-0.16.0.jar"" ""/Users/a4532252/.m2/repository/net/i2p/crypto/eddsa/0.3.0/eddsa-0.3.0.jar"" ""/Users/a4532252/.m2/repository/net/redhogs/cronparser/cron-parser-core/3.5/cron-parser-core-3.5.jar"" ""/Users/a4532252/.m2/repository/net/sf/cssbox/cssbox/5.0.1/cssbox-5.0.1.jar"" ""/Users/a4532252/.m2/repository/net/sf/cssbox/jstyleparser/4.0.0/jstyleparser-4.0.0.jar"" ""/Users/a4532252/.m2/repository/net/sf/qualitycheck/quality-check/1.3/quality-check-1.3.jar"" ""/Users/a4532252/.m2/repository/net/sf/uadetector/uadetector-core/0.9.22/uadetector-core-0.9.22.jar"" ""/Users/a4532252/.m2/repository/net/sf/uadetector/uadetector-resources/2014.10/uadetector-resources-2014.10.jar"" ""/Users/a4532252/.m2/repository/net/shibboleth/utilities/java-support/8.3.1/java-support-8.3.1.jar"" ""/Users/a4532252/.m2/repository/net/thisptr/jackson-jq/1.0.0-preview.20240207/jackson-jq-1.0.0-preview.20240207.jar"" ""/Users/a4532252/.m2/repository/noencore/noencore/0.3.7/noencore-0.3.7.jar"" ""/Users/a4532252/.m2/repository/org/antlr/antlr4-runtime/4.5.3/antlr4-runtime-4.5.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-compress/1.26.1/commons-compress-1.26.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-fileupload2-core/2.0.0-M1/commons-fileupload2-core-2.0.0-M1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-lang3/3.14.0/commons-lang3-3.14.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-text/1.11.0/commons-text-1.11.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpasyncclient/4.1.4/httpasyncclient-4.1.4.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpclient-cache/4.5.13/httpclient-cache-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpcore-nio/4.4.10/httpcore-nio-4.4.10.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpmime/4.5.13/httpmime-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.23.1/log4j-1.2-api-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-api/2.23.1/log4j-api-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-core/2.23.1/log4j-core-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-jcl/2.23.1/log4j-jcl-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-jul/2.23.1/log4j-jul-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-layout-template-json/2.23.1/log4j-layout-template-json-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-slf4j2-impl/2.23.1/log4j-slf4j2-impl-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi-ooxml-lite/5.2.5/poi-ooxml-lite-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi-ooxml/5.2.5/poi-ooxml-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi/5.2.5/poi-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/santuario/xmlsec/3.0.3/xmlsec-3.0.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/sshd/sshd-common/2.12.1/sshd-common-2.12.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/sshd/sshd-core/2.12.1/sshd-core-2.12.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/tika/tika-core/2.9.2/tika-core-2.9.2.jar"" ""/Users/a4532252/.m2/repository/org/apache/velocity/velocity-engine-core/2.3/velocity-engine-core-2.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlbeans/xmlbeans/5.2.0/xmlbeans-5.2.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlgraphics/batik-all/1.17/batik-all-1.17.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlgraphics/xmlgraphics-commons/2.9/xmlgraphics-commons-2.9.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcpkix-jdk18on/1.78/bcpkix-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcprov-jdk18on/1.78/bcprov-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcutil-jdk18on/1.78/bcutil-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/checkerframework/checker-qual/3.42.0/checker-qual-3.42.0.jar"" ""/Users/a4532252/.m2/repository/org/clj-commons/claypoole/1.2.2/claypoole-1.2.2.jar"" ""/Users/a4532252/.m2/repository/org/clj-commons/hickory/0.7.4/hickory-0.7.4.jar"" ""/Users/a4532252/.m2/repository/org/clojars/pntblnk/clj-ldap/0.0.17/clj-ldap-0.0.17.jar"" ""/Users/a4532252/.m2/repository/org/clojure/clojure/1.11.2/clojure-1.11.2.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.async/1.6.681/core.async-1.6.681.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.cache/1.1.234/core.cache-1.1.234.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.logic/1.1.0/core.logic-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.match/1.1.0/core.match-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.memoize/1.1.266/core.memoize-1.1.266.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.rrb-vector/0.1.2/core.rrb-vector-0.1.2.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.specs.alpha/0.2.62/core.specs.alpha-0.2.62.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.csv/1.1.0/data.csv-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.priority-map/1.2.0/data.priority-map-1.2.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.xml/0.0.8/data.xml-0.0.8.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.classpath/1.1.0/java.classpath-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.data/1.2.107/java.data-1.2.107.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.jdbc/0.7.12/java.jdbc-0.7.12.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.jmx/1.1.0/java.jmx-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/math.combinatorics/0.3.0/math.combinatorics-0.3.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/math.numeric-tower/0.1.0/math.numeric-tower-0.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/spec.alpha/0.3.218/spec.alpha-0.3.218.jar"" ""/Users/a4532252/.m2/repository/org/clojure/test.check/1.1.1/test.check-1.1.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.analyzer.jvm/1.2.3/tools.analyzer.jvm-1.2.3.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.analyzer/1.1.1/tools.analyzer-1.1.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.cli/1.1.230/tools.cli-1.1.230.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.logging/1.3.0/tools.logging-1.3.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.macro/0.2.0/tools.macro-0.2.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.namespace/1.5.0/tools.namespace-1.5.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.reader/1.4.1/tools.reader-1.4.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.trace/0.8.0/tools.trace-0.8.0.jar"" ""/Users/a4532252/.m2/repository/org/codehaus/woodstox/stax2-api/4.2.2/stax2-api-4.2.2.jar"" ""/Users/a4532252/.m2/repository/org/codelibs/nekohtml/2.0.2/nekohtml-2.0.2.jar"" ""/Users/a4532252/.m2/repository/org/codelibs/xerces/xercesImpl/2.12.0-sp1/xercesImpl-2.12.0-sp1.jar"" ""/Users/a4532252/.m2/repository/org/cryptacular/cryptacular/1.2.5/cryptacular-1.2.5.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-http/11.0.20/jetty-http-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-io/11.0.20/jetty-io-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-security/11.0.20/jetty-security-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-server/11.0.20/jetty-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-servlet/11.0.20/jetty-servlet-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-util/11.0.20/jetty-util-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-webapp/11.0.20/jetty-webapp-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-xml/11.0.20/jetty-xml-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/toolchain/jetty-jakarta-servlet-api/5.0.2/jetty-jakarta-servlet-api-5.0.2.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-core-common/11.0.20/websocket-core-common-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-core-server/11.0.20/websocket-core-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-api/11.0.20/websocket-jetty-api-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-common/11.0.20/websocket-jetty-common-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-server/11.0.20/websocket-jetty-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/11.0.20/websocket-servlet-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/flatland/ordered/1.15.11/ordered-1.15.11.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/js/js/22.3.5/js-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/regex/regex/22.3.5/regex-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/sdk/graal-sdk/22.3.5/graal-sdk-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/truffle/truffle-api/22.3.5/truffle-api-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/javassist/javassist/3.18.1-GA/javassist-3.18.1-GA.jar"" ""/Users/a4532252/.m2/repository/org/jetbrains/annotations/24.0.1/annotations-24.0.1.jar"" ""/Users/a4532252/.m2/repository/org/jruby/jcodings/jcodings/1.0.58/jcodings-1.0.58.jar"" ""/Users/a4532252/.m2/repository/org/jruby/joni/joni/2.2.1/joni-2.2.1.jar"" ""/Users/a4532252/.m2/repository/org/jsoup/jsoup/1.17.2/jsoup-1.17.2.jar"" ""/Users/a4532252/.m2/repository/org/liquibase/liquibase-core/4.26.0/liquibase-core-4.26.0.jar"" ""/Users/a4532252/.m2/repository/org/mariadb/jdbc/mariadb-java-client/2.7.10/mariadb-java-client-2.7.10.jar"" ""/Users/a4532252/.m2/repository/org/mindrot/jbcrypt/0.4/jbcrypt-0.4.jar"" ""/Users/a4532252/.m2/repository/org/msgpack/msgpack/0.6.12/msgpack-0.6.12.jar"" ""/Users/a4532252/.m2/repository/org/nibor/autolink/autolink/0.6.0/autolink-0.6.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-core/4.2.0/opensaml-core-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-messaging-api/4.2.0/opensaml-messaging-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-profile-api/4.2.0/opensaml-profile-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-saml-api/4.2.0/opensaml-saml-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-saml-impl/4.2.0/opensaml-saml-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-security-api/4.2.0/opensaml-security-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-security-impl/4.2.0/opensaml-security-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-soap-api/4.2.0/opensaml-soap-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-soap-impl/4.2.0/opensaml-soap-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-storage-api/4.2.0/opensaml-storage-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-xmlsec-api/4.2.0/opensaml-xmlsec-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-xmlsec-impl/4.2.0/opensaml-xmlsec-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/ow2/asm/asm/9.2/asm-9.2.jar"" ""/Users/a4532252/.m2/repository/org/postgresql/postgresql/42.7.3/postgresql-42.7.3.jar"" ""/Users/a4532252/.m2/repository/org/quartz-scheduler/quartz/2.3.2/quartz-2.3.2.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-core-protocols/1.12.0/ring-core-protocols-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-jakarta-servlet/1.12.0/ring-jakarta-servlet-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-websocket-protocols/1.12.0/ring-websocket-protocols-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/slf4j/slf4j-api/2.0.12/slf4j-api-2.0.12.jar"" ""/Users/a4532252/.m2/repository/org/tcrawley/dynapath/1.1.0/dynapath-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/threeten/threeten-extra/1.7.2/threeten-extra-1.7.2.jar"" ""/Users/a4532252/.m2/repository/org/tukaani/xz/1.9/xz-1.9.jar"" ""/Users/a4532252/.m2/repository/org/unbescape/unbescape/1.1.6.RELEASE/unbescape-1.1.6.RELEASE.jar"" ""/Users/a4532252/.m2/repository/org/yaml/snakeyaml/2.2/snakeyaml-2.2.jar"" ""/Users/a4532252/.m2/repository/potemkin/potemkin/0.4.7/potemkin-0.4.7.jar"" ""/Users/a4532252/.m2/repository/pretty/pretty/1.0.5/pretty-1.0.5.jar"" ""/Users/a4532252/.m2/repository/prismatic/schema/1.1.12/schema-1.1.12.jar"" ""/Users/a4532252/.m2/repository/quoin/quoin/0.1.2/quoin-0.1.2.jar"" ""/Users/a4532252/.m2/repository/redux/redux/0.1.4/redux-0.1.4.jar"" ""/Users/a4532252/.m2/repository/riddley/riddley/0.2.0/riddley-0.2.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-codec/1.2.0/ring-codec-1.2.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-core/1.12.0/ring-core-1.12.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-jetty-adapter/1.12.0/ring-jetty-adapter-1.12.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-json/0.5.1/ring-json-0.5.1.jar"" ""/Users/a4532252/.m2/repository/scout/scout/0.1.0/scout-0.1.0.jar"" ""/Users/a4532252/.m2/repository/slingshot/slingshot/0.12.2/slingshot-0.12.2.jar"" ""/Users/a4532252/.m2/repository/stencil/stencil/0.5.0/stencil-0.5.0.jar"" ""/Users/a4532252/.m2/repository/tigris/tigris/0.1.2/tigris-0.1.2.jar"" ""/Users/a4532252/.m2/repository/user-agent/user-agent/0.1.1/user-agent-0.1.1.jar"" ""/Users/a4532252/.m2/repository/weavejester/dependency/0.2.1/dependency-0.2.1.jar"" ""/Users/a4532252/.m2/repository/xml-apis/xml-apis-ext/1.3.04/xml-apis-ext-1.3.04.jar"" ""/Users/a4532252/.m2/repository/xml-apis/xml-apis/1.4.01/xml-apis-1.4.01.jar"" ""resources"" ""src"")}\r\n[backend] \tat metabase.plugins.classloader$require_STAR_.invokeStatic(classloader.clj:132)\r\n[backend] \tat metabase.plugins.classloader$require_STAR_.doInvoke(classloader.clj:116)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:408)\r\n[backend] \tat metabase.plugins.classloader$require.invokeStatic(classloader.clj:151)\r\n[backend] \tat metabase.plugins.classloader$require.invoke(classloader.clj:138)\r\n[backend] \tat clojure.lang.AFn.applyToHelper(AFn.java:154)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:669)\r\n[backend] \tat clojure.core$apply.invoke(core.clj:662)\r\n[backend] \tat metabase.driver.impl$require_driver_ns.invokeStatic(impl.clj:77)\r\n[backend] \tat metabase.driver.impl$require_driver_ns.doInvoke(impl.clj:71)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:410)\r\n[backend] \tat metabase.driver.impl$load_driver_namespace_if_needed_BANG_$fn__74988.invoke(impl.clj:97)\r\n[backend] \tat metabase.driver.impl$load_driver_namespace_if_needed_BANG_.invokeStatic(impl.clj:96)\r\n[backend] \tat metabase.driver.impl$load_driver_namespace_if_needed_BANG_.invoke(impl.clj:82)\r\n[backend] \tat metabase.driver.impl$register_BANG_.invokeStatic(impl.clj:148)\r\n[backend] \tat metabase.driver.impl$register_BANG_.doInvoke(impl.clj:117)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:486)\r\n[backend] \tat metabase.plugins.lazy_loaded_driver$register_lazy_loaded_driver_BANG_.invokeStatic(lazy_loaded_driver.clj:94)\r\n[backend] \tat metabase.plugins.lazy_loaded_driver$register_lazy_loaded_driver_BANG_.invoke(lazy_loaded_driver.clj:64)\r\n[backend] \tat metabase.plugins.initialize$init_BANG_.invokeStatic(initialize.clj:26)\r\n[backend] \tat metabase.plugins.initialize$init_BANG_.invoke(initialize.clj:18)\r\n[backend] \tat metabase.plugins.initialize$fn__118516$init_plugin_with_info_BANG_118515__118517.invoke(initialize.clj:59)\r\n[backend] \tat metabase.plugins.initialize$fn__118516$fn__118523.invoke(initialize.clj:47)\r\n[backend] \tat metabase.plugins$init_plugin_with_info_BANG_.invokeStatic(plugins.clj:89)\r\n[backend] \tat metabase.plugins$init_plugin_with_info_BANG_.invoke(plugins.clj:85)\r\n[backend] \tat metabase.plugins$init_plugin_BANG_.invokeStatic(plugins.clj:96)\r\n[backend] \tat metabase.plugins$init_plugin_BANG_.invoke(plugins.clj:91)\r\n[backend] \tat metabase.plugins$init_plugins_BANG_$fn__118630.invoke(plugins.clj:164)\r\n[backend] \tat metabase.plugins$init_plugins_BANG_.invokeStatic(plugins.clj:163)\r\n[backend] \tat metabase.plugins$init_plugins_BANG_.invoke(plugins.clj:156)\r\n[backend] \tat metabase.plugins$load_BANG_.invokeStatic(plugins.clj:172)\r\n[backend] \tat metabase.plugins$load_BANG_.invoke(plugins.clj:168)\r\n[backend] \tat metabase.plugins$load_plugins_BANG_.invokeStatic(plugins.clj:199)\r\n[backend] \tat metabase.plugins$load_plugins_BANG_.invoke(plugins.clj:178)\r\n[backend] \tat metabase.core$init_BANG__STAR_.invokeStatic(core.clj:108)\r\n[backend] \tat metabase.core$init_BANG__STAR_.invoke(core.clj:98)\r\n[backend] \tat metabase.core$init_BANG_.invokeStatic(core.clj:171)\r\n[backend] \tat metabase.core$init_BANG_.invoke(core.clj:166)\r\n[backend] \tat metabase.core$start_normally.invokeStatic(core.clj:183)\r\n[backend] \tat metabase.core$start_normally.invoke(core.clj:177)\r\n[backend] \tat metabase.core$entrypoint.invokeStatic(core.clj:216)\r\n[backend] \tat metabase.core$entrypoint.doInvoke(core.clj:210)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:397)\r\n[backend] \tat clojure.lang.AFn.applyToHelper(AFn.java:152)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n[backend] \tat clojure.lang.Var.applyTo(Var.java:705)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:667)\r\n[backend] \tat clojure.core$apply.invoke(core.clj:662)\r\n[backend] \tat metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)\r\n[backend] \tat metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:397)\r\n[backend] \tat clojure.lang.AFn.applyToHelper(AFn.java:152)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n[backend] \tat clojure.lang.Var.applyTo(Var.java:705)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:667)\r\n[backend] \tat clojure.main$main_opt.invokeStatic(main.clj:514)\r\n[backend] \tat clojure.main$main_opt.invoke(main.clj:510)\r\n[backend] \tat clojure.main$main.invokeStatic(main.clj:664)\r\n[backend] \tat clojure.main$main.doInvoke(main.clj:616)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:137)\r\n[backend] \tat clojure.lang.Var.applyTo(Var.java:705)\r\n[backend] \tat clojure.main.main(main.java:40)\r\n[backend] Caused by: java.io.FileNotFoundException: Could not locate metabase/driver/hive_like__init.class, metabase/driver/hive_like.clj or metabase/driver/hive_like.cljc on classpath. Please check that namespaces with dashes use underscores in the Clojure file name.\r\n[backend] \tat clojure.lang.RT.load(RT.java:462)\r\n[backend] \tat clojure.lang.RT.load(RT.java:424)\r\n[backend] \tat clojure.core$load$fn__6908.invoke(core.clj:6162)\r\n[backend] \tat clojure.core$load.invokeStatic(core.clj:6161)\r\n[backend] \tat clojure.core$load.doInvoke(core.clj:6145)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:408)\r\n[backend] \tat clojure.core$load_one.invokeStatic(core.clj:5934)\r\n[backend] \tat clojure.core$load_one.invoke(core.clj:5929)\r\n[backend] \tat clojure.core$load_lib$fn__6850.invoke(core.clj:5976)\r\n[backend] \tat clojure.core$load_lib.invokeStatic(core.clj:5975)\r\n[backend] \tat clojure.core$load_lib.doInvoke(core.clj:5954)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:142)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:669)\r\n[backend] \tat clojure.core$load_libs.invokeStatic(core.clj:6017)\r\n[backend] \tat clojure.core$load_libs.doInvoke(core.clj:6001)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:137)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:669)\r\n[backend] \tat clojure.core$require.invokeStatic(core.clj:6039)\r\n[backend] \tat clojure.core$require.doInvoke(core.clj:6039)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:137)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:667)\r\n[backend] \tat clojure.core$apply.invoke(core.clj:662)\r\n[backend] \tat metabase.plugins.classloader$require_STAR_.invokeStatic(classloader.clj:130)\r\n[backend] \t... 62 more\r\n[backend] 2024-08-29 10:29:11,467 ERROR metabase.plugins :: Failied to initialize plugin databricks-jdbc.metabase-driver.jar\r\n[backend] java.lang.Exception: Could not load :hive-like driver.\r\n[backend] \tat metabase.driver.impl$require_driver_ns.invokeStatic(impl.clj:80)\r\n[backend] \tat metabase.driver.impl$require_driver_ns.doInvoke(impl.clj:71)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:410)\r\n[backend] \tat metabase.driver.impl$load_driver_namespace_if_needed_BANG_$fn__74988.invoke(impl.clj:97)\r\n[backend] \tat metabase.driver.impl$load_driver_namespace_if_needed_BANG_.invokeStatic(impl.clj:96)\r\n[backend] \tat metabase.driver.impl$load_driver_namespace_if_needed_BANG_.invoke(impl.clj:82)\r\n[backend] \tat metabase.driver.impl$register_BANG_.invokeStatic(impl.clj:148)\r\n[backend] \tat metabase.driver.impl$register_BANG_.doInvoke(impl.clj:117)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:486)\r\n[backend] \tat metabase.plugins.lazy_loaded_driver$register_lazy_loaded_driver_BANG_.invokeStatic(lazy_loaded_driver.clj:94)\r\n[backend] \tat metabase.plugins.lazy_loaded_driver$register_lazy_loaded_driver_BANG_.invoke(lazy_loaded_driver.clj:64)\r\n[backend] \tat metabase.plugins.initialize$init_BANG_.invokeStatic(initialize.clj:26)\r\n[backend] \tat metabase.plugins.initialize$init_BANG_.invoke(initialize.clj:18)\r\n[backend] \tat metabase.plugins.initialize$fn__118516$init_plugin_with_info_BANG_118515__118517.invoke(initialize.clj:59)\r\n[backend] \tat metabase.plugins.initialize$fn__118516$fn__118523.invoke(initialize.clj:47)\r\n[backend] \tat metabase.plugins$init_plugin_with_info_BANG_.invokeStatic(plugins.clj:89)\r\n[backend] \tat metabase.plugins$init_plugin_with_info_BANG_.invoke(plugins.clj:85)\r\n[backend] \tat metabase.plugins$init_plugin_BANG_.invokeStatic(plugins.clj:96)\r\n[backend] \tat metabase.plugins$init_plugin_BANG_.invoke(plugins.clj:91)\r\n[backend] \tat metabase.plugins$init_plugins_BANG_$fn__118630.invoke(plugins.clj:164)\r\n[backend] \tat metabase.plugins$init_plugins_BANG_.invokeStatic(plugins.clj:163)\r\n[backend] \tat metabase.plugins$init_plugins_BANG_.invoke(plugins.clj:156)\r\n[backend] \tat metabase.plugins$load_BANG_.invokeStatic(plugins.clj:172)\r\n[backend] \tat metabase.plugins$load_BANG_.invoke(plugins.clj:168)\r\n[backend] \tat metabase.plugins$load_plugins_BANG_.invokeStatic(plugins.clj:199)\r\n[backend] \tat metabase.plugins$load_plugins_BANG_.invoke(plugins.clj:178)\r\n[backend] \tat metabase.core$init_BANG__STAR_.invokeStatic(core.clj:108)\r\n[backend] \tat metabase.core$init_BANG__STAR_.invoke(core.clj:98)\r\n[backend] \tat metabase.core$init_BANG_.invokeStatic(core.clj:171)\r\n[backend] \tat metabase.core$init_BANG_.invoke(core.clj:166)\r\n[backend] \tat metabase.core$start_normally.invokeStatic(core.clj:183)\r\n[backend] \tat metabase.core$start_normally.invoke(core.clj:177)\r\n[backend] \tat metabase.core$entrypoint.invokeStatic(core.clj:216)\r\n[backend] \tat metabase.core$entrypoint.doInvoke(core.clj:210)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:397)\r\n[backend] \tat clojure.lang.AFn.applyToHelper(AFn.java:152)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n[backend] \tat clojure.lang.Var.applyTo(Var.java:705)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:667)\r\n[backend] \tat clojure.core$apply.invoke(core.clj:662)\r\n[backend] \tat metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)\r\n[backend] \tat metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:397)\r\n[backend] \tat clojure.lang.AFn.applyToHelper(AFn.java:152)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n[backend] \tat clojure.lang.Var.applyTo(Var.java:705)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:667)\r\n[backend] \tat clojure.main$main_opt.invokeStatic(main.clj:514)\r\n[backend] \tat clojure.main$main_opt.invoke(main.clj:510)\r\n[backend] \tat clojure.main$main.invokeStatic(main.clj:664)\r\n[backend] \tat clojure.main$main.doInvoke(main.clj:616)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:137)\r\n[backend] \tat clojure.lang.Var.applyTo(Var.java:705)\r\n[backend] \tat clojure.main.main(main.java:40)\r\nCaused by: clojure.lang.ExceptionInfo: Could not locate metabase/driver/hive_like__init.class, metabase/driver/hive_like.clj or metabase/driver/hive_like.cljc on classpath. Please check that namespaces with dashes use underscores in the Clojure file name. {:classloader #object[clojure.lang.DynamicClassLoader 0x1538d8e5 ""clojure.lang.DynamicClassLoader@1538d8e5""], :classpath-urls (), :system-classpath (""/Users/a4532252/.gitlibs/libs/io.github.eerohele/pp/a4287519bdbddaf25e4e480a73caa8055f375b48/src"" ""/Users/a4532252/.m2/repository/amalloy/ring-buffer/1.3.1/ring-buffer-1.3.1.jar"" ""/Users/a4532252/.m2/repository/amalloy/ring-gzip-middleware/0.1.4/ring-gzip-middleware-0.1.4.jar"" ""/Users/a4532252/.m2/repository/babashka/fs/0.5.20/fs-0.5.20.jar"" ""/Users/a4532252/.m2/repository/better-cond/better-cond/2.1.5/better-cond-2.1.5.jar"" ""/Users/a4532252/.m2/repository/bigml/histogram/4.1.4/histogram-4.1.4.jar"" ""/Users/a4532252/.m2/repository/borkdude/dynaload/0.3.5/dynaload-0.3.5.jar"" ""/Users/a4532252/.m2/repository/borkdude/edamame/1.4.25/edamame-1.4.25.jar"" ""/Users/a4532252/.m2/repository/buddy/buddy-core/1.11.423/buddy-core-1.11.423.jar"" ""/Users/a4532252/.m2/repository/buddy/buddy-sign/3.5.351/buddy-sign-3.5.351.jar"" ""/Users/a4532252/.m2/repository/camel-snake-kebab/camel-snake-kebab/0.4.3/camel-snake-kebab-0.4.3.jar"" ""/Users/a4532252/.m2/repository/cheshire/cheshire/5.12.0/cheshire-5.12.0.jar"" ""/Users/a4532252/.m2/repository/clj-bom/clj-bom/0.1.2/clj-bom-0.1.2.jar"" ""/Users/a4532252/.m2/repository/clj-commons/clj-yaml/1.0.27/clj-yaml-1.0.27.jar"" ""/Users/a4532252/.m2/repository/clj-commons/iapetos/0.1.13/iapetos-0.1.13.jar"" ""/Users/a4532252/.m2/repository/clj-http/clj-http/3.12.3/clj-http-3.12.3.jar"" ""/Users/a4532252/.m2/repository/clj-time/clj-time/0.15.2/clj-time-0.15.2.jar"" ""/Users/a4532252/.m2/repository/clojure/java-time/clojure.java-time/1.4.2/clojure.java-time-1.4.2.jar"" ""/Users/a4532252/.m2/repository/clojurewerkz/quartzite/2.2.0/quartzite-2.2.0.jar"" ""/Users/a4532252/.m2/repository/clout/clout/2.2.1/clout-2.2.1.jar"" ""/Users/a4532252/.m2/repository/colorize/colorize/0.1.1/colorize-0.1.1.jar"" ""/Users/a4532252/.m2/repository/com/andrewmcveigh/cljs-time/0.5.2/cljs-time-0.5.2.jar"" ""/Users/a4532252/.m2/repository/com/clearspring/analytics/stream/2.9.8/stream-2.9.8.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-clj/1.0.324/transit-clj-1.0.324.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-cljs/0.8.269/transit-cljs-0.8.269.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-java/1.0.343/transit-java-1.0.343.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-js/0.8.874/transit-js-0.8.874.jar"" ""/Users/a4532252/.m2/repository/com/draines/postal/2.0.5/postal-2.0.5.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.17.0/jackson-annotations-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.17.0/jackson-core-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.17.0/jackson-databind-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-cbor/2.15.2/jackson-dataformat-cbor-2.15.2.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-smile/2.15.2/jackson-dataformat-smile-2.15.2.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/woodstox/woodstox-core/6.6.1/woodstox-core-6.6.1.jar"" ""/Users/a4532252/.m2/repository/com/gfredericks/test.chuck/0.2.14/test.chuck-0.2.14.jar"" ""/Users/a4532252/.m2/repository/com/github/jsqlparser/jsqlparser/4.9/jsqlparser-4.9.jar"" ""/Users/a4532252/.m2/repository/com/github/oliyh/martian-hato/0.1.24/martian-hato-0.1.24.jar"" ""/Users/a4532252/.m2/repository/com/github/oliyh/martian/0.1.24/martian-0.1.24.jar"" ""/Users/a4532252/.m2/repository/com/github/seancorfield/honeysql/2.6.1126/honeysql-2.6.1126.jar"" ""/Users/a4532252/.m2/repository/com/github/seancorfield/next.jdbc/1.3.925/next.jdbc-1.3.925.jar"" ""/Users/a4532252/.m2/repository/com/github/steffan-westcott/clj-otel-api/0.2.6/clj-otel-api-0.2.6.jar"" ""/Users/a4532252/.m2/repository/com/github/vertical-blank/sql-formatter/2.0.4/sql-formatter-2.0.4.jar"" ""/Users/a4532252/.m2/repository/com/github/virtuald/curvesapi/1.08/curvesapi-1.08.jar"" ""/Users/a4532252/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar"" ""/Users/a4532252/.m2/repository/com/google/errorprone/error_prone_annotations/2.26.1/error_prone_annotations-2.26.1.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/failureaccess/1.0.2/failureaccess-1.0.2.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/guava/33.1.0-jre/guava-33.1.0-jre.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar"" ""/Users/a4532252/.m2/repository/com/google/j2objc/j2objc-annotations/3.0.0/j2objc-annotations-3.0.0.jar"" ""/Users/a4532252/.m2/repository/com/googlecode/json-simple/json-simple/1.1.1/json-simple-1.1.1.jar"" ""/Users/a4532252/.m2/repository/com/h2database/h2/2.1.214/h2-2.1.214.jar"" ""/Users/a4532252/.m2/repository/com/ibm/icu/icu4j/71.1/icu4j-71.1.jar"" ""/Users/a4532252/.m2/repository/com/mchange/c3p0/0.9.5.5/c3p0-0.9.5.5.jar"" ""/Users/a4532252/.m2/repository/com/mchange/mchange-commons-java/0.2.19/mchange-commons-java-0.2.19.jar"" ""/Users/a4532252/.m2/repository/com/onelogin/java-saml-core/2.9.0/java-saml-core-2.9.0.jar"" ""/Users/a4532252/.m2/repository/com/onelogin/java-saml/2.9.0/java-saml-2.9.0.jar"" ""/Users/a4532252/.m2/repository/com/opencsv/opencsv/5.9/opencsv-5.9.jar"" ""/Users/a4532252/.m2/repository/com/snowplowanalytics/snowplow-java-tracker/1.0.1/snowplow-java-tracker-1.0.1.jar"" ""/Users/a4532252/.m2/repository/com/sun/activation/jakarta.activation/1.2.1/jakarta.activation-1.2.1.jar"" ""/Users/a4532252/.m2/repository/com/sun/mail/jakarta.mail/1.6.5/jakarta.mail-1.6.5.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/encore/3.112.0/encore-3.112.0.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/nippy/3.4.2/nippy-3.4.2.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/truss/1.11.0/truss-1.11.0.jar"" ""/Users/a4532252/.m2/repository/com/tdunning/t-digest/3.2/t-digest-3.2.jar"" ""/Users/a4532252/.m2/repository/com/unboundid/unboundid-ldapsdk/5.1.1/unboundid-ldapsdk-5.1.1.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-ext-autolink/0.64.8/flexmark-ext-autolink-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-ast/0.64.8/flexmark-util-ast-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-builder/0.64.8/flexmark-util-builder-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-collection/0.64.8/flexmark-util-collection-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-data/0.64.8/flexmark-util-data-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-dependency/0.64.8/flexmark-util-dependency-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-format/0.64.8/flexmark-util-format-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-html/0.64.8/flexmark-util-html-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-misc/0.64.8/flexmark-util-misc-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-options/0.64.8/flexmark-util-options-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-sequence/0.64.8/flexmark-util-sequence-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-visitor/0.64.8/flexmark-util-visitor-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util/0.64.8/flexmark-util-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark/0.64.8/flexmark-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/zaxxer/HikariCP-java7/2.4.13/HikariCP-java7-2.4.13.jar"" ""/Users/a4532252/.m2/repository/com/zaxxer/SparseBitSet/1.3/SparseBitSet-1.3.jar"" ""/Users/a4532252/.m2/repository/commons-codec/commons-codec/1.16.1/commons-codec-1.16.1.jar"" ""/Users/a4532252/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar"" ""/Users/a4532252/.m2/repository/commons-fileupload/commons-fileupload/1.5/commons-fileupload-1.5.jar"" ""/Users/a4532252/.m2/repository/commons-io/commons-io/2.15.1/commons-io-2.15.1.jar"" ""/Users/a4532252/.m2/repository/commons-logging/commons-logging/1.3.0/commons-logging-1.3.0.jar"" ""/Users/a4532252/.m2/repository/commons-net/commons-net/3.10.0/commons-net-3.10.0.jar"" ""/Users/a4532252/.m2/repository/commons-validator/commons-validator/1.8.0/commons-validator-1.8.0.jar"" ""/Users/a4532252/.m2/repository/compojure/compojure/1.7.1/compojure-1.7.1.jar"" ""/Users/a4532252/.m2/repository/crypto-equality/crypto-equality/1.0.1/crypto-equality-1.0.1.jar"" ""/Users/a4532252/.m2/repository/crypto-random/crypto-random/1.2.1/crypto-random-1.2.1.jar"" ""/Users/a4532252/.m2/repository/dk/ative/docjure/1.19.0/docjure-1.19.0.jar"" ""/Users/a4532252/.m2/repository/environ/environ/1.2.0/environ-1.2.0.jar"" ""/Users/a4532252/.m2/repository/fipp/fipp/0.6.26/fipp-0.6.26.jar"" ""/Users/a4532252/.m2/repository/frankiesardo/tripod/0.2.0/tripod-0.2.0.jar"" ""/Users/a4532252/.m2/repository/hato/hato/0.8.2/hato-0.8.2.jar"" ""/Users/a4532252/.m2/repository/hiccup/hiccup/1.0.5/hiccup-1.0.5.jar"" ""/Users/a4532252/.m2/repository/inflections/inflections/0.14.1/inflections-0.14.1.jar"" ""/Users/a4532252/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar"" ""/Users/a4532252/.m2/repository/io/airlift/aircompressor/0.27/aircompressor-0.27.jar"" ""/Users/a4532252/.m2/repository/io/dropwizard/metrics/metrics-core/4.2.9/metrics-core-4.2.9.jar"" ""/Users/a4532252/.m2/repository/io/github/camsaul/toucan2/1.0.538/toucan2-1.0.538.jar"" ""/Users/a4532252/.m2/repository/io/github/metabase/macaw/0.2.6/macaw-0.2.6.jar"" ""/Users/a4532252/.m2/repository/io/github/resilience4j/resilience4j-core/1.7.1/resilience4j-core-1.7.1.jar"" ""/Users/a4532252/.m2/repository/io/github/resilience4j/resilience4j-retry/1.7.1/resilience4j-retry-1.7.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/opentelemetry-api/1.34.1/opentelemetry-api-1.34.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/opentelemetry-context/1.34.1/opentelemetry-context-1.34.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/semconv/opentelemetry-semconv/1.23.1-alpha/opentelemetry-semconv-1.23.1-alpha.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_common/0.12.0/simpleclient_common-0.12.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_pushgateway/0.12.0/simpleclient_pushgateway-0.12.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/vavr/vavr-match/0.10.2/vavr-match-0.10.2.jar"" ""/Users/a4532252/.m2/repository/io/vavr/vavr/0.10.2/vavr-0.10.2.jar"" ""/Users/a4532252/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/3.0.1/jakarta.xml.bind-api-3.0.1.jar"" ""/Users/a4532252/.m2/repository/javax/annotation/jsr250-api/1.0/jsr250-api-1.0.jar"" ""/Users/a4532252/.m2/repository/javax/servlet/servlet-api/2.5/servlet-api-2.5.jar"" ""/Users/a4532252/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar"" ""/Users/a4532252/.m2/repository/joda-time/joda-time/2.10.6/joda-time-2.10.6.jar"" ""/Users/a4532252/.m2/repository/junegunn/grouper/0.1.1/grouper-0.1.1.jar"" ""/Users/a4532252/.m2/repository/kixi/stats/0.5.5/stats-0.5.5.jar"" ""/Users/a4532252/.m2/repository/lambdaisland/uri/1.19.155/uri-1.19.155.jar"" ""/Users/a4532252/.m2/repository/medley/medley/1.4.0/medley-1.4.0.jar"" ""/Users/a4532252/.m2/repository/metabase/connection-pool/1.2.0/connection-pool-1.2.0.jar"" ""/Users/a4532252/.m2/repository/metabase/saml20-clj/2.2.7.172/saml20-clj-2.2.7.172.jar"" ""/Users/a4532252/.m2/repository/metabase/throttle/1.0.2/throttle-1.0.2.jar"" ""/Users/a4532252/.m2/repository/methodical/methodical/0.15.1/methodical-0.15.1.jar"" ""/Users/a4532252/.m2/repository/metosin/malli/0.16.3/malli-0.16.3.jar"" ""/Users/a4532252/.m2/repository/metosin/schema-tools/0.12.3/schema-tools-0.12.3.jar"" ""/Users/a4532252/.m2/repository/metosin/spec-tools/0.10.5/spec-tools-0.10.5.jar"" ""/Users/a4532252/.m2/repository/mvxcvi/arrangement/2.1.0/arrangement-2.1.0.jar"" ""/Users/a4532252/.m2/repository/mvxcvi/puget/1.3.4/puget-1.3.4.jar"" ""/Users/a4532252/.m2/repository/nano-id/nano-id/1.1.0/nano-id-1.1.0.jar"" ""/Users/a4532252/.m2/repository/net/bytebuddy/byte-buddy/1.14.9/byte-buddy-1.14.9.jar"" ""/Users/a4532252/.m2/repository/net/cgrand/macrovich/0.2.2/macrovich-0.2.2.jar"" ""/Users/a4532252/.m2/repository/net/clojars/wkok/openai-clojure/0.16.0/openai-clojure-0.16.0.jar"" ""/Users/a4532252/.m2/repository/net/i2p/crypto/eddsa/0.3.0/eddsa-0.3.0.jar"" ""/Users/a4532252/.m2/repository/net/redhogs/cronparser/cron-parser-core/3.5/cron-parser-core-3.5.jar"" ""/Users/a4532252/.m2/repository/net/sf/cssbox/cssbox/5.0.1/cssbox-5.0.1.jar"" ""/Users/a4532252/.m2/repository/net/sf/cssbox/jstyleparser/4.0.0/jstyleparser-4.0.0.jar"" ""/Users/a4532252/.m2/repository/net/sf/qualitycheck/quality-check/1.3/quality-check-1.3.jar"" ""/Users/a4532252/.m2/repository/net/sf/uadetector/uadetector-core/0.9.22/uadetector-core-0.9.22.jar"" ""/Users/a4532252/.m2/repository/net/sf/uadetector/uadetector-resources/2014.10/uadetector-resources-2014.10.jar"" ""/Users/a4532252/.m2/repository/net/shibboleth/utilities/java-support/8.3.1/java-support-8.3.1.jar"" ""/Users/a4532252/.m2/repository/net/thisptr/jackson-jq/1.0.0-preview.20240207/jackson-jq-1.0.0-preview.20240207.jar"" ""/Users/a4532252/.m2/repository/noencore/noencore/0.3.7/noencore-0.3.7.jar"" ""/Users/a4532252/.m2/repository/org/antlr/antlr4-runtime/4.5.3/antlr4-runtime-4.5.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-compress/1.26.1/commons-compress-1.26.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-fileupload2-core/2.0.0-M1/commons-fileupload2-core-2.0.0-M1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-lang3/3.14.0/commons-lang3-3.14.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-text/1.11.0/commons-text-1.11.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpasyncclient/4.1.4/httpasyncclient-4.1.4.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpclient-cache/4.5.13/httpclient-cache-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpcore-nio/4.4.10/httpcore-nio-4.4.10.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpmime/4.5.13/httpmime-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.23.1/log4j-1.2-api-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-api/2.23.1/log4j-api-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-core/2.23.1/log4j-core-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-jcl/2.23.1/log4j-jcl-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-jul/2.23.1/log4j-jul-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-layout-template-json/2.23.1/log4j-layout-template-json-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-slf4j2-impl/2.23.1/log4j-slf4j2-impl-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi-ooxml-lite/5.2.5/poi-ooxml-lite-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi-ooxml/5.2.5/poi-ooxml-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi/5.2.5/poi-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/santuario/xmlsec/3.0.3/xmlsec-3.0.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/sshd/sshd-common/2.12.1/sshd-common-2.12.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/sshd/sshd-core/2.12.1/sshd-core-2.12.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/tika/tika-core/2.9.2/tika-core-2.9.2.jar"" ""/Users/a4532252/.m2/repository/org/apache/velocity/velocity-engine-core/2.3/velocity-engine-core-2.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlbeans/xmlbeans/5.2.0/xmlbeans-5.2.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlgraphics/batik-all/1.17/batik-all-1.17.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlgraphics/xmlgraphics-commons/2.9/xmlgraphics-commons-2.9.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcpkix-jdk18on/1.78/bcpkix-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcprov-jdk18on/1.78/bcprov-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcutil-jdk18on/1.78/bcutil-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/checkerframework/checker-qual/3.42.0/checker-qual-3.42.0.jar"" ""/Users/a4532252/.m2/repository/org/clj-commons/claypoole/1.2.2/claypoole-1.2.2.jar"" ""/Users/a4532252/.m2/repository/org/clj-commons/hickory/0.7.4/hickory-0.7.4.jar"" ""/Users/a4532252/.m2/repository/org/clojars/pntblnk/clj-ldap/0.0.17/clj-ldap-0.0.17.jar"" ""/Users/a4532252/.m2/repository/org/clojure/clojure/1.11.2/clojure-1.11.2.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.async/1.6.681/core.async-1.6.681.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.cache/1.1.234/core.cache-1.1.234.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.logic/1.1.0/core.logic-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.match/1.1.0/core.match-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.memoize/1.1.266/core.memoize-1.1.266.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.rrb-vector/0.1.2/core.rrb-vector-0.1.2.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.specs.alpha/0.2.62/core.specs.alpha-0.2.62.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.csv/1.1.0/data.csv-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.priority-map/1.2.0/data.priority-map-1.2.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.xml/0.0.8/data.xml-0.0.8.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.classpath/1.1.0/java.classpath-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.data/1.2.107/java.data-1.2.107.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.jdbc/0.7.12/java.jdbc-0.7.12.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.jmx/1.1.0/java.jmx-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/math.combinatorics/0.3.0/math.combinatorics-0.3.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/math.numeric-tower/0.1.0/math.numeric-tower-0.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/spec.alpha/0.3.218/spec.alpha-0.3.218.jar"" ""/Users/a4532252/.m2/repository/org/clojure/test.check/1.1.1/test.check-1.1.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.analyzer.jvm/1.2.3/tools.analyzer.jvm-1.2.3.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.analyzer/1.1.1/tools.analyzer-1.1.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.cli/1.1.230/tools.cli-1.1.230.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.logging/1.3.0/tools.logging-1.3.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.macro/0.2.0/tools.macro-0.2.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.namespace/1.5.0/tools.namespace-1.5.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.reader/1.4.1/tools.reader-1.4.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.trace/0.8.0/tools.trace-0.8.0.jar"" ""/Users/a4532252/.m2/repository/org/codehaus/woodstox/stax2-api/4.2.2/stax2-api-4.2.2.jar"" ""/Users/a4532252/.m2/repository/org/codelibs/nekohtml/2.0.2/nekohtml-2.0.2.jar"" ""/Users/a4532252/.m2/repository/org/codelibs/xerces/xercesImpl/2.12.0-sp1/xercesImpl-2.12.0-sp1.jar"" ""/Users/a4532252/.m2/repository/org/cryptacular/cryptacular/1.2.5/cryptacular-1.2.5.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-http/11.0.20/jetty-http-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-io/11.0.20/jetty-io-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-security/11.0.20/jetty-security-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-server/11.0.20/jetty-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-servlet/11.0.20/jetty-servlet-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-util/11.0.20/jetty-util-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-webapp/11.0.20/jetty-webapp-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-xml/11.0.20/jetty-xml-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/toolchain/jetty-jakarta-servlet-api/5.0.2/jetty-jakarta-servlet-api-5.0.2.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-core-common/11.0.20/websocket-core-common-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-core-server/11.0.20/websocket-core-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-api/11.0.20/websocket-jetty-api-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-common/11.0.20/websocket-jetty-common-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-server/11.0.20/websocket-jetty-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/11.0.20/websocket-servlet-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/flatland/ordered/1.15.11/ordered-1.15.11.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/js/js/22.3.5/js-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/regex/regex/22.3.5/regex-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/sdk/graal-sdk/22.3.5/graal-sdk-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/truffle/truffle-api/22.3.5/truffle-api-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/javassist/javassist/3.18.1-GA/javassist-3.18.1-GA.jar"" ""/Users/a4532252/.m2/repository/org/jetbrains/annotations/24.0.1/annotations-24.0.1.jar"" ""/Users/a4532252/.m2/repository/org/jruby/jcodings/jcodings/1.0.58/jcodings-1.0.58.jar"" ""/Users/a4532252/.m2/repository/org/jruby/joni/joni/2.2.1/joni-2.2.1.jar"" ""/Users/a4532252/.m2/repository/org/jsoup/jsoup/1.17.2/jsoup-1.17.2.jar"" ""/Users/a4532252/.m2/repository/org/liquibase/liquibase-core/4.26.0/liquibase-core-4.26.0.jar"" ""/Users/a4532252/.m2/repository/org/mariadb/jdbc/mariadb-java-client/2.7.10/mariadb-java-client-2.7.10.jar"" ""/Users/a4532252/.m2/repository/org/mindrot/jbcrypt/0.4/jbcrypt-0.4.jar"" ""/Users/a4532252/.m2/repository/org/msgpack/msgpack/0.6.12/msgpack-0.6.12.jar"" ""/Users/a4532252/.m2/repository/org/nibor/autolink/autolink/0.6.0/autolink-0.6.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-core/4.2.0/opensaml-core-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-messaging-api/4.2.0/opensaml-messaging-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-profile-api/4.2.0/opensaml-profile-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-saml-api/4.2.0/opensaml-saml-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-saml-impl/4.2.0/opensaml-saml-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-security-api/4.2.0/opensaml-security-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-security-impl/4.2.0/opensaml-security-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-soap-api/4.2.0/opensaml-soap-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-soap-impl/4.2.0/opensaml-soap-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-storage-api/4.2.0/opensaml-storage-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-xmlsec-api/4.2.0/opensaml-xmlsec-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-xmlsec-impl/4.2.0/opensaml-xmlsec-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/ow2/asm/asm/9.2/asm-9.2.jar"" ""/Users/a4532252/.m2/repository/org/postgresql/postgresql/42.7.3/postgresql-42.7.3.jar"" ""/Users/a4532252/.m2/repository/org/quartz-scheduler/quartz/2.3.2/quartz-2.3.2.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-core-protocols/1.12.0/ring-core-protocols-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-jakarta-servlet/1.12.0/ring-jakarta-servlet-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-websocket-protocols/1.12.0/ring-websocket-protocols-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/slf4j/slf4j-api/2.0.12/slf4j-api-2.0.12.jar"" ""/Users/a4532252/.m2/repository/org/tcrawley/dynapath/1.1.0/dynapath-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/threeten/threeten-extra/1.7.2/threeten-extra-1.7.2.jar"" ""/Users/a4532252/.m2/repository/org/tukaani/xz/1.9/xz-1.9.jar"" ""/Users/a4532252/.m2/repository/org/unbescape/unbescape/1.1.6.RELEASE/unbescape-1.1.6.RELEASE.jar"" ""/Users/a4532252/.m2/repository/org/yaml/snakeyaml/2.2/snakeyaml-2.2.jar"" ""/Users/a4532252/.m2/repository/potemkin/potemkin/0.4.7/potemkin-0.4.7.jar"" ""/Users/a4532252/.m2/repository/pretty/pretty/1.0.5/pretty-1.0.5.jar"" ""/Users/a4532252/.m2/repository/prismatic/schema/1.1.12/schema-1.1.12.jar"" ""/Users/a4532252/.m2/repository/quoin/quoin/0.1.2/quoin-0.1.2.jar"" ""/Users/a4532252/.m2/repository/redux/redux/0.1.4/redux-0.1.4.jar"" ""/Users/a4532252/.m2/repository/riddley/riddley/0.2.0/riddley-0.2.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-codec/1.2.0/ring-codec-1.2.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-core/1.12.0/ring-core-1.12.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-jetty-adapter/1.12.0/ring-jetty-adapter-1.12.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-json/0.5.1/ring-json-0.5.1.jar"" ""/Users/a4532252/.m2/repository/scout/scout/0.1.0/scout-0.1.0.jar"" ""/Users/a4532252/.m2/repository/slingshot/slingshot/0.12.2/slingshot-0.12.2.jar"" ""/Users/a4532252/.m2/repository/stencil/stencil/0.5.0/stencil-0.5.0.jar"" ""/Users/a4532252/.m2/repository/tigris/tigris/0.1.2/tigris-0.1.2.jar"" ""/Users/a4532252/.m2/repository/user-agent/user-agent/0.1.1/user-agent-0.1.1.jar"" ""/Users/a4532252/.m2/repository/weavejester/dependency/0.2.1/dependency-0.2.1.jar"" ""/Users/a4532252/.m2/repository/xml-apis/xml-apis-ext/1.3.04/xml-apis-ext-1.3.04.jar"" ""/Users/a4532252/.m2/repository/xml-apis/xml-apis/1.4.01/xml-apis-1.4.01.jar"" ""resources"" ""src"")}\r\n[backend] \tat metabase.plugins.classloader$require_STAR_.invokeStatic(classloader.clj:132)\r\n[backend] \tat metabase.plugins.classloader$require_STAR_.doInvoke(classloader.clj:116)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:408)\r\n[backend] \tat metabase.plugins.classloader$require.invokeStatic(classloader.clj:151)\r\n[backend] \tat metabase.plugins.classloader$require.invoke(classloader.clj:138)\r\n[backend] \tat clojure.lang.AFn.applyToHelper(AFn.java:154)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:669)\r\n[backend] \tat clojure.core$apply.invoke(core.clj:662)\r\n[backend] \tat metabase.driver.impl$require_driver_ns.invokeStatic(impl.clj:77)\r\n[backend] \t... 53 more\r\n[backend] Caused by: java.io.FileNotFoundException: Could not locate metabase/driver/hive_like__init.class, metabase/driver/hive_like.clj or metabase/driver/hive_like.cljc on classpath. Please check that namespaces with dashes use underscores in the Clojure file name.\r\n[backend] \tat clojure.lang.RT.load(RT.java:462)\r\n[backend] \tat clojure.lang.RT.load(RT.java:424)\r\n[backend] \tat clojure.core$load$fn__6908.invoke(core.clj:6162)\r\n[backend] \tat clojure.core$load.invokeStatic(core.clj:6161)\r\n[backend] \tat clojure.core$load.doInvoke(core.clj:6145)\r\n[backend] \tat clojure.lang.RestFn.invoke(RestFn.java:408)\r\n[backend] \tat clojure.core$load_one.invokeStatic(core.clj:5934)\r\n[backend] \tat clojure.core$load_one.invoke(core.clj:5929)\r\n[backend] \tat clojure.core$load_lib$fn__6850.invoke(core.clj:5976)\r\n[backend] \tat clojure.core$load_lib.invokeStatic(core.clj:5975)\r\n[backend] \tat clojure.core$load_lib.doInvoke(core.clj:5954)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:142)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:669)\r\n[backend] \tat clojure.core$load_libs.invokeStatic(core.clj:6017)\r\n[backend] \tat clojure.core$load_libs.doInvoke(core.clj:6001)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:137)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:669)\r\n[backend] \tat clojure.core$require.invokeStatic(core.clj:6039)\r\n[backend] \tat clojure.core$require.doInvoke(core.clj:6039)\r\n[backend] \tat clojure.lang.RestFn.applyTo(RestFn.java:137)\r\n[backend] \tat clojure.core$apply.invokeStatic(core.clj:667)\r\n[backend] \tat clojure.core$apply.invoke(core.clj:662)\r\n\tat metabase.plugins.classloader$require_STAR_.invokeStatic(classloader.clj:130)\r\n[backend] \t... 62 more', 'created_at': datetime.datetime(2024, 8, 29, 15, 12, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2318278535, 'issue_id': 2349449083, 'author': 'lbrdnk', 'body': ""Oh, I see. Using `yarn dev` starts Metabase without the `:drivers` `deps.edn` alias. I'm running the app differently for the development purposes, but I believe doing the following would resolve the problem.\r\n\r\nEdit the `package.json`, the `dev` script (line 371), modifying `'clojure -M:run'` to `'clojure -M:run:drivers'`.\r\n\r\nStarting the app with `yarn dev`, with the change in place, I was able to add Databricks database successfully. I also did `bin/build-drivers.sh` prior to that.\r\n\r\n(The logged exception should be resolved with the commit I've pushed now :))"", 'created_at': datetime.datetime(2024, 8, 29, 16, 19, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2318348380, 'issue_id': 2349449083, 'author': 'jschwendt', 'body': ""That worked like a champ!  I'm in and able to do everything as I would expect!  Thank you so much!!!"", 'created_at': datetime.datetime(2024, 8, 29, 16, 47, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2498049473, 'issue_id': 2349449083, 'author': 'lbrdnk', 'body': 'Closing as all items have been completed.', 'created_at': datetime.datetime(2024, 11, 25, 13, 39, 5, tzinfo=datetime.timezone.utc)}]","jschwendt on (2024-08-22 19:44:04 UTC): I tried the databricks-hive-like branch and ran into an issue when attempting to connect to Azure hosted Databricks.
Steps to reproduce:
1. bin/build-drivers.sh
2. yarn dev
3. Add connection in frontend and click ""Save"" button.  Got an error that hive_like class wasn't found
4. Copied the hive_like.clj and hive_like folder (with contents) to the same folder under databricks-jdbc
5. bin/build-drivers.sh 
6. yarn dev

Got the attached error in the console (included everything from the second run of ""yarn dev"" so you can see the full env).

Happy to help debug this with you as I'm trying my best to make it work.  I know it's not ready for prime time yet, but thought the early testing could be a help.
[console.txt](https://github.com/user-attachments/files/16716825/console.txt)

jschwendt on (2024-08-26 15:24:52 UTC): @lbrdnk do you have any suggestions?

lbrdnk (Issue Creator) on (2024-08-28 17:43:30 UTC): Hey @jschwendt. Thank you for ""trying out"" the driver, development is still in progress :)

Reading through the log you posted I see 2 main issues. 

1. Exception on logging that starts at line 329. I'm aware of this one and I'm trying to address that. This one seems not to affect the driver functionality.
2. Exception related to database connection at line 2936. I haven't encountered this one before. What version of java are you using? Would you be able to confirm whether it occurs using java 11?

Also, please use the [databricks-jdbc](https://github.com/metabase/metabase/tree/databricks-jdbc) branch that contains latest development.

jschwendt on (2024-08-29 15:12:13 UTC): Thanks @lbrdnk!  I was running openjdk 22 on Macos previously.  I just pulled your latest changes from the databricks-jdbc branch and ran it under openjdk 11.  Note that I ran into the same issue as before where I ran ""bin/build-drivers.sh"" followed by ""yarn dev"" and got the following error on startup.  To resolve this last time, I had to copy the hive files over from the sqlspark driver using the following command:
cp -R modules/drivers/sparksql/src/metabase/driver/hive_like* modules/drivers/databricks-jdbc/src/metabase/driver

That said, it didn't work this time.  Here's the error I got on startup:
[backend] 2024-08-29 10:29:11,454 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :databricks-jdbc...
[backend] 2024-08-29 10:29:11,456 ERROR driver.impl :: Error loading driver namespace
clojure.lang.ExceptionInfo: Could not locate metabase/driver/hive_like__init.class, metabase/driver/hive_like.clj or metabase/driver/hive_like.cljc on classpath. Please check that namespaces with dashes use underscores in the Clojure file name. {:classloader #object[clojure.lang.DynamicClassLoader 0x1538d8e5 ""clojure.lang.DynamicClassLoader@1538d8e5""], :classpath-urls (), :system-classpath (""/Users/a4532252/.gitlibs/libs/io.github.eerohele/pp/a4287519bdbddaf25e4e480a73caa8055f375b48/src"" ""/Users/a4532252/.m2/repository/amalloy/ring-buffer/1.3.1/ring-buffer-1.3.1.jar"" ""/Users/a4532252/.m2/repository/amalloy/ring-gzip-middleware/0.1.4/ring-gzip-middleware-0.1.4.jar"" ""/Users/a4532252/.m2/repository/babashka/fs/0.5.20/fs-0.5.20.jar"" ""/Users/a4532252/.m2/repository/better-cond/better-cond/2.1.5/better-cond-2.1.5.jar"" ""/Users/a4532252/.m2/repository/bigml/histogram/4.1.4/histogram-4.1.4.jar"" ""/Users/a4532252/.m2/repository/borkdude/dynaload/0.3.5/dynaload-0.3.5.jar"" ""/Users/a4532252/.m2/repository/borkdude/edamame/1.4.25/edamame-1.4.25.jar"" ""/Users/a4532252/.m2/repository/buddy/buddy-core/1.11.423/buddy-core-1.11.423.jar"" ""/Users/a4532252/.m2/repository/buddy/buddy-sign/3.5.351/buddy-sign-3.5.351.jar"" ""/Users/a4532252/.m2/repository/camel-snake-kebab/camel-snake-kebab/0.4.3/camel-snake-kebab-0.4.3.jar"" ""/Users/a4532252/.m2/repository/cheshire/cheshire/5.12.0/cheshire-5.12.0.jar"" ""/Users/a4532252/.m2/repository/clj-bom/clj-bom/0.1.2/clj-bom-0.1.2.jar"" ""/Users/a4532252/.m2/repository/clj-commons/clj-yaml/1.0.27/clj-yaml-1.0.27.jar"" ""/Users/a4532252/.m2/repository/clj-commons/iapetos/0.1.13/iapetos-0.1.13.jar"" ""/Users/a4532252/.m2/repository/clj-http/clj-http/3.12.3/clj-http-3.12.3.jar"" ""/Users/a4532252/.m2/repository/clj-time/clj-time/0.15.2/clj-time-0.15.2.jar"" ""/Users/a4532252/.m2/repository/clojure/java-time/clojure.java-time/1.4.2/clojure.java-time-1.4.2.jar"" ""/Users/a4532252/.m2/repository/clojurewerkz/quartzite/2.2.0/quartzite-2.2.0.jar"" ""/Users/a4532252/.m2/repository/clout/clout/2.2.1/clout-2.2.1.jar"" ""/Users/a4532252/.m2/repository/colorize/colorize/0.1.1/colorize-0.1.1.jar"" ""/Users/a4532252/.m2/repository/com/andrewmcveigh/cljs-time/0.5.2/cljs-time-0.5.2.jar"" ""/Users/a4532252/.m2/repository/com/clearspring/analytics/stream/2.9.8/stream-2.9.8.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-clj/1.0.324/transit-clj-1.0.324.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-cljs/0.8.269/transit-cljs-0.8.269.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-java/1.0.343/transit-java-1.0.343.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-js/0.8.874/transit-js-0.8.874.jar"" ""/Users/a4532252/.m2/repository/com/draines/postal/2.0.5/postal-2.0.5.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.17.0/jackson-annotations-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.17.0/jackson-core-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.17.0/jackson-databind-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-cbor/2.15.2/jackson-dataformat-cbor-2.15.2.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-smile/2.15.2/jackson-dataformat-smile-2.15.2.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/woodstox/woodstox-core/6.6.1/woodstox-core-6.6.1.jar"" ""/Users/a4532252/.m2/repository/com/gfredericks/test.chuck/0.2.14/test.chuck-0.2.14.jar"" ""/Users/a4532252/.m2/repository/com/github/jsqlparser/jsqlparser/4.9/jsqlparser-4.9.jar"" ""/Users/a4532252/.m2/repository/com/github/oliyh/martian-hato/0.1.24/martian-hato-0.1.24.jar"" ""/Users/a4532252/.m2/repository/com/github/oliyh/martian/0.1.24/martian-0.1.24.jar"" ""/Users/a4532252/.m2/repository/com/github/seancorfield/honeysql/2.6.1126/honeysql-2.6.1126.jar"" ""/Users/a4532252/.m2/repository/com/github/seancorfield/next.jdbc/1.3.925/next.jdbc-1.3.925.jar"" ""/Users/a4532252/.m2/repository/com/github/steffan-westcott/clj-otel-api/0.2.6/clj-otel-api-0.2.6.jar"" ""/Users/a4532252/.m2/repository/com/github/vertical-blank/sql-formatter/2.0.4/sql-formatter-2.0.4.jar"" ""/Users/a4532252/.m2/repository/com/github/virtuald/curvesapi/1.08/curvesapi-1.08.jar"" ""/Users/a4532252/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar"" ""/Users/a4532252/.m2/repository/com/google/errorprone/error_prone_annotations/2.26.1/error_prone_annotations-2.26.1.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/failureaccess/1.0.2/failureaccess-1.0.2.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/guava/33.1.0-jre/guava-33.1.0-jre.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar"" ""/Users/a4532252/.m2/repository/com/google/j2objc/j2objc-annotations/3.0.0/j2objc-annotations-3.0.0.jar"" ""/Users/a4532252/.m2/repository/com/googlecode/json-simple/json-simple/1.1.1/json-simple-1.1.1.jar"" ""/Users/a4532252/.m2/repository/com/h2database/h2/2.1.214/h2-2.1.214.jar"" ""/Users/a4532252/.m2/repository/com/ibm/icu/icu4j/71.1/icu4j-71.1.jar"" ""/Users/a4532252/.m2/repository/com/mchange/c3p0/0.9.5.5/c3p0-0.9.5.5.jar"" ""/Users/a4532252/.m2/repository/com/mchange/mchange-commons-java/0.2.19/mchange-commons-java-0.2.19.jar"" ""/Users/a4532252/.m2/repository/com/onelogin/java-saml-core/2.9.0/java-saml-core-2.9.0.jar"" ""/Users/a4532252/.m2/repository/com/onelogin/java-saml/2.9.0/java-saml-2.9.0.jar"" ""/Users/a4532252/.m2/repository/com/opencsv/opencsv/5.9/opencsv-5.9.jar"" ""/Users/a4532252/.m2/repository/com/snowplowanalytics/snowplow-java-tracker/1.0.1/snowplow-java-tracker-1.0.1.jar"" ""/Users/a4532252/.m2/repository/com/sun/activation/jakarta.activation/1.2.1/jakarta.activation-1.2.1.jar"" ""/Users/a4532252/.m2/repository/com/sun/mail/jakarta.mail/1.6.5/jakarta.mail-1.6.5.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/encore/3.112.0/encore-3.112.0.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/nippy/3.4.2/nippy-3.4.2.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/truss/1.11.0/truss-1.11.0.jar"" ""/Users/a4532252/.m2/repository/com/tdunning/t-digest/3.2/t-digest-3.2.jar"" ""/Users/a4532252/.m2/repository/com/unboundid/unboundid-ldapsdk/5.1.1/unboundid-ldapsdk-5.1.1.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-ext-autolink/0.64.8/flexmark-ext-autolink-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-ast/0.64.8/flexmark-util-ast-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-builder/0.64.8/flexmark-util-builder-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-collection/0.64.8/flexmark-util-collection-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-data/0.64.8/flexmark-util-data-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-dependency/0.64.8/flexmark-util-dependency-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-format/0.64.8/flexmark-util-format-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-html/0.64.8/flexmark-util-html-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-misc/0.64.8/flexmark-util-misc-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-options/0.64.8/flexmark-util-options-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-sequence/0.64.8/flexmark-util-sequence-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-visitor/0.64.8/flexmark-util-visitor-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util/0.64.8/flexmark-util-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark/0.64.8/flexmark-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/zaxxer/HikariCP-java7/2.4.13/HikariCP-java7-2.4.13.jar"" ""/Users/a4532252/.m2/repository/com/zaxxer/SparseBitSet/1.3/SparseBitSet-1.3.jar"" ""/Users/a4532252/.m2/repository/commons-codec/commons-codec/1.16.1/commons-codec-1.16.1.jar"" ""/Users/a4532252/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar"" ""/Users/a4532252/.m2/repository/commons-fileupload/commons-fileupload/1.5/commons-fileupload-1.5.jar"" ""/Users/a4532252/.m2/repository/commons-io/commons-io/2.15.1/commons-io-2.15.1.jar"" ""/Users/a4532252/.m2/repository/commons-logging/commons-logging/1.3.0/commons-logging-1.3.0.jar"" ""/Users/a4532252/.m2/repository/commons-net/commons-net/3.10.0/commons-net-3.10.0.jar"" ""/Users/a4532252/.m2/repository/commons-validator/commons-validator/1.8.0/commons-validator-1.8.0.jar"" ""/Users/a4532252/.m2/repository/compojure/compojure/1.7.1/compojure-1.7.1.jar"" ""/Users/a4532252/.m2/repository/crypto-equality/crypto-equality/1.0.1/crypto-equality-1.0.1.jar"" ""/Users/a4532252/.m2/repository/crypto-random/crypto-random/1.2.1/crypto-random-1.2.1.jar"" ""/Users/a4532252/.m2/repository/dk/ative/docjure/1.19.0/docjure-1.19.0.jar"" ""/Users/a4532252/.m2/repository/environ/environ/1.2.0/environ-1.2.0.jar"" ""/Users/a4532252/.m2/repository/fipp/fipp/0.6.26/fipp-0.6.26.jar"" ""/Users/a4532252/.m2/repository/frankiesardo/tripod/0.2.0/tripod-0.2.0.jar"" ""/Users/a4532252/.m2/repository/hato/hato/0.8.2/hato-0.8.2.jar"" ""/Users/a4532252/.m2/repository/hiccup/hiccup/1.0.5/hiccup-1.0.5.jar"" ""/Users/a4532252/.m2/repository/inflections/inflections/0.14.1/inflections-0.14.1.jar"" ""/Users/a4532252/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar"" ""/Users/a4532252/.m2/repository/io/airlift/aircompressor/0.27/aircompressor-0.27.jar"" ""/Users/a4532252/.m2/repository/io/dropwizard/metrics/metrics-core/4.2.9/metrics-core-4.2.9.jar"" ""/Users/a4532252/.m2/repository/io/github/camsaul/toucan2/1.0.538/toucan2-1.0.538.jar"" ""/Users/a4532252/.m2/repository/io/github/metabase/macaw/0.2.6/macaw-0.2.6.jar"" ""/Users/a4532252/.m2/repository/io/github/resilience4j/resilience4j-core/1.7.1/resilience4j-core-1.7.1.jar"" ""/Users/a4532252/.m2/repository/io/github/resilience4j/resilience4j-retry/1.7.1/resilience4j-retry-1.7.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/opentelemetry-api/1.34.1/opentelemetry-api-1.34.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/opentelemetry-context/1.34.1/opentelemetry-context-1.34.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/semconv/opentelemetry-semconv/1.23.1-alpha/opentelemetry-semconv-1.23.1-alpha.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_common/0.12.0/simpleclient_common-0.12.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_pushgateway/0.12.0/simpleclient_pushgateway-0.12.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/vavr/vavr-match/0.10.2/vavr-match-0.10.2.jar"" ""/Users/a4532252/.m2/repository/io/vavr/vavr/0.10.2/vavr-0.10.2.jar"" ""/Users/a4532252/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/3.0.1/jakarta.xml.bind-api-3.0.1.jar"" ""/Users/a4532252/.m2/repository/javax/annotation/jsr250-api/1.0/jsr250-api-1.0.jar"" ""/Users/a4532252/.m2/repository/javax/servlet/servlet-api/2.5/servlet-api-2.5.jar"" ""/Users/a4532252/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar"" ""/Users/a4532252/.m2/repository/joda-time/joda-time/2.10.6/joda-time-2.10.6.jar"" ""/Users/a4532252/.m2/repository/junegunn/grouper/0.1.1/grouper-0.1.1.jar"" ""/Users/a4532252/.m2/repository/kixi/stats/0.5.5/stats-0.5.5.jar"" ""/Users/a4532252/.m2/repository/lambdaisland/uri/1.19.155/uri-1.19.155.jar"" ""/Users/a4532252/.m2/repository/medley/medley/1.4.0/medley-1.4.0.jar"" ""/Users/a4532252/.m2/repository/metabase/connection-pool/1.2.0/connection-pool-1.2.0.jar"" ""/Users/a4532252/.m2/repository/metabase/saml20-clj/2.2.7.172/saml20-clj-2.2.7.172.jar"" ""/Users/a4532252/.m2/repository/metabase/throttle/1.0.2/throttle-1.0.2.jar"" ""/Users/a4532252/.m2/repository/methodical/methodical/0.15.1/methodical-0.15.1.jar"" ""/Users/a4532252/.m2/repository/metosin/malli/0.16.3/malli-0.16.3.jar"" ""/Users/a4532252/.m2/repository/metosin/schema-tools/0.12.3/schema-tools-0.12.3.jar"" ""/Users/a4532252/.m2/repository/metosin/spec-tools/0.10.5/spec-tools-0.10.5.jar"" ""/Users/a4532252/.m2/repository/mvxcvi/arrangement/2.1.0/arrangement-2.1.0.jar"" ""/Users/a4532252/.m2/repository/mvxcvi/puget/1.3.4/puget-1.3.4.jar"" ""/Users/a4532252/.m2/repository/nano-id/nano-id/1.1.0/nano-id-1.1.0.jar"" ""/Users/a4532252/.m2/repository/net/bytebuddy/byte-buddy/1.14.9/byte-buddy-1.14.9.jar"" ""/Users/a4532252/.m2/repository/net/cgrand/macrovich/0.2.2/macrovich-0.2.2.jar"" ""/Users/a4532252/.m2/repository/net/clojars/wkok/openai-clojure/0.16.0/openai-clojure-0.16.0.jar"" ""/Users/a4532252/.m2/repository/net/i2p/crypto/eddsa/0.3.0/eddsa-0.3.0.jar"" ""/Users/a4532252/.m2/repository/net/redhogs/cronparser/cron-parser-core/3.5/cron-parser-core-3.5.jar"" ""/Users/a4532252/.m2/repository/net/sf/cssbox/cssbox/5.0.1/cssbox-5.0.1.jar"" ""/Users/a4532252/.m2/repository/net/sf/cssbox/jstyleparser/4.0.0/jstyleparser-4.0.0.jar"" ""/Users/a4532252/.m2/repository/net/sf/qualitycheck/quality-check/1.3/quality-check-1.3.jar"" ""/Users/a4532252/.m2/repository/net/sf/uadetector/uadetector-core/0.9.22/uadetector-core-0.9.22.jar"" ""/Users/a4532252/.m2/repository/net/sf/uadetector/uadetector-resources/2014.10/uadetector-resources-2014.10.jar"" ""/Users/a4532252/.m2/repository/net/shibboleth/utilities/java-support/8.3.1/java-support-8.3.1.jar"" ""/Users/a4532252/.m2/repository/net/thisptr/jackson-jq/1.0.0-preview.20240207/jackson-jq-1.0.0-preview.20240207.jar"" ""/Users/a4532252/.m2/repository/noencore/noencore/0.3.7/noencore-0.3.7.jar"" ""/Users/a4532252/.m2/repository/org/antlr/antlr4-runtime/4.5.3/antlr4-runtime-4.5.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-compress/1.26.1/commons-compress-1.26.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-fileupload2-core/2.0.0-M1/commons-fileupload2-core-2.0.0-M1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-lang3/3.14.0/commons-lang3-3.14.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-text/1.11.0/commons-text-1.11.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpasyncclient/4.1.4/httpasyncclient-4.1.4.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpclient-cache/4.5.13/httpclient-cache-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpcore-nio/4.4.10/httpcore-nio-4.4.10.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpmime/4.5.13/httpmime-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.23.1/log4j-1.2-api-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-api/2.23.1/log4j-api-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-core/2.23.1/log4j-core-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-jcl/2.23.1/log4j-jcl-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-jul/2.23.1/log4j-jul-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-layout-template-json/2.23.1/log4j-layout-template-json-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-slf4j2-impl/2.23.1/log4j-slf4j2-impl-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi-ooxml-lite/5.2.5/poi-ooxml-lite-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi-ooxml/5.2.5/poi-ooxml-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi/5.2.5/poi-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/santuario/xmlsec/3.0.3/xmlsec-3.0.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/sshd/sshd-common/2.12.1/sshd-common-2.12.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/sshd/sshd-core/2.12.1/sshd-core-2.12.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/tika/tika-core/2.9.2/tika-core-2.9.2.jar"" ""/Users/a4532252/.m2/repository/org/apache/velocity/velocity-engine-core/2.3/velocity-engine-core-2.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlbeans/xmlbeans/5.2.0/xmlbeans-5.2.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlgraphics/batik-all/1.17/batik-all-1.17.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlgraphics/xmlgraphics-commons/2.9/xmlgraphics-commons-2.9.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcpkix-jdk18on/1.78/bcpkix-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcprov-jdk18on/1.78/bcprov-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcutil-jdk18on/1.78/bcutil-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/checkerframework/checker-qual/3.42.0/checker-qual-3.42.0.jar"" ""/Users/a4532252/.m2/repository/org/clj-commons/claypoole/1.2.2/claypoole-1.2.2.jar"" ""/Users/a4532252/.m2/repository/org/clj-commons/hickory/0.7.4/hickory-0.7.4.jar"" ""/Users/a4532252/.m2/repository/org/clojars/pntblnk/clj-ldap/0.0.17/clj-ldap-0.0.17.jar"" ""/Users/a4532252/.m2/repository/org/clojure/clojure/1.11.2/clojure-1.11.2.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.async/1.6.681/core.async-1.6.681.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.cache/1.1.234/core.cache-1.1.234.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.logic/1.1.0/core.logic-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.match/1.1.0/core.match-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.memoize/1.1.266/core.memoize-1.1.266.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.rrb-vector/0.1.2/core.rrb-vector-0.1.2.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.specs.alpha/0.2.62/core.specs.alpha-0.2.62.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.csv/1.1.0/data.csv-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.priority-map/1.2.0/data.priority-map-1.2.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.xml/0.0.8/data.xml-0.0.8.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.classpath/1.1.0/java.classpath-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.data/1.2.107/java.data-1.2.107.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.jdbc/0.7.12/java.jdbc-0.7.12.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.jmx/1.1.0/java.jmx-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/math.combinatorics/0.3.0/math.combinatorics-0.3.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/math.numeric-tower/0.1.0/math.numeric-tower-0.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/spec.alpha/0.3.218/spec.alpha-0.3.218.jar"" ""/Users/a4532252/.m2/repository/org/clojure/test.check/1.1.1/test.check-1.1.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.analyzer.jvm/1.2.3/tools.analyzer.jvm-1.2.3.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.analyzer/1.1.1/tools.analyzer-1.1.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.cli/1.1.230/tools.cli-1.1.230.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.logging/1.3.0/tools.logging-1.3.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.macro/0.2.0/tools.macro-0.2.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.namespace/1.5.0/tools.namespace-1.5.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.reader/1.4.1/tools.reader-1.4.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.trace/0.8.0/tools.trace-0.8.0.jar"" ""/Users/a4532252/.m2/repository/org/codehaus/woodstox/stax2-api/4.2.2/stax2-api-4.2.2.jar"" ""/Users/a4532252/.m2/repository/org/codelibs/nekohtml/2.0.2/nekohtml-2.0.2.jar"" ""/Users/a4532252/.m2/repository/org/codelibs/xerces/xercesImpl/2.12.0-sp1/xercesImpl-2.12.0-sp1.jar"" ""/Users/a4532252/.m2/repository/org/cryptacular/cryptacular/1.2.5/cryptacular-1.2.5.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-http/11.0.20/jetty-http-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-io/11.0.20/jetty-io-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-security/11.0.20/jetty-security-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-server/11.0.20/jetty-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-servlet/11.0.20/jetty-servlet-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-util/11.0.20/jetty-util-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-webapp/11.0.20/jetty-webapp-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-xml/11.0.20/jetty-xml-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/toolchain/jetty-jakarta-servlet-api/5.0.2/jetty-jakarta-servlet-api-5.0.2.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-core-common/11.0.20/websocket-core-common-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-core-server/11.0.20/websocket-core-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-api/11.0.20/websocket-jetty-api-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-common/11.0.20/websocket-jetty-common-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-server/11.0.20/websocket-jetty-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/11.0.20/websocket-servlet-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/flatland/ordered/1.15.11/ordered-1.15.11.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/js/js/22.3.5/js-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/regex/regex/22.3.5/regex-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/sdk/graal-sdk/22.3.5/graal-sdk-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/truffle/truffle-api/22.3.5/truffle-api-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/javassist/javassist/3.18.1-GA/javassist-3.18.1-GA.jar"" ""/Users/a4532252/.m2/repository/org/jetbrains/annotations/24.0.1/annotations-24.0.1.jar"" ""/Users/a4532252/.m2/repository/org/jruby/jcodings/jcodings/1.0.58/jcodings-1.0.58.jar"" ""/Users/a4532252/.m2/repository/org/jruby/joni/joni/2.2.1/joni-2.2.1.jar"" ""/Users/a4532252/.m2/repository/org/jsoup/jsoup/1.17.2/jsoup-1.17.2.jar"" ""/Users/a4532252/.m2/repository/org/liquibase/liquibase-core/4.26.0/liquibase-core-4.26.0.jar"" ""/Users/a4532252/.m2/repository/org/mariadb/jdbc/mariadb-java-client/2.7.10/mariadb-java-client-2.7.10.jar"" ""/Users/a4532252/.m2/repository/org/mindrot/jbcrypt/0.4/jbcrypt-0.4.jar"" ""/Users/a4532252/.m2/repository/org/msgpack/msgpack/0.6.12/msgpack-0.6.12.jar"" ""/Users/a4532252/.m2/repository/org/nibor/autolink/autolink/0.6.0/autolink-0.6.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-core/4.2.0/opensaml-core-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-messaging-api/4.2.0/opensaml-messaging-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-profile-api/4.2.0/opensaml-profile-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-saml-api/4.2.0/opensaml-saml-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-saml-impl/4.2.0/opensaml-saml-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-security-api/4.2.0/opensaml-security-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-security-impl/4.2.0/opensaml-security-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-soap-api/4.2.0/opensaml-soap-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-soap-impl/4.2.0/opensaml-soap-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-storage-api/4.2.0/opensaml-storage-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-xmlsec-api/4.2.0/opensaml-xmlsec-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-xmlsec-impl/4.2.0/opensaml-xmlsec-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/ow2/asm/asm/9.2/asm-9.2.jar"" ""/Users/a4532252/.m2/repository/org/postgresql/postgresql/42.7.3/postgresql-42.7.3.jar"" ""/Users/a4532252/.m2/repository/org/quartz-scheduler/quartz/2.3.2/quartz-2.3.2.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-core-protocols/1.12.0/ring-core-protocols-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-jakarta-servlet/1.12.0/ring-jakarta-servlet-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-websocket-protocols/1.12.0/ring-websocket-protocols-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/slf4j/slf4j-api/2.0.12/slf4j-api-2.0.12.jar"" ""/Users/a4532252/.m2/repository/org/tcrawley/dynapath/1.1.0/dynapath-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/threeten/threeten-extra/1.7.2/threeten-extra-1.7.2.jar"" ""/Users/a4532252/.m2/repository/org/tukaani/xz/1.9/xz-1.9.jar"" ""/Users/a4532252/.m2/repository/org/unbescape/unbescape/1.1.6.RELEASE/unbescape-1.1.6.RELEASE.jar"" ""/Users/a4532252/.m2/repository/org/yaml/snakeyaml/2.2/snakeyaml-2.2.jar"" ""/Users/a4532252/.m2/repository/potemkin/potemkin/0.4.7/potemkin-0.4.7.jar"" ""/Users/a4532252/.m2/repository/pretty/pretty/1.0.5/pretty-1.0.5.jar"" ""/Users/a4532252/.m2/repository/prismatic/schema/1.1.12/schema-1.1.12.jar"" ""/Users/a4532252/.m2/repository/quoin/quoin/0.1.2/quoin-0.1.2.jar"" ""/Users/a4532252/.m2/repository/redux/redux/0.1.4/redux-0.1.4.jar"" ""/Users/a4532252/.m2/repository/riddley/riddley/0.2.0/riddley-0.2.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-codec/1.2.0/ring-codec-1.2.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-core/1.12.0/ring-core-1.12.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-jetty-adapter/1.12.0/ring-jetty-adapter-1.12.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-json/0.5.1/ring-json-0.5.1.jar"" ""/Users/a4532252/.m2/repository/scout/scout/0.1.0/scout-0.1.0.jar"" ""/Users/a4532252/.m2/repository/slingshot/slingshot/0.12.2/slingshot-0.12.2.jar"" ""/Users/a4532252/.m2/repository/stencil/stencil/0.5.0/stencil-0.5.0.jar"" ""/Users/a4532252/.m2/repository/tigris/tigris/0.1.2/tigris-0.1.2.jar"" ""/Users/a4532252/.m2/repository/user-agent/user-agent/0.1.1/user-agent-0.1.1.jar"" ""/Users/a4532252/.m2/repository/weavejester/dependency/0.2.1/dependency-0.2.1.jar"" ""/Users/a4532252/.m2/repository/xml-apis/xml-apis-ext/1.3.04/xml-apis-ext-1.3.04.jar"" ""/Users/a4532252/.m2/repository/xml-apis/xml-apis/1.4.01/xml-apis-1.4.01.jar"" ""resources"" ""src"")}
[backend] 	at metabase.plugins.classloader$require_STAR_.invokeStatic(classloader.clj:132)
[backend] 	at metabase.plugins.classloader$require_STAR_.doInvoke(classloader.clj:116)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:408)
[backend] 	at metabase.plugins.classloader$require.invokeStatic(classloader.clj:151)
[backend] 	at metabase.plugins.classloader$require.invoke(classloader.clj:138)
[backend] 	at clojure.lang.AFn.applyToHelper(AFn.java:154)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:132)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:669)
[backend] 	at clojure.core$apply.invoke(core.clj:662)
[backend] 	at metabase.driver.impl$require_driver_ns.invokeStatic(impl.clj:77)
[backend] 	at metabase.driver.impl$require_driver_ns.doInvoke(impl.clj:71)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:410)
[backend] 	at metabase.driver.impl$load_driver_namespace_if_needed_BANG_$fn__74988.invoke(impl.clj:97)
[backend] 	at metabase.driver.impl$load_driver_namespace_if_needed_BANG_.invokeStatic(impl.clj:96)
[backend] 	at metabase.driver.impl$load_driver_namespace_if_needed_BANG_.invoke(impl.clj:82)
[backend] 	at metabase.driver.impl$register_BANG_.invokeStatic(impl.clj:148)
[backend] 	at metabase.driver.impl$register_BANG_.doInvoke(impl.clj:117)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:486)
[backend] 	at metabase.plugins.lazy_loaded_driver$register_lazy_loaded_driver_BANG_.invokeStatic(lazy_loaded_driver.clj:94)
[backend] 	at metabase.plugins.lazy_loaded_driver$register_lazy_loaded_driver_BANG_.invoke(lazy_loaded_driver.clj:64)
[backend] 	at metabase.plugins.initialize$init_BANG_.invokeStatic(initialize.clj:26)
[backend] 	at metabase.plugins.initialize$init_BANG_.invoke(initialize.clj:18)
[backend] 	at metabase.plugins.initialize$fn__118516$init_plugin_with_info_BANG_118515__118517.invoke(initialize.clj:59)
[backend] 	at metabase.plugins.initialize$fn__118516$fn__118523.invoke(initialize.clj:47)
[backend] 	at metabase.plugins$init_plugin_with_info_BANG_.invokeStatic(plugins.clj:89)
[backend] 	at metabase.plugins$init_plugin_with_info_BANG_.invoke(plugins.clj:85)
[backend] 	at metabase.plugins$init_plugin_BANG_.invokeStatic(plugins.clj:96)
[backend] 	at metabase.plugins$init_plugin_BANG_.invoke(plugins.clj:91)
[backend] 	at metabase.plugins$init_plugins_BANG_$fn__118630.invoke(plugins.clj:164)
[backend] 	at metabase.plugins$init_plugins_BANG_.invokeStatic(plugins.clj:163)
[backend] 	at metabase.plugins$init_plugins_BANG_.invoke(plugins.clj:156)
[backend] 	at metabase.plugins$load_BANG_.invokeStatic(plugins.clj:172)
[backend] 	at metabase.plugins$load_BANG_.invoke(plugins.clj:168)
[backend] 	at metabase.plugins$load_plugins_BANG_.invokeStatic(plugins.clj:199)
[backend] 	at metabase.plugins$load_plugins_BANG_.invoke(plugins.clj:178)
[backend] 	at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:108)
[backend] 	at metabase.core$init_BANG__STAR_.invoke(core.clj:98)
[backend] 	at metabase.core$init_BANG_.invokeStatic(core.clj:171)
[backend] 	at metabase.core$init_BANG_.invoke(core.clj:166)
[backend] 	at metabase.core$start_normally.invokeStatic(core.clj:183)
[backend] 	at metabase.core$start_normally.invoke(core.clj:177)
[backend] 	at metabase.core$entrypoint.invokeStatic(core.clj:216)
[backend] 	at metabase.core$entrypoint.doInvoke(core.clj:210)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:397)
[backend] 	at clojure.lang.AFn.applyToHelper(AFn.java:152)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:132)
[backend] 	at clojure.lang.Var.applyTo(Var.java:705)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:667)
[backend] 	at clojure.core$apply.invoke(core.clj:662)
[backend] 	at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
[backend] 	at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:397)
[backend] 	at clojure.lang.AFn.applyToHelper(AFn.java:152)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:132)
[backend] 	at clojure.lang.Var.applyTo(Var.java:705)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:667)
[backend] 	at clojure.main$main_opt.invokeStatic(main.clj:514)
[backend] 	at clojure.main$main_opt.invoke(main.clj:510)
[backend] 	at clojure.main$main.invokeStatic(main.clj:664)
[backend] 	at clojure.main$main.doInvoke(main.clj:616)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:137)
[backend] 	at clojure.lang.Var.applyTo(Var.java:705)
[backend] 	at clojure.main.main(main.java:40)
[backend] Caused by: java.io.FileNotFoundException: Could not locate metabase/driver/hive_like__init.class, metabase/driver/hive_like.clj or metabase/driver/hive_like.cljc on classpath. Please check that namespaces with dashes use underscores in the Clojure file name.
[backend] 	at clojure.lang.RT.load(RT.java:462)
[backend] 	at clojure.lang.RT.load(RT.java:424)
[backend] 	at clojure.core$load$fn__6908.invoke(core.clj:6162)
[backend] 	at clojure.core$load.invokeStatic(core.clj:6161)
[backend] 	at clojure.core$load.doInvoke(core.clj:6145)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:408)
[backend] 	at clojure.core$load_one.invokeStatic(core.clj:5934)
[backend] 	at clojure.core$load_one.invoke(core.clj:5929)
[backend] 	at clojure.core$load_lib$fn__6850.invoke(core.clj:5976)
[backend] 	at clojure.core$load_lib.invokeStatic(core.clj:5975)
[backend] 	at clojure.core$load_lib.doInvoke(core.clj:5954)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:142)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:669)
[backend] 	at clojure.core$load_libs.invokeStatic(core.clj:6017)
[backend] 	at clojure.core$load_libs.doInvoke(core.clj:6001)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:137)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:669)
[backend] 	at clojure.core$require.invokeStatic(core.clj:6039)
[backend] 	at clojure.core$require.doInvoke(core.clj:6039)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:137)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:667)
[backend] 	at clojure.core$apply.invoke(core.clj:662)
[backend] 	at metabase.plugins.classloader$require_STAR_.invokeStatic(classloader.clj:130)
[backend] 	... 62 more
[backend] 2024-08-29 10:29:11,467 ERROR metabase.plugins :: Failied to initialize plugin databricks-jdbc.metabase-driver.jar
[backend] java.lang.Exception: Could not load :hive-like driver.
[backend] 	at metabase.driver.impl$require_driver_ns.invokeStatic(impl.clj:80)
[backend] 	at metabase.driver.impl$require_driver_ns.doInvoke(impl.clj:71)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:410)
[backend] 	at metabase.driver.impl$load_driver_namespace_if_needed_BANG_$fn__74988.invoke(impl.clj:97)
[backend] 	at metabase.driver.impl$load_driver_namespace_if_needed_BANG_.invokeStatic(impl.clj:96)
[backend] 	at metabase.driver.impl$load_driver_namespace_if_needed_BANG_.invoke(impl.clj:82)
[backend] 	at metabase.driver.impl$register_BANG_.invokeStatic(impl.clj:148)
[backend] 	at metabase.driver.impl$register_BANG_.doInvoke(impl.clj:117)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:486)
[backend] 	at metabase.plugins.lazy_loaded_driver$register_lazy_loaded_driver_BANG_.invokeStatic(lazy_loaded_driver.clj:94)
[backend] 	at metabase.plugins.lazy_loaded_driver$register_lazy_loaded_driver_BANG_.invoke(lazy_loaded_driver.clj:64)
[backend] 	at metabase.plugins.initialize$init_BANG_.invokeStatic(initialize.clj:26)
[backend] 	at metabase.plugins.initialize$init_BANG_.invoke(initialize.clj:18)
[backend] 	at metabase.plugins.initialize$fn__118516$init_plugin_with_info_BANG_118515__118517.invoke(initialize.clj:59)
[backend] 	at metabase.plugins.initialize$fn__118516$fn__118523.invoke(initialize.clj:47)
[backend] 	at metabase.plugins$init_plugin_with_info_BANG_.invokeStatic(plugins.clj:89)
[backend] 	at metabase.plugins$init_plugin_with_info_BANG_.invoke(plugins.clj:85)
[backend] 	at metabase.plugins$init_plugin_BANG_.invokeStatic(plugins.clj:96)
[backend] 	at metabase.plugins$init_plugin_BANG_.invoke(plugins.clj:91)
[backend] 	at metabase.plugins$init_plugins_BANG_$fn__118630.invoke(plugins.clj:164)
[backend] 	at metabase.plugins$init_plugins_BANG_.invokeStatic(plugins.clj:163)
[backend] 	at metabase.plugins$init_plugins_BANG_.invoke(plugins.clj:156)
[backend] 	at metabase.plugins$load_BANG_.invokeStatic(plugins.clj:172)
[backend] 	at metabase.plugins$load_BANG_.invoke(plugins.clj:168)
[backend] 	at metabase.plugins$load_plugins_BANG_.invokeStatic(plugins.clj:199)
[backend] 	at metabase.plugins$load_plugins_BANG_.invoke(plugins.clj:178)
[backend] 	at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:108)
[backend] 	at metabase.core$init_BANG__STAR_.invoke(core.clj:98)
[backend] 	at metabase.core$init_BANG_.invokeStatic(core.clj:171)
[backend] 	at metabase.core$init_BANG_.invoke(core.clj:166)
[backend] 	at metabase.core$start_normally.invokeStatic(core.clj:183)
[backend] 	at metabase.core$start_normally.invoke(core.clj:177)
[backend] 	at metabase.core$entrypoint.invokeStatic(core.clj:216)
[backend] 	at metabase.core$entrypoint.doInvoke(core.clj:210)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:397)
[backend] 	at clojure.lang.AFn.applyToHelper(AFn.java:152)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:132)
[backend] 	at clojure.lang.Var.applyTo(Var.java:705)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:667)
[backend] 	at clojure.core$apply.invoke(core.clj:662)
[backend] 	at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
[backend] 	at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:397)
[backend] 	at clojure.lang.AFn.applyToHelper(AFn.java:152)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:132)
[backend] 	at clojure.lang.Var.applyTo(Var.java:705)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:667)
[backend] 	at clojure.main$main_opt.invokeStatic(main.clj:514)
[backend] 	at clojure.main$main_opt.invoke(main.clj:510)
[backend] 	at clojure.main$main.invokeStatic(main.clj:664)
[backend] 	at clojure.main$main.doInvoke(main.clj:616)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:137)
[backend] 	at clojure.lang.Var.applyTo(Var.java:705)
[backend] 	at clojure.main.main(main.java:40)
Caused by: clojure.lang.ExceptionInfo: Could not locate metabase/driver/hive_like__init.class, metabase/driver/hive_like.clj or metabase/driver/hive_like.cljc on classpath. Please check that namespaces with dashes use underscores in the Clojure file name. {:classloader #object[clojure.lang.DynamicClassLoader 0x1538d8e5 ""clojure.lang.DynamicClassLoader@1538d8e5""], :classpath-urls (), :system-classpath (""/Users/a4532252/.gitlibs/libs/io.github.eerohele/pp/a4287519bdbddaf25e4e480a73caa8055f375b48/src"" ""/Users/a4532252/.m2/repository/amalloy/ring-buffer/1.3.1/ring-buffer-1.3.1.jar"" ""/Users/a4532252/.m2/repository/amalloy/ring-gzip-middleware/0.1.4/ring-gzip-middleware-0.1.4.jar"" ""/Users/a4532252/.m2/repository/babashka/fs/0.5.20/fs-0.5.20.jar"" ""/Users/a4532252/.m2/repository/better-cond/better-cond/2.1.5/better-cond-2.1.5.jar"" ""/Users/a4532252/.m2/repository/bigml/histogram/4.1.4/histogram-4.1.4.jar"" ""/Users/a4532252/.m2/repository/borkdude/dynaload/0.3.5/dynaload-0.3.5.jar"" ""/Users/a4532252/.m2/repository/borkdude/edamame/1.4.25/edamame-1.4.25.jar"" ""/Users/a4532252/.m2/repository/buddy/buddy-core/1.11.423/buddy-core-1.11.423.jar"" ""/Users/a4532252/.m2/repository/buddy/buddy-sign/3.5.351/buddy-sign-3.5.351.jar"" ""/Users/a4532252/.m2/repository/camel-snake-kebab/camel-snake-kebab/0.4.3/camel-snake-kebab-0.4.3.jar"" ""/Users/a4532252/.m2/repository/cheshire/cheshire/5.12.0/cheshire-5.12.0.jar"" ""/Users/a4532252/.m2/repository/clj-bom/clj-bom/0.1.2/clj-bom-0.1.2.jar"" ""/Users/a4532252/.m2/repository/clj-commons/clj-yaml/1.0.27/clj-yaml-1.0.27.jar"" ""/Users/a4532252/.m2/repository/clj-commons/iapetos/0.1.13/iapetos-0.1.13.jar"" ""/Users/a4532252/.m2/repository/clj-http/clj-http/3.12.3/clj-http-3.12.3.jar"" ""/Users/a4532252/.m2/repository/clj-time/clj-time/0.15.2/clj-time-0.15.2.jar"" ""/Users/a4532252/.m2/repository/clojure/java-time/clojure.java-time/1.4.2/clojure.java-time-1.4.2.jar"" ""/Users/a4532252/.m2/repository/clojurewerkz/quartzite/2.2.0/quartzite-2.2.0.jar"" ""/Users/a4532252/.m2/repository/clout/clout/2.2.1/clout-2.2.1.jar"" ""/Users/a4532252/.m2/repository/colorize/colorize/0.1.1/colorize-0.1.1.jar"" ""/Users/a4532252/.m2/repository/com/andrewmcveigh/cljs-time/0.5.2/cljs-time-0.5.2.jar"" ""/Users/a4532252/.m2/repository/com/clearspring/analytics/stream/2.9.8/stream-2.9.8.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-clj/1.0.324/transit-clj-1.0.324.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-cljs/0.8.269/transit-cljs-0.8.269.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-java/1.0.343/transit-java-1.0.343.jar"" ""/Users/a4532252/.m2/repository/com/cognitect/transit-js/0.8.874/transit-js-0.8.874.jar"" ""/Users/a4532252/.m2/repository/com/draines/postal/2.0.5/postal-2.0.5.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-annotations/2.17.0/jackson-annotations-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-core/2.17.0/jackson-core-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/core/jackson-databind/2.17.0/jackson-databind-2.17.0.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-cbor/2.15.2/jackson-dataformat-cbor-2.15.2.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/jackson/dataformat/jackson-dataformat-smile/2.15.2/jackson-dataformat-smile-2.15.2.jar"" ""/Users/a4532252/.m2/repository/com/fasterxml/woodstox/woodstox-core/6.6.1/woodstox-core-6.6.1.jar"" ""/Users/a4532252/.m2/repository/com/gfredericks/test.chuck/0.2.14/test.chuck-0.2.14.jar"" ""/Users/a4532252/.m2/repository/com/github/jsqlparser/jsqlparser/4.9/jsqlparser-4.9.jar"" ""/Users/a4532252/.m2/repository/com/github/oliyh/martian-hato/0.1.24/martian-hato-0.1.24.jar"" ""/Users/a4532252/.m2/repository/com/github/oliyh/martian/0.1.24/martian-0.1.24.jar"" ""/Users/a4532252/.m2/repository/com/github/seancorfield/honeysql/2.6.1126/honeysql-2.6.1126.jar"" ""/Users/a4532252/.m2/repository/com/github/seancorfield/next.jdbc/1.3.925/next.jdbc-1.3.925.jar"" ""/Users/a4532252/.m2/repository/com/github/steffan-westcott/clj-otel-api/0.2.6/clj-otel-api-0.2.6.jar"" ""/Users/a4532252/.m2/repository/com/github/vertical-blank/sql-formatter/2.0.4/sql-formatter-2.0.4.jar"" ""/Users/a4532252/.m2/repository/com/github/virtuald/curvesapi/1.08/curvesapi-1.08.jar"" ""/Users/a4532252/.m2/repository/com/google/code/findbugs/jsr305/3.0.2/jsr305-3.0.2.jar"" ""/Users/a4532252/.m2/repository/com/google/errorprone/error_prone_annotations/2.26.1/error_prone_annotations-2.26.1.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/failureaccess/1.0.2/failureaccess-1.0.2.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/guava/33.1.0-jre/guava-33.1.0-jre.jar"" ""/Users/a4532252/.m2/repository/com/google/guava/listenablefuture/9999.0-empty-to-avoid-conflict-with-guava/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar"" ""/Users/a4532252/.m2/repository/com/google/j2objc/j2objc-annotations/3.0.0/j2objc-annotations-3.0.0.jar"" ""/Users/a4532252/.m2/repository/com/googlecode/json-simple/json-simple/1.1.1/json-simple-1.1.1.jar"" ""/Users/a4532252/.m2/repository/com/h2database/h2/2.1.214/h2-2.1.214.jar"" ""/Users/a4532252/.m2/repository/com/ibm/icu/icu4j/71.1/icu4j-71.1.jar"" ""/Users/a4532252/.m2/repository/com/mchange/c3p0/0.9.5.5/c3p0-0.9.5.5.jar"" ""/Users/a4532252/.m2/repository/com/mchange/mchange-commons-java/0.2.19/mchange-commons-java-0.2.19.jar"" ""/Users/a4532252/.m2/repository/com/onelogin/java-saml-core/2.9.0/java-saml-core-2.9.0.jar"" ""/Users/a4532252/.m2/repository/com/onelogin/java-saml/2.9.0/java-saml-2.9.0.jar"" ""/Users/a4532252/.m2/repository/com/opencsv/opencsv/5.9/opencsv-5.9.jar"" ""/Users/a4532252/.m2/repository/com/snowplowanalytics/snowplow-java-tracker/1.0.1/snowplow-java-tracker-1.0.1.jar"" ""/Users/a4532252/.m2/repository/com/sun/activation/jakarta.activation/1.2.1/jakarta.activation-1.2.1.jar"" ""/Users/a4532252/.m2/repository/com/sun/mail/jakarta.mail/1.6.5/jakarta.mail-1.6.5.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/encore/3.112.0/encore-3.112.0.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/nippy/3.4.2/nippy-3.4.2.jar"" ""/Users/a4532252/.m2/repository/com/taoensso/truss/1.11.0/truss-1.11.0.jar"" ""/Users/a4532252/.m2/repository/com/tdunning/t-digest/3.2/t-digest-3.2.jar"" ""/Users/a4532252/.m2/repository/com/unboundid/unboundid-ldapsdk/5.1.1/unboundid-ldapsdk-5.1.1.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-ext-autolink/0.64.8/flexmark-ext-autolink-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-ast/0.64.8/flexmark-util-ast-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-builder/0.64.8/flexmark-util-builder-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-collection/0.64.8/flexmark-util-collection-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-data/0.64.8/flexmark-util-data-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-dependency/0.64.8/flexmark-util-dependency-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-format/0.64.8/flexmark-util-format-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-html/0.64.8/flexmark-util-html-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-misc/0.64.8/flexmark-util-misc-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-options/0.64.8/flexmark-util-options-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-sequence/0.64.8/flexmark-util-sequence-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util-visitor/0.64.8/flexmark-util-visitor-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark-util/0.64.8/flexmark-util-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/vladsch/flexmark/flexmark/0.64.8/flexmark-0.64.8.jar"" ""/Users/a4532252/.m2/repository/com/zaxxer/HikariCP-java7/2.4.13/HikariCP-java7-2.4.13.jar"" ""/Users/a4532252/.m2/repository/com/zaxxer/SparseBitSet/1.3/SparseBitSet-1.3.jar"" ""/Users/a4532252/.m2/repository/commons-codec/commons-codec/1.16.1/commons-codec-1.16.1.jar"" ""/Users/a4532252/.m2/repository/commons-collections/commons-collections/3.2.2/commons-collections-3.2.2.jar"" ""/Users/a4532252/.m2/repository/commons-fileupload/commons-fileupload/1.5/commons-fileupload-1.5.jar"" ""/Users/a4532252/.m2/repository/commons-io/commons-io/2.15.1/commons-io-2.15.1.jar"" ""/Users/a4532252/.m2/repository/commons-logging/commons-logging/1.3.0/commons-logging-1.3.0.jar"" ""/Users/a4532252/.m2/repository/commons-net/commons-net/3.10.0/commons-net-3.10.0.jar"" ""/Users/a4532252/.m2/repository/commons-validator/commons-validator/1.8.0/commons-validator-1.8.0.jar"" ""/Users/a4532252/.m2/repository/compojure/compojure/1.7.1/compojure-1.7.1.jar"" ""/Users/a4532252/.m2/repository/crypto-equality/crypto-equality/1.0.1/crypto-equality-1.0.1.jar"" ""/Users/a4532252/.m2/repository/crypto-random/crypto-random/1.2.1/crypto-random-1.2.1.jar"" ""/Users/a4532252/.m2/repository/dk/ative/docjure/1.19.0/docjure-1.19.0.jar"" ""/Users/a4532252/.m2/repository/environ/environ/1.2.0/environ-1.2.0.jar"" ""/Users/a4532252/.m2/repository/fipp/fipp/0.6.26/fipp-0.6.26.jar"" ""/Users/a4532252/.m2/repository/frankiesardo/tripod/0.2.0/tripod-0.2.0.jar"" ""/Users/a4532252/.m2/repository/hato/hato/0.8.2/hato-0.8.2.jar"" ""/Users/a4532252/.m2/repository/hiccup/hiccup/1.0.5/hiccup-1.0.5.jar"" ""/Users/a4532252/.m2/repository/inflections/inflections/0.14.1/inflections-0.14.1.jar"" ""/Users/a4532252/.m2/repository/instaparse/instaparse/1.4.12/instaparse-1.4.12.jar"" ""/Users/a4532252/.m2/repository/io/airlift/aircompressor/0.27/aircompressor-0.27.jar"" ""/Users/a4532252/.m2/repository/io/dropwizard/metrics/metrics-core/4.2.9/metrics-core-4.2.9.jar"" ""/Users/a4532252/.m2/repository/io/github/camsaul/toucan2/1.0.538/toucan2-1.0.538.jar"" ""/Users/a4532252/.m2/repository/io/github/metabase/macaw/0.2.6/macaw-0.2.6.jar"" ""/Users/a4532252/.m2/repository/io/github/resilience4j/resilience4j-core/1.7.1/resilience4j-core-1.7.1.jar"" ""/Users/a4532252/.m2/repository/io/github/resilience4j/resilience4j-retry/1.7.1/resilience4j-retry-1.7.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/opentelemetry-api/1.34.1/opentelemetry-api-1.34.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/opentelemetry-context/1.34.1/opentelemetry-context-1.34.1.jar"" ""/Users/a4532252/.m2/repository/io/opentelemetry/semconv/opentelemetry-semconv/1.23.1-alpha/opentelemetry-semconv-1.23.1-alpha.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient/0.16.0/simpleclient-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_common/0.12.0/simpleclient_common-0.12.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_hotspot/0.16.0/simpleclient_hotspot-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_jetty/0.16.0/simpleclient_jetty-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_pushgateway/0.12.0/simpleclient_pushgateway-0.12.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_common/0.16.0/simpleclient_tracer_common-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_otel/0.16.0/simpleclient_tracer_otel-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/prometheus/simpleclient_tracer_otel_agent/0.16.0/simpleclient_tracer_otel_agent-0.16.0.jar"" ""/Users/a4532252/.m2/repository/io/vavr/vavr-match/0.10.2/vavr-match-0.10.2.jar"" ""/Users/a4532252/.m2/repository/io/vavr/vavr/0.10.2/vavr-0.10.2.jar"" ""/Users/a4532252/.m2/repository/jakarta/xml/bind/jakarta.xml.bind-api/3.0.1/jakarta.xml.bind-api-3.0.1.jar"" ""/Users/a4532252/.m2/repository/javax/annotation/jsr250-api/1.0/jsr250-api-1.0.jar"" ""/Users/a4532252/.m2/repository/javax/servlet/servlet-api/2.5/servlet-api-2.5.jar"" ""/Users/a4532252/.m2/repository/javax/xml/bind/jaxb-api/2.3.1/jaxb-api-2.3.1.jar"" ""/Users/a4532252/.m2/repository/joda-time/joda-time/2.10.6/joda-time-2.10.6.jar"" ""/Users/a4532252/.m2/repository/junegunn/grouper/0.1.1/grouper-0.1.1.jar"" ""/Users/a4532252/.m2/repository/kixi/stats/0.5.5/stats-0.5.5.jar"" ""/Users/a4532252/.m2/repository/lambdaisland/uri/1.19.155/uri-1.19.155.jar"" ""/Users/a4532252/.m2/repository/medley/medley/1.4.0/medley-1.4.0.jar"" ""/Users/a4532252/.m2/repository/metabase/connection-pool/1.2.0/connection-pool-1.2.0.jar"" ""/Users/a4532252/.m2/repository/metabase/saml20-clj/2.2.7.172/saml20-clj-2.2.7.172.jar"" ""/Users/a4532252/.m2/repository/metabase/throttle/1.0.2/throttle-1.0.2.jar"" ""/Users/a4532252/.m2/repository/methodical/methodical/0.15.1/methodical-0.15.1.jar"" ""/Users/a4532252/.m2/repository/metosin/malli/0.16.3/malli-0.16.3.jar"" ""/Users/a4532252/.m2/repository/metosin/schema-tools/0.12.3/schema-tools-0.12.3.jar"" ""/Users/a4532252/.m2/repository/metosin/spec-tools/0.10.5/spec-tools-0.10.5.jar"" ""/Users/a4532252/.m2/repository/mvxcvi/arrangement/2.1.0/arrangement-2.1.0.jar"" ""/Users/a4532252/.m2/repository/mvxcvi/puget/1.3.4/puget-1.3.4.jar"" ""/Users/a4532252/.m2/repository/nano-id/nano-id/1.1.0/nano-id-1.1.0.jar"" ""/Users/a4532252/.m2/repository/net/bytebuddy/byte-buddy/1.14.9/byte-buddy-1.14.9.jar"" ""/Users/a4532252/.m2/repository/net/cgrand/macrovich/0.2.2/macrovich-0.2.2.jar"" ""/Users/a4532252/.m2/repository/net/clojars/wkok/openai-clojure/0.16.0/openai-clojure-0.16.0.jar"" ""/Users/a4532252/.m2/repository/net/i2p/crypto/eddsa/0.3.0/eddsa-0.3.0.jar"" ""/Users/a4532252/.m2/repository/net/redhogs/cronparser/cron-parser-core/3.5/cron-parser-core-3.5.jar"" ""/Users/a4532252/.m2/repository/net/sf/cssbox/cssbox/5.0.1/cssbox-5.0.1.jar"" ""/Users/a4532252/.m2/repository/net/sf/cssbox/jstyleparser/4.0.0/jstyleparser-4.0.0.jar"" ""/Users/a4532252/.m2/repository/net/sf/qualitycheck/quality-check/1.3/quality-check-1.3.jar"" ""/Users/a4532252/.m2/repository/net/sf/uadetector/uadetector-core/0.9.22/uadetector-core-0.9.22.jar"" ""/Users/a4532252/.m2/repository/net/sf/uadetector/uadetector-resources/2014.10/uadetector-resources-2014.10.jar"" ""/Users/a4532252/.m2/repository/net/shibboleth/utilities/java-support/8.3.1/java-support-8.3.1.jar"" ""/Users/a4532252/.m2/repository/net/thisptr/jackson-jq/1.0.0-preview.20240207/jackson-jq-1.0.0-preview.20240207.jar"" ""/Users/a4532252/.m2/repository/noencore/noencore/0.3.7/noencore-0.3.7.jar"" ""/Users/a4532252/.m2/repository/org/antlr/antlr4-runtime/4.5.3/antlr4-runtime-4.5.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-collections4/4.4/commons-collections4-4.4.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-compress/1.26.1/commons-compress-1.26.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-fileupload2-core/2.0.0-M1/commons-fileupload2-core-2.0.0-M1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-lang3/3.14.0/commons-lang3-3.14.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-math3/3.6.1/commons-math3-3.6.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/commons/commons-text/1.11.0/commons-text-1.11.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpasyncclient/4.1.4/httpasyncclient-4.1.4.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpclient-cache/4.5.13/httpclient-cache-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpclient/4.5.13/httpclient-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpcore-nio/4.4.10/httpcore-nio-4.4.10.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpcore/4.4.15/httpcore-4.4.15.jar"" ""/Users/a4532252/.m2/repository/org/apache/httpcomponents/httpmime/4.5.13/httpmime-4.5.13.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-1.2-api/2.23.1/log4j-1.2-api-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-api/2.23.1/log4j-api-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-core/2.23.1/log4j-core-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-jcl/2.23.1/log4j-jcl-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-jul/2.23.1/log4j-jul-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-layout-template-json/2.23.1/log4j-layout-template-json-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/logging/log4j/log4j-slf4j2-impl/2.23.1/log4j-slf4j2-impl-2.23.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi-ooxml-lite/5.2.5/poi-ooxml-lite-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi-ooxml/5.2.5/poi-ooxml-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/poi/poi/5.2.5/poi-5.2.5.jar"" ""/Users/a4532252/.m2/repository/org/apache/santuario/xmlsec/3.0.3/xmlsec-3.0.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/sshd/sshd-common/2.12.1/sshd-common-2.12.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/sshd/sshd-core/2.12.1/sshd-core-2.12.1.jar"" ""/Users/a4532252/.m2/repository/org/apache/tika/tika-core/2.9.2/tika-core-2.9.2.jar"" ""/Users/a4532252/.m2/repository/org/apache/velocity/velocity-engine-core/2.3/velocity-engine-core-2.3.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlbeans/xmlbeans/5.2.0/xmlbeans-5.2.0.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlgraphics/batik-all/1.17/batik-all-1.17.jar"" ""/Users/a4532252/.m2/repository/org/apache/xmlgraphics/xmlgraphics-commons/2.9/xmlgraphics-commons-2.9.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcpkix-jdk18on/1.78/bcpkix-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcprov-jdk18on/1.78/bcprov-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/bouncycastle/bcutil-jdk18on/1.78/bcutil-jdk18on-1.78.jar"" ""/Users/a4532252/.m2/repository/org/checkerframework/checker-qual/3.42.0/checker-qual-3.42.0.jar"" ""/Users/a4532252/.m2/repository/org/clj-commons/claypoole/1.2.2/claypoole-1.2.2.jar"" ""/Users/a4532252/.m2/repository/org/clj-commons/hickory/0.7.4/hickory-0.7.4.jar"" ""/Users/a4532252/.m2/repository/org/clojars/pntblnk/clj-ldap/0.0.17/clj-ldap-0.0.17.jar"" ""/Users/a4532252/.m2/repository/org/clojure/clojure/1.11.2/clojure-1.11.2.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.async/1.6.681/core.async-1.6.681.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.cache/1.1.234/core.cache-1.1.234.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.logic/1.1.0/core.logic-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.match/1.1.0/core.match-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.memoize/1.1.266/core.memoize-1.1.266.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.rrb-vector/0.1.2/core.rrb-vector-0.1.2.jar"" ""/Users/a4532252/.m2/repository/org/clojure/core.specs.alpha/0.2.62/core.specs.alpha-0.2.62.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.csv/1.1.0/data.csv-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.priority-map/1.2.0/data.priority-map-1.2.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/data.xml/0.0.8/data.xml-0.0.8.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.classpath/1.1.0/java.classpath-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.data/1.2.107/java.data-1.2.107.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.jdbc/0.7.12/java.jdbc-0.7.12.jar"" ""/Users/a4532252/.m2/repository/org/clojure/java.jmx/1.1.0/java.jmx-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/math.combinatorics/0.3.0/math.combinatorics-0.3.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/math.numeric-tower/0.1.0/math.numeric-tower-0.1.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/spec.alpha/0.3.218/spec.alpha-0.3.218.jar"" ""/Users/a4532252/.m2/repository/org/clojure/test.check/1.1.1/test.check-1.1.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.analyzer.jvm/1.2.3/tools.analyzer.jvm-1.2.3.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.analyzer/1.1.1/tools.analyzer-1.1.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.cli/1.1.230/tools.cli-1.1.230.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.logging/1.3.0/tools.logging-1.3.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.macro/0.2.0/tools.macro-0.2.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.namespace/1.5.0/tools.namespace-1.5.0.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.reader/1.4.1/tools.reader-1.4.1.jar"" ""/Users/a4532252/.m2/repository/org/clojure/tools.trace/0.8.0/tools.trace-0.8.0.jar"" ""/Users/a4532252/.m2/repository/org/codehaus/woodstox/stax2-api/4.2.2/stax2-api-4.2.2.jar"" ""/Users/a4532252/.m2/repository/org/codelibs/nekohtml/2.0.2/nekohtml-2.0.2.jar"" ""/Users/a4532252/.m2/repository/org/codelibs/xerces/xercesImpl/2.12.0-sp1/xercesImpl-2.12.0-sp1.jar"" ""/Users/a4532252/.m2/repository/org/cryptacular/cryptacular/1.2.5/cryptacular-1.2.5.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-http/11.0.20/jetty-http-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-io/11.0.20/jetty-io-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-security/11.0.20/jetty-security-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-server/11.0.20/jetty-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-servlet/11.0.20/jetty-servlet-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-util/11.0.20/jetty-util-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-webapp/11.0.20/jetty-webapp-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/jetty-xml/11.0.20/jetty-xml-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/toolchain/jetty-jakarta-servlet-api/5.0.2/jetty-jakarta-servlet-api-5.0.2.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-core-common/11.0.20/websocket-core-common-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-core-server/11.0.20/websocket-core-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-api/11.0.20/websocket-jetty-api-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-common/11.0.20/websocket-jetty-common-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-jetty-server/11.0.20/websocket-jetty-server-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/eclipse/jetty/websocket/websocket-servlet/11.0.20/websocket-servlet-11.0.20.jar"" ""/Users/a4532252/.m2/repository/org/flatland/ordered/1.15.11/ordered-1.15.11.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/js/js/22.3.5/js-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/regex/regex/22.3.5/regex-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/sdk/graal-sdk/22.3.5/graal-sdk-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/graalvm/truffle/truffle-api/22.3.5/truffle-api-22.3.5.jar"" ""/Users/a4532252/.m2/repository/org/javassist/javassist/3.18.1-GA/javassist-3.18.1-GA.jar"" ""/Users/a4532252/.m2/repository/org/jetbrains/annotations/24.0.1/annotations-24.0.1.jar"" ""/Users/a4532252/.m2/repository/org/jruby/jcodings/jcodings/1.0.58/jcodings-1.0.58.jar"" ""/Users/a4532252/.m2/repository/org/jruby/joni/joni/2.2.1/joni-2.2.1.jar"" ""/Users/a4532252/.m2/repository/org/jsoup/jsoup/1.17.2/jsoup-1.17.2.jar"" ""/Users/a4532252/.m2/repository/org/liquibase/liquibase-core/4.26.0/liquibase-core-4.26.0.jar"" ""/Users/a4532252/.m2/repository/org/mariadb/jdbc/mariadb-java-client/2.7.10/mariadb-java-client-2.7.10.jar"" ""/Users/a4532252/.m2/repository/org/mindrot/jbcrypt/0.4/jbcrypt-0.4.jar"" ""/Users/a4532252/.m2/repository/org/msgpack/msgpack/0.6.12/msgpack-0.6.12.jar"" ""/Users/a4532252/.m2/repository/org/nibor/autolink/autolink/0.6.0/autolink-0.6.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-core/4.2.0/opensaml-core-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-messaging-api/4.2.0/opensaml-messaging-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-profile-api/4.2.0/opensaml-profile-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-saml-api/4.2.0/opensaml-saml-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-saml-impl/4.2.0/opensaml-saml-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-security-api/4.2.0/opensaml-security-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-security-impl/4.2.0/opensaml-security-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-soap-api/4.2.0/opensaml-soap-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-soap-impl/4.2.0/opensaml-soap-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-storage-api/4.2.0/opensaml-storage-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-xmlsec-api/4.2.0/opensaml-xmlsec-api-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/opensaml/opensaml-xmlsec-impl/4.2.0/opensaml-xmlsec-impl-4.2.0.jar"" ""/Users/a4532252/.m2/repository/org/ow2/asm/asm/9.2/asm-9.2.jar"" ""/Users/a4532252/.m2/repository/org/postgresql/postgresql/42.7.3/postgresql-42.7.3.jar"" ""/Users/a4532252/.m2/repository/org/quartz-scheduler/quartz/2.3.2/quartz-2.3.2.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-core-protocols/1.12.0/ring-core-protocols-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-jakarta-servlet/1.12.0/ring-jakarta-servlet-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/ring-clojure/ring-websocket-protocols/1.12.0/ring-websocket-protocols-1.12.0.jar"" ""/Users/a4532252/.m2/repository/org/slf4j/slf4j-api/2.0.12/slf4j-api-2.0.12.jar"" ""/Users/a4532252/.m2/repository/org/tcrawley/dynapath/1.1.0/dynapath-1.1.0.jar"" ""/Users/a4532252/.m2/repository/org/threeten/threeten-extra/1.7.2/threeten-extra-1.7.2.jar"" ""/Users/a4532252/.m2/repository/org/tukaani/xz/1.9/xz-1.9.jar"" ""/Users/a4532252/.m2/repository/org/unbescape/unbescape/1.1.6.RELEASE/unbescape-1.1.6.RELEASE.jar"" ""/Users/a4532252/.m2/repository/org/yaml/snakeyaml/2.2/snakeyaml-2.2.jar"" ""/Users/a4532252/.m2/repository/potemkin/potemkin/0.4.7/potemkin-0.4.7.jar"" ""/Users/a4532252/.m2/repository/pretty/pretty/1.0.5/pretty-1.0.5.jar"" ""/Users/a4532252/.m2/repository/prismatic/schema/1.1.12/schema-1.1.12.jar"" ""/Users/a4532252/.m2/repository/quoin/quoin/0.1.2/quoin-0.1.2.jar"" ""/Users/a4532252/.m2/repository/redux/redux/0.1.4/redux-0.1.4.jar"" ""/Users/a4532252/.m2/repository/riddley/riddley/0.2.0/riddley-0.2.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-codec/1.2.0/ring-codec-1.2.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-core/1.12.0/ring-core-1.12.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-jetty-adapter/1.12.0/ring-jetty-adapter-1.12.0.jar"" ""/Users/a4532252/.m2/repository/ring/ring-json/0.5.1/ring-json-0.5.1.jar"" ""/Users/a4532252/.m2/repository/scout/scout/0.1.0/scout-0.1.0.jar"" ""/Users/a4532252/.m2/repository/slingshot/slingshot/0.12.2/slingshot-0.12.2.jar"" ""/Users/a4532252/.m2/repository/stencil/stencil/0.5.0/stencil-0.5.0.jar"" ""/Users/a4532252/.m2/repository/tigris/tigris/0.1.2/tigris-0.1.2.jar"" ""/Users/a4532252/.m2/repository/user-agent/user-agent/0.1.1/user-agent-0.1.1.jar"" ""/Users/a4532252/.m2/repository/weavejester/dependency/0.2.1/dependency-0.2.1.jar"" ""/Users/a4532252/.m2/repository/xml-apis/xml-apis-ext/1.3.04/xml-apis-ext-1.3.04.jar"" ""/Users/a4532252/.m2/repository/xml-apis/xml-apis/1.4.01/xml-apis-1.4.01.jar"" ""resources"" ""src"")}
[backend] 	at metabase.plugins.classloader$require_STAR_.invokeStatic(classloader.clj:132)
[backend] 	at metabase.plugins.classloader$require_STAR_.doInvoke(classloader.clj:116)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:408)
[backend] 	at metabase.plugins.classloader$require.invokeStatic(classloader.clj:151)
[backend] 	at metabase.plugins.classloader$require.invoke(classloader.clj:138)
[backend] 	at clojure.lang.AFn.applyToHelper(AFn.java:154)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:132)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:669)
[backend] 	at clojure.core$apply.invoke(core.clj:662)
[backend] 	at metabase.driver.impl$require_driver_ns.invokeStatic(impl.clj:77)
[backend] 	... 53 more
[backend] Caused by: java.io.FileNotFoundException: Could not locate metabase/driver/hive_like__init.class, metabase/driver/hive_like.clj or metabase/driver/hive_like.cljc on classpath. Please check that namespaces with dashes use underscores in the Clojure file name.
[backend] 	at clojure.lang.RT.load(RT.java:462)
[backend] 	at clojure.lang.RT.load(RT.java:424)
[backend] 	at clojure.core$load$fn__6908.invoke(core.clj:6162)
[backend] 	at clojure.core$load.invokeStatic(core.clj:6161)
[backend] 	at clojure.core$load.doInvoke(core.clj:6145)
[backend] 	at clojure.lang.RestFn.invoke(RestFn.java:408)
[backend] 	at clojure.core$load_one.invokeStatic(core.clj:5934)
[backend] 	at clojure.core$load_one.invoke(core.clj:5929)
[backend] 	at clojure.core$load_lib$fn__6850.invoke(core.clj:5976)
[backend] 	at clojure.core$load_lib.invokeStatic(core.clj:5975)
[backend] 	at clojure.core$load_lib.doInvoke(core.clj:5954)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:142)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:669)
[backend] 	at clojure.core$load_libs.invokeStatic(core.clj:6017)
[backend] 	at clojure.core$load_libs.doInvoke(core.clj:6001)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:137)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:669)
[backend] 	at clojure.core$require.invokeStatic(core.clj:6039)
[backend] 	at clojure.core$require.doInvoke(core.clj:6039)
[backend] 	at clojure.lang.RestFn.applyTo(RestFn.java:137)
[backend] 	at clojure.core$apply.invokeStatic(core.clj:667)
[backend] 	at clojure.core$apply.invoke(core.clj:662)
	at metabase.plugins.classloader$require_STAR_.invokeStatic(classloader.clj:130)
[backend] 	... 62 more

lbrdnk (Issue Creator) on (2024-08-29 16:19:20 UTC): Oh, I see. Using `yarn dev` starts Metabase without the `:drivers` `deps.edn` alias. I'm running the app differently for the development purposes, but I believe doing the following would resolve the problem.

Edit the `package.json`, the `dev` script (line 371), modifying `'clojure -M:run'` to `'clojure -M:run:drivers'`.

Starting the app with `yarn dev`, with the change in place, I was able to add Databricks database successfully. I also did `bin/build-drivers.sh` prior to that.

(The logged exception should be resolved with the commit I've pushed now :))

jschwendt on (2024-08-29 16:47:03 UTC): That worked like a champ!  I'm in and able to do everything as I would expect!  Thank you so much!!!

lbrdnk (Issue Creator) on (2024-11-25 13:39:05 UTC): Closing as all items have been completed.

"
2349285874,issue,closed,not_planned,Not able to gather field values after moving table to new schema within same database,"### Describe the bug

Hi.
We have metabase connected to clickhouse database.
Right now we're in the process of moving some tables between different schemas within this one database.
For the tables that we moved I cannot gather field values (for field filters) receiving errors like

```
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-10T12:35:16+02:00 ERROR metabase.models.field-values Error fetching field values
clojure.lang.ExceptionInfo: Error executing query: Code: 279. DB::NetException: All connection tries failed. Log: 
Code: 210. DB::NetException: I/O error: Broken pipe, while writing to socket (192.168.0.127:49578 -> 192.168.0.127:9440). (NETWORK_ERROR) (version 23.2.6.34 (official build))
Code: 210. DB::NetException: I/O error: Broken pipe, while writing to socket (192.168.0.127:55494 -> 192.168.0.125:9440). (NETWORK_ERROR) (version 23.2.6.34 (official build))
There is no table `old_schema`.`table_name` on server: nl41.private:9440
There is no table `old_schema`.`table_name` on server: nl40.private:9440
: While executing Remote. (ALL_CONNECTION_TRIES_FAILED) (version 23.2.6.34 (official build))
```

Syncing database schema is on, with once per hour schedule.
Triggering ""sync database schema now"" manually brings the same error.

Meanwhile, I can see and query these moved tables in metabase without any errors (sql queries, ""table metadata"" in admin, etc.).

### To Reproduce

1. Move table to new schema within same database (ex. from database.old_schema.users --> database.new_schema.users)
2. Try to add field filter from table ""users"" OR trigger field scan from admin/table_metadata
3. Get error ""There is no table `old_schema`.`table_name` on server...""


### Expected behavior

Metabase updates moved tables metadata

### Logs

[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-12T19:02:22+02:00 DEBUG metabase.server.middleware.log GET /api/field/10266/values 200 71.0 ms (13 DB calls) App DB connections: 0/15 Jetty threads: 5/50 (1 idle, 0 queued) (131 total active threads) Queries in flight: 0 (0 queued); clickhouse DB 2 connections: 0/1 (0 threads blocked)
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-12T19:02:25+02:00 ERROR metabase.models.field-values Error fetching field values
clojure.lang.ExceptionInfo: Error executing query: Code: 279. DB::NetException: All connection tries failed. Log: 
There is no table `local`.`ug_users_properties_local` on server: nl40.private:9440
There is no table `local`.`ug_users_properties_local` on server: nl41.private:9440
: While executing Remote. (ALL_CONNECTION_TRIES_FAILED) (version 23.2.6.34 (official build))
, server ClickHouseNode [uri=http://nl41.mu.se:8123/default, options={use_server_time_zone_for_dates=true,use_no_proxy=false,product_name=metabase/1.2.2}]@-1808516779 {:driver :clickhouse, :sql [""-- Metabase"" ""SELECT"" ""  ` default `.` ug_users_properties `.` user_gender ` AS ` user_gender `"" ""FROM"" ""  ` default `.` ug_users_properties `"" ""GROUP BY"" ""  ` default `.` ug_users_properties `.` user_gender `"" ""ORDER BY"" ""  ` default `.` ug_users_properties `.` user_gender ` ASC"" ""LIMIT"" ""  1000""], :params nil, :type :invalid-query}
	at metabase.driver.sql_jdbc.execute$execute_reducible_query$fn__81039$fn__81040.invoke(execute.clj:681)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query$fn__81039.invoke(execute.clj:678)
	at metabase.driver.sql_jdbc.execute$fn__80840$fn__80841.invoke(execute.clj:384)
	at metabase.driver.sql_jdbc.execute$fn__80808$do_with_resolved_connection__80809.invoke(execute.clj:334)
	at clojure.lang.AFn.applyToHelper(AFn.java:165)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$apply.invoke(core.clj:662)
	at malli.core$_instrument$fn__13254.doInvoke(core.cljc:2526)
	at clojure.lang.RestFn.invoke(RestFn.java:457)
	at metabase.driver.sql_jdbc.execute$fn__80840.invokeStatic(execute.clj:378)
	at metabase.driver.sql_jdbc.execute$fn__80840.invoke(execute.clj:376)
	at clojure.lang.MultiFn.invoke(MultiFn.java:244)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:672)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:661)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:669)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:661)
	at metabase.driver.sql_jdbc$fn__115924.invokeStatic(sql_jdbc.clj:72)
	at metabase.driver.sql_jdbc$fn__115924.invoke(sql_jdbc.clj:70)
	at clojure.lang.MultiFn.invoke(MultiFn.java:244)
	at metabase.query_processor.context$executef.invokeStatic(context.clj:60)
	at metabase.query_processor.context$executef.invoke(context.clj:49)
	at metabase.query_processor.context.default$default_runf.invokeStatic(default.clj:68)
	at metabase.query_processor.context.default$default_runf.invoke(default.clj:66)
	at metabase.query_processor.context$runf.invokeStatic(context.clj:46)
	at metabase.query_processor.context$runf.invoke(context.clj:40)
	at metabase.query_processor.reducible$identity_qp.invokeStatic(reducible.clj:15)
	at metabase.query_processor.reducible$identity_qp.invoke(reducible.clj:12)
	at metabase.query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___77072.invoke(cache.clj:224)
	at metabase.query_processor.middleware.permissions$check_query_permissions$fn__72655.invoke(permissions.clj:126)
	at metabase.query_processor.middleware.mbql_to_native$mbql__GT_native$fn__76197.invoke(mbql_to_native.clj:24)
	at metabase.query_processor$fn__78305$combined_post_process__78310$combined_post_process_STAR___78311.invoke(query_processor.clj:260)
	at metabase.query_processor$fn__78305$combined_pre_process__78306$combined_pre_process_STAR___78307.invoke(query_processor.clj:257)
	at metabase.query_processor.middleware.resolve_database_and_driver$resolve_database_and_driver$fn__76983$fn__76988.invoke(resolve_database_and_driver.clj:36)
	at metabase.driver$do_with_driver.invokeStatic(driver.clj:93)
	at metabase.driver$do_with_driver.invoke(driver.clj:88)
	at metabase.query_processor.middleware.resolve_database_and_driver$resolve_database_and_driver$fn__76983.invoke(resolve_database_and_driver.clj:35)
	at metabase.query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__72965.invoke(fetch_source_query.clj:316)
	at metabase.query_processor.middleware.store$initialize_store$fn__73146$fn__73147.invoke(store.clj:12)
	at metabase.query_processor.store$do_with_store.invokeStatic(store.clj:56)
	at metabase.query_processor.store$do_with_store.invoke(store.clj:50)
	at metabase.query_processor.middleware.store$initialize_store$fn__73146.invoke(store.clj:11)
	at metabase.query_processor.middleware.normalize_query$normalize$fn__77279.invoke(normalize_query.clj:36)
	at metabase.query_processor.reducible$async_qp$qp_STAR___66814$thunk__66816.invoke(reducible.clj:103)
	at metabase.query_processor.reducible$async_qp$qp_STAR___66814.invoke(reducible.clj:109)
	at metabase.query_processor.reducible$async_qp$qp_STAR___66814.invoke(reducible.clj:94)
	at metabase.query_processor.reducible$async_qp$qp_STAR___66814.invoke(reducible.clj:91)
	at clojure.lang.AFn.applyToHelper(AFn.java:154)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.query_processor.reducible$sync_qp$qp_STAR___66826.doInvoke(reducible.clj:129)
	at clojure.lang.RestFn.applyTo(RestFn.java:137)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.query_processor$process_query.invokeStatic(query_processor.clj:295)
	at metabase.query_processor$process_query.doInvoke(query_processor.clj:289)
	at clojure.lang.RestFn.invoke(RestFn.java:410)
	at metabase.db.metadata_queries$qp_query$fn__88274.invoke(metadata_queries.clj:23)
	at metabase.db.metadata_queries$qp_query.invokeStatic(metadata_queries.clj:22)
	at metabase.db.metadata_queries$qp_query.invoke(metadata_queries.clj:20)
	at metabase.db.metadata_queries$field_query.invokeStatic(metadata_queries.clj:33)
	at metabase.db.metadata_queries$field_query.invoke(metadata_queries.clj:31)
	at metabase.db.metadata_queries$fn__88291$field_distinct_values__88300$fn__88303.invoke(metadata_queries.clj:65)
	at metabase.db.metadata_queries$fn__88291$field_distinct_values__88300.invoke(metadata_queries.clj:58)
	at metabase.db.metadata_queries$fn__88291$field_distinct_values__88300$fn__88301.invoke(metadata_queries.clj:62)
	at metabase.db.metadata_queries$fn__88291$field_distinct_values__88300.invoke(metadata_queries.clj:58)
	at clojure.lang.Var.invoke(Var.java:384)
	at metabase.models.field_values$distinct_values.invokeStatic(field_values.clj:318)
	at metabase.models.field_values$distinct_values.invoke(field_values.clj:303)
	at metabase.models.field_values$create_or_update_full_field_values_BANG_.invokeStatic(field_values.clj:345)
	at metabase.models.field_values$create_or_update_full_field_values_BANG_.doInvoke(field_values.clj:337)
	at clojure.lang.RestFn.invoke(RestFn.java:410)
	at metabase.api.field$fn__100043$fn__100044.invoke(field.clj:354)
	at metabase.api.field$fn__100043.invokeStatic(field.clj:353)
	at metabase.api.field$fn__100043.invoke(field.clj:345)
	at compojure.core$wrap_response$fn__44405.invoke(core.clj:160)
	at compojure.core$wrap_route_middleware$fn__44389.invoke(core.clj:132)
	at compojure.core$wrap_route_info$fn__44394.invoke(core.clj:139)
	at compojure.core$wrap_route_matches$fn__44398.invoke(core.clj:151)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__44398.invoke(core.clj:152)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__44398.invoke(core.clj:153)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417.invoke(core.clj:200)
	at metabase.server.middleware.auth$enforce_authentication$fn__100293.invoke(auth.clj:17)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417.invoke(core.clj:200)
	at compojure.core$make_context$handler__44445.invoke(core.clj:290)
	at compojure.core$make_context$fn__44449.invoke(core.clj:300)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$make_context$fn__44449.invoke(core.clj:301)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at metabase.api.routes$fn__112065$fn__112068.invoke(routes.clj:66)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417.invoke(core.clj:200)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.server.routes$fn__112230$fn__112231.doInvoke(routes.clj:70)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417.invoke(core.clj:200)
	at compojure.core$make_context$handler__44445.invoke(core.clj:290)
	at compojure.core$make_context$fn__44449.invoke(core.clj:300)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__44398.invoke(core.clj:153)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__44398.invoke(core.clj:153)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__44398.invoke(core.clj:153)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417$f__44418$respond_SINGLEQUOTE___44419.invoke(core.clj:197)
	at metabase.server.routes$fn__112215$fn__112217.invoke(routes.clj:47)
	at compojure.core$routes$fn__44417$f__44418.invoke(core.clj:198)
	at compojure.core$routes$fn__44417.invoke(core.clj:200)
	at metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__108657.invoke(exceptions.clj:107)
	at metabase.server.middleware.exceptions$catch_api_exceptions$fn__108654.invoke(exceptions.clj:95)
	at metabase.server.middleware.log$log_api_call$fn__112502$fn__112503$fn__112504.invoke(log.clj:216)
	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:18)
	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12)
	at metabase.server.middleware.log$log_api_call$fn__112502$fn__112503.invoke(log.clj:208)
	at toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112)
	at toucan2.execute$do_with_call_counts.invoke(execute.clj:103)
	at metabase.server.middleware.log$log_api_call$fn__112502.invoke(log.clj:207)
	at metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114646.invoke(browser_cookie.clj:42)
	at metabase.server.middleware.security$add_security_headers$fn__90803.invoke(security.clj:153)
	at metabase.server.middleware.json$wrap_json_body$fn__113202.invoke(json.clj:67)
	at metabase.server.middleware.offset_paging$handle_paging$fn__90827.invoke(offset_paging.clj:45)
	at metabase.server.middleware.json$wrap_streamed_json_response$fn__113220.invoke(json.clj:103)
	at ring.middleware.keyword_params$wrap_keyword_params$fn__114913.invoke(keyword_params.clj:55)
	at ring.middleware.params$wrap_params$fn__114932.invoke(params.clj:77)
	at metabase.server.middleware.misc$maybe_set_site_url$fn__57251.invoke(misc.clj:61)
	at metabase.server.middleware.session$reset_session_timeout$fn__71750.invoke(session.clj:457)
	at metabase.server.middleware.session$bind_current_user$fn__71717$fn__71718.invoke(session.clj:352)
	at metabase.server.middleware.session$do_with_current_user.invokeStatic(session.clj:331)
	at metabase.server.middleware.session$do_with_current_user.invoke(session.clj:315)
	at metabase.server.middleware.session$bind_current_user$fn__71717.invoke(session.clj:351)
	at metabase.server.middleware.session$wrap_current_user_info$fn__71698.invoke(session.clj:285)
	at metabase.server.middleware.session$wrap_session_id$fn__71681.invoke(session.clj:217)
	at metabase.server.middleware.auth$wrap_api_key$fn__100301.invoke(auth.clj:30)
	at ring.middleware.cookies$wrap_cookies$fn__114833.invoke(cookies.clj:216)
	at metabase.server.middleware.misc$add_content_type$fn__57233.invoke(misc.clj:29)
	at metabase.server.middleware.misc$disable_streaming_buffering$fn__57259.invoke(misc.clj:78)
	at ring.middleware.gzip$wrap_gzip$fn__114875.invoke(gzip.clj:86)
	at metabase.server.middleware.misc$bind_request$fn__57262.invoke(misc.clj:95)
	at metabase.server.middleware.ssl$redirect_to_https_middleware$fn__114662.invoke(ssl.clj:41)
	at metabase.server$async_proxy_handler$fn__79487.invoke(server.clj:77)
	at metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source)
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)
	at org.eclipse.jetty.server.Server.handle(Server.java:563)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$0(HttpChannel.java:505)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:762)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:497)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:282)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)
	at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:416)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:385)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:272)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.lambda$new$0(AdaptiveExecutionStrategy.java:140)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:936)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1080)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.sql.SQLException: Code: 279. DB::NetException: All connection tries failed. Log: 
There is no table `local`.`ug_users_properties_local` on server: nl40.private:9440
There is no table `local`.`ug_users_properties_local` on server: nl41.private:9440
: While executing Remote. (ALL_CONNECTION_TRIES_FAILED) (version 23.2.6.34 (official build))
, server ClickHouseNode [uri=http://nl41.mu.se:8123/default, options={use_server_time_zone_for_dates=true,use_no_proxy=false,product_name=metabase/1.2.2}]@-1808516779
	at com.clickhouse.jdbc.SqlExceptionUtils.handle(SqlExceptionUtils.java:85)
	at com.clickhouse.jdbc.SqlExceptionUtils.create(SqlExceptionUtils.java:31)
	at com.clickhouse.jdbc.SqlExceptionUtils.handle(SqlExceptionUtils.java:90)
	at com.clickhouse.jdbc.internal.ClickHouseStatementImpl.getLastResponse(ClickHouseStatementImpl.java:122)
	at com.clickhouse.jdbc.internal.ClickHouseStatementImpl.executeQuery(ClickHouseStatementImpl.java:476)
	at com.clickhouse.jdbc.internal.ClickHouseStatementImpl.execute(ClickHouseStatementImpl.java:464)
	at com.mchange.v2.c3p0.impl.NewProxyStatement.execute(NewProxyStatement.java:75)
	at metabase.driver.sql_jdbc.execute$fn__80964.invokeStatic(execute.clj:556)
	at metabase.driver.sql_jdbc.execute$fn__80964.invoke(execute.clj:554)
	at clojure.lang.MultiFn.invoke(MultiFn.java:239)
	at metabase.driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invokeStatic(execute.clj:564)
	at metabase.driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invoke(execute.clj:561)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query$fn__81039$fn__81040.invoke(execute.clj:679)
	... 208 more
Caused by: java.io.IOException: Code: 279. DB::NetException: All connection tries failed. Log: 
There is no table `local`.`ug_users_properties_local` on server: nl40.private:9440
There is no table `local`.`ug_users_properties_local` on server: nl41.private:9440
: While executing Remote. (ALL_CONNECTION_TRIES_FAILED) (version 23.2.6.34 (official build))
	at com.clickhouse.client.http.HttpUrlConnectionImpl.checkResponse(HttpUrlConnectionImpl.java:184)
	at com.clickhouse.client.http.HttpUrlConnectionImpl.post(HttpUrlConnectionImpl.java:227)
	at com.clickhouse.client.http.ClickHouseHttpClient.send(ClickHouseHttpClient.java:124)
	at com.clickhouse.client.AbstractClient.execute(AbstractClient.java:280)
	at com.clickhouse.client.ClickHouseClientBuilder$Agent.sendOnce(ClickHouseClientBuilder.java:282)
	at com.clickhouse.client.ClickHouseClientBuilder$Agent.send(ClickHouseClientBuilder.java:294)
	at com.clickhouse.client.ClickHouseClientBuilder$Agent.execute(ClickHouseClientBuilder.java:349)
	at com.clickhouse.client.ClickHouseClient.executeAndWait(ClickHouseClient.java:1056)
	at com.clickhouse.client.ClickHouseRequest.executeAndWait(ClickHouseRequest.java:2154)
	at com.clickhouse.jdbc.internal.ClickHouseStatementImpl.getLastResponse(ClickHouseStatementImpl.java:120)
	... 217 more

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Linux"",
    ""os.version"": ""3.10.0-1160.95.1.el7.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""clickhouse"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.0 (Debian 16.0-1.pgdg120+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.5.4""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2023-10-26"",
      ""tag"": ""v0.47.6"",
      ""branch"": ""?"",
      ""hash"": ""3a7ed7a""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Blocking usage

### Additional context

_No response_",p-matveev,2024-06-12 17:08:45+00:00,[],2024-07-05 17:41:46+00:00,2024-07-05 17:41:46+00:00,https://github.com/metabase/metabase/issues/44075,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Administration/Metadata & Sync', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2163734579, 'issue_id': 2349285874, 'author': 'calherries', 'body': '@p-matveev Thanks for raising this, I\'m currently trying to work out whether this is an issue with Metabase itself, or the ClickHouse driver ([repo](https://github.com/ClickHouse/metabase-clickhouse-driver)), which is one of Metabase\'s 3rd-party partner drivers.  \r\n\r\nClickHouse itself doesn\'t have schemas like Postgres or H2, only databases. The ClickHouse driver uses databases in place of schemas in many places in Metabase, to allow users to connect to more than one database at a time. So can you clarify for me two things:\r\n(1) are you moving tables from one _database_ to another, not from one schema to another?\r\n(2) have you specified both the new and old databases in the connection settings? (see pic below)\r\n\r\n<img width=""921"" alt=""image"" src=""https://github.com/metabase/metabase/assets/39073188/daaa26aa-51c0-405c-a6f8-d59010ba2a63"">\r\n\r\nI\'m dropping this from P1 to P2 because this is only confirmed for ClickHouse DBs. I\'ve tested with moving tables between schemas on Postgres on master and field values works correctly without throwing any exceptions.', 'created_at': datetime.datetime(2024, 6, 12, 19, 15, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2165531848, 'issue_id': 2349285874, 'author': 'p-matveev', 'body': '@calherries thank you for your reply. \r\nIt seems that we have one more issue regarding this, so I will try to sum up:\r\n\r\n1. Metabase doesn\'t see any **new** created tables at all (we checked it on tables created for last 2-3 weeks)\r\n2. Metabase doesn\'t see changes in ""location"" - it\'s what initial post was about: after moving table to new schema (and I tried specifying new schema as you recommended - it didn\'t help). \r\n\r\nSo it looks like metabase have metadata snapshot for some moment (maybe the very first database scan) and since then it cannot update it. \r\n\r\nWhen I manually trigger ""Sync database schema now"" I get in logs following:\r\n```\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: Sync metadata for clickhouse Database 2 \'UG Core\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step \'sync-dbms-version\' for clickhouse Database 2 \'UG Core\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step \'sync-dbms-version\' for clickhouse Database 2 \'UG Core\' (12.4 ms)\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step \'sync-timezone\' for clickhouse Database 2 \'UG Core\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step \'sync-timezone\' for clickhouse Database 2 \'UG Core\' (24.3 ms)\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step \'sync-tables\' for clickhouse Database 2 \'UG Core\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step \'sync-tables\' for clickhouse Database 2 \'UG Core\' (2.1 ms)\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step \'sync-fields\' for clickhouse Database 2 \'UG Core\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step \'sync-fields\' for clickhouse Database 2 \'UG Core\' (344.8 ms)\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step \'sync-fks\' for clickhouse Database 2 \'UG Core\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step \'sync-fks\' for clickhouse Database 2 \'UG Core\' (100.6 ms)\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step \'sync-metabase-metadata\' for clickhouse Database 2 \'UG Core\' (76.1 µs)\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step \'sync-metabase-metadata\' for clickhouse Database 2 \'UG Core\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: Sync metadata for clickhouse Database 2 \'UG Core\' (491.8 ms)\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: Analyze data for clickhouse Database 2 \'UG Core\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step \'fingerprint-fields\' for clickhouse Database 2 \'UG Core\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze fingerprint-fields Analyzed [*****·············································] 😢   12% Table 5,295 \'product_ug_local.ug_users_properties_local\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze fingerprint-fields Analyzed [***********·······································] 😒   24% Table 5,298 \'product_ug_local.ugp_shots_metrics_local\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step \'fingerprint-fields\' for clickhouse Database 2 \'UG Core\' (7.2 ms)\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step \'classify-fields\' for clickhouse Database 2 \'UG Core\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-fields Analyzed [******************································] 😕   36% Table 5,293 \'product_ug_local.ugp_courses_metrics_local\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-fields Analyzed [***********************···························] 😬   48% Table 5,296 \'product_ug_local.ug_users_properties_delta_local\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-fields Analyzed [******************************····················] 😌   60% Table 5,291 \'product_ug_local.ugp_active_users_local\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step \'classify-fields\' for clickhouse Database 2 \'UG Core\' (4.6 ms)\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step \'classify-tables\' for clickhouse Database 2 \'UG Core\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-tables Analyzed [************************************··············] 😋   72% Table 5,294 \'product_ug_local.ug_user_attributes_history_local\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-tables Analyzed [*****************************************·········] 😊   84% Table 5,297 \'product_ug_local.ugp_core_retention_raw_local\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-tables Analyzed [***********************************************···] 😎   96% Table 5,292 \'product_ug_local.ugp_seo_winners_losers_local\'\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step \'classify-tables\' for clickhouse Database 2 \'UG Core\' (5.2 ms)\r\n[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: Analyze data for clickhouse Database 2 \'UG Core\' (23.2 ms)\r\n```\r\n\r\nSeems like no errors, but nothing changes. \r\nAdditionally, I see in logs ""step \'fingerprint-fields\'"" but refingerprint is off (I don\'t know if it of any help). \r\nIs there a way to force metadata update maybe?', 'created_at': datetime.datetime(2024, 6, 13, 12, 34, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166804820, 'issue_id': 2349285874, 'author': 'calherries', 'body': 'Okay, thanks for adding this information. I\'m starting to think this is an issue with the ClickHouse driver now. But to confirm, can you:\r\n1. Customize the logging levels (see [the docs](https://www.metabase.com/docs/latest/configuring-metabase/log-configuration)), adding the following logger: `<Logger name=""metabase.sync.util"" level=""DEBUG""/>`\r\n2. Trigger ""Sync database schema now"" and paste the logs here?\r\n\r\nI\'d like to see if there are any errors in the Metabase code, meaning the tables get skipped. If not, then it\'s likely a ClickHouse driver issue where the `driver/describe-database` function ([source](https://github.com/ClickHouse/metabase-clickhouse-driver/blob/master/src/metabase/driver/clickhouse_introspection.clj#L142-L149)) does not pick up the table metadata.\r\n\r\n> Additionally, I see in logs ""step \'fingerprint-fields\'"" but refingerprint is off (I don\'t know if it of any help).\r\n\r\nThankfully that\'s not a bug, ""fingerprint-fields"" is distinct from refingerprinting. So I wouldn\'t worry about that', 'created_at': datetime.datetime(2024, 6, 13, 21, 12, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2185631525, 'issue_id': 2349285874, 'author': 'darksciencebase', 'body': '@p-matveev hi! have you had a chance to change the log configuration? the logs would greatly help investigate (and fix) this issue.', 'created_at': datetime.datetime(2024, 6, 24, 5, 22, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2185817406, 'issue_id': 2349285874, 'author': 'p-matveev', 'body': ""@darksciencebase Hi! Yes, I was just going to leave a message: I'm still waiting for our devops guys to add the logging option, sorry for that. I really hope to come back to in a couple of days. Sorry again for delay."", 'created_at': datetime.datetime(2024, 6, 24, 7, 37, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2210355791, 'issue_id': 2349285874, 'author': 'p-matveev', 'body': ""@darksciencebase Hi, sorry for the delay, had some busy weeks. News is that we updated Metabase to 0.50.6 version and also updated the clickhouse driver and problem seems to be solved. Metabase sees all schemas and table structures. \r\n\r\nOne small thing is that for most of the category fields it defines TYPE = 'No semantic type', which I think causes a bug where field filter doesn't have a dropdown list. But, maybe it's a thing for other issue )\r\nAnyway, thank you for your help and time spent."", 'created_at': datetime.datetime(2024, 7, 5, 7, 35, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2211199525, 'issue_id': 2349285874, 'author': 'calherries', 'body': 'Thanks @p-matveev, can you open another issue with more info + logs about the problem with semantic types?', 'created_at': datetime.datetime(2024, 7, 5, 17, 41, 46, tzinfo=datetime.timezone.utc)}]","calherries on (2024-06-12 19:15:58 UTC): @p-matveev Thanks for raising this, I'm currently trying to work out whether this is an issue with Metabase itself, or the ClickHouse driver ([repo](https://github.com/ClickHouse/metabase-clickhouse-driver)), which is one of Metabase's 3rd-party partner drivers.  

ClickHouse itself doesn't have schemas like Postgres or H2, only databases. The ClickHouse driver uses databases in place of schemas in many places in Metabase, to allow users to connect to more than one database at a time. So can you clarify for me two things:
(1) are you moving tables from one _database_ to another, not from one schema to another?
(2) have you specified both the new and old databases in the connection settings? (see pic below)

<img width=""921"" alt=""image"" src=""https://github.com/metabase/metabase/assets/39073188/daaa26aa-51c0-405c-a6f8-d59010ba2a63"">

I'm dropping this from P1 to P2 because this is only confirmed for ClickHouse DBs. I've tested with moving tables between schemas on Postgres on master and field values works correctly without throwing any exceptions.

p-matveev (Issue Creator) on (2024-06-13 12:34:55 UTC): @calherries thank you for your reply. 
It seems that we have one more issue regarding this, so I will try to sum up:

1. Metabase doesn't see any **new** created tables at all (we checked it on tables created for last 2-3 weeks)
2. Metabase doesn't see changes in ""location"" - it's what initial post was about: after moving table to new schema (and I tried specifying new schema as you recommended - it didn't help). 

So it looks like metabase have metadata snapshot for some moment (maybe the very first database scan) and since then it cannot update it. 

When I manually trigger ""Sync database schema now"" I get in logs following:
```
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: Sync metadata for clickhouse Database 2 'UG Core'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step 'sync-dbms-version' for clickhouse Database 2 'UG Core'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step 'sync-dbms-version' for clickhouse Database 2 'UG Core' (12.4 ms)
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step 'sync-timezone' for clickhouse Database 2 'UG Core'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step 'sync-timezone' for clickhouse Database 2 'UG Core' (24.3 ms)
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step 'sync-tables' for clickhouse Database 2 'UG Core'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step 'sync-tables' for clickhouse Database 2 'UG Core' (2.1 ms)
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step 'sync-fields' for clickhouse Database 2 'UG Core'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step 'sync-fields' for clickhouse Database 2 'UG Core' (344.8 ms)
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step 'sync-fks' for clickhouse Database 2 'UG Core'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step 'sync-fks' for clickhouse Database 2 'UG Core' (100.6 ms)
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step 'sync-metabase-metadata' for clickhouse Database 2 'UG Core' (76.1 µs)
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step 'sync-metabase-metadata' for clickhouse Database 2 'UG Core'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: Sync metadata for clickhouse Database 2 'UG Core' (491.8 ms)
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: Analyze data for clickhouse Database 2 'UG Core'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step 'fingerprint-fields' for clickhouse Database 2 'UG Core'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze fingerprint-fields Analyzed [*****·············································] 😢   12% Table 5,295 'product_ug_local.ug_users_properties_local'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze fingerprint-fields Analyzed [***********·······································] 😒   24% Table 5,298 'product_ug_local.ugp_shots_metrics_local'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step 'fingerprint-fields' for clickhouse Database 2 'UG Core' (7.2 ms)
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step 'classify-fields' for clickhouse Database 2 'UG Core'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-fields Analyzed [******************································] 😕   36% Table 5,293 'product_ug_local.ugp_courses_metrics_local'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-fields Analyzed [***********************···························] 😬   48% Table 5,296 'product_ug_local.ug_users_properties_delta_local'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-fields Analyzed [******************************····················] 😌   60% Table 5,291 'product_ug_local.ugp_active_users_local'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step 'classify-fields' for clickhouse Database 2 'UG Core' (4.6 ms)
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util STARTING: step 'classify-tables' for clickhouse Database 2 'UG Core'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-tables Analyzed [************************************··············] 😋   72% Table 5,294 'product_ug_local.ug_user_attributes_history_local'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-tables Analyzed [*****************************************·········] 😊   84% Table 5,297 'product_ug_local.ugp_core_retention_raw_local'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.analyze classify-tables Analyzed [***********************************************···] 😎   96% Table 5,292 'product_ug_local.ugp_seo_winners_losers_local'
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: step 'classify-tables' for clickhouse Database 2 'UG Core' (5.2 ms)
[d79964c8-415f-44de-a8b0-b625fafb9161] 2024-06-13T14:25:21+02:00 INFO metabase.sync.util FINISHED: Analyze data for clickhouse Database 2 'UG Core' (23.2 ms)
```

Seems like no errors, but nothing changes. 
Additionally, I see in logs ""step 'fingerprint-fields'"" but refingerprint is off (I don't know if it of any help). 
Is there a way to force metadata update maybe?

calherries on (2024-06-13 21:12:45 UTC): Okay, thanks for adding this information. I'm starting to think this is an issue with the ClickHouse driver now. But to confirm, can you:
1. Customize the logging levels (see [the docs](https://www.metabase.com/docs/latest/configuring-metabase/log-configuration)), adding the following logger: `<Logger name=""metabase.sync.util"" level=""DEBUG""/>`
2. Trigger ""Sync database schema now"" and paste the logs here?

I'd like to see if there are any errors in the Metabase code, meaning the tables get skipped. If not, then it's likely a ClickHouse driver issue where the `driver/describe-database` function ([source](https://github.com/ClickHouse/metabase-clickhouse-driver/blob/master/src/metabase/driver/clickhouse_introspection.clj#L142-L149)) does not pick up the table metadata.


Thankfully that's not a bug, ""fingerprint-fields"" is distinct from refingerprinting. So I wouldn't worry about that

darksciencebase on (2024-06-24 05:22:46 UTC): @p-matveev hi! have you had a chance to change the log configuration? the logs would greatly help investigate (and fix) this issue.

p-matveev (Issue Creator) on (2024-06-24 07:37:51 UTC): @darksciencebase Hi! Yes, I was just going to leave a message: I'm still waiting for our devops guys to add the logging option, sorry for that. I really hope to come back to in a couple of days. Sorry again for delay.

p-matveev (Issue Creator) on (2024-07-05 07:35:29 UTC): @darksciencebase Hi, sorry for the delay, had some busy weeks. News is that we updated Metabase to 0.50.6 version and also updated the clickhouse driver and problem seems to be solved. Metabase sees all schemas and table structures. 

One small thing is that for most of the category fields it defines TYPE = 'No semantic type', which I think causes a bug where field filter doesn't have a dropdown list. But, maybe it's a thing for other issue )
Anyway, thank you for your help and time spent.

calherries on (2024-07-05 17:41:46 UTC): Thanks @p-matveev, can you open another issue with more info + logs about the problem with semantic types?

"
2349131974,issue,closed,completed,Users with No Access to the Collection Our Analytics are not able to use the Query Editor for Saved Questions/Models,"### Describe the bug

Users with No Access to the Collection Our Analytics are not able to use the Query Editor for Saved Questions/Models

### To Reproduce

1) Go to People -> Groups -> New Group -> Name it Test and Save
2) Go to People -> People -> Invite Someone -> Add it to Group Test
3) Go to Permissions -> Collections -> Give No Access to Test and All Users to Our Analytics 

<img width=""1510"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/82308b74-22a1-4445-8781-01df98b7fbaf"">

4) Go to Permissions -> Data -> Give View and query builder only

<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/2fa284db-0200-4df0-9d8f-2c953c3293d3"">

5) Then login as that user and try to use a saved question or Model

<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/f4d98265-888f-4052-8223-1b02dadc9746"">


### Expected behavior

 I expect the user to have access to his personal collection and other collections ... since even giving him access to a new collection doesn't work

### Logs

GET /api/collection/root 403 71.3 ms (2 DB calls) {:metabase-user-id 2} 
""You don't have permissions to do that.""


### Information about your Metabase installation

```JSON
50.0
```


### Severity

blocker

### Additional context

Seems to be related to https://github.com/metabase/metabase/issues/30355 and other issues with removing access to the Root collection (Our Analytics)

Also seems that the issue from https://github.com/metabase/metabase/issues/38856 moved to somewhere else",Tony-metabase,2024-06-12 15:56:35+00:00,['ranquild'],2024-06-13 03:52:11+00:00,2024-06-13 03:52:11+00:00,https://github.com/metabase/metabase/issues/44071,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Administration/Permissions', 'Collection or Data permissions'), ('Organization/Saved Questions', ''), ('.Frontend', ''), ('.Escalation', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2163405705, 'issue_id': 2349131974, 'author': 'bshepherdson', 'body': 'Known issue. Fixed, backported, and release in flight.', 'created_at': datetime.datetime(2024, 6, 12, 16, 0, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163411561, 'issue_id': 2349131974, 'author': 'bshepherdson', 'body': 'https://github.com/metabase/metabase/issues/44043 we fail to fetch metadata for users without permissions to see tables.\r\n\r\nI\'m not entirely sure why that\'s surfaced as a permissions error here. But we use missing metadata as a signal for ""no permissions"" sometimes.\r\n\r\nI won\'t close this in case there\'s some extra problem here. Try it on master after the fix? #44052.', 'created_at': datetime.datetime(2024, 6, 12, 16, 2, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163501200, 'issue_id': 2349131974, 'author': 'sloansparger', 'body': '@Tony-metabase I was not able to reproduce the issue on the 50.1 JAR following the steps above. The issue should be fixed.', 'created_at': datetime.datetime(2024, 6, 12, 16, 52, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163628483, 'issue_id': 2349131974, 'author': 'Tony-metabase', 'body': '@sloansparger still an issue and i am on version 50.1\r\n\r\n<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/4bc09631-dc4b-4ec5-89f7-0c2115ee9421"">\r\n\r\n\r\n<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/845c631e-77ef-4ac0-8257-3610ce5d1aaf"">', 'created_at': datetime.datetime(2024, 6, 12, 18, 6, 55, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2024-06-12 16:00:03 UTC): Known issue. Fixed, backported, and release in flight.

bshepherdson on (2024-06-12 16:02:55 UTC): https://github.com/metabase/metabase/issues/44043 we fail to fetch metadata for users without permissions to see tables.

I'm not entirely sure why that's surfaced as a permissions error here. But we use missing metadata as a signal for ""no permissions"" sometimes.

I won't close this in case there's some extra problem here. Try it on master after the fix? #44052.

sloansparger on (2024-06-12 16:52:44 UTC): @Tony-metabase I was not able to reproduce the issue on the 50.1 JAR following the steps above. The issue should be fixed.

Tony-metabase (Issue Creator) on (2024-06-12 18:06:55 UTC): @sloansparger still an issue and i am on version 50.1

<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/4bc09631-dc4b-4ec5-89f7-0c2115ee9421"">


<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/845c631e-77ef-4ac0-8257-3610ce5d1aaf"">

"
2349111678,issue,closed,completed,Stacked bar chart doesn't display correct group's values on hover,"### Describe the bug

I have a table with some numeric values, a category column and date column. I created a question from it using the editor (not SQL). I grouped by this table on the category and date->month with aggregation being the sum of the numeric column (nothing fancy). Note that for some of the types the values are always negative. I created a stacked bar chart in the visualisation options (x is date->month, y is sum of the numeric value per category) and reorder the groups (aka categories block). Everything looked good at first, the table is filled correctly.

However when I hover the stacks it shows me only one category value regardless of the group color I hover and sometimes the value is NaN (see screenshots).

<img width=""354"" alt=""Screenshot 2024-06-12 at 17 10 22"" src=""https://github.com/metabase/metabase/assets/69579602/5e206be7-9a9e-4098-8002-20154f5d3ad7"">
<img width=""494"" alt=""Screenshot 2024-06-12 at 17 10 40"" src=""https://github.com/metabase/metabase/assets/69579602/fa78ff7d-a260-4d0c-9b3e-3b1b028d9628"">

It's not happening to all stacked bar charts. I tried to filter out negative values but I either:
- Get the same result if I put the filter just after the data source in the editor
- Get no chart at all (aka the grey default chart usually displayed when the chart is loading, but nothing load) if I put the filter after the summarize.

### To Reproduce

1. Go to Metabase, create a question from a table which has at least a decimal column, a date/timestamp column and a category column (string). Maybe the table needs to have only negative values for some categories.
2. In the editor, summarize the table with a sum of the numeric column grouped by the category column and the date column by month.
3. Click visualize, check that the table look nice (no null values)
4. Click visualization, select ""Bar"".
5. In the settings reorder some of the X-axis groups and set the stacking to ""Stack"", set the ""stacked chart type"" to bars, turn on ""Show values on data point"", with ""Values to show"" set to ""All"" and ""Auto formatting"" to ""Auto"".
6. Click ""done""
7. The bar chart looks ok but when hovering the stacks you can notice the bug.

### Expected behavior

When hovering a stack's group I should see this group's value with other groups' values and their % as shown below:
<img width=""507"" alt=""Screenshot 2024-06-12 at 17 41 38"" src=""https://github.com/metabase/metabase/assets/69579602/6c846394-527c-4927-95fd-6e90bf2fc58d"">


### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""17.0.11+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""17.0.11"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""17.0.11+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.58+"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Etc/UTC""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""13.13""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-07"",
      ""tag"": ""v0.49.15"",
      ""hash"": ""55821ac""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Annoying

### Additional context

_No response_",Timelessprod,2024-06-12 15:47:35+00:00,[],2024-07-15 09:25:13+00:00,2024-07-15 09:25:12+00:00,https://github.com/metabase/metabase/issues/44070,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2207204045, 'issue_id': 2349111678, 'author': 'JesseSDevaney', 'body': 'Hey @Timelessprod!\r\n\r\nThank you for reporting the issue you are experiencing. I just picked this up to start working on it, but I am unable to reproduce your issue.\r\n\r\n---\r\nWould you be able to check if the issue is still occurring? \r\n\r\nAnd if so, provide more detailed reproduction steps like what the actual data looks like - provided that any _sensitive information_ you do not want to be seen is removed.\r\n\r\nMore specifically, if this is still occurring, would you be able to send a view of what your reproducible data looks like and note which exact stack/category is experiencing the issue?\r\n\r\nFor example:\r\n![image](https://github.com/metabase/metabase/assets/22608765/67368f93-0c6e-4557-9c6a-ddf91a51cf1a)\r\n""It is the 2024 year stack that has broken tool-tip values displayed""', 'created_at': datetime.datetime(2024, 7, 3, 20, 30, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2228059817, 'issue_id': 2349111678, 'author': 'Timelessprod', 'body': 'The bug has been resolved by upgrading to v0.50.10 :D', 'created_at': datetime.datetime(2024, 7, 15, 9, 25, 12, tzinfo=datetime.timezone.utc)}]","JesseSDevaney on (2024-07-03 20:30:28 UTC): Hey @Timelessprod!

Thank you for reporting the issue you are experiencing. I just picked this up to start working on it, but I am unable to reproduce your issue.

---
Would you be able to check if the issue is still occurring? 

And if so, provide more detailed reproduction steps like what the actual data looks like - provided that any _sensitive information_ you do not want to be seen is removed.

More specifically, if this is still occurring, would you be able to send a view of what your reproducible data looks like and note which exact stack/category is experiencing the issue?

For example:
![image](https://github.com/metabase/metabase/assets/22608765/67368f93-0c6e-4557-9c6a-ddf91a51cf1a)
""It is the 2024 year stack that has broken tool-tip values displayed""

Timelessprod (Issue Creator) on (2024-07-15 09:25:12 UTC): The bug has been resolved by upgrading to v0.50.10 :D

"
2349106381,issue,closed,not_planned,"Users unable to load dashboard due to 'syntax error at or near "")""'","### Describe the bug

Users visiting dashboard they could view in 0.49.x can no longer do so in 0.50.0

We have repeated errors in our logs, triggered for different user ids and dashboard ids, that all log the same error.

The core of the issue seems to be Metabase issuing an improper query in the form `""SELECT * FROM ""metabase_database"" WHERE ""id"" IN ()""` (n.b. no ids or placeholders are given)

Logs included below.

### To Reproduce

Cannot consistently reproduce; some users can view the dashboard normally, but others trigger the above error.

### Expected behavior

Dashboards that loaded in 0.49 should continue to load in 0.50

### Logs

```
[ae7775f3-42f4-46ef-b1dc-66830a1bc2a1] 2024-06-12T10:37:21-04:00 ERROR metabase.server.middleware.log GET /api/dashboard/201/query_metadata 500 334.7 ms (71 DB calls) {:metabase-user-id 48} 
{:via
 [{:type clojure.lang.ExceptionInfo,
   :message ""ERROR: syntax error at or near \"")\""\n  Position: 50"",
   :data
   {:toucan2/context-trace
    [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection""
      {:toucan2.jdbc.query/sql-args [""SELECT * FROM \""metabase_database\"" WHERE \""id\"" IN ()""]}]
     [""resolve connection"" {:toucan2.connection/connectable metabase.db.connection.ApplicationDB}]
     [""resolve connection"" {:toucan2.connection/connectable :default}]
     [""resolve connection"" {:toucan2.connection/connectable nil}]
     {:toucan2.pipeline/rf
      #object[clojure.core$map$fn__5931$fn__5932 0x3304f710 ""clojure.core$map$fn__5931$fn__5932@3304f710""]}
     [""with compiled query""
      {:toucan2.pipeline/compiled-query [""SELECT * FROM \""metabase_database\"" WHERE \""id\"" IN ()""]}]
     [""with built query""
      {:toucan2.pipeline/built-query {:select [:*], :from [[:metabase_database]], :where [:in :id #{}]}}]
     [""with resolved query"" {:toucan2.pipeline/resolved-query {}}]
     [""with parsed args""
      {:toucan2.pipeline/query-type :toucan.query-type/select.instances,
       :toucan2.pipeline/parsed-args {:kv-args {:id [:in #{}]}, :queryable {}}}]
     [""with model"" {:toucan2.pipeline/model :model/Database}]
     [""with unparsed args""
      {:toucan2.pipeline/query-type :toucan.query-type/select.instances,
       :toucan2.pipeline/unparsed-args (:model/Database :id [:in #{}])}]]},
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse ""QueryExecutorImpl.java"" 2725]}
  {:type org.postgresql.util.PSQLException,
   :message ""ERROR: syntax error at or near \"")\""\n  Position: 50"",
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse ""QueryExecutorImpl.java"" 2725]}],
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse ""QueryExecutorImpl.java"" 2725]
  [org.postgresql.core.v3.QueryExecutorImpl processResults ""QueryExecutorImpl.java"" 2412]
  [org.postgresql.core.v3.QueryExecutorImpl execute ""QueryExecutorImpl.java"" 371]
  [org.postgresql.jdbc.PgStatement executeInternal ""PgStatement.java"" 502]
  [org.postgresql.jdbc.PgStatement execute ""PgStatement.java"" 419]
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.79-99.164.amzn2023.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.2""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-10"",
      ""tag"": ""v0.50.0"",
      ""hash"": ""4fe42d3""
    },
    ""settings"": {
      ""report-timezone"": ""America/New_York""
    }
  }
}
```


### Severity

blocking some users

### Additional context

_No response_",jamesvl,2024-06-12 15:44:46+00:00,[],2024-06-12 15:51:20+00:00,2024-06-12 15:48:36+00:00,https://github.com/metabase/metabase/issues/44069,"[('Type:Bug', 'Product defects'), ('.Backend', ''), ('.Needs Triage', '')]","[{'comment_id': 2163382044, 'issue_id': 2349106381, 'author': 'ranquild', 'body': 'Duplicate of https://github.com/metabase/metabase/issues/44043', 'created_at': datetime.datetime(2024, 6, 12, 15, 48, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163387916, 'issue_id': 2349106381, 'author': 'jamesvl', 'body': 'Agreed; I tried looking first for anything similar...\r\n\r\nMay close this one as a dupe.', 'created_at': datetime.datetime(2024, 6, 12, 15, 51, 20, tzinfo=datetime.timezone.utc)}]","ranquild on (2024-06-12 15:48:36 UTC): Duplicate of https://github.com/metabase/metabase/issues/44043

jamesvl (Issue Creator) on (2024-06-12 15:51:20 UTC): Agreed; I tried looking first for anything similar...

May close this one as a dupe.

"
2349094445,issue,closed,completed,Spike how hard it would be to maintain the previous `theme=transparent` behavior alongside the new transparent background setting,[Product doc](https://www.notion.so/metabase/Re-design-transparent-theme-for-static-embedding-and-public-links-a28e98a6e5c64301a48387c7b333d569),WiNloSt,2024-06-12 15:39:54+00:00,['WiNloSt'],2024-06-14 15:12:08+00:00,2024-06-14 15:12:08+00:00,https://github.com/metabase/metabase/issues/44068,[],"[{'comment_id': 2168246158, 'issue_id': 2349094445, 'author': 'WiNloSt', 'body': '- [Tech doc](https://www.notion.so/metabase/Tech-Re-design-transparent-theme-for-static-embedding-and-public-links-cbe2cb4f0ea247dc9ac91a072687deb1)\r\n- [Testing plan](https://www.notion.so/metabase/Testing-plan-3e67037b08434033a5f653c83c622e92)', 'created_at': datetime.datetime(2024, 6, 14, 15, 12, 8, tzinfo=datetime.timezone.utc)}]","WiNloSt (Issue Creator) on (2024-06-14 15:12:08 UTC): - [Tech doc](https://www.notion.so/metabase/Tech-Re-design-transparent-theme-for-static-embedding-and-public-links-cbe2cb4f0ea247dc9ac91a072687deb1)
- [Testing plan](https://www.notion.so/metabase/Testing-plan-3e67037b08434033a5f653c83c622e92)

"
2349047840,issue,closed,completed,add logic to hide the download results button for dashcards,,npretto,2024-06-12 15:18:11+00:00,['npretto'],2024-06-18 14:16:32+00:00,2024-06-18 14:16:32+00:00,https://github.com/metabase/metabase/issues/44067,[],[],
2348988572,issue,closed,not_planned,"When you comment out a filter in the code editor, it still appears in the question","### Describe the bug

When you comment out a filter in the code editor, it still appears in the question. This is a bug. So you ahve to totally delete the line which is bit annoying

### To Reproduce

* Create a new metabase sql query
* Add a filter or optional filter with [[ {{}} ]] syntax
* See the filter appear at top of query
* THe comment out the optional filter
* See the filter still at top of query
* Unable to run code

### Expected behavior

If a line is commented out in the code editor, even if it is an optional filter, dont actually run that code/ filter should not appear at top and code sholud be able to run

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.215-203.850.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""snowflake"",
      ""redshift""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.7""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.6.0""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-03-04"",
      ""tag"": ""v0.48.8"",
      ""hash"": ""a900c85""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Annoying, 

### Additional context

_No response_",aarthi-subramanian,2024-06-12 14:52:01+00:00,[],2024-06-12 15:01:09+00:00,2024-06-12 14:59:48+00:00,https://github.com/metabase/metabase/issues/44065,"[('Type:Bug', 'Product defects'), ('Browser:Chrome', ''), ('Querying/Native', 'The SQL/native query editor'), ('.Needs Triage', '')]","[{'comment_id': 2163254759, 'issue_id': 2348988572, 'author': 'paoliniluis', 'body': ""I have a strong belief that this is already in our issue tracker, but I can't find it"", 'created_at': datetime.datetime(2024, 6, 12, 14, 55, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163264548, 'issue_id': 2348988572, 'author': 'paoliniluis', 'body': 'ahhh yes, https://github.com/metabase/metabase/issues/33585', 'created_at': datetime.datetime(2024, 6, 12, 14, 59, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163267658, 'issue_id': 2348988572, 'author': 'aarthi-subramanian', 'body': 'ok thanks !!', 'created_at': datetime.datetime(2024, 6, 12, 15, 1, 7, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-12 14:55:45 UTC): I have a strong belief that this is already in our issue tracker, but I can't find it

paoliniluis on (2024-06-12 14:59:48 UTC): ahhh yes, https://github.com/metabase/metabase/issues/33585

aarthi-subramanian (Issue Creator) on (2024-06-12 15:01:07 UTC): ok thanks !!

"
2348983996,issue,open,,No option to select multiple values in dropdown filter,"### Describe the bug

There is no option to select multiple values (only single!) when you add a dropdown filter to a query :( :( . It's pretty frustrating.

The workaround suggested in some online chat was to use ""Field Filters"" but then field filters dont allow searching a metabase question to populate the values- can only select from a model!! It's been pretty frustrating and inhibits self-service.

### To Reproduce

* Create a new query
* Add a dropdown filter
* Try clicking around and cant allow selection of multiple values in dropdown
* Try workaround by clicking field filter
* Try clicking around and cant allow selection of values from another metabase question OR custom values- only models so this workaround doesnt work

### Expected behavior

Allow option to select multiple values in dropdown filter

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.215-203.850.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""snowflake"",
      ""redshift""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.7""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.6.0""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-03-04"",
      ""tag"": ""v0.48.8"",
      ""hash"": ""a900c85""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Blocking some users

### Additional context

_No response_",aarthi-subramanian,2024-06-12 14:50:04+00:00,[],2025-02-04 20:31:05+00:00,,https://github.com/metabase/metabase/issues/44064,"[('Type:New Feature', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Querying/Native', 'The SQL/native query editor'), ('.Team/Querying', '')]","[{'comment_id': 2163258099, 'issue_id': 2348983996, 'author': 'paoliniluis', 'body': ""sorry, I don't understand the issue here. Can you please explain a little bit further with practical examples? we need the examples or otherwise this is not an issue"", 'created_at': datetime.datetime(2024, 6, 12, 14, 57, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163262121, 'issue_id': 2348983996, 'author': 'ranquild', 'body': '@aarthi-subramanian I just tried using a custom dropdown source for a field filter parameter in a native query and I was able to use both a question and a list of custom values; I was able to pick multiple values in my filter widget. Is there something different in your case?\r\n\r\n<img width=""1722"" alt=""Screenshot 2024-06-12 at 10 56 48"" src=""https://github.com/metabase/metabase/assets/8542534/f2f980b1-a49a-47cb-bd99-46e770b6c6e3"">\r\n<img width=""1165"" alt=""Screenshot 2024-06-12 at 10 56 53"" src=""https://github.com/metabase/metabase/assets/8542534/d3d9412a-0688-4f0a-b52b-19346877e4d4"">', 'created_at': datetime.datetime(2024, 6, 12, 14, 58, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163276376, 'issue_id': 2348983996, 'author': 'aarthi-subramanian', 'body': 'Thank you @ranquild !\r\n\r\nSo when i try ""Field filter"", my right sidebar looks different. It doesnt offer ""from another model or question""-\r\n<img width=""1899"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/205cf516-2039-4305-be1b-02d56c4b6b98"">\r\n\r\n<img width=""271"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/af504512-41ba-4824-98c8-df75352814d3"">', 'created_at': datetime.datetime(2024, 6, 12, 15, 5, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163278456, 'issue_id': 2348983996, 'author': 'ranquild', 'body': '@aarthi-subramanian Select ""Field to map to"" to some database column.', 'created_at': datetime.datetime(2024, 6, 12, 15, 6, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163278530, 'issue_id': 2348983996, 'author': 'aarthi-subramanian', 'body': 'version-\r\n<img width=""800"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/5ebb0ff5-3d97-40b5-926b-60ddbf08db16"">', 'created_at': datetime.datetime(2024, 6, 12, 15, 6, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163280339, 'issue_id': 2348983996, 'author': 'ranquild', 'body': 'I.e. see \r\n<img width=""441"" alt=""Screenshot 2024-06-12 at 11 06 31"" src=""https://github.com/metabase/metabase/assets/8542534/b79eb384-4cad-4af6-adb7-74724098e099"">\r\n\r\n<img width=""405"" alt=""Screenshot 2024-06-12 at 11 06 39"" src=""https://github.com/metabase/metabase/assets/8542534/a77303d7-c2dc-4909-8cff-f7f60c776993"">', 'created_at': datetime.datetime(2024, 6, 12, 15, 6, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163281744, 'issue_id': 2348983996, 'author': 'aarthi-subramanian', 'body': '> @aarthi-subramanian Select ""Field to map to"" to some database column.\r\n\r\nYes! And then i get that second screenshot attached [above](https://github.com/metabase/metabase/issues/44064#issuecomment-2163276376). Again here-\r\n<img width=""269"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/4248d672-efae-4a4d-b860-8c331b51ea54"">', 'created_at': datetime.datetime(2024, 6, 12, 15, 7, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163283653, 'issue_id': 2348983996, 'author': 'ranquild', 'body': 'You need to select a schema first. `Public` and `Scratch` are the schemas in your database. After you click on either `Public` or `Scratch`, you would need to select a table, and then a field in this table that corresponds to the variable in the sql query.', 'created_at': datetime.datetime(2024, 6, 12, 15, 8, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163293013, 'issue_id': 2348983996, 'author': 'aarthi-subramanian', 'body': 'Hi yeah so if i pick `public` or `scratch` schema, they will then provide options of models saved. But not options of METABASE QUESTIONS/ temp queries or custom values like i mentioned in the top description. Is this possible? This is possible for variable type ""Text"" -> dropdownlist --> edit --> ""from another model or question"" or ""custom values""\r\n\r\n<img width=""284"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/65f7052e-cc4f-433c-9c08-efc345cee825"">\r\n\r\n\r\n<img width=""1239"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/f2b1dc9d-507c-4ace-ad6a-689da874345e"">', 'created_at': datetime.datetime(2024, 6, 12, 15, 12, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163304442, 'issue_id': 2348983996, 'author': 'ranquild', 'body': '@aarthi-subramanian when you select a schema, you need select the actual database table and the field for this variable. This is not the same as what will be used for the dropdown for this filter. For the dropdown, after you selected the database field, you can click on ""Dropdown list"" and pick a question/model for your dropdown options.', 'created_at': datetime.datetime(2024, 6, 12, 15, 17, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163308460, 'issue_id': 2348983996, 'author': 'ranquild', 'body': 'So in my query `SELECT * FROM PRODUCTS WHERE {{a}}` I select `Field filter` type, then pick `Products.Category` for the database field, then click `Dropdown list`, `Edit`, and define a custom list of values for this variable. I can also select a question here. \r\n<img width=""1724"" alt=""Screenshot 2024-06-12 at 11 18 23"" src=""https://github.com/metabase/metabase/assets/8542534/3e7187e5-3774-432d-87f2-9bb33bed0971"">\r\n<img width=""1440"" alt=""Screenshot 2024-06-12 at 11 18 32"" src=""https://github.com/metabase/metabase/assets/8542534/bbcc42f7-cba7-4aac-a5e3-69f47db1e17a"">\r\n<img width=""1723"" alt=""Screenshot 2024-06-12 at 11 18 37"" src=""https://github.com/metabase/metabase/assets/8542534/d074da0f-1bc5-4313-8273-4c89ab50dc3d"">', 'created_at': datetime.datetime(2024, 6, 12, 15, 19, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163342689, 'issue_id': 2348983996, 'author': 'aarthi-subramanian', 'body': ""HI agh apologies im just not understanding 🙏 . For the `Field to map to...` field, does it have to be a database table and field? Can i not map it to a field defined within the query or from another metabase model or question?\r\n\r\nE.g. Building off your example-\r\n```\r\nSELECT \r\n    *,\r\n    IFF(category = 'A', true, false) is_category_a\r\nFROM products\r\nWHERE {{is_category_A}}\r\n```\r\n* ^ can i apply a field filter that maps to `is_category_a` and i want to be able to select in the filter, just true, just false and BOTh true and false.\r\n\r\nIs this possible?"", 'created_at': datetime.datetime(2024, 6, 12, 15, 34, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163355618, 'issue_id': 2348983996, 'author': 'ranquild', 'body': '@aarthi-subramanian a field filter implies you want to filter on a database field, so `{{category}}` translates to `public.PRODUCTS.CATEGORY = {0}` in the db request. If you don\'t need that, you can use a regular text variable. Please note that with regular text variables you cannot select multiple options in the list. If you need multiple options, you would have to have multiple values in each row coming from your custom list or a source question used for dropdown values.\r\n\r\n<img width=""1728"" alt=""Screenshot 2024-06-12 at 11 40 31"" src=""https://github.com/metabase/metabase/assets/8542534/6d3dacbe-6639-43ef-a57b-deaae7673c5b"">\r\n<img width=""1151"" alt=""Screenshot 2024-06-12 at 11 40 38"" src=""https://github.com/metabase/metabase/assets/8542534/e3ca2c91-293e-4cde-9831-836743fe2536"">\r\n<img width=""560"" alt=""Screenshot 2024-06-12 at 11 40 42"" src=""https://github.com/metabase/metabase/assets/8542534/3bbc70ff-ec60-4455-a12f-7acff6eb0fc4"">', 'created_at': datetime.datetime(2024, 6, 12, 15, 40, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163666538, 'issue_id': 2348983996, 'author': 'aarthi-subramanian', 'body': '> @aarthi-subramanian a field filter implies you want to filter on a database field, so `{{category}}` translates to `public.PRODUCTS.CATEGORY = {0}` in the db request. If you don\'t need that, you can use a regular text variable. Please note that with regular text variables you cannot select multiple options in the list. If you need multiple options, you would have to have multiple values in each row coming from your custom list or a source question used for dropdown values.\r\n> \r\n\r\nHI thanks so this is what my whole issue post is about/ /described at top.\r\n* Variable type ""Field filter"" doesnt work for me. Sounds like it is bcos this only supports filtering on a db field.\r\n* So i been trying to make variable type ""text"" work. But this doesnt allow selecting multiple options on the list.\r\n\r\nCan we add the ability to select multiple options on variable type ""text"" ? Me and my team have a tonne of use cases for this. If better, we can switch this ticket from bug and instead a feature request.', 'created_at': datetime.datetime(2024, 6, 12, 18, 30, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168309260, 'issue_id': 2348983996, 'author': 'ranquild', 'body': '@aarthi-subramanian changed the type to ""new feature"".', 'created_at': datetime.datetime(2024, 6, 14, 15, 49, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168477614, 'issue_id': 2348983996, 'author': 'paoliniluis', 'body': '@aarthi-subramanian how would you compile the query in a query like ""SELECT FIELD FROM TABLE WHERE CONDITION= {{X}}"" here?', 'created_at': datetime.datetime(2024, 6, 14, 17, 36, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2346582596, 'issue_id': 2348983996, 'author': 'paulrosenzweig', 'body': 'I think this was covered elsewhere in the thread, but just to summarize:\r\n\r\n### The problem\r\n\r\nThere\'s no way to get multi-select on a column that doesn\'t exist in the database. Text and field filters each come close, but neither fully enable this today. \r\n\r\n### Possible features to enable this\r\n\r\n#### Option 1 – Update text filters to allow multi-select.\r\n\r\nCurrently, text filters interpolate a single string. `where [[foo = {{my_var}}]]` -> `where foo = \'bar\'`.\r\n\r\nThis could be extended with a ""allow multi-select"" option. Users would write sql to expect list of strings. `where [[foo in {{my_var}}]]` -> `where foo in (\'bar\', \'baz\')`. All existing questions would have to default to having this option off.  \r\n\r\n#### Option 2 – Allow field filters to filter columns on saved questions. \r\n\r\nCurrently, field filters can only connect to columns on db tables.\r\n\r\nLet\'s imagine there\'s a saved question with a result set that looks like this:\r\n\r\n| bucket_name | bucket_start | bucket_end |\r\n|-------------|--------------|------------|\r\n| $0-10       | 0            | 9.99       |\r\n| $10-25      | 10           | 24.99      |\r\n| $25+        | 25           | 1000       |\r\n\r\nWe might not have that table materialized in the db, and instead we use it like this:\r\n\r\n```sql\r\nselect *\r\nfrom transactions\r\njoin {{#123-transaction-buckets}}\r\non amount between bucket_start and bucket_end\r\n[[where {{bucket_name}}]]\r\n```\r\n\r\nThis feels like a natural extension of today\'s field filters. The one bit of trickiness is around how to generate the name of the field filter column. I think it would have to be just the column name (`""bucket_name""`), but I could imagine adding an option to specify a fully qualified name (`""my_table_alias"".""bucket_name""`).', 'created_at': datetime.datetime(2024, 9, 12, 15, 15, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2515175359, 'issue_id': 2348983996, 'author': 'joaofonsecapromptly', 'body': 'Select multiple values does work in single questions\n\n![Image](https://github.com/user-attachments/assets/28678cfd-3ef1-46a5-8835-7efd557f2716)\n\nBut not in dashboards\n\n![Image](https://github.com/user-attachments/assets/4a1158d9-b92a-4bff-a26c-8c23dec604fa)\n![Image](https://github.com/user-attachments/assets/be06d22f-2b04-453a-986f-779792e5a338)', 'created_at': datetime.datetime(2024, 12, 3, 17, 29, 7, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-12 14:57:02 UTC): sorry, I don't understand the issue here. Can you please explain a little bit further with practical examples? we need the examples or otherwise this is not an issue

ranquild on (2024-06-12 14:58:45 UTC): @aarthi-subramanian I just tried using a custom dropdown source for a field filter parameter in a native query and I was able to use both a question and a list of custom values; I was able to pick multiple values in my filter widget. Is there something different in your case?

<img width=""1722"" alt=""Screenshot 2024-06-12 at 10 56 48"" src=""https://github.com/metabase/metabase/assets/8542534/f2f980b1-a49a-47cb-bd99-46e770b6c6e3"">
<img width=""1165"" alt=""Screenshot 2024-06-12 at 10 56 53"" src=""https://github.com/metabase/metabase/assets/8542534/d3d9412a-0688-4f0a-b52b-19346877e4d4"">

aarthi-subramanian (Issue Creator) on (2024-06-12 15:05:04 UTC): Thank you @ranquild !

So when i try ""Field filter"", my right sidebar looks different. It doesnt offer ""from another model or question""-
<img width=""1899"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/205cf516-2039-4305-be1b-02d56c4b6b98"">

<img width=""271"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/af504512-41ba-4824-98c8-df75352814d3"">

ranquild on (2024-06-12 15:06:04 UTC): @aarthi-subramanian Select ""Field to map to"" to some database column.

aarthi-subramanian (Issue Creator) on (2024-06-12 15:06:06 UTC): version-
<img width=""800"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/5ebb0ff5-3d97-40b5-926b-60ddbf08db16"">

ranquild on (2024-06-12 15:06:57 UTC): I.e. see 
<img width=""441"" alt=""Screenshot 2024-06-12 at 11 06 31"" src=""https://github.com/metabase/metabase/assets/8542534/b79eb384-4cad-4af6-adb7-74724098e099"">

<img width=""405"" alt=""Screenshot 2024-06-12 at 11 06 39"" src=""https://github.com/metabase/metabase/assets/8542534/a77303d7-c2dc-4909-8cff-f7f60c776993"">

aarthi-subramanian (Issue Creator) on (2024-06-12 15:07:34 UTC): Yes! And then i get that second screenshot attached [above](https://github.com/metabase/metabase/issues/44064#issuecomment-2163276376). Again here-
<img width=""269"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/4248d672-efae-4a4d-b860-8c331b51ea54"">

ranquild on (2024-06-12 15:08:25 UTC): You need to select a schema first. `Public` and `Scratch` are the schemas in your database. After you click on either `Public` or `Scratch`, you would need to select a table, and then a field in this table that corresponds to the variable in the sql query.

aarthi-subramanian (Issue Creator) on (2024-06-12 15:12:39 UTC): Hi yeah so if i pick `public` or `scratch` schema, they will then provide options of models saved. But not options of METABASE QUESTIONS/ temp queries or custom values like i mentioned in the top description. Is this possible? This is possible for variable type ""Text"" -> dropdownlist --> edit --> ""from another model or question"" or ""custom values""

<img width=""284"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/65f7052e-cc4f-433c-9c08-efc345cee825"">


<img width=""1239"" alt=""image"" src=""https://github.com/metabase/metabase/assets/47357846/f2b1dc9d-507c-4ace-ad6a-689da874345e"">

ranquild on (2024-06-12 15:17:48 UTC): @aarthi-subramanian when you select a schema, you need select the actual database table and the field for this variable. This is not the same as what will be used for the dropdown for this filter. For the dropdown, after you selected the database field, you can click on ""Dropdown list"" and pick a question/model for your dropdown options.

ranquild on (2024-06-12 15:19:36 UTC): So in my query `SELECT * FROM PRODUCTS WHERE {{a}}` I select `Field filter` type, then pick `Products.Category` for the database field, then click `Dropdown list`, `Edit`, and define a custom list of values for this variable. I can also select a question here. 
<img width=""1724"" alt=""Screenshot 2024-06-12 at 11 18 23"" src=""https://github.com/metabase/metabase/assets/8542534/3e7187e5-3774-432d-87f2-9bb33bed0971"">
<img width=""1440"" alt=""Screenshot 2024-06-12 at 11 18 32"" src=""https://github.com/metabase/metabase/assets/8542534/bbcc42f7-cba7-4aac-a5e3-69f47db1e17a"">
<img width=""1723"" alt=""Screenshot 2024-06-12 at 11 18 37"" src=""https://github.com/metabase/metabase/assets/8542534/d074da0f-1bc5-4313-8273-4c89ab50dc3d"">

aarthi-subramanian (Issue Creator) on (2024-06-12 15:34:53 UTC): HI agh apologies im just not understanding 🙏 . For the `Field to map to...` field, does it have to be a database table and field? Can i not map it to a field defined within the query or from another metabase model or question?

E.g. Building off your example-
```
SELECT 
    *,
    IFF(category = 'A', true, false) is_category_a
FROM products
WHERE {{is_category_A}}
```
* ^ can i apply a field filter that maps to `is_category_a` and i want to be able to select in the filter, just true, just false and BOTh true and false.

Is this possible?

ranquild on (2024-06-12 15:40:58 UTC): @aarthi-subramanian a field filter implies you want to filter on a database field, so `{{category}}` translates to `public.PRODUCTS.CATEGORY = {0}` in the db request. If you don't need that, you can use a regular text variable. Please note that with regular text variables you cannot select multiple options in the list. If you need multiple options, you would have to have multiple values in each row coming from your custom list or a source question used for dropdown values.

<img width=""1728"" alt=""Screenshot 2024-06-12 at 11 40 31"" src=""https://github.com/metabase/metabase/assets/8542534/6d3dacbe-6639-43ef-a57b-deaae7673c5b"">
<img width=""1151"" alt=""Screenshot 2024-06-12 at 11 40 38"" src=""https://github.com/metabase/metabase/assets/8542534/e3ca2c91-293e-4cde-9831-836743fe2536"">
<img width=""560"" alt=""Screenshot 2024-06-12 at 11 40 42"" src=""https://github.com/metabase/metabase/assets/8542534/3bbc70ff-ec60-4455-a12f-7acff6eb0fc4"">

aarthi-subramanian (Issue Creator) on (2024-06-12 18:30:57 UTC): HI thanks so this is what my whole issue post is about/ /described at top.
* Variable type ""Field filter"" doesnt work for me. Sounds like it is bcos this only supports filtering on a db field.
* So i been trying to make variable type ""text"" work. But this doesnt allow selecting multiple options on the list.

Can we add the ability to select multiple options on variable type ""text"" ? Me and my team have a tonne of use cases for this. If better, we can switch this ticket from bug and instead a feature request.

ranquild on (2024-06-14 15:49:56 UTC): @aarthi-subramanian changed the type to ""new feature"".

paoliniluis on (2024-06-14 17:36:05 UTC): @aarthi-subramanian how would you compile the query in a query like ""SELECT FIELD FROM TABLE WHERE CONDITION= {{X}}"" here?

paulrosenzweig on (2024-09-12 15:15:26 UTC): I think this was covered elsewhere in the thread, but just to summarize:

### The problem

There's no way to get multi-select on a column that doesn't exist in the database. Text and field filters each come close, but neither fully enable this today. 

### Possible features to enable this

#### Option 1 – Update text filters to allow multi-select.

Currently, text filters interpolate a single string. `where [[foo = {{my_var}}]]` -> `where foo = 'bar'`.

This could be extended with a ""allow multi-select"" option. Users would write sql to expect list of strings. `where [[foo in {{my_var}}]]` -> `where foo in ('bar', 'baz')`. All existing questions would have to default to having this option off.  

#### Option 2 – Allow field filters to filter columns on saved questions. 

Currently, field filters can only connect to columns on db tables.

Let's imagine there's a saved question with a result set that looks like this:

| bucket_name | bucket_start | bucket_end |
|-------------|--------------|------------|
| $0-10       | 0            | 9.99       |
| $10-25      | 10           | 24.99      |
| $25+        | 25           | 1000       |

We might not have that table materialized in the db, and instead we use it like this:

```sql
select *
from transactions
join {{#123-transaction-buckets}}
on amount between bucket_start and bucket_end
[[where {{bucket_name}}]]
```

This feels like a natural extension of today's field filters. The one bit of trickiness is around how to generate the name of the field filter column. I think it would have to be just the column name (`""bucket_name""`), but I could imagine adding an option to specify a fully qualified name (`""my_table_alias"".""bucket_name""`).

joaofonsecapromptly on (2024-12-03 17:29:07 UTC): Select multiple values does work in single questions

![Image](https://github.com/user-attachments/assets/28678cfd-3ef1-46a5-8835-7efd557f2716)

But not in dashboards

![Image](https://github.com/user-attachments/assets/4a1158d9-b92a-4bff-a26c-8c23dec604fa)
![Image](https://github.com/user-attachments/assets/be06d22f-2b04-453a-986f-779792e5a338)

"
2348949320,issue,closed,completed,BE doesn't return mappings for field values,"**Context**

`/api/public/dashboard/:id/params/:paramId/values` doesn't return human readable values, only values.

[Dashboard for testing](https://www.unesco.org/metabase/public/dashboard/0502ba52-e2ca-4bf6-8d3c-a89df5fc822f?themes_and_sub-themes=12594&action=&region=)

<img width=""487"" alt=""image"" src=""https://github.com/metabase/metabase/assets/125459446/7262727a-3a03-4aef-9a87-ed467036295e"">

but for another parameter same url returns both values and mapping

<img width=""618"" alt=""image"" src=""https://github.com/metabase/metabase/assets/125459446/7faab414-aa18-4199-8b54-f1787fb1b0b0"">

At the same time `/dashboard/:id` returns correct `param_values`

<img width=""827"" alt=""image"" src=""https://github.com/metabase/metabase/assets/125459446/e592b889-91da-4dd7-817d-09204ab65391"">

### What needs to be done

- return human readable values together with values from `/values` in public dashboard
- fix format of `param_values` in the dashboard response - combine values and human_readable_values in pairs `[value, human_readable_value]`


NIT: it looks like we don't use all of param_values from `/dashboard` response as we request them separately to get a correct mapping between fields and values, so we can return only values required for displaying initial values (parameter values from the query)



- issue links: https://github.com/metabase/metabase/issues/44047

",uladzimirdev,2024-06-12 14:38:30+00:00,[],2024-06-13 10:28:53+00:00,2024-06-13 10:28:53+00:00,https://github.com/metabase/metabase/issues/44063,"[('Type:Bug', 'Product defects'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Backend', ''), ('Sharing/Public', '')]",[],
2348944887,issue,closed,completed,Investigate parsing errors on stats.metabase.com,"We're currently seeing the majority[^1] of native queries fail during analysis in our private staging environment.

[^1]: 59.3% of ~3000 queries

We should drill into these a bit to make sure we are working on the most impactful improvements.

Some ideas to get going:

- Filter out non-SQL native queries
- Breakdown by driver
- Breakdown by exception message
- Breakdown by presence of SQL keywords

We should create issues for fixing all the issues we find in the parent Epic.",crisptrutski,2024-06-12 14:36:39+00:00,[],2024-07-24 12:17:52+00:00,2024-07-24 12:17:52+00:00,https://github.com/metabase/metabase/issues/44062,"[('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2166565481, 'issue_id': 2348944887, 'author': 'crisptrutski', 'body': ""As a start I looked at all the broken queries without template tags:\r\n\r\n```text\r\ntotal queries: 3073\r\nqueries without template tags: 189 (6.2%)\r\nbroken queries without template tags: (15.3%)\r\n\r\nbroken queries w/tt, by engine:\r\n\r\n- mongo:     1 (not even SQL)\r\n- h2:        4 (all the queries are invalid)\r\n- postgres: 24 (discussed below)\r\n```\r\n\r\nOf the Postgres queries, 21 fail because these use the alias `final`. This is a reserved word for Oracle, hence a reserved word for JSQLParser. This suggests that having some of escaping for reserved word false positives could be useful. AFAIK we can get a list of the *actual* reserved words from metadata on the JDBC connection, but they should be stable enough to just hard code by driver too.\r\n\r\nOne of the above queries also has another issue too  - a `case` statement with no clauses besides an `else`. I'm not sure whether this is allowed by some dialects and not others, but it reminds me of `WHERE x IN ()` which is also illegal for many engines. I'm not sure it's worth caring about.\r\n\r\nThen there are 2 malformed queries, and then there is only 1 final query where we seem to have an interesting parsing issue - we don't seem to handle `BETWEEN` expressions for dates well (or at all?)."", 'created_at': datetime.datetime(2024, 6, 13, 19, 0, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2180720391, 'issue_id': 2348944887, 'author': 'crisptrutski', 'body': 'I realize I made a mistake earlier, incorrectly excluding queries with `:template-tags` of `{}` versus `nil` (or undefined).\r\n\r\nIncluding those again:\r\n\r\n```\r\ntotal queries: 3073\r\nqueries without template tags: 1584 (51.55%)\r\nbroken queries without template tags: (16.35%)\r\n\r\nbroken queries w/tt, by engine:\r\n\r\n- mongo:               4 (not even SQL)\r\n- bigquery-cloud-sdk  10 (also not SQL)\r\n- h2:                 13 \r\n- redshift:           30\r\n- postgres:          202\r\n```\r\n\r\nMore useful examples to comb through :-)', 'created_at': datetime.datetime(2024, 6, 20, 13, 35, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2180737288, 'issue_id': 2348944887, 'author': 'crisptrutski', 'body': 'Every single Postgres query breaks due to some kind of grammar error.\r\n\r\nHere are the frequencies based on the unexpected token that was encountered:\r\n\r\n```clojure\r\n ([""FINAL""                122]\r\n  [""(""                     21]\r\n  [""AND""                   12]\r\n  [""<OP_GREATERTHANEQUALS>"" 7]\r\n  [""<K_SELECT>""             2]\r\n  [""<EOF>""                  2]\r\n  [""AS""                     2]\r\n  [""FILTER""                 2]\r\n  [""BETWEEN""                2]\r\n  ["")""                      1]\r\n  [""<S_IDENTIFIER>""         1]\r\n  [""WHERE""                  1]\r\n  [""NOT""                    1]\r\n  [""{""                      1]\r\n  ["",""                      1]\r\n  [""WITH""                   1]\r\n  [""IN""                     1])\r\n\r\n```\r\n\r\nThe most common one, `final`, is not a reserved word for Postgres, so we know that https://github.com/metabase/metabase/issues/44200 will fix 60.4% of these.', 'created_at': datetime.datetime(2024, 6, 20, 13, 41, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2180795451, 'issue_id': 2348944887, 'author': 'crisptrutski', 'body': 'The other two:\r\n\r\n```clojure\r\n ;; h2\r\n {""<EOF>""                 5\r\n  "",""                     2\r\n  ""<K_SELECT>""            1\r\n  ""<S_IDENTIFIER>""        1\r\n  ""[""                     1\r\n  ""<S_QUOTED_IDENTIFIER>"" 1\r\n  ""(""                     1}\r\n\r\n ;; big query\r\n {""<S_DOUBLE>"" 8\r\n  "",""          1\r\n  ""<K_SELECT>"" 1}\r\n```', 'created_at': datetime.datetime(2024, 6, 20, 14, 4, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2200526691, 'issue_id': 2348944887, 'author': 'crisptrutski', 'body': ""Rather than attempting to make further progress in a local environment, we should just request access to the stat's appdb and do the analysis directly."", 'created_at': datetime.datetime(2024, 7, 1, 15, 58, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2242466760, 'issue_id': 2348944887, 'author': 'crisptrutski', 'body': 'Comparing to the MBQL parsing, there are 2276 out of a total of 7202 non-archived MBQL cards in Stats without Query Field records populated, i.e coverage is about 68%', 'created_at': datetime.datetime(2024, 7, 22, 9, 9, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2247765699, 'issue_id': 2348944887, 'author': 'crisptrutski', 'body': ""Since deploying the new backfill to Stats, we have ~78% of native cards with `QueryField` records populated. Since we don't expect any records for queries that use models or even constants (yes there are  few), it's very plausible that our analysis success rate is close to the 92% that we see for parsing cards without template tags.\r\n\r\nI tried connecting my audit script to the stats app db, doing some monkey patching so that it works with a read-only replica, and compiling all the template tags. This took about 1hr to run through the ~750 cards, but something went wrong with the compilation and many still contained some raw tags. Spot checking a few of these, they were actually analyzed fine in the stats db, so it's something to do with how I got the app running.\r\n\r\nThis level of robustness is already enough to be useful, so resolving this."", 'created_at': datetime.datetime(2024, 7, 24, 12, 17, 52, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-06-13 19:00:01 UTC): As a start I looked at all the broken queries without template tags:

```text
total queries: 3073
queries without template tags: 189 (6.2%)
broken queries without template tags: (15.3%)

broken queries w/tt, by engine:

- mongo:     1 (not even SQL)
- h2:        4 (all the queries are invalid)
- postgres: 24 (discussed below)
```

Of the Postgres queries, 21 fail because these use the alias `final`. This is a reserved word for Oracle, hence a reserved word for JSQLParser. This suggests that having some of escaping for reserved word false positives could be useful. AFAIK we can get a list of the *actual* reserved words from metadata on the JDBC connection, but they should be stable enough to just hard code by driver too.

One of the above queries also has another issue too  - a `case` statement with no clauses besides an `else`. I'm not sure whether this is allowed by some dialects and not others, but it reminds me of `WHERE x IN ()` which is also illegal for many engines. I'm not sure it's worth caring about.

Then there are 2 malformed queries, and then there is only 1 final query where we seem to have an interesting parsing issue - we don't seem to handle `BETWEEN` expressions for dates well (or at all?).

crisptrutski (Issue Creator) on (2024-06-20 13:35:23 UTC): I realize I made a mistake earlier, incorrectly excluding queries with `:template-tags` of `{}` versus `nil` (or undefined).

Including those again:

```
total queries: 3073
queries without template tags: 1584 (51.55%)
broken queries without template tags: (16.35%)

broken queries w/tt, by engine:

- mongo:               4 (not even SQL)
- bigquery-cloud-sdk  10 (also not SQL)
- h2:                 13 
- redshift:           30
- postgres:          202
```

More useful examples to comb through :-)

crisptrutski (Issue Creator) on (2024-06-20 13:41:09 UTC): Every single Postgres query breaks due to some kind of grammar error.

Here are the frequencies based on the unexpected token that was encountered:

```clojure
 ([""FINAL""                122]
  [""(""                     21]
  [""AND""                   12]
  [""<OP_GREATERTHANEQUALS>"" 7]
  [""<K_SELECT>""             2]
  [""<EOF>""                  2]
  [""AS""                     2]
  [""FILTER""                 2]
  [""BETWEEN""                2]
  ["")""                      1]
  [""<S_IDENTIFIER>""         1]
  [""WHERE""                  1]
  [""NOT""                    1]
  [""{""                      1]
  ["",""                      1]
  [""WITH""                   1]
  [""IN""                     1])

```

The most common one, `final`, is not a reserved word for Postgres, so we know that https://github.com/metabase/metabase/issues/44200 will fix 60.4% of these.

crisptrutski (Issue Creator) on (2024-06-20 14:04:34 UTC): The other two:

```clojure
 ;; h2
 {""<EOF>""                 5
  "",""                     2
  ""<K_SELECT>""            1
  ""<S_IDENTIFIER>""        1
  ""[""                     1
  ""<S_QUOTED_IDENTIFIER>"" 1
  ""(""                     1}

 ;; big query
 {""<S_DOUBLE>"" 8
  "",""          1
  ""<K_SELECT>"" 1}
```

crisptrutski (Issue Creator) on (2024-07-01 15:58:34 UTC): Rather than attempting to make further progress in a local environment, we should just request access to the stat's appdb and do the analysis directly.

crisptrutski (Issue Creator) on (2024-07-22 09:09:51 UTC): Comparing to the MBQL parsing, there are 2276 out of a total of 7202 non-archived MBQL cards in Stats without Query Field records populated, i.e coverage is about 68%

crisptrutski (Issue Creator) on (2024-07-24 12:17:52 UTC): Since deploying the new backfill to Stats, we have ~78% of native cards with `QueryField` records populated. Since we don't expect any records for queries that use models or even constants (yes there are  few), it's very plausible that our analysis success rate is close to the 92% that we see for parsing cards without template tags.

I tried connecting my audit script to the stats app db, doing some monkey patching so that it works with a read-only replica, and compiling all the template tags. This took about 1hr to run through the ~750 cards, but something went wrong with the compilation and many still contained some raw tags. Spot checking a few of these, they were actually analyzed fine in the stats db, so it's something to do with how I got the app running.

This level of robustness is already enough to be useful, so resolving this.

"
2348878588,issue,closed,completed,"Comma in quoted string during CSV upload: CSV error (unexpected character: ,)","### Describe the bug

Trying to upload the following file will result in an error:
```csv
""c1"",""c2""
""a,b,c"",""d""
```

```
CSV error (unexpected character: ,)
```

### To Reproduce

1. Run Metabase 1.50.0
2. Go to http://localhost:3000/admin/settings/uploads
3. Select / enter ""Sample Database"", ""PUBLIC"" and ""upload_""
4. Go to http://localhost:3000/collection/root
5. Click on upload icon in the top right (""Upload data to Our analytics"")
6. Select the file quoted above
7. See error

### Expected behavior

File should be processed, since comma in string is quoted.

### Logs

```
2024-06-12 13:57:08,992 ERROR middleware.log :: POST /api/card/from-csv 500 164.9 ms (5 DB calls) {:metabase-user-id 1}
{:message ""CSV error (unexpected character: ,)""}
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.8.11-300.fc40.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-10"",
      ""tag"": ""v1.50.0"",
      ""hash"": ""4fe42d3""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

blocking some users

### Additional context

_No response_",devurandom,2024-06-12 14:08:32+00:00,['dpsutton'],2024-06-13 00:03:59+00:00,2024-06-12 22:21:54+00:00,https://github.com/metabase/metabase/issues/44060,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/Workflows', 'aka BEC'), ('Organization/Uploads', 'Direct data upload (CSV)')]","[{'comment_id': 2163260291, 'issue_id': 2348878588, 'author': 'calherries', 'body': 'This is a regression on the 49 branch.\r\n- 48 (62357c4c98) works fine\r\n- 49 (98e027a811) same error\r\n- master (febfe4a5aa) same error', 'created_at': datetime.datetime(2024, 6, 12, 14, 57, 57, tzinfo=datetime.timezone.utc)}]","calherries on (2024-06-12 14:57:57 UTC): This is a regression on the 49 branch.
- 48 (62357c4c98) works fine
- 49 (98e027a811) same error
- master (febfe4a5aa) same error

"
2348850954,issue,closed,completed,Model persistence tab in Performance should be available on OSS,"### Describe the bug

Model persistent tab is appearing only in EE versions, but this tab should be available in all instances.

### To Reproduce

1. Go to admin panel in OSS
2. Click on Performance
3. Can't find `Model persistence`


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
0.50 OSS
```


### Severity

P1

### Additional context

_No response_",luizarakaki,2024-06-12 13:57:41+00:00,['rafpaf'],2024-06-12 21:29:14+00:00,2024-06-12 18:36:29+00:00,https://github.com/metabase/metabase/issues/44058,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('Administration/Settings', ''), ('Querying/Cache', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2163933301, 'issue_id': 2348850954, 'author': 'mohamed-montaser91', 'body': '@luizarakaki \r\n\r\nalso Model persistence on/off is not in the database as well, the docs says it should be there\r\n![image](https://github.com/metabase/metabase/assets/145304304/063da645-c7a4-497c-b7e3-1eb234cbd73e)', 'created_at': datetime.datetime(2024, 6, 12, 21, 29, 13, tzinfo=datetime.timezone.utc)}]","mohamed-montaser91 on (2024-06-12 21:29:13 UTC): @luizarakaki 

also Model persistence on/off is not in the database as well, the docs says it should be there
![image](https://github.com/metabase/metabase/assets/145304304/063da645-c7a4-497c-b7e3-1eb234cbd73e)

"
2348759192,issue,closed,completed,"Add ""How should people filter on this column?"" for number parameters",,romeovs,2024-06-12 13:18:23+00:00,[],2024-10-08 16:18:48+00:00,2024-08-05 07:23:48+00:00,https://github.com/metabase/metabase/issues/44054,"[('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.')]",[],
2348563400,issue,open,,Update SQL field filters during find & replace of a field,"**Context**

When applying Find & Replace to a SQL query, it might have field filter parameters. These are mapped to a Field from the data warehouse - these mappings should be updated if that field is being replaced.

[Overall product doc](https://www.notion.so/metabase/Find-and-replace-data-reference-in-native-queries-API-70f6e14243254289922ef2099591a19b)
[Specific tech doc](https://www.notion.so/metabase/Tech-Find-replace-on-SQL-parameters-925321a793474d2498f945165e4ea766)",bshepherdson,2024-06-12 11:45:28+00:00,['bshepherdson'],2025-02-04 20:29:06+00:00,,https://github.com/metabase/metabase/issues/44050,"[('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Querying/Native', 'The SQL/native query editor'), ('.Backend', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Querying', '')]",[],
2348352036,issue,closed,completed,Filters show raw values on public version of dashboard ,"### Describe the bug

When a dashboard is shared via a public embed or link, its filters show the raw filter values instead of the corresponding display values.

The circumstances:
- filter values are served by a native model
- the model column is mapped to database category column
- the database column has a custom mapping set up for its display values


Original dashboard:
<img width=""863"" alt=""image"" src=""https://github.com/metabase/metabase/assets/11080638/2114b36c-f56a-41cb-be8f-b0ff64ac14cb"">


Public link: https://www.unesco.org/metabase/public/dashboard/0502ba52-e2ca-4bf6-8d3c-a89df5fc822f

<img width=""883"" alt=""image"" src=""https://github.com/metabase/metabase/assets/11080638/e882e1c8-6f55-45ad-9923-451ceaf5b36e"">




### To Reproduce

I could not reproduce this so far, however I can provide more details as I have access to the instance that shows this behavior.

### Expected behavior

It should work the same way as the the non-shared version.

### Logs

_No response_

### Information about your Metabase installation

```JSON
1.49.13
```


### Severity

P1 - blocking a customer

### Additional context
This was reported to be working in 49.8 before upgrading to 49.13.

_No response_",zbodi74,2024-06-12 10:00:55+00:00,['ranquild'],2024-06-13 10:29:14+00:00,2024-06-13 10:29:05+00:00,https://github.com/metabase/metabase/issues/44047,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Dashboards', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('Querying/Remapping', 'Remapped display values, whether human-readable values or Field->Field remappings'), ('.Escalation', ''), ('.Team/Querying', ''), ('Sharing/Public', '')]","[{'comment_id': 2165256003, 'issue_id': 2348352036, 'author': 'uladzimirdev', 'body': 'https://github.com/metabase/metabase/pull/44099 is merged', 'created_at': datetime.datetime(2024, 6, 13, 10, 29, 13, tzinfo=datetime.timezone.utc)}]","uladzimirdev on (2024-06-13 10:29:13 UTC): https://github.com/metabase/metabase/pull/44099 is merged

"
2348089080,issue,closed,completed,Don't expose CTEs as tables,,crisptrutski,2024-06-12 07:56:58+00:00,['crisptrutski'],2024-07-01 15:52:16+00:00,2024-06-21 11:48:24+00:00,https://github.com/metabase/metabase/issues/44046,"[('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]",[],
2348076589,issue,closed,completed,Don't expose elements depending on column-less expressions,"I believe this had to do with not exposing columns which reference expressions like `COUNT(*)`

For example:

```sql
WITH cte AS (SELECT COUNT(*) AS a FROM foo)
SELECT a AS b FROM bar
```

Should not infer source column like `bar.a`",crisptrutski,2024-06-12 07:51:18+00:00,['crisptrutski'],2024-07-01 15:52:33+00:00,2024-06-21 11:57:56+00:00,https://github.com/metabase/metabase/issues/44045,"[('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2177226419, 'issue_id': 2348076589, 'author': 'crisptrutski', 'body': 'I think this might be fixed already, just need to add a test case.', 'created_at': datetime.datetime(2024, 6, 18, 23, 3, 53, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-06-18 23:03:53 UTC): I think this might be fixed already, just need to add a test case.

"
2348039749,issue,closed,completed,"After upgrading to 0.50, all non-admin users are facing error message : ERROR: syntax error at or near "")"" ","**Describe the bug**
After upgrading to v0.50, all non-admin users encounter an error when trying to access any question or dashboard.

**Logs**
[7a5de2fb-b7cb-451d-98e2-7f13c79679e6] 2024-06-12T09:21:35+02:00 ERROR metabase.server.middleware.log GET /api/dashboard/32/query_metadata 500 7,4 s (183 appels de DB) {:metabase-user-id 73} 
{:via
 [{:type clojure.lang.ExceptionInfo,
   :message ""ERROR: syntax error at or near \"")\""\n  Position: 50"",
   :data
   {:toucan2/context-trace
    [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection""
      {:toucan2.jdbc.query/sql-args [""SELECT * FROM \""metabase_database\"" WHERE \""id\"" IN ()""]}]
     [""resolve connection"" {:toucan2.connection/connectable metabase.db.connection.ApplicationDB}]
     [""resolve connection"" {:toucan2.connection/connectable :default}]
     [""resolve connection"" {:toucan2.connection/connectable nil}]
     {:toucan2.pipeline/rf
      #object[clojure.core$map$fn__5931$fn__5932 0x3451c8a0 ""clojure.core$map$fn__5931$fn__5932@3451c8a0""]}
     [""with compiled query""
      {:toucan2.pipeline/compiled-query [""SELECT * FROM \""metabase_database\"" WHERE \""id\"" IN ()""]}]
     [""with built query""
      {:toucan2.pipeline/built-query {:select [:*], :from [[:metabase_database]], :where [:in :id #{}]}}]
     [""with resolved query"" {:toucan2.pipeline/resolved-query {}}]
     [""with parsed args""
      {:toucan2.pipeline/query-type :toucan.query-type/select.instances,
       :toucan2.pipeline/parsed-args {:kv-args {:id [:in #{}]}, :queryable {}}}]
     [""with model"" {:toucan2.pipeline/model :model/Database}]
     [""with unparsed args""
      {:toucan2.pipeline/query-type :toucan.query-type/select.instances,
       :toucan2.pipeline/unparsed-args (:model/Database :id [:in #{}])}]]},
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse ""QueryExecutorImpl.java"" 2725]}
  {:type org.postgresql.util.PSQLException,
   :message ""ERROR: syntax error at or near \"")\""\n  Position: 50"",
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse ""QueryExecutorImpl.java"" 2725]}],
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse ""QueryExecutorImpl.java"" 2725]
  [org.postgresql.core.v3.QueryExecutorImpl processResults ""QueryExecutorImpl.java"" 2412]
  [org.postgresql.core.v3.QueryExecutorImpl execute ""QueryExecutorImpl.java"" 371]
  [org.postgresql.jdbc.PgStatement executeInternal ""PgStatement.java"" 502]
  [org.postgresql.jdbc.PgStatement execute ""PgStatement.java"" 419]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags ""PgPreparedStatement.java"" 194]
  [org.postgresql.jdbc.PgPreparedStatement execute ""PgPreparedStatement.java"" 180]
  [com.mchange.v2.c3p0.impl.NewProxyPreparedStatement execute ""NewProxyPreparedStatement.java"" 67]
  [toucan2.jdbc.query$reduce_jdbc_query invokeStatic ""query.clj"" 40]
  [toucan2.jdbc.query$reduce_jdbc_query invoke ""query.clj"" 22]
  [toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default
   invokeStatic
   ""pipeline.clj""
   19]
  [toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default
   invoke
   ""pipeline.clj""
   9]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 178]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$partial$fn__5908 doInvoke ""core.clj"" 2639]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18078 invoke ""threaded.clj"" 79]
  [methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18040 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 doInvoke ""core.clj"" 2589]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18050 doInvoke ""threaded.clj"" 46]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 151]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 65]
  [methodical.impl.standard$invoke_multifn doInvoke ""standard.clj"" 47]
  [clojure.lang.RestFn invoke ""RestFn.java"" 594]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 199]
  [toucan2.pipeline$transduce_execute$with_connection_STAR___21303 invoke ""pipeline.clj"" 78]
  [toucan2.connection$bind_current_connectable_fn$fn__20980 invoke ""connection.clj"" 104]
  [toucan2.connection$bind_current_connectable_fn$fn__20980 invoke ""connection.clj"" 104]
  [toucan2.connection$bind_current_connectable_fn$fn__20980 invoke ""connection.clj"" 104]
  [toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource invokeStatic ""connection.clj"" 18]
  [toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource invoke ""connection.clj"" 15]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18072 invoke ""threaded.clj"" 70]
  [methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18040 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 invoke ""core.clj"" 2587]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18050 invoke ""threaded.clj"" 43]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invokeStatic ""connection.clj"" 118]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invoke ""connection.clj"" 106]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 55]
  [methodical.impl.standard$invoke_multifn invoke ""standard.clj"" 47]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 193]
  [metabase.db.connection$do_with_connection_primary_method_default invokeStatic ""connection.clj"" 132]
  [metabase.db.connection$do_with_connection_primary_method_default invoke ""connection.clj"" 130]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18072 invoke ""threaded.clj"" 70]
  [methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18040 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 invoke ""core.clj"" 2587]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18050 invoke ""threaded.clj"" 43]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invokeStatic ""connection.clj"" 118]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invoke ""connection.clj"" 106]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 55]
  [methodical.impl.standard$invoke_multifn invoke ""standard.clj"" 47]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 193]
  [toucan2.connection$do_with_connection_primary_method_ invokeStatic ""connection.clj"" 204]
  [toucan2.connection$do_with_connection_primary_method_ invoke ""connection.clj"" 194]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18072 invoke ""threaded.clj"" 70]
  [methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18040 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 invoke ""core.clj"" 2587]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18050 invoke ""threaded.clj"" 43]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invokeStatic ""connection.clj"" 118]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invoke ""connection.clj"" 106]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 55]
  [methodical.impl.standard$invoke_multifn invoke ""standard.clj"" 47]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 193]
  [toucan2.pipeline$transduce_execute invokeStatic ""pipeline.clj"" 77]
  [toucan2.pipeline$transduce_execute invoke ""pipeline.clj"" 64]
  [clojure.lang.Var invoke ""Var.java"" 399]
  [toucan2.pipeline$transduce_compiled_query invokeStatic ""pipeline.clj"" 244]
  [toucan2.pipeline$transduce_compiled_query invoke ""pipeline.clj"" 240]
  [toucan2.pipeline$transduce_built_query invokeStatic ""pipeline.clj"" 252]
  [toucan2.pipeline$transduce_built_query invoke ""pipeline.clj"" 246]
  [toucan2.pipeline$transduce_query_primary_method_default invokeStatic ""pipeline.clj"" 272]
  [toucan2.pipeline$transduce_query_primary_method_default invoke ""pipeline.clj"" 269]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 178]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$partial$fn__5908 doInvoke ""core.clj"" 2639]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18078 invoke ""threaded.clj"" 79]
  [methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18040 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 doInvoke ""core.clj"" 2589]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18050 doInvoke ""threaded.clj"" 46]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 151]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 65]
  [methodical.impl.standard$invoke_multifn doInvoke ""standard.clj"" 47]
  [clojure.lang.RestFn invoke ""RestFn.java"" 594]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 199]
  [toucan2.pipeline$transduce_query_STAR_ invokeStatic ""pipeline.clj"" 278]
  [toucan2.pipeline$transduce_query_STAR_ invoke ""pipeline.clj"" 274]
  [toucan2.pipeline$transduce_with_model invokeStatic ""pipeline.clj"" 293]
  [toucan2.pipeline$transduce_with_model invoke ""pipeline.clj"" 280]
  [toucan2.pipeline$transduce_parsed invokeStatic ""pipeline.clj"" 309]
  [toucan2.pipeline$transduce_parsed invoke ""pipeline.clj"" 295]
  [toucan2.pipeline$transduce_unparsed invokeStatic ""pipeline.clj"" 317]
  [toucan2.pipeline$transduce_unparsed invoke ""pipeline.clj"" 311]
  [toucan2.select$select_fn__GT_fn invokeStatic ""select.clj"" 195]
  [toucan2.select$select_fn__GT_fn doInvoke ""select.clj"" 181]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 142]
  [clojure.core$apply invokeStatic ""core.clj"" 673]
  [clojure.core$apply invoke ""core.clj"" 662]
  [toucan2.select$select_pk__GT_fn invokeStatic ""select.clj"" 221]
  [toucan2.select$select_pk__GT_fn doInvoke ""select.clj"" 210]
  [clojure.lang.RestFn invoke ""RestFn.java"" 464]
  [metabase.api.table$batch_fetch_query_metadatas_STAR_ invokeStatic ""table.clj"" 359]
  [metabase.api.table$batch_fetch_query_metadatas_STAR_ invoke ""table.clj"" 348]
  [metabase.api.table$fn__93453$batch_fetch_table_query_metadatas__93454 invoke ""table.clj"" 379]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 154]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [metabase.public_settings.premium_features$dynamic_ee_oss_fn$fn__55937 doInvoke ""premium_features.clj"" 557]
  [clojure.lang.RestFn invoke ""RestFn.java"" 408]
  [metabase.api.query_metadata$metadata_for_table_dependents invokeStatic ""query_metadata.clj"" 34]
  [metabase.api.query_metadata$metadata_for_table_dependents invoke ""query_metadata.clj"" 30]
  [metabase.api.query_metadata$metadata_for_dependents invokeStatic ""query_metadata.clj"" 50]
  [metabase.api.query_metadata$metadata_for_dependents invoke ""query_metadata.clj"" 49]
  [metabase.api.query_metadata$dashboard_metadata invokeStatic ""query_metadata.clj"" 152]
  [metabase.api.query_metadata$dashboard_metadata invoke ""query_metadata.clj"" 118]
  [metabase.api.dashboard$fn__97835 invokeStatic ""dashboard.clj"" 843]
  [metabase.api.dashboard$fn__97835 invoke ""dashboard.clj"" 838]
  [compojure.core$wrap_response$fn__52844 invoke ""core.clj"" 160]
  [compojure.core$wrap_route_middleware$fn__52828 invoke ""core.clj"" 132]
  [compojure.core$wrap_route_info$fn__52833 invoke ""core.clj"" 139]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 151]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 152]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 152]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856 invoke ""core.clj"" 200]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [metabase.server.middleware.auth$enforce_authentication$fn__97094 invoke ""auth.clj"" 18]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__52884 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 300]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 152]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [metabase.api.routes$fn__103529$fn__103532 invoke ""routes.clj"" 73]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856 invoke ""core.clj"" 200]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [metabase.server.routes$fn__103809$fn__103810 doInvoke ""routes.clj"" 73]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__52884 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__52888 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 152]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 152]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52837 invoke ""core.clj"" 152]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856$f__52857$respond_SINGLEQUOTE___52858 invoke ""core.clj"" 197]
  [metabase.server.routes$fn__103792$fn__103794 invoke ""routes.clj"" 47]
  [compojure.core$routes$fn__52856$f__52857 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52856 invoke ""core.clj"" 200]
  [metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__99959 invoke ""exceptions.clj"" 107]
  [metabase.server.middleware.exceptions$catch_api_exceptions$fn__99956 invoke ""exceptions.clj"" 96]
  [metabase.server.middleware.log$log_api_call$fn__104089$fn__104090$fn__104091 invoke ""log.clj"" 236]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invokeStatic ""diagnostic.clj"" 18]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invoke ""diagnostic.clj"" 12]
  [metabase.server.middleware.log$log_api_call$fn__104089$fn__104090 invoke ""log.clj"" 227]
  [toucan2.execute$do_with_call_counts invokeStatic ""execute.clj"" 112]
  [toucan2.execute$do_with_call_counts invoke ""execute.clj"" 103]
  [metabase.server.middleware.log$log_api_call$fn__104089 invoke ""log.clj"" 226]
  [metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__107377 invoke ""browser_cookie.clj"" 40]
  [metabase.server.middleware.security$add_security_headers$fn__99915 invoke ""security.clj"" 238]
  [ring.middleware.json$wrap_json_body$fn__107636 invoke ""json.clj"" 64]
  [metabase.server.middleware.offset_paging$handle_paging$fn__86415 invoke ""offset_paging.clj"" 43]
  [metabase.server.middleware.json$wrap_streamed_json_response$fn__54299 invoke ""json.clj"" 83]
  [ring.middleware.keyword_params$wrap_keyword_params$fn__107725 invoke ""keyword_params.clj"" 55]
  [ring.middleware.params$wrap_params$fn__107744 invoke ""params.clj"" 77]
  [metabase.server.middleware.misc$maybe_set_site_url$fn__69704 invoke ""misc.clj"" 60]
  [metabase.server.middleware.session$reset_session_timeout$fn__76848 invoke ""session.clj"" 552]
  [metabase.server.middleware.session$bind_current_user$fn__76814$fn__76815 invoke ""session.clj"" 446]
  [metabase.server.middleware.session$do_with_current_user invokeStatic ""session.clj"" 425]
  [metabase.server.middleware.session$do_with_current_user invoke ""session.clj"" 408]
  [metabase.server.middleware.session$bind_current_user$fn__76814 invoke ""session.clj"" 445]
  [metabase.server.middleware.session$wrap_current_user_info$fn__76795 invoke ""session.clj"" 383]
  [metabase.server.middleware.session$wrap_session_id$fn__76767 invoke ""session.clj"" 259]
  [metabase.server.middleware.auth$wrap_static_api_key$fn__97102 invoke ""auth.clj"" 32]
  [ring.middleware.cookies$wrap_cookies$fn__107564 invoke ""cookies.clj"" 200]
  [metabase.server.middleware.misc$add_content_type$fn__69686 invoke ""misc.clj"" 28]
  [metabase.server.middleware.misc$disable_streaming_buffering$fn__69712 invoke ""misc.clj"" 77]
  [ring.middleware.gzip$wrap_gzip$fn__107606 invoke ""gzip.clj"" 86]
  [metabase.server.middleware.misc$bind_request$fn__69715 invoke ""misc.clj"" 94]
  [metabase.server.middleware.ssl$redirect_to_https_middleware$fn__107393 invoke ""ssl.clj"" 41]
  [metabase.server$async_proxy_handler$fn__70050 invoke ""server.clj"" 77]
  [metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a handle nil -1]
  [org.eclipse.jetty.server.handler.StatisticsHandler handle ""StatisticsHandler.java"" 173]
  [org.eclipse.jetty.server.handler.HandlerWrapper handle ""HandlerWrapper.java"" 122]
  [org.eclipse.jetty.server.Server handle ""Server.java"" 563]
  [org.eclipse.jetty.server.HttpChannel$RequestDispatchable dispatch ""HttpChannel.java"" 1598]
  [org.eclipse.jetty.server.HttpChannel dispatch ""HttpChannel.java"" 753]
  [org.eclipse.jetty.server.HttpChannel handle ""HttpChannel.java"" 501]
  [org.eclipse.jetty.server.HttpConnection onFillable ""HttpConnection.java"" 287]
  [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded ""AbstractConnection.java"" 314]
  [org.eclipse.jetty.io.FillInterest fillable ""FillInterest.java"" 100]
  [org.eclipse.jetty.io.SelectableChannelEndPoint$1 run ""SelectableChannelEndPoint.java"" 53]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy runTask ""AdaptiveExecutionStrategy.java"" 421]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy consumeTask ""AdaptiveExecutionStrategy.java"" 390]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy tryProduce ""AdaptiveExecutionStrategy.java"" 277]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy run ""AdaptiveExecutionStrategy.java"" 199]
  [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run ""ReservedThreadExecutor.java"" 411]
  [org.eclipse.jetty.util.thread.QueuedThreadPool runJob ""QueuedThreadPool.java"" 969]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner doRunJob ""QueuedThreadPool.java"" 1194]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run ""QueuedThreadPool.java"" 1149]
  [java.lang.Thread run nil -1]],
 :cause ""ERROR: syntax error at or near \"")\""\n  Position: 50"",
 :message ""ERROR: syntax error at or near \"")\""\n  Position: 50""}



**To Reproduce**
Steps to reproduce the behavior:
1.	Log in as a non-admin user.
2.	Open a question or dashboard accessible to “All users”.
3.	An error message appears: ERROR: syntax error at or near “)” Position: 50.

**Expected behavior**
The ""All users"" objects shoud be visible to anoyne.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**Severity**
This is blocking our usage of Metabase entirely. Nothing is accessible except for admins.


**Additional context**


**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""fr-FR"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.8.6-clevercloud-vm-dirty"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""snowflake"",
      ""postgres"",
      ""mysql"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.4""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-10"",
      ""tag"": ""v0.50.0"",
      ""hash"": ""4fe42d3""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Paris""
    }
  }
}
```",tcourtainsellsy,2024-06-12 07:34:05+00:00,['qnkhuat'],2024-07-16 16:09:16+00:00,2024-06-12 13:53:51+00:00,https://github.com/metabase/metabase/issues/44043,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Misc/API', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Escalation', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2162467464, 'issue_id': 2348039749, 'author': 'ruber0id', 'body': 'Same issue, but with MySQL Prod DB (ver. 8.0.36)', 'created_at': datetime.datetime(2024, 6, 12, 8, 53, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162471084, 'issue_id': 2348039749, 'author': 'MathiasGr', 'body': 'Same here', 'created_at': datetime.datetime(2024, 6, 12, 8, 55, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162505518, 'issue_id': 2348039749, 'author': 'alyakh-gegi-llc', 'body': 'Same [Error showing questions for users without ""Create queries"" permission after upgrade to v0.50.0](https://github.com/metabase/metabase/issues/44035)', 'created_at': datetime.datetime(2024, 6, 12, 9, 9, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162810443, 'issue_id': 2348039749, 'author': 'darksciencebase', 'body': 'possibly introduced by https://github.com/metabase/metabase/pull/43625', 'created_at': datetime.datetime(2024, 6, 12, 11, 49, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163534614, 'issue_id': 2348039749, 'author': 'perivamsi', 'body': 'Please upgrade to 50.1, this issue is fixed there.', 'created_at': datetime.datetime(2024, 6, 12, 17, 11, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2164913980, 'issue_id': 2348039749, 'author': 'tcourtainsellsy', 'body': 'I confirm this is fixed now, thanks a lot.', 'created_at': datetime.datetime(2024, 6, 13, 7, 59, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2231274518, 'issue_id': 2348039749, 'author': 'akundevigooodsru', 'body': 'We still have this issue on 0.50.1 and 0.50.13 when empty filters from the request are converted to the `where param_name IN ()` in the query. \r\nRolled back to 0.49.15 and errors gone.', 'created_at': datetime.datetime(2024, 7, 16, 15, 47, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2231318114, 'issue_id': 2348039749, 'author': 'adam-james-v', 'body': ""@akundevigooodsru, I suspect that you're encountering a different issue, though you're right that it seems similar. Do you mind opening an issue? If you get a chance to do that, could you also provide a little more detail/context regarding the error you've seen. For example, could you provide information in the issue about which request this happens with? A regular dashboard? An embedded dashboard? That sort of thing."", 'created_at': datetime.datetime(2024, 7, 16, 16, 9, 15, tzinfo=datetime.timezone.utc)}]","ruber0id on (2024-06-12 08:53:31 UTC): Same issue, but with MySQL Prod DB (ver. 8.0.36)

MathiasGr on (2024-06-12 08:55:15 UTC): Same here

alyakh-gegi-llc on (2024-06-12 09:09:06 UTC): Same [Error showing questions for users without ""Create queries"" permission after upgrade to v0.50.0](https://github.com/metabase/metabase/issues/44035)

darksciencebase on (2024-06-12 11:49:50 UTC): possibly introduced by https://github.com/metabase/metabase/pull/43625

perivamsi on (2024-06-12 17:11:08 UTC): Please upgrade to 50.1, this issue is fixed there.

tcourtainsellsy (Issue Creator) on (2024-06-13 07:59:06 UTC): I confirm this is fixed now, thanks a lot.

akundevigooodsru on (2024-07-16 15:47:07 UTC): We still have this issue on 0.50.1 and 0.50.13 when empty filters from the request are converted to the `where param_name IN ()` in the query. 
Rolled back to 0.49.15 and errors gone.

adam-james-v on (2024-07-16 16:09:15 UTC): @akundevigooodsru, I suspect that you're encountering a different issue, though you're right that it seems similar. Do you mind opening an issue? If you get a chance to do that, could you also provide a little more detail/context regarding the error you've seen. For example, could you provide information in the issue about which request this happens with? A regular dashboard? An embedded dashboard? That sort of thing.

"
2348013558,issue,closed,not_planned,[Flaky Test]: sample-database-schedule-sync-test,"Last Flake: https://github.com/metabase/metabase/actions/runs/9444697255
Last Flake Time: 2024-06-10T01:51:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-12 07:20:02+00:00,[],2024-12-13 16:43:39+00:00,2024-12-13 16:43:39+00:00,https://github.com/metabase/metabase/issues/44042,"[('.CI & Tests', ''), ('.Backend', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2348013525,issue,closed,completed,[Flaky Test]: above-goal-alert-test,"Last Flake: https://github.com/metabase/metabase/actions/runs/9453305966
Last Flake Time: 2024-06-10T12:22:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-12 07:20:01+00:00,['qnkhuat'],2024-06-21 03:28:49+00:00,2024-06-21 03:28:49+00:00,https://github.com/metabase/metabase/issues/44041,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2162336297, 'issue_id': 2348013525, 'author': 'darksciencebase', 'body': ""we've already had [an issue in progress ](https://github.com/metabase/metabase/issues/43321) about this, but we're switching to this one to make it easier for the bot."", 'created_at': datetime.datetime(2024, 6, 12, 7, 47, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2181934059, 'issue_id': 2348013525, 'author': 'qnkhuat', 'body': 'Fixed by reworking how test setup works in https://github.com/metabase/metabase/pull/43924', 'created_at': datetime.datetime(2024, 6, 21, 3, 28, 49, tzinfo=datetime.timezone.utc)}]","darksciencebase on (2024-06-12 07:47:03 UTC): we've already had [an issue in progress ](https://github.com/metabase/metabase/issues/43321) about this, but we're switching to this one to make it easier for the bot.

qnkhuat (Assginee) on (2024-06-21 03:28:49 UTC): Fixed by reworking how test setup works in https://github.com/metabase/metabase/pull/43924

"
2348013501,issue,closed,completed,[Flaky Test]: scenarios > models metadata GUI model clears custom metadata when a model is turned back into a question,"Last Flake: https://github.com/metabase/metabase/actions/runs/9447852559
Last Flake Time: 2024-06-10T05:35:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-12 07:20:00+00:00,['kamilmielnik'],2024-11-08 12:42:03+00:00,2024-11-08 11:31:52+00:00,https://github.com/metabase/metabase/issues/44040,"[('.CI & Tests', ''), ('Querying/Models', 'aka Datasets'), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2348013477,issue,closed,not_planned,[Flaky Test]: scenarios > question > offset aggregations suggests and allows using offset(),"Last Flake: https://github.com/metabase/metabase/actions/runs/9455468280
Last Flake Time: 2024-06-10T14:41:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 4
Flakes in the last 7d: 5",github-automation-metabase,2024-06-12 07:19:59+00:00,[],2024-12-13 16:43:59+00:00,2024-12-13 16:43:59+00:00,https://github.com/metabase/metabase/issues/44039,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2348013448,issue,closed,not_planned,[Flaky Test]: custom expression should create a filter with a custom expression,"Last Flake: https://github.com/metabase/metabase/actions/runs/9456282830
Last Flake Time: 2024-06-10T21:03:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 5
Flakes in the last 7d: 6",github-automation-metabase,2024-06-12 07:19:58+00:00,[],2024-12-13 16:43:59+00:00,2024-12-13 16:43:59+00:00,https://github.com/metabase/metabase/issues/44038,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2347999575,issue,closed,completed,Parse Release Branch Commit History for Release notes + milestones,"### General Idea
- parse every commit in the release branch since the last release tag
- for every commit in the release branch
  - find the backport PR
  - trace the backport PR to the PR(s) to master
  - find any/all linked issues from the PR to master
- add milestones to all issues with a link to the release branch for the current next open milestone
- flag all closed issues in the milestone that can't be traced to the release branch


### Problems
- an issue [cannot have multiple milestones](https://github.com/orgs/community/discussions/4566), so if a bugfix is backported to multiple release branches, we can't rely on milestones to generate accurate release notes
- how to handle reverts?
- notify of open issues in milestone?",iethree,2024-06-12 07:12:17+00:00,['iethree'],2024-10-08 16:20:42+00:00,2024-07-16 17:56:34+00:00,https://github.com/metabase/metabase/issues/44037,"[('.Building & Releasing', '')]",[],
2347935768,issue,closed,not_planned,"Error showing questions for users without ""Create queries"" permission after upgrade to v0.50.0","### Describe the bug

After upgrading to v1.50.0, Questions/Dashboards for users without “Create queries” permission are not displayed, there is an error:
```You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1```

In the error log I see the query for ""api/dashboard/5/query_metadata"":
```SELECT * FROM `metabase_database` WHERE `id` IN ()```

If we grant the “Permissions - Data - Column ""Create queries"" for our database - Yes” permission, the Questions/Dashboards are displayed correctly. But we do not give the “Create queries” permission to all user groups.

### To Reproduce

1. Open Questions/Dashboards under a user without the “Create queries” permission.
2. See error.


### Expected behavior

Users without “Create queries” permission but with “View data - Can view” should be able to see Questions. 
This worked on version 1.49.6.


### Information about your Metabase installation

```JSON
- MySQL 8.0.36
- Metabase v1.50.0
```

### Severity

Blocks users from working after updating.

### Logs

<details>

```[a3655181-c643-41b2-9b85-ada0f47a085b] 2024-06-12T09:09:14+03:00 ERROR metabase.server.middleware.log GET /api/dashboard/5/query_metadata 500 113.4 ms (79 DB calls) {:metabase-user-id 13371342} 
{:via
 [{:type clojure.lang.ExceptionInfo,
   :message
   ""(conn=41) You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1"",
   :data
   {:toucan2/context-trace
    [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection""
      {:toucan2.jdbc.query/sql-args [""SELECT * FROM `metabase_database` WHERE `id` IN ()""]}]
     [""resolve connection"" {:toucan2.connection/connectable metabase.db.connection.ApplicationDB}]
     [""resolve connection"" {:toucan2.connection/connectable :default}]
     [""resolve connection"" {:toucan2.connection/connectable nil}]
     {:toucan2.pipeline/rf
      #object[clojure.core$map$fn__5931$fn__5932 0x5ae00553 ""clojure.core$map$fn__5931$fn__5932@5ae00553""]}
     [""with compiled query"" {:toucan2.pipeline/compiled-query [""SELECT * FROM `metabase_database` WHERE `id` IN ()""]}]
     [""with built query""
      {:toucan2.pipeline/built-query {:select [:*], :from [[:metabase_database]], :where [:in :id #{}]}}]
     [""with resolved query"" {:toucan2.pipeline/resolved-query {}}]
     [""with parsed args""
      {:toucan2.pipeline/query-type :toucan.query-type/select.instances,
       :toucan2.pipeline/parsed-args {:kv-args {:id [:in #{}]}, :queryable {}}}]
     [""with model"" {:toucan2.pipeline/model :model/Database}]
     [""with unparsed args""
      {:toucan2.pipeline/query-type :toucan.query-type/select.instances,
       :toucan2.pipeline/unparsed-args (:model/Database :id [:in #{}])}]]},
   :at [org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory createException ""ExceptionFactory.java"" 62]}
  {:type java.sql.SQLSyntaxErrorException,
   :message
   ""(conn=41) You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1"",
   :at [org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory createException ""ExceptionFactory.java"" 62]}
  {:type org.mariadb.jdbc.internal.util.exceptions.MariaDbSqlException,
   :message
   ""You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1"",
   :at [org.mariadb.jdbc.internal.util.exceptions.MariaDbSqlException of ""MariaDbSqlException.java"" 34]}
  {:type java.sql.SQLException,
   :message
   ""You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1"",
   :at [org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol readErrorPacket ""AbstractQueryProtocol.java"" 1693]}],
 :trace
 [[org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol readErrorPacket ""AbstractQueryProtocol.java"" 1693]
  [org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol readPacket ""AbstractQueryProtocol.java"" 1555]
  [org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol getResult ""AbstractQueryProtocol.java"" 1518]
  [org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol executeQuery ""AbstractQueryProtocol.java"" 319]
  [org.mariadb.jdbc.ClientSidePreparedStatement executeInternal ""ClientSidePreparedStatement.java"" 220]
  [org.mariadb.jdbc.ClientSidePreparedStatement execute ""ClientSidePreparedStatement.java"" 149]
  [com.mchange.v2.c3p0.impl.NewProxyPreparedStatement execute ""NewProxyPreparedStatement.java"" 67]
  [toucan2.jdbc.query$reduce_jdbc_query invokeStatic ""query.clj"" 40]
  [toucan2.jdbc.query$reduce_jdbc_query invoke ""query.clj"" 22]
  [toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default
   invokeStatic
   ""pipeline.clj""
   19]
  [toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default
   invoke
   ""pipeline.clj""
   9]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 178]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$partial$fn__5908 doInvoke ""core.clj"" 2639]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [methodical.impl.combo.threaded$fn__18074$fn__18075$fn__18082 invoke ""threaded.clj"" 79]
  [methodical.impl.combo.threaded$reducer_fn$fn__18044$fn__18048 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18044 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 doInvoke ""core.clj"" 2589]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18054 doInvoke ""threaded.clj"" 46]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 151]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 65]
  [methodical.impl.standard$invoke_multifn doInvoke ""standard.clj"" 47]
  [clojure.lang.RestFn invoke ""RestFn.java"" 594]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 199]
  [toucan2.pipeline$transduce_execute$with_connection_STAR___21307 invoke ""pipeline.clj"" 78]
  [toucan2.connection$bind_current_connectable_fn$fn__20984 invoke ""connection.clj"" 104]
  [toucan2.connection$bind_current_connectable_fn$fn__20984 invoke ""connection.clj"" 104]
  [toucan2.connection$bind_current_connectable_fn$fn__20984 invoke ""connection.clj"" 104]
  [toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource invokeStatic ""connection.clj"" 18]
  [toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource invoke ""connection.clj"" 15]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.combo.threaded$fn__18074$fn__18075$fn__18076 invoke ""threaded.clj"" 70]
  [methodical.impl.combo.threaded$reducer_fn$fn__18044$fn__18048 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18044 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 invoke ""core.clj"" 2587]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18054 invoke ""threaded.clj"" 43]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invokeStatic ""connection.clj"" 118]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invoke ""connection.clj"" 106]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 55]
  [methodical.impl.standard$invoke_multifn invoke ""standard.clj"" 47]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 193]
  [metabase.db.connection$do_with_connection_primary_method_default invokeStatic ""connection.clj"" 132]
  [metabase.db.connection$do_with_connection_primary_method_default invoke ""connection.clj"" 130]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.combo.threaded$fn__18074$fn__18075$fn__18076 invoke ""threaded.clj"" 70]
  [methodical.impl.combo.threaded$reducer_fn$fn__18044$fn__18048 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18044 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 invoke ""core.clj"" 2587]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18054 invoke ""threaded.clj"" 43]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invokeStatic ""connection.clj"" 118]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invoke ""connection.clj"" 106]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 55]
  [methodical.impl.standard$invoke_multifn invoke ""standard.clj"" 47]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 193]
  [toucan2.connection$do_with_connection_primary_method_ invokeStatic ""connection.clj"" 204]
  [toucan2.connection$do_with_connection_primary_method_ invoke ""connection.clj"" 194]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.combo.threaded$fn__18074$fn__18075$fn__18076 invoke ""threaded.clj"" 70]
  [methodical.impl.combo.threaded$reducer_fn$fn__18044$fn__18048 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18044 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 invoke ""core.clj"" 2587]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18054 invoke ""threaded.clj"" 43]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invokeStatic ""connection.clj"" 118]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invoke ""connection.clj"" 106]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 55]
  [methodical.impl.standard$invoke_multifn invoke ""standard.clj"" 47]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 193]
  [toucan2.pipeline$transduce_execute invokeStatic ""pipeline.clj"" 77]
  [toucan2.pipeline$transduce_execute invoke ""pipeline.clj"" 64]
  [clojure.lang.Var invoke ""Var.java"" 399]
  [toucan2.pipeline$transduce_compiled_query invokeStatic ""pipeline.clj"" 244]
  [toucan2.pipeline$transduce_compiled_query invoke ""pipeline.clj"" 240]
  [toucan2.pipeline$transduce_built_query invokeStatic ""pipeline.clj"" 252]
  [toucan2.pipeline$transduce_built_query invoke ""pipeline.clj"" 246]
  [toucan2.pipeline$transduce_query_primary_method_default invokeStatic ""pipeline.clj"" 272]
  [toucan2.pipeline$transduce_query_primary_method_default invoke ""pipeline.clj"" 269]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 178]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$partial$fn__5908 doInvoke ""core.clj"" 2639]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [methodical.impl.combo.threaded$fn__18074$fn__18075$fn__18082 invoke ""threaded.clj"" 79]
  [methodical.impl.combo.threaded$reducer_fn$fn__18044$fn__18048 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18044 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 doInvoke ""core.clj"" 2589]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18054 doInvoke ""threaded.clj"" 46]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 151]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 65]
  [methodical.impl.standard$invoke_multifn doInvoke ""standard.clj"" 47]
  [clojure.lang.RestFn invoke ""RestFn.java"" 594]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 199]
  [toucan2.pipeline$transduce_query_STAR_ invokeStatic ""pipeline.clj"" 278]
  [toucan2.pipeline$transduce_query_STAR_ invoke ""pipeline.clj"" 274]
  [toucan2.pipeline$transduce_with_model invokeStatic ""pipeline.clj"" 293]
  [toucan2.pipeline$transduce_with_model invoke ""pipeline.clj"" 280]
  [toucan2.pipeline$transduce_parsed invokeStatic ""pipeline.clj"" 309]
  [toucan2.pipeline$transduce_parsed invoke ""pipeline.clj"" 295]
  [toucan2.pipeline$transduce_unparsed invokeStatic ""pipeline.clj"" 317]
  [toucan2.pipeline$transduce_unparsed invoke ""pipeline.clj"" 311]
  [toucan2.select$select_fn__GT_fn invokeStatic ""select.clj"" 195]
  [toucan2.select$select_fn__GT_fn doInvoke ""select.clj"" 181]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 142]
  [clojure.core$apply invokeStatic ""core.clj"" 673]
  [clojure.core$apply invoke ""core.clj"" 662]
  [toucan2.select$select_pk__GT_fn invokeStatic ""select.clj"" 221]
  [toucan2.select$select_pk__GT_fn doInvoke ""select.clj"" 210]
  [clojure.lang.RestFn invoke ""RestFn.java"" 464]
  [metabase.api.table$batch_fetch_query_metadatas_STAR_ invokeStatic ""table.clj"" 359]
  [metabase.api.table$batch_fetch_query_metadatas_STAR_ invoke ""table.clj"" 348]
  [metabase_enterprise.sandbox.api.table$fn__106555$batch_fetch_table_query_metadatas__106556 invoke ""table.clj"" 74]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 154]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [metabase.public_settings.premium_features$dynamic_ee_oss_fn$fn__55941 doInvoke ""premium_features.clj"" 551]
  [clojure.lang.RestFn invoke ""RestFn.java"" 408]
  [metabase.api.query_metadata$metadata_for_table_dependents invokeStatic ""query_metadata.clj"" 34]
  [metabase.api.query_metadata$metadata_for_table_dependents invoke ""query_metadata.clj"" 30]
  [metabase.api.query_metadata$metadata_for_dependents invokeStatic ""query_metadata.clj"" 50]
  [metabase.api.query_metadata$metadata_for_dependents invoke ""query_metadata.clj"" 49]
  [metabase.api.query_metadata$dashboard_metadata invokeStatic ""query_metadata.clj"" 152]
  [metabase.api.query_metadata$dashboard_metadata invoke ""query_metadata.clj"" 118]
  [metabase.api.dashboard$fn__98537 invokeStatic ""dashboard.clj"" 843]
  [metabase.api.dashboard$fn__98537 invoke ""dashboard.clj"" 838]
  [compojure.core$wrap_response$fn__52848 invoke ""core.clj"" 160]
  [compojure.core$wrap_route_middleware$fn__52832 invoke ""core.clj"" 132]
  [compojure.core$wrap_route_info$fn__52837 invoke ""core.clj"" 139]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 151]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 152]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 152]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860 invoke ""core.clj"" 200]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [metabase.server.middleware.auth$enforce_authentication$fn__97796 invoke ""auth.clj"" 18]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__52888 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 300]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 152]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860 invoke ""core.clj"" 200]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860 invoke ""core.clj"" 200]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860 invoke ""core.clj"" 200]
  [metabase.api.routes$fn__104231$fn__104232 invoke ""routes.clj"" 70]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860 invoke ""core.clj"" 200]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [metabase.server.routes$fn__104511$fn__104512 doInvoke ""routes.clj"" 73]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__52888 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 152]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 152]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__52841 invoke ""core.clj"" 152]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860 invoke ""core.clj"" 200]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__52888 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860$f__52861$respond_SINGLEQUOTE___52862 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__52892 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860 invoke ""core.clj"" 200]
  [compojure.core$routes$fn__52860$f__52861 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__52860 invoke ""core.clj"" 200]
  [metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__100661 invoke ""exceptions.clj"" 107]
  [metabase.server.middleware.exceptions$catch_api_exceptions$fn__100658 invoke ""exceptions.clj"" 96]
  [metabase.server.middleware.log$log_api_call$fn__106840$fn__106841$fn__106842 invoke ""log.clj"" 236]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invokeStatic ""diagnostic.clj"" 18]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invoke ""diagnostic.clj"" 12]
  [metabase.server.middleware.log$log_api_call$fn__106840$fn__106841 invoke ""log.clj"" 227]
  [toucan2.execute$do_with_call_counts invokeStatic ""execute.clj"" 112]
  [toucan2.execute$do_with_call_counts invoke ""execute.clj"" 103]
  [metabase.server.middleware.log$log_api_call$fn__106840 invoke ""log.clj"" 226]
  [metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__112981 invoke ""browser_cookie.clj"" 40]
  [metabase.server.middleware.security$add_security_headers$fn__100617 invoke ""security.clj"" 238]
  [ring.middleware.json$wrap_json_body$fn__113240 invoke ""json.clj"" 64]
  [metabase.server.middleware.offset_paging$handle_paging$fn__87117 invoke ""offset_paging.clj"" 43]
  [metabase.server.middleware.json$wrap_streamed_json_response$fn__54303 invoke ""json.clj"" 83]
  [ring.middleware.keyword_params$wrap_keyword_params$fn__113329 invoke ""keyword_params.clj"" 55]
  [ring.middleware.params$wrap_params$fn__113348 invoke ""params.clj"" 77]
  [metabase.server.middleware.misc$maybe_set_site_url$fn__69708 invoke ""misc.clj"" 60]
  [metabase.server.middleware.session$reset_session_timeout$fn__76852 invoke ""session.clj"" 552]
  [metabase.server.middleware.session$bind_current_user$fn__76818$fn__76819 invoke ""session.clj"" 446]
  [metabase.server.middleware.session$do_with_current_user invokeStatic ""session.clj"" 425]
  [metabase.server.middleware.session$do_with_current_user invoke ""session.clj"" 408]
  [metabase.server.middleware.session$bind_current_user$fn__76818 invoke ""session.clj"" 445]
  [metabase.server.middleware.session$wrap_current_user_info$fn__76799 invoke ""session.clj"" 383]
  [metabase.server.middleware.session$wrap_session_id$fn__76771 invoke ""session.clj"" 259]
  [metabase.server.middleware.auth$wrap_static_api_key$fn__97804 invoke ""auth.clj"" 32]
  [ring.middleware.cookies$wrap_cookies$fn__113168 invoke ""cookies.clj"" 200]
  [metabase.server.middleware.misc$add_content_type$fn__69690 invoke ""misc.clj"" 28]
  [metabase.server.middleware.misc$disable_streaming_buffering$fn__69716 invoke ""misc.clj"" 77]
  [ring.middleware.gzip$wrap_gzip$fn__113210 invoke ""gzip.clj"" 86]
  [metabase.server.middleware.misc$bind_request$fn__69719 invoke ""misc.clj"" 94]
  [metabase.server.middleware.ssl$redirect_to_https_middleware$fn__112997 invoke ""ssl.clj"" 41]
  [metabase.server$async_proxy_handler$fn__70054 invoke ""server.clj"" 77]
  [metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a handle nil -1]
  [org.eclipse.jetty.server.handler.StatisticsHandler handle ""StatisticsHandler.java"" 173]
  [org.eclipse.jetty.server.handler.HandlerWrapper handle ""HandlerWrapper.java"" 122]
  [org.eclipse.jetty.server.Server handle ""Server.java"" 563]
  [org.eclipse.jetty.server.HttpChannel$RequestDispatchable dispatch ""HttpChannel.java"" 1598]
  [org.eclipse.jetty.server.HttpChannel dispatch ""HttpChannel.java"" 753]
  [org.eclipse.jetty.server.HttpChannel handle ""HttpChannel.java"" 501]
  [org.eclipse.jetty.server.HttpConnection onFillable ""HttpConnection.java"" 287]
  [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded ""AbstractConnection.java"" 314]
  [org.eclipse.jetty.io.FillInterest fillable ""FillInterest.java"" 100]
  [org.eclipse.jetty.io.SelectableChannelEndPoint$1 run ""SelectableChannelEndPoint.java"" 53]
  [org.eclipse.jetty.util.thread.QueuedThreadPool runJob ""QueuedThreadPool.java"" 969]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner doRunJob ""QueuedThreadPool.java"" 1194]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run ""QueuedThreadPool.java"" 1149]
  [java.lang.Thread run nil -1]],
 :cause
 ""You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1"",
 :message
 ""(conn=41) You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 1""}```
</details>",alyakh-gegi-llc,2024-06-12 06:39:17+00:00,[],2024-06-12 11:32:14+00:00,2024-06-12 11:32:14+00:00,https://github.com/metabase/metabase/issues/44035,"[('Type:Bug', 'Product defects'), ('Database/MySQL', None), ('Administration/Permissions', 'Collection or Data permissions'), ('.Needs Triage', '')]","[{'comment_id': 2162227939, 'issue_id': 2347935768, 'author': 'alyakh-gegi-llc', 'body': '![Screenshot_2024-06-12_09-00-06](https://github.com/metabase/metabase/assets/132369714/85906e48-a151-4e6d-becd-1f3956d393a9)\r\n![Screenshot_2024-06-12_09-17-53](https://github.com/metabase/metabase/assets/132369714/21dffd78-8f80-4cb9-bad8-916d604821ad)', 'created_at': datetime.datetime(2024, 6, 12, 6, 42, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162780068, 'issue_id': 2347935768, 'author': 'paoliniluis', 'body': 'I’m going to close this one in favor of the other one ok? We’re taking this One with the highest priority', 'created_at': datetime.datetime(2024, 6, 12, 11, 32, 14, tzinfo=datetime.timezone.utc)}]","alyakh-gegi-llc (Issue Creator) on (2024-06-12 06:42:50 UTC): ![Screenshot_2024-06-12_09-00-06](https://github.com/metabase/metabase/assets/132369714/85906e48-a151-4e6d-becd-1f3956d393a9)
![Screenshot_2024-06-12_09-17-53](https://github.com/metabase/metabase/assets/132369714/21dffd78-8f80-4cb9-bad8-916d604821ad)

paoliniluis on (2024-06-12 11:32:14 UTC): I’m going to close this one in favor of the other one ok? We’re taking this One with the highest priority

"
2347906202,issue,closed,completed,"""Not able to modify the internal user"" for example dashboard creator user","### Describe the bug

I'm the author of [dbt-metabase](https://github.com/gouline/dbt-metabase) that allows users to export Metabase dashboards as dbt exposures. To populate the exposure owner, I use dashboard `creator` block whenever available or `creator_id` fetched via [`GET /api/user/:id`](https://www.metabase.com/docs/latest/api/user#get-apiuserid) otherwise.

Attempting to query the `creator_id` on example dashboards returns HTTP 400 ""Not able to modify the internal user"", even though I'm only reading, not modify it. [`GET /api/dashboard/:id`](https://www.metabase.com/docs/latest/api/dashboard#get-apidashboardid) also doesn't return the `creator` block like some others (e.g. [`GET /api/dashboard/`](https://www.metabase.com/docs/latest/api/dashboard#get-apidashboard)), so there's nowhere to get that name from.

### To Reproduce

1. Fresh install of Metabase 50
2. Query `GET /api/dashboard/:id` with any example dashboard ID (from `GET /api/dashboard`)
3. Find `creator_id` and query API `GET /user/:id` with that ID
4. Observe HTTP 400 ""Not able to modify the internal user"" response

### Expected behavior

- **Option 1:** `GET /user/:id` responds 200 with internal user details
- **Option 2:** `GET /api/dashboard/:id` includes `creator` block with user details

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Metabase version: 0.50.0
```


### Severity

Annoying

### Additional context

There's likely no legitimate use case for exporting examples to dbt, but I'm sure users will attempt to export everything and be puzzled by the error. For now, I'm filtering for 400 responses that mention ""internal user"", not the most elegant workaround.",gouline,2024-06-12 06:20:46+00:00,['noahmoss'],2024-06-13 18:15:15+00:00,2024-06-13 18:13:19+00:00,https://github.com/metabase/metabase/issues/44034,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Dashboards', ''), ('.Backend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2162785739, 'issue_id': 2347906202, 'author': 'paoliniluis', 'body': 'Hey first of all thanks for your project, it’s really helpful for the community. I’m taking this to the product team so we can fix it as soon as we can', 'created_at': datetime.datetime(2024, 6, 12, 11, 35, 29, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-12 11:35:29 UTC): Hey first of all thanks for your project, it’s really helpful for the community. I’m taking this to the product team so we can fix it as soon as we can

"
2347734379,issue,open,,"on a pie chart, can you display the number of values ​​(count) instead of a percentage?","on a pie chart, can you display the number of values ​​(count) instead of a percentage? 

Currently it is in percentage form, and if I want to see the amount I have to hover on the pie chart. So when I export the visualization in PDF format, the number does not appear.",usuwono,2024-06-12 03:41:27+00:00,[],2025-02-04 20:31:28+00:00,,https://github.com/metabase/metabase/issues/44033,"[('Type:New Feature', ''), ('.Completeness', ''), ('.Frontend', ''), ('Visualization/Charts/Pie', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2163221314, 'issue_id': 2347734379, 'author': 'FilmonK', 'body': 'https://github.com/metabase/metabase/issues/12977', 'created_at': datetime.datetime(2024, 6, 12, 14, 45, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2314361392, 'issue_id': 2347734379, 'author': 'mcentrih', 'body': 'I would really like this. Values are more user frendly for some of dashboards', 'created_at': datetime.datetime(2024, 8, 28, 5, 40, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2411373403, 'issue_id': 2347734379, 'author': 'fr3fou', 'body': '+1', 'created_at': datetime.datetime(2024, 10, 14, 14, 5, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2537169067, 'issue_id': 2347734379, 'author': 'jsavage5', 'body': '+1 This would be a huge improvement for my use case as well', 'created_at': datetime.datetime(2024, 12, 11, 21, 2, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2597295129, 'issue_id': 2347734379, 'author': 'mattre1d', 'body': '+1', 'created_at': datetime.datetime(2025, 1, 17, 2, 19, 39, tzinfo=datetime.timezone.utc)}]","FilmonK on (2024-06-12 14:45:58 UTC): https://github.com/metabase/metabase/issues/12977

mcentrih on (2024-08-28 05:40:46 UTC): I would really like this. Values are more user frendly for some of dashboards

fr3fou on (2024-10-14 14:05:54 UTC): +1

jsavage5 on (2024-12-11 21:02:15 UTC): +1 This would be a huge improvement for my use case as well

mattre1d on (2025-01-17 02:19:39 UTC): +1

"
2347161763,issue,closed,completed,Remove 'animate' and 'highlightOnHover' props,,rafpaf,2024-06-11 19:45:36+00:00,[],2024-06-13 08:47:20+00:00,2024-06-12 20:55:18+00:00,https://github.com/metabase/metabase/issues/44026,[],[],
2347081806,issue,closed,completed,Custom resize handle in the notebook native query preview sidebar has custom styling again,"### Describe the bug

The custom styling for this resize handle was removed in #41877 as per the design team's instructions. It mistakenly spawned back to life in #41975 

### To Reproduce

1. Open any table in a notebook mode
2. Click on ""Show SQL""
3. Notice that the handle resembles a scrollbar
4. 
![image](https://github.com/metabase/metabase/assets/31325167/6911bbd7-ba65-4277-a343-2a159b871495)



### Expected behavior

The resize handle should not be visible. I.e. it shouldn't have any custom styling.
The whole left border is the resize handle, 10px wide.

### Logs

_No response_

### Information about your Metabase installation

```JSON
local dev, `master`, 6c1458f, H2, Sample Database
```


### Severity

P3

### Additional context

_No response_",nemanjaglumac,2024-06-11 18:54:31+00:00,['nemanjaglumac'],2024-10-08 17:08:03+00:00,2024-06-11 19:25:03+00:00,https://github.com/metabase/metabase/issues/44022,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/Notebook', 'Items specific to the Custom/Notebook query builder'), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature'), ('.Team/Querying', '')]",[],
2346982486,issue,closed,completed,improve legends,"https://metaboat.slack.com/archives/C064QMXEV9N/p1717460443337769?thread_ts=1717460135.322869&cid=C064QMXEV9N

## TODO
- [x] move to bottom (https://github.com/metabase/metabase/pull/43555/commits/9c8fcbf85ebe12bc4b519aa39d5b1c6578e9f00c)
- [x] decrease dot margin (https://github.com/metabase/metabase/pull/43555/commits/5fe843add2fd5d9831617ddc28e61fa725f5c5ee)
- [x] show in columns (https://github.com/metabase/metabase/pull/43555/commits/98c2f658ff2cf84238762fa327fd86aeac59f098)
- [x] sort items vertically in columns (https://github.com/metabase/metabase/pull/43555/commits/9f8369ddb7e3c39aada6d15dba5f618eb3b6acf3)
- [x] don't use columns if we can fit everything in one row (https://github.com/metabase/metabase/pull/43555/commits/45712c5b604d147a819cd08e720e64ab72bf7987)
- [x] legends should be aligned to chart edge, not image edge (https://github.com/metabase/metabase/pull/43969/commits/e23ff880c868cb837f0f606d702acda16b72f32d)
- [x] always show legend in static viz, even if setting is disabled (https://github.com/metabase/metabase/pull/43555/commits/a8f089c25291c4182c67e2f7b972efaf27722b78)
- [x] should center the legend if it's just one column (https://metaboat.slack.com/archives/C077SMHSUTV/p1718204317785689) (https://github.com/metabase/metabase/pull/43969/commits/e23ff880c868cb837f0f606d702acda16b72f32d)
- [x] show legend with just one item (question/14994) (https://github.com/metabase/metabase/pull/43555/commits/b51e95091fab85c7aceef74a7c8ca38b9aba5f9e)
- [x] right justify percentages (https://github.com/metabase/metabase/pull/43555/commits/5a656cc6c7cfa34be70c2801f4b27058c159eb9a)",EmmadUsmani,2024-06-11 17:55:33+00:00,['EmmadUsmani'],2024-06-17 17:44:50+00:00,2024-06-17 17:44:50+00:00,https://github.com/metabase/metabase/issues/44019,[],[],
2346944198,issue,closed,not_planned,Rename Summarize Columns in Charts,"**Is your feature request related to a problem? Please describe.**
Columns in most of visualizations can be renamed but it's no the case in Pie Charts 
![image](https://github.com/metabase/metabase/assets/109289055/1191af05-d2e6-472e-8bf1-35bf4ef7fbff)

**Describe the solution you'd like**
Just to add the option to rename the meausre column would be enough like in these cases
![image](https://github.com/metabase/metabase/assets/109289055/aa728589-476d-4ed2-8e17-17530902d2e8)

**How important is this feature to you?**
This lets details in visualizations have more customizable options. It may apply also to the other summarize columns that may appear in the details of a value, although it may be another request? I'm not sure.
![image](https://github.com/metabase/metabase/assets/109289055/3661bdc1-3220-41d6-98e6-30f2684fb436)

",nachosan2,2024-06-11 17:32:00+00:00,[],2024-07-31 18:21:16+00:00,2024-07-31 18:21:16+00:00,https://github.com/metabase/metabase/issues/44018,"[('Type:New Feature', ''), ('Visualization/Charts/Pie', '')]","[{'comment_id': 2261143567, 'issue_id': 2346944198, 'author': 'cdeweyx', 'body': 'Dupe of https://github.com/metabase/metabase/issues/9312', 'created_at': datetime.datetime(2024, 7, 31, 18, 21, 9, tzinfo=datetime.timezone.utc)}]","cdeweyx on (2024-07-31 18:21:09 UTC): Dupe of https://github.com/metabase/metabase/issues/9312

"
2346917013,issue,open,,Show all collections before any other items,"It would be neat to see all collections first. Easier to find items.

**Current State**
<img src=""https://github.com/metabase/metabase/assets/15974735/7e4ca604-b59a-439c-912d-c7e9705d1168"" height=""500"">

**Desired State**
<img src=""https://github.com/metabase/metabase/assets/15974735/b56faabd-ddcb-4b4d-90eb-f0fe98fb9418"" height=""500"">
",vvaezian,2024-06-11 17:16:02+00:00,[],2024-06-13 07:33:20+00:00,,https://github.com/metabase/metabase/issues/44017,"[('Type:New Feature', ''), ('Organization/Collections', '')]",[],
2346765122,issue,open,,[BE] Updating schemas for provider fields,,snoe,2024-06-11 15:48:20+00:00,['snoe'],2024-08-16 13:24:19+00:00,,https://github.com/metabase/metabase/issues/44013,"[('.Backend', ''), ('.Team/Querying', '')]",[],
2346757779,issue,closed,completed,Error migrating to the 50.0 with the database connection encrypted,"### Describe the bug

I have a Metabase instance that runs in the docker container with the database connection encrypted with MB_ENCRYPTION_SECRET_KEY. 
During the upgrade to 50.0 version, database migration fails. I believe that's caused by the fill_cache_config.pg.sql migration script that tries to set up the default settings for the new cache config but doesn't take into the account the fact that this setting is encrypted.
I believe it might be an issue for the migrations on the other database engines as well.
The workaround is to remove the settings keys affected by the migration scripts before the migration.

### To Reproduce

1. Have the pre-0.50.0 Metabase instance setup with MB_ENCRYPTION_SECRET_KEY setting and the query caching set up.
2. Upgrade to 0.50.0 version.
3. See the error during migration.


### Expected behavior

Migration completes successfully.

### Logs

```
2024-06-11 15:56:56 2024-06-11 12:56:56,331 INFO db.liquibase :: Database has unrun migrations. Checking if migration lock is taken...
2024-06-11 15:56:56 2024-06-11 12:56:56,348 INFO db.liquibase :: No migration lock found.
2024-06-11 15:56:56 2024-06-11 12:56:56,348 INFO db.liquibase :: Migration lock acquired.
2024-06-11 15:56:56 2024-06-11 12:56:56,609 INFO db.liquibase :: Running 32 migrations ...
2024-06-11 15:56:56 2024-06-11 12:56:56,932 ERROR liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v50.2024-04-12T12:33:09::piranha encountered an exception.
2024-06-11 15:56:56 liquibase.exception.DatabaseException: ERROR: invalid input syntax for type double precision: ""BW2J+jGXv2seSOh2ZXEehWTUWTwUJx5lSUr20Sw6mulcSaaFxjEmtgtLwE+wacV5CqyebuY/zg/e5pP7Wg5m3Q=="" [Failed SQL: (0) WITH root AS (
2024-06-11 15:56:56   select 'root' AS model,
2024-06-11 15:56:56          0      AS model_id,
2024-06-11 15:56:56          'ttl'  AS strategy,
2024-06-11 15:56:56          json_build_object(
2024-06-11 15:56:56            'multiplier', coalesce((select value::float::int from setting where key = 'query-caching-ttl-ratio'), 10),
2024-06-11 15:56:56            'min_duration_ms', coalesce((select value::float::int from setting where key = 'query-caching-min-ttl'), 60000)
2024-06-11 15:56:56          ) AS config
2024-06-11 15:56:56 ), database AS (
2024-06-11 15:56:56   select 'database' AS model,
2024-06-11 15:56:56          id         AS model_id,
2024-06-11 15:56:56          'duration' AS strategy,
2024-06-11 15:56:56          json_build_object('duration', cache_ttl, 'unit', 'hours') AS config
2024-06-11 15:56:56     from metabase_database
2024-06-11 15:56:56    where cache_ttl is not null
2024-06-11 15:56:56 ), dashboard AS (
2024-06-11 15:56:56   select 'dashboard' AS model,
2024-06-11 15:56:56          id          AS model_id,
2024-06-11 15:56:56          'duration'  AS strategy,
2024-06-11 15:56:56          json_build_object('duration', cache_ttl, 'unit', 'hours') AS config
2024-06-11 15:56:56     from report_dashboard
2024-06-11 15:56:56    where cache_ttl is not null
2024-06-11 15:56:56 ), card AS (
2024-06-11 15:56:56   select 'question' AS model,
2024-06-11 15:56:56          id         AS model_id,
2024-06-11 15:56:56          'duration' AS strategy,
2024-06-11 15:56:56          json_build_object('duration', cache_ttl, 'unit', 'hours') AS config
2024-06-11 15:56:56     from report_card
2024-06-11 15:56:56    where cache_ttl is not null
2024-06-11 15:56:56 ), rows1 AS (
2024-06-11 15:56:56   SELECT * FROM root UNION ALL
2024-06-11 15:56:56   SELECT * FROM database UNION ALL
2024-06-11 15:56:56   SELECT * FROM dashboard UNION ALL
2024-06-11 15:56:56   SELECT * FROM card
2024-06-11 15:56:56 ), rows AS (
2024-06-11 15:56:56   SELECT * FROM rows1
2024-06-11 15:56:56    WHERE (SELECT true FROM setting WHERE key = 'enable-query-caching' AND VALUE = 'true')
2024-06-11 15:56:56 )
2024-06-11 15:56:56     INSERT INTO cache_config (model, model_id, strategy, config)
2024-06-11 15:56:56     SELECT * FROM rows
2024-06-11 15:56:56     ON CONFLICT (model, model_id) DO NOTHING]
2024-06-11 15:56:56     at liquibase.executor.jvm.JdbcExecutor$ExecuteStatementCallback.doInStatement(jdbcexecutor.java:470)
2024-06-11 15:56:56     at liquibase.executor.jvm.JdbcExecutor.execute(jdbcexecutor.java:77)
2024-06-11 15:56:56     at liquibase.executor.jvm.JdbcExecutor.execute(jdbcexecutor.java:179)
2024-06-11 15:56:56     at liquibase.executor.AbstractExecutor.execute(abstractexecutor.java:141)
2024-06-11 15:56:56     at liquibase.database.AbstractJdbcDatabase.executeStatements(abstractjdbcdatabase.java:1285)
2024-06-11 15:56:56     at liquibase.changelog.ChangeSet.execute(changeset.java:755)
2024-06-11 15:56:56     at liquibase.changelog.visitor.UpdateVisitor.executeAcceptedChange(updatevisitor.java:119)
2024-06-11 15:56:56     at liquibase.changelog.visitor.UpdateVisitor.visit(updatevisitor.java:68)
2024-06-11 15:56:56     at liquibase.changelog.ChangeLogIterator$2.lambda$run$0(changelogiterator.java:133)
2024-06-11 15:56:56     at liquibase.changelog.ChangeLogIterator$2.lambda$run$0(changelogiterator.java:133)
2024-06-11 15:56:56     at liquibase.Scope.lambda$child$0(scope.java:186)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:195)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:185)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:164)
2024-06-11 15:56:56     at liquibase.changelog.ChangeLogIterator$[2.run](https://2.run/)(changelogiterator.java:122)
2024-06-11 15:56:56     at liquibase.Scope.lambda$child$0(scope.java:186)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:195)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:185)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:164)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:252)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:256)
2024-06-11 15:56:56     at [liquibase.changelog.ChangeLogIterator.run](https://liquibase.changelog.changelogiterator.run/)(changelogiterator.java:89)
2024-06-11 15:56:56     at liquibase.command.core.AbstractUpdateCommandStep.lambda$run$0(abstractupdatecommandstep.java:110)
2024-06-11 15:56:56     at liquibase.Scope.lambda$child$0(scope.java:186)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:195)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:185)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:164)
2024-06-11 15:56:56     at [liquibase.command.core.AbstractUpdateCommandStep.run](https://liquibase.command.core.abstractupdatecommandstep.run/)(abstractupdatecommandstep.java:108)
2024-06-11 15:56:56     at [liquibase.command.core.UpdateCommandStep.run](https://liquibase.command.core.updatecommandstep.run/)(updatecommandstep.java:105)
2024-06-11 15:56:56     at liquibase.command.CommandScope.execute(commandscope.java:217)
2024-06-11 15:56:56     at liquibase.Liquibase.lambda$update$0(liquibase.java:245)
2024-06-11 15:56:56     at liquibase.Scope.lambda$child$0(scope.java:186)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:195)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:185)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:164)
2024-06-11 15:56:56     at liquibase.Liquibase.runInScope(liquibase.java:1419)
2024-06-11 15:56:56     at liquibase.Liquibase.update(liquibase.java:234)
2024-06-11 15:56:56     at liquibase.Liquibase.update(liquibase.java:212)
2024-06-11 15:56:56     at liquibase.Liquibase.update(liquibase.java:194)
2024-06-11 15:56:56     at metabase.db.liquibase$migrate_up_if_needed_BANG_$fn__44378.invoke(liquibase.clj:359)
2024-06-11 15:56:56     at metabase.db.liquibase$run_in_scope_locked$reify__44374.run(liquibase.clj:324)
2024-06-11 15:56:56     at liquibase.Scope.lambda$child$0(scope.java:186)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:195)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:185)
2024-06-11 15:56:56     at liquibase.Scope.child(scope.java:164)
2024-06-11 15:56:56     at metabase.db.liquibase$run_in_scope_locked.invokeStatic(liquibase.clj:317)
2024-06-11 15:56:56     at metabase.db.liquibase$run_in_scope_locked.invoke(liquibase.clj:300)
2024-06-11 15:56:56     at metabase.db.liquibase$migrate_up_if_needed_BANG_.invokeStatic(liquibase.clj:348)
2024-06-11 15:56:56     at metabase.db.liquibase$migrate_up_if_needed_BANG_.invoke(liquibase.clj:341)
2024-06-11 15:56:56     at metabase.db.setup$migrate_BANG_$fn__53305.invoke(setup.clj:84)
2024-06-11 15:56:56     at metabase.db.liquibase$do_with_liquibase$f_STAR___44315.invoke(liquibase.clj:139)
2024-06-11 15:56:56     at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:142)
2024-06-11 15:56:56     at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:130)
2024-06-11 15:56:56     at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:73)
2024-06-11 15:56:56     at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:55)
2024-06-11 15:56:56     at clojure.lang.RestFn.invoke(restfn.java:425)
2024-06-11 15:56:56     at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:149)
2024-06-11 15:56:56     at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:144)
2024-06-11 15:56:56     at metabase.db.setup$setup_db_BANG_$fn53333$fn53334.invoke(setup.clj:167)
2024-06-11 15:56:56     at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)
2024-06-11 15:56:56     at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)
2024-06-11 15:56:56     at metabase.db.setup$setup_db_BANG_$fn__53333.invoke(setup.clj:161)
2024-06-11 15:56:56     at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:160)
2024-06-11 15:56:56     at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:153)
2024-06-11 15:56:56     at metabase.db$setup_db_BANG_$fn__53358.invoke(db.clj:82)
2024-06-11 15:56:56     at metabase.db$setup_db_BANG_.invokeStatic(db.clj:77)
2024-06-11 15:56:56     at metabase.db$setup_db_BANG_.doInvoke(db.clj:64)
2024-06-11 15:56:56     at clojure.lang.RestFn.invoke(restfn.java:421)
2024-06-11 15:56:56     at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:117)
2024-06-11 15:56:56     at metabase.core$init_BANG__STAR_.invoke(core.clj:98)
2024-06-11 15:56:56     at metabase.core$init_BANG_.invokeStatic(core.clj:170)
2024-06-11 15:56:56     at metabase.core$init_BANG_.invoke(core.clj:165)
2024-06-11 15:56:56     at metabase.core$start_normally.invokeStatic(core.clj:182)
2024-06-11 15:56:56     at metabase.core$start_normally.invoke(core.clj:176)
2024-06-11 15:56:56     at metabase.core$entrypoint.invokeStatic(core.clj:215)
2024-06-11 15:56:56     at metabase.core$entrypoint.doInvoke(core.clj:209)
2024-06-11 15:56:56     at clojure.lang.RestFn.invoke(restfn.java:397)
2024-06-11 15:56:56     at clojure.lang.AFn.applyToHelper(afn.java:152)
2024-06-11 15:56:56     at clojure.lang.RestFn.applyTo(restfn.java:132)
2024-06-11 15:56:56     at clojure.lang.Var.applyTo(var.java:705)
2024-06-11 15:56:56     at clojure.core$apply.invokeStatic(core.clj:667)
2024-06-11 15:56:56     at clojure.core$apply.invoke(core.clj:662)
2024-06-11 15:56:56     at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
2024-06-11 15:56:56     at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
2024-06-11 15:56:56     at clojure.lang.RestFn.invoke(restfn.java:397)
2024-06-11 15:56:56     at clojure.lang.AFn.applyToHelper(afn.java:152)
2024-06-11 15:56:56     at clojure.lang.RestFn.applyTo(restfn.java:132)
2024-06-11 15:56:56     at metabase.bootstrap.main(Unknown Source)
2024-06-11 15:56:56 Caused by: org.postgresql.util.PSQLException: ERROR: invalid input syntax for type double precision: ""BW2J+jGXv2seSOh2ZXEehWTUWTwUJx5lSUr20Sw6mulcSaaFxjEmtgtLwE+wacV5CqyebuY/zg/e5pP7Wg5m3Q==""
2024-06-11 15:56:56     at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(queryexecutorimpl.java:2725)
2024-06-11 15:56:56     at org.postgresql.core.v3.QueryExecutorImpl.processResults(queryexecutorimpl.java:2412)
2024-06-11 15:56:56     at org.postgresql.core.v3.QueryExecutorImpl.execute(queryexecutorimpl.java:371)
2024-06-11 15:56:56     at org.postgresql.jdbc.PgStatement.executeInternal(pgstatement.java:502)
2024-06-11 15:56:56     at org.postgresql.jdbc.PgStatement.execute(pgstatement.java:419)
2024-06-11 15:56:56     at org.postgresql.jdbc.PgStatement.executeWithFlags(pgstatement.java:341)
2024-06-11 15:56:56     at org.postgresql.jdbc.PgStatement.executeCachedSql(pgstatement.java:326)
2024-06-11 15:56:56     at org.postgresql.jdbc.PgStatement.executeWithFlags(pgstatement.java:302)
2024-06-11 15:56:56     at org.postgresql.jdbc.PgStatement.execute(pgstatement.java:297)
2024-06-11 15:56:56     at com.mchange.v2.c3p0.impl.NewProxyStatement.execute(newproxystatement.java:75)
2024-06-11 15:56:56     at liquibase.executor.jvm.JdbcExecutor$ExecuteStatementCallback.doInStatement(jdbcexecutor.java:464)
2024-06-11 15:56:56     ... 86 more
2024-06-11 15:56:56 
2024-06-11 15:56:56 UPDATE SUMMARY
2024-06-11 15:56:56 Run:                         32
2024-06-11 15:56:56 Previously run:             302
2024-06-11 15:56:56 Filtered out:                49
2024-06-11 15:56:56 -------------------------------
2024-06-11 15:56:56 Total change sets:          383
```

### Information about your Metabase installation

```JSON
- Metabase version: 0.49.6 (tried the migration starting with the 0.49.13 as well
- Metabase environment: Docker
- Metabase internal database: PostgreSQL
```


### Severity

blocking usage of Metabase entirely

### Additional context

_No response_",ilkar399,2024-06-11 15:44:49+00:00,['piranha'],2024-06-12 21:12:38+00:00,2024-06-12 21:12:38+00:00,https://github.com/metabase/metabase/issues/44012,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Operation/Database Migrations', 'Issues with application DB migrations when launching Metabase'), ('.Backend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Escalation', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2161157627, 'issue_id': 2346757779, 'author': 'paoliniluis', 'body': 'regression of https://github.com/metabase/metabase/issues/42612', 'created_at': datetime.datetime(2024, 6, 11, 16, 21, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163590206, 'issue_id': 2346757779, 'author': 'calherries', 'body': 'backport https://github.com/metabase/metabase/pull/44077 will close it', 'created_at': datetime.datetime(2024, 6, 12, 17, 43, 56, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-11 16:21:27 UTC): regression of https://github.com/metabase/metabase/issues/42612

calherries on (2024-06-12 17:43:56 UTC): backport https://github.com/metabase/metabase/pull/44077 will close it

"
2346716726,issue,closed,completed,Improve indexes on login_history table,"### Describe the bug

Slack thread: https://metaboat.slack.com/archives/C05MPF0TM3L/p1718116225353229

The index `idx_user_id_device_id` is defined on `(session_id, device_id)`. We should change it to be on `(user_id, device_id)` and/or add a new index for this. 

### To Reproduce

n/a		

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Current master
```


### Severity

p3

### Additional context

_No response_",noahmoss,2024-06-11 15:25:39+00:00,['noahmoss'],2024-06-13 18:17:34+00:00,2024-06-13 18:13:03+00:00,https://github.com/metabase/metabase/issues/44009,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Performance', ''), ('.Backend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2346618528,issue,closed,completed,"net.sf.jsqlparser.parser.ParseException on ""FINAL"" or ""||""","**Describe the bug**
Recently migrated metabase to v0.50.0 from a very old version. Along with that moved it to ECS from elastic beanstalk. CPU and memory consumption looks fine < 60%. Post migration questions are taking a long time to load. Simple filtering in tables is taking more than 30 seconds. Along with that I see a lot of query parsing errors.

**Logs**

```
net.sf.jsqlparser.JSQLParserException: net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: ""final"" ""FINAL"",    at line 83, column 3.,Was expecting one of:,    ""ACTION"",    ""ACTIVE"",    ""ADD"",    ""ADVANCE"",    ""ADVISE"",    ""AGAINST"",    ""ALGORITHM"",    ""ALTER"",    ""ANALYZE"",    ""APPLY"",    ""ARCHIVE"",    ""ARRAY"",    ""ASC"",    ""AT"",    ""AUTHORIZATION"",    ""AUTO"",    ""BEGIN"",    ""BERNOULLI"",    ""BINARY"",    ""BIT"",    ""BLOCK"",    ""BROWSE"",    ""BUFFERS"",    ""BY"",    ""BYTE"",    ""BYTES"",    ""CACHE"",    ""CALL"",    ""CASCADE"",    ""CASE"",    ""CAST"",    ""CHANGE"",    ""CHANGES"",    ""CHAR"",    ""CHARACTER"",    ""CHECKPOINT"",    ""CLOSE"",    ""COLLATE"",    ""COLUMN"",    ""COLUMNS"",    ""COMMENT"",    ""COMMIT"",    ""CONCURRENTLY"",    ""CONFLICT"",    ""CONNECT"",    ""CONSTRAINTS"",    ""CONVERT"",    ""COSTS"",    ""CREATE"",    ""CS"",    ""CYCLE"",    ""DATA"",    ""DATABASE"",    ""DDL"",    ""DECLARE"",    ""DEFAULT"",    ""DEFERRABLE"",    ""DELAYED"",    ""DELETE"",    ""DESC"",    ""DESCRIBE"",    ""DISABLE"",    ""DISCONNECT"",    ""DIV"",    ""DML"",    ""DO"",    ""DOMAIN"",    ""DROP"",    ""DUMP"",    ""DUPLICATE"",    ""ELEMENTS"",    ""EMIT"",    ""ENABLE"",    ""END"",    ""ESCAPE"",    ""EXCLUDE"",    ""EXEC"",    ""EXECUTE"",    ""EXPLAIN"",    ""EXPLICIT"",    ""EXTENDED"",    ""EXTRACT"",    ""FALSE"",    ""FILTER"",    ""FIRST"",    ""FLUSH"",    ""FN"",    ""FOLLOWING"",    ""FORMAT"",    ""FULLTEXT"",    ""FUNCTION"",    ""GRANT"",    ""GROUP"",    ""GUARD"",    ""HASH"",    ""HISTORY"",    ""HOPPING"",    ""IGNORE"",    ""INCLUDE"",    ""INCREMENT"",    ""INDEX"",    ""INSERT"",    ""INTERLEAVE"",    ""INTERPRET"",    ""INTERVAL"",    ""INVALIDATE"",    ""ISNULL"",    ""JSON"",    ""KEEP"",    ""KEY"",    ""KEYS"",    ""LAST"",    ""LEADING"",    ""LINK"",    ""LOCAL"",    ""LOCKED"",    ""LOG"",    ""LOOP"",    ""MATCH"",    ""MATCHED"",    ""MATERIALIZED"",    ""MAXVALUE"",    ""MEMBER"",    ""MERGE"",    ""MINVALUE"",    ""MODIFY"",    ""MOVEMENT"",    ""NEXT"",    ""NO"",    ""NOCACHE"",    ""NOKEEP"",    ""NOLOCK"",    ""NOMAXVALUE"",    ""NOMINVALUE"",    ""NOORDER"",    ""NOTHING"",    ""NOTNULL"",    ""NOVALIDATE"",    ""NOWAIT"",    ""NULLS"",    ""OF"",    ""OFF"",    ""ON"",    ""OPEN"",    ""OVER"",    ""OVERLAPS"",    ""PARALLEL"",    ""PARENT"",    ""PARTITION"",    ""PATH"",    ""PERCENT"",    ""PLACING"",    ""PRECEDING"",    ""PRECISION"",    ""PRIMARY"",    ""PRIOR"",    ""PURGE"",    ""QUALIFY"",    ""QUERY"",    ""QUICK"",    ""QUIESCE"",    ""RANGE"",    ""RAW"",    ""READ"",    ""RECURSIVE"",    ""RECYCLEBIN"",    ""REFERENCES"",    ""REFRESH"",    ""REGISTER"",    ""REMOTE"",    ""RENAME"",    ""REPEATABLE"",    ""REPLACE"",    ""RESET"",    ""RESTART"",    ""RESTRICT"",    ""RESTRICTED"",    ""RESUMABLE"",    ""RESUME"",    ""RETURN"",    ""RLIKE"",    ""ROLLBACK"",    ""ROLLUP"",    ""ROOT"",    ""ROW"",    ""ROWS"",    ""RR"",    ""RS"",    ""SAVEPOINT"",    ""SCHEMA"",    ""SECURE"",    ""SEED"",    ""SEPARATOR"",    ""SEQUENCE"",    ""SESSION"",    ""SETS"",    ""SHARE"",    ""SHOW"",    ""SHUTDOWN"",    ""SIBLINGS"",    ""SIGNED"",    ""SIMILAR"",    ""SIZE"",    ""SKIP"",    ""START"",    ""STORED"",    ""STRING"",    ""SUSPEND"",    ""SWITCH"",    ""SYNONYM"",    ""SYSTEM"",    ""TABLE"",    ""TABLES"",    ""TABLESPACE"",    ""TEMP"",    ""TEMPORARY"",    ""THEN"",    ""TIMEOUT"",    ""TIMESTAMPTZ"",    ""TIMEZONE"",    ""TO"",    ""TOP"",    ""TRIGGER"",    ""TRUE"",    ""TRUNCATE"",    ""TUMBLING"",    ""TYPE"",    ""UNLOGGED"",    ""UNQIESCE"",    ""UNSIGNED"",    ""UPDATE"",    ""UPSERT"",    ""UR"",    ""USER"",    ""VALIDATE"",    ""VALUE"",    ""VALUES"",    ""VERBOSE"",    ""VIEW"",    ""VOLATILE"",    ""WAIT"",    ""WITHIN"",    ""WITHOUT"",    ""WORK"",    ""XML"",    ""XMLAGG"",    ""XMLDATA"",    ""XMLSCHEMA"",    ""XMLTEXT"",    ""XSINIL"",    ""YAML"",    ""YES"",    ""ZONE"",    <K_DATETIMELITERAL>,    <K_DATE_LITERAL>,    <K_ISOLATION>,    <K_STRING_FUNCTION_NAME>,    <K_TIME_KEY_EXPR>,    <S_IDENTIFIER>,    <S_QUOTED_IDENTIFIER>,	at net.sf.jsqlparser.parser.CCJSqlParserUtil.parseStatement(CCJSqlParserUtil.java:350),	at net.sf.jsqlparser.parser.CCJSqlParserUtil.parse(CCJSqlParserUtil.java:123),	at net.sf.jsqlparser.parser.CCJSqlParserUtil.parse(CCJSqlParserUtil.java:89),	at net.sf.jsqlparser.parser.CCJSqlParserUtil.parse(CCJSqlParserUtil.java:62),	at macaw.core$parsed_query.invokeStatic(core.clj:13),	at macaw.core$parsed_query.invoke(core.clj:10),	at metabase.native_query_analyzer$field_ids_for_sql.invokeStatic(native_query_analyzer.clj:155),	at metabase.native_query_analyzer$field_ids_for_sql.invoke(native_query_analyzer.clj:141),	at metabase.models.query_field$query_field_ids.invokeStatic(query_field.clj:27),	at metabase.models.query_field$query_field_ids.invoke(query_field.clj:19),	at metabase.models.query_field$update_query_fields_for_card_BANG_.invokeStatic(query_field.clj:42),	at metabase.models.query_field$update_query_fields_for_card_BANG_.invoke(query_field.clj:34),	at metabase.models.card$each_row_fn_primary_method_toucan_query_type_update__STAR__model_Card$fn__77144.invoke(card.clj:582),	at toucan2.tools.after$define_after_impl$f__25286.invoke(after.clj:107),	at toucan2.tools.after$results_transform_primary_method_toucan_result_type_instances_toucan2_tools_after_model$row_fn__25261.invoke(after.clj:49),	at clojure.core$map$fn__5931$fn__5932.invoke(core.clj:2759),	at clojure.core$map$fn__5931$fn__5932.invoke(core.clj:2759),	at clojure.core$map$fn__5931$fn__5932.invoke(core.clj:2759),	at clojure.core$map$fn__5931$fn__5932.invoke(core.clj:2759),	at toucan2.jdbc.result_set$reduce_result_set.invokeStatic(result_set.clj:158),	at toucan2.jdbc.result_set$reduce_result_set.invoke(result_set.clj:125),	at toucan2.jdbc.query$reduce_jdbc_query.invokeStatic(query.clj:51),	at toucan2.jdbc.query$reduce_jdbc_query.invoke(query.clj:22),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invokeStatic(pipeline.clj:19),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invoke(pipeline.clj:9),	at clojure.lang.AFn.applyToHelper(AFn.java:178),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$partial$fn__5908.doInvoke(core.clj:2639),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18078.invoke(threaded.clj:79),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.doInvoke(core.clj:2589),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$apply.doInvoke(core.clj:662),	at clojure.lang.RestFn.invoke(RestFn.java:533),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.doInvoke(threaded.clj:46),	at clojure.lang.RestFn.applyTo(RestFn.java:151),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$apply.doInvoke(core.clj:662),	at clojure.lang.RestFn.invoke(RestFn.java:533),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65),	at methodical.impl.standard$invoke_multifn.doInvoke(standard.clj:47),	at clojure.lang.RestFn.invoke(RestFn.java:594),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:199),	at toucan2.pipeline$transduce_execute$with_connection_STAR___21303.invoke(pipeline.clj:78),	at toucan2.connection$bind_current_connectable_fn$fn__20980.invoke(connection.clj:104),	at toucan2.connection$bind_current_connectable_fn$fn__20980.invoke(connection.clj:104),	at toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invokeStatic(connection.clj:13),	at toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invoke(connection.clj:11),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18072.invoke(threaded.clj:70),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.invoke(core.clj:2587),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.invoke(threaded.clj:43),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193),	at toucan2.connection$do_with_connection_primary_method_.invokeStatic(connection.clj:204),	at toucan2.connection$do_with_connection_primary_method_.invoke(connection.clj:194),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18072.invoke(threaded.clj:70),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.invoke(core.clj:2587),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.invoke(threaded.clj:43),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193),	at toucan2.pipeline$transduce_execute.invokeStatic(pipeline.clj:77),	at toucan2.pipeline$transduce_execute.invoke(pipeline.clj:64),	at clojure.lang.Var.invoke(Var.java:399),	at toucan2.pipeline$transduce_compiled_query.invokeStatic(pipeline.clj:244),	at toucan2.pipeline$transduce_compiled_query.invoke(pipeline.clj:240),	at toucan2.pipeline$transduce_built_query.invokeStatic(pipeline.clj:252),	at toucan2.pipeline$transduce_built_query.invoke(pipeline.clj:246),	at toucan2.pipeline$transduce_query_primary_method_default.invokeStatic(pipeline.clj:272),	at toucan2.pipeline$transduce_query_primary_method_default.invoke(pipeline.clj:269),	at clojure.lang.AFn.applyToHelper(AFn.java:178),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$partial$fn__5908.doInvoke(core.clj:2639),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18078.invoke(threaded.clj:79),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.doInvoke(core.clj:2589),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$apply.doInvoke(core.clj:662),	at clojure.lang.RestFn.invoke(RestFn.java:533),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.doInvoke(threaded.clj:46),	at clojure.lang.RestFn.applyTo(RestFn.java:151),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$apply.doInvoke(core.clj:662),	at clojure.lang.RestFn.invoke(RestFn.java:533),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65),	at methodical.impl.standard$invoke_multifn.doInvoke(standard.clj:47),	at clojure.lang.RestFn.invoke(RestFn.java:594),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:199),	at toucan2.jdbc.pipeline$transduce_instances_from_pks.invokeStatic(pipeline.clj:43),	at toucan2.jdbc.pipeline$transduce_instances_from_pks.invoke(pipeline.clj:32),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_toucan2_jdbc_pipeline_DML_queries_returning_instances_default.invokeStatic(pipeline.clj:68),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_toucan2_jdbc_pipeline_DML_queries_returning_instances_default.invoke(pipeline.clj:52),	at clojure.lang.AFn.applyToHelper(AFn.java:178),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$partial$fn__5908.doInvoke(core.clj:2639),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18078.invoke(threaded.clj:79),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.doInvoke(core.clj:2589),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$apply.doInvoke(core.clj:662),	at clojure.lang.RestFn.invoke(RestFn.java:533),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.doInvoke(threaded.clj:46),	at clojure.lang.RestFn.applyTo(RestFn.java:151),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$apply.doInvoke(core.clj:662),	at clojure.lang.RestFn.invoke(RestFn.java:533),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65),	at methodical.impl.standard$invoke_multifn.doInvoke(standard.clj:47),	at clojure.lang.RestFn.invoke(RestFn.java:594),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:199),	at toucan2.pipeline$transduce_execute$with_connection_STAR___21299$with_transaction_STAR___21300.invoke(pipeline.clj:75),	at toucan2.connection$bind_current_connectable_fn$fn__20980.invoke(connection.clj:104),	at metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invokeStatic(connection.clj:180),	at metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invoke(connection.clj:162),	at clojure.lang.AFn.applyToHelper(AFn.java:165),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:457),	at clojure.core$partial$fn__5908.invoke(core.clj:2643),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18074.invoke(threaded.clj:71),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.invoke(core.clj:2588),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.invoke(threaded.clj:44),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invokeStatic(connection.clj:249),	at toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invoke(connection.clj:245),	at clojure.lang.AFn.applyToHelper(AFn.java:165),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:457),	at clojure.core$partial$fn__5908.invoke(core.clj:2643),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:58),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:195),	at toucan2.pipeline$transduce_execute$with_connection_STAR___21299.invoke(pipeline.clj:74),	at toucan2.connection$bind_current_connectable_fn$fn__20980.invoke(connection.clj:104),	at toucan2.connection$bind_current_connectable_fn$fn__20980.invoke(connection.clj:104),	at toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invokeStatic(connection.clj:13),	at toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invoke(connection.clj:11),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18072.invoke(threaded.clj:70),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.invoke(core.clj:2587),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.invoke(threaded.clj:43),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193),	at toucan2.connection$do_with_connection_primary_method_.invokeStatic(connection.clj:204),	at toucan2.connection$do_with_connection_primary_method_.invoke(connection.clj:194),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18072.invoke(threaded.clj:70),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.invoke(core.clj:2587),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.invoke(threaded.clj:43),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193),	at toucan2.pipeline$transduce_execute.invokeStatic(pipeline.clj:74),	at toucan2.pipeline$transduce_execute.invoke(pipeline.clj:64),	at clojure.lang.Var.invoke(Var.java:399),	at toucan2.pipeline$transduce_compiled_query.invokeStatic(pipeline.clj:244),	at toucan2.pipeline$transduce_compiled_query.invoke(pipeline.clj:240),	at toucan2.pipeline$transduce_built_query.invokeStatic(pipeline.clj:252),	at toucan2.pipeline$transduce_built_query.invoke(pipeline.clj:246),	at toucan2.pipeline$transduce_query_primary_method_default.invokeStatic(pipeline.clj:272),	at toucan2.pipeline$transduce_query_primary_method_default.invoke(pipeline.clj:269),	at clojure.lang.AFn.applyToHelper(AFn.java:178),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$partial$fn__5908.doInvoke(core.clj:2639),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:482),	at toucan2.tools.after$transduce_query_primary_method_toucan2_tools_after_query_type_toucan2_tools_after_model_default.invokeStatic(after.clj:95),	at toucan2.tools.after$transduce_query_primary_method_toucan2_tools_after_query_type_toucan2_tools_after_model_default.invoke(after.clj:84),	at clojure.lang.AFn.applyToHelper(AFn.java:178),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$partial$fn__5908.doInvoke(core.clj:2639),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:482),	at toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default.invokeStatic(before_update.clj:102),	at toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default.invoke(before_update.clj:94),	at clojure.lang.AFn.applyToHelper(AFn.java:178),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$partial$fn__5908.doInvoke(core.clj:2639),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18078.invoke(threaded.clj:79),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.doInvoke(core.clj:2589),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$apply.doInvoke(core.clj:662),	at clojure.lang.RestFn.invoke(RestFn.java:533),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.doInvoke(threaded.clj:46),	at clojure.lang.RestFn.applyTo(RestFn.java:151),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$apply.doInvoke(core.clj:662),	at clojure.lang.RestFn.invoke(RestFn.java:533),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65),	at methodical.impl.standard$invoke_multifn.doInvoke(standard.clj:47),	at clojure.lang.RestFn.invoke(RestFn.java:594),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:199),	at toucan2.tools.after$transduce_query_primary_method_toucan2_tools_after_query_type_toucan2_tools_after_model_default.invokeStatic(after.clj:102),	at toucan2.tools.after$transduce_query_primary_method_toucan2_tools_after_query_type_toucan2_tools_after_model_default.invoke(after.clj:84),	at clojure.lang.AFn.applyToHelper(AFn.java:178),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$partial$fn__5908.doInvoke(core.clj:2639),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:482),	at toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default$with_connection_STAR___25544$with_transaction_STAR___25545$fn__25546.invoke(before_update.clj:115),	at clojure.core$map$fn__5931$fn__5932.invoke(core.clj:2759),	at clojure.lang.PersistentVector.reduce(PersistentVector.java:343),	at clojure.core$transduce.invokeStatic(core.clj:6947),	at clojure.core$transduce.invokeStatic(core.clj:6943),	at clojure.core$transduce.invoke(core.clj:6934),	at toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default$with_connection_STAR___25544$with_transaction_STAR___25545.invoke(before_update.clj:113),	at toucan2.connection$bind_current_connectable_fn$fn__20980.invoke(connection.clj:104),	at metabase.db.connection$do_transaction$thunk__42540.invoke(connection.clj:140),	at metabase.db.connection$do_transaction.invokeStatic(connection.clj:152),	at metabase.db.connection$do_transaction.invoke(connection.clj:136),	at metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invokeStatic(connection.clj:189),	at metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invoke(connection.clj:162),	at clojure.lang.AFn.applyToHelper(AFn.java:165),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:457),	at clojure.core$partial$fn__5908.invoke(core.clj:2643),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18074.invoke(threaded.clj:71),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.invoke(core.clj:2588),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.invoke(threaded.clj:44),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invokeStatic(connection.clj:249),	at toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invoke(connection.clj:245),	at clojure.lang.AFn.applyToHelper(AFn.java:165),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:457),	at clojure.core$partial$fn__5908.invoke(core.clj:2643),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:58),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:195),	at toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default$with_connection_STAR___25544.invoke(before_update.clj:112),	at toucan2.connection$bind_current_connectable_fn$fn__20980.invoke(connection.clj:104),	at toucan2.connection$bind_current_connectable_fn$fn__20980.invoke(connection.clj:104),	at toucan2.connection$bind_current_connectable_fn$fn__20980.invoke(connection.clj:104),	at toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource.invokeStatic(connection.clj:18),	at toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource.invoke(connection.clj:15),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18072.invoke(threaded.clj:70),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.invoke(core.clj:2587),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.invoke(threaded.clj:43),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193),	at metabase.db.connection$do_with_connection_primary_method_default.invokeStatic(connection.clj:132),	at metabase.db.connection$do_with_connection_primary_method_default.invoke(connection.clj:130),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18072.invoke(threaded.clj:70),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.invoke(core.clj:2587),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.invoke(threaded.clj:43),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193),	at toucan2.connection$do_with_connection_primary_method_.invokeStatic(connection.clj:204),	at toucan2.connection$do_with_connection_primary_method_.invoke(connection.clj:194),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18072.invoke(threaded.clj:70),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.invoke(core.clj:2587),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.invoke(threaded.clj:43),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118),	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193),	at toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default.invokeStatic(before_update.clj:112),	at toucan2.tools.before_update$transduce_query_primary_method_toucan_query_type_update__STAR__toucan2_tools_before_update_before_update_default.invoke(before_update.clj:94),	at clojure.lang.AFn.applyToHelper(AFn.java:178),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$partial$fn__5908.doInvoke(core.clj:2639),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at methodical.impl.combo.threaded$fn__18070$fn__18071$fn__18078.invoke(threaded.clj:79),	at methodical.impl.combo.threaded$reducer_fn$fn__18040$fn__18044.invoke(threaded.clj:23),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$reduce.invokeStatic(core.clj:6887),	at clojure.core$reduce.invoke(core.clj:6869),	at methodical.impl.combo.threaded$reducer_fn$fn__18040.invoke(threaded.clj:21),	at clojure.core$comp$fn__5876.doInvoke(core.clj:2589),	at clojure.lang.RestFn.applyTo(RestFn.java:146),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$apply.doInvoke(core.clj:662),	at clojure.lang.RestFn.invoke(RestFn.java:533),	at methodical.impl.combo.threaded$combine_with_threader$fn__18050.doInvoke(threaded.clj:46),	at clojure.lang.RestFn.applyTo(RestFn.java:151),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.applyTo(RestFn.java:137),	at clojure.core$apply.invokeStatic(core.clj:675),	at clojure.core$apply.doInvoke(core.clj:662),	at clojure.lang.RestFn.invoke(RestFn.java:533),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65),	at methodical.impl.standard$invoke_multifn.doInvoke(standard.clj:47),	at clojure.lang.RestFn.invoke(RestFn.java:594),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:199),	at toucan2.pipeline$transduce_query_STAR_.invokeStatic(pipeline.clj:278),	at toucan2.pipeline$transduce_query_STAR_.invoke(pipeline.clj:274),	at toucan2.pipeline$transduce_with_model.invokeStatic(pipeline.clj:293),	at toucan2.pipeline$transduce_with_model.invoke(pipeline.clj:280),	at toucan2.pipeline$transduce_parsed.invokeStatic(pipeline.clj:309),	at toucan2.pipeline$transduce_parsed.invoke(pipeline.clj:295),	at toucan2.pipeline$transduce_unparsed.invokeStatic(pipeline.clj:317),	at toucan2.pipeline$transduce_unparsed.invoke(pipeline.clj:311),	at toucan2.pipeline$transduce_unparsed_with_default_rf.invokeStatic(pipeline.clj:374),	at toucan2.pipeline$transduce_unparsed_with_default_rf.invoke(pipeline.clj:368),	at toucan2.update$update_BANG_.invokeStatic(update.clj:53),	at toucan2.update$update_BANG_.doInvoke(update.clj:50),	at clojure.lang.RestFn.invoke(RestFn.java:457),	at metabase.query_processor.middleware.update_used_cards$update_used_cards_BANG__STAR_$fn__69477.invoke(update_used_cards.clj:20),	at clojure.lang.AFn.run(AFn.java:22),	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source),Caused by: java.util.concurrent.ExecutionException: net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: ""final"" ""FINAL"",    at line 83, column 3.,Was expecting one of:,    ""ACTION"",    ""ACTIVE"",    ""ADD"",    ""ADVANCE"",    ""ADVISE"",    ""AGAINST"",    ""ALGORITHM"",    ""ALTER"",    ""ANALYZE"",    ""APPLY"",    ""ARCHIVE"",    ""ARRAY"",    ""ASC"",    ""AT"",    ""AUTHORIZATION"",    ""AUTO"",    ""BEGIN"",    ""BERNOULLI"",    ""BINARY"",    ""BIT"",    ""BLOCK"",    ""BROWSE"",    ""BUFFERS"",    ""BY"",    ""BYTE"",    ""BYTES"",    ""CACHE"",    ""CALL"",    ""CASCADE"",    ""CASE"",    ""CAST"",    ""CHANGE"",    ""CHANGES"",    ""CHAR"",    ""CHARACTER"",    ""CHECKPOINT"",    ""CLOSE"",    ""COLLATE"",    ""COLUMN"",    ""COLUMNS"",    ""COMMENT"",    ""COMMIT"",    ""CONCURRENTLY"",    ""CONFLICT"",    ""CONNECT"",    ""CONSTRAINTS"",    ""CONVERT"",    ""COSTS"",    ""CREATE"",    ""CS"",    ""CYCLE"",    ""DATA"",    ""DATABASE"",    ""DDL"",    ""DECLARE"",    ""DEFAULT"",    ""DEFERRABLE"",    ""DELAYED"",    ""DELETE"",    ""DESC"",    ""DESCRIBE"",    ""DISABLE"",    ""DISCONNECT"",    ""DIV"",    ""DML"",    ""DO"",    ""DOMAIN"",    ""DROP"",    ""DUMP"",    ""DUPLICATE"",    ""ELEMENTS"",    ""EMIT"",    ""ENABLE"",    ""END"",    ""ESCAPE"",    ""EXCLUDE"",    ""EXEC"",    ""EXECUTE"",    ""EXPLAIN"",    ""EXPLICIT"",    ""EXTENDED"",    ""EXTRACT"",    ""FALSE"",    ""FILTER"",    ""FIRST"",    ""FLUSH"",    ""FN"",    ""FOLLOWING"",    ""FORMAT"",    ""FULLTEXT"",    ""FUNCTION"",    ""GRANT"",    ""GROUP"",    ""GUARD"",    ""HASH"",    ""HISTORY"",    ""HOPPING"",    ""IGNORE"",    ""INCLUDE"",    ""INCREMENT"",    ""INDEX"",    ""INSERT"",    ""INTERLEAVE"",    ""INTERPRET"",    ""INTERVAL"",    ""INVALIDATE"",    ""ISNULL"",    ""JSON"",    ""KEEP"",    ""KEY"",    ""KEYS"",    ""LAST"",    ""LEADING"",    ""LINK"",    ""LOCAL"",    ""LOCKED"",    ""LOG"",    ""LOOP"",    ""MATCH"",    ""MATCHED"",    ""MATERIALIZED"",    ""MAXVALUE"",    ""MEMBER"",    ""MERGE"",    ""MINVALUE"",    ""MODIFY"",    ""MOVEMENT"",    ""NEXT"",    ""NO"",    ""NOCACHE"",    ""NOKEEP"",    ""NOLOCK"",    ""NOMAXVALUE"",    ""NOMINVALUE"",    ""NOORDER"",    ""NOTHING"",    ""NOTNULL"",    ""NOVALIDATE"",    ""NOWAIT"",    ""NULLS"",    ""OF"",    ""OFF"",    ""ON"",    ""OPEN"",    ""OVER"",    ""OVERLAPS"",    ""PARALLEL"",    ""PARENT"",    ""PARTITION"",    ""PATH"",    ""PERCENT"",    ""PLACING"",    ""PRECEDING"",    ""PRECISION"",    ""PRIMARY"",    ""PRIOR"",    ""PURGE"",    ""QUALIFY"",    ""QUERY"",    ""QUICK"",    ""QUIESCE"",    ""RANGE"",    ""RAW"",    ""READ"",    ""RECURSIVE"",    ""RECYCLEBIN"",    ""REFERENCES"",    ""REFRESH"",    ""REGISTER"",    ""REMOTE"",    ""RENAME"",    ""REPEATABLE"",    ""REPLACE"",    ""RESET"",    ""RESTART"",    ""RESTRICT"",    ""RESTRICTED"",    ""RESUMABLE"",    ""RESUME"",    ""RETURN"",    ""RLIKE"",    ""ROLLBACK"",    ""ROLLUP"",    ""ROOT"",    ""ROW"",    ""ROWS"",    ""RR"",    ""RS"",    ""SAVEPOINT"",    ""SCHEMA"",    ""SECURE"",    ""SEED"",    ""SEPARATOR"",    ""SEQUENCE"",    ""SESSION"",    ""SETS"",    ""SHARE"",    ""SHOW"",    ""SHUTDOWN"",    ""SIBLINGS"",    ""SIGNED"",    ""SIMILAR"",    ""SIZE"",    ""SKIP"",    ""START"",    ""STORED"",    ""STRING"",    ""SUSPEND"",    ""SWITCH"",    ""SYNONYM"",    ""SYSTEM"",    ""TABLE"",    ""TABLES"",    ""TABLESPACE"",    ""TEMP"",    ""TEMPORARY"",    ""THEN"",    ""TIMEOUT"",    ""TIMESTAMPTZ"",    ""TIMEZONE"",    ""TO"",    ""TOP"",    ""TRIGGER"",    ""TRUE"",    ""TRUNCATE"",    ""TUMBLING"",    ""TYPE"",    ""UNLOGGED"",    ""UNQIESCE"",    ""UNSIGNED"",    ""UPDATE"",    ""UPSERT"",    ""UR"",    ""USER"",    ""VALIDATE"",    ""VALUE"",    ""VALUES"",    ""VERBOSE"",    ""VIEW"",    ""VOLATILE"",    ""WAIT"",    ""WITHIN"",    ""WITHOUT"",    ""WORK"",    ""XML"",    ""XMLAGG"",    ""XMLDATA"",    ""XMLSCHEMA"",    ""XMLTEXT"",    ""XSINIL"",    ""YAML"",    ""YES"",    ""ZONE"",    <K_DATETIMELITERAL>,    <K_DATE_LITERAL>,    <K_ISOLATION>,    <K_STRING_FUNCTION_NAME>,    <K_TIME_KEY_EXPR>,    <S_IDENTIFIER>,    <S_QUOTED_IDENTIFIER>,	at java.base/java.util.concurrent.FutureTask.report(Unknown Source),	at java.base/java.util.concurrent.FutureTask.get(Unknown Source),	at net.sf.jsqlparser.parser.CCJSqlParserUtil.parseStatement(CCJSqlParserUtil.java:343),	... 720 more,Caused by: net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: ""final"" ""FINAL"",    at line 83, column 3.,Was expecting one of:,    ""ACTION"",    ""ACTIVE"",    ""ADD"",    ""ADVANCE"",    ""ADVISE"",    ""AGAINST"",    ""ALGORITHM"",    ""ALTER"",    ""ANALYZE"",    ""APPLY"",    ""ARCHIVE"",    ""ARRAY"",    ""ASC"",    ""AT"",    ""AUTHORIZATION"",    ""AUTO"",    ""BEGIN"",    ""BERNOULLI"",    ""BINARY"",    ""BIT"",    ""BLOCK"",    ""BROWSE"",    ""BUFFERS"",    ""BY"",    ""BYTE"",    ""BYTES"",    ""CACHE"",    ""CALL"",    ""CASCADE"",    ""CASE"",    ""CAST"",    ""CHANGE"",    ""CHANGES"",    ""CHAR"",    ""CHARACTER"",    ""CHECKPOINT"",    ""CLOSE"",    ""COLLATE"",    ""COLUMN"",    ""COLUMNS"",    ""COMMENT"",    ""COMMIT"",    ""CONCURRENTLY"",    ""CONFLICT"",    ""CONNECT"",    ""CONSTRAINTS"",    ""CONVERT"",    ""COSTS"",    ""CREATE"",    ""CS"",    ""CYCLE"",    ""DATA"",    ""DATABASE"",    ""DDL"",    ""DECLARE"",    ""DEFAULT"",    ""DEFERRABLE"",    ""DELAYED"",    ""DELETE"",    ""DESC"",    ""DESCRIBE"",    ""DISABLE"",    ""DISCONNECT"",    ""DIV"",    ""DML"",    ""DO"",    ""DOMAIN"",    ""DROP"",    ""DUMP"",    ""DUPLICATE"",    ""ELEMENTS"",    ""EMIT"",    ""ENABLE"",    ""END"",    ""ESCAPE"",    ""EXCLUDE"",    ""EXEC"",    ""EXECUTE"",    ""EXPLAIN"",    ""EXPLICIT"",    ""EXTENDED"",    ""EXTRACT"",    ""FALSE"",    ""FILTER"",    ""FIRST"",    ""FLUSH"",    ""FN"",    ""FOLLOWING"",    ""FORMAT"",    ""FULLTEXT"",    ""FUNCTION"",    ""GRANT"",    ""GROUP"",    ""GUARD"",    ""HASH"",    ""HISTORY"",    ""HOPPING"",    ""IGNORE"",    ""INCLUDE"",    ""INCREMENT"",    ""INDEX"",    ""INSERT"",    ""INTERLEAVE"",    ""INTERPRET"",    ""INTERVAL"",    ""INVALIDATE"",    ""ISNULL"",    ""JSON"",    ""KEEP"",    ""KEY"",    ""KEYS"",    ""LAST"",    ""LEADING"",    ""LINK"",    ""LOCAL"",    ""LOCKED"",    ""LOG"",    ""LOOP"",    ""MATCH"",    ""MATCHED"",    ""MATERIALIZED"",    ""MAXVALUE"",    ""MEMBER"",    ""MERGE"",    ""MINVALUE"",    ""MODIFY"",    ""MOVEMENT"",    ""NEXT"",    ""NO"",    ""NOCACHE"",    ""NOKEEP"",    ""NOLOCK"",    ""NOMAXVALUE"",    ""NOMINVALUE"",    ""NOORDER"",    ""NOTHING"",    ""NOTNULL"",    ""NOVALIDATE"",    ""NOWAIT"",    ""NULLS"",    ""OF"",    ""OFF"",    ""ON"",    ""OPEN"",    ""OVER"",    ""OVERLAPS"",    ""PARALLEL"",    ""PARENT"",    ""PARTITION"",    ""PATH"",    ""PERCENT"",    ""PLACING"",    ""PRECEDING"",    ""PRECISION"",    ""PRIMARY"",    ""PRIOR"",    ""PURGE"",    ""QUALIFY"",    ""QUERY"",    ""QUICK"",    ""QUIESCE"",    ""RANGE"",    ""RAW"",    ""READ"",    ""RECURSIVE"",    ""RECYCLEBIN"",    ""REFERENCES"",    ""REFRESH"",    ""REGISTER"",    ""REMOTE"",    ""RENAME"",    ""REPEATABLE"",    ""REPLACE"",    ""RESET"",    ""RESTART"",    ""RESTRICT"",    ""RESTRICTED"",    ""RESUMABLE"",    ""RESUME"",    ""RETURN"",    ""RLIKE"",    ""ROLLBACK"",    ""ROLLUP"",    ""ROOT"",    ""ROW"",    ""ROWS"",    ""RR"",    ""RS"",    ""SAVEPOINT"",    ""SCHEMA"",    ""SECURE"",    ""SEED"",    ""SEPARATOR"",    ""SEQUENCE"",    ""SESSION"",    ""SETS"",    ""SHARE"",    ""SHOW"",    ""SHUTDOWN"",    ""SIBLINGS"",    ""SIGNED"",    ""SIMILAR"",    ""SIZE"",    ""SKIP"",    ""START"",    ""STORED"",    ""STRING"",    ""SUSPEND"",    ""SWITCH"",    ""SYNONYM"",    ""SYSTEM"",    ""TABLE"",    ""TABLES"",    ""TABLESPACE"",    ""TEMP"",    ""TEMPORARY"",    ""THEN"",    ""TIMEOUT"",    ""TIMESTAMPTZ"",    ""TIMEZONE"",    ""TO"",    ""TOP"",    ""TRIGGER"",    ""TRUE"",    ""TRUNCATE"",    ""TUMBLING"",    ""TYPE"",    ""UNLOGGED"",    ""UNQIESCE"",    ""UNSIGNED"",    ""UPDATE"",    ""UPSERT"",    ""UR"",    ""USER"",    ""VALIDATE"",    ""VALUE"",    ""VALUES"",    ""VERBOSE"",    ""VIEW"",    ""VOLATILE"",    ""WAIT"",    ""WITHIN"",    ""WITHOUT"",    ""WORK"",    ""XML"",    ""XMLAGG"",    ""XMLDATA"",    ""XMLSCHEMA"",    ""XMLTEXT"",    ""XSINIL"",    ""YAML"",    ""YES"",    ""ZONE"",    <K_DATETIMELITERAL>,    <K_DATE_LITERAL>,    <K_ISOLATION>,    <K_STRING_FUNCTION_NAME>,    <K_TIME_KEY_EXPR>,    <S_IDENTIFIER>,    <S_QUOTED_IDENTIFIER>,	at net.sf.jsqlparser.parser.CCJSqlParser.generateParseException(CCJSqlParser.java:39603),	at net.sf.jsqlparser.parser.CCJSqlParser.jj_consume_token(CCJSqlParser.java:39427),	at net.sf.jsqlparser.parser.CCJSqlParser.RelObjectName(CCJSqlParser.java:7062),	at net.sf.jsqlparser.parser.CCJSqlParser.WithItem(CCJSqlParser.java:9412),	at net.sf.jsqlparser.parser.CCJSqlParser.WithList(CCJSqlParser.java:9387),	at net.sf.jsqlparser.parser.CCJSqlParser.SingleStatement(CCJSqlParser.java:369),	at net.sf.jsqlparser.parser.CCJSqlParser.Statement(CCJSqlParser.java:296),	at net.sf.jsqlparser.parser.CCJSqlParserUtil$1.call(CCJSqlParserUtil.java:339),	at net.sf.jsqlparser.parser.CCJSqlParserUtil$1.call(CCJSqlParserUtil.java:336),	... 4 more

```
    


**Expected behavior**
Quicker response time.


**Severity**
This is happening in our prod instance. It's blocking users.



**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.91-99.172.amzn2023.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""13.13""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-10"",
      ""tag"": ""v0.50.0"",
      ""hash"": ""4fe42d3""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```",psneha716,2024-06-11 14:42:46+00:00,[],2024-08-28 02:09:54+00:00,2024-07-02 09:04:12+00:00,https://github.com/metabase/metabase/issues/44006,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2160985448, 'issue_id': 2346618528, 'author': 'paoliniluis', 'body': ""@psneha716 what's the sizing of your ecs tasks?"", 'created_at': datetime.datetime(2024, 6, 11, 14, 59, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2161349465, 'issue_id': 2346618528, 'author': 'psneha716', 'body': 'Hey @paoliniluis,\r\nTask CPU: 3800 units (3.711 vCPU)\r\nTask memory: 3700 MiB (3.613 GB)', 'created_at': datetime.datetime(2024, 6, 11, 18, 15, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2161415725, 'issue_id': 2346618528, 'author': 'paoliniluis', 'body': 'gotcha, can you send us some logs?', 'created_at': datetime.datetime(2024, 6, 11, 18, 56, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2161527903, 'issue_id': 2346618528, 'author': 'psneha716', 'body': ""Sure.\r\n\r\n> Simple filtering in tables is taking more than 30 seconds\r\n\r\nRegarding this, I tried filtering on a column(text) in a db table using both _contains_ and _is_ clause. With _is_, the filtering happens in no time but with _contains_ the question takes too long to load. Following are the relevent logs:\r\n\r\n```\r\n2024-06-11 19:43:12,363 ERROR query-processor.streaming :: Client closed connection prematurely\r\norg.eclipse.jetty.io.EofException\r\n……………\r\n………….\r\nCaused by: java.io.IOException: Broken pipe\r\n2024-06-11 19:43:12,366 DEBUG middleware.log :: \x1b[32mPOST /api/dataset 202 [ASYNC: canceled] 1.1 mins (18 DB calls) App DB connections: 1/15 Jetty threads: 3/50 (15 idle, 0 queued) (155 total active threads) Queries in flight: 0 (0 queued); postgres DB 3 connections: 0/3 (0 threads blocked) {:metabase-user-id 72}\x1b\r\n```\r\n\r\n\r\nMost of the errors I see are related to Broken pipe. Let me know if you'd like me to share any specific pattern of log lines."", 'created_at': datetime.datetime(2024, 6, 11, 20, 10, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162430034, 'issue_id': 2346618528, 'author': 'tsmacdonald', 'body': ""Hi @psneha716 , I suspect that the stack trace with the `JSQLParserException` is a red herring, but to eliminate the possibility it'd be useful to disable SQL parsing for now. (SQL parsing is new in 50; it was soft launched to iron out issues and will be used for user-facing features in upcoming versions of Metabase.)\r\n\r\nYou can disable it by setting the `sql-parsing-enabled` setting to `false`. You can do this by setting the `MB_SQL_PARSING_ENABLED` environment variable; see [here](https://www.metabase.com/docs/latest/configuring-metabase/environment-variables) for documentation."", 'created_at': datetime.datetime(2024, 6, 12, 8, 36, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162516494, 'issue_id': 2346618528, 'author': 'tsmacdonald', 'body': ""@psneha716 this won't help with your performance issue, but if you don't mind sharing your query that uses `FINAL` we'd appreciate it so that we can make the parser better! (Simplifying or anonymizing the query is fine!)"", 'created_at': datetime.datetime(2024, 6, 12, 9, 14, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162539776, 'issue_id': 2346618528, 'author': 'psneha716', 'body': ""Hi @tsmacdonald,\r\nThanks for your response. I'll try out disabling sql parsing and will share the query with parsing issue with you. \r\n\r\nWhat about _contains_ clause query though? Why is it extremely slow, in earlier version it was working fine."", 'created_at': datetime.datetime(2024, 6, 12, 9, 26, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162765804, 'issue_id': 2346618528, 'author': 'paoliniluis', 'body': '@psneha716 send us the full logs from the start of the instance', 'created_at': datetime.datetime(2024, 6, 12, 11, 23, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163094428, 'issue_id': 2346618528, 'author': 'bshepherdson', 'body': ""The change we made to `contains` in 50 was to support multiple arguments.\r\n\r\n`contains` is a much more expensive, non-indexable thing to ask the database for than `is`, but I wouldn't have expected anything to change for a `contains` with a single argument. Please share an example of a query or at least the `contains` SQL clause or GUI filter that's showing degraded performance."", 'created_at': datetime.datetime(2024, 6, 12, 14, 3, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163638768, 'issue_id': 2346618528, 'author': 'psneha716', 'body': 'Hi @bshepherdson,\r\nPlease find the screen recording of the GUI attached.\r\n[Screen Recording 2024-06-12 at 11.34.26\u202fPM.zip](https://github.com/user-attachments/files/15809159/Screen.Recording.2024-06-12.at.11.34.26.PM.zip)', 'created_at': datetime.datetime(2024, 6, 12, 18, 13, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163731775, 'issue_id': 2346618528, 'author': 'psneha716', 'body': ""I'm considering downgrading the version of metabase to v0.49.15. Is it possible to do it?"", 'created_at': datetime.datetime(2024, 6, 12, 19, 14, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163771902, 'issue_id': 2346618528, 'author': 'bshepherdson', 'body': 'Yes, it should be possible to downgrade to the previous major version.', 'created_at': datetime.datetime(2024, 6, 12, 19, 40, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163914687, 'issue_id': 2346618528, 'author': 'psneha716', 'body': 'Hi @bshepherdson,\r\nI\'m not able to downgrade. Please help!\r\n\r\n- Stopped the container running v0.50 metabase instance \r\n- Ran the following\r\n```\r\n$docker run --rm metabase/metabase:v0.50.1 ""migrate down""\r\nWarning: environ value jdk-11.0.23+9 for key :java-version has been overwritten with 11.0.23\r\n2024-06-12 21:08:25,427 INFO metabase.util :: Maximum memory available to JVM: 1.9 GB\r\n2024-06-12 21:08:27,762 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓\r\n For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html\r\n2024-06-12 21:08:28,566 WARN db.env :: WARNING: Using Metabase with an H2 application database is not recommended for production deployments. For production deployments, we highly recommend using Postgres, MySQL, or MariaDB instead. If you decide to continue to use H2, please be sure to back up the database file regularly. For more information, see https://metabase.com/docs/latest/operations-guide/migrating-from-h2.html\r\n2024-06-12 21:08:32,573 INFO driver.impl :: Registered abstract driver :sql  🚚\r\n2024-06-12 21:08:32,579 INFO driver.impl :: Registered abstract driver :sql-jdbc (parents: [:sql]) 🚚\r\n2024-06-12 21:08:32,585 INFO metabase.util :: Load driver :sql-jdbc took 32.7 ms\r\n2024-06-12 21:08:32,586 INFO driver.impl :: Registered driver :h2 (parents: [:sql-jdbc]) 🚚\r\n2024-06-12 21:08:32,717 INFO driver.impl :: Registered driver :mysql (parents: [:sql-jdbc]) 🚚\r\n2024-06-12 21:08:32,744 INFO driver.impl :: Registered driver :postgres (parents: [:sql-jdbc]) 🚚\r\n2024-06-12 21:08:34,401 INFO metabase.core ::\r\nMetabase v0.50.1 (cc4ca82)\r\n\r\nCopyright © 2024 Metabase, Inc.\r\n\r\nMetabase Enterprise Edition extensions are NOT PRESENT.\r\n2024-06-12 21:08:34,657 INFO db.setup :: Setting up Liquibase...\r\n2024-06-12 21:08:35,245 INFO db.liquibase :: Updating liquibase table to reflect consolidated changeset filenames\r\n2024-06-12 21:08:35,254 INFO db.liquibase :: No migration lock found.\r\n2024-06-12 21:08:35,255 INFO db.liquibase :: Migration lock acquired.\r\n2024-06-12 21:08:35,259 INFO db.setup :: Liquibase is ready.\r\n2024-06-12 21:08:35,262 INFO db.liquibase :: No migration lock found.\r\n2024-06-12 21:08:35,263 INFO db.liquibase :: Migration lock acquired.\r\n2024-06-12 21:08:35,264 INFO db.liquibase :: Rolling back app database schema to version 49\r\n```\r\n\r\n- Tried spinning up a container using v0.49.15, but getting the following error:\r\n```\r\n\r\n2024-06-12 21:10:56,380 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\n--\r\n2024-06-12 21:10:56,382 INFO db.setup :: \x1b[36mVerifying postgres Database Connection ...\x1b[0m\r\n2024-06-12 21:10:56,724 INFO db.setup :: Successfully verified PostgreSQL 13.13 application database connection. ✅\r\n2024-06-12 21:10:56,725 INFO db.setup :: \x1b[36mChecking if a database downgrade is required...\x1b[0m\r\n2024-06-12 21:10:56,834 ERROR middleware.log :: \x1b[31mGET /api/health 503 287.2 µs (0 DB calls)\r\n{:status ""initializing"", :progress 0.3}\r\n\x1b[0m\r\n2024-06-12 21:10:56,844 ERROR middleware.log :: \x1b[31mGET /api/health 503 182.0 µs (0 DB calls)\r\n{:status ""initializing"", :progress 0.3}\r\n\x1b[0m\r\n2024-06-12 21:10:57,344 ERROR metabase.core :: Metabase Initialization FAILED\r\nclojure.lang.ExceptionInfo: \x1b[31mERROR: Downgrade detected.\x1b[0m\r\nYour metabase instance appears to have been downgraded without a corresponding database downgrade.\r\nYou must run `java -jar metabase.jar migrate down` from version 50.\r\nOnce your database has been downgraded, try running the application again.\r\n\r\n\r\n```', 'created_at': datetime.datetime(2024, 6, 12, 21, 15, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163919441, 'issue_id': 2346618528, 'author': 'bshepherdson', 'body': ""That looks like the correct flow to me, but I'm not so familiar with the operational side.\r\n\r\n@paoliniluis or others in Success to assist here."", 'created_at': datetime.datetime(2024, 6, 12, 21, 18, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163955063, 'issue_id': 2346618528, 'author': 'paoliniluis', 'body': '@psneha716 please move to 50.1 instead of downgrading', 'created_at': datetime.datetime(2024, 6, 12, 21, 45, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163959620, 'issue_id': 2346618528, 'author': 'psneha716', 'body': '@paoliniluis. I already did, but the _contains_ clause issue still persists.', 'created_at': datetime.datetime(2024, 6, 12, 21, 49, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163993699, 'issue_id': 2346618528, 'author': 'paoliniluis', 'body': ""Send a screenshot of how you're doing the contains query and also how it worked in previous versions"", 'created_at': datetime.datetime(2024, 6, 12, 22, 19, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2164665879, 'issue_id': 2346618528, 'author': 'psneha716', 'body': ""@paoliniluis I've already shared the GUI recording [here](https://github.com/metabase/metabase/issues/44006#issuecomment-2163638768). Please check."", 'created_at': datetime.datetime(2024, 6, 13, 6, 48, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2167577934, 'issue_id': 2346618528, 'author': 'psneha716', 'body': 'Hi team,\r\nAny ETA on fixing the contains clause filtering issue?', 'created_at': datetime.datetime(2024, 6, 14, 8, 59, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168025715, 'issue_id': 2346618528, 'author': 'wadjeroudi', 'body': ""same issue for us on ecs, everything runs much more slower (on 0.50.3), going to update on 0.50.4 but don't see a fix related to that issue."", 'created_at': datetime.datetime(2024, 6, 14, 13, 17, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2173981186, 'issue_id': 2346618528, 'author': 'paoliniluis', 'body': 'Another one:\r\n```\r\nJun 17 14:27:50.616i-014f121faf49c8c12dns-poc-metabasenet.sf.jsqlparser.JSQLParserException: net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: ""||"" <OP_CONCAT>\r\n```', 'created_at': datetime.datetime(2024, 6, 17, 17, 44, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2173992734, 'issue_id': 2346618528, 'author': 'paoliniluis', 'body': ""There are many things here that I don't understand:\r\n1) @psneha716 you're expecting that your DW will return the results in the same time when doing a `x = y` and x LIKE `%y%` operation? that's not Metabase fault but rather your DW doing probably a full table scan for that. Can you please tell us what are you expecting exactly so we can help you here?\r\n2) query parsing: I'm going to change the issue name for reflecting that\r\n3) @wadjeroudi what are you seeing?"", 'created_at': datetime.datetime(2024, 6, 17, 17, 51, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2174340209, 'issue_id': 2346618528, 'author': 'bshepherdson', 'body': 'I checked the SQL generated for single- and multi-argument `contains`, starting with `Products`.\r\n\r\n`Vendor contains ""son""`:\r\n```sql\r\nWHERE LOWER(""PUBLIC"".""PRODUCTS"".""VENDOR"") LIKE \'%son%\' LIMIT 2000\r\n```\r\n\r\n`Vendor contains ""son"", ""hal""`:\r\n```sql\r\nWHERE (LOWER(""PUBLIC"".""PRODUCTS"".""VENDOR"") LIKE \'%son%\')\r\nOR    (LOWER(""PUBLIC"".""PRODUCTS"".""VENDOR"") LIKE \'%hal%\')\r\nLIMIT 2000\r\n```\r\n\r\nwhich both match what I expected to see.', 'created_at': datetime.datetime(2024, 6, 17, 20, 12, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2178241850, 'issue_id': 2346618528, 'author': 'psneha716', 'body': 'Hey @paoliniluis,\r\nSorry, for the confusion. There seems to be no issues with the contains clause as such on metabase. Tried running the same query on our db and it takes around the same time.\r\n\r\nTurns out in our previous metabase verison the default filter clause was _is_ and now all the default filters have been changed to _contains_  clause for the columns in the table. And hence the increase in query time with contains:\r\n\r\n<img width=""489"" alt=""image"" src=""https://github.com/metabase/metabase/assets/152379423/a695edb5-2369-4d56-964c-a95bed12ee2e"">\r\n\r\nBut, when I double click on a value in a column, the filter clause used is _is_ :\r\n\r\n<img width=""373"" alt=""image"" src=""https://github.com/metabase/metabase/assets/152379423/ddd49054-abc3-4a52-8510-2a95acb5d2d9"">\r\n\r\n\r\nIs there any way for me to change the defaults back to _is_  clause?', 'created_at': datetime.datetime(2024, 6, 19, 9, 47, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2178255306, 'issue_id': 2346618528, 'author': 'psneha716', 'body': 'Also metabase has been crashing with frequent OOM errors. \r\n\r\n```\r\nfatal error: OutOfMemory encountered: Java heap space\r\n```', 'created_at': datetime.datetime(2024, 6, 19, 9, 52, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2178573379, 'issue_id': 2346618528, 'author': 'darksciencebase', 'body': ""@psneha716 we're investigating OOMs in this issue: https://github.com/metabase/metabase/issues/44359\r\nplease comment there if you have any observations/logs/etc for narrowing down the cause"", 'created_at': datetime.datetime(2024, 6, 19, 12, 24, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179332516, 'issue_id': 2346618528, 'author': 'psneha716', 'body': '@darksciencebase Any solution for the filter issue?', 'created_at': datetime.datetime(2024, 6, 19, 19, 7, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2188765490, 'issue_id': 2346618528, 'author': 'psneha716', 'body': ""Hi guys,\r\nWe are seeing very frequent CPU and memory spikes which brings down the whole application. This is affecting our end users and needs to be resolved asap. Could someone please assist me in downgrading metabase to v49? I tried downgrading but it isn't working - [logs](https://github.com/metabase/metabase/issues/44006#issuecomment-2163914687). Any help would be greatly appreciated!"", 'created_at': datetime.datetime(2024, 6, 25, 12, 7, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2188810928, 'issue_id': 2346618528, 'author': 'perivamsi', 'body': ""@psneha716 email me at vamsi@metabase.com\r\n\r\nI'll help you"", 'created_at': datetime.datetime(2024, 6, 25, 12, 31, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2202402240, 'issue_id': 2346618528, 'author': 'perivamsi', 'body': '@psneha716 we are closing this issue. If you are facing specific bugs, please raise new issue.', 'created_at': datetime.datetime(2024, 7, 2, 9, 4, 10, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-11 14:59:24 UTC): @psneha716 what's the sizing of your ecs tasks?

psneha716 (Issue Creator) on (2024-06-11 18:15:07 UTC): Hey @paoliniluis,
Task CPU: 3800 units (3.711 vCPU)
Task memory: 3700 MiB (3.613 GB)

paoliniluis on (2024-06-11 18:56:23 UTC): gotcha, can you send us some logs?

psneha716 (Issue Creator) on (2024-06-11 20:10:07 UTC): Sure.


Regarding this, I tried filtering on a column(text) in a db table using both _contains_ and _is_ clause. With _is_, the filtering happens in no time but with _contains_ the question takes too long to load. Following are the relevent logs:

```
2024-06-11 19:43:12,363 ERROR query-processor.streaming :: Client closed connection prematurely
org.eclipse.jetty.io.EofException
……………
………….
Caused by: java.io.IOException: Broken pipe
2024-06-11 19:43:12,366 DEBUG middleware.log :: [32mPOST /api/dataset 202 [ASYNC: canceled] 1.1 mins (18 DB calls) App DB connections: 1/15 Jetty threads: 3/50 (15 idle, 0 queued) (155 total active threads) Queries in flight: 0 (0 queued); postgres DB 3 connections: 0/3 (0 threads blocked) {:metabase-user-id 72}
```


Most of the errors I see are related to Broken pipe. Let me know if you'd like me to share any specific pattern of log lines.

tsmacdonald on (2024-06-12 08:36:19 UTC): Hi @psneha716 , I suspect that the stack trace with the `JSQLParserException` is a red herring, but to eliminate the possibility it'd be useful to disable SQL parsing for now. (SQL parsing is new in 50; it was soft launched to iron out issues and will be used for user-facing features in upcoming versions of Metabase.)

You can disable it by setting the `sql-parsing-enabled` setting to `false`. You can do this by setting the `MB_SQL_PARSING_ENABLED` environment variable; see [here](https://www.metabase.com/docs/latest/configuring-metabase/environment-variables) for documentation.

tsmacdonald on (2024-06-12 09:14:38 UTC): @psneha716 this won't help with your performance issue, but if you don't mind sharing your query that uses `FINAL` we'd appreciate it so that we can make the parser better! (Simplifying or anonymizing the query is fine!)

psneha716 (Issue Creator) on (2024-06-12 09:26:49 UTC): Hi @tsmacdonald,
Thanks for your response. I'll try out disabling sql parsing and will share the query with parsing issue with you. 

What about _contains_ clause query though? Why is it extremely slow, in earlier version it was working fine.

paoliniluis on (2024-06-12 11:23:48 UTC): @psneha716 send us the full logs from the start of the instance

bshepherdson on (2024-06-12 14:03:28 UTC): The change we made to `contains` in 50 was to support multiple arguments.

`contains` is a much more expensive, non-indexable thing to ask the database for than `is`, but I wouldn't have expected anything to change for a `contains` with a single argument. Please share an example of a query or at least the `contains` SQL clause or GUI filter that's showing degraded performance.

psneha716 (Issue Creator) on (2024-06-12 18:13:06 UTC): Hi @bshepherdson,
Please find the screen recording of the GUI attached.
[Screen Recording 2024-06-12 at 11.34.26 PM.zip](https://github.com/user-attachments/files/15809159/Screen.Recording.2024-06-12.at.11.34.26.PM.zip)

psneha716 (Issue Creator) on (2024-06-12 19:14:06 UTC): I'm considering downgrading the version of metabase to v0.49.15. Is it possible to do it?

bshepherdson on (2024-06-12 19:40:49 UTC): Yes, it should be possible to downgrade to the previous major version.

psneha716 (Issue Creator) on (2024-06-12 21:15:13 UTC): Hi @bshepherdson,
I'm not able to downgrade. Please help!

- Stopped the container running v0.50 metabase instance 
- Ran the following
```
$docker run --rm metabase/metabase:v0.50.1 ""migrate down""
Warning: environ value jdk-11.0.23+9 for key :java-version has been overwritten with 11.0.23
2024-06-12 21:08:25,427 INFO metabase.util :: Maximum memory available to JVM: 1.9 GB
2024-06-12 21:08:27,762 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓
 For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html
2024-06-12 21:08:28,566 WARN db.env :: WARNING: Using Metabase with an H2 application database is not recommended for production deployments. For production deployments, we highly recommend using Postgres, MySQL, or MariaDB instead. If you decide to continue to use H2, please be sure to back up the database file regularly. For more information, see https://metabase.com/docs/latest/operations-guide/migrating-from-h2.html
2024-06-12 21:08:32,573 INFO driver.impl :: Registered abstract driver :sql  🚚
2024-06-12 21:08:32,579 INFO driver.impl :: Registered abstract driver :sql-jdbc (parents: [:sql]) 🚚
2024-06-12 21:08:32,585 INFO metabase.util :: Load driver :sql-jdbc took 32.7 ms
2024-06-12 21:08:32,586 INFO driver.impl :: Registered driver :h2 (parents: [:sql-jdbc]) 🚚
2024-06-12 21:08:32,717 INFO driver.impl :: Registered driver :mysql (parents: [:sql-jdbc]) 🚚
2024-06-12 21:08:32,744 INFO driver.impl :: Registered driver :postgres (parents: [:sql-jdbc]) 🚚
2024-06-12 21:08:34,401 INFO metabase.core ::
Metabase v0.50.1 (cc4ca82)

Copyright © 2024 Metabase, Inc.

Metabase Enterprise Edition extensions are NOT PRESENT.
2024-06-12 21:08:34,657 INFO db.setup :: Setting up Liquibase...
2024-06-12 21:08:35,245 INFO db.liquibase :: Updating liquibase table to reflect consolidated changeset filenames
2024-06-12 21:08:35,254 INFO db.liquibase :: No migration lock found.
2024-06-12 21:08:35,255 INFO db.liquibase :: Migration lock acquired.
2024-06-12 21:08:35,259 INFO db.setup :: Liquibase is ready.
2024-06-12 21:08:35,262 INFO db.liquibase :: No migration lock found.
2024-06-12 21:08:35,263 INFO db.liquibase :: Migration lock acquired.
2024-06-12 21:08:35,264 INFO db.liquibase :: Rolling back app database schema to version 49
```

- Tried spinning up a container using v0.49.15, but getting the following error:
```

2024-06-12 21:10:56,380 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
--
2024-06-12 21:10:56,382 INFO db.setup :: [36mVerifying postgres Database Connection ...[0m
2024-06-12 21:10:56,724 INFO db.setup :: Successfully verified PostgreSQL 13.13 application database connection. ✅
2024-06-12 21:10:56,725 INFO db.setup :: [36mChecking if a database downgrade is required...[0m
2024-06-12 21:10:56,834 ERROR middleware.log :: [31mGET /api/health 503 287.2 µs (0 DB calls)
{:status ""initializing"", :progress 0.3}
[0m
2024-06-12 21:10:56,844 ERROR middleware.log :: [31mGET /api/health 503 182.0 µs (0 DB calls)
{:status ""initializing"", :progress 0.3}
[0m
2024-06-12 21:10:57,344 ERROR metabase.core :: Metabase Initialization FAILED
clojure.lang.ExceptionInfo: [31mERROR: Downgrade detected.[0m
Your metabase instance appears to have been downgraded without a corresponding database downgrade.
You must run `java -jar metabase.jar migrate down` from version 50.
Once your database has been downgraded, try running the application again.


```

bshepherdson on (2024-06-12 21:18:46 UTC): That looks like the correct flow to me, but I'm not so familiar with the operational side.

@paoliniluis or others in Success to assist here.

paoliniluis on (2024-06-12 21:45:16 UTC): @psneha716 please move to 50.1 instead of downgrading

psneha716 (Issue Creator) on (2024-06-12 21:49:10 UTC): @paoliniluis. I already did, but the _contains_ clause issue still persists.

paoliniluis on (2024-06-12 22:19:08 UTC): Send a screenshot of how you're doing the contains query and also how it worked in previous versions

psneha716 (Issue Creator) on (2024-06-13 06:48:09 UTC): @paoliniluis I've already shared the GUI recording [here](https://github.com/metabase/metabase/issues/44006#issuecomment-2163638768). Please check.

psneha716 (Issue Creator) on (2024-06-14 08:59:27 UTC): Hi team,
Any ETA on fixing the contains clause filtering issue?

wadjeroudi on (2024-06-14 13:17:37 UTC): same issue for us on ecs, everything runs much more slower (on 0.50.3), going to update on 0.50.4 but don't see a fix related to that issue.

paoliniluis on (2024-06-17 17:44:44 UTC): Another one:
```
Jun 17 14:27:50.616i-014f121faf49c8c12dns-poc-metabasenet.sf.jsqlparser.JSQLParserException: net.sf.jsqlparser.parser.ParseException: Encountered unexpected token: ""||"" <OP_CONCAT>
```

paoliniluis on (2024-06-17 17:51:37 UTC): There are many things here that I don't understand:
1) @psneha716 you're expecting that your DW will return the results in the same time when doing a `x = y` and x LIKE `%y%` operation? that's not Metabase fault but rather your DW doing probably a full table scan for that. Can you please tell us what are you expecting exactly so we can help you here?
2) query parsing: I'm going to change the issue name for reflecting that
3) @wadjeroudi what are you seeing?

bshepherdson on (2024-06-17 20:12:35 UTC): I checked the SQL generated for single- and multi-argument `contains`, starting with `Products`.

`Vendor contains ""son""`:
```sql
WHERE LOWER(""PUBLIC"".""PRODUCTS"".""VENDOR"") LIKE '%son%' LIMIT 2000
```

`Vendor contains ""son"", ""hal""`:
```sql
WHERE (LOWER(""PUBLIC"".""PRODUCTS"".""VENDOR"") LIKE '%son%')
OR    (LOWER(""PUBLIC"".""PRODUCTS"".""VENDOR"") LIKE '%hal%')
LIMIT 2000
```

which both match what I expected to see.

psneha716 (Issue Creator) on (2024-06-19 09:47:31 UTC): Hey @paoliniluis,
Sorry, for the confusion. There seems to be no issues with the contains clause as such on metabase. Tried running the same query on our db and it takes around the same time.

Turns out in our previous metabase verison the default filter clause was _is_ and now all the default filters have been changed to _contains_  clause for the columns in the table. And hence the increase in query time with contains:

<img width=""489"" alt=""image"" src=""https://github.com/metabase/metabase/assets/152379423/a695edb5-2369-4d56-964c-a95bed12ee2e"">

But, when I double click on a value in a column, the filter clause used is _is_ :

<img width=""373"" alt=""image"" src=""https://github.com/metabase/metabase/assets/152379423/ddd49054-abc3-4a52-8510-2a95acb5d2d9"">


Is there any way for me to change the defaults back to _is_  clause?

psneha716 (Issue Creator) on (2024-06-19 09:52:23 UTC): Also metabase has been crashing with frequent OOM errors. 

```
fatal error: OutOfMemory encountered: Java heap space
```

darksciencebase on (2024-06-19 12:24:08 UTC): @psneha716 we're investigating OOMs in this issue: https://github.com/metabase/metabase/issues/44359
please comment there if you have any observations/logs/etc for narrowing down the cause

psneha716 (Issue Creator) on (2024-06-19 19:07:58 UTC): @darksciencebase Any solution for the filter issue?

psneha716 (Issue Creator) on (2024-06-25 12:07:34 UTC): Hi guys,
We are seeing very frequent CPU and memory spikes which brings down the whole application. This is affecting our end users and needs to be resolved asap. Could someone please assist me in downgrading metabase to v49? I tried downgrading but it isn't working - [logs](https://github.com/metabase/metabase/issues/44006#issuecomment-2163914687). Any help would be greatly appreciated!

perivamsi on (2024-06-25 12:31:40 UTC): @psneha716 email me at vamsi@metabase.com

I'll help you

perivamsi on (2024-07-02 09:04:10 UTC): @psneha716 we are closing this issue. If you are facing specific bugs, please raise new issue.

"
2346522116,issue,open,,"Add or remove columns in the viz settings will fire the query on each click, which is expensive on big tables","### Describe the bug

A customer reported that the select boxes over the columns in the viz settings of a question in a table view get slow when the tables have lots of columns. We shouldn't fire the queries on every click but rather just when the user has done all changes

### To Reproduce

1) load https://drive.google.com/file/d/1GstMkB0cyiK0QddZOhjuNfXeXfVrssQr/view?usp=drive_link into a postgres
2) start metabase and add the postgres db that loaded the file above
3) then go to a single table, click viz settings, click on ""add or remove columns"" and then click on any checkbox repeteadly
4) see that the ui lags and also that we're firing repeatedly the query to the DW

### Expected behavior

We should have an apply button

### Logs

NA

### Information about your Metabase installation

```JSON
since v49 I believe
```


### Severity

P2

### Additional context

_No response_",paoliniluis,2024-06-11 14:00:56+00:00,[],2025-02-04 20:31:27+00:00,,https://github.com/metabase/metabase/issues/44003,"[('.Performance', ''), ('Type:New Feature', ''), ('Visualization/Chart Settings', ''), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]","[{'comment_id': 2209040829, 'issue_id': 2346522116, 'author': 'kamilmielnik', 'body': 'Reproducible in `master` at 638d79c457.', 'created_at': datetime.datetime(2024, 7, 4, 13, 45, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2625378770, 'issue_id': 2346522116, 'author': 'ranquild', 'body': ""We respect a DB-wide setting to auto-run queries. if it's disabled, queries won't auto-run. If they need to change fields in bulk, they can do it via the notebook editor."", 'created_at': datetime.datetime(2025, 1, 30, 19, 22, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2627002804, 'issue_id': 2346522116, 'author': 'mngr', 'body': ""I have a project to [improve the UI of adding and removing columns](https://www.notion.so/metabase/Simplify-adding-and-removing-columns-8eccec6f1e2e4130ae3b07ecb13d496d), so we'll consider this input there"", 'created_at': datetime.datetime(2025, 1, 31, 11, 39, 24, tzinfo=datetime.timezone.utc)}]","kamilmielnik on (2024-07-04 13:45:06 UTC): Reproducible in `master` at 638d79c457.

ranquild on (2025-01-30 19:22:51 UTC): We respect a DB-wide setting to auto-run queries. if it's disabled, queries won't auto-run. If they need to change fields in bulk, they can do it via the notebook editor.

mngr on (2025-01-31 11:39:24 UTC): I have a project to [improve the UI of adding and removing columns](https://www.notion.so/metabase/Simplify-adding-and-removing-columns-8eccec6f1e2e4130ae3b07ecb13d496d), so we'll consider this input there

"
2346349151,issue,open,,Can't append data to model,"### Describe the bug

Hello!
I'm trying to update data in a model by adding a csv file to the model. But Metabase does not show me the desired model in the drop-down list. So? i can't append data to a model. What to do?

### To Reproduce

1. Go to 'Useful data'
2. pulling csv file, 
the inscription appears 'drop here to upload'
3. a window appears 'Select upload destination'
4. I'm trying to find my model in the list, but there is only 1 model out of 9


### Expected behavior

see in the drop-down list the desired model in which you need to specify data

### Logs

_No response_

### Information about your Metabase installation

```JSON
browser Chrome 125.0.6422.142 
Operation system Windows 11 Pro
Database PostgresSQL
Metabase version v0.49.1
```


### Severity

this problem blocking my usage of Metabase

### Additional context

_No response_",Shevchenko-Juls,2024-06-11 12:49:08+00:00,[],2024-06-11 13:00:16+00:00,,https://github.com/metabase/metabase/issues/44001,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Backend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Organization/Uploads', 'Direct data upload (CSV)')]",[],
2346215016,issue,closed,completed,0.50.0 line graph with multiple series all jumbled up,"### Describe the bug

Upgraded metabase to 0.50.0.

1. Under line area goes in a diagonal line from the X and Y origin to the first data point.

![image](https://github.com/metabase/metabase/assets/165997959/571d3446-0c28-4a5f-800a-bf3fc4640dbb)


### To Reproduce

1. Have a table with multiple series
2. Plot series as line charts
3. Enable area under (some of the) line series
4. Set line shape to stepped (<- important)


### Expected behavior

- The area under the line should climb vertically to meet the first datapoint

### Logs

_No response_

### Information about your Metabase installation

```JSON
- all browsers I could lay my hands on
- windows 11
- Postgres
- metabase 0.50.0
- jar file on debian
- Postgres
```


### Severity

blocking an upgrade

### Additional context

_No response_",VD-arjenh,2024-06-11 11:48:19+00:00,['alxnddr'],2024-06-13 14:26:11+00:00,2024-06-13 14:08:24+00:00,https://github.com/metabase/metabase/issues/43998,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2161413088, 'issue_id': 2346215016, 'author': 'alxnddr', 'body': 'Related to https://github.com/apache/echarts/issues/20021', 'created_at': datetime.datetime(2024, 6, 11, 18, 54, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2164145172, 'issue_id': 2346215016, 'author': 'alxnddr', 'body': '@VD-arjenh thanks for the report! I separated z-indices problem to another issue https://github.com/metabase/metabase/issues/44110', 'created_at': datetime.datetime(2024, 6, 13, 0, 40, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2164548886, 'issue_id': 2346215016, 'author': 'VD-arjenh', 'body': '@alxnddr and thank you for the very quick solution already for the invalid areas!', 'created_at': datetime.datetime(2024, 6, 13, 6, 14, 29, tzinfo=datetime.timezone.utc)}]","alxnddr (Assginee) on (2024-06-11 18:54:43 UTC): Related to https://github.com/apache/echarts/issues/20021

alxnddr (Assginee) on (2024-06-13 00:40:05 UTC): @VD-arjenh thanks for the report! I separated z-indices problem to another issue https://github.com/metabase/metabase/issues/44110

VD-arjenh (Issue Creator) on (2024-06-13 06:14:29 UTC): @alxnddr and thank you for the very quick solution already for the invalid areas!

"
2345917554,issue,closed,completed,Enter submits Entity Picker modal and Create dashboard modal simultaneously,"### Describe the bug


https://github.com/metabase/metabase/assets/6830683/f31c7c0f-51fb-4ee9-bcc9-c95b180b013e



### To Reproduce

1. Be on some dashboard
2. New > Question > Orders > Save > Save > Yes please!
3. Open ""Dashboards"" tab
4. Click ""Create a new dashboard""
5. Type ""Totally new dashboard"" and hit Enter in the ""Create a new dashboard"" modal

Question is added to dashboard from step 1

### Expected behavior

Dashboard is created and selected in the Entity Picker modal, but Entity Picker modal is still shown and not submitted.

### Information about your Metabase installation

master, 4594299

### Severity

P2
",kamilmielnik,2024-06-11 09:37:18+00:00,['npfitz'],2024-07-31 19:03:57+00:00,2024-07-31 19:03:36+00:00,https://github.com/metabase/metabase/issues/43994,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Already Fixed', 'will apear in ""Already Fixed"" in the release notes (not ""Bug Fixes"" that we actively fixed)'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2261210554, 'issue_id': 2345917554, 'author': 'npfitz', 'body': 'Closing this as a duplicate of https://github.com/metabase/metabase/issues/45360, which was resolved with https://github.com/metabase/metabase/pull/45989', 'created_at': datetime.datetime(2024, 7, 31, 19, 3, 36, tzinfo=datetime.timezone.utc)}]","npfitz (Assginee) on (2024-07-31 19:03:36 UTC): Closing this as a duplicate of https://github.com/metabase/metabase/issues/45360, which was resolved with https://github.com/metabase/metabase/pull/45989

"
2345872642,issue,closed,completed,"SQL ""Unknown column"" errors on 0.50.0 with breakouts on nested models","### Describe the bug

After updating to V0.50.0 the errors comes, some of fields turns to unkonw

### To Reproduce

After updating to V0.50.0 

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Any information?
```


### Severity

 blocking usage of Metabase entirely

### Additional context

_No response_",Jianbin719,2024-06-11 09:21:22+00:00,['bshepherdson'],2024-08-28 02:09:54+00:00,2024-06-19 17:24:01+00:00,https://github.com/metabase/metabase/issues/43993,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/Processor', ''), ('Querying/MBQL', ''), ('Querying/Nested Queries', 'Questions based on other saved questions'), ('.Backend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('Querying/Models', 'aka Datasets'), ('.Team/Querying', '')]","[{'comment_id': 2160425917, 'issue_id': 2345872642, 'author': 'paoliniluis', 'body': 'Screenshot?', 'created_at': datetime.datetime(2024, 6, 11, 10, 42, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2160588536, 'issue_id': 2345872642, 'author': 'ranquild', 'body': '@Jianbin719 could you provide some additional information? You get this issue in dashboards with parameters, right? Does it happen with saved questions or models? Anything special about them?', 'created_at': datetime.datetime(2024, 6, 11, 12, 3, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2160806299, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': 'I have one model X which consists of two table A and B. Then I created one more question Y to filter model X. \r\n\r\nThe error exists in Pivot Table display, when trying to Summarize by field in Table B.  But with regular Table display is fine .\r\n\r\nI do not have any problem in [v0.49.15]. the problem with version 0.50.0 only.', 'created_at': datetime.datetime(2024, 6, 11, 13, 44, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2160810423, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': '![image](https://github.com/metabase/metabase/assets/75652286/f7870e29-2c64-424c-82e2-7ee8690f3505)', 'created_at': datetime.datetime(2024, 6, 11, 13, 46, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2160937217, 'issue_id': 2345872642, 'author': 'paoliniluis', 'body': ""@Jianbin719 I don't see where the field turns to unknown"", 'created_at': datetime.datetime(2024, 6, 11, 14, 39, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2161149752, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': '> ![image](https://github.com/metabase/metabase/assets/75652286/f7870e29-2c64-424c-82e2-7ee8690f3505)\n> \n\n@paoliniluis The company field turns into unknown. \n\nWhere I can show you the log or detailed information\n\n![Screenshot_20240612_001555.jpg](https://github.com/metabase/metabase/assets/75652286/87f0c1fd-d4f3-4bb5-8ae5-e76f83fe1336)', 'created_at': datetime.datetime(2024, 6, 11, 16, 17, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2161161315, 'issue_id': 2345872642, 'author': 'paoliniluis', 'body': ""ok, please open the browser console and send us what you see. It's a FE error that crashes the query builder"", 'created_at': datetime.datetime(2024, 6, 11, 16, 23, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162036137, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': 'Password fields present on an insecure (http://) page. This is a security risk that allows user login credentials to be stolen.\r\n[login](http://192.168.11.18/auth/login?redirect=%2Fquestion%2F117%2Fnotebook)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database],\\n    :schema #object[Object [object Object]],\\n    :value nil,\\n    :type :malli.core/missing-key}\\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\\n    :in [:stages 0], \\n    :schema #object[Object [object Object]], \\n    :value {:lib/type :mbql.stage/mbql}})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database],\\n    :schema #object[Object [object Object]],\\n    :value nil,\\n    :type :malli.core/missing-key}\\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\\n    :in [:stages 0], \\n    :schema #object[Object [object Object]], \\n    :value {:lib/type :mbql.stage/mbql}})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database], \\n    :schema #object[Object [object Object]], \\n    :value nil, \\n    :type :malli.core/missing-key})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value\\n {:lib/type :mbql/query,\\n  :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}],\\n  :lib/metadata #object[p [object Object]]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value\\n  {:lib/type :mbql/query,\\n   :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}],\\n   :lib/metadata #object[p [object Object]]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database], \\n    :schema #object[Object [object Object]], \\n    :value nil, \\n    :type :malli.core/missing-key})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database],\\n    :schema #object[Object [object Object]],\\n    :value nil,\\n    :type :malli.core/missing-key}\\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\\n    :in [:stages 0], \\n    :schema #object[Object [object Object]], \\n    :value {:lib/type :mbql.stage/mbql}})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database],\\n    :schema #object[Object [object Object]],\\n    :value nil,\\n    :type :malli.core/missing-key}\\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\\n    :in [:stages 0], \\n    :schema #object[Object [object Object]], \\n    :value {:lib/type :mbql.stage/mbql}})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database], \\n    :schema #object[Object [object Object]], \\n    :value nil, \\n    :type :malli.core/missing-key})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value\\n {:lib/type :mbql/query,\\n  :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}],\\n  :lib/metadata #object[p [object Object]]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value\\n  {:lib/type :mbql/query,\\n   :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}],\\n   :lib/metadata #object[p [object Object]]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database], \\n    :schema #object[Object [object Object]], \\n    :value nil, \\n    :type :malli.core/missing-key})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database],\\n    :schema #object[Object [object Object]],\\n    :value nil,\\n    :type :malli.core/missing-key}\\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\\n    :in [:stages 0], \\n    :schema #object[Object [object Object]], \\n    :value {:lib/type :mbql.stage/mbql}})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database],\\n    :schema #object[Object [object Object]],\\n    :value nil,\\n    :type :malli.core/missing-key}\\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\\n    :in [:stages 0], \\n    :schema #object[Object [object Object]], \\n    :value {:lib/type :mbql.stage/mbql}})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database], \\n    :schema #object[Object [object Object]], \\n    :value nil, \\n    :type :malli.core/missing-key})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\n[metabase.lib.normalize] ""Error normalizing pMBQL:\\n{:value\\n {:lib/type :mbql/query,\\n  :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}],\\n  :lib/metadata #object[p [object Object]]},\\n :schema #object[Object [object Object]],\\n :explain\\n {:schema #object[Object [object Object]],\\n  :value\\n  {:lib/type :mbql/query,\\n   :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \\""\\""}],\\n   :lib/metadata #object[p [object Object]]},\\n  :errors\\n  ({:path [0 0 :database],\\n    :in [:database], \\n    :schema #object[Object [object Object]], \\n    :value nil, \\n    :type :malli.core/missing-key})}}\\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)\r\nContent-Security-Policy: The page’s settings blocked an inline style (style-src-elem) from being applied because it violates the following directive: “style-src \'self\' \'nonce-hkGpf76bw8\' https://accounts.google.com/” [emotion-sheet.browser.esm.js:74:22](webpack:///node_modules/@emotion/sheet/dist/emotion-sheet.browser.esm.js)\r\nError getting setting pivot_table.column_split TypeError: e is undefined\r\n    t settings.ts:122\r\n    t settings.ts:122\r\n    eG Underscore\r\n    getValue settings.ts:121\r\n    e settings.js:86\r\n    e settings.js:69\r\n    ee settings.js:42\r\n    f visualization.js:97\r\n    eV selectors.js:737\r\n    Redux 10\r\n    et9 QueryBuilder.jsx:118\r\n    Redux 7\r\n    aJ React\r\n    Redux 5\r\n    aJ React\r\n    Redux 5\r\n    aJ React\r\n    Redux 5\r\n    aJ React\r\n    Redux 5\r\n    aJ React\r\n    Redux 5\r\n    aJ React\r\n    Redux 5\r\n    aJ React\r\n    Redux 5\r\n    aJ React\r\n    Redux 9\r\n    em querying.js:211\r\n    Redux 2\r\n    eo querying.js:139\r\n[settings.js:109:12](webpack:///visualizations/lib/settings.js)\r\nError getting setting pivot_table.column_split TypeError: e is undefined\r\n    t settings.ts:122\r\n    t settings.ts:122\r\n    eG Underscore\r\n    getValue settings.ts:121\r\n    e settings.js:86\r\n    e settings.js:69\r\n    ee settings.js:42\r\n    f visualization.js:97\r\n    eV selectors.js:737\r\n    Redux 10\r\n    et9 QueryBuilder.jsx:118\r\n    Redux 4\r\n    u use-sync-external-store-shim.production.min.js:10\r\n    c Redux\r\n    React 9\r\n    unstable_runWithPriority scheduler.production.min.js:18\r\n    React 4\r\n    Redux 10\r\n[settings.js:109:12](webpack:///visualizations/lib/settings.js)\r\nError getting setting pivot_table.column_split TypeError: e is undefined\r\n    t settings.ts:122\r\n    t settings.ts:122\r\n    eG Underscore\r\n    getValue settings.ts:121\r\n    e settings.js:86\r\n    e settings.js:69\r\n    ee settings.js:42\r\n    f visualization.js:97\r\n    g visualization.js:116\r\n    _getWidgets ChartSettings.jsx:167\r\n    render ChartSettings.jsx:285\r\n    React 8\r\n    unstable_runWithPriority scheduler.production.min.js:18\r\n    React 5\r\n[settings.js:109:12](webpack:///visualizations/lib/settings.js)\r\n\r\n\u200b', 'created_at': datetime.datetime(2024, 6, 12, 3, 30, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162036615, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': '![image](https://github.com/metabase/metabase/assets/75652286/c75890b4-f9b8-4afb-89f8-fd812d527b2c)', 'created_at': datetime.datetime(2024, 6, 12, 3, 31, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163319201, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': 'I tried to reproduce this with an MBQL model on the Sample Database: Orders joined to People, Sum of SUBTOTAL by People.NAME. It works in a regular table view and chart view, but if I try to pivot it fails on the server side with a similar error:\r\n\r\n```sql\r\n-- 2024-06-12 15:07:20,488 ERROR middleware.catch-exceptions :: Error processing query: Column ""source.NAME"" not found; SQL statement:                                                                                                                         \r\nSELECT\r\n  ""source"".""NAME"" AS ""People - User__NAME"",\r\n  ""source"".""pivot-grouping"" AS ""pivot-grouping"",\r\n  SUM(""source"".""SUBTOTAL"") AS ""sum""\r\nFROM (\r\n  SELECT\r\n    ""source"".""SUBTOTAL"" AS ""SUBTOTAL"",\r\n    ABS(0) AS ""pivot-grouping""\r\n  FROM (\r\n    SELECT\r\n      ""PUBLIC"".""ORDERS"".""ID"" AS ""ID"",\r\n      ""PUBLIC"".""ORDERS"".""USER_ID"" AS ""USER_ID"",\r\n      ""PUBLIC"".""ORDERS"".""PRODUCT_ID"" AS ""PRODUCT_ID"",\r\n      ""PUBLIC"".""ORDERS"".""SUBTOTAL"" AS ""SUBTOTAL"",\r\n      ""PUBLIC"".""ORDERS"".""TAX"" AS ""TAX"",\r\n      ""PUBLIC"".""ORDERS"".""TOTAL"" AS ""TOTAL"",\r\n      ""PUBLIC"".""ORDERS"".""DISCOUNT"" AS ""DISCOUNT"",\r\n      ""PUBLIC"".""ORDERS"".""CREATED_AT"" AS ""CREATED_AT"",\r\n      ""PUBLIC"".""ORDERS"".""QUANTITY"" AS ""QUANTITY"",\r\n      ""People - User"".""ID"" AS ""People - User__ID"",\r\n      ""People - User"".""ADDRESS"" AS ""People - User__ADDRESS"",\r\n      ""People - User"".""EMAIL"" AS ""People - User__EMAIL"",\r\n      ""People - User"".""PASSWORD"" AS ""People - User__PASSWORD"",\r\n      ""People - User"".""NAME"" AS ""People - User__NAME"",\r\n      ""People - User"".""CITY"" AS ""People - User__CITY"",\r\n      ""People - User"".""LONGITUDE"" AS ""People - User__LONGITUDE"",\r\n      ""People - User"".""STATE"" AS ""People - User__STATE"", \r\n      ""People - User"".""SOURCE"" AS ""People - User__SOURCE"",\r\n      ""People - User"".""BIRTH_DATE"" AS ""People - User__BIRTH_DATE"",\r\n      ""People - User"".""ZIP"" AS ""People - User__ZIP"",\r\n      ""People - User"".""LATITUDE"" AS ""People - User__LATITUDE"",\r\n      ""People - User"".""CREATED_AT"" AS ""People - User__CREATED_AT""\r\n    FROM ""PUBLIC"".""ORDERS""\r\n    LEFT JOIN ""PUBLIC"".""PEOPLE"" AS ""People - User"" ON ""PUBLIC"".""ORDERS"".""USER_ID"" = ""People - User"".""ID""\r\n  ) AS ""source""\r\n) AS ""source""\r\nGROUP BY ""source"".""NAME"", ""source"".""pivot-grouping""\r\nORDER BY ""source"".""NAME"" ASC, ""source"".""pivot-grouping"" ASC;\r\n```\r\n\r\nThe first inner query selects only `source.SUBTOTAL` and `pivot-grouping`, and not `NAME`, so it\'s not available for the outer source. I think this is an issue with pivoting on models. I\'ll try the similar query without the extra layer introduced by models.', 'created_at': datetime.datetime(2024, 6, 12, 15, 24, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163338511, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': ""Ah, it's actually an issue with nesting and pivot tables.\r\n\r\nThis query is a bit contrived, to get multiple stages on a simple dataset, but it does repro the issue.\r\n\r\nThis one-stage works fine:\r\n![2024-06-12-112816_1894x1122_scrot](https://github.com/metabase/metabase/assets/157812/768dd5a1-3cd6-4874-a0bb-13c28e8600a1)\r\n\r\nBut this is broken with the same kind of error:\r\n![2024-06-12-113218_1953x1317_scrot](https://github.com/metabase/metabase/assets/157812/7c40778c-82e6-4faa-bfee-1450921aab90)"", 'created_at': datetime.datetime(2024, 6, 12, 15, 32, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163339912, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': ""I'm debugging into this issue."", 'created_at': datetime.datetime(2024, 6, 12, 15, 33, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163379259, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': ""Confirmed this is a regression, it works fine in 49. I'm bisecting to nail down the cause."", 'created_at': datetime.datetime(2024, 6, 12, 15, 47, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163903789, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': ""I've narrowed down this issue to how fields are tracked across stages when we introduce extra levels of nesting (eg. when there are expressions).\r\n\r\nThere's a subtle case that's not being properly handled. Should be fixed tomorrow.\r\n\r\nFor the record, this only appears on:\r\n- nested queries\r\n- with aggregations in the last stage; and\r\n- either when pivoting or with expressions in non-first stages"", 'created_at': datetime.datetime(2024, 6, 12, 21, 8, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166396135, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': ""I'm actually failing to see the regression here. This fails in the same way on 49.16.\r\n\r\nI'm trying 49.0 and the last 48.x now for comparison."", 'created_at': datetime.datetime(2024, 6, 13, 17, 28, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166431668, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': ""Okay, I understand my confusion about the regression or not: this has been broken for single multi-stage queries for a long time, but it used to work for **models**. That's the part that broke in 0.50.0.\r\n\r\nI've got a fix for this. I'll clean it up and get the PR posted today."", 'created_at': datetime.datetime(2024, 6, 13, 17, 46, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168176021, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': 'Thanks for fixing the issue. \r\n\r\nBut the problem again, when I used Custom Field in secondary nesting model or more for Pivot Table. \r\n\r\n![image](https://github.com/metabase/metabase/assets/75652286/b9143dc5-8303-4b19-a53a-1c8572254994)\r\n\r\nQtyNoMotor is a Custom Field from secondary nesting model', 'created_at': datetime.datetime(2024, 6, 14, 14, 32, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168177937, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': 'It is also fine in any 0.49', 'created_at': datetime.datetime(2024, 6, 14, 14, 33, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2174205477, 'issue_id': 2345872642, 'author': 'paoliniluis', 'body': '@Jianbin719 you moved to 50.4 or 50.5?', 'created_at': datetime.datetime(2024, 6, 17, 18, 53, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2174412133, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': ""@Jianbin719 it's working for me on 50.5. Can you give more detail of the model, the query, and especially the error message you're getting?\r\n\r\nI'm using this as the model definition:\r\n![2024-06-17-165117_2522x1132_scrot](https://github.com/metabase/metabase/assets/157812/361a1fba-9253-4e63-a3b7-1ebdc1e43653)\r\n\r\nand this as the query:\r\n![2024-06-17-165038_2547x552_scrot](https://github.com/metabase/metabase/assets/157812/6523e7c1-0386-48fd-930f-8b0fd63267bc)\r\n\r\n## On debugging\r\n\r\nThe best help you could give me for debugging this would be to **reproduce this issue using the Sample Database**. \r\n\r\nSecond best would be to include the diagnostic information. Press Ctrl+F1 on the question that failed, and send the JSON file with at least these selections:\r\n![2024-06-17-165523_1256x1086_scrot](https://github.com/metabase/metabase/assets/157812/044845da-1046-460c-ad5b-19449a430d16)\r\nBut do review the JSON file first - it might include sensitive things you don't want to post on the Github issue."", 'created_at': datetime.datetime(2024, 6, 17, 20, 58, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2174730137, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': '[metabase-diagnostic-info-2024-06-18T01_10_57.280Z.json](https://github.com/user-attachments/files/15878972/metabase-diagnostic-info-2024-06-18T01_10_57.280Z.json)\r\n\r\n@bshepherdson Thanks for your reply. I updated it to 0.50.5', 'created_at': datetime.datetime(2024, 6, 18, 1, 23, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2176038309, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': '> [metabase-diagnostic-info-2024-06-18T01_10_57.280Z.json](https://github.com/user-attachments/files/15878972/metabase-diagnostic-info-2024-06-18T01_10_57.280Z.json)\n> \n> @bshepherdson Thanks for your reply. I updated it to 0.50.5\n> \n\nI updated to 0.50.5, but problem not solved', 'created_at': datetime.datetime(2024, 6, 18, 12, 56, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2176107098, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': 'Right! Sorry for the extra close-and-reopen there.\r\n\r\nThanks for the diagnostic info! Here\'s the SQL from one of the errors:\r\n\r\n```sql\r\nSELECT                                                                                                                        \r\n  `source`.`Group Product - Series__ProductGroup` AS `Group Product - Series__ProductGroup`,                                  \r\n  `source`.`pivot-grouping` AS `pivot-grouping`,                                                                              \r\n  SUM(`source`.`QtyNoMotor`) AS `sum`,                                                                                        \r\n  SUM(`source`.`subtotal_usd`) AS `sum_2`                                                                                     \r\nFROM                                                                                                                          \r\n  (                                                                                                                           \r\n    SELECT                                                                                                                    \r\n      `source`.`subtotal_usd` AS `subtotal_usd`,                                                                              \r\n      `source`.`QtyNoMotor` AS `QtyNoMotor`,                                                                                  \r\n      ABS(0) AS `pivot-grouping`                                                                                              \r\n    FROM                                                                                                                      \r\n      (                                                                                                                       \r\n        select                                                                                                                \r\n          *                                                                                                                   \r\n        from                                                                                                                  \r\n          `metabase_cache_00491_2`.`model_57_模型-鼎捷订单`                                                                   \r\n      ) AS `source`                                                                                                           \r\n  ) AS `source`                                                                                                               \r\nGROUP BY                                                                                                                      \r\n  `source`.`Group Product - Series__ProductGroup`,                                                                            \r\n  `source`.`pivot-grouping`                                                                                                   \r\nORDER BY                                                                                                                      \r\n  `source`.`Group Product - Series__ProductGroup` ASC,                                                                        \r\n  `source`.`pivot-grouping` ASC \r\n  ```\r\n  \r\nwhich looks like this same issue. The ```source.`Group Product - Series__ProductGroup` ``` doesn\'t exist on the middle query.\r\n\r\nThe MBQL here is:\r\n\r\n```clojure\r\n  {:lib/type :mbql/query                                                                                                      \r\n   :qp.pivot/breakout-combination [0]                                                                                         \r\n   :stages [{:lib/type :mbql.stage/mbql                                                                                       \r\n             :aggregation [[:sum {} [:field {:base-type :type/BigInteger} ""QtyNoMotor""]]                                      \r\n                           [:sum {} [:field {:base-type :type/Decimal} ""subtotal_usd""]]]                                      \r\n             :source-card 57                                                                                                  \r\n             :breakout    [[:field {:base-type :type/Text} ""ProductGroup""]                                                    \r\n                           [:expression                                                                                       \r\n                            {:base-type :type/Integer,                                                                        \r\n                             :effective-type :type/Integer}                                                                   \r\n                            ""pivot-grouping""]]                                                                                \r\n             :expressions [[:abs {:lib/expression-name ""pivot-grouping""} 0]]}]                                                \r\n   :middleware {:pivot-options                     {:pivot-rows nil, :pivot-cols nil}}                                        \r\n   :database 2}\r\n```\r\n\r\nwhich looks plausible and valid. \r\n\r\nMy current speculation is that the inner ```(SELECT * FROM `metabase_cache_00491_2`.`model_57_模型-鼎捷订单`)``` is the issue - if we don\'t know which fields are coming from that innermost query, the logic to nest the query might be broken.\r\n\r\nI\'m continuing to debug this.', 'created_at': datetime.datetime(2024, 6, 18, 13, 29, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2176123722, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': 'ProductGroup is the custom field for the relatwd model', 'created_at': datetime.datetime(2024, 6, 18, 13, 36, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2176950450, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': ""I can't reproduce this, even guided by the MBQL from your error messages, which I posted above.\r\n\r\nIt may be related to model caching, but it's hard to check that.\r\n\r\nCan you post screenshots of the whole query editor for both the model's query and the query using the model? You can blur the field and table names if needed, but please keep the icons (it matters sometimes whether something is a table or a model)."", 'created_at': datetime.datetime(2024, 6, 18, 20, 51, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2177799606, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': '![image](https://github.com/metabase/metabase/assets/75652286/ceb9a26a-331b-464f-aedc-eb47426b6fba)', 'created_at': datetime.datetime(2024, 6, 19, 5, 47, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2177800234, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': '![image](https://github.com/metabase/metabase/assets/75652286/c6edc9d4-7cec-43ea-b9b7-18ea873018ef)', 'created_at': datetime.datetime(2024, 6, 19, 5, 47, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2178734667, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': '> ![image](https://github.com/metabase/metabase/assets/75652286/c6edc9d4-7cec-43ea-b9b7-18ea873018ef)\n> \n\nProblem with this configuration in Pivot table.', 'created_at': datetime.datetime(2024, 6, 19, 13, 33, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2178811501, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': ""Thanks! Two nested models with the expression on the inner one was a combination I hadn't tried.\r\n\r\nI'll try to reproduce this."", 'created_at': datetime.datetime(2024, 6, 19, 14, 7, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2178958654, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': 'Yep, that reproduces for me.\r\n\r\nFor posterity, I did it like this:\r\n- **Model A:** Products, with a custom column ""Rating Bucket"": `floor([Rating])`\r\n- **Model B:** Orders joined to Model A (on the default `Orders.PRODUCT_ID = Model A.ID`)\r\n- **Question:** Model B, sum of Subtotal, sum of Quantity, break out by Rating Bucket (Don\'t Bin)\r\n- The results are correct on a vanilla table, but break with a pivot viz (because of the extra expression and therefore extra level of nesting).\r\n\r\nI\'m debugging what\'s happening in the nesting logic now.', 'created_at': datetime.datetime(2024, 6, 19, 15, 17, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179352534, 'issue_id': 2345872642, 'author': 'bshepherdson', 'body': 'This will be in 50.7.', 'created_at': datetime.datetime(2024, 6, 19, 19, 26, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179740196, 'issue_id': 2345872642, 'author': 'Jianbin719', 'body': 'Thanks a lot', 'created_at': datetime.datetime(2024, 6, 20, 3, 29, 46, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-11 10:42:01 UTC): Screenshot?

ranquild on (2024-06-11 12:03:28 UTC): @Jianbin719 could you provide some additional information? You get this issue in dashboards with parameters, right? Does it happen with saved questions or models? Anything special about them?

Jianbin719 (Issue Creator) on (2024-06-11 13:44:15 UTC): I have one model X which consists of two table A and B. Then I created one more question Y to filter model X. 

The error exists in Pivot Table display, when trying to Summarize by field in Table B.  But with regular Table display is fine .

I do not have any problem in [v0.49.15]. the problem with version 0.50.0 only.

Jianbin719 (Issue Creator) on (2024-06-11 13:46:03 UTC): ![image](https://github.com/metabase/metabase/assets/75652286/f7870e29-2c64-424c-82e2-7ee8690f3505)

paoliniluis on (2024-06-11 14:39:18 UTC): @Jianbin719 I don't see where the field turns to unknown

Jianbin719 (Issue Creator) on (2024-06-11 16:17:11 UTC): @paoliniluis The company field turns into unknown. 

Where I can show you the log or detailed information

![Screenshot_20240612_001555.jpg](https://github.com/metabase/metabase/assets/75652286/87f0c1fd-d4f3-4bb5-8ae5-e76f83fe1336)

paoliniluis on (2024-06-11 16:23:23 UTC): ok, please open the browser console and send us what you see. It's a FE error that crashes the query builder

Jianbin719 (Issue Creator) on (2024-06-12 03:30:35 UTC): Password fields present on an insecure (http://) page. This is a security risk that allows user login credentials to be stolen.
[login](http://192.168.11.18/auth/login?redirect=%2Fquestion%2F117%2Fnotebook)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database],\n    :schema #object[Object [object Object]],\n    :value nil,\n    :type :malli.core/missing-key}\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\n    :in [:stages 0], \n    :schema #object[Object [object Object]], \n    :value {:lib/type :mbql.stage/mbql}})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database],\n    :schema #object[Object [object Object]],\n    :value nil,\n    :type :malli.core/missing-key}\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\n    :in [:stages 0], \n    :schema #object[Object [object Object]], \n    :value {:lib/type :mbql.stage/mbql}})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database], \n    :schema #object[Object [object Object]], \n    :value nil, \n    :type :malli.core/missing-key})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value\n {:lib/type :mbql/query,\n  :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}],\n  :lib/metadata #object[p [object Object]]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value\n  {:lib/type :mbql/query,\n   :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}],\n   :lib/metadata #object[p [object Object]]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database], \n    :schema #object[Object [object Object]], \n    :value nil, \n    :type :malli.core/missing-key})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database],\n    :schema #object[Object [object Object]],\n    :value nil,\n    :type :malli.core/missing-key}\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\n    :in [:stages 0], \n    :schema #object[Object [object Object]], \n    :value {:lib/type :mbql.stage/mbql}})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database],\n    :schema #object[Object [object Object]],\n    :value nil,\n    :type :malli.core/missing-key}\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\n    :in [:stages 0], \n    :schema #object[Object [object Object]], \n    :value {:lib/type :mbql.stage/mbql}})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database], \n    :schema #object[Object [object Object]], \n    :value nil, \n    :type :malli.core/missing-key})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value\n {:lib/type :mbql/query,\n  :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}],\n  :lib/metadata #object[p [object Object]]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value\n  {:lib/type :mbql/query,\n   :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}],\n   :lib/metadata #object[p [object Object]]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database], \n    :schema #object[Object [object Object]], \n    :value nil, \n    :type :malli.core/missing-key})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database],\n    :schema #object[Object [object Object]],\n    :value nil,\n    :type :malli.core/missing-key}\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\n    :in [:stages 0], \n    :schema #object[Object [object Object]], \n    :value {:lib/type :mbql.stage/mbql}})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/mbql}], :lib/metadata #object[p [object Object]]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database],\n    :schema #object[Object [object Object]],\n    :value nil,\n    :type :malli.core/missing-key}\n   {:path [0 0 :stages 0 1 0 0 :mbql.stage/mbql],\n    :in [:stages 0], \n    :schema #object[Object [object Object]], \n    :value {:lib/type :mbql.stage/mbql}})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value {:lib/type :mbql/query, :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database], \n    :schema #object[Object [object Object]], \n    :value nil, \n    :type :malli.core/missing-key})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
[metabase.lib.normalize] ""Error normalizing pMBQL:\n{:value\n {:lib/type :mbql/query,\n  :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}],\n  :lib/metadata #object[p [object Object]]},\n :schema #object[Object [object Object]],\n :explain\n {:schema #object[Object [object Object]],\n  :value\n  {:lib/type :mbql/query,\n   :stages [{:lib/type :mbql.stage/native, :template-tags {}, :native \""\""}],\n   :lib/metadata #object[p [object Object]]},\n  :errors\n  ({:path [0 0 :database],\n    :in [:database], \n    :schema #object[Object [object Object]], \n    :value nil, \n    :type :malli.core/missing-key})}}\n"" [core.cljs:4009:5](webpack:///target/cljs_release/cljs/core.cljs)
Content-Security-Policy: The page’s settings blocked an inline style (style-src-elem) from being applied because it violates the following directive: “style-src 'self' 'nonce-hkGpf76bw8' https://accounts.google.com/” [emotion-sheet.browser.esm.js:74:22](webpack:///node_modules/@emotion/sheet/dist/emotion-sheet.browser.esm.js)
Error getting setting pivot_table.column_split TypeError: e is undefined
    t settings.ts:122
    t settings.ts:122
    eG Underscore
    getValue settings.ts:121
    e settings.js:86
    e settings.js:69
    ee settings.js:42
    f visualization.js:97
    eV selectors.js:737
    Redux 10
    et9 QueryBuilder.jsx:118
    Redux 7
    aJ React
    Redux 5
    aJ React
    Redux 5
    aJ React
    Redux 5
    aJ React
    Redux 5
    aJ React
    Redux 5
    aJ React
    Redux 5
    aJ React
    Redux 5
    aJ React
    Redux 9
    em querying.js:211
    Redux 2
    eo querying.js:139
[settings.js:109:12](webpack:///visualizations/lib/settings.js)
Error getting setting pivot_table.column_split TypeError: e is undefined
    t settings.ts:122
    t settings.ts:122
    eG Underscore
    getValue settings.ts:121
    e settings.js:86
    e settings.js:69
    ee settings.js:42
    f visualization.js:97
    eV selectors.js:737
    Redux 10
    et9 QueryBuilder.jsx:118
    Redux 4
    u use-sync-external-store-shim.production.min.js:10
    c Redux
    React 9
    unstable_runWithPriority scheduler.production.min.js:18
    React 4
    Redux 10
[settings.js:109:12](webpack:///visualizations/lib/settings.js)
Error getting setting pivot_table.column_split TypeError: e is undefined
    t settings.ts:122
    t settings.ts:122
    eG Underscore
    getValue settings.ts:121
    e settings.js:86
    e settings.js:69
    ee settings.js:42
    f visualization.js:97
    g visualization.js:116
    _getWidgets ChartSettings.jsx:167
    render ChartSettings.jsx:285
    React 8
    unstable_runWithPriority scheduler.production.min.js:18
    React 5
[settings.js:109:12](webpack:///visualizations/lib/settings.js)

​

Jianbin719 (Issue Creator) on (2024-06-12 03:31:13 UTC): ![image](https://github.com/metabase/metabase/assets/75652286/c75890b4-f9b8-4afb-89f8-fd812d527b2c)

bshepherdson (Assginee) on (2024-06-12 15:24:14 UTC): I tried to reproduce this with an MBQL model on the Sample Database: Orders joined to People, Sum of SUBTOTAL by People.NAME. It works in a regular table view and chart view, but if I try to pivot it fails on the server side with a similar error:

```sql
-- 2024-06-12 15:07:20,488 ERROR middleware.catch-exceptions :: Error processing query: Column ""source.NAME"" not found; SQL statement:                                                                                                                         
SELECT
  ""source"".""NAME"" AS ""People - User__NAME"",
  ""source"".""pivot-grouping"" AS ""pivot-grouping"",
  SUM(""source"".""SUBTOTAL"") AS ""sum""
FROM (
  SELECT
    ""source"".""SUBTOTAL"" AS ""SUBTOTAL"",
    ABS(0) AS ""pivot-grouping""
  FROM (
    SELECT
      ""PUBLIC"".""ORDERS"".""ID"" AS ""ID"",
      ""PUBLIC"".""ORDERS"".""USER_ID"" AS ""USER_ID"",
      ""PUBLIC"".""ORDERS"".""PRODUCT_ID"" AS ""PRODUCT_ID"",
      ""PUBLIC"".""ORDERS"".""SUBTOTAL"" AS ""SUBTOTAL"",
      ""PUBLIC"".""ORDERS"".""TAX"" AS ""TAX"",
      ""PUBLIC"".""ORDERS"".""TOTAL"" AS ""TOTAL"",
      ""PUBLIC"".""ORDERS"".""DISCOUNT"" AS ""DISCOUNT"",
      ""PUBLIC"".""ORDERS"".""CREATED_AT"" AS ""CREATED_AT"",
      ""PUBLIC"".""ORDERS"".""QUANTITY"" AS ""QUANTITY"",
      ""People - User"".""ID"" AS ""People - User__ID"",
      ""People - User"".""ADDRESS"" AS ""People - User__ADDRESS"",
      ""People - User"".""EMAIL"" AS ""People - User__EMAIL"",
      ""People - User"".""PASSWORD"" AS ""People - User__PASSWORD"",
      ""People - User"".""NAME"" AS ""People - User__NAME"",
      ""People - User"".""CITY"" AS ""People - User__CITY"",
      ""People - User"".""LONGITUDE"" AS ""People - User__LONGITUDE"",
      ""People - User"".""STATE"" AS ""People - User__STATE"", 
      ""People - User"".""SOURCE"" AS ""People - User__SOURCE"",
      ""People - User"".""BIRTH_DATE"" AS ""People - User__BIRTH_DATE"",
      ""People - User"".""ZIP"" AS ""People - User__ZIP"",
      ""People - User"".""LATITUDE"" AS ""People - User__LATITUDE"",
      ""People - User"".""CREATED_AT"" AS ""People - User__CREATED_AT""
    FROM ""PUBLIC"".""ORDERS""
    LEFT JOIN ""PUBLIC"".""PEOPLE"" AS ""People - User"" ON ""PUBLIC"".""ORDERS"".""USER_ID"" = ""People - User"".""ID""
  ) AS ""source""
) AS ""source""
GROUP BY ""source"".""NAME"", ""source"".""pivot-grouping""
ORDER BY ""source"".""NAME"" ASC, ""source"".""pivot-grouping"" ASC;
```

The first inner query selects only `source.SUBTOTAL` and `pivot-grouping`, and not `NAME`, so it's not available for the outer source. I think this is an issue with pivoting on models. I'll try the similar query without the extra layer introduced by models.

bshepherdson (Assginee) on (2024-06-12 15:32:56 UTC): Ah, it's actually an issue with nesting and pivot tables.

This query is a bit contrived, to get multiple stages on a simple dataset, but it does repro the issue.

This one-stage works fine:
![2024-06-12-112816_1894x1122_scrot](https://github.com/metabase/metabase/assets/157812/768dd5a1-3cd6-4874-a0bb-13c28e8600a1)

But this is broken with the same kind of error:
![2024-06-12-113218_1953x1317_scrot](https://github.com/metabase/metabase/assets/157812/7c40778c-82e6-4faa-bfee-1450921aab90)

bshepherdson (Assginee) on (2024-06-12 15:33:37 UTC): I'm debugging into this issue.

bshepherdson (Assginee) on (2024-06-12 15:47:13 UTC): Confirmed this is a regression, it works fine in 49. I'm bisecting to nail down the cause.

bshepherdson (Assginee) on (2024-06-12 21:08:02 UTC): I've narrowed down this issue to how fields are tracked across stages when we introduce extra levels of nesting (eg. when there are expressions).

There's a subtle case that's not being properly handled. Should be fixed tomorrow.

For the record, this only appears on:
- nested queries
- with aggregations in the last stage; and
- either when pivoting or with expressions in non-first stages

bshepherdson (Assginee) on (2024-06-13 17:28:53 UTC): I'm actually failing to see the regression here. This fails in the same way on 49.16.

I'm trying 49.0 and the last 48.x now for comparison.

bshepherdson (Assginee) on (2024-06-13 17:46:49 UTC): Okay, I understand my confusion about the regression or not: this has been broken for single multi-stage queries for a long time, but it used to work for **models**. That's the part that broke in 0.50.0.

I've got a fix for this. I'll clean it up and get the PR posted today.

Jianbin719 (Issue Creator) on (2024-06-14 14:32:47 UTC): Thanks for fixing the issue. 

But the problem again, when I used Custom Field in secondary nesting model or more for Pivot Table. 

![image](https://github.com/metabase/metabase/assets/75652286/b9143dc5-8303-4b19-a53a-1c8572254994)

QtyNoMotor is a Custom Field from secondary nesting model

Jianbin719 (Issue Creator) on (2024-06-14 14:33:47 UTC): It is also fine in any 0.49

paoliniluis on (2024-06-17 18:53:33 UTC): @Jianbin719 you moved to 50.4 or 50.5?

bshepherdson (Assginee) on (2024-06-17 20:58:17 UTC): @Jianbin719 it's working for me on 50.5. Can you give more detail of the model, the query, and especially the error message you're getting?

I'm using this as the model definition:
![2024-06-17-165117_2522x1132_scrot](https://github.com/metabase/metabase/assets/157812/361a1fba-9253-4e63-a3b7-1ebdc1e43653)

and this as the query:
![2024-06-17-165038_2547x552_scrot](https://github.com/metabase/metabase/assets/157812/6523e7c1-0386-48fd-930f-8b0fd63267bc)

## On debugging

The best help you could give me for debugging this would be to **reproduce this issue using the Sample Database**. 

Second best would be to include the diagnostic information. Press Ctrl+F1 on the question that failed, and send the JSON file with at least these selections:
![2024-06-17-165523_1256x1086_scrot](https://github.com/metabase/metabase/assets/157812/044845da-1046-460c-ad5b-19449a430d16)
But do review the JSON file first - it might include sensitive things you don't want to post on the Github issue.

Jianbin719 (Issue Creator) on (2024-06-18 01:23:38 UTC): [metabase-diagnostic-info-2024-06-18T01_10_57.280Z.json](https://github.com/user-attachments/files/15878972/metabase-diagnostic-info-2024-06-18T01_10_57.280Z.json)

@bshepherdson Thanks for your reply. I updated it to 0.50.5

Jianbin719 (Issue Creator) on (2024-06-18 12:56:41 UTC): I updated to 0.50.5, but problem not solved

bshepherdson (Assginee) on (2024-06-18 13:29:10 UTC): Right! Sorry for the extra close-and-reopen there.

Thanks for the diagnostic info! Here's the SQL from one of the errors:

```sql
SELECT                                                                                                                        
  `source`.`Group Product - Series__ProductGroup` AS `Group Product - Series__ProductGroup`,                                  
  `source`.`pivot-grouping` AS `pivot-grouping`,                                                                              
  SUM(`source`.`QtyNoMotor`) AS `sum`,                                                                                        
  SUM(`source`.`subtotal_usd`) AS `sum_2`                                                                                     
FROM                                                                                                                          
  (                                                                                                                           
    SELECT                                                                                                                    
      `source`.`subtotal_usd` AS `subtotal_usd`,                                                                              
      `source`.`QtyNoMotor` AS `QtyNoMotor`,                                                                                  
      ABS(0) AS `pivot-grouping`                                                                                              
    FROM                                                                                                                      
      (                                                                                                                       
        select                                                                                                                
          *                                                                                                                   
        from                                                                                                                  
          `metabase_cache_00491_2`.`model_57_模型-鼎捷订单`                                                                   
      ) AS `source`                                                                                                           
  ) AS `source`                                                                                                               
GROUP BY                                                                                                                      
  `source`.`Group Product - Series__ProductGroup`,                                                                            
  `source`.`pivot-grouping`                                                                                                   
ORDER BY                                                                                                                      
  `source`.`Group Product - Series__ProductGroup` ASC,                                                                        
  `source`.`pivot-grouping` ASC 
  ```
  
which looks like this same issue. The ```source.`Group Product - Series__ProductGroup` ``` doesn't exist on the middle query.

The MBQL here is:

```clojure
  {:lib/type :mbql/query                                                                                                      
   :qp.pivot/breakout-combination [0]                                                                                         
   :stages [{:lib/type :mbql.stage/mbql                                                                                       
             :aggregation [[:sum {} [:field {:base-type :type/BigInteger} ""QtyNoMotor""]]                                      
                           [:sum {} [:field {:base-type :type/Decimal} ""subtotal_usd""]]]                                      
             :source-card 57                                                                                                  
             :breakout    [[:field {:base-type :type/Text} ""ProductGroup""]                                                    
                           [:expression                                                                                       
                            {:base-type :type/Integer,                                                                        
                             :effective-type :type/Integer}                                                                   
                            ""pivot-grouping""]]                                                                                
             :expressions [[:abs {:lib/expression-name ""pivot-grouping""} 0]]}]                                                
   :middleware {:pivot-options                     {:pivot-rows nil, :pivot-cols nil}}                                        
   :database 2}
```

which looks plausible and valid. 

My current speculation is that the inner ```(SELECT * FROM `metabase_cache_00491_2`.`model_57_模型-鼎捷订单`)``` is the issue - if we don't know which fields are coming from that innermost query, the logic to nest the query might be broken.

I'm continuing to debug this.

Jianbin719 (Issue Creator) on (2024-06-18 13:36:31 UTC): ProductGroup is the custom field for the relatwd model

bshepherdson (Assginee) on (2024-06-18 20:51:23 UTC): I can't reproduce this, even guided by the MBQL from your error messages, which I posted above.

It may be related to model caching, but it's hard to check that.

Can you post screenshots of the whole query editor for both the model's query and the query using the model? You can blur the field and table names if needed, but please keep the icons (it matters sometimes whether something is a table or a model).

Jianbin719 (Issue Creator) on (2024-06-19 05:47:16 UTC): ![image](https://github.com/metabase/metabase/assets/75652286/ceb9a26a-331b-464f-aedc-eb47426b6fba)

Jianbin719 (Issue Creator) on (2024-06-19 05:47:54 UTC): ![image](https://github.com/metabase/metabase/assets/75652286/c6edc9d4-7cec-43ea-b9b7-18ea873018ef)

Jianbin719 (Issue Creator) on (2024-06-19 13:33:25 UTC): Problem with this configuration in Pivot table.

bshepherdson (Assginee) on (2024-06-19 14:07:06 UTC): Thanks! Two nested models with the expression on the inner one was a combination I hadn't tried.

I'll try to reproduce this.

bshepherdson (Assginee) on (2024-06-19 15:17:03 UTC): Yep, that reproduces for me.

For posterity, I did it like this:
- **Model A:** Products, with a custom column ""Rating Bucket"": `floor([Rating])`
- **Model B:** Orders joined to Model A (on the default `Orders.PRODUCT_ID = Model A.ID`)
- **Question:** Model B, sum of Subtotal, sum of Quantity, break out by Rating Bucket (Don't Bin)
- The results are correct on a vanilla table, but break with a pivot viz (because of the extra expression and therefore extra level of nesting).

I'm debugging what's happening in the nesting logic now.

bshepherdson (Assginee) on (2024-06-19 19:26:26 UTC): This will be in 50.7.

Jianbin719 (Issue Creator) on (2024-06-20 03:29:46 UTC): Thanks a lot

"
2345770813,issue,closed,completed,Lib.expressionClauseForLegacyExpression throws when using a multi-value string/contains filter,"Thread with info https://metaboat.slack.com/archives/C0645JP1W81/p1718109273559439

### Describe the bug

https://github.com/metabase/metabase/assets/6830683/fdcf4d3d-a6cb-4bd5-ad15-911ef701d1ee


### To Reproduce

1. Create a question Orders > Limit 5
2. Add it to a new dashboard
3. Add Text > Contains filter to the dashboard and connect it to Source field in the card
4. Save dashboard
5. Set 2 filter values: ""aa"" and ""bb""
6. Click dashcard title

Nothing happens.
There's an error in JS console:
```
Uncaught (in promise) Error: No protocol method IAssociative.-assoc defined for type number: 14
```

### Expected behavior

No error in JS console.
You get navigated to question page.

### Information about your Metabase installation

master, 459429985c, v50+ (we didn't support multiple values in these filters before)


### Severity

P1/P2
",kamilmielnik,2024-06-11 08:41:17+00:00,['ranquild'],2024-07-16 15:45:58+00:00,2024-07-16 14:04:54+00:00,https://github.com/metabase/metabase/issues/43990,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('Querying/MBQL', ''), ('.Frontend', ''), ('Querying/Drill Thrus', 'Refining existing queries with Drill Thrus'), ('.Team/Querying', '')]","[{'comment_id': 2160220052, 'issue_id': 2345770813, 'author': 'kamilmielnik', 'body': 'This issue happens when computing URL for the dashcard title.\r\nIt has not been caught by tests because you need to click such link to get the error.\r\n\r\nHowever #43816 adds link computation even before the click event happens, so this bug prevails there.\r\nI had to add a temporary try/catch to work around it (see 08a5606ad6)\r\n\r\n:warning: Please revert [that commit](https://github.com/metabase/metabase/commit/08a5606ad6752aa7b60c5f2e0bd5d287568a1ed8) when issue is fixed :warning:', 'created_at': datetime.datetime(2024, 6, 11, 9, 21, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162282700, 'issue_id': 2345770813, 'author': 'kamilmielnik', 'body': ""There's a repro for it already, see: #43000\r\n:warning:  When this issue is fixed please unskip it and update the issue id in the test name :warning:"", 'created_at': datetime.datetime(2024, 6, 12, 7, 16, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2181801521, 'issue_id': 2345770813, 'author': 'ranquild', 'body': 'As discussed, for legacy mbql only we need to pass args differently on the FE.', 'created_at': datetime.datetime(2024, 6, 21, 1, 4, 47, tzinfo=datetime.timezone.utc)}]","kamilmielnik (Issue Creator) on (2024-06-11 09:21:19 UTC): This issue happens when computing URL for the dashcard title.
It has not been caught by tests because you need to click such link to get the error.

However #43816 adds link computation even before the click event happens, so this bug prevails there.
I had to add a temporary try/catch to work around it (see 08a5606ad6)

:warning: Please revert [that commit](https://github.com/metabase/metabase/commit/08a5606ad6752aa7b60c5f2e0bd5d287568a1ed8) when issue is fixed :warning:

kamilmielnik (Issue Creator) on (2024-06-12 07:16:07 UTC): There's a repro for it already, see: #43000
:warning:  When this issue is fixed please unskip it and update the issue id in the test name :warning:

ranquild (Assginee) on (2024-06-21 01:04:47 UTC): As discussed, for legacy mbql only we need to pass args differently on the FE.

"
2345706729,issue,closed,not_planned,Changing Date Granularity on the go,"**Problem:**
As a visitor of a dashboard, you may want to change date granularity of a graph to get better insight while analyzing. right now, this is not possible, and the way we have solved it in our company is adding all daily, weekly and monthly versions of each graph in one dashboard. But in this way, the dashboard becomes veryyyy long and hard to read for audience.


**Suggestion**
I think if we can define some parameteres like current filters, to define how each query is written related to the date fields, we can show date granualrity for each graph or for a whole dashbaord.

![date granularity](https://github.com/metabase/metabase/assets/9046779/33e326f4-3072-4695-bdbb-007ea30debcc)

This change makes it much easier for audience to get insight from each dashboard. and already almost all other platforms like power BI have this.


",mehdimeskin,2024-06-11 08:11:02+00:00,[],2024-06-11 10:44:16+00:00,2024-06-11 10:44:16+00:00,https://github.com/metabase/metabase/issues/43989,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2160429943, 'issue_id': 2345706729, 'author': 'paoliniluis', 'body': 'This is coming soon, it’s a duplicate of another feature request', 'created_at': datetime.datetime(2024, 6, 11, 10, 44, 16, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-11 10:44:16 UTC): This is coming soon, it’s a duplicate of another feature request

"
2345236624,issue,closed,not_planned,"Migration failed in Mysql 8, says ""Invalid default value for `updated_at`""","After I tried to upgrade to new version, the error occurred, which was:
 `Reason: liquibase.exception.DatabaseException: (conn=7301810) Invalid default value for 'updated_at' [Failed SQL: (1067) CREATE TABLE `metabase`.`cloud_migration` (`id` INT AUTO_INCREMENT NOT NULL COMMENT 'Unique ID', `external_id` LONGTEXT NOT NULL COMMENT 'Matching ID in Cloud for this migration', `upload_url` LONGTEXT NOT NULL COMMENT 'URL where the backup will be uploaded to', `state` VARCHAR(32) DEFAULT 'init' NOT NULL COMMENT 'Current state of the migration: init, setup, dump, upload, done, error, cancelled', `progress` INT DEFAULT 0 NOT NULL COMMENT 'Number between 0 to 100 representing progress as a percentage', `created_at` timestamp(6) NOT NULL COMMENT 'Timestamp when the config was inserted', `updated_at` timestamp(6) NOT NULL COMMENT 'Timestamp when the config was updated', CONSTRAINT `PK_CLOUD_MIGRATION` PRIMARY KEY (`id`)) COMMENT='Migrate to cloud directly from Metabase' ENGINE InnoDB CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;]`

After some investigation, the root cause of mine issue is that the sql_mode in mysql 8 (you can check it by `show variables like 'sql_mode' ; `), it has `NO_ZERO_IN_DATE,NO_ZERO_DATE` by default, just delete these two items. Maybe the migration script shoud consider this situation.
_Originally posted by @wjh000123 in https://github.com/metabase/metabase/issues/40546#issuecomment-2159612060_
            ",wjh000123,2024-06-11 02:30:41+00:00,[],2025-01-08 15:40:19+00:00,2025-01-08 15:40:19+00:00,https://github.com/metabase/metabase/issues/43985,"[('Priority:P2', 'Average run of the mill bug'), ('.Unable to Reproduce', ''), ('Operation/Database Migrations', 'Issues with application DB migrations when launching Metabase'), ('.Backend', '')]","[{'comment_id': 2160486338, 'issue_id': 2345236624, 'author': 'qnkhuat', 'body': ""I couldn't reproduce.\r\n\r\n```\r\nmysql> show variables like 'sql_mode';\r\n+---------------+-----------------------------------------------------------------------------------------------------------------------+\r\n| Variable_name | Value                                                                                                                 |\r\n+---------------+-----------------------------------------------------------------------------------------------------------------------+\r\n| sql_mode      | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |\r\n+---------------+-----------------------------------------------------------------------------------------------------------------------+\r\n1 row in set (0.00 sec)\r\n```\r\n\r\nI have this and using MySQL 8.1.0 and migration works.\r\n\r\n@wjh000123 could you provide more details about your setup? Maybe you have other custom settings?"", 'created_at': datetime.datetime(2024, 6, 11, 11, 16, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2160489952, 'issue_id': 2345236624, 'author': 'qnkhuat', 'body': ""Which mysql version you're running and on which platform?"", 'created_at': datetime.datetime(2024, 6, 11, 11, 18, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2160988757, 'issue_id': 2345236624, 'author': 'paoliniluis', 'body': ""yeah, me neither @wjh000123, can you specify exact version of MySQL you're using?"", 'created_at': datetime.datetime(2024, 6, 11, 15, 0, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2161005638, 'issue_id': 2345236624, 'author': 'paoliniluis', 'body': 'setting it to ""can\'t reproduce"" as the user is either using a fork of MySQL/MariaDB or maybe a wrong version (like 5.x)', 'created_at': datetime.datetime(2024, 6, 11, 15, 8, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2167306996, 'issue_id': 2345236624, 'author': 'WangDanpeng', 'body': 'The issue seems to occur on the Alibaba Cloud database, and I have resolved it in a similar way. The problems tend to arise on Alibaba Cloud databases.\r\n![image](https://github.com/metabase/metabase/assets/20870505/0e3549cd-7d8b-4ee0-9d13-d832d729364d)', 'created_at': datetime.datetime(2024, 6, 14, 6, 25, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2577725138, 'issue_id': 2345236624, 'author': 'zhoujunhe', 'body': '这个问题很简单，启动metabase的时候把环境变量配置以下值，注意把IP，数据库，用户名和密码换成自己的，只要sql_mode没有NO_ZERO_IN_DATE,NO_ZERO_DATE就行，我里只使用了STRICT_TRANS_TABLES，大家用阿里云的应都会中文吧，这个在metabase官方文档还特意提了不支持阿里云的mysql，其实文档标记一下，碰到这问题让大家使用环境变量MB_DB_CONNECTION_URI就可以了。\n```\nMB_DB_CONNECTION_URI=""jdbc:mysql://{IP}:3306/metabase?sessionVariables=sql_mode=\'STRICT_TRANS_TABLES\'""\nMB_DB_USER=""username""\nMB_DB_PASS=""password""\n```', 'created_at': datetime.datetime(2025, 1, 8, 13, 52, 36, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-06-11 11:16:11 UTC): I couldn't reproduce.

```
mysql> show variables like 'sql_mode';
+---------------+-----------------------------------------------------------------------------------------------------------------------+
| Variable_name | Value                                                                                                                 |
+---------------+-----------------------------------------------------------------------------------------------------------------------+
| sql_mode      | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION |
+---------------+-----------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

I have this and using MySQL 8.1.0 and migration works.

@wjh000123 could you provide more details about your setup? Maybe you have other custom settings?

qnkhuat on (2024-06-11 11:18:06 UTC): Which mysql version you're running and on which platform?

paoliniluis on (2024-06-11 15:00:49 UTC): yeah, me neither @wjh000123, can you specify exact version of MySQL you're using?

paoliniluis on (2024-06-11 15:08:06 UTC): setting it to ""can't reproduce"" as the user is either using a fork of MySQL/MariaDB or maybe a wrong version (like 5.x)

WangDanpeng on (2024-06-14 06:25:59 UTC): The issue seems to occur on the Alibaba Cloud database, and I have resolved it in a similar way. The problems tend to arise on Alibaba Cloud databases.
![image](https://github.com/metabase/metabase/assets/20870505/0e3549cd-7d8b-4ee0-9d13-d832d729364d)

zhoujunhe on (2025-01-08 13:52:36 UTC): 这个问题很简单，启动metabase的时候把环境变量配置以下值，注意把IP，数据库，用户名和密码换成自己的，只要sql_mode没有NO_ZERO_IN_DATE,NO_ZERO_DATE就行，我里只使用了STRICT_TRANS_TABLES，大家用阿里云的应都会中文吧，这个在metabase官方文档还特意提了不支持阿里云的mysql，其实文档标记一下，碰到这问题让大家使用环境变量MB_DB_CONNECTION_URI就可以了。
```
MB_DB_CONNECTION_URI=""jdbc:mysql://{IP}:3306/metabase?sessionVariables=sql_mode='STRICT_TRANS_TABLES'""
MB_DB_USER=""username""
MB_DB_PASS=""password""
```

"
2345066892,issue,closed,completed,We're maxing out fields at 255 characters in several places in the UI while our DB supports infinite text,"### Describe the bug

There are some sections where we're maxing out the text fields to 255 chars:
![image](https://github.com/metabase/metabase/assets/1711649/62d26ede-70c1-4497-b08c-1806bb0f5fe4)

The problem is that for many of those fields, the DB allows more/infinite characters

### To Reproduce

1) e.g. create a dashboard and use a long text
![image](https://github.com/metabase/metabase/assets/1711649/9ce3e7cb-579d-4d8e-bc49-62f23c6029a7)

2) see the limitation

3) check the DB, we're using text fields which are infinite in lenght

### Expected behavior

We should allow more text, even more if we're going to allow AI descriptions

### Logs

NA

### Information about your Metabase installation

```JSON
-v50, but this comes from before
```


### Severity

P2

### Additional context

NA",paoliniluis,2024-06-11 00:12:34+00:00,['kulyk'],2024-06-28 17:52:35+00:00,2024-06-28 14:33:49+00:00,https://github.com/metabase/metabase/issues/43983,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2172930856, 'issue_id': 2345066892, 'author': 'perivamsi', 'body': 'Bug or feature request?', 'created_at': datetime.datetime(2024, 6, 17, 9, 55, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2172988106, 'issue_id': 2345066892, 'author': 'paoliniluis', 'body': 'A customer we have is hitting this as a bug, that’s why I tagged it as such', 'created_at': datetime.datetime(2024, 6, 17, 10, 23, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2178936787, 'issue_id': 2345066892, 'author': 'perivamsi', 'body': 'My suggestion is to remove this restriction on [dashboard creation](https://github.com/metabase/metabase/blob/35f97092e09109b998e3f5b4678d06123bbd9793/frontend/src/metabase/dashboard/containers/CreateDashboardForm.tsx#L28) and [dashboard copying](https://github.com/metabase/metabase/blob/35f97092e09109b998e3f5b4678d06123bbd9793/frontend/src/metabase/dashboard/containers/CopyDashboardForm.tsx#L32).', 'created_at': datetime.datetime(2024, 6, 19, 15, 7, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2187132725, 'issue_id': 2345066892, 'author': 'cdeweyx', 'body': '[Thread](https://metaboat.slack.com/archives/C064QMXEV9N/p1718628995208319)', 'created_at': datetime.datetime(2024, 6, 24, 18, 9, 12, tzinfo=datetime.timezone.utc)}]","perivamsi on (2024-06-17 09:55:47 UTC): Bug or feature request?

paoliniluis (Issue Creator) on (2024-06-17 10:23:03 UTC): A customer we have is hitting this as a bug, that’s why I tagged it as such

perivamsi on (2024-06-19 15:07:31 UTC): My suggestion is to remove this restriction on [dashboard creation](https://github.com/metabase/metabase/blob/35f97092e09109b998e3f5b4678d06123bbd9793/frontend/src/metabase/dashboard/containers/CreateDashboardForm.tsx#L28) and [dashboard copying](https://github.com/metabase/metabase/blob/35f97092e09109b998e3f5b4678d06123bbd9793/frontend/src/metabase/dashboard/containers/CopyDashboardForm.tsx#L32).

cdeweyx on (2024-06-24 18:09:12 UTC): [Thread](https://metaboat.slack.com/archives/C064QMXEV9N/p1718628995208319)

"
2344934095,issue,closed,completed,Fields from Amazon Athena Tables / S3 Buckets Fail to sync if there is not an Underscore in the Table Name,"### Describe the bug

After connecting to Athena (S3 data source) the tables are all listed and they can all be queried from the native editor. However, when you attempt to access the table from the GUI editor you receive this error for some tables:

_No fields found for table ""accounts""._

Can confirm there are no fields in the metabase_fields table. The pattern seems to be that tables WITH an underscore in the title sync just fine. Tables without underscores in the title do not. This behavior only seems to occur if the data catalog is defined explicitly in the connection settings from within Metabase.

### To Reproduce

1. Set up Metabase v49.xx
2. Set up Athena using an S3 bucket as the data source with some sample files ([this lab ](https://github.com/paoliniluis/metabase-athena-glue) works great)
3. Some folders in the bucket should have an underscore in the name; others should not
4. Connect to Athena from Metabase (explicitly include the catalog in the connection config)
5. Look at Table Metadata
6. Note that tables with an underscore in the name have fields to be manage. Tables without an underscore do not.

### Expected behavior

Fields from the table should sync into Metabase so the GUI builder is functional.

### Logs

2024-06-10 17:12:29 2024-06-10 22:12:29,190 INFO sync.util :: STARTING: Sync metadata for athena Database 3 ''Athena''
2024-06-10 17:12:30 2024-06-10 22:12:30,036 INFO sync.util :: STARTING: step ''sync-dbms-version'' for athena Database 3 ''Athena''
2024-06-10 17:12:30 2024-06-10 22:12:30,040 INFO sync.util :: FINISHED: step ''sync-dbms-version'' for athena Database 3 ''Athena'' (3.4 ms)
2024-06-10 17:12:30 2024-06-10 22:12:30,040 INFO sync.util :: STARTING: step ''sync-timezone'' for athena Database 3 ''Athena''
2024-06-10 17:12:30 2024-06-10 22:12:30,041 INFO sync-metadata.sync-timezone :: :athena database 3 default timezone is nil
2024-06-10 17:12:30 2024-06-10 22:12:30,041 INFO sync.util :: FINISHED: step ''sync-timezone'' for athena Database 3 ''Athena'' (1.2 ms)
2024-06-10 17:12:30 2024-06-10 22:12:30,041 INFO sync.util :: STARTING: step ''sync-tables'' for athena Database 3 ''Athena''
2024-06-10 17:12:30 2024-06-10 22:12:30,056 INFO sync-metadata.tables :: Found new tables: (Table  ''s3-data-source.accounttest'' Table  ''s3-data-source.account_testunderscore'')
2024-06-10 17:12:30 2024-06-10 22:12:30,121 INFO sync-metadata.tables :: Updating table metadata for Table 30 ''s3-data-source.reviews''
2024-06-10 17:12:30 2024-06-10 22:12:30,122 INFO sync-metadata.tables :: Updating table metadata for Table 32 ''s3-data-source.account_testunderscore''
2024-06-10 17:12:30 2024-06-10 22:12:30,122 INFO sync-metadata.tables :: Updating table metadata for Table 31 ''s3-data-source.accounttest''
2024-06-10 17:12:30 2024-06-10 22:12:30,122 INFO sync-metadata.tables :: Updating table metadata for Table 29 ''s3-data-source.feedback''
2024-06-10 17:12:30 2024-06-10 22:12:30,122 INFO sync-metadata.tables :: Updating table metadata for Table 26 ''s3-data-source.invoices''
2024-06-10 17:12:30 2024-06-10 22:12:30,122 INFO sync-metadata.tables :: Updating table metadata for Table 27 ''s3-data-source.analytic_events''
2024-06-10 17:12:30 2024-06-10 22:12:30,122 INFO sync-metadata.tables :: Updating table metadata for Table 28 ''s3-data-source.accounts''
2024-06-10 17:12:30 2024-06-10 22:12:30,227 INFO sync.util :: FINISHED: step ''sync-tables'' for athena Database 3 ''Athena'' (185.1 ms)
2024-06-10 17:12:30 2024-06-10 22:12:30,227 INFO sync.util :: STARTING: step ''sync-fields'' for athena Database 3 ''Athena''
2024-06-10 17:12:31 2024-06-10 22:12:31,037 INFO sync.util :: FINISHED: step ''sync-fields'' for athena Database 3 ''Athena'' (809.9 ms)
2024-06-10 17:12:31 2024-06-10 22:12:31,037 INFO sync.util :: STARTING: step ''sync-fks'' for athena Database 3 ''Athena''
2024-06-10 17:12:31 2024-06-10 22:12:31,076 INFO sync.util :: FINISHED: step ''sync-fks'' for athena Database 3 ''Athena'' (38.6 ms)
2024-06-10 17:12:31 2024-06-10 22:12:31,076 INFO sync.util :: STARTING: step ''sync-indexes'' for athena Database 3 ''Athena''
2024-06-10 17:12:31 2024-06-10 22:12:31,076 INFO sync.util :: FINISHED: step ''sync-indexes'' for athena Database 3 ''Athena'' (144.4 µs)
2024-06-10 17:12:31 2024-06-10 22:12:31,076 INFO sync.util :: STARTING: step ''sync-metabase-metadata'' for athena Database 3 ''Athena''
2024-06-10 17:12:31 2024-06-10 22:12:31,077 INFO sync.util :: FINISHED: step ''sync-metabase-metadata'' for athena Database 3 ''Athena'' (677.5 µs)
2024-06-10 17:12:31 2024-06-10 22:12:31,077 INFO sync.util :: STARTING: step ''sync-table-privileges'' for athena Database 3 ''Athena''
2024-06-10 17:12:31 2024-06-10 22:12:31,077 INFO sync.util :: FINISHED: step ''sync-table-privileges'' for athena Database 3 ''Athena'' (103.3 µs)
2024-06-10 17:12:31 2024-06-10 22:12:31,127 INFO sync.util :: FINISHED: Sync metadata for athena Database 3 ''Athena'' (1.9 s)
2024-06-10 17:12:31 2024-06-10 22:12:31,128 INFO sync.util :: STARTING: Analyze data for athena Database 3 ''Athena''
2024-06-10 17:12:31 2024-06-10 22:12:31,133 INFO sync.util :: STARTING: step ''fingerprint-fields'' for athena Database 3 ''Athena''
2024-06-10 17:12:31 2024-06-10 22:12:31,169 INFO analyze.fingerprint :: Fingerprinting 15 fields in table Table 32 ''s3-data-source.account_testunderscore''
2024-06-10 17:12:33 2024-06-10 22:12:33,905 INFO sync.analyze :: fingerprint-fields Analyzed [******············································] 😞   14% Table 29 ''s3-data-source.feedback''
2024-06-10 17:12:33 2024-06-10 22:12:33,914 INFO sync.analyze :: fingerprint-fields Analyzed [*************·····································] 😒   27% Table 26 ''s3-data-source.invoices''
2024-06-10 17:12:33 2024-06-10 22:12:33,918 INFO sync.util :: FINISHED: step ''fingerprint-fields'' for athena Database 3 ''Athena'' (2.8 s)
2024-06-10 17:12:33 2024-06-10 22:12:33,918 INFO sync.util :: STARTING: step ''classify-fields'' for athena Database 3 ''Athena''
2024-06-10 17:12:34 2024-06-10 22:12:34,007 INFO sync.analyze :: classify-fields Analyzed [********************······························] 😐   41% Table 31 ''s3-data-source.accounttest''
2024-06-10 17:12:34 2024-06-10 22:12:34,013 INFO sync.analyze :: classify-fields Analyzed [***************************·······················] 😌   55% Table 27 ''s3-data-source.analytic_events''
2024-06-10 17:12:34 2024-06-10 22:12:34,016 INFO sync.util :: FINISHED: step ''classify-fields'' for athena Database 3 ''Athena'' (97.4 ms)
2024-06-10 17:12:34 2024-06-10 22:12:34,016 INFO sync.util :: STARTING: step ''classify-tables'' for athena Database 3 ''Athena''
2024-06-10 17:12:34 2024-06-10 22:12:34,024 INFO sync.analyze :: classify-tables Analyzed [**********************************················] 😏   68% Table 32 ''s3-data-source.account_testunderscore''
2024-06-10 17:12:34 2024-06-10 22:12:34,033 INFO sync.analyze :: classify-tables Analyzed [****************************************··········] 😊   82% Table 30 ''s3-data-source.reviews''
2024-06-10 17:12:34 2024-06-10 22:12:34,034 INFO sync.analyze :: classify-tables Analyzed [***********************************************···] 😍   95% Table 28 ''s3-data-source.accounts''
2024-06-10 17:12:34 2024-06-10 22:12:34,034 INFO sync.util :: FINISHED: step ''classify-tables'' for athena Database 3 ''Athena'' (17.8 ms)
2024-06-10 17:12:34 2024-06-10 22:12:34,075 INFO sync.util :: FINISHED: Analyze data for athena Database 3 ''Athena'' (2.9 s)

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.133.1-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres"",
      ""athena""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.22 (Debian 11.22-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-28"",
      ""tag"": ""v1.49.13"",
      ""hash"": ""de28e83""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Severe - there is a work around but it's not easy to diagnose

### Additional context

Note: I tested this with the above linked lab. I have not tried implementing this without using Glue.

Here is a walk through:
https://www.loom.com/share/af88c7ee1be74b2fa5151cf0b982c1f1",ixipixi,2024-06-10 22:12:39+00:00,['calherries'],2024-06-15 11:55:20+00:00,2024-06-14 18:26:23+00:00,https://github.com/metabase/metabase/issues/43980,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Administration/Metadata & Sync', ''), ('Database/Athena', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2161883030, 'issue_id': 2344934095, 'author': 'calherries', 'body': 'The issue is a bug in the athena JDBC driver.\r\n\r\nHere\'s a small repro in Clojure using `.getColumns`:\r\n\r\n```clojure\r\n(require \'[metabase.test :as mt])\r\n(require \'[clojure.test :refer :all])\r\n(let [get-columns (fn [{:keys [table-name catalog]}]\r\n                    (let [details (merge secrets\r\n                                         {:region ""us-east-1"",\r\n                                          :workgroup ""primary"",\r\n                                          :s3_staging_dir ""s3://athena-metabase-results-test"",\r\n                                          :catalog catalog,\r\n                                          :advanced-options false})\r\n                          schema     ""s3-data-source""]\r\n                      (sql-jdbc.execute/do-with-connection-with-options\r\n                       :athena\r\n                       (sql-jdbc.conn/connection-details->spec :athena details)\r\n                       nil\r\n                       (fn [^Connection conn]\r\n                         (let [metadata (.getMetaData conn)]\r\n                           (with-open [rs (.getColumns metadata catalog schema table-name nil)]\r\n                             (jdbc/metadata-result rs)))))))]\r\n  ;; when a catalog is specified, it returns 0 columns\r\n  (is (= 0 (count (get-columns {:table-name ""accounttest"", :catalog ""AwsDataCatalog""}))))\r\n  ;; when no catalog is specified, it returns columns\r\n  (is (= 15 (count (get-columns {:table-name ""accounttest"", :catalog nil}))))\r\n  ;; when table name has underscores and a catalog is specified, it returns columns\r\n  (is (= 15 (count (get-columns {:table-name ""account_testunderscore"", :catalog ""AwsDataCatalog""})))))\r\n```\r\n\r\nAthena\'s JDBC driver is closed-source so we can\'t diagnose why this is happening. But, we can workaround it by using system tables. This returns the expected columns:\r\n```clojure\r\n(let [schema     ""s3-data-source""\r\n      table-name ""accounttest""\r\n      catalog    ""AwsDataCatalog""\r\n      details (merge secrets\r\n                     {:region ""us-east-1"",\r\n                      :workgroup ""primary"",\r\n                      :s3_staging_dir ""s3://athena-metabase-results-test"",\r\n                      :catalog catalog,\r\n                      :advanced-options false})\r\n      query (str ""SELECT * FROM information_schema.columns WHERE table_name = \'"" table-name ""\' AND table_schema = \'"" schema ""\' AND table_catalog = \'"" (u/lower-case-en catalog) ""\'"")]\r\n  (jdbc/query (sql-jdbc.conn/connection-details->spec :athena details) query))\r\n```', 'created_at': datetime.datetime(2024, 6, 12, 1, 21, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166965880, 'issue_id': 2344934095, 'author': 'calherries', 'body': 'I narrowed down the cause to the lack of a ""athena:GetTableMetadata"" permission in the IAM policy. \r\n\r\nIf the IAM policy includes the [GetTableMetadata action](https://docs.aws.amazon.com/athena/latest/APIReference/API_GetTableMetadata.html), the `.getColumns` call returns the expected columns in all cases. If not, then it only returns the expected columns if the table name has underscores, or the `catalog` argument is left as null. How strange!\r\n\r\nThis diff in the IAM policy JSON demonstrates the difference:\r\n```\r\n@@ -1,85 +1,84 @@\r\n{\r\n  ""Version"": ""2012-10-17"",\r\n  ""Statement"": [\r\n      {\r\n          ""Sid"": ""VisualEditor0"",\r\n          ""Effect"": ""Allow"",\r\n          ""Action"": [\r\n              ""glue:BatchCreatePartition"",\r\n              ""athena:StartQueryExecution"",\r\n              ""athena:ListDataCatalogs"",\r\n              ""glue:DeleteDatabase"",\r\n              ""glue:GetTableVersions"",\r\n              ""glue:GetPartitions"",\r\n              ""glue:BatchDeletePartition"",\r\n              ""glue:UpdateTable"",\r\n              ""athena:GetQueryResults"",\r\n              ""glue:DeleteTable"",\r\n              ""athena:ListWorkGroups"",\r\n              ""athena:DeletePreparedStatement"",\r\n              ""athena:GetNamedQuery"",\r\n              ""athena:ListQueryExecutions"",\r\n              ""athena:GetWorkGroup"",\r\n              ""glue:GetTableVersion"",\r\n              ""athena:StopQueryExecution"",\r\n              ""glue:CreatePartition"",\r\n              ""glue:UpdatePartition"",\r\n              ""athena:CreatePreparedStatement"",\r\n              ""glue:UpdateDatabase"",\r\n              ""athena:GetQueryResultsStream"",\r\n              ""glue:CreateTable"",\r\n              ""glue:GetTables"",\r\n              ""glue:BatchGetPartition"",\r\n              ""glue:GetDatabases"",\r\n              ""athena:GetPreparedStatement"",\r\n              ""athena:ListTagsForResource"",\r\n              ""glue:GetTable"",\r\n              ""athena:ListNamedQueries"",\r\n              ""glue:GetDatabase"",\r\n              ""glue:GetPartition"",\r\n              ""athena:ListDatabases"",\r\n              ""glue:CreateDatabase"",\r\n              ""athena:GetQueryExecution"",\r\n              ""glue:BatchDeleteTable"",\r\n              ""athena:BatchGetNamedQuery"",\r\n              ""athena:ListTableMetadata"",\r\n              ""glue:DeletePartition"",\r\n              [-""athena:BatchGetQueryExecution"",-]\r\n[-                ""athena:GetTableMetadata""-]{+""athena:BatchGetQueryExecution""+}\r\n          ],\r\n          ""Resource"": ""*""\r\n      },\r\n      {\r\n          ""Sid"": ""VisualEditor1"",\r\n          ""Effect"": ""Allow"",\r\n          ""Action"": [\r\n              ""s3:GetObject"",\r\n              ""s3:DeleteObjectVersion"",\r\n              ""s3:ListBucket"",\r\n              ""s3:DeleteObject"",\r\n              ""s3:GetBucketLocation""\r\n          ],\r\n          ""Resource"": [\r\n              ""arn:aws:s3:::metabase-ci-athena-data/*"",\r\n              ""arn:aws:s3:::metabase-ci-athena-results/*"",\r\n              ""arn:aws:s3:::metabase-ci-athena-data"",\r\n              ""arn:aws:s3:::metabase-ci-athena-results""\r\n          ]\r\n      },\r\n      {\r\n          ""Sid"": ""VisualEditor2"",\r\n          ""Effect"": ""Allow"",\r\n          ""Action"": [\r\n              ""s3:PutObject"",\r\n              ""s3:GetObject"",\r\n              ""s3:AbortMultipartUpload"",\r\n              ""s3:ListBucket"",\r\n              ""s3:GetBucketLocation""\r\n          ],\r\n          ""Resource"": [\r\n              ""arn:aws:s3:::metabase-ci-athena-results/*"",\r\n              ""arn:aws:s3:::metabase-ci-athena-results""\r\n          ]\r\n      }\r\n  ]\r\n}\r\n\r\n```', 'created_at': datetime.datetime(2024, 6, 13, 23, 45, 19, tzinfo=datetime.timezone.utc)}]","calherries (Assginee) on (2024-06-12 01:21:29 UTC): The issue is a bug in the athena JDBC driver.

Here's a small repro in Clojure using `.getColumns`:

```clojure
(require '[metabase.test :as mt])
(require '[clojure.test :refer :all])
(let [get-columns (fn [{:keys [table-name catalog]}]
                    (let [details (merge secrets
                                         {:region ""us-east-1"",
                                          :workgroup ""primary"",
                                          :s3_staging_dir ""s3://athena-metabase-results-test"",
                                          :catalog catalog,
                                          :advanced-options false})
                          schema     ""s3-data-source""]
                      (sql-jdbc.execute/do-with-connection-with-options
                       :athena
                       (sql-jdbc.conn/connection-details->spec :athena details)
                       nil
                       (fn [^Connection conn]
                         (let [metadata (.getMetaData conn)]
                           (with-open [rs (.getColumns metadata catalog schema table-name nil)]
                             (jdbc/metadata-result rs)))))))]
  ;; when a catalog is specified, it returns 0 columns
  (is (= 0 (count (get-columns {:table-name ""accounttest"", :catalog ""AwsDataCatalog""}))))
  ;; when no catalog is specified, it returns columns
  (is (= 15 (count (get-columns {:table-name ""accounttest"", :catalog nil}))))
  ;; when table name has underscores and a catalog is specified, it returns columns
  (is (= 15 (count (get-columns {:table-name ""account_testunderscore"", :catalog ""AwsDataCatalog""})))))
```

Athena's JDBC driver is closed-source so we can't diagnose why this is happening. But, we can workaround it by using system tables. This returns the expected columns:
```clojure
(let [schema     ""s3-data-source""
      table-name ""accounttest""
      catalog    ""AwsDataCatalog""
      details (merge secrets
                     {:region ""us-east-1"",
                      :workgroup ""primary"",
                      :s3_staging_dir ""s3://athena-metabase-results-test"",
                      :catalog catalog,
                      :advanced-options false})
      query (str ""SELECT * FROM information_schema.columns WHERE table_name = '"" table-name ""' AND table_schema = '"" schema ""' AND table_catalog = '"" (u/lower-case-en catalog) ""'"")]
  (jdbc/query (sql-jdbc.conn/connection-details->spec :athena details) query))
```

calherries (Assginee) on (2024-06-13 23:45:19 UTC): I narrowed down the cause to the lack of a ""athena:GetTableMetadata"" permission in the IAM policy. 

If the IAM policy includes the [GetTableMetadata action](https://docs.aws.amazon.com/athena/latest/APIReference/API_GetTableMetadata.html), the `.getColumns` call returns the expected columns in all cases. If not, then it only returns the expected columns if the table name has underscores, or the `catalog` argument is left as null. How strange!

This diff in the IAM policy JSON demonstrates the difference:
```
@@ -1,85 +1,84 @@
{
  ""Version"": ""2012-10-17"",
  ""Statement"": [
      {
          ""Sid"": ""VisualEditor0"",
          ""Effect"": ""Allow"",
          ""Action"": [
              ""glue:BatchCreatePartition"",
              ""athena:StartQueryExecution"",
              ""athena:ListDataCatalogs"",
              ""glue:DeleteDatabase"",
              ""glue:GetTableVersions"",
              ""glue:GetPartitions"",
              ""glue:BatchDeletePartition"",
              ""glue:UpdateTable"",
              ""athena:GetQueryResults"",
              ""glue:DeleteTable"",
              ""athena:ListWorkGroups"",
              ""athena:DeletePreparedStatement"",
              ""athena:GetNamedQuery"",
              ""athena:ListQueryExecutions"",
              ""athena:GetWorkGroup"",
              ""glue:GetTableVersion"",
              ""athena:StopQueryExecution"",
              ""glue:CreatePartition"",
              ""glue:UpdatePartition"",
              ""athena:CreatePreparedStatement"",
              ""glue:UpdateDatabase"",
              ""athena:GetQueryResultsStream"",
              ""glue:CreateTable"",
              ""glue:GetTables"",
              ""glue:BatchGetPartition"",
              ""glue:GetDatabases"",
              ""athena:GetPreparedStatement"",
              ""athena:ListTagsForResource"",
              ""glue:GetTable"",
              ""athena:ListNamedQueries"",
              ""glue:GetDatabase"",
              ""glue:GetPartition"",
              ""athena:ListDatabases"",
              ""glue:CreateDatabase"",
              ""athena:GetQueryExecution"",
              ""glue:BatchDeleteTable"",
              ""athena:BatchGetNamedQuery"",
              ""athena:ListTableMetadata"",
              ""glue:DeletePartition"",
              [-""athena:BatchGetQueryExecution"",-]
[-                ""athena:GetTableMetadata""-]{+""athena:BatchGetQueryExecution""+}
          ],
          ""Resource"": ""*""
      },
      {
          ""Sid"": ""VisualEditor1"",
          ""Effect"": ""Allow"",
          ""Action"": [
              ""s3:GetObject"",
              ""s3:DeleteObjectVersion"",
              ""s3:ListBucket"",
              ""s3:DeleteObject"",
              ""s3:GetBucketLocation""
          ],
          ""Resource"": [
              ""arn:aws:s3:::metabase-ci-athena-data/*"",
              ""arn:aws:s3:::metabase-ci-athena-results/*"",
              ""arn:aws:s3:::metabase-ci-athena-data"",
              ""arn:aws:s3:::metabase-ci-athena-results""
          ]
      },
      {
          ""Sid"": ""VisualEditor2"",
          ""Effect"": ""Allow"",
          ""Action"": [
              ""s3:PutObject"",
              ""s3:GetObject"",
              ""s3:AbortMultipartUpload"",
              ""s3:ListBucket"",
              ""s3:GetBucketLocation""
          ],
          ""Resource"": [
              ""arn:aws:s3:::metabase-ci-athena-results/*"",
              ""arn:aws:s3:::metabase-ci-athena-results""
          ]
      }
  ]
}

```

"
2344793158,issue,closed,completed,show tooltip on hover,,EmmadUsmani,2024-06-10 20:43:42+00:00,['EmmadUsmani'],2024-06-28 00:43:33+00:00,2024-06-28 00:43:32+00:00,https://github.com/metabase/metabase/issues/43974,[],"[{'comment_id': 2195885645, 'issue_id': 2344793158, 'author': 'EmmadUsmani', 'body': 'Implemented in https://github.com/metabase/metabase/pull/43555/commits/d0385d1916613d9e7811420de20c77d1919146fd', 'created_at': datetime.datetime(2024, 6, 28, 0, 43, 32, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-28 00:43:32 UTC): Implemented in https://github.com/metabase/metabase/pull/43555/commits/d0385d1916613d9e7811420de20c77d1919146fd

"
2344783147,issue,closed,completed,Fix dashboard cards not rendering in static dashboard unit tests,"See unit tests in https://github.com/metabase/metabase/pull/43859 for examples of this issue.

- There is a condition in `DashboardGridConnected.tsx` where we do not render the grid when the width is 0. I saw you manually passed width={0} in the `PublicOrEmbeddedDashboard.tsx`, but the ExplicitSize HoC is supposed to provide the width - but it does not in the unit test. Do we need to mock it somehow?
- When I forced the width prop to be something else, the loading spinner never goes away and the test fails due to `waitForLoaderToBeRemoved` throwing. Do we need to dispatch some action first?",heypoom,2024-06-10 20:36:57+00:00,['heypoom'],2024-06-12 15:34:30+00:00,2024-06-12 15:34:30+00:00,https://github.com/metabase/metabase/issues/43973,"[('.CI & Tests', ''), ('Embedding/Static', 'Static embedding, previously known as signed embedding')]","[{'comment_id': 2161255222, 'issue_id': 2344783147, 'author': 'heypoom', 'body': 'Getting a console.error message about minWidth/maxWidth in the unit test, to try to fix tomorrow', 'created_at': datetime.datetime(2024, 6, 11, 17, 16, 40, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2024-06-11 17:16:40 UTC): Getting a console.error message about minWidth/maxWidth in the unit test, to try to fix tomorrow

"
2344759590,issue,closed,completed,"Do not register any JWT claim as user attribute: `iss`, `sub`, `aud`, `exp`, `nbf`, `iat`, `jti`",,noahmoss,2024-06-10 20:22:16+00:00,['noahmoss'],2024-10-08 17:07:43+00:00,2024-06-13 19:10:55+00:00,https://github.com/metabase/metabase/issues/43971,[],[],
2344662604,issue,closed,completed,"add ""auto-connected"" info to cards which were automatically wired","Show ""auto-connected"" text wtih an icon

<img width=""944"" alt=""image"" src=""https://github.com/metabase/metabase/assets/125459446/74fa9a4e-285d-4320-b430-aa3bf8fc96d6"">
",uladzimirdev,2024-06-10 19:19:40+00:00,['uladzimirdev'],2024-06-19 13:57:33+00:00,2024-06-19 13:57:33+00:00,https://github.com/metabase/metabase/issues/43964,[],[],
2344627778,issue,closed,completed,render chart with responsive sizing,,EmmadUsmani,2024-06-10 18:58:42+00:00,['EmmadUsmani'],2024-06-10 20:12:47+00:00,2024-06-10 20:12:47+00:00,https://github.com/metabase/metabase/issues/43961,[],"[{'comment_id': 2159201556, 'issue_id': 2344627778, 'author': 'EmmadUsmani', 'body': 'Completed in https://github.com/metabase/metabase/pull/43969/commits/68abfcb73c5534e38e7424e25aa8b84720e551f9', 'created_at': datetime.datetime(2024, 6, 10, 20, 12, 47, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-10 20:12:47 UTC): Completed in https://github.com/metabase/metabase/pull/43969/commits/68abfcb73c5534e38e7424e25aa8b84720e551f9

"
2344613926,issue,closed,completed,Use skeleton loader in Browse models sidenav,per discussion here: https://metaboat.slack.com/archives/C06REDHM6BV/p1718032879581939,rafpaf,2024-06-10 18:51:33+00:00,['rafpaf'],2024-06-12 19:16:37+00:00,2024-06-12 19:16:37+00:00,https://github.com/metabase/metabase/issues/43960,[],[],
2344482857,issue,open,,[Epic] Query validator,"[Product doc](https://www.notion.so/metabase/Query-validator-a8981d498f324da5acf9284e7d7ba2f6)


```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/issues/44976
- [ ] https://github.com/metabase/metabase/issues/45546
- [ ] https://github.com/metabase/metabase/issues/46881
- [ ] https://github.com/metabase/metabase/issues/46929
- [ ] https://github.com/metabase/metabase/issues/47939
```
",luizarakaki,2024-06-10 17:37:48+00:00,[],2024-10-03 01:27:52+00:00,,https://github.com/metabase/metabase/issues/43953,"[('.Epic', 'Feature Implementation or Project'), ('.Team/Workflows', 'aka BEC'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2344430940,issue,open,,Driver: Connection Impersonation: Athena,"**Is your feature request related to a problem? Please describe.**
A way to use impersonation in Athena

**Describe the solution you'd like**
Just that

**Describe alternatives you've considered**
NA

**How important is this feature to you?**
Requested by a lead

**Additional context**
They're using Athena + Synapse
",paoliniluis,2024-06-10 17:08:44+00:00,[],2025-02-04 20:30:45+00:00,,https://github.com/metabase/metabase/issues/43950,"[('Type:New Feature', ''), ('Database/Athena', ''), ('Administration/Impersonation', 'Role level security')]",[],
2344329500,issue,closed,not_planned,Migrated metrics are not visualized on a dashboard,"_edit: Moved to P2 because this only applies to our internal instance. The migration was fixed afterwards_

### Describe the bug

When opening a picker to add something to a dashboard the migrated v1 metrics are not visualized correctly

### To Reproduce

1. Open / create a dashboard
2. Hit plus button to add a card
3. Search for any migrated v1 metric, like Average First Resolution Time (minutes)
4. See the card added with text ""Which fields do you want to use for the X and Y axes?"" instead of the correct viz


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```


### Severity

Breaks major use cases

### Additional context

_No response_",mngr,2024-06-10 16:13:54+00:00,[],2025-01-16 20:08:09+00:00,2025-01-16 20:08:09+00:00,https://github.com/metabase/metabase/issues/43944,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/Querying', ''), ('Querying/Metrics', 'v2'), ('Semantic Model', '')]","[{'comment_id': 2177208396, 'issue_id': 2344329500, 'author': 'paoliniluis', 'body': 'Same happens if you do:\r\n- new query: orders join with people join with orders (again)\r\n- save it as a model\r\n- do an x-ray of this\r\n\r\n![image](https://github.com/metabase/metabase/assets/1711649/04fc543c-bb6a-48cd-ab60-6da3b1a917f1)', 'created_at': datetime.datetime(2024, 6, 18, 22, 43, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2231696847, 'issue_id': 2344329500, 'author': 'luizarakaki', 'body': 'Moved to P2 as this affects only our internal instance.', 'created_at': datetime.datetime(2024, 7, 16, 19, 37, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2231868840, 'issue_id': 2344329500, 'author': 'perivamsi', 'body': 'Created https://github.com/metabase/metabase/issues/45685 for the x-rays issue', 'created_at': datetime.datetime(2024, 7, 16, 21, 37, 51, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-18 22:43:50 UTC): Same happens if you do:
- new query: orders join with people join with orders (again)
- save it as a model
- do an x-ray of this

![image](https://github.com/metabase/metabase/assets/1711649/04fc543c-bb6a-48cd-ab60-6da3b1a917f1)

luizarakaki on (2024-07-16 19:37:51 UTC): Moved to P2 as this affects only our internal instance.

perivamsi on (2024-07-16 21:37:51 UTC): Created https://github.com/metabase/metabase/issues/45685 for the x-rays issue

"
2344304113,issue,closed,completed,Metrics with filters on implicitly joined columns produce query error when added in a Summarize block,"### Describe the bug

If a metric definition includes a filter for an implicitly joined column, when added in a Summarize block, the metric breaks the query with an error


### To Reproduce

1. New metric
2. Select Orders in data picker
3. Add filter Product -> Category is Gadget
4. Summarize Count by Created At: Month
5. Save
6. New question
7. Select Orders in data picker
8. Choose your saved metric from the Common metrics
9. Hit Visualize
10. See error `Cannot determine the source table or query for Field clause [:field 16 {:base-type :type/Text, :source-field 10, :join-alias ""PRODUCTS__via__PRODUCT_ID"", :metabase.query-processor.middleware.escape-join-aliases/join-alias nil}]`


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```


### Severity

breaks one of use cases

### Additional context

_No response_",mngr,2024-06-10 16:04:11+00:00,['snoe'],2024-08-28 02:09:53+00:00,2024-06-11 22:12:53+00:00,https://github.com/metabase/metabase/issues/43943,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2344211488,issue,open,,Make the data picker wider when needed to fit long content,"## Big resource names are hard to see in the Popover
![image](https://github.com/metabase/metabase/assets/11581684/336d37ec-777f-4e6d-8d82-29b4eee93865)

So would be nice if I could resize it.

This screenshot was taken in the question creation page, in the **Saved Questions** popover when searching.

My suggestion is to add a `resize: horizontal` to the Popover body. It solved the problem for me.",gdsc0301,2024-06-10 15:29:50+00:00,[],2025-02-04 20:31:04+00:00,,https://github.com/metabase/metabase/issues/43939,"[('.CSS', ''), ('Type:New Feature', ''), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('Organization/Entity picker', '')]",[],
2344132041,issue,closed,completed,[Flaky Test]: tag dimension should default to string/contains for a new high cardinality string field filter,"Last Flake: https://github.com/metabase/metabase/actions/runs/9421622574
Last Flake Time: 2024-06-07T12:00:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-10 14:53:17+00:00,[],2024-07-30 14:51:38+00:00,2024-07-30 14:51:38+00:00,https://github.com/metabase/metabase/issues/43938,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2231387906, 'issue_id': 2344132041, 'author': 'iethree', 'body': 'still flaking a lot: https://github.com/metabase/metabase/actions/runs/9957930568/job/27511091587?pr=45643#step:6:1124', 'created_at': datetime.datetime(2024, 7, 16, 16, 49, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2231826707, 'issue_id': 2344132041, 'author': 'iethree', 'body': 'flake on master: https://github.com/metabase/metabase/actions/runs/9963360395/job/27530375483#step:5:1128', 'created_at': datetime.datetime(2024, 7, 16, 21, 4, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2233644547, 'issue_id': 2344132041, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9965162542\nLast Flake Time: 2024-07-16T15:47:00-07:00\nFlakes in the last day: 2\nFlakes in the last 3d: 9\nFlakes in the last 7d: 17', 'created_at': datetime.datetime(2024, 7, 17, 15, 50, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2233646663, 'issue_id': 2344132041, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9965162542\nLast Flake Time: 2024-07-16T15:47:00-07:00\nFlakes in the last day: 2\nFlakes in the last 3d: 9\nFlakes in the last 7d: 17', 'created_at': datetime.datetime(2024, 7, 17, 15, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2258547117, 'issue_id': 2344132041, 'author': 'nemanjaglumac', 'body': 'Fixed by https://github.com/metabase/metabase/pull/45978.', 'created_at': datetime.datetime(2024, 7, 30, 14, 51, 38, tzinfo=datetime.timezone.utc)}]","iethree on (2024-07-16 16:49:33 UTC): still flaking a lot: https://github.com/metabase/metabase/actions/runs/9957930568/job/27511091587?pr=45643#step:6:1124

iethree on (2024-07-16 21:04:52 UTC): flake on master: https://github.com/metabase/metabase/actions/runs/9963360395/job/27530375483#step:5:1128

github-automation-metabase (Issue Creator) on (2024-07-17 15:50:01 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9965162542
Last Flake Time: 2024-07-16T15:47:00-07:00
Flakes in the last day: 2
Flakes in the last 3d: 9
Flakes in the last 7d: 17

github-automation-metabase (Issue Creator) on (2024-07-17 15:51:00 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9965162542
Last Flake Time: 2024-07-16T15:47:00-07:00
Flakes in the last day: 2
Flakes in the last 3d: 9
Flakes in the last 7d: 17

nemanjaglumac on (2024-07-30 14:51:38 UTC): Fixed by https://github.com/metabase/metabase/pull/45978.

"
2344132007,issue,closed,completed,[Flaky Test]: tag dimension should default to number/= for a new numeric field filter,"Last Flake: https://github.com/metabase/metabase/actions/runs/9422395340
Last Flake Time: 2024-06-07T13:16:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-10 14:53:16+00:00,[],2024-07-30 14:52:15+00:00,2024-07-30 14:52:15+00:00,https://github.com/metabase/metabase/issues/43937,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2165797467, 'issue_id': 2344132007, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9488063197\nLast Flake Time: 2024-06-12T12:11:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 2\nFlakes in the last 7d: 3', 'created_at': datetime.datetime(2024, 6, 13, 14, 12, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2167641699, 'issue_id': 2344132007, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9498293569\nLast Flake Time: 2024-06-13T04:08:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 2\nFlakes in the last 7d: 5', 'created_at': datetime.datetime(2024, 6, 14, 9, 34, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2178799327, 'issue_id': 2344132007, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9569015651\nLast Flake Time: 2024-06-18T10:15:00-07:00\nFlakes in the last day: 2\nFlakes in the last 3d: 3\nFlakes in the last 7d: 6', 'created_at': datetime.datetime(2024, 6, 19, 14, 2, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2258548617, 'issue_id': 2344132007, 'author': 'nemanjaglumac', 'body': 'Fixed by https://github.com/metabase/metabase/pull/45978', 'created_at': datetime.datetime(2024, 7, 30, 14, 52, 15, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-13 14:12:58 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9488063197
Last Flake Time: 2024-06-12T12:11:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 2
Flakes in the last 7d: 3

github-automation-metabase (Issue Creator) on (2024-06-14 09:34:47 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9498293569
Last Flake Time: 2024-06-13T04:08:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 2
Flakes in the last 7d: 5

github-automation-metabase (Issue Creator) on (2024-06-19 14:02:26 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9569015651
Last Flake Time: 2024-06-18T10:15:00-07:00
Flakes in the last day: 2
Flakes in the last 3d: 3
Flakes in the last 7d: 6

nemanjaglumac on (2024-07-30 14:52:15 UTC): Fixed by https://github.com/metabase/metabase/pull/45978

"
2344131971,issue,closed,completed,[Flaky Test]: scenarios > visualizations > line/bar chart > tooltips > single series question grouped by month on dashboard should not show percent change when previous month is missing from result data,"Last Flake: https://github.com/metabase/metabase/actions/runs/9437892268
Last Flake Time: 2024-06-09T09:51:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-10 14:53:15+00:00,"['alxnddr', 'nemanjaglumac']",2024-10-08 17:08:09+00:00,2024-06-11 14:09:25+00:00,https://github.com/metabase/metabase/issues/43936,"[('.CI & Tests', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('flaky-test-fix', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2344131940,issue,closed,not_planned,[Flaky Test]: check-can-connect-before-sync-test,"Last Flake: https://github.com/metabase/metabase/actions/runs/9429695622
Last Flake Time: 2024-06-08T09:03:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-10 14:53:14+00:00,[],2024-12-13 16:43:38+00:00,2024-12-13 16:43:38+00:00,https://github.com/metabase/metabase/issues/43935,"[('.CI & Tests', ''), ('.Backend', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2344131842,issue,closed,completed,[Flaky Test]: should prevent saving new and updating existing models without result_metadata (metabase#37009),"Last Flake: https://github.com/metabase/metabase/actions/runs/9426004442
Last Flake Time: 2024-06-09T22:21:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 5
Flakes in the last 7d: 5",github-automation-metabase,2024-06-10 14:53:12+00:00,[],2024-07-26 08:21:35+00:00,2024-07-26 08:21:35+00:00,https://github.com/metabase/metabase/issues/43934,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2252224740, 'issue_id': 2344131842, 'author': 'nemanjaglumac', 'body': 'Fixed by #46038', 'created_at': datetime.datetime(2024, 7, 26, 8, 21, 35, tzinfo=datetime.timezone.utc)}]","nemanjaglumac on (2024-07-26 08:21:35 UTC): Fixed by #46038

"
2343914029,issue,closed,completed,Slack/Email Exportation Inconsistencies,"### Describe the bug

There are two issues related to the Slack/Email export functionality:

	1.	Visual Bug: The type of the chart exported to Slack/Email does not match the type specified in the editor. In the editor, I am using a Line chart with a smooth style (as shown in the screenshot). However, the exported chart in Slack appears with hard lines.
	2.	Data Inconsistency: The data displayed in the editor does not match the data exported to Slack. The screenshot clearly shows this discrepancy.

### To Reproduce

1.	Create a Line chart in the editor with a smooth style.
2.	Export the chart to Slack/Email.
3.	Compare the chart type and data between the editor and Slack/Email export.

### Expected behavior

•	The exported chart in Slack/Email should match the Line chart with smooth style as seen in the editor.
•	The data exported to Slack/Email should be consistent with the data displayed in the editor.

### Logs

```
[247d9ff0-ce4d-4eac-98cf-3aad002a9d97] 2024-06-10T10:00:00-03:00 INFO metabase.task.send-pulses Sending scheduled pulses...
[247d9ff0-ce4d-4eac-98cf-3aad002a9d97] 2024-06-10T10:00:00-03:00 INFO metabase.query-processor.card Question's average execution duration is 2.1 s; using 'magic' TTL of 21.0 s 💾
[247d9ff0-ce4d-4eac-98cf-3aad002a9d97] 2024-06-10T10:00:01-03:00 INFO metabase.query-processor.middleware.cache Query took 1.7 s to run; minimum for cache eligibility is 60.0 s; not eligible
[247d9ff0-ce4d-4eac-98cf-3aad002a9d97] 2024-06-10T10:00:02-03:00 INFO metabase.query-processor.card Question's average execution duration is 2.6 s; using 'magic' TTL of 26.0 s 💾
[247d9ff0-ce4d-4eac-98cf-3aad002a9d97] 2024-06-10T10:00:04-03:00 INFO metabase.query-processor.middleware.cache Query took 2.2 s to run; minimum for cache eligibility is 60.0 s; not eligible


```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.153-100.162.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""13.15 (Debian 13.15-1.pgdg120+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-05"",
      ""tag"": ""v0.49.14"",
      ""hash"": ""3606ed3""
    },
    ""settings"": {
      ""report-timezone"": ""America/New_York""
    }
  }
}
```


### Severity

This issue is blocking our usage of Metabase entirely. 

### Additional context



Data Table:
<img width=""374"" alt=""image"" src=""https://github.com/metabase/metabase/assets/59780143/ff1ae24d-7215-4317-9a07-c7c26c73e5f0"">


Preview Editor:

<img width=""324"" alt=""image"" src=""https://github.com/metabase/metabase/assets/59780143/3d511c45-ab71-4083-af9c-10ca9f31e36d"">

Preview Editor:
<img width=""1294"" alt=""image"" src=""https://github.com/metabase/metabase/assets/59780143/6ffc96fa-24a3-4480-8a5e-c6500f601488"">


Slack Output:
<img width=""916"" alt=""image"" src=""https://github.com/metabase/metabase/assets/59780143/c1b9e042-2b61-4efe-a7c8-3073982cfb14"">


",stwonary,2024-06-10 13:21:04+00:00,['adam-james-v'],2024-06-13 20:28:52+00:00,2024-06-13 15:31:56+00:00,https://github.com/metabase/metabase/issues/43927,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('Notifications/Slack', ''), ('Visualization/Static', 'Subscriptions/pulse generated image'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2166017597, 'issue_id': 2343914029, 'author': 'adam-james-v', 'body': ""Hi @stwonary , thanks for creating this issue.\r\nI've noticed that you're running Metabase 49.\r\nWe've put in lots of effort to improve our subscription's visualizations in v50 and these 2 concerns of yours are addressed in that version.\r\n\r\nIf you're able to update to v50, that will be your best option.\r\n\r\nIf you need to stay on 49, here are some things you can try to help make your subscription look a bit closer to what you are expecting:\r\n\r\n- for each series in the visualization, explicitly set the axis position to 'left':\r\n![image](https://github.com/metabase/metabase/assets/21064735/e640e65d-7012-49aa-9cfb-a5ff7341f693)\r\n- turn OFF the auto split y-axis feature.\r\n![image](https://github.com/metabase/metabase/assets/21064735/2d910228-9028-49be-a9cb-d6bb577ab64e)\r\n\r\n\r\nThese should at the very least make the data look more correct. The reason it appears wrong is (at least in part) related to the fact that in the subscription's render, the Y-axis is being 'auto-split' and has a different scale. Since it's hard to see which series is associated with either axis, the data looks wrong at a glance. You are correct to point out that this is not great, and is why we've made changes in 50!\r\n\r\nSince this is addressed in 50, and is fixed alongside a larger set of changes, I'm closing this since the fix won't be in 49. \r\nI hope you're able to either update or successfully work around the issue!"", 'created_at': datetime.datetime(2024, 6, 13, 15, 31, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166436814, 'issue_id': 2343914029, 'author': 'stwonary', 'body': 'Hi @adam-james-v, thank you for your response. I can confirm that it is fixed in version v50.', 'created_at': datetime.datetime(2024, 6, 13, 17, 49, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166708024, 'issue_id': 2343914029, 'author': 'adam-james-v', 'body': 'Happy to hear that worked for you :)', 'created_at': datetime.datetime(2024, 6, 13, 20, 28, 51, tzinfo=datetime.timezone.utc)}]","adam-james-v (Assginee) on (2024-06-13 15:31:56 UTC): Hi @stwonary , thanks for creating this issue.
I've noticed that you're running Metabase 49.
We've put in lots of effort to improve our subscription's visualizations in v50 and these 2 concerns of yours are addressed in that version.

If you're able to update to v50, that will be your best option.

If you need to stay on 49, here are some things you can try to help make your subscription look a bit closer to what you are expecting:

- for each series in the visualization, explicitly set the axis position to 'left':
![image](https://github.com/metabase/metabase/assets/21064735/e640e65d-7012-49aa-9cfb-a5ff7341f693)
- turn OFF the auto split y-axis feature.
![image](https://github.com/metabase/metabase/assets/21064735/2d910228-9028-49be-a9cb-d6bb577ab64e)


These should at the very least make the data look more correct. The reason it appears wrong is (at least in part) related to the fact that in the subscription's render, the Y-axis is being 'auto-split' and has a different scale. Since it's hard to see which series is associated with either axis, the data looks wrong at a glance. You are correct to point out that this is not great, and is why we've made changes in 50!

Since this is addressed in 50, and is fixed alongside a larger set of changes, I'm closing this since the fix won't be in 49. 
I hope you're able to either update or successfully work around the issue!

stwonary (Issue Creator) on (2024-06-13 17:49:28 UTC): Hi @adam-james-v, thank you for your response. I can confirm that it is fixed in version v50.

adam-james-v (Assginee) on (2024-06-13 20:28:51 UTC): Happy to hear that worked for you :)

"
2343832759,issue,open,,Simplify loading/error handling,,rafpaf,2024-06-10 12:48:52+00:00,['rafpaf'],2024-10-02 23:58:20+00:00,,https://github.com/metabase/metabase/issues/43926,[],[],
2343282608,issue,closed,completed,[ParseSQL] Prepare for the release,"**Implementation Plan**


```[tasklist]
### Tasks
- [ ] #43516
- [ ] #44118
- [ ] https://github.com/metabase/macaw/issues/58
- [ ] #43643
- [ ] #43644
- [x] What about column refs that don't match fields?
- [x] What about table refs that don't match anything?
- [ ] https://github.com/metabase/metabase/pull/47063
- [ ] #43645
- [ ] #43646
- [ ] https://github.com/metabase/metabase/issues/47180
- [x] Get EE token added to cloud etc
- [x] Reduce log levels from DEBUG to INFO prior to release?
- [ ] https://github.com/metabase/metabase/pull/47216
```

",darksciencebase,2024-06-10 08:45:33+00:00,['tsmacdonald'],2024-10-23 10:55:04+00:00,2024-10-23 10:55:03+00:00,https://github.com/metabase/metabase/issues/43920,"[('.Backend', ''), ('.Epic', 'Feature Implementation or Project'), ('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2310516705, 'issue_id': 2343282608, 'author': 'crisptrutski', 'body': 'I see there 4 open bullet points on this epic, can we keep it open until they are all resolved?', 'created_at': datetime.datetime(2024, 8, 26, 15, 43, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2312151407, 'issue_id': 2343282608, 'author': 'tsmacdonald', 'body': 'Cloud token: https://github.com/metabase/harbormaster/pull/5261', 'created_at': datetime.datetime(2024, 8, 27, 10, 29, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2431726353, 'issue_id': 2343282608, 'author': 'crisptrutski', 'body': ""Don't see anything else to do here"", 'created_at': datetime.datetime(2024, 10, 23, 10, 55, 3, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-08-26 15:43:50 UTC): I see there 4 open bullet points on this epic, can we keep it open until they are all resolved?

tsmacdonald (Assginee) on (2024-08-27 10:29:44 UTC): Cloud token: https://github.com/metabase/harbormaster/pull/5261

crisptrutski on (2024-10-23 10:55:03 UTC): Don't see anything else to do here

"
2343276538,issue,closed,completed,[ParseSQL] Correctness of Query Column Attribution,"**Implementation Plan**

```[tasklist]
### Tasks
- [x] #42584
- [ ] #42585
- [ ] https://github.com/metabase/metabase/issues/44046
- [ ] https://github.com/metabase/metabase/issues/44380
- [ ] https://github.com/metabase/metabase/issues/44045
- [ ] https://github.com/metabase/macaw/pull/84
```

**Deferred**

- #42586
- #43725
- https://github.com/metabase/metabase/issues/42938
- https://github.com/metabase/metabase/issues/46955
",darksciencebase,2024-06-10 08:43:28+00:00,['crisptrutski'],2024-08-19 09:58:07+00:00,2024-08-19 09:58:07+00:00,https://github.com/metabase/metabase/issues/43919,"[('.Epic', 'Feature Implementation or Project'), ('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2200521614, 'issue_id': 2343276538, 'author': 'crisptrutski', 'body': ""We've decided to pause implementing further analysis support, but before closing this Epic we should sanity check our correctness somehow. A good baseline to use is to compare the existing analysis for MBQL cards to the analysis we get from first compiling them to SQL and then using Macaw to analyze them."", 'created_at': datetime.datetime(2024, 7, 1, 15, 55, 42, tzinfo=datetime.timezone.utc)}]","crisptrutski (Assginee) on (2024-07-01 15:55:42 UTC): We've decided to pause implementing further analysis support, but before closing this Epic we should sanity check our correctness somehow. A good baseline to use is to compare the existing analysis for MBQL cards to the analysis we get from first compiling them to SQL and then using Macaw to analyze them.

"
2343237552,issue,closed,completed,Option to show border instead of shadow in dashboard cards for embedding SDK,"Add a theme option `theme.components.dashboard.card.border` of type `string | undefined`. When the border theme option is defined, we use that to render the border and disable the default box shadow.

```tsx
{card: {border: ""1px solid #2d2d30""}}
```",heypoom,2024-06-10 08:28:43+00:00,['heypoom'],2024-10-08 17:08:07+00:00,2024-06-11 15:14:47+00:00,https://github.com/metabase/metabase/issues/43918,"[('Embedding/SDK', 'Embedding SDK for React')]",[],
2343184814,issue,closed,completed,"Allow multiple values to be picked for number parameters for ""Equal to"" and ""Not equal to""",,romeovs,2024-06-10 08:09:02+00:00,[],2024-10-08 17:08:08+00:00,2024-06-11 14:57:15+00:00,https://github.com/metabase/metabase/issues/43917,"[('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.')]",[],
2343175745,issue,closed,completed,Support +HHMM timezone format in CSV upload,"### Description

A common date format option `%z` prints the offset as 4 straight digits:

```python
datetime.now().astimezone().strftime('%Y-%m-%dT%H:%M:%S%z')

'2024-06-10T07:55:59+0000'
``` 

Unfortunately Metabase does not currently support this format, and will parse it as string instead of a timestamp.

It does however handle the very similar and slightly more common ISO 8601 format: `2024-06-10T07:55:59+00:00`

It would be great if Metabase could simply handle the original timestamp, to save customers needing to do further pre-processing.

Unfortunately, as Metabase defers the parsing to the Java standard library, it's not trivial to extend the supported pattern",crisptrutski,2024-06-10 08:05:35+00:00,['crisptrutski'],2024-08-19 14:04:04+00:00,2024-08-12 16:04:18+00:00,https://github.com/metabase/metabase/issues/43915,"[('.Backend', ''), ('.Team/Workflows', 'aka BEC'), ('Organization/Uploads', 'Direct data upload (CSV)'), ('good first issue', 'A starter issue that is good for someone new to the codebase or is a new contributor')]",[],
2343136433,issue,closed,completed,[Epic] Add custom list input support and labels for number filters,"**Links**
- [product doc](https://www.notion.so/metabase/Add-custom-list-input-support-and-labels-for-number-filters-73075ef42f0541749cc636be2108e41d)
- [testing plan](https://www.notion.so/metabase/test-plan-Add-custom-list-input-support-and-labels-for-parameters-111e1ea897914b7587a35bfaa5c8b24f)


**Implementation Plan**

```[tasklist]
### Milestone 1
- [ ] https://github.com/metabase/metabase/issues/43917
```
```[tasklist]
### Milestone 2
- [ ] https://github.com/metabase/metabase/issues/44289
- [ ] https://github.com/metabase/metabase/issues/44290
- [ ] https://github.com/metabase/metabase/issues/44054
```",romeovs,2024-06-10 07:47:06+00:00,['romeovs'],2024-08-05 14:33:52+00:00,2024-08-05 14:33:52+00:00,https://github.com/metabase/metabase/issues/43914,"[('Type:New Feature', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Epic', 'Feature Implementation or Project'), ('.Team/Querying', '')]",[],
2343008063,issue,closed,completed,[Flaky test] metabase.pulse.pulse-integration-test/skip-if-empty-test,"Failed run : https://github.com/metabase/metabase/actions/runs/9422626293/job/25959361895#step:4:4005

[Flaky report](https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBmbGFrZXMgYnkgc3VpdGUgbmFtZSBhbmQgdGVzdCBuYW1lIChub3QgUVApIiwiZGVzY3JpcHRpb24iOiJodHRwczovL3N0YXRzLm1ldGFiYXNlLmNvbS9tb2RlbC8xNDgyOC10ZXN0LWZsYWtpbmVzcyIsImRhdGFzZXRfcXVlcnkiOnsiZGF0YWJhc2UiOjI2LCJ0eXBlIjoicXVlcnkiLCJxdWVyeSI6eyJhZ2dyZWdhdGlvbiI6W1siY291bnQiXSxbIm1heCIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl91cmwiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dXSxbIm1heCIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl9zdGFydGVkX2F0Iix7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWVXaXRoTG9jYWxUWiIsInRlbXBvcmFsLXVuaXQiOiJtaW51dGUifV1dLFsiYWdncmVnYXRpb24tb3B0aW9ucyIsWyJjb3VudC13aGVyZSIsWyI-IixbImZpZWxkIiwid29ya2Zsb3dfcnVuX3N0YXJ0ZWRfYXQiLHsiYmFzZS10eXBlIjoidHlwZS9EYXRlVGltZVdpdGhMb2NhbFRaIn1dLFsiZGF0ZXRpbWUtc3VidHJhY3QiLFsibm93Il0sMywiZGF5Il1dXSx7Im5hbWUiOiJDb3VudCAobGFzdCAzZCkiLCJkaXNwbGF5LW5hbWUiOiJDb3VudCAobGFzdCAzZCkifV1dLCJicmVha291dCI6W1siZmllbGQiLCJzdWl0ZV9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwidGVzdF9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwid29ya2Zsb3dfcnVuX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLCJ3b3JrZmxvd19qb2JfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV1dLCJvcmRlci1ieSI6W1siZGVzYyIsWyJhZ2dyZWdhdGlvbiIsM11dLFsiZGVzYyIsWyJhZ2dyZWdhdGlvbiIsMF1dXSwic291cmNlLXRhYmxlIjoiY2FyZF9fMTQ4MjgiLCJmaWx0ZXIiOlsiYW5kIixbInRpbWUtaW50ZXJ2YWwiLFsiZmllbGQiLCJ3b3JrZmxvd19ydW5fc3RhcnRlZF9hdCIseyJiYXNlLXR5cGUiOiJ0eXBlL0RhdGVUaW1lV2l0aExvY2FsVFoifV0sLTcsImRheSJdLFsiZG9lcy1ub3QtY29udGFpbiIsWyJmaWVsZCIsInN1aXRlX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJxdWVyeS1wcm9jZXNzb3IiLHsiY2FzZS1zZW5zaXRpdmUiOmZhbHNlfV0sWyJjb250YWlucyIsWyJmaWVsZCIsIndvcmtmbG93X2pvYl9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSwiYmUtdGVzdHMtIix7ImNhc2Utc2Vuc2l0aXZlIjpmYWxzZX1dLFsiPSIsWyJmaWVsZCIsInRlc3RfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sInNraXAtaWYtZW1wdHktdGVzdCJdXX19LCJkaXNwbGF5IjoidGFibGUiLCJkaXNwbGF5SXNMb2NrZWQiOnRydWUsInBhcmFtZXRlcnMiOltdLCJ2aXN1YWxpemF0aW9uX3NldHRpbmdzIjp7InRhYmxlLnBpdm90X2NvbHVtbiI6InN1aXRlX25hbWUiLCJ0YWJsZS5jZWxsX2NvbHVtbiI6ImNvdW50IiwidGFibGUucGl2b3QiOmZhbHNlLCJ0YWJsZS5jb2x1bW5zIjpbeyJuYW1lIjoic3VpdGVfbmFtZSIsImtleSI6IltcIm5hbWVcIixcInN1aXRlX25hbWVcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsInN1aXRlX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dfSx7Im5hbWUiOiJ0ZXN0X25hbWUiLCJrZXkiOiJbXCJuYW1lXCIsXCJ0ZXN0X25hbWVcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsInRlc3RfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV19LHsibmFtZSI6IndvcmtmbG93X3J1bl9uYW1lIiwia2V5IjoiW1wibmFtZVwiLFwid29ya2Zsb3dfcnVuX25hbWVcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsIndvcmtmbG93X3J1bl9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XX0seyJuYW1lIjoid29ya2Zsb3dfam9iX25hbWUiLCJrZXkiOiJbXCJuYW1lXCIsXCJ3b3JrZmxvd19qb2JfbmFtZVwiXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImZpZWxkIiwid29ya2Zsb3dfam9iX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dfSx7Im5hbWUiOiJDb3VudCAobGFzdCAzZCkiLCJrZXkiOiJbXCJuYW1lXCIsXCJDb3VudCAobGFzdCAzZClcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJhZ2dyZWdhdGlvbiIsM119LHsibmFtZSI6ImNvdW50Iiwia2V5IjoiW1wibmFtZVwiLFwiY291bnRcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJhZ2dyZWdhdGlvbiIsMF19LHsibmFtZSI6Im1heCIsImtleSI6IltcIm5hbWVcIixcIm1heFwiXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImFnZ3JlZ2F0aW9uIiwxXX0seyJuYW1lIjoibWF4XzIiLCJrZXkiOiJbXCJuYW1lXCIsXCJtYXhfMlwiXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImFnZ3JlZ2F0aW9uIiwyXX1dLCJjb2x1bW5fc2V0dGluZ3MiOnsiW1wibmFtZVwiLFwiY291bnRcIl0iOnsiY29sdW1uX3RpdGxlIjoiQ291bnQgKGxhc3QgN2QpIn0sIltcIm5hbWVcIixcIm1heFwiXSI6eyJjb2x1bW5fdGl0bGUiOiJMYXN0IGZhaWxlZCBydW4ifSwiW1wibmFtZVwiLFwibWF4XzJcIl0iOnsiY29sdW1uX3RpdGxlIjoiTGFzdCBmYWlsZWQgZGF0ZSIsImRhdGVfc3R5bGUiOiJNTU1NIEQsIFlZWVkiLCJ0aW1lX2VuYWJsZWQiOm51bGx9fX0sIm9yaWdpbmFsX2NhcmRfaWQiOjE1MjEyfQ==)",qnkhuat,2024-06-10 06:49:21+00:00,[],2024-06-10 20:37:56+00:00,2024-06-10 08:05:24+00:00,https://github.com/metabase/metabase/issues/43912,"[('Reporting/Pulses', 'Now called Subscriptions'), ('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Workflows', 'aka BEC')]",[],
2342881635,issue,closed,not_planned,[Flaky test] models/models.cy.spec.js,[Job](https://github.com/metabase/metabase/actions/runs/9416878147/job/25970174951#step:13:474),qnkhuat,2024-06-10 05:23:45+00:00,[],2024-06-10 14:50:36+00:00,2024-06-10 14:50:36+00:00,https://github.com/metabase/metabase/issues/43909,"[('.CI & Tests', ''), ('.Frontend', ''), ('flaky-test-fix', '')]","[{'comment_id': 2158577086, 'issue_id': 2342881635, 'author': 'iethree', 'body': 'duplicate of https://github.com/metabase/metabase/issues/43870', 'created_at': datetime.datetime(2024, 6, 10, 14, 50, 36, tzinfo=datetime.timezone.utc)}]","iethree on (2024-06-10 14:50:36 UTC): duplicate of https://github.com/metabase/metabase/issues/43870

"
2342880705,issue,closed,not_planned,[Flaky test] models/reproductions.cy.spec.js ,[job](https://github.com/metabase/metabase/actions/runs/9416878147/job/26004328722?pr=43821#step:13:608),qnkhuat,2024-06-10 05:22:47+00:00,[],2024-06-10 14:54:54+00:00,2024-06-10 14:54:53+00:00,https://github.com/metabase/metabase/issues/43908,"[('.CI & Tests', ''), ('.Frontend', ''), ('flaky-test-fix', '')]","[{'comment_id': 2158587155, 'issue_id': 2342880705, 'author': 'iethree', 'body': 'duplicate of https://github.com/metabase/metabase/issues/43934', 'created_at': datetime.datetime(2024, 6, 10, 14, 54, 53, tzinfo=datetime.timezone.utc)}]","iethree on (2024-06-10 14:54:53 UTC): duplicate of https://github.com/metabase/metabase/issues/43934

"
2341561226,issue,closed,completed,Mongo queries not cached due to Unfreezable type: class org.bson.Document,"### Describe the bug

When runing queries against our mongo db, the queries are not cached. Seems that the models using mongo are also not cached.

### To Reproduce

1. Go to 'Databases'
2. Click on 'Add'
3. Create a new database with Mongo 6.0
4. Create some questions for it
5. Watch the logs


### Expected behavior

Mongo queries should be cached in order to speedup dashboards questions.

### Logs

```
2024-06-08 08:55:12,478 ERROR middleware.cache :: Error saving query results to cache: Unfreezable type: class org.bson.Document
clojure.lang.ExceptionInfo: Unfreezable type: class org.bson.Document {:type org.bson.Document, :as-str ""{\""$limit\"" #object[org.bson.BsonInt32 0x330207cd \""BsonInt32{value=1048575}\""]}""}
        at taoensso.nippy$throw_unfreezable.invokeStatic(nippy.clj:953)
        at taoensso.nippy$throw_unfreezable.invoke(nippy.clj:950)
        at taoensso.nippy$fn__35698.invokeStatic(nippy.clj:1188)
        at taoensso.nippy$fn__35698.invoke(nippy.clj:1170)
        at taoensso.nippy$fn__35362$G__35346__35369.invoke(nippy.clj:580)
        at taoensso.nippy$fn__35399.invokeStatic(nippy.clj:605)
        at taoensso.nippy$fn__35399.invoke(nippy.clj:596)
        at taoensso.nippy$fn__35380$G__35375__35387.invoke(nippy.clj:587)
        at taoensso.nippy$write_vec$fn__35444$fn__35445.invoke(nippy.clj:746)
        at taoensso.nippy$write_vec$fn__35444.invoke(nippy.clj:746)
        at clojure.lang.PersistentVector.reduce(PersistentVector.java:343)
        at clojure.core$reduce.invokeStatic(core.clj:6886)
        at clojure.core$reduce.invoke(core.clj:6869)
        at taoensso.nippy$write_vec.invokeStatic(nippy.clj:746)
        at taoensso.nippy$write_vec.invoke(nippy.clj:735)
        at taoensso.nippy$fn__35643.invokeStatic(nippy.clj:1113)
        at taoensso.nippy$fn__35643.invoke(nippy.clj:1113)
        at taoensso.nippy$fn__35362$G__35346__35369.invoke(nippy.clj:580)
        at taoensso.nippy$fn__35394.invokeStatic(nippy.clj:602)
        at taoensso.nippy$fn__35394.invoke(nippy.clj:596)
        at taoensso.nippy$fn__35380$G__35375__35387.invoke(nippy.clj:587)
        at taoensso.nippy$write_map$fn__35475$fn__35476.invoke(nippy.clj:862)
        at taoensso.nippy$write_map$fn__35475.invoke(nippy.clj:850)
        at clojure.lang.PersistentArrayMap.kvreduce(PersistentArrayMap.java:429)
        at clojure.core$fn__8525.invokeStatic(core.clj:6909)
        at clojure.core$fn__8525.invoke(core.clj:6889)
        at clojure.core.protocols$fn__8257$G__8252__8266.invoke(protocols.clj:175)
        at clojure.core$reduce_kv.invokeStatic(core.clj:6920)
        at clojure.core$reduce_kv.invoke(core.clj:6911)
        at taoensso.nippy$write_map.invokeStatic(nippy.clj:850)
        at taoensso.nippy$write_map.invoke(nippy.clj:839)
        at taoensso.nippy$fn__35651.invokeStatic(nippy.clj:1115)
        at taoensso.nippy$fn__35651.invoke(nippy.clj:1115)
        at taoensso.nippy$fn__35362$G__35346__35369.invoke(nippy.clj:580)
        at taoensso.nippy$fn__35394.invokeStatic(nippy.clj:602)
        at taoensso.nippy$fn__35394.invoke(nippy.clj:596)
        at taoensso.nippy$fn__35380$G__35375__35387.invoke(nippy.clj:587)
        at taoensso.nippy$write_map$fn__35475$fn__35476.invoke(nippy.clj:862)
        at taoensso.nippy$write_map$fn__35475.invoke(nippy.clj:850)
        at clojure.lang.PersistentArrayMap.kvreduce(PersistentArrayMap.java:429)
        at clojure.core$fn__8525.invokeStatic(core.clj:6909)
        at clojure.core$fn__8525.invoke(core.clj:6889)
        at clojure.core.protocols$fn__8257$G__8252__8266.invoke(protocols.clj:175)
        at clojure.core$reduce_kv.invokeStatic(core.clj:6920)
        at clojure.core$reduce_kv.invoke(core.clj:6911)
        at taoensso.nippy$write_map.invokeStatic(nippy.clj:850)
        at taoensso.nippy$write_map.invoke(nippy.clj:839)
        at taoensso.nippy$fn__35651.invokeStatic(nippy.clj:1115)
        at taoensso.nippy$fn__35651.invoke(nippy.clj:1115)
        at taoensso.nippy$fn__35362$G__35346__35369.invoke(nippy.clj:580)
        at taoensso.nippy$fn__35394.invokeStatic(nippy.clj:602)
        at taoensso.nippy$fn__35394.invoke(nippy.clj:596)
        at taoensso.nippy$fn__35380$G__35375__35387.invoke(nippy.clj:587)
        at taoensso.nippy$write_map$fn__35475$fn__35476.invoke(nippy.clj:862)
        at taoensso.nippy$write_map$fn__35475.invoke(nippy.clj:850)
        at clojure.lang.PersistentArrayMap.kvreduce(PersistentArrayMap.java:429)
        at clojure.core$fn__8525.invokeStatic(core.clj:6909)
        at clojure.core$fn__8525.invoke(core.clj:6889)
        at clojure.core.protocols$fn__8257$G__8252__8266.invoke(protocols.clj:175)
        at clojure.core$reduce_kv.invokeStatic(core.clj:6920)
        at clojure.core$reduce_kv.invoke(core.clj:6911)
        at taoensso.nippy$write_map.invokeStatic(nippy.clj:850)
        at taoensso.nippy$write_map.invoke(nippy.clj:839)
        at taoensso.nippy$fn__35651.invokeStatic(nippy.clj:1115)
        at taoensso.nippy$fn__35651.invoke(nippy.clj:1115)
        at taoensso.nippy$fn__35362$G__35346__35369.invoke(nippy.clj:580)
        at taoensso.nippy$fn__35394.invokeStatic(nippy.clj:602)
        at taoensso.nippy$fn__35394.invoke(nippy.clj:596)
        at taoensso.nippy$fn__35380$G__35375__35387.invoke(nippy.clj:587)
        at taoensso.nippy$freeze_to_out_BANG_.invokeStatic(nippy.clj:961)
        at taoensso.nippy$freeze_to_out_BANG_.invoke(nippy.clj:958)
        at metabase.query_processor.middleware.cache.impl$freeze_BANG_.invokeStatic(impl.clj:51)
        at metabase.query_processor.middleware.cache.impl$freeze_BANG_.invoke(impl.clj:48)
        at metabase.query_processor.middleware.cache.impl$do_with_serialization$in_STAR___69690$fn__69691.invoke(impl.clj:86)
        at metabase.query_processor.middleware.cache.impl$do_with_serialization$in_STAR___69690.invoke(impl.clj:85)
        at metabase.query_processor.middleware.cache$add_object_to_cache_BANG_.invokeStatic(cache.clj:68)
        at metabase.query_processor.middleware.cache$add_object_to_cache_BANG_.invoke(cache.clj:64)
        at metabase.query_processor.middleware.cache$save_results_xform$fn__72602.invoke(cache.clj:107)
        at clojure.core$transduce.invokeStatic(core.clj:6949)
        at clojure.core$transduce.invokeStatic(core.clj:6943)
        at clojure.core$transduce.invoke(core.clj:6934)
        at metabase.query_processor.context.default$default_reducef$fn__50897.invoke(default.clj:34)
        at metabase.query_processor.context.default$default_reducef.invokeStatic(default.clj:33)
        at metabase.query_processor.context.default$default_reducef.invoke(default.clj:25)
        at metabase.query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___72643$fn__72644.invoke(cache.clj:201)
        at metabase.query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:83)
        at metabase.query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)
        at metabase.query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:73)
        at metabase.query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)
        at metabase.query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___72643.invoke(cache.clj:197)
        at metabase.query_processor.context$reducef.invokeStatic(context.clj:70)
        at metabase.query_processor.context$reducef.invoke(context.clj:63)
        at metabase.query_processor.context.default$default_runf$respond_STAR___50901.invoke(default.clj:45)
        at metabase.driver.mongo.execute$reduce_results.invokeStatic(execute.clj:177)
        at metabase.driver.mongo.execute$reduce_results.invoke(execute.clj:171)
        at metabase.driver.mongo.execute$execute_reducible_query.invokeStatic(execute.clj:207)
        at metabase.driver.mongo.execute$execute_reducible_query.invoke(execute.clj:182)
        at metabase.driver.mongo$fn__116198$f__112432__auto____116199.invoke(mongo.clj:321)
        at metabase.driver.mongo.connection$do_with_mongo_client$fn__112423.invoke(connection.clj:94)
        at metabase.util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:165)
        at metabase.util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154)
        at metabase.driver.mongo.connection$do_with_mongo_client.invokeStatic(connection.clj:89)
        at metabase.driver.mongo.connection$do_with_mongo_client.invoke(connection.clj:85)
        at metabase.driver.mongo$fn__116198.invokeStatic(mongo.clj:320)
        at metabase.driver.mongo$fn__116198.invoke(mongo.clj:318)
        at clojure.lang.MultiFn.invoke(MultiFn.java:244)
        at metabase.query_processor.context$executef.invokeStatic(context.clj:60)
        at metabase.query_processor.context$executef.invoke(context.clj:49)
        at metabase.query_processor.context.default$default_runf.invokeStatic(default.clj:44)
        at metabase.query_processor.context.default$default_runf.invoke(default.clj:42)
        at metabase.query_processor.context$runf.invokeStatic(context.clj:46)
        at metabase.query_processor.context$runf.invoke(context.clj:40)
        at metabase.query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)
        at metabase.query_processor.reducible$identity_qp.invoke(reducible.clj:36)
        at metabase.query_processor.middleware.cache$run_query_with_cache.invokeStatic(cache.clj:202)
        at metabase.query_processor.middleware.cache$run_query_with_cache.invoke(cache.clj:186)
        at metabase.query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72656.invoke(cache.clj:228)
        at metabase.query_processor.middleware.permissions$check_query_permissions$fn__67003.invoke(permissions.clj:140)
        at metabase.query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72477.invoke(enterprise.clj:51)
        at metabase.query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72487.invoke(enterprise.clj:64)
        at metabase.query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71919.invoke(mbql_to_native.clj:24)
        at metabase.query_processor$fn__73824$combined_post_process__73829$combined_post_process_STAR___73830.invoke(query_processor.clj:262)
        at metabase.query_processor$fn__73824$combined_pre_process__73825$combined_pre_process_STAR___73826.invoke(query_processor.clj:259)
        at metabase.query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__67100.invoke(fetch_source_query.clj:299)
        at metabase.query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72567$fn__72571.invoke(resolve_database_and_driver.clj:77)
        at metabase.driver$do_with_driver.invokeStatic(driver.clj:97)
        at metabase.driver$do_with_driver.invoke(driver.clj:92)
        at metabase.query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72567.invoke(resolve_database_and_driver.clj:76)
        at metabase.query_processor.middleware.store$initialize_store$fn__67727$fn__67728.invoke(store.clj:14)
        at metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)
        at metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:150)
        at metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)
        at metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:150)
        at metabase.query_processor.middleware.store$initialize_store$fn__67727.invoke(store.clj:13)
        at metabase.query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72564.invoke(resolve_database_and_driver.clj:60)
        at metabase.query_processor.middleware.normalize_query$normalize$fn__72869.invoke(normalize_query.clj:38)
        at metabase.query_processor.middleware.enterprise$fn__72504$handle_audit_app_internal_queries__72505$fn__72507.invoke(enterprise.clj:96)
        at metabase.query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72515.invoke(enterprise.clj:103)
        at metabase.query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71630.invoke(constraints.clj:104)
        at metabase.query_processor.middleware.process_userland_query$process_userland_query$fn__72800.invoke(process_userland_query.clj:156)
        at metabase.query_processor.middleware.catch_exceptions$catch_exceptions$fn__73401.invoke(catch_exceptions.clj:171)
        at metabase.query_processor.reducible$async_qp$qp_STAR___63219$thunk__63221.invoke(reducible.clj:126)
        at metabase.query_processor.reducible$async_qp$qp_STAR___63219$fn__63223.invoke(reducible.clj:131)
        at clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047)
        at clojure.lang.AFn.call(AFn.java:18)
        at java.base/java.util.concurrent.FutureTask.run(Unknown Source)
        at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
        at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.base/java.lang.Thread.run(Unknown Source)
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.8.0-31-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""mongo""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.3 (Debian 16.3-1.pgdg120+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-05"",
      ""tag"": ""v0.49.14"",
      ""hash"": ""3606ed3""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

High

### Additional context

* mongo:6.0.13
",niltonvasques,2024-06-08 09:04:58+00:00,['lbrdnk'],2024-08-28 02:09:53+00:00,2024-07-17 18:23:27+00:00,https://github.com/metabase/metabase/issues/43901,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Mongo', None), ('.Backend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('Querying/Cache', ''), ('.Team/Querying', '')]","[{'comment_id': 2228725961, 'issue_id': 2341561226, 'author': 'lbrdnk', 'body': ""@niltonvasques, I've reproduced the issue with question based on native model (even though native query, not a model, as a source should suffice). Linked PR contains the fix.\r\n\r\nCould you confirm that's the setup you used (native model based question)? Or share more details? I'd like to make sure the fix works also in your case."", 'created_at': datetime.datetime(2024, 7, 15, 15, 6, 5, tzinfo=datetime.timezone.utc)}]","lbrdnk (Assginee) on (2024-07-15 15:06:05 UTC): @niltonvasques, I've reproduced the issue with question based on native model (even though native query, not a model, as a source should suffice). Linked PR contains the fix.

Could you confirm that's the setup you used (native model based question)? Or share more details? I'd like to make sure the fix works also in your case.

"
2341215349,issue,closed,completed,"use ""metric"" icon for metrics in lib/icon.ts",,rafpaf,2024-06-07 21:52:11+00:00,[],2024-10-08 17:08:25+00:00,2024-06-10 14:48:27+00:00,https://github.com/metabase/metabase/issues/43894,[],[],
2341104755,issue,closed,not_planned,[Flaky Test]: 'read-only' user should be able to resize column width (metabase#9772),"Last Flake: https://github.com/metabase/metabase/actions/runs/9408330179
Last Flake Time: 2024-06-06T15:31:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-07 20:19:12+00:00,[],2024-12-13 16:43:58+00:00,2024-12-13 16:43:58+00:00,https://github.com/metabase/metabase/issues/43880,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2341104743,issue,closed,completed,[Flaky Test]: basic-timeseries-test,"Last Flake: https://github.com/metabase/metabase/actions/runs/9388257785
Last Flake Time: 2024-06-05T10:47:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-07 20:19:11+00:00,[],2024-07-01 14:03:23+00:00,2024-07-01 14:03:22+00:00,https://github.com/metabase/metabase/issues/43879,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2165797567, 'issue_id': 2341104743, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9490526367\nLast Flake Time: 2024-06-12T16:07:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 1\nFlakes in the last 7d: 1', 'created_at': datetime.datetime(2024, 6, 13, 14, 13, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2200243014, 'issue_id': 2341104743, 'author': 'qnkhuat', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43924', 'created_at': datetime.datetime(2024, 7, 1, 14, 3, 22, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-13 14:13:01 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9490526367
Last Flake Time: 2024-06-12T16:07:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 1
Flakes in the last 7d: 1

qnkhuat on (2024-07-01 14:03:22 UTC): Fixed by https://github.com/metabase/metabase/pull/43924

"
2341104727,issue,closed,not_planned,[Flaky Test]: skip-if-empty-test,"Last Flake: https://github.com/metabase/metabase/actions/runs/9405003044
Last Flake Time: 2024-06-06T10:51:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-07 20:19:10+00:00,[],2024-12-13 16:43:38+00:00,2024-12-13 16:43:38+00:00,https://github.com/metabase/metabase/issues/43878,"[('.CI & Tests', ''), ('.Backend', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2341104712,issue,closed,not_planned,[Flaky Test]: get-database-can-upload-test,"Last Flake: https://github.com/metabase/metabase/actions/runs/9405294602
Last Flake Time: 2024-06-06T11:16:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-07 20:19:10+00:00,[],2024-12-13 16:43:37+00:00,2024-12-13 16:43:37+00:00,https://github.com/metabase/metabase/issues/43877,"[('.CI & Tests', ''), ('.Backend', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2233644838, 'issue_id': 2341104712, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9964958278\nLast Flake Time: 2024-07-16T16:11:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 1\nFlakes in the last 7d: 1', 'created_at': datetime.datetime(2024, 7, 17, 15, 50, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2233646822, 'issue_id': 2341104712, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9964958278\nLast Flake Time: 2024-07-16T16:11:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 1\nFlakes in the last 7d: 1', 'created_at': datetime.datetime(2024, 7, 17, 15, 51, 4, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-07-17 15:50:11 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9964958278
Last Flake Time: 2024-07-16T16:11:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 1
Flakes in the last 7d: 1

github-automation-metabase (Issue Creator) on (2024-07-17 15:51:04 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9964958278
Last Flake Time: 2024-07-16T16:11:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 1
Flakes in the last 7d: 1

"
2341104697,issue,closed,not_planned,[Flaky Test]: redshift-lbv-sync-error-test,"Last Flake: https://github.com/metabase/metabase/actions/runs/9404892912
Last Flake Time: 2024-06-06T10:47:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-07 20:19:09+00:00,[],2024-12-13 16:43:37+00:00,2024-12-13 16:43:37+00:00,https://github.com/metabase/metabase/issues/43876,"[('.CI & Tests', ''), ('.Backend', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2341104682,issue,closed,completed,[Flaky Test]: lifecycle-test,"Last Flake: https://github.com/metabase/metabase/actions/runs/9384253083
Last Flake Time: 2024-06-05T06:48:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-07 20:19:08+00:00,[],2024-07-01 14:03:34+00:00,2024-07-01 14:03:34+00:00,https://github.com/metabase/metabase/issues/43875,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2200243435, 'issue_id': 2341104682, 'author': 'qnkhuat', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43924', 'created_at': datetime.datetime(2024, 7, 1, 14, 3, 34, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-07-01 14:03:34 UTC): Fixed by https://github.com/metabase/metabase/pull/43924

"
2341104675,issue,closed,not_planned,[Flaky Test]: scenarios > home > custom homepage custom homepage set should not show you a toast after it has been dismissed,"Last Flake: https://github.com/metabase/metabase/actions/runs/9384253067
Last Flake Time: 2024-06-05T06:10:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-07 20:19:07+00:00,[],2024-12-13 16:45:38+00:00,2024-12-13 16:45:38+00:00,https://github.com/metabase/metabase/issues/43874,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2341104663,issue,closed,completed,[Flaky Test]: scenarios > admin > datamodel > segments with segment should see a newly asked question in its questions list,"Last Flake: https://github.com/metabase/metabase/actions/runs/9407548339
Last Flake Time: 2024-06-06T14:17:00-07:00
Flakes in the last day: 2
Flakes in the last 3d: 3
Flakes in the last 7d: 3",github-automation-metabase,2024-06-07 20:19:07+00:00,['nemanjaglumac'],2024-10-08 17:06:41+00:00,2024-06-20 18:04:53+00:00,https://github.com/metabase/metabase/issues/43873,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2158583266, 'issue_id': 2341104663, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9441819595\nLast Flake Time: 2024-06-09T23:15:00-07:00\nFlakes in the last day: 3\nFlakes in the last 3d: 12\nFlakes in the last 7d: 21', 'created_at': datetime.datetime(2024, 6, 10, 14, 53, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162288891, 'issue_id': 2341104663, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9462924260\nLast Flake Time: 2024-06-11T02:57:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 8\nFlakes in the last 7d: 26', 'created_at': datetime.datetime(2024, 6, 12, 7, 19, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2178799295, 'issue_id': 2341104663, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9573247982\nLast Flake Time: 2024-06-18T16:29:00-07:00\nFlakes in the last day: 2\nFlakes in the last 3d: 5\nFlakes in the last 7d: 10', 'created_at': datetime.datetime(2024, 6, 19, 14, 2, 26, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-10 14:53:10 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9441819595
Last Flake Time: 2024-06-09T23:15:00-07:00
Flakes in the last day: 3
Flakes in the last 3d: 12
Flakes in the last 7d: 21

github-automation-metabase (Issue Creator) on (2024-06-12 07:19:58 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9462924260
Last Flake Time: 2024-06-11T02:57:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 8
Flakes in the last 7d: 26

github-automation-metabase (Issue Creator) on (2024-06-19 14:02:26 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9573247982
Last Flake Time: 2024-06-18T16:29:00-07:00
Flakes in the last day: 2
Flakes in the last 3d: 5
Flakes in the last 7d: 10

"
2341104651,issue,closed,completed,[Flaky Test]: should correctly insert function suggestion with the opening parenthesis,"Last Flake: https://github.com/metabase/metabase/actions/runs/9406368710
Last Flake Time: 2024-06-06T12:43:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 5
Flakes in the last 7d: 9",github-automation-metabase,2024-06-07 20:19:06+00:00,['nemanjaglumac'],2024-06-10 20:32:01+00:00,2024-06-10 18:34:47+00:00,https://github.com/metabase/metabase/issues/43872,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2158583322, 'issue_id': 2341104651, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9422049364\nLast Flake Time: 2024-06-09T23:15:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 6\nFlakes in the last 7d: 10', 'created_at': datetime.datetime(2024, 6, 10, 14, 53, 12, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-10 14:53:12 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9422049364
Last Flake Time: 2024-06-09T23:15:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 6
Flakes in the last 7d: 10

"
2341104636,issue,closed,completed,"[Flaky Test]: should add, update bookmark name when question name is updated, then remove bookmark from question page","Last Flake: https://github.com/metabase/metabase/actions/runs/9408203925
Last Flake Time: 2024-06-06T18:23:00-07:00
Flakes in the last day: 2
Flakes in the last 3d: 5
Flakes in the last 7d: 5",github-automation-metabase,2024-06-07 20:19:05+00:00,['nemanjaglumac'],2024-10-08 17:08:19+00:00,2024-06-10 20:27:03+00:00,https://github.com/metabase/metabase/issues/43871,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2158583387, 'issue_id': 2341104636, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9443401540\nLast Flake Time: 2024-06-09T23:55:00-07:00\nFlakes in the last day: 2\nFlakes in the last 3d: 2\nFlakes in the last 7d: 5', 'created_at': datetime.datetime(2024, 6, 10, 14, 53, 13, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-10 14:53:13 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9443401540
Last Flake Time: 2024-06-09T23:55:00-07:00
Flakes in the last day: 2
Flakes in the last 3d: 2
Flakes in the last 7d: 5

"
2341104618,issue,closed,completed,[Flaky Test]: should automatically pin newly created models,"Last Flake: https://github.com/metabase/metabase/actions/runs/9407750048
Last Flake Time: 2024-06-06T14:38:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 7
Flakes in the last 7d: 7",github-automation-metabase,2024-06-07 20:19:04+00:00,[],2024-07-30 15:42:32+00:00,2024-07-30 15:42:32+00:00,https://github.com/metabase/metabase/issues/43870,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2158583289, 'issue_id': 2341104618, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9441819595\nLast Flake Time: 2024-06-09T22:21:00-07:00\nFlakes in the last day: 2\nFlakes in the last 3d: 9\nFlakes in the last 7d: 16', 'created_at': datetime.datetime(2024, 6, 10, 14, 53, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2165797338, 'issue_id': 2341104618, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9474194065\nLast Flake Time: 2024-06-12T14:53:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 9\nFlakes in the last 7d: 26', 'created_at': datetime.datetime(2024, 6, 13, 14, 12, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2258659175, 'issue_id': 2341104618, 'author': 'nemanjaglumac', 'body': '50/50 ✅ on `master`\r\nhttps://github.com/metabase/metabase/actions/runs/10164813914', 'created_at': datetime.datetime(2024, 7, 30, 15, 42, 32, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-10 14:53:11 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9441819595
Last Flake Time: 2024-06-09T22:21:00-07:00
Flakes in the last day: 2
Flakes in the last 3d: 9
Flakes in the last 7d: 16

github-automation-metabase (Issue Creator) on (2024-06-13 14:12:55 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9474194065
Last Flake Time: 2024-06-12T14:53:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 9
Flakes in the last 7d: 26

nemanjaglumac on (2024-07-30 15:42:32 UTC): 50/50 ✅ on `master`
https://github.com/metabase/metabase/actions/runs/10164813914

"
2340959169,issue,closed,completed,[Databricks] Iterate over driver's features and enable more if appropriate,,lbrdnk,2024-06-07 18:22:13+00:00,[],2024-08-28 17:14:53+00:00,2024-08-28 17:14:53+00:00,https://github.com/metabase/metabase/issues/43858,"[('.Backend', ''), ('Database/Databricks', '')]","[{'comment_id': 2315878894, 'issue_id': 2340959169, 'author': 'lbrdnk', 'body': '`:set-timezone` feature was enabled in the WIP PR https://github.com/metabase/metabase/pull/42263.', 'created_at': datetime.datetime(2024, 8, 28, 17, 14, 53, tzinfo=datetime.timezone.utc)}]","lbrdnk (Issue Creator) on (2024-08-28 17:14:53 UTC): `:set-timezone` feature was enabled in the WIP PR https://github.com/metabase/metabase/pull/42263.

"
2340958949,issue,closed,completed,[Databricks] Consider use of uniquely namespaced database entities per CI run,Databricks driver is tested against cloud instance as eg. Redshift. In Redshift tests we prefix entities with unique identifier so every job works on its own data. It might make sense to implement similar approach also for Databricks.,lbrdnk,2024-06-07 18:22:01+00:00,[],2024-08-28 17:04:08+00:00,2024-08-28 17:04:08+00:00,https://github.com/metabase/metabase/issues/43857,"[('.CI & Tests', ''), ('.Backend', ''), ('.Team/Querying', ''), ('Database/Databricks', '')]","[{'comment_id': 2315859741, 'issue_id': 2340958949, 'author': 'lbrdnk', 'body': ""I've decided not to use prefixed datasets at the moment as per discussion on QPD weekly."", 'created_at': datetime.datetime(2024, 8, 28, 17, 4, 8, tzinfo=datetime.timezone.utc)}]","lbrdnk (Issue Creator) on (2024-08-28 17:04:08 UTC): I've decided not to use prefixed datasets at the moment as per discussion on QPD weekly.

"
2340944260,issue,closed,completed,[Databricks] Attempt to derive `:hive-like`,Current implementation passes the testsuite (apart from very few exceptions to be resolved later). Initially I planned to use plain `:sql-jdbc` as driver's parent to keep things simple. It turned out that lot of `:hive-like` functionality could be re-used. It could make sense to directly derive it. This option should be examined.,lbrdnk,2024-06-07 18:14:20+00:00,['lbrdnk'],2024-06-12 18:30:19+00:00,2024-06-12 18:29:00+00:00,https://github.com/metabase/metabase/issues/43854,"[('Database/Databricks', '')]","[{'comment_id': 2163665558, 'issue_id': 2340944260, 'author': 'lbrdnk', 'body': 'Closing as implementation deriving `:hive-like` is in [`databricks-hive-like`](https://github.com/metabase/metabase/tree/databricks-hive-like) branch.', 'created_at': datetime.datetime(2024, 6, 12, 18, 30, 18, tzinfo=datetime.timezone.utc)}]","lbrdnk (Issue Creator) on (2024-06-12 18:30:18 UTC): Closing as implementation deriving `:hive-like` is in [`databricks-hive-like`](https://github.com/metabase/metabase/tree/databricks-hive-like) branch.

"
2340908939,issue,closed,not_planned,Metabase not displaying table columns registered with Lakeformation in Athena,"**Describe the bug**
Metabase correctly loads the database and shows the table names, however it doesn't show the table schema and I can't see the data in visualization, returning the error No fields found for table X. However, if I try to view the table via native query, all the fields and data are loaded correctly.

**Logs**

[068e27cb-5ab0-4347-9d8d-08937211cb25] 2024-06-07T14:32:07-03:00 ERROR metabase.models.query.permissions ,clojure.lang.ExceptionInfo: Error calculating permissions for query {:query {:database 67, :type :query, :query {:source-table 2562}}},	at metabase.models.query.permissions$mbql_permissions_path_set.invokeStatic(permissions.clj:160),	at metabase.models.query.permissions$mbql_permissions_path_set.invoke(permissions.clj:139),	at metabase.models.query.permissions$perms_set_STAR_.invokeStatic(permissions.clj:176),	at metabase.models.query.permissions$perms_set_STAR_.invoke(permissions.clj:169),	at metabase.models.query.permissions$perms_set.invokeStatic(permissions.clj:191),	at metabase.models.query.permissions$perms_set.doInvoke(permissions.clj:186),	at clojure.lang.RestFn.invoke(RestFn.java:410),	at metabase.models.query.permissions$can_run_query_QMARK_.invokeStatic(permissions.clj:198),	at metabase.models.query.permissions$can_run_query_QMARK_.invoke(permissions.clj:193),	at metabase.models.query.permissions$can_query_table_QMARK_.invokeStatic(permissions.clj:204),	at metabase.models.query.permissions$can_query_table_QMARK_.invoke(permissions.clj:201),	at metabase.events.view_log$publish_event_BANG__primary_method_metabase_events_view_log_table_read.invokeStatic(view_log.clj:112),	at metabase.events.view_log$publish_event_BANG__primary_method_metabase_events_view_log_table_read.invoke(view_log.clj:100),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.combo.operator$invoke_fn$fn__18025.invoke(operator.clj:69),	at methodical.impl.combo.operator$fn__18046$fn__18047$fn__18048.invoke(operator.clj:112),	at clojure.core$comp$fn__5876.invoke(core.clj:2587),	at metabase.events$publish_event_BANG__around_method_default$fn__36615.invoke(events.clj:143),	at metabase.events$publish_event_BANG__around_method_default.invokeStatic(events.clj:137),	at metabase.events$publish_event_BANG__around_method_default.invoke(events.clj:109),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at clojure.core$partial$fn__5908.invoke(core.clj:2642),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.RestFn.applyTo(RestFn.java:132),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193),	at metabase.api.dataset$run_query_async.invokeStatic(dataset.clj:66),	at metabase.api.dataset$run_query_async.doInvoke(dataset.clj:49),	at clojure.lang.RestFn.invoke(RestFn.java:410),	at metabase.api.dataset$fn__94356.invokeStatic(dataset.clj:85),	at metabase.api.dataset$fn__94356.invoke(dataset.clj:81),	at compojure.core$wrap_response$fn__45006.invoke(core.clj:160),	at compojure.core$wrap_route_middleware$fn__44990.invoke(core.clj:132),	at compojure.core$wrap_route_info$fn__44995.invoke(core.clj:139),	at compojure.core$wrap_route_matches$fn__44999.invoke(core.clj:151),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44999.invoke(core.clj:152),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018.invoke(core.clj:200),	at metabase.server.middleware.auth$enforce_authentication$fn__94429.invoke(auth.clj:17),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018.invoke(core.clj:200),	at compojure.core$make_context$handler__45046.invoke(core.clj:290),	at compojure.core$make_context$fn__45050.invoke(core.clj:300),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$make_context$fn__45050.invoke(core.clj:301),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$make_context$fn__45050.invoke(core.clj:301),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$make_context$fn__45050.invoke(core.clj:301),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$make_context$fn__45050.invoke(core.clj:301),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$make_context$fn__45050.invoke(core.clj:301),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$make_context$fn__45050.invoke(core.clj:301),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$make_context$fn__45050.invoke(core.clj:301),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$make_context$fn__45050.invoke(core.clj:301),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$make_context$fn__45050.invoke(core.clj:301),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at metabase.api.routes$fn__102495$fn__102498.invoke(routes.clj:67),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018.invoke(core.clj:200),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at metabase.server.routes$fn__102660$fn__102661.doInvoke(routes.clj:72),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018.invoke(core.clj:200),	at compojure.core$make_context$handler__45046.invoke(core.clj:290),	at compojure.core$make_context$fn__45050.invoke(core.clj:300),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44999.invoke(core.clj:153),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44999.invoke(core.clj:153),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44999.invoke(core.clj:153),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018$f__45019$respond_SINGLEQUOTE___45020.invoke(core.clj:197),	at metabase.server.routes$fn__102645$fn__102647.invoke(routes.clj:49),	at compojure.core$routes$fn__45018$f__45019.invoke(core.clj:198),	at compojure.core$routes$fn__45018.invoke(core.clj:200),	at metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__99173.invoke(exceptions.clj:108),	at metabase.server.middleware.exceptions$catch_api_exceptions$fn__99170.invoke(exceptions.clj:96),	at metabase.server.middleware.log$log_api_call$fn__102937$fn__102938$fn__102939.invoke(log.clj:230),	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:18),	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12),	at metabase.server.middleware.log$log_api_call$fn__102937$fn__102938.invoke(log.clj:222),	at toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112),	at toucan2.execute$do_with_call_counts.invoke(execute.clj:103),	at metabase.server.middleware.log$log_api_call$fn__102937.invoke(log.clj:221),	at metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__105002.invoke(browser_cookie.clj:40),	at metabase.server.middleware.security$add_security_headers$fn__99129.invoke(security.clj:182),	at metabase.server.middleware.json$wrap_json_body$fn__46363.invoke(json.clj:67),	at metabase.server.middleware.offset_paging$handle_paging$fn__85327.invoke(offset_paging.clj:43),	at metabase.server.middleware.json$wrap_streamed_json_response$fn__46381.invoke(json.clj:103),	at ring.middleware.keyword_params$wrap_keyword_params$fn__105269.invoke(keyword_params.clj:55),	at ring.middleware.params$wrap_params$fn__105288.invoke(params.clj:77),	at metabase.server.middleware.misc$maybe_set_site_url$fn__67642.invoke(misc.clj:61),	at metabase.server.middleware.session$reset_session_timeout$fn__73075.invoke(session.clj:546),	at metabase.server.middleware.session$bind_current_user$fn__73041$fn__73042.invoke(session.clj:440),	at metabase.server.middleware.session$do_with_current_user.invokeStatic(session.clj:419),	at metabase.server.middleware.session$do_with_current_user.invoke(session.clj:403),	at metabase.server.middleware.session$bind_current_user$fn__73041.invoke(session.clj:439),	at metabase.server.middleware.session$wrap_current_user_info$fn__73024.invoke(session.clj:378),	at metabase.server.middleware.session$wrap_session_id$fn__72996.invoke(session.clj:257),	at metabase.server.middleware.auth$wrap_static_api_key$fn__94437.invoke(auth.clj:30),	at ring.middleware.cookies$wrap_cookies$fn__105189.invoke(cookies.clj:194),	at metabase.server.middleware.misc$add_content_type$fn__67624.invoke(misc.clj:29),	at metabase.server.middleware.misc$disable_streaming_buffering$fn__67650.invoke(misc.clj:78),	at ring.middleware.gzip$wrap_gzip$fn__105231.invoke(gzip.clj:86),	at metabase.server.middleware.misc$bind_request$fn__67653.invoke(misc.clj:95),	at metabase.server.middleware.ssl$redirect_to_https_middleware$fn__105018.invoke(ssl.clj:41),	at metabase.server$async_proxy_handler$fn__68064.invoke(server.clj:78),	at metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source),	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173),	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122),	at org.eclipse.jetty.server.Server.handle(Server.java:563),	at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598),	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753),	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501),	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287),	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314),	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100),	at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199),	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411),	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969),	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194),	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149),	at java.base/java.lang.Thread.run(Unknown Source),Caused by: clojure.lang.ExceptionInfo: No fields found for table ""changelog"". {:table-id 2562, :type :invalid-query},	at metabase.query_processor.middleware.add_implicit_clauses$sorted_implicit_fields_for_table.invokeStatic(add_implicit_clauses.clj:35),	at metabase.query_processor.middleware.add_implicit_clauses$sorted_implicit_fields_for_table.invoke(add_implicit_clauses.clj:29),	at metabase.query_processor.middleware.add_implicit_clauses$add_implicit_fields.invokeStatic(add_implicit_clauses.clj:99),	at metabase.query_processor.middleware.add_implicit_clauses$add_implicit_fields.invoke(add_implicit_clauses.clj:92),	at metabase.query_processor.middleware.add_implicit_clauses$add_implicit_mbql_clauses$fn__64825.invoke(add_implicit_clauses.clj:143),	at clojure.walk$walk.invokeStatic(walk.clj:50),	at clojure.walk$postwalk.invokeStatic(walk.clj:53),	at clojure.walk$postwalk.invoke(walk.clj:53),	at metabase.query_processor.middleware.add_implicit_clauses$add_implicit_mbql_clauses.invokeStatic(add_implicit_clauses.clj:136),	at metabase.query_processor.middleware.add_implicit_clauses$add_implicit_mbql_clauses.invoke(add_implicit_clauses.clj:133),	at clojure.core$update.invokeStatic(core.clj:6232),	at clojure.core$update.invoke(core.clj:6224),	at metabase.query_processor.middleware.add_implicit_clauses$add_implicit_clauses.invokeStatic(add_implicit_clauses.clj:153),	at metabase.query_processor.middleware.add_implicit_clauses$add_implicit_clauses.invoke(add_implicit_clauses.clj:147),	at clojure.lang.Var.invoke(Var.java:384),	at metabase.query_processor$preprocess_STAR_$fn__73816.invoke(query_processor.clj:164),	at clojure.lang.PersistentVector.reduce(PersistentVector.java:343),	at clojure.core$reduce.invokeStatic(core.clj:6886),	at clojure.core$reduce.invoke(core.clj:6869),	at metabase.query_processor$preprocess_STAR_.invokeStatic(query_processor.clj:162),	at metabase.query_processor$preprocess_STAR_.invoke(query_processor.clj:157),	at metabase.query_processor$preprocess$fn__73844.invoke(query_processor.clj:321),	at metabase.query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__67100.invoke(fetch_source_query.clj:303),	at metabase.query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72567$fn__72571.invoke(resolve_database_and_driver.clj:77),	at metabase.driver$do_with_driver.invokeStatic(driver.clj:97),	at metabase.driver$do_with_driver.invoke(driver.clj:92),	at metabase.query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72567.invoke(resolve_database_and_driver.clj:76),	at metabase.query_processor.middleware.store$initialize_store$fn__67727$fn__67728.invoke(store.clj:14),	at metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169),	at metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:150),	at metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158),	at metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:150),	at metabase.query_processor.middleware.store$initialize_store$fn__67727.invoke(store.clj:13),	at metabase.query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72564.invoke(resolve_database_and_driver.clj:60),	at metabase.query_processor.middleware.normalize_query$normalize$fn__72869.invoke(normalize_query.clj:38),	at metabase.query_processor.middleware.enterprise$fn__72504$handle_audit_app_internal_queries__72505$fn__72507.invoke(enterprise.clj:96),	at metabase.query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72515.invoke(enterprise.clj:103),	at metabase.query_processor.middleware.prevent_infinite_recursive_preprocesses$prevent_infinite_recursive_preprocesses$fn__71571.invoke(prevent_infinite_recursive_preprocesses.clj:23),	at metabase.query_processor$preprocess.invokeStatic(query_processor.clj:322),	at metabase.query_processor$preprocess.invoke(query_processor.clj:313),	at clojure.lang.Var.invoke(Var.java:384),	at metabase.models.query.permissions$preprocess_query.invokeStatic(permissions.clj:137),	at metabase.models.query.permissions$preprocess_query.invoke(permissions.clj:132),	at metabase.models.query.permissions$mbql_permissions_path_set.invokeStatic(permissions.clj:154),	... 163 more
[068e27cb-5ab0-4347-9d8d-08937211cb25] 2024-06-07T14:32:07-03:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: No fields found for table ""changelog"".
{:database_id 67,
 :started_at #t ""2024-06-07T17:32:07.818758Z[GMT]"",
 :action_id nil,
 :error_type :invalid-query,
 :json_query
 {:database 67,
  :query {:source-table 2562},
  :type ""query"",
  :parameters [],
  :middleware {:js-int-to-string? true, :add-default-userland-constraints? true}},
 :native nil,
 :status :failed,
 :class clojure.lang.ExceptionInfo,
 :stacktrace
 [""--> query_processor.middleware.add_implicit_clauses$sorted_implicit_fields_for_table.invokeStatic(add_implicit_clauses.clj:35)""
  ""query_processor.middleware.add_implicit_clauses$sorted_implicit_fields_for_table.invoke(add_implicit_clauses.clj:29)""
  ""query_processor.middleware.add_implicit_clauses$add_implicit_fields.invokeStatic(add_implicit_clauses.clj:99)""
  ""query_processor.middleware.add_implicit_clauses$add_implicit_fields.invoke(add_implicit_clauses.clj:92)""
  ""query_processor.middleware.add_implicit_clauses$add_implicit_mbql_clauses$fn__64825.invoke(add_implicit_clauses.clj:143)""
  ""query_processor.middleware.add_implicit_clauses$add_implicit_mbql_clauses.invokeStatic(add_implicit_clauses.clj:136)""
  ""query_processor.middleware.add_implicit_clauses$add_implicit_mbql_clauses.invoke(add_implicit_clauses.clj:133)""
  ""query_processor.middleware.add_implicit_clauses$add_implicit_clauses.invokeStatic(add_implicit_clauses.clj:153)""
  ""query_processor.middleware.add_implicit_clauses$add_implicit_clauses.invoke(add_implicit_clauses.clj:147)""
  ""query_processor$preprocess_STAR_$fn__73816.invoke(query_processor.clj:164)""
  ""query_processor$preprocess_STAR_.invokeStatic(query_processor.clj:162)""
  ""query_processor$preprocess_STAR_.invoke(query_processor.clj:157)""
  ""query_processor$fn__73824$combined_pre_process__73825$combined_pre_process_STAR___73826.invoke(query_processor.clj:259)""
  ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__67100.invoke(fetch_source_query.clj:303)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72567$fn__72571.invoke(resolve_database_and_driver.clj:77)""
  ""driver$do_with_driver.invokeStatic(driver.clj:97)""
  ""driver$do_with_driver.invoke(driver.clj:92)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72567.invoke(resolve_database_and_driver.clj:76)""
  ""query_processor.middleware.store$initialize_store$fn__67727$fn__67728.invoke(store.clj:14)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.middleware.store$initialize_store$fn__67727.invoke(store.clj:13)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72564.invoke(resolve_database_and_driver.clj:60)""
  ""query_processor.middleware.normalize_query$normalize$fn__72869.invoke(normalize_query.clj:38)""
  ""query_processor.middleware.enterprise$fn__72504$handle_audit_app_internal_queries__72505$fn__72507.invoke(enterprise.clj:96)""
  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72515.invoke(enterprise.clj:103)""
  ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71630.invoke(constraints.clj:104)""
  ""query_processor.middleware.process_userland_query$process_userland_query$fn__72800.invoke(process_userland_query.clj:156)""
  ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__73401.invoke(catch_exceptions.clj:171)""
  ""query_processor.reducible$async_qp$qp_STAR___63219$thunk__63221.invoke(reducible.clj:126)""
  ""query_processor.reducible$async_qp$qp_STAR___63219.invoke(reducible.clj:132)""
  ""query_processor.reducible$sync_qp$qp_STAR___63231.doInvoke(reducible.clj:153)""
  ""query_processor$process_userland_query.invokeStatic(query_processor.clj:402)""
  ""query_processor$process_userland_query.doInvoke(query_processor.clj:398)""
  ""query_processor$process_query_and_save_execution_BANG_.invokeStatic(query_processor.clj:416)""
  ""query_processor$process_query_and_save_execution_BANG_.invoke(query_processor.clj:406)""
  ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invokeStatic(query_processor.clj:431)""
  ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invoke(query_processor.clj:421)""
  ""api.dataset$run_query_async$fn__94343.invoke(dataset.clj:79)""
  ""query_processor.streaming$streaming_response_STAR_$fn__53631$fn__53633.invoke(streaming.clj:168)""
  ""query_processor.streaming$streaming_response_STAR_$fn__53631.invoke(streaming.clj:167)""
  ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)""
  ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)""
  ""async.streaming_response$do_f_async$task__44086.invoke(streaming_response.clj:88)""],
 :card_id nil,
 :context :ad-hoc,
 :error ""No fields found for table \""changelog\""."",
 :row_count 0,
 :running_time 0,
 :preprocessed nil,
 :ex-data {:table-id 2562, :type :invalid-query},
 :data {:rows [], :cols []}}

**To Reproduce**
Steps to reproduce the behavior:
1. Create and populate database in Glue Data Catalog
2. Give permissions to it via LakeFormation to the user consuming it via Athena
3. Synch data with Metabase
4. See error

**Expected behavior**
All table schema and data showing correctly as the native query.



**Severity**
How severe an issue is this bug to you? Is this annoying, blocking some users, blocking an upgrade or blocking your usage of Metabase entirely?
Blocking usage of Metabase, as the tables don't show correctly.



**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""pt-BR"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.153"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mongo"",
      ""athena""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.2""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-05"",
      ""tag"": ""v0.49.14"",
      ""hash"": ""3606ed3""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```",WeslleyCsts,2024-06-07 17:47:02+00:00,[],2024-06-14 11:46:10+00:00,2024-06-14 11:46:10+00:00,https://github.com/metabase/metabase/issues/43852,"[('Type:Bug', 'Product defects'), ('Database/Athena', '')]","[{'comment_id': 2155501918, 'issue_id': 2340908939, 'author': 'WeslleyCsts', 'body': ""Just a quick update for more context:\r\n\r\nI've tried recreating the same table with another name on glue, using the same s3 path for the data and the same permission on Lake Formation, by doing this the created table shows all columns as it should be, I'm guessing this has something to do with Metabase or how it queries LakeFormation and somehow throttles it during too many requests"", 'created_at': datetime.datetime(2024, 6, 7, 20, 28, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2160777191, 'issue_id': 2340908939, 'author': 'ixipixi', 'body': ""@WeslleyCsts do you think this may be what you're seeing? \r\n\r\nhttps://github.com/metabase/metabase/issues/43980"", 'created_at': datetime.datetime(2024, 6, 11, 13, 30, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163969681, 'issue_id': 2340908939, 'author': 'calherries', 'body': ""@WeslleyCsts\r\n\r\n> I've tried recreating the same table with another name on glue\r\n\r\nFor the table you created where everything worked, did its name contain any underscores?"", 'created_at': datetime.datetime(2024, 6, 12, 21, 57, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2164033767, 'issue_id': 2340908939, 'author': 'paoliniluis', 'body': ""@ixipixi pinging you as you've been around here recently"", 'created_at': datetime.datetime(2024, 6, 12, 23, 2, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2166353638, 'issue_id': 2340908939, 'author': 'WeslleyCsts', 'body': 'Hi @calherries, guess this is the same issue as @ixipixi, all my tables with underscore are loaded correctly', 'created_at': datetime.datetime(2024, 6, 13, 17, 13, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2167850296, 'issue_id': 2340908939, 'author': 'darksciencebase', 'body': 'closing as duplicate then, the fix for https://github.com/metabase/metabase/issues/43980 will be shipped in the coming days', 'created_at': datetime.datetime(2024, 6, 14, 11, 46, 10, tzinfo=datetime.timezone.utc)}]","WeslleyCsts (Issue Creator) on (2024-06-07 20:28:51 UTC): Just a quick update for more context:

I've tried recreating the same table with another name on glue, using the same s3 path for the data and the same permission on Lake Formation, by doing this the created table shows all columns as it should be, I'm guessing this has something to do with Metabase or how it queries LakeFormation and somehow throttles it during too many requests

ixipixi on (2024-06-11 13:30:58 UTC): @WeslleyCsts do you think this may be what you're seeing? 

https://github.com/metabase/metabase/issues/43980

calherries on (2024-06-12 21:57:28 UTC): @WeslleyCsts


For the table you created where everything worked, did its name contain any underscores?

paoliniluis on (2024-06-12 23:02:08 UTC): @ixipixi pinging you as you've been around here recently

WeslleyCsts (Issue Creator) on (2024-06-13 17:13:14 UTC): Hi @calherries, guess this is the same issue as @ixipixi, all my tables with underscore are loaded correctly

darksciencebase on (2024-06-14 11:46:10 UTC): closing as duplicate then, the fix for https://github.com/metabase/metabase/issues/43980 will be shipped in the coming days

"
2340894606,issue,closed,completed,Remind PR author to prefix their PR title with conventional commit type,"A followed-up task to #42748 

[Discussed on Slack](https://metaboat.slack.com/archives/C063Q3F1HPF/p1717778600852229?thread_ts=1717701534.687259&cid=C063Q3F1HPF)

It's possible that we forgot to prefix our PR with the conventional commit when modifying embedding SDK code. So we should have some sort of automation to remind the author.",WiNloSt,2024-06-07 17:35:09+00:00,['WiNloSt'],2024-10-08 17:08:16+00:00,2024-06-11 06:30:37+00:00,https://github.com/metabase/metabase/issues/43850,"[('.CI & Tests', ''), ('.Team/Embedding', '')]",[],
2340818957,issue,closed,completed,[Epic] Re-design transparent theme for static embedding and public links,"**Links**
- [product doc](https://www.notion.so/metabase/Re-design-transparent-theme-for-static-embedding-and-public-links-a28e98a6e5c64301a48387c7b333d569)
- [testing plan](https://www.notion.so/metabase/Testing-plan-3e67037b08434033a5f653c83c622e92)
- [Figma file](https://www.figma.com/design/1YcsFf5yYdFZTguwoKVdkj/Re-design-the-transparent-background-setting-in-interactive-embedds?node-id=917-6518&t=xGtBN4rhXtqkfgnr-0)

Milestone 1 branch: [`43838-milestone-1-necessity`](https://github.com/metabase/metabase/tree/43838-milestone-1-necessity)
```[tasklist]
### Milestone 1 - Necessity
- [ ] https://github.com/metabase/metabase/issues/44068
- [x] Handle dashboard sticky filters on transparent background
- [ ] https://github.com/metabase/metabase/issues/44273
- [ ] https://github.com/metabase/metabase/issues/44476
- [ ] https://github.com/metabase/metabase/issues/45090
- [ ] https://github.com/metabase/metabase/issues/45202
- [ ] https://github.com/metabase/metabase/issues/45407
- [ ] https://github.com/metabase/metabase/issues/45427
- [ ] https://github.com/metabase/metabase/issues/45565
```

```[tasklist]
### Milestone 2 - Polishing
- [ ] https://github.com/metabase/metabase/issues/45723
- [ ] https://github.com/metabase/metabase/issues/46378
- [ ] https://github.com/metabase/metabase/issues/46419
```
```[tasklist]
### Future milestones
- [ ] https://github.com/metabase/metabase/issues/46479
- [x] Introduce hover colors
- [ ] Allow simulating user background color
- [ ] Match `.DashboardNight` (dashboard) to `.ThemeNight` (EmbedFrame)
- [ ] https://github.com/metabase/metabase/issues/45422
- [x] ensure SDK compatibility with new semantic colors
```
",WiNloSt,2024-06-07 16:37:44+00:00,[],2024-08-23 12:32:26+00:00,2024-08-23 12:32:25+00:00,https://github.com/metabase/metabase/issues/43838,"[('Reporting/Dashboards', ''), ('Embedding/Static', 'Static embedding, previously known as signed embedding'), ('.Epic', 'Feature Implementation or Project')]","[{'comment_id': 2306997505, 'issue_id': 2340818957, 'author': 'WiNloSt', 'body': 'We [discussed that](https://metaboat.slack.com/archives/C063Q3F1HPF/p1724398752339749?thread_ts=1724077872.663639&cid=C063Q3F1HPF) we can close this issue once the UTM tag is merged, which it has been.', 'created_at': datetime.datetime(2024, 8, 23, 12, 32, 26, tzinfo=datetime.timezone.utc)}]","WiNloSt (Issue Creator) on (2024-08-23 12:32:26 UTC): We [discussed that](https://metaboat.slack.com/archives/C063Q3F1HPF/p1724398752339749?thread_ts=1724077872.663639&cid=C063Q3F1HPF) we can close this issue once the UTM tag is merged, which it has been.

"
2340705289,issue,open,,Add option to show Settings Gear in Interactive embedding,"**Is your feature request related to a problem? Please describe.**
You might want to have users access their account settings or Admin settings, but you currently can't in interactive embedding.

**Describe the solution you'd like**
Ability to configure this as a parameter or to be enabled when enabling top_nav parameter
![Screenshot 2024-06-07 at 12 22 55 PM](https://github.com/metabase/metabase/assets/132273646/fcd0e1dc-63dd-40ad-82b1-37b862cab5fa)

**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
Requested by a customer, internal ticket: https://metabase.zendesk.com/agent/tickets/21588

**Additional context**
N/A
",ignacio-mb,2024-06-07 15:23:34+00:00,[],2024-06-07 15:31:35+00:00,,https://github.com/metabase/metabase/issues/43831,"[('Type:New Feature', ''), ('Administration/Settings', ''), ('Embedding/Interactive', 'Interactive Embedding, previously known as Full app embedding'), ('.Team/Embedding', '')]",[],
2340355280,issue,closed,completed,[Notifications] Webhook channel for alert,"**Links**
- product doc: https://www.notion.so/metabase/Enable-users-to-create-custom-webhook-notification-channels-da7234d688e344b2b376e22818f3c727 (WIP)
- high level eng doc: https://www.notion.so/metabase/Notification-high-level-design-9620a4a69db0494f806a146cc9174964
- Webhook tech doc: https://www.notion.so/metabase/Webhook-for-Alert-4f9c7727e06c4c958687c25e1eece21e?pvs=4
- Feature branch: [feat-http-channel](https://github.com/metabase/metabase/pull/45201)

**Implementation Plan**

```[tasklist]
### Milestone 1: Channel Refactor -- BE only
- [x] Create a new module: channel
- [x] Introduce a set of channels multi-methods
- [x] Migrate email and slacks to the new channel module
- [x] #43924
```


```[tasklist]
### Milestone 2.1: Setup page
- [x] [BE] [introduce a new multimethod `channel/can-connect?` and implement for http](https://github.com/metabase/metabase/pull/44955) (0.5 day)
- [x] [BE] [Add the `channel` table](https://github.com/metabase/metabase/pull/45207) (0.5 day)
- [x] [BE] [Implement channel CRUD APIs](https://github.com/metabase/metabase/pull/45207) (1.5 days)
- [x] [BE] [Implement test connection API ](https://github.com/metabase/metabase/pull/45207)(0.5 day)
- [ ] https://github.com/metabase/metabase/issues/45574
```

```[tasklist]
### Milestone 2.2: Implement HTTP channel (outcome: repl demo to send data to zapier)
- [x] [BE] https://github.com/metabase/metabase/pull/45545 (1 day)
```


```[tasklist]
### Milestone 2.3: Enable HTTP channel for alert
- [x] [BE] [Update `GET /api/pulse/form_input` to return HTTP channel details (0.5 day)](https://github.com/metabase/metabase/pull/45839)
- [x] [BE] [Update `POST /api/alert` and `PUT /api/alert/:id` to accept HTTP channels (0.5 day)](https://github.com/metabase/metabase/pull/45839)
- [x] [BE] [Update `POST /api/pulse/test` so that we can test HTTP channels for alert ( 1 day )](https://github.com/metabase/metabase/pull/45839)
- [x] [BE] [Do not show channel.details for non-admin users](https://github.com/metabase/metabase/pull/46034)
- [x] [BE] [Disable channel will delete pulse channel](https://github.com/metabase/metabase/pull/46115)
- [ ] https://github.com/metabase/metabase/issues/46341
- [ ] https://github.com/metabase/metabase/issues/46657
```
```[tasklist]
### Milestone 3: serdes and audit
- [x] [BE] [ensure we serdes channel properly (0.5 day)](https://github.com/metabase/metabase/pull/46031)
- [x] [BE] [audit log channel creation / update (0.5 day)](https://github.com/metabase/metabase/pull/46113)
- [x] [BE] [Record a `TaskHistory` for each `channel/send!` call. include the retry info](https://github.com/metabase/metabase/pull/46218)
```
",qnkhuat,2024-06-07 12:38:15+00:00,"['piranha', 'npfitz', 'qnkhuat']",2024-09-09 12:03:28+00:00,2024-08-30 08:07:56+00:00,https://github.com/metabase/metabase/issues/43822,"[('.Epic', 'Feature Implementation or Project'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2154774645, 'issue_id': 2340355280, 'author': 'darksciencebase', 'body': 'This will close https://github.com/metabase/metabase/issues/2298', 'created_at': datetime.datetime(2024, 6, 7, 12, 51, 53, tzinfo=datetime.timezone.utc)}]","darksciencebase on (2024-06-07 12:51:53 UTC): This will close https://github.com/metabase/metabase/issues/2298

"
2340320530,issue,closed,completed,Static dashboard does not consume proper width when under a flex parent in embedding SDK,"Static dashboard currently does not render with proper width when under a flexbox parent. It seems to be taking very small spaces.

## How to reproduce

- Try the following code snippet, you can set a fixed `w` and the static dashboard does not change.

```tsx
<Flex mih=""100vh"" w=""100%"">
    <StaticDashboard dashboardId={17} withTitle withDownloads />
 </Flex>
```

![Image](https://github.com/metabase/metabase/assets/4714175/601358be-a752-428d-b337-7f1b2889fb6b)

",heypoom,2024-06-07 12:18:45+00:00,['heypoom'],2024-10-08 17:08:14+00:00,2024-06-11 10:05:37+00:00,https://github.com/metabase/metabase/issues/43820,"[('Embedding/SDK', 'Embedding SDK for React')]",[],
2340316759,issue,closed,completed,Option to hide dashboard card title in embedding SDK,"Expose the `withCardTitle` prop to allow hiding dashboard card titles. This should be `true` by default.


```[tasklist]
### Blockers
- [ ] https://github.com/metabase/metabase/issues/43973
```
",heypoom,2024-06-07 12:16:36+00:00,['heypoom'],2024-10-08 17:07:45+00:00,2024-06-13 17:54:02+00:00,https://github.com/metabase/metabase/issues/43819,"[('Type:New Feature', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2340161276,issue,closed,completed,"In Admin / Performance / Data caching settings, the Save button is inaccessible when pushed offscreen by a long list of databases",,rafpaf,2024-06-07 10:45:58+00:00,['rafpaf'],2024-06-10 15:49:27+00:00,2024-06-10 15:49:26+00:00,https://github.com/metabase/metabase/issues/43813,"[('Type:Bug', 'Product defects'), ('.Backend', '')]",[],
2340042199,issue,closed,not_planned,Cannot update and save question - you don’t have permission to see that,"### Describe the bug

When I try to update and save an innocent SQL question, I get the error:

> Sorry, you don’t have permission to see that.

![image](https://github.com/metabase/metabase/assets/4390468/1c1ae527-63ed-4693-8035-11a278b444a2)


### To Reproduce

I have admin permissions and one question saved in Our Analytics.

When I modify it and run the query it works as expected.
When saving the question, overwriting the existing one, it will immediately fail.

The SQL is pretty innocent and runs against Athena. (shortened)

I simply add a few more rows to have up-to-date fx rates.

```sql
WITH CurrencyConversion (month, currency, rate) AS (
    SELECT month, currency, rate
    FROM (VALUES

(timestamp '2024-01-01', 'CHF', 0.9368227273),
(timestamp '2024-02-01', 'CHF', 0.9462190476),

(timestamp '2024-01-01', 'EUR', 1.0),
(timestamp '2024-02-01', 'EUR', 1.0)

    ) AS CurrencyConversion (month, currency, rate)
)
SELECT *
FROM CurrencyConversion
```

Strangely enough, I have a similar questions right next to it and no problems updating it.

### Expected behavior

Saving a change to a question should work especially considering I'm an admin.

### Logs

Metabase logs:

```
[6114bda0-916e-410b-9d52-bb99214b9d60] 2024-06-07T11:41:29+02:00 DEBUG metabase.server.middleware.log GET /api/alert/question/53 200 1.8 ms (1 DB calls) App DB connections: 2/15 Jetty threads: 4/50 (3 idle, 0 queued) (131 total active threads) Queries in flight: 0 (0 queued)
[6114bda0-916e-410b-9d52-bb99214b9d60] 2024-06-07T11:41:31+02:00 DEBUG metabase.server.middleware.log POST /api/card/53/query 202 [ASYNC: completed] 710.0 ms (15 DB calls) App DB connections: 3/15 Jetty threads: 2/50 (4 idle, 0 queued) (131 total active threads) Queries in flight: 0 (0 queued); athena DB 4 connections: 0/1 (0 threads blocked)
```

Chrome console:

![image](https://github.com/metabase/metabase/assets/4390468/fbc8feb8-5962-4837-a0f0-67fb21054693)

### Information about your Metabase installation

```JSON
Hosted on AWS.

Metabase -> Athena -> S3 -> ORC files


{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.215-203.850.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Zurich""
  },
  ""metabase-info"": {
    ""databases"": [
      ""athena"",
      ""mysql""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""13.13""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-09"",
      ""tag"": ""v0.49.9"",
      ""hash"": ""c0913c7""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Zurich""
    }
  }
}
```


### Severity

Blocks updating questions that are used in different places

### Additional context

_No response_",etoulas,2024-06-07 09:50:05+00:00,[],2024-11-20 20:25:44+00:00,2024-11-20 20:25:43+00:00,https://github.com/metabase/metabase/issues/43807,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Administration/Permissions', 'Collection or Data permissions'), ('Organization/Saved Questions', ''), ('Database/Athena', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2203370508, 'issue_id': 2340042199, 'author': 'etoulas', 'body': 'The issue _could_ be related to the cast that is happening here.\r\n\r\nI saw similar issues with the Amazon Athena connector when calling CAST() explicitly.\r\n\r\nHowever, I have another currency table that has a lot more `timestamp ...` casts and there is no problem saving that one.', 'created_at': datetime.datetime(2024, 7, 2, 14, 27, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2298323641, 'issue_id': 2340042199, 'author': 'etoulas', 'body': 'Another input.\r\n\r\nI managed to workaround the problem for that particular question with fx rates:\r\n\r\nI used ""Format query"" in the SQL editor. After that I could save without problem.\r\n\r\nIt looks like the SQL format has to match some expectation somewhere.\r\n\r\n(Side note: in a previous setup that connected to a Postgres DB I sometimes ran into a similar issue if the last line of the query contained a `-- comment`. I thought I mention it, even though it is not exactly the same issue.)', 'created_at': datetime.datetime(2024, 8, 20, 8, 50, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2489479869, 'issue_id': 2340042199, 'author': 'paoliniluis', 'body': '@etoulas can you upgrade to v51? this probably is a bug we have already fixed', 'created_at': datetime.datetime(2024, 11, 20, 20, 25, 43, tzinfo=datetime.timezone.utc)}]","etoulas (Issue Creator) on (2024-07-02 14:27:42 UTC): The issue _could_ be related to the cast that is happening here.

I saw similar issues with the Amazon Athena connector when calling CAST() explicitly.

However, I have another currency table that has a lot more `timestamp ...` casts and there is no problem saving that one.

etoulas (Issue Creator) on (2024-08-20 08:50:56 UTC): Another input.

I managed to workaround the problem for that particular question with fx rates:

I used ""Format query"" in the SQL editor. After that I could save without problem.

It looks like the SQL format has to match some expectation somewhere.

(Side note: in a previous setup that connected to a Postgres DB I sometimes ran into a similar issue if the last line of the query contained a `-- comment`. I thought I mention it, even though it is not exactly the same issue.)

paoliniluis on (2024-11-20 20:25:43 UTC): @etoulas can you upgrade to v51? this probably is a bug we have already fixed

"
2340032915,issue,closed,completed,"Testing plan for ""Make dashboard filter auto-wire less presumptuous""","**Context**
- [epic](https://github.com/metabase/metabase/issues/43182)

+ Replace card
	+ [x] toast is shown
	+ multiple filters can be mapped
       + [x] message contains number of filters
    + single filter can be mapped
       + [x] message contains filter name
+ Add card 
	+ [x] toast is shown
	+ multiple filters can be mapped
       + [x] message contains number of filters
    + single filter can be mapped
       + [x] message contains filter name
+ Add mapping
	+ single tab
      + [x] message is shown
    + multi tab
      + [x] message with a postfix ""in current tab"" is shown
+ Remove filter
  + [x] toast is dismissed

Unit tests
- actions/card
	- [x] add card doesn't update parameter_mappings
	- [x] replace card doesn't update parameter_mappings
",uladzimirdev,2024-06-07 09:45:00+00:00,['uladzimirdev'],2024-06-24 15:40:12+00:00,2024-06-24 15:40:12+00:00,https://github.com/metabase/metabase/issues/43806,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2339512699,issue,closed,not_planned,Field Filter can't auto search and return the matched list whatever we did in both dashboard filter and questions filter,"### Describe the bug

no matched items listed when I input a value in the dropdown list of Dashboard filter.

same issues happened in question filter.

![image](https://github.com/metabase/metabase/assets/863963/77178a91-3772-4712-a2d8-a2e1cc7d35ae)
![image](https://github.com/metabase/metabase/assets/863963/d5a11b26-719c-40c2-a13c-18fee470dbe0)


for the table,  I have done the configuration in table metadata with admin 
![image](https://github.com/metabase/metabase/assets/863963/d13c66ce-f698-4c49-9269-b88f2f3792bc)
DB is clickhouse
metabase version v0.49.11

### To Reproduce

create a question, 
add a filter for a category field.  there are values list in the dropdown list
when input a value in inputbox of the dropdown list. nothing return Even if it should match many items


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Microsoft Edge  125.0.2535.85   (64 bit)
DB is clickhouse:  ClickHouse server version 22.8.21.38 (official build).
metabase version v0.49.11

Below is the error in metabase log:

[562e5813-8c9b-43a8-812e-5c59d5a56f91] 2024-06-07T11:34:43+08:00 ERROR metabase.api.field Error searching field values,java.lang.RuntimeException: [:ref :metabase.mbql.schema/value] is not a valid sequence schema; a valid sequence schema consists of zero or more `one` elements, followed by zero or more `optional` elements, followed by an optional schema that will match the remaining elements.,	at schema.core$parse_sequence_schema.invokeStatic(core.cljc:940),	at schema.core$parse_sequence_schema.invoke(core.cljc:932),	at schema.core$fn__5625.invokeStatic(core.cljc:958),	at schema.core$fn__5625.invoke(core.cljc:948),	at schema.core$fn__4702$G__4684__4707.invoke(core.cljc:96),	at schema.core$checker$fn__4726.invoke(core.cljc:128),	at schema.spec.core$sub_checker$fn__4514.invoke(core.cljc:95),	at schema.spec.core$with_cache.invokeStatic(core.cljc:83),	at schema.spec.core$with_cache.invoke(core.cljc:74),	at schema.spec.core$sub_checker.invokeStatic(core.cljc:93),	at schema.spec.core$sub_checker.invoke(core.cljc:88),	at schema.spec.variant$option_step.invokeStatic(variant.cljc:14),	at schema.spec.variant$option_step.invoke(variant.cljc:12),	at schema.spec.variant.VariantSpec$fn__4578.invoke(variant.cljc:47),	at clojure.lang.PersistentList.reduce(PersistentList.java:141),	at clojure.core$reduce.invokeStatic(core.clj:6886),	at clojure.core$reduce.invoke(core.clj:6869),	at schema.spec.variant.VariantSpec.checker(variant.cljc:45),	at schema.core$checker$fn__4726.invoke(core.cljc:128),	at schema.spec.core$sub_checker$fn__4514.invoke(core.cljc:95),	at schema.spec.core$with_cache.invokeStatic(core.cljc:83),	at schema.spec.core$with_cache.invoke(core.cljc:74),	at schema.spec.core$sub_checker.invokeStatic(core.cljc:93),	at schema.spec.core$sub_checker.invoke(core.cljc:88),	at schema.spec.variant$option_step.invokeStatic(variant.cljc:14),	at schema.spec.variant$option_step.invoke(variant.cljc:12),	at schema.spec.variant.VariantSpec$fn__4578.invoke(variant.cljc:47),	at clojure.lang.PersistentList.reduce(PersistentList.java:141),	at clojure.core$reduce.invokeStatic(core.clj:6886),	at clojure.core$reduce.invoke(core.clj:6869),	at schema.spec.variant.VariantSpec.checker(variant.cljc:45),	at schema.core$checker$fn__4726.invoke(core.cljc:128),	at schema.spec.core$sub_checker$fn__4514.invoke(core.cljc:95),	at schema.spec.core$with_cache.invokeStatic(core.cljc:83),	at schema.spec.core$with_cache.invoke(core.cljc:74),	at schema.spec.core$sub_checker.invokeStatic(core.cljc:93),	at schema.spec.core$sub_checker.invoke(core.cljc:88),	at schema.spec.collection$element_transformer.invokeStatic(collection.cljc:34),	at schema.spec.collection$element_transformer.invoke(collection.cljc:16),	at schema.spec.collection$sequence_transformer$fn__4631.invoke(collection.cljc:45),	at clojure.lang.PersistentList.reduce(PersistentList.java:144),	at clojure.core$reduce.invokeStatic(core.clj:6886),	at clojure.core$reduce.invoke(core.clj:6869),	at schema.spec.collection$sequence_transformer.invokeStatic(collection.cljc:43),	at schema.spec.collection$sequence_transformer.invoke(collection.cljc:40),	at schema.spec.collection.CollectionSpec.checker(collection.cljc:75),	at schema.core$checker$fn__4726.invoke(core.cljc:128),	at schema.spec.core$run_checker.invokeStatic(core.cljc:68),	at schema.spec.core$run_checker.invoke(core.cljc:64),	at schema.core$checker.invokeStatic(core.cljc:127),	at schema.core$checker.invoke(core.cljc:122),	at metabase.driver.clickhouse_qp$fn__91038$fn__91041.invoke(clickhouse_qp.clj:293),	at clojure.lang.Delay.deref(Delay.java:42),	at clojure.core$deref.invokeStatic(core.clj:2337),	at clojure.core$deref.invoke(core.clj:2323),	at metabase.driver.clickhouse_qp$fn__91038$update_string_value__91045.invoke(clickhouse_qp.clj:293),	at metabase.driver.clickhouse_qp$fn__91060.invokeStatic(clickhouse_qp.clj:301),	at metabase.driver.clickhouse_qp$fn__91060.invoke(clickhouse_qp.clj:297),	at clojure.lang.MultiFn.invoke(MultiFn.java:234),	at clojure.core$partial$fn__5908.invoke(core.clj:2641),	at clojure.core$map$fn__5931$fn__5932.invoke(core.clj:2759),	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:63),	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136),	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124),	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19),	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31),	at clojure.core.protocols$fn__8234.invokeStatic(protocols.clj:75),	at clojure.core.protocols$fn__8234.invoke(protocols.clj:75),	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13),	at clojure.core$transduce.invokeStatic(core.clj:6948),	at clojure.core$into.invokeStatic(core.clj:6963),	at clojure.core$into.invoke(core.clj:6951),	at metabase.driver.sql.query_processor$fn__66243.invokeStatic(query_processor.clj:1147),	at metabase.driver.sql.query_processor$fn__66243.invoke(query_processor.clj:1145),	at clojure.lang.MultiFn.invoke(MultiFn.java:234),	at metabase.driver.sql.query_processor$fn__66261.invokeStatic(query_processor.clj:1168),	at metabase.driver.sql.query_processor$fn__66261.invoke(query_processor.clj:1166),	at clojure.lang.MultiFn.invoke(MultiFn.java:244),	at metabase.driver.sql.query_processor$apply_top_level_clauses$fn__66367.invoke(query_processor.clj:1407),	at clojure.lang.ArraySeq.reduce(ArraySeq.java:119),	at clojure.core$transduce.invokeStatic(core.clj:6947),	at clojure.core$transduce.invoke(core.clj:6934),	at metabase.driver.sql.query_processor$apply_top_level_clauses.invokeStatic(query_processor.clj:1401),	at metabase.driver.sql.query_processor$apply_top_level_clauses.invoke(query_processor.clj:1394),	at metabase.driver.sql.query_processor$apply_top_level_clauses.invokeStatic(query_processor.clj:1398),	at metabase.driver.sql.query_processor$apply_top_level_clauses.invoke(query_processor.clj:1394),	at metabase.driver.sql.query_processor$apply_clauses.invokeStatic(query_processor.clj:1464),	at metabase.driver.sql.query_processor$apply_clauses.invoke(query_processor.clj:1452),	at metabase.driver.sql.query_processor$mbql__GT_honeysql.invokeStatic(query_processor.clj:1484),	at metabase.driver.sql.query_processor$mbql__GT_honeysql.invoke(query_processor.clj:1478),	at metabase.driver.sql.query_processor$mbql__GT_native.invokeStatic(query_processor.clj:1493),	at metabase.driver.sql.query_processor$mbql__GT_native.invoke(query_processor.clj:1489),	at metabase.driver.sql$fn__83379.invokeStatic(sql.clj:49),	at metabase.driver.sql$fn__83379.invoke(sql.clj:47),	at clojure.lang.MultiFn.invoke(MultiFn.java:234),	at metabase.query_processor.middleware.mbql_to_native$query__GT_native_form.invokeStatic(mbql_to_native.clj:14),	at metabase.query_processor.middleware.mbql_to_native$query__GT_native_form.invoke(mbql_to_native.clj:9),	at metabase.query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71570.invoke(mbql_to_native.clj:21),	at metabase.query_processor$fn__73475$combined_post_process__73480$combined_post_process_STAR___73481.invoke(query_processor.clj:262),	at metabase.query_processor$fn__73475$combined_pre_process__73476$combined_pre_process_STAR___73477.invoke(query_processor.clj:259),	at metabase.query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66753.invoke(fetch_source_query.clj:303),	at metabase.query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72218$fn__72222.invoke(resolve_database_and_driver.clj:77),	at metabase.driver$do_with_driver.invokeStatic(driver.clj:97),	at metabase.driver$do_with_driver.invoke(driver.clj:92),	at metabase.query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72218.invoke(resolve_database_and_driver.clj:76),	at metabase.query_processor.middleware.store$initialize_store$fn__67380$fn__67381.invoke(store.clj:14),	at metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169),	at metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:150),	at metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158),	at metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:150),	at metabase.query_processor.middleware.store$initialize_store$fn__67380.invoke(store.clj:13),	at metabase.query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72215.invoke(resolve_database_and_driver.clj:60),	at metabase.query_processor.middleware.normalize_query$normalize$fn__72520.invoke(normalize_query.clj:38),	at metabase.query_processor.middleware.enterprise$fn__72155$handle_audit_app_internal_queries__72156$fn__72158.invoke(enterprise.clj:96),	at metabase.query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72166.invoke(enterprise.clj:103),	at metabase.query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126),	at metabase.query_processor.reducible$async_qp$qp_STAR___62893.invoke(reducible.clj:132),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at metabase.query_processor.reducible$sync_qp$qp_STAR___62905.doInvoke(reducible.clj:153),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at metabase.query_processor$process_query.invokeStatic(query_processor.clj:311),	at metabase.query_processor$process_query.invoke(query_processor.clj:291),	at metabase.models.params.chain_filter$unremapped_chain_filter.invokeStatic(chain_filter.clj:444),	at metabase.models.params.chain_filter$unremapped_chain_filter.invoke(chain_filter.clj:435),	at metabase.models.params.chain_filter$unremapped_chain_filter_search.invokeStatic(chain_filter.clj:623),	at metabase.models.params.chain_filter$unremapped_chain_filter_search.invoke(chain_filter.clj:613),	at metabase.models.params.chain_filter$chain_filter_search.invokeStatic(chain_filter.clj:707),	at metabase.models.params.chain_filter$chain_filter_search.doInvoke(chain_filter.clj:680),	at clojure.lang.RestFn.invoke(RestFn.java:494),	at metabase.api.dashboard$chain_filter$fn__95181.invoke(dashboard.clj:1005),	at clojure.core$map$fn__5935.invoke(core.clj:2772),	at clojure.lang.LazySeq.sval(LazySeq.java:42),	at clojure.lang.LazySeq.seq(LazySeq.java:51),	at clojure.lang.RT.seq(RT.java:535),	at clojure.core$seq__5467.invokeStatic(core.clj:139),	at clojure.core$map$fn__5935.invoke(core.clj:2763),	at clojure.lang.LazySeq.sval(LazySeq.java:42),	at clojure.lang.LazySeq.seq(LazySeq.java:51),	at clojure.lang.RT.seq(RT.java:535),	at clojure.core$seq__5467.invokeStatic(core.clj:139),	at clojure.core$apply.invokeStatic(core.clj:662),	at clojure.core$mapcat.invokeStatic(core.clj:2800),	at clojure.core$mapcat.doInvoke(core.clj:2800),	at clojure.lang.RestFn.invoke(RestFn.java:423),	at metabase.api.dashboard$chain_filter.invokeStatic(dashboard.clj:1008),	at metabase.api.dashboard$chain_filter.invoke(dashboard.clj:983),	at metabase.api.dashboard$param_values$fn__95189.invoke(dashboard.clj:1045),	at metabase.models.params.custom_values$parameter__GT_values.invokeStatic(custom_values.clj:134),	at metabase.models.params.custom_values$parameter__GT_values.invoke(custom_values.clj:119),	at metabase.api.dashboard$param_values.invokeStatic(dashboard.clj:1042),	at metabase.api.dashboard$param_values.invoke(dashboard.clj:1022),	at metabase.api.dashboard$fn__95197$fn__95199.invoke(dashboard.clj:1075),	at metabase.api.dashboard$fn__95197.invokeStatic(dashboard.clj:1074),	at metabase.api.dashboard$fn__95197.invoke(dashboard.clj:1060),	at compojure.core$wrap_response$fn__44694.invoke(core.clj:160),	at compojure.core$wrap_route_middleware$fn__44678.invoke(core.clj:132),	at compojure.core$wrap_route_info$fn__44683.invoke(core.clj:139),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:151),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:152),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:153),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:153),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:153),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:152),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:152),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:152),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:153),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:153),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:152),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:153),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:153),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706.invoke(core.clj:200),	at metabase.server.middleware.auth$enforce_authentication$fn__94049.invoke(auth.clj:17),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706.invoke(core.clj:200),	at compojure.core$make_context$handler__44734.invoke(core.clj:290),	at compojure.core$make_context$fn__44738.invoke(core.clj:300),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$make_context$fn__44738.invoke(core.clj:301),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$make_context$fn__44738.invoke(core.clj:301),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$make_context$fn__44738.invoke(core.clj:301),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$make_context$fn__44738.invoke(core.clj:301),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$make_context$fn__44738.invoke(core.clj:301),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$make_context$fn__44738.invoke(core.clj:301),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$make_context$fn__44738.invoke(core.clj:301),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at metabase.api.routes$fn__102082$fn__102085.invoke(routes.clj:67),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706.invoke(core.clj:200),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at metabase.server.routes$fn__102247$fn__102248.doInvoke(routes.clj:72),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706.invoke(core.clj:200),	at compojure.core$make_context$handler__44734.invoke(core.clj:290),	at compojure.core$make_context$fn__44738.invoke(core.clj:300),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:152),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:152),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:152),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197),	at metabase.server.routes$fn__102232$fn__102234.invoke(routes.clj:49),	at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198),	at compojure.core$routes$fn__44706.invoke(core.clj:200),	at metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__98793.invoke(exceptions.clj:108),	at metabase.server.middleware.exceptions$catch_api_exceptions$fn__98790.invoke(exceptions.clj:96),	at metabase.server.middleware.log$log_api_call$fn__102524$fn__102525$fn__102526.invoke(log.clj:230),	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:18),	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12),	at metabase.server.middleware.log$log_api_call$fn__102524$fn__102525.invoke(log.clj:222),	at toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112),	at toucan2.execute$do_with_call_counts.invoke(execute.clj:103),	at metabase.server.middleware.log$log_api_call$fn__102524.invoke(log.clj:221),	at metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__104589.invoke(browser_cookie.clj:40),	at metabase.server.middleware.security$add_security_headers$fn__98749.invoke(security.clj:182),	at metabase.server.middleware.json$wrap_json_body$fn__46051.invoke(json.clj:67),	at metabase.server.middleware.offset_paging$handle_paging$fn__84947.invoke(offset_paging.clj:43),	at metabase.server.middleware.json$wrap_streamed_json_response$fn__46069.invoke(json.clj:103),	at ring.middleware.keyword_params$wrap_keyword_params$fn__104856.invoke(keyword_params.clj:55),	at ring.middleware.params$wrap_params$fn__104875.invoke(params.clj:77),	at metabase.server.middleware.misc$maybe_set_site_url$fn__67295.invoke(misc.clj:61),	at metabase.server.middleware.session$reset_session_timeout$fn__72726.invoke(session.clj:546),	at metabase.server.middleware.session$bind_current_user$fn__72692$fn__72693.invoke(session.clj:440),	at metabase.server.middleware.session$do_with_current_user.invokeStatic(session.clj:419),	at metabase.server.middleware.session$do_with_current_user.invoke(session.clj:403),	at metabase.server.middleware.session$bind_current_user$fn__72692.invoke(session.clj:439),	at metabase.server.middleware.session$wrap_current_user_info$fn__72675.invoke(session.clj:378),	at metabase.server.middleware.session$wrap_session_id$fn__72647.invoke(session.clj:257),	at metabase.server.middleware.auth$wrap_static_api_key$fn__94057.invoke(auth.clj:30),	at ring.middleware.cookies$wrap_cookies$fn__104776.invoke(cookies.clj:194),	at metabase.server.middleware.misc$add_content_type$fn__67277.invoke(misc.clj:29),	at metabase.server.middleware.misc$disable_streaming_buffering$fn__67303.invoke(misc.clj:78),	at ring.middleware.gzip$wrap_gzip$fn__104818.invoke(gzip.clj:86),	at metabase.server.middleware.misc$bind_request$fn__67306.invoke(misc.clj:95),	at metabase.server.middleware.ssl$redirect_to_https_middleware$fn__104605.invoke(ssl.clj:41),	at metabase.server$async_proxy_handler$fn__67717.invoke(server.clj:78),	at metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source),	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173),	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122),	at org.eclipse.jetty.server.Server.handle(Server.java:563),	at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598),	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753),	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501),	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287),	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314),	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100),	at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199),	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411),	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969),	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194),	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149),	at java.base/java.lang.Thread.run(Unknown Source)
```


### Severity

very serious. 

### Additional context

_No response_",bladexxx,2024-06-07 03:37:05+00:00,[],2024-06-07 17:46:46+00:00,2024-06-07 03:53:19+00:00,https://github.com/metabase/metabase/issues/43803,"[('Type:Bug', 'Product defects'), ('.Frontend', ''), ('.Needs Triage', '')]","[{'comment_id': 2153832627, 'issue_id': 2339512699, 'author': 'bladexxx', 'body': 'I resolved this issue after I upgraded the clickhouse driver !  not metabase issue.', 'created_at': datetime.datetime(2024, 6, 7, 3, 53, 16, tzinfo=datetime.timezone.utc)}]","bladexxx (Issue Creator) on (2024-06-07 03:53:16 UTC): I resolved this issue after I upgraded the clickhouse driver !  not metabase issue.

"
2339307784,issue,closed,completed,Clicking two times over the metabase logo will return that something's wrong,"### Describe the bug

Weird bug probably related to https://github.com/metabase/metabase/issues/41563?

### To Reproduce

1) in the home page of stats, do double click to the logo
2) see the error

### Expected behavior

we should load the home page?

### Logs

NA

### Information about your Metabase installation

```JSON
master
```


### Severity

P1

### Additional context

![image](https://github.com/metabase/metabase/assets/1711649/c0d300cb-f5e7-4472-a083-cdea340904f6)
",paoliniluis,2024-06-06 23:37:31+00:00,['kulyk'],2024-06-10 20:33:41+00:00,2024-06-10 14:30:08+00:00,https://github.com/metabase/metabase/issues/43800,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.')]",[],
2339296044,issue,closed,completed,Column metadata gets lost when connecting a filter to a model,"### Describe the bug

Interesting bug of metadata not there so filters can never show the fields in the filters

### To Reproduce

1) Do a query like the following
![image](https://github.com/metabase/metabase/assets/1711649/03800771-6f26-4953-a73c-4ffb016b96e9)
2) save it as a model
3) go to a dashboard and add a filter connected to the user source
4) see that the filter values will never appear

### Expected behavior

We should show the filter values (in fact we show those for product category)

### Logs

NA

### Information about your Metabase installation

```JSON
v50 (don't know if it's also in versions below that)
```


### Severity

P1

### Additional context

NA",paoliniluis,2024-06-06 23:26:05+00:00,"['bshepherdson', 'ranquild']",2024-08-28 02:09:52+00:00,2024-06-07 22:47:51+00:00,https://github.com/metabase/metabase/issues/43799,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Dashboards', ''), ('Querying/MBQL', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('.Backend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('Querying/Models', 'aka Datasets'), ('.Team/Querying', '')]",[],
2339250852,issue,closed,completed,wrong color in legend and chart for null dimension,"<img width=""1297"" alt=""Screenshot 2024-06-06 at 3 32 49 PM"" src=""https://github.com/metabase/metabase/assets/37751258/362833c3-4943-48b1-aad3-fa6d2c0256ab"">
",EmmadUsmani,2024-06-06 22:34:02+00:00,['EmmadUsmani'],2024-06-07 18:17:43+00:00,2024-06-07 18:17:41+00:00,https://github.com/metabase/metabase/issues/43797,"[('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.')]","[{'comment_id': 2155307868, 'issue_id': 2339250852, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/61311d793f77d250da0b93e93096f735b576c94c', 'created_at': datetime.datetime(2024, 6, 7, 18, 17, 41, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-07 18:17:41 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/61311d793f77d250da0b93e93096f735b576c94c

"
2339235603,issue,closed,completed,Downloading a gauge chart as a png will crash browser tab or take a ridiculously long time,"### Describe the bug

Trying to download a gauge chart will crash your browser tab or take 2+ min

I tried this both from the question as well as from the dashboard and on several gauges in stats.

### To Reproduce

1.  Go to stats.metabase.com 
2. Attempt to download a png of the Open Bugs gauge


### Expected behavior

It should just work

### Logs

I created a jam and will post that somewhere in slack

### Information about your Metabase installation

```JSON
- master as of June 6
- Using Chrome
```


### Severity

Lightly annoying after getting my browser back

### Additional context

_No response_",cbalusek,2024-06-06 22:17:28+00:00,[],2024-06-11 12:24:11+00:00,2024-06-11 12:23:45+00:00,https://github.com/metabase/metabase/issues/43795,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/', ''), ('Visualization/Scalars', 'Numbers, progress bars, gauges'), ('Visualization/Download', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2153533195, 'issue_id': 2339235603, 'author': 'paoliniluis', 'body': ""P2 since it's a gauge... but the issue is concerning"", 'created_at': datetime.datetime(2024, 6, 6, 23, 2, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2160627776, 'issue_id': 2339235603, 'author': 'kulyk', 'body': 'Apparently, it was caused by a browser extension installed by some people on the team. Exports work much master without the extension', 'created_at': datetime.datetime(2024, 6, 11, 12, 23, 45, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-06 23:02:59 UTC): P2 since it's a gauge... but the issue is concerning

kulyk on (2024-06-11 12:23:45 UTC): Apparently, it was caused by a browser extension installed by some people on the team. Exports work much master without the extension

"
2339208370,issue,closed,completed,firing an x-ray made of aggregated fields will generate bad wrong queries,"### Describe the bug

If you try to x-ray some model that was made with aggregations, then the x-ray will fail with all questions being wrong

### To Reproduce

1) build a question like 
![image](https://github.com/metabase/metabase/assets/1711649/3c49c260-ca85-4509-9edd-051a4e64e6aa)
2) save it as a model
3) then do an x-ray on the model

see the dashboard failing on every question

### Expected behavior

It should work

### Logs

![image](https://github.com/metabase/metabase/assets/1711649/8b2fdbf6-4152-4fbe-a163-bfeac6ad24fa)

ERROR: column source.user_id does not exist
  Position: 926



### Information about your Metabase installation

```JSON
v50, but probably comes from a previous version
```


### Severity

P1

### Additional context

NA",paoliniluis,2024-06-06 21:51:12+00:00,['snoe'],2024-08-28 02:09:52+00:00,2024-07-05 17:31:44+00:00,https://github.com/metabase/metabase/issues/43793,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2339150410,issue,open,,Visualization: Marimekko chart,"**Is your feature request related to a problem? Please describe.**
Visualize data using a Marimekko chart

![image](https://github.com/metabase/metabase/assets/17803548/8be08c93-683a-48b0-bcb8-5d13f4a542e1)


**Describe the solution you'd like**
Allow the data to be display in this format. 


⬇️ Please click the 👍 reaction instead of leaving a +1 or update? comment",psalinasy,2024-06-06 21:02:49+00:00,[],2024-06-06 23:04:23+00:00,,https://github.com/metabase/metabase/issues/43789,"[('Type:New Feature', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.')]",[],
2339051492,issue,closed,completed,Row Chart x-axis formatting applies column metric scaling twice ,"This fix was supposed to make it into the fix for:

- https://github.com/metabase/metabase/pull/43668

but ended up being lost because the latest changes were not pushed up to the branch before merging.

---

### Demo

**No column scaling** :heavy_check_mark: 

![image](https://github.com/metabase/metabase/assets/22608765/0ea96a67-39d0-41ef-876b-f92566f4d337)

**With column scaling** :x:

![image](https://github.com/metabase/metabase/assets/22608765/8414c404-ea2b-435f-a912-748b76cc4526)
_The tick values should go from 500000 to 50000, but the scaling gets applied twice so it changes to 5000. Everything else works as expected_",JesseSDevaney,2024-06-06 19:55:46+00:00,['JesseSDevaney'],2024-06-07 17:42:44+00:00,2024-06-06 22:26:55+00:00,https://github.com/metabase/metabase/issues/43779,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('Visualization/Charts/Row', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2338908819,issue,closed,not_planned,PostgreSQL integer fields getting auto-detected as 'Category',"Metabase is auto-detecting PG integer fields as 'Category' when there are zeroes or null values, or even only a few distinct values.  I can fix this in the Table Metadata Admin dialogue, but every time the table is recreated I have to do this again.  It seems like the default should just be to accept the PG field defined as integer to be'Quantity', as this is a much more common scenario than using integers as 'Category'",sasignell,2024-06-06 18:28:51+00:00,[],2024-12-24 11:38:06+00:00,2024-06-24 13:25:04+00:00,https://github.com/metabase/metabase/issues/43776,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Database/Postgres', None), ('Administration/Metadata & Sync', ''), ('Administration/Table Metadata', ''), ('.Backend', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2153533655, 'issue_id': 2338908819, 'author': 'paoliniluis', 'body': 'Version? DDL of the table?', 'created_at': datetime.datetime(2024, 6, 6, 23, 3, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2154858134, 'issue_id': 2338908819, 'author': 'sasignell', 'body': 'Hello,\r\n   Thanks for the prompt reply.\r\n\r\nThe PG version is PostgreSQL 10.23 (Ubuntu 10.23-0ubuntu0.18.04.2) on\r\nx86_64-pc-linux-gnu, compiled by gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0,\r\n64-bit\r\nMetabase version is v1.49.13\r\n\r\nDDL of table (I believe) is\r\n\r\n-- FOREIGN TABLE: reports.li_daily_tech_report\r\n\r\n-- DROP FOREIGN TABLE IF EXISTS reports.li_daily_tech_report;\r\n\r\nCREATE FOREIGN TABLE IF NOT EXISTS reports.li_daily_tech_report(\r\n    date date,\r\n    tech text COLLATE pg_catalog.""default"",\r\n    inspections_completed integer,\r\n    appts_completed integer,\r\n    meters_total integer,\r\n    outside_meters integer,\r\n    inside_meters integer,\r\n    door_hangers integer,\r\n    wait_time integer,\r\n    dispatches integer,\r\n    poe_seals integer\r\n)\r\n    SERVER li_daily_tech_report\r\n    OPTIONS (program E\'curl -d \'\'{\r\n        ""q"": ""WITH a AS (SELECT technician_parent AS\r\ntech,COALESCE(is_meter_outside,$$no$$) AS is_meter_outside,CASE WHEN\r\nis_meter_count_correct=$$no$$ THEN updated_meter_count::integer ELSE\r\nmeter_count::integer END AS\r\nmeter_count_corrected,door_hanger_date,inspection_completed_date,\r\nappointment_date, CASE WHEN appointment_date=inspection_completed_date THEN\r\n1 ELSE 0 END AS appt_completed FROM \\\\""LI Service Line Inspection 2021\\\\""\r\nWHERE inspection_completed_date=current_date-1) , b AS (SELECT tech,\r\nCOUNT(*) AS inspections_completed, SUM(appt_completed) AS appts_completed,\r\nSUM(meter_count_corrected) AS meters_total, SUM(CASE WHEN\r\nis_meter_outside=$$yes$$ THEN meter_count_corrected ELSE 0 END) AS\r\noutside_meters, SUM(CASE WHEN is_meter_outside=$$no$$ THEN\r\nmeter_count_corrected ELSE 0 END) AS inside_meters FROM a WHERE tech IS NOT\r\nNULL GROUP BY tech ), door AS ( SELECT  technician_parent AS tech,COUNT(*)\r\nAS door_hangers FROM \\\\""LI Service Line Inspection 2021\\\\"" WHERE\r\ndoor_hanger_date=current_date-1 GROUP BY technician_parent),gro AS (SELECT\r\ntechnician_parent AS tech,\r\nSUM(COALESCE(technician_wait_time,$$0$$)::integer) AS wait_time,SUM(CASE\r\nWHEN dispatched = $$yes$$ then 1 else 0 END) as dispatched from \\\\""LI\r\nService Line Inspection 2021/gas_repair_order_info\\\\"" a JOIN \\\\""LI Service\r\nLine Inspection 2021\\\\"" b ON a._record_id=b._record_id WHERE\r\ngro_date=current_date-1 GROUP BY technician_parent),poe AS ( SELECT\r\ntechnician_svs AS tech,COUNT(*) as poe_seals from \\\\""LI Service Line\r\nInspection 2021/poe_inspection_parent\\\\"" WHERE\r\nsvs_inspection_date::date=current_date-1 AND poe_sealing_required =$$yes$$\r\nGROUP BY technician_svs) SELECT\r\ncurrent_date-1,b.*,door.door_hangers,gro.wait_time,gro.dispatched,COALESCE(poe.poe_seals,0)\r\nFROM b LEFT JOIN door ON b.tech=door.tech  LEFT JOIN gro ON b.tech=gro.tech\r\nLEFT JOIN poe ON b.tech=poe.tech"",\r\n""f"": ""csv"" }\'\' -H ""Content-Type: application/json"" -H ""X-ApiToken: "" -X\r\nPOST https://api.fulcrumapp.com/api/v2/query\', format \'csv\', header \'true\');\r\n\r\n\r\nOn Thu, Jun 6, 2024 at 7:03\u202fPM Luis Paolini ***@***.***>\r\nwrote:\r\n\r\n> Version? DDL of the table?\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/metabase/metabase/issues/43776#issuecomment-2153533655>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AA77J542G6HLFHGTRIPGRE3ZGDTF5AVCNFSM6AAAAABI5IKFROVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDCNJTGUZTGNRVGU>\r\n> .\r\n> You are receiving this because you authored the thread.Message ID:\r\n> ***@***.***>\r\n>\r\n\r\n\r\n-- \r\nSteve Signell\r\nFrontier Spatial, L.L.C.\r\nColchester, VT', 'created_at': datetime.datetime(2024, 6, 7, 13, 37, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2159430971, 'issue_id': 2338908819, 'author': 'FilmonK', 'body': ""Can reproduce with something as simple as:\r\nPostgres 15.1\r\nMetabase 1.49.14\r\n\r\n```\r\nCREATE TABLE li_daily_tech_report (\r\n    id SERIAL,\r\n    date date,\r\n    tech text,\r\n    inspections_completed integer,\r\n    appts_completed integer,\r\n    meters_total integer,\r\n    outside_meters integer,\r\n    inside_meters integer,\r\n    door_hangers integer,\r\n    wait_time integer,\r\n    dispatches integer,\r\n    poe_seals integer\r\n)\r\n```\r\n   \r\n   \r\n```\r\nINSERT INTO li_daily_tech_report (date, tech, inspections_completed, appts_completed, meters_total, outside_meters, inside_meters, door_hangers, wait_time, dispatches, poe_seals)\r\nVALUES \r\n    (CURRENT_DATE - 1, 'Tech A', 5, 2, 20, 10, 10, 1, 30, 5, 0),\r\n    (CURRENT_DATE - 2, 'Tech B', 3, 1, 15, 5, 10, 0, 45, 3, 1),\r\n    (CURRENT_DATE - 3, 'Tech C', 7, 3, 25, 15, 10, 2, 60, 6, 2),\r\n    (CURRENT_DATE - 4, 'Tech D', 2, 0, 10, 4, 6, 0, 20, 2, 0),\r\n    (CURRENT_DATE - 5, 'Tech E', 8, 4, 30, 20, 10, 3, 90, 7, 3),\r\n    (CURRENT_DATE - 6, 'Tech F', 4, 1, 18, 9, 9, 1, 40, 4, 1),\r\n    (CURRENT_DATE - 7, 'Tech G', 6, 2, 22, 11, 11, 2, 70, 5, 2),\r\n    (CURRENT_DATE - 8, 'Tech H', 1, 0, 8, 3, 5, 0, 10, 1, 0),\r\n    (CURRENT_DATE - 9, 'Tech I', 9, 5, 35, 17, 18, 4, 100, 8, 4),\r\n    (CURRENT_DATE - 10, 'Tech J', 5, 2, 20, 10, 10, 1, 30, 5, 0),\r\n    (CURRENT_DATE - 11, 'Tech K', 3, 1, 15, 5, 10, 0, 45, 3, 1),\r\n    (CURRENT_DATE - 12, 'Tech L', 7, 3, 25, 15, 10, 2, 60, 6, 2),\r\n    (CURRENT_DATE - 13, 'Tech M', 2, 0, 10, 4, 6, 0, 20, 2, 0),\r\n    (CURRENT_DATE - 14, 'Tech N', 8, 4, 30, 20, 10, 3, 90, 7, 3),\r\n    (CURRENT_DATE - 15, 'Tech O', 4, 1, 18, 9, 9, 1, 40, 4, 1),\r\n    (CURRENT_DATE - 16, 'Tech P', 6, 2, 22, 11, 11, 2, 70, 5, 2),\r\n    (CURRENT_DATE - 17, 'Tech Q', 1, 0, 8, 3, 5, 0, 10, 1, 0),\r\n    (CURRENT_DATE - 18, 'Tech R', 9, 5, 35, 17, 18, 4, 100, 8, 4),\r\n    (CURRENT_DATE - 19, 'Tech S', 5, 2, 20, 10, 10, 1, 30, 5, 0),\r\n    (CURRENT_DATE - 20, 'Tech T', 3, 1, 15, 5, 10, 0, 45, 3, 1);\r\n```\r\n\r\nYou will see something similar to the following in the logs:\r\n\r\nanalyze.classify :: Based on classification, updating these values of Field 3887 ''**inspections_completed**'': {:has_field_values :auto-list, :**semantic_type :type/Category**}"", 'created_at': datetime.datetime(2024, 6, 10, 22, 42, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2186578964, 'issue_id': 2338908819, 'author': 'luizarakaki', 'body': 'dupe of #33888', 'created_at': datetime.datetime(2024, 6, 24, 13, 25, 4, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-06 23:03:37 UTC): Version? DDL of the table?

sasignell (Issue Creator) on (2024-06-07 13:37:22 UTC): Hello,
   Thanks for the prompt reply.

The PG version is PostgreSQL 10.23 (Ubuntu 10.23-0ubuntu0.18.04.2) on
x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0,
64-bit
Metabase version is v1.49.13

DDL of table (I believe) is

-- FOREIGN TABLE: reports.li_daily_tech_report

-- DROP FOREIGN TABLE IF EXISTS reports.li_daily_tech_report;

CREATE FOREIGN TABLE IF NOT EXISTS reports.li_daily_tech_report(
    date date,
    tech text COLLATE pg_catalog.""default"",
    inspections_completed integer,
    appts_completed integer,
    meters_total integer,
    outside_meters integer,
    inside_meters integer,
    door_hangers integer,
    wait_time integer,
    dispatches integer,
    poe_seals integer
)
    SERVER li_daily_tech_report
    OPTIONS (program E'curl -d ''{
        ""q"": ""WITH a AS (SELECT technician_parent AS
tech,COALESCE(is_meter_outside,$$no$$) AS is_meter_outside,CASE WHEN
is_meter_count_correct=$$no$$ THEN updated_meter_count::integer ELSE
meter_count::integer END AS
meter_count_corrected,door_hanger_date,inspection_completed_date,
appointment_date, CASE WHEN appointment_date=inspection_completed_date THEN
1 ELSE 0 END AS appt_completed FROM \\""LI Service Line Inspection 2021\\""
WHERE inspection_completed_date=current_date-1) , b AS (SELECT tech,
COUNT(*) AS inspections_completed, SUM(appt_completed) AS appts_completed,
SUM(meter_count_corrected) AS meters_total, SUM(CASE WHEN
is_meter_outside=$$yes$$ THEN meter_count_corrected ELSE 0 END) AS
outside_meters, SUM(CASE WHEN is_meter_outside=$$no$$ THEN
meter_count_corrected ELSE 0 END) AS inside_meters FROM a WHERE tech IS NOT
NULL GROUP BY tech ), door AS ( SELECT  technician_parent AS tech,COUNT(*)
AS door_hangers FROM \\""LI Service Line Inspection 2021\\"" WHERE
door_hanger_date=current_date-1 GROUP BY technician_parent),gro AS (SELECT
technician_parent AS tech,
SUM(COALESCE(technician_wait_time,$$0$$)::integer) AS wait_time,SUM(CASE
WHEN dispatched = $$yes$$ then 1 else 0 END) as dispatched from \\""LI
Service Line Inspection 2021/gas_repair_order_info\\"" a JOIN \\""LI Service
Line Inspection 2021\\"" b ON a._record_id=b._record_id WHERE
gro_date=current_date-1 GROUP BY technician_parent),poe AS ( SELECT
technician_svs AS tech,COUNT(*) as poe_seals from \\""LI Service Line
Inspection 2021/poe_inspection_parent\\"" WHERE
svs_inspection_date::date=current_date-1 AND poe_sealing_required =$$yes$$
GROUP BY technician_svs) SELECT
current_date-1,b.*,door.door_hangers,gro.wait_time,gro.dispatched,COALESCE(poe.poe_seals,0)
FROM b LEFT JOIN door ON b.tech=door.tech  LEFT JOIN gro ON b.tech=gro.tech
LEFT JOIN poe ON b.tech=poe.tech"",
""f"": ""csv"" }'' -H ""Content-Type: application/json"" -H ""X-ApiToken: "" -X
POST https://api.fulcrumapp.com/api/v2/query', format 'csv', header 'true');


On Thu, Jun 6, 2024 at 7:03 PM Luis Paolini ***@***.***>
wrote:



-- 
Steve Signell
Frontier Spatial, L.L.C.
Colchester, VT

FilmonK on (2024-06-10 22:42:06 UTC): Can reproduce with something as simple as:
Postgres 15.1
Metabase 1.49.14

```
CREATE TABLE li_daily_tech_report (
    id SERIAL,
    date date,
    tech text,
    inspections_completed integer,
    appts_completed integer,
    meters_total integer,
    outside_meters integer,
    inside_meters integer,
    door_hangers integer,
    wait_time integer,
    dispatches integer,
    poe_seals integer
)
```
   
   
```
INSERT INTO li_daily_tech_report (date, tech, inspections_completed, appts_completed, meters_total, outside_meters, inside_meters, door_hangers, wait_time, dispatches, poe_seals)
VALUES 
    (CURRENT_DATE - 1, 'Tech A', 5, 2, 20, 10, 10, 1, 30, 5, 0),
    (CURRENT_DATE - 2, 'Tech B', 3, 1, 15, 5, 10, 0, 45, 3, 1),
    (CURRENT_DATE - 3, 'Tech C', 7, 3, 25, 15, 10, 2, 60, 6, 2),
    (CURRENT_DATE - 4, 'Tech D', 2, 0, 10, 4, 6, 0, 20, 2, 0),
    (CURRENT_DATE - 5, 'Tech E', 8, 4, 30, 20, 10, 3, 90, 7, 3),
    (CURRENT_DATE - 6, 'Tech F', 4, 1, 18, 9, 9, 1, 40, 4, 1),
    (CURRENT_DATE - 7, 'Tech G', 6, 2, 22, 11, 11, 2, 70, 5, 2),
    (CURRENT_DATE - 8, 'Tech H', 1, 0, 8, 3, 5, 0, 10, 1, 0),
    (CURRENT_DATE - 9, 'Tech I', 9, 5, 35, 17, 18, 4, 100, 8, 4),
    (CURRENT_DATE - 10, 'Tech J', 5, 2, 20, 10, 10, 1, 30, 5, 0),
    (CURRENT_DATE - 11, 'Tech K', 3, 1, 15, 5, 10, 0, 45, 3, 1),
    (CURRENT_DATE - 12, 'Tech L', 7, 3, 25, 15, 10, 2, 60, 6, 2),
    (CURRENT_DATE - 13, 'Tech M', 2, 0, 10, 4, 6, 0, 20, 2, 0),
    (CURRENT_DATE - 14, 'Tech N', 8, 4, 30, 20, 10, 3, 90, 7, 3),
    (CURRENT_DATE - 15, 'Tech O', 4, 1, 18, 9, 9, 1, 40, 4, 1),
    (CURRENT_DATE - 16, 'Tech P', 6, 2, 22, 11, 11, 2, 70, 5, 2),
    (CURRENT_DATE - 17, 'Tech Q', 1, 0, 8, 3, 5, 0, 10, 1, 0),
    (CURRENT_DATE - 18, 'Tech R', 9, 5, 35, 17, 18, 4, 100, 8, 4),
    (CURRENT_DATE - 19, 'Tech S', 5, 2, 20, 10, 10, 1, 30, 5, 0),
    (CURRENT_DATE - 20, 'Tech T', 3, 1, 15, 5, 10, 0, 45, 3, 1);
```

You will see something similar to the following in the logs:

analyze.classify :: Based on classification, updating these values of Field 3887 ''**inspections_completed**'': {:has_field_values :auto-list, :**semantic_type :type/Category**}

luizarakaki on (2024-06-24 13:25:04 UTC): dupe of #33888

"
2338863216,issue,closed,completed,legend labels are wrong for relative date dimension,"<img width=""973"" alt=""Screenshot 2024-06-06 at 11 00 31 AM"" src=""https://github.com/metabase/metabase/assets/37751258/ed629b8b-46f7-45f2-8f8b-64b5d34a352f"">
",EmmadUsmani,2024-06-06 18:00:50+00:00,['EmmadUsmani'],2024-06-06 22:15:23+00:00,2024-06-06 22:15:16+00:00,https://github.com/metabase/metabase/issues/43774,"[('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.')]","[{'comment_id': 2153490025, 'issue_id': 2338863216, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/f92d6b94388fd9f372a9be15b93f85bd1c9eb0b7', 'created_at': datetime.datetime(2024, 6, 6, 22, 15, 16, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-06 22:15:16 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/f92d6b94388fd9f372a9be15b93f85bd1c9eb0b7

"
2338856584,issue,closed,completed,legend labels are wrong for binned dimension,"<img width=""1006"" alt=""Screenshot 2024-06-06 at 10 54 51 AM"" src=""https://github.com/metabase/metabase/assets/37751258/3e607520-985c-4b9e-9072-30c6f175ab16"">

",EmmadUsmani,2024-06-06 17:57:09+00:00,['EmmadUsmani'],2024-06-06 22:15:37+00:00,2024-06-06 22:15:33+00:00,https://github.com/metabase/metabase/issues/43773,"[('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.')]","[{'comment_id': 2153490310, 'issue_id': 2338856584, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/f92d6b94388fd9f372a9be15b93f85bd1c9eb0b7', 'created_at': datetime.datetime(2024, 6, 6, 22, 15, 33, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-06 22:15:33 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/f92d6b94388fd9f372a9be15b93f85bd1c9eb0b7

"
2338849037,issue,closed,completed,"""other"" item appears on legend with mixed positive and negative metric values","<img width=""986"" alt=""Screenshot 2024-06-06 at 10 51 06 AM"" src=""https://github.com/metabase/metabase/assets/37751258/c2e96e71-7a68-4d77-8893-349c43180025"">

<img width=""226"" alt=""Screenshot 2024-06-06 at 10 51 09 AM"" src=""https://github.com/metabase/metabase/assets/37751258/48468368-297d-4824-a25c-c1f3dd1bb2c7"">
",EmmadUsmani,2024-06-06 17:52:22+00:00,['EmmadUsmani'],2024-06-17 19:58:11+00:00,2024-06-17 19:58:07+00:00,https://github.com/metabase/metabase/issues/43770,"[('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.')]","[{'comment_id': 2153339565, 'issue_id': 2338849037, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/0092f0af9868a3cdd1325cdb043ddf3f6129c048', 'created_at': datetime.datetime(2024, 6, 6, 20, 18, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2163682290, 'issue_id': 2338849037, 'author': 'EmmadUsmani', 'body': ""Reopening as we decided to handle this differently. We'll remove negative slices from the chart, and still show positive ones."", 'created_at': datetime.datetime(2024, 6, 12, 18, 40, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2174315535, 'issue_id': 2338849037, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/088e67d298afd6c469675754c445ec17ec428892', 'created_at': datetime.datetime(2024, 6, 17, 19, 58, 7, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-06 20:18:33 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/0092f0af9868a3cdd1325cdb043ddf3f6129c048

EmmadUsmani (Issue Creator) on (2024-06-12 18:40:57 UTC): Reopening as we decided to handle this differently. We'll remove negative slices from the chart, and still show positive ones.

EmmadUsmani (Issue Creator) on (2024-06-17 19:58:07 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/088e67d298afd6c469675754c445ec17ec428892

"
2338843815,issue,closed,completed,pie is invisible when metric values are all negative,"<img width=""925"" alt=""Screenshot 2024-06-06 at 10 47 37 AM"" src=""https://github.com/metabase/metabase/assets/37751258/3403a372-ac33-4e8b-8c8c-afaad5273327"">
",EmmadUsmani,2024-06-06 17:49:09+00:00,['EmmadUsmani'],2024-06-17 19:57:57+00:00,2024-06-17 19:57:57+00:00,https://github.com/metabase/metabase/issues/43769,"[('Visualization/Charts/Pie', '')]","[{'comment_id': 2158878116, 'issue_id': 2338843815, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/1eec778da687a2a7ef33c4b7e83c0cf78e8c5f34', 'created_at': datetime.datetime(2024, 6, 10, 17, 1, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2174315281, 'issue_id': 2338843815, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/088e67d298afd6c469675754c445ec17ec428892', 'created_at': datetime.datetime(2024, 6, 17, 19, 57, 57, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-10 17:01:20 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/1eec778da687a2a7ef33c4b7e83c0cf78e8c5f34

EmmadUsmani (Issue Creator) on (2024-06-17 19:57:57 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/088e67d298afd6c469675754c445ec17ec428892

"
2338838409,issue,closed,completed,white percent labels on chart can be hard to read,"<img width=""402"" alt=""Screenshot 2024-06-06 at 10 45 15 AM"" src=""https://github.com/metabase/metabase/assets/37751258/3f9b9eec-7fcb-4a4a-a2e7-70d55a5702b8"">

See the gamecube and psp slices",EmmadUsmani,2024-06-06 17:46:26+00:00,['EmmadUsmani'],2024-06-26 22:19:32+00:00,2024-06-26 22:19:32+00:00,https://github.com/metabase/metabase/issues/43768,"[('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.')]","[{'comment_id': 2189928743, 'issue_id': 2338838409, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/2424f965a75cb9cc898f40ac872960762fa45e47', 'created_at': datetime.datetime(2024, 6, 25, 20, 40, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2190045576, 'issue_id': 2338838409, 'author': 'EmmadUsmani', 'body': ""The original commit works for static viz, but not for dynamic since labels overflow on small charts (small dashcard or window size).\r\n\r\nI'm reopening the issue but will move this under the dynamic viz section."", 'created_at': datetime.datetime(2024, 6, 25, 22, 1, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2192715173, 'issue_id': 2338838409, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/f346c67a299fce6d0c1b9fafe4bc78cb6a3c7705', 'created_at': datetime.datetime(2024, 6, 26, 22, 19, 32, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-25 20:40:34 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/2424f965a75cb9cc898f40ac872960762fa45e47

EmmadUsmani (Issue Creator) on (2024-06-25 22:01:13 UTC): The original commit works for static viz, but not for dynamic since labels overflow on small charts (small dashcard or window size).

I'm reopening the issue but will move this under the dynamic viz section.

EmmadUsmani (Issue Creator) on (2024-06-26 22:19:32 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/f346c67a299fce6d0c1b9fafe4bc78cb6a3c7705

"
2338825947,issue,closed,completed,tiny slices disappear,"<img width=""1032"" alt=""Screenshot 2024-06-06 at 10 37 58 AM"" src=""https://github.com/metabase/metabase/assets/37751258/58f7c888-397c-4b9c-9073-e58b8d267d3a"">

The slice for Delaware is missing on the left
",EmmadUsmani,2024-06-06 17:38:51+00:00,['EmmadUsmani'],2024-06-06 20:18:16+00:00,2024-06-06 20:18:15+00:00,https://github.com/metabase/metabase/issues/43766,"[('Visualization/Charts/Pie', '')]","[{'comment_id': 2153339167, 'issue_id': 2338825947, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/0092f0af9868a3cdd1325cdb043ddf3f6129c048', 'created_at': datetime.datetime(2024, 6, 6, 20, 18, 15, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-06 20:18:15 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/0092f0af9868a3cdd1325cdb043ddf3f6129c048

"
2338814412,issue,closed,completed,total is rounded,"![image](https://github.com/metabase/metabase/assets/37751258/a1cded87-07a6-429e-ac92-78f1e3fa4fc0)
",EmmadUsmani,2024-06-06 17:32:19+00:00,['EmmadUsmani'],2024-06-06 20:33:52+00:00,2024-06-06 20:33:51+00:00,https://github.com/metabase/metabase/issues/43764,[],"[{'comment_id': 2153361137, 'issue_id': 2338814412, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/dbdef21a34574be384c17a7a7c22d9a0f79bf797', 'created_at': datetime.datetime(2024, 6, 6, 20, 33, 52, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-06 20:33:52 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/dbdef21a34574be384c17a7a7c22d9a0f79bf797

"
2338809635,issue,closed,completed,date in legend is unformatted,"<img width=""974"" alt=""Screenshot 2024-06-06 at 10 29 04 AM"" src=""https://github.com/metabase/metabase/assets/37751258/1abbcaca-9c2f-4619-a84c-4e0cc7e0d560"">
",EmmadUsmani,2024-06-06 17:29:24+00:00,['EmmadUsmani'],2024-06-06 21:24:29+00:00,2024-06-06 21:24:28+00:00,https://github.com/metabase/metabase/issues/43762,"[('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.')]","[{'comment_id': 2153432089, 'issue_id': 2338809635, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/fc9dd5fac2166ad04e9f9f0a8c8e410422d4deae', 'created_at': datetime.datetime(2024, 6, 6, 21, 24, 29, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-06 21:24:29 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/fc9dd5fac2166ad04e9f9f0a8c8e410422d4deae

"
2338714211,issue,closed,completed,Logs filled with 'uploads-enabled' has been removed; use 'uploads_enabled' on the database instead,"### Describe the bug

For some reason my logs are filled with WARN metabase.public-settings :: 'uploads-enabled' has been removed; use 'uploads_enabled' on the database instead


### To Reproduce

1) start a metabase with a postgres db as the app db
2) start it and authenticate
3) check the logs

### Expected behavior

We should not have that error at all

### Logs

NA

### Information about your Metabase installation

```JSON
v50-RC2
```


### Severity

P2

### Additional context

NA",paoliniluis,2024-06-06 16:41:28+00:00,['calherries'],2024-06-10 16:44:05+00:00,2024-06-10 13:54:04+00:00,https://github.com/metabase/metabase/issues/43756,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Administration/Settings', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2154559331, 'issue_id': 2338714211, 'author': 'perivamsi', 'body': 'This is not a release blocker, removing 50 milestone', 'created_at': datetime.datetime(2024, 6, 7, 10, 31, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2154896107, 'issue_id': 2338714211, 'author': 'dpsutton', 'body': 'This arises from https://github.com/metabase/metabase/pull/42869. That PR adds these logs. Unclear at a quick glance what should happen.', 'created_at': datetime.datetime(2024, 6, 7, 13, 53, 54, tzinfo=datetime.timezone.utc)}]","perivamsi on (2024-06-07 10:31:31 UTC): This is not a release blocker, removing 50 milestone

dpsutton on (2024-06-07 13:53:54 UTC): This arises from https://github.com/metabase/metabase/pull/42869. That PR adds these logs. Unclear at a quick glance what should happen.

"
2338564543,issue,closed,completed,Automatically merge the doc PR,,WiNloSt,2024-06-06 15:39:58+00:00,[],2024-06-10 20:46:25+00:00,2024-06-07 16:18:15+00:00,https://github.com/metabase/metabase/issues/43746,"[('.CI & Tests', '')]",[],
2338527723,issue,open,,More window functions,"**Is your feature request related to a problem? Please describe.**
With the new addition of `offset` (cool), there might be more advanced calculations you want to do with other window functions that we currently don't support. 

**Describe the solution you'd like**
Add more advanced window functions like 
`RANK`
`PERCENT_RANK`
`DENSE_RANK`
`ROW_NUMBER`

And other ones documented here: https://www.postgresql.org/docs/current/functions-window.html

**Describe alternatives you've considered**
Doing SQL

**How important is this feature to you?**
Requested by a customer that does some cool advanced analyics

**Additional context**
Related to https://github.com/metabase/metabase/issues/2120, https://github.com/metabase/metabase/issues/40991  and https://github.com/metabase/metabase/issues/41000

I know we have [this internal doc](https://www.notion.so/metabase/MBQL-and-Window-Functions-79399f5cb0e94ae796f14a258827841e?pvs=4), but this issue to track customer and user requests. 
",ignacio-mb,2024-06-06 15:24:33+00:00,[],2024-06-10 17:43:35+00:00,,https://github.com/metabase/metabase/issues/43741,"[('Querying/Processor', ''), ('Type:New Feature', ''), ('Querying/', '')]",[],
2338456245,issue,closed,completed,Timeline events are on top of bars and data labels,"<img width=""228"" alt=""Screenshot 2024-06-06 at 11 49 02 AM"" src=""https://github.com/metabase/metabase/assets/14301985/76f080bd-6c7a-435f-9db3-23fffa4d937b"">
",alxnddr,2024-06-06 14:49:57+00:00,['alxnddr'],2024-06-06 21:00:05+00:00,2024-06-06 21:00:04+00:00,https://github.com/metabase/metabase/issues/43738,"[('Priority:P2', 'Average run of the mill bug'), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature'), ('Visualization/Charts/Events', 'Event annotation in timelines'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2338453686,issue,closed,completed,"""Show value for this series"" setting does nothing when ""Show values for data points"" is disabled",https://metaboat.slack.com/archives/C064QMXEV9N/p1717683864033719,alxnddr,2024-06-06 14:48:46+00:00,['JesseSDevaney'],2024-06-10 20:49:54+00:00,2024-06-07 17:43:22+00:00,https://github.com/metabase/metabase/issues/43737,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2153469001, 'issue_id': 2338453686, 'author': 'JesseSDevaney', 'body': 'Keeping open until backport merges: https://github.com/metabase/metabase/pull/43794', 'created_at': datetime.datetime(2024, 6, 6, 21, 56, 41, tzinfo=datetime.timezone.utc)}]","JesseSDevaney (Assginee) on (2024-06-06 21:56:41 UTC): Keeping open until backport merges: https://github.com/metabase/metabase/pull/43794

"
2337966689,issue,open,,Track renames across card references,"We need to be careful when renaming ""columns"" that come from card references.

These fall into two categories, aliased and non-aliased.

As jargon, we can refer to the query fields of a particular model which which get **exposed** from the given card, without getting modified in any way or occluded by an alias, as **transparent** query fields.

In order to deal with such fields being renamed, we need to avoid breaking any other card that access them transitively via this one. 

There are two potential solutions: breaking the ""flow"" of the name by introducing an alias for the previous name, or propagating the renames up the card reference DAG.

```sql
-- card 123
SELECT total FROM orders WHERE subtotal > 100

-- card 321
SELECT total FROM {{https://github.com/metabase/metabase/issues/123}}

/*
we want to replace orders.total with orders.amount
*/

-- either:
-- new card 123
SELECT amount AS total FROM orders WHERE subtotal > 100

-- new card 321
SELECT total FROM {{https://github.com/metabase/metabase/issues/123}} -- unchanged

-- or, and I think preferably:
-- new card 123
SELECT amount from orders WHERE subtotal > 100
```

The first option has a major downside - over time it will leave a message of anachronistic terms lying around.

There is a some risk with propagating renames as well though - it could lead to name collisions and masking of indirect fields though, so perhaps aliases are not only simpler but more prudent?",crisptrutski,2024-06-06 10:58:45+00:00,[],2024-07-01 16:06:16+00:00,,https://github.com/metabase/metabase/issues/43725,"[('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2152098925, 'issue_id': 2337966689, 'author': 'crisptrutski', 'body': 'Whichever route we take, knowing which fields are transparently exposed is a useful foundation to use.', 'created_at': datetime.datetime(2024, 6, 6, 11, 22, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2200543693, 'issue_id': 2337966689, 'author': 'crisptrutski', 'body': ""We're not working on this right now as it's not essentially to support cross-card renames in v1."", 'created_at': datetime.datetime(2024, 7, 1, 16, 6, 15, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-06-06 11:22:08 UTC): Whichever route we take, knowing which fields are transparently exposed is a useful foundation to use.

crisptrutski (Issue Creator) on (2024-07-01 16:06:15 UTC): We're not working on this right now as it's not essentially to support cross-card renames in v1.

"
2337822734,issue,closed,not_planned,The insert statement will be executed,"### Describe the bug

Create a new ""SQL problem"", enter ""insert into a (id) values (1)"" and execute it. The execution will be successful, and select with no result will be returned

### To Reproduce

1. to 'SQL PROBLEM'
2. write on ""insert into a (id) values (1)"" 
3. Records inserted into the database


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Metabase version 0.49.13
```


### Severity

Serious impact on the database, but can be avoided by revoking permissions

### Additional context

_No response_",sw2011,2024-06-06 09:43:05+00:00,[],2024-06-07 07:13:50+00:00,2024-06-06 23:03:50+00:00,https://github.com/metabase/metabase/issues/43722,"[('Type:Bug', 'Product defects'), ('Querying/Native', 'The SQL/native query editor'), ('.Needs Triage', '')]","[{'comment_id': 2152019627, 'issue_id': 2337822734, 'author': 'paoliniluis', 'body': 'Sorry I don’t understand what you’re doing', 'created_at': datetime.datetime(2024, 6, 6, 10, 58, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2154234968, 'issue_id': 2337822734, 'author': 'sw2011', 'body': 'What I mean is that when an insert statement is executed in the SQL editor of Metabase, it will be successfully executed; In historical versions of Metabase, this syntax has been reported as an error and cannot be executed.', 'created_at': datetime.datetime(2024, 6, 7, 7, 13, 49, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-06 10:58:48 UTC): Sorry I don’t understand what you’re doing

sw2011 (Issue Creator) on (2024-06-07 07:13:49 UTC): What I mean is that when an insert statement is executed in the SQL editor of Metabase, it will be successfully executed; In historical versions of Metabase, this syntax has been reported as an error and cannot be executed.

"
2337725850,issue,open,,Make model caching work with sandboxing,"**Is your feature request related to a problem? Please describe.**
[Model caching](https://www.metabase.com/docs/latest/data-modeling/models#model-caching) does not work with [data sandboxes](https://www.metabase.com/docs/latest/permissions/data-sandboxes) at the moment.

Model caching speeds up and reduces the cost of queries that are complex or involve large amounts of data. However it doesn't support data sandboxing, so it is currently not usable for client facing dashboards in a sandboxed environment, such as in instances serving multiple tenants.

**Describe the solution you'd like**
When it is feasible, queries utilize the cached resultset of a model even when the current user has sandboxed access to the underlying source data.

Alternatively, consider introducing sandboxed query access for models - similarly to tables, an additional filter would be applied based on group membership and user attributes (simple sandboxing), or an alternative model would provide the result set (advanced sandboxing).

**Describe alternatives you've considered**
Build and maintain the model externally (e.g. build a materialized view) and set up data sandboxing in Metabase.

**How important is this feature to you?**
Requested by a customer.",zbodi74,2024-06-06 08:56:15+00:00,[],2025-02-04 20:31:06+00:00,,https://github.com/metabase/metabase/issues/43720,"[('Administration/Data Sandboxes', 'Enterprise Sandboxing'), ('Querying/Models', 'aka Datasets'), ('Querying/Cache', ''), ('Semantic Model', ''), ('Semantic Model/Models', '')]","[{'comment_id': 2575601550, 'issue_id': 2337725850, 'author': 'thebiglabasky', 'body': 'Just to be extra clear, buy Model caching, you mean Model persistence right?', 'created_at': datetime.datetime(2025, 1, 7, 15, 37, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2575632943, 'issue_id': 2337725850, 'author': 'paoliniluis', 'body': '@thebiglabasky yes', 'created_at': datetime.datetime(2025, 1, 7, 15, 51, 15, tzinfo=datetime.timezone.utc)}]","thebiglabasky on (2025-01-07 15:37:48 UTC): Just to be extra clear, buy Model caching, you mean Model persistence right?

paoliniluis on (2025-01-07 15:51:15 UTC): @thebiglabasky yes

"
2336982564,issue,closed,completed,[Flaky Test]: tag dimension should default to string/= for a new low cardinality string field filter,"Last Flake: https://github.com/metabase/metabase/actions/runs/9360097620
Last Flake Time: 2024-06-03T19:33:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-05 23:24:21+00:00,[],2024-07-30 14:51:57+00:00,2024-07-30 14:51:57+00:00,https://github.com/metabase/metabase/issues/43713,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2155488324, 'issue_id': 2336982564, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9405559240\nLast Flake Time: 2024-06-06T11:17:00-07:00\nFlakes in the last day: 0\nFlakes in the last 3d: 1\nFlakes in the last 7d: 2', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2167641722, 'issue_id': 2336982564, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9498293569\nLast Flake Time: 2024-06-13T04:08:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 2\nFlakes in the last 7d: 3', 'created_at': datetime.datetime(2024, 6, 14, 9, 34, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2233644439, 'issue_id': 2336982564, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9967292106\nLast Flake Time: 2024-07-16T19:41:00-07:00\nFlakes in the last day: 5\nFlakes in the last 3d: 11\nFlakes in the last 7d: 19', 'created_at': datetime.datetime(2024, 7, 17, 15, 49, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2233646625, 'issue_id': 2336982564, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9967292106\nLast Flake Time: 2024-07-16T19:41:00-07:00\nFlakes in the last day: 5\nFlakes in the last 3d: 11\nFlakes in the last 7d: 19', 'created_at': datetime.datetime(2024, 7, 17, 15, 50, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2258547829, 'issue_id': 2336982564, 'author': 'nemanjaglumac', 'body': 'Fixed by https://github.com/metabase/metabase/pull/45978', 'created_at': datetime.datetime(2024, 7, 30, 14, 51, 57, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:16 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9405559240
Last Flake Time: 2024-06-06T11:17:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 2

github-automation-metabase (Issue Creator) on (2024-06-14 09:34:48 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9498293569
Last Flake Time: 2024-06-13T04:08:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 2
Flakes in the last 7d: 3

github-automation-metabase (Issue Creator) on (2024-07-17 15:49:59 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9967292106
Last Flake Time: 2024-07-16T19:41:00-07:00
Flakes in the last day: 5
Flakes in the last 3d: 11
Flakes in the last 7d: 19

github-automation-metabase (Issue Creator) on (2024-07-17 15:50:59 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9967292106
Last Flake Time: 2024-07-16T19:41:00-07:00
Flakes in the last day: 5
Flakes in the last 3d: 11
Flakes in the last 7d: 19

nemanjaglumac on (2024-07-30 14:51:57 UTC): Fixed by https://github.com/metabase/metabase/pull/45978

"
2336982547,issue,closed,not_planned,[Flaky Test]: breadcrumbs should allow to navigate to and from table settings in a no-schema database,"Last Flake: https://github.com/metabase/metabase/actions/runs/9360097620
Last Flake Time: 2024-06-03T19:33:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-05 23:24:21+00:00,[],2024-12-13 16:43:58+00:00,2024-12-13 16:43:58+00:00,https://github.com/metabase/metabase/issues/43712,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2336982542,issue,closed,not_planned,[Flaky Test]: rows-alert-test,"Last Flake: https://github.com/metabase/metabase/actions/runs/9374490110
Last Flake Time: 2024-06-04T15:16:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-05 23:24:20+00:00,[],2024-12-13 16:43:36+00:00,2024-12-13 16:43:36+00:00,https://github.com/metabase/metabase/issues/43711,"[('.CI & Tests', ''), ('.Backend', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2155488348, 'issue_id': 2336982542, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9374490110\nLast Flake Time: 2024-06-04T15:16:00-07:00\nFlakes in the last day: 0\nFlakes in the last 3d: 1\nFlakes in the last 7d: 1', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 17, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:17 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9374490110
Last Flake Time: 2024-06-04T15:16:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1

"
2336982537,issue,closed,completed,[Flaky Test]: should not clip dashcard actions (metabase#31274),"Last Flake: https://github.com/metabase/metabase/actions/runs/9378777427
Last Flake Time: 2024-06-04T23:37:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-05 23:24:19+00:00,[],2024-06-19 19:32:57+00:00,2024-06-19 19:32:56+00:00,https://github.com/metabase/metabase/issues/43710,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2155488337, 'issue_id': 2336982537, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9378777427\nLast Flake Time: 2024-06-04T23:37:00-07:00\nFlakes in the last day: 0\nFlakes in the last 3d: 1\nFlakes in the last 7d: 1', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179359606, 'issue_id': 2336982537, 'author': 'JesseSDevaney', 'body': 'Closing as this test does not appear to be flaking anymore according to replay.io/cannot reproduce the flake to fix it since it is no longer occurring', 'created_at': datetime.datetime(2024, 6, 19, 19, 32, 57, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:16 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9378777427
Last Flake Time: 2024-06-04T23:37:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1

JesseSDevaney on (2024-06-19 19:32:57 UTC): Closing as this test does not appear to be flaking anymore according to replay.io/cannot reproduce the flake to fix it since it is no longer occurring

"
2336982529,issue,closed,completed,[Flaky Test]: odal should switch back to not having tabs when the search query is cleared,"Last Flake: https://github.com/metabase/metabase/actions/runs/9360217246
Last Flake Time: 2024-06-03T19:45:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-05 23:24:19+00:00,[],2024-06-19 19:30:41+00:00,2024-06-19 19:30:40+00:00,https://github.com/metabase/metabase/issues/43709,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2179357124, 'issue_id': 2336982529, 'author': 'JesseSDevaney', 'body': 'Closing as this test does not appear to be flaking anymore/the posted CI run does not even have a test failure for the test it is mentioning.', 'created_at': datetime.datetime(2024, 6, 19, 19, 30, 40, tzinfo=datetime.timezone.utc)}]","JesseSDevaney on (2024-06-19 19:30:40 UTC): Closing as this test does not appear to be flaking anymore/the posted CI run does not even have a test failure for the test it is mentioning.

"
2336982524,issue,closed,not_planned,[Flaky Test]: should work for both simple and nested questions based on previously converted GUI query,"Last Flake: https://github.com/metabase/metabase/actions/runs/9365338848
Last Flake Time: 2024-06-04T03:51:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1",github-automation-metabase,2024-06-05 23:24:18+00:00,[],2024-12-13 16:43:58+00:00,2024-12-13 16:43:58+00:00,https://github.com/metabase/metabase/issues/43708,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2336982517,issue,closed,completed,[Flaky Test]: should be able to reference a saved native question that ends with a semicolon `;` (metabase#28218),"Last Flake: https://github.com/metabase/metabase/actions/runs/9357716394
Last Flake Time: 2024-06-03T15:21:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 2
Flakes in the last 7d: 2",github-automation-metabase,2024-06-05 23:24:17+00:00,[],2024-07-26 08:20:26+00:00,2024-07-26 08:20:26+00:00,https://github.com/metabase/metabase/issues/43707,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2155488309, 'issue_id': 2336982517, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9407548339\nLast Flake Time: 2024-06-06T14:17:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 1\nFlakes in the last 7d: 3', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2252222730, 'issue_id': 2336982517, 'author': 'nemanjaglumac', 'body': 'Fixed by #46048', 'created_at': datetime.datetime(2024, 7, 26, 8, 20, 26, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:15 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9407548339
Last Flake Time: 2024-06-06T14:17:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 1
Flakes in the last 7d: 3

nemanjaglumac on (2024-07-26 08:20:26 UTC): Fixed by #46048

"
2336982512,issue,closed,completed,[Flaky Test]: should be able to reference a nested question (metabase#25988),"Last Flake: https://github.com/metabase/metabase/actions/runs/9368623032
Last Flake Time: 2024-06-04T07:42:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 2",github-automation-metabase,2024-06-05 23:24:16+00:00,[],2024-10-08 17:08:12+00:00,2024-06-12 07:24:42+00:00,https://github.com/metabase/metabase/issues/43706,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2155488355, 'issue_id': 2336982512, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9405710300\nLast Flake Time: 2024-06-06T11:45:00-07:00\nFlakes in the last day: 0\nFlakes in the last 3d: 1\nFlakes in the last 7d: 1', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2162296704, 'issue_id': 2336982512, 'author': 'nemanjaglumac', 'body': 'Fixed by #43991', 'created_at': datetime.datetime(2024, 6, 12, 7, 24, 42, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:17 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9405710300
Last Flake Time: 2024-06-06T11:45:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 1
Flakes in the last 7d: 1

nemanjaglumac on (2024-06-12 07:24:42 UTC): Fixed by #43991

"
2336982505,issue,closed,completed,[Flaky Test]: tag dimension should default to number/= for a new reviews->rating field filter (metabase#16151),"Last Flake: https://github.com/metabase/metabase/actions/runs/9365686247
Last Flake Time: 2024-06-04T04:07:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 2
Flakes in the last 7d: 3",github-automation-metabase,2024-06-05 23:24:16+00:00,[],2024-07-30 14:52:35+00:00,2024-07-30 14:52:35+00:00,https://github.com/metabase/metabase/issues/43705,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2155488282, 'issue_id': 2336982505, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9407043064\nLast Flake Time: 2024-06-06T13:23:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 2\nFlakes in the last 7d: 5', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2258549367, 'issue_id': 2336982505, 'author': 'nemanjaglumac', 'body': 'Fixed by https://github.com/metabase/metabase/pull/45978', 'created_at': datetime.datetime(2024, 7, 30, 14, 52, 35, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:14 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9407043064
Last Flake Time: 2024-06-06T13:23:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 2
Flakes in the last 7d: 5

nemanjaglumac on (2024-07-30 14:52:35 UTC): Fixed by https://github.com/metabase/metabase/pull/45978

"
2336982494,issue,closed,completed,[Flaky Test]: should work when set through the filter widget,"Last Flake: https://github.com/metabase/metabase/actions/runs/9360021255
Last Flake Time: 2024-06-03T19:00:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 5
Flakes in the last 7d: 5",github-automation-metabase,2024-06-05 23:24:15+00:00,[],2024-06-19 19:26:41+00:00,2024-06-19 19:26:41+00:00,https://github.com/metabase/metabase/issues/43704,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2179352793, 'issue_id': 2336982494, 'author': 'JesseSDevaney', 'body': 'Similar to #43703, closing as it does not appear to be flaking anymore + I cannot find where the old flake was even occurring:\r\n![image](https://github.com/metabase/metabase/assets/22608765/97e32a4c-f19e-4900-a503-01ce440d61d7)', 'created_at': datetime.datetime(2024, 6, 19, 19, 26, 41, tzinfo=datetime.timezone.utc)}]","JesseSDevaney on (2024-06-19 19:26:41 UTC): Similar to #43703, closing as it does not appear to be flaking anymore + I cannot find where the old flake was even occurring:
![image](https://github.com/metabase/metabase/assets/22608765/97e32a4c-f19e-4900-a503-01ce440d61d7)

"
2336982479,issue,closed,completed,[Flaky Test]: should work when set as the default filter,"Last Flake: https://github.com/metabase/metabase/actions/runs/9360021255
Last Flake Time: 2024-06-03T19:00:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 5
Flakes in the last 7d: 5",github-automation-metabase,2024-06-05 23:24:14+00:00,[],2024-06-19 19:25:22+00:00,2024-06-19 19:25:22+00:00,https://github.com/metabase/metabase/issues/43703,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2179351296, 'issue_id': 2336982479, 'author': 'JesseSDevaney', 'body': 'Closing as it does not appear to be flaking anymore + I cannot find where the old flake was even occurring:\r\n![image](https://github.com/metabase/metabase/assets/22608765/82420f42-f781-465f-aa3f-d08928fb2cec)', 'created_at': datetime.datetime(2024, 6, 19, 19, 25, 22, tzinfo=datetime.timezone.utc)}]","JesseSDevaney on (2024-06-19 19:25:22 UTC): Closing as it does not appear to be flaking anymore + I cannot find where the old flake was even occurring:
![image](https://github.com/metabase/metabase/assets/22608765/82420f42-f781-465f-aa3f-d08928fb2cec)

"
2336982470,issue,closed,completed,[Flaky Test]: scenarios > visualizations > line/bar chart > tooltips > percent change across daylight savings time change should not omit percent change the week after DST begins,"Last Flake: https://github.com/metabase/metabase/actions/runs/9358676003
Last Flake Time: 2024-06-04T07:41:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 5
Flakes in the last 7d: 6",github-automation-metabase,2024-06-05 23:24:13+00:00,[],2024-06-19 19:34:38+00:00,2024-06-19 19:34:38+00:00,https://github.com/metabase/metabase/issues/43702,"[('.CI & Tests', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('flaky-test-fix', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2155488295, 'issue_id': 2336982470, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9405346911\nLast Flake Time: 2024-06-06T11:18:00-07:00\nFlakes in the last day: 0\nFlakes in the last 3d: 2\nFlakes in the last 7d: 4', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2158583303, 'issue_id': 2336982470, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9422395346\nLast Flake Time: 2024-06-09T23:15:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 6\nFlakes in the last 7d: 9', 'created_at': datetime.datetime(2024, 6, 10, 14, 53, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179361273, 'issue_id': 2336982470, 'author': 'JesseSDevaney', 'body': 'Similar to #43701, closing as it appears this was fixed by:\r\n- https://github.com/metabase/metabase/pull/43975', 'created_at': datetime.datetime(2024, 6, 19, 19, 34, 38, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:14 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9405346911
Last Flake Time: 2024-06-06T11:18:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 2
Flakes in the last 7d: 4

github-automation-metabase (Issue Creator) on (2024-06-10 14:53:11 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9422395346
Last Flake Time: 2024-06-09T23:15:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 6
Flakes in the last 7d: 9

JesseSDevaney on (2024-06-19 19:34:38 UTC): Similar to #43701, closing as it appears this was fixed by:
- https://github.com/metabase/metabase/pull/43975

"
2336982466,issue,closed,completed,[Flaky Test]: scenarios > visualizations > line/bar chart > tooltips > percent change across daylight savings time change should not omit percent change on April,"Last Flake: https://github.com/metabase/metabase/actions/runs/9373741984
Last Flake Time: 2024-06-04T13:58:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 5
Flakes in the last 7d: 7",github-automation-metabase,2024-06-05 23:24:12+00:00,['JesseSDevaney'],2024-06-19 19:10:23+00:00,2024-06-19 19:10:23+00:00,https://github.com/metabase/metabase/issues/43701,"[('.CI & Tests', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('flaky-test-fix', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2155488266, 'issue_id': 2336982466, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9407877818\nLast Flake Time: 2024-06-06T14:56:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 6\nFlakes in the last 7d: 11', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2158583411, 'issue_id': 2336982466, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9437892268\nLast Flake Time: 2024-06-09T09:51:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 3\nFlakes in the last 7d: 3', 'created_at': datetime.datetime(2024, 6, 10, 14, 53, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2179334884, 'issue_id': 2336982466, 'author': 'JesseSDevaney', 'body': 'Closing as it appears this was fixed by:\r\n- https://github.com/metabase/metabase/pull/43975', 'created_at': datetime.datetime(2024, 6, 19, 19, 10, 23, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:13 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9407877818
Last Flake Time: 2024-06-06T14:56:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 6
Flakes in the last 7d: 11

github-automation-metabase (Issue Creator) on (2024-06-10 14:53:14 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9437892268
Last Flake Time: 2024-06-09T09:51:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 3
Flakes in the last 7d: 3

JesseSDevaney (Assginee) on (2024-06-19 19:10:23 UTC): Closing as it appears this was fixed by:
- https://github.com/metabase/metabase/pull/43975

"
2336982455,issue,closed,completed,[Flaky Test]: should always show the most recent revision (metabase#16559),"Last Flake: https://github.com/metabase/metabase/actions/runs/9357939752
Last Flake Time: 2024-06-03T16:08:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 6
Flakes in the last 7d: 12",github-automation-metabase,2024-06-05 23:24:12+00:00,['kamilmielnik'],2024-11-26 18:51:56+00:00,2024-11-05 09:56:47+00:00,https://github.com/metabase/metabase/issues/43700,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2155488256, 'issue_id': 2336982455, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9407924722\nLast Flake Time: 2024-06-06T16:59:00-07:00\nFlakes in the last day: 2\nFlakes in the last 3d: 11\nFlakes in the last 7d: 11', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2158583364, 'issue_id': 2336982455, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9423499617\nLast Flake Time: 2024-06-09T23:15:00-07:00\nFlakes in the last day: 1\nFlakes in the last 3d: 4\nFlakes in the last 7d: 17', 'created_at': datetime.datetime(2024, 6, 10, 14, 53, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2456728151, 'issue_id': 2336982455, 'author': 'kamilmielnik', 'body': 'Fixed by #49472', 'created_at': datetime.datetime(2024, 11, 5, 9, 56, 47, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:12 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9407924722
Last Flake Time: 2024-06-06T16:59:00-07:00
Flakes in the last day: 2
Flakes in the last 3d: 11
Flakes in the last 7d: 11

github-automation-metabase (Issue Creator) on (2024-06-10 14:53:13 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9423499617
Last Flake Time: 2024-06-09T23:15:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 4
Flakes in the last 7d: 17

kamilmielnik (Assginee) on (2024-11-05 09:56:47 UTC): Fixed by #49472

"
2336982445,issue,closed,completed,[Flaky Test]: should be able to cancel a migration,"Last Flake: https://github.com/metabase/metabase/actions/runs/9373885310
Last Flake Time: 2024-06-04T14:00:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 7
Flakes in the last 7d: 23",github-automation-metabase,2024-06-05 23:24:11+00:00,"['npfitz', 'sloansparger']",2024-06-07 20:05:52+00:00,2024-06-07 19:54:04+00:00,https://github.com/metabase/metabase/issues/43699,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2336982440,issue,closed,not_planned,[Flaky Test]: scenarios > models metadata GUI model allows for canceling changes,"Last Flake: https://github.com/metabase/metabase/actions/runs/9365221335
Last Flake Time: 2024-06-04T07:26:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 8
Flakes in the last 7d: 8",github-automation-metabase,2024-06-05 23:24:10+00:00,[],2024-12-13 16:43:57+00:00,2024-12-13 16:43:57+00:00,https://github.com/metabase/metabase/issues/43698,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2155488318, 'issue_id': 2336982440, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9403733899\nLast Flake Time: 2024-06-06T09:09:00-07:00\nFlakes in the last day: 0\nFlakes in the last 3d: 2\nFlakes in the last 7d: 2', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2233644423, 'issue_id': 2336982440, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9965186383\nLast Flake Time: 2024-07-16T16:43:00-07:00\nFlakes in the last day: 5\nFlakes in the last 3d: 11\nFlakes in the last 7d: 16', 'created_at': datetime.datetime(2024, 7, 17, 15, 49, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2233646608, 'issue_id': 2336982440, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9965186383\nLast Flake Time: 2024-07-16T16:43:00-07:00\nFlakes in the last day: 5\nFlakes in the last 3d: 11\nFlakes in the last 7d: 16', 'created_at': datetime.datetime(2024, 7, 17, 15, 50, 58, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:15 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9403733899
Last Flake Time: 2024-06-06T09:09:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 2
Flakes in the last 7d: 2

github-automation-metabase (Issue Creator) on (2024-07-17 15:49:58 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9965186383
Last Flake Time: 2024-07-16T16:43:00-07:00
Flakes in the last day: 5
Flakes in the last 3d: 11
Flakes in the last 7d: 16

github-automation-metabase (Issue Creator) on (2024-07-17 15:50:58 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9965186383
Last Flake Time: 2024-07-16T16:43:00-07:00
Flakes in the last day: 5
Flakes in the last 3d: 11
Flakes in the last 7d: 16

"
2336982433,issue,closed,not_planned,[Flaky Test]: scenarios > embedding > full app dashboards should send `frame` message with dashboard height when the dashboard is resized (metabase#37437),"Last Flake: https://github.com/metabase/metabase/actions/runs/9374704695
Last Flake Time: 2024-06-04T15:23:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 10
Flakes in the last 7d: 19",github-automation-metabase,2024-06-05 23:24:09+00:00,[],2024-12-13 16:45:37+00:00,2024-12-13 16:45:37+00:00,https://github.com/metabase/metabase/issues/43697,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Embedding', '')]","[{'comment_id': 2155488272, 'issue_id': 2336982433, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9374704695\nLast Flake Time: 2024-06-04T15:23:00-07:00\nFlakes in the last day: 0\nFlakes in the last 3d: 2\nFlakes in the last 7d: 5', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 13, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:13 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9374704695
Last Flake Time: 2024-06-04T15:23:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 2
Flakes in the last 7d: 5

"
2336982415,issue,closed,completed,[Flaky Test]: sidebar should be resizable,"Last Flake: https://github.com/metabase/metabase/actions/runs/9374614270
Last Flake Time: 2024-06-04T15:22:00-07:00
Flakes in the last day: 0
Flakes in the last 3d: 22
Flakes in the last 7d: 44",github-automation-metabase,2024-06-05 23:24:09+00:00,['nemanjaglumac'],2024-06-10 20:40:26+00:00,2024-06-10 17:35:37+00:00,https://github.com/metabase/metabase/issues/43696,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2155488247, 'issue_id': 2336982415, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9411503130\nLast Flake Time: 2024-06-06T21:47:00-07:00\nFlakes in the last day: 9\nFlakes in the last 3d: 25\nFlakes in the last 7d: 25', 'created_at': datetime.datetime(2024, 6, 7, 20, 16, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2158583242, 'issue_id': 2336982415, 'author': 'github-automation-metabase', 'body': 'This test is still flaky\n\nLast Flake: https://github.com/metabase/metabase/actions/runs/9443409743\nLast Flake Time: 2024-06-09T23:58:00-07:00\nFlakes in the last day: 6\nFlakes in the last 3d: 31\nFlakes in the last 7d: 63', 'created_at': datetime.datetime(2024, 6, 10, 14, 53, 9, tzinfo=datetime.timezone.utc)}]","github-automation-metabase (Issue Creator) on (2024-06-07 20:16:11 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9411503130
Last Flake Time: 2024-06-06T21:47:00-07:00
Flakes in the last day: 9
Flakes in the last 3d: 25
Flakes in the last 7d: 25

github-automation-metabase (Issue Creator) on (2024-06-10 14:53:09 UTC): This test is still flaky

Last Flake: https://github.com/metabase/metabase/actions/runs/9443409743
Last Flake Time: 2024-06-09T23:58:00-07:00
Flakes in the last day: 6
Flakes in the last 3d: 31
Flakes in the last 7d: 63

"
2336962649,issue,closed,completed,[Flaky Test]: scenarios > collection items listing sorting should allow to sort unpinned items by columns asc and desc,"Last Flake: https://github.com/metabase/metabase/actions/runs/9374707062
Last Flake Time: 2024-06-04T16:08:00-07:00
Flakes in the last day: 1
Flakes in the last 3d: 23
Flakes in the last 7d: 27",iethree,2024-06-05 22:59:03+00:00,['nemanjaglumac'],2024-10-08 17:08:02+00:00,2024-06-11 19:45:46+00:00,https://github.com/metabase/metabase/issues/43695,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2336874393,issue,closed,not_planned,[Flaky Test]: scenarios > collection items listing sorting should allow to sort unpinned items by columns asc and desc,"Last Flake: https://github.com/metabase/metabase/actions/runs/9374707062
Last Flake Time: 2024-06-04T16:08:00-07:00
Flakes in the last day: 4
Flakes in the last 3d: 23
Flakes in the last 7d: 27",iethree,2024-06-05 21:34:58+00:00,[],2024-06-05 23:01:13+00:00,2024-06-05 23:01:12+00:00,https://github.com/metabase/metabase/issues/43691,"[('.CI & Tests', ''), ('flaky-test-fix', '')]","[{'comment_id': 2151097929, 'issue_id': 2336874393, 'author': 'iethree', 'body': 'duplicate: https://github.com/metabase/metabase/issues/43695', 'created_at': datetime.datetime(2024, 6, 5, 23, 1, 12, tzinfo=datetime.timezone.utc)}]","iethree (Issue Creator) on (2024-06-05 23:01:12 UTC): duplicate: https://github.com/metabase/metabase/issues/43695

"
2336650503,issue,closed,not_planned,Improve `ambiguous column name X` error message to include the line number,"### Describe the bug

We often run into this error message. BUt like which line is the error in? Or which block?
<img width=""506"" alt=""Screenshot 2024-06-04 at 3 14 09 PM"" src=""https://github.com/metabase/metabase/assets/47357846/a9ed8876-15dd-4357-9e3f-00f35319da39"">


### To Reproduce

Create a query with a few ctes or a long query and try to reference some ambiguous column names. See this error message and you dont know which block the issue is in

### Expected behavior

Error message should say which line the error is happening in. JUst like other metabase error messages

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.216-204.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""snowflake"",
      ""redshift""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.7""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.6.0""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-03-04"",
      ""tag"": ""v0.48.8"",
      ""hash"": ""a900c85""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Annoying, slows down dev time

### Additional context

_No response_",aarthi-subramanian,2024-06-05 19:14:26+00:00,[],2024-06-06 08:02:11+00:00,2024-06-06 08:01:24+00:00,https://github.com/metabase/metabase/issues/43683,"[('Querying/Processor', ''), ('Querying/Native', 'The SQL/native query editor'), ('Querying/', '')]","[{'comment_id': 2150872329, 'issue_id': 2336650503, 'author': 'ignacio-mb', 'body': 'Hi @aarthi-subramanian can this be duplicate of https://github.com/metabase/metabase/issues/625 ?', 'created_at': datetime.datetime(2024, 6, 5, 20, 9, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2151653687, 'issue_id': 2336650503, 'author': 'WiNloSt', 'body': ""Based on https://github.com/metabase/metabase/issues/30333#issuecomment-1973885041. This is a duplicate of https://github.com/metabase/metabase/issues/625. I'll close this issue for now. You can also upvote #625 if you haven't.\r\n\r\nThanks for reporting!"", 'created_at': datetime.datetime(2024, 6, 6, 8, 1, 25, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-06-05 20:09:16 UTC): Hi @aarthi-subramanian can this be duplicate of https://github.com/metabase/metabase/issues/625 ?

WiNloSt on (2024-06-06 08:01:25 UTC): Based on https://github.com/metabase/metabase/issues/30333#issuecomment-1973885041. This is a duplicate of https://github.com/metabase/metabase/issues/625. I'll close this issue for now. You can also upvote #625 if you haven't.

Thanks for reporting!

"
2336471321,issue,closed,completed,special characters on the data will break subscriptions,"### Describe the bug

Some crazy chars will break the subscriptions since batik can't handle those

### To Reproduce

1) new sql question
2) 
```
select '	

  ,',1
union all
select '	

  ',2
```
3) save it as a bar chart
4) add it to a dashboard
5) send as a subscription

### Expected behavior

_No response_

### Logs

```	
2024-06-05 13:00:05.497	
2024-06-05 13:00:05,495 ERROR pulse.render :: Pulse card render error
2024-06-05 13:00:04.909	
	... 68 more
2024-06-05 13:00:04.909	
	at org.apache.batik.dom.util.SAXDocumentFactory.createDocument(SAXDocumentFactory.java:453)
2024-06-05 13:00:04.909	
	at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
2024-06-05 13:00:04.909	
	at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
2024-06-05 13:00:04.909	
	at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
2024-06-05 13:00:04.909	
	at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
2024-06-05 13:00:04.909	
	at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
2024-06-05 13:00:04.909	
	at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)



2024-06-05 13:00:04.909	
	at org.apache.xerces.impl.XMLScanner.reportFatalError(Unknown Source)
2024-06-05 13:00:04.909	
	at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
2024-06-05 13:00:04.909	
	at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
2024-06-05 13:00:04.909	
	at org.apache.xerces.impl.XMLErrorReporter.reportError(Unknown Source)
2024-06-05 13:00:04.909	
	at org.apache.xerces.util.ErrorHandlerWrapper.fatalError(Unknown Source)
2024-06-05 13:00:04.909	
	at org.apache.xerces.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
2024-06-05 13:00:04.909	
Caused by: org.xml.sax.SAXParseException; systemId: file:///fake.svg; lineNumber: 1; columnNumber: 9159; An invalid XML character (Unicode: 0x1f) was found in the element content of the document.
2024-06-05 13:00:04.909	
	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
2024-06-05 13:00:04.909	
	at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
2024-06-05 13:00:04.909	
	at metabase.task.send_pulses.SendPulses.execute(send_pulses.clj:96)
2024-06-05 13:00:04.909	
	at metabase.models.task_history$do_with_task_history.invoke(task_history.clj:91)
2024-06-05 13:00:04.909	
	at metabase.models.task_history$do_with_task_history.invokeStatic(task_history.clj:96)
2024-06-05 13:00:04.909	
	at metabase.task.send_pulses.SendPulses$fn__107633.invoke(send_pulses.clj:110)
2024-06-05 13:00:04.909	
	at metabase.task.send_pulses$send_pulses_BANG_.invoke(send_pulses.clj:39)
2024-06-05 13:00:04.909	
	at metabase.task.send_pulses$send_pulses_BANG_.invokeStatic(send_pulses.clj:46)
2024-06-05 13:00:04.909	
	at metabase.task.send_pulses$send_pulses_BANG_.invoke(send_pulses.clj:39)
2024-06-05 13:00:04.909	
	at metabase.task.send_pulses$send_pulses_BANG_.invokeStatic(send_pulses.clj:52)
2024-06-05 13:00:04.909	
	at metabase.task.send_pulses$send_pulses_BANG_$fn__107593.invoke(send_pulses.clj:53)
2024-06-05 13:00:04.909	
	at metabase.models.task_history$do_with_task_history.invoke(task_history.clj:91)
2024-06-05 13:00:04.909	
	at metabase.models.task_history$do_with_task_history.invokeStatic(task_history.clj:96)
2024-06-05 13:00:04.909	
	at metabase.task.send_pulses$send_pulses_BANG_$fn__107593$fn__107594.invoke(send_pulses.clj:57)
2024-06-05 13:00:04.909	
	at clojure.lang.RestFn.invoke(RestFn.java:439)
2024-06-05 13:00:04.909	
	at metabase.pulse$send_pulse_BANG_.doInvoke(pulse.clj:576)
2024-06-05 13:00:04.909	
	at metabase.pulse$send_pulse_BANG_.invokeStatic(pulse.clj:595)
2024-06-05 13:00:04.909	
	at metabase.pulse$send_notifications_BANG_.invoke(pulse.clj:567)
2024-06-05 13:00:04.909	
	at metabase.pulse$send_notifications_BANG_.invokeStatic(pulse.clj:568)
2024-06-05 13:00:04.909	
	at clojure.core$seq__5467.invoke(core.clj:139)
2024-06-05 13:00:04.909	
	at clojure.core$seq__5467.invokeStatic(core.clj:139)
2024-06-05 13:00:04.909	
	at clojure.lang.RT.seq(RT.java:535)
2024-06-05 13:00:04.909	
	at clojure.lang.LazySeq.seq(LazySeq.java:51)
2024-06-05 13:00:04.909	
	at clojure.lang.LazySeq.sval(LazySeq.java:42)
2024-06-05 13:00:04.909	
	at metabase.pulse$parts__GT_notifications$iter__99964__99968$fn__99969.invoke(pulse.clj:513)
2024-06-05 13:00:04.909	
	at metabase.pulse$parts__GT_notifications$iter__99964__99968$fn__99969$fn__99970.invoke(pulse.clj:515)
2024-06-05 13:00:04.909	
	at clojure.lang.MultiFn.invoke(MultiFn.java:239)
2024-06-05 13:00:04.909	
	at metabase.pulse$fn__99889.invoke(pulse.clj:433)
2024-06-05 13:00:04.909	
	at metabase.pulse$fn__99889.invokeStatic(pulse.clj:444)
2024-06-05 13:00:04.909	
	at metabase.email.messages$render_pulse_email.invoke(messages.clj:520)
2024-06-05 13:00:04.909	
	at metabase.email.messages$render_pulse_email.invokeStatic(messages.clj:523)
2024-06-05 13:00:04.909	
	at metabase.email.messages$render_message_body.invoke(messages.clj:494)
2024-06-05 13:00:04.909	
	at metabase.email.messages$render_message_body.invokeStatic(messages.clj:496)
2024-06-05 13:00:04.909	
	at metabase.email.messages$render_message_body$fn__76480.invoke(messages.clj:497)
2024-06-05 13:00:04.909	
	at clojure.core$mapv.invoke(core.clj:6971)
2024-06-05 13:00:04.909	
	at clojure.core$mapv.invokeStatic(core.clj:6971)
2024-06-05 13:00:04.909	
	at clojure.core$reduce.invokeStatic(core.clj:6887)
2024-06-05 13:00:04.909	
	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
2024-06-05 13:00:04.909	
	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
2024-06-05 13:00:04.909	
	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
2024-06-05 13:00:04.909	
	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
2024-06-05 13:00:04.909	
	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
2024-06-05 13:00:04.909	
	at clojure.core.protocols$fn__8249.invoke(protocols.clj:124)
2024-06-05 13:00:04.909	
	at clojure.core.protocols$fn__8249.invokeStatic(protocols.clj:168)
2024-06-05 13:00:04.909	
	at clojure.core$mapv$fn__8535.invoke(core.clj:6980)
2024-06-05 13:00:04.909	
	at metabase.email.messages$render_message_body$fn__76480$fn__76481.invoke(messages.clj:497)
2024-06-05 13:00:04.909	
	at metabase.email.messages$render_part.invoke(messages.clj:440)
2024-06-05 13:00:04.909	
	at metabase.email.messages$render_part.invokeStatic(messages.clj:444)
2024-06-05 13:00:04.909	
	at metabase.pulse.render$fn__75440$render_pulse_section__75445.invoke(render.clj:198)
2024-06-05 13:00:04.909	
	at metabase.pulse.render$fn__75440$render_pulse_section__75445$fn__75449.invoke(render.clj:201)
2024-06-05 13:00:04.909	
	at metabase.pulse.render$fn__75440$render_pulse_section__75445$fn__75449$fn__75452.invoke(render.clj:203)
2024-06-05 13:00:04.909	
	at metabase.pulse.render$fn__75407$render_pulse_card__75412.invoke(render.clj:151)
2024-06-05 13:00:04.908	
	at metabase.pulse.render$fn__75407$render_pulse_card__75412$fn__75413.invoke(render.clj:169)
2024-06-05 13:00:04.908	
	at metabase.pulse.render$fn__75367$render_pulse_card_body__75372.invoke(render.clj:130)
2024-06-05 13:00:04.908	
	at metabase.pulse.render$fn__75367$render_pulse_card_body__75372$fn__75376.invoke(render.clj:140)
2024-06-05 13:00:04.908	
	at clojure.lang.MultiFn.invoke(MultiFn.java:261)
2024-06-05 13:00:04.908	
	at metabase.pulse.render.body$fn__74566$render__74554__74571.invoke(body.clj:840)
2024-06-05 13:00:04.908	
	at metabase.pulse.render.body$fn__74566$render__74554__74571$fn__74572.invoke(body.clj:842)
2024-06-05 13:00:04.908	
	at metabase.pulse.render.body$lab_image_bundle.invoke(body.clj:798)
2024-06-05 13:00:04.908	
	at metabase.pulse.render.body$lab_image_bundle.invokeStatic(body.clj:823)
2024-06-05 13:00:04.908	
	at metabase.pulse.render.js_svg$combo_chart.invoke(js_svg.clj:146)
2024-06-05 13:00:04.908	
	at metabase.pulse.render.js_svg$combo_chart.invokeStatic(js_svg.clj:154)
2024-06-05 13:00:04.908	
	at metabase.pulse.render.js_svg$svg_string__GT_bytes.invoke(js_svg.clj:111)
2024-06-05 13:00:04.908	
	at metabase.pulse.render.js_svg$svg_string__GT_bytes.invokeStatic(js_svg.clj:114)
2024-06-05 13:00:04.908	
	at metabase.pulse.render.js_svg$parse_svg_string.invoke(js_svg.clj:81)
2024-06-05 13:00:04.908	
	at metabase.pulse.render.js_svg$parse_svg_string.invokeStatic(js_svg.clj:85)
2024-06-05 13:00:04.908	
	at org.apache.batik.anim.dom.SAXSVGDocumentFactory.createDocument(SAXSVGDocumentFactory.java:226)
2024-06-05 13:00:04.908	
	at org.apache.batik.dom.util.SAXDocumentFactory.createDocument(SAXDocumentFactory.java:357)
2024-06-05 13:00:04.908	
	at org.apache.batik.dom.util.SAXDocumentFactory.createDocument(SAXDocumentFactory.java:459)
2024-06-05 13:00:04.908	
org.apache.batik.dom.util.SAXIOException: An invalid XML character (Unicode: 0x1f) was found in the element content of the document.
```

### Information about your Metabase installation

```JSON
since the beginning
```


### Severity

P2

### Additional context

![image](https://github.com/metabase/metabase/assets/1711649/b879378c-953d-48c7-b161-e9cf77785d39)
",paoliniluis,2024-06-05 17:38:36+00:00,['adam-james-v'],2024-06-24 23:06:26+00:00,2024-06-24 21:52:11+00:00,https://github.com/metabase/metabase/issues/43677,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Pulses', 'Now called Subscriptions'), ('.Backend', ''), ('Notifications/Slack', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2336424864,issue,closed,completed,Review styling issues for visualizations in questions and dashboards in embedding SDK,"- Add the following visualization types ([ranked by popularity](https://stats.metabase.com/question/5120-viz-type-distribution)) to your local test environment's test page (e.g. the Kitchen Sink in Shoppy); use the StaticDashboard, StaticQuestion and InteractiveQuestion component to render them.
- Experiment with existing theme options (refer to the `MetabaseTheme` type for what is possible today
- **Create new GitHub issues** when issues arise (e.g. the font size scaling does not apply to pivot tables), or if there are possible improvements.

This task is related to https://github.com/metabase/metabase/issues/43672 which reviews possible styling issues in the StaticDashboard component. There will be overlap between these two tasks.

### Ranked visualization list by usage popularity

1. combo
2. pivot
3. area
4. object
5. gauge
6. map
7. progress
8. funnel
9. scatter
10. waterfall",heypoom,2024-06-05 17:11:36+00:00,['heypoom'],2024-06-14 14:03:32+00:00,2024-06-14 14:03:13+00:00,https://github.com/metabase/metabase/issues/43674,"[('Visualization/', ''), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted')]","[{'comment_id': 2168121937, 'issue_id': 2336424864, 'author': 'heypoom', 'body': 'Reviewing the 10 remaining [visualizations](https://github.com/metabase/metabase/issues/43674) in static dashboards, good news is that they already works nicely with theming.\r\n\r\n- Default theming, custom font family & font size, custom colors works well.\r\n- Only minor issues remaining.\r\n  - funnel title color\r\n  - font size scaling for pivot table cell, funnel title, gauge label and chart legend item title\r\n- Colors of gauge and maps can be set in visualization settings already.\r\n  - overriding the gauge and map colors from SDK is still not possible for same reason as [overriding chart colors](https://github.com/metabase/metabase/pull/42960) earlier\r\n- item labels tend to have no padding in some charts (this also applies in regular dashboards, not only embedding)\r\n\r\n<img src=""https://github.com/metabase/metabase/assets/4714175/22762f28-c96a-49a5-866a-2cae6e2f6bcd"" width=""400"">\r\n\r\n<img src=""https://github.com/metabase/metabase/assets/4714175/fee0b169-7728-44a3-bc66-4b860e58a153"" width=""400"">\r\n\r\nCreating tasks for the additional minor issues now.', 'created_at': datetime.datetime(2024, 6, 14, 14, 3, 13, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2024-06-14 14:03:13 UTC): Reviewing the 10 remaining [visualizations](https://github.com/metabase/metabase/issues/43674) in static dashboards, good news is that they already works nicely with theming.

- Default theming, custom font family & font size, custom colors works well.
- Only minor issues remaining.
  - funnel title color
  - font size scaling for pivot table cell, funnel title, gauge label and chart legend item title
- Colors of gauge and maps can be set in visualization settings already.
  - overriding the gauge and map colors from SDK is still not possible for same reason as [overriding chart colors](https://github.com/metabase/metabase/pull/42960) earlier
- item labels tend to have no padding in some charts (this also applies in regular dashboards, not only embedding)

<img src=""https://github.com/metabase/metabase/assets/4714175/22762f28-c96a-49a5-866a-2cae6e2f6bcd"" width=""400"">

<img src=""https://github.com/metabase/metabase/assets/4714175/fee0b169-7728-44a3-bc66-4b860e58a153"" width=""400"">

Creating tasks for the additional minor issues now.

"
2336403411,issue,closed,completed,Review styling issues in static dashboards for embedding SDK,"Review the embedded static dashboard component to identify styles that looks out-of-place, such as the font size of static dashboard components, and create GitHub Issues for those. Can be done alongside https://github.com/metabase/shoppy/issues/26 to use the demo app as a test bench.

This task is related to https://github.com/metabase/metabase/issues/43674 which reviews how viz components renders under embedding, and with theme options applied. There will be overlap between these two tasks.",heypoom,2024-06-05 16:59:43+00:00,['heypoom'],2024-06-13 20:35:31+00:00,2024-06-13 20:35:31+00:00,https://github.com/metabase/metabase/issues/43672,"[('.Team/Embedding', '')]","[{'comment_id': 2166718047, 'issue_id': 2336403411, 'author': 'heypoom', 'body': 'Will continue viz-specific tasks at https://github.com/metabase/metabase/issues/43674. Closing this as the other MS3 tasks are done.', 'created_at': datetime.datetime(2024, 6, 13, 20, 35, 31, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2024-06-13 20:35:31 UTC): Will continue viz-specific tasks at https://github.com/metabase/metabase/issues/43674. Closing this as the other MS3 tasks are done.

"
2336358437,issue,open,,Metabase can't acquire a connection from the pool after some time in Oracle,"### Describe the bug

Daily error in Metabase, which occurs every morning and makes the system unusable with the message **ORA-00604: error occurred at recursive SQL level 1 ORA-01756: quoted string not properly terminated**. This error usually happens at 7am.

### To Reproduce

I don't know exactly how to reproduce the error, but we found a workaround by restarting the metabase daily at 6am.

### Expected behavior

It is expected that it will not be necessary to restart the metabase every night.

### Logs

```
2024-06-05 05:00:00,006 INFO task.sync-databases :: Skipping update, automatic Field value updates are disabled for Database 1.
2024-06-05 06:00:00,003 INFO task.send-pulses :: Sending scheduled pulses...
2024-06-05 07:00:00,481 INFO task.send-pulses :: Sending scheduled pulses...
2024-06-05 07:41:49,801 DEBUG middleware.log :: GET /api/session/properties 200 98.4 ms (1 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 15 Threads do Jetty: 9 / 50 (2 ocioso, 0 na fila) (157 total de threads ativas) Consultas ativas: 0 (0 na fila)
2024-06-05 07:41:51,067 DEBUG middleware.log :: GET /api/public/dashboard/63a8b637-21a2-410b-9dcd-2d928328d720 200 1.4 s (7 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 15 Threads do Jetty: 8 / 50 (2 ocioso, 0 na fila) (157 total de threads ativas) Consultas ativas: 0 (0 na fila)
2024-06-05 07:41:51,301 DEBUG middleware.log :: GET /api/session/properties 200 10.5 ms (1 chamadas ao banco de dados) Conexões com o banco de dados: 2 / 15 Threads do Jetty: 9 / 50 (2 ocioso, 0 na fila) (157 total de threads ativas) Consultas ativas: 0 (0 na fila)
2024-06-05 07:41:51,380 DEBUG middleware.log :: GET /api/public/dashboard/63a8b637-21a2-410b-9dcd-2d928328d720 200 105.3 ms (7 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 15 Threads do Jetty: 8 / 50 (2 ocioso, 0 na fila) (157 total de threads ativas) Consultas ativas: 0 (0 na fila)
2024-06-05 07:41:53,272 DEBUG middleware.log :: GET /api/public/dashboard/63a8b637-21a2-410b-9dcd-2d928328d720/dashcard/925/card/1536 202 [ASYNC: canceled] 1.8 s (11 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 15 Threads do Jetty: 7 / 50 (7 ocioso, 0 na fila) (178 total de threads ativas) Consultas ativas: 11 (0 na fila); oracle DB 10 connections: 0/0 (4 threads blocked)
2024-06-05 07:41:53,272 DEBUG middleware.log :: GET /api/public/dashboard/63a8b637-21a2-410b-9dcd-2d928328d720/dashcard/946/card/1613 202 [ASYNC: canceled] 1.8 s (11 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 15 Threads do Jetty: 7 / 50 (7 ocioso, 0 na fila) (178 total de threads ativas) Consultas ativas: 9 (0 na fila); oracle DB 10 connections: 0/0 (8 threads blocked)
2024-06-05 07:41:53,272 DEBUG middleware.log :: GET /api/public/dashboard/63a8b637-21a2-410b-9dcd-2d928328d720/dashcard/945/card/1611 202 [ASYNC: canceled] 1.8 s (11 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 15 Threads do Jetty: 10 / 50 (7 ocioso, 0 na fila) (178 total de threads ativas) Consultas ativas: 8 (0 na fila); oracle DB 10 connections: 0/0 (6 threads blocked)
2024-06-05 07:41:53,272 DEBUG middleware.log :: GET /api/public/dashboard/63a8b637-21a2-410b-9dcd-2d928328d720/dashcard/948/card/1614 202 [ASYNC: canceled] 1.8 s (11 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 15 Threads do Jetty: 8 / 50 (7 ocioso, 0 na fila) (178 total de threads ativas) Consultas ativas: 7 (0 na fila); oracle DB 10 connections: 0/0 (0 threads blocked)
2024-06-05 07:41:53,272 DEBUG middleware.log :: GET /api/public/dashboard/63a8b637-21a2-410b-9dcd-2d928328d720/dashcard/947/card/1612 202 [ASYNC: canceled] 1.8 s (11 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 15 Threads do Jetty: 9 / 50 (6 ocioso, 0 na fila) (178 total de threads ativas) Consultas ativas: 6 (0 na fila); oracle DB 10 connections: 0/0 (1 threads blocked)
2024-06-05 07:41:54,337 ERROR middleware.catch-exceptions :: Erro ao processar a consulta: ORA-00604: error occurred at recursive SQL level 1
ORA-01756: quoted string not properly terminated

{:database_id 10,
 :started_at #t ""2024-06-05T07:41:52.240265200-03:00[GMT-03:00]"",
 :via
 [{:status :failed,
   :class com.mchange.v2.resourcepool.CannotAcquireResourceException,
   :error ""A ResourcePool could not acquire a resource from its primary factory or source."",
   :stacktrace
   [""com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1507)""
    ""com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:644)""
    ""com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:554)""
    ""com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutAndMarkConnectionInUse(C3P0PooledConnectionPool.java:758)""
    ""com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:685)""
    ""com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:140)""
    ""--> driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:318)""
    ""driver.sql_jdbc.execute$fn__79305.invokeStatic(execute.clj:383)""
    ""driver.sql_jdbc.execute$fn__79305.invoke(execute.clj:381)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:693)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:690)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc$fn__106894.invokeStatic(sql_jdbc.clj:78)""
    ""driver.sql_jdbc$fn__106894.invoke(sql_jdbc.clj:76)""
    ""driver.oracle$fn__121552.invokeStatic(oracle.clj:507)""
    ""driver.oracle$fn__121552.invoke(oracle.clj:505)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72328.invoke(cache.clj:229)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66677.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72149.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72159.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71591.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73496$combined_post_process__73501$combined_post_process_STAR___73502.invoke(query_processor.clj:262)""
    ""query_processor$fn__73496$combined_pre_process__73497$combined_pre_process_STAR___73498.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66774.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239$fn__72243.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67401$fn__67402.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67401.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72236.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72541.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__72176$handle_audit_app_internal_queries__72177$fn__72179.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72187.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71302.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72472.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__73073.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62893$fn__62897.invoke(reducible.clj:131)""]}
  {:status :failed,
   :class java.sql.SQLException,
   :error ""Connections could not be acquired from the underlying database!"",
   :stacktrace
   [""com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:118)""
    ""com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:692)""
    ""com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:140)""
    ""--> driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:318)""
    ""driver.sql_jdbc.execute$fn__79305.invokeStatic(execute.clj:383)""
    ""driver.sql_jdbc.execute$fn__79305.invoke(execute.clj:381)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:693)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:690)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc$fn__106894.invokeStatic(sql_jdbc.clj:78)""
    ""driver.sql_jdbc$fn__106894.invoke(sql_jdbc.clj:76)""
    ""driver.oracle$fn__121552.invokeStatic(oracle.clj:507)""
    ""driver.oracle$fn__121552.invoke(oracle.clj:505)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72328.invoke(cache.clj:229)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66677.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72149.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72159.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71591.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73496$combined_post_process__73501$combined_post_process_STAR___73502.invoke(query_processor.clj:262)""
    ""query_processor$fn__73496$combined_pre_process__73497$combined_pre_process_STAR___73498.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66774.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239$fn__72243.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67401$fn__67402.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67401.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72236.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72541.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__72176$handle_audit_app_internal_queries__72177$fn__72179.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72187.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71302.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72472.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__73073.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62893$fn__62897.invoke(reducible.clj:131)""],
   :state nil}],
 :action_id nil,
 :state ""60000"",
 :json_query
 {:constraints {:max-results 10000, :max-results-bare-rows 2000},
  :type :native,
  :middleware {:js-int-to-string? true, :ignore-cached-results? false},
  :native
  {:query
   ""/*SELECT decode(PERC_META,null,' ',to_char(PERC_META,'fm999G990D00') || '%') PERC_META\nFROM SA_ATENA.VW_META_SERVENTIAS S\nWHERE \n (CODIGO_SERVENTIA IS NULL [AND {ZONA_ELEITORAL} IS NULL]) \n[OR (NUM_ZE = LPAD({ZONA_ELEITORAL},3,'0'))]\nAND CD_META = 'META1'*/\n\nSELECT \n    META1 PERC_META\nFROM \n    SA_ATENA.VW_META_INDICADOR_VALOR_SERVENTIA\nWHERE \n    1=1\n    [[AND ZONA_NUMERO = LPAD({{ZONA_ELEITORAL}},3,'0')]]"",
   :template-tags
   {""ZONA_ELEITORAL""
    {:id ""5a67cc64-f343-8678-4bb8-909311acd1e2"", :name ""ZONA_ELEITORAL"", :display-name ""Zona eleitoral"", :type :text}}},
  :viz-settings {},
  :database 10,
  :parameters [{:type :id, :value [""026""], :id ""61f69444"", :target [:variable [:template-tag ""ZONA_ELEITORAL""]]}],
  :async? true,
  :cache-ttl nil},
 :status :failed,
 :class java.sql.SQLException,
 :stacktrace
 [""oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:629)""
  ""oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:558)""
  ""oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:553)""
  ""oracle.jdbc.driver.T4CTTIfun.processError(T4CTTIfun.java:1376)""
  ""oracle.jdbc.driver.T4CTTIoauthenticate.processError(T4CTTIoauthenticate.java:783)""
  ""oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:771)""
  ""oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:298)""
  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:451)""
  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTHWithO5Logon(T4CTTIoauthenticate.java:1565)""
  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:1314)""
  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:1268)""
  ""oracle.jdbc.driver.T4CConnection.authenticateWithPassword(T4CConnection.java:1515)""
  ""oracle.jdbc.driver.T4CConnection.authenticateUserForLogon(T4CConnection.java:1464)""
  ""oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:676)""
  ""oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:1088)""
  ""oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:89)""
  ""oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:732)""
  ""oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:648)""
  ""--> plugins.jdbc_proxy$proxy_driver$reify__84482.connect(jdbc_proxy.clj:37)""
  ""connection_pool$proxy_data_source$reify__28702.getConnection(connection_pool.clj:29)""],
 :card_id 1611,
 :context :public-dashboard,
 :error ""ORA-00604: error occurred at recursive SQL level 1\nORA-01756: quoted string not properly terminated\n"",
 :row_count 0,
 :running_time 0,
 :data {:rows [], :cols []}}

```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""pt-BR"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""Cp1252"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Windows Server 2012 R2"",
    ""os.version"": ""6.3"",
    ""user.language"": ""pt"",
    ""user.timezone"": ""GMT-3""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""oracle"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""12.19""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-23"",
      ""tag"": ""v0.49.12"",
      ""hash"": ""77e7a81""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

The error requires an unnecessary Metabase restart task

### Additional context

_No response_",tatusis,2024-06-05 16:32:20+00:00,[],2025-02-04 20:25:15+00:00,,https://github.com/metabase/metabase/issues/43669,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Database/Oracle', None), ('.Backend', ''), ('.Team/Drivers', '')]","[{'comment_id': 2150626845, 'issue_id': 2336358437, 'author': 'paoliniluis', 'body': ""can you get the query that metabase does to the db when it fires that query?\r\n\r\nit seems like it's \r\n```\r\nSELECT decode(PERC_META,null,' ',to_char(PERC_META,'fm999G990D00') || '%') PERC_META\\nFROM SA_ATENA.VW_META_SERVENTIAS S\\nWHERE \\n (CODIGO_SERVENTIA IS NULL [AND {ZONA_ELEITORAL} IS NULL]) \\n[OR (NUM_ZE = LPAD({ZONA_ELEITORAL},3,'0'))]\\nAND CD_META = 'META1'*/\\n\\nSELECT \\n    META1 PERC_META\\nFROM \\n    SA_ATENA.VW_META_INDICADOR_VALOR_SERVENTIA\\nWHERE \\n    1=1\\n    [[AND ZONA_NUMERO = LPAD({{ZONA_ELEITORAL}},3,'0')]]\r\n```\r\n\r\nbut I want to know how it's finally compiled before reaching the DW"", 'created_at': datetime.datetime(2024, 6, 5, 17, 50, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2150720392, 'issue_id': 2336358437, 'author': 'tatusis', 'body': 'Hi, thanks for getting back to us. This query is in the log, yes, but we believe it is a Metabase issue in general. Because the error happens with other queries in other databases. In short, from some point onwards all queries in all databases give this same error.\r\n\r\nThe error below is from the same day and happens with another query accessing another database.\r\n\r\n```\r\n2024-06-05 10:29:54,389 ERROR middleware.catch-exceptions :: Erro ao processar a consulta: ORA-00604: ocorrência de erro a nível de instrução de SQL recursiva 1\r\nORA-01756: cadeia de caracteres entre aspas/plicas não terminada corretamente\r\n\r\n{:database_id 7,\r\n :started_at #t ""2024-06-05T10:29:19.644683500-03:00[GMT-03:00]"",\r\n :via\r\n [{:status :failed,\r\n   :class com.mchange.v2.resourcepool.CannotAcquireResourceException,\r\n   :error ""A ResourcePool could not acquire a resource from its primary factory or source."",\r\n   :stacktrace\r\n   [""com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1507)""\r\n    ""com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:644)""\r\n    ""com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:554)""\r\n    ""com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutAndMarkConnectionInUse(C3P0PooledConnectionPool.java:758)""\r\n    ""com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:685)""\r\n    ""com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:140)""\r\n    ""--> driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""\r\n    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:318)""\r\n    ""driver.sql_jdbc.execute$fn__79305.invokeStatic(execute.clj:383)""\r\n    ""driver.sql_jdbc.execute$fn__79305.invoke(execute.clj:381)""\r\n    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:693)""\r\n    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""\r\n    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:690)""\r\n    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""\r\n    ""driver.sql_jdbc$fn__106894.invokeStatic(sql_jdbc.clj:78)""\r\n    ""driver.sql_jdbc$fn__106894.invoke(sql_jdbc.clj:76)""\r\n    ""driver.oracle$fn__121552.invokeStatic(oracle.clj:507)""\r\n    ""driver.oracle$fn__121552.invoke(oracle.clj:505)""\r\n    ""query_processor.context$executef.invokeStatic(context.clj:60)""\r\n    ""query_processor.context$executef.invoke(context.clj:49)""\r\n    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""\r\n    ""query_processor.context.default$default_runf.invoke(default.clj:42)""\r\n    ""query_processor.context$runf.invokeStatic(context.clj:46)""\r\n    ""query_processor.context$runf.invoke(context.clj:40)""\r\n    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""\r\n    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""\r\n    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72328.invoke(cache.clj:229)""\r\n    ""query_processor.middleware.permissions$check_query_permissions$fn__66677.invoke(permissions.clj:140)""\r\n    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72149.invoke(enterprise.clj:51)""\r\n    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72159.invoke(enterprise.clj:64)""\r\n    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71591.invoke(mbql_to_native.clj:24)""\r\n    ""query_processor$fn__73496$combined_post_process__73501$combined_post_process_STAR___73502.invoke(query_processor.clj:262)""\r\n    ""query_processor$fn__73496$combined_pre_process__73497$combined_pre_process_STAR___73498.invoke(query_processor.clj:259)""\r\n    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66774.invoke(fetch_source_query.clj:303)""\r\n    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239$fn__72243.invoke(resolve_database_and_driver.clj:77)""\r\n    ""driver$do_with_driver.invokeStatic(driver.clj:97)""\r\n    ""driver$do_with_driver.invoke(driver.clj:92)""\r\n    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239.invoke(resolve_database_and_driver.clj:76)""\r\n    ""query_processor.middleware.store$initialize_store$fn__67401$fn__67402.invoke(store.clj:14)""\r\n    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""\r\n    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""\r\n    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""\r\n    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""\r\n    ""query_processor.middleware.store$initialize_store$fn__67401.invoke(store.clj:13)""\r\n    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72236.invoke(resolve_database_and_driver.clj:60)""\r\n    ""query_processor.middleware.normalize_query$normalize$fn__72541.invoke(normalize_query.clj:38)""\r\n    ""query_processor.middleware.enterprise$fn__72176$handle_audit_app_internal_queries__72177$fn__72179.invoke(enterprise.clj:96)""\r\n    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72187.invoke(enterprise.clj:103)""\r\n    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71302.invoke(constraints.clj:104)""\r\n    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72472.invoke(process_userland_query.clj:156)""\r\n    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__73073.invoke(catch_exceptions.clj:171)""\r\n    ""query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126)""\r\n    ""query_processor.reducible$async_qp$qp_STAR___62893$fn__62897.invoke(reducible.clj:131)""]}\r\n  {:status :failed,\r\n   :class java.sql.SQLException,\r\n   :error ""Connections could not be acquired from the underlying database!"",\r\n   :stacktrace\r\n   [""com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:118)""\r\n    ""com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:692)""\r\n    ""com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:140)""\r\n    ""--> driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""\r\n    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:318)""\r\n    ""driver.sql_jdbc.execute$fn__79305.invokeStatic(execute.clj:383)""\r\n    ""driver.sql_jdbc.execute$fn__79305.invoke(execute.clj:381)""\r\n    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:693)""\r\n    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""\r\n    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:690)""\r\n    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""\r\n    ""driver.sql_jdbc$fn__106894.invokeStatic(sql_jdbc.clj:78)""\r\n    ""driver.sql_jdbc$fn__106894.invoke(sql_jdbc.clj:76)""\r\n    ""driver.oracle$fn__121552.invokeStatic(oracle.clj:507)""\r\n    ""driver.oracle$fn__121552.invoke(oracle.clj:505)""\r\n    ""query_processor.context$executef.invokeStatic(context.clj:60)""\r\n    ""query_processor.context$executef.invoke(context.clj:49)""\r\n    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""\r\n    ""query_processor.context.default$default_runf.invoke(default.clj:42)""\r\n    ""query_processor.context$runf.invokeStatic(context.clj:46)""\r\n    ""query_processor.context$runf.invoke(context.clj:40)""\r\n    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""\r\n    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""\r\n    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72328.invoke(cache.clj:229)""\r\n    ""query_processor.middleware.permissions$check_query_permissions$fn__66677.invoke(permissions.clj:140)""\r\n    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72149.invoke(enterprise.clj:51)""\r\n    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72159.invoke(enterprise.clj:64)""\r\n    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71591.invoke(mbql_to_native.clj:24)""\r\n    ""query_processor$fn__73496$combined_post_process__73501$combined_post_process_STAR___73502.invoke(query_processor.clj:262)""\r\n    ""query_processor$fn__73496$combined_pre_process__73497$combined_pre_process_STAR___73498.invoke(query_processor.clj:259)""\r\n    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66774.invoke(fetch_source_query.clj:303)""\r\n    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239$fn__72243.invoke(resolve_database_and_driver.clj:77)""\r\n    ""driver$do_with_driver.invokeStatic(driver.clj:97)""\r\n    ""driver$do_with_driver.invoke(driver.clj:92)""\r\n    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239.invoke(resolve_database_and_driver.clj:76)""\r\n    ""query_processor.middleware.store$initialize_store$fn__67401$fn__67402.invoke(store.clj:14)""\r\n    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""\r\n    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""\r\n    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""\r\n    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""\r\n    ""query_processor.middleware.store$initialize_store$fn__67401.invoke(store.clj:13)""\r\n    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72236.invoke(resolve_database_and_driver.clj:60)""\r\n    ""query_processor.middleware.normalize_query$normalize$fn__72541.invoke(normalize_query.clj:38)""\r\n    ""query_processor.middleware.enterprise$fn__72176$handle_audit_app_internal_queries__72177$fn__72179.invoke(enterprise.clj:96)""\r\n    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72187.invoke(enterprise.clj:103)""\r\n    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71302.invoke(constraints.clj:104)""\r\n    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72472.invoke(process_userland_query.clj:156)""\r\n    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__73073.invoke(catch_exceptions.clj:171)""\r\n    ""query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126)""\r\n    ""query_processor.reducible$async_qp$qp_STAR___62893$fn__62897.invoke(reducible.clj:131)""],\r\n   :state nil}],\r\n :action_id nil,\r\n :state ""60000"",\r\n :json_query\r\n {:constraints {:max-results 10000, :max-results-bare-rows 2000},\r\n  :type :query,\r\n  :middleware {:js-int-to-string? true, :ignore-cached-results? false, :process-viz-settings? false},\r\n  :viz-settings nil,\r\n  :database 7,\r\n  :query {:source-table 79241},\r\n  :parameters [],\r\n  :async? true,\r\n  :cache-ttl nil},\r\n :native\r\n {:query\r\n  ""SELECT * FROM (SELECT \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""ID\\"" \\""ID\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""ORDEM\\"" \\""ORDEM\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""TIPO\\"" \\""TIPO\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""MATRICULA\\"" \\""MATRICULA\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""TITULO\\"" \\""TITULO\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""LOGIN\\"" \\""LOGIN\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""NOME\\"" \\""NOME\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""EMAIL\\"" \\""EMAIL\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""CARGO\\"" \\""CARGO\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""CD_LOTACAO\\"" \\""CD_LOTACAO\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""LOTACAO\\"" \\""LOTACAO\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""SITUACAO\\"" \\""SITUACAO\\"", \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"".\\""ACESSO\\"" \\""ACESSO\\"" FROM \\""GUARDIAO\\"".\\""HELPDESK_USUARIOS\\"") WHERE rownum <= 2000"",\r\n  :params nil},\r\n :status :failed,\r\n :class java.sql.SQLException,\r\n :stacktrace\r\n [""oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:629)""\r\n  ""oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:558)""\r\n  ""oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:553)""\r\n  ""oracle.jdbc.driver.T4CTTIfun.processError(T4CTTIfun.java:1376)""\r\n  ""oracle.jdbc.driver.T4CTTIoauthenticate.processError(T4CTTIoauthenticate.java:783)""\r\n  ""oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:771)""\r\n  ""oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:298)""\r\n  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:451)""\r\n  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTHWithO5Logon(T4CTTIoauthenticate.java:1565)""\r\n  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:1314)""\r\n  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:1268)""\r\n  ""oracle.jdbc.driver.T4CConnection.authenticateWithPassword(T4CConnection.java:1515)""\r\n  ""oracle.jdbc.driver.T4CConnection.authenticateUserForLogon(T4CConnection.java:1464)""\r\n  ""oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:676)""\r\n  ""oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:1088)""\r\n  ""oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:89)""\r\n  ""oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:732)""\r\n  ""oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:648)""\r\n  ""--> plugins.jdbc_proxy$proxy_driver$reify__84482.connect(jdbc_proxy.clj:37)""\r\n  ""connection_pool$proxy_data_source$reify__28702.getConnection(connection_pool.clj:29)""],\r\n :card_id 456,\r\n :context :question,\r\n :error\r\n ""ORA-00604: ocorrência de erro a nível de instrução de SQL recursiva 1\\nORA-01756: cadeia de caracteres entre aspas/plicas não terminada corretamente\\n"",\r\n :row_count 0,\r\n :running_time 0,\r\n :preprocessed\r\n {:constraints {:max-results 10000, :max-results-bare-rows 2000},\r\n  :type :query,\r\n  :middleware {:js-int-to-string? true, :ignore-cached-results? false, :process-viz-settings? false},\r\n  :info\r\n  {:executed-by 18,\r\n   :context :question,\r\n   :card-id 456,\r\n   :card-name ""Guardião - Servidores"",\r\n   :visualization-settings {:table.pivot-column ""ORDEM"", :table.cell-column ""ID""}},\r\n  :database 7,\r\n  :query\r\n  {:source-table 79241,\r\n   :fields\r\n   [[:field 490681 nil]\r\n    [:field 490680 nil]\r\n    [:field 490679 nil]\r\n    [:field 490685 nil]\r\n    [:field 490682 nil]\r\n    [:field 490676 nil]\r\n    [:field 490677 nil]\r\n    [:field 490686 nil]\r\n    [:field 490683 nil]\r\n    [:field 490687 nil]\r\n    [:field 490684 nil]\r\n    [:field 490678 nil]\r\n    [:field 490675 nil]],\r\n   :limit 2000,\r\n   :metabase.query-processor.middleware.limit/original-limit nil},\r\n  :async? true},\r\n :data {:rows [], :cols []}}\r\n```', 'created_at': datetime.datetime(2024, 6, 5, 18, 42, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2150746158, 'issue_id': 2336358437, 'author': 'tatusis', 'body': ""Regarding your question, follow the query below, I just ran it in Metabase without errors.\r\n\r\n```\r\n/*SELECT decode(PERC_META,null,' ',to_char(PERC_META,'fm999G990D00') || '%') PERC_META\r\nFROM SA_ATENA.VW_META_SERVENTIAS S\r\nWHERE \r\n (CODIGO_SERVENTIA IS NULL [AND {ZONA_ELEITORAL} IS NULL]) \r\n[OR (NUM_ZE = LPAD({ZONA_ELEITORAL},3,'0'))]\r\nAND CD_META = 'META1'*/\r\n\r\nSELECT \r\n    META1 PERC_META\r\nFROM \r\n    SA_ATENA.VW_META_INDICADOR_VALOR_SERVENTIA\r\nWHERE \r\n    1=1\r\n    [[AND ZONA_NUMERO = LPAD({{ZONA_ELEITORAL}},3,'0')]]\r\n```"", 'created_at': datetime.datetime(2024, 6, 5, 18, 54, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2153382644, 'issue_id': 2336358437, 'author': 'tatusis', 'body': ""Today we had the same error. \r\n\r\nI don't know if it's related, but the log shows some entries with this message:\r\n\r\n`2024-06-06 08:39:44,942 ERROR middleware.catch-exceptions :: Erro ao processar a consulta: Closed`\r\n\r\nThe maximum number of connections in the Metabase profile for this Oracle database is 20 sessions. Metabase is configured with the default of 15 sessions. Oracle's idle time is set to 40min.\r\n\r\nDoes Metabase have some kind of keep alive function? Does the metabase pool have some kind of default idle time for terminating sessions?"", 'created_at': datetime.datetime(2024, 6, 6, 20, 48, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2155299964, 'issue_id': 2336358437, 'author': 'tatusis', 'body': 'Today we had the same error.\r\n\r\n```\r\njava.sql.SQLException: Connections could not be acquired from the underlying database!\r\n\tat com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:118)\r\n\tat com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:692)\r\n\tat com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:140)\r\n\tat metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)\r\n\tat metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:318)\r\n\tat metabase.driver.sql_jdbc.execute$fn__79305.invokeStatic(execute.clj:383)\r\n\tat metabase.driver.sql_jdbc.execute$fn__79305.invoke(execute.clj:381)\r\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:244)\r\n\tat metabase.driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:693)\r\n\tat metabase.driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)\r\n\tat metabase.driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:690)\r\n\tat metabase.driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)\r\n\tat metabase.driver.sql_jdbc$fn__106894.invokeStatic(sql_jdbc.clj:78)\r\n\tat metabase.driver.sql_jdbc$fn__106894.invoke(sql_jdbc.clj:76)\r\n\tat metabase.driver.oracle$fn__121552.invokeStatic(oracle.clj:507)\r\n\tat metabase.driver.oracle$fn__121552.invoke(oracle.clj:505)\r\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:244)\r\n\tat metabase.query_processor.context$executef.invokeStatic(context.clj:60)\r\n\tat metabase.query_processor.context$executef.invoke(context.clj:49)\r\n\tat metabase.query_processor.context.default$default_runf.invokeStatic(default.clj:44)\r\n\tat metabase.query_processor.context.default$default_runf.invoke(default.clj:42)\r\n\tat metabase.query_processor.context$runf.invokeStatic(context.clj:46)\r\n\tat metabase.query_processor.context$runf.invoke(context.clj:40)\r\n\tat metabase.query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)\r\n\tat metabase.query_processor.reducible$identity_qp.invoke(reducible.clj:36)\r\n\tat metabase.query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72328.invoke(cache.clj:229)\r\n\tat metabase.query_processor.middleware.permissions$check_query_permissions$fn__66677.invoke(permissions.clj:140)\r\n\tat metabase.query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72149.invoke(enterprise.clj:51)\r\n\tat metabase.query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72159.invoke(enterprise.clj:64)\r\n\tat metabase.query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71591.invoke(mbql_to_native.clj:24)\r\n\tat metabase.query_processor$fn__73496$combined_post_process__73501$combined_post_process_STAR___73502.invoke(query_processor.clj:262)\r\n\tat metabase.query_processor$fn__73496$combined_pre_process__73497$combined_pre_process_STAR___73498.invoke(query_processor.clj:259)\r\n\tat metabase.query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66774.invoke(fetch_source_query.clj:303)\r\n\tat metabase.query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239$fn__72243.invoke(resolve_database_and_driver.clj:77)\r\n\tat metabase.driver$do_with_driver.invokeStatic(driver.clj:97)\r\n\tat metabase.driver$do_with_driver.invoke(driver.clj:92)\r\n\tat metabase.query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239.invoke(resolve_database_and_driver.clj:76)\r\n\tat metabase.query_processor.middleware.store$initialize_store$fn__67401$fn__67402.invoke(store.clj:14)\r\n\tat metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)\r\n\tat metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:150)\r\n\tat metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)\r\n\tat metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:150)\r\n\tat metabase.query_processor.middleware.store$initialize_store$fn__67401.invoke(store.clj:13)\r\n\tat metabase.query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72236.invoke(resolve_database_and_driver.clj:60)\r\n\tat metabase.query_processor.middleware.normalize_query$normalize$fn__72541.invoke(normalize_query.clj:38)\r\n\tat metabase.query_processor.middleware.enterprise$fn__72176$handle_audit_app_internal_queries__72177$fn__72179.invoke(enterprise.clj:96)\r\n\tat metabase.query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72187.invoke(enterprise.clj:103)\r\n\tat metabase.query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126)\r\n\tat metabase.query_processor.reducible$async_qp$qp_STAR___62893$fn__62897.invoke(reducible.clj:131)\r\n\tat clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047)\r\n\tat clojure.lang.AFn.call(AFn.java:18)\r\n\tat java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n\tat java.base/java.lang.Thread.run(Thread.java:829)\r\nCaused by: com.mchange.v2.resourcepool.CannotAcquireResourceException: A ResourcePool could not acquire a resource from its primary factory or source.\r\n\tat com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1507)\r\n\tat com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:644)\r\n\tat com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:554)\r\n\tat com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutAndMarkConnectionInUse(C3P0PooledConnectionPool.java:758)\r\n\tat com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:685)\r\n\t... 53 more\r\nCaused by: java.sql.SQLException: ORA-00604: error occurred at recursive SQL level 1\r\nORA-01756: quoted string not properly terminated\r\n\r\nhttps://docs.oracle.com/error-help/db/ora-00604/\r\n\tat oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:709)\r\n\tat oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:604)\r\n\tat oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:599)\r\n\tat oracle.jdbc.driver.T4CTTIfun.processError(T4CTTIfun.java:1807)\r\n\tat oracle.jdbc.driver.T4CTTIoauthenticate.processError(T4CTTIoauthenticate.java:903)\r\n\tat oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:1101)\r\n\tat oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:409)\r\n\tat oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:530)\r\n\tat oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTHWithO5Logon(T4CTTIoauthenticate.java:1712)\r\n\tat oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:1459)\r\n\tat oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:1399)\r\n\tat oracle.jdbc.driver.T4CConnection.authenticateWithPassword(T4CConnection.java:2048)\r\n\tat oracle.jdbc.driver.T4CConnection.authenticateUserForLogon(T4CConnection.java:1987)\r\n\tat oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:1088)\r\n\tat oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:1178)\r\n\tat oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:105)\r\n\tat oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:886)\r\n\tat oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:693)\r\n\tat metabase.plugins.jdbc_proxy$proxy_driver$reify__84482.connect(jdbc_proxy.clj:37)\r\n\tat java.sql/java.sql.DriverManager.getConnection(DriverManager.java:677)\r\n\tat java.sql/java.sql.DriverManager.getConnection(DriverManager.java:189)\r\n\tat metabase.connection_pool$proxy_data_source$reify__28702.getConnection(connection_pool.clj:29)\r\n\tat com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:161)\r\n\tat com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:147)\r\n\tat com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:202)\r\n\tat com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1176)\r\n\tat com.mchange.v2.resourcepool.BasicResourcePool.doAcquireAndDecrementPendingAcquiresWithinLockOnSuccess(BasicResourcePool.java:1163)\r\n\tat com.mchange.v2.resourcepool.BasicResourcePool.access$700(BasicResourcePool.java:44)\r\n\tat com.mchange.v2.resourcepool.BasicResourcePool$ScatteredAcquireTask.run(BasicResourcePool.java:1908)\r\n\tat com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:696)\r\n```', 'created_at': datetime.datetime(2024, 6, 7, 18, 11, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2209281061, 'issue_id': 2336358437, 'author': 'tatusis', 'body': 'Hello, I would like to add some information to the reported problem:\r\n\r\nThe error only happens with Oracle databases.\r\n\r\nAfter the error below:\r\n\r\n```\r\n2024-07-03 11:17:45,937 ERROR middleware.catch-exceptions :: Error processing query: ORA-00604: error occurred at recursive SQL level 1\r\nORA-01756: quoted string not properly terminated\r\n```\r\n\r\nAll queries against the same database receive the same error.\r\n\r\nThis error causes the application to display two errors:\r\n\r\n`A ResourcePool could not acquire a resource from its primary factory or source.`\r\n\r\nand\r\n\r\n`Connections could not be acquired from the underlying database!`\r\n\r\nIf possible, I would like to know if you have already received other complaints about the same error or if it was possible to reproduce the error with the information provided and if there is any workaround.', 'created_at': datetime.datetime(2024, 7, 4, 15, 59, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2214921994, 'issue_id': 2336358437, 'author': 'tatusis', 'body': 'Hello,\r\nWe disabled send pulse jobs and noticed a drastic reduction in the number of errors of this type. I am recording this information here as it may help identify the problem.', 'created_at': datetime.datetime(2024, 7, 8, 18, 42, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2215003772, 'issue_id': 2336358437, 'author': 'perivamsi', 'body': '@tatusis thank you for that information, that certainly helps. we will continue to look into this issue.', 'created_at': datetime.datetime(2024, 7, 8, 19, 25, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2474179931, 'issue_id': 2336358437, 'author': 'tatusis', 'body': 'Unfortunately, this error ""**ORA-00604: error occurred at recursive SQL level 1 ORA-01756: quoted string not properly terminated**"" has been occurring more and more frequently and has made using Metabase increasingly difficult. The system only returns to normal use after a reboot, and we are performing several per day. The error happens in all of our Oracle databases, but does not occur in other databases.', 'created_at': datetime.datetime(2024, 11, 13, 16, 49, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2474189891, 'issue_id': 2336358437, 'author': 'tatusis', 'body': 'The error happens several times a day, making all queries in that database unavailable.', 'created_at': datetime.datetime(2024, 11, 13, 16, 53, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2474254904, 'issue_id': 2336358437, 'author': 'paoliniluis', 'body': 'We’re about to upgrade the driver in the next major release, I can backport that if needed to see if this helps', 'created_at': datetime.datetime(2024, 11, 13, 17, 16, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2474293197, 'issue_id': 2336358437, 'author': 'tatusis', 'body': 'Good news. Would that be 0.51 or 0.52? We are using 0.50.', 'created_at': datetime.datetime(2024, 11, 13, 17, 32, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2533803792, 'issue_id': 2336358437, 'author': 's35241607', 'body': 'I also have the same problem, would like to know if there is any solution?', 'created_at': datetime.datetime(2024, 12, 11, 7, 3, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2549133036, 'issue_id': 2336358437, 'author': 'mariovalney', 'body': 'I also have the same problem.', 'created_at': datetime.datetime(2024, 12, 17, 17, 36, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2583535859, 'issue_id': 2336358437, 'author': 'tatusis', 'body': 'Hello @paoliniluis, I would like to share that we have updated Metabase to the latest version (v0.52.5) \u200b\u200band the problem persists. It seems to us that after a certain point, the pool is no longer able to create sessions in the database and, even when it does, they are terminated quickly.', 'created_at': datetime.datetime(2025, 1, 10, 18, 37, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2583599323, 'issue_id': 2336358437, 'author': 'paoliniluis', 'body': '@tatusis have you also upgraded the oracle driver?', 'created_at': datetime.datetime(2025, 1, 10, 18, 55, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2583608602, 'issue_id': 2336358437, 'author': 'tatusis', 'body': 'Yes @paoliniluis, to ojdbc11.', 'created_at': datetime.datetime(2025, 1, 10, 18, 58, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2596156160, 'issue_id': 2336358437, 'author': 'tatusis', 'body': 'Hello, we activate property c3p0.breakAfterAcquireFailure=true on c3p0.properties:\n\nBelow is the log that we have obtained daily at practically the same time..\n\n```\n2025-01-16 10:52:18,260 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/882/card/1550 202 [ASYNC: completed] 52ms (15 DB calls) App DB connections: 2/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 5 (0 queued); oracle DB 7 connections: 0/10 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 10:52:18,260 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/911/card/1583 202 [ASYNC: completed] 49ms (15 DB calls) App DB connections: 2/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 5 (0 queued); oracle DB 7 connections: 1/10 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 10:52:18,260 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/912/card/1584 202 [ASYNC: completed] 49ms (15 DB calls) App DB connections: 1/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 3 (0 queued); oracle DB 7 connections: 2/10 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 10:52:18,276 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/875/card/1547 202 [ASYNC: completed] 57ms (15 DB calls) App DB connections: 1/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 2 (0 queued); oracle DB 7 connections: 3/10 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 10:52:18,276 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/874/card/1546 202 [ASYNC: completed] 60ms (15 DB calls) App DB connections: 3/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 1 (0 queued); oracle DB 7 connections: 4/10 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 10:52:18,292 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/873/card/1553 202 [ASYNC: completed] 68ms (15 DB calls) App DB connections: 3/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 0 (0 queued); oracle DB 7 connections: 4/10 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 10:52:18,354 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/1067/card/1883 202 [ASYNC: completed] 54ms (15 DB calls) App DB connections: 2/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 4 (0 queued); oracle DB 7 connections: 1/10 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 10:52:18,354 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/1066/card/1881 202 [ASYNC: completed] 51ms (16 DB calls) App DB connections: 4/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 2 (0 queued); oracle DB 7 connections: 3/10 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 10:52:18,354 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/1065/card/1882 202 [ASYNC: completed] 47ms (16 DB calls) App DB connections: 4/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 3 (0 queued); oracle DB 7 connections: 4/10 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 10:52:18,354 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/878/card/1555 202 [ASYNC: completed] 71ms (16 DB calls) App DB connections: 4/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 2 (0 queued); oracle DB 7 connections: 2/10 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 10:52:18,839 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/876/card/1554 202 [ASYNC: completed] 542ms (16 DB calls) App DB connections: 1/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 0 (0 queued); oracle DB 7 connections: 0/10 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 11:00:00,276 INFO notification.send :: [Notification 6] Sending\n2025-01-16 11:00:15,181 INFO notification.send :: [Notification 6] Sending message to channel :channel/email\n2025-01-16 11:00:15,306 INFO notification.send :: [Notification 6] Sent successfully\n2025-01-16 11:10:50,313 DEBUG middleware.log :: GET /api/session/properties 200 10ms (1 DB calls) App DB connections: 0/12 Jetty threads: 8/50 (1 idle, 0 queued) (144 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n2025-01-16 11:10:50,360 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7 200 21ms (6 DB calls) App DB connections: 0/12 Jetty threads: 8/50 (1 idle, 0 queued) (146 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n2025-01-16 11:10:50,454 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/882/card/1550 202 [ASYNC: completed] 46ms (16 DB calls) App DB connections: 1/12 Jetty threads: 8/50 (1 idle, 0 queued) (147 total active threads) Queries in flight: 2 (0 queued); oracle DB 7 connections: 0/1 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 11:10:50,469 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/873/card/1553 202 [ASYNC: completed] 71ms (15 DB calls) App DB connections: 0/12 Jetty threads: 11/50 (0 idle, 0 queued) (147 total active threads) Queries in flight: 2 (0 queued); oracle DB 7 connections: 1/1 (0 threads blocked) {:metabase-user-id nil}\n2025-01-16 11:10:50,641 ERROR resourcepool.BasicResourcePool :: A RESOURCE POOL IS PERMANENTLY BROKEN! [com.mchange.v2.resourcepool.BasicResourcePool$ScatteredAcquireTask@5243a82a] (because a series of 0 acquisition attempts failed.)\n2025-01-16 11:10:50,641 ERROR resourcepool.BasicResourcePool :: com.mchange.v2.resourcepool.BasicResourcePool@24a29207 -- Unexpectedly broken!!!\ncom.mchange.v2.resourcepool.ResourcePoolException: Unexpected Break Stack Trace!\n\tat com.mchange.v2.resourcepool.BasicResourcePool.unexpectedBreak(BasicResourcePool.java:948)\n\tat com.mchange.v2.resourcepool.BasicResourcePool.access$1000(BasicResourcePool.java:9)\n\tat com.mchange.v2.resourcepool.BasicResourcePool$ScatteredAcquireTask.run(BasicResourcePool.java:1903)\n\tat com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:696)\n2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/911/card/1583 202 [ASYNC: canceled] 172ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (4 threads blocked) {:metabase-user-id nil}\n2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/882/card/1550 202 [ASYNC: canceled] 175ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (2 threads blocked) {:metabase-user-id nil}\n2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/875/card/1547 202 [ASYNC: canceled] 163ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (6 threads blocked) {:metabase-user-id nil}\n2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/912/card/1584 202 [ASYNC: canceled] 215ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (1 threads blocked) {:metabase-user-id nil}\n2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/874/card/1546 202 [ASYNC: canceled] 157ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (7 threads blocked) {:metabase-user-id nil}\n2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/912/card/1584 202 [ASYNC: canceled] 165ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (5 threads blocked) {:metabase-user-id nil}\n2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/873/card/1553 202 [ASYNC: canceled] 175ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (3 threads blocked) {:metabase-user-id nil}\n2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/911/card/1583 202 [ASYNC: canceled] 238ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (1 threads blocked) {:metabase-user-id nil}\n```', 'created_at': datetime.datetime(2025, 1, 16, 16, 19, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2596883322, 'issue_id': 2336358437, 'author': 'luizarakaki', 'body': '@tatusis Do you have reports on memory consumption? Can you check if your instance has OOM errors?', 'created_at': datetime.datetime(2025, 1, 16, 21, 3, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2596936079, 'issue_id': 2336358437, 'author': 'tatusis', 'body': 'This server has 128GB of RAM and, on average, 69% of the memory is occupied.\n\nIn short, this metabase connects to other databases, but this error only happens in Oracle databases. Send pulse was disabled as we realized it was causing the issue at a time determined by the schedule. Even after this removal, the error still happens from time to time. I have already verified that it is possible to initiate a connection to the Oracle database with another tool, such as SQL Developer, for example.\n\nEdited: the server event log does not show out of memory errors.', 'created_at': datetime.datetime(2025, 1, 16, 21, 34, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2610937443, 'issue_id': 2336358437, 'author': 'paoliniluis', 'body': '@tatusis can you add MB_JDBC_DATA_WAREHOUSE_UNRETURNED_CONNECTION_TIMEOUT_SECONDS=600 to the environment variables and let us know if this happens again?', 'created_at': datetime.datetime(2025, 1, 23, 20, 19, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2612907923, 'issue_id': 2336358437, 'author': 'tatusis', 'body': ""Hello @paoliniluis, I made the change you recommended, but the problem persists.\n\nToday, when I opened a dashboard in Metabase, I found this situation:\n\n![Image](https://github.com/user-attachments/assets/5da2bf34-9d02-4ea8-845a-2dc2d66a4949)\n\nSome dashboard queries worked and others didn't.\n\nSo I looked in the database and there was only one metabase user session:\n\n![Image](https://github.com/user-attachments/assets/fac481fb-b9ac-4d5c-adf1-37f684592b90)\n\nI reset the metabase and opened the same dashboard. Everything started working again:\n\n![Image](https://github.com/user-attachments/assets/d4b8e199-5b44-4d51-ad94-0e8b99492d80)\n\nand when running this dashboard, the sessions in the bank appear again:\n\n![Image](https://github.com/user-attachments/assets/06ff5f2b-32ce-46e0-b820-24948afa8dc2)"", 'created_at': datetime.datetime(2025, 1, 24, 16, 18, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2612947184, 'issue_id': 2336358437, 'author': 'paoliniluis', 'body': 'thanks @tatusis, and what about oracle logs, do they say something when it unplugs the Metabase connections?', 'created_at': datetime.datetime(2025, 1, 24, 16, 38, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2612980242, 'issue_id': 2336358437, 'author': 'mariovalney', 'body': '_JFYI_\n\n**TL;DR:** We encountered this issue and resolved it with a fresh installation.\n\nAt my company, we faced the exact same issue. Our Metabase instance was running in Docker on an EC2 instance managed by a partner. After multiple attempts and countless restarts, we decided to internalize the setup and recreated the same infrastructure (same instance type, Docker version, Metabase version, and ODBC version - of course, connected to the same database) on our side.\n\nSince then, the problem has not occurred again.', 'created_at': datetime.datetime(2025, 1, 24, 16, 55, 1, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-05 17:50:27 UTC): can you get the query that metabase does to the db when it fires that query?

it seems like it's 
```
SELECT decode(PERC_META,null,' ',to_char(PERC_META,'fm999G990D00') || '%') PERC_META\nFROM SA_ATENA.VW_META_SERVENTIAS S\nWHERE \n (CODIGO_SERVENTIA IS NULL [AND {ZONA_ELEITORAL} IS NULL]) \n[OR (NUM_ZE = LPAD({ZONA_ELEITORAL},3,'0'))]\nAND CD_META = 'META1'*/\n\nSELECT \n    META1 PERC_META\nFROM \n    SA_ATENA.VW_META_INDICADOR_VALOR_SERVENTIA\nWHERE \n    1=1\n    [[AND ZONA_NUMERO = LPAD({{ZONA_ELEITORAL}},3,'0')]]
```

but I want to know how it's finally compiled before reaching the DW

tatusis (Issue Creator) on (2024-06-05 18:42:06 UTC): Hi, thanks for getting back to us. This query is in the log, yes, but we believe it is a Metabase issue in general. Because the error happens with other queries in other databases. In short, from some point onwards all queries in all databases give this same error.

The error below is from the same day and happens with another query accessing another database.

```
2024-06-05 10:29:54,389 ERROR middleware.catch-exceptions :: Erro ao processar a consulta: ORA-00604: ocorrência de erro a nível de instrução de SQL recursiva 1
ORA-01756: cadeia de caracteres entre aspas/plicas não terminada corretamente

{:database_id 7,
 :started_at #t ""2024-06-05T10:29:19.644683500-03:00[GMT-03:00]"",
 :via
 [{:status :failed,
   :class com.mchange.v2.resourcepool.CannotAcquireResourceException,
   :error ""A ResourcePool could not acquire a resource from its primary factory or source."",
   :stacktrace
   [""com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1507)""
    ""com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:644)""
    ""com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:554)""
    ""com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutAndMarkConnectionInUse(C3P0PooledConnectionPool.java:758)""
    ""com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:685)""
    ""com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:140)""
    ""--> driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:318)""
    ""driver.sql_jdbc.execute$fn__79305.invokeStatic(execute.clj:383)""
    ""driver.sql_jdbc.execute$fn__79305.invoke(execute.clj:381)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:693)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:690)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc$fn__106894.invokeStatic(sql_jdbc.clj:78)""
    ""driver.sql_jdbc$fn__106894.invoke(sql_jdbc.clj:76)""
    ""driver.oracle$fn__121552.invokeStatic(oracle.clj:507)""
    ""driver.oracle$fn__121552.invoke(oracle.clj:505)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72328.invoke(cache.clj:229)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66677.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72149.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72159.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71591.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73496$combined_post_process__73501$combined_post_process_STAR___73502.invoke(query_processor.clj:262)""
    ""query_processor$fn__73496$combined_pre_process__73497$combined_pre_process_STAR___73498.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66774.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239$fn__72243.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67401$fn__67402.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67401.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72236.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72541.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__72176$handle_audit_app_internal_queries__72177$fn__72179.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72187.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71302.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72472.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__73073.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62893$fn__62897.invoke(reducible.clj:131)""]}
  {:status :failed,
   :class java.sql.SQLException,
   :error ""Connections could not be acquired from the underlying database!"",
   :stacktrace
   [""com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:118)""
    ""com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:692)""
    ""com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:140)""
    ""--> driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:318)""
    ""driver.sql_jdbc.execute$fn__79305.invokeStatic(execute.clj:383)""
    ""driver.sql_jdbc.execute$fn__79305.invoke(execute.clj:381)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:693)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:690)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc$fn__106894.invokeStatic(sql_jdbc.clj:78)""
    ""driver.sql_jdbc$fn__106894.invoke(sql_jdbc.clj:76)""
    ""driver.oracle$fn__121552.invokeStatic(oracle.clj:507)""
    ""driver.oracle$fn__121552.invoke(oracle.clj:505)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72328.invoke(cache.clj:229)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66677.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72149.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72159.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71591.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73496$combined_post_process__73501$combined_post_process_STAR___73502.invoke(query_processor.clj:262)""
    ""query_processor$fn__73496$combined_pre_process__73497$combined_pre_process_STAR___73498.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66774.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239$fn__72243.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67401$fn__67402.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67401.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72236.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72541.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__72176$handle_audit_app_internal_queries__72177$fn__72179.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72187.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71302.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72472.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__73073.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62893$fn__62897.invoke(reducible.clj:131)""],
   :state nil}],
 :action_id nil,
 :state ""60000"",
 :json_query
 {:constraints {:max-results 10000, :max-results-bare-rows 2000},
  :type :query,
  :middleware {:js-int-to-string? true, :ignore-cached-results? false, :process-viz-settings? false},
  :viz-settings nil,
  :database 7,
  :query {:source-table 79241},
  :parameters [],
  :async? true,
  :cache-ttl nil},
 :native
 {:query
  ""SELECT * FROM (SELECT \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""ID\"" \""ID\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""ORDEM\"" \""ORDEM\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""TIPO\"" \""TIPO\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""MATRICULA\"" \""MATRICULA\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""TITULO\"" \""TITULO\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""LOGIN\"" \""LOGIN\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""NOME\"" \""NOME\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""EMAIL\"" \""EMAIL\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""CARGO\"" \""CARGO\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""CD_LOTACAO\"" \""CD_LOTACAO\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""LOTACAO\"" \""LOTACAO\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""SITUACAO\"" \""SITUACAO\"", \""GUARDIAO\"".\""HELPDESK_USUARIOS\"".\""ACESSO\"" \""ACESSO\"" FROM \""GUARDIAO\"".\""HELPDESK_USUARIOS\"") WHERE rownum <= 2000"",
  :params nil},
 :status :failed,
 :class java.sql.SQLException,
 :stacktrace
 [""oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:629)""
  ""oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:558)""
  ""oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:553)""
  ""oracle.jdbc.driver.T4CTTIfun.processError(T4CTTIfun.java:1376)""
  ""oracle.jdbc.driver.T4CTTIoauthenticate.processError(T4CTTIoauthenticate.java:783)""
  ""oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:771)""
  ""oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:298)""
  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:451)""
  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTHWithO5Logon(T4CTTIoauthenticate.java:1565)""
  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:1314)""
  ""oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:1268)""
  ""oracle.jdbc.driver.T4CConnection.authenticateWithPassword(T4CConnection.java:1515)""
  ""oracle.jdbc.driver.T4CConnection.authenticateUserForLogon(T4CConnection.java:1464)""
  ""oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:676)""
  ""oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:1088)""
  ""oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:89)""
  ""oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:732)""
  ""oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:648)""
  ""--> plugins.jdbc_proxy$proxy_driver$reify__84482.connect(jdbc_proxy.clj:37)""
  ""connection_pool$proxy_data_source$reify__28702.getConnection(connection_pool.clj:29)""],
 :card_id 456,
 :context :question,
 :error
 ""ORA-00604: ocorrência de erro a nível de instrução de SQL recursiva 1\nORA-01756: cadeia de caracteres entre aspas/plicas não terminada corretamente\n"",
 :row_count 0,
 :running_time 0,
 :preprocessed
 {:constraints {:max-results 10000, :max-results-bare-rows 2000},
  :type :query,
  :middleware {:js-int-to-string? true, :ignore-cached-results? false, :process-viz-settings? false},
  :info
  {:executed-by 18,
   :context :question,
   :card-id 456,
   :card-name ""Guardião - Servidores"",
   :visualization-settings {:table.pivot-column ""ORDEM"", :table.cell-column ""ID""}},
  :database 7,
  :query
  {:source-table 79241,
   :fields
   [[:field 490681 nil]
    [:field 490680 nil]
    [:field 490679 nil]
    [:field 490685 nil]
    [:field 490682 nil]
    [:field 490676 nil]
    [:field 490677 nil]
    [:field 490686 nil]
    [:field 490683 nil]
    [:field 490687 nil]
    [:field 490684 nil]
    [:field 490678 nil]
    [:field 490675 nil]],
   :limit 2000,
   :metabase.query-processor.middleware.limit/original-limit nil},
  :async? true},
 :data {:rows [], :cols []}}
```

tatusis (Issue Creator) on (2024-06-05 18:54:45 UTC): Regarding your question, follow the query below, I just ran it in Metabase without errors.

```
/*SELECT decode(PERC_META,null,' ',to_char(PERC_META,'fm999G990D00') || '%') PERC_META
FROM SA_ATENA.VW_META_SERVENTIAS S
WHERE 
 (CODIGO_SERVENTIA IS NULL [AND {ZONA_ELEITORAL} IS NULL]) 
[OR (NUM_ZE = LPAD({ZONA_ELEITORAL},3,'0'))]
AND CD_META = 'META1'*/

SELECT 
    META1 PERC_META
FROM 
    SA_ATENA.VW_META_INDICADOR_VALOR_SERVENTIA
WHERE 
    1=1
    [[AND ZONA_NUMERO = LPAD({{ZONA_ELEITORAL}},3,'0')]]
```

tatusis (Issue Creator) on (2024-06-06 20:48:02 UTC): Today we had the same error. 

I don't know if it's related, but the log shows some entries with this message:

`2024-06-06 08:39:44,942 ERROR middleware.catch-exceptions :: Erro ao processar a consulta: Closed`

The maximum number of connections in the Metabase profile for this Oracle database is 20 sessions. Metabase is configured with the default of 15 sessions. Oracle's idle time is set to 40min.

Does Metabase have some kind of keep alive function? Does the metabase pool have some kind of default idle time for terminating sessions?

tatusis (Issue Creator) on (2024-06-07 18:11:45 UTC): Today we had the same error.

```
java.sql.SQLException: Connections could not be acquired from the underlying database!
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:118)
	at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:692)
	at com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource.getConnection(AbstractPoolBackedDataSource.java:140)
	at metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)
	at metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:318)
	at metabase.driver.sql_jdbc.execute$fn__79305.invokeStatic(execute.clj:383)
	at metabase.driver.sql_jdbc.execute$fn__79305.invoke(execute.clj:381)
	at clojure.lang.MultiFn.invoke(MultiFn.java:244)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:693)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:690)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)
	at metabase.driver.sql_jdbc$fn__106894.invokeStatic(sql_jdbc.clj:78)
	at metabase.driver.sql_jdbc$fn__106894.invoke(sql_jdbc.clj:76)
	at metabase.driver.oracle$fn__121552.invokeStatic(oracle.clj:507)
	at metabase.driver.oracle$fn__121552.invoke(oracle.clj:505)
	at clojure.lang.MultiFn.invoke(MultiFn.java:244)
	at metabase.query_processor.context$executef.invokeStatic(context.clj:60)
	at metabase.query_processor.context$executef.invoke(context.clj:49)
	at metabase.query_processor.context.default$default_runf.invokeStatic(default.clj:44)
	at metabase.query_processor.context.default$default_runf.invoke(default.clj:42)
	at metabase.query_processor.context$runf.invokeStatic(context.clj:46)
	at metabase.query_processor.context$runf.invoke(context.clj:40)
	at metabase.query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)
	at metabase.query_processor.reducible$identity_qp.invoke(reducible.clj:36)
	at metabase.query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72328.invoke(cache.clj:229)
	at metabase.query_processor.middleware.permissions$check_query_permissions$fn__66677.invoke(permissions.clj:140)
	at metabase.query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72149.invoke(enterprise.clj:51)
	at metabase.query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72159.invoke(enterprise.clj:64)
	at metabase.query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71591.invoke(mbql_to_native.clj:24)
	at metabase.query_processor$fn__73496$combined_post_process__73501$combined_post_process_STAR___73502.invoke(query_processor.clj:262)
	at metabase.query_processor$fn__73496$combined_pre_process__73497$combined_pre_process_STAR___73498.invoke(query_processor.clj:259)
	at metabase.query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66774.invoke(fetch_source_query.clj:303)
	at metabase.query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239$fn__72243.invoke(resolve_database_and_driver.clj:77)
	at metabase.driver$do_with_driver.invokeStatic(driver.clj:97)
	at metabase.driver$do_with_driver.invoke(driver.clj:92)
	at metabase.query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239.invoke(resolve_database_and_driver.clj:76)
	at metabase.query_processor.middleware.store$initialize_store$fn__67401$fn__67402.invoke(store.clj:14)
	at metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)
	at metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:150)
	at metabase.query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)
	at metabase.query_processor.store$do_with_metadata_provider.invoke(store.clj:150)
	at metabase.query_processor.middleware.store$initialize_store$fn__67401.invoke(store.clj:13)
	at metabase.query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72236.invoke(resolve_database_and_driver.clj:60)
	at metabase.query_processor.middleware.normalize_query$normalize$fn__72541.invoke(normalize_query.clj:38)
	at metabase.query_processor.middleware.enterprise$fn__72176$handle_audit_app_internal_queries__72177$fn__72179.invoke(enterprise.clj:96)
	at metabase.query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72187.invoke(enterprise.clj:103)
	at metabase.query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126)
	at metabase.query_processor.reducible$async_qp$qp_STAR___62893$fn__62897.invoke(reducible.clj:131)
	at clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047)
	at clojure.lang.AFn.call(AFn.java:18)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: com.mchange.v2.resourcepool.CannotAcquireResourceException: A ResourcePool could not acquire a resource from its primary factory or source.
	at com.mchange.v2.resourcepool.BasicResourcePool.awaitAvailable(BasicResourcePool.java:1507)
	at com.mchange.v2.resourcepool.BasicResourcePool.prelimCheckoutResource(BasicResourcePool.java:644)
	at com.mchange.v2.resourcepool.BasicResourcePool.checkoutResource(BasicResourcePool.java:554)
	at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutAndMarkConnectionInUse(C3P0PooledConnectionPool.java:758)
	at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool.checkoutPooledConnection(C3P0PooledConnectionPool.java:685)
	... 53 more
Caused by: java.sql.SQLException: ORA-00604: error occurred at recursive SQL level 1
ORA-01756: quoted string not properly terminated

https://docs.oracle.com/error-help/db/ora-00604/
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:709)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:604)
	at oracle.jdbc.driver.T4CTTIoer11.processError(T4CTTIoer11.java:599)
	at oracle.jdbc.driver.T4CTTIfun.processError(T4CTTIfun.java:1807)
	at oracle.jdbc.driver.T4CTTIoauthenticate.processError(T4CTTIoauthenticate.java:903)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:1101)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:409)
	at oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:530)
	at oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTHWithO5Logon(T4CTTIoauthenticate.java:1712)
	at oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:1459)
	at oracle.jdbc.driver.T4CTTIoauthenticate.doOAUTH(T4CTTIoauthenticate.java:1399)
	at oracle.jdbc.driver.T4CConnection.authenticateWithPassword(T4CConnection.java:2048)
	at oracle.jdbc.driver.T4CConnection.authenticateUserForLogon(T4CConnection.java:1987)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:1088)
	at oracle.jdbc.driver.PhysicalConnection.connect(PhysicalConnection.java:1178)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:105)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:886)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:693)
	at metabase.plugins.jdbc_proxy$proxy_driver$reify__84482.connect(jdbc_proxy.clj:37)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:677)
	at java.sql/java.sql.DriverManager.getConnection(DriverManager.java:189)
	at metabase.connection_pool$proxy_data_source$reify__28702.getConnection(connection_pool.clj:29)
	at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:161)
	at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:147)
	at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:202)
	at com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1176)
	at com.mchange.v2.resourcepool.BasicResourcePool.doAcquireAndDecrementPendingAcquiresWithinLockOnSuccess(BasicResourcePool.java:1163)
	at com.mchange.v2.resourcepool.BasicResourcePool.access$700(BasicResourcePool.java:44)
	at com.mchange.v2.resourcepool.BasicResourcePool$ScatteredAcquireTask.run(BasicResourcePool.java:1908)
	at com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:696)
```

tatusis (Issue Creator) on (2024-07-04 15:59:52 UTC): Hello, I would like to add some information to the reported problem:

The error only happens with Oracle databases.

After the error below:

```
2024-07-03 11:17:45,937 ERROR middleware.catch-exceptions :: Error processing query: ORA-00604: error occurred at recursive SQL level 1
ORA-01756: quoted string not properly terminated
```

All queries against the same database receive the same error.

This error causes the application to display two errors:

`A ResourcePool could not acquire a resource from its primary factory or source.`

and

`Connections could not be acquired from the underlying database!`

If possible, I would like to know if you have already received other complaints about the same error or if it was possible to reproduce the error with the information provided and if there is any workaround.

tatusis (Issue Creator) on (2024-07-08 18:42:05 UTC): Hello,
We disabled send pulse jobs and noticed a drastic reduction in the number of errors of this type. I am recording this information here as it may help identify the problem.

perivamsi on (2024-07-08 19:25:20 UTC): @tatusis thank you for that information, that certainly helps. we will continue to look into this issue.

tatusis (Issue Creator) on (2024-11-13 16:49:58 UTC): Unfortunately, this error ""**ORA-00604: error occurred at recursive SQL level 1 ORA-01756: quoted string not properly terminated**"" has been occurring more and more frequently and has made using Metabase increasingly difficult. The system only returns to normal use after a reboot, and we are performing several per day. The error happens in all of our Oracle databases, but does not occur in other databases.

tatusis (Issue Creator) on (2024-11-13 16:53:10 UTC): The error happens several times a day, making all queries in that database unavailable.

paoliniluis on (2024-11-13 17:16:01 UTC): We’re about to upgrade the driver in the next major release, I can backport that if needed to see if this helps

tatusis (Issue Creator) on (2024-11-13 17:32:33 UTC): Good news. Would that be 0.51 or 0.52? We are using 0.50.

s35241607 on (2024-12-11 07:03:33 UTC): I also have the same problem, would like to know if there is any solution?

mariovalney on (2024-12-17 17:36:28 UTC): I also have the same problem.

tatusis (Issue Creator) on (2025-01-10 18:37:37 UTC): Hello @paoliniluis, I would like to share that we have updated Metabase to the latest version (v0.52.5) ​​and the problem persists. It seems to us that after a certain point, the pool is no longer able to create sessions in the database and, even when it does, they are terminated quickly.

paoliniluis on (2025-01-10 18:55:53 UTC): @tatusis have you also upgraded the oracle driver?

tatusis (Issue Creator) on (2025-01-10 18:58:25 UTC): Yes @paoliniluis, to ojdbc11.

tatusis (Issue Creator) on (2025-01-16 16:19:59 UTC): Hello, we activate property c3p0.breakAfterAcquireFailure=true on c3p0.properties:

Below is the log that we have obtained daily at practically the same time..

```
2025-01-16 10:52:18,260 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/882/card/1550 202 [ASYNC: completed] 52ms (15 DB calls) App DB connections: 2/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 5 (0 queued); oracle DB 7 connections: 0/10 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 10:52:18,260 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/911/card/1583 202 [ASYNC: completed] 49ms (15 DB calls) App DB connections: 2/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 5 (0 queued); oracle DB 7 connections: 1/10 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 10:52:18,260 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/912/card/1584 202 [ASYNC: completed] 49ms (15 DB calls) App DB connections: 1/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 3 (0 queued); oracle DB 7 connections: 2/10 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 10:52:18,276 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/875/card/1547 202 [ASYNC: completed] 57ms (15 DB calls) App DB connections: 1/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 2 (0 queued); oracle DB 7 connections: 3/10 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 10:52:18,276 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/874/card/1546 202 [ASYNC: completed] 60ms (15 DB calls) App DB connections: 3/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 1 (0 queued); oracle DB 7 connections: 4/10 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 10:52:18,292 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/873/card/1553 202 [ASYNC: completed] 68ms (15 DB calls) App DB connections: 3/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 0 (0 queued); oracle DB 7 connections: 4/10 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 10:52:18,354 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/1067/card/1883 202 [ASYNC: completed] 54ms (15 DB calls) App DB connections: 2/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 4 (0 queued); oracle DB 7 connections: 1/10 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 10:52:18,354 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/1066/card/1881 202 [ASYNC: completed] 51ms (16 DB calls) App DB connections: 4/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 2 (0 queued); oracle DB 7 connections: 3/10 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 10:52:18,354 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/1065/card/1882 202 [ASYNC: completed] 47ms (16 DB calls) App DB connections: 4/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 3 (0 queued); oracle DB 7 connections: 4/10 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 10:52:18,354 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/878/card/1555 202 [ASYNC: completed] 71ms (16 DB calls) App DB connections: 4/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 2 (0 queued); oracle DB 7 connections: 2/10 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 10:52:18,839 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/876/card/1554 202 [ASYNC: completed] 542ms (16 DB calls) App DB connections: 1/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 0 (0 queued); oracle DB 7 connections: 0/10 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 11:00:00,276 INFO notification.send :: [Notification 6] Sending
2025-01-16 11:00:15,181 INFO notification.send :: [Notification 6] Sending message to channel :channel/email
2025-01-16 11:00:15,306 INFO notification.send :: [Notification 6] Sent successfully
2025-01-16 11:10:50,313 DEBUG middleware.log :: GET /api/session/properties 200 10ms (1 DB calls) App DB connections: 0/12 Jetty threads: 8/50 (1 idle, 0 queued) (144 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
2025-01-16 11:10:50,360 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7 200 21ms (6 DB calls) App DB connections: 0/12 Jetty threads: 8/50 (1 idle, 0 queued) (146 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
2025-01-16 11:10:50,454 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/882/card/1550 202 [ASYNC: completed] 46ms (16 DB calls) App DB connections: 1/12 Jetty threads: 8/50 (1 idle, 0 queued) (147 total active threads) Queries in flight: 2 (0 queued); oracle DB 7 connections: 0/1 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 11:10:50,469 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/873/card/1553 202 [ASYNC: completed] 71ms (15 DB calls) App DB connections: 0/12 Jetty threads: 11/50 (0 idle, 0 queued) (147 total active threads) Queries in flight: 2 (0 queued); oracle DB 7 connections: 1/1 (0 threads blocked) {:metabase-user-id nil}
2025-01-16 11:10:50,641 ERROR resourcepool.BasicResourcePool :: A RESOURCE POOL IS PERMANENTLY BROKEN! [com.mchange.v2.resourcepool.BasicResourcePool$ScatteredAcquireTask@5243a82a] (because a series of 0 acquisition attempts failed.)
2025-01-16 11:10:50,641 ERROR resourcepool.BasicResourcePool :: com.mchange.v2.resourcepool.BasicResourcePool@24a29207 -- Unexpectedly broken!!!
com.mchange.v2.resourcepool.ResourcePoolException: Unexpected Break Stack Trace!
	at com.mchange.v2.resourcepool.BasicResourcePool.unexpectedBreak(BasicResourcePool.java:948)
	at com.mchange.v2.resourcepool.BasicResourcePool.access$1000(BasicResourcePool.java:9)
	at com.mchange.v2.resourcepool.BasicResourcePool$ScatteredAcquireTask.run(BasicResourcePool.java:1903)
	at com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:696)
2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/911/card/1583 202 [ASYNC: canceled] 172ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (4 threads blocked) {:metabase-user-id nil}
2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/882/card/1550 202 [ASYNC: canceled] 175ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (2 threads blocked) {:metabase-user-id nil}
2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/875/card/1547 202 [ASYNC: canceled] 163ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (6 threads blocked) {:metabase-user-id nil}
2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/912/card/1584 202 [ASYNC: canceled] 215ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (1 threads blocked) {:metabase-user-id nil}
2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/874/card/1546 202 [ASYNC: canceled] 157ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (7 threads blocked) {:metabase-user-id nil}
2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/912/card/1584 202 [ASYNC: canceled] 165ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (5 threads blocked) {:metabase-user-id nil}
2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/873/card/1553 202 [ASYNC: canceled] 175ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (3 threads blocked) {:metabase-user-id nil}
2025-01-16 11:10:50,641 DEBUG middleware.log :: GET /api/public/dashboard/4351faa4-13ea-472a-a05a-97e9117d0fe7/dashcard/911/card/1583 202 [ASYNC: canceled] 238ms (11 DB calls) App DB connections: 0/12 Jetty threads: 7/50 (4 idle, 0 queued) (151 total active threads) Queries in flight: 8 (0 queued); oracle DB 7 connections: 1/1 (1 threads blocked) {:metabase-user-id nil}
```

luizarakaki on (2025-01-16 21:03:14 UTC): @tatusis Do you have reports on memory consumption? Can you check if your instance has OOM errors?

tatusis (Issue Creator) on (2025-01-16 21:34:55 UTC): This server has 128GB of RAM and, on average, 69% of the memory is occupied.

In short, this metabase connects to other databases, but this error only happens in Oracle databases. Send pulse was disabled as we realized it was causing the issue at a time determined by the schedule. Even after this removal, the error still happens from time to time. I have already verified that it is possible to initiate a connection to the Oracle database with another tool, such as SQL Developer, for example.

Edited: the server event log does not show out of memory errors.

paoliniluis on (2025-01-23 20:19:53 UTC): @tatusis can you add MB_JDBC_DATA_WAREHOUSE_UNRETURNED_CONNECTION_TIMEOUT_SECONDS=600 to the environment variables and let us know if this happens again?

tatusis (Issue Creator) on (2025-01-24 16:18:54 UTC): Hello @paoliniluis, I made the change you recommended, but the problem persists.

Today, when I opened a dashboard in Metabase, I found this situation:

![Image](https://github.com/user-attachments/assets/5da2bf34-9d02-4ea8-845a-2dc2d66a4949)

Some dashboard queries worked and others didn't.

So I looked in the database and there was only one metabase user session:

![Image](https://github.com/user-attachments/assets/fac481fb-b9ac-4d5c-adf1-37f684592b90)

I reset the metabase and opened the same dashboard. Everything started working again:

![Image](https://github.com/user-attachments/assets/d4b8e199-5b44-4d51-ad94-0e8b99492d80)

and when running this dashboard, the sessions in the bank appear again:

![Image](https://github.com/user-attachments/assets/06ff5f2b-32ce-46e0-b820-24948afa8dc2)

paoliniluis on (2025-01-24 16:38:25 UTC): thanks @tatusis, and what about oracle logs, do they say something when it unplugs the Metabase connections?

mariovalney on (2025-01-24 16:55:01 UTC): _JFYI_

**TL;DR:** We encountered this issue and resolved it with a fresh installation.

At my company, we faced the exact same issue. Our Metabase instance was running in Docker on an EC2 instance managed by a partner. After multiple attempts and countless restarts, we decided to internalize the setup and recreated the same infrastructure (same instance type, Docker version, Metabase version, and ODBC version - of course, connected to the same database) on our side.

Since then, the problem has not occurred again.

"
2336331691,issue,open,,Decouple Sort of Legend and Segments of a Stacked Bar,"**Is your feature request related to a problem? Please describe.**
It is standard practice to sort a legend in descending order (with the highest data point at the top) for readability. In a stacked bar it's also common practice for the largest data to be the at the bottom of the stack. Currently there isn't a way to do this in Metabase - modifying the order of the series forces these to match in Metabase.

**Describe the solution you'd like**
- We should be able to choose a sort ascending / descending for legend independent of the series display in the bar
- We should also be able to manually choose sort order of the legend independently

**Describe alternatives you've considered**
There aren't any other display customizations I could find to meet this use case.

In this example it would be ideal for ""Current"" to be at the top of the legend while the bar remained the same:

<img width=""322"" alt=""image"" src=""https://github.com/metabase/metabase/assets/13661163/858c50b6-c44a-4443-8585-c27115852dca"">

Example of what the default legend sort would ideally look like:
<img width=""623"" alt=""image2"" src=""https://github.com/metabase/metabase/assets/13661163/fec9ed51-6903-4844-b391-bf1885a1c7c2"">
",ixipixi,2024-06-05 16:17:37+00:00,[],2025-02-04 20:31:41+00:00,,https://github.com/metabase/metabase/issues/43666,"[('Type:New Feature', ''), ('Visualization/Chart Settings', ''), ('Visualization/Legend', '')]","[{'comment_id': 2155275566, 'issue_id': 2336331691, 'author': 'ignacio-mb', 'body': 'Might be related partially to https://github.com/metabase/metabase/issues/42178', 'created_at': datetime.datetime(2024, 6, 7, 17, 53, 56, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-06-07 17:53:56 UTC): Might be related partially to https://github.com/metabase/metabase/issues/42178

"
2336237536,issue,closed,completed,Table background changes when adding it to a dashboard ,"### Describe the bug

When adding a question to a dashboard the table colors change

### To Reproduce

1. Go to New -> Question -> Orders -> Save -> Add to dashboard. 

![image](https://github.com/metabase/metabase/assets/110378427/33ba23c2-1325-4ece-b419-98501110983c)

You will notice the colors changed. The left part is 49.13 and right part is 50-RC2

The question when you open it on 50-RC2 looks like this 

![image](https://github.com/metabase/metabase/assets/110378427/77bab8d2-7ac1-43ce-9ef7-b1771891d987)



### Expected behavior

Consistent colors

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
50-RC2
```


### Severity

changes the layout of a dashboard so it's not nice

### Additional context

_No response_",Tony-metabase,2024-06-05 15:37:09+00:00,['heypoom'],2024-06-06 19:20:46+00:00,2024-06-06 19:20:45+00:00,https://github.com/metabase/metabase/issues/43665,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('.Team/Embedding', '')]",[],
2336095495,issue,closed,completed,Add Model Icon to Model section inside a collection,"**Is your feature request related to a problem? Please describe.**
Example: 
![image](https://github.com/metabase/metabase/assets/132273646/c2d17690-c8ac-40ed-9725-cc91c9faab38)


**Describe the solution you'd like**
Have a model icon, the same as pinned dashboards, questions and metrics.

**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
N/A

**Additional context**
N/A
",ignacio-mb,2024-06-05 14:33:20+00:00,[],2024-10-08 16:20:36+00:00,2024-07-17 14:13:07+00:00,https://github.com/metabase/metabase/issues/43659,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Type:New Feature', ''), ('Organization/Collections', ''), ('Organization/', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2336095402,issue,closed,not_planned,Pinned Models lack an icon,"### Describe the bug

![image](https://github.com/metabase/metabase/assets/6377293/2c347453-4426-42a2-a363-1e494c29b7d9)


### To Reproduce

a

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
a
```


### Severity

p3

### Additional context

_No response_",dpsutton,2024-06-05 14:33:18+00:00,[],2024-06-06 13:07:52+00:00,2024-06-05 14:34:19+00:00,https://github.com/metabase/metabase/issues/43658,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2152410521, 'issue_id': 2336095402, 'author': 'WiNloSt', 'body': ""Closed because it's a duplicate of https://github.com/metabase/metabase/issues/43659"", 'created_at': datetime.datetime(2024, 6, 6, 13, 7, 52, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2024-06-06 13:07:52 UTC): Closed because it's a duplicate of https://github.com/metabase/metabase/issues/43659

"
2335833762,issue,open,,Ability to lock the side_nav (hide sidebar) for interactive embedding,"**Is your feature request related to a problem? Please describe.**
Currently you can only perform two options with the side_nav ... Either `=true` 

<img width=""1507"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/b9e7e1ef-987f-4e4a-87a3-f3915a68baf6"">

Or `=false` 

<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/99472c87-45d3-4983-9bb1-ee965c871dae"">


**Describe the solution you'd like**
I would live to hide the sidebar but keep the side_nav locked like this: 

<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/af0bf36e-a595-423c-8c4d-67fd16eb8e7e"">

**Describe alternatives you've considered**
None that are simple
",Tony-metabase,2024-06-05 12:56:07+00:00,[],2024-06-05 12:56:07+00:00,,https://github.com/metabase/metabase/issues/43655,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Type:New Feature', ''), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('Embedding/Interactive', 'Interactive Embedding, previously known as Full app embedding'), ('.Team/Embedding', '')]",[],
2335820698,issue,closed,completed,Error: There was a problem displaying this chart,"**Describe the bug**
Question/model is not showing up in dashboard. Even tho the question/model itself is working as expected. This started happening after I added a date range filter to the dashboard.

**Logs**

[Console logs](https://gist.github.com/progremir/ee7cdaac9b80df4ba3a6bee17246baee)


**To Reproduce**
Steps to reproduce the behavior:
1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**

<img width=""1204"" alt=""image"" src=""https://github.com/metabase/metabase/assets/17231674/8ff4fc25-c510-4f4c-b0d8-262179fd29ef"">

**Severity**
How severe an issue is this bug to you? Is this annoying, blocking some users, blocking an upgrade or blocking your usage of Metabase entirely?
Note: the more honest and specific you are here the more we will take you seriously.

**Additional context**
Add any other context about the problem here.

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.217-205.860.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-28"",
      ""tag"": ""v1.49.13"",
      ""hash"": ""de28e83""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```",progremir,2024-06-05 12:50:02+00:00,[],2024-06-06 07:05:06+00:00,2024-06-06 07:05:06+00:00,https://github.com/metabase/metabase/issues/43654,"[('Type:Bug', 'Product defects'), ('Reporting/Dashboards', '')]","[{'comment_id': 2150817792, 'issue_id': 2335820698, 'author': 'paoliniluis', 'body': 'Please contact the support email as it seems you’re a pro or enterprise customer', 'created_at': datetime.datetime(2024, 6, 5, 19, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2151554051, 'issue_id': 2335820698, 'author': 'progremir', 'body': 'Will do! thanks', 'created_at': datetime.datetime(2024, 6, 6, 7, 5, 6, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-05 19:37:00 UTC): Please contact the support email as it seems you’re a pro or enterprise customer

progremir (Issue Creator) on (2024-06-06 07:05:06 UTC): Will do! thanks

"
2335590749,issue,closed,not_planned,Slack alert is no longer working due to Slack API change,"### Describe the bug

I created an alert that posts hourly in a slack channel. Everything seems to be configured correctly, app has permissions, is in channel etc but nothing is getting posted. Looking at the logs on Metabase I see the below error about how the file upload method appears to be deprecated.

Am I the only one seeing this error? If it was truly a Slack API deprecation I would imagine it could affect many users

```
[7b568b01-c93f-4669-90d8-818222003329] 2024-06-05T11:00:35+02:00 ERROR metabase.pulse Error sending notification!
clojure.lang.ExceptionInfo: Slack API error: method_deprecated {:error-code ""method_deprecated"", :message ""Slack API error: method_deprecated"", :response {:ok false, :error ""method_deprecated""}, :url ""https://slack.com/api/files.upload""}
	at metabase.integrations.slack$do_slack_request.invokeStatic(slack.clj:148)
	at metabase.integrations.slack$do_slack_request.invoke(slack.clj:129)
	at metabase.integrations.slack$POST.invokeStatic(slack.clj:158)
	at metabase.integrations.slack$POST.invoke(slack.clj:155)
	at metabase.integrations.slack$fn__90612$_AMPERSAND_f__90613$fn__90614.invoke(slack.clj:330)
	at metabase.integrations.slack$fn__90612$_AMPERSAND_f__90613.invoke(slack.clj:329)
	at metabase.integrations.slack$fn__90612$fn__90619.invoke(slack.clj:320)
	at metabase.pulse$create_and_upload_slack_attachments_BANG_$fn__101155.invoke(pulse.clj:342)
	at clojure.core.protocols$naive_seq_reduce.invokeStatic(protocols.clj:62)
	at clojure.core.protocols$interface_or_naive_reduce.invokeStatic(protocols.clj:72)
	at clojure.core.protocols$fn__8249.invokeStatic(protocols.clj:169)
	at clojure.core.protocols$fn__8249.invoke(protocols.clj:124)
	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
	at clojure.core.protocols$fn__8234.invokeStatic(protocols.clj:75)
	at clojure.core.protocols$fn__8234.invoke(protocols.clj:75)
	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
	at clojure.core$reduce.invokeStatic(core.clj:6886)
	at clojure.core$reduce.invoke(core.clj:6868)
	at metabase.pulse$create_and_upload_slack_attachments_BANG_.invokeStatic(pulse.clj:335)
	at metabase.pulse$create_and_upload_slack_attachments_BANG_.invoke(pulse.clj:326)
	at metabase.pulse$create_and_upload_slack_attachments_BANG_.invokeStatic(pulse.clj:332)
	at metabase.pulse$create_and_upload_slack_attachments_BANG_.invoke(pulse.clj:326)
	at metabase.pulse$fn__101314.invokeStatic(pulse.clj:532)
	at metabase.pulse$fn__101314.invoke(pulse.clj:530)
	at clojure.lang.MultiFn.invoke(MultiFn.java:229)
	at clojure.lang.AFn.applyToHelper(AFn.java:154)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.util.retry$decorate$fn$reify__68358.call(retry.clj:77)
	at io.github.resilience4j.retry.Retry.lambda$decorateCallable$5(Retry.java:306)
	at metabase.util.retry$decorate$fn__68357.doInvoke(retry.clj:78)
	at clojure.lang.RestFn.applyTo(RestFn.java:137)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.pulse$send_notification_retrying_BANG_.invokeStatic(pulse.clj:552)
	at metabase.pulse$send_notification_retrying_BANG_.doInvoke(pulse.clj:549)
	at clojure.lang.RestFn.invoke(RestFn.java:408)
	at metabase.pulse$send_notifications_BANG_$fn__101332.invoke(pulse.clj:559)
	at metabase.pulse$send_notifications_BANG_.invokeStatic(pulse.clj:558)
	at metabase.pulse$send_notifications_BANG_.invoke(pulse.clj:554)
	at metabase.pulse$send_pulse_BANG_.invokeStatic(pulse.clj:582)
	at metabase.pulse$send_pulse_BANG_.doInvoke(pulse.clj:563)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at metabase.task.send_pulses$fn__103529$send_pulses_BANG___103538$fn__103541$fn__103561$fn__103562.invoke(send_pulses.clj:61)
	at metabase.models.task_history$fn__57476$_AMPERSAND_f__57477.invoke(task_history.clj:96)
	at metabase.models.task_history$fn__57476$fn__57479.invoke(task_history.clj:91)
	at metabase.task.send_pulses$fn__103529$send_pulses_BANG___103538$fn__103541$fn__103561.invoke(send_pulses.clj:57)
	at metabase.task.send_pulses$fn__103529$send_pulses_BANG___103538$fn__103541.invoke(send_pulses.clj:56)
	at metabase.task.send_pulses$fn__103529$send_pulses_BANG___103538.invoke(send_pulses.clj:43)
	at metabase.task.send_pulses$fn__103529$send_pulses_BANG___103538$fn__103539.invoke(send_pulses.clj:50)
	at metabase.task.send_pulses$fn__103529$send_pulses_BANG___103538.invoke(send_pulses.clj:43)
	at metabase.task.send_pulses.SendPulses$fn__103640.invoke(send_pulses.clj:114)
	at metabase.models.task_history$fn__57476$_AMPERSAND_f__57477.invoke(task_history.clj:96)
	at metabase.models.task_history$fn__57476$fn__57479.invoke(task_history.clj:91)
	at metabase.task.send_pulses.SendPulses.execute(send_pulses.clj:100)
	at org.quartz.core.JobRunShell.run(JobRunShell.java:202)
	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573)
Caused by: clojure.lang.ExceptionInfo: Slack API error: method_deprecated {:error-code ""method_deprecated"", :message ""Slack API error: method_deprecated"", :response {:ok false, :error ""method_deprecated""}}
	at metabase.integrations.slack$handle_error.invokeStatic(slack.clj:120)
	at metabase.integrations.slack$handle_error.invoke(slack.clj:101)
	at metabase.integrations.slack$handle_response.invokeStatic(slack.clj:127)
	at metabase.integrations.slack$handle_response.invoke(slack.clj:122)
	at metabase.integrations.slack$do_slack_request.invokeStatic(slack.clj:146)
	... 58 more
```


### To Reproduce

1. Create a slack app and an alert that posts to slack hourly
2. See if something is getting posted in slack or if you are also seeing this error in the Metabase logs


### Expected behavior

I would assume that a post appears in the specified channel in slack

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""4.14.290-217.505.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Berlin""
  },
  ""metabase-info"": {
    ""databases"": [
      ""athena"",
      ""bigquery-cloud-sdk"",
      ""googleanalytics"",
      ""postgres"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""12.17""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.6.0""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-02-06"",
      ""tag"": ""v0.48.5"",
      ""hash"": ""dab12cf""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Berlin""
    }
  }
}
```


### Severity

blocking

### Additional context

_No response_",vomc,2024-06-05 11:02:01+00:00,[],2024-06-05 11:13:27+00:00,2024-06-05 11:13:12+00:00,https://github.com/metabase/metabase/issues/43651,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Pulses', 'Now called Subscriptions'), ('Notifications/Slack', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2149559380, 'issue_id': 2335590749, 'author': 'qnkhuat', 'body': 'Please upgrade to the latest version, or 48.13 which includes the [fix](https://github.com/metabase/metabase/issues/41890)', 'created_at': datetime.datetime(2024, 6, 5, 11, 13, 10, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-06-05 11:13:10 UTC): Please upgrade to the latest version, or 48.13 which includes the [fix](https://github.com/metabase/metabase/issues/41890)

"
2335405659,issue,closed,not_planned,Send the queries to starrocks as normal strings without a prepared statement,"### Describe the bug

An error occurs when executing SQL with custom parameters. The backend is starrocks and the SQL executed is:
```sql
select {{text}};
```

error is:
```
An SQLException was provoked by the following failure: java.lang.ArrayIndexOutOfBoundsException
```

### To Reproduce

1. connect to starrocks db with Mysql driver
2. execute sql with custom parameter
3. See error


### Expected behavior

Statements with custom parameters can be executed normally


### Logs

```
2024-06-05 09:34:32,600 ERROR middleware.catch-exceptions :: 处理查询时出错。An SQLException was provoked by the following failure: java.lang.ArrayIndexOutOfBoundsException
{:database_id 3,
 :started_at #t ""2024-06-05T09:34:32.581904Z[GMT]"",
 :via
 [{:status :failed,
   :class java.sql.SQLException,
   :error ""An SQLException was provoked by the following failure: java.lang.ArrayIndexOutOfBoundsException"",
   :stacktrace
   [""com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:118)""
    ""com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:77)""
    ""com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:74)""
    ""com.mchange.v2.c3p0.impl.NewPooledConnection.handleThrowable(NewPooledConnection.java:505)""
    ""com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:1490)""
    ""--> driver.sql_jdbc.execute$fn__79407.invokeStatic(execute.clj:557)""
    ""driver.sql_jdbc.execute$fn__79407.invoke(execute.clj:555)""
    ""driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invokeStatic(execute.clj:570)""
    ""driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invoke(execute.clj:566)""
    ""driver.sql_jdbc.execute$execute_reducible_query$fn__79490$fn__79491.invoke(execute.clj:700)""
    ""driver.sql_jdbc.execute$execute_reducible_query$fn__79490.invoke(execute.clj:699)""
    ""driver.sql_jdbc.execute$fn__79283$fn__79284.invoke(execute.clj:389)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:335)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:318)""
    ""driver.sql_jdbc.execute$fn__79283.invokeStatic(execute.clj:383)""
    ""driver.sql_jdbc.execute$fn__79283.invoke(execute.clj:381)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:693)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:690)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc$fn__106839.invokeStatic(sql_jdbc.clj:78)""
    ""driver.sql_jdbc$fn__106839.invoke(sql_jdbc.clj:76)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72307.invoke(cache.clj:229)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66656.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72128.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72138.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71570.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73475$combined_post_process__73480$combined_post_process_STAR___73481.invoke(query_processor.clj:262)""
    ""query_processor$fn__73475$combined_pre_process__73476$combined_pre_process_STAR___73477.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66753.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72218$fn__72222.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72218.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67380$fn__67381.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67380.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72215.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72520.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__72155$handle_audit_app_internal_queries__72156$fn__72158.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72166.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71281.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72451.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__73052.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62893.invoke(reducible.clj:132)""
    ""query_processor.reducible$sync_qp$qp_STAR___62905.doInvoke(reducible.clj:153)""
    ""query_processor$process_userland_query.invokeStatic(query_processor.clj:402)""
    ""query_processor$process_userland_query.doInvoke(query_processor.clj:398)""
    ""query_processor$process_query_and_save_execution_BANG_.invokeStatic(query_processor.clj:416)""
    ""query_processor$process_query_and_save_execution_BANG_.invoke(query_processor.clj:406)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invokeStatic(query_processor.clj:431)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invoke(query_processor.clj:421)""
    ""api.dataset$run_query_async$fn__93963.invoke(dataset.clj:79)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53319$fn__53321.invoke(streaming.clj:168)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53319.invoke(streaming.clj:167)""
    ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)""
    ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)""
    ""async.streaming_response$do_f_async$task__43774.invoke(streaming_response.clj:88)""],
   :state nil}
  {:status :failed,
   :class clojure.lang.ExceptionInfo,
   :error ""执行查询时出错。An SQLException was provoked by the following failure: java.lang.ArrayIndexOutOfBoundsException"",
   :stacktrace
   [""--> driver.sql_jdbc.execute$execute_reducible_query$fn__79490$fn__79491.invoke(execute.clj:702)""
    ""driver.sql_jdbc.execute$execute_reducible_query$fn__79490.invoke(execute.clj:699)""
    ""driver.sql_jdbc.execute$fn__79283$fn__79284.invoke(execute.clj:389)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:335)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:318)""
    ""driver.sql_jdbc.execute$fn__79283.invokeStatic(execute.clj:383)""
    ""driver.sql_jdbc.execute$fn__79283.invoke(execute.clj:381)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:693)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:690)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc$fn__106839.invokeStatic(sql_jdbc.clj:78)""
    ""driver.sql_jdbc$fn__106839.invoke(sql_jdbc.clj:76)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72307.invoke(cache.clj:229)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66656.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72128.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72138.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71570.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73475$combined_post_process__73480$combined_post_process_STAR___73481.invoke(query_processor.clj:262)""
    ""query_processor$fn__73475$combined_pre_process__73476$combined_pre_process_STAR___73477.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66753.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72218$fn__72222.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72218.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67380$fn__67381.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67380.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72215.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72520.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__72155$handle_audit_app_internal_queries__72156$fn__72158.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72166.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71281.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72451.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__73052.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62893.invoke(reducible.clj:132)""
    ""query_processor.reducible$sync_qp$qp_STAR___62905.doInvoke(reducible.clj:153)""
    ""query_processor$process_userland_query.invokeStatic(query_processor.clj:402)""
    ""query_processor$process_userland_query.doInvoke(query_processor.clj:398)""
    ""query_processor$process_query_and_save_execution_BANG_.invokeStatic(query_processor.clj:416)""
    ""query_processor$process_query_and_save_execution_BANG_.invoke(query_processor.clj:406)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invokeStatic(query_processor.clj:431)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invoke(query_processor.clj:421)""
    ""api.dataset$run_query_async$fn__93963.invoke(dataset.clj:79)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53319$fn__53321.invoke(streaming.clj:168)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53319.invoke(streaming.clj:167)""
    ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)""
    ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)""
    ""async.streaming_response$do_f_async$task__43774.invoke(streaming_response.clj:88)""],
   :error_type :invalid-query,
   :ex-data
   {:driver :mysql,
    :sql
    [""-- Metabase:: userID: 1 queryType: native queryHash: 1d467b25246bcb77e8217f46755e8beb4eba99b4c7320dea1d0de2bb14bd4d5b""
     ""SELECT""
     ""  `$part_date`,""
     ""  COUNT(*) AS `count`""
     ""FROM""
     ""  `ta_event_119`""
     ""WHERE""
     ""  `ta_event_119`.`$part_event` = 'start_game'""
     ""  AND `$part_date` BETWEEN ? AND date '2024-06-06'""
     ""GROUP BY""
     ""  `$part_date`""
     ""ORDER BY""
     ""  `$part_date`;""],
    :params [#t ""2024-05-30""],
    :type :invalid-query}}],
 :action_id nil,
 :error_type :invalid-query,
 :json_query
 {:type ""native"",
  :native
  {:query
   ""SELECT\n  `$part_date`,\n  COUNT(*) AS `count`\nFROM\n  `ta_event_119`\nWHERE\n  `ta_event_119`.`$part_event` = 'start_game'\n    AND `$part_date` BETWEEN {{start_dt}} AND date '2024-06-06' \nGROUP BY\n  `$part_date`\nORDER BY\n  `$part_date`;"",
   :template-tags
   {:start_dt {:type ""date"", :name ""start_dt"", :id ""ce325261-882a-46f6-bc88-b4130a6acdec"", :display-name ""Start Dt""}},
   :collection ""ta_event_119""},
  :database 3,
  :parameters
  [{:id ""ce325261-882a-46f6-bc88-b4130a6acdec"",
    :type ""date/single"",
    :value ""2024-05-30"",
    :target [""variable"" [""template-tag"" ""start_dt""]]}],
  :middleware {:js-int-to-string? true, :add-default-userland-constraints? true}},
 :status :failed,
 :class java.lang.ArrayIndexOutOfBoundsException,
 :stacktrace [nil],
 :card_id nil,
 :context :ad-hoc,
 :error ""An SQLException was provoked by the following failure: java.lang.ArrayIndexOutOfBoundsException"",
 :row_count 0,
 :running_time 0,
 :data {:rows [], :cols []}}
```

### Information about your Metabase installation

```JSON
os: centos7
starrocks version: 3.2.6-2585333
metabase version(run in docker): metabase/metabase:v0.49.11
docker version: 24.0.7
```


### Severity

blocking usage of Metabase

### Additional context

_No response_",sanikoyes,2024-06-05 09:44:16+00:00,[],2024-11-20 19:32:14+00:00,2024-11-20 19:32:14+00:00,https://github.com/metabase/metabase/issues/43647,"[('Database/', ''), ('Type:New Feature', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Backend', '')]","[{'comment_id': 2149453132, 'issue_id': 2335405659, 'author': 'sanikoyes', 'body': 'It seems to be a problem with the prepared statement driver. Starrocks backend does not support prepared statements.\r\nHope to add an option to disable this feature (convert to direct sql string)', 'created_at': datetime.datetime(2024, 6, 5, 10, 30, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2149463582, 'issue_id': 2335405659, 'author': 'paoliniluis', 'body': 'https://github.com/metabase/metabase/issues/28081', 'created_at': datetime.datetime(2024, 6, 5, 10, 36, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2323103043, 'issue_id': 2335405659, 'author': 'paoliniluis', 'body': '@sanikoyes can you check https://mariadb.com/kb/en/about-mariadb-connector-j/#prepared-statements ? try using that parameter and let us know if it works', 'created_at': datetime.datetime(2024, 9, 1, 1, 22, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2401763887, 'issue_id': 2335405659, 'author': 'paoliniluis', 'body': '@sanikoyes can you test this out? thanks', 'created_at': datetime.datetime(2024, 10, 9, 9, 7, 10, tzinfo=datetime.timezone.utc)}]","sanikoyes (Issue Creator) on (2024-06-05 10:30:57 UTC): It seems to be a problem with the prepared statement driver. Starrocks backend does not support prepared statements.
Hope to add an option to disable this feature (convert to direct sql string)

paoliniluis on (2024-06-05 10:36:20 UTC): https://github.com/metabase/metabase/issues/28081

paoliniluis on (2024-09-01 01:22:48 UTC): @sanikoyes can you check https://mariadb.com/kb/en/about-mariadb-connector-j/#prepared-statements ? try using that parameter and let us know if it works

paoliniluis on (2024-10-09 09:07:10 UTC): @sanikoyes can you test this out? thanks

"
2335402355,issue,closed,completed,"Do some basic profiling (on big queries, etc.) to make sure we don't use too much memory",,tsmacdonald,2024-06-05 09:43:08+00:00,['crisptrutski'],2024-08-22 07:17:18+00:00,2024-08-22 07:17:18+00:00,https://github.com/metabase/metabase/issues/43646,"[('.Memory Usage', ''), ('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2167578822, 'issue_id': 2335402355, 'author': 'crisptrutski', 'body': 'We can use the large Snowflake benchmark as our first test case.', 'created_at': datetime.datetime(2024, 6, 14, 8, 59, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2303954032, 'issue_id': 2335402355, 'author': 'crisptrutski', 'body': 'Done in https://github.com/metabase/macaw/pull/87\r\n\r\nShared some stats in slack.', 'created_at': datetime.datetime(2024, 8, 22, 7, 17, 18, tzinfo=datetime.timezone.utc)}]","crisptrutski (Assginee) on (2024-06-14 08:59:58 UTC): We can use the large Snowflake benchmark as our first test case.

crisptrutski (Assginee) on (2024-08-22 07:17:18 UTC): Done in https://github.com/metabase/macaw/pull/87

Shared some stats in slack.

"
2335401983,issue,closed,not_planned,Instrument parsing performance,,tsmacdonald,2024-06-05 09:43:01+00:00,['tsmacdonald'],2024-08-27 10:24:01+00:00,2024-08-27 10:24:01+00:00,https://github.com/metabase/metabase/issues/43645,"[('.Performance', ''), ('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2167577813, 'issue_id': 2335401983, 'author': 'crisptrutski', 'body': 'I presume this is around performance in prod?\r\n\r\nIt would also be good to have some micro benchmarks in the repo.', 'created_at': datetime.datetime(2024, 6, 14, 8, 59, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2296551956, 'issue_id': 2335401983, 'author': 'crisptrutski', 'body': ""I did a bit of benchmarking of queries in our tests, using clj-sync-profile. Timewise the analysis was taking about 14% of the time, with database queries taking up the remainder, which was a bit more than I expected, but not alarming. Given there's little low hanging fruit on the database side, this is probably fine."", 'created_at': datetime.datetime(2024, 8, 19, 13, 14, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2304456822, 'issue_id': 2335401983, 'author': 'crisptrutski', 'body': ""Passing this over to Tim as I'm not sure what the brief is here.\r\n\r\nWe are currently logging the times things take in [Grafana](https://grafana.monitoring.metabase.com/d/Zjw_nJX7k/metabase-logs?orgId=1&refresh=5m&var-cluster=staging-1&var-filter=task.analyz&var-namespace=All&var-dns_host=stats.metabase.com&var-pod=All&from=now-15m&to=now)"", 'created_at': datetime.datetime(2024, 8, 22, 11, 40, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2312140068, 'issue_id': 2335401983, 'author': 'tsmacdonald', 'body': ""We decided that with manual monitoring/testing on stats, the general tooling surrounding k6, etc., performance is okay and doesn't need further scrutiny"", 'created_at': datetime.datetime(2024, 8, 27, 10, 24, 1, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-06-14 08:59:23 UTC): I presume this is around performance in prod?

It would also be good to have some micro benchmarks in the repo.

crisptrutski on (2024-08-19 13:14:28 UTC): I did a bit of benchmarking of queries in our tests, using clj-sync-profile. Timewise the analysis was taking about 14% of the time, with database queries taking up the remainder, which was a bit more than I expected, but not alarming. Given there's little low hanging fruit on the database side, this is probably fine.

crisptrutski on (2024-08-22 11:40:15 UTC): Passing this over to Tim as I'm not sure what the brief is here.

We are currently logging the times things take in [Grafana](https://grafana.monitoring.metabase.com/d/Zjw_nJX7k/metabase-logs?orgId=1&refresh=5m&var-cluster=staging-1&var-filter=task.analyz&var-namespace=All&var-dns_host=stats.metabase.com&var-pod=All&from=now-15m&to=now)

tsmacdonald (Issue Creator) on (2024-08-27 10:24:01 UTC): We decided that with manual monitoring/testing on stats, the general tooling surrounding k6, etc., performance is okay and doesn't need further scrutiny

"
2335401550,issue,closed,completed,Ensure we can find logged parse exceptions in Grafana,,tsmacdonald,2024-06-05 09:42:51+00:00,['crisptrutski'],2024-08-02 14:43:13+00:00,2024-08-02 14:35:36+00:00,https://github.com/metabase/metabase/issues/43644,"[('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2265541137, 'issue_id': 2335401550, 'author': 'crisptrutski', 'body': 'It\'s not pretty, but it\'s [there now](https://grafana.monitoring.metabase.com/d/Zjw_nJX7k/metabase-logs?orgId=1&refresh=5m&var-cluster=staging-1&var-filter=Encountered%20unexpected%20token&var-namespace=All&var-dns_host=stats.metabase.com&var-pod=All&from=now-24h&to=now):\r\n\r\n```\r\n{""lvl"":""ERROR"",\r\n ""lgr"":""metabase.query-analysis"",\r\n ""m"":""Error parsing SQL ..."",\r\n ""exception"":{\r\n    ""exception_class"": ""net.sf.jsqlparser.JSQLParserException"",\r\n    ""exception_message"": ""Encountered unexpected token: \\"">=\\"" <OP_GREATERTHANEQUALS> at line 5, column 52. Was expecting one of ..."",\r\n    ""stacktrace"":""net.sf.jsqlparser.JSQLParserException...""\r\n```', 'created_at': datetime.datetime(2024, 8, 2, 14, 35, 34, tzinfo=datetime.timezone.utc)}]","crisptrutski (Assginee) on (2024-08-02 14:35:34 UTC): It's not pretty, but it's [there now](https://grafana.monitoring.metabase.com/d/Zjw_nJX7k/metabase-logs?orgId=1&refresh=5m&var-cluster=staging-1&var-filter=Encountered%20unexpected%20token&var-namespace=All&var-dns_host=stats.metabase.com&var-pod=All&from=now-24h&to=now):

```
{""lvl"":""ERROR"",
 ""lgr"":""metabase.query-analysis"",
 ""m"":""Error parsing SQL ..."",
 ""exception"":{
    ""exception_class"": ""net.sf.jsqlparser.JSQLParserException"",
    ""exception_message"": ""Encountered unexpected token: \"">=\"" <OP_GREATERTHANEQUALS> at line 5, column 52. Was expecting one of ..."",
    ""stacktrace"":""net.sf.jsqlparser.JSQLParserException...""
```

"
2335400671,issue,closed,not_planned,Store context in `QueryField` table,,tsmacdonald,2024-06-05 09:42:33+00:00,['tsmacdonald'],2024-08-06 14:16:42+00:00,2024-08-06 14:16:41+00:00,https://github.com/metabase/metabase/issues/43643,"[('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2259928695, 'issue_id': 2335400671, 'author': 'crisptrutski', 'body': 'I\'m not certain what we want to persist here, and why.\r\n\r\nA ""source column"" might appear in multiple contexts - do we want to store duplicates for these?', 'created_at': datetime.datetime(2024, 7, 31, 8, 14, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2271409893, 'issue_id': 2335400671, 'author': 'tsmacdonald', 'body': 'I think with the new schema and all this is just noise and needs to be rethought', 'created_at': datetime.datetime(2024, 8, 6, 14, 16, 41, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-07-31 08:14:04 UTC): I'm not certain what we want to persist here, and why.

A ""source column"" might appear in multiple contexts - do we want to store duplicates for these?

tsmacdonald (Issue Creator) on (2024-08-06 14:16:41 UTC): I think with the new schema and all this is just noise and needs to be rethought

"
2335295008,issue,closed,not_planned,Failed to upgrade v0.44.4 -> v0.49.13,"### Describe the bug

When I tried to upgrade from v0.44.4 to v0.49.13, the new instance failed to start. I discovered that the new version requires MySQL 8, but my environment is MySQL 5.7. 
At this point, I attempted to roll back the data by executing` java -jar metabase.jar migrate down` 
The rollback was successful, with the message:
`Rolling back app database schema to version 48`
However, I am still unable to start my v0.44.4 instance.

### To Reproduce

1. Stop the Metabase instance.
2. Replace with v0.49.13 JAR file.
3. Start the new instance.
4. Instance fails to start, perform rollback operation. ` java -jar metabase.jar migrate down` 
5. Start the old instance.


### Expected behavior

_No response_

### Logs

```
2024-06-05 16:47:33,486 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
2024-06-05 16:47:33,489 INFO db.setup :: Verifying mysql Database Connection ...
2024-06-05 16:47:33,628 INFO db.setup :: Successfully verified MySQL 5.7.27 application database connection. ✅
2024-06-05 16:47:33,629 INFO db.setup :: Running Database Migrations...
2024-06-05 16:47:33,630 INFO db.setup :: Setting up Liquibase...
2024-06-05 16:47:33,782 INFO db.setup :: Liquibase is ready.
2024-06-05 16:47:33,782 INFO db.liquibase :: Checking if Database has unrun migrations...
2024-06-05 16:47:34,768 INFO db.liquibase :: Database has unrun migrations. Waiting for migration lock to be cleared...
2024-06-05 16:47:34,866 INFO db.liquibase :: Migration lock is cleared. Running migrations...
2024-06-05 16:47:35,038 INFO db.setup :: Database Migrations Current ...  ✅
2024-06-05 16:47:35,051 INFO db.data-migrations :: Running all necessary data migrations, this may take a minute.
2024-06-05 16:47:35,057 ERROR metabase.core :: Metabase Initialization FAILED
java.sql.SQLSyntaxErrorException: (conn=3053054) Table 'metabase.data_migrations' doesn't exist
	at org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory.createException(ExceptionFactory.java:62)
	at org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory.create(ExceptionFactory.java:158)
	at org.mariadb.jdbc.MariaDbStatement.executeExceptionEpilogue(MariaDbStatement.java:262)
	at org.mariadb.jdbc.ClientSidePreparedStatement.executeInternal(ClientSidePreparedStatement.java:229)
	at org.mariadb.jdbc.ClientSidePreparedStatement.execute(ClientSidePreparedStatement.java:149)
	at org.mariadb.jdbc.ClientSidePreparedStatement.executeQuery(ClientSidePreparedStatement.java:163)
	at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:1471)
	at clojure.java.jdbc$execute_query_with_params.invokeStatic(jdbc.clj:1090)
	at clojure.java.jdbc$execute_query_with_params.invoke(jdbc.clj:1084)
	at clojure.java.jdbc$db_query_with_resultset_STAR_.invokeStatic(jdbc.clj:1113)
	at clojure.java.jdbc$db_query_with_resultset_STAR_.invoke(jdbc.clj:1093)
	at clojure.java.jdbc$query.invokeStatic(jdbc.clj:1182)
	at clojure.java.jdbc$query.invoke(jdbc.clj:1144)
	at toucan.db$query.invokeStatic(db.clj:308)
	at toucan.db$query.doInvoke(db.clj:304)
	at clojure.lang.RestFn.invoke(RestFn.java:410)
	at toucan.db$simple_select.invokeStatic(db.clj:414)
	at toucan.db$simple_select.invoke(db.clj:403)
	at toucan.db$select.invokeStatic(db.clj:708)
	at toucan.db$select.doInvoke(db.clj:702)
	at clojure.lang.RestFn.invoke(RestFn.java:410)
	at clojure.lang.AFn.applyToHelper(AFn.java:154)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$apply.invoke(core.clj:662)
	at toucan.db$select_field.invokeStatic(db.clj:733)
	at toucan.db$select_field.doInvoke(db.clj:725)
	at clojure.lang.RestFn.invoke(RestFn.java:425)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.core$apply.invokeStatic(core.clj:671)
	at clojure.core$apply.invoke(core.clj:662)
	at toucan.db$select_ids.invokeStatic(db.clj:743)
	at toucan.db$select_ids.doInvoke(db.clj:736)
	at clojure.lang.RestFn.invoke(RestFn.java:410)
	at metabase.db.data_migrations$run_all_BANG_.invokeStatic(data_migrations.clj:61)
	at metabase.db.data_migrations$run_all_BANG_.invoke(data_migrations.clj:57)
	at clojure.lang.Var.invoke(Var.java:380)
	at metabase.db.setup$fn__35519$run_data_migrations_BANG___35524$fn__35525.invoke(setup.clj:131)
	at metabase.db.setup$fn__35519$run_data_migrations_BANG___35524.invoke(setup.clj:122)
	at metabase.db.setup$fn__35544$setup_db_BANG___35549$fn__35550$fn__35553$fn__35554.invoke(setup.clj:146)
	at metabase.util$do_with_us_locale.invokeStatic(util.clj:716)
	at metabase.util$do_with_us_locale.invoke(util.clj:702)
	at metabase.db.setup$fn__35544$setup_db_BANG___35549$fn__35550$fn__35553.invoke(setup.clj:143)
	at metabase.db.setup$fn__35544$setup_db_BANG___35549$fn__35550.invoke(setup.clj:142)
	at metabase.db.setup$fn__35544$setup_db_BANG___35549.invoke(setup.clj:136)
	at metabase.db$setup_db_BANG_$fn__35579.invoke(db.clj:65)
	at metabase.db$setup_db_BANG_.invokeStatic(db.clj:60)
	at metabase.db$setup_db_BANG_.invoke(db.clj:51)
	at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:100)
	at metabase.core$init_BANG__STAR_.invoke(core.clj:83)
	at metabase.core$init_BANG_.invokeStatic(core.clj:145)
	at metabase.core$init_BANG_.invoke(core.clj:140)
	at metabase.core$start_normally.invokeStatic(core.clj:157)
	at metabase.core$start_normally.invoke(core.clj:151)
	at metabase.core$_main.invokeStatic(core.clj:190)
	at metabase.core$_main.doInvoke(core.clj:184)
	at clojure.lang.RestFn.invoke(RestFn.java:397)
	at clojure.lang.AFn.applyToHelper(AFn.java:152)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at metabase.core.main(Unknown Source)
Caused by: org.mariadb.jdbc.internal.util.exceptions.MariaDbSqlException: Table 'metabase.data_migrations' doesn't exist
	at org.mariadb.jdbc.internal.util.exceptions.MariaDbSqlException.of(MariaDbSqlException.java:34)
	at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.exceptionWithQuery(AbstractQueryProtocol.java:194)
	at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.exceptionWithQuery(AbstractQueryProtocol.java:177)
	at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.executeQuery(AbstractQueryProtocol.java:321)
	at org.mariadb.jdbc.ClientSidePreparedStatement.executeInternal(ClientSidePreparedStatement.java:220)
	... 57 more
Caused by: java.sql.SQLException: Table 'metabase.data_migrations' doesn't exist
	at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.readErrorPacket(AbstractQueryProtocol.java:1695)
	at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.readPacket(AbstractQueryProtocol.java:1557)
	at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.getResult(AbstractQueryProtocol.java:1520)
	at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.executeQuery(AbstractQueryProtocol.java:318)
	... 58 more
2024-06-05 16:47:35,064 INFO metabase.core :: Metabase Shutting Down ...
2024-06-05 16:47:35,065 INFO metabase.server :: Shutting Down Embedded Jetty Webserver
2024-06-05 16:47:35,071 INFO metabase.core :: Metabase Shutdown COMPLETE

```

### Information about your Metabase installation

```
Metabase:V0.44.4
Database:mysql 5.7.27
```


### Severity

P0

### Additional context

_No response_",j1kwen,2024-06-05 08:54:43+00:00,[],2024-06-06 01:18:47+00:00,2024-06-05 10:32:39+00:00,https://github.com/metabase/metabase/issues/43641,"[('Type:Bug', 'Product defects'), ('Database/MySQL', None), ('Operation/Database Migrations', 'Issues with application DB migrations when launching Metabase'), ('.Needs Triage', '')]","[{'comment_id': 2149456376, 'issue_id': 2335295008, 'author': 'paoliniluis', 'body': '""Rolling back app database schema to version 48"", so the database version is now in v48, you need to spin up that version and not v44', 'created_at': datetime.datetime(2024, 6, 5, 10, 32, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2151225389, 'issue_id': 2335295008, 'author': 'j1kwen', 'body': 'However, upgrade to v0.49 did not complete successfully. checking the table `DATABASECHANGELOG`, the last entry is `v48.00-032`. Therefore, even after executing `java -jar metabase.jar migrate down` with v0.49, it is still not possible to start v0.48. The error is as follows.\r\n\r\n```\r\n2024-06-06 09:17:56,026 INFO db.setup :: Checking if a database downgrade is required...\r\n2024-06-06 09:17:56,347 INFO db.setup :: Running Database Migrations...\r\n2024-06-06 09:17:56,348 INFO db.setup :: Setting up Liquibase...\r\n2024-06-06 09:17:56,367 INFO db.setup :: Liquibase is ready.\r\n2024-06-06 09:17:56,367 INFO db.liquibase :: Checking if Database has unrun migrations...\r\n2024-06-06 09:17:56,843 ERROR metabase.core :: Metabase Initialization FAILED\r\nliquibase.exception.ValidationFailedException: Validation Failed:\r\n     175 changesets check sum\r\n          migrations/001_update_migrations.yaml::v00.00-000::qnkhuat was: 9:cecb4c73745e92033c738dbf3d6e747e but is now: 8:a59595109e74e7a2678a1b0dfd25f74a\r\n          migrations/001_update_migrations.yaml::v45.00-001::snoe was: 9:24324f06a65a9bb339c735f02cbfb47f but is now: 8:ec8c30ee4f53a15a36c402d8124bb8af\r\n          migrations/001_update_migrations.yaml::v45.00-002::snoe was: 9:d2c9f50f5a29947a07e4808957d63ab6 but is now: 8:6da7a6285edb138c404de0eeba209570\r\n          migrations/001_update_migrations.yaml::v45.00-003::snoe was: 9:dafaaf7c9f0efbf92670ea93c001f7a1 but is now: 8:512337d6d4af38016aa79585abbe03a1\r\n          migrations/001_update_migrations.yaml::v45.00-011::snoe was: 9:c539f152aa1c2287c5b602c7a395f9e8 but is now: 8:dcf1cda9f20dca4b6ff8101b13b98c4a\r\n          migrations/001_update_migrations.yaml::v45.00-012::snoe was: 9:4b66ab5561933821db3a68d21ce43b6b but is now: 8:5ff2660791f217125b263ccddeacb585\r\n          migrations/001_update_migrations.yaml::v45.00-013::snoe was: 9:54c5d6a9659b7ae62e8c42f60f9620d2 but is now: 8:26dba276b14255d4346507a1a25d117b\r\n          migrations/001_update_migrations.yaml::v45.00-022::snoe was: 9:4f00f51af294ccdd99b6029b7a023643 but is now: 8:c9d0fc313dfb8b88ac500136d625cdca\r\n          migrations/001_update_migrations.yaml::v45.00-023::snoe was: 9:082d296233ee6dbbf2871b9d93c3a6a4 but is now: 8:c6c1ff9ca3b62d4cda3a2d782dd86f2f\r\n          migrations/001_update_migrations.yaml::v45.00-025::metamben was: 9:2214b0d71acc8a8cf90781a2aca98664 but is now: 8:50a43cea3123ecdb602123825f5a7dbf\r\n          migrations/001_update_migrations.yaml::v45.00-026::snoe was: 9:9f2ce2d2d79d0dce365ddf3464d1f648 but is now: 8:ae77d4086998911877e3207fcf90c9c7\r\n          migrations/001_update_migrations.yaml::v45.00-027::snoe was: 9:73718f7b7c3fb4ef30f71dc6e6170528 but is now: 8:40c3c8391c1416a3bce09ca3c7237173\r\n          migrations/001_update_migrations.yaml::v45.00-028::camsaul was: 9:883315d70f3fc10b07858aa0e48ed9da but is now: 8:f8f68f80627aeb2ef7f28f2af2b5a31b\r\n          migrations/001_update_migrations.yaml::v45.00-029::camsaul was: 9:fe3b8aca811ef5b541f922a83c7ded8c but is now: 8:579957652133eab3ee023dd911162a1e\r\n          migrations/001_update_migrations.yaml::v45.00-030::camsaul was: 9:63da8f2f82baf396ad30f3fd451c501d but is now: 8:41eda097feb034c4d01b2dbda74753c8\r\n          migrations/001_update_migrations.yaml::v45.00-031::camsaul was: 9:3628c1c692bec0f7258ea983b18340b5 but is now: 8:6416e373e335dc1c12c7571af674dede\r\n          migrations/001_update_migrations.yaml::v45.00-033::camsaul was: 9:b93dab321e4a1fcaeb74d12b52867fd4 but is now: 8:34df79fc79e086ab05bb2fd79bb4e322\r\n          migrations/001_update_migrations.yaml::v45.00-035::camsaul was: 9:207984e21c44681a6135592cab3d0f3f but is now: 8:dcee49781d80d9c4be5ad9dd51975a07\r\n          migrations/001_update_migrations.yaml::v45.00-036::snoe was: 9:1c5db47da78b69f2540542243b529e65 but is now: 8:d6d138f84722d9f99987669910c4c376\r\n          migrations/001_update_migrations.yaml::v45.00-037::snoe was: 9:6600702fb0cc9dcd8628fca8df9c0b39 but is now: 8:56f548cc84a53cc6d18302761ee71554\r\n          migrations/001_update_migrations.yaml::v45.00-039::camsaul was: 9:7b331f47a0260218275c58fa21fdcc60 but is now: 8:2c539d76d3aead7f7366b15333132b30\r\n          migrations/001_update_migrations.yaml::v45.00-041::camsaul was: 9:84d479472b81809b8067f72b28934954 but is now: 8:82dc368fa3e0163a06929da6e9556fe2\r\n          migrations/001_update_migrations.yaml::v45.00-042::camsaul was: 9:f600f2e052bf44938d081165c8d87364 but is now: 8:d04207471480e335f14094e9a7a5d293\r\n          migrations/001_update_migrations.yaml::v45.00-043::camsaul was: 9:daa8b1249027fa4c9ea07f1acb8ee889 but is now: 8:d06439bc30e5b98e267c22630909b7d8\r\n          migrations/001_update_migrations.yaml::v45.00-044::metamben was: 9:39c664afe6e6c6598576c7575931b106 but is now: 8:f5bcfdfd0f2135f44c2864f9542ce766\r\n          migrations/001_update_migrations.yaml::v45.00-048::camsaul was: 9:122ebd5e3f3b30b61b66bfad0e9ab1b0 but is now: 8:5615941cbbe6d267348a8bfc9182bd79\r\n\r\n```', 'created_at': datetime.datetime(2024, 6, 6, 1, 18, 46, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-05 10:32:39 UTC): ""Rolling back app database schema to version 48"", so the database version is now in v48, you need to spin up that version and not v44

j1kwen (Issue Creator) on (2024-06-06 01:18:46 UTC): However, upgrade to v0.49 did not complete successfully. checking the table `DATABASECHANGELOG`, the last entry is `v48.00-032`. Therefore, even after executing `java -jar metabase.jar migrate down` with v0.49, it is still not possible to start v0.48. The error is as follows.

```
2024-06-06 09:17:56,026 INFO db.setup :: Checking if a database downgrade is required...
2024-06-06 09:17:56,347 INFO db.setup :: Running Database Migrations...
2024-06-06 09:17:56,348 INFO db.setup :: Setting up Liquibase...
2024-06-06 09:17:56,367 INFO db.setup :: Liquibase is ready.
2024-06-06 09:17:56,367 INFO db.liquibase :: Checking if Database has unrun migrations...
2024-06-06 09:17:56,843 ERROR metabase.core :: Metabase Initialization FAILED
liquibase.exception.ValidationFailedException: Validation Failed:
     175 changesets check sum
          migrations/001_update_migrations.yaml::v00.00-000::qnkhuat was: 9:cecb4c73745e92033c738dbf3d6e747e but is now: 8:a59595109e74e7a2678a1b0dfd25f74a
          migrations/001_update_migrations.yaml::v45.00-001::snoe was: 9:24324f06a65a9bb339c735f02cbfb47f but is now: 8:ec8c30ee4f53a15a36c402d8124bb8af
          migrations/001_update_migrations.yaml::v45.00-002::snoe was: 9:d2c9f50f5a29947a07e4808957d63ab6 but is now: 8:6da7a6285edb138c404de0eeba209570
          migrations/001_update_migrations.yaml::v45.00-003::snoe was: 9:dafaaf7c9f0efbf92670ea93c001f7a1 but is now: 8:512337d6d4af38016aa79585abbe03a1
          migrations/001_update_migrations.yaml::v45.00-011::snoe was: 9:c539f152aa1c2287c5b602c7a395f9e8 but is now: 8:dcf1cda9f20dca4b6ff8101b13b98c4a
          migrations/001_update_migrations.yaml::v45.00-012::snoe was: 9:4b66ab5561933821db3a68d21ce43b6b but is now: 8:5ff2660791f217125b263ccddeacb585
          migrations/001_update_migrations.yaml::v45.00-013::snoe was: 9:54c5d6a9659b7ae62e8c42f60f9620d2 but is now: 8:26dba276b14255d4346507a1a25d117b
          migrations/001_update_migrations.yaml::v45.00-022::snoe was: 9:4f00f51af294ccdd99b6029b7a023643 but is now: 8:c9d0fc313dfb8b88ac500136d625cdca
          migrations/001_update_migrations.yaml::v45.00-023::snoe was: 9:082d296233ee6dbbf2871b9d93c3a6a4 but is now: 8:c6c1ff9ca3b62d4cda3a2d782dd86f2f
          migrations/001_update_migrations.yaml::v45.00-025::metamben was: 9:2214b0d71acc8a8cf90781a2aca98664 but is now: 8:50a43cea3123ecdb602123825f5a7dbf
          migrations/001_update_migrations.yaml::v45.00-026::snoe was: 9:9f2ce2d2d79d0dce365ddf3464d1f648 but is now: 8:ae77d4086998911877e3207fcf90c9c7
          migrations/001_update_migrations.yaml::v45.00-027::snoe was: 9:73718f7b7c3fb4ef30f71dc6e6170528 but is now: 8:40c3c8391c1416a3bce09ca3c7237173
          migrations/001_update_migrations.yaml::v45.00-028::camsaul was: 9:883315d70f3fc10b07858aa0e48ed9da but is now: 8:f8f68f80627aeb2ef7f28f2af2b5a31b
          migrations/001_update_migrations.yaml::v45.00-029::camsaul was: 9:fe3b8aca811ef5b541f922a83c7ded8c but is now: 8:579957652133eab3ee023dd911162a1e
          migrations/001_update_migrations.yaml::v45.00-030::camsaul was: 9:63da8f2f82baf396ad30f3fd451c501d but is now: 8:41eda097feb034c4d01b2dbda74753c8
          migrations/001_update_migrations.yaml::v45.00-031::camsaul was: 9:3628c1c692bec0f7258ea983b18340b5 but is now: 8:6416e373e335dc1c12c7571af674dede
          migrations/001_update_migrations.yaml::v45.00-033::camsaul was: 9:b93dab321e4a1fcaeb74d12b52867fd4 but is now: 8:34df79fc79e086ab05bb2fd79bb4e322
          migrations/001_update_migrations.yaml::v45.00-035::camsaul was: 9:207984e21c44681a6135592cab3d0f3f but is now: 8:dcee49781d80d9c4be5ad9dd51975a07
          migrations/001_update_migrations.yaml::v45.00-036::snoe was: 9:1c5db47da78b69f2540542243b529e65 but is now: 8:d6d138f84722d9f99987669910c4c376
          migrations/001_update_migrations.yaml::v45.00-037::snoe was: 9:6600702fb0cc9dcd8628fca8df9c0b39 but is now: 8:56f548cc84a53cc6d18302761ee71554
          migrations/001_update_migrations.yaml::v45.00-039::camsaul was: 9:7b331f47a0260218275c58fa21fdcc60 but is now: 8:2c539d76d3aead7f7366b15333132b30
          migrations/001_update_migrations.yaml::v45.00-041::camsaul was: 9:84d479472b81809b8067f72b28934954 but is now: 8:82dc368fa3e0163a06929da6e9556fe2
          migrations/001_update_migrations.yaml::v45.00-042::camsaul was: 9:f600f2e052bf44938d081165c8d87364 but is now: 8:d04207471480e335f14094e9a7a5d293
          migrations/001_update_migrations.yaml::v45.00-043::camsaul was: 9:daa8b1249027fa4c9ea07f1acb8ee889 but is now: 8:d06439bc30e5b98e267c22630909b7d8
          migrations/001_update_migrations.yaml::v45.00-044::metamben was: 9:39c664afe6e6c6598576c7575931b106 but is now: 8:f5bcfdfd0f2135f44c2864f9542ce766
          migrations/001_update_migrations.yaml::v45.00-048::camsaul was: 9:122ebd5e3f3b30b61b66bfad0e9ab1b0 but is now: 8:5615941cbbe6d267348a8bfc9182bd79

```

"
2334876482,issue,open,reopened,Pivot table is not pivoted (Slack),"### Describe the bug

If a dashboard subscription has a pivot table, sending it to slack will fail

### To Reproduce

1. Setup slack
2. Create a dashboard
3. Add the ""Orders according to sources per quarter"" card from the example collection to the dashboard. It's a pivot table
4. Create a dashboard subscription to send to slack
5. Try sending it

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```


### Severity

P2

### Additional context

_No response_",qnkhuat,2024-06-05 04:33:14+00:00,[],2025-02-04 20:31:57+00:00,,https://github.com/metabase/metabase/issues/43638,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('Reporting/Pulses', 'Now called Subscriptions'), ('.Correctness', ''), ('.Backend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('Notifications/Slack', ''), ('Visualization/Static', 'Subscriptions/pulse generated image'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2199968238, 'issue_id': 2334876482, 'author': 'qnkhuat', 'body': 'you can send it now, but the rendered image is not ""pivoted\'\r\nPivot table on dashboard\r\n<img width=""546"" alt=""Screenshot 2024-07-01 at 19 04 04"" src=""https://github.com/metabase/metabase/assets/25661381/bd4c3c9b-59be-4014-a293-831f8da4bf93"">\r\n\r\nRendered image on slack\r\n![image](https://github.com/metabase/metabase/assets/25661381/95986152-dffd-4e52-88ed-12fe755c4350)\r\n\r\nRendered table on email\r\n<img width=""602"" alt=""Screenshot 2024-07-01 at 19 04 54"" src=""https://github.com/metabase/metabase/assets/25661381/bc830521-0ef8-4c96-a1ef-b24983144eba"">', 'created_at': datetime.datetime(2024, 7, 1, 12, 5, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2317327704, 'issue_id': 2334876482, 'author': 'fabiolanza', 'body': 'Being able to send pivot tables via subscription is very important. Can we please get an update on roadmap for this feature? Thank you.', 'created_at': datetime.datetime(2024, 8, 29, 11, 1, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2317854929, 'issue_id': 2334876482, 'author': 'cdeweyx', 'body': ""> Being able to send pivot tables via subscription is very important. Can we please get an update on roadmap for this feature? Thank you.\r\n\r\nFixing the attached / exported data files to be pivoted like you see in the product is currently in development for next major release. Supporting in-line pivot tables in subscriptions is on our radar but most likely won't be included in the next couple releases."", 'created_at': datetime.datetime(2024, 8, 29, 14, 21, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2399416962, 'issue_id': 2334876482, 'author': 'JurenaMat', 'body': 'Pitching in to support the option to send tables formatted as pivoted tables in pulse subscription. This feature is crucial to our adoption of Metabase', 'created_at': datetime.datetime(2024, 10, 8, 10, 3, 44, tzinfo=datetime.timezone.utc)}]","qnkhuat (Issue Creator) on (2024-07-01 12:05:14 UTC): you can send it now, but the rendered image is not ""pivoted'
Pivot table on dashboard
<img width=""546"" alt=""Screenshot 2024-07-01 at 19 04 04"" src=""https://github.com/metabase/metabase/assets/25661381/bd4c3c9b-59be-4014-a293-831f8da4bf93"">

Rendered image on slack
![image](https://github.com/metabase/metabase/assets/25661381/95986152-dffd-4e52-88ed-12fe755c4350)

Rendered table on email
<img width=""602"" alt=""Screenshot 2024-07-01 at 19 04 54"" src=""https://github.com/metabase/metabase/assets/25661381/bc830521-0ef8-4c96-a1ef-b24983144eba"">

fabiolanza on (2024-08-29 11:01:11 UTC): Being able to send pivot tables via subscription is very important. Can we please get an update on roadmap for this feature? Thank you.

cdeweyx on (2024-08-29 14:21:27 UTC): Fixing the attached / exported data files to be pivoted like you see in the product is currently in development for next major release. Supporting in-line pivot tables in subscriptions is on our radar but most likely won't be included in the next couple releases.

JurenaMat on (2024-10-08 10:03:44 UTC): Pitching in to support the option to send tables formatted as pivoted tables in pulse subscription. This feature is crucial to our adoption of Metabase

"
2334475011,issue,closed,completed,RowCharts continuously shrink on hover (row charts have become shy),"**RowCharts are shrinking on hover** (any row chart)

https://github.com/metabase/metabase/assets/22608765/89758601-1601-4ee4-94ee-1abe896bce68

---
**Latest version:** Master",JesseSDevaney,2024-06-04 22:29:59+00:00,['alxnddr'],2024-06-05 10:22:45+00:00,2024-06-05 10:22:44+00:00,https://github.com/metabase/metabase/issues/43631,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Visualization/Charts/Row', ''), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2334471469,issue,open,,FE - Change `getMetadata` selector to compute data based on the RTK query cache only,"Epic https://github.com/metabase/metabase/issues/40898

Final task in the epic that switches from the entity framework to RTK query in `getMetadata` selector. Endpoints for metadata collection:

```
/api/field/:id -> field only
/api/table/:id -> table only
/api/table/:id/query_metadata -> table only
/api/card/:id -> card only
/api/dataset/query_metadata -> databases, tables, fields
/api/card/:id/query_metadata -> databases, tables, fields
/api/dashboard/:id/query_metadata -> databases, tables, fields, cards
```

Their responses should be combined in a `Metadata` object with the same shape as the existing one but without nested entities normalization as there are no unique references for fields. ",ranquild,2024-06-04 22:26:32+00:00,['kamilmielnik'],2024-06-11 13:18:28+00:00,,https://github.com/metabase/metabase/issues/43630,"[('.Frontend', '')]",[],
2334471396,issue,closed,completed,FE - Use `/api/dataset/query_metadata` endpoint,,ranquild,2024-06-04 22:26:29+00:00,['ranquild'],2024-06-10 20:48:10+00:00,2024-06-06 11:13:20+00:00,https://github.com/metabase/metabase/issues/43629,"[('.Frontend', '')]",[],
2334471347,issue,closed,completed,BE - Add `/api/dataset/query_metadata` endpoint,"Similar to the endpoints introduced here https://github.com/metabase/metabase/issues/43330

",ranquild,2024-06-04 22:26:25+00:00,['ranquild'],2024-06-10 20:48:13+00:00,2024-06-06 11:13:20+00:00,https://github.com/metabase/metabase/issues/43628,"[('.Backend', '')]",[],
2334465151,issue,closed,completed,Add Open Backport Reminders,,iethree,2024-06-04 22:20:01+00:00,['iethree'],2024-10-08 17:08:57+00:00,2024-06-06 13:12:47+00:00,https://github.com/metabase/metabase/issues/43627,[],[],
2334307688,issue,closed,not_planned,Serialization - Inconsistent datasource YAML for password field for MongoDB,"### Describe the bug

Datasource YAML file for MongoDB shows password field as ""pass"" instead of ""password"" like other datasources.

### To Reproduce

1. Export Metabase with MongoDB connection with ""-s"" parameter
2. Edit datasource YAML file for this connection.
3. Notice that the password field is set as ""pass"" and not ""password"" like other data sources
4. Changing it to ""password"" and then importing it breaks the connection in Metabase


### Expected behavior

""pass"" should be the same as ""password"" for consistency

### Logs

_No response_

### Information about your Metabase installation

```JSON
v1.50.0-RC1
```


### Severity

annoying

### Additional context

_No response_",taqattack,2024-06-04 20:22:40+00:00,[],2024-06-10 05:59:16+00:00,2024-06-04 22:45:11+00:00,https://github.com/metabase/metabase/issues/43615,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Database/Mongo', None), ('.Backend', ''), ('.Needs Triage', ''), ('Operation/Serialization', 'Enterprise contents migration')]","[{'comment_id': 2148531476, 'issue_id': 2334307688, 'author': 'calherries', 'body': ""I wouldn't label this a bug, this is merely an annoyance. While I agree it's a little unexpected, the password connection property for MongoDB has always been `pass`. Changing it to `password` will break backwards compatibility so to solve this we'd have to maintain both `pass` and `password`. And allowing multiple names for the same property is simply complicating things for not much gain, unless there's a use case that requires they are consistent across databases. I'm inclined to close this issue until there's a greater reason to act on this."", 'created_at': datetime.datetime(2024, 6, 4, 22, 45, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2157330815, 'issue_id': 2334307688, 'author': 'darksciencebase', 'body': 'confirming with the product team', 'created_at': datetime.datetime(2024, 6, 10, 5, 59, 15, tzinfo=datetime.timezone.utc)}]","calherries on (2024-06-04 22:45:11 UTC): I wouldn't label this a bug, this is merely an annoyance. While I agree it's a little unexpected, the password connection property for MongoDB has always been `pass`. Changing it to `password` will break backwards compatibility so to solve this we'd have to maintain both `pass` and `password`. And allowing multiple names for the same property is simply complicating things for not much gain, unless there's a use case that requires they are consistent across databases. I'm inclined to close this issue until there's a greater reason to act on this.

darksciencebase on (2024-06-10 05:59:15 UTC): confirming with the product team

"
2334050069,issue,closed,completed,add export pdf button to EmbedFrame,,npretto,2024-06-04 17:37:59+00:00,['npretto'],2024-06-12 15:17:53+00:00,2024-06-12 15:17:53+00:00,https://github.com/metabase/metabase/issues/43605,"[('Type:New Feature', ''), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted')]","[{'comment_id': 2163304650, 'issue_id': 2334050069, 'author': 'npretto', 'body': ""Close as it's been merged to the integration branch"", 'created_at': datetime.datetime(2024, 6, 12, 15, 17, 53, tzinfo=datetime.timezone.utc)}]","npretto (Issue Creator) on (2024-06-12 15:17:53 UTC): Close as it's been merged to the integration branch

"
2333923174,issue,closed,completed,Database role is not respected when private key is used in Snowflake,"As per discussion in https://github.com/metabase/metabase/issues/41852 database role is not respected as connection property when there is connection url containing private key file.

However, if the role is set as url parameter, it is used normally. Hence we should set the role as url parameter.",lbrdnk,2024-06-04 16:22:12+00:00,['lbrdnk'],2024-08-28 02:09:51+00:00,2024-06-06 17:34:07+00:00,https://github.com/metabase/metabase/issues/43600,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Database/Snowflake', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2333909862,issue,closed,completed,[Testing Plan] Temporal unit parameters in dashboards,"Mapping targets:
- [x] 0/1/2+ breakouts
- [x] Multi-stage queries
- [x] Multiple temporal unit parameters for the same card
- [x] Multiple cards in the same dashcard
- [x] Doesn't allow to change the unit for breakouts based on expressions
- [x] Doesn't allow to change the unit for breakouts based on columns with binning strategies
- [x] Cannot map to a SQL query
- [x] Model - mbql/native
- [x] Metric

Default & required values:
- [x] Should be able to set a default value
- [x] Should open a dashboard with a default value
- [x] Should be able to make the parameter required + reset its value

Query string parameters:
- [x] Should parse query string parameter values

Click behaviors:
- [x] Update a dashboard filter ?
- [x] Go to a custom destination - dashboard - filter ?
- [x] Custom destination - URL - values you can reference -> filters ?

Auto-wiring:
- [x] Auto-wiring for a single card - does not map to unrelated cards
- [x] Auto-wiring for multiple cards - should not overwrite mappings
- [x] No auto-wiring of incompatible parameters for the same column

Permissions:
- [x] Should allow to change the temporal unit without data permissions in dashboards
- [x] Should ignore temporal unit parameters when drilling-thru without data permissions

Embedding:
- [x] Should work for public (static) dashboards
- [x] Should work for interactive dashboards (embeds)",ranquild,2024-06-04 16:14:17+00:00,['ranquild'],2024-06-19 19:08:25+00:00,2024-06-19 19:08:25+00:00,https://github.com/metabase/metabase/issues/43599,"[('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.')]",[],
2333804353,issue,closed,completed,BigQuery - Date Field Filter not including Timezone,"### Describe the bug

In 1.49.13 and 50RC2, the query generated from a field filter doesn't include the timezone as it does in 1.49.6.
I haven't tested versions in between.


### To Reproduce

1. Confirm you have a value for Localization, I'm using Europe/Oslo for this example.

<br>
<br>

2. I'm using the following as a test query where 'timefield' is a field filter associated with a timestamp field in a BigQuery table.
```
SELECT
`mbsampledata.Cars`.`car_brand` AS `car_brand`,
`mbsampledata.Cars`.`car_model` AS `car_model`,
`mbsampledata.Cars`.`car_year` AS `car_year`,
`mbsampledata.Cars`.`msrp` AS `msrp`,
`mbsampledata.Cars`.`datesold` AS `datesold`
FROM
`mbsampledata.Cars`
WHERE {{timefield}}
```

<br>
<br>
 
3. Filter by Today
In version 1.49.6, it generates the following
```
SELECT
`mbsampledata.Cars`.`car_brand` AS `car_brand`,
`mbsampledata.Cars`.`car_model` AS `car_model`,
`mbsampledata.Cars`.`car_year` AS `car_year`,
`mbsampledata.Cars`.`msrp` AS `msrp`,
`mbsampledata.Cars`.`datesold` AS `datesold`
FROM
`mbsampledata.Cars`
WHERE timestamp_trunc(`mbsampledata.Cars`.`datesold`, day, 'Europe/Oslo') = timestamp ""2024-06-04 00:00:00 Europe/Oslo""
```
<br>
<br>
 
In version 1.49.13 and 50RC2, it generates the following, without the timezone.
```
SELECT
`mbsampledata.Cars`.`car_brand` AS `car_brand`,
`mbsampledata.Cars`.`car_model` AS `car_model`,
`mbsampledata.Cars`.`car_year` AS `car_year`,
`mbsampledata.Cars`.`msrp` AS `msrp`,
`mbsampledata.Cars`.`datesold` AS `datesold`
FROM
`mbsampledata.Cars`
WHERE TIMESTAMP_TRUNC(`mbsampledata.Cars`.`datesold`, day, 'Europe/Oslo') = timestamp ""2024-06-04 00:00:00Z""
```
 


### Expected behavior

For the timezone to be applied as it did in previous versions.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.49-linuxkit-pr"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.1 (Debian 15.1-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-06-03"",
      ""tag"": ""v1.50.0-RC2"",
      ""hash"": ""7a8b73e""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Oslo""
    }
  }
}
```


### Severity

P2 - Not able to use certain date filters

### Additional context

_No response_",FilmonK,2024-06-04 15:19:47+00:00,['snoe'],2024-08-28 02:09:51+00:00,2024-07-16 22:25:10+00:00,https://github.com/metabase/metabase/issues/43597,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/BigQuery', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Backend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/Querying', '')]","[{'comment_id': 2213199816, 'issue_id': 2333804353, 'author': 'mayank-apnamart', 'body': 'Hi Guys,\r\n\r\nFacing the same issue with my setup also, Is there a timeline for this. Also, meanwhile is there a work around I can do for the same?', 'created_at': datetime.datetime(2024, 7, 8, 7, 6, 14, tzinfo=datetime.timezone.utc)}]","mayank-apnamart on (2024-07-08 07:06:14 UTC): Hi Guys,

Facing the same issue with my setup also, Is there a timeline for this. Also, meanwhile is there a work around I can do for the same?

"
2333755615,issue,closed,completed,Flake Issue Creator,"Github action that runs nightly and 
- uses metabase API key to check a flake question
- for the top X flakes, queries open issues with the exact title `[Flake Fix] {testName}`
- if no such issue is open, it opens it
- if such an issue is open post a follow-up comment that it's still flaky

Questions
- how to assign to teams?",iethree,2024-06-04 14:57:12+00:00,['iethree'],2024-10-08 17:04:41+00:00,2024-07-11 13:48:47+00:00,https://github.com/metabase/metabase/issues/43594,"[('.CI & Tests', '')]",[],
2333482317,issue,closed,completed,E2E flake `e2e/test/scenarios/embedding/interactive-embedding.cy.spec.js`,"There have been multiple reports for flaky `e2e/test/scenarios/embedding/interactive-embedding.cy.spec.js` lately.

[From stats](https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBGbGFraW5lc3MiLCJkZXNjcmlwdGlvbiI6IkZsYWtleSB0ZXN0cyBmb3IgTWV0YWJhc2UgZnJvbSB3b3JrZmxvdyBqb2JzIHBlciB0ZXN0L2pvYi9ydW4vYnJhbmNoL2NvbW1pdC4gVXBkYXRlZCBkYWlseS4iLCJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoyNiwidHlwZSI6InF1ZXJ5IiwicXVlcnkiOnsic291cmNlLXRhYmxlIjoiY2FyZF9fMTQ4MjgiLCJmaWx0ZXIiOlsiPSIsWyJmaWVsZCIsInRlc3RfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sInNjZW5hcmlvcyA-IGVtYmVkZGluZyA-IGZ1bGwgYXBwIGRhc2hib2FyZHMgc2hvdWxkIHNlbmQgYGZyYW1lYCBtZXNzYWdlIHdpdGggZGFzaGJvYXJkIGhlaWdodCB3aGVuIHRoZSBkYXNoYm9hcmQgaXMgcmVzaXplZCAobWV0YWJhc2UjMzc0MzcpIl19fSwiZGlzcGxheSI6InRhYmxlIiwicGFyYW1ldGVycyI6W10sInZpc3VhbGl6YXRpb25fc2V0dGluZ3MiOnsidGFibGUucGl2b3RfY29sdW1uIjoicmVwb3NpdG9yeSIsInRhYmxlLmNlbGxfY29sdW1uIjoidGVzdHMifSwib3JpZ2luYWxfY2FyZF9pZCI6MTQ4Mjh9), this test started to flake since May 29.",WiNloSt,2024-06-04 13:02:49+00:00,['WiNloSt'],2024-06-10 20:40:07+00:00,2024-06-05 08:01:37+00:00,https://github.com/metabase/metabase/issues/43587,"[('.CI & Tests', ''), ('Embedding/Interactive', 'Interactive Embedding, previously known as Full app embedding'), ('flaky-test-fix', ''), ('.Team/Embedding', '')]",[],
2333220416,issue,closed,completed,Follow up work on SDK changelog automation,"```[tasklist]
### Tasks
- [x] Fix The workflow to use github-automation@metabase.com as a committer email
- [x] Fix the workflow to check for an exact match of the tag
```
",WiNloSt,2024-06-04 10:56:53+00:00,['WiNloSt'],2024-06-10 20:45:36+00:00,2024-06-06 07:42:26+00:00,https://github.com/metabase/metabase/issues/43583,"[('.CI & Tests', '')]",[],
2333216601,issue,closed,completed,Research handling changelog files in different branches.,Check how to handle changlogs i.e. do we have different changelogs in different branches or just master. Let's see how other libraries are doing this.,WiNloSt,2024-06-04 10:54:55+00:00,['WiNloSt'],2024-06-10 20:46:08+00:00,2024-06-07 15:15:54+00:00,https://github.com/metabase/metabase/issues/43582,"[('.CI & Tests', '')]","[{'comment_id': 2150417210, 'issue_id': 2333216601, 'author': 'WiNloSt', 'body': ""There are hardly any conversions I could search on the internet. Here are the 2 sources I found regarding changelog\r\n- https://github.com/olivierlacan/keep-a-changelog/issues/228\r\n- https://keepachangelog.com/en/1.1.0/\r\n\r\nNothing concrete about how we should structure our changelog, nor there's a de-facto standard of dealing with changelog when we do previous major version minor releases e.g. release 0.2.0 after 1.0.0\r\n\r\nHowever, the 2 main repos I looked at, Angular and React both have their own distinct way to dealing with changelog.\r\n\r\n1. [Angular](https://github.com/angular/angular/blob/main/CHANGELOG.md): Order their changelog entry [by the release date](https://github.com/angular/angular/blob/main/CHANGELOG.md#1340-2023-04-06)\r\n    ![image](https://github.com/metabase/metabase/assets/1937582/04b17957-a2f7-496c-ae1b-9e00761db040)\r\n2. [React](https://github.com/facebook/react/blob/main/CHANGELOG.md): Seems to manually add past releases following [version order manually.](https://github.com/facebook/react/pull/20027)\r\n    ![image](https://github.com/metabase/metabase/assets/1937582/c8b7b948-99e3-4a8f-ae2b-a215e5a41826)\r\n\r\nI think we should select what's best in our case. I think for simplicity what we are doing (like Angular) streamline the release a lot. That also means our SDK changelog will look much like our GitHub Release page where the latest released version are on top even if it's for the past major version.\r\n\r\nI think what we could change in the workflow instead of copying the whole file which doesn't make sense is to generate the changelog at the commit that we release then cherry-pick the change to master. That way we'll make sure we won't get any conflict and only the appended change will be appended on top of `master`'s `CHANGELOG.md`.\r\n\r\nDoes that make sense @npretto ?"", 'created_at': datetime.datetime(2024, 6, 5, 15, 55, 42, tzinfo=datetime.timezone.utc)}]","WiNloSt (Issue Creator) on (2024-06-05 15:55:42 UTC): There are hardly any conversions I could search on the internet. Here are the 2 sources I found regarding changelog
- https://github.com/olivierlacan/keep-a-changelog/issues/228
- https://keepachangelog.com/en/1.1.0/

Nothing concrete about how we should structure our changelog, nor there's a de-facto standard of dealing with changelog when we do previous major version minor releases e.g. release 0.2.0 after 1.0.0

However, the 2 main repos I looked at, Angular and React both have their own distinct way to dealing with changelog.

1. [Angular](https://github.com/angular/angular/blob/main/CHANGELOG.md): Order their changelog entry [by the release date](https://github.com/angular/angular/blob/main/CHANGELOG.md#1340-2023-04-06)
    ![image](https://github.com/metabase/metabase/assets/1937582/04b17957-a2f7-496c-ae1b-9e00761db040)
2. [React](https://github.com/facebook/react/blob/main/CHANGELOG.md): Seems to manually add past releases following [version order manually.](https://github.com/facebook/react/pull/20027)
    ![image](https://github.com/metabase/metabase/assets/1937582/c8b7b948-99e3-4a8f-ae2b-a215e5a41826)

I think we should select what's best in our case. I think for simplicity what we are doing (like Angular) streamline the release a lot. That also means our SDK changelog will look much like our GitHub Release page where the latest released version are on top even if it's for the past major version.

I think what we could change in the workflow instead of copying the whole file which doesn't make sense is to generate the changelog at the commit that we release then cherry-pick the change to master. That way we'll make sure we won't get any conflict and only the appended change will be appended on top of `master`'s `CHANGELOG.md`.

Does that make sense @npretto ?

"
2333016820,issue,open,,Support passphrase-protected private keys for connecting to Snowflake,"**Is your feature request related to a problem? Please describe.**
Currently only private keys without a passphrase are supported as Snowflake connection credentials.
Some people prefer to use passphrase protected private keys, as they are encrypted at rest and thus considered more secure.

**Describe the solution you'd like**
Be able to connect to Snowflake using a passphrase protected private key.

**Describe alternatives you've considered**
n/a aside from using passphrase-less private keys (ones created with the `-nocrypt` option)

**How important is this feature to you?**
Would be welcome by a customer.
",zbodi74,2024-06-04 09:23:39+00:00,[],2024-06-04 14:37:40+00:00,,https://github.com/metabase/metabase/issues/43576,"[('Type:New Feature', ''), ('Database/Snowflake', '')]",[],
2332997524,issue,open,, Support `MB_ENCRYPTION_SECRET_KEY_FILE` as a docker secret,"### Describe the bug

Cannot provide `MB_ENCRYPTION_SECRET_KEY_FILE` as an env var to the metabase container.

### To Reproduce

1. Create container with a secret in a file and an env var `MB_ENCRYPTION_SECRET_KEY_FILE` pointing to that file
2. Result: `INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. `


### Expected behavior

Metabase should pull out the secret in the file

### Logs

```

Warning: environ value jdk-11.0.23+9 for key :java-version has been overwritten with 11.0.23
2024-06-04 09:09:58,823 INFO metabase.util :: Maximum memory available to JVM: 1.9 GB
2024-06-04 09:10:02,632 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓 
```

### Information about your Metabase installation

```JSON
- docker
```


### Severity

blocking usage

### Additional context

A PR for this has been languishing for over a year here: https://github.com/metabase/metabase/pull/29386",Ramblurr,2024-06-04 09:14:28+00:00,[],2024-06-04 14:27:07+00:00,,https://github.com/metabase/metabase/issues/43575,"[('Type:New Feature', ''), ('Operation/Docker', '')]","[{'comment_id': 2147230125, 'issue_id': 2332997524, 'author': 'WiNloSt', 'body': ""@Ramblurr I just checked the code base and we only have [MB_ENCRYPTION_SECRET_KEY](https://www.metabase.com/docs/latest/configuring-metabase/environment-variables). I'm not sure if we used to have this in the past or not, but it's not in v49."", 'created_at': datetime.datetime(2024, 6, 4, 10, 52, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147400170, 'issue_id': 2332997524, 'author': 'paoliniluis', 'body': 'Check the ones that are supported: https://github.com/metabase/metabase/pull/18887/files', 'created_at': datetime.datetime(2024, 6, 4, 12, 21, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147680729, 'issue_id': 2332997524, 'author': 'Ramblurr', 'body': ""Sorry if there is misunderstanding...  I created this issue because we would *like* to be able to use `MB_ENCRYPTION_SECRET_KEY_FILE` (and not `MB_ENCRYPTION_SECRET_KEY`). I'm aware it doesn't exist. The lack of this seems like a (minor?) security bug. \r\n\r\nAs I mentioned in the text, there's a pre-existing PR here https://github.com/metabase/metabase/pull/29386"", 'created_at': datetime.datetime(2024, 6, 4, 14, 27, 6, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2024-06-04 10:52:29 UTC): @Ramblurr I just checked the code base and we only have [MB_ENCRYPTION_SECRET_KEY](https://www.metabase.com/docs/latest/configuring-metabase/environment-variables). I'm not sure if we used to have this in the past or not, but it's not in v49.

paoliniluis on (2024-06-04 12:21:49 UTC): Check the ones that are supported: https://github.com/metabase/metabase/pull/18887/files

Ramblurr (Issue Creator) on (2024-06-04 14:27:06 UTC): Sorry if there is misunderstanding...  I created this issue because we would *like* to be able to use `MB_ENCRYPTION_SECRET_KEY_FILE` (and not `MB_ENCRYPTION_SECRET_KEY`). I'm aware it doesn't exist. The lack of this seems like a (minor?) security bug. 

As I mentioned in the text, there's a pre-existing PR here https://github.com/metabase/metabase/pull/29386

"
2332746942,issue,open,,Language dropdown scrolls the page when opened on a large screen,"### Describe the bug

https://github.com/metabase/metabase/assets/6830683/eb422e86-395d-4a7d-bc13-43064319ce33

### To Reproduce

1. Use large viewport (in my case it's 2506x1319)
2. Go to Admin > Settings > Localization
3. Open ""Instance language"" dropdown
4. Observe and wait

### Expected behavior

Dropdown opens and resizes itself instantly

### Information about your Metabase installation

master, 2f0bc49783

### Severity

P2 (because it's annoying)
",kamilmielnik,2024-06-04 07:20:13+00:00,[],2024-06-04 14:34:07+00:00,,https://github.com/metabase/metabase/issues/43572,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Administration/Settings', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2147696660, 'issue_id': 2332746942, 'author': 'npfitz', 'body': ""This is still using our legacy select, and therefore our legacy popover component. I think the right thing to do here is to use the new `SettingsSelect` component, but would likely require some styling. I know we have plans to overhaul the settings pages in the near future, so I'll tag this bug to that project\n\nAlso, I'm downgrading this to a P3 because it's purely cosmetic"", 'created_at': datetime.datetime(2024, 6, 4, 14, 33, 49, tzinfo=datetime.timezone.utc)}]","npfitz on (2024-06-04 14:33:49 UTC): This is still using our legacy select, and therefore our legacy popover component. I think the right thing to do here is to use the new `SettingsSelect` component, but would likely require some styling. I know we have plans to overhaul the settings pages in the near future, so I'll tag this bug to that project

Also, I'm downgrading this to a P3 because it's purely cosmetic

"
2332566971,issue,closed,not_planned,Docker container startup fail - JRE error,"### Describe the bug

Running [metabase/metabase:latest](app://dd/dashboard/images/local/sha256:a7da769be325f9e876e6ac3f05025e57e62c0ac432225f635579766d51373586?tag=latest&name=metabase%2Fmetabase) using Docker Desktop (upgraded to latest), docker fails with JRE error.

### To Reproduce

1. Go to Docker Desktop
2. Click on Metabase container
3. Press PLAY button (Run)
4. See error


### Expected behavior

It should be started as per usual on port localhost:3000.

### Logs

2024-06-04 14:31:51 Warning: environ value jdk-11.0.23+9 for key :java-version has been overwritten with 11.0.23
2024-06-04 14:31:54 2024-06-04 04:31:54,504 INFO metabase.util :: Maximum memory available to JVM: 1.9 GB
2024-06-04 14:31:55 2024-06-04 04:31:55,920 WARN db.env :: WARNING: Using Metabase with an H2 application database is not recommended for production deployments. For production deployments, we highly recommend using Postgres, MySQL, or MariaDB instead. If you decide to continue to use H2, please be sure to back up the database file regularly. For more information, see https://metabase.com/docs/latest/operations-guide/migrating-from-h2.html
2024-06-04 14:31:56 2024-06-04 04:31:56,113 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓 
2024-06-04 14:31:56  For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html
2024-06-04 14:31:59 [thread 49 also had an error]
2024-06-04 14:31:59 #
2024-06-04 14:31:59 # A fatal error has been detected by the Java Runtime Environment:
2024-06-04 14:31:59 #
2024-06-04 14:31:59 #  SIGSEGV (0xb) at pc=0x00007ffffebd9f3d, pid=1, tid=52
2024-06-04 14:31:59 #
2024-06-04 14:31:59 # JRE version: OpenJDK Runtime Environment Temurin-11.0.23+9 (11.0.23+9) (build 11.0.23+9)
2024-06-04 14:31:59 # Java VM: OpenJDK 64-Bit Server VM Temurin-11.0.23+9 (11.0.23+9, mixed mode, tiered, compressed oops, g1 gc, linux-amd64)
2024-06-04 14:31:59 # Problematic frame:
2024-06-04 14:31:59 # V  [libjvm.so+0x78cf3d]  G1ParEvacuateFollowersClosure::do_void()+0x1fd
2024-06-04 14:31:59 #
2024-06-04 14:31:59 # No core dump will be written. Core dumps have been disabled. To enable core dumping, try ""ulimit -c unlimited"" before starting Java again
2024-06-04 14:31:59 #
2024-06-04 14:31:59 # Can not save log file, dump to screen..
2024-06-04 14:31:59 #
2024-06-04 14:31:59 # A fatal error has been detected by the Java Runtime Environment:
2024-06-04 14:31:59 #
2024-06-04 14:31:59 #  SIGSEGV (0xb) at pc=0x00007ffffebd9f3d, pid=1, tid=52
2024-06-04 14:31:59 #
2024-06-04 14:31:59 # JRE version: OpenJDK Runtime Environment Temurin-11.0.23+9 (11.0.23+9) (build 11.0.23+9)
2024-06-04 14:31:59 # Java VM: OpenJDK 64-Bit Server VM Temurin-11.0.23+9 (11.0.23+9, mixed mode, tiered, compressed oops, g1 gc, linux-amd64)
2024-06-04 14:31:59 # Problematic frame:
2024-06-04 14:31:59 # V  [libjvm.so+0x78cf3d]  G1ParEvacuateFollowersClosure::do_void()+0x1fd
2024-06-04 14:31:59 #
2024-06-04 14:31:59 # No core dump will be written. Core dumps have been disabled. To enable core dumping, try ""ulimit -c unlimited"" before starting Java again
2024-06-04 14:31:59 #
2024-06-04 14:31:59 # If you would like to submit a bug report, please visit:
2024-06-04 14:31:59 #   https://github.com/adoptium/adoptium-support/issues
2024-06-04 14:31:59 #
2024-06-04 14:31:59 
2024-06-04 14:31:59 ---------------  S U M M A R Y ------------
2024-06-04 14:31:59 
2024-06-04 14:31:59 Command Line: -XX:+IgnoreUnrecognizedVMOptions -Dfile.encoding=UTF-8 -Dlogfile.path=target/log -XX:+CrashOnOutOfMemoryError /app/metabase.jar
2024-06-04 14:31:59 
2024-06-04 14:31:59 Host: x86_64, 8 cores, 7G, Alpine Linux v3.19
2024-06-04 14:31:59 Time: Tue Jun  4 04:31:59 2024 UTC elapsed time: 11.231443 seconds (0d 0h 0m 11s)
2024-06-04 14:31:59 
2024-06-04 14:31:59 ---------------  T H R E A D  ---------------
2024-06-04 14:31:59 
2024-06-04 14:31:59 Current thread (0x00007fffdc504000):  GCTaskThread ""GC Thread#4"" [stack: 0x00007fffdaa19000,0x00007fffdab19aa8] [id=52]
2024-06-04 14:31:59 
2024-06-04 14:31:59 Stack: [0x00007fffdaa19000,0x00007fffdab19aa8],  sp=0x00007fffdab19720,  free space=1025k
2024-06-04 14:31:59 Native frames: (J=compiled Java code, A=aot compiled Java code, j=interpreted, Vv=VM code, C=native code)
2024-06-04 14:31:59 V  [libjvm.so+0x78cf3d]  G1ParEvacuateFollowersClosure::do_void()+0x1fd
2024-06-04 14:31:59 V  [libjvm.so+0x794c66]  G1ParTask::work(unsigned int)+0x166
2024-06-04 14:31:59 V  [libjvm.so+0xed7abd]  GangWorker::loop()+0x4d
2024-06-04 14:31:59 V  [libjvm.so+0xe3ddfc]  Thread::call_run()+0x13c
2024-06-04 14:31:59 V  [libjvm.so+0xc28036]  thread_native_entry(Thread*)+0x136
2024-06-04 14:31:59 
2024-06-04 14:31:59 
2024-06-04 14:31:59 siginfo: si_signo: 11 (SIGSEGV), si_code: 1 (SEGV_MAPERR), si_addr: 0x0000000000000000
2024-06-04 14:31:59 
2024-06-04 14:31:59 Register to memory mapping:
2024-06-04 14:31:59 
2024-06-04 14:31:59 RAX=0x00000c3200000b01 is an unknown value
2024-06-04 14:31:59 RBX=0x0 is NULL
2024-06-04 14:31:59 RCX=0x0000000000000b56 is an unknown value
2024-06-04 14:31:59 RDX=0x00000c3200000b57 is an unknown value
.....
2024-06-04 14:31:59 VM Arguments:
2024-06-04 14:31:59 jvm_args: -XX:+IgnoreUnrecognizedVMOptions -Dfile.encoding=UTF-8 -Dlogfile.path=target/log -XX:+CrashOnOutOfMemoryError 
2024-06-04 14:31:59 java_command: /app/metabase.jar
2024-06-04 14:31:59 java_class_path (initial): /app/metabase.jar
2024-06-04 14:31:59 Launcher Type: SUN_STANDARD
2024-06-04 14:31:59 
2024-06-04 14:31:59 [Global flags]
2024-06-04 14:31:59      intx CICompilerCount                          = 4                                         {product} {ergonomic}
2024-06-04 14:31:59      uint ConcGCThreads                            = 2                                         {product} {ergonomic}
2024-06-04 14:31:59      bool CrashOnOutOfMemoryError                  = true                                      {product} {command line}
2024-06-04 14:31:59      uint G1ConcRefinementThreads                  = 8                                         {product} {ergonomic}
2024-06-04 14:31:59    size_t G1HeapRegionSize                         = 1048576                                   {product} {ergonomic}
2024-06-04 14:31:59     uintx GCDrainStackTargetSize                   = 64                                        {product} {ergonomic}
2024-06-04 14:31:59      bool IgnoreUnrecognizedVMOptions              = true                                      {product} {command line}
2024-06-04 14:31:59    size_t InitialHeapSize                          = 130023424                                 {product} {ergonomic}
2024-06-04 14:31:59    size_t MarkStackSize                            = 4194304                                   {product} {ergonomic}
2024-06-04 14:31:59    size_t MaxHeapSize                              = 2057306112                                {product} {ergonomic}
2024-06-04 14:31:59    size_t MaxNewSize                               = 1234173952                                {product} {ergonomic}
2024-06-04 14:31:59    size_t MinHeapDeltaBytes                        = 1048576                                   {product} {ergonomic}
2024-06-04 14:31:59     uintx NonNMethodCodeHeapSize                   = 5836300                                {pd product} {ergonomic}
2024-06-04 14:31:59     uintx NonProfiledCodeHeapSize                  = 122910970                              {pd product} {ergonomic}
2024-06-04 14:31:59     uintx ProfiledCodeHeapSize                     = 122910970                              {pd product} {ergonomic}
2024-06-04 14:31:59     uintx ReservedCodeCacheSize                    = 251658240                              {pd product} {ergonomic}
2024-06-04 14:31:59      bool SegmentedCodeCache                       = true                                      {product} {ergonomic}
2024-06-04 14:31:59      bool UseCompressedClassPointers               = true                                 {lp64_product} {ergonomic}
2024-06-04 14:31:59      bool UseCompressedOops                        = true                                 {lp64_product} {ergonomic}
2024-06-04 14:31:59      bool UseG1GC                                  = true                                      {product} {ergonomic}
2024-06-04 14:31:59 
2024-06-04 14:31:59 Logging:
2024-06-04 14:31:59 Log output configuration:
2024-06-04 14:31:59  #0: stdout all=warning uptime,level,tags
2024-06-04 14:31:59  #1: stderr all=off uptime,level,tags
2024-06-04 14:31:59 
2024-06-04 14:31:59 Environment Variables:
2024-06-04 14:31:59 JAVA_HOME=/opt/java/openjdk
2024-06-04 14:31:59 PATH=/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
2024-06-04 14:31:59 FC_LANG=en-US
2024-06-04 14:31:59 LD_LIBRARY_PATH=/opt/java/openjdk/lib/server:/opt/java/openjdk/lib:/opt/java/openjdk/../lib
2024-06-04 14:31:59 SHELL=/bin/sh
2024-06-04 14:31:59 LANG=en_US.UTF-8
2024-06-04 14:31:59 LC_ALL=en_US.UTF-8
2024-06-04 14:31:59 LC_CTYPE=en_US.UTF-8
2024-06-04 14:31:59 
2024-06-04 14:31:59 Signal Handlers:
2024-06-04 14:31:59 SIGSEGV: [libjvm.so+0xeab920], sa_mask[0]=11111111111111111111111111111110, sa_flags=SA_RESTART|SA_SIGINFO
2024-06-04 14:31:59 SIGBUS: [libjvm.so+0xeab920], sa_mask[0]=11111111111111111111111111111110, sa_flags=SA_RESTART|SA_SIGINFO
2024-06-04 14:31:59 SIGFPE: [libjvm.so+0xeab920], sa_mask[0]=11111111111111111111111111111110, sa_flags=SA_RESTART|SA_SIGINFO
2024-06-04 14:31:59 SIGPIPE: [libjvm.so+0xc1e340], sa_mask[0]=11111111111111111111111111111110, sa_flags=SA_RESTART|SA_SIGINFO
2024-06-04 14:31:59 SIGXFSZ: [libjvm.so+0xc1e340], sa_mask[0]=11111111111111111111111111111110, sa_flags=SA_RESTART|SA_SIGINFO
2024-06-04 14:31:59 SIGILL: [libjvm.so+0xeab920], sa_mask[0]=11111111111111111111111111111110, sa_flags=SA_RESTART|SA_SIGINFO
2024-06-04 14:31:59 SIGUSR2: [libjvm.so+0xc1e1e0], sa_mask[0]=00000000000000000000000000000000, sa_flags=SA_RESTART|SA_SIGINFO
2024-06-04 14:31:59 SIGHUP: [libjvm.so+0xc1e990], sa_mask[0]=11111111111111111111111111111110, sa_flags=SA_RESTART|SA_SIGINFO
2024-06-04 14:31:59 SIGINT: [libjvm.so+0xc1e990], sa_mask[0]=11111111111111111111111111111110, sa_flags=SA_RESTART|SA_SIGINFO
2024-06-04 14:31:59 SIGTERM: [libjvm.so+0xc1e990], sa_mask[0]=11111111111111111111111111111110, sa_flags=SA_RESTART|SA_SIGINFO
2024-06-04 14:31:59 SIGQUIT: [libjvm.so+0xc1e990], sa_mask[0]=11111111111111111111111111111110, sa_flags=SA_RESTART|SA_SIGINFO
2024-06-04 14:31:59 
2024-06-04 14:31:59 
2024-06-04 14:31:59 ---------------  S Y S T E M  ---------------
2024-06-04 14:31:59 
2024-06-04 14:31:59 OS:NAME=""Alpine Linux""
2024-06-04 14:31:59 ID=alpine
2024-06-04 14:31:59 VERSION_ID=3.19.1
2024-06-04 14:31:59 PRETTY_NAME=""Alpine Linux v3.19""
2024-06-04 14:31:59 HOME_URL=""https://alpinelinux.org/""
2024-06-04 14:31:59 BUG_REPORT_URL=""https://gitlab.alpinelinux.org/alpine/aports/-/issues""
2024-06-04 14:31:59 uname:Linux 6.6.26-linuxkit #1 SMP Sat Apr 27 04:13:19 UTC 2024 x86_64
2024-06-04 14:31:59 OS uptime: 0 days 0:00 hours
2024-06-04 14:31:59 libc:musl - unknown musl - unknown 
2024-06-04 14:31:59 rlimit (soft/hard): STACK 8192k/infinity , CORE 0k/infinity , NPROC infinity/infinity , NOFILE 1048576/1048576 , AS infinity/infinity , CPU infinity/infinity , DATA infinity/infinity , FSIZE infinity/infinity , MEMLOCK infinity/infinity
2024-06-04 14:31:59 load average:0.46 0.10 0.03
2024-06-04 14:31:59 
2024-06-04 14:31:59 /proc/meminfo:
2024-06-04 14:31:59 MemTotal:        8029248 kB
2024-06-04 14:31:59 MemFree:         6743444 kB
2024-06-04 14:31:59 MemAvailable:    6942680 kB
2024-06-04 14:31:59 Buffers:           10392 kB
2024-06-04 14:31:59 Cached:           330920 kB
2024-06-04 14:31:59 SwapCached:            0 kB
2024-06-04 14:31:59 Active:          1054564 kB
2024-06-04 14:31:59 Inactive:         114504 kB
2024-06-04 14:31:59 Active(anon):     828452 kB
2024-06-04 14:31:59 Inactive(anon):        0 kB
2024-06-04 14:31:59 Active(file):     226112 kB
2024-06-04 14:31:59 Inactive(file):   114504 kB
2024-06-04 14:31:59 Unevictable:           0 kB
2024-06-04 14:31:59 Mlocked:               0 kB
2024-06-04 14:31:59 SwapTotal:       1048572 kB
2024-06-04 14:31:59 SwapFree:        1048572 kB
2024-06-04 14:31:59 Zswap:                 0 kB
2024-06-04 14:31:59 Zswapped:              0 kB
2024-06-04 14:31:59 Dirty:               388 kB
2024-06-04 14:31:59 Writeback:             0 kB
2024-06-04 14:31:59 AnonPages:        826944 kB
2024-06-04 14:31:59 Mapped:           135828 kB
2024-06-04 14:31:59 Shmem:               640 kB
2024-06-04 14:31:59 KReclaimable:      10304 kB
2024-06-04 14:31:59 Slab:              46100 kB
2024-06-04 14:31:59 SReclaimable:      10304 kB
2024-06-04 14:31:59 SUnreclaim:        35796 kB
2024-06-04 14:31:59 KernelStack:        4592 kB
2024-06-04 14:31:59 PageTables:         3468 kB
2024-06-04 14:31:59 SecPageTables:         0 kB
2024-06-04 14:31:59 NFS_Unstable:          0 kB
2024-06-04 14:31:59 Bounce:                0 kB
2024-06-04 14:31:59 WritebackTmp:          0 kB
2024-06-04 14:31:59 CommitLimit:     5063196 kB
2024-06-04 14:31:59 Committed_AS:    1755168 kB
2024-06-04 14:31:59 VmallocTotal:   133141626880 kB
2024-06-04 14:31:59 VmallocUsed:        2448 kB
2024-06-04 14:31:59 VmallocChunk:          0 kB
2024-06-04 14:31:59 Percpu:             2208 kB
2024-06-04 14:31:59 AnonHugePages:    475136 kB
2024-06-04 14:31:59 ShmemHugePages:        0 kB
2024-06-04 14:31:59 ShmemPmdMapped:        0 kB
2024-06-04 14:31:59 FileHugePages:         0 kB
2024-06-04 14:31:59 FilePmdMapped:         0 kB
2024-06-04 14:31:59 HugePages_Total:       0
2024-06-04 14:31:59 HugePages_Free:        0
2024-06-04 14:31:59 HugePages_Rsvd:        0
2024-06-04 14:31:59 HugePages_Surp:        0
2024-06-04 14:31:59 Hugepagesize:       2048 kB
2024-06-04 14:31:59 Hugetlb:               0 kB
2024-06-04 14:31:59 
2024-06-04 14:31:59 /sys/kernel/mm/transparent_hugepage/enabled:
2024-06-04 14:31:59 [always] madvise never
2024-06-04 14:31:59 /sys/kernel/mm/transparent_hugepage/defrag (defrag/compaction efforts parameter):
2024-06-04 14:31:59 always defer defer+madvise [madvise] never
2024-06-04 14:31:59 
2024-06-04 14:31:59 Process Memory:
2024-06-04 14:31:59 Virtual Size: 4100116K (peak: 4121480K)
2024-06-04 14:31:59 Resident Set Size: 663624K (peak: 676124K) (anon: 645320K, file: 18304K, shmem: 0K)
2024-06-04 14:31:59 Swapped out: 0K
2024-06-04 14:31:59 
2024-06-04 14:31:59 /proc/sys/kernel/threads-max (system-wide limit on the number of threads):
2024-06-04 14:31:59 62685
2024-06-04 14:31:59 /proc/sys/vm/max_map_count (maximum number of memory map areas a process may have):
2024-06-04 14:31:59 262144
2024-06-04 14:31:59 /proc/sys/kernel/pid_max (system-wide limit on number of process identifiers):
2024-06-04 14:31:59 99999
2024-06-04 14:31:59
...
2024-06-04 14:31:59 
2024-06-04 14:31:59 Memory: 4k page, physical 8029248k(6743192k free), swap 1048572k(1048572k free)
2024-06-04 14:31:59 
2024-06-04 14:31:59 vm_info: OpenJDK 64-Bit Server VM (11.0.23+9) for linux-amd64-musl JRE (11.0.23+9), built on Apr 17 2024 05:45:29 by """" with gcc 10.3.1 20211027
2024-06-04 14:31:59 
2024-06-04 14:31:59 END.

### Information about your Metabase installation

```JSON
- OS: MacOS Sonoma 14.5
- Apple M3 chip
- Docker Desktop v4.30.0
```


### Severity

Blocker for docker image user

### Additional context

_No response_",schlos,2024-06-04 05:11:10+00:00,[],2024-11-18 13:38:59+00:00,2024-11-18 13:38:57+00:00,https://github.com/metabase/metabase/issues/43571,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Database/H2', None), ('Operation/Docker', ''), ('.Backend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2146626370, 'issue_id': 2332566971, 'author': 'schlos', 'body': 'Tried also other docker container runtime to rule out issue with Docker Desktop - tried on OrbStack (latest version, 1.6.1), error logged there:\r\n\r\n```\r\nWarning: environ value jdk-11.0.23+9 for key :java-version has been overwritten with 11.0.23\r\n2024-06-04 04:55:38,018 INFO metabase.util :: Maximum memory available to JVM: 1.3 GB\r\n2024-06-04 04:55:39,380 WARN db.env :: WARNING: Using Metabase with an H2 application database is not recommended for production deployments. For production deployments, we highly recommend using Postgres, MySQL, or MariaDB instead. If you decide to continue to use H2, please be sure to back up the database file regularly. For more information, see https://metabase.com/docs/latest/operations-guide/migrating-from-h2.html\r\n2024-06-04 04:55:39,536 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓 \r\n For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html\r\n2024-06-04 04:55:43,705 INFO driver.impl :: Registered abstract driver :sql  🚚\r\n2024-06-04 04:55:43,714 INFO driver.impl :: Registered abstract driver :sql-jdbc (parents: [:sql]) 🚚\r\n2024-06-04 04:55:43,722 INFO metabase.util :: Load driver :sql-jdbc took 49.8 ms\r\n2024-06-04 04:55:43,724 INFO driver.impl :: Registered driver :h2 (parents: [:sql-jdbc]) 🚚\r\n2024-06-04 04:55:43,877 INFO driver.impl :: Registered driver :mysql (parents: [:sql-jdbc]) 🚚\r\n2024-06-04 04:55:43,905 INFO driver.impl :: Registered driver :postgres (parents: [:sql-jdbc]) 🚚\r\n2024-06-04 04:55:45,214 INFO metabase.core :: \r\nMetabase v0.49.13 (de28e83) \r\n\r\nCopyright © 2024 Metabase, Inc. \r\n\r\nMetabase Enterprise Edition extensions are NOT PRESENT.\r\n2024-06-04 04:55:45,224 INFO metabase.core :: Starting Metabase in STANDALONE mode\r\n2024-06-04 04:55:45,276 INFO metabase.server :: Launching Embedded Jetty Webserver with config:\r\n {:port 3000, :host ""0.0.0.0""}\r\n\r\n2024-06-04 04:55:45,332 INFO metabase.core :: Starting Metabase version v0.49.13 (de28e83) ...\r\n2024-06-04 04:55:45,336 INFO metabase.core :: System info:\r\n {""file.encoding"" ""UTF-8"",\r\n ""java.runtime.name"" ""OpenJDK Runtime Environment"",\r\n ""java.runtime.version"" ""11.0.23+9"",\r\n ""java.vendor"" ""Eclipse Adoptium"",\r\n ""java.vendor.url"" ""https://adoptium.net/"",\r\n ""java.version"" ""11.0.23"",\r\n ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",\r\n ""java.vm.version"" ""11.0.23+9"",\r\n ""os.name"" ""Linux"",\r\n ""os.version"" ""6.7.12-orbstack-00202-g57474688ffbd"",\r\n ""user.language"" ""en"",\r\n ""user.timezone"" ""GMT""}\r\n\r\n2024-06-04 04:55:45,340 INFO metabase.plugins :: Loading plugins in /plugins...\r\n2024-06-04 04:55:45,447 INFO util.files :: Extract file /modules/sparksql.metabase-driver.jar -> /plugins/sparksql.metabase-driver.jar\r\n2024-06-04 04:55:45,510 INFO util.files :: Extract file /modules/sqlserver.metabase-driver.jar -> /plugins/sqlserver.metabase-driver.jar\r\n2024-06-04 04:55:45,519 INFO util.files :: Extract file /modules/snowflake.metabase-driver.jar -> /plugins/snowflake.metabase-driver.jar\r\n2024-06-04 04:55:45,781 INFO util.files :: Extract file /modules/mongo.metabase-driver.jar -> /plugins/mongo.metabase-driver.jar\r\n2024-06-04 04:55:45,794 INFO util.files :: Extract file /modules/oracle.metabase-driver.jar -> /plugins/oracle.metabase-driver.jar\r\n2024-06-04 04:55:45,795 INFO util.files :: Extract file /modules/googleanalytics.metabase-driver.jar -> /plugins/googleanalytics.metabase-driver.jar\r\n2024-06-04 04:55:45,804 INFO util.files :: Extract file /modules/athena.metabase-driver.jar -> /plugins/athena.metabase-driver.jar\r\n2024-06-04 04:55:45,860 INFO util.files :: Extract file /modules/redshift.metabase-driver.jar -> /plugins/redshift.metabase-driver.jar\r\n2024-06-04 04:55:45,864 INFO util.files :: Extract file /modules/presto-jdbc.metabase-driver.jar -> /plugins/presto-jdbc.metabase-driver.jar\r\n2024-06-04 04:55:45,900 INFO util.files :: Extract file /modules/bigquery-cloud-sdk.metabase-driver.jar -> /plugins/bigquery-cloud-sdk.metabase-driver.jar\r\n2024-06-04 04:55:46,009 INFO util.files :: Extract file /modules/druid.metabase-driver.jar -> /plugins/druid.metabase-driver.jar\r\n2024-06-04 04:55:46,011 INFO util.files :: Extract file /modules/vertica.metabase-driver.jar -> /plugins/vertica.metabase-driver.jar\r\n2024-06-04 04:55:46,012 INFO util.files :: Extract file /modules/sqlite.metabase-driver.jar -> /plugins/sqlite.metabase-driver.jar\r\n2024-06-04 04:55:46,214 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...\r\n2024-06-04 04:55:46,217 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚\r\n2024-06-04 04:55:46,220 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...\r\n2024-06-04 04:55:46,221 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚\r\n2024-06-04 04:55:46,231 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...\r\n2024-06-04 04:55:46,232 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚\r\n2024-06-04 04:55:46,265 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...\r\n2024-06-04 04:55:46,266 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚\r\n2024-06-04 04:55:46,275 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...\r\n2024-06-04 04:55:46,276 INFO driver.impl :: Registered driver :mongo  🚚\r\n2024-06-04 04:55:46,296 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Oracle Driver due to required dependencies. Metabase requires the Oracle JDBC driver in order to connect to Oracle databases, but we can\'t ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/oracle.html for more details.\r\n\r\n2024-06-04 04:55:46,297 INFO plugins.dependencies :: Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? false\r\n2024-06-04 04:55:46,298 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Oracle Driver""]\r\n2024-06-04 04:55:46,312 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...\r\n2024-06-04 04:55:46,313 INFO driver.impl :: Registered driver :googleanalytics  🚚\r\n2024-06-04 04:55:46,326 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :athena...\r\n2024-06-04 04:55:46,327 INFO driver.impl :: Registered driver :athena (parents: [:sql-jdbc]) 🚚\r\n2024-06-04 04:55:46,330 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...\r\n2024-06-04 04:55:46,330 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚\r\n2024-06-04 04:55:46,345 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...\r\n2024-06-04 04:55:46,345 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚\r\n2024-06-04 04:55:46,356 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...\r\n2024-06-04 04:55:46,357 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚\r\n2024-06-04 04:55:46,363 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...\r\n2024-06-04 04:55:46,364 INFO driver.impl :: Registered driver :druid  🚚\r\n2024-06-04 04:55:46,369 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can\'t ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.\r\n\r\n2024-06-04 04:55:46,371 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false\r\n2024-06-04 04:55:46,372 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver"" ""Metabase Oracle Driver""]\r\n2024-06-04 04:55:46,373 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...\r\n2024-06-04 04:55:46,374 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚\r\n2024-06-04 04:55:46,387 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\n2024-06-04 04:55:46,389 INFO db.setup :: Verifying h2 Database Connection ...\r\n2024-06-04 04:55:47,129 INFO db.setup :: Successfully verified H2 2.1.214 (2022-06-13) application database connection. ✅\r\n2024-06-04 04:55:47,132 INFO db.setup :: Checking if a database downgrade is required...\r\n2024-06-04 04:55:47,851 INFO db.setup :: Running Database Migrations...\r\n2024-06-04 04:55:47,852 INFO db.setup :: Setting up Liquibase...\r\n2024-06-04 04:55:48,131 INFO db.setup :: Liquibase is ready.\r\n2024-06-04 04:55:48,134 INFO db.liquibase :: Checking if Database has unrun migrations...\r\n2024-06-04 04:55:48,659 INFO db.liquibase :: Database has unrun migrations. Checking if migraton lock is taken...\r\n2024-06-04 04:55:48,671 INFO db.liquibase :: No migration lock found.\r\n2024-06-04 04:55:48,936 INFO db.liquibase :: Running 9 migrations ...\r\n2024-06-04 04:55:49,428 INFO impl.StdSchedulerFactory :: Using default implementation for ThreadExecutor\r\n2024-06-04 04:55:49,459 INFO core.SchedulerSignalerImpl :: Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl\r\n2024-06-04 04:55:49,460 INFO core.QuartzScheduler :: Quartz Scheduler v.2.3.2 created.\r\n2024-06-04 04:55:49,460 INFO jdbcjobstore.JobStoreTX :: Using db table-based data access locking (synchronization).\r\n2024-06-04 04:55:49,462 INFO jdbcjobstore.JobStoreTX :: JobStoreTX initialized.\r\n2024-06-04 04:55:49,465 INFO core.QuartzScheduler :: Scheduler meta-data: Quartz Scheduler (v2.3.2) \'MetabaseScheduler\' with instanceId \'ab66a974b5581717476949439\'\r\n  Scheduler class: \'org.quartz.core.QuartzScheduler\' - running locally.\r\n  NOT STARTED.\r\n  Currently in standby mode.\r\n  Number of jobs executed: 0\r\n  Using thread pool \'org.quartz.simpl.SimpleThreadPool\' - with 10 threads.\r\n  Using job-store \'org.quartz.impl.jdbcjobstore.JobStoreTX\' - which supports persistence. and is clustered.\r\n\r\n2024-06-04 04:55:49,465 INFO impl.StdSchedulerFactory :: Quartz scheduler \'MetabaseScheduler\' initialized from default resource file in Quartz package: \'quartz.properties\'\r\n2024-06-04 04:55:49,465 INFO impl.StdSchedulerFactory :: Quartz scheduler version: 2.3.2\r\n2024-06-04 04:55:49,510 INFO jdbcjobstore.JobStoreTX :: ClusterManager: detected 1 failed or restarted instances.\r\n2024-06-04 04:55:49,510 INFO jdbcjobstore.JobStoreTX :: ClusterManager: Scanning for instance ""60f0e50b3bfa1716200268272""\'s failed in-progress jobs.\r\n2024-06-04 04:55:49,531 INFO jdbcjobstore.JobStoreTX :: ClusterManager: ......Cleaned-up 1 other failed job(s).\r\n2024-06-04 04:55:49,545 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_ab66a974b5581717476949439 started.\r\n2024-06-04 04:55:49,592 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_ab66a974b5581717476949439 shutting down.\r\n2024-06-04 04:55:49,592 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_ab66a974b5581717476949439 paused.\r\n2024-06-04 04:55:49,602 INFO jdbcjobstore.JobStoreTX :: Handling the first 20 triggers that missed their scheduled fire-time.  More misfired triggers remain to be processed.\r\n2024-06-04 04:55:49,615 ERROR jdbcjobstore.JobStoreTX :: MisfireHandler: Error handling misfires: Couldn\'t retrieve trigger: Block not found in id [1, -26, 2, -28, 2] [2.1.214/50]\r\norg.quartz.JobPersistenceException: Couldn\'t retrieve trigger: Block not found in id [1, -26, 2, -28, 2] [2.1.214/50] [See nested exception: java.io.IOException: Block not found in id [1, -26, 2, -28, 2] [2.1.214/50]]\r\n\tat org.quartz.impl.jdbcjobstore.JobStoreSupport.retrieveTrigger(JobStoreSupport.java:1538)\r\n\tat org.quartz.impl.jdbcjobstore.JobStoreSupport.recoverMisfiredJobs(JobStoreSupport.java:984)\r\n\tat org.quartz.impl.jdbcjobstore.JobStoreSupport.doRecoverMisfires(JobStoreSupport.java:3264)\r\n\tat org.quartz.impl.jdbcjobstore.JobStoreSupport$MisfireHandler.manage(JobStoreSupport.java:4012)\r\n\tat org.quartz.impl.jdbcjobstore.JobStoreSupport$MisfireHandler.run(JobStoreSupport.java:4033)\r\nCaused by: java.io.IOException: Block not found in id [1, -26, 2, -28, 2] [2.1.214/50]\r\n\tat org.h2.mvstore.StreamStore$Stream.read(StreamStore.java:514)\r\n\tat java.base/java.io.FilterInputStream.read(Unknown Source)\r\n\tat org.h2.mvstore.db.LobStorageMap$LobInputStream.read(LobStorageMap.java:358)\r\n\tat java.base/java.io.ObjectInputStream$PeekInputStream.read(Unknown Source)\r\n\tat java.base/java.io.ObjectInputStream$PeekInputStream.readFully(Unknown Source)\r\n\tat java.base/java.io.ObjectInputStream$BlockDataInputStream.readShort(Unknown Source)\r\n\tat java.base/java.io.ObjectInputStream.readStreamHeader(Unknown Source)\r\n\tat java.base/java.io.ObjectInputStream.<init>(Unknown Source)\r\n\tat org.quartz.impl.jdbcjobstore.StdJDBCDelegate.getObjectFromBlob(StdJDBCDelegate.java:3199)\r\n\tat org.quartz.impl.jdbcjobstore.StdJDBCDelegate.selectTrigger(StdJDBCDelegate.java:1780)\r\n\tat org.quartz.impl.jdbcjobstore.JobStoreSupport.retrieveTrigger(JobStoreSupport.java:1536)\r\n\t... 4 more\r\nCaused by: org.h2.mvstore.MVStoreException: Reading from file sun.nio.ch.FileChannelImpl@4b737e1c failed at 3129518 (length -1), read 0, remaining 384 [2.1.214/1]\r\n\tat org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:1004)\r\n\tat org.h2.mvstore.DataUtils.readFully(DataUtils.java:470)\r\n\tat org.h2.mvstore.FileStore.readFully(FileStore.java:98)\r\n\tat org.h2.mvstore.Chunk.readBufferForPage(Chunk.java:422)\r\n\tat org.h2.mvstore.MVStore.readPage(MVStore.java:2569)\r\n\tat org.h2.mvstore.MVMap.readPage(MVMap.java:633)\r\n\tat org.h2.mvstore.Page$NonLeaf.getChildPage(Page.java:1125)\r\n\tat org.h2.mvstore.Page.get(Page.java:243)\r\n\tat org.h2.mvstore.MVMap.get(MVMap.java:436)\r\n\tat org.h2.mvstore.MVMap.get(MVMap.java:424)\r\n\tat org.h2.mvstore.StreamStore.getBlock(StreamStore.java:434)\r\n\tat org.h2.mvstore.StreamStore$Stream.nextBuffer(StreamStore.java:551)\r\n\tat org.h2.mvstore.StreamStore$Stream.read(StreamStore.java:508)\r\n\t... 14 more\r\nCaused by: java.nio.channels.ClosedByInterruptException\r\n\tat java.base/java.nio.channels.spi.AbstractInterruptibleChannel.end(Unknown Source)\r\n\tat java.base/sun.nio.ch.FileChannelImpl.endBlocking(Unknown Source)\r\n\tat java.base/sun.nio.ch.FileChannelImpl.readInternal(Unknown Source)\r\n\tat java.base/sun.nio.ch.FileChannelImpl.read(Unknown Source)\r\n\tat org.h2.mvstore.DataUtils.readFully(DataUtils.java:456)\r\n\t... 25 more\r\n2024-06-04 04:55:49,622 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_ab66a974b5581717476949439 shutdown complete.\r\n2024-06-04 04:55:49,808 ERROR liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat encountered an exception.\r\n\r\nUPDATE SUMMARY\r\nRun:                          9\r\nPreviously run:             262\r\nFiltered out:                19\r\n-------------------------------\r\nTotal change sets:          290\r\n\r\n\r\nFILTERED CHANGE SETS SUMMARY\r\nDBMS mismatch:               19\r\n\r\n2024-06-04 04:55:49,873 ERROR metabase.core :: Metabase Initialization FAILED\r\nliquibase.exception.CommandExecutionException: liquibase.exception.LiquibaseException: liquibase.exception.MigrationFailedException: Migration failed for changeset migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat:\r\n     Reason: clojure.lang.ExceptionInfo: General error: ""General error: """"org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"""" [50000-214]""; SQL statement:\r\nCOMMIT [50000-214] {:toucan2/context-trace [[""resolve connection"" {:toucan2.connection/connectable org.h2.jdbc.JdbcConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}\r\n\tat liquibase.command.CommandScope.execute(CommandScope.java:253)\r\n\tat liquibase.Liquibase.lambda$update$0(Liquibase.java:245)\r\n\tat liquibase.Scope.lambda$child$0(Scope.java:186)\r\n\tat liquibase.Scope.child(Scope.java:195)\r\n\tat liquibase.Scope.child(Scope.java:185)\r\n\tat liquibase.Scope.child(Scope.java:164)\r\n\tat liquibase.Liquibase.runInScope(Liquibase.java:1419)\r\n\tat liquibase.Liquibase.update(Liquibase.java:234)\r\n\tat liquibase.Liquibase.update(Liquibase.java:212)\r\n\tat liquibase.Liquibase.update(Liquibase.java:194)\r\n\tat metabase.db.liquibase$migrate_up_if_needed_BANG_.invokeStatic(liquibase.clj:305)\r\n\tat metabase.db.liquibase$migrate_up_if_needed_BANG_.invoke(liquibase.clj:287)\r\n\tat metabase.db.setup$migrate_BANG_$fn__51159.invoke(setup.clj:80)\r\n\tat metabase.db.liquibase$do_with_liquibase$f_STAR___48835.invoke(liquibase.clj:139)\r\n\tat metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:142)\r\n\tat metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:130)\r\n\tat metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)\r\n\tat metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:445)\r\n\tat metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:147)\r\n\tat metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:141)\r\n\tat metabase.db.setup$setup_db_BANG_$fn__51187$fn__51188.invoke(setup.clj:165)\r\n\tat metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)\r\n\tat metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)\r\n\tat metabase.db.setup$setup_db_BANG_$fn__51187.invoke(setup.clj:160)\r\n\tat metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:159)\r\n\tat metabase.db.setup$setup_db_BANG_.invoke(setup.clj:153)\r\n\tat metabase.db$setup_db_BANG_$fn__51207.invoke(db.clj:69)\r\n\tat metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)\r\n\tat metabase.db$setup_db_BANG_.invoke(db.clj:55)\r\n\tat metabase.core$init_BANG__STAR_.invokeStatic(core.clj:116)\r\n\tat metabase.core$init_BANG__STAR_.invoke(core.clj:101)\r\n\tat metabase.core$init_BANG_.invokeStatic(core.clj:159)\r\n\tat metabase.core$init_BANG_.invoke(core.clj:154)\r\n\tat metabase.core$start_normally.invokeStatic(core.clj:171)\r\n\tat metabase.core$start_normally.invoke(core.clj:165)\r\n\tat metabase.core$entrypoint.invokeStatic(core.clj:204)\r\n\tat metabase.core$entrypoint.doInvoke(core.clj:198)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:397)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:152)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat clojure.lang.Var.applyTo(Var.java:705)\r\n\tat clojure.core$apply.invokeStatic(core.clj:667)\r\n\tat clojure.core$apply.invoke(core.clj:662)\r\n\tat metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)\r\n\tat metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:397)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:152)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat metabase.bootstrap.main(Unknown Source)\r\nCaused by: liquibase.exception.LiquibaseException: liquibase.exception.MigrationFailedException: Migration failed for changeset migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat:\r\n     Reason: clojure.lang.ExceptionInfo: General error: ""General error: """"org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"""" [50000-214]""; SQL statement:\r\nCOMMIT [50000-214] {:toucan2/context-trace [[""resolve connection"" {:toucan2.connection/connectable org.h2.jdbc.JdbcConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}\r\n\tat liquibase.changelog.ChangeLogIterator.run(ChangeLogIterator.java:151)\r\n\tat liquibase.command.core.AbstractUpdateCommandStep.lambda$run$0(AbstractUpdateCommandStep.java:110)\r\n\tat liquibase.Scope.lambda$child$0(Scope.java:186)\r\n\tat liquibase.Scope.child(Scope.java:195)\r\n\tat liquibase.Scope.child(Scope.java:185)\r\n\tat liquibase.Scope.child(Scope.java:164)\r\n\tat liquibase.command.core.AbstractUpdateCommandStep.run(AbstractUpdateCommandStep.java:108)\r\n\tat liquibase.command.core.UpdateCommandStep.run(UpdateCommandStep.java:105)\r\n\tat liquibase.command.CommandScope.execute(CommandScope.java:217)\r\n\t... 49 more\r\nCaused by: liquibase.exception.MigrationFailedException: Migration failed for changeset migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat:\r\n     Reason: clojure.lang.ExceptionInfo: General error: ""General error: """"org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"""" [50000-214]""; SQL statement:\r\nCOMMIT [50000-214] {:toucan2/context-trace [[""resolve connection"" {:toucan2.connection/connectable org.h2.jdbc.JdbcConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}\r\n\tat liquibase.changelog.ChangeSet.execute(ChangeSet.java:797)\r\n\tat liquibase.changelog.visitor.UpdateVisitor.executeAcceptedChange(UpdateVisitor.java:119)\r\n\tat liquibase.changelog.visitor.UpdateVisitor.visit(UpdateVisitor.java:68)\r\n\tat liquibase.changelog.ChangeLogIterator$2.lambda$run$0(ChangeLogIterator.java:133)\r\n\tat liquibase.Scope.lambda$child$0(Scope.java:186)\r\n\tat liquibase.Scope.child(Scope.java:195)\r\n\tat liquibase.Scope.child(Scope.java:185)\r\n\tat liquibase.Scope.child(Scope.java:164)\r\n\tat liquibase.changelog.ChangeLogIterator$2.run(ChangeLogIterator.java:122)\r\n\tat liquibase.Scope.lambda$child$0(Scope.java:186)\r\n\tat liquibase.Scope.child(Scope.java:195)\r\n\tat liquibase.Scope.child(Scope.java:185)\r\n\tat liquibase.Scope.child(Scope.java:164)\r\n\tat liquibase.Scope.child(Scope.java:252)\r\n\tat liquibase.Scope.child(Scope.java:256)\r\n\tat liquibase.changelog.ChangeLogIterator.run(ChangeLogIterator.java:89)\r\n\t... 57 more\r\nCaused by: clojure.lang.ExceptionInfo: General error: ""General error: """"org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"""" [50000-214]""; SQL statement:\r\nCOMMIT [50000-214] {:toucan2/context-trace [[""resolve connection"" {:toucan2.connection/connectable org.h2.jdbc.JdbcConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}\r\n\tat org.h2.message.DbException.getJdbcSQLException(DbException.java:554)\r\n\tat org.h2.message.DbException.getJdbcSQLException(DbException.java:477)\r\n\tat org.h2.message.DbException.get(DbException.java:212)\r\n\tat org.h2.engine.Database.throwLastBackgroundException(Database.java:1782)\r\n\tat org.h2.engine.SessionLocal.beforeCommitOrRollback(SessionLocal.java:754)\r\n\tat org.h2.engine.SessionLocal.commit(SessionLocal.java:668)\r\n\tat org.h2.command.dml.TransactionCommand.update(TransactionCommand.java:46)\r\n\tat org.h2.command.CommandContainer.update(CommandContainer.java:169)\r\n\tat org.h2.command.Command.executeUpdate(Command.java:252)\r\n\tat org.h2.jdbc.JdbcConnection.commit(JdbcConnection.java:447)\r\n\tat com.mchange.v2.c3p0.impl.NewProxyConnection.commit(NewProxyConnection.java:981)\r\n\tat metabase.db.connection$do_transaction$thunk__32333.invoke(connection.clj:153)\r\n\tat metabase.db.connection$do_transaction.invokeStatic(connection.clj:165)\r\n\tat metabase.db.connection$do_transaction.invoke(connection.clj:146)\r\n\tat metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invokeStatic(connection.clj:199)\r\n\tat metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invoke(connection.clj:172)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:165)\r\n\tat clojure.lang.AFn.applyTo(AFn.java:144)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:457)\r\n\tat clojure.core$partial$fn__5908.invoke(core.clj:2643)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:160)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:436)\r\n\tat methodical.impl.combo.threaded$fn__18243$fn__18244$fn__18247.invoke(threaded.clj:71)\r\n\tat methodical.impl.combo.threaded$reducer_fn$fn__18213$fn__18217.invoke(threaded.clj:23)\r\n\tat clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)\r\n\tat clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)\r\n\tat clojure.core.protocols$fn__8244.invoke(protocols.clj:124)\r\n\tat clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)\r\n\tat clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)\r\n\tat clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)\r\n\tat clojure.core.protocols$fn__8236.invoke(protocols.clj:75)\r\n\tat clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)\r\n\tat clojure.core$reduce.invokeStatic(core.clj:6887)\r\n\tat clojure.core$reduce.invoke(core.clj:6869)\r\n\tat methodical.impl.combo.threaded$reducer_fn$fn__18213.invoke(threaded.clj:21)\r\n\tat clojure.core$comp$fn__5876.invoke(core.clj:2588)\r\n\tat methodical.impl.combo.threaded$combine_with_threader$fn__18223.invoke(threaded.clj:44)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:160)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:436)\r\n\tat toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invokeStatic(connection.clj:249)\r\n\tat toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invoke(connection.clj:245)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:165)\r\n\tat clojure.lang.AFn.applyTo(AFn.java:144)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:457)\r\n\tat clojure.core$partial$fn__5908.invoke(core.clj:2643)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:160)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:436)\r\n\tat methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:58)\r\n\tat methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)\r\n\tat methodical.impl.standard.StandardMultiFn.invoke(standard.clj:195)\r\n\tat metabase.db.custom_migrations.DeleteScanFieldValuesTriggerForDBThatTurnItOff$with_connection_STAR___48618.invoke(custom_migrations.clj:1106)\r\n\tat toucan2.connection$bind_current_connectable_fn$fn__21153.invoke(connection.clj:104)\r\n\tat toucan2.connection$bind_current_connectable_fn$fn__21153.invoke(connection.clj:104)\r\n\tat toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invokeStatic(connection.clj:13)\r\n\tat toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invoke(connection.clj:11)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:160)\r\n\tat clojure.lang.AFn.applyTo(AFn.java:144)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:436)\r\n\tat clojure.core$partial$fn__5908.invoke(core.clj:2642)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:156)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:421)\r\n\tat methodical.impl.combo.threaded$fn__18243$fn__18244$fn__18245.invoke(threaded.clj:70)\r\n\tat methodical.impl.combo.threaded$reducer_fn$fn__18213$fn__18217.invoke(threaded.clj:23)\r\n\tat clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)\r\n\tat clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)\r\n\tat clojure.core.protocols$fn__8244.invoke(protocols.clj:124)\r\n\tat clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)\r\n\tat clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)\r\n\tat clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)\r\n\tat clojure.core.protocols$fn__8236.invoke(protocols.clj:75)\r\n\tat clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)\r\n\tat clojure.core$reduce.invokeStatic(core.clj:6887)\r\n\tat clojure.core$reduce.invoke(core.clj:6869)\r\n\tat methodical.impl.combo.threaded$reducer_fn$fn__18213.invoke(threaded.clj:21)\r\n\tat clojure.core$comp$fn__5876.invoke(core.clj:2587)\r\n\tat methodical.impl.combo.threaded$combine_with_threader$fn__18223.invoke(threaded.clj:43)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:156)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:421)\r\n\tat toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)\r\n\tat toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:160)\r\n\tat clojure.lang.AFn.applyTo(AFn.java:144)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:436)\r\n\tat clojure.core$partial$fn__5908.invoke(core.clj:2642)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:156)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:421)\r\n\tat methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)\r\n\tat methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)\r\n\tat methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193)\r\n\tat toucan2.connection$do_with_connection_primary_method_.invokeStatic(connection.clj:204)\r\n\tat toucan2.connection$do_with_connection_primary_method_.invoke(connection.clj:194)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:160)\r\n\tat clojure.lang.AFn.applyTo(AFn.java:144)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:436)\r\n\tat clojure.core$partial$fn__5908.invoke(core.clj:2642)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:156)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:421)\r\n\tat methodical.impl.combo.threaded$fn__18243$fn__18244$fn__18245.invoke(threaded.clj:70)\r\n\tat methodical.impl.combo.threaded$reducer_fn$fn__18213$fn__18217.invoke(threaded.clj:23)\r\n\tat clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)\r\n\tat clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)\r\n\tat clojure.core.protocols$fn__8244.invoke(protocols.clj:124)\r\n\tat clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)\r\n\tat clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)\r\n\tat clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)\r\n\tat clojure.core.protocols$fn__8236.invoke(protocols.clj:75)\r\n\tat clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)\r\n\tat clojure.core$reduce.invokeStatic(core.clj:6887)\r\n\tat clojure.core$reduce.invoke(core.clj:6869)\r\n\tat methodical.impl.combo.threaded$reducer_fn$fn__18213.invoke(threaded.clj:21)\r\n\tat clojure.core$comp$fn__5876.invoke(core.clj:2587)\r\n\tat methodical.impl.combo.threaded$combine_with_threader$fn__18223.invoke(threaded.clj:43)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:156)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:421)\r\n\tat toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)\r\n\tat toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:160)\r\n\tat clojure.lang.AFn.applyTo(AFn.java:144)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:436)\r\n\tat clojure.core$partial$fn__5908.invoke(core.clj:2642)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:156)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat clojure.lang.AFunction$1.doInvoke(AFunction.java:31)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:421)\r\n\tat methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)\r\n\tat methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)\r\n\tat methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193)\r\n\tat metabase.db.custom_migrations.DeleteScanFieldValuesTriggerForDBThatTurnItOff.execute(custom_migrations.clj:1106)\r\n\tat liquibase.change.custom.CustomChangeWrapper.generateStatements(CustomChangeWrapper.java:169)\r\n\tat liquibase.database.AbstractJdbcDatabase.executeStatements(AbstractJdbcDatabase.java:1271)\r\n\tat metabase.db.liquibase.h2.proxy$liquibase.database.core.H2Database$ff19274a.executeStatements(Unknown Source)\r\n\tat liquibase.changelog.ChangeSet.execute(ChangeSet.java:755)\r\n\t... 72 more\r\nCaused by: org.h2.jdbc.JdbcSQLNonTransientException: General error: ""General error: """"org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"""" [50000-214]""; SQL statement:\r\nCOMMIT [50000-214]\r\n\t... 226 more\r\nCaused by: org.h2.message.DbException: General error: ""org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"" [50000-214]\r\n\tat org.h2.message.DbException.get(DbException.java:212)\r\n\tat org.h2.message.DbException.convert(DbException.java:395)\r\n\tat org.h2.mvstore.db.Store.lambda$new$0(Store.java:125)\r\n\tat org.h2.mvstore.MVStore.handleException(MVStore.java:3318)\r\n\tat org.h2.mvstore.MVStore.panic(MVStore.java:593)\r\n\tat org.h2.mvstore.MVStore.write(MVStore.java:1271)\r\n\tat org.h2.mvstore.MVStore.storeBuffer(MVStore.java:1750)\r\n\tat org.h2.mvstore.MVStore.lambda$serializeAndStore$5(MVStore.java:1600)\r\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\r\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\r\n\tat java.base/java.lang.Thread.run(Unknown Source)\r\nCaused by: org.h2.jdbc.JdbcSQLNonTransientException: General error: ""org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"" [50000-214]\r\n\tat org.h2.message.DbException.getJdbcSQLException(DbException.java:554)\r\n\tat org.h2.message.DbException.getJdbcSQLException(DbException.java:477)\r\n\t... 13 more\r\nCaused by: org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]\r\n\tat org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:1004)\r\n\tat org.h2.mvstore.DataUtils.writeFully(DataUtils.java:493)\r\n\tat org.h2.mvstore.FileStore.writeFully(FileStore.java:113)\r\n\tat org.h2.mvstore.MVStore.write(MVStore.java:1269)\r\n\t... 7 more\r\nCaused by: java.nio.channels.ClosedChannelException\r\n\tat java.base/sun.nio.ch.FileChannelImpl.ensureOpen(Unknown Source)\r\n\tat java.base/sun.nio.ch.FileChannelImpl.write(Unknown Source)\r\n\tat org.h2.mvstore.DataUtils.writeFully(DataUtils.java:489)\r\n\t... 9 more\r\n2024-06-04 04:55:49,888 INFO metabase.core :: Metabase Shutting Down ...\r\n2024-06-04 04:55:49,889 INFO metabase.server :: Shutting Down Embedded Jetty Webserver\r\n2024-06-04 04:55:49,904 WARN db.liquibase :: ()\r\n2024-06-04 04:55:49,905 INFO metabase.core :: Metabase Shutdown COMPLETE\r\n```', 'created_at': datetime.datetime(2024, 6, 4, 5, 13, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147402456, 'issue_id': 2332566971, 'author': 'paoliniluis', 'body': 'can you tell us your pc/laptop specs?', 'created_at': datetime.datetime(2024, 6, 4, 12, 22, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147653110, 'issue_id': 2332566971, 'author': 'mikich', 'body': '### I have the same issue - actually roadblock! Please, any suggestions?!?\r\n\r\nRunning the latest Docker 4.30.0 (149282) on Apple M3 Pro, 36Gb RAM, Sonoma 14.5\r\n\r\n\r\n```\r\n2024-06-04 08:37:19 Warning: environ value jdk-11.0.23+9 for key :java-version has been overwritten with 11.0.23\r\n2024-06-04 08:37:20 #\r\n2024-06-04 08:37:20 # A fatal error has been detected by the Java Runtime Environment:\r\n2024-06-04 08:37:20 #\r\n2024-06-04 08:37:20 #  SIGSEGV (0xb) at pc=0x00007ffffebd9f3d, pid=1, tid=41\r\n2024-06-04 08:37:20 #\r\n2024-06-04 08:37:20 # JRE version: OpenJDK Runtime Environment Temurin-11.0.23+9 (11.0.23+9) (build 11.0.23+9)\r\n2024-06-04 08:37:20 # Java VM: OpenJDK 64-Bit Server VM Temurin-11.0.23+9 (11.0.23+9, mixed mode, tiered, compressed oops, g1 gc, linux-amd64)\r\n2024-06-04 08:37:20 # Problematic frame:\r\n2024-06-04 08:37:20 # V  [libjvm.so+0x78cf3d]  G1ParEvacuateFollowersClosure::do_void()+0x1fd\r\n2024-06-04 08:37:20 #\r\n2024-06-04 08:37:20 # No core dump will be written. Core dumps have been disabled. To enable core dumping, try ""ulimit -c unlimited"" before starting Java again\r\n2024-06-04 08:37:20 #\r\n2024-06-04 08:37:20 # Can not save log file, dump to screen..\r\n2024-06-04 08:37:20 #\r\n2024-06-04 08:37:20 # A fatal error has been detected by the Java Runtime Environment:\r\n2024-06-04 08:37:20 #\r\n2024-06-04 08:37:20 #  SIGSEGV (0xb) at pc=0x00007ffffebd9f3d, pid=1, tid=41\r\n2024-06-04 08:37:20 #\r\n2024-06-04 08:37:20 # JRE version: OpenJDK Runtime Environment Temurin-11.0.23+9 (11.0.23+9) (build 11.0.23+9)\r\n2024-06-04 08:37:20 # Java VM: OpenJDK 64-Bit Server VM Temurin-11.0.23+9 (11.0.23+9, mixed mode, tiered, compressed oops, g1 gc, linux-amd64)\r\n2024-06-04 08:37:20 # Problematic frame:\r\n2024-06-04 08:37:20 # V  [libjvm.so+0x78cf3d]  G1ParEvacuateFollowersClosure::do_void()+0x1fd\r\n2024-06-04 08:37:20 #\r\n2024-06-04 08:37:20 # No core dump will be written. Core dumps have been disabled. To enable core dumping, try ""ulimit -c unlimited"" before starting Java again\r\n2024-06-04 08:37:20 #\r\n2024-06-04 08:37:20 # If you would like to submit a bug report, please visit:\r\n2024-06-04 08:37:20 #   https://github.com/adoptium/adoptium-support/issues\r\n2024-06-04 08:37:20 #\r\n2024-06-04 08:37:20 \r\n2024-06-04 08:37:20 ---------------  S U M M A R Y ------------\r\n2024-06-04 08:37:20 \r\n2024-06-04 08:37:20 Command Line: -XX:+IgnoreUnrecognizedVMOptions -Dfile.encoding=UTF-8 -Dlogfile.path=target/log -XX:+CrashOnOutOfMemoryError /app/metabase.jar\r\n2024-06-04 08:37:20 \r\n2024-06-04 08:37:20 Host: x86_64, 11 cores, 21G, Alpine Linux v3.19\r\n2024-06-04 08:37:20 Time: Tue Jun  4 13:37:20 2024 UTC elapsed time: 4.173301 seconds (0d 0h 0m 4s)\r\n2024-06-04 08:37:20 \r\n2024-06-04 08:37:20 ---------------  T H R E A D  ---------------\r\nBla, Bla, Bla, Bla, Bla, Bla, Bla, ...\r\n```\r\n\r\nAlso, here is part of my docker-compose.yml:\r\n\r\n```\r\n  # BI\r\n  metabase:\r\n    image: metabase/metabase:latest\r\n    container_name: metabase\r\n    hostname: metabase\r\n    volumes:\r\n    - /dev/urandom:/dev/random:ro\r\n    ports:\r\n      - 3000:3000\r\n    environment:\r\n      MB_DB_TYPE: postgres\r\n      MB_DB_DBNAME: metabaseappdb\r\n      MB_DB_PORT: 5432\r\n      MB_DB_USER: metabase\r\n      MB_DB_PASS: mysecretpassword\r\n      MB_DB_HOST: postgres\r\n    networks:\r\n      - app_net\r\n    healthcheck:\r\n      test: curl --fail -I http://localhost:3000/api/health || exit 1\r\n      interval: 15s\r\n      timeout: 5s\r\n      retries: 5\r\n  # postgres - BI\'s DB\r\n  postgres:\r\n    image: postgres:latest\r\n    container_name: postgres\r\n    hostname: postgres\r\n    environment:\r\n      POSTGRES_USER: metabase\r\n      POSTGRES_DB: metabaseappdb\r\n      POSTGRES_PASSWORD: mysecretpassword\r\n    expose:\r\n      - 5432\r\n    ports:\r\n      - ""5432:5432""\r\n    networks:\r\n      - app_net\r\n```\r\n\r\n**Java version container pointing is bellow:**\r\n```\r\n# java -version\r\nopenjdk version ""11.0.23"" 2024-04-16\r\nOpenJDK Runtime Environment Temurin-11.0.23+9 (build 11.0.23+9)\r\nOpenJDK 64-Bit Server VM Temurin-11.0.23+9 (build 11.0.23+9, mixed mode)\r\n\r\n# echo $JAVA_HOME\r\n/opt/java/openjdk\r\n\r\n# echo $PATH\r\n/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\r\n```', 'created_at': datetime.datetime(2024, 6, 4, 14, 15, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147890730, 'issue_id': 2332566971, 'author': 'markbastian', 'body': 'Seeing the same thing. I\'ve tried both latest and v0.49.13.\r\n\r\n```\r\nHardware Overview:\r\n\r\n  Model Name:\tMacBook Pro\r\n  Model Identifier:\tMac15,9\r\n  Model Number:\tZ1AH000VNLL/A\r\n  Chip:\tApple M3 Max\r\n  Total Number of Cores:\t16 (12 performance and 4 efficiency)\r\n  Memory:\t64 GB\r\n  System Firmware Version:\t10151.121.1\r\n  OS Loader Version:\t10151.121.1\r\n```\r\nError:\r\n```\r\n#\r\n# A fatal error has been detected by the Java Runtime Environment:\r\n#\r\n#  SIGSEGV (0xb) at pc=0x00007ffffebde144[thread 91 also had an error]\r\n[thread 89 also had an error]\r\n[thread 92 also had an error]\r\n[thread 96 also had an error]\r\n[thread 24 also had an error]\r\n[thread 90 also had an error]\r\n[thread 46 also had an error]\r\n[thread 95 also had an error]\r\n[thread 94 also had an error]\r\n[thread 66 also had an error]\r\n[thread 60 also had an error]\r\n[thread 93 also had an error]\r\n, pid=1, tid=54\r\n#\r\n# JRE version: OpenJDK Runtime Environment Temurin-11.0.23+9 (11.0.23+9) (build 11.0.23+9)\r\n# Java VM: OpenJDK 64-Bit Server VM Temurin-11.0.23+9 (11.0.23+9, mixed mode, tiered, compressed oops, g1 gc, linux-amd64)\r\n# Problematic frame:\r\n# V  [libjvm.so+0x791144]  oopDesc::size()+0x24\r\n#\r\n# No core dump will be written. Core dumps have been disabled. To enable core dumping, try ""ulimit -c unlimited"" before starting Java again\r\n```', 'created_at': datetime.datetime(2024, 6, 4, 15, 59, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147962755, 'issue_id': 2332566971, 'author': 'paoliniluis', 'body': 'Anyone that runs on Mac please upgrade your docker runtime to the latest version, or run with Colima, or build your own container of Metabase based on Ubuntu or other base image that supports ARM\r\n\r\nyou’re all most probably seeing https://github.com/docker/for-mac/issues/7172\r\n\r\nbtw, hi @markbastian, we miss you ❤️', 'created_at': datetime.datetime(2024, 6, 4, 16, 36, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2148206081, 'issue_id': 2332566971, 'author': 'markbastian', 'body': 'Thanks for the tip @paoliniluis.\r\n\r\nI can confirm that the following steps worked for me:\r\n1. `brew install colima`\r\n2. `colima start`\r\n3. `docker run -p 3100:3000 --platform linux/amd64 --name metabase-latest metabase/metabase`\r\n\r\nNote that you can prevent the need to restart colima on startup with `brew services start colima`\r\n\r\nMiss you all, too!', 'created_at': datetime.datetime(2024, 6, 4, 19, 0, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2148239500, 'issue_id': 2332566971, 'author': 'markbastian', 'body': 'Note [additional step required to work with compose](https://github.com/abiosoft/colima/discussions/874).', 'created_at': datetime.datetime(2024, 6, 4, 19, 22, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2148419024, 'issue_id': 2332566971, 'author': 'mikich', 'body': 'I tried all the above tips, thank you @markbastian , although unsuccessful:\r\nBoth:\r\n\r\n-     colima start\r\n-     docker run -p 3100:3000 --platform linux/amd64 --name metabase-latest metabase/metabase\r\n\r\nAnd:\r\n\r\n-     docker-compose -f docker-compose.yml up --detach\r\n\r\nGot me the same result as before :-(\r\n\r\n> A fatal error has been detected by the Java Runtime Environment:\r\n> SIGSEGV (0xb) at pc=0x00007ffffebe162e, pid=1, tid=55\r\n> JRE version: OpenJDK Runtime Environment Temurin-11.0.23+9 (11.0.23+9) (build 11.0.23+9)', 'created_at': datetime.datetime(2024, 6, 4, 21, 8, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2151421567, 'issue_id': 2332566971, 'author': 'schlos', 'body': '1) With Docker Desktop (macOS):\r\n\r\n```\r\ndocker run -d -p 3000:3000 \\\r\n  -v ~/metabase-data:/Users/username/Workspace/metabase.db \\\r\n  -e ""MB_DB_FILE=/metabase-data/metabase.db"" \\\r\n  --name metabase metabase/metabase\r\n```\r\n\r\n> WARNING: The requested image\'s platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested\r\n> 792584cecb86e8b5dc56dbd0e0f9ac3c7bfce2f8cdefedceb70081449b86a5f0\r\n\r\n2) With Colima (macOS):\r\n\r\n```\r\ncolima start\r\nINFO[0000] starting colima\r\nINFO[0000] runtime: docker\r\nINFO[0001] starting ...                                  context=vm\r\nINFO[0012] provisioning ...                              context=docker\r\nINFO[0012] starting ...                                  context=docker\r\nINFO[0013] done\r\n```\r\n\r\n```\r\ndocker run -d -p 3000:3000 \\\r\n  -v ~/metabase-data:/Users/username/Workspace/metabase.db \\\r\n  -e ""MB_DB_FILE=/metabase-data/metabase.db"" \\\r\n  --name metabase metabase/metabase\r\n\r\nUnable to find image \'metabase/metabase:latest\' locally\r\nlatest: Pulling from metabase/metabase\r\n4abcf2066143: Pull complete\r\na21a63612cbe: Pull complete\r\n1e3d1cfa9847: Pull complete\r\nc29f1605bed2: Pull complete\r\nb17f30e766d9: Pull complete\r\n09d6e4610ee2: Pull complete\r\n85ebd572b17f: Pull complete\r\nDigest: sha256:3531a3488e5238b537b76d23e267af961c88a15c6eb748ee6f829751d8fc867d\r\nStatus: Downloaded newer image for metabase/metabase:latest\r\n```\r\n\r\n> WARNING: The requested image\'s platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested\r\n> 9b8ec80003235e9c6a4887f98abc75b045a7de05a6aebcb2035524006472f4af\r\n\r\nAm I doing something wrong?', 'created_at': datetime.datetime(2024, 6, 6, 5, 6, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2156805721, 'issue_id': 2332566971, 'author': 'oliv-j', 'body': '> 1. With Docker Desktop (macOS):\r\n> \r\n> ```\r\n> docker run -d -p 3000:3000 \\\r\n>   -v ~/metabase-data:/Users/username/Workspace/metabase.db \\\r\n>   -e ""MB_DB_FILE=/metabase-data/metabase.db"" \\\r\n>   --name metabase metabase/metabase\r\n> ```\r\n> \r\n> > WARNING: The requested image\'s platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested\r\n> > 792584cecb86e8b5dc56dbd0e0f9ac3c7bfce2f8cdefedceb70081449b86a5f0\r\n> \r\n> 2. With Colima (macOS):\r\n> \r\n> ```\r\n> colima start\r\n> INFO[0000] starting colima\r\n> INFO[0000] runtime: docker\r\n> INFO[0001] starting ...                                  context=vm\r\n> INFO[0012] provisioning ...                              context=docker\r\n> INFO[0012] starting ...                                  context=docker\r\n> INFO[0013] done\r\n> ```\r\n> \r\n> ```\r\n> docker run -d -p 3000:3000 \\\r\n>   -v ~/metabase-data:/Users/username/Workspace/metabase.db \\\r\n>   -e ""MB_DB_FILE=/metabase-data/metabase.db"" \\\r\n>   --name metabase metabase/metabase\r\n> \r\n> Unable to find image \'metabase/metabase:latest\' locally\r\n> latest: Pulling from metabase/metabase\r\n> 4abcf2066143: Pull complete\r\n> a21a63612cbe: Pull complete\r\n> 1e3d1cfa9847: Pull complete\r\n> c29f1605bed2: Pull complete\r\n> b17f30e766d9: Pull complete\r\n> 09d6e4610ee2: Pull complete\r\n> 85ebd572b17f: Pull complete\r\n> Digest: sha256:3531a3488e5238b537b76d23e267af961c88a15c6eb748ee6f829751d8fc867d\r\n> Status: Downloaded newer image for metabase/metabase:latest\r\n> ```\r\n> \r\n> > WARNING: The requested image\'s platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested\r\n> > 9b8ec80003235e9c6a4887f98abc75b045a7de05a6aebcb2035524006472f4af\r\n> \r\n> Am I doing something wrong?\r\n\r\nNot sure - fired up a fresh install of docker and metabase on Tuesday last week and it worked fine with pretty standard settings.. Didn\'t use brew or colima etc. Couple of days later I tried again and got the fatal error message (see OP) and spent hours trying to get it to work. Removed it all, used brew for colima and disabled the virtualisation framework in Docker...now I just get an error - failed to connect to mysql and metabase shuts down.', 'created_at': datetime.datetime(2024, 6, 9, 21, 53, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2177732531, 'issue_id': 2332566971, 'author': 'schlos', 'body': '> can you tell us your pc/laptop specs?\r\n\r\n@paoliniluis hope this helps:\r\n\r\n```\r\n$ system_profiler SPHardwareDataType\r\n\r\nHardware:\r\n\r\n    Hardware Overview:\r\n\r\n      Model Name: MacBook Air\r\n      Model Identifier: Mac15,13\r\n      Model Number: Z1BP000MHX/A\r\n      Chip: Apple M3\r\n      Total Number of Cores: 8 (4 performance and 4 efficiency)\r\n      Memory: 16 GB\r\n      System Firmware Version: 10151.121.1\r\n      OS Loader Version: 10151.121.1\r\n```', 'created_at': datetime.datetime(2024, 6, 19, 4, 52, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2187667328, 'issue_id': 2332566971, 'author': 'renansigolo', 'body': 'Just had the same issue and solved by using this 2 steps:\r\n1. In your terminal run `export LD_BIND_NOW=1`\r\n1. Disable the Rosetta emulation from docker (I\'m currently running docker v4.31.0)\r\n\r\n\r\n<img width=""1804"" alt=""Screenshot 2024-06-25 at 10 09 28\u202fAM"" src=""https://github.com/metabase/metabase/assets/25624875/b7304b51-726c-4fec-9a8e-08ebfde10130"">\r\n\r\nI hope this helps!', 'created_at': datetime.datetime(2024, 6, 25, 0, 13, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2191253706, 'issue_id': 2332566971, 'author': 'AykutCevik', 'body': '@renansigolo Thanks for the tip! This helped me to run metabase without installing anything else.', 'created_at': datetime.datetime(2024, 6, 26, 9, 36, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2194759583, 'issue_id': 2332566971, 'author': 'mikich', 'body': 'I ended up using an alternative image, specially created for arm64 (I\'m running it on Mac M3Pro).\r\nHere is my `docker-config.yml`:\r\n\r\n```version: ""4.0""\r\nservices:\r\n  # BI - Metabse\r\n  metabase:\r\n    container_name: metabase\r\n    platform: linux/arm64\r\n    expose:\r\n      - 3003\r\n    ports:\r\n      - ""3003:3000""\r\n    image: bobblybook/metabase\r\n    restart: always\r\n    networks:\r\n      - app_net\r\n\r\nnetworks:\r\n  app_net:\r\n    ipam:\r\n      driver: default\r\n      config:\r\n        - subnet: ""172.16.240.0/24""\r\n```', 'created_at': datetime.datetime(2024, 6, 27, 13, 58, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2483070494, 'issue_id': 2332566971, 'author': 'paoliniluis', 'body': 'duplicate of https://github.com/metabase/metabase/issues/13119', 'created_at': datetime.datetime(2024, 11, 18, 13, 38, 57, tzinfo=datetime.timezone.utc)}]","schlos (Issue Creator) on (2024-06-04 05:13:14 UTC): Tried also other docker container runtime to rule out issue with Docker Desktop - tried on OrbStack (latest version, 1.6.1), error logged there:

```
Warning: environ value jdk-11.0.23+9 for key :java-version has been overwritten with 11.0.23
2024-06-04 04:55:38,018 INFO metabase.util :: Maximum memory available to JVM: 1.3 GB
2024-06-04 04:55:39,380 WARN db.env :: WARNING: Using Metabase with an H2 application database is not recommended for production deployments. For production deployments, we highly recommend using Postgres, MySQL, or MariaDB instead. If you decide to continue to use H2, please be sure to back up the database file regularly. For more information, see https://metabase.com/docs/latest/operations-guide/migrating-from-h2.html
2024-06-04 04:55:39,536 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓 
 For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html
2024-06-04 04:55:43,705 INFO driver.impl :: Registered abstract driver :sql  🚚
2024-06-04 04:55:43,714 INFO driver.impl :: Registered abstract driver :sql-jdbc (parents: [:sql]) 🚚
2024-06-04 04:55:43,722 INFO metabase.util :: Load driver :sql-jdbc took 49.8 ms
2024-06-04 04:55:43,724 INFO driver.impl :: Registered driver :h2 (parents: [:sql-jdbc]) 🚚
2024-06-04 04:55:43,877 INFO driver.impl :: Registered driver :mysql (parents: [:sql-jdbc]) 🚚
2024-06-04 04:55:43,905 INFO driver.impl :: Registered driver :postgres (parents: [:sql-jdbc]) 🚚
2024-06-04 04:55:45,214 INFO metabase.core :: 
Metabase v0.49.13 (de28e83) 

Copyright © 2024 Metabase, Inc. 

Metabase Enterprise Edition extensions are NOT PRESENT.
2024-06-04 04:55:45,224 INFO metabase.core :: Starting Metabase in STANDALONE mode
2024-06-04 04:55:45,276 INFO metabase.server :: Launching Embedded Jetty Webserver with config:
 {:port 3000, :host ""0.0.0.0""}

2024-06-04 04:55:45,332 INFO metabase.core :: Starting Metabase version v0.49.13 (de28e83) ...
2024-06-04 04:55:45,336 INFO metabase.core :: System info:
 {""file.encoding"" ""UTF-8"",
 ""java.runtime.name"" ""OpenJDK Runtime Environment"",
 ""java.runtime.version"" ""11.0.23+9"",
 ""java.vendor"" ""Eclipse Adoptium"",
 ""java.vendor.url"" ""https://adoptium.net/"",
 ""java.version"" ""11.0.23"",
 ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",
 ""java.vm.version"" ""11.0.23+9"",
 ""os.name"" ""Linux"",
 ""os.version"" ""6.7.12-orbstack-00202-g57474688ffbd"",
 ""user.language"" ""en"",
 ""user.timezone"" ""GMT""}

2024-06-04 04:55:45,340 INFO metabase.plugins :: Loading plugins in /plugins...
2024-06-04 04:55:45,447 INFO util.files :: Extract file /modules/sparksql.metabase-driver.jar -> /plugins/sparksql.metabase-driver.jar
2024-06-04 04:55:45,510 INFO util.files :: Extract file /modules/sqlserver.metabase-driver.jar -> /plugins/sqlserver.metabase-driver.jar
2024-06-04 04:55:45,519 INFO util.files :: Extract file /modules/snowflake.metabase-driver.jar -> /plugins/snowflake.metabase-driver.jar
2024-06-04 04:55:45,781 INFO util.files :: Extract file /modules/mongo.metabase-driver.jar -> /plugins/mongo.metabase-driver.jar
2024-06-04 04:55:45,794 INFO util.files :: Extract file /modules/oracle.metabase-driver.jar -> /plugins/oracle.metabase-driver.jar
2024-06-04 04:55:45,795 INFO util.files :: Extract file /modules/googleanalytics.metabase-driver.jar -> /plugins/googleanalytics.metabase-driver.jar
2024-06-04 04:55:45,804 INFO util.files :: Extract file /modules/athena.metabase-driver.jar -> /plugins/athena.metabase-driver.jar
2024-06-04 04:55:45,860 INFO util.files :: Extract file /modules/redshift.metabase-driver.jar -> /plugins/redshift.metabase-driver.jar
2024-06-04 04:55:45,864 INFO util.files :: Extract file /modules/presto-jdbc.metabase-driver.jar -> /plugins/presto-jdbc.metabase-driver.jar
2024-06-04 04:55:45,900 INFO util.files :: Extract file /modules/bigquery-cloud-sdk.metabase-driver.jar -> /plugins/bigquery-cloud-sdk.metabase-driver.jar
2024-06-04 04:55:46,009 INFO util.files :: Extract file /modules/druid.metabase-driver.jar -> /plugins/druid.metabase-driver.jar
2024-06-04 04:55:46,011 INFO util.files :: Extract file /modules/vertica.metabase-driver.jar -> /plugins/vertica.metabase-driver.jar
2024-06-04 04:55:46,012 INFO util.files :: Extract file /modules/sqlite.metabase-driver.jar -> /plugins/sqlite.metabase-driver.jar
2024-06-04 04:55:46,214 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...
2024-06-04 04:55:46,217 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚
2024-06-04 04:55:46,220 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...
2024-06-04 04:55:46,221 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚
2024-06-04 04:55:46,231 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...
2024-06-04 04:55:46,232 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚
2024-06-04 04:55:46,265 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...
2024-06-04 04:55:46,266 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚
2024-06-04 04:55:46,275 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...
2024-06-04 04:55:46,276 INFO driver.impl :: Registered driver :mongo  🚚
2024-06-04 04:55:46,296 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Oracle Driver due to required dependencies. Metabase requires the Oracle JDBC driver in order to connect to Oracle databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/oracle.html for more details.

2024-06-04 04:55:46,297 INFO plugins.dependencies :: Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? false
2024-06-04 04:55:46,298 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Oracle Driver""]
2024-06-04 04:55:46,312 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...
2024-06-04 04:55:46,313 INFO driver.impl :: Registered driver :googleanalytics  🚚
2024-06-04 04:55:46,326 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :athena...
2024-06-04 04:55:46,327 INFO driver.impl :: Registered driver :athena (parents: [:sql-jdbc]) 🚚
2024-06-04 04:55:46,330 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...
2024-06-04 04:55:46,330 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚
2024-06-04 04:55:46,345 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...
2024-06-04 04:55:46,345 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚
2024-06-04 04:55:46,356 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...
2024-06-04 04:55:46,357 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚
2024-06-04 04:55:46,363 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...
2024-06-04 04:55:46,364 INFO driver.impl :: Registered driver :druid  🚚
2024-06-04 04:55:46,369 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.

2024-06-04 04:55:46,371 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false
2024-06-04 04:55:46,372 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver"" ""Metabase Oracle Driver""]
2024-06-04 04:55:46,373 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...
2024-06-04 04:55:46,374 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚
2024-06-04 04:55:46,387 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
2024-06-04 04:55:46,389 INFO db.setup :: Verifying h2 Database Connection ...
2024-06-04 04:55:47,129 INFO db.setup :: Successfully verified H2 2.1.214 (2022-06-13) application database connection. ✅
2024-06-04 04:55:47,132 INFO db.setup :: Checking if a database downgrade is required...
2024-06-04 04:55:47,851 INFO db.setup :: Running Database Migrations...
2024-06-04 04:55:47,852 INFO db.setup :: Setting up Liquibase...
2024-06-04 04:55:48,131 INFO db.setup :: Liquibase is ready.
2024-06-04 04:55:48,134 INFO db.liquibase :: Checking if Database has unrun migrations...
2024-06-04 04:55:48,659 INFO db.liquibase :: Database has unrun migrations. Checking if migraton lock is taken...
2024-06-04 04:55:48,671 INFO db.liquibase :: No migration lock found.
2024-06-04 04:55:48,936 INFO db.liquibase :: Running 9 migrations ...
2024-06-04 04:55:49,428 INFO impl.StdSchedulerFactory :: Using default implementation for ThreadExecutor
2024-06-04 04:55:49,459 INFO core.SchedulerSignalerImpl :: Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2024-06-04 04:55:49,460 INFO core.QuartzScheduler :: Quartz Scheduler v.2.3.2 created.
2024-06-04 04:55:49,460 INFO jdbcjobstore.JobStoreTX :: Using db table-based data access locking (synchronization).
2024-06-04 04:55:49,462 INFO jdbcjobstore.JobStoreTX :: JobStoreTX initialized.
2024-06-04 04:55:49,465 INFO core.QuartzScheduler :: Scheduler meta-data: Quartz Scheduler (v2.3.2) 'MetabaseScheduler' with instanceId 'ab66a974b5581717476949439'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.impl.jdbcjobstore.JobStoreTX' - which supports persistence. and is clustered.

2024-06-04 04:55:49,465 INFO impl.StdSchedulerFactory :: Quartz scheduler 'MetabaseScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2024-06-04 04:55:49,465 INFO impl.StdSchedulerFactory :: Quartz scheduler version: 2.3.2
2024-06-04 04:55:49,510 INFO jdbcjobstore.JobStoreTX :: ClusterManager: detected 1 failed or restarted instances.
2024-06-04 04:55:49,510 INFO jdbcjobstore.JobStoreTX :: ClusterManager: Scanning for instance ""60f0e50b3bfa1716200268272""'s failed in-progress jobs.
2024-06-04 04:55:49,531 INFO jdbcjobstore.JobStoreTX :: ClusterManager: ......Cleaned-up 1 other failed job(s).
2024-06-04 04:55:49,545 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_ab66a974b5581717476949439 started.
2024-06-04 04:55:49,592 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_ab66a974b5581717476949439 shutting down.
2024-06-04 04:55:49,592 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_ab66a974b5581717476949439 paused.
2024-06-04 04:55:49,602 INFO jdbcjobstore.JobStoreTX :: Handling the first 20 triggers that missed their scheduled fire-time.  More misfired triggers remain to be processed.
2024-06-04 04:55:49,615 ERROR jdbcjobstore.JobStoreTX :: MisfireHandler: Error handling misfires: Couldn't retrieve trigger: Block not found in id [1, -26, 2, -28, 2] [2.1.214/50]
org.quartz.JobPersistenceException: Couldn't retrieve trigger: Block not found in id [1, -26, 2, -28, 2] [2.1.214/50] [See nested exception: java.io.IOException: Block not found in id [1, -26, 2, -28, 2] [2.1.214/50]]
	at org.quartz.impl.jdbcjobstore.JobStoreSupport.retrieveTrigger(JobStoreSupport.java:1538)
	at org.quartz.impl.jdbcjobstore.JobStoreSupport.recoverMisfiredJobs(JobStoreSupport.java:984)
	at org.quartz.impl.jdbcjobstore.JobStoreSupport.doRecoverMisfires(JobStoreSupport.java:3264)
	at org.quartz.impl.jdbcjobstore.JobStoreSupport$MisfireHandler.manage(JobStoreSupport.java:4012)
	at org.quartz.impl.jdbcjobstore.JobStoreSupport$MisfireHandler.run(JobStoreSupport.java:4033)
Caused by: java.io.IOException: Block not found in id [1, -26, 2, -28, 2] [2.1.214/50]
	at org.h2.mvstore.StreamStore$Stream.read(StreamStore.java:514)
	at java.base/java.io.FilterInputStream.read(Unknown Source)
	at org.h2.mvstore.db.LobStorageMap$LobInputStream.read(LobStorageMap.java:358)
	at java.base/java.io.ObjectInputStream$PeekInputStream.read(Unknown Source)
	at java.base/java.io.ObjectInputStream$PeekInputStream.readFully(Unknown Source)
	at java.base/java.io.ObjectInputStream$BlockDataInputStream.readShort(Unknown Source)
	at java.base/java.io.ObjectInputStream.readStreamHeader(Unknown Source)
	at java.base/java.io.ObjectInputStream.<init>(Unknown Source)
	at org.quartz.impl.jdbcjobstore.StdJDBCDelegate.getObjectFromBlob(StdJDBCDelegate.java:3199)
	at org.quartz.impl.jdbcjobstore.StdJDBCDelegate.selectTrigger(StdJDBCDelegate.java:1780)
	at org.quartz.impl.jdbcjobstore.JobStoreSupport.retrieveTrigger(JobStoreSupport.java:1536)
	... 4 more
Caused by: org.h2.mvstore.MVStoreException: Reading from file sun.nio.ch.FileChannelImpl@4b737e1c failed at 3129518 (length -1), read 0, remaining 384 [2.1.214/1]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:1004)
	at org.h2.mvstore.DataUtils.readFully(DataUtils.java:470)
	at org.h2.mvstore.FileStore.readFully(FileStore.java:98)
	at org.h2.mvstore.Chunk.readBufferForPage(Chunk.java:422)
	at org.h2.mvstore.MVStore.readPage(MVStore.java:2569)
	at org.h2.mvstore.MVMap.readPage(MVMap.java:633)
	at org.h2.mvstore.Page$NonLeaf.getChildPage(Page.java:1125)
	at org.h2.mvstore.Page.get(Page.java:243)
	at org.h2.mvstore.MVMap.get(MVMap.java:436)
	at org.h2.mvstore.MVMap.get(MVMap.java:424)
	at org.h2.mvstore.StreamStore.getBlock(StreamStore.java:434)
	at org.h2.mvstore.StreamStore$Stream.nextBuffer(StreamStore.java:551)
	at org.h2.mvstore.StreamStore$Stream.read(StreamStore.java:508)
	... 14 more
Caused by: java.nio.channels.ClosedByInterruptException
	at java.base/java.nio.channels.spi.AbstractInterruptibleChannel.end(Unknown Source)
	at java.base/sun.nio.ch.FileChannelImpl.endBlocking(Unknown Source)
	at java.base/sun.nio.ch.FileChannelImpl.readInternal(Unknown Source)
	at java.base/sun.nio.ch.FileChannelImpl.read(Unknown Source)
	at org.h2.mvstore.DataUtils.readFully(DataUtils.java:456)
	... 25 more
2024-06-04 04:55:49,622 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_ab66a974b5581717476949439 shutdown complete.
2024-06-04 04:55:49,808 ERROR liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat encountered an exception.

UPDATE SUMMARY
Run:                          9
Previously run:             262
Filtered out:                19
-------------------------------
Total change sets:          290


FILTERED CHANGE SETS SUMMARY
DBMS mismatch:               19

2024-06-04 04:55:49,873 ERROR metabase.core :: Metabase Initialization FAILED
liquibase.exception.CommandExecutionException: liquibase.exception.LiquibaseException: liquibase.exception.MigrationFailedException: Migration failed for changeset migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat:
     Reason: clojure.lang.ExceptionInfo: General error: ""General error: """"org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"""" [50000-214]""; SQL statement:
COMMIT [50000-214] {:toucan2/context-trace [[""resolve connection"" {:toucan2.connection/connectable org.h2.jdbc.JdbcConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}
	at liquibase.command.CommandScope.execute(CommandScope.java:253)
	at liquibase.Liquibase.lambda$update$0(Liquibase.java:245)
	at liquibase.Scope.lambda$child$0(Scope.java:186)
	at liquibase.Scope.child(Scope.java:195)
	at liquibase.Scope.child(Scope.java:185)
	at liquibase.Scope.child(Scope.java:164)
	at liquibase.Liquibase.runInScope(Liquibase.java:1419)
	at liquibase.Liquibase.update(Liquibase.java:234)
	at liquibase.Liquibase.update(Liquibase.java:212)
	at liquibase.Liquibase.update(Liquibase.java:194)
	at metabase.db.liquibase$migrate_up_if_needed_BANG_.invokeStatic(liquibase.clj:305)
	at metabase.db.liquibase$migrate_up_if_needed_BANG_.invoke(liquibase.clj:287)
	at metabase.db.setup$migrate_BANG_$fn__51159.invoke(setup.clj:80)
	at metabase.db.liquibase$do_with_liquibase$f_STAR___48835.invoke(liquibase.clj:139)
	at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:142)
	at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:130)
	at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)
	at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)
	at clojure.lang.RestFn.invoke(RestFn.java:445)
	at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:147)
	at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:141)
	at metabase.db.setup$setup_db_BANG_$fn__51187$fn__51188.invoke(setup.clj:165)
	at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)
	at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)
	at metabase.db.setup$setup_db_BANG_$fn__51187.invoke(setup.clj:160)
	at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:159)
	at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:153)
	at metabase.db$setup_db_BANG_$fn__51207.invoke(db.clj:69)
	at metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)
	at metabase.db$setup_db_BANG_.invoke(db.clj:55)
	at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:116)
	at metabase.core$init_BANG__STAR_.invoke(core.clj:101)
	at metabase.core$init_BANG_.invokeStatic(core.clj:159)
	at metabase.core$init_BANG_.invoke(core.clj:154)
	at metabase.core$start_normally.invokeStatic(core.clj:171)
	at metabase.core$start_normally.invoke(core.clj:165)
	at metabase.core$entrypoint.invokeStatic(core.clj:204)
	at metabase.core$entrypoint.doInvoke(core.clj:198)
	at clojure.lang.RestFn.invoke(RestFn.java:397)
	at clojure.lang.AFn.applyToHelper(AFn.java:152)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.Var.applyTo(Var.java:705)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
	at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
	at clojure.lang.RestFn.invoke(RestFn.java:397)
	at clojure.lang.AFn.applyToHelper(AFn.java:152)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at metabase.bootstrap.main(Unknown Source)
Caused by: liquibase.exception.LiquibaseException: liquibase.exception.MigrationFailedException: Migration failed for changeset migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat:
     Reason: clojure.lang.ExceptionInfo: General error: ""General error: """"org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"""" [50000-214]""; SQL statement:
COMMIT [50000-214] {:toucan2/context-trace [[""resolve connection"" {:toucan2.connection/connectable org.h2.jdbc.JdbcConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}
	at liquibase.changelog.ChangeLogIterator.run(ChangeLogIterator.java:151)
	at liquibase.command.core.AbstractUpdateCommandStep.lambda$run$0(AbstractUpdateCommandStep.java:110)
	at liquibase.Scope.lambda$child$0(Scope.java:186)
	at liquibase.Scope.child(Scope.java:195)
	at liquibase.Scope.child(Scope.java:185)
	at liquibase.Scope.child(Scope.java:164)
	at liquibase.command.core.AbstractUpdateCommandStep.run(AbstractUpdateCommandStep.java:108)
	at liquibase.command.core.UpdateCommandStep.run(UpdateCommandStep.java:105)
	at liquibase.command.CommandScope.execute(CommandScope.java:217)
	... 49 more
Caused by: liquibase.exception.MigrationFailedException: Migration failed for changeset migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat:
     Reason: clojure.lang.ExceptionInfo: General error: ""General error: """"org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"""" [50000-214]""; SQL statement:
COMMIT [50000-214] {:toucan2/context-trace [[""resolve connection"" {:toucan2.connection/connectable org.h2.jdbc.JdbcConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}
	at liquibase.changelog.ChangeSet.execute(ChangeSet.java:797)
	at liquibase.changelog.visitor.UpdateVisitor.executeAcceptedChange(UpdateVisitor.java:119)
	at liquibase.changelog.visitor.UpdateVisitor.visit(UpdateVisitor.java:68)
	at liquibase.changelog.ChangeLogIterator$2.lambda$run$0(ChangeLogIterator.java:133)
	at liquibase.Scope.lambda$child$0(Scope.java:186)
	at liquibase.Scope.child(Scope.java:195)
	at liquibase.Scope.child(Scope.java:185)
	at liquibase.Scope.child(Scope.java:164)
	at liquibase.changelog.ChangeLogIterator$2.run(ChangeLogIterator.java:122)
	at liquibase.Scope.lambda$child$0(Scope.java:186)
	at liquibase.Scope.child(Scope.java:195)
	at liquibase.Scope.child(Scope.java:185)
	at liquibase.Scope.child(Scope.java:164)
	at liquibase.Scope.child(Scope.java:252)
	at liquibase.Scope.child(Scope.java:256)
	at liquibase.changelog.ChangeLogIterator.run(ChangeLogIterator.java:89)
	... 57 more
Caused by: clojure.lang.ExceptionInfo: General error: ""General error: """"org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"""" [50000-214]""; SQL statement:
COMMIT [50000-214] {:toucan2/context-trace [[""resolve connection"" {:toucan2.connection/connectable org.h2.jdbc.JdbcConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:554)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:477)
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.engine.Database.throwLastBackgroundException(Database.java:1782)
	at org.h2.engine.SessionLocal.beforeCommitOrRollback(SessionLocal.java:754)
	at org.h2.engine.SessionLocal.commit(SessionLocal.java:668)
	at org.h2.command.dml.TransactionCommand.update(TransactionCommand.java:46)
	at org.h2.command.CommandContainer.update(CommandContainer.java:169)
	at org.h2.command.Command.executeUpdate(Command.java:252)
	at org.h2.jdbc.JdbcConnection.commit(JdbcConnection.java:447)
	at com.mchange.v2.c3p0.impl.NewProxyConnection.commit(NewProxyConnection.java:981)
	at metabase.db.connection$do_transaction$thunk__32333.invoke(connection.clj:153)
	at metabase.db.connection$do_transaction.invokeStatic(connection.clj:165)
	at metabase.db.connection$do_transaction.invoke(connection.clj:146)
	at metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invokeStatic(connection.clj:199)
	at metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invoke(connection.clj:172)
	at clojure.lang.AFn.applyToHelper(AFn.java:165)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:457)
	at clojure.core$partial$fn__5908.invoke(core.clj:2643)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at methodical.impl.combo.threaded$fn__18243$fn__18244$fn__18247.invoke(threaded.clj:71)
	at methodical.impl.combo.threaded$reducer_fn$fn__18213$fn__18217.invoke(threaded.clj:23)
	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
	at clojure.core$reduce.invokeStatic(core.clj:6887)
	at clojure.core$reduce.invoke(core.clj:6869)
	at methodical.impl.combo.threaded$reducer_fn$fn__18213.invoke(threaded.clj:21)
	at clojure.core$comp$fn__5876.invoke(core.clj:2588)
	at methodical.impl.combo.threaded$combine_with_threader$fn__18223.invoke(threaded.clj:44)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invokeStatic(connection.clj:249)
	at toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invoke(connection.clj:245)
	at clojure.lang.AFn.applyToHelper(AFn.java:165)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:457)
	at clojure.core$partial$fn__5908.invoke(core.clj:2643)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:58)
	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:195)
	at metabase.db.custom_migrations.DeleteScanFieldValuesTriggerForDBThatTurnItOff$with_connection_STAR___48618.invoke(custom_migrations.clj:1106)
	at toucan2.connection$bind_current_connectable_fn$fn__21153.invoke(connection.clj:104)
	at toucan2.connection$bind_current_connectable_fn$fn__21153.invoke(connection.clj:104)
	at toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invokeStatic(connection.clj:13)
	at toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invoke(connection.clj:11)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at clojure.core$partial$fn__5908.invoke(core.clj:2642)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at methodical.impl.combo.threaded$fn__18243$fn__18244$fn__18245.invoke(threaded.clj:70)
	at methodical.impl.combo.threaded$reducer_fn$fn__18213$fn__18217.invoke(threaded.clj:23)
	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
	at clojure.core$reduce.invokeStatic(core.clj:6887)
	at clojure.core$reduce.invoke(core.clj:6869)
	at methodical.impl.combo.threaded$reducer_fn$fn__18213.invoke(threaded.clj:21)
	at clojure.core$comp$fn__5876.invoke(core.clj:2587)
	at methodical.impl.combo.threaded$combine_with_threader$fn__18223.invoke(threaded.clj:43)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at clojure.core$partial$fn__5908.invoke(core.clj:2642)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193)
	at toucan2.connection$do_with_connection_primary_method_.invokeStatic(connection.clj:204)
	at toucan2.connection$do_with_connection_primary_method_.invoke(connection.clj:194)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at clojure.core$partial$fn__5908.invoke(core.clj:2642)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at methodical.impl.combo.threaded$fn__18243$fn__18244$fn__18245.invoke(threaded.clj:70)
	at methodical.impl.combo.threaded$reducer_fn$fn__18213$fn__18217.invoke(threaded.clj:23)
	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
	at clojure.core$reduce.invokeStatic(core.clj:6887)
	at clojure.core$reduce.invoke(core.clj:6869)
	at methodical.impl.combo.threaded$reducer_fn$fn__18213.invoke(threaded.clj:21)
	at clojure.core$comp$fn__5876.invoke(core.clj:2587)
	at methodical.impl.combo.threaded$combine_with_threader$fn__18223.invoke(threaded.clj:43)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at clojure.core$partial$fn__5908.invoke(core.clj:2642)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193)
	at metabase.db.custom_migrations.DeleteScanFieldValuesTriggerForDBThatTurnItOff.execute(custom_migrations.clj:1106)
	at liquibase.change.custom.CustomChangeWrapper.generateStatements(CustomChangeWrapper.java:169)
	at liquibase.database.AbstractJdbcDatabase.executeStatements(AbstractJdbcDatabase.java:1271)
	at metabase.db.liquibase.h2.proxy$liquibase.database.core.H2Database$ff19274a.executeStatements(Unknown Source)
	at liquibase.changelog.ChangeSet.execute(ChangeSet.java:755)
	... 72 more
Caused by: org.h2.jdbc.JdbcSQLNonTransientException: General error: ""General error: """"org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"""" [50000-214]""; SQL statement:
COMMIT [50000-214]
	... 226 more
Caused by: org.h2.message.DbException: General error: ""org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"" [50000-214]
	at org.h2.message.DbException.get(DbException.java:212)
	at org.h2.message.DbException.convert(DbException.java:395)
	at org.h2.mvstore.db.Store.lambda$new$0(Store.java:125)
	at org.h2.mvstore.MVStore.handleException(MVStore.java:3318)
	at org.h2.mvstore.MVStore.panic(MVStore.java:593)
	at org.h2.mvstore.MVStore.write(MVStore.java:1271)
	at org.h2.mvstore.MVStore.storeBuffer(MVStore.java:1750)
	at org.h2.mvstore.MVStore.lambda$serializeAndStore$5(MVStore.java:1600)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: org.h2.jdbc.JdbcSQLNonTransientException: General error: ""org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]"" [50000-214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:554)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:477)
	... 13 more
Caused by: org.h2.mvstore.MVStoreException: Writing to sun.nio.ch.FileChannelImpl@4b737e1c failed; length 122880 at 6115328 [2.1.214/2]
	at org.h2.mvstore.DataUtils.newMVStoreException(DataUtils.java:1004)
	at org.h2.mvstore.DataUtils.writeFully(DataUtils.java:493)
	at org.h2.mvstore.FileStore.writeFully(FileStore.java:113)
	at org.h2.mvstore.MVStore.write(MVStore.java:1269)
	... 7 more
Caused by: java.nio.channels.ClosedChannelException
	at java.base/sun.nio.ch.FileChannelImpl.ensureOpen(Unknown Source)
	at java.base/sun.nio.ch.FileChannelImpl.write(Unknown Source)
	at org.h2.mvstore.DataUtils.writeFully(DataUtils.java:489)
	... 9 more
2024-06-04 04:55:49,888 INFO metabase.core :: Metabase Shutting Down ...
2024-06-04 04:55:49,889 INFO metabase.server :: Shutting Down Embedded Jetty Webserver
2024-06-04 04:55:49,904 WARN db.liquibase :: ()
2024-06-04 04:55:49,905 INFO metabase.core :: Metabase Shutdown COMPLETE
```

paoliniluis on (2024-06-04 12:22:53 UTC): can you tell us your pc/laptop specs?

mikich on (2024-06-04 14:15:35 UTC): ### I have the same issue - actually roadblock! Please, any suggestions?!?

Running the latest Docker 4.30.0 (149282) on Apple M3 Pro, 36Gb RAM, Sonoma 14.5


```
2024-06-04 08:37:19 Warning: environ value jdk-11.0.23+9 for key :java-version has been overwritten with 11.0.23
2024-06-04 08:37:20 #
2024-06-04 08:37:20 # A fatal error has been detected by the Java Runtime Environment:
2024-06-04 08:37:20 #
2024-06-04 08:37:20 #  SIGSEGV (0xb) at pc=0x00007ffffebd9f3d, pid=1, tid=41
2024-06-04 08:37:20 #
2024-06-04 08:37:20 # JRE version: OpenJDK Runtime Environment Temurin-11.0.23+9 (11.0.23+9) (build 11.0.23+9)
2024-06-04 08:37:20 # Java VM: OpenJDK 64-Bit Server VM Temurin-11.0.23+9 (11.0.23+9, mixed mode, tiered, compressed oops, g1 gc, linux-amd64)
2024-06-04 08:37:20 # Problematic frame:
2024-06-04 08:37:20 # V  [libjvm.so+0x78cf3d]  G1ParEvacuateFollowersClosure::do_void()+0x1fd
2024-06-04 08:37:20 #
2024-06-04 08:37:20 # No core dump will be written. Core dumps have been disabled. To enable core dumping, try ""ulimit -c unlimited"" before starting Java again
2024-06-04 08:37:20 #
2024-06-04 08:37:20 # Can not save log file, dump to screen..
2024-06-04 08:37:20 #
2024-06-04 08:37:20 # A fatal error has been detected by the Java Runtime Environment:
2024-06-04 08:37:20 #
2024-06-04 08:37:20 #  SIGSEGV (0xb) at pc=0x00007ffffebd9f3d, pid=1, tid=41
2024-06-04 08:37:20 #
2024-06-04 08:37:20 # JRE version: OpenJDK Runtime Environment Temurin-11.0.23+9 (11.0.23+9) (build 11.0.23+9)
2024-06-04 08:37:20 # Java VM: OpenJDK 64-Bit Server VM Temurin-11.0.23+9 (11.0.23+9, mixed mode, tiered, compressed oops, g1 gc, linux-amd64)
2024-06-04 08:37:20 # Problematic frame:
2024-06-04 08:37:20 # V  [libjvm.so+0x78cf3d]  G1ParEvacuateFollowersClosure::do_void()+0x1fd
2024-06-04 08:37:20 #
2024-06-04 08:37:20 # No core dump will be written. Core dumps have been disabled. To enable core dumping, try ""ulimit -c unlimited"" before starting Java again
2024-06-04 08:37:20 #
2024-06-04 08:37:20 # If you would like to submit a bug report, please visit:
2024-06-04 08:37:20 #   https://github.com/adoptium/adoptium-support/issues
2024-06-04 08:37:20 #
2024-06-04 08:37:20 
2024-06-04 08:37:20 ---------------  S U M M A R Y ------------
2024-06-04 08:37:20 
2024-06-04 08:37:20 Command Line: -XX:+IgnoreUnrecognizedVMOptions -Dfile.encoding=UTF-8 -Dlogfile.path=target/log -XX:+CrashOnOutOfMemoryError /app/metabase.jar
2024-06-04 08:37:20 
2024-06-04 08:37:20 Host: x86_64, 11 cores, 21G, Alpine Linux v3.19
2024-06-04 08:37:20 Time: Tue Jun  4 13:37:20 2024 UTC elapsed time: 4.173301 seconds (0d 0h 0m 4s)
2024-06-04 08:37:20 
2024-06-04 08:37:20 ---------------  T H R E A D  ---------------
Bla, Bla, Bla, Bla, Bla, Bla, Bla, ...
```

Also, here is part of my docker-compose.yml:

```
  # BI
  metabase:
    image: metabase/metabase:latest
    container_name: metabase
    hostname: metabase
    volumes:
    - /dev/urandom:/dev/random:ro
    ports:
      - 3000:3000
    environment:
      MB_DB_TYPE: postgres
      MB_DB_DBNAME: metabaseappdb
      MB_DB_PORT: 5432
      MB_DB_USER: metabase
      MB_DB_PASS: mysecretpassword
      MB_DB_HOST: postgres
    networks:
      - app_net
    healthcheck:
      test: curl --fail -I http://localhost:3000/api/health || exit 1
      interval: 15s
      timeout: 5s
      retries: 5
  # postgres - BI's DB
  postgres:
    image: postgres:latest
    container_name: postgres
    hostname: postgres
    environment:
      POSTGRES_USER: metabase
      POSTGRES_DB: metabaseappdb
      POSTGRES_PASSWORD: mysecretpassword
    expose:
      - 5432
    ports:
      - ""5432:5432""
    networks:
      - app_net
```

**Java version container pointing is bellow:**
```
# java -version
openjdk version ""11.0.23"" 2024-04-16
OpenJDK Runtime Environment Temurin-11.0.23+9 (build 11.0.23+9)
OpenJDK 64-Bit Server VM Temurin-11.0.23+9 (build 11.0.23+9, mixed mode)

# echo $JAVA_HOME
/opt/java/openjdk

# echo $PATH
/opt/java/openjdk/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
```

markbastian on (2024-06-04 15:59:32 UTC): Seeing the same thing. I've tried both latest and v0.49.13.

```
Hardware Overview:

  Model Name:	MacBook Pro
  Model Identifier:	Mac15,9
  Model Number:	Z1AH000VNLL/A
  Chip:	Apple M3 Max
  Total Number of Cores:	16 (12 performance and 4 efficiency)
  Memory:	64 GB
  System Firmware Version:	10151.121.1
  OS Loader Version:	10151.121.1
```
Error:
```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  SIGSEGV (0xb) at pc=0x00007ffffebde144[thread 91 also had an error]
[thread 89 also had an error]
[thread 92 also had an error]
[thread 96 also had an error]
[thread 24 also had an error]
[thread 90 also had an error]
[thread 46 also had an error]
[thread 95 also had an error]
[thread 94 also had an error]
[thread 66 also had an error]
[thread 60 also had an error]
[thread 93 also had an error]
, pid=1, tid=54
#
# JRE version: OpenJDK Runtime Environment Temurin-11.0.23+9 (11.0.23+9) (build 11.0.23+9)
# Java VM: OpenJDK 64-Bit Server VM Temurin-11.0.23+9 (11.0.23+9, mixed mode, tiered, compressed oops, g1 gc, linux-amd64)
# Problematic frame:
# V  [libjvm.so+0x791144]  oopDesc::size()+0x24
#
# No core dump will be written. Core dumps have been disabled. To enable core dumping, try ""ulimit -c unlimited"" before starting Java again
```

paoliniluis on (2024-06-04 16:36:17 UTC): Anyone that runs on Mac please upgrade your docker runtime to the latest version, or run with Colima, or build your own container of Metabase based on Ubuntu or other base image that supports ARM

you’re all most probably seeing https://github.com/docker/for-mac/issues/7172

btw, hi @markbastian, we miss you ❤️

markbastian on (2024-06-04 19:00:16 UTC): Thanks for the tip @paoliniluis.

I can confirm that the following steps worked for me:
1. `brew install colima`
2. `colima start`
3. `docker run -p 3100:3000 --platform linux/amd64 --name metabase-latest metabase/metabase`

Note that you can prevent the need to restart colima on startup with `brew services start colima`

Miss you all, too!

markbastian on (2024-06-04 19:22:24 UTC): Note [additional step required to work with compose](https://github.com/abiosoft/colima/discussions/874).

mikich on (2024-06-04 21:08:04 UTC): I tried all the above tips, thank you @markbastian , although unsuccessful:
Both:

-     colima start
-     docker run -p 3100:3000 --platform linux/amd64 --name metabase-latest metabase/metabase

And:

-     docker-compose -f docker-compose.yml up --detach

Got me the same result as before :-(

schlos (Issue Creator) on (2024-06-06 05:06:34 UTC): 1) With Docker Desktop (macOS):

```
docker run -d -p 3000:3000 \
  -v ~/metabase-data:/Users/username/Workspace/metabase.db \
  -e ""MB_DB_FILE=/metabase-data/metabase.db"" \
  --name metabase metabase/metabase
```


2) With Colima (macOS):

```
colima start
INFO[0000] starting colima
INFO[0000] runtime: docker
INFO[0001] starting ...                                  context=vm
INFO[0012] provisioning ...                              context=docker
INFO[0012] starting ...                                  context=docker
INFO[0013] done
```

```
docker run -d -p 3000:3000 \
  -v ~/metabase-data:/Users/username/Workspace/metabase.db \
  -e ""MB_DB_FILE=/metabase-data/metabase.db"" \
  --name metabase metabase/metabase

Unable to find image 'metabase/metabase:latest' locally
latest: Pulling from metabase/metabase
4abcf2066143: Pull complete
a21a63612cbe: Pull complete
1e3d1cfa9847: Pull complete
c29f1605bed2: Pull complete
b17f30e766d9: Pull complete
09d6e4610ee2: Pull complete
85ebd572b17f: Pull complete
Digest: sha256:3531a3488e5238b537b76d23e267af961c88a15c6eb748ee6f829751d8fc867d
Status: Downloaded newer image for metabase/metabase:latest
```


Am I doing something wrong?

oliv-j on (2024-06-09 21:53:32 UTC): Not sure - fired up a fresh install of docker and metabase on Tuesday last week and it worked fine with pretty standard settings.. Didn't use brew or colima etc. Couple of days later I tried again and got the fatal error message (see OP) and spent hours trying to get it to work. Removed it all, used brew for colima and disabled the virtualisation framework in Docker...now I just get an error - failed to connect to mysql and metabase shuts down.

schlos (Issue Creator) on (2024-06-19 04:52:42 UTC): @paoliniluis hope this helps:

```
$ system_profiler SPHardwareDataType

Hardware:

    Hardware Overview:

      Model Name: MacBook Air
      Model Identifier: Mac15,13
      Model Number: Z1BP000MHX/A
      Chip: Apple M3
      Total Number of Cores: 8 (4 performance and 4 efficiency)
      Memory: 16 GB
      System Firmware Version: 10151.121.1
      OS Loader Version: 10151.121.1
```

renansigolo on (2024-06-25 00:13:07 UTC): Just had the same issue and solved by using this 2 steps:
1. In your terminal run `export LD_BIND_NOW=1`
1. Disable the Rosetta emulation from docker (I'm currently running docker v4.31.0)


<img width=""1804"" alt=""Screenshot 2024-06-25 at 10 09 28 AM"" src=""https://github.com/metabase/metabase/assets/25624875/b7304b51-726c-4fec-9a8e-08ebfde10130"">

I hope this helps!

AykutCevik on (2024-06-26 09:36:55 UTC): @renansigolo Thanks for the tip! This helped me to run metabase without installing anything else.

mikich on (2024-06-27 13:58:17 UTC): I ended up using an alternative image, specially created for arm64 (I'm running it on Mac M3Pro).
Here is my `docker-config.yml`:

```version: ""4.0""
services:
  # BI - Metabse
  metabase:
    container_name: metabase
    platform: linux/arm64
    expose:
      - 3003
    ports:
      - ""3003:3000""
    image: bobblybook/metabase
    restart: always
    networks:
      - app_net

networks:
  app_net:
    ipam:
      driver: default
      config:
        - subnet: ""172.16.240.0/24""
```

paoliniluis on (2024-11-18 13:38:57 UTC): duplicate of https://github.com/metabase/metabase/issues/13119

"
2332383470,issue,closed,completed,fix(webapp/browse): Fix overflow issues with collection paths,"- [ ] Some collection paths are getting cut off by a pixel. Note that the bottom of the ""g"" is truncated here. The vertical truncation is also causing the tooltips to appear on strings that are not genuinely truncated (and which do not have ellipses). See first screenshot below

- [ ] Some collection paths are overflowing nearby content (see second screenshot below)

![Image](https://github.com/metabase/metabase/assets/130925/5bd35c26-8bbd-47a1-98b2-93f120e3d616)

![Image](https://github.com/user-attachments/assets/4ee6fad7-7267-4a16-81e7-190bfcdef6a8)",rafpaf,2024-06-04 02:17:53+00:00,[],2025-02-04 19:59:17+00:00,2025-02-04 19:59:16+00:00,https://github.com/metabase/metabase/issues/43568,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Organization/Collections', ''), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2634937526, 'issue_id': 2332383470, 'author': 'rafpaf', 'body': 'This has been solved', 'created_at': datetime.datetime(2025, 2, 4, 19, 59, 16, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2025-02-04 19:59:16 UTC): This has been solved

"
2332310425,issue,closed,completed,update e2e tests,,EmmadUsmani,2024-06-04 00:51:54+00:00,['EmmadUsmani'],2024-07-01 19:45:18+00:00,2024-07-01 19:45:18+00:00,https://github.com/metabase/metabase/issues/43565,"[('.CI & Tests', '')]","[{'comment_id': 2200895648, 'issue_id': 2332310425, 'author': 'EmmadUsmani', 'body': 'Done in https://github.com/metabase/metabase/pull/43555/commits/daaa0e40ad973f2fd92825a6166abe60aa187d0d', 'created_at': datetime.datetime(2024, 7, 1, 19, 45, 18, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-07-01 19:45:18 UTC): Done in https://github.com/metabase/metabase/pull/43555/commits/daaa0e40ad973f2fd92825a6166abe60aa187d0d

"
2332310372,issue,closed,completed,create visual regression tests for all settings,,EmmadUsmani,2024-06-04 00:51:50+00:00,['EmmadUsmani'],2024-06-06 17:31:06+00:00,2024-06-06 17:30:48+00:00,https://github.com/metabase/metabase/issues/43564,[],[],
2332262401,issue,closed,completed,click actions,,EmmadUsmani,2024-06-03 23:58:55+00:00,['EmmadUsmani'],2024-07-01 16:52:35+00:00,2024-07-01 16:51:51+00:00,https://github.com/metabase/metabase/issues/43562,[],"[{'comment_id': 2200621737, 'issue_id': 2332262401, 'author': 'EmmadUsmani', 'body': 'Implemented in https://github.com/metabase/metabase/pull/43555/commits/57f7e0a37055760a934a39aaf84be84a3b445d28', 'created_at': datetime.datetime(2024, 7, 1, 16, 52, 34, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-07-01 16:52:34 UTC): Implemented in https://github.com/metabase/metabase/pull/43555/commits/57f7e0a37055760a934a39aaf84be84a3b445d28

"
2332262359,issue,closed,completed,connect legend to emphasis state,,EmmadUsmani,2024-06-03 23:58:53+00:00,['EmmadUsmani'],2024-06-28 23:03:51+00:00,2024-06-28 23:03:51+00:00,https://github.com/metabase/metabase/issues/43561,[],"[{'comment_id': 2197754330, 'issue_id': 2332262359, 'author': 'EmmadUsmani', 'body': 'Implemented in https://github.com/metabase/metabase/pull/43555/commits/b18789fbf0743523e2df43baba1f891e02bbee8b', 'created_at': datetime.datetime(2024, 6, 28, 23, 3, 51, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-28 23:03:51 UTC): Implemented in https://github.com/metabase/metabase/pull/43555/commits/b18789fbf0743523e2df43baba1f891e02bbee8b

"
2332262306,issue,closed,completed,render legend,,EmmadUsmani,2024-06-03 23:58:50+00:00,['EmmadUsmani'],2024-06-28 23:03:41+00:00,2024-06-28 23:03:41+00:00,https://github.com/metabase/metabase/issues/43560,[],"[{'comment_id': 2197754237, 'issue_id': 2332262306, 'author': 'EmmadUsmani', 'body': 'Implemented in https://github.com/metabase/metabase/pull/43555/commits/b18789fbf0743523e2df43baba1f891e02bbee8b', 'created_at': datetime.datetime(2024, 6, 28, 23, 3, 41, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-28 23:03:41 UTC): Implemented in https://github.com/metabase/metabase/pull/43555/commits/b18789fbf0743523e2df43baba1f891e02bbee8b

"
2332262262,issue,closed,completed,update total on slice hover,,EmmadUsmani,2024-06-03 23:58:47+00:00,['EmmadUsmani'],2024-06-28 00:43:02+00:00,2024-06-28 00:43:01+00:00,https://github.com/metabase/metabase/issues/43559,"[('Visualization/Charts/Pie', '')]","[{'comment_id': 2195885350, 'issue_id': 2332262262, 'author': 'EmmadUsmani', 'body': 'Implemented in https://github.com/metabase/metabase/pull/43555/commits/948a2276a11711035ce741771b3e7755846f0b26', 'created_at': datetime.datetime(2024, 6, 28, 0, 43, 1, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-28 00:43:01 UTC): Implemented in https://github.com/metabase/metabase/pull/43555/commits/948a2276a11711035ce741771b3e7755846f0b26

"
2332262222,issue,closed,completed,emphasis state for slice hover,,EmmadUsmani,2024-06-03 23:58:45+00:00,['EmmadUsmani'],2024-06-26 22:20:15+00:00,2024-06-26 22:20:15+00:00,https://github.com/metabase/metabase/issues/43558,"[('.Frontend', '')]","[{'comment_id': 2192715903, 'issue_id': 2332262222, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/949e0d128650b46f0a342a94d389bf617f44ae4c', 'created_at': datetime.datetime(2024, 6, 26, 22, 20, 15, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-26 22:20:15 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/949e0d128650b46f0a342a94d389bf617f44ae4c

"
2332262179,issue,closed,completed,difference in percentage formatting,"<img width=""981"" alt=""Screenshot 2024-06-06 at 10 30 02 AM"" src=""https://github.com/metabase/metabase/assets/37751258/dd9b36fc-f033-46de-8887-f4f7b3cfbf23"">

This seemingly only happens on the legend. Below is an example where the percentage is on the chart, and the percentages are the same between static and in-app viz.

<img width=""1025"" alt=""Screenshot 2024-06-06 at 10 34 28 AM"" src=""https://github.com/metabase/metabase/assets/37751258/04ff21da-6b23-4726-8097-7bf1952a41f6"">
",EmmadUsmani,2024-06-03 23:58:41+00:00,['EmmadUsmani'],2024-06-06 20:54:21+00:00,2024-06-06 20:54:16+00:00,https://github.com/metabase/metabase/issues/43557,[],"[{'comment_id': 2153391471, 'issue_id': 2332262179, 'author': 'EmmadUsmani', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43555/commits/b8d23142ec0586046f12e02bc8ff5e41234454c5', 'created_at': datetime.datetime(2024, 6, 6, 20, 54, 16, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-06-06 20:54:16 UTC): Fixed by https://github.com/metabase/metabase/pull/43555/commits/b8d23142ec0586046f12e02bc8ff5e41234454c5

"
2332259802,issue,closed,completed,migrate static pie chart to echarts,,EmmadUsmani,2024-06-03 23:55:59+00:00,['EmmadUsmani'],2024-07-09 22:15:53+00:00,2024-07-09 22:15:52+00:00,https://github.com/metabase/metabase/issues/43556,"[('Visualization/Charts/Pie', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.')]","[{'comment_id': 2218823415, 'issue_id': 2332259802, 'author': 'EmmadUsmani', 'body': 'Closing as we are done bug bashing the static chart, and all regressions have been fixed', 'created_at': datetime.datetime(2024, 7, 9, 22, 15, 52, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-07-09 22:15:52 UTC): Closing as we are done bug bashing the static chart, and all regressions have been fixed

"
2332239439,issue,open,,"If `:semantic_type = :type/Category` then string operators are allowed in MLv2, even if the `effective_type` should not allow them","### Describe the bug

I came across this bug trying to make MySQL ENUM types have a base_type of `type/TextLike` https://github.com/metabase/metabase/pull/43533.

The problem is that filter operators like ""contains"" or ""starts with"" are available on the FE in the GUI editor for fields that have `:effective_type = :type/TextLike` and `:semantic_type = :type/Category`. But the purpose of `:type/TextLike`, as opposed to `:type/Text`, is to disallow such filters:
https://github.com/metabase/metabase/blob/2a21cf2ea2e1708ce4f4b4fdea77ea96189a852c/src/metabase/types.cljc#L256-L257

I traced the bug down to the fact that `(metabase.lib.types.isa/field-type? :metabase.lib.types.constants/string field)` will return `true` for such a field.

```
(let [field {:lib/type           :metadata/column
             :description        nil
             :base-type          :type/IPAddress
             :semantic-type      :type/Category
             :table-id           152
             :name               ""color""
             :coercion-strategy  nil
             :settings           nil
             :nfc-path           nil
             :database-type      ""ENUM""
             :effective-type     :type/IPAddress
             :fk-target-field-id nil
             :id                 768
             :parent-id          nil
             :visibility-type    :normal
             :display-name       ""Color""
             :position           1
             :fingerprint        {}}]
  (metabase.lib.types.isa/field-type? :metabase.lib.types.constants/string field))
```

This is a result of how `metabase.lib.types.isa/field-type?` and `lib.types.constants/type-hierarchies` are implemented.

This line: 
https://github.com/metabase/metabase/blob/2a21cf2ea2e1708ce4f4b4fdea77ea96189a852c/src/metabase/lib/types/constants.cljc#L46
and this line:
https://github.com/metabase/metabase/blob/2a21cf2ea2e1708ce4f4b4fdea77ea96189a852c/src/metabase/lib/types/isa.cljc#L34
means that any column that has `:semantic_type = :type/Category` will get a true result from `(metabase.lib.types.isa/field-type? :metabase.lib.types.constants/string field)`.

### To Reproduce

To see the issue with a real database:

1. Switch to the `mysql-enum-type-as-text` branch from this PR: https://github.com/metabase/metabase/pull/43533 (or master after it is merged)
2. Create a table:
```
-- Create the table
CREATE TABLE colors (
    id INT AUTO_INCREMENT PRIMARY KEY,
    color ENUM('red', 'green', '1')
);

-- Insert values into the table
INSERT INTO colors (color) VALUES ('red');
INSERT INTO colors (color) VALUES ('green');
INSERT INTO colors (color) VALUES ('1');
INSERT INTO colors (color) VALUES (NULL);
```
3. Sync the MySQL database with Metabase
4. Query the table with the GUI editor, and add a ""contains"" filter on the `color` column. (incorrect, this should be possible)
5. Execute the query and note that the error is displayed (correct)

### Expected behavior

If `:effective_type = :type/TextLike` then you should not be able to apply text operations to the column from the UI.

### Logs

_No response_

### Information about your Metabase installation

```JSON
`mysql-enum-type-as-text` branch
```


### Severity

low

### Additional context

_No response_",calherries,2024-06-03 23:34:20+00:00,[],2025-02-04 20:27:12+00:00,,https://github.com/metabase/metabase/issues/43554,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/MBQL', ''), ('.Backend', ''), ('.Team/Querying', ''), ('.Possibly Already Fixed', 'This might already be fixed, e.g. because we fixed something similar to it recently. TODO-list')]",[],
2332145727,issue,open,,"""Unsubscribe"" Option for External Subscription Recipients Fails if Email Address has a Plus Sign In It","### Describe the bug

You can set up external recipients for alerts and subscriptions. If the recipient has a '+' sign in their email address then the unsubscribe link generated in the subscription does not work.

### To Reproduce

1. Create a subscription in Metabase
2. Set it up to deliver to yourself with Gmail's ""plus addressing"" (if your Gmail is franky@mycompany.com you can email franky+test@mycompany.com)
3. When alert is received click ""unsubscribe
4. Land on the error page ""Whoops, something went wrong. Please give it a minute and try again""

The API call to the unsubscribe endpoint fails with ""invalid hash""

### Expected behavior

The unsubscribe should work

### Logs

_No response_

### Information about your Metabase installation

```JSON
v49.13
```


### Severity

annoying

### Additional context

_No response_",ixipixi,2024-06-03 22:08:50+00:00,[],2024-06-04 10:41:16+00:00,,https://github.com/metabase/metabase/issues/43543,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Pulses', 'Now called Subscriptions'), ('Misc/Emails', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2332115768,issue,open,,[Cache] Remove classnames from cache code,,rafpaf,2024-06-03 21:49:25+00:00,[],2024-06-04 01:39:47+00:00,,https://github.com/metabase/metabase/issues/43541,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2332038789,issue,closed,completed,Switching from a `stack - 100%` chart to a line chart causes the line chart to break,"Switching from a `stack- 100%` bar chart to a line chart causes the line chart to incorrectly display. Essentially, the settings for `normalized` bar charts are still being respected even though they are no longer relevant

![image](https://github.com/metabase/metabase/assets/22608765/10f62eca-990e-4453-9041-1eb7f2af2ded)

![image](https://github.com/metabase/metabase/assets/22608765/09778285-6e8b-4b90-8df3-6856ecda6704)
",JesseSDevaney,2024-06-03 20:56:57+00:00,['alxnddr'],2024-06-11 00:56:47+00:00,2024-06-10 21:24:31+00:00,https://github.com/metabase/metabase/issues/43538,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Chart Settings', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2332034716,issue,closed,completed,Using scaling on a question with multiple y-axis columns breaks tool-tips and y-axis label formatting,"### Multiple Y-axis columns breaks with scaling breaks chart

Since we only use one of the columns targeting a specific y-axis (left or right), we may or may not apply the column `scale` factor. This can result in an incorrectly displayed chart - i.e. plotted data points do not align with y-axis values. And, tool-tip values do not align with actual values.

---
**1. Multiple Y-axis columns breaks y-axis formatting**

![image](https://github.com/metabase/metabase/assets/22608765/62d497a4-b15b-4e22-b37c-9949b0df2b76)

![image](https://github.com/metabase/metabase/assets/22608765/e620c98d-0e22-4880-a49a-58a7280f3cf1)

![image](https://github.com/metabase/metabase/assets/22608765/ec4ab7b8-b9dc-49e2-a6bc-76476388b57c)


---
**2. Multiple Y-axis columns breaks tool-tip values**

![image](https://github.com/metabase/metabase/assets/22608765/db0a58b8-0e6b-47e7-be7f-a9d1713d0784)

![image](https://github.com/metabase/metabase/assets/22608765/26e565df-9cfe-4206-aa8d-bfe5e9f3e629)

As you can see, the scaling factor had not effect on the chart display or tool-tip values.",JesseSDevaney,2024-06-03 20:54:12+00:00,['JesseSDevaney'],2024-06-06 22:25:40+00:00,2024-06-06 22:25:39+00:00,https://github.com/metabase/metabase/issues/43536,"[('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Correctness', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]","[{'comment_id': 2150937750, 'issue_id': 2332034716, 'author': 'JesseSDevaney', 'body': 'Waiting until backport merges to officially close', 'created_at': datetime.datetime(2024, 6, 5, 20, 48, 16, tzinfo=datetime.timezone.utc)}]","JesseSDevaney (Issue Creator) on (2024-06-05 20:48:16 UTC): Waiting until backport merges to officially close

"
2331769396,issue,closed,completed,Text in detail viz on public dashboards lacks contrast when using night mode.,"### Describe the bug

The text that appears in detail visualizations is not correctly contrasted when using night mode in public view. However, when using night mode inside Metabase app (as a logged in user) you are able to see the colors correctly 

Night mode inside Metabase as a logged in user:
<img width=""1504"" alt=""Screenshot 2024-06-03 at 1 12 12 PM"" src=""https://github.com/metabase/metabase/assets/17803548/9626a67e-c4a6-4612-814f-db77f78845e6"">

Night mode in public dashboard:
<img width=""1512"" alt=""Screenshot 2024-06-03 at 1 12 27 PM"" src=""https://github.com/metabase/metabase/assets/17803548/b74f6721-b893-40e6-82d8-6b53f2f539f4"">

### To Reproduce

1. Create a question with a detail viz, add it to a dashboard
2. Enable public link
3. Go to the public link
4. Go to full screen
5. Change to night mode


### Expected behavior

It should have the contrast that the logged in user has. 

### Logs

_No response_

### Information about your Metabase installation

```JSON
I replicate this using version v1.49.13, the customer that saw this is in v1.49.13-x01
```


### Severity

Affecting customers

### Additional context

https://sales-demo.metabaseapp.com/public/dashboard/b57086ff-bf23-4612-9116-541e44399147?plan=&date_filter=#theme=night",psalinasy,2024-06-03 18:17:39+00:00,['WiNloSt'],2024-10-08 16:16:57+00:00,2024-08-21 08:24:45+00:00,https://github.com/metabase/metabase/issues/43532,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('Visualization/Detail', 'ObjectDetail'), ('.Team/Embedding', ''), ('Sharing/Public', '')]",[],
2331683373,issue,closed,completed,Can't edit joined tables after saving the question,"### Describe the bug

After saving a question, I can no longer edit the joined table. 

I can add and remove joined tables, but the existing ones aren't editable (can't change from table A to table B). 

At first it seemed like a limitation, however I suspect this is a bug, because if I add a new join (which I can do), and if it pick a wrong join field (which may exists in complex tables) , then I can't correct, and it will use wrong auto picked one.

### To Reproduce

1. Create a new question
2. Add a few joins
3. Save the question
4. Try editing the question changing one of the joins you made. You'll be able to change the left and right column, but you won't be able to change the left and right tables.


[Gravação de tela de 2024-06-03 14-18-38.webm](https://github.com/metabase/metabase/assets/119939906/ec31fe18-a270-4313-9d67-b30f4381f1af)



### Expected behavior

You should be able to edit joined tables.

### Logs

There are no relevant logs in  Troubleshooting -> Logs or in Javascript.

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""pt-BR"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.0-71-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mysql""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MySQL"",
        ""version"": ""8.0.31-0ubuntu0.22.04.1""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-28"",
      ""tag"": ""v0.49.13"",
      ""hash"": ""de28e83""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

It's very annoying, users can't edit a mistake after saving.

### Additional context

_No response_",abcRede,2024-06-03 17:26:30+00:00,[],2024-07-01 22:23:37+00:00,2024-06-24 13:40:22+00:00,https://github.com/metabase/metabase/issues/43531,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Already Fixed', 'will apear in ""Already Fixed"" in the release notes (not ""Bug Fixes"" that we actively fixed)'), ('.Team/Querying', '')]","[{'comment_id': 2186491923, 'issue_id': 2331683373, 'author': 'romeovs', 'body': 'This persists in v49.17 but was fixed with the new data picker in v50 in [this epic](https://github.com/metabase/metabase/issues/40890).', 'created_at': datetime.datetime(2024, 6, 24, 12, 43, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2186611297, 'issue_id': 2331683373, 'author': 'romeovs', 'body': ""@abcRede I'm closing this issue for now, as it is fixed in v50, please reopen if the issue persists."", 'created_at': datetime.datetime(2024, 6, 24, 13, 40, 22, tzinfo=datetime.timezone.utc)}]","romeovs on (2024-06-24 12:43:01 UTC): This persists in v49.17 but was fixed with the new data picker in v50 in [this epic](https://github.com/metabase/metabase/issues/40890).

romeovs on (2024-06-24 13:40:22 UTC): @abcRede I'm closing this issue for now, as it is fixed in v50, please reopen if the issue persists.

"
2331525800,issue,open,,Re-implement the SameSite=None suggestion,"**Context**

We're going to remove it with https://github.com/metabase/metabase/pull/43524 because it's not perfect:
- it suggests to use SameSite=None when on localhost and the authorized origin is localhost on a different port, but that currently is broken because it won't use the Secure attribute
- it fails to parse domains without a protocol or port (new Url(xxx) fails)

This is a task to remember to address it and to be linked in the code as to why we removed it

",npretto,2024-06-03 16:00:18+00:00,[],2024-06-03 16:43:52+00:00,,https://github.com/metabase/metabase/issues/43523,"[('Embedding/Interactive', 'Interactive Embedding, previously known as Full app embedding'), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Embedding', '')]",[],
2331397877,issue,closed,not_planned,Throw an exception if `query->components` finds a column/table that doesn't correspond to a known `Field` or `Table` ,"(although…at least for lineage, we'd probably just swallow the error?)",tsmacdonald,2024-06-03 15:04:21+00:00,['tsmacdonald'],2024-06-05 09:40:15+00:00,2024-06-05 09:40:15+00:00,https://github.com/metabase/metabase/issues/43517,"[('.Backend', ''), ('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2149348574, 'issue_id': 2331397877, 'author': 'tsmacdonald', 'body': ""I'm putting this on ice until I get clearer direction about how the API will be used"", 'created_at': datetime.datetime(2024, 6, 5, 9, 40, 15, tzinfo=datetime.timezone.utc)}]","tsmacdonald (Issue Creator) on (2024-06-05 09:40:15 UTC): I'm putting this on ice until I get clearer direction about how the API will be used

"
2331396771,issue,closed,completed,[ParseSQL] Move native query analysis to EE-only driver code,"EE-only: obvious reasons

driver: so that we don't try to process Mongo/Snowflake/etc. queries. And can set the right Macaw options",tsmacdonald,2024-06-03 15:03:51+00:00,['tsmacdonald'],2024-07-15 12:29:24+00:00,2024-07-15 12:29:24+00:00,https://github.com/metabase/metabase/issues/43516,"[('Querying/Native', 'The SQL/native query editor'), ('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2228390729, 'issue_id': 2331396771, 'author': 'tsmacdonald', 'body': 'This is adequately addressed for now by #44350 and #44976', 'created_at': datetime.datetime(2024, 7, 15, 12, 29, 24, tzinfo=datetime.timezone.utc)}]","tsmacdonald (Issue Creator) on (2024-07-15 12:29:24 UTC): This is adequately addressed for now by #44350 and #44976

"
2331389136,issue,closed,not_planned,Error while adding a new Snowflake connection,"**Describe the bug**
When I try creating a Snowflake connection in my metabase account I have 400 error.  My account is xxxxxxx-xxxxxxx. i just fill the username, password, role and database. 
I've no network policies on the snowflake side. 

**Logs**
```
JDBC driver internal error: exception creating result java.lang.NoClassDefFoundError: Could not initialize class net.snowflake.client.jdbc.internal.apache.arrow.memory.RootAllocator at net.snowflake.client.jdbc.SnowflakeResultSetSerializableV1.create(SnowflakeResultSetSerializableV1
```

**To Reproduce**
Steps to reproduce the behavior:
1. Go to `admin/databases/create`

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""fr-FR"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""17.0.7+7"",
    ""java.vendor"": ""N/A"",
    ""java.vendor.url"": ""https://openjdk.java.net/"",
    ""java.version"": ""17.0.7"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""17.0.7+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.4.0-121-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Etc/UTC""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""hosting-env"": ""heroku"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""13.7 (Debian 13.7-1.pgdg90+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.5.4""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2023-12-01"",
      ""tag"": ""v0.47.9"",
      ""branch"": ""?"",
      ""hash"": ""d05b06e""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```",rcourivaud,2024-06-03 15:00:42+00:00,[],2024-06-10 09:06:46+00:00,2024-06-05 15:00:06+00:00,https://github.com/metabase/metabase/issues/43515,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2145561553, 'issue_id': 2331389136, 'author': 'paoliniluis', 'body': 'this is new, do you use any custom built metabase instance?', 'created_at': datetime.datetime(2024, 6, 3, 15, 50, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2146769127, 'issue_id': 2331389136, 'author': 'rcourivaud', 'body': 'We are using Scalingo IaaS : https://scalingo.com/.\r\nAnd the buildpack for Metabase : https://github.com/Scalingo/metabase-scalingo\r\n\r\nThe buildpack has not changed since last year.', 'created_at': datetime.datetime(2024, 6, 4, 7, 8, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2150294469, 'issue_id': 2331389136, 'author': 'paoliniluis', 'body': 'well... then you need to upgrade that first. Scalingo seems to be cloning heroku so ask the scalingo team to move to the newest metabase version as the bug has been fixed already in the newest versions of metabase', 'created_at': datetime.datetime(2024, 6, 5, 15, 0, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2157776909, 'issue_id': 2331389136, 'author': 'rcourivaud', 'body': ""Hello @paoliniluis, I've the same error on the last version of Metabase."", 'created_at': datetime.datetime(2024, 6, 10, 9, 6, 45, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-03 15:50:44 UTC): this is new, do you use any custom built metabase instance?

rcourivaud (Issue Creator) on (2024-06-04 07:08:14 UTC): We are using Scalingo IaaS : https://scalingo.com/.
And the buildpack for Metabase : https://github.com/Scalingo/metabase-scalingo

The buildpack has not changed since last year.

paoliniluis on (2024-06-05 15:00:06 UTC): well... then you need to upgrade that first. Scalingo seems to be cloning heroku so ask the scalingo team to move to the newest metabase version as the bug has been fixed already in the newest versions of metabase

rcourivaud (Issue Creator) on (2024-06-10 09:06:45 UTC): Hello @paoliniluis, I've the same error on the last version of Metabase.

"
2331382604,issue,closed,not_planned,Subscription images do not match dashboard format,"### Describe the bug

Some aspects of formatting are lost in subscription images (both over Slack and Email)

### To Reproduce

1. Create a question and summarize it by two fields (e.g. month and country/state)
2. Use stacked bars to visualize the question, save it and add it to a dashboard
3. Send the dashboard over slack or email
4. The resulting graph isn't stacked

This is one example, but the issue seems to happen to basically any visualization setting that's not the default for the chart time. Map location for instance simply results in a table.


### Expected behavior

sent images should be identical to what the dashboard shows

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Browser: Arc Version 1.44.2 (50412), Chromium Engine Version 125.0.6422.112
- MacBook Pro M1, 14.4.1 (23E224)
- Postgres internal, any external database
- self hosted, version v0.49.13, Built on 2024-05-28
```


### Severity

Annoying

### Additional context

_No response_",matanzg,2024-06-03 14:57:54+00:00,[],2024-06-03 14:59:03+00:00,2024-06-03 14:59:03+00:00,https://github.com/metabase/metabase/issues/43513,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2145423452, 'issue_id': 2331382604, 'author': 'paoliniluis', 'body': ""This is coming in v50, please check how does it look in v50-RC1 (don't use that in production)"", 'created_at': datetime.datetime(2024, 6, 3, 14, 59, 3, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-03 14:59:03 UTC): This is coming in v50, please check how does it look in v50-RC1 (don't use that in production)

"
2331353688,issue,open,,Debug mode in serialization,"**Is your feature request related to a problem? Please describe.**
The current serialization feature exposes the entire stack trace when it should just send a single log line with an error if any

**Describe the solution you'd like**
Make the current serialization only to log the first line of the error and not the entire stack trace. Also add a --debug flag that will dump the entire stack trace if there's an error

**Describe alternatives you've considered**
NA

**How important is this feature to you?**
Will greatly simplify the debugging in serialization

**Additional context**
NA
",paoliniluis,2024-06-03 14:45:18+00:00,[],2024-06-03 14:47:34+00:00,,https://github.com/metabase/metabase/issues/43510,"[('Type:New Feature', ''), ('.Backend', ''), ('Operation/Serialization', 'Enterprise contents migration')]",[],
2331305747,issue,closed,completed,Batch fetch card__id table metadata,Batch load cards in `/api/dashboard/:id/query_metadata`.,metamben,2024-06-03 14:26:54+00:00,['metamben'],2024-06-10 20:48:43+00:00,2024-06-06 15:04:47+00:00,https://github.com/metabase/metabase/issues/43509,[],[],
2331252619,issue,closed,completed,Consolidate e2e Repro Specs,"There is significant (4-6 second) setup overhead in separate test files in CI. combining dozens of reproduction specs that all have 1 or 2 tests, provides several minutes of CI savings in many cases

We should consolidate all of these, even when there are only a couple offenders to eliminate the pattern from the codebase and to keep it from continuing.

```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/pull/43328
- [ ] https://github.com/metabase/metabase/pull/43342
- [ ] https://github.com/metabase/metabase/pull/43271
- [ ] https://github.com/metabase/metabase/pull/43519
- [ ] https://github.com/metabase/metabase/pull/43619
- [ ] https://github.com/metabase/metabase/pull/43514
- [ ] https://github.com/metabase/metabase/pull/43527
- [ ] https://github.com/metabase/metabase/pull/43552
- [ ] https://github.com/metabase/metabase/pull/43616
- [ ] https://github.com/metabase/metabase/pull/43613
- [ ] https://github.com/metabase/metabase/pull/43717
- [ ] https://github.com/metabase/metabase/pull/43716
- [ ] https://github.com/metabase/metabase/pull/43718
- [ ] https://github.com/metabase/metabase/pull/43844
- [ ] https://github.com/metabase/metabase/pull/43843
- [ ] https://github.com/metabase/metabase/pull/43841
- [ ] https://github.com/metabase/metabase/pull/43846
- [ ] https://github.com/metabase/metabase/pull/43853
- [ ] onboarding
- [ ] binning
```
",iethree,2024-06-03 14:05:32+00:00,[],2025-01-17 20:29:46+00:00,2025-01-03 16:55:34+00:00,https://github.com/metabase/metabase/issues/43505,[],"[{'comment_id': 2231179255, 'issue_id': 2331252619, 'author': 'iethree', 'body': ""One down side to this project is that some developers find working with large files to be rather cumbersome.\r\n\r\nOne alternative approach suggested by @romeovs is keeping test files small, but running them via imports into larger files, which should solve  the performance problem.\r\n\r\nsee [discussion](https://metaboat.slack.com/archives/C0669P4AF9N/p1719825667882659) and proof of concept PR:\r\n- https://github.com/metabase/metabase/pull/44889\r\n\r\nOne open question: \r\n- Do most developers find large files hard to work with?\r\n\r\nOne blocker: \r\n- we need a linter that can ensure that all spec files are imported into runner files so that we don't end up with orphan spec files that never get run."", 'created_at': datetime.datetime(2024, 7, 16, 15, 11, 35, tzinfo=datetime.timezone.utc)}]","iethree (Issue Creator) on (2024-07-16 15:11:35 UTC): One down side to this project is that some developers find working with large files to be rather cumbersome.

One alternative approach suggested by @romeovs is keeping test files small, but running them via imports into larger files, which should solve  the performance problem.

see [discussion](https://metaboat.slack.com/archives/C0669P4AF9N/p1719825667882659) and proof of concept PR:
- https://github.com/metabase/metabase/pull/44889

One open question: 
- Do most developers find large files hard to work with?

One blocker: 
- we need a linter that can ensure that all spec files are imported into runner files so that we don't end up with orphan spec files that never get run.

"
2331237414,issue,closed,completed,Release From already-built test jars,"We already build production-ready jars for testing on our release branches, we can release faster and with more confidence in the release artifact if, instead of building new jars, we tag these existing jars at release time.

[Proof of concept
](https://github.com/iethree/metabase/actions/runs/9322372854)

> [!NOTE] 
> we can't get rid of the build-from-commit job completely for two reasons: (1) github artifacts have a limited life, so if we want to release from a commit that is more than a week old (rare, but it'll happen), we'll need to build a fresh jar, or (2) if the test jar isn't built yet, and we want to start the release process in parallel with the release-branch testing

",iethree,2024-06-03 13:59:10+00:00,['iethree'],2024-10-08 17:09:18+00:00,2024-06-04 21:29:57+00:00,https://github.com/metabase/metabase/issues/43504,"[('.Building & Releasing', '')]",[],
2331218107,issue,open,,Serialization validator,"**Is your feature request related to a problem? Please describe.**
There are customers with massive bundles, we shoud have a tool that validates that a bundle is healthy (all deps are fine).

**Describe the solution you'd like**
A tool that checks for healthyness of a bundle to check before the import

**Describe alternatives you've considered**
None

**How important is this feature to you?**
We're hitting issues from many customers that use serialization that don't know/can't find why an import fails

**Additional context**
NA
",paoliniluis,2024-06-03 13:50:59+00:00,[],2024-06-03 22:02:20+00:00,,https://github.com/metabase/metabase/issues/43502,"[('Type:New Feature', ''), ('Operation/Serialization', 'Enterprise contents migration')]","[{'comment_id': 2146202058, 'issue_id': 2331218107, 'author': 'likeshumidity', 'body': ""I have used [JSON Schema](https://json-schema.org/) and [ajv](https://ajv.js.org/) before and really liked them. Would love it if we documented Serialization, X-ray resources, and API calls using it, because it makes it easy to add to OpenAPI spec, it's human readable, and it is mature (i.e. featureful and well-documented).\r\n\r\nRelated resources:\r\n- JSON Schema\r\n  - https://json-schema.org/\r\n- Clojure JSON Schema Validator & Generator\r\n  - https://github.com/luposlip/json-schema\r\n- Node.js JSON Schema validation with AJV\r\n  - https://ajv.js.org/\r\n  - https://www.npmjs.com/package/ajv-cli\r\n  - https://www.npmjs.com/package/pajv\r\n- JSON Schema with YAML files\r\n  - https://asdf-standard.readthedocs.io/en/1.0.3/schemas/yaml_schema.html\r\n  - https://json-schema-everywhere.github.io/yaml"", 'created_at': datetime.datetime(2024, 6, 3, 22, 2, 19, tzinfo=datetime.timezone.utc)}]","likeshumidity on (2024-06-03 22:02:19 UTC): I have used [JSON Schema](https://json-schema.org/) and [ajv](https://ajv.js.org/) before and really liked them. Would love it if we documented Serialization, X-ray resources, and API calls using it, because it makes it easy to add to OpenAPI spec, it's human readable, and it is mature (i.e. featureful and well-documented).

Related resources:
- JSON Schema
  - https://json-schema.org/
- Clojure JSON Schema Validator & Generator
  - https://github.com/luposlip/json-schema
- Node.js JSON Schema validation with AJV
  - https://ajv.js.org/
  - https://www.npmjs.com/package/ajv-cli
  - https://www.npmjs.com/package/pajv
- JSON Schema with YAML files
  - https://asdf-standard.readthedocs.io/en/1.0.3/schemas/yaml_schema.html
  - https://json-schema-everywhere.github.io/yaml

"
2331170970,issue,open,,"Athena question hangs on ""waiting for results"" for empty result sets due to ""Error reducing result rows: null""","### Describe the bug

Any metabase Question for athena that returns no results hangs in the /dataset request due to the following exception.  The same SQL query works fine in metabase correctly displaying ""No results!"" although it does take a surprising amount of time to say that:  the query runtime was 41s according to athena but metabase log says POST /api/dataset 202 [ASYNC: completed] 1.4 mins

  {:status :failed,
   :class clojure.lang.ExceptionInfo,
   :error ""Error reducing result rows: null"",
   :stacktrace
   [""--> query_processor.context.default$default_reducef$fn__50585.invoke(default.clj:36)""
    ""query_processor.context.default$default_reducef.invokeStatic(default.clj:33)""
    ""query_processor.context.default$default_reducef.invoke(default.clj:25)""
    ""query_processor.context$reducef.invokeStatic(context.clj:70)""
    ""query_processor.context$reducef.invoke(context.clj:63)""
    ""query_processor.context.default$default_runf$respond_STAR___50589.invoke(default.clj:45)""
    ""driver.sql_jdbc.execute$execute_reducible_query$fn__79512.invoke(execute.clj:710)""
    ""driver.sql_jdbc.execute$fn__79305$fn__79306.invoke(execute.clj:389)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:335)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:318)""
    ""driver.sql_jdbc.execute$fn__79305.invokeStatic(execute.clj:383)""
    ""driver.sql_jdbc.execute$fn__79305.invoke(execute.clj:381)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:693)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:690)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:679)""
    ""driver.sql_jdbc$fn__106894.invokeStatic(sql_jdbc.clj:78)""
    ""driver.sql_jdbc$fn__106894.invoke(sql_jdbc.clj:76)""
    ""driver.athena$fn__125392.invokeStatic(athena.clj:445)""
    ""driver.athena$fn__125392.invoke(athena.clj:443)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72328.invoke(cache.clj:229)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66677.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72149.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72159.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71591.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73496$combined_post_process__73501$combined_post_process_STAR___73502.invoke(query_processor.clj:262)""
    ""query_processor$fn__73496$combined_pre_process__73497$combined_pre_process_STAR___73498.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66774.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239$fn__72243.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72239.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67401$fn__67402.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67401.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72236.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72541.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__72176$handle_audit_app_internal_queries__72177$fn__72179.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72187.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71302.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72472.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__73073.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62893$thunk__62895.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62893.invoke(reducible.clj:132)""
    ""query_processor.reducible$sync_qp$qp_STAR___62905.doInvoke(reducible.clj:153)""
    ""query_processor$process_userland_query.invokeStatic(query_processor.clj:402)""
    ""query_processor$process_userland_query.doInvoke(query_processor.clj:398)""
    ""query_processor$process_query_and_save_execution_BANG_.invokeStatic(query_processor.clj:416)""
    ""query_processor$process_query_and_save_execution_BANG_.invoke(query_processor.clj:406)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invokeStatic(query_processor.clj:431)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invoke(query_processor.clj:421)""
    ""api.dataset$run_query_async$fn__93985.invoke(dataset.clj:79)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53319$fn__53321.invoke(streaming.clj:168)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53319.invoke(streaming.clj:167)""
    ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)""
    ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)""
    ""async.streaming_response$do_f_async$task__43774.invoke(streaming_response.clj:88)""],


### To Reproduce

1. Construct athena metabase Question that returns no results
2. Run it


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Metabase 0.49.13
- AWS Athena engine version 3
- OS X Safari
```


### Severity

blocking some users

### Additional context

_No response_",ericcj,2024-06-03 13:31:14+00:00,[],2025-02-04 20:27:56+00:00,,https://github.com/metabase/metabase/issues/43501,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Processor', ''), ('.Backend', ''), ('Database/Athena', ''), ('.Team/Drivers', '')]","[{'comment_id': 2145403941, 'issue_id': 2331170970, 'author': 'paoliniluis', 'body': '@ericcj nice find, any quick athena select statement that you can send to make it return zero rows?', 'created_at': datetime.datetime(2024, 6, 3, 14, 50, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2145762646, 'issue_id': 2331170970, 'author': 'ericcj', 'body': ""it can't be a sql query since those work it has to be a simple question so any filter that you know is impossible would reproduce it i think"", 'created_at': datetime.datetime(2024, 6, 3, 17, 31, 41, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-03 14:50:46 UTC): @ericcj nice find, any quick athena select statement that you can send to make it return zero rows?

ericcj (Issue Creator) on (2024-06-03 17:31:41 UTC): it can't be a sql query since those work it has to be a simple question so any filter that you know is impossible would reproduce it i think

"
2331054194,issue,closed,completed,[Databricks] Make the driver testable in CI,"```[tasklist]
### Tasks
- [x] Make data loading code work
- [x] Create a CI job
```
",lbrdnk,2024-06-03 12:40:38+00:00,['lbrdnk'],2024-06-12 18:31:36+00:00,2024-06-12 18:31:35+00:00,https://github.com/metabase/metabase/issues/43497,"[('.CI & Tests', ''), ('.Backend', ''), ('Database/Databricks', '')]","[{'comment_id': 2163667633, 'issue_id': 2331054194, 'author': 'lbrdnk', 'body': 'Closing as implementation with Databricks CI job is in [databricks-hive-like](https://github.com/metabase/metabase/tree/databricks-hive-like) branch.', 'created_at': datetime.datetime(2024, 6, 12, 18, 31, 36, tzinfo=datetime.timezone.utc)}]","lbrdnk (Issue Creator) on (2024-06-12 18:31:36 UTC): Closing as implementation with Databricks CI job is in [databricks-hive-like](https://github.com/metabase/metabase/tree/databricks-hive-like) branch.

"
2330938677,issue,closed,completed,Improve the Trash data model,"As discussed here:

https://www.notion.so/metabase/Outstanding-Issues-with-the-Trash-0be395258ee74c058dd3df79bf93a5d7?showMoveTo=true&saveParent=true

The short version: with the advent of the Trash, we have separated the concept of ""where is this item located in the collection hierarchy"" into two parts:

- where do we display the item?, and
- what collection determines whether someone has permission to view/modify an item?

This used to be one thing, but for the Trash, it's two: we need to display the item in the Trash, but permissions are still determined by the location an item used to be in.

My initial implementation used the existing infrastructure (`dashboard.collection_id`, `card.collection_id`, `collection.location`) to determine where we display an item, while adding new columns (`dashboard.trashed_from_collection_id`, `collection.trashed_from_location`) used to check permissions.

But: it's a lower risk change to use the existing infrastructure to check *permissions* (because permissions matter more), while adding new columns to figure out where to display an item. As discussed in the document above, it also neatly avoids some issues that cropped up with our initial testing of the Trash (pagination, the difficulty of migrating existing `archived` items to the Trash, and easy pagination).

I've started implementing this in #42845 ",johnswanson,2024-06-03 11:49:36+00:00,['johnswanson'],2024-10-08 17:08:06+00:00,2024-06-11 15:31:16+00:00,https://github.com/metabase/metabase/issues/43494,[],[],
2330512544,issue,closed,not_planned,Docker container startup fail ,"### Describe the bug

2024-06-03 08:25:08,976 INFO metabase.plugins :: Loading plugins in /plugins...
2024-06-03 13:55:09 2024-06-03 08:25:09,101 INFO util.files :: Extract file /modules/sparksql.metabase-driver.jar -> /plugins/sparksql.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,171 INFO util.files :: Extract file /modules/sqlserver.metabase-driver.jar -> /plugins/sqlserver.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,180 INFO util.files :: Extract file /modules/snowflake.metabase-driver.jar -> /plugins/snowflake.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,476 INFO util.files :: Extract file /modules/mongo.metabase-driver.jar -> /plugins/mongo.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,491 INFO util.files :: Extract file /modules/oracle.metabase-driver.jar -> /plugins/oracle.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,492 INFO util.files :: Extract file /modules/googleanalytics.metabase-driver.jar -> /plugins/googleanalytics.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,502 INFO util.files :: Extract file /modules/athena.metabase-driver.jar -> /plugins/athena.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,564 INFO util.files :: Extract file /modules/redshift.metabase-driver.jar -> /plugins/redshift.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,569 INFO util.files :: Extract file /modules/presto-jdbc.metabase-driver.jar -> /plugins/presto-jdbc.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,614 INFO util.files :: Extract file /modules/bigquery-cloud-sdk.metabase-driver.jar -> /plugins/bigquery-cloud-sdk.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,741 INFO util.files :: Extract file /modules/druid.metabase-driver.jar -> /plugins/druid.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,744 INFO util.files :: Extract file /modules/vertica.metabase-driver.jar -> /plugins/vertica.metabase-driver.jar
2024-06-03 13:55:09 2024-06-03 08:25:09,745 INFO util.files :: Extract file /modules/sqlite.metabase-driver.jar -> /plugins/sqlite.metabase-driver.jar
2024-06-03 13:55:09 #
2024-06-03 13:55:09 # A fatal error has been detected by the Java Runtime Environment:
2024-06-03 13:55:09 #
2024-06-03 13:55:09 #  SIGSEGV (0xb) at pc=0x00007ffffec1b072, pid=1, tid=24
2024-06-03 13:55:09 #
2024-06-03 13:55:09 # JRE version: OpenJDK Runtime Environment Temurin-11.0.23+9 (11.0.23+9) (build 11.0.23+9)
2024-06-03 13:55:09 # Java VM: OpenJDK 64-Bit Server VM Temurin-11.0.23+9 (11.0.23+9, mixed mode, tiered, compressed oops, g1 gc, linux-amd64)
2024-06-03 13:55:09 # Problematic frame:
2024-06-03 13:55:09 # V  [libjvm.so+0x7ce072]  G1ParScanThreadState::copy_to_survivor_space(InCSetState, oopDesc*, markOopDesc*)+0x42
2024-06-03 13:55:09 #
2024-06-03 13:55:09 # No core dump will be written. Core dumps have been disabled. To enable core dumping, try ""ulimit -c unlimited"" before starting Java again
2024-06-03 13:55:09 #
2024-06-03 13:55:09 # An error report file with more information is saved as:
2024-06-03 13:55:09 # /tmp/hs_err_pid1.log
2024-06-03 13:55:09 #
2024-06-03 13:55:09 # If you would like to submit a bug report, please visit:
2024-06-03 13:55:09 #   https://github.com/adoptium/adoptium-support/issues
2024-06-03 13:55:09 #


### To Reproduce

```
version: '3.9'
services:
  metabase:
    image: metabase/metabase:latest
    container_name: metabase
    hostname: metabase
    volumes:
    - /dev/urandom:/dev/random:ro
    ports:
      - 3000:3000
    environment:
      MB_DB_TYPE: postgres
      MB_DB_DBNAME: metabaseappdb
      MB_DB_PORT: 5432
      MB_DB_USER: metabase
      MB_DB_PASS: mysecretpassword
      MB_DB_HOST: postgres
    networks:
      - metanet1
    healthcheck:
      test: curl --fail -I http://localhost:3000/api/health || exit 1
      interval: 15s
      timeout: 5s
      retries: 5
  postgres:
    image: postgres:latest
    container_name: postgres
    hostname: postgres
    environment:
      POSTGRES_USER: metabase
      POSTGRES_DB: metabaseappdb
      POSTGRES_PASSWORD: mysecretpassword
    networks:
      - metanet1
networks:
  metanet1:
    driver: bridge
```
```docker compose up```


### Expected behavior

On localhost:3000 general Metabsee UI should be visbile 

### Logs

_No response_

### Information about your Metabase installation

```JSON
version: '3.9'
services:
  metabase:
    image: metabase/metabase:latest
    container_name: metabase
    hostname: metabase
    volumes:
    - /dev/urandom:/dev/random:ro
    ports:
      - 3000:3000
    environment:
      MB_DB_TYPE: postgres
      MB_DB_DBNAME: metabaseappdb
      MB_DB_PORT: 5432
      MB_DB_USER: metabase
      MB_DB_PASS: mysecretpassword
      MB_DB_HOST: postgres
    networks:
      - metanet1
    healthcheck:
      test: curl --fail -I http://localhost:3000/api/health || exit 1
      interval: 15s
      timeout: 5s
      retries: 5
  postgres:
    image: postgres:latest
    container_name: postgres
    hostname: postgres
    environment:
      POSTGRES_USER: metabase
      POSTGRES_DB: metabaseappdb
      POSTGRES_PASSWORD: mysecretpassword
    networks:
      - metanet1
networks:
  metanet1:
    driver: bridge
```
```


### Severity

Blocker for docker image user

### Additional context

_No response_",Arjxm,2024-06-03 08:30:58+00:00,[],2024-06-11 08:14:58+00:00,2024-06-03 12:08:45+00:00,https://github.com/metabase/metabase/issues/43488,"[('Type:Bug', 'Product defects'), ('Operation/Docker', ''), ('.Needs Triage', '')]","[{'comment_id': 2144804371, 'issue_id': 2330512544, 'author': 'paoliniluis', 'body': 'Please send your computer specs', 'created_at': datetime.datetime(2024, 6, 3, 10, 7, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2144914376, 'issue_id': 2330512544, 'author': 'Arjxm', 'body': 'Apple M2 \r\n16 GB RAM', 'created_at': datetime.datetime(2024, 6, 3, 11, 5, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2145030310, 'issue_id': 2330512544, 'author': 'paoliniluis', 'body': ""you have an outdated docker installation or the installation is not using Rosetta well. If you can't make it work, try Colima"", 'created_at': datetime.datetime(2024, 6, 3, 12, 8, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2145035782, 'issue_id': 2330512544, 'author': 'Arjxm', 'body': 'Thanks', 'created_at': datetime.datetime(2024, 6, 3, 12, 11, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2145307099, 'issue_id': 2330512544, 'author': 'Tony-metabase', 'body': '@Arjxm I have been looking online and it seems to be an odd combo of [mac and sonoma](https://github.com/docker/for-mac/issues/7006) ... but it seems this version of [docker desktop](https://docs.docker.com/desktop/release-notes/#4272) is fine. Can you try downgrading and see what happens?', 'created_at': datetime.datetime(2024, 6, 3, 14, 11, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2158723713, 'issue_id': 2330512544, 'author': 'Arjxm', 'body': 'okay let me check', 'created_at': datetime.datetime(2024, 6, 10, 15, 49, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2160081769, 'issue_id': 2330512544, 'author': 'Arjxm', 'body': '@Tony-metabase Well, its working for me', 'created_at': datetime.datetime(2024, 6, 11, 8, 14, 58, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-06-03 10:07:46 UTC): Please send your computer specs

Arjxm (Issue Creator) on (2024-06-03 11:05:45 UTC): Apple M2 
16 GB RAM

paoliniluis on (2024-06-03 12:08:45 UTC): you have an outdated docker installation or the installation is not using Rosetta well. If you can't make it work, try Colima

Arjxm (Issue Creator) on (2024-06-03 12:11:25 UTC): Thanks

Tony-metabase on (2024-06-03 14:11:26 UTC): @Arjxm I have been looking online and it seems to be an odd combo of [mac and sonoma](https://github.com/docker/for-mac/issues/7006) ... but it seems this version of [docker desktop](https://docs.docker.com/desktop/release-notes/#4272) is fine. Can you try downgrading and see what happens?

Arjxm (Issue Creator) on (2024-06-10 15:49:46 UTC): okay let me check

Arjxm (Issue Creator) on (2024-06-11 08:14:58 UTC): @Tony-metabase Well, its working for me

"
2328656241,issue,closed,completed,Command Palette Icon Tweaks,"- [x] Add color to icons (similar to entity picker) (see #43161)
- [x] [Top-align icons when text is multiline](https://metaboat.slack.com/archives/C064EB1UE5P/p1717192115461349?thread_ts=1716585720.474239&cid=C064EB1UE5P)
- [x] [single-line icon alignment](https://metaboat.slack.com/archives/C064EB1UE5P/p1716499215070839?thread_ts=1716484925.374579&cid=C064EB1UE5P)
",iethree,2024-05-31 22:18:05+00:00,['npfitz'],2024-06-09 20:08:35+00:00,2024-06-09 16:14:11+00:00,https://github.com/metabase/metabase/issues/43475,"[('Organization/Search', ''), ('.Frontend', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2328655156,issue,open,,Percentage format is not retained within Questions,"### Describe the bug

The percentage format is not retained when using a combination of Snowflake database, CTE/subqueries, and Number variable types. 
Still doing some testing but this combination seems to trigger the issue.

Happening in 1.49.13 and 50RC1.




### To Reproduce

1.  Create a question using SQL

```
 SELECT
   AVG(L_QUANTITY) AS avg_quantity
 FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
 WHERE L_QUANTITY > {{goal}}
```
<img width=""1447"" alt=""1"" src=""https://github.com/metabase/metabase/assets/17398657/522906e4-19bd-457b-aed7-8afd135904ea"">

<br>

Change the Style to Percent and things work as expected
<img width=""414"" alt=""5"" src=""https://github.com/metabase/metabase/assets/17398657/46935c24-2a82-4769-a655-e543eea0a0e7"">


2. Now use a query like the following
```
WITH mybase AS (
 SELECT
   L_LINENUMBER,
   L_SUPPKEY,
   SUM(L_QUANTITY) AS quantity_sum
 FROM SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.LINEITEM
 GROUP BY 1, 2
 )

SELECT
 AVG(quantity_sum) / nullif({{ goal }}, 0)
FROM mybase
```
<br>

Use a Number variable type and change style to Percent and we should still be good.

<img width=""1447"" alt=""2"" src=""https://github.com/metabase/metabase/assets/17398657/2f740966-9bd1-41a4-b484-281a9c86f707"">

<br>
<br>

3. Change the value in ""Goal"" and notice the percent style resets to Normal
<img width=""1447"" alt=""3"" src=""https://github.com/metabase/metabase/assets/17398657/44925b07-367c-4b82-9804-51e702fbf7fa"">

<br>
<br>


You can go back and adjust the style but it will only keep the style value for the item that already been used in the “Goal” filter.
If you view the metadata via JSON for the question, you’ll see individual entries for each ""Goal"" value that has been adjusted to Percent.

<br>

```
""visualization_settings"": {
        ""column_settings"": {
            ""[\""name\"",\""AVG(QUANTITY_SUM) / NULLIF(58, 0)\""]"": {
                ""number_style"": ""percent""
            },
            ""[\""name\"",\""AVG(QUANTITY_SUM) / NULLIF(54, 0)\""]"": {
                ""number_style"": ""percent""
            },
            ""[\""name\"",\""AVG(QUANTITY_SUM) / NULLIF(87, 0)\""]"": {
                ""number_style"": ""percent""
            },
            ""[\""name\"",\""AVG(QUANTITY_SUM) / NULLIF(65, 0)\""]"": {
                ""number_style"": ""percent""
            },
            ""[\""name\"",\""AVG(QUANTITY_SUM) / ?\""]"": {
                ""number_style"": ""percent""
            },
            ""[\""name\"",\""AVG(QUANTITY_SUM) / NULLIF(23, 0)\""]"": {
                ""number_style"": ""percent""
            },
            ""[\""name\"",\""AVG(QUANTITY_SUM) / NULLIF(?, 0 )\""]"": {
                ""number_style"": ""percent""
            },
            ""[\""name\"",\""AVG(QUANTITY_SUM) / NULLIF(76, 0)\""]"": {
                ""number_style"": ""percent""
            },
            ""[\""name\"",\""AVG(QUANTITY_SUM) / NULLIF(?, 0)\""]"": {
                ""number_style"": ""percent""
            },
            ""[\""name\"",\""AVG(QUANTITY_SUM) / NULLIF(435, 0)\""]"": {
                ""number_style"": ""percent""
            },
            ""[\""name\"",\""AVG_QUANTITY\""]"": {
                ""number_style"": ""percent""
            }
        }
    },
```

<br>

4. The last bit of this is if you change this to Text variable type, it works as expected. 
Meaning, the percent style remains intact regardless of the value in ""Goal"", and individual visualization records aren't written to the question's metadata.

<img width=""1447"" alt=""4"" src=""https://github.com/metabase/metabase/assets/17398657/c08d7a68-aea2-477e-aa88-b8bf522bda45"">

<br>
<br>

This doesn’t happen in Postgres with a similar type query. The Percent style remains and individual entries aren’t stored within the metadata. I haven't tested this in any other SQL engine.

```
WITH player_cte AS (
 SELECT 
  player_name,
  team_name,
  SUM(fgm) AS field_goals
 FROM season_gamelog
 GROUP BY 1, 2
 )
 
 SELECT
   AVG(field_goals) / nullif({{ goal }}, 0)
 FROM player_cte
```








### Expected behavior

For the percentage style to always be present if selected.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.216-204.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mongo"",
      ""postgres"",
      ""snowflake"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-28"",
      ""tag"": ""v1.49.13"",
      ""hash"": ""de28e83""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3 - Keeping consistency with visualizations

### Additional context

_No response_",FilmonK,2024-05-31 22:16:50+00:00,[],2025-02-05 14:54:39+00:00,,https://github.com/metabase/metabase/issues/43474,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Database/Snowflake', ''), ('Customization/Formatting', ''), ('.Frontend', ''), ('Visualization/Scalars', 'Numbers, progress bars, gauges'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2328522096,issue,closed,completed,`mt/with-dynamic-redefs` stack overflows if you try to nest it,"Ran into this today IRL, I needed to update `metabase.upload-test/create-csv-upload!-schema-test` to only redef `future-call` inside of `upload/scan-and-sync-table!` and it caused a stack overflow. Replacing `mt/with-dynamic-redefs` with normal `with-redefs` fixed the issue.

Here's a simpler reproduction for the issue

```clj
(defn y []
  :y)

(defn x []
  (y))

(defn z []
  (mt/with-dynamic-redefs [x
                           (let [orig x]
                             (fn []
                               (mt/with-dynamic-redefs [y (constantly :redef)]
                                 (orig))))]
    (x)))

(z)

;; =>
1. Unhandled java.lang.StackOverflowError
   (No message)

                   RT.java: 1609  clojure.lang.RT/vector
                Tuple.java:   24  clojure.lang.Tuple/create
           upload_test.clj:  880  metabase.upload-test/z/fn
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
                  AFn.java:  144  clojure.lang.AFn/applyTo
                  core.clj:  667  clojure.core/apply
                  core.clj:  662  clojure.core/apply
        dynamic_redefs.clj:   22  metabase.test.util.dynamic-redefs/var->proxy/fn
               RestFn.java:  397  clojure.lang.RestFn/invoke
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
               RestFn.java:  132  clojure.lang.RestFn/applyTo
            AFunction.java:   31  clojure.lang.AFunction$1/doInvoke
               RestFn.java:  397  clojure.lang.RestFn/invoke
           upload_test.clj:  881  metabase.upload-test/z/fn
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
                  AFn.java:  144  clojure.lang.AFn/applyTo
                  core.clj:  667  clojure.core/apply
                  core.clj:  662  clojure.core/apply
        dynamic_redefs.clj:   22  metabase.test.util.dynamic-redefs/var->proxy/fn
               RestFn.java:  397  clojure.lang.RestFn/invoke
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
               RestFn.java:  132  clojure.lang.RestFn/applyTo
            AFunction.java:   31  clojure.lang.AFunction$1/doInvoke
               RestFn.java:  397  clojure.lang.RestFn/invoke
           upload_test.clj:  881  metabase.upload-test/z/fn
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
                  AFn.java:  144  clojure.lang.AFn/applyTo
                  core.clj:  667  clojure.core/apply
                  core.clj:  662  clojure.core/apply
        dynamic_redefs.clj:   22  metabase.test.util.dynamic-redefs/var->proxy/fn
               RestFn.java:  397  clojure.lang.RestFn/invoke
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
               RestFn.java:  132  clojure.lang.RestFn/applyTo
            AFunction.java:   31  clojure.lang.AFunction$1/doInvoke
               RestFn.java:  397  clojure.lang.RestFn/invoke
           upload_test.clj:  881  metabase.upload-test/z/fn
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
                  AFn.java:  144  clojure.lang.AFn/applyTo
                  core.clj:  667  clojure.core/apply
                  core.clj:  662  clojure.core/apply
        dynamic_redefs.clj:   22  metabase.test.util.dynamic-redefs/var->proxy/fn
               RestFn.java:  397  clojure.lang.RestFn/invoke
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
               RestFn.java:  132  clojure.lang.RestFn/applyTo
            AFunction.java:   31  clojure.lang.AFunction$1/doInvoke
               RestFn.java:  397  clojure.lang.RestFn/invoke
           upload_test.clj:  881  metabase.upload-test/z/fn
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
                  AFn.java:  144  clojure.lang.AFn/applyTo
                  core.clj:  667  clojure.core/apply
                  core.clj:  662  clojure.core/apply
        dynamic_redefs.clj:   22  metabase.test.util.dynamic-redefs/var->proxy/fn
               RestFn.java:  397  clojure.lang.RestFn/invoke
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
               RestFn.java:  132  clojure.lang.RestFn/applyTo
            AFunction.java:   31  clojure.lang.AFunction$1/doInvoke
               RestFn.java:  397  clojure.lang.RestFn/invoke
           upload_test.clj:  881  metabase.upload-test/z/fn
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
                  AFn.java:  144  clojure.lang.AFn/applyTo
                  core.clj:  667  clojure.core/apply
                  core.clj:  662  clojure.core/apply
        dynamic_redefs.clj:   22  metabase.test.util.dynamic-redefs/var->proxy/fn
               RestFn.java:  397  clojure.lang.RestFn/invoke
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
               RestFn.java:  132  clojure.lang.RestFn/applyTo
            AFunction.java:   31  clojure.lang.AFunction$1/doInvoke
               RestFn.java:  397  clojure.lang.RestFn/invoke
           upload_test.clj:  881  metabase.upload-test/z/fn
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
                  AFn.java:  144  clojure.lang.AFn/applyTo
                  core.clj:  667  clojure.core/apply
                  core.clj:  662  clojure.core/apply
        dynamic_redefs.clj:   22  metabase.test.util.dynamic-redefs/var->proxy/fn
               RestFn.java:  397  clojure.lang.RestFn/invoke
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
               RestFn.java:  132  clojure.lang.RestFn/applyTo
            AFunction.java:   31  clojure.lang.AFunction$1/doInvoke
               RestFn.java:  397  clojure.lang.RestFn/invoke
           upload_test.clj:  881  metabase.upload-test/z/fn
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
                  AFn.java:  144  clojure.lang.AFn/applyTo
                  core.clj:  667  clojure.core/apply
                  core.clj:  662  clojure.core/apply
        dynamic_redefs.clj:   22  metabase.test.util.dynamic-redefs/var->proxy/fn
               RestFn.java:  397  clojure.lang.RestFn/invoke
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
               RestFn.java:  132  clojure.lang.RestFn/applyTo
            AFunction.java:   31  clojure.lang.AFunction$1/doInvoke
               RestFn.java:  397  clojure.lang.RestFn/invoke
           upload_test.clj:  881  metabase.upload-test/z/fn
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
                  AFn.java:  144  clojure.lang.AFn/applyTo
                  core.clj:  667  clojure.core/apply
                  core.clj:  662  clojure.core/apply
        dynamic_redefs.clj:   22  metabase.test.util.dynamic-redefs/var->proxy/fn
               RestFn.java:  397  clojure.lang.RestFn/invoke
                  AFn.java:  152  clojure.lang.AFn/applyToHelper
               RestFn.java:  132  clojure.lang.RestFn/applyTo
            AFunction.java:   31  clojure.lang.AFunction$1/doInvoke
...
```",camsaul,2024-05-31 20:11:01+00:00,[],2024-12-24 11:38:12+00:00,2024-07-11 08:38:14+00:00,https://github.com/metabase/metabase/issues/43471,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.CI & Tests', ''), ('.Backend', ''), ('.Team/Workflows', 'aka BEC'), ('Organization/Uploads', 'Direct data upload (CSV)')]","[{'comment_id': 2144753990, 'issue_id': 2328522096, 'author': 'crisptrutski', 'body': ""We actually have a [test](https://github.com/metabase/metabase/blob/d521d628ca607b525132a797454bdf2c6a8e7c79/test/metabase/test/util_test.clj#L90-L99) which uses nested, so clearly there's something interesting about the usage here. \r\n\r\nUpdate: ah, the issue is when it's used within the binding. Didn't think of that usage!"", 'created_at': datetime.datetime(2024, 6, 3, 9, 44, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2145017832, 'issue_id': 2328522096, 'author': 'crisptrutski', 'body': ""Ah, OK so the issue is quite subtle, and in fact there are two issues with the example code itself.\r\n\r\nFirstly, by the time we define `orig`, it is already referring to the patched version of `x`, i.e. the version that will delegate to whatever the current scope is.\r\n\r\nIf we move the `let` outside the `with-dynamic-redefs` then we get the correct behavior:\r\n\r\n```clojure\r\n(defn z []\r\n  (let [orig x]\r\n    (mt/with-dynamic-redefs [x\r\n                             (let [orig x]\r\n                               (fn []\r\n                                 (mt/with-dynamic-redefs [y (constantly :redef)]\r\n                                   (orig)))]\r\n      (x))))\r\n```\r\n\r\nAt least... we'll get that behavior the first time it's called. The second time it's called the top-level x will have been patched already before we define `orig` this time, and we'll overflow.\r\n\r\nI'm not completely convinced this is a bug, this is how I imagine things working where `x` is a var, i.e. late-binding, and dynamically bound.\r\n\r\nIf we need to do patterns like this, I think the best thing to do is to explicitly look up the current value of var, and I can add a convenience method for doing that. Will put a PR together quick."", 'created_at': datetime.datetime(2024, 6, 3, 12, 2, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2222356818, 'issue_id': 2328522096, 'author': 'crisptrutski', 'body': ""Closing this, since it's behaving as I expected, and we now expose a convenient helper (`mt/dynamic-value`) to enable the motivating [use case](https://github.com/metabase/metabase/pull/43496/files#diff-75d9dbbca4532d033a481ae4d6d6962c513de1a295e6ffed868868558c072ad3R114-R118)."", 'created_at': datetime.datetime(2024, 7, 11, 8, 38, 14, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-06-03 09:44:24 UTC): We actually have a [test](https://github.com/metabase/metabase/blob/d521d628ca607b525132a797454bdf2c6a8e7c79/test/metabase/test/util_test.clj#L90-L99) which uses nested, so clearly there's something interesting about the usage here. 

Update: ah, the issue is when it's used within the binding. Didn't think of that usage!

crisptrutski on (2024-06-03 12:02:16 UTC): Ah, OK so the issue is quite subtle, and in fact there are two issues with the example code itself.

Firstly, by the time we define `orig`, it is already referring to the patched version of `x`, i.e. the version that will delegate to whatever the current scope is.

If we move the `let` outside the `with-dynamic-redefs` then we get the correct behavior:

```clojure
(defn z []
  (let [orig x]
    (mt/with-dynamic-redefs [x
                             (let [orig x]
                               (fn []
                                 (mt/with-dynamic-redefs [y (constantly :redef)]
                                   (orig)))]
      (x))))
```

At least... we'll get that behavior the first time it's called. The second time it's called the top-level x will have been patched already before we define `orig` this time, and we'll overflow.

I'm not completely convinced this is a bug, this is how I imagine things working where `x` is a var, i.e. late-binding, and dynamically bound.

If we need to do patterns like this, I think the best thing to do is to explicitly look up the current value of var, and I can add a convenience method for doing that. Will put a PR together quick.

crisptrutski on (2024-07-11 08:38:14 UTC): Closing this, since it's behaving as I expected, and we now expose a convenient helper (`mt/dynamic-value`) to enable the motivating [use case](https://github.com/metabase/metabase/pull/43496/files#diff-75d9dbbca4532d033a481ae4d6d6962c513de1a295e6ffed868868558c072ad3R114-R118).

"
2328394770,issue,open,,Accept access_token property along jwt in JWT SSO,"### Describe the bug

We seem to have done our own standard on JWT SSO. While all the documentation states that the token should be passed in access_token property, we use jwt. E.g.:

https://edumation.metabase.com/auth/sso?
```
jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MTAwMDAwMCwiZmlyc3RfbmFtZSI6Ik1hcnkiLCJsYXN0X25hbWUiOiJTbWl0aCIsImVtYWlsIjoibWFyeS5zbWl0aEBtZXRhYmFzZS5jb20iLCJvY2N1cGF0aW9uIjoidGVhY2hlciIsImF2YXRhciI6Ii9pbWFnZXMvbWFyeS1zbWl0aC5wbmciLCJncm91cHMiOlsiUHJvZmVzc29ycyJdLCJwcm9mZXNzb3JfaWQiOjEsImV4cGlyZXNJbiI6IjIgZGF5cyIsImlhdCI6MTcxNzE3OTYyMH0.oSxUT2l2ISpd11ygfieb5FOBMSKdUSSAWd1eswC_Eqg&return_to=https%3A%2F%2Fedumation.metabase.com%2Fdashboard%2F1-overview%3Flocale%3Den-US%26logo%3Dfalse%26top_nav%3Dfalse%26search%3Dfalse%26new_button%3Dfalse%26side_nav%3Dfalse%26header%3Dfalse%26additional_info%3Dfalse%26action_buttons%3Dfalse
```

But if you use Keycloak
```
http://localhost:3003/auth/sso?redirect=/#session_state=f0f63f13-80af-4257-8232-6571b0a54fad&iss=http%3A%2F%2Flocalhost%3A9090%2Frealms%2Fmaster&access_token=eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI1aUFFcTBtZXg3UWtUY3oybGxleVQwRDJQcWFkTTgwR1JzT2Y3dVNoUVVrIn0.eyJleHAiOjE3MTcxODAyMjIsImlhdCI6MTcxNzE3OTMyMiwiYXV0aF90aW1lIjoxNzE3MTc4ODE0LCJqdGkiOiI0NTBhNjhkYS1jMjhkLTRhMDYtOGI4Mi01YTk4M2M4YjgwYTgiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjkwOTAvcmVhbG1zL21hc3RlciIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiIwMDhhMjU4OS02MTEyLTQ4MDctODQzNi1hZTllNTA3NWIzOGQiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJtZXRhYmFzZS1qd3QiLCJzZXNzaW9uX3N0YXRlIjoiZjBmNjNmMTMtODBhZi00MjU3LTgyMzItNjU3MWIwYTU0ZmFkIiwiYWNyIjoiMCIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0OjMwMDMiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbImRlZmF1bHQtcm9sZXMtbWFzdGVyIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoiZW1haWwgcHJvZmlsZSIsInNpZCI6ImYwZjYzZjEzLTgwYWYtNDI1Ny04MjMyLTY1NzFiMGE1NGZhZCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYW1lIjoiSnVhbiBjYXJsaXRvcyIsInByZWZlcnJlZF91c2VybmFtZSI6ImJAYS5jb20iLCJnaXZlbl9uYW1lIjoiSnVhbiIsImZhbWlseV9uYW1lIjoiY2FybGl0b3MiLCJlbWFpbCI6ImJAYS5jb20ifQ.MYcOjWnHT3iGR8ucokaIkrD0RukfkDQTBhhC8Lmhlzr_SjgIB-4krtvDVp2DTmUj7WYOCdmPdNKGJRm96k6UnQSLrixvCyf5ryNgM-WP0IxJtR96IGTRN8wb7w6OZVqNr8jyCqNhaT_yhWAjUW5fZYO6-_mAkekdsFR2jxsGC6aGhEwIZSi5tDPfSM7WgcDpy8xrrOW7BIpLRPwCZ5DCAe9wP08E9awcNgVW4SkMLd8V7P5n5zovBoTeywM5wFcbZf4Mjpu64oFPPsrVukfvgUIaT4nV5M2XmAe9HZ4zv8j0Woc7w-MW39kzJUT08v_FawxKM4Y_LtGESUKvh8Ui-g&token_type=Bearer&expires_in=900
```

we should accept both parameters

### To Reproduce

1) configure an implicit auth flow with Keycloak
1.1) add a new client Oauth
1.2) root url http://<metabaseurl>/auth/sso
1.3) select only implicit flow
1.4) credentials should be signed jwt with client secret (the client secret should be the metabase generated signing key)
1.5) then add in the default client scope the properties you want to send
2) set up Metabase JWT
2.1) JWT SSO URL: http://<KeycloackURL>/realms/master/protocol/openid-connect/auth?client_id=<client-name-item.1.1>&response_type=token
2.2) enable and test

see that there's no SSO

### Expected behavior

We should adopt the standards

### Logs

NA

### Information about your Metabase installation

```JSON
it has always been like that
```


### Severity

P3

### Additional context

To overcome this limitation you need an application in the middle that does the redirection rewriting the parameters
![image](https://github.com/metabase/metabase/assets/1711649/f1f4af7e-81cb-4f09-b7c6-d4163c0f2903)
",paoliniluis,2024-05-31 18:38:24+00:00,[],2024-06-20 15:09:21+00:00,,https://github.com/metabase/metabase/issues/43468,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Backend', ''), ('Administration/Auth/SSO', 'Enterprise SSO like SAML and JWT'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2142797137, 'issue_id': 2328394770, 'author': 'paoliniluis', 'body': 'references https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-implicit-grant-flow', 'created_at': datetime.datetime(2024, 5, 31, 18, 38, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2142800293, 'issue_id': 2328394770, 'author': 'paoliniluis', 'body': ""Don't know how much we'll be able to tackle this if we're going to support https://github.com/metabase/metabase/issues/42479"", 'created_at': datetime.datetime(2024, 5, 31, 18, 41, 3, tzinfo=datetime.timezone.utc)}]","paoliniluis (Issue Creator) on (2024-05-31 18:38:41 UTC): references https://learn.microsoft.com/en-us/entra/identity-platform/v2-oauth2-implicit-grant-flow

paoliniluis (Issue Creator) on (2024-05-31 18:41:03 UTC): Don't know how much we'll be able to tackle this if we're going to support https://github.com/metabase/metabase/issues/42479

"
2328384904,issue,closed,not_planned,[BE] Change column aliases for aggregations to name the original column,"Currently it's `sum`, `sum_2`, etc. and no details.

I think we should change aggregations which consume columns to have the form `sum__of__SUBTOTAL`, using the `desired-column-alias` of the column. (So the min of an implicitly joined column would be the lengthy but unambiguous `min__of__Reviews__via__PRODUCT_ID__RATING`.)",bshepherdson,2024-05-31 18:31:24+00:00,['bshepherdson'],2024-06-06 18:30:04+00:00,2024-06-06 18:30:04+00:00,https://github.com/metabase/metabase/issues/43467,"[('Querying/Processor', ''), ('.Backend', ''), ('.metabase-lib', 'Label for tracking all issues related to the shared CLJC metabase-lib')]","[{'comment_id': 2153149335, 'issue_id': 2328384904, 'author': 'bshepherdson', 'body': ""I tried to do this, but it's impractical given how aggregations are represented currently. For the purposes of #43306 this is not a problem."", 'created_at': datetime.datetime(2024, 6, 6, 18, 30, 4, tzinfo=datetime.timezone.utc)}]","bshepherdson (Issue Creator) on (2024-06-06 18:30:04 UTC): I tried to do this, but it's impractical given how aggregations are represented currently. For the purposes of #43306 this is not a problem.

"
2328282097,issue,closed,completed,Review and refine static dashboard props for embedding SDK,Let's review the props of the static dashboard component to ensure that they're cleaned up and consistent with our expectations. See the [discussion thread](https://metaboat.slack.com/archives/C063Q3F1HPF/p1717150408109729) on Slack.,heypoom,2024-05-31 17:22:30+00:00,[],2024-10-08 17:09:07+00:00,2024-06-05 15:36:48+00:00,https://github.com/metabase/metabase/issues/43463,"[('Embedding/SDK', 'Embedding SDK for React')]",[],
2328276581,issue,open,,"When Metabase is running on http, SameSite=none will break authentication in Chrome","### Describe the bug

Under admin settings - embedding - interactive embedding, we recommend setting `SameSite=None` if the application domain and protocol entered in authorized origins is different from the domain and protocol that Metabase is running on.

When running Metabase on localhost with http (not https), this breaks authentication in Chrome. This is because we add the SameSite=none attribute in the cookie, but not the Secure attribute, which is required. Thus, Chrome will not send the cookie to Metabase.

This impacts cross-site requests (interactive embedding with iframe) and same-site requests (accessing Metabase directly, e.g. using email/password). To resolve the issue (change the SameSite setting again) a different browser must be used. 

[The docs](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie) say when it's used, the cookie must be set as secure, and it must be sent over HTTPS, but there is an exception for localhost.

### To Reproduce

1. Run MB locally on `http://localhost:3000`
2. Sign into MB using Chrome
3. Enable embedding
4. Embedding settings -> Interactive -> enter authorized origins `http://localhost:9090`
5. SameSite=none is suggested, change to that value
6. Sign out
7. Try to sign in again, see that it fails
8. Inspect the cookies

![image](https://github.com/metabase/metabase/assets/24216/69a84c96-2748-4e99-949e-9f0027cd06e8)

Impact:
* Sign in with email/password or SSO directly into MB: sign in fails but there is no error message
* Interactive embedding: redirect loop -> SSO into MB fails -> redirects to SSO endpoint -> SSO into MB fails -> ....

### Expected behavior

When using `SameSite=none`, the `Secure` attribute must also be set. This would usually prevent the browser from sending the cookie if the server is not on `https`, but localhost is an exception.

Alternatives:
* do not recommend setting `SameSite=none` if MB is running on `http://localhost`, possible also ignore `SameSite=None` when MB is running on HTTP
* set the `Secure` attribute when MB is running on localhost and `SameSite=None`


### Logs

_No response_

### Information about your Metabase installation

```JSON
- Impacts MB 48, 49, 50, master...
```


### Severity

P1 because the recommended setup for self-hosters breaks authentication in Chrome and it has a big impact on everyone trying to get embedding up and running

### Additional context

_No response_",albertoperdomo,2024-05-31 17:19:08+00:00,[],2025-02-04 20:25:57+00:00,,https://github.com/metabase/metabase/issues/43462,"[('Type:Bug', 'Product defects'), ('.Security related', ''), ('Priority:P2', 'Average run of the mill bug'), ('Administration/Auth', 'Google Auth, LDAP, pw+email login'), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('.Backend', ''), ('.Team/Embedding', '')]","[{'comment_id': 2145297518, 'issue_id': 2328276581, 'author': 'albertoperdomo', 'body': ""I've verified that leaving the setting to the default value of `SameSite=Lax` works in Chrome when both MB and app are hosted on localhost. We should probably stop recommending users to change to `SameSite=None` in the UI when MB is running on `http://localhost` as the most immediate fix."", 'created_at': datetime.datetime(2024, 6, 3, 14, 7, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2182207774, 'issue_id': 2328276581, 'author': 'albertoperdomo', 'body': ""I've downgraded this to P2 since we've temporarily disabled the suggestion in the UI to set `SameSite=None`."", 'created_at': datetime.datetime(2024, 6, 21, 7, 54, 4, tzinfo=datetime.timezone.utc)}]","albertoperdomo (Issue Creator) on (2024-06-03 14:07:13 UTC): I've verified that leaving the setting to the default value of `SameSite=Lax` works in Chrome when both MB and app are hosted on localhost. We should probably stop recommending users to change to `SameSite=None` in the UI when MB is running on `http://localhost` as the most immediate fix.

albertoperdomo (Issue Creator) on (2024-06-21 07:54:04 UTC): I've downgraded this to P2 since we've temporarily disabled the suggestion in the UI to set `SameSite=None`.

"
2328270200,issue,closed,completed,Fingerprint of Large Binary Fields Crashes Metabase,"### Describe the bug

Metabase runs out of memory very quickly when it hits the fingerprint stage of a table with large binary data fields

### To Reproduce

1. Spin up a Postgres DB to use for testing
2. Generate a test table in Postgres with a few thousand large fields stored in a bytea column:

-- Create a sequence for generating unique IDs
CREATE SEQUENCE big_byte_seq;

-- Insert 2,500 rows with 1 MB bytea values
DO $$
DECLARE
    i INTEGER;
BEGIN
    FOR i IN 1..2500 LOOP
        EXECUTE 'INSERT INTO example_table (id, data) VALUES ($1, $3)'
        USING NEXTVAL('big_byte_seq'),
              'Data ' || i,
              decode(md5(random()::text), 'hex') || repeat('00', 524288)::bytea;
    END LOOP;
END $$;
;

3. Run Metabase with JAVA_OPTS=""-Xms512m -Xmx2g"" (it will also crash at higher memory allocation but it fails faster for testing if you drop it a little)

4. Add your test db and watch it crash with OOM




### Expected behavior

We should be able to read this more efficiently or anticipate the size and reduce the amount of data we're calling in. Do we even need to fingerprint binary data?

### Logs

2024-05-31 12:05:12 2024-05-31 17:05:12,966 INFO sync-metadata.tables :: Updating table metadata for Table 43 ''public.my_table''
2024-05-31 12:05:12 2024-05-31 17:05:12,967 INFO sync-metadata.tables :: Updating table metadata for Table 27 ''public.test_table_2''
2024-05-31 12:05:12 2024-05-31 17:05:12,967 INFO sync-metadata.tables :: Updating table metadata for Table 33 ''public.upquery_result_2024_05_21t22_09_18_961517z__1__20240523213634''
2024-05-31 12:05:12 2024-05-31 17:05:12,967 INFO sync.util :: FINISHED: step ''sync-tables'' for postgres Database 3 ''PG Test Replica'' (31.7 ms)
2024-05-31 12:05:12 2024-05-31 17:05:12,968 INFO sync.util :: STARTING: step ''sync-fields'' for postgres Database 3 ''PG Test Replica''
2024-05-31 12:05:13 2024-05-31 17:05:13,139 INFO sync.util :: FINISHED: step ''sync-fields'' for postgres Database 3 ''PG Test Replica'' (171.2 ms)
2024-05-31 12:05:13 2024-05-31 17:05:13,139 INFO sync.util :: STARTING: step ''sync-fks'' for postgres Database 3 ''PG Test Replica''
2024-05-31 12:05:13 2024-05-31 17:05:13,214 INFO sync.util :: FINISHED: step ''sync-fks'' for postgres Database 3 ''PG Test Replica'' (74.6 ms)
2024-05-31 12:05:13 2024-05-31 17:05:13,214 INFO sync.util :: STARTING: step ''sync-indexes'' for postgres Database 3 ''PG Test Replica''
2024-05-31 12:05:13 2024-05-31 17:05:13,307 INFO sync.util :: FINISHED: step ''sync-indexes'' for postgres Database 3 ''PG Test Replica'' (92.8 ms)
2024-05-31 12:05:13 2024-05-31 17:05:13,308 INFO sync.util :: STARTING: step ''sync-metabase-metadata'' for postgres Database 3 ''PG Test Replica''
2024-05-31 12:05:13 2024-05-31 17:05:13,309 INFO sync.util :: FINISHED: step ''sync-metabase-metadata'' for postgres Database 3 ''PG Test Replica'' (1.2 ms)
2024-05-31 12:05:13 2024-05-31 17:05:13,310 INFO sync.util :: STARTING: step ''sync-table-privileges'' for postgres Database 3 ''PG Test Replica''
2024-05-31 12:05:13 2024-05-31 17:05:13,371 INFO sync.util :: FINISHED: step ''sync-table-privileges'' for postgres Database 3 ''PG Test Replica'' (61.2 ms)
2024-05-31 12:05:13 2024-05-31 17:05:13,532 INFO sync.util :: FINISHED: Sync metadata for postgres Database 3 ''PG Test Replica'' (764.0 ms)
2024-05-31 12:05:13 2024-05-31 17:05:13,534 INFO sync.util :: STARTING: Analyze data for postgres Database 3 ''PG Test Replica''
2024-05-31 12:05:13 2024-05-31 17:05:13,549 INFO sync.util :: STARTING: step ''fingerprint-fields'' for postgres Database 3 ''PG Test Replica''
2024-05-31 12:05:13 2024-05-31 17:05:13,567 INFO sync.analyze :: fingerprint-fields Analyzed [************······································] 😒   25% Table 46 ''public.example_table''
2024-05-31 12:05:13 2024-05-31 17:05:13,585 INFO analyze.fingerprint :: Fingerprinting 1 fields in table Table 46 ''public.example_table''
2024-05-31 12:05:21 Aborting due to java.lang.OutOfMemoryError: Java heap space
2024-05-31 12:05:21 #
2024-05-31 12:05:21 # A fatal error has been detected by the Java Runtime Environment:
2024-05-31 12:05:21 #
2024-05-31 12:05:21 #  Internal Error (debug.cpp:339), pid=1, tid=122
2024-05-31 12:05:21 #  fatal error: OutOfMemory encountered: Java heap space
2024-05-31 12:05:21 #
2024-05-31 12:05:21 # JRE version: OpenJDK Runtime Environment Temurin-11.0.23+9 (11.0.23+9) (build 11.0.23+9)
2024-05-31 12:05:21 # Java VM: OpenJDK 64-Bit Server VM Temurin-11.0.23+9 (11.0.23+9, mixed mode, tiered, compressed oops, g1 gc, linux-amd64)
2024-05-31 12:05:21 # No core dump will be written. Core dumps have been disabled. To enable core dumping, try ""ulimit -c unlimited"" before starting Java again
2024-05-31 12:05:21 #
2024-05-31 12:05:21 # An error report file with more information is saved as:
2024-05-31 12:05:21 # /tmp/hs_err_pid1.log

### Information about your Metabase installation

```JSON
149.11
```


### Severity

P1

### Additional context

_No response_",ixipixi,2024-05-31 17:16:13+00:00,['calherries'],2024-06-04 14:43:34+00:00,2024-06-04 14:43:23+00:00,https://github.com/metabase/metabase/issues/43461,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Postgres', None), ('Administration/Metadata & Sync', ''), ('.Memory Usage', ''), ('.Backend', ''), ('.Escalation', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2147718869, 'issue_id': 2328270200, 'author': 'calherries', 'body': 'The fix has been backported to the 49 branch https://github.com/metabase/metabase/pull/43563', 'created_at': datetime.datetime(2024, 6, 4, 14, 43, 23, tzinfo=datetime.timezone.utc)}]","calherries (Assginee) on (2024-06-04 14:43:23 UTC): The fix has been backported to the 49 branch https://github.com/metabase/metabase/pull/43563

"
2328246831,issue,open,,Stop loading most of the BE while compiling CLJS,"While compiling CLJS, we accidentally end up loading most of the Metabase BE:

- Compiling CLJS means running macros.
- The macros are written in JVM Clojure, and run inside the CLJS compiler.
- So CLJS compilation begins by loading the same code (more or less) in JVM Clojure.
- That accidentally includes a large chunk of Metabase's BE code, including parts that try to start DB connections among much else.

Rearranging some namespaces and requires, and/or making the expensive things a bit lazier, should be able to reduce that startup time greatly. I don't have a good dependency graph, but I got a good picture of which namespaces (transitively) take a long time to load using [this Clojure patch](https://gist.github.com/pesterhazy/7f8af5701b51ccd86f99fc222436e6ea) which logs each namespace's load time. `metabase.util` (and in particular its `metabase.util.jvm` that it re-exports in JVM Clojure) are particularly suspect.",bshepherdson,2024-05-31 17:01:02+00:00,[],2024-05-31 17:03:19+00:00,,https://github.com/metabase/metabase/issues/43459,"[('.Performance', ''), ('.Backend', '')]",[],
2328109383,issue,closed,completed,`Stack values to show` setting does not work with ordinal x-axis scale,"### Describe the bug

If you create a stacked bar chart, set the `Stack values to show` setting to `Insides`, no data labels will be shown. Notably, this doesn't happen on some questions in the sample dataset, but it does with other data.

<img width=""1281"" alt=""Screenshot 2024-05-31 at 8 27 37 AM"" src=""https://github.com/metabase/metabase/assets/37751258/b7f8449d-b963-4a15-8f59-cfb577b5954b"">

### To Reproduce

Repro can be found on stats: https://stats.metabase.com/question/18082-43454-stack-values-to-show-setting-does-not-work-with-ordinal-x-axis-and-log-power-y-axis-scales

1. Create the following question using this CSV: [pokedex.csv](https://github.com/user-attachments/files/15515787/pokedex.csv)

<img width=""1202"" alt=""Screenshot 2024-05-31 at 8 32 41 AM"" src=""https://github.com/metabase/metabase/assets/37751258/c5a74369-b2e6-47c9-93c3-421790c4659f"">


2. Visualize as a stacked bar chart with ordinal x-axis scale, and set `Stack values to show` setting to `Insides`

### Expected behavior

The data labels should be shown inside the bars

### Logs

_No response_

### Information about your Metabase installation

```JSON
`master` commit `c1f1d98381666c40d6636ccef8181d24d19b2d9e`
```


### Severity

Moderately severe, prevents some questions from being visualized properly

### Additional context

_No response_",EmmadUsmani,2024-05-31 15:37:21+00:00,['alxnddr'],2024-06-03 14:20:54+00:00,2024-06-03 14:20:54+00:00,https://github.com/metabase/metabase/issues/43454,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2327818294,issue,open,,"Add IP Address Logging to ""Unsubscribe"" Actions for Subscriptions","**Is your feature request related to a problem? Please describe.**
We sometimes have users that are unexpectedly removed from subscriptions via the ""Unsubscribe"" endpoint. It's very hard to identify the origin of the Unsubscribe action for troubleshooting purposes.  

**Describe the solution you'd like**
When the unsubscribe action is initiated it would be great if we could track the IP address from which the action was initiated. This would help narrow down if the event is occurring from within the application, from the users machine or because of some external software (like a malware / link scanner).

**Describe alternatives you've considered**
We've dug through the audit logs in Metabase but external unsubscribes only track when the event occurred and which email unsubscribed. It's unclear how the action was initiated or  from where.

**How important is this feature to you?**
Potentially sanity saving!

**Additional context**
I really enjoy my sanity (most of the time)
",ixipixi,2024-05-31 13:14:49+00:00,[],2024-06-03 16:57:13+00:00,,https://github.com/metabase/metabase/issues/43441,"[('.Security related', ''), ('Type:New Feature', ''), ('Administration/Usage analytics', 'Pro and Enterprise meta analytics, fka audit')]",[],
2327525921,issue,open,,Floating point values become corrupted on .csv export .xlsx is fine,"### Describe the bug

In the CSV output from a query that joins tables containing both floating point numerical data and timestamps, the numerical output values are corrupted with non-standard characters. However, the same query produces a correct output when exported as an XLSX file.

sample extracts attached.
[metabase xlsx.xlsx](https://github.com/user-attachments/files/15512393/metabase.xlsx.xlsx)
[metabase csv.csv](https://github.com/user-attachments/files/15512394/metabase.csv.csv)



### To Reproduce

In a postgres db have two tables. Each tables should have at least a numerical column with floating point data and a timestamp column 

In the UI formulate a question that joins the two tables

Export the results as a .csv file

### Expected behavior

the .csv values should not be corrupted

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""fr"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36 Edg/125.0.0.0"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.0-1052-azure"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.6""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-28"",
      ""tag"": ""v0.49.13"",
      ""hash"": ""de28e83""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

annoying - requires extra development work to handle xlsx compared to csv

### Additional context

_No response_",CharlesCheckley,2024-05-31 10:43:04+00:00,[],2024-05-31 17:30:12+00:00,,https://github.com/metabase/metabase/issues/43435,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Export', ''), ('.Backend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2142695470, 'issue_id': 2327525921, 'author': 'bshepherdson', 'body': 'Dan noted on Slack that this looks encoding-related, but we do set UTF-8 when exporting to CSV.', 'created_at': datetime.datetime(2024, 5, 31, 17, 30, 11, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2024-05-31 17:30:11 UTC): Dan noted on Slack that this looks encoding-related, but we do set UTF-8 when exporting to CSV.

"
2327173763,issue,open,,Cannot change permissions when Language set to Swedish,"**Describe the bug**
When the Instance Language is set to Swedish, I cannot change the Permissions

**Logs**
[cae9af17-8d1a-4d60-aa37-c50cd0dc9f9e] 2024-05-31T09:36:34+02:00 DEBUG metabase.server.middleware.log GET /api/permissions/group 200 54.1 ms (2 DB-anrop) App DB-anslutningar: 2/15 Jetty threads: 3/50 (4 idle, 0 queued) (totalt 77 aktiva trådar) Frågor på gång: 0 (0 köade)
[cae9af17-8d1a-4d60-aa37-c50cd0dc9f9e] 2024-05-31T09:36:34+02:00 DEBUG metabase.server.middleware.log GET /api/user 200 250.4 ms (4 DB-anrop) App DB-anslutningar: 2/15 Jetty threads: 3/50 (4 idle, 0 queued) (totalt 77 aktiva trådar) Frågor på gång: 0 (0 köade)
[cae9af17-8d1a-4d60-aa37-c50cd0dc9f9e] 2024-05-31T09:36:34+02:00 DEBUG metabase.server.middleware.log GET /api/permissions/membership 200 57.1 ms (1 DB-anrop) App DB-anslutningar: 2/15 Jetty threads: 3/50 (4 idle, 0 queued) (totalt 77 aktiva trådar) Frågor på gång: 0 (0 köade)
[cae9af17-8d1a-4d60-aa37-c50cd0dc9f9e] 2024-05-31T09:36:39+02:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/2 200 79.7 ms (3 DB-anrop) App DB-anslutningar: 2/15 Jetty threads: 4/50 (3 idle, 0 queued) (totalt 77 aktiva trådar) Frågor på gång: 0 (0 köade)
[cae9af17-8d1a-4d60-aa37-c50cd0dc9f9e] 2024-05-31T09:36:39+02:00 ERROR metabase.models.permissions.parse Fel i analysen av behörighetsträdet Parse error at line 1, column 23:
/collection/namespace/snippets/root/
                      ^
Expected one of:
:end-of-string
""read""

[cae9af17-8d1a-4d60-aa37-c50cd0dc9f9e] 2024-05-31T09:36:39+02:00 ERROR metabase.models.permissions.parse Fel i analysen av behörighetsträdet Parse error at line 1, column 1:
/application/subscription/
^
Expected one of:
""/"" (followed by end-of-string)
""/query/db/""
""/data/db/""
""/collection/""
""/details""
""/data-model""
""/download""
""/block/db/""
""/db/""
""/execute/""

[cae9af17-8d1a-4d60-aa37-c50cd0dc9f9e] 2024-05-31T09:36:39+02:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/1 200 170.5 ms (3 DB-anrop) App DB-anslutningar: 1/15 Jetty threads: 3/50 (4 idle, 0 queued) (totalt 77 aktiva trådar) Frågor på gång: 0 (0 köade)
[cae9af17-8d1a-4d60-aa37-c50cd0dc9f9e] 2024-05-31T09:36:41+02:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/3 200 85.7 ms (3 DB-anrop) App DB-anslutningar: 1/15 Jetty threads: 3/50 (4 idle, 0 queued) (totalt 77 aktiva trådar) Frågor på gång: 0 (0 köade)
[cae9af17-8d1a-4d60-aa37-c50cd0dc9f9e] 2024-05-31T09:36:46+02:00 DEBUG metabase.server.middleware.log GET /api/database/3/metadata 200 692.7 ms (9 DB-anrop) App DB-anslutningar: 2/15 Jetty threads: 3/50 (4 idle, 0 queued) (totalt 77 aktiva trådar) Frågor på gång: 0 (0 köade)
[cae9af17-8d1a-4d60-aa37-c50cd0dc9f9e] 2024-05-31T09:36:53+02:00 DEBUG metabase.server.middleware.log PUT /api/permissions/graph 400 971.4 ms (16 DB-anrop) 
""You cannot create or revoke permissions for the 'Admin' group.""

**To Reproduce**
Steps to reproduce the behavior:
1. Make sure the language is set to Swedish
2. Click on Permissions
3. Click on All Users or any other non-Admin group
4. Set one database to ""No Self-service""
5. Try to save.
6. Then you get ""You cannot create or revoke permissions for the 'Admin' group


**Expected behavior**
Should be able to save the changes

**Screenshots**
![image](https://github.com/metabase/metabase/assets/160489928/7b25c146-1293-4ea1-93f3-67700dc6860a)


**Severity**
An bug but work-around is to switch to English.

**Additional context**
Add any other context about the problem here.

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.153.1-1.cm2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""sqlserver"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.2""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-28"",
      ""tag"": ""v0.49.13"",
      ""hash"": ""de28e83""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Stockholm""
    }
  }
}
```",niclas-evidence-operations,2024-05-31 07:45:23+00:00,[],2024-07-05 13:19:54+00:00,,https://github.com/metabase/metabase/issues/43432,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Administration/Permissions', 'Collection or Data permissions'), ('Customization/i18n', ''), ('.Backend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2210867708, 'issue_id': 2327173763, 'author': 'paoliniluis', 'body': '@niclas-evidence-operations can you send us the dump of the permissions and collections table? you can remove any sensitive information you want', 'created_at': datetime.datetime(2024, 7, 5, 13, 19, 53, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-07-05 13:19:53 UTC): @niclas-evidence-operations can you send us the dump of the permissions and collections table? you can remove any sensitive information you want

"
2326733533,issue,closed,completed,Filter MultiAutocomplete now adds every intermediate value as a filter,"### Describe the bug

When typing a value into a MultiAutocomplete filter field, a filter is added not just for what you actually select, but for each of the values that the autocomplete control had after typing each letter. Please see the attached video for a demo.

The same problem happens if you choose some values from the MultiAutocomplete drop-down and then X them out; they're still added as filters.

This only happens for certain fields, and I'm not sure why - I haven't found the right Sample Database fields to reproduce it. It doesn't happen when filtering on that table directly, I think - it needs to come from an association. But some other similar name fields on associated tables don't trigger the bug, and I can't see why they're different.

This is a regression in 0.49. I've done a git bisect and the problem was introduced in commit e64daa4f452af197d7d3f62bac083fecf482b86a which is part of the improvements @ranquild made in #40278.

### To Reproduce

1. Go to a table that exhibits the problem
2. Click on 'Filter'
3. Scroll down to the associated table that exhibits the problem
4. Go to an auto-complete-able text field and type a few letters
5. Select a value
6. Apply the filter
7. Observe that a number of filters have been added, one after each character typed


### Expected behavior

Only the selected values shown in the autocomplete should be added as a filter.

### Logs

No JS logs emitted while the frontend is hitting this bug. Nothing interesting I can see on the backend.

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.3"",
    ""java.vendor"": ""Homebrew"",
    ""java.vendor.url"": ""https://github.com/Homebrew/homebrew-core/issues"",
    ""java.version"": ""21.0.3"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.3"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.4.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Pacific/Auckland""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""bigquery-cloud-sdk""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2022-09-06"",
      ""src_hash"": ""8a88eaab9b69213780bd2547d41bd97f1f2e9855"",
      ""tag"": ""v0.45.0-SNAPSHOT"",
      ""branch"": ""master"",
      ""hash"": ""93d3df5""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Medium

### Additional context

Demo from our test environment:

https://github.com/metabase/metabase/assets/12062/31033483-ae4b-4bbd-a872-c51b866a42b0
",willbryant,2024-05-31 00:00:41+00:00,[],2024-07-17 02:04:22+00:00,2024-07-17 02:04:15+00:00,https://github.com/metabase/metabase/issues/43426,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/MBQL', ''), ('.Backend', '')]","[{'comment_id': 2204721434, 'issue_id': 2326733533, 'author': 'willbryant', 'body': 'I think I\'ve figured out why this only happens on some fields. First of all, this only happens on the filter modal, not the editor screen. Secondly, it only happens when you see ""Search the list"" fields.\r\n\r\nI believe this is because it\'s only in the case where `FilterValuePicker` returns a `ListValuePicker` and where `ListValuePicker` returns an `AutocompletePicker` rather than a `CheckboxGridPicker`.\r\n\r\nThe filter dialog doesn\'t experience this issue because in the `!props.compact` case it will return a `CheckboxGridPicker`. And similarly, a lot fields won\'t exhibit this bug because in the `props.fieldValues.length > MAX_INLINE_OPTIONS` case it will again return `CheckboxGridPicker`.\r\n\r\nAnd you won\'t get the `ListValuePicker` (""Search the list"") unless `canListFieldValues()` returns true, which looks to me like it\'s checking mainly that the list of values is known and not too long (`!has_more_values`).\r\n\r\nTherefore, to repro this bug, you need some distinct data with more than `MAX_INLINE_OPTIONS` (12) values, but not so many that you get into the `!has_more_values` case, I think?', 'created_at': datetime.datetime(2024, 7, 2, 23, 48, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2204731415, 'issue_id': 2326733533, 'author': 'willbryant', 'body': ""I thought it might be this part of the commit:\r\n\r\n```\r\n@@ -71,6 +71,7 @@ function FilterValuePicker({\r\n         fieldValues={fieldData.values}\r\n         selectedValues={selectedValues}\r\n         placeholder={t`Search the list`}\r\n+        shouldCreate={shouldCreate}\r\n         autoFocus={autoFocus}\r\n         compact={compact}\r\n         onChange={onChange}\r\n```\r\n\r\nBecause that's the only one that *added* `shouldCreate` rather than *replacing* a `canAddValue` with `shouldCreate`. But reverting that line doesn't seem to fix it. So I think it's something to do with the onChange behavior in MultiAutocomplete?"", 'created_at': datetime.datetime(2024, 7, 2, 23, 54, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2227095751, 'issue_id': 2326733533, 'author': 'ranquild', 'body': 'Repro with Sample Database:\n- Admin -> Table Metadata -> Products -> Title -> Change ""Filtering on this field"" to ""Search box""\n- New -> Question -> Orders\n- Join Orders on ID = ID (self join)\n- Visualize\n- Filter -> See multiple 2 join groups for Product because there are 2 PRODUCT_ID now\n- Select the second Product group\n- Change operator for Title to be `Is`, start typing some value, then select it from the dropdown\n- Click Apply filters\n- See multiple filters created\n- This is because we lose track of implicitly joined fields where there is more than 1 `source-field`\n\nDemo https://www.loom.com/share/cd8eb83f6de84f7289e36af33696f92a\nI\'ll have a fix shortly that would remove some of the symptoms - not fully fix this issue.', 'created_at': datetime.datetime(2024, 7, 13, 20, 27, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2231213500, 'issue_id': 2326733533, 'author': 'ranquild', 'body': ""@willbryant it's partially fixed in master now and will be released in some 0.50.x release soon. I'll leave this issue open as it's still possible to face it. Reassigning to another team because there is an internal issue with implicit field references that I cannot fix here."", 'created_at': datetime.datetime(2024, 7, 16, 15, 20, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2232191791, 'issue_id': 2326733533, 'author': 'ranquild', 'body': ""Closing this issue (by https://github.com/metabase/metabase/pull/45532). I'll create another one for other issues with implicit fields."", 'created_at': datetime.datetime(2024, 7, 17, 2, 4, 15, tzinfo=datetime.timezone.utc)}]","willbryant (Issue Creator) on (2024-07-02 23:48:13 UTC): I think I've figured out why this only happens on some fields. First of all, this only happens on the filter modal, not the editor screen. Secondly, it only happens when you see ""Search the list"" fields.

I believe this is because it's only in the case where `FilterValuePicker` returns a `ListValuePicker` and where `ListValuePicker` returns an `AutocompletePicker` rather than a `CheckboxGridPicker`.

The filter dialog doesn't experience this issue because in the `!props.compact` case it will return a `CheckboxGridPicker`. And similarly, a lot fields won't exhibit this bug because in the `props.fieldValues.length > MAX_INLINE_OPTIONS` case it will again return `CheckboxGridPicker`.

And you won't get the `ListValuePicker` (""Search the list"") unless `canListFieldValues()` returns true, which looks to me like it's checking mainly that the list of values is known and not too long (`!has_more_values`).

Therefore, to repro this bug, you need some distinct data with more than `MAX_INLINE_OPTIONS` (12) values, but not so many that you get into the `!has_more_values` case, I think?

willbryant (Issue Creator) on (2024-07-02 23:54:52 UTC): I thought it might be this part of the commit:

```
@@ -71,6 +71,7 @@ function FilterValuePicker({
         fieldValues={fieldData.values}
         selectedValues={selectedValues}
         placeholder={t`Search the list`}
+        shouldCreate={shouldCreate}
         autoFocus={autoFocus}
         compact={compact}
         onChange={onChange}
```

Because that's the only one that *added* `shouldCreate` rather than *replacing* a `canAddValue` with `shouldCreate`. But reverting that line doesn't seem to fix it. So I think it's something to do with the onChange behavior in MultiAutocomplete?

ranquild on (2024-07-13 20:27:14 UTC): Repro with Sample Database:
- Admin -> Table Metadata -> Products -> Title -> Change ""Filtering on this field"" to ""Search box""
- New -> Question -> Orders
- Join Orders on ID = ID (self join)
- Visualize
- Filter -> See multiple 2 join groups for Product because there are 2 PRODUCT_ID now
- Select the second Product group
- Change operator for Title to be `Is`, start typing some value, then select it from the dropdown
- Click Apply filters
- See multiple filters created
- This is because we lose track of implicitly joined fields where there is more than 1 `source-field`

Demo https://www.loom.com/share/cd8eb83f6de84f7289e36af33696f92a
I'll have a fix shortly that would remove some of the symptoms - not fully fix this issue.

ranquild on (2024-07-16 15:20:42 UTC): @willbryant it's partially fixed in master now and will be released in some 0.50.x release soon. I'll leave this issue open as it's still possible to face it. Reassigning to another team because there is an internal issue with implicit field references that I cannot fix here.

ranquild on (2024-07-17 02:04:15 UTC): Closing this issue (by https://github.com/metabase/metabase/pull/45532). I'll create another one for other issues with implicit fields.

"
2326597099,issue,closed,completed,Update [nocache] check in prepare-frontend workflow to check the correct commit message in PRs,"I think we use outdated format to get commit `github.event.head_commit`

so a way for testing (but not for merging) is to comment out `Get node_modules cache` part of `.github/actions/prepare-frontend/action.yml` on your branch

<@U5A85JL4V> ^^ can be a task for DevEx :slightly_smiling_face:

[Slack Message](https://metaboat.slack.com/archives/C5XHN8GLW/p1717102662948199?thread_ts=1717101367.527999&cid=C5XHN8GLW)",iethree,2024-05-30 21:55:29+00:00,[],2025-01-03 16:54:47+00:00,2025-01-03 16:54:46+00:00,https://github.com/metabase/metabase/issues/43419,"[('.CI & Tests', ''), ('.Frontend', ''), ('dev/ergonomic', '')]","[{'comment_id': 2569535466, 'issue_id': 2326597099, 'author': 'iethree', 'body': 'this got fixed', 'created_at': datetime.datetime(2025, 1, 3, 16, 54, 46, tzinfo=datetime.timezone.utc)}]","iethree (Issue Creator) on (2025-01-03 16:54:46 UTC): this got fixed

"
2326536476,issue,open,,Replace all custom Kondo macroexpansions with hooks,"As mentioned here https://metaboat.slack.com/archives/CKZEMT1MJ/p1717102454766569 and elsewhere custom Kondo macroexpansions are broken in several different ways, replacing them all with custom hooks instead fixes a lot of stuff and makes LSP navigation work a lot more nicely. We should replace all of our custom Kondo macroexpansions with equivalent hooks instead.",camsaul,2024-05-30 21:00:34+00:00,[],2025-02-04 20:29:49+00:00,,https://github.com/metabase/metabase/issues/43414,"[('Type:Tech Debt', 'or Refactoring'), ('.CI & Tests', ''), ('.Backend', ''), ('.DX', 'Developer experience and QoL related.'), ('.Team/DevEx', '')]",[],
2326513709,issue,closed,completed,[dc.js migration] Improve cartesian chart performance,"Thread: https://metaboat.slack.com/archives/C064QMXEV9N/p1717098407191639

Formatting takes 85%+ of time of building the chart `option` object",alxnddr,2024-05-30 20:46:08+00:00,[],2024-07-17 16:23:15+00:00,2024-07-17 16:23:15+00:00,https://github.com/metabase/metabase/issues/43410,"[('.Performance', ''), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]","[{'comment_id': 2233710671, 'issue_id': 2326513709, 'author': 'alxnddr', 'body': 'Fixed by https://github.com/metabase/metabase/pull/44861', 'created_at': datetime.datetime(2024, 7, 17, 16, 23, 15, tzinfo=datetime.timezone.utc)}]","alxnddr (Issue Creator) on (2024-07-17 16:23:15 UTC): Fixed by https://github.com/metabase/metabase/pull/44861

"
2326436698,issue,open,,Add kondo linter for match :guard,Add kondo linter to check that use of `(_ :guard _)` in `lib.util.match/match` and `lib.util.match/replace` is correct. See https://github.com/metabase/metabase/pull/43358#discussion_r1620973964 for details.,lbrdnk,2024-05-30 19:54:42+00:00,[],2025-02-04 20:23:54+00:00,,https://github.com/metabase/metabase/issues/43406,"[('.Backend', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Querying', '')]",[],
2326314393,issue,closed,not_planned,Query button not showing up under new drop down,"**Describe the bug**
When I go to the New drop down, 'New Query' isn't there (I can't remember if that's what it's called). I only see the option to add new Dashboard or new Collection.

**Logs**
Please include javascript console and server logs around the time this bug occurred. For information about how to get these, consult our [bug troubleshooting guide](https://metabase.com/docs/latest/troubleshooting-guide/bugs.html)
<img width=""672"" alt=""image"" src=""https://github.com/metabase/metabase/assets/130695508/2ccfdb0e-ec24-4499-8dfe-6e848a355649"">


**To Reproduce**
Steps to reproduce the behavior:
1. Go to New
2. Querying option not there

**Expected behavior**
A clear and concise description of what you expected to happen.

Ability to query.

**Screenshots**
If applicable, add screenshots to help explain your problem.
<img width=""441"" alt=""image"" src=""https://github.com/metabase/metabase/assets/130695508/3dc3f3dd-364c-49ec-929c-9950ca52fd56"">


**Severity**
How severe an issue is this bug to you? Is this annoying, blocking some users, blocking an upgrade or blocking your usage of Metabase entirely?
Note: the more honest and specific you are here the more we will take you seriously.

This is blocking my usage of Metabase entirely so it is pretty high priority.

**Additional context**
Add any other context about the problem here.

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en"",
    ""platform"": ""Mac"",
    ""userAgent"": ""Chrome"",
    ""vendor"": ""Google Inc.""
  }
}
```",amaliacote,2024-05-30 18:36:37+00:00,[],2024-06-06 23:05:09+00:00,2024-06-06 23:05:09+00:00,https://github.com/metabase/metabase/issues/43402,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2147671878, 'issue_id': 2326314393, 'author': 'ignacio-mb', 'body': 'Hi @amaliacote, can you paste the complete diagnostic information please?', 'created_at': datetime.datetime(2024, 6, 4, 14, 23, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2153534987, 'issue_id': 2326314393, 'author': 'paoliniluis', 'body': 'closing due to a lack of an answer', 'created_at': datetime.datetime(2024, 6, 6, 23, 5, 9, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-06-04 14:23:22 UTC): Hi @amaliacote, can you paste the complete diagnostic information please?

paoliniluis on (2024-06-06 23:05:09 UTC): closing due to a lack of an answer

"
2326239323,issue,open,,Resolve warnings that show up during legacy to pmbql transformations,"As a follow up of #42931, warnings that are present during transformation of legacy to pmbql should be resolved.

To reproduce:
1. Set coercion of SampleDB > People > id to UNIXSeconds->DateTime.
2. Run question with People as source table.
3. In results, click on id column header and ""Filter by this column"".
4. Filter by any specific dates.
5. Applying the filter results in a console warnings.

Warnings are result of a call to `lib.normalize/normalize` on something that won't produce schema conforming pmbql. In this case it is the filter of what ought to be a query:
```
[[:between
       {:lib/uuid ""d92082c6-9ac1-4344-9e4f-8ca784cd7568""}
       [:field {:base-type :type/BigInteger, :lib/uuid ""22d15067-4029-4323-8abb-52484c6f1bc4""} 46]
       ""2024-04-30""
       ""2024-05-30""]]
```
As field 46 is coerced field, information on its effective type is missing to make it conform `:between` schema defined in `src/metabase/lib/schema/filter.cljc`.

One of problematic `lib.normalize/normalize` calls can be traced to `->pMBQL :dispatch-type/map`, but there may be more of those.

---

More broadly, the problem is that we treat `->pMBQL` as a function that transforms legacy to _valid_ pmbql. That is however not possible without use of metadata as legacy mbql alone sometimes does not contain enough information to accomplish that (ie. missing effective-type).

There are multiple ways how to solve this:
- Shutdown warnings inside normalization call _as normalization should ensure shape of the query is correct_, not necessarily its contents.
- Shutdown schema checks in calls to `->pMBQL` and elsewhere (currently in `lib.query`, `lib.js ns and maybe few more`).
- Add metadata provider as an arg to (or binding on top of) `->pMBQL`.
- ~~Wait until Datascript query manipulation is in place -- the logic in question here will be overhauled by that.~~",lbrdnk,2024-05-30 17:49:14+00:00,[],2025-02-04 20:29:50+00:00,,https://github.com/metabase/metabase/issues/43400,"[('Type:Tech Debt', 'or Refactoring'), ('.Backend', ''), ('.metabase-lib', 'Label for tracking all issues related to the shared CLJC metabase-lib'), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Querying', '')]",[],
2326097729,issue,open,,Unsubscribe on unsaved pulse doesn't work,"### Describe the bug

Emails on dashboard subscriptions can go to users and also to email addresses not associated with a user account:
<img width=""955"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6377293/cc25eabf-3ad4-48ac-a51b-a030e175ce8f"">
Here the `dan sutton` user is a user in the system, and i have added `test@test.com` as an email address not associated with a user account locally.

The dashboard sent over email to the user account includes a link to ""manage your subscriptions""
<img width=""360"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6377293/d73e6f3a-c919-4f8a-affa-baa782a76b1a"">

For the non-user account, we offer an ""unsubscribe"" link:
<img width=""624"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6377293/890267f1-5c93-420a-838a-6c55641b3e3e"">

This link points to:
http://localhost:3006/unsubscribe?hash=ef9bc8f75949969efa79791d03397efe0afd42f66bca4c65db1962ff68bb27b9cde17d33ca087deaf5b69bf0d681526c56cc3df11325e05aa42c4afde03c3ce1&email=test@test.com&pulse-id=

There are a few issues with this:
- note the lack of a pulse-id on `pulse-id=`
- the route `http://localhost:3006/unsubscribe` is not a route
- the route that anticipates doing the unsubscribe is `metabase.api.session POST ""/pulse/unsubscribe""`
- i'm not sure we can use POST request from an email like that handler expects?

<img width=""1398"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6377293/4d345381-a2a1-4aad-8597-d67bf8a4d275"">


### To Reproduce

Create a dashboard, send it to your user and also some non-user email address. Check the emails.

If you need an easy way to see emails, run the following docker container:
`docker run -p 1080:1080 -p 1025:1025  maildev/maildev`

and then view it on `localhost:1080`
<img width=""1398"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6377293/5bfabe51-f22a-491b-a57a-9dc555882a76"">

And the email settings for your local mb are simple: host is localhost and port is 1025. No username or creds required
<img width=""875"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6377293/09706188-0cd2-455e-94ca-f626fa3cd800"">


### Expected behavior

The unsubscribe link should work. 

### Logs

_No response_

### Information about your Metabase installation

```JSON
tested on 1.49.6, 1.49.13, 1.50.0-RC1
```


### Severity

seemingly not that high, but we should fix this

### Additional context

Original issue: https://github.com/metabase/metabase/issues/29955
PR that closed issue: https://github.com/metabase/metabase/pull/30597
another PR: https://github.com/metabase/metabase/pull/30892
",dpsutton,2024-05-30 16:34:31+00:00,[],2024-07-15 10:36:26+00:00,,https://github.com/metabase/metabase/issues/43391,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Pulses', 'Now called Subscriptions'), ('Misc/API', ''), ('Type:New Feature', ''), ('.Frontend', ''), ('Misc/Emails', ''), ('Visualization/Static', 'Subscriptions/pulse generated image')]","[{'comment_id': 2181966065, 'issue_id': 2326097729, 'author': 'qnkhuat', 'body': '@dpsutton If you saved the pulse before sending it, the unsubscribe button will work.\r\n\r\nI don\'t think it\'s a bug if you can\'t unsubscribe to something that doesn\'t exist, but maybe we want to make the FE little more helpful other than ""We\'re little lost""?\r\n\r\nBut that\'s super low on priority imo.', 'created_at': datetime.datetime(2024, 6, 21, 4, 11, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2185565929, 'issue_id': 2326097729, 'author': 'qnkhuat', 'body': ""I'm turning this into a feature request for a better error message if you unsubscribe an unsaved pulse."", 'created_at': datetime.datetime(2024, 6, 24, 4, 10, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2186372728, 'issue_id': 2326097729, 'author': 'darksciencebase', 'body': '@luizarakaki do you agree this is a feature request?', 'created_at': datetime.datetime(2024, 6, 24, 11, 39, 17, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-06-21 04:11:38 UTC): @dpsutton If you saved the pulse before sending it, the unsubscribe button will work.

I don't think it's a bug if you can't unsubscribe to something that doesn't exist, but maybe we want to make the FE little more helpful other than ""We're little lost""?

But that's super low on priority imo.

qnkhuat on (2024-06-24 04:10:22 UTC): I'm turning this into a feature request for a better error message if you unsubscribe an unsaved pulse.

darksciencebase on (2024-06-24 11:39:17 UTC): @luizarakaki do you agree this is a feature request?

"
2326076576,issue,open,,Display issues affecting native models referencing columns with mapped values,"### Describe the bug

Display issues and model corruption might occur when a native model references columns with custom mapped display values set in Table Metadata. These include:
- Non-mapped values might be shown instead of the mapped ones.
- Columns can be displayed twice, showing both mapped and unmapped values.
- Editing the model can break it.


### To Reproduce

1. In Admin Settings / Table Metadata / Sample Database / Reviews, set up a custom mapping for the Rating column.
2. Create a native model which uses this table: `select distinct rating from reviews`, in the model metadata set 'Database column this maps to' to the correct source column. Save the model.
3. The mapped values are displayed correctly.
<img width=""245"" alt=""image"" src=""https://github.com/metabase/metabase/assets/11080638/39a5e8d2-51b9-413c-a598-a6b67986cff7"">

5. Click on '...' / Edit query definition, the preview shows the mapped values
<img width=""485"" alt=""image"" src=""https://github.com/metabase/metabase/assets/11080638/8e090cba-b886-4122-a702-892099653153"">

6. Refresh the preview (Cmd+Enter or click the refresh icon in the editor)

7(!) The non-mapped values are shown
<img width=""486"" alt=""image"" src=""https://github.com/metabase/metabase/assets/11080638/e2381ead-ed3a-49ea-ae4d-e348d74aa157"">

8. Now click on cancel to stop editing the model
9(!) The column is displayed twice with mapped and unmapped values:
<img width=""480"" alt=""image"" src=""https://github.com/metabase/metabase/assets/11080638/ca9456df-a95e-4ec3-aa06-bc9bcca334ce"">

10. Reloading the page resolves this.

11. Still using the same model, go to '...' / Edit Metadata, update the description and Save Changes.

12(!) The model breaks:
<img width=""634"" alt=""image"" src=""https://github.com/metabase/metabase/assets/11080638/362e23df-86be-44b4-8e11-b082779d67f3"">



### Expected behavior

Each of the steps should work

### Logs

_No response_

### Information about your Metabase installation

```JSON
Seen on 1.49.8 and 1.49.13
```


### Severity

Reported by a customer

### Additional context

_No response_",zbodi74,2024-05-30 16:22:43+00:00,[],2025-02-04 20:29:28+00:00,,https://github.com/metabase/metabase/issues/43390,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Native', 'The SQL/native query editor'), ('Administration/Table Metadata', ''), ('.Backend', ''), ('Querying/Models', 'aka Datasets'), ('Querying/Remapping', 'Remapped display values, whether human-readable values or Field->Field remappings'), ('.Team/Querying', ''), ('Semantic Model', '')]","[{'comment_id': 2142686946, 'issue_id': 2326076576, 'author': 'bshepherdson', 'body': 'This seems like it\'s coming from confusion in MLv2 and/or the FE between querying/previewing ""inside"" the model and ""outside"" the model.\r\n\r\n""Inside"" the model, which is to say querying against the model\'s definition directly, the model\'s metadata overrides should not be applied. It should return the `""rating""` column exactly as it comes from SQL, as a simple number.\r\n\r\n""Outside"" the model, the metadata overrides should be visible. That means the `rating` native column is linked to the `Reviews.RATING` Field, which has a custom mapping in the Table Metadata.', 'created_at': datetime.datetime(2024, 5, 31, 17, 24, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2356709379, 'issue_id': 2326076576, 'author': 'camsaul', 'body': 'Is this a duplicate of #23449 ?', 'created_at': datetime.datetime(2024, 9, 17, 19, 17, 39, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2024-05-31 17:24:30 UTC): This seems like it's coming from confusion in MLv2 and/or the FE between querying/previewing ""inside"" the model and ""outside"" the model.

""Inside"" the model, which is to say querying against the model's definition directly, the model's metadata overrides should not be applied. It should return the `""rating""` column exactly as it comes from SQL, as a simple number.

""Outside"" the model, the metadata overrides should be visible. That means the `rating` native column is linked to the `Reviews.RATING` Field, which has a custom mapping in the Table Metadata.

camsaul on (2024-09-17 19:17:39 UTC): Is this a duplicate of #23449 ?

"
2326045487,issue,closed,completed,Move `isEditable` from query display info to a card property computed on the BE,"Add a new card property, similar to `can_write`, that would give the same results as `isEditable` flag computed by MBQL lib today. The benefit is that this won't require metadata to be loaded upfront, and therefore improves FE performance. 

Unclear how to name the property but maybe `can_write_query`, meaning whether the user can modify the query.",ranquild,2024-05-30 16:07:33+00:00,['snoe'],2024-06-10 20:33:50+00:00,2024-06-04 15:04:04+00:00,https://github.com/metabase/metabase/issues/43386,"[('.Backend', '')]",[],
2326030726,issue,closed,completed,Optimize `fieldFilterParameterToFilter`,,ranquild,2024-05-30 15:59:58+00:00,['ranquild'],2024-06-06 19:24:11+00:00,2024-06-06 19:24:11+00:00,https://github.com/metabase/metabase/issues/43385,"[('.Backend', '')]",[],
2325996217,issue,open,,Custom mapping is reset while editing unrelated settings in column metadata,"### Describe the bug

Some unrelated actions in the column metadata editor seem to reset the custom field value mappings set for the column.
[Cal's note: the mappings are reset only on the frontend, but the persisted settings are not reset unless the user saves them again]

### To Reproduce

1. In Admin Settings / Table Metadata / Sample Database / Reviews, set up a custom mapping for the _Rating_ column.

2. Do one of the following:
* Click on Save, and Exit Admin, then go back to the same place
* Update an unrelated field in the column settings, such as the column description then click elsewhere so the change is saved
* Click on Discard cached field values and refresh the page
* On the table level page, update the title of the same column

3. (!) The 'Custom mapping' setting reverts to 'Use original value', or the setting remains, but the mapped values reset to the original field values.

### Expected behavior

The mapping should be kept.

### Logs

_No response_

### Information about your Metabase installation

```JSON
Reproduced in 1.49.8 and 1.49.13
```


### Severity

Annoying. Found it while trying to reproduce something else.

### Additional context

_No response_",zbodi74,2024-05-30 15:42:03+00:00,[],2025-02-04 20:29:24+00:00,,https://github.com/metabase/metabase/issues/43382,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Administration/Settings', ''), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Semantic Model', '')]","[{'comment_id': 2140261821, 'issue_id': 2325996217, 'author': 'calherries', 'body': ""This is a FE issue so I'm redirecting this to Team/AdminWebApp. The request to update the field values (`POST /api/field/:id/values`) does the job, so this is a FE issue. After refreshing the page, the updated settings are persisted. But if you do any of the above in step 2 the FE is incorrectly using cached settings that should have been updated or invalidated.\r\n\r\nSo the title of the issue is a little misleading, because the changes to the custom mapping is only reset on the FE, but the custom mapping is actually saved correctly on the BE. Because of this, I'd say this is more like a P3 than P2. It's not blocking any functionality but it is certainly showing incorrect information to users."", 'created_at': datetime.datetime(2024, 5, 30, 16, 56, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2141519085, 'issue_id': 2325996217, 'author': 'zbodi74', 'body': ""I just noticed, editing the name or description of the column at the table level page also persists the change. So I'd vote for P2 as the mapping might be cleared out even without a visible change on the UI."", 'created_at': datetime.datetime(2024, 5, 31, 8, 45, 40, tzinfo=datetime.timezone.utc)}]","calherries on (2024-05-30 16:56:50 UTC): This is a FE issue so I'm redirecting this to Team/AdminWebApp. The request to update the field values (`POST /api/field/:id/values`) does the job, so this is a FE issue. After refreshing the page, the updated settings are persisted. But if you do any of the above in step 2 the FE is incorrectly using cached settings that should have been updated or invalidated.

So the title of the issue is a little misleading, because the changes to the custom mapping is only reset on the FE, but the custom mapping is actually saved correctly on the BE. Because of this, I'd say this is more like a P3 than P2. It's not blocking any functionality but it is certainly showing incorrect information to users.

zbodi74 (Issue Creator) on (2024-05-31 08:45:40 UTC): I just noticed, editing the name or description of the column at the table level page also persists the change. So I'd vote for P2 as the mapping might be cleared out even without a visible change on the UI.

"
2325860598,issue,closed,completed,Optimize dashboard metadata request,"Should be based on changes here https://github.com/metabase/metabase/pull/43416

Currently it takes ~3.5s for the BE to calculate metadata for a medium size dashboard. 

Repro:
- Open https://stats.metabase.com/dashboard/1880
- See `/api/dashboard/:id/query_metadata`:

<img width=""868"" alt=""Screenshot 2024-05-30 at 17 44 36"" src=""https://github.com/metabase/metabase/assets/8542534/896ea2fd-7584-48c0-92c3-9e1f50f0b6fc"">

This is very slow and we need to optimize this.
```[tasklist]
### Tasks
- [ ] Memoize the query_metadata call
- [ ] Batch fetch table metadata
- [ ] https://github.com/metabase/metabase/issues/43509
- [ ] Batch fetch database
- [ ] Batch fetch dashboard
- [ ] Batch fetch fields
```
",ranquild,2024-05-30 14:46:05+00:00,[],2024-08-07 16:13:55+00:00,2024-08-07 16:13:55+00:00,https://github.com/metabase/metabase/issues/43378,"[('.Performance', ''), ('.Backend', '')]","[{'comment_id': 2161139146, 'issue_id': 2325860598, 'author': 'perivamsi', 'body': 'Pausing the work on this for now - as of 6/11', 'created_at': datetime.datetime(2024, 6, 11, 16, 11, 35, tzinfo=datetime.timezone.utc)}]","perivamsi on (2024-06-11 16:11:35 UTC): Pausing the work on this for now - as of 6/11

"
2325815313,issue,closed,completed,Update to React Testing Library 15 + fix unit tests,,sloansparger,2024-05-30 14:25:13+00:00,['sloansparger'],2024-05-31 15:05:49+00:00,2024-05-31 15:05:49+00:00,https://github.com/metabase/metabase/issues/43373,"[('.TestingStrategy/FE', '')]",[],
2325690316,issue,closed,not_planned,Cannot edit advanced sandboxing SQL Question,"### Describe the bug

There is a particular advanced sandboxing question which is failing when trying to save:

![image](https://github.com/metabase/metabase/assets/110378427/07033adc-b753-4eaf-b27d-ec19aa7b8dc9)

### To Reproduce

I am not able to reproduce but the customer is hitting an issue like this:

`Cannot update Card: Card is used for Sandboxing, and updates would violate sandbox rules. No fields found for table ""MITM_PROTECTION_DETAILS"". {:table-id 577, :type :invalid-query, :toucan2/context-trace [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"" {:toucan2.jdbc.query/sql-args ...`

Attaching the problematic collection for reference https://drive.google.com/file/d/1btUZI6aGdzZU2YO6SJq2s74Wy0_41HXO/view?usp=drive_link

In case you want to import said question locally

### Expected behavior

Able to save Sandboxing Question ... Note this is impacting the serialization process because the question is ending in the same state 

### Logs

Had to attach a file due to some Github max character error

[export_error.zip](https://github.com/metabase/metabase/files/15500592/export_error.zip)


### Information about your Metabase installation

```JSON
They are currently on 1.49.12 but they are old timers on metabase so those sandboxed questions might have been created in 1.47 or even 1.44/1.45
```


### Severity

A customer is blocked since they are moving form Serialization v1 to v2 and they need this to work

### Additional context

_No response_",Tony-metabase,2024-05-30 13:26:52+00:00,['metamben'],2024-09-23 07:43:01+00:00,2024-09-23 07:43:01+00:00,https://github.com/metabase/metabase/issues/43371,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Administration/Data Sandboxes', 'Enterprise Sandboxing'), ('.Team/Querying', '')]","[{'comment_id': 2144593720, 'issue_id': 2325690316, 'author': 'Tony-metabase', 'body': ""@piranha just an FYI this is related to results metadata. If the customer removes all problematic card (cause he has a lot) and leaves only 1 ... The import still fails. \r\n\r\nBUT if they go to this SQL card, do a small edit and save, then export and import it works. So it's something related to metadata which requires update when it's on a different version."", 'created_at': datetime.datetime(2024, 6, 3, 8, 28, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2239621034, 'issue_id': 2325690316, 'author': 'noahmoss', 'body': 'Here\'s what we know after some investigation. Copying over my comment [from Slack](https://metaboat.slack.com/archives/C064EB1UE5P/p1721405962906229).\r\n\r\n* A SQL question A is used as the source for a sandbox on a table T \r\n* When this question is edited and re-saved as B, we try to verify that that the result metadata of B matches up with the types of the columns in T\r\n* To determine the column types for T we construct a basic MBQL query that selects from T and call metabase.query-processor.preprocess/query->expected-cols on it\r\n\r\nThis ultimately throws an exception in metabase.query-processor.middleware.add-implicit-clauses/sorted-implicit-fields-for-table saying that no fields were found for the table. This is the function which fetches the fields:\r\n```\r\n(defn- table->sorted-fields\r\n  ""Return a sequence of all Fields for table that we\'d normally include in the equivalent of a `SELECT *`.""\r\n  [table-id]\r\n  (->> (lib.metadata/fields (qp.store/metadata-provider) table-id)\r\n       (remove :parent-id)\r\n       (remove #(#{:sensitive :retired} (:visibility-type %)))\r\n       (sort-by (juxt :position (comp u/lower-case-en :name)))))\r\n  ```\r\nSo if this issue reproduces consistently for the user, I\'d expect a basic MBQL query over the table being sandboxed to also fail with a similar error.\r\n\r\nThe closest thing I can get to a repro is to set the visibility of all the fields in a table to hidden. Then I do get an equivalent error when querying it:\r\n![image](https://github.com/user-attachments/assets/df06e6b6-30ee-41e3-8073-535816119d2f)\r\n\r\n\r\nSo the next things I\'d look at are:\r\n* Is the metadata provider not correctly including fields for this table, or is lib.metadata/fields not returning them properly?\r\n* If fields are being returned, are they all marked as sensitive/retired? (I\'m not sure what the :parent-id removal is about but maybe that\'s in play too)', 'created_at': datetime.datetime(2024, 7, 19, 16, 45, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2239622651, 'issue_id': 2325690316, 'author': 'noahmoss', 'body': ""@Tony-metabase If this customer is still seeing this issue, can they check if they can view the table that's being sandboxed at all? i.e. just via the data browser"", 'created_at': datetime.datetime(2024, 7, 19, 16, 46, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2241858879, 'issue_id': 2325690316, 'author': 'perivamsi', 'body': 'more context in this [slack thread](https://metaboat.slack.com/archives/C052ZBWRG3W/p1717075622845209)', 'created_at': datetime.datetime(2024, 7, 22, 0, 59, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2272217158, 'issue_id': 2325690316, 'author': 'metamben', 'body': 'An admin user can see about 50 normal (visible, not archived) columns in the `CONFIGURATION_TAMPERING_ATTEMPT_DETAILS` table.', 'created_at': datetime.datetime(2024, 8, 6, 21, 54, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2312830247, 'issue_id': 2325690316, 'author': 'metamben', 'body': 'The problem is that the sandboxed tables (and all their columns) have `active = false`, so the QP cannot find any columns and fails.', 'created_at': datetime.datetime(2024, 8, 27, 15, 8, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2321440441, 'issue_id': 2325690316, 'author': 'mngr', 'body': 'Can we close this?', 'created_at': datetime.datetime(2024, 8, 30, 14, 28, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2321500458, 'issue_id': 2325690316, 'author': 'Tony-metabase', 'body': 'No, the customer still has this issue but we are trying to surgically fix it via the DB', 'created_at': datetime.datetime(2024, 8, 30, 14, 49, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2338468749, 'issue_id': 2325690316, 'author': 'NevRA', 'body': 'Update based on https://metaboat.slack.com/archives/C013N8XL286/p1725896356839389?thread_ts=1725892783.667429&cid=C013N8XL286', 'created_at': datetime.datetime(2024, 9, 9, 15, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2367449197, 'issue_id': 2325690316, 'author': 'Tony-metabase', 'body': 'Closing since we surgically fixed this via the DB', 'created_at': datetime.datetime(2024, 9, 23, 7, 43, 1, tzinfo=datetime.timezone.utc)}]","Tony-metabase (Issue Creator) on (2024-06-03 08:28:42 UTC): @piranha just an FYI this is related to results metadata. If the customer removes all problematic card (cause he has a lot) and leaves only 1 ... The import still fails. 

BUT if they go to this SQL card, do a small edit and save, then export and import it works. So it's something related to metadata which requires update when it's on a different version.

noahmoss on (2024-07-19 16:45:12 UTC): Here's what we know after some investigation. Copying over my comment [from Slack](https://metaboat.slack.com/archives/C064EB1UE5P/p1721405962906229).

* A SQL question A is used as the source for a sandbox on a table T 
* When this question is edited and re-saved as B, we try to verify that that the result metadata of B matches up with the types of the columns in T
* To determine the column types for T we construct a basic MBQL query that selects from T and call metabase.query-processor.preprocess/query->expected-cols on it

This ultimately throws an exception in metabase.query-processor.middleware.add-implicit-clauses/sorted-implicit-fields-for-table saying that no fields were found for the table. This is the function which fetches the fields:
```
(defn- table->sorted-fields
  ""Return a sequence of all Fields for table that we'd normally include in the equivalent of a `SELECT *`.""
  [table-id]
  (->> (lib.metadata/fields (qp.store/metadata-provider) table-id)
       (remove :parent-id)
       (remove #(#{:sensitive :retired} (:visibility-type %)))
       (sort-by (juxt :position (comp u/lower-case-en :name)))))
  ```
So if this issue reproduces consistently for the user, I'd expect a basic MBQL query over the table being sandboxed to also fail with a similar error.

The closest thing I can get to a repro is to set the visibility of all the fields in a table to hidden. Then I do get an equivalent error when querying it:
![image](https://github.com/user-attachments/assets/df06e6b6-30ee-41e3-8073-535816119d2f)


So the next things I'd look at are:
* Is the metadata provider not correctly including fields for this table, or is lib.metadata/fields not returning them properly?
* If fields are being returned, are they all marked as sensitive/retired? (I'm not sure what the :parent-id removal is about but maybe that's in play too)

noahmoss on (2024-07-19 16:46:20 UTC): @Tony-metabase If this customer is still seeing this issue, can they check if they can view the table that's being sandboxed at all? i.e. just via the data browser

perivamsi on (2024-07-22 00:59:12 UTC): more context in this [slack thread](https://metaboat.slack.com/archives/C052ZBWRG3W/p1717075622845209)

metamben (Assginee) on (2024-08-06 21:54:43 UTC): An admin user can see about 50 normal (visible, not archived) columns in the `CONFIGURATION_TAMPERING_ATTEMPT_DETAILS` table.

metamben (Assginee) on (2024-08-27 15:08:23 UTC): The problem is that the sandboxed tables (and all their columns) have `active = false`, so the QP cannot find any columns and fails.

mngr on (2024-08-30 14:28:37 UTC): Can we close this?

Tony-metabase (Issue Creator) on (2024-08-30 14:49:19 UTC): No, the customer still has this issue but we are trying to surgically fix it via the DB

NevRA on (2024-09-09 15:45:00 UTC): Update based on https://metaboat.slack.com/archives/C013N8XL286/p1725896356839389?thread_ts=1725892783.667429&cid=C013N8XL286

Tony-metabase (Issue Creator) on (2024-09-23 07:43:01 UTC): Closing since we surgically fixed this via the DB

"
2325614391,issue,open,,Granular permissions for instance Settings,"**Is your feature request related to a problem? Please describe.**
A company may want to set up Admin permissions but limit which tabs they can see from the Admin Settings. 

**Describe the solution you'd like**
A way to limit access to certain parts of the Settings to a group

**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
In the customer's words: ""We want to allow a specific user to set up permissions in the admin settings but not have access to people (so that the user can’t create new users or groups but only define permissions for the existing groups).""

**Additional context**
![image](https://github.com/metabase/metabase/assets/132273646/41667d9c-8286-479c-b6a3-ebe5e09a3ac0)
",ignacio-mb,2024-05-30 12:54:52+00:00,[],2025-02-04 20:30:34+00:00,,https://github.com/metabase/metabase/issues/43368,"[('Type:New Feature', ''), ('Administration/Permissions', 'Collection or Data permissions'), ('Administration/Settings', '')]",[],
2325578492,issue,open,,"Global search entries added via model metadata > ""Surface individual records in search by matching against this column"" cached permanently?","### Describe the bug

""Surface individual records in search by matching against this column"" can produce duplicated search entries, which apparently cannot be easily removed:

![image](https://github.com/metabase/metabase/assets/52021/e9573ed2-9e46-4dcd-8cb3-1b027c3ba163)

### To Reproduce

What I did before I encountered the issue:

1. Created a new model A, say with columns ""id"" (of type Entity Key) and ""name"" (of type Entity Name)
2. Enabled ""Surface individual records in search by matching against this column"" for the ""name"" column
3. Checked if A records can be found via Metabase global search - they can (the change took effect almost immediately)
4. Edited the model. I don't remember what I did exactly, probably added a filter in the model A definition
5. Saw that ""Surface individual records in search by matching against this column"" metadata option for the ""name"" column became disabled and turned it on again.
6. Now global search yields two instances for every found A record 🐞 

I cannot get rid of the duplicated entries. What I tried:
1. Searched in the docs, unsuccessfully
2. Searched here on GitHub, unsuccessfully
3. Archived the model. The search entries were still there, but pointed to a page saying that ""The question was archived""
4. Unarchived the model. The search entries are still duplicated 😞 

![image](https://github.com/metabase/metabase/assets/52021/c0aed4bd-5cc9-4f77-baf9-cd6d9f146e99)

### Expected behavior

Option A: ""Surface individual records in search by matching against this column"" should not produce new search entries where entries for the same model and column already exist.

Option B: There should be an option to rebuild search entries, perhaps in Admin settings > Troubleshooting section or elsewhere where you think it would be appropriate.

### Logs

_No response_

### Information about your Metabase installation

```JSON
Metabase 0.49.12 deployed from the official `metabase/metabase` Docker image, with PostgreSQL as the database.
```


### Severity

annoying

### Additional context

_No response_",earshinov,2024-05-30 12:37:38+00:00,[],2024-05-30 15:52:32+00:00,,https://github.com/metabase/metabase/issues/43366,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Organization/Search', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2325353258,issue,closed,completed,Fix DashcardMenu.shouldRender perf,"<img width=""749"" alt=""image"" src=""https://github.com/metabase/metabase/assets/125459446/a1f99285-8ca7-4b62-b696-22011a325d1f"">

```
const { isEditable } = Lib.queryDisplayInfo(question.query());
return question.canWrite() && isEditable;
```

if possible, we need to optimize `question.query()` or `question.canWrite()`",uladzimirdev,2024-05-30 10:51:43+00:00,[],2024-05-30 15:47:04+00:00,2024-05-30 15:47:04+00:00,https://github.com/metabase/metabase/issues/43360,"[('.Performance', ''), ('.Frontend', '')]","[{'comment_id': 2139827435, 'issue_id': 2325353258, 'author': 'ranquild', 'body': 'I think this is the same story about `isEditable`. We need to move this check to the BE.', 'created_at': datetime.datetime(2024, 5, 30, 15, 1, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2140013091, 'issue_id': 2325353258, 'author': 'uladzimirdev', 'body': 'closing it then', 'created_at': datetime.datetime(2024, 5, 30, 15, 47, 4, tzinfo=datetime.timezone.utc)}]","ranquild on (2024-05-30 15:01:05 UTC): I think this is the same story about `isEditable`. We need to move this check to the BE.

uladzimirdev (Issue Creator) on (2024-05-30 15:47:04 UTC): closing it then

"
2325207340,issue,open,,Link Cards should allow linking to a specific tab of a dashboard,"**Is your feature request related to a problem? Please describe.**
Clicking on a link card always land you on the first tab of a dashboard.

**Describe the solution you'd like**
When creating or updating a Link Card let the user to (optionally) select a specific tab to land on.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**How important is this feature to you?**
Requested by a customer.

**Additional context**
Click behavior has the same limitation, see https://github.com/metabase/metabase/issues/34447",zbodi74,2024-05-30 09:36:11+00:00,[],2024-05-30 09:36:12+00:00,,https://github.com/metabase/metabase/issues/43359,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('.Completeness', '')]",[],
2324860958,issue,closed,completed,The branch name make git error on Windows: `39026-metrics->legacy-metrics`,"### Describe the bug

> git fetch origin
error: cannot lock ref 'refs/remotes/origin/39026-metrics->legacy-metrics': Unable to create 'D:/code/metabase/.git/refs/remotes/origin/39026-metrics->legacy-metrics.lock': Invalid argument
From https://github.com/metabase/metabase
 ! [new branch]            39026-metrics->legacy-metrics -> origin/39026-metrics->legacy-metrics  (unable to update local ref)


### To Reproduce

git fetch or git pull on windows

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Windows
```


### Severity

blocking build

### Additional context

_No response_",cowcomic,2024-05-30 06:56:51+00:00,['metamben'],2024-08-28 02:09:51+00:00,2024-05-30 14:17:46+00:00,https://github.com/metabase/metabase/issues/43355,"[('Type:Bug', 'Product defects'), ('.Needs Triage', ''), ('.Team/Querying', ''), ('.DX', 'Developer experience and QoL related.')]","[{'comment_id': 2139500019, 'issue_id': 2324860958, 'author': 'bshepherdson', 'body': '@metamben this is your branch, can you rename it? (Like push it under a new name, and adjust any PRs to point at it.)', 'created_at': datetime.datetime(2024, 5, 30, 12, 56, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2139660093, 'issue_id': 2324860958, 'author': 'metamben', 'body': ""I've just deleted the branch, it's PR has been closed."", 'created_at': datetime.datetime(2024, 5, 30, 14, 17, 46, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2024-05-30 12:56:44 UTC): @metamben this is your branch, can you rename it? (Like push it under a new name, and adjust any PRs to point at it.)

metamben (Assginee) on (2024-05-30 14:17:46 UTC): I've just deleted the branch, it's PR has been closed.

"
2324299236,issue,open,,[Epic] Support Azure Managed Identity for Postgres and MySQL,"**Links**
- product doc: https://www.notion.so/metabase/Support-Azure-Managed-Identity-for-Postgres-and-MySQL-917d1e20ac8c4551a6de39b5cc32ff41
- eng doc: https://www.notion.so/metabase/Support-Azure-Managed-Identity-for-Postgres-and-MySQL-6ecc7a0504bd4a1fa05696770bf74ebe
- feature branch:  TBD
- related issues:
  https://github.com/metabase/metabase/issues/43168

## Milestones

### Milestone 1: BE & FE: Allow CRUD for provider fields in database

- [ ] #44013
- [ ] #44305
- [ ] #44306

### Milestone 2: BE: Use the provider

**What we ship at the end of the milestone:**

- [ ] #44308

### Milestone 3: FE: Wire up details
- [ ]  [FE] Interface changes to choose provider, and enter in url and headers and not enter a password.",snoe,2024-05-29 21:46:36+00:00,['snoe'],2025-02-04 20:24:09+00:00,,https://github.com/metabase/metabase/issues/43348,"[('.Frontend', ''), ('.Backend', ''), ('.Epic', 'Feature Implementation or Project'), ('.TestingStrategy/FE', '')]",[],
2324297009,issue,closed,not_planned,"""Compact"" and ""Full"" are flipped in viz settings > Auto formatting when presenting percentages","### Describe the bug

Say you create a time series, like churn rate per quarter and you want the values of each quarter to show on the chart. So, you create the following chart 

<img width=""1093"" alt=""Screenshot 2024-05-29 at 2 39 02 PM"" src=""https://github.com/metabase/metabase/assets/116025058/1279409e-57f1-4f88-83ad-f3f455a87549"">

And go to visualization settings > display > toggle ""Show values on data points"". 

The ""Compact"" and ""Full"" buttons have opposite effects. 


### To Reproduce

1. Create a time series - i.e. count of orders grouper by month
2. Go to visualization settings > display > toggle ""show values on data points""
3. Select ""compact"" or ""full"" in Auto formatting and see Metabase behave with opposite commands

<img width=""773"" alt=""Screenshot 2024-05-29 at 2 46 03 PM"" src=""https://github.com/metabase/metabase/assets/116025058/d76d0808-e96f-4f15-a80a-71a2b64e9ac6"">

<img width=""803"" alt=""Screenshot 2024-05-29 at 2 46 23 PM"" src=""https://github.com/metabase/metabase/assets/116025058/098f4dec-bd74-4ec1-b395-2d642cb194fc"">

### Expected behavior

Compact numbers should show compact values and Full numbers should the full values. 

### Logs

_No response_

### Information about your Metabase installation

```JSON
Database: H2 (sample database)
Metabase version: v1.49.13
Metabase cloud
```


### Severity

Not blocking since I can select the opposite option, might be annoying to our customers

### Additional context

_No response_",dahyeik,2024-05-29 21:44:36+00:00,['JesseSDevaney'],2024-05-31 19:35:38+00:00,2024-05-31 19:35:38+00:00,https://github.com/metabase/metabase/issues/43347,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2142872655, 'issue_id': 2324297009, 'author': 'JesseSDevaney', 'body': '**Diagnosed Issue:** Essentially, when `full` formatting is used, it respects the `Minimum number of decimals` specified in the metric column formatting options, but `compact` formatting does not. `compact` formatting uses a different set of logic than `full` formatting does.\r\n\r\n**Demo**\r\n\r\nhttps://github.com/metabase/metabase/assets/22608765/f7ab2af0-8269-463c-acc2-29afbad420ad', 'created_at': datetime.datetime(2024, 5, 31, 19, 35, 38, tzinfo=datetime.timezone.utc)}]","JesseSDevaney (Assginee) on (2024-05-31 19:35:38 UTC): **Diagnosed Issue:** Essentially, when `full` formatting is used, it respects the `Minimum number of decimals` specified in the metric column formatting options, but `compact` formatting does not. `compact` formatting uses a different set of logic than `full` formatting does.

**Demo**

https://github.com/metabase/metabase/assets/22608765/f7ab2af0-8269-463c-acc2-29afbad420ad

"
2324287827,issue,closed,completed,speed up models e2e job,,iethree,2024-05-29 21:36:09+00:00,['iethree'],2024-10-08 17:10:06+00:00,2024-05-30 13:10:25+00:00,https://github.com/metabase/metabase/issues/43346,[],[],
2324285601,issue,closed,completed,Split up filter e2e jobs,,iethree,2024-05-29 21:34:41+00:00,['iethree'],2024-10-08 17:09:38+00:00,2024-05-31 20:16:41+00:00,https://github.com/metabase/metabase/issues/43345,[],[],
2324285495,issue,closed,completed,Split up questions e2e job,,iethree,2024-05-29 21:34:36+00:00,['iethree'],2024-10-08 17:10:07+00:00,2024-05-30 13:10:14+00:00,https://github.com/metabase/metabase/issues/43344,[],[],
2324285373,issue,closed,completed,Benchmark faster CI runners,,iethree,2024-05-29 21:34:31+00:00,['iethree'],2024-05-31 22:45:06+00:00,2024-05-31 22:45:06+00:00,https://github.com/metabase/metabase/issues/43343,"[('.CI & Tests', '')]","[{'comment_id': 2143068081, 'issue_id': 2324285373, 'author': 'iethree', 'body': '[see analysis of findings](https://metaboat.slack.com/archives/C0669P4AF9N/p1716999946317179?thread_ts=1716936646.566749&cid=C0669P4AF9N)\r\n\r\nsee test runs:\r\n- https://github.com/metabase/metabase/pull/43279\r\n- https://github.com/metabase/metabase/pull/43280\r\n- https://github.com/metabase/metabase/pull/43281', 'created_at': datetime.datetime(2024, 5, 31, 22, 45, 6, tzinfo=datetime.timezone.utc)}]","iethree (Issue Creator) on (2024-05-31 22:45:06 UTC): [see analysis of findings](https://metaboat.slack.com/archives/C0669P4AF9N/p1716999946317179?thread_ts=1716936646.566749&cid=C0669P4AF9N)

see test runs:
- https://github.com/metabase/metabase/pull/43279
- https://github.com/metabase/metabase/pull/43280
- https://github.com/metabase/metabase/pull/43281

"
2324231772,issue,closed,completed,Review https://github.com/MotherDuck-Open-Source/metabase_duckdb_driver/releases/tag/0.2.7 release,,metamben,2024-05-29 20:54:06+00:00,['metamben'],2024-05-30 15:14:29+00:00,2024-05-30 15:14:29+00:00,https://github.com/metabase/metabase/issues/43338,[],[],
2324222973,issue,closed,completed,Fix DashCardCardParameterMapper performance,,ranquild,2024-05-29 20:47:43+00:00,['ranquild'],2024-10-08 17:10:08+00:00,2024-05-30 12:37:27+00:00,https://github.com/metabase/metabase/issues/43337,"[('.Performance', '')]",[],
2324214007,issue,closed,not_planned,[Blocked] Do not compute `isEditable` with MBQL lib and use a new card property coming from the BE,"isEditable causing this atm:

<img width=""723"" alt=""Screenshot 2024-05-30 at 00 20 33"" src=""https://github.com/metabase/metabase/assets/8542534/b130807e-402b-41b4-8a4a-f6b0154d6921"">
",ranquild,2024-05-29 20:42:09+00:00,[],2024-06-03 12:35:12+00:00,2024-06-03 12:35:12+00:00,https://github.com/metabase/metabase/issues/43335,"[('.Performance', '')]",[],
2324204847,issue,closed,completed,Single metadata endpoint for cards,"Similar to https://github.com/metabase/metabase/issues/43156

Add a `/api/card/:id/query_metadata` endpoint that returns all metadata required for the query. Should be the same as calling `dependent-metadata` on the query. Use the same response shape as in other endpoints:

```
{
 databases: Database[];
  tables: Table[]; 
  fields: Field[];
}
```

The new endpoint should be used in the QB and when adding new cards to the dashboard. When this task is done, the FE should no longer call `Lib.dependentMetadata`. ",ranquild,2024-05-29 20:35:25+00:00,['snoe'],2024-06-10 20:24:55+00:00,2024-05-31 23:32:46+00:00,https://github.com/metabase/metabase/issues/43334,"[('Type:New Feature', ''), ('.Backend', '')]",[],
2324174464,issue,closed,completed,Single metadata endpoint for x-ray dashboards,"Follow up for https://github.com/metabase/metabase/pull/43283

Add `/api/automagic-dashboards/:entity/:entity-id-or-query/query_metadata` that returns metadata for all cards and click behaviors (if any) as in https://github.com/metabase/metabase/pull/43283 and https://github.com/metabase/metabase/issues/43319

Currently the FE doesn't use `show` parameter in `/api/automagic-dashboards/:entity/:entity-id-or-query`, so the default value can be used. 
",ranquild,2024-05-29 20:15:19+00:00,['snoe'],2024-06-01 01:18:22+00:00,2024-06-01 01:18:22+00:00,https://github.com/metabase/metabase/issues/43332,"[('Querying/X-rays', ''), ('.Backend', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2324169951,issue,closed,completed,[Epic] Improve dashboard performance,"Fixes https://github.com/metabase/metabase/issues/41468

```[tasklist]
### FE + BE
- [ ] https://github.com/metabase/metabase/issues/43156
- [ ] https://github.com/metabase/metabase/issues/43319
- [ ] https://github.com/metabase/metabase/issues/43334
- [ ] https://github.com/metabase/metabase/issues/43332
- [ ] https://github.com/metabase/metabase/issues/43386
- [ ] https://github.com/metabase/metabase/issues/43378
```

```[tasklist]
### FE
- [ ] https://github.com/metabase/metabase/pull/43312
- [ ] https://github.com/metabase/metabase/pull/43354
- [ ] https://github.com/metabase/metabase/issues/43337
```",ranquild,2024-05-29 20:12:03+00:00,"['snoe', 'ranquild', 'uladzimirdev']",2024-08-07 16:13:48+00:00,2024-08-07 16:13:48+00:00,https://github.com/metabase/metabase/issues/43330,"[('Reporting/Dashboards', ''), ('.Epic', 'Feature Implementation or Project')]",[],
2324027541,issue,open,,Ability to decide where in the chart to put labels/legends,"**Is your feature request related to a problem? Please describe.**
Currently, this is not possible.

**Describe the solution you'd like**
Ability to change the location of the labels in the chart
![Screenshot 2024-05-29 at 3 48 13 PM](https://github.com/metabase/metabase/assets/132273646/cf982648-1c70-42ff-b138-9b365689f364)

For line/bar chart with multiple series, for example, I could change it to the bottom or right parts of the chart.
![Screenshot 2024-05-29 at 3 53 15 PM](https://github.com/metabase/metabase/assets/132273646/baa38f13-c1bd-4459-b727-90fbac45c369)

**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
Requested by a customer, more info [here](https://www.notion.so/metabase/Ellucian-2becbc478e6d49eda446143081a2e820?pvs=4#e24e11648ee54297b80529c6ea24fd7e) 

**Additional context**
Related to https://github.com/metabase/metabase/issues/8437
",ignacio-mb,2024-05-29 18:53:48+00:00,[],2025-02-04 20:31:40+00:00,,https://github.com/metabase/metabase/issues/43326,"[('Type:New Feature', ''), ('Visualization/Chart Settings', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('Visualization/Charts/Row', ''), ('Visualization/Charts/Pie', ''), ('Visualization/Legend', '')]","[{'comment_id': 2166723507, 'issue_id': 2324027541, 'author': 'ignacio-mb', 'body': 'This should also consider the ability to hide the label', 'created_at': datetime.datetime(2024, 6, 13, 20, 37, 53, tzinfo=datetime.timezone.utc)}]","ignacio-mb (Issue Creator) on (2024-06-13 20:37:53 UTC): This should also consider the ability to hide the label

"
2324017613,issue,closed,completed,CSV downloads for pivot tables are missing header row when multiple measures exist,"[Slack context](https://metaboat.slack.com/archives/C064QMXEV9N/p1716992098871809)

Follow up to https://github.com/metabase/metabase/pull/41668/",cdeweyx,2024-05-29 18:48:10+00:00,['adam-james-v'],2024-05-30 21:52:26+00:00,2024-05-30 21:52:26+00:00,https://github.com/metabase/metabase/issues/43325,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Correctness', ''), ('Reporting/Export', ''), ('.Backend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('Visualization/Tables/old-pivoted', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2323977860,issue,closed,not_planned,BE flake: metabase.pulse-test/above-goal-alert-test,"This has flaked at least a few times recently.

logs: 

```
FAIL in metabase.pulse-test/above-goal-alert-test (pulse_test.clj:621)
above goal alert with progress bar sent to :email channel 
with temporary :model/Card with attributes
{:creator_id 1,
 :database_id 1,
 :dataset_query {:database 1, :type :query, :query {:source-table 5, :aggregation [[""max"" 34]]}},
 :display :progress,
 :name ""Test card"",
 :visualization_settings {:progress.goal 3, :graph.dimensions [""DATE""], :graph.metrics [""count""]},
 :created_at #t ""2024-05-29T15:21:56.414194Z[UTC]"",
 :updated_at #t ""2024-05-29T15:21:56.414195Z[UTC]""}

 
with temporary :model/Pulse with attributes
{:creator_id 1,
 :name ""Pulse Name"",
 :created_at #t ""2024-05-29T15:21:56.432626Z[UTC]"",
 :updated_at #t ""2024-05-29T15:21:56.432627Z[UTC]"",
 :alert_condition ""goal"",
 :alert_first_only false,
 :alert_above_goal true}

 
with temporary :model/PulseCard with attributes
{:position 0, :include_csv false, :include_xls false, :pulse_id 263, :card_id 1569}

 
with temporary :model/PulseChannel with attributes
{:channel_type :email,
 :details {},
 :schedule_type :daily,
 :schedule_hour 15,
 :created_at #t ""2024-05-29T15:21:56.438013Z[UTC]"",
 :updated_at #t ""2024-05-29T15:21:56.438014Z[UTC]"",
 :pulse_id 263}

 
with temporary :model/PulseChannelRecipient with attributes
{:user_id 1, :pulse_channel_id 165}

 
Setting :email-smtp-host = ""fake_smtp_host""
 
Setting :email-smtp-port = 587
 
Setting :site-url = ""https://metabase.com/testmb""

expected: {""rasta@metabase.com"" [{:bcc #{""rasta@metabase.com""},
                                  :body [{""Test card"" true}
                                         {:content #<Class@1a6c5a9e java.net.URL>,
                                          :content-id true,
                                          :content-type ""image/png"",
                                          :type :inline}
                                         {:content #<Class@1a6c5a9e java.net.URL>,
                                          :content-id true,
                                          :content-type ""image/png"",
                                          :type :inline}],
                                  :from ""notifications@metabase.com"",
                                  :subject ""Alert: Test card has reached its goal""}]}
  actual: {}
```

[Source here](https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBmbGFrZXMgYnkgc3VpdGUgbmFtZSBhbmQgdGVzdCBuYW1lIChub3QgUVApIiwiZGVzY3JpcHRpb24iOiJodHRwczovL3N0YXRzLm1ldGFiYXNlLmNvbS9tb2RlbC8xNDgyOC10ZXN0LWZsYWtpbmVzcyIsImRhdGFzZXRfcXVlcnkiOnsiZGF0YWJhc2UiOjI2LCJ0eXBlIjoicXVlcnkiLCJxdWVyeSI6eyJhZ2dyZWdhdGlvbiI6W1siY291bnQiXSxbIm1pbiIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl91cmwiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dXV0sImJyZWFrb3V0IjpbWyJmaWVsZCIsInN1aXRlX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLCJ0ZXN0X25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLCJ3b3JrZmxvd19ydW5fc3RhcnRlZF9hdCIseyJiYXNlLXR5cGUiOiJ0eXBlL0RhdGVUaW1lV2l0aExvY2FsVFoiLCJ0ZW1wb3JhbC11bml0IjoiZGF5In1dXSwic291cmNlLXRhYmxlIjoiY2FyZF9fMTQ4MjgiLCJmaWx0ZXIiOlsiYW5kIixbImRvZXMtbm90LWNvbnRhaW4iLFsiZmllbGQiLCJzdWl0ZV9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSwicXVlcnktcHJvY2Vzc29yIix7ImNhc2Utc2Vuc2l0aXZlIjpmYWxzZX1dLFsiY29udGFpbnMiLFsiZmllbGQiLCJ3b3JrZmxvd19qb2JfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sImJlLXRlc3RzLSIseyJjYXNlLXNlbnNpdGl2ZSI6ZmFsc2V9XSxbIj0iLFsiZmllbGQiLCJ0ZXN0X25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJhYm92ZS1nb2FsLWFsZXJ0LXRlc3QiXV19fSwiZGlzcGxheSI6InRhYmxlIiwiZGlzcGxheUlzTG9ja2VkIjp0cnVlLCJwYXJhbWV0ZXJzIjpbXSwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6eyJ0YWJsZS5waXZvdF9jb2x1bW4iOiJzdWl0ZV9uYW1lIiwidGFibGUuY2VsbF9jb2x1bW4iOiJjb3VudCIsInRhYmxlLnBpdm90IjpmYWxzZSwidGFibGUuY29sdW1ucyI6W3sibmFtZSI6InN1aXRlX25hbWUiLCJrZXkiOiJbXCJuYW1lXCIsXCJzdWl0ZV9uYW1lXCJdIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLCJzdWl0ZV9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XX0seyJuYW1lIjoidGVzdF9uYW1lIiwia2V5IjoiW1wibmFtZVwiLFwidGVzdF9uYW1lXCJdIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLCJ0ZXN0X25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dfSx7Im5hbWUiOiJjb3VudCIsImtleSI6IltcIm5hbWVcIixcImNvdW50XCJdIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiYWdncmVnYXRpb24iLDBdfSx7Im5hbWUiOiJ3b3JrZmxvd19ydW5fc3RhcnRlZF9hdCIsImtleSI6IltcIm5hbWVcIixcIndvcmtmbG93X3J1bl9zdGFydGVkX2F0XCJdIiwiZmllbGRSZWYiOlsiZmllbGQiLCJ3b3JrZmxvd19ydW5fc3RhcnRlZF9hdCIseyJiYXNlLXR5cGUiOiJ0eXBlL0RhdGVUaW1lV2l0aExvY2FsVFoiLCJ0ZW1wb3JhbC11bml0IjoiZGF5In1dLCJlbmFibGVkIjp0cnVlfSx7Im5hbWUiOiJtaW4iLCJrZXkiOiJbXCJuYW1lXCIsXCJtaW5cIl0iLCJmaWVsZFJlZiI6WyJhZ2dyZWdhdGlvbiIsMV0sImVuYWJsZWQiOnRydWV9XSwiY29sdW1uX3NldHRpbmdzIjp7IltcIm5hbWVcIixcImNvdW50XCJdIjp7ImNvbHVtbl90aXRsZSI6IkNvdW50In0sIltcIm5hbWVcIixcIm1heFwiXSI6eyJjb2x1bW5fdGl0bGUiOiJMYXN0IGZhaWxlZCBydW4ifSwiW1wibmFtZVwiLFwibWF4XzJcIl0iOnsiY29sdW1uX3RpdGxlIjoiTGFzdCBmYWlsZWQgZGF0ZSIsImRhdGVfc3R5bGUiOiJNTU1NIEQsIFlZWVkiLCJ0aW1lX2VuYWJsZWQiOm51bGx9fX0sIm9yaWdpbmFsX2NhcmRfaWQiOjE1MjEyfQ==)

Possibly related flake: https://github.com/metabase/metabase/issues/43130",calherries,2024-05-29 18:27:41+00:00,['qnkhuat'],2024-06-12 07:48:18+00:00,2024-06-12 07:48:17+00:00,https://github.com/metabase/metabase/issues/43321,"[('.CI & Tests', ''), ('flaky-test-fix', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2162338342, 'issue_id': 2323977860, 'author': 'darksciencebase', 'body': 'closing this as a duplicate in favor of [the bot-created issue](https://github.com/metabase/metabase/issues/44041). this one is older but the bot should not have to adapt to free-text format', 'created_at': datetime.datetime(2024, 6, 12, 7, 48, 17, tzinfo=datetime.timezone.utc)}]","darksciencebase on (2024-06-12 07:48:17 UTC): closing this as a duplicate in favor of [the bot-created issue](https://github.com/metabase/metabase/issues/44041). this one is older but the bot should not have to adapt to free-text format

"
2323960870,issue,closed,not_planned,[Epic] DevEx Projects,"```[tasklist]
### CI
- [x] https://github.com/metabase/metabase/issues/43343
- [ ] https://github.com/metabase/metabase/issues/44364
- [ ] https://github.com/metabase/metabase/issues/44661
- [ ] https://github.com/metabase/metabase/issues/43594
- [ ] https://github.com/metabase/metabase/issues/44952
- [ ] https://github.com/metabase/metabase/issues/44957
- [ ] https://github.com/metabase/metabase/issues/43505
- [ ] https://github.com/metabase/metabase/issues/45009
- [ ] https://github.com/metabase/metabase/issues/44662
- [ ] https://github.com/metabase/metabase/issues/45501
- [ ] #46415
- [ ] https://github.com/metabase/metabase/issues/47500
- [ ] https://github.com/metabase/metabase/issues/48326
- [ ] Basic Performance Testing in CI
```

```[tasklist]
### e2e debugging experience
- [ ] https://github.com/metabase/metabase/issues/46870
- [ ] https://github.com/metabase/metabase/issues/46954
- [ ] add names of falining tests to annotation of github actions page
```


```[tasklist]
### Release
- [ ] https://github.com/metabase/metabase/issues/43504
- [ ] https://github.com/metabase/metabase/pull/36420
- [ ] https://github.com/metabase/metabase/pull/39634
- [ ] https://github.com/metabase/metabase/pull/37613
- [ ] https://github.com/metabase/metabase/issues/43627
- [ ] https://github.com/metabase/metabase/issues/44117
- [ ] https://github.com/metabase/metabase/issues/44154
- [ ] https://github.com/metabase/metabase/issues/44123
- [ ] https://github.com/metabase/metabase/pull/44663
- [ ] https://github.com/metabase/metabase/issues/45353
- [ ] https://github.com/metabase/metabase/pull/45048
- [ ] https://github.com/metabase/metabase/issues/44037
- [ ] https://github.com/metabase/metabase/issues/47785
- [ ] https://github.com/metabase/metabase/issues/47786
- [ ] https://github.com/metabase/metabase/issues/48281
- [ ] https://github.com/metabase/metabase/issues/48121
- [ ] https://github.com/metabase/metabase/issues/46838
- [ ] https://github.com/metabase/metabase/issues/48627
- [ ] https://github.com/metabase/metabase/pull/49340
- [ ] https://github.com/metabase/metabase/issues/50741
- [ ] https://github.com/metabase/metabase/issues/50742
- [ ] Notify on ee-extra build/merge failures
- [ ] Integrate third party driver tests into release process?
```

```[tasklist]
### Misc
- [x] Create Devex Survey
- [x] Create Devex Dashboard
- [ ] https://github.com/metabase/metabase/pull/43420
- [ ] https://github.com/metabase/metabase/issues/43419
- [ ] https://github.com/metabase/metabase/pull/44401
- [ ] https://github.com/metabase/metabase/issues/46424
- [ ] https://github.com/metabase/metabase/issues/47118
- [ ] https://github.com/metabase/metabase/issues/46823
- [ ] https://github.com/metabase/metabase/issues/47165
```
```[tasklist]
### Requests from developers
- [ ] https://github.com/metabase/metabase/issues/45698
- [ ] https://github.com/metabase/metabase/issues/47087
- [ ] https://github.com/metabase/metabase/issues/46889
- [ ] https://github.com/metabase/metabase/issues/46869
- [ ] https://github.com/metabase/metabase/issues/46840
- [ ] https://github.com/metabase/metabase/issues/46962
- [ ] Introduce a way to check if new code adds new warnings or errors in console and fail CI
- [ ] Get rid of prop-types warnings from browser console
```
```[tasklist]
### jest unit tests
- [ ] https://github.com/metabase/metabase/issues/46264
- [ ] specify node env for tests which do not require DOM
- [ ] bundle cljs files for unit tests - so we can skip a huge step on requiring cljs files for every single test
```

```[tasklist]
### CI build time improvements
- [x] migrate from babel to swc - finish prior work from Roman
- [x] remove duplicated build steps
- [ ] https://github.com/metabase/metabase/issues/47025
- [ ] https://github.com/metabase/metabase/issues/45700
- [ ] https://github.com/metabase/metabase/issues/37576
- [ ] https://github.com/metabase/metabase/issues/36336
```
",iethree,2024-05-29 18:18:44+00:00,['iethree'],2025-02-07 15:39:32+00:00,2025-02-07 15:39:31+00:00,https://github.com/metabase/metabase/issues/43320,"[('.Building & Releasing', ''), ('.CI & Tests', ''), ('.Epic', 'Feature Implementation or Project')]",[],
2323944536,issue,closed,completed,Add metadata for click behaviors in `/api/dashboard/:id/query_metadata`,"Follow up for https://github.com/metabase/metabase/issues/43156

We load metadata for queries referenced by cards with the new endpoint, but we also need to load metadata for questions and dashboards used in custom click behaviors.

Currently, the shape of the response is:
```
{
  databases: Database[],
  tables: Table[],
  fields: Field[],
}
```

We'll extend it and add `cards` and `dashboards`:
```
{
  ...
  cards: Card[],
  dashboards: Dashboard[],
}
```

Dashboard with click behaviors referencing questions and dashboards looks like this:

```
{
  ""dashcards"": [
    {
      ""visualization_settings"": {
        ""column_settings"": {
          ""[\""ref\"",[\""field\"",10,null]]"": {
            ""click_behavior"": {
              ""type"": ""link"", // only ""link""
              ""linkType"": ""dashboard"", // could be ""question"" or ""dashboard""
              ""targetId"": 11, // id of the dashboard or question
              ""parameterMapping"": {}
            }
          }
        }
      }
    }
  ]
}
```

1. For `linkType = ""dashboard""`, we need to load `/api/dashboard/:id`,
2. For `linkType = ""question""`, we need to load the card `/api/card/:id` **and** query metadata for this card. This should follow the same logic used for other cards on the dashboard.

Ignore unaccessible entries in all cases.
",ranquild,2024-05-29 18:11:02+00:00,['snoe'],2024-10-08 17:09:50+00:00,2024-05-31 13:26:45+00:00,https://github.com/metabase/metabase/issues/43319,"[('.Backend', ''), ('Reporting/Dashboards/Click Behavior', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2323372009,issue,open,,[BE] Ensure that serdes works for the new keys,,bshepherdson,2024-05-29 13:42:13+00:00,[],2024-08-16 13:24:07+00:00,,https://github.com/metabase/metabase/issues/43311,"[('.Backend', ''), ('.Team/Querying', '')]",[],
2323371880,issue,open,,[BE] Rewrite old viz settings on reading a previously saved card,,bshepherdson,2024-05-29 13:42:10+00:00,[],2024-08-16 13:25:03+00:00,,https://github.com/metabase/metabase/issues/43310,"[('.Backend', ''), ('.Team/Querying', '')]",[],
2323371798,issue,open,,[BE] Use `desired-column-alias` in static viz,,bshepherdson,2024-05-29 13:42:07+00:00,[],2025-02-04 20:31:52+00:00,,https://github.com/metabase/metabase/issues/43309,"[('.Backend', ''), ('Visualization/Static', 'Subscriptions/pulse generated image'), ('.Team/Querying', '')]",[],
2323371715,issue,open,,[FE] Use `desired-column-alias` for all viz settings (as opaque as possible),,bshepherdson,2024-05-29 13:42:05+00:00,[],2024-05-29 13:44:18+00:00,,https://github.com/metabase/metabase/issues/43308,"[('.Frontend', '')]",[],
2323371574,issue,closed,completed,[BE] Expose `desired-column-alias` on `result_metadata` and `data.cols` in responses.,,bshepherdson,2024-05-29 13:42:02+00:00,['bshepherdson'],2024-06-17 15:25:05+00:00,2024-06-17 15:25:05+00:00,https://github.com/metabase/metabase/issues/43307,"[('Visualization/Chart Settings', '')]",[],
2323370731,issue,closed,completed,[Epic] Remove field refs from viz settings,"**Links**
- product doc: None - eng-led project
- [eng doc](https://www.notion.so/metabase/Tech-Remove-field-refs-from-viz-settings-bec453dc75bd40efb54a1ddb83acd536)
- feature branch: `viz-settings-deref`
- issue links: _This definitely is expected to fix several open issues but I don't have a list handy._

**Implementation Plan**


***Milestone 1: Foundation***

- [x] #43467
- [x] #43307

***Milestone 2: Consumption***

- [ ] #43308
- [ ] #43309

***Milestone 3: Storage***

- [ ] #43310
- [ ] #43311

**Future work**

`desired-column-alias` does not include the temporal unit of a breakout (nor should it). However, if we want to support multiple breakouts on the same column we need an alternative way to reference them, including from viz settings.

Similarly, `desired-column-alias` doesn't avoid the dangling refs issue: if there are, say, three `SUM` aggregations on different fields (`sum`, `sum_2` and `sum_3`) and they have viz settings defined, then deleting the middle one will result in dangling viz-settings for `sum_3` _and_ wrongly using the old `sum_2` viz settings for what is really `sum_3`.",bshepherdson,2024-05-29 13:41:39+00:00,"['bshepherdson', 'ranquild']",2024-07-17 15:12:57+00:00,2024-07-17 15:12:56+00:00,https://github.com/metabase/metabase/issues/43306,"[('Type:Tech Debt', 'or Refactoring'), ('.Backend', ''), ('.Epic', 'Feature Implementation or Project')]","[{'comment_id': 2233565516, 'issue_id': 2323370731, 'author': 'NevRA', 'body': 'Decided to proceed in a dedicated epic', 'created_at': datetime.datetime(2024, 7, 17, 15, 12, 57, tzinfo=datetime.timezone.utc)}]","NevRA on (2024-07-17 15:12:57 UTC): Decided to proceed in a dedicated epic

"
2323334729,issue,closed,not_planned,Question crashes upon entering string in custom column expression,"### Describe the bug

I could not find this bug in past reports.

When I create a Custom Column, enter ""string"" in the expression, and try to name the column, the question immediately crashes. I tried this with both Models and Raw Data, and the same behavior occurs. 
![Screenshot 2024-05-29 at 15 13 33](https://github.com/metabase/metabase/assets/20630578/c5a484dc-a97b-481f-a17b-3df2a5bec20b)
![Screenshot 2024-05-29 at 15 13 14](https://github.com/metabase/metabase/assets/20630578/a56b1872-e9c4-40f4-bb66-f8503faed981)

When I create a metric in Table Metadata in the Admin and enter ""string"" in the expression when trying to make a custom column, I get the error ""Expecting aggregation but found ""string"""". This is the error I would expect to see in the question as well.
![Screenshot 2024-05-29 at 15 18 42](https://github.com/metabase/metabase/assets/20630578/8746a81e-f44d-4f2b-b09e-c192735916e7)


### To Reproduce

1. Click on '+ New', then 'Question'
2. Select Sample Database
3. Click the '+' under the data that shows 'Custom column"" upon hovering
4. Insert any text between quotes (i.e. ""string"")


### Expected behavior

 An error message with ""Expecting aggregation but found ""string"""".

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.215-203.850.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-13"",
      ""tag"": ""v1.49.10"",
      ""hash"": ""9e8fc83""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Not severe

### Additional context

_No response_",annebelleo,2024-05-29 13:26:43+00:00,[],2024-05-29 13:43:37+00:00,2024-05-29 13:43:36+00:00,https://github.com/metabase/metabase/issues/43305,"[('Type:Bug', 'Product defects'), ('.Frontend', ''), ('.Needs Triage', ''), ('Querying/Notebook/Custom Column', '')]","[{'comment_id': 2137452424, 'issue_id': 2323334729, 'author': 'annebelleo', 'body': 'Oops, duplicate of #34776', 'created_at': datetime.datetime(2024, 5, 29, 13, 43, 37, tzinfo=datetime.timezone.utc)}]","annebelleo (Issue Creator) on (2024-05-29 13:43:37 UTC): Oops, duplicate of #34776

"
2323152626,issue,closed,completed,Runtime errors when drilling down on Interactive Question component using SDK,"### Describe the bug

Runtime errors when drilling down

### To Reproduce

1. Embed an interactive question component
2. Drill down (see these records)
3. The table loads but there are uncaught runtime errors

Loom: https://www.loom.com/share/2deefad86e1442108a2a71a24065e8f4

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
- SDK npm v0.1.5
```


### Severity

P2

### Additional context

_No response_",albertoperdomo,2024-05-29 12:04:41+00:00,[],2024-11-08 16:09:36+00:00,2024-11-08 16:09:34+00:00,https://github.com/metabase/metabase/issues/43304,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Embedding/Interactive', 'Interactive Embedding, previously known as Full app embedding'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2137250266, 'issue_id': 2323152626, 'author': 'albertoperdomo', 'body': ""Related to https://github.com/metabase/metabase/issues/42352. We fixed the loading state, but we didn't remove the runtime errors."", 'created_at': datetime.datetime(2024, 5, 29, 12, 5, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2137355623, 'issue_id': 2323152626, 'author': 'WiNloSt', 'body': ""[We discussed that ](https://metaboat.slack.com/archives/C063Q3F1HPF/p1716985096688679?thread_ts=1716983463.904489&cid=C063Q3F1HPF)it's okay to prevent this specific error from surfacing to users for now if we can't fix the root cause."", 'created_at': datetime.datetime(2024, 5, 29, 12, 58, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2424797117, 'issue_id': 2323152626, 'author': 'albertoperdomo', 'body': ""I've tested again with 0.1.40 using https://github.com/metabase/metabase-nodejs-react-sdk-embedding-sample and getting the following error:\n\n![Image](https://github.com/user-attachments/assets/cde059ce-3954-4736-b02c-c86baad6a05e)"", 'created_at': datetime.datetime(2024, 10, 20, 9, 57, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2465137564, 'issue_id': 2323152626, 'author': 'albertoperdomo', 'body': 'The latest error is tracked at https://github.com/metabase/metabase/issues/47563 and was closed via https://github.com/metabase/metabase/pull/49064', 'created_at': datetime.datetime(2024, 11, 8, 16, 9, 34, tzinfo=datetime.timezone.utc)}]","albertoperdomo (Issue Creator) on (2024-05-29 12:05:48 UTC): Related to https://github.com/metabase/metabase/issues/42352. We fixed the loading state, but we didn't remove the runtime errors.

WiNloSt on (2024-05-29 12:58:35 UTC): [We discussed that ](https://metaboat.slack.com/archives/C063Q3F1HPF/p1716985096688679?thread_ts=1716983463.904489&cid=C063Q3F1HPF)it's okay to prevent this specific error from surfacing to users for now if we can't fix the root cause.

albertoperdomo (Issue Creator) on (2024-10-20 09:57:14 UTC): I've tested again with 0.1.40 using https://github.com/metabase/metabase-nodejs-react-sdk-embedding-sample and getting the following error:

![Image](https://github.com/user-attachments/assets/cde059ce-3954-4736-b02c-c86baad6a05e)

albertoperdomo (Issue Creator) on (2024-11-08 16:09:34 UTC): The latest error is tracked at https://github.com/metabase/metabase/issues/47563 and was closed via https://github.com/metabase/metabase/pull/49064

"
2323027827,issue,closed,completed,Change the criteria for Recents in the Data Picker,"Currently when opening the Data Picker we open the Recents tab where show everything you **viewed** recently.
Although this criteria is totally valid to show Recents in other places like search, it is not helpful at all while picking the data source.
Instead of what you viewed recently you would want to see there all the stuff you recently **picked as the data source** for a new question or model or metric.",mngr,2024-05-29 11:01:21+00:00,['escherize'],2024-08-22 21:03:24+00:00,2024-06-14 17:52:43+00:00,https://github.com/metabase/metabase/issues/43300,"[('.Frontend', ''), ('.Backend', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template')]","[{'comment_id': 2137799051, 'issue_id': 2323027827, 'author': 'iethree', 'body': 'see [discussion](https://metaboat.slack.com/archives/C064EB1UE5P/p1716996274007719) re potentially logging ""selections"" independent of ""views"" so that we can slice these things more finely in various places', 'created_at': datetime.datetime(2024, 5, 29, 16, 17, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2138277612, 'issue_id': 2323027827, 'author': 'escherize', 'body': 'Summarizing our decisions regarding this idea:\r\n\r\n## API To track selection events:\r\n\r\n- `POST /api/activity/recents`\r\nWhenever a selection occurs, the frontend will send a post body like:\r\n```\r\n{\r\n  id: number, \r\n  model: \'card\' | \'dataset\' | \'dashboard\' | \'table\' | \'collection\',\r\n  context: \'selection\'\r\n}\r\n```\r\n\r\n## API To read recently selected + viewed items\r\n\r\ncontext is a required query parameter, and dictate what keys will be in the response.\r\n\r\n1. `GET /api/activity/recents?context=view`\r\nreturns recent view items only\r\n\r\n```\r\n{""recent_views"": [Items...]}\r\n```\r\n\r\n(n.b. this is the exact same thing as `/api/activity/recent_views`)\r\n\r\n2. `GET /api/activity/recents?context=selection` \r\nto get only views or recently-selected items:\r\n\r\n```\r\n{""recent_selections"": [Items...]}\r\n```\r\n\r\n3. `GET /api/activity/recents?context=all` \r\ngets both, under the 2 keys: \r\n\r\n```\r\n{""recent_views"": [Items...],\r\n ""recent_selections"": [Items...]}\r\n```\r\n\r\n----\r\n\r\n## Backend details\r\n\r\nWe should add `context`, a non-nullable text column to the `recent_views` table, that can be used to differentiate these two kinds of views. That should allow for easily expanding the recents purview.\r\n\r\nThe 4 or 5 big queries will need to be parameterized with context: either `selection`, `view`, or both of them, so we can keep the query upfront. We can still pass everything through\r\n\r\n### Garbage Collection\r\n\r\nFor deduplication, we would need to delete all but the most recent values for all rows with the same `(user_id, model_type, model_id, context)` therefore context will need to be considered here. Then for compaction, we delete all but the latest 20 items per `user_id x model_type x model_id x context`\r\n\r\n- As it is now, we make a query for duplicate items, and delete all but the newest entry when there is a collision on `(user_id, model_type, model_id, context)`. I think it is time to closely consider improving the recent_views schema, to be unique on those fields, and simply do upserts when there is a collision on (user_id, model_type, model_id, context). This will let us stop doing manual deduplication.\r\n\r\n\r\n-----\r\n\r\n- [x] Add `POST /api/activity/recents` to record selection events (.5 days)\r\n- [x] Create the `GET /api/activity/recents?context=view` endpoint (.3 days)\r\n- [x] Update db schema + backend to return selection events (2 days)\r\n- [x] Compaction on multiple contexts (1 day)\r\n- [x] Update the api to be able to return both (1 day)\r\n- [x] e2e tests + ci', 'created_at': datetime.datetime(2024, 5, 29, 21, 16, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147827512, 'issue_id': 2323027827, 'author': 'escherize', 'body': ""Frontend Tasks:\r\n\r\n1. [x] Adding a request to `POST /api/activity/recents` to record selection events\r\n2. [x] Update the request for `GET /api/activity/recent_items` in the data picker to `GET /api/activity/recents?context=selection`, and use that list instead (the exact same shape is returned, so nothing else to do there).\r\n\r\n----\r\n\r\n### `POST /api/activity/recents`\r\nWhenever a selection occurs, the client will send a post body like:\r\n```\r\n{\r\n  id: number,\r\n  model: 'card' | 'dataset' | 'dashboard' | 'table' | 'collection',\r\n  context: 'selection',\r\n}\r\n```"", 'created_at': datetime.datetime(2024, 6, 4, 15, 30, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168501157, 'issue_id': 2323027827, 'author': 'dpsutton', 'body': 'closed by https://github.com/metabase/metabase/pull/43478', 'created_at': datetime.datetime(2024, 6, 14, 17, 52, 43, tzinfo=datetime.timezone.utc)}]","iethree on (2024-05-29 16:17:32 UTC): see [discussion](https://metaboat.slack.com/archives/C064EB1UE5P/p1716996274007719) re potentially logging ""selections"" independent of ""views"" so that we can slice these things more finely in various places

escherize (Assginee) on (2024-05-29 21:16:04 UTC): Summarizing our decisions regarding this idea:

## API To track selection events:

- `POST /api/activity/recents`
Whenever a selection occurs, the frontend will send a post body like:
```
{
  id: number, 
  model: 'card' | 'dataset' | 'dashboard' | 'table' | 'collection',
  context: 'selection'
}
```

## API To read recently selected + viewed items

context is a required query parameter, and dictate what keys will be in the response.

1. `GET /api/activity/recents?context=view`
returns recent view items only

```
{""recent_views"": [Items...]}
```

(n.b. this is the exact same thing as `/api/activity/recent_views`)

2. `GET /api/activity/recents?context=selection` 
to get only views or recently-selected items:

```
{""recent_selections"": [Items...]}
```

3. `GET /api/activity/recents?context=all` 
gets both, under the 2 keys: 

```
{""recent_views"": [Items...],
 ""recent_selections"": [Items...]}
```

----

## Backend details

We should add `context`, a non-nullable text column to the `recent_views` table, that can be used to differentiate these two kinds of views. That should allow for easily expanding the recents purview.

The 4 or 5 big queries will need to be parameterized with context: either `selection`, `view`, or both of them, so we can keep the query upfront. We can still pass everything through

### Garbage Collection

For deduplication, we would need to delete all but the most recent values for all rows with the same `(user_id, model_type, model_id, context)` therefore context will need to be considered here. Then for compaction, we delete all but the latest 20 items per `user_id x model_type x model_id x context`

- As it is now, we make a query for duplicate items, and delete all but the newest entry when there is a collision on `(user_id, model_type, model_id, context)`. I think it is time to closely consider improving the recent_views schema, to be unique on those fields, and simply do upserts when there is a collision on (user_id, model_type, model_id, context). This will let us stop doing manual deduplication.


-----

- [x] Add `POST /api/activity/recents` to record selection events (.5 days)
- [x] Create the `GET /api/activity/recents?context=view` endpoint (.3 days)
- [x] Update db schema + backend to return selection events (2 days)
- [x] Compaction on multiple contexts (1 day)
- [x] Update the api to be able to return both (1 day)
- [x] e2e tests + ci

escherize (Assginee) on (2024-06-04 15:30:10 UTC): Frontend Tasks:

1. [x] Adding a request to `POST /api/activity/recents` to record selection events
2. [x] Update the request for `GET /api/activity/recent_items` in the data picker to `GET /api/activity/recents?context=selection`, and use that list instead (the exact same shape is returned, so nothing else to do there).

----

### `POST /api/activity/recents`
Whenever a selection occurs, the client will send a post body like:
```
{
  id: number,
  model: 'card' | 'dataset' | 'dashboard' | 'table' | 'collection',
  context: 'selection',
}
```

dpsutton on (2024-06-14 17:52:43 UTC): closed by https://github.com/metabase/metabase/pull/43478

"
2322946964,issue,closed,not_planned,Can I please get an update on this ticket https://github.com/metabase/metabase/issues/38687,"**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**How important is this feature to you?**

**Additional context**
Add any other context or screenshots about the feature request here.

<img width=""939"" alt=""Screenshot 2024-05-29 at 6 19 22 AM"" src=""https://github.com/metabase/metabase/assets/121153315/244647e7-8526-4723-b746-acaba681224b"">
",OdinTallBeard,2024-05-29 10:19:57+00:00,[],2024-05-29 12:47:39+00:00,2024-05-29 12:47:39+00:00,https://github.com/metabase/metabase/issues/43299,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2137332906, 'issue_id': 2322946964, 'author': 'paoliniluis', 'body': ""there's no need to open several issues for us to take something into consideration, you need to know that we read every single comment on every single issue, and if we don't answer it's not because we haven't seen it, but because there's no progress on the matter. We have limited resources and we can't tackle every single thing that comes to us and we need to prioritize"", 'created_at': datetime.datetime(2024, 5, 29, 12, 47, 39, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-05-29 12:47:39 UTC): there's no need to open several issues for us to take something into consideration, you need to know that we read every single comment on every single issue, and if we don't answer it's not because we haven't seen it, but because there's no progress on the matter. We have limited resources and we can't tackle every single thing that comes to us and we need to prioritize

"
2322945330,issue,closed,not_planned,Can I please get an update on this ticket ,"**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**How important is this feature to you?**

**Additional context**
Add any other context or screenshots about the feature request here.
",OdinTallBeard,2024-05-29 10:19:03+00:00,[],2024-05-29 12:45:37+00:00,2024-05-29 12:45:37+00:00,https://github.com/metabase/metabase/issues/43298,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2137328372, 'issue_id': 2322945330, 'author': 'paoliniluis', 'body': 'sorry, what ticket?', 'created_at': datetime.datetime(2024, 5, 29, 12, 45, 33, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-05-29 12:45:33 UTC): sorry, what ticket?

"
2322941485,issue,closed,not_planned,Pleas reopen this ticket https://github.com/metabase/metabase/issues/30315,"### Describe the bug

https://github.com/metabase/metabase/issues/30315

### To Reproduce

1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
https://github.com/metabase/metabase/issues/30315
```


### Severity

10/10

### Additional context

_No response_",OdinTallBeard,2024-05-29 10:17:06+00:00,[],2024-05-29 10:18:38+00:00,2024-05-29 10:18:38+00:00,https://github.com/metabase/metabase/issues/43297,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2137063664, 'issue_id': 2322941485, 'author': 'Tony-metabase', 'body': 'https://github.com/metabase/metabase/issues/30315', 'created_at': datetime.datetime(2024, 5, 29, 10, 18, 38, tzinfo=datetime.timezone.utc)}]","Tony-metabase on (2024-05-29 10:18:38 UTC): https://github.com/metabase/metabase/issues/30315

"
2322774420,issue,closed,completed,Table loses visualization settings when using a click action,"### Describe the bug

When adding a column through the ""Add column"" shortcut, the viz settings get lost.

### To Reproduce

1. Browse data -> Sample database -> Orders
2. Add a visualisation (anything other than table, settingsdo not matter)
3. At the bottom, toggle data view which shows the table
4. Use one of the click actions:
  a. Add a new column from this view (using the the column shortcut icon in the header ""+"")
  b. Sort by a particular column
  c. Filter by a particular column
5. The viz type has changed from Line to Table

### Expected behavior

The visualization settings should be preserved.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-05-28"",
      ""src_hash"": ""4948d23809d918a1761d6298d51caf6ab1588fb8"",
      ""tag"": ""v0.1.6-SNAPSHOT"",
      ""hash"": ""868a441""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-05-29 09:02:13+00:00,['ranquild'],2024-06-24 14:24:42+00:00,2024-06-24 13:08:33+00:00,https://github.com/metabase/metabase/issues/43294,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/MBQL', ''), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2322649685,issue,closed,completed,[ParseSQL] Handle shadowed names properly with find-and-replace,,tsmacdonald,2024-05-29 08:02:41+00:00,['crisptrutski'],2024-06-06 10:57:56+00:00,2024-06-06 10:57:56+00:00,https://github.com/metabase/metabase/issues/43291,"[('.Backend', ''), ('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]","[{'comment_id': 2151798187, 'issue_id': 2322649685, 'author': 'crisptrutski', 'body': '@tsmacdonald some additional details on the requirements here would be helpful. \r\n\r\nThe example we discussed in Slack already seems to be supported since we did the qualifier work, see the [following test](https://github.com/metabase/macaw/blob/4087b86/test/macaw/core_test.clj#L407-L419).', 'created_at': datetime.datetime(2024, 6, 6, 9, 13, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2151986801, 'issue_id': 2322649685, 'author': 'tsmacdonald', 'body': '@crisptrutski this might deserve to be a separate issue (sorry for bad project management here) but I think now is the time to deal with your embedded model / transparent field ref business, which will require work on both the Metabase and Macaw side. Like\r\n\r\n```sql\r\n-- card 123\r\nSELECT total FROM orders WHERE subtotal > 100\r\n\r\n-- card 321\r\nSELECT total FROM {{#123}}\r\n\r\n/*\r\nwe want to replace orders.total with orders.amount\r\n*/\r\n\r\n-- either:\r\n-- new card 123\r\nSELECT amount AS total FROM orders WHERE subtotal > 100\r\n\r\n-- new card 321\r\nSELECT total FROM {{#123}} -- unchanged\r\n\r\n-- or, and I think preferably:\r\n-- new card 123\r\nSELECT amount from orders WHERE subtotal > 100\r\n\r\n-- new card 321\r\nSELECT amount FROM {{#123}}\r\n```', 'created_at': datetime.datetime(2024, 6, 6, 10, 48, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2152002824, 'issue_id': 2322649685, 'author': 'crisptrutski', 'body': ""Yeah, I was also thinking it's a good time to pick that up 👍"", 'created_at': datetime.datetime(2024, 6, 6, 10, 53, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2152011875, 'issue_id': 2322649685, 'author': 'crisptrutski', 'body': 'Closing this ticket to finish off where I see the scope of Milestone 5b ending, opening a new issue for tracking how fields are exposed to other cards.', 'created_at': datetime.datetime(2024, 6, 6, 10, 56, 26, tzinfo=datetime.timezone.utc)}]","crisptrutski (Assginee) on (2024-06-06 09:13:58 UTC): @tsmacdonald some additional details on the requirements here would be helpful. 

The example we discussed in Slack already seems to be supported since we did the qualifier work, see the [following test](https://github.com/metabase/macaw/blob/4087b86/test/macaw/core_test.clj#L407-L419).

tsmacdonald (Issue Creator) on (2024-06-06 10:48:57 UTC): @crisptrutski this might deserve to be a separate issue (sorry for bad project management here) but I think now is the time to deal with your embedded model / transparent field ref business, which will require work on both the Metabase and Macaw side. Like

```sql
-- card 123
SELECT total FROM orders WHERE subtotal > 100

-- card 321
SELECT total FROM {{#123}}

/*
we want to replace orders.total with orders.amount
*/

-- either:
-- new card 123
SELECT amount AS total FROM orders WHERE subtotal > 100

-- new card 321
SELECT total FROM {{#123}} -- unchanged

-- or, and I think preferably:
-- new card 123
SELECT amount from orders WHERE subtotal > 100

-- new card 321
SELECT amount FROM {{#123}}
```

crisptrutski (Assginee) on (2024-06-06 10:53:38 UTC): Yeah, I was also thinking it's a good time to pick that up 👍

crisptrutski (Assginee) on (2024-06-06 10:56:26 UTC): Closing this ticket to finish off where I see the scope of Milestone 5b ending, opening a new issue for tracking how fields are exposed to other cards.

"
2322573634,issue,closed,completed,Use MultiAutocomplete in dashboard filters too,,romeovs,2024-05-29 07:26:32+00:00,[],2024-06-17 06:39:05+00:00,2024-06-14 08:04:19+00:00,https://github.com/metabase/metabase/issues/43290,"[('.Frontend', '')]",[],
2322450728,issue,closed,completed,rename `PublicDashboard` to `PublicOrEmbeddedDashboard` and isPublic to isPublicOrEmbed,,npretto,2024-05-29 06:15:07+00:00,['npretto'],2024-06-10 20:38:24+00:00,2024-05-31 10:45:05+00:00,https://github.com/metabase/metabase/issues/43289,[],[],
2321980942,issue,open,,Manual Sort of Series on Dashcards Should be Sticky when Additional Series are Added,"**Is your feature request related to a problem? Please describe.**
If you have a dashboard cards with many series and you manually sort them - the sort order is lost when an additional series is added to the card. If you only have a few series this isn't a big deal - but if you're manually sorting 20 - 30 and then have to redo this on each dashboard that you add an additional series to it becomes very cumbersome very quickly.

**Describe the solution you'd like**
If an additional series is added the series sort from the base card should be sticky by default and editable from the visualization settings for the dashcard. 

**Describe alternatives you've considered**
Manually renaming the titles of the plotted series to force sort order.

**Additional context**
Short Loom to illustrate the struggle: https://www.loom.com/share/ce8d794176f64b0daea40dccd33e2295
",ixipixi,2024-05-28 21:53:12+00:00,[],2024-06-04 14:26:21+00:00,,https://github.com/metabase/metabase/issues/43278,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('Visualization/Chart Settings', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.')]",[],
2321877336,issue,closed,completed,show a toast with auto-connect button for newly added dashcards,"- when new card is added to the dashboard, we need to show a toast with suggestion to auto-connect",uladzimirdev,2024-05-28 20:34:10+00:00,['uladzimirdev'],2024-10-08 17:08:22+00:00,2024-06-10 19:19:19+00:00,https://github.com/metabase/metabase/issues/43268,"[('.Team/Querying', '')]",[],
2321811212,issue,closed,completed,Remove usage of `color-mod` from css files,"Currently we use postcss [color-mod functions](https://github.com/csstools/postcss-color-mod-function) to generate some colors for dashboards.

Those work only during compile-time and generate static rgba colors, which won't change based on theme config.
We should refactor this to work with provided theme.

Here are all unique usages of `color-mod`:
```
color-mod(var(--color-text-white) alpha(-14%));

color-mod(var(--mb-color-bg-black) alpha(-40%));
color-mod(var(--mb-color-bg-black) alpha(-99%));

color-mod(var(--mb-color-bg-white) alpha(-28%));
color-mod(var(--mb-color-bg-white) alpha(-85%));
color-mod(var(--mb-color-bg-white) alpha(-86%));

color-mod(var(--mb-color-border) alpha(-70%));
color-mod(var(--mb-color-border) alpha(-80%));
color-mod(var(--mb-color-border) blackness(12%));
color-mod(var(--mb-color-border) blackness(5%));


``` 

We should generate colors for these cases based on provided theme ([like this](https://github.com/metabase/metabase/blob/35a6544b799af28b1891d4f6200d7450ae48419f/frontend/src/metabase/lib/colors/palette.ts#L61)), expose them as CSS variables and use them in CSS files.

DoD: postcss-color-mod-function dependency has been removed from package.json",deniskaber,2024-05-28 19:54:14+00:00,['heypoom'],2024-10-08 17:07:29+00:00,2024-06-14 13:29:15+00:00,https://github.com/metabase/metabase/issues/43265,"[('.CSS', ''), ('.Team/Embedding', '')]",[],
2321748972,issue,closed,completed,[Browse] Filter toggle should be absent if there are no verified models,,rafpaf,2024-05-28 19:13:42+00:00,[],2024-06-10 20:35:07+00:00,2024-06-04 02:21:23+00:00,https://github.com/metabase/metabase/issues/43262,[],[],
2321739856,issue,closed,completed,Generating an x-ray on a line chart on big tables will generate a massive x-ray that will lock up the browser,"### Describe the bug

A customer has a very big table, which they use to generate a simple line chart. They found that when they use an x-ray on a data point the x-ray generated is massive

### To Reproduce

1) set up Metabase with a postgres db
2) load this massive dataset https://drive.google.com/file/d/1rbp2or3Kdoc6Fy-9j1m2HCA4NvOEa2A9/view?usp=sharing
3) do a very simple question like
![image](https://github.com/metabase/metabase/assets/1711649/8598b4d9-52c5-4648-a232-b83d76485214)

4) then click on any data point ->automatic insights- >x-rays
![image](https://github.com/metabase/metabase/assets/1711649/d844b078-af1d-4d3f-b5ca-2581fbff53f9)

you'll get an ultra massive dashboard that locks up the browser and probably the server as well

### Expected behavior

we need product on this

### Logs

NA

### Information about your Metabase installation

```JSON
since the very beginning
```


### Severity

P1

### Additional context

NA",paoliniluis,2024-05-28 19:07:32+00:00,['piranha'],2024-12-24 11:38:19+00:00,2024-07-23 07:39:41+00:00,https://github.com/metabase/metabase/issues/43258,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Performance', ''), ('Querying/X-rays', ''), ('.Backend', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2178437159, 'issue_id': 2321739856, 'author': 'darksciencebase', 'body': '[thread mentioning slowness in the tests as well](https://metaboat.slack.com/archives/C0641E4PB9B/p1718637304256719). if this turns out to be a separate issue, we should create a new ticket', 'created_at': datetime.datetime(2024, 6, 19, 11, 24, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2199801145, 'issue_id': 2321739856, 'author': 'piranha', 'body': 'My findings: the `automagic-dashboards/adhoc/.../cell/...` API returns a dashboard with 311 cards (16 kb json) in ~5 seconds, and `automagic-dashboards/adhoc/.../query_metadata` returns a table with 500 fields (23 kb json) in ~10 seconds (this happens in parallel). \r\n\r\nBrowser is perfectly responsive during this time (obviously), but then locks up to generate queries for every card at the same time. If I profile JS, it indicates that LOTS of functions is called (and the functions are not small either, each one of them takes about 20-23 ms).\r\n\r\n<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6553/69ef7cf4-ca33-463b-adbe-e5261b8a2074"">\r\n\r\nFor example, DashCardInner, after following all the nesting, ends up calling `getUrlWithParameters` (takes 23 ms), which in turns calls `getUrl` (which spends 11.1ms in `fromLegacyQuery`) and `query` (which also spends 11.1ms in `fromLegacyQuery`). Most of the time of `fromLegacyQuery` is spent in `metabase$lib$schema$join_ref_error_for_stages`.\r\n\r\nThis issue can be tackled from three sides:\r\n\r\n- Limit amount of work to be done, i.e. don\'t render so many cards at once (or least do that with pagination)\r\n  - Either from server side, this can also speed up initial responses, and will help not to lock UI as much\r\n  - Or for client side, just render whatever the client will see first and then reveal/fetch data on scroll, that will also help with UI locking and the API will stay simple with no pagination as it is right now\r\n- Optimize `metabase$lib$schema$join_ref_error_for_stages` (and possibly other functions), it needs to be much faster to be used like it is used right now.\r\n\r\nJust in case, [profile is here](https://drive.google.com/file/d/1-ekg0bH17TmSb9Hecj9W33kUgtzI9y0w/view?usp=sharing), if you want to see it without reproducing (profiler misbehaves seeing this page too 🤣).', 'created_at': datetime.datetime(2024, 7, 1, 10, 35, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2206387753, 'issue_id': 2321739856, 'author': 'kamilmielnik', 'body': ""> For example, DashCardInner, after following all the nesting, ends up calling `getUrlWithParameters` (takes 23 ms),\r\n\r\nThis was due to [Copy question link from dashboard](https://www.notion.so/metabase/Copy-question-link-from-dashboard-702fe6ec9c874f12bb2cda19dbbf6f47) feature (PR: #43816).\r\n\r\nWe've added optimization to compute chart title link only on mouseenter and focus: #45095\r\n\r\nI'm not closing the issue yet, as 300-card dashboards are still slow. The app does not freeze anymore though. See #45095 for videos.\r\nSee [Slack](https://metaboat.slack.com/archives/C05NXACAG1G/p1719922327712559) for details."", 'created_at': datetime.datetime(2024, 7, 3, 14, 49, 35, tzinfo=datetime.timezone.utc)}]","darksciencebase on (2024-06-19 11:24:45 UTC): [thread mentioning slowness in the tests as well](https://metaboat.slack.com/archives/C0641E4PB9B/p1718637304256719). if this turns out to be a separate issue, we should create a new ticket

piranha (Assginee) on (2024-07-01 10:35:44 UTC): My findings: the `automagic-dashboards/adhoc/.../cell/...` API returns a dashboard with 311 cards (16 kb json) in ~5 seconds, and `automagic-dashboards/adhoc/.../query_metadata` returns a table with 500 fields (23 kb json) in ~10 seconds (this happens in parallel). 

Browser is perfectly responsive during this time (obviously), but then locks up to generate queries for every card at the same time. If I profile JS, it indicates that LOTS of functions is called (and the functions are not small either, each one of them takes about 20-23 ms).

<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6553/69ef7cf4-ca33-463b-adbe-e5261b8a2074"">

For example, DashCardInner, after following all the nesting, ends up calling `getUrlWithParameters` (takes 23 ms), which in turns calls `getUrl` (which spends 11.1ms in `fromLegacyQuery`) and `query` (which also spends 11.1ms in `fromLegacyQuery`). Most of the time of `fromLegacyQuery` is spent in `metabase$lib$schema$join_ref_error_for_stages`.

This issue can be tackled from three sides:

- Limit amount of work to be done, i.e. don't render so many cards at once (or least do that with pagination)
  - Either from server side, this can also speed up initial responses, and will help not to lock UI as much
  - Or for client side, just render whatever the client will see first and then reveal/fetch data on scroll, that will also help with UI locking and the API will stay simple with no pagination as it is right now
- Optimize `metabase$lib$schema$join_ref_error_for_stages` (and possibly other functions), it needs to be much faster to be used like it is used right now.

Just in case, [profile is here](https://drive.google.com/file/d/1-ekg0bH17TmSb9Hecj9W33kUgtzI9y0w/view?usp=sharing), if you want to see it without reproducing (profiler misbehaves seeing this page too 🤣).

kamilmielnik on (2024-07-03 14:49:35 UTC): This was due to [Copy question link from dashboard](https://www.notion.so/metabase/Copy-question-link-from-dashboard-702fe6ec9c874f12bb2cda19dbbf6f47) feature (PR: #43816).

We've added optimization to compute chart title link only on mouseenter and focus: #45095

I'm not closing the issue yet, as 300-card dashboards are still slow. The app does not freeze anymore though. See #45095 for videos.
See [Slack](https://metaboat.slack.com/archives/C05NXACAG1G/p1719922327712559) for details.

"
2321692160,issue,closed,completed,BE flake: metabase.xrays.automagic-dashboards.core-test/call-count-test,"This test flaked once ([source](https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBmbGFrZXMgYnkgc3VpdGUgbmFtZSBhbmQgdGVzdCBuYW1lIChub3QgUVApIiwiZGVzY3JpcHRpb24iOiJodHRwczovL3N0YXRzLm1ldGFiYXNlLmNvbS9tb2RlbC8xNDgyOC10ZXN0LWZsYWtpbmVzcyIsImRhdGFzZXRfcXVlcnkiOnsiZGF0YWJhc2UiOjI2LCJ0eXBlIjoicXVlcnkiLCJxdWVyeSI6eyJhZ2dyZWdhdGlvbiI6W1siY291bnQiXSxbIm1heCIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl91cmwiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dXSxbIm1heCIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl9zdGFydGVkX2F0Iix7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWVXaXRoTG9jYWxUWiIsInRlbXBvcmFsLXVuaXQiOiJtaW51dGUifV1dLFsiYWdncmVnYXRpb24tb3B0aW9ucyIsWyJjb3VudC13aGVyZSIsWyI-IixbImZpZWxkIiwid29ya2Zsb3dfcnVuX3N0YXJ0ZWRfYXQiLHsiYmFzZS10eXBlIjoidHlwZS9EYXRlVGltZVdpdGhMb2NhbFRaIn1dLFsiZGF0ZXRpbWUtc3VidHJhY3QiLFsibm93Il0sMywiZGF5Il1dXSx7Im5hbWUiOiJDb3VudCAobGFzdCAzZCkiLCJkaXNwbGF5LW5hbWUiOiJDb3VudCAobGFzdCAzZCkifV1dLCJicmVha291dCI6W1siZmllbGQiLCJzdWl0ZV9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwidGVzdF9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwid29ya2Zsb3dfcnVuX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLCJ3b3JrZmxvd19qb2JfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV1dLCJvcmRlci1ieSI6W1siZGVzYyIsWyJhZ2dyZWdhdGlvbiIsM11dLFsiZGVzYyIsWyJhZ2dyZWdhdGlvbiIsMF1dXSwic291cmNlLXRhYmxlIjoiY2FyZF9fMTQ4MjgiLCJmaWx0ZXIiOlsiYW5kIixbImNvbnRhaW5zIixbImZpZWxkIiwidGVzdF9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSwiY2FsbC1jb3VudCIseyJjYXNlLXNlbnNpdGl2ZSI6ZmFsc2V9XSxbIj0iLFsiZmllbGQiLCJ0ZXN0X25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJjYWxsLWNvdW50LXRlc3QiXV19fSwiZGlzcGxheSI6InRhYmxlIiwiZGlzcGxheUlzTG9ja2VkIjp0cnVlLCJwYXJhbWV0ZXJzIjpbXSwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6eyJ0YWJsZS5waXZvdF9jb2x1bW4iOiJzdWl0ZV9uYW1lIiwidGFibGUuY2VsbF9jb2x1bW4iOiJjb3VudCIsInRhYmxlLnBpdm90IjpmYWxzZSwidGFibGUuY29sdW1ucyI6W3sibmFtZSI6InN1aXRlX25hbWUiLCJrZXkiOiJbXCJuYW1lXCIsXCJzdWl0ZV9uYW1lXCJdIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLCJzdWl0ZV9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XX0seyJuYW1lIjoidGVzdF9uYW1lIiwia2V5IjoiW1wibmFtZVwiLFwidGVzdF9uYW1lXCJdIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLCJ0ZXN0X25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dfSx7Im5hbWUiOiJ3b3JrZmxvd19ydW5fbmFtZSIsImtleSI6IltcIm5hbWVcIixcIndvcmtmbG93X3J1bl9uYW1lXCJdIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLCJ3b3JrZmxvd19ydW5fbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV19LHsibmFtZSI6IndvcmtmbG93X2pvYl9uYW1lIiwia2V5IjoiW1wibmFtZVwiLFwid29ya2Zsb3dfam9iX25hbWVcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsIndvcmtmbG93X2pvYl9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XX0seyJuYW1lIjoiQ291bnQgKGxhc3QgM2QpIiwia2V5IjoiW1wibmFtZVwiLFwiQ291bnQgKGxhc3QgM2QpXCJdIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiYWdncmVnYXRpb24iLDNdfSx7Im5hbWUiOiJjb3VudCIsImtleSI6IltcIm5hbWVcIixcImNvdW50XCJdIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiYWdncmVnYXRpb24iLDBdfSx7Im5hbWUiOiJtYXgiLCJrZXkiOiJbXCJuYW1lXCIsXCJtYXhcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJhZ2dyZWdhdGlvbiIsMV19LHsibmFtZSI6Im1heF8yIiwia2V5IjoiW1wibmFtZVwiLFwibWF4XzJcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJhZ2dyZWdhdGlvbiIsMl19XSwiY29sdW1uX3NldHRpbmdzIjp7IltcIm5hbWVcIixcImNvdW50XCJdIjp7ImNvbHVtbl90aXRsZSI6IkNvdW50IChsYXN0IDdkKSJ9LCJbXCJuYW1lXCIsXCJtYXhcIl0iOnsiY29sdW1uX3RpdGxlIjoiTGFzdCBmYWlsZWQgcnVuIn0sIltcIm5hbWVcIixcIm1heF8yXCJdIjp7ImNvbHVtbl90aXRsZSI6Ikxhc3QgZmFpbGVkIGRhdGUiLCJkYXRlX3N0eWxlIjoiTU1NTSBELCBZWVlZIiwidGltZV9lbmFibGVkIjpudWxsfX0sInRhYmxlLmNvbHVtbl93aWR0aHMiOls0NzddfSwib3JpZ2luYWxfY2FyZF9pZCI6MTUyMTJ9))

[example failure](https://github.com/metabase/metabase/actions/runs/9265847704)",calherries,2024-05-28 18:36:33+00:00,['calherries'],2024-06-07 16:07:33+00:00,2024-06-07 16:07:33+00:00,https://github.com/metabase/metabase/issues/43256,"[('.CI & Tests', ''), ('flaky-test-fix', '')]","[{'comment_id': 2155132574, 'issue_id': 2321692160, 'author': 'calherries', 'body': 'Fixed by https://github.com/metabase/metabase/pull/43248', 'created_at': datetime.datetime(2024, 6, 7, 16, 7, 33, tzinfo=datetime.timezone.utc)}]","calherries (Issue Creator) on (2024-06-07 16:07:33 UTC): Fixed by https://github.com/metabase/metabase/pull/43248

"
2321644525,issue,closed,completed,[Browse] Don't show browse models in sidebar when no models exist,,rafpaf,2024-05-28 18:05:52+00:00,[],2024-06-10 20:42:38+00:00,2024-06-06 15:43:17+00:00,https://github.com/metabase/metabase/issues/43253,[],[],
2321583017,issue,closed,not_planned,Simplify CollectionBreadcrumbs to improve performance,"* Remove initial ellipsis
* Consider reducing usage of styled components",rafpaf,2024-05-28 17:28:37+00:00,['rafpaf'],2024-06-04 14:32:14+00:00,2024-06-04 14:32:14+00:00,https://github.com/metabase/metabase/issues/43252,"[('.Performance', ''), ('.Frontend', '')]",[],
2321580506,issue,closed,completed,[Browse] Remove Metabase analytics models,"![image](https://github.com/metabase/metabase/assets/130925/bd94f022-23ef-4d3b-bd10-1214f7f2834a)
",rafpaf,2024-05-28 17:27:02+00:00,[],2024-06-10 20:49:05+00:00,2024-06-07 20:24:25+00:00,https://github.com/metabase/metabase/issues/43251,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2321454524,issue,closed,not_planned,Dropdown filter doesn't populate from SQL model,"### Describe the bug

Dropdown filters don't populate when a question is built from a SQL model. 

### To Reproduce

1. Crete a model from a SQL query
2. Map the appropriate database column in Model setting > Edit query definition > Metadata > Database column this maps to as indicated in [our Model documentation](https://www.metabase.com/docs/latest/data-modeling/models#database-column-this-maps-to) 
3. Also make sure to set the Data Type as 'category' in Admin Settings > Table Metadata
4.  And set the Filtering on this field option to ""a list of all values""
5. Create a question based on the SQL model you created
6. Add the question to a dashboard and create a dropdown dashboard filter mapping back to the column you want
7. See the new dashboard filter behave like an input filter

Recorded my reproduction steps in this loom: https://www.loom.com/share/7feb5aed5bdb4a23818c593b7bdb3640?sid=bf73a038-c068-4709-8026-270c688dcb6c

### Expected behavior

Assuming there are less than 1k distinct values, it should just work as a dropdown filter

### Logs

_No response_

### Information about your Metabase installation

```JSON
Chrome 
H2 database
v49.10
Metabase cloud
```


### Severity

Annoying to users since they have to workaround this by feeding values from a model or saved question

### Additional context

_No response_",dahyeik,2024-05-28 16:11:44+00:00,[],2024-05-29 12:54:49+00:00,2024-05-29 12:54:49+00:00,https://github.com/metabase/metabase/issues/43243,"[('Type:Bug', 'Product defects'), ('.Needs Triage', ''), ('Querying/Models', 'aka Datasets')]","[{'comment_id': 2135759470, 'issue_id': 2321454524, 'author': 'paoliniluis', 'body': 'strong belief this is the same as https://github.com/metabase/metabase/issues/43154 cc @ranquild', 'created_at': datetime.datetime(2024, 5, 28, 17, 20, 48, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-05-28 17:20:48 UTC): strong belief this is the same as https://github.com/metabase/metabase/issues/43154 cc @ranquild

"
2320624575,issue,closed,not_planned," yarn build, getting error in executing this command","ubuntu@ip-172-16-1-181:~/exploratory-analytics$ yarn build
yarn run v1.22.22
$ yarn build:cljs && yarn build:js
$ yarn && yarn build-pure:cljs
$ echo $npm_execpath | grep -q yarn || echo '\033[0;33mSorry, npm is not supported. Please use Yarn (https://yarnpkg.com/).\033[0m'
[1/5] Validating package.json...
[2/5] Resolving packages...
warning Resolution field ""ansi-regex@5.0.1"" is incompatible with requested version ""ansi-regex@^2.0.0""
warning Resolution field ""json5@2.2.2"" is incompatible with requested version ""json5@^2.2.3""
warning Resolution field ""json5@2.2.2"" is incompatible with requested version ""json5@^2.2.3""
warning Resolution field ""json5@2.2.2"" is incompatible with requested version ""json5@^1.0.1""
warning Resolution field ""set-value@4.0.1"" is incompatible with requested version ""set-value@^2.0.0""
warning Resolution field ""unset-value@2.0.1"" is incompatible with requested version ""unset-value@^1.0.0""
warning Resolution field ""set-value@4.0.1"" is incompatible with requested version ""set-value@^2.0.1""
warning Resolution field ""source-map-js@1.2.0"" is incompatible with requested version ""source-map-js@^0.6.2""
warning Resolution field ""nth-check@2.0.1"" is incompatible with requested version ""nth-check@^1.0.2""
warning Resolution field ""ansi-regex@5.0.1"" is incompatible with requested version ""ansi-regex@^2.0.0""
warning Resolution field ""json5@2.2.2"" is incompatible with requested version ""json5@^1.0.2""
warning Resolution field ""ansi-regex@5.0.1"" is incompatible with requested version ""ansi-regex@^6.0.1""
warning Resolution field ""ansi-regex@5.0.1"" is incompatible with requested version ""ansi-regex@^6.0.1""
success Already up-to-date.
$ husky install
husky - Git hooks installed
$ yarn clean-dev:cljs && shadow-cljs compile app
$ rm -rf target/cljs_dev/*
shadow-cljs - config: /home/ubuntu/exploratory-analytics/shadow-cljs.edn
shadow-cljs - starting via ""clojure""
Execution error (FileNotFoundException) at java.io.FileInputStream/open0 (FileInputStream.java:-2).
-A:cljs (No such file or directory)

Full report at:
/tmp/clojure-921353521078117295.edn
error Command failed with exit code 1.
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
error Command failed with exit code 1.
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
error Command failed with exit code 1.
info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.

",sandeepraghu,2024-05-28 09:52:01+00:00,[],2024-05-30 05:16:43+00:00,2024-05-28 12:10:13+00:00,https://github.com/metabase/metabase/issues/43223,[],"[{'comment_id': 2135061696, 'issue_id': 2320624575, 'author': 'paoliniluis', 'body': 'please more info: java version, node version, yarn version...', 'created_at': datetime.datetime(2024, 5, 28, 12, 10, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2135145507, 'issue_id': 2320624575, 'author': 'sandeepraghu', 'body': '@paoliniluis \r\njava --version\r\nopenjdk 11.0.22 2024-01-16\r\nOpenJDK Runtime Environment (build 11.0.22+7-post-Ubuntu-0ubuntu222.04.1)\r\nOpenJDK 64-Bit Server VM (build 11.0.22+7-post-Ubuntu-0ubuntu222.04.1, mixed mode, sharing)\r\nnode --version\r\nv18.20.3\r\nyarn --version\r\n1.22.22', 'created_at': datetime.datetime(2024, 5, 28, 12, 53, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2135260020, 'issue_id': 2320624575, 'author': 'paoliniluis', 'body': 'branch?', 'created_at': datetime.datetime(2024, 5, 28, 13, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2135694564, 'issue_id': 2320624575, 'author': 'sandeepraghu', 'body': 'master', 'created_at': datetime.datetime(2024, 5, 28, 16, 41, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2135764410, 'issue_id': 2320624575, 'author': 'paoliniluis', 'body': 'have you installed clojure cli?', 'created_at': datetime.datetime(2024, 5, 28, 17, 24, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2136532843, 'issue_id': 2320624575, 'author': 'sandeepraghu', 'body': 'yes', 'created_at': datetime.datetime(2024, 5, 29, 5, 19, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2137254924, 'issue_id': 2320624575, 'author': 'sandeepraghu', 'body': 'it build successfully with yarn build command \r\nbut when i accessing it on a browser and adding database in that i am only getting two database option in database type dropdown. How to fix this?', 'created_at': datetime.datetime(2024, 5, 29, 12, 8, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2137339439, 'issue_id': 2320624575, 'author': 'paoliniluis', 'body': ""I don't understand the problem"", 'created_at': datetime.datetime(2024, 5, 29, 12, 50, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2138699020, 'issue_id': 2320624575, 'author': 'sandeepraghu', 'body': 'thansk it is fixed!', 'created_at': datetime.datetime(2024, 5, 30, 5, 16, 42, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-05-28 12:10:13 UTC): please more info: java version, node version, yarn version...

sandeepraghu (Issue Creator) on (2024-05-28 12:53:10 UTC): @paoliniluis 
java --version
openjdk 11.0.22 2024-01-16
OpenJDK Runtime Environment (build 11.0.22+7-post-Ubuntu-0ubuntu222.04.1)
OpenJDK 64-Bit Server VM (build 11.0.22+7-post-Ubuntu-0ubuntu222.04.1, mixed mode, sharing)
node --version
v18.20.3
yarn --version
1.22.22

paoliniluis on (2024-05-28 13:46:00 UTC): branch?

sandeepraghu (Issue Creator) on (2024-05-28 16:41:34 UTC): master

paoliniluis on (2024-05-28 17:24:10 UTC): have you installed clojure cli?

sandeepraghu (Issue Creator) on (2024-05-29 05:19:43 UTC): yes

sandeepraghu (Issue Creator) on (2024-05-29 12:08:27 UTC): it build successfully with yarn build command 
but when i accessing it on a browser and adding database in that i am only getting two database option in database type dropdown. How to fix this?

paoliniluis on (2024-05-29 12:50:45 UTC): I don't understand the problem

sandeepraghu (Issue Creator) on (2024-05-30 05:16:42 UTC): thansk it is fixed!

"
2320621588,issue,closed,completed,Wrong columns shown in Extract/Combine expression when aggregation is present,"### Describe the bug


https://github.com/metabase/metabase/assets/6830683/cc87ed88-5e52-4456-9b4f-8d82c0791d53



### To Reproduce

1. Start a new question
2. Try to add custom column via Extract column or Combine column shortcut
3. Notice you can select all the right columns in there
4. Add an aggregation
5. Try to add custom column via Extract column or Combine column shortcut **before** the aggregation

Aggregated columns are the only ones user can select from

### Expected behavior

All columns that were visible in step (2) should be visible now as well

### Information about your Metabase installation

master, 92daf0cc7f, `0.50.0-RC1`

### Severity

P2
",kamilmielnik,2024-05-28 09:50:35+00:00,[],2024-05-31 14:49:23+00:00,2024-05-31 14:49:22+00:00,https://github.com/metabase/metabase/issues/43222,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('Querying/Notebook/Custom Column', ''), ('.Team/Querying', '')]","[{'comment_id': 2134965991, 'issue_id': 2320621588, 'author': 'kamilmielnik', 'body': 'Marked as a blocker for 0.50, see [Slack](https://metaboat.slack.com/archives/C05NXACAG1G/p1716890201814939?thread_ts=1716889848.351869&cid=C05NXACAG1G)', 'created_at': datetime.datetime(2024, 5, 28, 11, 18, 3, tzinfo=datetime.timezone.utc)}]","kamilmielnik (Issue Creator) on (2024-05-28 11:18:03 UTC): Marked as a blocker for 0.50, see [Slack](https://metaboat.slack.com/archives/C05NXACAG1G/p1716890201814939?thread_ts=1716889848.351869&cid=C05NXACAG1G)

"
2320444373,issue,closed,completed,More than 10 Series (using Add Series Dashboard Feature) cause Filter UI to be inaccessible ,"### Describe the bug

If you add more than 10 Series then the filter for some of the Series becomes inaccessible

<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/b47560bf-8445-43b6-b4ab-e98c7256b52e"">


### To Reproduce

1. Go to the following [Dashboard](https://stats.metabase.com/dashboard/2451-test-10-series-question) and try to add a filter to Series 8,9 or 10


### Expected behavior

Able to set filters to all Series that are added

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
master
```


### Severity

makes the Add Series for large numbers impossible to work with

### Additional context

_No response_",Tony-metabase,2024-05-28 08:25:34+00:00,['kamilmielnik'],2024-07-16 09:29:11+00:00,2024-07-16 07:46:06+00:00,https://github.com/metabase/metabase/issues/43219,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2320220211,issue,closed,completed,Questions based on a custom SQL query aren't updated,"### Describe the bug

When you modify a SQL question A and you have a question B that use A, if you have modified A, B does not receive the change until you completely rewrite the question with the metabase editor. (B is metabase editor, A is plain SQL)

### To Reproduce

1. create a sql question that returns fields A, B and C
2. create a metabase editor based question using the first one
3. modify the first one to add a field D
4. returns in the second question, try to select the field D -> you can't unless you reset the question


### Expected behavior

It should receive change without need to almost destroy the question and restart everything ... 

### Logs

_No response_

### Information about your Metabase installation

```JSON
- metabase version 0.49.12
```


### Severity

annoying

### Additional context

_No response_",alexisvisco,2024-05-28 06:18:28+00:00,['kamilmielnik'],2024-07-03 12:05:50+00:00,2024-07-03 06:51:24+00:00,https://github.com/metabase/metabase/issues/43216,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Nested Queries', 'Questions based on other saved questions'), ('.Frontend', ''), ('Querying/Notebook', 'Items specific to the Custom/Notebook query builder'), ('.Already Fixed', 'will apear in ""Already Fixed"" in the release notes (not ""Bug Fixes"" that we actively fixed)'), ('.Team/Querying', '')]","[{'comment_id': 2135276514, 'issue_id': 2320220211, 'author': 'bshepherdson', 'body': ""This is a known problem in Metabase generally, and not limited to SQL questions either - when the metadata of query (such as its list of columns) changes, other things that depend on that query might not be updated.\r\n\r\nRefreshing the client after editing the upstream question should force a reload of the metadata, and then the downstream question shows the added fields in the field picker. It worked for me.\r\n\r\nA bonus bug: if a GUI question doesn't select specific fields from its source, the default is to select all. Then when the source is edited to return new columns:\r\n- *Running* the downstream query will return those new columns\r\n- But *opening the field picker* won't show the new columns.\r\n\r\nIf you select a subset of the columns in the GUI query, and then **remove** a selected column from the source query, then running the downstream query will fail because it tries to select a column that doesn't exist. See #41785."", 'created_at': datetime.datetime(2024, 5, 28, 13, 53, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2181805405, 'issue_id': 2320220211, 'author': 'ranquild', 'body': 'FE caching issue', 'created_at': datetime.datetime(2024, 6, 21, 1, 10, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2200054109, 'issue_id': 2320220211, 'author': 'kamilmielnik', 'body': 'Repro video (v49.11):\r\n\r\nhttps://github.com/metabase/metabase/assets/6830683/f17fb317-4147-414a-bcc3-927114b9b62e', 'created_at': datetime.datetime(2024, 7, 1, 12, 47, 32, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2024-05-28 13:53:19 UTC): This is a known problem in Metabase generally, and not limited to SQL questions either - when the metadata of query (such as its list of columns) changes, other things that depend on that query might not be updated.

Refreshing the client after editing the upstream question should force a reload of the metadata, and then the downstream question shows the added fields in the field picker. It worked for me.

A bonus bug: if a GUI question doesn't select specific fields from its source, the default is to select all. Then when the source is edited to return new columns:
- *Running* the downstream query will return those new columns
- But *opening the field picker* won't show the new columns.

If you select a subset of the columns in the GUI query, and then **remove** a selected column from the source query, then running the downstream query will fail because it tries to select a column that doesn't exist. See #41785.

ranquild on (2024-06-21 01:10:28 UTC): FE caching issue

kamilmielnik (Assginee) on (2024-07-01 12:47:32 UTC): Repro video (v49.11):

https://github.com/metabase/metabase/assets/6830683/f17fb317-4147-414a-bcc3-927114b9b62e

"
2320209151,issue,closed,completed,horizontal scroll disappeared on overflowing pivot table on saved questions.,"**Describe the bug**
A clear and concise description of what the bug is.

**Logs**
Please include javascript console and server logs around the time this bug occurred. For information about how to get these, consult our [bug troubleshooting guide](https://metabase.com/docs/latest/troubleshooting-guide/bugs.html)

**To Reproduce**
Steps to reproduce the behavior:
1. Go to 'a saved question with pivot table, have many columns, need horizontal scrollbar to view data.'
2. Click on '....'
3. Scroll down to '....'
4. See error

**Expected behavior**
If the columns are over the page width, the horizontal scrollbar should be visible.

**Screenshots**
![image](https://github.com/metabase/metabase/assets/58539792/1a76c136-a64f-4000-9553-59205178f1fd)

**Severity**
Blocking your usage of Metabase entirely

**Additional context**
if on edit model, this scrollbar is visible. or press F11 on web browser (full screen model), this scroll bar shows.

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""GBK"",
    ""java.runtime.name"": ""Java(TM) SE Runtime Environment"",
    ""java.runtime.version"": ""11.0.21+9-LTS-193"",
    ""java.vendor"": ""Oracle Corporation"",
    ""java.vendor.url"": ""https://openjdk.java.net/"",
    ""java.version"": ""11.0.21"",
    ""java.vm.name"": ""Java HotSpot(TM) 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.21+9-LTS-193"",
    ""os.name"": ""Windows Server 2019"",
    ""os.version"": ""10.0"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Asia/Shanghai""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""sqlserver""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.3""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-16"",
      ""tag"": ""v0.49.11"",
      ""hash"": ""b894f2d""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```",Jeffreyren-hb,2024-05-28 06:10:49+00:00,['EmmadUsmani'],2024-06-26 18:51:53+00:00,2024-06-25 22:56:18+00:00,https://github.com/metabase/metabase/issues/43215,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2319862566,issue,open,,Redundant text about auto binned in Summarize block,"### Describe the bug

When I group by a binnable column, it looks nice and fine right away (first image). But then if I close the sidebar and reopen it, it looks wacky: it’s unnecessarily showing Auto binned next to the column’s name (second image).
![image](https://github.com/metabase/metabase/assets/777800/3f3466ae-af34-49e7-86b3-0ce082f61d5d)
![image](https://github.com/metabase/metabase/assets/777800/b70f7387-283b-44e3-8dda-d895719fb7bc)


### To Reproduce

1. Open Summarize from chill mode
2. Group by auto-binned column
3. Run and open again
4. See redundant `: Auto binned` text in the column name


### Expected behavior

It should just say the column name.
It seems that longDisplayName is used to show the table name there for joined columns. So most likely the right solution would be to not propagate `: Auto binned` into the longDisplayName or create a third field to show for pinned items, depending on where we use longDisplayName right now and if there is a need to show `: Auto binned` in those places.

### Logs

_No response_

### Information about your Metabase installation

```JSON
last version
```


### Severity

Just goofy

### Additional context

It seems that longDisplayName is used to show the table name there for joined columns. So most likely the right solution would be to not propagate : Auto binned into the long display name or create a third field to show for pinned items, depending on where we use longDisplayName right now and if there is a need to show : Auto binned there.",mngr,2024-05-27 22:52:45+00:00,[],2025-02-04 20:27:15+00:00,,https://github.com/metabase/metabase/issues/43209,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/MBQL', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2319770984,issue,closed,not_planned,BE flake: metabase.models.cloud-migration-test/migrate!-test,"Failure example: https://github.com/metabase/metabase/actions/runs/9259612945/job/25471865370?pr=43102#step:7:2228

logs:
```
Setting :read-only-mode = false
 exits early on terminal state
expected: 1
  actual: 0
```

This test added in this PR https://github.com/metabase/metabase/pull/41317. It has failed 10 times in the last 7 days as I'm writing this on May 27 [(source)](https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBmbGFrZXMgYnkgc3VpdGUgbmFtZSBhbmQgdGVzdCBuYW1lIChub3QgUVApIiwiZGVzY3JpcHRpb24iOiJodHRwczovL3N0YXRzLm1ldGFiYXNlLmNvbS9tb2RlbC8xNDgyOC10ZXN0LWZsYWtpbmVzcyIsImRhdGFzZXRfcXVlcnkiOnsiZGF0YWJhc2UiOjI2LCJ0eXBlIjoicXVlcnkiLCJxdWVyeSI6eyJhZ2dyZWdhdGlvbiI6W1siY291bnQiXSxbIm1heCIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl91cmwiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dXSxbIm1heCIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl9zdGFydGVkX2F0Iix7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWVXaXRoTG9jYWxUWiIsInRlbXBvcmFsLXVuaXQiOiJtaW51dGUifV1dLFsiYWdncmVnYXRpb24tb3B0aW9ucyIsWyJjb3VudC13aGVyZSIsWyI-IixbImZpZWxkIiwid29ya2Zsb3dfcnVuX3N0YXJ0ZWRfYXQiLHsiYmFzZS10eXBlIjoidHlwZS9EYXRlVGltZVdpdGhMb2NhbFRaIn1dLFsiZGF0ZXRpbWUtc3VidHJhY3QiLFsibm93Il0sMywiZGF5Il1dXSx7Im5hbWUiOiJDb3VudCAobGFzdCAzZCkiLCJkaXNwbGF5LW5hbWUiOiJDb3VudCAobGFzdCAzZCkifV1dLCJicmVha291dCI6W1siZmllbGQiLCJzdWl0ZV9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwidGVzdF9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XV0sIm9yZGVyLWJ5IjpbWyJkZXNjIixbImFnZ3JlZ2F0aW9uIiwzXV0sWyJkZXNjIixbImFnZ3JlZ2F0aW9uIiwwXV1dLCJzb3VyY2UtdGFibGUiOiJjYXJkX18xNDgyOCIsImZpbHRlciI6WyJhbmQiLFsidGltZS1pbnRlcnZhbCIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl9zdGFydGVkX2F0Iix7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWVXaXRoTG9jYWxUWiJ9XSwtNywiZGF5Il0sWyJkb2VzLW5vdC1jb250YWluIixbImZpZWxkIiwic3VpdGVfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sInF1ZXJ5LXByb2Nlc3NvciIseyJjYXNlLXNlbnNpdGl2ZSI6ZmFsc2V9XSxbImNvbnRhaW5zIixbImZpZWxkIiwid29ya2Zsb3dfam9iX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJiZS10ZXN0cy0iLHsiY2FzZS1zZW5zaXRpdmUiOmZhbHNlfV0sWyI9IixbImZpZWxkIiwidGVzdF9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSwibWlncmF0ZSEtdGVzdCJdXX19LCJkaXNwbGF5IjoidGFibGUiLCJkaXNwbGF5SXNMb2NrZWQiOnRydWUsInBhcmFtZXRlcnMiOltdLCJ2aXN1YWxpemF0aW9uX3NldHRpbmdzIjp7InRhYmxlLnBpdm90X2NvbHVtbiI6InN1aXRlX25hbWUiLCJ0YWJsZS5jZWxsX2NvbHVtbiI6ImNvdW50IiwidGFibGUucGl2b3QiOmZhbHNlLCJ0YWJsZS5jb2x1bW5zIjpbeyJuYW1lIjoic3VpdGVfbmFtZSIsImtleSI6IltcIm5hbWVcIixcInN1aXRlX25hbWVcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsInN1aXRlX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dfSx7Im5hbWUiOiJ0ZXN0X25hbWUiLCJrZXkiOiJbXCJuYW1lXCIsXCJ0ZXN0X25hbWVcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsInRlc3RfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV19LHsibmFtZSI6IkNvdW50IChsYXN0IDNkKSIsImtleSI6IltcIm5hbWVcIixcIkNvdW50IChsYXN0IDNkKVwiXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImFnZ3JlZ2F0aW9uIiwzXX0seyJuYW1lIjoiY291bnQiLCJrZXkiOiJbXCJuYW1lXCIsXCJjb3VudFwiXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImFnZ3JlZ2F0aW9uIiwwXX0seyJuYW1lIjoibWF4Iiwia2V5IjoiW1wibmFtZVwiLFwibWF4XCJdIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiYWdncmVnYXRpb24iLDFdfSx7Im5hbWUiOiJtYXhfMiIsImtleSI6IltcIm5hbWVcIixcIm1heF8yXCJdIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiYWdncmVnYXRpb24iLDJdfV0sImNvbHVtbl9zZXR0aW5ncyI6eyJbXCJuYW1lXCIsXCJjb3VudFwiXSI6eyJjb2x1bW5fdGl0bGUiOiJDb3VudCAobGFzdCA3ZCkifSwiW1wibmFtZVwiLFwibWF4XCJdIjp7ImNvbHVtbl90aXRsZSI6Ikxhc3QgZmFpbGVkIHJ1biJ9LCJbXCJuYW1lXCIsXCJtYXhfMlwiXSI6eyJjb2x1bW5fdGl0bGUiOiJMYXN0IGZhaWxlZCBkYXRlIiwiZGF0ZV9zdHlsZSI6Ik1NTU0gRCwgWVlZWSIsInRpbWVfZW5hYmxlZCI6bnVsbH19fSwib3JpZ2luYWxfY2FyZF9pZCI6MTUyMTJ9)",calherries,2024-05-27 20:57:47+00:00,['filipesilva'],2024-12-13 16:45:37+00:00,2024-12-13 16:45:37+00:00,https://github.com/metabase/metabase/issues/43207,"[('.Backend', ''), ('flaky-test-fix', '')]",[],
2319382199,issue,closed,completed,Using specific dates in Date field filter automatically adds unwanted time filter,"### Describe the bug

When filtering on the ""date"" field in our this txns table, as you can see these are the parameters set with no time selected whatsoever
![image](https://github.com/metabase/metabase/assets/114496083/cde20c2a-45a0-40a8-813c-8d262d175536)

however, after clicking on apply/update filter right after, you can see in the image below that a time filter is automatically added.
![image](https://github.com/metabase/metabase/assets/114496083/3d5a5725-76f5-403e-9366-fb905fb13951)


Also this only happens when choosing April 26th, and it is the day when Daylight Savings took effect in my local timezone.
Issue is not reported across all users, but no solution found so far.


### To Reproduce

1. Go to txns table
2. Filter by ""specific dates""
3. Make sure specific dates end or begin on 26th april
4. Time filter gets automaticall applied

### Expected behavior

This should work as a normal date filter. If i don't have any time added or specified in the date filter then it should not appear automatically

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.214-202.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""12.17""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-22"",
      ""tag"": ""v0.49.7"",
      ""hash"": ""f0ff786""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Blocking users, misrepresenting numbers on dashboards

### Additional context

_No response_",osayedTFL,2024-05-27 15:18:43+00:00,['ranquild'],2024-07-14 17:54:55+00:00,2024-07-14 17:54:48+00:00,https://github.com/metabase/metabase/issues/43196,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Unable to Reproduce', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Difficulty:Hard', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]","[{'comment_id': 2133719218, 'issue_id': 2319382199, 'author': 'bshepherdson', 'body': 'This is definitely DST-related. I suspect this is only a UI quirk, and not impacting the query results, but I\'m not certain.\r\n\r\n@osayedTFL Are you able to look at the Network tab for either the `/api/card/1234` for this card, or a `.../dataset` request for this card? It would be helpful to see how this filter is represented internally. Also, what are the time zones here? (DST start/stop rules vary significantly.)\r\n\r\nThere\'s not really such a thing as a ""date filter"" for a `datetime` column - the filter will need to specify the exact times at the SQL level, something like `date >= 2024-04-01T00:00:00 AND date < 2024-04-27T00:00:00`.\r\n\r\nBut the latter time might not really exist, if DST skips the hour of midnight and the day begins at 1am. I think we\'re rendering this badly in two ways: (1) we\'re showing the time when we don\'t want to be, because one of the times is not midnight; and (2) making it look like the 26th isn\'t included, when the SQL might exclude it.\r\n\r\nTime zones and DST are a perennial pain point in Metabase. There may be no perfect way to reconcile the time zones of (1) the query author, (2) the database being queried, and (3) the query viewer, but there\'s still a bug to clean up here.', 'created_at': datetime.datetime(2024, 5, 27, 15, 41, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2134727324, 'issue_id': 2319382199, 'author': 'osayedTFL', 'body': 'Actually it does affect query results when filtering for 26 April specifically, especially as an ""end date"" in the field filter. All results for 26 April should show, but in this way it only shows results until 1 am on 26 april.\r\n This is the day when the DST jump happened and you are correct, it was the case that the clock went straight from Midnight to 1 am. The timezone is Africa/Cairo or UTC +2. This still shouldn\'t happen as our db is set to UTC, but the ""date"" field here specifically has a data type of ""DateTimeWithLocalTZ""\r\n \r\n As for the network tab, I have here the payload of a ""dataset"" request.\r\n \r\n As you can see, a ""temporal unit"" key is added in the field filter for some reason.\r\n{`""database"":2,""type"":""query"",""query"":{""source-table"":9,""filter"":[""between"",[""field"",263,{""base-type"":""type/DateTimeWithLocalTZ"",""temporal-unit"":""minute""}],""2024-04-01T00:00:00"",""2024-04-26T01:00:00""]},""parameters"":[]}`\r\n\r\n\r\nhowever, as stated before, this issue does not appear for everyone in my organization, when I open the request from their device, this is the payload that is sent, notice that no time units are used.\r\n`{""database"":2,""type"":""query"",""query"":{""source-table"":9,""filter"":[""between"",[""field"",263,{""base-type"":""type/DateTimeWithLocalTZ""}],""2024-04-01"",""2024-04-26""]},""parameters"":[]}`\r\n\r\nDo let me know if you need any more information on my end and I appreciate the response.', 'created_at': datetime.datetime(2024, 5, 28, 9, 14, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2227428067, 'issue_id': 2319382199, 'author': 'ranquild', 'body': 'Fixed by https://github.com/metabase/metabase/pull/44859', 'created_at': datetime.datetime(2024, 7, 14, 17, 54, 48, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2024-05-27 15:41:19 UTC): This is definitely DST-related. I suspect this is only a UI quirk, and not impacting the query results, but I'm not certain.

@osayedTFL Are you able to look at the Network tab for either the `/api/card/1234` for this card, or a `.../dataset` request for this card? It would be helpful to see how this filter is represented internally. Also, what are the time zones here? (DST start/stop rules vary significantly.)

There's not really such a thing as a ""date filter"" for a `datetime` column - the filter will need to specify the exact times at the SQL level, something like `date >= 2024-04-01T00:00:00 AND date < 2024-04-27T00:00:00`.

But the latter time might not really exist, if DST skips the hour of midnight and the day begins at 1am. I think we're rendering this badly in two ways: (1) we're showing the time when we don't want to be, because one of the times is not midnight; and (2) making it look like the 26th isn't included, when the SQL might exclude it.

Time zones and DST are a perennial pain point in Metabase. There may be no perfect way to reconcile the time zones of (1) the query author, (2) the database being queried, and (3) the query viewer, but there's still a bug to clean up here.

osayedTFL (Issue Creator) on (2024-05-28 09:14:56 UTC): Actually it does affect query results when filtering for 26 April specifically, especially as an ""end date"" in the field filter. All results for 26 April should show, but in this way it only shows results until 1 am on 26 april.
 This is the day when the DST jump happened and you are correct, it was the case that the clock went straight from Midnight to 1 am. The timezone is Africa/Cairo or UTC +2. This still shouldn't happen as our db is set to UTC, but the ""date"" field here specifically has a data type of ""DateTimeWithLocalTZ""
 
 As for the network tab, I have here the payload of a ""dataset"" request.
 
 As you can see, a ""temporal unit"" key is added in the field filter for some reason.
{`""database"":2,""type"":""query"",""query"":{""source-table"":9,""filter"":[""between"",[""field"",263,{""base-type"":""type/DateTimeWithLocalTZ"",""temporal-unit"":""minute""}],""2024-04-01T00:00:00"",""2024-04-26T01:00:00""]},""parameters"":[]}`


however, as stated before, this issue does not appear for everyone in my organization, when I open the request from their device, this is the payload that is sent, notice that no time units are used.
`{""database"":2,""type"":""query"",""query"":{""source-table"":9,""filter"":[""between"",[""field"",263,{""base-type"":""type/DateTimeWithLocalTZ""}],""2024-04-01"",""2024-04-26""]},""parameters"":[]}`

Do let me know if you need any more information on my end and I appreciate the response.

ranquild (Assginee) on (2024-07-14 17:54:48 UTC): Fixed by https://github.com/metabase/metabase/pull/44859

"
2319283990,issue,closed,not_planned,[Epic] Streamline sandbox setup,"After the v50 permissions refactor, the sandbox setup UX is weird.

At the database level, the `view data` permission is `granular` although the only reason to use this permission level is to set up `sandbox`.

For each table, the only available options are `can view` and `sandboxed`. We should have another option `can't see` that is the same as an empty sandbox.",luizarakaki,2024-05-27 14:23:07+00:00,[],2024-08-15 12:55:52+00:00,2024-08-14 20:28:51+00:00,https://github.com/metabase/metabase/issues/43193,"[('Administration/Permissions', 'Collection or Data permissions'), ('Administration/Data Sandboxes', 'Enterprise Sandboxing'), ('.Epic', 'Feature Implementation or Project'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2289816643, 'issue_id': 2319283990, 'author': 'luizarakaki', 'body': 'Closed in favor of table-level block', 'created_at': datetime.datetime(2024, 8, 14, 20, 28, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2291217055, 'issue_id': 2319283990, 'author': 'jpleyden98', 'body': 'Is there a link to the table-level block issue?', 'created_at': datetime.datetime(2024, 8, 15, 12, 55, 51, tzinfo=datetime.timezone.utc)}]","luizarakaki (Issue Creator) on (2024-08-14 20:28:51 UTC): Closed in favor of table-level block

jpleyden98 on (2024-08-15 12:55:51 UTC): Is there a link to the table-level block issue?

"
2319269438,issue,closed,completed,Redundant `#edit` in the URL after creating a dashboard,"### Describe the bug

https://github.com/metabase/metabase/assets/6830683/34d82b4a-8bb7-4c0e-b7c1-f29dfb3dfc51


### To Reproduce

1. Create a new dashboard and save it
2. Refresh the page

Dashboard is opened in edit mode.
URL contains extra `#edit`.

### Expected behavior

Dashboard is opened in view mode.
There is no extra `#edit` in the URL.

### Information about your Metabase installation

master, 057cb3f386


### Severity

P3
",kamilmielnik,2024-05-27 14:15:20+00:00,['oisincoveney'],2024-05-29 17:45:38+00:00,2024-05-29 17:45:29+00:00,https://github.com/metabase/metabase/issues/43192,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2319262804,issue,closed,completed,Improvements to examples collection,"* Remove ""top selling products"" question - not used, seems like the correct one in use is ""best selling products""
* Filters only appear to be wired to some questions in one of tabs",albertoperdomo,2024-05-27 14:11:50+00:00,[],2024-05-29 15:01:46+00:00,2024-05-29 15:01:46+00:00,https://github.com/metabase/metabase/issues/43190,"[('Type:Bug', 'Product defects'), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Embedding', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2135896076, 'issue_id': 2319262804, 'author': 'calherries', 'body': ""reopening while the backport isn't merged https://github.com/metabase/metabase/pull/43244"", 'created_at': datetime.datetime(2024, 5, 28, 18, 44, 17, tzinfo=datetime.timezone.utc)}]","calherries on (2024-05-28 18:44:17 UTC): reopening while the backport isn't merged https://github.com/metabase/metabase/pull/43244

"
2318915812,issue,closed,completed,Update toast copy,"
Update toast copy to contain column name or number of filters",uladzimirdev,2024-05-27 11:20:44+00:00,[],2024-05-28 20:33:25+00:00,2024-05-28 20:33:25+00:00,https://github.com/metabase/metabase/issues/43186,[],[],
2318915703,issue,closed,completed,make toast to be shown longer,"- Toast timer up from 5 to 12 seconds and timer is paused when toast is being hovered.
- The bar on top visualizes the time left before the toast gets dismissed automatically. It changes color while the bar is hovered, and the bar pauses.",uladzimirdev,2024-05-27 11:20:41+00:00,[],2024-05-28 20:33:06+00:00,2024-05-28 20:33:06+00:00,https://github.com/metabase/metabase/issues/43185,"[('.Frontend', '')]",[],
2318915616,issue,closed,completed,Replace automatic wiring of the cards with optin variant via toast button,"- Initial toast contains ""connect to .."" message
- after a click on ""connect to ..."" button, new toast is shown with the message ""connected...""
- connection happens only in the current tab
- toast is shown for 12s",uladzimirdev,2024-05-27 11:20:38+00:00,['uladzimirdev'],2024-10-08 17:08:21+00:00,2024-06-10 19:19:19+00:00,https://github.com/metabase/metabase/issues/43184,"[('.Team/Querying', '')]",[],
2318913816,issue,closed,completed,restructure e2e tests - currently they crash chrome locally,move auto-wiring tests and helpers to a separate file,uladzimirdev,2024-05-27 11:19:37+00:00,['uladzimirdev'],2024-10-08 17:10:37+00:00,2024-05-27 11:20:26+00:00,https://github.com/metabase/metabase/issues/43183,[],[],
2318912952,issue,closed,completed,[Epic] Make dashboard filter auto-wire less presumptuous,"**Links**
- [product doc](https://www.notion.so/metabase/Make-dashboard-filter-auto-wire-less-presumptuous-7f60adeccb38442c84cdde5663045e3f)
- feature branch: `filters-auto-wire-presumptuous`
- [testing plan](https://github.com/metabase/metabase/issues/43806)

**Implementation Plan**

```[tasklist]
### ***Milestone 1*** - Main functionality
- [ ] https://github.com/metabase/metabase/issues/43183
- [ ] https://github.com/metabase/metabase/issues/43184
- [ ] https://github.com/metabase/metabase/issues/43268
```

```[tasklist]
### ***Milestone 2*** - Follow ups
- [ ] https://github.com/metabase/metabase/pull/44015
- [ ] https://github.com/metabase/metabase/issues/43964
```",uladzimirdev,2024-05-27 11:19:07+00:00,['uladzimirdev'],2024-06-19 14:09:59+00:00,2024-06-19 14:09:59+00:00,https://github.com/metabase/metabase/issues/43182,"[('Type:New Feature', ''), ('.Frontend', ''), ('.Epic', 'Feature Implementation or Project')]",[],
2318833184,issue,closed,completed,MYSQL - Regexextract option is not available anymore in GUI custom column ,"### Describe the bug

The regexextract option is no longer available on MYSQL for custom columns

### To Reproduce

1. Go to a MYSQL [Database](https://stats.metabase.com/browse/databases/11-magento-test) -> Custom Column and try to use the [regexextract](https://www.metabase.com/docs/latest/questions/query-builder/expressions/regexextract) -> Nothing shows up:

<img width=""1047"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/c63949e6-3068-4cc5-9148-52d983590f18"">



### Expected behavior

The function is given as an option:

<img width=""1103"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/3ad904d0-0620-48db-9945-6c1c721a91d1"">


### Logs

Nothing that are relevant

### Information about your Metabase installation

```JSON
replicated on 50 and on master
```


### Severity

it is a regression

### Additional context

If you have old questions coming from different version the regex still work but new questions don't work",Tony-metabase,2024-05-27 10:35:53+00:00,['bshepherdson'],2024-05-30 21:05:02+00:00,2024-05-30 21:05:02+00:00,https://github.com/metabase/metabase/issues/43180,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Database/MySQL', None), ('Querying/Notebook', 'Items specific to the Custom/Notebook query builder'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('Querying/Notebook/Custom Column', '')]","[{'comment_id': 2134036545, 'issue_id': 2318833184, 'author': 'bshepherdson', 'body': 'This is deliberate, and not a new change or a regression so far as I can tell. MySQL only supports a poor subset of regular expression features, so it does not have the `:regex` driver feature. That [controls](https://github.com/metabase/metabase/blame/master/frontend/src/metabase-lib/v1/expressions/config.ts#L116) the `regexextract` function appearing in expressions. That code and the setting of `:regex false` for MySQL have been around for years.\r\n\r\nIf newer MySQL versions support a fuller set of regex features, then perhaps `:regex` can be enabled for them. In particular, we have regexes that expect `:regex true` drivers to support things like lookahead and lookbehind. A separate feature request can be filed in that case.', 'created_at': datetime.datetime(2024, 5, 27, 20, 51, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2135715284, 'issue_id': 2318833184, 'author': 'bshepherdson', 'body': ""On further discussion, newer MySQL (and MariaDB) have proper PCRE support. I'm adding the `:regex` feature for the MySQL driver, and from Metabase 0.50 onwards `regexextract` (and other regex-powered features like extracting domains from emails and URLs) will be supported."", 'created_at': datetime.datetime(2024, 5, 28, 16, 53, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2140795542, 'issue_id': 2318833184, 'author': 'bshepherdson', 'body': 'Reopening until the backport to `release-x.50.x` lands: #43408 .', 'created_at': datetime.datetime(2024, 5, 30, 20, 15, 11, tzinfo=datetime.timezone.utc)}]","bshepherdson (Assginee) on (2024-05-27 20:51:44 UTC): This is deliberate, and not a new change or a regression so far as I can tell. MySQL only supports a poor subset of regular expression features, so it does not have the `:regex` driver feature. That [controls](https://github.com/metabase/metabase/blame/master/frontend/src/metabase-lib/v1/expressions/config.ts#L116) the `regexextract` function appearing in expressions. That code and the setting of `:regex false` for MySQL have been around for years.

If newer MySQL versions support a fuller set of regex features, then perhaps `:regex` can be enabled for them. In particular, we have regexes that expect `:regex true` drivers to support things like lookahead and lookbehind. A separate feature request can be filed in that case.

bshepherdson (Assginee) on (2024-05-28 16:53:55 UTC): On further discussion, newer MySQL (and MariaDB) have proper PCRE support. I'm adding the `:regex` feature for the MySQL driver, and from Metabase 0.50 onwards `regexextract` (and other regex-powered features like extracting domains from emails and URLs) will be supported.

bshepherdson (Assginee) on (2024-05-30 20:15:11 UTC): Reopening until the backport to `release-x.50.x` lands: #43408 .

"
2318694018,issue,closed,completed,"Previous period comparison shortcut in chill mode - ""+"" button",,kamilmielnik,2024-05-27 09:28:31+00:00,['kamilmielnik'],2024-10-08 17:09:25+00:00,2024-06-04 09:53:56+00:00,https://github.com/metabase/metabase/issues/43178,"[('.Frontend', ''), ('.Team/Querying', '')]",[],
2318502334,issue,closed,completed,Dashboard export to PNG renders incorrect font for labels,"Context: https://metaboat.slack.com/archives/C05MPF0TM3L/p1715860538574289
",perivamsi,2024-05-27 07:57:45+00:00,['kulyk'],2024-10-08 17:10:15+00:00,2024-05-29 16:14:54+00:00,https://github.com/metabase/metabase/issues/43175,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('Visualization/Download', ''), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.')]",[],
2318499451,issue,closed,not_planned,Err: Card Nox not exists when try to connet two Models /Questions from different database.,"### Describe the bug

I created two Questons), Once I try to create third question which includes two Questions from from two database. then the error comes, Card xxx not exists. 

My purpose to use metabase to connect two database and compare the completion of the sales target. 

### To Reproduce

1. Create two questions, they are from two database.
2. Create third question, and select two Question above
3. Error comes.

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
All the latest version from edge and Metabase.
```


### Severity

blocking your usage of Metabase entirely

### Additional context

_No response_",Jianbin719,2024-05-27 07:56:30+00:00,[],2024-05-27 13:55:18+00:00,2024-05-27 09:34:13+00:00,https://github.com/metabase/metabase/issues/43174,"[('Type:Bug', 'Product defects'), ('Querying/Nested Queries', 'Questions based on other saved questions')]","[{'comment_id': 2133072304, 'issue_id': 2318499451, 'author': 'Tony-metabase', 'body': 'That’s not possible. One of the most requested features. You’ll have to use a data warehouse. For reference:\r\n\r\nhttps://github.com/metabase/metabase/issues/3953', 'created_at': datetime.datetime(2024, 5, 27, 9, 34, 13, tzinfo=datetime.timezone.utc)}]","Tony-metabase on (2024-05-27 09:34:13 UTC): That’s not possible. One of the most requested features. You’ll have to use a data warehouse. For reference:

https://github.com/metabase/metabase/issues/3953

"
2318473816,issue,closed,completed,"""Add column"" button does nothing when summarizing","### Describe the bug

The ""Add column"" button (the plus button in the column header) does nothing when a table is the result of summarizing.

![image](https://github.com/metabase/metabase/assets/1250185/d3a722eb-e8ca-4ff9-8b3d-7b62616a7cad)


### To Reproduce

1. Browse data -> Orders
2. Summarize by Created at
3. Switch to tabular view
4. Click the blue `+` button in the column header, it does nothign


### Expected behavior

The button should not be visible since it has no purpose.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:126.0) Gecko/20100101 Firefox/126.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-05-23"",
      ""src_hash"": ""3408dbf541bb1904a57dcb2cf7022f8e76d2b1ba"",
      ""tag"": ""v0.1.6-SNAPSHOT"",
      ""hash"": ""40074bd""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-05-27 07:44:32+00:00,[],2024-10-08 17:10:16+00:00,2024-05-29 09:02:55+00:00,https://github.com/metabase/metabase/issues/43173,"[('Type:Bug', 'Product defects'), ('.Frontend', ''), ('Querying/Notebook', 'Items specific to the Custom/Notebook query builder')]",[],
2318345779,issue,closed,not_planned,No method in multimethod 'connection-details->spec' for dispatch value: :databend,"### Describe the bug

I am writing a custom metabase driver for databend and when I use the latest version of metabase, I got an error:

```
{:message ""No method in multimethod 'connection-details->spec' for dispatch value: :databend""}

```

When I downgrade to 0.47 it works well.

### To Reproduce

1. Download the 0.49.12 version metabase.jar to metabase-databend-driver
2. cd metabase-databend-driver
3. mvn deploy:deploy-file -Durl=file:repo -DgroupId=com.databend -DartifactId=metabase-core -Dversion=1.40 -Dpackaging=jar -Dfile=metabase.jar
4. LEIN_SNAPSHOTS_IN_RELEASE=true DEBUG=1 lein uberjar
5. cp target/uberjar/databend.metabase-driver.jar ./plugins
6. java -jar metabase.jar
7. Open localhost:3000 and add a databend database.
8. Got the error


### Expected behavior

Add database correctly.

### Logs

clojure.lang.ExceptionInfo: No method in multimethod 'connection-details->spec' for dispatch value: :databend {:message ""No method in multimethod 'connection-details->spec' for dispatch value: :databend""}
        at metabase.driver.util$can_connect_with_details_QMARK_.invokeStatic(util.clj:165)
        at metabase.driver.util$can_connect_with_details_QMARK_.doInvoke(util.clj:136)
        at clojure.lang.RestFn.invoke(RestFn.java:442)
        at metabase.api.database$test_database_connection.invokeStatic(database.clj:706)
        at metabase.api.database$test_database_connection.doInvoke(database.clj:696)
        at clojure.lang.RestFn.invoke(RestFn.java:425)
        at metabase.api.database$test_connection_details.invokeStatic(database.clj:760)
        at metabase.api.database$test_connection_details.invoke(database.clj:740)
        at metabase.api.database$fn__98532.invokeStatic(database.clj:782)
        at metabase.api.database$fn__98532.invoke(database.clj:764)
        at compojure.core$wrap_response$fn__44694.invoke(core.clj:160)
        at compojure.core$wrap_route_middleware$fn__44678.invoke(core.clj:132)
        at compojure.core$wrap_route_info$fn__44683.invoke(core.clj:139)
        at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:151)
        at clojure.lang.Var.invoke(Var.java:393)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:152)
        at clojure.lang.Var.invoke(Var.java:393)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706.invoke(core.clj:200)
        at metabase.server.middleware.auth$enforce_authentication$fn__94071.invoke(auth.clj:17)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706.invoke(core.clj:200)
        at compojure.core$make_context$handler__44734.invoke(core.clj:290)
        at compojure.core$make_context$fn__44738.invoke(core.clj:300)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$make_context$fn__44738.invoke(core.clj:301)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$make_context$fn__44738.invoke(core.clj:301)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$make_context$fn__44738.invoke(core.clj:301)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$make_context$fn__44738.invoke(core.clj:301)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$make_context$fn__44738.invoke(core.clj:301)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$make_context$fn__44738.invoke(core.clj:301)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$make_context$fn__44738.invoke(core.clj:301)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$make_context$fn__44738.invoke(core.clj:301)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at metabase.api.routes$fn__102137$fn__102140.invoke(routes.clj:67)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706.invoke(core.clj:200)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.server.routes$fn__102302$fn__102303.doInvoke(routes.clj:72)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706.invoke(core.clj:200)
        at compojure.core$make_context$handler__44734.invoke(core.clj:290)
        at compojure.core$make_context$fn__44738.invoke(core.clj:300)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:153)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:153)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at compojure.core$wrap_route_matches$fn__44687.invoke(core.clj:153)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706$f__44707$respond_SINGLEQUOTE___44708.invoke(core.clj:197)
        at metabase.server.routes$fn__102287$fn__102289.invoke(routes.clj:49)
        at compojure.core$routes$fn__44706$f__44707.invoke(core.clj:198)
        at compojure.core$routes$fn__44706.invoke(core.clj:200)
        at metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__98815.invoke(exceptions.clj:108)
        at metabase.server.middleware.exceptions$catch_api_exceptions$fn__98812.invoke(exceptions.clj:96)
        at metabase.server.middleware.log$log_api_call$fn__102579$fn__102580$fn__102581.invoke(log.clj:230)
        at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:18)
        at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12)
        at metabase.server.middleware.log$log_api_call$fn__102579$fn__102580.invoke(log.clj:222)
        at toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112)
        at toucan2.execute$do_with_call_counts.invoke(execute.clj:103)
        at metabase.server.middleware.log$log_api_call$fn__102579.invoke(log.clj:221)
        at metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__104644.invoke(browser_cookie.clj:40)
        at metabase.server.middleware.security$add_security_headers$fn__98771.invoke(security.clj:182)
        at metabase.server.middleware.json$wrap_json_body$fn__46051.invoke(json.clj:67)
        at metabase.server.middleware.offset_paging$handle_paging$fn__84969.invoke(offset_paging.clj:43)
        at metabase.server.middleware.json$wrap_streamed_json_response$fn__46069.invoke(json.clj:103)
        at ring.middleware.keyword_params$wrap_keyword_params$fn__104911.invoke(keyword_params.clj:55)
        at ring.middleware.params$wrap_params$fn__104930.invoke(params.clj:77)
        at metabase.server.middleware.misc$maybe_set_site_url$fn__67316.invoke(misc.clj:61)
        at metabase.server.middleware.session$reset_session_timeout$fn__72747.invoke(session.clj:546)
        at metabase.server.middleware.session$bind_current_user$fn__72713$fn__72714.invoke(session.clj:440)
        at metabase.server.middleware.session$do_with_current_user.invokeStatic(session.clj:419)
        at metabase.server.middleware.session$do_with_current_user.invoke(session.clj:403)
        at metabase.server.middleware.session$bind_current_user$fn__72713.invoke(session.clj:439)
        at metabase.server.middleware.session$wrap_current_user_info$fn__72696.invoke(session.clj:378)
        at metabase.server.middleware.session$wrap_session_id$fn__72668.invoke(session.clj:257)
        at metabase.server.middleware.auth$wrap_static_api_key$fn__94079.invoke(auth.clj:30)
        at ring.middleware.cookies$wrap_cookies$fn__104831.invoke(cookies.clj:194)
        at metabase.server.middleware.misc$add_content_type$fn__67298.invoke(misc.clj:29)
        at metabase.server.middleware.misc$disable_streaming_buffering$fn__67324.invoke(misc.clj:78)
        at ring.middleware.gzip$wrap_gzip$fn__104873.invoke(gzip.clj:86)
        at metabase.server.middleware.misc$bind_request$fn__67327.invoke(misc.clj:95)
        at metabase.server.middleware.ssl$redirect_to_https_middleware$fn__104660.invoke(ssl.clj:41)
        at metabase.server$async_proxy_handler$fn__67738.invoke(server.clj:78)
        at metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source)
        at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173)
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)
        at org.eclipse.jetty.server.Server.handle(Server.java:563)
        at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598)
        at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753)
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501)
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287)
        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314)
        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)
        at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)
        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)
        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)
        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)
        at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199)
        at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149)
        at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.lang.IllegalArgumentException: No method in multimethod 'connection-details->spec' for dispatch value: :databend
        at clojure.lang.MultiFn.getFn(MultiFn.java:156)
        at clojure.lang.MultiFn.invoke(MultiFn.java:233)
        at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection$fn__51133.invoke(connection.clj:315)
        at metabase.util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:165)
        at metabase.util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154)
        at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invokeStatic(connection.clj:314)
        at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invoke(connection.clj:310)
        at metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invokeStatic(connection.clj:339)
        at metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invoke(connection.clj:335)
        at metabase.driver.sql_jdbc$fn__106882.invokeStatic(sql_jdbc.clj:49)
        at metabase.driver.sql_jdbc$fn__106882.invoke(sql_jdbc.clj:47)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at metabase.driver.util$can_connect_with_details_QMARK_$fn__60068.invoke(util.clj:148)
        at clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047)
        at clojure.lang.AFn.call(AFn.java:18)
        at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
        at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
        at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
        ... 1 more
2024-05-27 14:24:48,441 DEBUG middleware.log :: POST /api/database 400 80.4 ms（1个数据库调用） 
{:message ""No method in multimethod 'connection-details->spec' for dispatch value: :databend""}


### Information about your Metabase installation

```JSON
- Macos 
- metabase 0.49.12
```


### Severity

high

### Additional context

_No response_",hantmac,2024-05-27 06:30:52+00:00,[],2024-05-27 14:53:41+00:00,2024-05-27 09:36:46+00:00,https://github.com/metabase/metabase/issues/43171,"[('Type:Bug', 'Product defects'), ('.Backend', ''), ('.Needs Triage', '')]","[{'comment_id': 2133077404, 'issue_id': 2318345779, 'author': 'Tony-metabase', 'body': ""Metabase doesn't support metabase-databend-driver ... you will need to check with the guys who created the repo:\r\n\r\nhttps://github.com/databendcloud/metabase-databend-driver\r\n\r\nAlso note the repo version because there wasn't any update since Oct 2023 so probably the driver needs to be updated to be compatible with version 49"", 'created_at': datetime.datetime(2024, 5, 27, 9, 36, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2133384625, 'issue_id': 2318345779, 'author': 'hantmac', 'body': ""> Metabase doesn't support metabase-databend-driver ... you will need to check with the guys who created the repo:\r\n> \r\n> https://github.com/databendcloud/metabase-databend-driver\r\n> \r\n> Also note the repo version because there wasn't any update since Oct 2023 so probably the driver needs to be updated to be compatible with version 49\r\n\r\nHi @Tony-metabase , thanks for responsing, I am actually working on the metabase-databend-driver, and I want to make to compatible with version 49. So what break changes in metabase 49 version ?  Because I use 47, 48 works well.  Or some docs can metabase driver developer can read?"", 'created_at': datetime.datetime(2024, 5, 27, 12, 31, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2133432518, 'issue_id': 2318345779, 'author': 'Tony-metabase', 'body': 'So this should get you started https://www.metabase.com/docs/latest/developers-guide/drivers/start\r\n\r\nAlso go through each version here and make sure your driver supports the changes mentioned there:\r\n\r\nhttps://www.metabase.com/docs/v0.49/developers-guide/driver-changelog', 'created_at': datetime.datetime(2024, 5, 27, 12, 58, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2133643221, 'issue_id': 2318345779, 'author': 'hantmac', 'body': '> So this should get you started https://www.metabase.com/docs/latest/developers-guide/drivers/start\r\n> \r\n> Also go through each version here and make sure your driver supports the changes mentioned there:\r\n> \r\n> https://www.metabase.com/docs/v0.49/developers-guide/driver-changelog\r\n\r\nThanks very much!', 'created_at': datetime.datetime(2024, 5, 27, 14, 53, 40, tzinfo=datetime.timezone.utc)}]","Tony-metabase on (2024-05-27 09:36:46 UTC): Metabase doesn't support metabase-databend-driver ... you will need to check with the guys who created the repo:

https://github.com/databendcloud/metabase-databend-driver

Also note the repo version because there wasn't any update since Oct 2023 so probably the driver needs to be updated to be compatible with version 49

hantmac (Issue Creator) on (2024-05-27 12:31:01 UTC): Hi @Tony-metabase , thanks for responsing, I am actually working on the metabase-databend-driver, and I want to make to compatible with version 49. So what break changes in metabase 49 version ?  Because I use 47, 48 works well.  Or some docs can metabase driver developer can read?

Tony-metabase on (2024-05-27 12:58:19 UTC): So this should get you started https://www.metabase.com/docs/latest/developers-guide/drivers/start

Also go through each version here and make sure your driver supports the changes mentioned there:

https://www.metabase.com/docs/v0.49/developers-guide/driver-changelog

hantmac (Issue Creator) on (2024-05-27 14:53:40 UTC): Thanks very much!

"
2316883563,issue,closed,completed,Support Azure Managed Identity,"Support [Azure Managed Identity](https://learn.microsoft.com/en-us/azure/postgresql/single-server/how-to-connect-with-managed-identity#retrieving-the-access-token-from-azure-instance-metadata-service) as an auth mechanism to login to Postgres hosted on Azure


context: https://metaboat.slack.com/archives/C01LQQ2UW03/p1716418798546319

This is a sample BASH script to do this
```

# Retrieve the access token

export PGPASSWORD=`curl -s 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&resource=https%3A%2F%2Fossrdbms-aad.database.windows.net&client_id=CLIENT_ID' -H Metadata:true | jq -r .access_token`

# Connect to the database

psql -h SERVER --user USER@SERVER DBNAME
```",perivamsi,2024-05-25 09:52:23+00:00,[],2024-06-08 09:56:39+00:00,2024-06-08 09:56:38+00:00,https://github.com/metabase/metabase/issues/43168,"[('Database/Postgres', None), ('.Backend', '')]","[{'comment_id': 2132518392, 'issue_id': 2316883563, 'author': 'paoliniluis', 'body': 'Same as IAM auth', 'created_at': datetime.datetime(2024, 5, 27, 2, 5, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2155927306, 'issue_id': 2316883563, 'author': 'perivamsi', 'body': 'Tracked here https://github.com/metabase/metabase/issues/43348', 'created_at': datetime.datetime(2024, 6, 8, 9, 56, 38, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-05-27 02:05:54 UTC): Same as IAM auth

perivamsi (Issue Creator) on (2024-06-08 09:56:38 UTC): Tracked here https://github.com/metabase/metabase/issues/43348

"
2316404039,issue,closed,completed,"Currency can not be undefined when style is ""currency"" when sending subscriptions (and you don't get the sign on the field)","### Describe the bug

Probably won't cause any problem but if you do a custom expression, make the field format as currencym, use one of the new viz's and make a subscription, then you get the error in the logs

### To Reproduce

1) make this query (see that the s tax is a custom expression)
![image](https://github.com/metabase/metabase/assets/1711649/00985968-e0bd-4d29-8b3f-81400d5b012a)

2) use an area chart
![image](https://github.com/metabase/metabase/assets/1711649/f8b57519-bfb0-4d0f-9a70-fe50dddf62fb)

3) make sure tax is a currency

4) add the chart to a dashboard and send a subscription, hit that in the logs

### Expected behavior

there should be no error and the currency sign should be on the subscription chart

### Logs

```
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
Error formatting number TypeError: Currency can not be undefined when style is ""currency"".
2024-05-24 23:28:13,327 DEBUG middleware.log :: POST /api/pulse/test 200 5.7 s (77 DB calls) App DB connections: 0/7 Jetty threads: 7/50 (9 idle, 0 queued) (94 total active threads) Queries in flight: 0 (0 queued); postgres DB 2 connections: 0/2 (0 threads blocked) {:metabase-user-id 1}

```

### Information about your Metabase installation

```JSON
v50
```


### Severity

P2

### Additional context

this is the chart (check the dollar sign on the x-axis)
![image](https://github.com/metabase/metabase/assets/1711649/52de0e0b-68a8-42af-a182-34c5c36eba8c)

this is the subscription
![image](https://github.com/metabase/metabase/assets/1711649/297289f2-7d9a-41b5-a570-3dbc7a1c3f84)
",paoliniluis,2024-05-24 23:40:12+00:00,['EmmadUsmani'],2024-07-31 20:26:51+00:00,2024-07-31 20:26:35+00:00,https://github.com/metabase/metabase/issues/43165,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Pulses', 'Now called Subscriptions'), ('Customization/Formatting', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('Querying/Notebook/Custom Expression', ''), ('.Already Fixed', 'will apear in ""Already Fixed"" in the release notes (not ""Bug Fixes"" that we actively fixed)'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2261391237, 'issue_id': 2316404039, 'author': 'EmmadUsmani', 'body': ""Tried reproducing, looks like it's fixed now.\r\n\r\nhttps://github.com/user-attachments/assets/6158fefb-0785-4db1-8df8-df8d3a6f229d"", 'created_at': datetime.datetime(2024, 7, 31, 20, 26, 35, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Assginee) on (2024-07-31 20:26:35 UTC): Tried reproducing, looks like it's fixed now.

https://github.com/user-attachments/assets/6158fefb-0785-4db1-8df8-df8d3a6f229d

"
2316393253,issue,closed,completed,We don't respect the column custom format for custom expressions,"### Describe the bug

Probably similar or the same as https://github.com/metabase/metabase/issues/43040, but if you make a custom expression you don't get the custom formatting

### To Reproduce

1) new question from orders
2) add a custom expression like ""sum(total)"" and ""average(tax)"", group by category
3) format the sum and average as money with the sign next to the columns
4) export it, you get the columns without the format

### Expected behavior

it should get the format

### Logs

NA

### Information about your Metabase installation

```JSON
v49
```


### Severity

P2

### Additional context

NA",paoliniluis,2024-05-24 23:22:09+00:00,[],2024-08-13 17:57:24+00:00,2024-08-09 19:50:14+00:00,https://github.com/metabase/metabase/issues/43164,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Chart Settings', ''), ('Reporting/Export', ''), ('Customization/Formatting', ''), ('.Backend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2316365233,issue,closed,completed,Animation happening when hovering between columns that prevents the column metadata from populating fast,"### Describe the bug

There's a weird animation happening when I hover between columns

### To Reproduce

1) create a question and transform it into a model
2) then hover over the columns on the right, see the screen turning white'ish

### Expected behavior

It should not do any animation

### Logs

NA

### Information about your Metabase installation

```JSON
v50
```


### Severity

P3

### Additional context

![Peek 2024-05-24 19-44](https://github.com/metabase/metabase/assets/1711649/9b040c6d-8e52-4511-a39a-0493a46f0088)
",paoliniluis,2024-05-24 22:45:00+00:00,['uladzimirdev'],2024-07-15 20:58:09+00:00,2024-07-11 14:15:54+00:00,https://github.com/metabase/metabase/issues/43163,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('Querying/Models', 'aka Datasets'), ('.Team/Querying', '')]","[{'comment_id': 2214195096, 'issue_id': 2316365233, 'author': 'NevRA', 'body': '@paoliniluis can you help with reproduction?', 'created_at': datetime.datetime(2024, 7, 8, 14, 13, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2220674403, 'issue_id': 2316365233, 'author': 'uladzimirdev', 'body': '@NevRA I was able to reproduce it using steps from @paoliniluis. `Orders` table and `Quantity` column do the trick, but the column needs to be close to the end of a viewport\r\n\r\n\r\n\r\nhttps://github.com/metabase/metabase/assets/125459446/b4b38475-86b5-477b-8fa1-de788f753b8c', 'created_at': datetime.datetime(2024, 7, 10, 14, 30, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2222338478, 'issue_id': 2316365233, 'author': 'nemanjaglumac', 'body': ""The same thing happens when you resize the window. This is probably why it's possible to reproduce only on the last column. The tooltip (popover) renders most likely just slightly out of the window constraints. Notice it adds the horizontal scroll."", 'created_at': datetime.datetime(2024, 7, 11, 8, 28, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2229421300, 'issue_id': 2316365233, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.50.14](https://github.com/metabase/metabase/milestone/254)', 'created_at': datetime.datetime(2024, 7, 15, 20, 58, 8, tzinfo=datetime.timezone.utc)}]","NevRA on (2024-07-08 14:13:10 UTC): @paoliniluis can you help with reproduction?

uladzimirdev (Assginee) on (2024-07-10 14:30:22 UTC): @NevRA I was able to reproduce it using steps from @paoliniluis. `Orders` table and `Quantity` column do the trick, but the column needs to be close to the end of a viewport



https://github.com/metabase/metabase/assets/125459446/b4b38475-86b5-477b-8fa1-de788f753b8c

nemanjaglumac on (2024-07-11 08:28:44 UTC): The same thing happens when you resize the window. This is probably why it's possible to reproduce only on the last column. The tooltip (popover) renders most likely just slightly out of the window constraints. Notice it adds the horizontal scroll.

github-actions[bot] on (2024-07-15 20:58:08 UTC): 🚀 This should also be released by [v0.50.14](https://github.com/metabase/metabase/milestone/254)

"
2316364154,issue,open,,"Ability to ""hide"" a question's name or title on a dashboard widget ","**Is your feature request related to a problem? Please describe.**
As a user designing a dashboard, I want to have fine-grained control over what text appears above my visualization.  For space reasons, I might not want to use space that displays the Question title or Question name in a dashboard.   

**Describe the solution you'd like**
I should be able to select or toggle whether to ""Hide"" or ""Show"" a questions name on a dashboard. 

**Describe alternatives you've considered**
None available

**How important is this feature to you?**
Very

**Additional context**
Add any other context or screenshots about the feature request here.
",ronrlin,2024-05-24 22:44:21+00:00,[],2024-06-04 14:30:15+00:00,,https://github.com/metabase/metabase/issues/43162,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('Visualization/Chart Settings', '')]","[{'comment_id': 2147687491, 'issue_id': 2316364154, 'author': 'ignacio-mb', 'body': 'Related to https://github.com/metabase/metabase/issues/8437 regarding customizability of charts', 'created_at': datetime.datetime(2024, 6, 4, 14, 29, 52, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-06-04 14:29:52 UTC): Related to https://github.com/metabase/metabase/issues/8437 regarding customizability of charts

"
2316328558,issue,closed,completed,Remove Trash from release v50,We've decided to remove the Trash from the RC for now. We'll take some additional time to make sure we're in a good place for v51.,johnswanson,2024-05-24 22:14:24+00:00,"['johnswanson', 'sloansparger']",2024-05-28 19:06:30+00:00,2024-05-28 19:06:30+00:00,https://github.com/metabase/metabase/issues/43159,[],[],
2316328518,issue,closed,not_planned,Remove Trash from release v50,,johnswanson,2024-05-24 22:14:20+00:00,[],2024-05-24 23:03:22+00:00,2024-05-24 23:03:22+00:00,https://github.com/metabase/metabase/issues/43158,[],"[{'comment_id': 2130495185, 'issue_id': 2316328518, 'author': 'paoliniluis', 'body': 'dupe?', 'created_at': datetime.datetime(2024, 5, 24, 23, 3, 11, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-05-24 23:03:11 UTC): dupe?

"
2316309766,issue,closed,completed,"New dashboard modal takes the previous dashboard context when pressing ""enter""","### Describe the bug

Modal mayhem

### To Reproduce

1) create an empty dashboard, save it on the our analytics with name ""first""
2) now create a question, save it, click ""yes"" when it asks you to add it to a dashboard
3) in the modal that opens, click on ""create a new dashboard""
4) type in the 2nd modal ""second"" and press the ""ENTER"" key on your keyboard

... your question will be saved to ""first"" and not to ""second"" (second will never be created)

### Expected behavior

Second should be created with the question

### Logs

NA

### Information about your Metabase installation

```JSON
v50
```


### Severity

P2

### Additional context

_No response_",paoliniluis,2024-05-24 21:51:51+00:00,[],2024-07-26 13:13:23+00:00,2024-07-26 13:13:23+00:00,https://github.com/metabase/metabase/issues/43157,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2237479672, 'issue_id': 2316309766, 'author': 'rafpaf', 'body': 'Illustration of the bug: https://www.loom.com/share/85925cd6f9f04cfba99a5e401990ca87?sid=aa7ed458-19b0-49f4-a55c-1f586ed038e5', 'created_at': datetime.datetime(2024, 7, 18, 20, 11, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2252739911, 'issue_id': 2316309766, 'author': 'npfitz', 'body': 'Closing as a duplicate of https://github.com/metabase/metabase/issues/45360. Fix should already be in 50.16.', 'created_at': datetime.datetime(2024, 7, 26, 13, 13, 23, tzinfo=datetime.timezone.utc)}]","rafpaf on (2024-07-18 20:11:48 UTC): Illustration of the bug: https://www.loom.com/share/85925cd6f9f04cfba99a5e401990ca87?sid=aa7ed458-19b0-49f4-a55c-1f586ed038e5

npfitz on (2024-07-26 13:13:23 UTC): Closing as a duplicate of https://github.com/metabase/metabase/issues/45360. Fix should already be in 50.16.

"
2316307592,issue,closed,completed,Single metadata endpoint for a dashboard,"Single /api/dashboard/:id/query_metadata endpoint that returns all metadata for a dashboard

This will improve the dashboard load performance

context: https://metaboat.slack.com/archives/C0645JP1W81/p1716586270545149",perivamsi,2024-05-24 21:49:42+00:00,['snoe'],2024-10-08 17:10:11+00:00,2024-05-29 21:21:05+00:00,https://github.com/metabase/metabase/issues/43156,"[('Reporting/Dashboards', ''), ('Querying/MBQL', ''), ('Type:New Feature', ''), ('.Backend', '')]","[{'comment_id': 2130418241, 'issue_id': 2316307592, 'author': 'ranquild', 'body': 'Please use this format:\r\n```\r\n{\r\n  databases: { // /api/database OR /api/database/:id for each db\r\n    dbId1: db1,\r\n    dbId2: db2,\r\n  },\r\n  schemas: { \r\n    dbId1: [""schema1"", ""schema2""], // /api/database/:id/schemas\r\n    dbId2: [""schema1"", ""schema2""],\r\n  },\r\n  tables: { // /api/table/:id/query_metadata and /api/table/card__:id/query_metadata\r\n    table1Id: table1,\r\n    table2Id: table2,\r\n   ""card__1"": card1Metadata,\r\n  },\r\n  fields: { // /api/field/:id\r\n  }\r\n}\r\n```\r\n\r\nWhere entries are obtained by calling `Lib.dependentMetadata` for each card in the dashboard.', 'created_at': datetime.datetime(2024, 5, 24, 21, 56, 36, tzinfo=datetime.timezone.utc)}]","ranquild on (2024-05-24 21:56:36 UTC): Please use this format:
```
{
  databases: { // /api/database OR /api/database/:id for each db
    dbId1: db1,
    dbId2: db2,
  },
  schemas: { 
    dbId1: [""schema1"", ""schema2""], // /api/database/:id/schemas
    dbId2: [""schema1"", ""schema2""],
  },
  tables: { // /api/table/:id/query_metadata and /api/table/card__:id/query_metadata
    table1Id: table1,
    table2Id: table2,
   ""card__1"": card1Metadata,
  },
  fields: { // /api/field/:id
  }
}
```

Where entries are obtained by calling `Lib.dependentMetadata` for each card in the dashboard.

"
2316299611,issue,closed,completed,"Connecting a filter to a model will render ""unknown field""","### Describe the bug

If you connect a filter to model in a dashboard you get an ""unknown field"" error

### To Reproduce

1) create a model (orders join people)
2) add it to a dashboard
3) connect a categorical filter to it
4) see the error
![image](https://github.com/metabase/metabase/assets/1711649/7a0a5603-d1b5-4df9-9ee6-eddae9e70531)

### Expected behavior

It should show the name of the field

### Logs

NA

### Information about your Metabase installation

```JSON
v50
```


### Severity

P2

### Additional context

Probably related to https://github.com/metabase/metabase/issues/43154

(I believe it's a P2, but might have something to do with metadata so it could transform to a P1)",paoliniluis,2024-05-24 21:39:52+00:00,['ranquild'],2024-06-06 21:45:34+00:00,2024-06-06 21:44:45+00:00,https://github.com/metabase/metabase/issues/43155,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Dashboards', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('Querying/Models', 'aka Datasets'), ('.Escalation', '')]","[{'comment_id': 2142225579, 'issue_id': 2316299611, 'author': 'paoliniluis', 'body': 'pretty sure it has a strong connection to https://github.com/metabase/metabase/issues/42379', 'created_at': datetime.datetime(2024, 5, 31, 13, 54, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2152358527, 'issue_id': 2316299611, 'author': 'ranquild', 'body': '@paoliniluis I cannot repro in v50. Could you double check?', 'created_at': datetime.datetime(2024, 6, 6, 12, 54, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2153456102, 'issue_id': 2316299611, 'author': 'paoliniluis', 'body': 'fixed', 'created_at': datetime.datetime(2024, 6, 6, 21, 44, 45, tzinfo=datetime.timezone.utc)}]","paoliniluis (Issue Creator) on (2024-05-31 13:54:36 UTC): pretty sure it has a strong connection to https://github.com/metabase/metabase/issues/42379

ranquild (Assginee) on (2024-06-06 12:54:51 UTC): @paoliniluis I cannot repro in v50. Could you double check?

paoliniluis (Issue Creator) on (2024-06-06 21:44:45 UTC): fixed

"
2316293346,issue,closed,completed,Filters connected to categorical fields don't work anymore if question is based on a model,"### Describe the bug

We have a big regression in filters on dashboards. It does not even fire the query to populate the values

### To Reproduce

1) create a model (orders join people), save it
2) create a question based on that model, just get the entire model as a table
3) create a dashboard, add the question and add a categorical filter, connect it to ""people - user -> source""
![image](https://github.com/metabase/metabase/assets/1711649/8dcbecb4-418c-431f-920c-8536d4c673a0)
4) then save it and try to use the filter, you don't get any values
![image](https://github.com/metabase/metabase/assets/1711649/e9dbc3a3-75c1-427c-bb9c-7b9c0c4ffdbb)

### Expected behavior

It should get the filter values

### Logs

NA

### Information about your Metabase installation

```JSON
v50, but I think this comes from v49
```


### Severity

P1

### Additional context

_No response_",paoliniluis,2024-05-24 21:35:07+00:00,"['bshepherdson', 'ranquild']",2024-05-31 14:05:10+00:00,2024-05-31 14:05:10+00:00,https://github.com/metabase/metabase/issues/43154,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Dashboards', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Backend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('Querying/Models', 'aka Datasets'), ('.Escalation', '')]","[{'comment_id': 2133589977, 'issue_id': 2316293346, 'author': 'paoliniluis', 'body': 'we need to backport this to 49', 'created_at': datetime.datetime(2024, 5, 27, 14, 23, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2141862026, 'issue_id': 2316293346, 'author': 'bshepherdson', 'body': 'Keeping this open until the backport is done.', 'created_at': datetime.datetime(2024, 5, 31, 11, 43, 42, tzinfo=datetime.timezone.utc)}]","paoliniluis (Issue Creator) on (2024-05-27 14:23:30 UTC): we need to backport this to 49

bshepherdson (Assginee) on (2024-05-31 11:43:42 UTC): Keeping this open until the backport is done.

"
2316286019,issue,closed,completed,BE flake: metabase.models.dashboard-card-test/update-dashboard-card!-call-count-test,"This has failed 6 times in the last 7 days (written 24 May). [Source](https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBmbGFrZXMgYnkgc3VpdGUgbmFtZSBhbmQgdGVzdCBuYW1lIChub3QgUVApIiwiZGVzY3JpcHRpb24iOiJodHRwczovL3N0YXRzLm1ldGFiYXNlLmNvbS9tb2RlbC8xNDgyOC10ZXN0LWZsYWtpbmVzcyIsImRhdGFzZXRfcXVlcnkiOnsiZGF0YWJhc2UiOjI2LCJ0eXBlIjoicXVlcnkiLCJxdWVyeSI6eyJhZ2dyZWdhdGlvbiI6W1siY291bnQiXSxbIm1heCIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl91cmwiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dXSxbIm1heCIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl9zdGFydGVkX2F0Iix7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWVXaXRoTG9jYWxUWiIsInRlbXBvcmFsLXVuaXQiOiJtaW51dGUifV1dLFsiYWdncmVnYXRpb24tb3B0aW9ucyIsWyJjb3VudC13aGVyZSIsWyI-IixbImZpZWxkIiwid29ya2Zsb3dfcnVuX3N0YXJ0ZWRfYXQiLHsiYmFzZS10eXBlIjoidHlwZS9EYXRlVGltZVdpdGhMb2NhbFRaIn1dLFsiZGF0ZXRpbWUtc3VidHJhY3QiLFsibm93Il0sMywiZGF5Il1dXSx7Im5hbWUiOiJDb3VudCAobGFzdCAzZCkiLCJkaXNwbGF5LW5hbWUiOiJDb3VudCAobGFzdCAzZCkifV1dLCJicmVha291dCI6W1siZmllbGQiLCJzdWl0ZV9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwidGVzdF9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwid29ya2Zsb3dfcnVuX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLCJ3b3JrZmxvd19qb2JfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV1dLCJvcmRlci1ieSI6W1siZGVzYyIsWyJhZ2dyZWdhdGlvbiIsM11dLFsiZGVzYyIsWyJhZ2dyZWdhdGlvbiIsMF1dXSwic291cmNlLXRhYmxlIjoiY2FyZF9fMTQ4MjgiLCJmaWx0ZXIiOlsiYW5kIixbImNvbnRhaW5zIixbImZpZWxkIiwidGVzdF9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSwiY2FsbC1jb3VudCIseyJjYXNlLXNlbnNpdGl2ZSI6ZmFsc2V9XSxbIj0iLFsiZmllbGQiLCJ0ZXN0X25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJ1cGRhdGUtZGFzaGJvYXJkLWNhcmQhLWNhbGwtY291bnQtdGVzdCJdXX19LCJkaXNwbGF5IjoidGFibGUiLCJkaXNwbGF5SXNMb2NrZWQiOnRydWUsInBhcmFtZXRlcnMiOltdLCJ2aXN1YWxpemF0aW9uX3NldHRpbmdzIjp7InRhYmxlLnBpdm90X2NvbHVtbiI6InN1aXRlX25hbWUiLCJ0YWJsZS5jZWxsX2NvbHVtbiI6ImNvdW50IiwidGFibGUucGl2b3QiOmZhbHNlLCJ0YWJsZS5jb2x1bW5zIjpbeyJuYW1lIjoic3VpdGVfbmFtZSIsImtleSI6IltcIm5hbWVcIixcInN1aXRlX25hbWVcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsInN1aXRlX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dfSx7Im5hbWUiOiJ0ZXN0X25hbWUiLCJrZXkiOiJbXCJuYW1lXCIsXCJ0ZXN0X25hbWVcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsInRlc3RfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV19LHsibmFtZSI6IndvcmtmbG93X3J1bl9uYW1lIiwia2V5IjoiW1wibmFtZVwiLFwid29ya2Zsb3dfcnVuX25hbWVcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsIndvcmtmbG93X3J1bl9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XX0seyJuYW1lIjoid29ya2Zsb3dfam9iX25hbWUiLCJrZXkiOiJbXCJuYW1lXCIsXCJ3b3JrZmxvd19qb2JfbmFtZVwiXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImZpZWxkIiwid29ya2Zsb3dfam9iX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dfSx7Im5hbWUiOiJDb3VudCAobGFzdCAzZCkiLCJrZXkiOiJbXCJuYW1lXCIsXCJDb3VudCAobGFzdCAzZClcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJhZ2dyZWdhdGlvbiIsM119LHsibmFtZSI6ImNvdW50Iiwia2V5IjoiW1wibmFtZVwiLFwiY291bnRcIl0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJhZ2dyZWdhdGlvbiIsMF19LHsibmFtZSI6Im1heCIsImtleSI6IltcIm5hbWVcIixcIm1heFwiXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImFnZ3JlZ2F0aW9uIiwxXX0seyJuYW1lIjoibWF4XzIiLCJrZXkiOiJbXCJuYW1lXCIsXCJtYXhfMlwiXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImFnZ3JlZ2F0aW9uIiwyXX1dLCJjb2x1bW5fc2V0dGluZ3MiOnsiW1wibmFtZVwiLFwiY291bnRcIl0iOnsiY29sdW1uX3RpdGxlIjoiQ291bnQgKGxhc3QgN2QpIn0sIltcIm5hbWVcIixcIm1heFwiXSI6eyJjb2x1bW5fdGl0bGUiOiJMYXN0IGZhaWxlZCBydW4ifSwiW1wibmFtZVwiLFwibWF4XzJcIl0iOnsiY29sdW1uX3RpdGxlIjoiTGFzdCBmYWlsZWQgZGF0ZSIsImRhdGVfc3R5bGUiOiJNTU1NIEQsIFlZWVkiLCJ0aW1lX2VuYWJsZWQiOm51bGx9fX0sIm9yaWdpbmFsX2NhcmRfaWQiOjE1MjEyfQ==)

[example failure](https://github.com/metabase/metabase/actions/runs/9204616998/job/25318542157#step:4:3351)

logs:
```
FAIL in metabase.models.dashboard-card-test/update-dashboard-card!-call-count-test (dashboard_card_test.clj:245)
This tracks the call count of update-dashcards! for the purpose of optimizing the
           PUT /api/dashboard/:id/cards handler 
with temporary :model/Dashboard with attributes
{:creator_id 2,
 :name ""JPKYSGPXMVWTKHIZTPIA"",
 :created_at #t ""2024-05-23T08:42:52.027058Z[UTC]"",
 :updated_at #t ""2024-05-23T08:42:52.027059Z[UTC]""}

 
with temporary :model/Card with attributes
{:creator_id 2,
 :database_id 1,
 :dataset_query {},
 :display :table,
 :name ""VURHKZFDCIRBNXSSETPU"",
 :visualization_settings {},
 :created_at #t ""2024-05-23T08:42:52.031346Z[UTC]"",
 :updated_at #t ""2024-05-23T08:42:52.031347Z[UTC]""}

 
with temporary :model/DashboardCard with attributes
{:row 0,
 :col 0,
 :size_x 4,
 :size_y 4,
 :created_at #t ""2024-05-23T08:42:52.037440Z[UTC]"",
 :updated_at #t ""2024-05-23T08:42:52.037440Z[UTC]"",
 :dashboard_id 524,
 :card_id 1924}

 
with temporary :model/DashboardCard with attributes
{:row 0,
 :col 0,
 :size_x 4,
 :size_y 4,
 :created_at #t ""2024-05-23T08:42:52.041427Z[UTC]"",
 :updated_at #t ""2024-05-23T08:42:52.041428Z[UTC]"",
 :dashboard_id 524,
 :card_id 1924}

 
with temporary :model/DashboardCard with attributes
{:row 0,
 :col 0,
 :size_x 4,
 :size_y 4,
 :created_at #t ""2024-05-23T08:42:52.045442Z[UTC]"",
 :updated_at #t ""2024-05-23T08:42:52.045443Z[UTC]"",
 :dashboard_id 524,
 :card_id 1924}

 
with temporary :model/Card with attributes
{:creator_id 2,
 :database_id 1,
 :dataset_query {},
 :display :table,
 :name ""Series Card 1"",
 :visualization_settings {},
 :created_at #t ""2024-05-23T08:42:52.049621Z[UTC]"",
 :updated_at #t ""2024-05-23T08:42:52.049622Z[UTC]""}

 
with temporary :model/Card with attributes
{:creator_id 2,
 :database_id 1,
 :dataset_query {},
 :display :table,
 :name ""Series Card 2"",
 :visualization_settings {},
 :created_at #t ""2024-05-23T08:42:52.056443Z[UTC]"",
 :updated_at #t ""2024-05-23T08:42:52.056444Z[UTC]""}

 Should have more calls if there are changes to the dashcards
expected: 10
  actual: 11
```

It's happening on MySQL and Postgres.",calherries,2024-05-24 21:28:12+00:00,['calherries'],2024-10-08 17:10:23+00:00,2024-05-28 19:22:07+00:00,https://github.com/metabase/metabase/issues/43153,"[('.Backend', ''), ('flaky-test-fix', ''), ('.Team/Workflows', 'aka BEC')]",[],
2316284804,issue,open,,We should abandon arrows in the column names and adopt a dash or a dot,"**Is your feature request related to a problem? Please describe.**
Interesting bug that happens when users export tables that have joins: weird characters appear on the column names since they have Excel or something else configured in another language or locale. If we abandon the arrows in the names and just use a dash or a dot we would avoid that bug

**Describe the solution you'd like**
Let's start using dots or dashes for the field names on joins / json unfolding

**Describe alternatives you've considered**
None

**How important is this feature to you?**
Some customers have customers that hit this issue as their locale does not use UTF-8 as the default encoding

**Additional context**
NA
",paoliniluis,2024-05-24 21:27:09+00:00,[],2024-05-24 21:29:26+00:00,,https://github.com/metabase/metabase/issues/43152,"[('Administration/Metadata & Sync', ''), ('Type:New Feature', ''), ('Customization/Formatting', ''), ('.Backend', '')]",[],
2316263756,issue,closed,completed,[BE] Add `type` property to `/api/table/card__:id/query_metadata` to avoid unneeded requests to `/api/card/:id`,"`Lib.dependentMetadata` requests cards (`/api/card/:id`) alongside query metadata (`/api/table/card__:id/query_metadata`) to get the `type` property. This causes mostly duplicate requests which results in bad performance for dashboards and incorrect records for which items are ""recent"". Let's add `type` property to `/api/table/card__:id/query_metadata` and remove `card` entries from `dependentMetadata`.",ranquild,2024-05-24 21:08:57+00:00,['metamben'],2024-05-28 23:10:58+00:00,2024-05-28 23:10:58+00:00,https://github.com/metabase/metabase/issues/43151,"[('.Backend', '')]",[],
2316187081,issue,closed,completed,Fix url changes multiple times when switch Dashboard tab + PR follow-ups,"**Context**

Convert DashboardControls to TS hooks #42777 causes a new issue. When a user switch Dashboard tab, url changes multiple times.

See https://github.com/metabase/metabase/pull/42777#issuecomment-2130092696 for more details.

- issue links: [Add static dashboards to embedding SDK](https://github.com/metabase/metabase/pull/41973)

**Dev notes**
From what I can see, the issue happens because we call history.replaceState from multiple places at the same time during Dashboard tab rendering:
* We update current active tab in https://github.com/metabase/metabase/blob/5e29f434a055a4d4413da16d7f1f7fe306c9440d/frontend/src/metabase/dashboard/components/DashboardTabs/use-sync-url-slug.ts#L81-L91

* and then we also set filters params to the URL as well in https://github.com/metabase/metabase/blob/5e29f434a055a4d4413da16d7f1f7fe306c9440d/frontend/src/metabase/hooks/use-synced-query-string.ts#L26-L32

The root cause seems to be that these calls override each other multiple times.

",deniskaber,2024-05-24 20:12:38+00:00,['kulyk'],2024-07-18 10:33:32+00:00,2024-07-18 10:30:59+00:00,https://github.com/metabase/metabase/issues/43145,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2316067707,issue,open,,"Don't use ""select *"" when fetching cached models in columnar DB's","### Describe the bug

Checking https://github.com/metabase/metabase/issues/43137 I was thinking that when we do caching of models we end up firing ""select * ..."" to the cached models. This might work fine for postgres but not for redshift, so we should also apply the solution mentioned in the issue linked

### To Reproduce

1) create a model in redshift
2) cache it
3) fire a query to the cached model
4) see that we're sending a select * in the subquery, which is not recommended at all in columnar dbs

### Expected behavior

NA

### Logs

NA

### Information about your Metabase installation

```JSON
it has been there since forever
```


### Severity

P2

### Additional context

_No response_",paoliniluis,2024-05-24 18:57:33+00:00,[],2025-02-04 20:28:23+00:00,,https://github.com/metabase/metabase/issues/43138,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Performance', ''), ('Database/Redshift', None), ('.Backend', ''), ('Querying/Cache', ''), ('.Team/Querying', '')]",[],
