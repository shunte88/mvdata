id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2449602067,pull_request,closed,,"[Permissions] Add ""No access"" schema/table permission","Pursuant of #46379

### Description

Adds a new ""Blocked"" option to tables and schemas. This PR implements the minimum set of requirements defined in the following prod doc/designs to accomplish this:
- Prod doc - https://www.notion.so/metabase/Add-the-No-access-table-level-permission-07044439723e40fd9c88dca4f33e9a8f?pvs=4
- Figma - https://www.figma.com/design/zUL1LA0EW4RUZNVzGnqmKm/Streamline-Sandbox-Setup?node-id=67-738&t=C61xq3xSLl9sVwW6-4

### Demo
Schema + table level blocking
https://github.com/user-attachments/assets/c8f74040-96c3-431e-bb3b-e46c77fdaa32

Permission warning modal a child entity as ""blocked"" permissions and is trying to upgrade ""create queries"" access 
https://github.com/user-attachments/assets/0141cad5-78d7-425a-9098-4a0b0190f591


![CleanShot 2024-08-12 at 18 06 08@2x](https://github.com/user-attachments/assets/17683577-5ca2-4219-9d69-fcbc27fdd86a)

Sandboxing modal has copy changes:
![CleanShot 2024-08-13 at 09 43 48@2x](https://github.com/user-attachments/assets/f59c3f47-b345-4008-9e32-39f1265ac129)

Permission warning modal changes:
(db-level w/ sandboxed tables)
![CleanShot 2024-08-13 at 16 20 08@2x](https://github.com/user-attachments/assets/b32d912c-3ef6-466b-b1da-bf08419ce4de)
(schema-level w/o sandboxed tables)
![CleanShot 2024-08-13 at 16 19 45@2x](https://github.com/user-attachments/assets/b5c185f4-6fbc-494c-9270-99f4a22e74d3)



### Checklist

- [x] Tests have been added/updated to cover changes in this PR
(note: more test coverage in #46663)
",sloansparger,2024-08-05 22:49:07+00:00,['sloansparger'],2024-08-13 22:39:36+00:00,2024-08-13 22:39:34+00:00,https://github.com/metabase/metabase/pull/46509,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2449557788,pull_request,closed,,Use message's query for async updates,"### Description 

This change updates ""priority"" query analysis to skip querying the database for details, and to get all its information from the message payload. This saves performing an extra query, but more importantly removes the (broken) requirement that the card is committed to the db before analysis is requested.

Using in-memory data means that concurrent updates to a card's query may commit in a different order to their message dispatching, and we will then end up with analysis for  stale query. In practice its unlikely to get such high frequency edits to the query, and in that case they're unlikely to be large enough changes the analysis meaningfully. If the worst does come pass though, future improvements to the sweeper will pick this up by checking the analysis against a hash of the query.",crisptrutski,2024-08-05 22:06:15+00:00,['crisptrutski'],2024-10-08 16:18:42+00:00,2024-08-06 09:11:14+00:00,https://github.com/metabase/metabase/pull/46508,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2449539526,pull_request,closed,,"🤖 backported ""Remove uncessary db calls when updating card""","  #46480
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-05 21:50:30+00:00,"['qnkhuat', 'github-automation-metabase']",2024-08-06 08:20:14+00:00,2024-08-06 08:20:12+00:00,https://github.com/metabase/metabase/pull/46507,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2449518038,pull_request,closed,,"🤖 backported ""ci: enable video recordings for failing cypress tests""",#46281,github-automation-metabase,2024-08-05 21:32:50+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-08-06 09:27:18+00:00,2024-08-06 09:27:17+00:00,https://github.com/metabase/metabase/pull/46506,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2449491024,pull_request,closed,,automatically use compact formatting for pie chart total,"Closes https://github.com/metabase/metabase/issues/26916

### Description

Will automatically use compact number formatting for the total/slice value text in the center of the pie chart, if the text would overflow without it.

### How to verify

Create the following question, visualize as a pie chart, add to a dashboard and make the card small

<img width=""1191"" alt=""Screenshot 2024-08-05 at 2 16 43 PM"" src=""https://github.com/user-attachments/assets/94e78554-45aa-46e6-b320-657fdcccdb5b"">

### Demo

https://github.com/user-attachments/assets/7cb47efb-f99a-4c59-abaf-a0622574912b

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",EmmadUsmani,2024-08-05 21:13:42+00:00,['EmmadUsmani'],2024-08-25 21:29:38+00:00,2024-08-08 15:45:36+00:00,https://github.com/metabase/metabase/pull/46505,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2269929959, 'issue_id': 2449491024, 'author': 'EmmadUsmani', 'body': '* **#47208** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47208?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46607** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46607?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46505** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46505?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* **#46466** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46466?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 5, 21, 13, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2269930085, 'issue_id': 2449491024, 'author': 'EmmadUsmani', 'body': '> [!WARNING]\n> <b>This pull request is not mergeable via GitHub because a downstack PR is open. Once all requirements are satisfied, merge this PR as a stack <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46505?utm_source=stack-comment-downstack-mergeability-warning"" >on Graphite</a>.</b>\n> <a href=""https://graphite.dev/docs/merge-pull-requests"">Learn more</a>\n\n* **#46505** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46505?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* **#46466** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46466?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 5, 21, 14, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2269938509, 'issue_id': 2449491024, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 82d25cafe2cc49d12339b294c695da93c44be74a...86b7ded443e3284aa1430afddf937a775bc34576.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/echarts/pie/constants.ts<br>frontend/src/metabase/visualizations/echarts/pie/format.ts<br>frontend/src/metabase/visualizations/echarts/pie/option.ts |', 'created_at': datetime.datetime(2024, 8, 5, 21, 19, 57, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-08-05 21:13:58 UTC): * **#47208** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47208?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46607** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46607?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46505** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46505?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* **#46466** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46466?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

EmmadUsmani (Issue Creator) on (2024-08-05 21:14:04 UTC): * **#46505** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46505?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* **#46466** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46466?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

github-actions[bot] on (2024-08-05 21:19:57 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 82d25cafe2cc49d12339b294c695da93c44be74a...86b7ded443e3284aa1430afddf937a775bc34576.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/echarts/pie/constants.ts<br>frontend/src/metabase/visualizations/echarts/pie/format.ts<br>frontend/src/metabase/visualizations/echarts/pie/option.ts |

"
2449361362,pull_request,closed,,Generate better release logs for success,"
### Description

Our new patch release workflow is good at getting fixes out quickly and easily, but it makes it hard for our success team to know what's in each patch. This adds a simple workflow that basically just formats a git log and uploads it to the web to make it real clear where each release happened.

see:
 - https://static.metabase.com/release-log/v49.html
 - https://static.metabase.com/release-log/v50.html
",iethree,2024-08-05 19:53:47+00:00,['iethree'],2024-10-08 16:18:33+00:00,2024-08-07 15:00:14+00:00,https://github.com/metabase/metabase/pull/46504,"[('.Building & Releasing', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2449295734,pull_request,closed,,"🤖 backported ""fix: mongo ObjectId should be orderable""",#46501,github-automation-metabase,2024-08-05 19:16:08+00:00,"['snoe', 'github-automation-metabase']",2024-08-05 20:41:52+00:00,2024-08-05 20:41:51+00:00,https://github.com/metabase/metabase/pull/46503,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2449052296,pull_request,closed,,"feat(sdk): connect databases, generate models and x-rays from the CLI","Closes #46412 and #46416 

### Description

To make onboarding for the embedding sdk smoother, we allow the customers to add a database connection and pick a couple of tables from within the CLI, which will create models and x-ray dashboards automatically for them. This data can be used when generating example dashboard components.

### How to verify

- Run `yarn build-embedding-sdk:watch` in a terminal, then `node resources/embedding-sdk/dist/cli.js start` in another terminal
- Go through the steps - try to add a database connection, and pick a couple of tables. See the demo video below.
- You should see a couple of generated models and x-ray dashboards.

### Demo

<div>
    <a href=""https://www.loom.com/share/c8b2b692d4a446838b60c0b7e356192b"">
      <p>August 6 - CLI database, model & x-ray demo (WIP) - Watch Video</p>
    </a>
    <a href=""https://www.loom.com/share/c8b2b692d4a446838b60c0b7e356192b"">
      <img style=""max-width:300px;"" src=""https://cdn.loom.com/sessions/thumbnails/c8b2b692d4a446838b60c0b7e356192b-3e31cc30876cbcd2-full-play.gif"">
    </a>
  </div>",heypoom,2024-08-05 17:11:33+00:00,['heypoom'],2024-08-08 09:32:34+00:00,2024-08-08 09:30:43+00:00,https://github.com/metabase/metabase/pull/46502,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2273744730, 'issue_id': 2449052296, 'author': 'heypoom', 'body': '(fixing conflicts...)', 'created_at': datetime.datetime(2024, 8, 7, 15, 28, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2275376690, 'issue_id': 2449052296, 'author': 'heypoom', 'body': ""@deniskaber thanks, I agree with the API breaking change issue. I think a nice thing to do would be to move the API calls into `metabase-shared`, then the main app, the sdk and the cli could all invoke the same function. That way, if the backend folks update the API, someone on the main app team can update it, and it would propagate to all 3 usages (including the CLI).\r\n\r\n(It would be even better if we have API versioning, let's hope that day comes soon!)"", 'created_at': datetime.datetime(2024, 8, 8, 9, 32, 20, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2024-08-07 15:28:38 UTC): (fixing conflicts...)

heypoom (Issue Creator) on (2024-08-08 09:32:20 UTC): @deniskaber thanks, I agree with the API breaking change issue. I think a nice thing to do would be to move the API calls into `metabase-shared`, then the main app, the sdk and the cli could all invoke the same function. That way, if the backend folks update the API, someone on the main app team can update it, and it would propagate to all 3 usages (including the CLI).

(It would be even better if we have API versioning, let's hope that day comes soon!)

"
2449016773,pull_request,closed,,fix: mongo ObjectId should be orderable,"Fixes #46259

Mongo ObjectId derive :type/TextLike but that can't be an orderable type, so we mark the specific Mongo type as orderable for malli schemas.
",snoe,2024-08-05 16:51:31+00:00,['snoe'],2024-08-05 19:15:17+00:00,2024-08-05 19:15:17+00:00,https://github.com/metabase/metabase/pull/46501,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2448897717,pull_request,closed,,Move the compare to the past aggregation to the bottom of the dropdown and hide it when no temporal breakouts are available,"Closes https://github.com/metabase/metabase/issues/46499 as part of https://github.com/metabase/metabase/issues/46493

### Description

- Make the ""Compare to the past"" dropdown item an action and move it to the bottom
- Simplify the label to just be ""Compare to the past""
- Only show the ""Compare to the past"" button when, there either is a) a temporal breakout already in use, or b) there are temporal columns that _can be added_ as breakouts later (we will auto-select one in a follow up PR).

### How to verify

Describe the steps to verify that the changes are working as expected.

1. New question -> Sample Dataset -> Orders
2. Create an aggregation: Sum of Subtotal
3. Click the ""+"" button in the aggregation section the dropdown should look like the screenshots below

Verify that
- when there are no temporal columns is not on a temporal column, the ""Compare to the past"" button does not show
- when there are no temporal columns, the ""Compare to the past"" button does not show

Notes: 

### Demo
<img width=""245"" alt=""Screenshot 2024-08-05 at 17 48 53"" src=""https://github.com/user-attachments/assets/cf225306-d50f-4657-a343-58c4d91a0a9d"">


",romeovs,2024-08-05 15:49:53+00:00,['romeovs'],2024-08-09 09:24:11+00:00,2024-08-09 09:24:08+00:00,https://github.com/metabase/metabase/pull/46500,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2271818639, 'issue_id': 2448897717, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff b9a7566f2cb7ca8a10f9b5b1a43b4192069bc664...beeb6449f8bd1790867bae56ea21bee734707ef9.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/click-actions/actions/CompareAggregationsAction/CompareAggregationsAction.tsx |', 'created_at': datetime.datetime(2024, 8, 6, 17, 44, 8, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-06 17:44:08 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff b9a7566f2cb7ca8a10f9b5b1a43b4192069bc664...beeb6449f8bd1790867bae56ea21bee734707ef9.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/click-actions/actions/CompareAggregationsAction/CompareAggregationsAction.tsx |

"
2448787913,pull_request,closed,,Manual Backport - #46453 - [Permissions] Fix advanced permissions edits not always saving,"#46453

Manual backport due to CI failure: https://github.com/metabase/metabase/actions/runs/10222612065/job/28356953509",sloansparger,2024-08-05 15:05:15+00:00,['sloansparger'],2024-08-05 15:35:09+00:00,2024-08-05 15:35:08+00:00,https://github.com/metabase/metabase/pull/46498,"[('.Team/AdminWebapp', 'Admin and Webapp team'), ('was-backported', 'apply this to PRs that are themselves backports')]",[],
2448758139,pull_request,closed,,Add storybook docs for embedding e2e tests,"Relates to https://github.com/metabase/metabase/pull/45512

### Description

We want to add docs describing initial setup to run Embedding SDK Storybook, which is used for e2e tests.
This is needed for people who would experience issues with our e2e tests and would like to run our Storybook.

### How to verify

Check if docs make sense
",deniskaber,2024-08-05 14:52:33+00:00,['deniskaber'],2024-10-08 16:18:41+00:00,2024-08-06 12:55:00+00:00,https://github.com/metabase/metabase/pull/46496,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2269270700, 'issue_id': 2448758139, 'author': 'github-actions[bot]', 'body': '@deniskaber You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 5, 14, 52, 54, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-05 14:52:54 UTC): @deniskaber You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2448754300,pull_request,closed,,dx: automate babel deduplication,"### Description

One of the most duplicated packages (which is very easy to add) is `@babel/*`, very recent example is https://github.com/metabase/metabase/pull/46428

<img width=""1613"" alt=""image"" src=""https://github.com/user-attachments/assets/258a82ab-51c7-4a5a-ad42-fabed4274b57"">


### How to verify

- `yarn install` works as before
- ci is green

### Demo



https://github.com/user-attachments/assets/4dec1397-3895-4790-8772-26d3d9404751

",uladzimirdev,2024-08-05 14:51:02+00:00,['uladzimirdev'],2024-10-08 16:18:25+00:00,2024-08-08 06:15:34+00:00,https://github.com/metabase/metabase/pull/46495,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]",[],
2448701283,pull_request,closed,,Follow-up milestone 2 for [Epic] Re-design transparent theme for static embedding and public links,"Relate to Epic #43838

### Description

This PR accomplishes 3 things.
1. Introduce [new base colors](https://www.figma.com/design/OlyKP09vro7EkQ2ZzXDDla/color-playground?node-id=501-2549&t=S7YjATSbqaPbQKuZ-0)
2. Introduce hover colors. ([Github comment](https://github.com/metabase/metabase/pull/46428#discussion_r1702281088)). This makes many components' hover and selected state consistent.
3. Fix [embed frame border color](https://github.com/metabase/metabase/pull/46428#pullrequestreview-2216037341)

### How to verify

1. View all new loki snapshots, and you should see that the hover/selected colors are more consistent.
2. Embed the dashboard/question in another application and the border shouldn't look off.

### Demo

View Loki snapshots

### Checklist

- [x] Tests have been added/updated to cover changes in this PR (loki snapshots)
",WiNloSt,2024-08-05 14:27:29+00:00,['WiNloSt'],2024-10-08 16:18:21+00:00,2024-08-08 11:31:41+00:00,https://github.com/metabase/metabase/pull/46491,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2269252055, 'issue_id': 2448701283, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 5, 14, 44, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2269257390, 'issue_id': 2448701283, 'author': 'WiNloSt', 'body': ""@metabase/admin-webapp I change some hover/selected colors to make all of them in this PR consistent and theme-able. You can see how they changed by looking at loki snapshots in this PR. I've also [requested a design review](https://metaboat.slack.com/archives/C063Q3F1HPF/p1722869146028559) already."", 'created_at': datetime.datetime(2024, 8, 5, 14, 46, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2269262030, 'issue_id': 2448701283, 'author': 'rafpaf', 'body': '@WiNloSt Thank you for the detailed comments throughout the PR - they help a good deal when reviewing', 'created_at': datetime.datetime(2024, 8, 5, 14, 48, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2273019016, 'issue_id': 2448701283, 'author': 'WiNloSt', 'body': '@albertoperdomo I fixed the pivot table cell hover background color on dark theme in https://github.com/metabase/metabase/commit/86ae9009b4e7e7afe24633b790f19d57df34b1f9', 'created_at': datetime.datetime(2024, 8, 7, 9, 22, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2273873970, 'issue_id': 2448701283, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 7, 16, 35, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2273877140, 'issue_id': 2448701283, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 7, 16, 37, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2275096091, 'issue_id': 2448701283, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 8, 7, 3, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2275332696, 'issue_id': 2448701283, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 8, 9, 10, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2275369271, 'issue_id': 2448701283, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 6fb1e51d8f9bdf75f13ead6727b78d8e4778fcbd...5be9f8fc1168a11daca0b5b5a798db7b8e8f1400.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/TableSimple/TableSimple.stories.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.styled.tsx<br>frontend/src/metabase/visualizations/visualizations/SmartScalar/SmartScalar.jsx |\n| @kdoh | frontend/src/metabase/ui/components/buttons/ActionIcon/ActionIcon.styled.tsx<br>frontend/src/metabase/ui/components/inputs/MultiSelect/MultiSelect.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/Select.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/SelectItem/SelectItem.module.css<br>frontend/src/metabase/ui/components/overlays/Menu/Menu.styled.tsx<br>frontend/src/metabase/ui/components/theme/ThemeProvider/ThemeProvider.unit.spec.tsx<br>frontend/src/metabase/ui/components/typography/Text/Text.styled.tsx |', 'created_at': datetime.datetime(2024, 8, 8, 9, 28, 45, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-05 14:44:31 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

WiNloSt (Issue Creator) on (2024-08-05 14:46:55 UTC): @metabase/admin-webapp I change some hover/selected colors to make all of them in this PR consistent and theme-able. You can see how they changed by looking at loki snapshots in this PR. I've also [requested a design review](https://metaboat.slack.com/archives/C063Q3F1HPF/p1722869146028559) already.

rafpaf on (2024-08-05 14:48:57 UTC): @WiNloSt Thank you for the detailed comments throughout the PR - they help a good deal when reviewing

WiNloSt (Issue Creator) on (2024-08-07 09:22:18 UTC): @albertoperdomo I fixed the pivot table cell hover background color on dark theme in https://github.com/metabase/metabase/commit/86ae9009b4e7e7afe24633b790f19d57df34b1f9

github-actions[bot] on (2024-08-07 16:35:21 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-07 16:37:11 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-08 07:03:15 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-08 09:10:54 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-08 09:28:45 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 6fb1e51d8f9bdf75f13ead6727b78d8e4778fcbd...5be9f8fc1168a11daca0b5b5a798db7b8e8f1400.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/TableSimple/TableSimple.stories.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.styled.tsx<br>frontend/src/metabase/visualizations/visualizations/SmartScalar/SmartScalar.jsx |
| @kdoh | frontend/src/metabase/ui/components/buttons/ActionIcon/ActionIcon.styled.tsx<br>frontend/src/metabase/ui/components/inputs/MultiSelect/MultiSelect.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/Select.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/SelectItem/SelectItem.module.css<br>frontend/src/metabase/ui/components/overlays/Menu/Menu.styled.tsx<br>frontend/src/metabase/ui/components/theme/ThemeProvider/ThemeProvider.unit.spec.tsx<br>frontend/src/metabase/ui/components/typography/Text/Text.styled.tsx |

"
2448690760,pull_request,closed,,"🤖 backported ""fix db switching in ts/with-dbs""",#46481,github-automation-metabase,2024-08-05 14:22:42+00:00,"['piranha', 'github-automation-metabase']",2024-08-05 15:10:15+00:00,2024-08-05 15:10:15+00:00,https://github.com/metabase/metabase/pull/46490,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2448650813,pull_request,closed,,Enable type info computation for string id fields,"Closes https://github.com/metabase/metabase/issues/46059

### Description

In `sql.qp/->honeysql [:postgres :value]` it is expected that wrapped values have `:database_type`. Types are added to integer id fields using metadata provider. That's 

Field clauses coming from models are identified by string name. This PR modifies `wrap-value-literals` middleware, so types are added also to values in expression with fields having name instead of id.

### How to verify

Run new test or follow the reproduction steps from the description.

### Checklist

- [X] Tests have been added/updated to cover changes in this PR
",lbrdnk,2024-08-05 14:05:06+00:00,['lbrdnk'],2024-08-14 08:34:32+00:00,2024-08-14 08:34:30+00:00,https://github.com/metabase/metabase/pull/46488,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2448584875,pull_request,closed,,fix(browse/models): Correct the number of recently viewed models shown,"### Description

The number of recently viewed models shown in Browse models depends on the number of models the user has permission to see. However, when counting these models, I mistakenly included the instance analytics models. These are never shown in Browse models, are not relevant to it, and should not be counted in this context.

### How to verify

Reduce the number of models in your instance down to 8 or fewer. (You can convert models temporarily to saved questions.) You should no longer see any recently viewed models. This should be the case even if you have instance analytics models.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",rafpaf,2024-08-05 13:36:52+00:00,['rafpaf'],2024-08-07 21:00:40+00:00,2024-08-06 15:05:11+00:00,https://github.com/metabase/metabase/pull/46487,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2269100123, 'issue_id': 2448584875, 'author': 'rafpaf', 'body': '* **#46487** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46487?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 5, 13, 37, 8, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-08-05 13:37:08 UTC): * **#46487** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46487?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2448568645,pull_request,closed,,"Manual backport - #46322 - ""Reset all filters"" button","#46322

Fully manual backport, there were just too many conflicts.",kamilmielnik,2024-08-05 13:29:24+00:00,['kamilmielnik'],2024-08-05 14:28:15+00:00,2024-08-05 14:28:14+00:00,https://github.com/metabase/metabase/pull/46486,"[('.Team/Querying', ''), ('was-backported', 'apply this to PRs that are themselves backports')]",[],
2448562432,pull_request,closed,,perf: Optimize validation with Malli,"This PR contains various bits and pieces that make value validation with Malli more allocation-efficient (and somewhat faster). E.g., since #46167, this PR further reduces the allocations in the DB add/sync benchmark from 20 GB to ~15 GB.

Malli is updated to the latest version to include this: https://github.com/metosin/malli/pull/1079.

`satisfies?` is bad on hot paths because of https://clojure-goes-fast.com/blog/performance-tidbit-instanceof/, https://clojure.atlassian.net/browse/CLJ-1814.",alexander-yakushev,2024-08-05 13:26:26+00:00,['alexander-yakushev'],2024-10-08 16:18:43+00:00,2024-08-06 07:54:15+00:00,https://github.com/metabase/metabase/pull/46485,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2270612334, 'issue_id': 2448562432, 'author': 'alexander-yakushev', 'body': 'The Malli improvements contribute the most, yes. But `reduce-kv` is also significant in a few places because plain `reduce` over a map creates MapEntries for each key-value pair.', 'created_at': datetime.datetime(2024, 8, 6, 7, 49, 45, tzinfo=datetime.timezone.utc)}]","alexander-yakushev (Issue Creator) on (2024-08-06 07:49:45 UTC): The Malli improvements contribute the most, yes. But `reduce-kv` is also significant in a few places because plain `reduce` over a map creates MapEntries for each key-value pair.

"
2448436460,pull_request,closed,,POC: import specs ,"Redo of https://github.com/metabase/metabase/pull/44889 but with some additional stuff implemented:
- set up different patterns to match tests locally vs on CI
- the e2e test script validator now also makes sure all test files are included in at least one barrel file
- renames the barrel files to `ci.cy.spec.ts`

From the other PR:
This is a POC to split up the e2e tests (again 🤐) to but keep the performance benefits from using large consolidated spec files that have a lot of tests in them.

Writing smaller spec files is more pleasant for devs, but it has a downside: Cypress has to some setup for each spec file it encounters and all of the setup for all the small spec files adds up (consolidating the reproductions into one file, or a small set of files shaved 4m of a 15m CI run).

The (_unproved_) assumption of this POC is that if we write our tests in non-spec files (ie. Cypress doesn't think they are tests), but import all these small files into one large spec, we can have the best of both worlds:
- Cypress only picks up a couple of specs, so has to do less setup, resulting in better test performance
- Devs can write tests in small files instead of huge specs

This PR tests these assumptions by splitting up the question reproductions into a bunch of smaller test files again to see if the performance improvements are maintained.

If this works, in the future we could do more improvements.

1. import _all_ specs into one (or a low number) of large spec file so we completely eliminate any setup done by Cypress
2. Use different greps in CI and local dev for what the specs are so devs can run the small test files locally, but Cypress does not pick up on them in CI.


The question reproductions run [took 12m18s](https://github.com/metabase/metabase/actions/runs/9722494339/job/26836566677?pr=44889) on this PR vs. [12m24s on master](https://github.com/metabase/metabase/actions/runs/9720931022/job/26833122551), so it does not seem to impact performance.",romeovs,2024-08-05 12:29:44+00:00,['romeovs'],2025-02-04 01:31:38+00:00,2025-02-04 01:31:37+00:00,https://github.com/metabase/metabase/pull/46484,"[('.CI & Tests', ''), ('Stale', 'Stale PRs that will be auto-closed'), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', ''), ('.Team/DevEx', '')]","[{'comment_id': 2603450099, 'issue_id': 2448436460, 'author': 'github-actions[bot]', 'body': 'This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.', 'created_at': datetime.datetime(2025, 1, 21, 1, 31, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2632557885, 'issue_id': 2448436460, 'author': 'github-actions[bot]', 'body': 'This pull request was closed because it had no activity for more than 90 days.', 'created_at': datetime.datetime(2025, 2, 4, 1, 31, 37, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-01-21 01:31:30 UTC): This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.

github-actions[bot] on (2025-02-04 01:31:37 UTC): This pull request was closed because it had no activity for more than 90 days.

"
2448330329,pull_request,closed,,e2e: add cypress-terminal-report,"closes https://github.com/metabase/metabase/issues/46494

### Description

add cypress terminal report

### How to verify

check a [failing job](https://github.com/metabase/metabase/actions/runs/10249928816/job/28354813499?pr=46483) and [report](https://github.com/metabase/metabase/actions/runs/10249928816/artifacts/1776624705), which can be found on the [actions page](https://github.com/metabase/metabase/actions/runs/10249928816?pr=46483)

### console output
https://github.com/user-attachments/assets/aca48e51-0898-4bea-913b-517337e93a5b




### Updated mocha report

https://github.com/user-attachments/assets/0373fc79-d8cb-4b19-9c2e-f974d18cb8ae

",uladzimirdev,2024-08-05 11:35:44+00:00,['uladzimirdev'],2024-08-07 14:53:21+00:00,2024-08-07 14:53:20+00:00,https://github.com/metabase/metabase/pull/46483,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]",[],
2448294321,pull_request,closed,,Protect against invalid file uploads,"Closes https://github.com/metabase/metabase-private/issues/227

### Description

This PR adds file type validation to the CSV upload API endpoints.",crisptrutski,2024-08-05 11:17:21+00:00,['crisptrutski'],2024-08-07 10:24:57+00:00,2024-08-07 10:20:09+00:00,https://github.com/metabase/metabase/pull/46482,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2273133747, 'issue_id': 2448294321, 'author': 'crisptrutski', 'body': 'Damn, auto merge fail after rebasing off another branch 🤦', 'created_at': datetime.datetime(2024, 8, 7, 10, 22, 9, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-08-07 10:22:09 UTC): Damn, auto merge fail after rebasing off another branch 🤦

"
2448291626,pull_request,closed,,fix db switching in ts/with-dbs,"mt/with-temp opens transaction which is used by toucan to make requests, so `mt/with-db` had no impact on database used inside of mt/with-temp

Fixes #46032 
",piranha,2024-08-05 11:16:09+00:00,['piranha'],2024-08-05 14:21:55+00:00,2024-08-05 14:21:54+00:00,https://github.com/metabase/metabase/pull/46481,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2269039007, 'issue_id': 2448291626, 'author': 'qnkhuat', 'body': 'should we put this test in ?\r\n\r\n```clojure\r\n(deftest with-dbs-works-as-expected-test\r\n  (ts/with-dbs [source-db dest-db]\r\n    (ts/with-db source-db\r\n      (mt/with-temp\r\n        [:model/Card {card-id :id} {:name ""MY CARD""}]\r\n        (testing ""card is available in the source db""\r\n          (is (some? (t2/select-one :model/Card :name ""MY CARD""))))\r\n        (ts/with-db dest-db\r\n          (testing ""card should not be available in the dest db""\r\n           ;; FAIL, select is returning a Card\r\n           (is (nil? (t2/select-one :model/Card :name ""MY CARD"")))))))))\r\n```', 'created_at': datetime.datetime(2024, 8, 5, 13, 8, 36, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-08-05 13:08:36 UTC): should we put this test in ?

```clojure
(deftest with-dbs-works-as-expected-test
  (ts/with-dbs [source-db dest-db]
    (ts/with-db source-db
      (mt/with-temp
        [:model/Card {card-id :id} {:name ""MY CARD""}]
        (testing ""card is available in the source db""
          (is (some? (t2/select-one :model/Card :name ""MY CARD""))))
        (ts/with-db dest-db
          (testing ""card should not be available in the dest db""
           ;; FAIL, select is returning a Card
           (is (nil? (t2/select-one :model/Card :name ""MY CARD"")))))))))
```

"
2448234733,pull_request,closed,,Remove uncessary db calls when updating card,"Closes https://github.com/metabase/metabase/issues/46477

This reduces the example from making 10 db calls to 2 db calls when updating the name of 3 cards

```clojure
(mt/with-temp [:model/Card {card-1 :id} {}
               :model/Card {card-2 :id} {}
               :model/Card {card-3 :id} {}]
  (t2/with-call-count [call-count]
    (t2/update! :model/Card :id [:in [card-1 card-2 card-3]] {:name ""new name""})
    (call-count)))
;; => 2 (was 10)
```

And the 2 queries are:
```sql
SELECT * FROM ""report_card"" WHERE ""id"" = [1, 2, 3]
UPDATE ""report_card"" SET ""name"" = ""new name"", ""updated_at"" = NOW() WHERE ""id"" in [1, 2, 3]
```",qnkhuat,2024-08-05 10:46:29+00:00,['qnkhuat'],2024-08-05 21:49:42+00:00,2024-08-05 21:49:41+00:00,https://github.com/metabase/metabase/pull/46480,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2448106916,pull_request,closed,,[Manual backport 49] expose MB_DB_QUERY_TIMEOUT_MINUTES setting (#44759),https://github.com/metabase/metabase/pull/44759,lbrdnk,2024-08-05 09:45:00+00:00,['lbrdnk'],2024-08-06 08:46:03+00:00,2024-08-06 08:42:59+00:00,https://github.com/metabase/metabase/pull/46478,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2448064784,pull_request,closed,,[Manual backport 50] expose MB_DB_QUERY_TIMEOUT_MINUTES setting (#44759),https://github.com/metabase/metabase/pull/44759,lbrdnk,2024-08-05 09:26:43+00:00,['lbrdnk'],2024-08-06 08:48:14+00:00,2024-08-06 08:47:47+00:00,https://github.com/metabase/metabase/pull/46476,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2448048422,pull_request,closed,,"🤖 backported """"Reset all filters"" button""","  #46322
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-05 09:19:37+00:00,"['kamilmielnik', 'github-automation-metabase']",2024-08-05 13:30:04+00:00,2024-08-05 12:30:00+00:00,https://github.com/metabase/metabase/pull/46475,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2269084674, 'issue_id': 2448048422, 'author': 'kamilmielnik', 'body': 'Closed in favor of #46486. Too many conflicts.', 'created_at': datetime.datetime(2024, 8, 5, 13, 30, 2, tzinfo=datetime.timezone.utc)}]","kamilmielnik (Assginee) on (2024-08-05 13:30:02 UTC): Closed in favor of #46486. Too many conflicts.

"
2448005611,pull_request,closed,,[notification] Fix test pulse endpoint does not work properly for http channels,"Fix POST /api/pulse/test does not send pulse for HTTP channels.

Nick found this bug when trying to integrate FE with BE in https://metaboat.slack.com/archives/C07318NQ5M2/p1722544629672509

The question is, why didn't our test catch this? and it was because our test helper `pulse.test-util/with-captured-channel-send-messages!` was capturing all call to `channel/send!`, so in a way this is not an e2e tests because the failure happens inside the `channel/send!` implementation for HTTP channel.

We fixed this bug and also add 2 e2e tests for 2 flows:
- send alert to HTTP channel using `pulse/send-pulse!`, this is the function that our quartz scheduler will call to send pulses
- POST /api/pulse/test for HTTP channels",qnkhuat,2024-08-05 09:00:24+00:00,['qnkhuat'],2024-08-21 07:09:26+00:00,2024-08-07 02:39:04+00:00,https://github.com/metabase/metabase/pull/46474,"[('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2271746150, 'issue_id': 2448005611, 'author': 'calherries', 'body': ""This kind of thing makes me question whether it's ever worth it to have keyword values in a map that aren't namespaced. It makes some things more ergonomic but it's frequently a cause of mistakes"", 'created_at': datetime.datetime(2024, 8, 6, 17, 3, 14, tzinfo=datetime.timezone.utc)}]","calherries on (2024-08-06 17:03:14 UTC): This kind of thing makes me question whether it's ever worth it to have keyword values in a map that aren't namespaced. It makes some things more ergonomic but it's frequently a cause of mistakes

"
2447981572,pull_request,closed,,"🤖 backported ""Update ""Clear"" and ""Reset"" buttons""","  #46050

Notable manual conflict resolution:
- `ParameterValueWidget` significantly differs in `release-x.50.x` and in `master` (JS vs TS), so changes were line-cherry-picked
- updated new e2e tests to use filter input components that v50 defaults to
- `TemporalUnitSettings.tsx` does not exist in `release-x.50.x` so related changes have been omitted in this backport",github-automation-metabase,2024-08-05 08:48:50+00:00,"['kamilmielnik', 'github-automation-metabase']",2024-08-05 12:29:08+00:00,2024-08-05 12:29:06+00:00,https://github.com/metabase/metabase/pull/46473,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2447087437,pull_request,closed,,CI for external contribution #44759,https://github.com/metabase/metabase/pull/44759,lbrdnk,2024-08-04 11:15:03+00:00,['lbrdnk'],2024-08-04 15:25:23+00:00,2024-08-04 15:25:23+00:00,https://github.com/metabase/metabase/pull/46470,"[('backport', 'Automatically create PR on current release branch on merge'), ('do not merge', '')]",[],
2445967029,pull_request,closed,,Fix auto release schedule off by one,"00:15 is the _next_ day, so a mon-fri release at 8pm eastern time is actually a tues-sat release UTC. 🤦 
",iethree,2024-08-03 02:38:02+00:00,['iethree'],2024-10-08 16:18:45+00:00,2024-08-05 14:36:35+00:00,https://github.com/metabase/metabase/pull/46469,"[('.Building & Releasing', ''), ('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2268387156, 'issue_id': 2445967029, 'author': 'uladzimirdev', 'body': 'so, we want not to release it on Monday UTC, right?\r\n<img width=""1020"" alt=""image"" src=""https://github.com/user-attachments/assets/4ad54503-d0d8-4a00-b57f-5c768904f9fa"">', 'created_at': datetime.datetime(2024, 8, 5, 7, 40, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2269233307, 'issue_id': 2445967029, 'author': 'iethree', 'body': '> so, we want not to release it on Monday UTC, right?\r\n\r\nyeah we want the first release each week to be 8:15pm Monday Eastern Time, which is actually 00:15 Tuesday UTC.', 'created_at': datetime.datetime(2024, 8, 5, 14, 36, 6, tzinfo=datetime.timezone.utc)}]","uladzimirdev on (2024-08-05 07:40:42 UTC): so, we want not to release it on Monday UTC, right?
<img width=""1020"" alt=""image"" src=""https://github.com/user-attachments/assets/4ad54503-d0d8-4a00-b57f-5c768904f9fa"">

iethree (Issue Creator) on (2024-08-05 14:36:06 UTC): yeah we want the first release each week to be 8:15pm Monday Eastern Time, which is actually 00:15 Tuesday UTC.

"
2445906449,pull_request,closed,,Last Used Param Value doesn't fill in with default value if cleared,"Fixes #46368

The Last used parameter value is cleared when the frontend sends `nil` as the parameter's value. This works except in cases where a user clears a parameter with a default value. In this case, we want to indicate that the parameter is cleared, so we store `nil` in the appdb in such a case.
",adam-james-v,2024-08-03 00:15:08+00:00,['adam-james-v'],2024-08-09 00:44:37+00:00,2024-08-09 00:44:35+00:00,https://github.com/metabase/metabase/pull/46468,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2445849989,pull_request,closed,,"🤖 backported ""fix missing horizontal scroll on pivot tables""","  #46400
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-02 22:45:00+00:00,"['alxnddr', 'github-automation-metabase']",2024-08-03 00:39:31+00:00,2024-08-03 00:39:29+00:00,https://github.com/metabase/metabase/pull/46467,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2266231126, 'issue_id': 2445849989, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff fa5c496949f78f1f3c0e460858b8b3d015a0f6e3...73570e08a60cdb16d65e85b9685c71fa09eb2a1a.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.styled.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/utils.ts |', 'created_at': datetime.datetime(2024, 8, 2, 22, 48, 23, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-02 22:48:23 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff fa5c496949f78f1f3c0e460858b8b3d015a0f6e3...73570e08a60cdb16d65e85b9685c71fa09eb2a1a.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.styled.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/utils.ts |

"
2445828197,pull_request,closed,,truncate total text in pie chart,"Closes https://github.com/metabase/metabase/issues/30996

### Description

Prevents the total text in the center of the pie chart from being cut off by automatically truncating it if it's too long.

### How to verify

1. Create a pie chart
2. Use the settings for the measure series to add a very long prefix/suffix to the center text
3. Confirmed that it truncates instead of overflowing
4. In the notebook editor, create another or modify the same question, but use a custom column with a long name (use `concat` function) for the dimension column.
5. On the chart, hover over slices, confirm their labels in the center are truncated.

### Demo

<img width=""416"" alt=""Screenshot 2024-08-02 at 3 10 38 PM"" src=""https://github.com/user-attachments/assets/599b2439-1203-481f-98c9-9a3ea03c2045"">

<img width=""413"" alt=""Screenshot 2024-08-02 at 3 10 30 PM"" src=""https://github.com/user-attachments/assets/172514a7-9124-4340-896b-3ea978288823"">

<img width=""421"" alt=""Screenshot 2024-08-02 at 3 10 12 PM"" src=""https://github.com/user-attachments/assets/d255bb34-d90f-4178-9ede-802d398d9444"">


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",EmmadUsmani,2024-08-02 22:14:47+00:00,['EmmadUsmani'],2024-09-18 21:18:27+00:00,2024-08-07 16:10:53+00:00,https://github.com/metabase/metabase/pull/46466,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team'), ('loki-update', '')]","[{'comment_id': 2266206033, 'issue_id': 2445828197, 'author': 'EmmadUsmani', 'body': '* **#47208** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47208?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46607** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46607?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46505** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46505?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46466** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46466?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 2, 22, 15, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2266232266, 'issue_id': 2445828197, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff d5601723b40f627c5257181259d7618fdf7e9d03...2de72ac899a2680e1c5a8a7530143aebf5a71bb2.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/echarts/pie/constants.ts<br>frontend/src/metabase/visualizations/echarts/pie/option.ts |', 'created_at': datetime.datetime(2024, 8, 2, 22, 50, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2359422974, 'issue_id': 2445828197, 'author': 'EmmadUsmani', 'body': '* **#47208** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47208?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46607** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46607?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46505** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46505?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46466** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46466?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 9, 18, 21, 18, 26, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-08-02 22:15:02 UTC): * **#47208** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47208?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46607** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46607?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46505** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46505?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46466** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46466?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

github-actions[bot] on (2024-08-02 22:50:17 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff d5601723b40f627c5257181259d7618fdf7e9d03...2de72ac899a2680e1c5a8a7530143aebf5a71bb2.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/echarts/pie/constants.ts<br>frontend/src/metabase/visualizations/echarts/pie/option.ts |

EmmadUsmani (Issue Creator) on (2024-09-18 21:18:26 UTC): * **#47208** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47208?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46607** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46607?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46505** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46505?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46466** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46466?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2445818975,pull_request,closed,,[E2E] Improve + Fix tests that use sandboxing,"Pursuant of #47095

### Description

Improvements based on these internal slack threads: https://metaboat.slack.com/archives/C505ZNNH4/p1722611219985539
https://metaboat.slack.com/archives/C505ZNNH4/p1724187422396359

**Problem**
Permissions for some sandbox e2e tests were misconfigured such that they had full view access resulting in false positives. Many of our sandbox tests were not making any assertions on wether they were sandboxed, but only on the related functionality we wanted to test.

**Solution**
Add 3 layers of assertions on tests that test on sandboxed data where possible:
1. Assert the results are limited (and I added comments with # of results all access would have)
2. Assert on data request having `is_sandboxed` set to `true` in the response
3. Assert on the data in the response following some expected constraints (typically that all values in a column equal the user attribute value we're sandboxing on)

The last two points make use of a new util `assertDatasetReqIsSandboxed` (its api is documented in the code). In some cases the data that comes back is aggregated so we're unable to make the third assertion. In this case we'll just fall back to `is_sandboxed` being set to `true`.

**Note**
After combing through these tests we had a few other sandboxes that were misconfigured. Those have been fixed as well.

### How to verify

- You should be able to replace  `cy.signInAsSandboxedUser` with `cy.signInAsANormalUser` and see failures for almost all sandbox tests. Note: Some test for the absence of behavior which is consistent with unrestricted access or the test is configuring sandboxes.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",sloansparger,2024-08-02 22:02:47+00:00,['sloansparger'],2024-09-22 08:32:44+00:00,2024-09-20 16:16:46+00:00,https://github.com/metabase/metabase/pull/46465,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2307781032, 'issue_id': 2445818975, 'author': 'sloansparger', 'body': 'The original implementation of this PR just focused on asserting the # of results. You provided feedback that we should ""Improve assertions by adding negative assertions to the mix (not just asserting on the number of rows - even though this works; try making sure that some value that a user should not see does not render on a page)"" ([message](https://metaboat.slack.com/archives/C505ZNNH4/p1724187422396359)).\r\n\r\nI agree with this feedback, but like # of rows it has it\'s own faults since we can\'t assert why something was filtered, we just hope it\'s because it\'s sandboxed. Adding the is_sandboxed assertion adds to these guarantees, but ultimately each check is brittle in it\'s own way (e.g. is_sandboxed is true if only 1 of 10 tables in your query is sandboxed, so fingers crossed you configured the right one!).\r\n\r\nAs for asserting on the API response, I fully agree this is an anti-pattern generally, but I think there\'s value in using it here to provide the strongest guarantees we can that our data access and security is working correctly.', 'created_at': datetime.datetime(2024, 8, 23, 20, 40, 38, tzinfo=datetime.timezone.utc)}]","sloansparger (Issue Creator) on (2024-08-23 20:40:38 UTC): The original implementation of this PR just focused on asserting the # of results. You provided feedback that we should ""Improve assertions by adding negative assertions to the mix (not just asserting on the number of rows - even though this works; try making sure that some value that a user should not see does not render on a page)"" ([message](https://metaboat.slack.com/archives/C505ZNNH4/p1724187422396359)).

I agree with this feedback, but like # of rows it has it's own faults since we can't assert why something was filtered, we just hope it's because it's sandboxed. Adding the is_sandboxed assertion adds to these guarantees, but ultimately each check is brittle in it's own way (e.g. is_sandboxed is true if only 1 of 10 tables in your query is sandboxed, so fingers crossed you configured the right one!).

As for asserting on the API response, I fully agree this is an anti-pattern generally, but I think there's value in using it here to provide the strongest guarantees we can that our data access and security is working correctly.

"
2445771282,pull_request,closed,,"🤖 backported ""fix: In delayed error/loading wrapper, on error, display the error""","  #46395
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-02 21:15:23+00:00,"['rafpaf', 'github-automation-metabase']",2024-08-05 17:40:13+00:00,2024-08-05 17:40:11+00:00,https://github.com/metabase/metabase/pull/46463,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2445733772,pull_request,closed,,fix(webapp/browse): Fix bug where verified filter is applied to recents even when no verified models exist,"Screencast showing the bug on master: https://www.loom.com/share/2b1fc3016b684f628e063867d6be7e49?sid=7283d0a3-fd3b-4048-8fb7-33b30c34fbf2 

Screencast showing the bug fixed in this branch: https://www.loom.com/share/fe179670029e40349fba3ff3ebd5fafa?sid=b0580855-dff3-4953-99be-174052d37e31

Closes #46464",rafpaf,2024-08-02 20:39:53+00:00,['rafpaf'],2024-08-07 02:56:37+00:00,2024-08-07 02:56:35+00:00,https://github.com/metabase/metabase/pull/46462,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2266118327, 'issue_id': 2445733772, 'author': 'rafpaf', 'body': '* **#46462** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46462?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 2, 20, 40, 9, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-08-02 20:40:09 UTC): * **#46462** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46462?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2445715663,pull_request,closed,,"🤖 backported ""Remove global css module that was applying red borders""",#40112,github-automation-metabase,2024-08-02 20:24:19+00:00,"['rafpaf', 'github-automation-metabase']",2024-08-02 20:53:29+00:00,2024-08-02 20:53:28+00:00,https://github.com/metabase/metabase/pull/46461,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2445667733,pull_request,closed,,Convert audit v2 column_settings to column names,"Depends on https://github.com/metabase/metabase/pull/46383

This is automatic replacement done by the migration script. Please note that audit v2 viz settings were designed to work with postgres and mysql only.

How to verify:
- Merge `column-settings-legacy` locally
- Run docker, then `yarn test-qa-dbs:up` to spin up postgres
- `MB_DB_TYPE=postgres MB_DB_PORT=5404 MB_DB_HOST=localhost MB_DB_DBNAME=sample MB_DB_USER=metabase MB_DB_PASS=metasample123 yarn dev-ee` to start Metabase with postgres
- Enter the token and active your Metabase EE
- Browse affected questions/models/dashboards

Note
- There were some broken settings that didn't point to any column in the response
- No need to check every changed entity",ranquild,2024-08-02 19:49:29+00:00,['ranquild'],2024-10-08 16:18:39+00:00,2024-08-06 18:51:23+00:00,https://github.com/metabase/metabase/pull/46460,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2445649913,pull_request,closed,,"🤖 backported ""Perf fix for card metadata in QP""","  #46443
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-02 19:37:31+00:00,"['ranquild', 'github-automation-metabase']",2024-08-02 20:27:16+00:00,2024-08-02 20:27:15+00:00,https://github.com/metabase/metabase/pull/46459,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2445638569,pull_request,closed,,fix(browse): Make Browse models table full width,"![image](https://github.com/user-attachments/assets/8d619ef0-9a85-4c3b-a886-5b10d5e41c85)

- [x] Change the browsing models page to full width from previously centered and fixed width
- [x] Change the recent cards from previous fixed width to 4 cards per row up to 8 cards totally. Make them responsive when screen is smaller to 3, 2 and 1 cards accordingly

Postponed for now:
- [ ] Change the models table to 3 evenly-distributed columns with a responsive priority from left to right. When screen is large, show 3 columns. Then hide descriptions, and finally collections. Always show names.",rafpaf,2024-08-02 19:30:07+00:00,['rafpaf'],2024-08-13 18:28:41+00:00,2024-08-13 18:28:21+00:00,https://github.com/metabase/metabase/pull/46458,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2266019464, 'issue_id': 2445638569, 'author': 'rafpaf', 'body': '* **#46458** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46458?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 2, 19, 30, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2286868367, 'issue_id': 2445638569, 'author': 'rafpaf', 'body': 'Postponed for now\n\nDiscussion: https://metaboat.slack.com/archives/C06REDHM6BV/p1723135821554829?thread_ts=1720458369.496439&cid=C06REDHM6BV', 'created_at': datetime.datetime(2024, 8, 13, 18, 28, 41, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-08-02 19:30:37 UTC): * **#46458** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46458?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

rafpaf (Issue Creator) on (2024-08-13 18:28:41 UTC): Postponed for now

Discussion: https://metaboat.slack.com/archives/C06REDHM6BV/p1723135821554829?thread_ts=1720458369.496439&cid=C06REDHM6BV

"
2445569729,pull_request,closed,,fix(webapp/sidenav): Move Browse sidebar section in between Trash and other collections,"### Description

Moves the **Browse** part of the sidenav down, just above Trash.

Brief discussion here: https://metaboat.slack.com/archives/C06REDHM6BV/p1722460903919469?thread_ts=1720458369.496439&cid=C06REDHM6BV

### How to verify

Open the sidenav",rafpaf,2024-08-02 18:46:37+00:00,['rafpaf'],2024-08-13 17:31:58+00:00,2024-08-07 21:22:25+00:00,https://github.com/metabase/metabase/pull/46457,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2265952300, 'issue_id': 2445569729, 'author': 'rafpaf', 'body': '* **#46457** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46457?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 2, 18, 46, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2272114889, 'issue_id': 2445569729, 'author': 'dhuniverse', 'body': 'Approved.', 'created_at': datetime.datetime(2024, 8, 6, 20, 42, 57, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-08-02 18:46:55 UTC): * **#46457** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46457?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

dhuniverse on (2024-08-06 20:42:57 UTC): Approved.

"
2445501433,pull_request,closed,,fix flaking tab reorder e2e test,"https://metaboat.slack.com/archives/C5XHN8GLW/p1722606104726619

### Description

Attempting to fix flakiness in one of the specs in `tabs.cy.spec.js`.

### How to verify

Run stress test workflow

https://github.com/metabase/metabase/actions/runs/10220068695

### Demo

https://github.com/user-attachments/assets/f6b500d8-3e5c-4117-bb0d-c360d5f93786

Tested with 4x CPU slowdown locally

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",EmmadUsmani,2024-08-02 18:01:03+00:00,['EmmadUsmani'],2024-10-08 16:18:52+00:00,2024-08-02 19:09:14+00:00,https://github.com/metabase/metabase/pull/46455,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2265887536, 'issue_id': 2445501433, 'author': 'EmmadUsmani', 'body': '* **#46455** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46455?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 2, 18, 1, 19, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-08-02 18:01:19 UTC): * **#46455** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46455?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2445473925,pull_request,closed,,Fix bad i18n string,"Fixes #46440

couple things come together here.

Bad escaping:
The `{` characters are used for format strings and placeholders like

```clojure
impl=> (translate ""fr"" ""After {0}"" [""Bob""])
""Après Bob""
```

And if you want _literal_ {'s in your translation string, you must escape them like ""'{"" or ""'}"" using an apostrophe. But this isn't the end of our worries.

in `resources/zh-CN.edn`, we actually have _two_ translations for the original string:

```clojure
""User lookup filter. The placeholder '{login}' will be replaced by the user supplied login.""
""用户找过滤器，占位符 '{login'} 将替换为用户提供的登录名。""

,,,

""User lookup filter. The placeholder '{login}' will be replaced by the user supplied login.""
""用户查找筛选器。占位符“{login}”将替换为用户提供的登录名。""
```

And this later has unescaped curlies.

<img width=""1164"" alt=""image"" src=""https://github.com/user-attachments/assets/31ec3be8-ee30-4bc7-8af7-04174c3f51ba"">
(note: I fixed the i18n string here. But with the fix of the source string, we'll have a new key to translate)

> [!NOTE]  
> This string is broken, but in a benign way. ""foo '{bar}'"" is _busted_. successfully quotes the first `{`, and then has the sequence `bar}` before it hits an open escape `'` that is unterminated. It just ignores this. So it breaks in an acceptable way.

The fix for that is at
https://poeditor.com/projects/po_edit?per_page=20&id=200535&id_language=31&filter=&order=&search=User+lookup+filter but will need to wait for the new source translation string in this instance with the corrected escaping.

```clojure
;; simulate what happens at runtime
impl=> (translated-format-string ""zh_CN""
                                 ""User lookup filter. The placeholder '{login}' will be replaced by the user supplied login.""
                                 {})
""用户查找筛选器。占位符“{login}”将替换为用户提供的登录名。""
impl=> (MessageFormat. *1 (locale ""zh_CN""))
Execution error (NumberFormatException) at java.lang.NumberFormatException/forInputString (NumberFormatException.java:67).
For input string: ""login""
;; the problematic zh-CN string
impl=> (MessageFormat. ""用户查找筛选器。占位符“{login}”将替换为用户提供的登录名。"")
Execution error (NumberFormatException) at java.lang.NumberFormatException/forInputString (NumberFormatException.java:67).
For input string: ""login""
;; minimal reproduction
impl=> (MessageFormat. ""“{login}”"")
Execution error (NumberFormatException) at java.lang.NumberFormatException/forInputString (NumberFormatException.java:67).
For input string: ""login""

impl=> (MessageFormat. ""“'{login}'”"") ;; <-- busted in the benign way
#object[java.text.MessageFormat
        ""0x2b37e363""
        ""java.text.MessageFormat@c2f4bbaa""]
impl=> (MessageFormat. ""“'{login'}”"") ;; <-- correctly escapes both { and }
#object[java.text.MessageFormat
        ""0x4f3c8819""
        ""java.text.MessageFormat@c2f4bbaa""]
```
",dpsutton,2024-08-02 17:41:45+00:00,['dpsutton'],2024-08-06 15:49:43+00:00,2024-08-06 15:49:41+00:00,https://github.com/metabase/metabase/pull/46454,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2445467883,pull_request,closed,,[Permissions] Fix advanced permissions edits not always saving,"Closes #46450

### Description

Fixes a bug where when you make subsequent edits to other permissions for an entity after having changed it's ""view data"" permissions to an advanced permission in that same session of edits (i.e. you haven't saved your changes yet) the value does not get persisted to the server. For impersonated tables, this is a bug that has existed for multiple versions of metabase, but the recent permissions refactor made the same bug appear for sandboxed tables.

The failing logic is that we were removing associated associated sandboxing / impersonation data from the permissions graph if there were modifications to that entity's permissions without properly guarding if that edit was for the same column (view data permission in this case). This PR adds those guards and adds test coverage for this bug.

### How to verify

Repro steps are in the issue.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",sloansparger,2024-08-02 17:37:36+00:00,['sloansparger'],2024-08-05 14:37:29+00:00,2024-08-02 22:06:33+00:00,https://github.com/metabase/metabase/pull/46453,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2269233860, 'issue_id': 2445467883, 'author': 'sloansparger', 'body': '@metabase-bot backport release-x.50.x', 'created_at': datetime.datetime(2024, 8, 5, 14, 36, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2269236497, 'issue_id': 2445467883, 'author': 'github-actions[bot]', 'body': '@sloansparger something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10250850297)', 'created_at': datetime.datetime(2024, 8, 5, 14, 37, 27, tzinfo=datetime.timezone.utc)}]","sloansparger (Issue Creator) on (2024-08-05 14:36:20 UTC): @metabase-bot backport release-x.50.x

github-actions[bot] on (2024-08-05 14:37:27 UTC): @sloansparger something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10250850297)

"
2445451192,pull_request,closed,,"🤖 backported ""Avoid sorting by missing aggregation reference""",#46386,github-automation-metabase,2024-08-02 17:24:46+00:00,"['lbrdnk', 'github-automation-metabase']",2024-08-02 18:43:53+00:00,2024-08-02 18:43:52+00:00,https://github.com/metabase/metabase/pull/46452,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2445448062,pull_request,closed,,"🤖 backported ""Properly handle SMTP Settings environment variables""","  #46302

✅ conflicts resolved manually",github-automation-metabase,2024-08-02 17:22:43+00:00,"['iethree', 'github-automation-metabase']",2024-08-02 19:10:41+00:00,2024-08-02 19:10:39+00:00,https://github.com/metabase/metabase/pull/46451,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2445348194,pull_request,closed,,"🤖 backported ""docs - remove reference to Google Analytics""",#46445,github-automation-metabase,2024-08-02 16:24:40+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-02 16:26:18+00:00,2024-08-02 16:26:17+00:00,https://github.com/metabase/metabase/pull/46448,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2445338983,pull_request,closed,,Update SDK version to 0.1.26,Update Readme version references and published npm package version to 0.1.26,github-automation-metabase,2024-08-02 16:20:11+00:00,"['albertoperdomo', 'github-automation-metabase']",2024-10-08 16:18:55+00:00,2024-08-02 16:24:42+00:00,https://github.com/metabase/metabase/pull/46447,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2265738793, 'issue_id': 2445338983, 'author': 'github-actions[bot]', 'body': '@github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 2, 16, 20, 33, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-02 16:20:33 UTC): @github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2445314127,pull_request,closed,,docs - remove reference to Google Analytics,"We no longer use GA for anonymous data collection.

See https://github.com/metabase/metabase/pull/42556",jeff-bruemmer,2024-08-02 16:07:55+00:00,['jeff-bruemmer'],2024-08-02 16:26:46+00:00,2024-08-02 16:23:51+00:00,https://github.com/metabase/metabase/pull/46445,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2445293384,pull_request,closed,,"🤖 backported ""docs - various link fixes""",#46441,github-automation-metabase,2024-08-02 15:58:25+00:00,"['abdhabli', 'github-automation-metabase']",2024-08-02 16:00:03+00:00,2024-08-02 16:00:02+00:00,https://github.com/metabase/metabase/pull/46444,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2445287013,pull_request,closed,,Perf fix for card metadata in QP,"The perf regression was introduced in https://github.com/metabase/metabase/pull/31706 to handle an edge case. This PR batches field requests.

For history - the biggest reason why we fetch fields for columns is that `table-id` is missing in `result-metadata` and that's a very common case. 

Before
```
POST /api/dashboard/save 200 2.4 s (900 DB calls) App DB connections: 0/15 Jetty threads: 5/50 (2 idle, 0 queued) (94 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}
```

Now

```
POST /api/dashboard/save 200 2.2 s (539 DB calls) App DB connections: 0/7 Jetty threads: 5/50 (2 idle, 0 queued) (93 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}
```",ranquild,2024-08-02 15:55:21+00:00,['ranquild'],2024-08-02 20:27:43+00:00,2024-08-02 19:36:44+00:00,https://github.com/metabase/metabase/pull/46443,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2445272140,pull_request,closed,,"🤖 backported ""test: do not allow cypress to raise an error on timeline hover""",#46230,github-automation-metabase,2024-08-02 15:49:22+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-08-02 16:20:00+00:00,2024-08-02 16:20:00+00:00,https://github.com/metabase/metabase/pull/46442,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2445270757,pull_request,closed,,docs - various link fixes,Various link fixes.,jeff-bruemmer,2024-08-02 15:48:40+00:00,['jeff-bruemmer'],2024-08-02 16:00:30+00:00,2024-08-02 15:57:36+00:00,https://github.com/metabase/metabase/pull/46441,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2445237947,pull_request,closed,,"🤖 backported ""[xray] separate limits for max cards in section and max total cards""",#46436,github-automation-metabase,2024-08-02 15:33:37+00:00,"['piranha', 'github-automation-metabase']",2024-08-05 07:19:00+00:00,2024-08-05 07:18:59+00:00,https://github.com/metabase/metabase/pull/46439,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2445230627,pull_request,closed,,Add `relative-time-interval` mbql function 2,"Closes https://github.com/metabase/metabase/issues/45942

The original PR https://github.com/metabase/metabase/pull/46211 was reverted because of following CI failure in master. This PR is verbatim original plus (1) update to the failing tests and (2) resolution of error logs (not harmful but ugly) from `optimize-temporal-filters` ns and (3) fix for linter error. Those are the only differences from original PR (described in the code comments).

---

(1) Problem with tests was as follows. The `filter-by-expression-relative-time-interval-test` was using `[:relative-time-interval [:expression ""customdate"" {:base-type :type/DateTime}] -1 :week -1 :week]]` filter and `checkins:1-per-day` dataset.

The dataset contains rows for _current day and 15 days ago_ (and also 14 future days, that's irrelevant now). I've ignored this fact _writing that test on Monday_.

Test expected that 7 days for the _relative-time-interval -1 week -1 week_ would be returned from query. That would unfortunately hold only _if test is run on Monday or Sunday_.

I've got the PR through the CI on Monday and approvals later, hence the failures.

To fix that I've added `checkins:1-per-day:60` on which it could be shown that _relative-time-interval -1 week -1 week_ offset works properly.

---

(2) While working on the former I've realized there are error logs from the filter optimization middleware which are also addressed. There is a code comment that describes it.

---

(3) With addition of new dataset for testing `[:relative-time-interval <col> -1 :week -1 :week`] new kondo error surfaced.

Specifically, of unused private var `checkins:1-per-day:60`. Closer examination showed, that (a) other private dataset vars are used also in other different places as args to `dataset` and (b) that `hooks.metabase.test.data/dataset` depends on kondo cache generated for `metabase.test.data.dataset-definitions` namespace.

To fix erroneous behavior, I've decided to modifiy hook's logic in a way, that check for locally defined var does not depend on cache anymore.

I've also added generation of cache that's required for hook's correct operation to `./bin/kondo.sh` script. (This alone, would resolve the error, but I believe it is good practice to remove that dependency from the hook's (even if just) one code path).
",lbrdnk,2024-08-02 15:30:54+00:00,['lbrdnk'],2024-08-07 09:36:43+00:00,2024-08-07 09:36:41+00:00,https://github.com/metabase/metabase/pull/46438,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2445176555,pull_request,closed,,Delete database using config file,"== Goal ==

Currently the config file (`MB_CONFIG_FILE_PATH`) only allows adding or
changing databases, but not removing them.  Since connected databases
can be managed as a service by us, it becomes necessary to delete any
information Metabase has about them, including any stored credentials.

Since this is a destructive operation with no way to revert (without
restoring from a backup), we raise the bar for accidental deletion and
require not just a (boolean) flag, but a magic string to be set.

== How to test ==

1. Configure a database as described in https://www.metabase.com/docs/latest/configuring-metabase/config-file#databases.
2. Start your Metabase instance.
3. Verify the database shows up in the ""admin"" section and it works.
   Create a dashboard and questions using the database.
4. Add a `delete: ""DELETE_WITH_DEPENDENTS:${name}""` line to your
   database configuration section.
5. Restart your Metabase instance.
6. Verify the database no longer shows up in the ""admin"" section.
   Notice that questions using it are gone, too.

Closes: https://github.com/metabase/harbormaster/issues/5173
",devurandom,2024-08-02 15:08:18+00:00,['devurandom'],2024-08-07 14:52:51+00:00,2024-08-07 14:52:48+00:00,https://github.com/metabase/metabase/pull/46437,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2445120000,pull_request,closed,,[xray] separate limits for max cards in section and max total cards,Improves situation in #46346 after what #45909 had done.,piranha,2024-08-02 14:44:01+00:00,['piranha'],2024-08-05 07:19:23+00:00,2024-08-02 15:32:44+00:00,https://github.com/metabase/metabase/pull/46436,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2445090808,pull_request,closed,,"🤖 backported ""[Permissions] Update ordering of create query permissions options""",#46391,github-automation-metabase,2024-08-02 14:32:09+00:00,"['sloansparger', 'github-automation-metabase']",2024-08-02 14:58:48+00:00,2024-08-02 14:58:47+00:00,https://github.com/metabase/metabase/pull/46435,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2445027095,pull_request,closed,,Various hardenings for SQL analysis,"### Description

This change should fix some explosions in stats due to phantom fields, while also making things a bit more rigorous.

- Record the table schema in query_field - especially useful for unknown tables
- Allow null table names in query_field - they might be phantoms, or they might not
  - We still have the option to filter them out in tools we build on top
- Tighten up matching logic to consider schema",crisptrutski,2024-08-02 14:00:23+00:00,['crisptrutski'],2024-10-08 16:18:46+00:00,2024-08-05 13:46:29+00:00,https://github.com/metabase/metabase/pull/46432,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]",[],
2444987202,pull_request,closed,,"🤖 backported ""Revert ""Preprocess queries before data perms check""""",#46429,github-automation-metabase,2024-08-02 13:39:22+00:00,"['johnswanson', 'github-automation-metabase']",2024-08-02 17:15:58+00:00,2024-08-02 17:15:57+00:00,https://github.com/metabase/metabase/pull/46431,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2444985176,pull_request,closed,,"🤖 backported ""Add extra geojson content type""",#46427,github-automation-metabase,2024-08-02 13:38:16+00:00,"['noahmoss', 'github-automation-metabase']",2024-08-02 14:27:09+00:00,2024-08-02 14:27:08+00:00,https://github.com/metabase/metabase/pull/46430,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2444901547,pull_request,closed,,"Revert ""Preprocess queries before data perms check""","Reverts metabase/metabase#45601

This was a redundant fix. Theoretically we probably _should_ preprocess before checking permissions as it could lead to other permissions failures if we rely on preprocessing to happen before perms are checked. But the only situation where this happens right now is for sandboxing, and we've fixed that particular issue elsewhere.

https://github.com/metabase/metabase/issues/46346#issuecomment-2261648497",johnswanson,2024-08-02 12:52:12+00:00,['johnswanson'],2024-08-02 17:16:23+00:00,2024-08-02 13:38:24+00:00,https://github.com/metabase/metabase/pull/46429,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2444895882,pull_request,closed,,[Milestone 2] Re-design transparent theme for static embedding and public links,"### Description

This is the milestone 2 of #43838

This milestone style all the following parameter widgets:
- DateSingleWidget
- DateRangeWidget
- DateRelativeWidget
- DateMonthYearWidget
- DateQuarterYearWidget
- DateAllOptionsWidget
- TemporalUnitWidget
- TextWidget
- NumberInputWidget
- ParameterFieldWidget
- StringInputWidget

### How to verify

2 ways:
1. Create a dashboard or a question and add any of the above filters
2. Which is more preferable, run storybook `yarn storybook` and look for the stories under `PublicOrEmbeddedDashboardView/filters`

### Demo
Look at the [loki snapshots](https://github.com/metabase/metabase/pull/46428/files)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",WiNloSt,2024-08-02 12:49:08+00:00,['WiNloSt'],2024-10-08 16:18:47+00:00,2024-08-05 10:20:34+00:00,https://github.com/metabase/metabase/pull/46428,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2265322278, 'issue_id': 2444895882, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 2, 12, 49, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2265325800, 'issue_id': 2444895882, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 2, 12, 50, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2265372733, 'issue_id': 2444895882, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 2, 13, 9, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2265387326, 'issue_id': 2444895882, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 2, 13, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2268616445, 'issue_id': 2444895882, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff a05452ef2e089c55036060a73161630be9a685f1...8d1a8d008e33532f4ccb62f5634b77753d318699.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/buttons/Button/Button.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Checkbox/Checkbox.styled.tsx<br>frontend/src/metabase/ui/components/inputs/MultiSelect/MultiSelect.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/Select.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/SelectItem/SelectItem.module.css<br>frontend/src/metabase/ui/components/overlays/Popover/Popover.styled.tsx |', 'created_at': datetime.datetime(2024, 8, 5, 9, 32, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2268626073, 'issue_id': 2444895882, 'author': 'WiNloSt', 'body': ""> I just tested this and it looks good! Great work @WiNloSt !\r\n> \r\n> Question, probably for @AlessioLaiso :\r\n> \r\n> Is the border around the dashboard supposed to have this blueish color? The line under the header has a different color (dark grey). See screenshot:\r\n> \r\n\r\n@albertoperdomo I couldn't reproduce the blue-ish border using a static dashboard, dark theme + no background with my setup.\r\n![image](https://github.com/user-attachments/assets/149e306a-c8e3-479a-8dbc-70ce2c97edec)\r\n\r\nEdit:\r\nNor the example dashboard has blue-ish border\r\n![Screenshot 2024-08-05 at 4 43 44\u202fPM](https://github.com/user-attachments/assets/68323aa8-fff7-4870-889b-d103575df74b)"", 'created_at': datetime.datetime(2024, 8, 5, 9, 36, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2268993910, 'issue_id': 2444895882, 'author': 'AlessioLaiso', 'body': ""> I just tested this and it looks good! Great work @WiNloSt !\r\n> \r\n> Question, probably for @AlessioLaiso :\r\n> \r\n> Is the border around the dashboard supposed to have this blueish color? The line under the header has a different color (dark grey). See screenshot:\r\n> \r\n> ![image](https://private-user-images.githubusercontent.com/24216/354669790-d2ced4c5-311b-4815-8b78-68efe67fa6db.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjI4NjIyNzIsIm5iZiI6MTcyMjg2MTk3MiwicGF0aCI6Ii8yNDIxNi8zNTQ2Njk3OTAtZDJjZWQ0YzUtMzExYi00ODE1LThiNzgtNjhlZmU2N2ZhNmRiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA4MDUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwODA1VDEyNDYxMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTNkZDQ2ZWJjOTVjNTA4MTQ0YmEwNGFkMjUwMWNhNWZmZTljYTQxZjhjODk2MDI0MjhjN2RmNDIyZDVlMDM0YmQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Y2Gk33EwKt9URy9frYJcaaDExI0qRXwzbLPoA5hFS8Q)\r\n\r\nI'd think that the border should be the same color as the divider below the tabs."", 'created_at': datetime.datetime(2024, 8, 5, 12, 47, 13, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-02 12:49:33 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-02 12:50:30 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-02 13:09:06 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-02 13:17:00 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-05 09:32:25 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff a05452ef2e089c55036060a73161630be9a685f1...8d1a8d008e33532f4ccb62f5634b77753d318699.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/buttons/Button/Button.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Checkbox/Checkbox.styled.tsx<br>frontend/src/metabase/ui/components/inputs/MultiSelect/MultiSelect.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/Select.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/SelectItem/SelectItem.module.css<br>frontend/src/metabase/ui/components/overlays/Popover/Popover.styled.tsx |

WiNloSt (Issue Creator) on (2024-08-05 09:36:23 UTC): @albertoperdomo I couldn't reproduce the blue-ish border using a static dashboard, dark theme + no background with my setup.
![image](https://github.com/user-attachments/assets/149e306a-c8e3-479a-8dbc-70ce2c97edec)

Edit:
Nor the example dashboard has blue-ish border
![Screenshot 2024-08-05 at 4 43 44 PM](https://github.com/user-attachments/assets/68323aa8-fff7-4870-889b-d103575df74b)

AlessioLaiso on (2024-08-05 12:47:13 UTC): I'd think that the border should be the same color as the divider below the tabs.

"
2444891455,pull_request,closed,,Add extra geojson content type,"Resolves https://github.com/metabase/metabase/issues/46307

Seems like this content type is obsolete in favor `application/geo+json`, at least according to the IANA page here: https://www.iana.org/assignments/media-types/application/vnd.geo+json

However I don't see any harm in supporting it.",noahmoss,2024-08-02 12:46:36+00:00,['noahmoss'],2024-08-02 13:37:24+00:00,2024-08-02 13:37:23+00:00,https://github.com/metabase/metabase/pull/46427,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2265312015, 'issue_id': 2444891455, 'author': 'noahmoss', 'body': '* **#46427** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46427?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 2, 12, 46, 50, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-08-02 12:46:50 UTC): * **#46427** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46427?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2444883200,pull_request,closed,,"🤖 backported ""docs - note on locked parameters""",#46392,github-automation-metabase,2024-08-02 12:41:45+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-05 12:22:19+00:00,2024-08-05 12:22:18+00:00,https://github.com/metabase/metabase/pull/46426,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2444709930,pull_request,closed,,"🤖 backported ""Reduce memory usage when sending anon stat""",#46404,metabase-bot[bot],2024-08-02 10:58:11+00:00,['qnkhuat'],2024-08-05 07:27:29+00:00,2024-08-05 07:27:28+00:00,https://github.com/metabase/metabase/pull/46423,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2444617484,pull_request,closed,,Remove experimental base color shades,"Closes #46419

### Description

This PR is created in response to https://github.com/metabase/metabase/pull/45813#pullrequestreview-2199981367

### How to verify

Loki tests pass. I've tested this locally by running.

1. `NODE_ENV=development yarn build-storybook && yarn http-server storybook-static -p 6006` and
2. `yarn test-visual:loki --storiesFilter=^embed`

### Checklist

- [ ] ~Tests have been added/updated to cover changes in this PR (No behavior change)~
",WiNloSt,2024-08-02 10:09:25+00:00,['WiNloSt'],2024-08-02 12:44:06+00:00,2024-08-02 12:44:04+00:00,https://github.com/metabase/metabase/pull/46421,"[('.Team/Embedding', '')]","[{'comment_id': 2265035919, 'issue_id': 2444617484, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 2, 10, 9, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2265037793, 'issue_id': 2444617484, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 9f1cbc3c79f14f157cf60ec9fb029263fe5beceb...41b158b15a934c3398c88867f1523f62411af5ef.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/buttons/Button/Button.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Checkbox/Checkbox.styled.tsx<br>frontend/src/metabase/ui/components/inputs/MultiSelect/MultiSelect.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/Select.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/SelectItem/SelectItem.module.css<br>frontend/src/metabase/ui/components/overlays/Popover/Popover.styled.tsx |', 'created_at': datetime.datetime(2024, 8, 2, 10, 10, 45, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-02 10:09:44 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-02 10:10:45 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 9f1cbc3c79f14f157cf60ec9fb029263fe5beceb...41b158b15a934c3398c88867f1523f62411af5ef.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/buttons/Button/Button.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Checkbox/Checkbox.styled.tsx<br>frontend/src/metabase/ui/components/inputs/MultiSelect/MultiSelect.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/Select.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/SelectItem/SelectItem.module.css<br>frontend/src/metabase/ui/components/overlays/Popover/Popover.styled.tsx |

"
2444593279,pull_request,closed,,Tighten up queue test,"### Description

Hopefully this fixes flakes like [this](https://github.com/metabase/metabase/actions/runs/10211915673/job/28254186670?pr=46410). If not it will at least reduce some test verbiage.

Update: smuggling in some extra logging on the related tasks.",crisptrutski,2024-08-02 10:00:08+00:00,['crisptrutski'],2024-10-08 16:18:57+00:00,2024-08-02 12:58:44+00:00,https://github.com/metabase/metabase/pull/46420,"[('flaky-test-fix', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2444523920,pull_request,closed,,"🤖 backported ""Reduce memory usage when sending anon stat""",#46404,github-automation-metabase,2024-08-02 09:29:48+00:00,"['qnkhuat', 'github-automation-metabase']",2024-08-02 10:22:39+00:00,2024-08-02 10:22:38+00:00,https://github.com/metabase/metabase/pull/46418,"[('.Team/Workflows', 'aka BEC'), ('was-backported', 'apply this to PRs that are themselves backports')]",[],
2444436765,pull_request,closed,,Added another webhook,,NevRA,2024-08-02 08:51:45+00:00,['NevRA'],2024-10-08 16:18:59+00:00,2024-08-02 11:51:03+00:00,https://github.com/metabase/metabase/pull/46414,"[('.CI & Tests', ''), ('no-backport', 'Do not backport this PR to any branch')]",[],
2444427689,pull_request,closed,,Convert `AlertListPopoverContent` to TS,"Converts `AlertListPopoverContent` to TS. This PR doesn't modify any code except `AlertScheduleText`, which just changes the `span` to a Mantine `Text` component

No functionality should have changed, so all tests should pass.",oisincoveney,2024-08-02 08:47:34+00:00,['oisincoveney'],2024-08-08 17:16:24+00:00,2024-08-08 11:22:19+00:00,https://github.com/metabase/metabase/pull/46413,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Embedding', '')]","[{'comment_id': 2276300386, 'issue_id': 2444427689, 'author': 'iethree', 'body': 'FYI: \r\n- https://github.com/metabase/metabase/pull/46394', 'created_at': datetime.datetime(2024, 8, 8, 17, 16, 23, tzinfo=datetime.timezone.utc)}]","iethree on (2024-08-08 17:16:23 UTC): FYI: 
- https://github.com/metabase/metabase/pull/46394

"
2444305925,pull_request,closed,,Fix log formatting for query analyzer,"### Description

This fixes the markup used for two exceptional cases.

We should add tests to hit both of these edge cases, but I'd like to get this out in the meantime to get analysis working in stats again - it currently gets poison pilled by the first non-analyzable card.",crisptrutski,2024-08-02 07:42:40+00:00,['crisptrutski'],2024-10-08 16:19:00+00:00,2024-08-02 09:14:07+00:00,https://github.com/metabase/metabase/pull/46410,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2444300224,pull_request,closed,,update the UI of the downloads toggle to make it look like the others…,"| before                                                                                      | after                                                                                     |
|---------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------|
| ![ image ](https://github.com/user-attachments/assets/a348220d-9011-418b-82c0-14d2a7a98cfb) | ![image](https://github.com/user-attachments/assets/094865cc-4634-4194-b70e-3960e1aa6860) |",npretto,2024-08-02 07:40:00+00:00,['npretto'],2024-10-08 16:18:55+00:00,2024-08-02 14:50:16+00:00,https://github.com/metabase/metabase/pull/46409,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2444279867,pull_request,closed,,"🤖 backported ""[serdes] http api: be more picky about files we unpack from an archive""",#46362,github-automation-metabase,2024-08-02 07:30:18+00:00,"['piranha', 'github-automation-metabase']",2024-08-02 08:21:01+00:00,2024-08-02 08:21:00+00:00,https://github.com/metabase/metabase/pull/46407,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2444000287,pull_request,closed,,Reduce memory usage when sending anon stat,"Fixes https://github.com/metabase/metabase/issues/46403

How test
1. Start MB with a small heapsize (512MB)
2. insert 200k of query Execution
```clojure
;; insert 200k of query Execution
(let [rand-char (fn [] (char (+ (int \A) (rand-int 26))))
        big-error (clojure.string/join (repeatedly 1e5 rand-char))]
    (doseq [_ (range 200)]
      (t2/insert! :model/QueryExecution (for [_ (range 1e3)]
                                          {:hash (byte-array 32),
                                           :result_rows 1,
                                           :started_at :%now,
                                           :executor_id nil,
                                           :native false,
                                           :card_id nil,
                                           :context :ad-hoc,
                                           :running_time 1
                                           :error big-error})))
    (t2/count :model/QueryExecution))

```
3. Try calling summarize-executions
```clojure
(summarize-executions)
```",qnkhuat,2024-08-02 04:23:30+00:00,['qnkhuat'],2024-08-02 10:57:13+00:00,2024-08-02 09:29:02+00:00,https://github.com/metabase/metabase/pull/46404,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2265112533, 'issue_id': 2444000287, 'author': 'qnkhuat', 'body': '@metabase-bot backport release-x.49.x', 'created_at': datetime.datetime(2024, 8, 2, 10, 57, 11, tzinfo=datetime.timezone.utc)}]","qnkhuat (Issue Creator) on (2024-08-02 10:57:11 UTC): @metabase-bot backport release-x.49.x

"
2443873927,pull_request,closed,,"🤖 backported ""fix viz settings not persisted during question edit""",#46308,github-automation-metabase,2024-08-02 02:38:16+00:00,"['EmmadUsmani', 'github-automation-metabase']",2024-08-02 18:40:45+00:00,2024-08-02 18:40:44+00:00,https://github.com/metabase/metabase/pull/46402,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2264402531, 'issue_id': 2443873927, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff bf75bd59d19cca1b159b4b672b0dec22c1326124...52ccda93dccdadba95c0546004f6e5c42c234e6b.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/lib/settings/graph.js<br>frontend/src/metabase/visualizations/shared/settings/cartesian-chart.ts |', 'created_at': datetime.datetime(2024, 8, 2, 2, 39, 42, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-02 02:39:42 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff bf75bd59d19cca1b159b4b672b0dec22c1326124...52ccda93dccdadba95c0546004f6e5c42c234e6b.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/lib/settings/graph.js<br>frontend/src/metabase/visualizations/shared/settings/cartesian-chart.ts |

"
2443772963,pull_request,closed,,Download Row Limit Env Var,"Adds `MB_DOWNLOAD_ROW_LIMIT` to enable changing the row limit on downloads and alert/subscription attachments (not the rendered tables, but the .csv, etc.).

Based on: #44982 (Thanks, @r-kot)

 Implements: #28144 and #45078

The difference in this PR compared to #44982 is that the download limit applies to all downloads, the only exception being when the limit is above `qp.i/absolute-max-results` (1048575, based on Excel's limitation); in such a case, the user supplied limit is only used if the download is csv or json, and `qp.i/absolute-max-results` is used for xlsx.

This PR also fixes alert/subscription attachment limits; prior to this, they were set to the in-app limit of 2000 rows, but now they will follow the user supplied download-row-limit.

This PR also adds a test to the downloads-and-exports test namespace, confirming that they follow the supplied limit, or the max limit if none is supplied.",adam-james-v,2024-08-02 01:12:26+00:00,['adam-james-v'],2024-08-26 17:12:01+00:00,2024-08-12 14:57:53+00:00,https://github.com/metabase/metabase/pull/46401,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2286632743, 'issue_id': 2443772963, 'author': 'adam-james-v', 'body': '@metabase-bot backport release-x.49.x', 'created_at': datetime.datetime(2024, 8, 13, 16, 16, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2286634648, 'issue_id': 2443772963, 'author': 'github-actions[bot]', 'body': '@adam-james-v something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10373403749)', 'created_at': datetime.datetime(2024, 8, 13, 16, 17, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2287081218, 'issue_id': 2443772963, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.50.20](https://github.com/metabase/metabase/milestone/262)', 'created_at': datetime.datetime(2024, 8, 13, 20, 28, 42, tzinfo=datetime.timezone.utc)}]","adam-james-v (Issue Creator) on (2024-08-13 16:16:01 UTC): @metabase-bot backport release-x.49.x

github-actions[bot] on (2024-08-13 16:17:02 UTC): @adam-james-v something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10373403749)

github-actions[bot] on (2024-08-13 20:28:42 UTC): 🚀 This should also be released by [v0.50.20](https://github.com/metabase/metabase/milestone/262)

"
2443741932,pull_request,closed,,fix missing horizontal scroll on pivot tables,"Closes https://github.com/metabase/metabase/issues/24678

### Description

Fixes missing horizontal scroll on pivot tables when the left sidebar is too wide.

### How to verify

1) Create a pivot table with 3-4 rows so that the rows table sidebar is wide enough
<img width=""339"" alt=""Screenshot 2024-08-01 at 9 40 29 PM"" src=""https://github.com/user-attachments/assets/50edb678-bb48-4963-a8f8-8ea1db42ed5d"">

2) Add the pivot table on a dashboard and make the dashcard narrow so that it can only show the left sidebar which is fixed
3) Ensure the table has a horizontal scrollbar

### Demo

[Slack thread with a loom](https://metaboat.slack.com/archives/C064QMXEV9N/p1722559346051959)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",alxnddr,2024-08-02 00:30:20+00:00,['alxnddr'],2024-08-02 22:44:16+00:00,2024-08-02 22:44:14+00:00,https://github.com/metabase/metabase/pull/46400,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team'), ('loki-update', '')]",[],
2443647141,pull_request,closed,,add both option for pie chart percentages,"Closes https://github.com/metabase/metabase/issues/40617

### Description

An additional radio option for the `pie.percent_visibility` has been added that will show percentages on the both the chart and legend simultaneously.

### How to verify

1. Create a pie chart
2. Set ""show percentages"" setting to ""both""
3. Confirm percentages are visible on chart and legend.

### Demo

https://github.com/user-attachments/assets/af25d628-07a6-4031-b8b9-dff93c42bc95

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",EmmadUsmani,2024-08-01 23:10:53+00:00,['EmmadUsmani'],2024-08-05 05:53:12+00:00,2024-08-05 05:53:11+00:00,https://github.com/metabase/metabase/pull/46399,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team'), ('PR-Env', 'See https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458')]","[{'comment_id': 2264179750, 'issue_id': 2443647141, 'author': 'EmmadUsmani', 'body': '* **#46399** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46399?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* **#46397** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46397?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 1, 23, 11, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2264184459, 'issue_id': 2443647141, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 5edfd8ac9724f2d8d14f0be38eb31f29db353b2f...4cd4d4c6197875ccd0883a78d7808c73b268ae3f.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/echarts/pie/option.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/PieChart.tsx<br>frontend/src/metabase/visualizations/visualizations/PieChart/chart-definition.ts |', 'created_at': datetime.datetime(2024, 8, 1, 23, 15, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2266238339, 'issue_id': 2443647141, 'author': 'github-actions[bot]', 'body': '👋 Deploying a preview environment for commit 4cd4d4c6197875ccd0883a78d7808c73b268ae3f.\n✅ Preview:\n    https://pr46399.coredev.metabase.com\n🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)\n<!-- Sticky Pull Request Comment -->', 'created_at': datetime.datetime(2024, 8, 2, 22, 59, 20, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-08-01 23:11:05 UTC): * **#46399** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46399?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* **#46397** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46397?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

github-actions[bot] on (2024-08-01 23:15:17 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 5edfd8ac9724f2d8d14f0be38eb31f29db353b2f...4cd4d4c6197875ccd0883a78d7808c73b268ae3f.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/echarts/pie/option.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/PieChart.tsx<br>frontend/src/metabase/visualizations/visualizations/PieChart/chart-definition.ts |

github-actions[bot] on (2024-08-02 22:59:20 UTC): 👋 Deploying a preview environment for commit 4cd4d4c6197875ccd0883a78d7808c73b268ae3f.
✅ Preview:
    https://pr46399.coredev.metabase.com
🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)
<!-- Sticky Pull Request Comment -->

"
2443560875,pull_request,closed,,add pie.decimal_places setting,"Closes https://github.com/metabase/metabase/issues/12152

### Description

Adds a viz setting for the pie chart to allow setting a fixed number of decimals places when displaying percentages either on the chart or legend. If the setting is not present, we will use the old logic, which is to use 2 significant digits (e.g. number of digits after the leftmost zero) on the chart, and 3 significant digits on the legend.

### How to verify

1. Create a pie chart
2. Enable the show percentages on legend setting
3. Set the value of the number of decimal places setting
4. Confirm the legend matches your setting
5. Change the setting to show percentages on teh chart
6. Confirm the chart matches your setting

### Demo

https://github.com/user-attachments/assets/38968503-16d8-4bdb-95ba-a549ed55a639

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",EmmadUsmani,2024-08-01 22:04:09+00:00,['EmmadUsmani'],2024-09-21 19:17:10+00:00,2024-08-02 22:46:06+00:00,https://github.com/metabase/metabase/pull/46397,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team'), ('loki-update', ''), ('PR-Env', 'See https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458')]","[{'comment_id': 2264090694, 'issue_id': 2443560875, 'author': 'EmmadUsmani', 'body': '* **#46399** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46399?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46397** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46397?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 1, 22, 4, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2264092962, 'issue_id': 2443560875, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 9c8168a20e7b2e280fd8870c811680134713969d...d9da62436980d916a59d3febb6d19d501223b3a8.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/settings/ChartSettingInputNumeric.tsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingInputNumeric.unit.spec.tsx<br>frontend/src/metabase/visualizations/echarts/pie/format.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/chart-definition.ts |', 'created_at': datetime.datetime(2024, 8, 1, 22, 5, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2266188808, 'issue_id': 2443560875, 'author': 'github-actions[bot]', 'body': '👋 Deploying a preview environment for commit d9da62436980d916a59d3febb6d19d501223b3a8.\n✅ Preview:\n    https://pr46397.coredev.metabase.com\n🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)\n<!-- Sticky Pull Request Comment -->', 'created_at': datetime.datetime(2024, 8, 2, 21, 53, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2365293299, 'issue_id': 2443560875, 'author': 'lobindam', 'body': '> * **[add both option for pie chart percentages\xa0#46399](https://github.com/metabase/metabase/pull/46399)** [<img alt=""Graphite"" width=""10px"" height=""10px"" src=""https://camo.githubusercontent.com/365768b8448b91ea2b5fe3f944937f2edadca0c3fcbf75ad736e4f514a26889c/68747470733a2f2f7374617469632e67726170686974652e6465762f67726170686974652d33327833322d626c61636b2e706e67"">](https://app.graphite.dev/github/pr/metabase/metabase/46399?utm_source=stack-comment-icon)\r\n> * **[add pie.decimal_places setting\xa0#46397](https://github.com/metabase/metabase/pull/46397)** [<img alt=""Graphite"" width=""10px"" height=""10px"" src=""https://camo.githubusercontent.com/365768b8448b91ea2b5fe3f944937f2edadca0c3fcbf75ad736e4f514a26889c/68747470733a2f2f7374617469632e67726170686974652e6465762f67726170686974652d33327833322d626c61636b2e706e67"">](https://app.graphite.dev/github/pr/metabase/metabase/46397?utm_source=stack-comment-icon) 👈\r\n> * `master`\r\n> \r\n> This stack of pull requests is managed by Graphite. [Learn more about stacking.](https://stacking.dev/?utm_source=stack-comment)\r\n> \r\n> Join @EmmadUsmani and the rest of your teammates on [<img alt=""Graphite"" width=""11px"" height=""11px"" src=""https://camo.githubusercontent.com/365768b8448b91ea2b5fe3f944937f2edadca0c3fcbf75ad736e4f514a26889c/68747470733a2f2f7374617469632e67726170686974652e6465762f67726170686974652d33327833322d626c61636b2e706e67""> Graphite](https://graphite.dev?utm-source=stack-comment)\r\n\r\nHello, where could I gest this version?', 'created_at': datetime.datetime(2024, 9, 21, 19, 17, 8, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-08-01 22:04:29 UTC): * **#46399** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46399?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46397** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46397?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

github-actions[bot] on (2024-08-01 22:05:40 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 9c8168a20e7b2e280fd8870c811680134713969d...d9da62436980d916a59d3febb6d19d501223b3a8.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/settings/ChartSettingInputNumeric.tsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingInputNumeric.unit.spec.tsx<br>frontend/src/metabase/visualizations/echarts/pie/format.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/chart-definition.ts |

github-actions[bot] on (2024-08-02 21:53:08 UTC): 👋 Deploying a preview environment for commit d9da62436980d916a59d3febb6d19d501223b3a8.
✅ Preview:
    https://pr46397.coredev.metabase.com
🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)
<!-- Sticky Pull Request Comment -->

lobindam on (2024-09-21 19:17:08 UTC): Hello, where could I gest this version?

"
2443440614,pull_request,closed,,"fix: In delayed error/loading wrapper, on error, display the error","### Description

The `DelayedAndLoadingWrapper` had a bug where if both the `loading` and `error` props were truthy, and the `loader` prop was provided, the loader would be shown, not the error.

### How to verify

In `frontend/src/metabase/browse/components/BrowseModels.tsx:131`, change the `error` prop on `DelayedLoadingAndErrorWrapper` to `true`. On master, you won't see an error message, but in this branch you will.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR",rafpaf,2024-08-01 21:05:26+00:00,['rafpaf'],2024-08-05 17:40:36+00:00,2024-08-02 21:14:38+00:00,https://github.com/metabase/metabase/pull/46395,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2263992311, 'issue_id': 2443440614, 'author': 'rafpaf', 'body': '* **#46395** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46395?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 1, 21, 5, 41, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-08-01 21:05:41 UTC): * **#46395** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46395?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2443435025,pull_request,closed,,QuestionAlertWidget to FC + TS,"
prep for https://github.com/metabase/metabase/issues/46191

### Description

![Screen Shot 2024-08-01 at 2 47 45 PM](https://github.com/user-attachments/assets/10444d5b-1209-4472-8894-c1ce32e73696)


The various sharing/alert/embed components are pretty old, and suffer from a severe case of spaghetti. This is a first step toward untangling them.
- Convert QuestionAlertWidget to typescript
- Convert QuestionAlertWidget to be a functional component
- Use RTKQuery hook to fetch data in QuestionAlertWidget
- moves AlertListPopoverContent to a different directory, It will get more TLC in a subsequent PR
No functional changes at all.

⚠️ No Tests ⚠️ I intentionally didn't write new tests for this PR because the behavior of this component is going to change completely in #46191
",iethree,2024-08-01 21:03:31+00:00,['iethree'],2025-02-04 16:05:09+00:00,2024-08-16 21:12:33+00:00,https://github.com/metabase/metabase/pull/46394,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2294321568, 'issue_id': 2443435025, 'author': 'iethree', 'body': 'ended up deleting much of this and including the rest in https://github.com/metabase/metabase/pull/46593', 'created_at': datetime.datetime(2024, 8, 16, 21, 12, 33, tzinfo=datetime.timezone.utc)}]","iethree (Issue Creator) on (2024-08-16 21:12:33 UTC): ended up deleting much of this and including the rest in https://github.com/metabase/metabase/pull/46593

"
2443336061,pull_request,closed,,Speed up permissions migrations (round 2),"Fixes #46497 

* Rewrites permission migrations with the goal of improving performance
* Precomputes the permission paths for each table in a CTE
* Adds `ANALYZE data_permissions` calls before any heavy insertion jobs
  * (I've added a good number of these...they help substantially, but unsure which of these are helpful and which are redundant)",noahmoss,2024-08-01 20:16:26+00:00,['noahmoss'],2024-08-13 15:06:09+00:00,2024-08-13 15:06:07+00:00,https://github.com/metabase/metabase/pull/46393,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2263907217, 'issue_id': 2443336061, 'author': 'noahmoss', 'body': '* **#46393** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46393?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 1, 20, 16, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2274412712, 'issue_id': 2443336061, 'author': 'johnswanson', 'body': ""Looking at this more today, I found that the performance suffers pretty rapidly with large numbers of permissions groups:\r\n\r\n```\r\ntable_count  group_count  resulting_data_permission_count  migration_ms\r\n152560       2            459437                           34368.227958\r\n162560       2            489497                           27559.583167\r\n222560       2            959492                           32182.925167\r\n262560       2            790097                           68536.443166\r\n302560       2            910337                           80100.077625\r\n342560       2            1030577                          86583.370042\r\n442560       2            1331177                          80407.519208\r\n542560       2            1631777                          186439.729541\r\n642560       2            1932377                          228435.363834\r\n742560       2            2232977                          284153.462583\r\n842560       2            2533577                          347160.588417\r\n4021         100          510039                           48658.427416\r\n4021         200          1013039                          95913.10925\r\n4021         300          1516039                          145751.82875\r\n```\r\n\r\nMy migration timed out at 6 minutes with 4021 tables and 400 permissions groups.\r\n\r\nOne important thing to note here: the very high costs here compared to when I was testing on real-world data are, I think, due to the fact that in these tests, *every* permissions group has granular permissions set on *every* database. In the real world, this seems unlikely.\r\n\r\nThe number of interest here is effectively the total number of [group-id, table] pairs such that the permissions group has *granular* permissions on the table's database. If that number is very high, the migration will be slow.\r\n\r\nOne other note: I didn't include the old version in the table above for the simple reason that it began timing out with only 200,000 tables - so we're looking at at least an OOM improvement in speed here."", 'created_at': datetime.datetime(2024, 8, 7, 21, 52, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2274476636, 'issue_id': 2443336061, 'author': 'dpsutton', 'body': '**table-count**|**group-count**|**resulting-data-permission-count**|**migration-ms**\r\n:-----:|:-----:|:-----:|:-----:\r\n152,560|2|459,437|34 s\r\n162,560|2|489,497|27 s\r\n222,560|2|959,492|32 s\r\n262,560|2|790,097|68 s\r\n302,560|2|910,337|80 s\r\n342,560|2|1,030,577|86 s\r\n442,560|2|1,331,177|80 s\r\n542,560|2|1,631,777|186 s (3 min)\r\n642,560|2|1,932,377|228 (3.8 min)\r\n742,560|2|2,232,977|284 (4.7 min)\r\n842,560|2|2,533,577|347 (5.7 min)\r\n4021|100|510,039|48 s\r\n4021|200|1,013,039|95 s\r\n4021|300|1,516,039|145 s (2.4 min)\r\n~931,000|3|~5.3M|18m9s', 'created_at': datetime.datetime(2024, 8, 7, 22, 47, 38, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-08-01 20:16:41 UTC): * **#46393** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46393?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

johnswanson on (2024-08-07 21:52:38 UTC): Looking at this more today, I found that the performance suffers pretty rapidly with large numbers of permissions groups:

```
table_count  group_count  resulting_data_permission_count  migration_ms
152560       2            459437                           34368.227958
162560       2            489497                           27559.583167
222560       2            959492                           32182.925167
262560       2            790097                           68536.443166
302560       2            910337                           80100.077625
342560       2            1030577                          86583.370042
442560       2            1331177                          80407.519208
542560       2            1631777                          186439.729541
642560       2            1932377                          228435.363834
742560       2            2232977                          284153.462583
842560       2            2533577                          347160.588417
4021         100          510039                           48658.427416
4021         200          1013039                          95913.10925
4021         300          1516039                          145751.82875
```

My migration timed out at 6 minutes with 4021 tables and 400 permissions groups.

One important thing to note here: the very high costs here compared to when I was testing on real-world data are, I think, due to the fact that in these tests, *every* permissions group has granular permissions set on *every* database. In the real world, this seems unlikely.

The number of interest here is effectively the total number of [group-id, table] pairs such that the permissions group has *granular* permissions on the table's database. If that number is very high, the migration will be slow.

One other note: I didn't include the old version in the table above for the simple reason that it began timing out with only 200,000 tables - so we're looking at at least an OOM improvement in speed here.

dpsutton on (2024-08-07 22:47:38 UTC): **table-count**|**group-count**|**resulting-data-permission-count**|**migration-ms**
:-----:|:-----:|:-----:|:-----:
152,560|2|459,437|34 s
162,560|2|489,497|27 s
222,560|2|959,492|32 s
262,560|2|790,097|68 s
302,560|2|910,337|80 s
342,560|2|1,030,577|86 s
442,560|2|1,331,177|80 s
542,560|2|1,631,777|186 s (3 min)
642,560|2|1,932,377|228 (3.8 min)
742,560|2|2,232,977|284 (4.7 min)
842,560|2|2,533,577|347 (5.7 min)
4021|100|510,039|48 s
4021|200|1,013,039|95 s
4021|300|1,516,039|145 s (2.4 min)
~931,000|3|~5.3M|18m9s

"
2443334233,pull_request,closed,,docs - note on locked parameters,See https://github.com/metabase/metabase/issues/46375#issuecomment-2263632846,jeff-bruemmer,2024-08-01 20:15:31+00:00,['jeff-bruemmer'],2024-08-05 12:22:50+00:00,2024-08-02 12:40:58+00:00,https://github.com/metabase/metabase/pull/46392,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2443254041,pull_request,closed,,[Permissions] Update ordering of create query permissions options,"### Description

Based on discussion in [this internal slack thread](https://metaboat.slack.com/archives/C01LQQ2UW03/p1721947677425419), we want to move the ""Granular"" permission option for create queries to be the last option for the ""Create Queries"" column for data permissions.

### How to verify

- Go to admin -> permissions
- Select a group (all user's group is fine)
- Click a dropdown in the create queries column for a database
- Test again by drilling down into a db with multiple schemas

### Demo

![CleanShot 2024-08-01 at 14 26 00@2x](https://github.com/user-attachments/assets/b2fd2f6a-369c-4a50-9452-ecb3c4678bb9)
![CleanShot 2024-08-01 at 14 25 18@2x](https://github.com/user-attachments/assets/de1933d6-0f02-4b97-a288-2b6d88dec3c9)


### Checklist

- [x] Tests have been added/updated to cover changes in this PR",sloansparger,2024-08-01 19:34:30+00:00,['sloansparger'],2024-08-02 14:59:12+00:00,2024-08-02 14:31:15+00:00,https://github.com/metabase/metabase/pull/46391,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2265588068, 'issue_id': 2443254041, 'author': 'dhuniverse', 'body': 'Approved.', 'created_at': datetime.datetime(2024, 8, 2, 14, 55, 56, tzinfo=datetime.timezone.utc)}]","dhuniverse on (2024-08-02 14:55:56 UTC): Approved.

"
2443108936,pull_request,closed,,"🤖 backported ""fix db connection form icons""",#46290,github-automation-metabase,2024-08-01 18:23:07+00:00,"['iethree', 'github-automation-metabase']",2024-08-02 18:30:58+00:00,2024-08-02 18:30:57+00:00,https://github.com/metabase/metabase/pull/46390,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2443100290,pull_request,closed,,[Bug Fix] Items can be dragged from the Trash into the Trash ,"Closes #46184

### Description

Fixes being able to drag items into the trash that are already inside the trash. Also adds test coverage for dragging items to/from/within the trash and tests undoing move to/from the trash.

### How to verify

- From the trash, drag an item in the trash to the trash collection in the navigation sidebar (it should not be considered a move)
- From outside the trash, move an item to the trash by dragging it into the trash collection in the sidebar. Test undoing it.
- From in the trash, move an item out of the trash by dragging it into another collection in the sidebar. Test undoing it.

### Demo

https://github.com/user-attachments/assets/7ecfe5c0-f56c-4dd1-ae9b-26fd7f4e9f1d


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",sloansparger,2024-08-01 18:20:07+00:00,['sloansparger'],2024-08-05 16:02:00+00:00,2024-08-05 16:01:58+00:00,https://github.com/metabase/metabase/pull/46389,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2269397228, 'issue_id': 2443100290, 'author': 'johnswanson', 'body': '> LGTM.\r\n> \r\n> The only bit I don\'t have context on is: Why do we prioritize the archived status over the collection_id status?\r\n> \r\n> (I\'m not advocating this, just curious about the reason. What I mean is would it make sense to dissoc archived, and keep collection_id instead?)\r\n\r\nThe case we\'re trying to fix here is that the frontend sometimes sends us `{:collection_id [the-trash-id] :archived true}` due to a bug (or overzealous fanciness, depending on how you look at it) in how we determine the diff that needs ""undoing.""\r\n\r\nI think conceptually it would make sense to prioritize the `collection_id` over `archived` - either one seems fine - but in our particular case, that would just result in an error that ""you can\'t modify the trash collection,"" since the `collection_id` here is the Trash collection ID.', 'created_at': datetime.datetime(2024, 8, 5, 15, 52, 52, tzinfo=datetime.timezone.utc)}]","johnswanson on (2024-08-05 15:52:52 UTC): The case we're trying to fix here is that the frontend sometimes sends us `{:collection_id [the-trash-id] :archived true}` due to a bug (or overzealous fanciness, depending on how you look at it) in how we determine the diff that needs ""undoing.""

I think conceptually it would make sense to prioritize the `collection_id` over `archived` - either one seems fine - but in our particular case, that would just result in an error that ""you can't modify the trash collection,"" since the `collection_id` here is the Trash collection ID.

"
2443094380,pull_request,closed,,"🤖 backported ""Avoid adding temporal-unit to lhs cols""","  #46262
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-01 18:17:23+00:00,"['lbrdnk', 'github-automation-metabase']",2024-08-02 08:46:33+00:00,2024-08-02 08:46:31+00:00,https://github.com/metabase/metabase/pull/46388,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2443067190,pull_request,closed,,[Auto Clean-up] Use EE API Endpoints,"### Description

The BE moved the stale items endpoint from `/api` to `/api/ee`, this PR updates the UI to accommodate this change.

### How to verify

Verify that clean up modal continues to work as it did before

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",sloansparger,2024-08-01 18:03:23+00:00,['sloansparger'],2024-08-23 23:06:36+00:00,2024-08-23 23:06:34+00:00,https://github.com/metabase/metabase/pull/46387,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2307390070, 'issue_id': 2443067190, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 54a27a77e856adaf83a88563762d342c01373eb7...69a226b5efca097697a89747cf0d685590771554.\n\nNo notifications.', 'created_at': datetime.datetime(2024, 8, 23, 16, 9, 45, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-23 16:09:45 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 54a27a77e856adaf83a88563762d342c01373eb7...69a226b5efca097697a89747cf0d685590771554.

No notifications.

"
2443013101,pull_request,closed,,Avoid sorting by missing aggregation reference,"Closes #46369

In `values-from-card-query` aggregation was originally removed from the last stage of a query, but not the order by clause. Queries could then end up referencing removed aggregation in order by. This PR addresses that.",lbrdnk,2024-08-01 17:39:22+00:00,['lbrdnk'],2024-08-02 17:24:01+00:00,2024-08-02 17:24:00+00:00,https://github.com/metabase/metabase/pull/46386,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2442985368,pull_request,closed,,"🤖 backported ""Permissions modal dismiss patch""",#46381,github-automation-metabase,2024-08-01 17:23:49+00:00,"['npfitz', 'github-automation-metabase']",2024-08-01 17:50:36+00:00,2024-08-01 17:50:35+00:00,https://github.com/metabase/metabase/pull/46385,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2442980950,pull_request,closed,,fix pie slice border missing in backend static viz,"### Description

In https://github.com/metabase/metabase/pull/43555/commits/1fab1f8d18e1d227cb865db97abe07349455661b, we accidentally removed the pie slice border from the subscription output, since the backend could not read the css variable we were using.

This PR fixes that by not using the css var for static viz, and instead using the default white color. This is fine because we don't have customizable subscriptions (e.g. background will always be white).

### How to verify

1. Create a pie chart
2. Add to a dashboard
3. Send a subscription
4. Confirm it has the white border around slices

### Demo


![Screenshot 2024-08-01 at 10.06.45 AM.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/9ULpbAzGBtvQRyZEpGvu/f485030a-1508-4566-b249-86390d79caa2.png)

Static viz is fixed

![Screenshot 2024-08-01 at 10.07.21 AM.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/9ULpbAzGBtvQRyZEpGvu/72d2b811-b201-4c16-82fe-edf584066967.png)

Storybook is still correct

![Screenshot 2024-08-01 at 10.06.57 AM.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/9ULpbAzGBtvQRyZEpGvu/59ed95f5-d6e2-489f-8a26-dc8619589d26.png)

In-app viz is still correct

![Screenshot 2024-08-01 at 10.27.45 AM.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/9ULpbAzGBtvQRyZEpGvu/36830138-5d5b-48c2-8b05-9e3c1dad52f5.png)

Night mode is still correct

![Screenshot 2024-08-01 at 10.06.54 AM.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/9ULpbAzGBtvQRyZEpGvu/b771759a-d247-4580-b906-a0022bcd79fe.png)

Embedded storybook example is still correct

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR

_Hard to test since the bug didn't occur in storybook, only after rendering the png with batik._",EmmadUsmani,2024-08-01 17:21:24+00:00,['EmmadUsmani'],2024-10-08 16:19:01+00:00,2024-08-01 18:38:10+00:00,https://github.com/metabase/metabase/pull/46384,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2263577320, 'issue_id': 2442980950, 'author': 'EmmadUsmani', 'body': '* **#46384** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46384?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 1, 17, 21, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2263589259, 'issue_id': 2442980950, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 5b4fe7cd3f2e4f66b6921a1904c0c8062c4c8107...160918f9893dbe57f056acfa723119c605dce188.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/hooks/use-browser-rendering-context.ts<br>frontend/src/metabase/visualizations/shared/components/RowChart/RowChart.stories.tsx<br>frontend/src/metabase/visualizations/shared/utils/theme.ts<br>frontend/src/metabase/visualizations/visualizations/RowChart/RowChart.tsx<br>frontend/src/metabase/visualizations/visualizations/RowChart/utils/theme.ts |', 'created_at': datetime.datetime(2024, 8, 1, 17, 27, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2263646544, 'issue_id': 2442980950, 'author': 'EmmadUsmani', 'body': ""@alxnddr Visual specs unfortunately wouldn't catch the bug since it only happens in the png output by batik"", 'created_at': datetime.datetime(2024, 8, 1, 17, 58, 15, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-08-01 17:21:40 UTC): * **#46384** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46384?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

github-actions[bot] on (2024-08-01 17:27:53 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 5b4fe7cd3f2e4f66b6921a1904c0c8062c4c8107...160918f9893dbe57f056acfa723119c605dce188.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/hooks/use-browser-rendering-context.ts<br>frontend/src/metabase/visualizations/shared/components/RowChart/RowChart.stories.tsx<br>frontend/src/metabase/visualizations/shared/utils/theme.ts<br>frontend/src/metabase/visualizations/visualizations/RowChart/RowChart.tsx<br>frontend/src/metabase/visualizations/visualizations/RowChart/utils/theme.ts |

EmmadUsmani (Issue Creator) on (2024-08-01 17:58:15 UTC): @alxnddr Visual specs unfortunately wouldn't catch the bug since it only happens in the png output by batik

"
2442963632,pull_request,closed,,Support both name & field ref-based column keys in viz settings on read and upgrade on write,"I realized that we cannot fully migrate `column_settings` because 10-20% of all cards that we know about don't have `result_metadata` and also don't have `table.columns` (that can be used to substitute `result_metadata` in some cases). So we would have to do it the hard way - by supporting both legacy and modern keys on read, and upgrading legacy keys on write.

How to verify:
- On `master` -> New -> Question -> Orders -> Visualize
- Use viz settings to change column titles for multiple columns -> Save
- Export this question and make sure that columns have correct titles in exported files 
- Checkout this branch and open the question
- All column titles should not be lost
- Export should work as before
- Change some column title and save. Check the network tab and see that column keys were rewritten.
- Column titles for unchanged columns should not be lost.
- Export should work as before for this question after saving.",ranquild,2024-08-01 17:11:49+00:00,['ranquild'],2024-10-02 15:26:38+00:00,2024-08-06 17:29:34+00:00,https://github.com/metabase/metabase/pull/46383,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2263561901, 'issue_id': 2442963632, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff acea9a2979a499a9c013c7bac2efa6fdf0a431cf...baea7e4e59671d02dcc4c6cbfb13d6d9b78b16ea.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/click-actions/actions/ColumnFormattingAction/ColumnFormattingAction.tsx<br>frontend/src/metabase/visualizations/components/ChartSettings.jsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingFieldPicker.jsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingFieldsPartition.jsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingNestedSettings.jsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingTableColumns/TableColumnPanel/utils.ts<br>frontend/src/metabase/visualizations/components/settings/ChartSettingsListColumns/ChartSettingsListColumns.tsx<br>frontend/src/metabase/visualizations/echarts/cartesian/model/util.ts<br>frontend/src/metabase/visualizations/lib/settings/column.js<br>frontend/src/metabase/visualizations/lib/settings/nested.js<br>frontend/src/metabase/visualizations/lib/settings/nested.unit.spec.js<br>frontend/src/metabase/visualizations/lib/settings/series.js<br>frontend/src/metabase/visualizations/lib/utils.js<br>frontend/src/metabase/visualizations/shared/settings/column.ts<br>frontend/src/metabase/visualizations/visualizations/Table.unit.spec.js |', 'created_at': datetime.datetime(2024, 8, 1, 17, 13, 9, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-01 17:13:09 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff acea9a2979a499a9c013c7bac2efa6fdf0a431cf...baea7e4e59671d02dcc4c6cbfb13d6d9b78b16ea.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/click-actions/actions/ColumnFormattingAction/ColumnFormattingAction.tsx<br>frontend/src/metabase/visualizations/components/ChartSettings.jsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingFieldPicker.jsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingFieldsPartition.jsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingNestedSettings.jsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingTableColumns/TableColumnPanel/utils.ts<br>frontend/src/metabase/visualizations/components/settings/ChartSettingsListColumns/ChartSettingsListColumns.tsx<br>frontend/src/metabase/visualizations/echarts/cartesian/model/util.ts<br>frontend/src/metabase/visualizations/lib/settings/column.js<br>frontend/src/metabase/visualizations/lib/settings/nested.js<br>frontend/src/metabase/visualizations/lib/settings/nested.unit.spec.js<br>frontend/src/metabase/visualizations/lib/settings/series.js<br>frontend/src/metabase/visualizations/lib/utils.js<br>frontend/src/metabase/visualizations/shared/settings/column.ts<br>frontend/src/metabase/visualizations/visualizations/Table.unit.spec.js |

"
2442890340,pull_request,closed,,Milestone 2 polishing,"Closes https://github.com/metabase/metabase/issues/46378

### Description

1. Align Metabase banner
2. Add a test for Don't rerender preview when changing dashboard with tabs' look and feel options. Apparently, the upstream already fix that, so I only add a test.

### How to verify

All test passes. E2E and loki.

### Demo
Look at the loki snapshots.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",WiNloSt,2024-08-01 16:33:21+00:00,['WiNloSt'],2024-08-02 09:55:56+00:00,2024-08-02 09:55:54+00:00,https://github.com/metabase/metabase/pull/46382,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2263487702, 'issue_id': 2442890340, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 1, 16, 33, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2263490110, 'issue_id': 2442890340, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff e04e3dfcc16f047275e5dd427dac0f38043838ca...18d31accd8fc7d24e04f26fb4e99ec805dcf3d73.\n\nNo notifications.', 'created_at': datetime.datetime(2024, 8, 1, 16, 34, 46, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-01 16:33:40 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-01 16:34:46 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff e04e3dfcc16f047275e5dd427dac0f38043838ca...18d31accd8fc7d24e04f26fb4e99ec805dcf3d73.

No notifications.

"
2442850663,pull_request,closed,,Permissions modal dismiss patch,"Closes https://github.com/metabase/metabase/issues/46380

### Description
Previously, the modal was shown purely based on the settings in the redux store. This meant that if the request to update the value (and then refresh the settings) failed, the value would never change and the modal would not technically be dismissable

This changes moves that value that determines if we're showing the modal or not to component level state. This means that the modal can be dismissed regardless of whether or not the network request succeeds. It's worth noting that if the request does fail, the modal will appear again if you navigate away and then back to the permissions page.

### How to verify
1. Have an instance that was set up before version 50, and migrated up to 50
2. Go to the permissions page. A modal should appear explaining how permissions have changed
3. Find a way to make requests to `/api/setting/show-updated-permission-modal` to error
4. Dismiss the modal. You should see an error in your network tab, but the modal should still dismiss.

### Demo
![chrome_XJNQVgWbX7](https://github.com/user-attachments/assets/d7cc7ec7-feb1-416e-8129-48c76ccb7e92)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",npfitz,2024-08-01 16:12:11+00:00,['npfitz'],2024-08-01 17:23:04+00:00,2024-08-01 17:23:02+00:00,https://github.com/metabase/metabase/pull/46381,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2442603670,pull_request,closed,,Split `AlertModals` into multiple files,"I'm splitting `AlertModals` into multiple files so we can convert them to Mantine and typescript in the future (generally for adding to the SDK, ideally).

I didn't touch anything beyond adding some types to some of the functions. It shouldn't affect any functionality, so all tests should still pass.",oisincoveney,2024-08-01 14:18:18+00:00,['oisincoveney'],2024-08-08 14:38:14+00:00,2024-08-08 12:00:21+00:00,https://github.com/metabase/metabase/pull/46376,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Embedding', '')]",[],
2442491564,pull_request,closed,,"🤖 backported ""Add v0.49.22 to the list of releases""",#46355,github-automation-metabase,2024-08-01 13:36:17+00:00,"['alexyarosh', 'github-automation-metabase']",2024-08-06 18:11:31+00:00,2024-08-06 18:11:29+00:00,https://github.com/metabase/metabase/pull/46374,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2442491347,pull_request,closed,,docs - api docs update,Updates API docs for master branch.,jeff-bruemmer,2024-08-01 13:36:12+00:00,['jeff-bruemmer'],2024-10-08 16:16:40+00:00,2024-08-22 23:07:33+00:00,https://github.com/metabase/metabase/pull/46373,"[('Type:Documentation', ''), ('no-backport', 'Do not backport this PR to any branch')]",[],
2442451131,pull_request,closed,,"Revert ""Add `:relative-time-interval` mbql function (#46211)""","Master is failing, hence the temporary revert.",lbrdnk,2024-08-01 13:22:53+00:00,['lbrdnk'],2024-10-08 16:19:05+00:00,2024-08-01 14:11:15+00:00,https://github.com/metabase/metabase/pull/46370,"[('no-backport', 'Do not backport this PR to any branch')]",[],
2442220818,pull_request,closed,,e2e: Remove flaky tag from timeseries question with a goal test in alert-types spec,"### Stress-test on `master`
50/50 ✅ https://github.com/metabase/metabase/actions/runs/10196749153",nemanjaglumac,2024-08-01 11:34:19+00:00,['nemanjaglumac'],2024-10-08 16:19:00+00:00,2024-08-02 07:07:57+00:00,https://github.com/metabase/metabase/pull/46367,"[('.CI & Tests', ''), ('backport', 'Automatically create PR on current release branch on merge'), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2442212011,pull_request,closed,,replace webpack with Rspack for the main app,"Closes https://github.com/metabase/metabase/issues/47025

### Description

[Rspack](https://rspack.dev/) is faster than webpack, it's written in Rust as other modern tools like [swc](https://swc.rs/).  

Why Rspack.

- it's 3 times faster than webpack on our app
- it supports same plugins as webpack or provides replacements
- it support the same config, so we mostly copy old webpack config
- it's [v1.0](https://rspack.dev/blog/announcing-1-0), kinda marked as production ready

### How to verify

Before approval please run it locally, try to do the same task you do every day and report feedback if any


### Demo

Rspack

<img width=""1119"" alt=""image"" src=""https://github.com/user-attachments/assets/af49e692-09d3-4720-8251-36141dfb8aa1"">

Webpack

<img width=""1120"" alt=""image"" src=""https://github.com/user-attachments/assets/f41f75fd-17de-481b-b04c-812a2f834e42"">



<details><summary>Detailed demo</summary>
<p>

### Before


https://github.com/user-attachments/assets/e0b3df7c-b340-421a-9c9b-5e1ed61ed537


### After


https://github.com/user-attachments/assets/035bba10-c41b-421e-978c-d8c398c60602


### cljs live reload


https://github.com/user-attachments/assets/120f2375-65d7-42bd-a86a-f66464af9981



</p>
</details> 


### Checklist

- [x] refresh (hot) mode works
- [x] prod build works
- [x] ci is green
",uladzimirdev,2024-08-01 11:29:38+00:00,['uladzimirdev'],2024-08-28 09:22:30+00:00,2024-08-28 09:22:28+00:00,https://github.com/metabase/metabase/pull/46366,"[('visual', 'Run Percy visual testing'), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', ''), ('PR-Env', 'See https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458')]","[{'comment_id': 2302892180, 'issue_id': 2442212011, 'author': 'iethree', 'body': 'works for me in local dev!', 'created_at': datetime.datetime(2024, 8, 21, 19, 47, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2303910844, 'issue_id': 2442212011, 'author': 'romeovs', 'body': 'Works for me too locally!', 'created_at': datetime.datetime(2024, 8, 22, 6, 48, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2307718940, 'issue_id': 2442212011, 'author': 'rafpaf', 'body': 'This is exciting! I checked out this branch and I\'m seeing a configuration error mentioned in the logs. Is it related?\n\n```\n[js] husky - Git hooks installed\n[js] Configuration error:\n[js] - Expected boolean, received object at ""cache""\n[js] <i> [webpack-dev-server] Project is running at:\n[js] <i> [webpack-dev-server] Loopback: http://localhost:8080/\n[js] <i> [webpack-dev-server] On Your Network (IPv4): http://192.168.0.251:8080/\n[js] <i> [webpack-dev-server] On Your Network (IPv6): http://[fe80::1]:8080/\n[js] <i> [webpack-dev-server] Content not from webpack is served from \'/Users/raf/metabase/public\' directory\n[js] Rspack compiled successfully\n```', 'created_at': datetime.datetime(2024, 8, 23, 19, 50, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2309681706, 'issue_id': 2442212011, 'author': 'uladzimirdev', 'body': '@rafpaf thanks for the feedback!\r\n\r\n> Rspack currently only supports memory cache, persistent cache is under planning, for more details refer to [Persistent Cache Support](https://rspack.dev/misc/planning/roadmap#persistent-cache-support).\r\n\r\nI dropped object configuration, so you can stop using `FS_CACHE` env variable', 'created_at': datetime.datetime(2024, 8, 26, 8, 46, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2314595215, 'issue_id': 2442212011, 'author': 'github-actions[bot]', 'body': '👋 Deploying a preview environment for commit 1c6823a0858ac89a7e8b903a7f6040699529b211.\n✅ Preview:\n    https://pr46366.coredev.metabase.com\n🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)\n<!-- Sticky Pull Request Comment -->', 'created_at': datetime.datetime(2024, 8, 28, 7, 56, 37, tzinfo=datetime.timezone.utc)}]","iethree on (2024-08-21 19:47:46 UTC): works for me in local dev!

romeovs on (2024-08-22 06:48:56 UTC): Works for me too locally!

rafpaf on (2024-08-23 19:50:03 UTC): This is exciting! I checked out this branch and I'm seeing a configuration error mentioned in the logs. Is it related?

```
[js] husky - Git hooks installed
[js] Configuration error:
[js] - Expected boolean, received object at ""cache""
[js] <i> [webpack-dev-server] Project is running at:
[js] <i> [webpack-dev-server] Loopback: http://localhost:8080/
[js] <i> [webpack-dev-server] On Your Network (IPv4): http://192.168.0.251:8080/
[js] <i> [webpack-dev-server] On Your Network (IPv6): http://[fe80::1]:8080/
[js] <i> [webpack-dev-server] Content not from webpack is served from '/Users/raf/metabase/public' directory
[js] Rspack compiled successfully
```

uladzimirdev (Issue Creator) on (2024-08-26 08:46:40 UTC): @rafpaf thanks for the feedback!


I dropped object configuration, so you can stop using `FS_CACHE` env variable

github-actions[bot] on (2024-08-28 07:56:37 UTC): 👋 Deploying a preview environment for commit 1c6823a0858ac89a7e8b903a7f6040699529b211.
✅ Preview:
    https://pr46366.coredev.metabase.com
🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)
<!-- Sticky Pull Request Comment -->

"
2442152603,pull_request,closed,,Complete theming filter popover night mode,"Closes https://github.com/metabase/metabase/issues/45723

### Description

Theme Unit of time filter. And add tests for number filter.

### How to verify

Add a Unit of Time filter, and link it to a date field.

For overall milestone 2 testing, there are 2 ways to test this.
1. run `yarn storybook` and search for
    - `PublicOrEmbeddedQuestionView` or
    - `PublicOrEmbeddedDashboardView`
    
    and play with those stories
2. Run Metabase and try out static embed preview with different filters.

### Demo

#### After
![image](https://github.com/user-attachments/assets/9db864a6-97be-4bff-9170-0f2a6c6026c2)

#### Before
![image](https://github.com/user-attachments/assets/fa9394a5-2ff0-4c3d-81d2-590b351b18e8)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR (Loki snapshots)
",WiNloSt,2024-08-01 10:59:34+00:00,['WiNloSt'],2024-08-01 16:26:25+00:00,2024-08-01 16:26:23+00:00,https://github.com/metabase/metabase/pull/46365,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2262754699, 'issue_id': 2442152603, 'author': 'github-actions[bot]', 'body': '@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 1, 10, 59, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2262756465, 'issue_id': 2442152603, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff e4de093a27da0dc66f4250e389883785435f14e9...ad582ee5f168dd064690a177312aea9cd51ee266.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/inputs/Checkbox/Checkbox.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/SelectItem/SelectItem.module.css |', 'created_at': datetime.datetime(2024, 8, 1, 11, 0, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2262906749, 'issue_id': 2442152603, 'author': 'AlessioLaiso', 'body': 'I see some inconsistencies that would be worth solving.\r\n\r\nIf we start from the assumption that this screenshot below includes the desired states for selected and hovered elements...\r\n<img width=""347"" alt=""Screenshot 2024-08-01 at 13 19 32"" src=""https://github.com/user-attachments/assets/178b4374-be1f-489b-9fda-bf3f2e110184"">\r\n\r\n...would it be worth aligning the ones below?\r\n<img width=""225"" alt=""Screenshot 2024-08-01 at 13 21 03"" src=""https://github.com/user-attachments/assets/390c929b-474c-4c35-a11a-c37e6d906236"">\r\n<img width=""322"" alt=""Screenshot 2024-08-01 at 13 21 20"" src=""https://github.com/user-attachments/assets/adf5d000-1b7d-4e65-a8f2-e37a3f80cf0d"">\r\n<img width=""408"" alt=""Screenshot 2024-08-01 at 13 21 45"" src=""https://github.com/user-attachments/assets/545a3c09-a8f7-42c7-bcce-b7158e48be0f"">\r\n<img width=""293"" alt=""Screenshot 2024-08-01 at 13 21 59"" src=""https://github.com/user-attachments/assets/b64c1000-4498-4872-99b2-f4c32c572e67"">', 'created_at': datetime.datetime(2024, 8, 1, 12, 22, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2262921720, 'issue_id': 2442152603, 'author': 'albertoperdomo', 'body': 'I found what looks like issues in some of the filters, although unrelated to unit of time. Tested using the examples dashboard w/ an additional unit of time filter.\r\n\r\nCheckboxes in white look odd\r\n<img width=""334"" alt=""image"" src=""https://github.com/user-attachments/assets/e4be3906-345d-4f8f-984c-94b1c1530513"">\r\n\r\nDropdown with values looks odd\r\n<img width=""348"" alt=""image"" src=""https://github.com/user-attachments/assets/a1fa4c68-c686-42f4-802c-efeb668769e9"">\r\n\r\nAdditionally, the no results illustration looks off on dark theme. Do we need an alternative image for this, @AlessioLaiso ?\r\n\r\n<img width=""184"" alt=""image"" src=""https://github.com/user-attachments/assets/66d2d958-de26-455e-ad18-a75f21ea67dc"">', 'created_at': datetime.datetime(2024, 8, 1, 12, 30, 38, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-01 10:59:54 UTC): @WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-01 11:00:52 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff e4de093a27da0dc66f4250e389883785435f14e9...ad582ee5f168dd064690a177312aea9cd51ee266.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/inputs/Checkbox/Checkbox.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/SelectItem/SelectItem.module.css |

AlessioLaiso on (2024-08-01 12:22:51 UTC): I see some inconsistencies that would be worth solving.

If we start from the assumption that this screenshot below includes the desired states for selected and hovered elements...
<img width=""347"" alt=""Screenshot 2024-08-01 at 13 19 32"" src=""https://github.com/user-attachments/assets/178b4374-be1f-489b-9fda-bf3f2e110184"">

...would it be worth aligning the ones below?
<img width=""225"" alt=""Screenshot 2024-08-01 at 13 21 03"" src=""https://github.com/user-attachments/assets/390c929b-474c-4c35-a11a-c37e6d906236"">
<img width=""322"" alt=""Screenshot 2024-08-01 at 13 21 20"" src=""https://github.com/user-attachments/assets/adf5d000-1b7d-4e65-a8f2-e37a3f80cf0d"">
<img width=""408"" alt=""Screenshot 2024-08-01 at 13 21 45"" src=""https://github.com/user-attachments/assets/545a3c09-a8f7-42c7-bcce-b7158e48be0f"">
<img width=""293"" alt=""Screenshot 2024-08-01 at 13 21 59"" src=""https://github.com/user-attachments/assets/b64c1000-4498-4872-99b2-f4c32c572e67"">

albertoperdomo on (2024-08-01 12:30:38 UTC): I found what looks like issues in some of the filters, although unrelated to unit of time. Tested using the examples dashboard w/ an additional unit of time filter.

Checkboxes in white look odd
<img width=""334"" alt=""image"" src=""https://github.com/user-attachments/assets/e4be3906-345d-4f8f-984c-94b1c1530513"">

Dropdown with values looks odd
<img width=""348"" alt=""image"" src=""https://github.com/user-attachments/assets/a1fa4c68-c686-42f4-802c-efeb668769e9"">

Additionally, the no results illustration looks off on dark theme. Do we need an alternative image for this, @AlessioLaiso ?

<img width=""184"" alt=""image"" src=""https://github.com/user-attachments/assets/66d2d958-de26-455e-ad18-a75f21ea67dc"">

"
2441926474,pull_request,closed,,"🤖 backported ""Add `:relative-time-interval` mbql function""","  #46211
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-01 09:13:13+00:00,"['lbrdnk', 'github-automation-metabase']",2024-08-01 15:17:31+00:00,2024-08-01 15:17:30+00:00,https://github.com/metabase/metabase/pull/46363,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2263333670, 'issue_id': 2441926474, 'author': 'lbrdnk', 'body': ""There was a failure after merging the original PR into master. The PR was reverted and I'll send it again when I address the failure. Hence closing the backport."", 'created_at': datetime.datetime(2024, 8, 1, 15, 17, 30, tzinfo=datetime.timezone.utc)}]","lbrdnk (Assginee) on (2024-08-01 15:17:30 UTC): There was a failure after merging the original PR into master. The PR was reverted and I'll send it again when I address the failure. Hence closing the backport.

"
2441922078,pull_request,closed,,[serdes] http api: be more picky about files we unpack from an archive,"Previously we unpacked everything and picked up first entry as the directory containing the data. This works well when archives are passed as is. However, if a user unpacks and then packs an archive, there is a good chance that some hidden directories will appear - and they are first in order.

So we skip those right now, and additionally check known markers of the serialization data directory.

[Context](https://metaboat.slack.com/archives/C05MPF0TM3L/p1722438171600739?thread_ts=1722425662.581279&cid=C05MPF0TM3L)",piranha,2024-08-01 09:11:30+00:00,['piranha'],2024-08-02 08:21:25+00:00,2024-08-02 07:29:32+00:00,https://github.com/metabase/metabase/pull/46362,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2441608828,pull_request,closed,,"🤖 backported ""Fix x-ray generate invalid query for table with Date column""",#46317,github-automation-metabase,2024-08-01 06:35:41+00:00,"['qnkhuat', 'github-automation-metabase']",2024-08-01 07:24:17+00:00,2024-08-01 07:24:16+00:00,https://github.com/metabase/metabase/pull/46361,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2441489930,pull_request,open,,fix combined scalars cannot be rendered as a funnel,"Closes https://github.com/metabase/metabase/issues/45656

Description
Describe the overall approach and the problem being solved.

How to verify
Describe the steps to verify that the changes are working as expected.

New question -> Sample Dataset -> ...
...
Demo
Upload a demo video or before/after screenshots if sensible or remove the section

Checklist
 Tests have been added/updated to cover changes in this PR",alxnddr,2024-08-01 05:10:46+00:00,['alxnddr'],2025-01-21 14:39:53+00:00,,https://github.com/metabase/metabase/pull/46360,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2571839390, 'issue_id': 2441489930, 'author': 'trunk-io[bot]', 'body': '<!-- Trunk Test Analytics -->\n\n\n[![Static Badge](https://img.shields.io/badge/9539_tests-c66d0345-purple)](https://app.trunk.io/metabase/flaky-tests/pr/46360?repo=metabase/metabase&commitHash=c66d0345c54676381ddcb2a8b1ac0acd4f7b679a&utm_source=gh-comment) &ensp; [![Static Badge](https://img.shields.io/badge/0-failed-crimson)](https://app.trunk.io/metabase/flaky-tests/pr/46360?repo=metabase/metabase&commitHash=c66d0345c54676381ddcb2a8b1ac0acd4f7b679a&utm_source=gh-comment&runConclusion=FAILURE) &ensp; [![Static Badge](https://img.shields.io/badge/0-flaky-red)](https://app.trunk.io/metabase/flaky-tests/pr/46360?repo=metabase/metabase&commitHash=c66d0345c54676381ddcb2a8b1ac0acd4f7b679a&utm_source=gh-comment&runConclusion=FAILURE) &ensp; [![Static Badge](https://img.shields.io/badge/0-quarantined-yellow)](https://app.trunk.io/metabase/flaky-tests/pr/46360?repo=metabase/metabase&commitHash=c66d0345c54676381ddcb2a8b1ac0acd4f7b679a&utm_source=gh-comment&runConclusion=QUARANTINED)\n\n\n<sub>\n\n[View Full Report ↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46360?repo=metabase/metabase&commitHash=c66d0345c54676381ddcb2a8b1ac0acd4f7b679a&utm_source=gh-comment) ⋅ [Docs](https://docs.trunk.io/flaky-tests?utm_source=gh-comment)\n\n</sub>', 'created_at': datetime.datetime(2025, 1, 6, 1, 9, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2604918186, 'issue_id': 2441489930, 'author': 'colax94', 'body': 'Hi, anything blocking this please ? :)', 'created_at': datetime.datetime(2025, 1, 21, 14, 39, 51, tzinfo=datetime.timezone.utc)}]","trunk-io[bot] on (2025-01-06 01:09:47 UTC): <!-- Trunk Test Analytics -->


[![Static Badge](https://img.shields.io/badge/9539_tests-c66d0345-purple)](https://app.trunk.io/metabase/flaky-tests/pr/46360?repo=metabase/metabase&commitHash=c66d0345c54676381ddcb2a8b1ac0acd4f7b679a&utm_source=gh-comment) &ensp; [![Static Badge](https://img.shields.io/badge/0-failed-crimson)](https://app.trunk.io/metabase/flaky-tests/pr/46360?repo=metabase/metabase&commitHash=c66d0345c54676381ddcb2a8b1ac0acd4f7b679a&utm_source=gh-comment&runConclusion=FAILURE) &ensp; [![Static Badge](https://img.shields.io/badge/0-flaky-red)](https://app.trunk.io/metabase/flaky-tests/pr/46360?repo=metabase/metabase&commitHash=c66d0345c54676381ddcb2a8b1ac0acd4f7b679a&utm_source=gh-comment&runConclusion=FAILURE) &ensp; [![Static Badge](https://img.shields.io/badge/0-quarantined-yellow)](https://app.trunk.io/metabase/flaky-tests/pr/46360?repo=metabase/metabase&commitHash=c66d0345c54676381ddcb2a8b1ac0acd4f7b679a&utm_source=gh-comment&runConclusion=QUARANTINED)


<sub>

[View Full Report ↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46360?repo=metabase/metabase&commitHash=c66d0345c54676381ddcb2a8b1ac0acd4f7b679a&utm_source=gh-comment) ⋅ [Docs](https://docs.trunk.io/flaky-tests?utm_source=gh-comment)

</sub>

colax94 on (2025-01-21 14:39:51 UTC): Hi, anything blocking this please ? :)

"
2441306090,pull_request,closed,,use echarts tooltip,"Closes https://github.com/metabase/metabase/issues/42114
Closes https://github.com/metabase/metabase/issues/37734

### Description

This PR replaces our old tooltip with the new ECharts tooltip. The scope of this PR is the [Milestone 1](https://www.notion.so/metabase/Migrate-tooltips-to-ECharts-for-more-predictable-behavior-364f2c71f3b248f1b839960af037279c?pvs=4#0a6e760a29d54395be150b8740859389).

**Changes to Line/Area/Bar/Combo tooltips**
- Previously users could see in tooltips all the columns for a given data point but now the tooltip shows only series data that is used on the chart.
- Non-stacked time series charts show the difference with the previous value for every series.
- Stacked charts tooltips now do not have limit of 9 series, the tooltip shows all of them. The sorting of series in tooltip by descending order was also removed.

**Changes to Waterfall and Scatter tooltips**
- Only new UI, nothing else should change.

**Changes to the Pie tooltip**
- Pie chart tooltips now do not have limit of 9 slices, the tooltip shows all of them. The sorting of slices in tooltip by descending order was also removed.

### How to verify

Verify the changes listed above.

### Demo

Pie chart
<img width=""451"" alt=""Screenshot 2024-08-14 at 8 39 14 PM"" src=""https://github.com/user-attachments/assets/bfe04880-680d-45d8-ac95-bbba9fd92a50"">

Stacked tooltip
<img width=""285"" alt=""Screenshot 2024-08-14 at 8 39 18 PM"" src=""https://github.com/user-attachments/assets/d55dc1da-daa8-47a2-b15a-b4518a0ca2da"">

Non-stacked tooltip
<img width=""295"" alt=""Screenshot 2024-08-14 at 8 39 56 PM"" src=""https://github.com/user-attachments/assets/df567094-08c0-46a2-b788-dedf226c1b4f"">

All columns tooltip
<img width=""275"" alt=""Screenshot 2024-08-14 at 8 40 10 PM"" src=""https://github.com/user-attachments/assets/4a1ff460-f87e-4e0e-99d3-56c85c760d86"">

### Checklist

- [x] Tests have been added/updated to cover changes in this PR 
",alxnddr,2024-08-01 02:38:25+00:00,['alxnddr'],2024-08-16 15:39:09+00:00,2024-08-16 15:39:07+00:00,https://github.com/metabase/metabase/pull/46359,"[('no-backport', 'Do not backport this PR to any branch'), ('loki-update', '')]","[{'comment_id': 2292434397, 'issue_id': 2441306090, 'author': 'alxnddr', 'body': ""@EmmadUsmani thanks for reviewing!\r\n\r\n> Pie charts are missing the total value\r\n\r\nFixed this in the last commit\r\n\r\n> line chart sometimes included the total column, sometimes it didn't, and when it did it had a single NaN%\r\n\r\nIs it a time series? On time series the third column is the diff with the previous value, now we show it for all series. I'll check if `NaN%` is the correct value or a bug"", 'created_at': datetime.datetime(2024, 8, 15, 23, 10, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2292498940, 'issue_id': 2441306090, 'author': 'EmmadUsmani', 'body': ""@alxnddr Yup it's timeseries"", 'created_at': datetime.datetime(2024, 8, 16, 0, 19, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2292788918, 'issue_id': 2441306090, 'author': 'alxnddr', 'body': '@EmmadUsmani I fixed the issues, thanks!', 'created_at': datetime.datetime(2024, 8, 16, 4, 34, 32, tzinfo=datetime.timezone.utc)}]","alxnddr (Issue Creator) on (2024-08-15 23:10:57 UTC): @EmmadUsmani thanks for reviewing!


Fixed this in the last commit


Is it a time series? On time series the third column is the diff with the previous value, now we show it for all series. I'll check if `NaN%` is the correct value or a bug

EmmadUsmani on (2024-08-16 00:19:52 UTC): @alxnddr Yup it's timeseries

alxnddr (Issue Creator) on (2024-08-16 04:34:32 UTC): @EmmadUsmani I fixed the issues, thanks!

"
2441110264,pull_request,closed,,Support consuming question or model based metrics,"Fixes #45824 

### Description

1. This PR adds the field `report_card.source_card_id` so that we can efficiently find metrics based on given cards. (There is no migration, but since this field is only used to find metrics and no users should have metrics based on cards, this is OK.)
2. `available-metrics` now returns metrics on models subject to the same logic as metrics based on tables.
3. QP now supports executing queries using such metrics.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. Create model B based on the Orders table
4. Create a metric M based on B
5. Create a new question based on B, add new summary, find metric M under ""Common Metrics"" and select it
6. Preview the results

### Demo

Selecting a metric defined on the model the question is based on:
<img width=""701"" alt=""image"" src=""https://github.com/user-attachments/assets/d96956e4-3438-4c9d-844a-44d1e0377ace"">

Running the question:
<img width=""985"" alt=""image"" src=""https://github.com/user-attachments/assets/e9651667-3c59-4222-a0a5-c03f3e5258ab"">

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
- [ ] E2E tests would be good but take large chunk of my time.
",metamben,2024-07-31 23:08:50+00:00,['metamben'],2024-08-06 21:42:17+00:00,2024-08-06 21:42:15+00:00,https://github.com/metabase/metabase/pull/46356,"[('no-backport', 'Do not backport this PR to any branch')]",[],
2441082623,pull_request,closed,,Add v0.49.22 to the list of releases,Like it says on the tin 😁,github-automation-metabase,2024-07-31 22:57:52+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-06 18:11:55+00:00,2024-08-01 13:35:32+00:00,https://github.com/metabase/metabase/pull/46355,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2441015668,pull_request,closed,,Encrypt by default,"WIP

Previously https://github.com/metabase/metabase/pull/44657
",calherries,2024-07-31 21:56:12+00:00,['calherries'],2024-08-19 17:46:19+00:00,2024-08-19 17:46:19+00:00,https://github.com/metabase/metabase/pull/46353,"[('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2297106863, 'issue_id': 2441015668, 'author': 'calherries', 'body': ""Closing, I recommend following the approach in https://github.com/metabase/metabase/pull/44657. Downgrading is an issue with this approach since we'd have to guarantee that the encryption key was in the environment when the downgrade command is made, which I think is a guarantee that we can't make with confidence. Better to stay on the safe side and only enable encryption for dev and tests."", 'created_at': datetime.datetime(2024, 8, 19, 17, 46, 19, tzinfo=datetime.timezone.utc)}]","calherries (Issue Creator) on (2024-08-19 17:46:19 UTC): Closing, I recommend following the approach in https://github.com/metabase/metabase/pull/44657. Downgrading is an issue with this approach since we'd have to guarantee that the encryption key was in the environment when the downgrade command is made, which I think is a guarantee that we can't make with confidence. Better to stay on the safe side and only enable encryption for dev and tests.

"
2441010763,pull_request,closed,,change pr-env conditional,"### Description

Updates the conditional for pr-env to `github.event.pull_request.head.repo.full_name == github.repository`
per https://github.com/metabase/metabase/pull/46301#discussion_r1698679879
",oreonl,2024-07-31 21:51:32+00:00,['oreonl'],2024-10-08 16:19:02+00:00,2024-08-01 18:17:48+00:00,https://github.com/metabase/metabase/pull/46352,"[('.CI & Tests', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.DX', 'Developer experience and QoL related.'), ('.Team/DevEx', '')]",[],
2440989812,pull_request,closed,,Fix coll permissions for audit collection,"We've had a function in `models.collection` for a while that has taken a permissions set and returned a set of collection IDs that the user has permissions on. I refactored this recently, but didn't notice that it was actually doing the permissions checks slightly incorrectly, and kept that wrong behavior in my refactor. Specifically, because it only looks at the user's permissions and the collection IDs and doesn't use `mi/can-read?` or `mi/can-write?`, it's completely indifferent to whether a collection is an audit collection or not.

This is arguably not a *permissions* issue: the two errors that could come about here are:

- someone sees the audit collection even though the audit feature is disabled, or

- someone is presented with the audit collection in a context where only writable collections should be present - when they try to actually write to it, it fails (since then we're doing the real permissions check).

The primary motivation for this fix was to prevent audit dashboards and cards from appearing in the list of stale items.",johnswanson,2024-07-31 21:34:43+00:00,['johnswanson'],2024-10-08 16:18:54+00:00,2024-08-02 17:43:09+00:00,https://github.com/metabase/metabase/pull/46351,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2440984432,pull_request,closed,,test(sdk) Don't show notebook toggle button for brand new questions,"
Closes https://github.com/metabase/metabase/issues/46252

### Description

Hides the notebook toggle button for brand new questions. Will be more visible once we make this button bigger in https://github.com/metabase/metabase/pull/46097.

![hideNotebookToggleButton](https://github.com/user-attachments/assets/8ecd2718-6d37-45c6-b2ec-10d40346c1ff)

![Screen Shot 2024-07-31 at 3 29 00 PM](https://github.com/user-attachments/assets/a7dda17a-75c8-4682-bf49-f3113c184c7c)


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-07-31 21:29:57+00:00,['iethree'],2024-08-02 19:08:00+00:00,2024-08-02 19:07:59+00:00,https://github.com/metabase/metabase/pull/46350,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2263482327, 'issue_id': 2440984432, 'author': 'github-actions[bot]', 'body': '@iethree You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 1, 16, 30, 45, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-01 16:30:45 UTC): @iethree You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2440965163,pull_request,closed,,fix pie chart total graphic not being removed,"https://metaboat.slack.com/archives/C064QMXEV9N/p1722459053536019

### Description

When we refactored the pie chart to not use a constant graphic option object (https://github.com/metabase/metabase/pull/43555/commits/8ab97a92589827cb3fb900175da06ff73b7ff6b0), this bug was created. Returning `undefined` for an object value in echarts does not remove the previous value. Instead, what we do in this PR is still return the graphic object, but with empty strings for text values. I confirmed that echarts does not render anything (there's no DOM elements) when the strings are empty.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. Create any pie chart
2. Toggle the ""show total"" setting from the viz settings sidebar on and off
3. It should instantly update
4. Last selected value should be saved in viz settings, and respected after refresh

### Demo

https://github.com/user-attachments/assets/b7109677-1dcc-454d-9af2-fe5ed327635d

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",EmmadUsmani,2024-07-31 21:14:37+00:00,['EmmadUsmani'],2024-10-08 16:19:06+00:00,2024-07-31 21:58:25+00:00,https://github.com/metabase/metabase/pull/46349,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2261474972, 'issue_id': 2440965163, 'author': 'EmmadUsmani', 'body': '* **#46349** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46349?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 31, 21, 14, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2261477674, 'issue_id': 2440965163, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff c4196d99fb9c14708599790419b22267ed57a014...9a14e6af0a27cbeca00a1ab79c684267a8e4a394.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/echarts/pie/option.ts |', 'created_at': datetime.datetime(2024, 7, 31, 21, 16, 40, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-07-31 21:14:51 UTC): * **#46349** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46349?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

github-actions[bot] on (2024-07-31 21:16:40 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff c4196d99fb9c14708599790419b22267ed57a014...9a14e6af0a27cbeca00a1ab79c684267a8e4a394.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/echarts/pie/option.ts |

"
2440950788,pull_request,closed,,Properly detect when Snowflake is using a local key file when expanding connection properties ,"Fixes https://github.com/metabase/metabase/issues/45393

Previously, the Snowflake driver's `resolve-private-key` logic was looking for the key `private-key-path` in the database details to determine whether the key is in a local path, or uploaded and stored in the `secret` table.

However, `private-key-path` doesn't seem to be in the details map at this point, and I can't find any other references to it in the code. This meant that both local keys and uploaded keys were using the same code path which would write the value from the `secret` table to a temp file. But for local keys, this value is just the path to the key file, so the temp file would contain a path and not an actual key.

I think because `metabase.models.secret/value->file!` is memoized, the file path is being cached correctly when the database is initially added. But on restart, or for a second instance in a cluster, the correct value would not be cached and it will fail. This is probably why this issue wasn't caught earlier.

Fix: instead of using `private-key-path`, it seems that `private-key-options` will be set to either `""local""` or `""uploaded""`, and we can look at this to differentiate the two types of key storage. This fixes the issue for me locally.",noahmoss,2024-07-31 21:03:18+00:00,['noahmoss'],2024-08-22 18:08:23+00:00,2024-08-22 18:08:21+00:00,https://github.com/metabase/metabase/pull/46348,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2261458629, 'issue_id': 2440950788, 'author': 'noahmoss', 'body': '* **#46348** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46348?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 31, 21, 3, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2305093516, 'issue_id': 2440950788, 'author': 'troyharvey', 'body': 'Thanks for working on this @noahmoss!', 'created_at': datetime.datetime(2024, 8, 22, 15, 47, 51, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-07-31 21:03:34 UTC): * **#46348** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46348?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

troyharvey on (2024-08-22 15:47:51 UTC): Thanks for working on this @noahmoss!

"
2440937181,pull_request,closed,,44723 human readable coercion strategies,"Closes https://github.com/metabase/metabase/issues/44723

### Description
Over a year ago, the field editor was refactored so that fields could be edited without requiring the full database metadata ([PR here](https://github.com/metabase/metabase/pull/30484)). When this work was done, we dropped humanizing the coercion strategies, and later on the files that did that string manipulation were removed as they were no longer imported by any files

This PR reverts the commit removing the files, converts them to TS, and adds an e2e test for casting field types

### How to verify
1. Admin -> Table Metadata -> Sample DB -> Feedback
2. Go to the ratings field and click the gear
3. There should be an option to cast the field to a different data type (this is being interpreted as a number, so you're able to cast to UNIX Time)
4. The options in that menu should not be namespaced with `Coercion/`

### Demo
<img width=""262"" alt=""chrome_FZvFE2ygRL"" src=""https://github.com/user-attachments/assets/40221e24-1c59-47b9-8442-480af38f7dad"">

### Checklist
- [x] Tests have been added/updated to cover changes in this PR
",npfitz,2024-07-31 20:53:17+00:00,['npfitz'],2024-08-12 12:26:54+00:00,2024-08-12 12:26:52+00:00,https://github.com/metabase/metabase/pull/46347,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2440612891,pull_request,closed,,"🤖 backported ""Update links to Learn section of metabase.com""",#46336,github-automation-metabase,2024-07-31 18:05:49+00:00,"['gusaiani', 'github-automation-metabase']",2024-07-31 18:07:20+00:00,2024-07-31 18:07:19+00:00,https://github.com/metabase/metabase/pull/46340,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2440393657,pull_request,closed,,"🤖 backported ""Quick Followup to Pull #45691""",#46286,github-automation-metabase,2024-07-31 15:57:04+00:00,"['adam-james-v', 'github-automation-metabase']",2024-07-31 17:20:25+00:00,2024-07-31 17:20:24+00:00,https://github.com/metabase/metabase/pull/46338,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2440248748,pull_request,closed,,Update links to Learn section of metabase.com,"We are revamping the Learn section of our public website, and certain URLs have been updated.

We do have redirects.
However, our website repo does not follow them when they have anchor links, so we must update a few manually here.",gusaiani,2024-07-31 14:47:36+00:00,['gusaiani'],2024-07-31 18:07:45+00:00,2024-07-31 18:04:19+00:00,https://github.com/metabase/metabase/pull/46336,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2440222253,pull_request,closed,,Embed downloads ms3 - analytics,"This is MS3 of [[Epic] Add download PDF to static embedded dashboards and make knobs for downloads consistent between public links and static embeds](https://github.com/metabase/metabase/issues/42628)

Commits come from approved PRs, but the last PR had some conflicts + a failing test (due to bad automatic merges I think, a line was added outside of a `it()`, that I had to [fix manually](https://github.com/metabase/metabase/pull/46132/commits/32b20a07e87d11c2038288aaa9ccff017be2f4d3))",npretto,2024-07-31 14:36:13+00:00,['npretto'],2024-10-08 16:18:56+00:00,2024-08-02 14:16:19+00:00,https://github.com/metabase/metabase/pull/46335,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2440217276,pull_request,closed,,Embed downloads - MS3 - analytics,,npretto,2024-07-31 14:34:03+00:00,['npretto'],2024-07-31 14:35:29+00:00,2024-07-31 14:35:29+00:00,https://github.com/metabase/metabase/pull/46334,"[('.Team/Embedding', '')]",[],
2440148569,pull_request,closed,,"🤖 backported ""fix(webapp/browse): Use user locale if available in Browse models""","  #45914
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-31 14:04:43+00:00,"['rafpaf', 'github-automation-metabase']",2024-07-31 17:42:23+00:00,2024-07-31 17:42:21+00:00,https://github.com/metabase/metabase/pull/46333,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2261035452, 'issue_id': 2440148569, 'author': 'rafpaf', 'body': '### Merge activity\n\n* **Jul 31, 1:42 PM EDT**: @rafpaf merged this pull request with [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/46333).', 'created_at': datetime.datetime(2024, 7, 31, 17, 42, 22, tzinfo=datetime.timezone.utc)}]","rafpaf (Assginee) on (2024-07-31 17:42:22 UTC): ### Merge activity

* **Jul 31, 1:42 PM EDT**: @rafpaf merged this pull request with [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/46333).

"
2440004203,pull_request,closed,,"🤖 backported ""docs - update firefox link""",#46330,github-automation-metabase,2024-07-31 12:59:54+00:00,"['abdhabli', 'github-automation-metabase']",2024-07-31 13:01:23+00:00,2024-07-31 13:01:22+00:00,https://github.com/metabase/metabase/pull/46331,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2439998619,pull_request,closed,,docs - update firefox link,Updates expired link.,jeff-bruemmer,2024-07-31 12:57:16+00:00,['jeff-bruemmer'],2024-07-31 13:01:51+00:00,2024-07-31 12:59:06+00:00,https://github.com/metabase/metabase/pull/46330,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2439988041,pull_request,closed,,"🤖 backported ""docs: import clarification""",#46328,github-automation-metabase,2024-07-31 12:52:24+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-31 12:53:51+00:00,2024-07-31 12:53:50+00:00,https://github.com/metabase/metabase/pull/46329,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2439966064,pull_request,closed,,docs: import clarification,,alexyarosh,2024-07-31 12:42:03+00:00,['alexyarosh'],2024-07-31 12:54:19+00:00,2024-07-31 12:51:33+00:00,https://github.com/metabase/metabase/pull/46328,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2439947411,pull_request,closed,,Fix OOM error syncing MongoDB collection with large documents,"Resolves https://github.com/metabase/metabase/issues/46277

WIP

### How to verify

1. Start Metabase with 1 GB of maximum heap space by setting -Xmx2g option
2. Create a collection with very large documents:

```
use test;

function generateLargeArrayDocument(arraySize) {
  const largeArray = Array.from({ length: arraySize }, (_, index) => ({
    id: index,
    value: Math.random()
  }));
  return {
    _id: new ObjectId(),
    largeArray: largeArray
  };
}

db.createCollection(""oom_test"")

const numDocuments = 500;
const arraySize = 100000;

for (let i = 0; i < numDocuments; i++) {
  db.oom_test.insertOne(generateLargeArrayDocument(arraySize));
}
```
3. Add the DB to metabase and sync its fields. Before this would fail and now it will succeed.
```
(def db (t2/select-one :model/Database :engine :mongo))
(sync.fields/sync-fields! db)
```
",calherries,2024-07-31 12:32:56+00:00,['calherries'],2024-08-19 12:25:16+00:00,2024-08-19 12:25:15+00:00,https://github.com/metabase/metabase/pull/46327,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2296450719, 'issue_id': 2439947411, 'author': 'calherries', 'body': 'closing in favour of https://github.com/metabase/metabase/pull/46598', 'created_at': datetime.datetime(2024, 8, 19, 12, 25, 15, tzinfo=datetime.timezone.utc)}]","calherries (Issue Creator) on (2024-08-19 12:25:15 UTC): closing in favour of https://github.com/metabase/metabase/pull/46598

"
2439902332,pull_request,closed,,"🤖 backported ""test: reduce flakiness by waiting longer for loader to disappear""","  #46320
",github-automation-metabase,2024-07-31 12:12:50+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-07-31 14:10:04+00:00,2024-07-31 14:10:03+00:00,https://github.com/metabase/metabase/pull/46326,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2439876251,pull_request,closed,,"🤖 backported ""Add v0.50.18 to the list of releases""",#46304,github-automation-metabase,2024-07-31 12:01:11+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-31 12:08:03+00:00,2024-07-31 12:08:02+00:00,https://github.com/metabase/metabase/pull/46325,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2439869567,pull_request,closed,,"🤖 backported ""docs - correct tar command""",#46299,github-automation-metabase,2024-07-31 11:57:38+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-31 11:59:06+00:00,2024-07-31 11:59:05+00:00,https://github.com/metabase/metabase/pull/46324,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2439864512,pull_request,closed,,"🤖 backported ""make search results filterable by concrete ids""","backport of  #46276
",github-automation-metabase,2024-07-31 11:54:54+00:00,"['piranha', 'github-automation-metabase']",2024-08-01 07:50:35+00:00,2024-08-01 07:50:34+00:00,https://github.com/metabase/metabase/pull/46323,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2439854019,pull_request,closed,,"""Reset all filters"" button","Closes #45984

Depends on #46050

### Description

Review with [""Hide whitespace"" on](https://github.com/user-attachments/assets/69555486-1893-4585-90a1-583a2a9ffa9a) - there's been an indentation change affecting many lines in `dashboard-filters-reset-clear.cy.spec.ts`.

### How to verify

Subject: ""..."" dropdown > ""Reset all filters"" button in dashboards
For filters without default values, it should clear non-empty values.
For filters with default values, it should reset non-default values to default.
It should be shown only when the action is not a noop.

More info in the testing plan: #45977.

### Demo


https://github.com/user-attachments/assets/27287741-74fd-4a72-8b2b-58229f7cb7e9

",kamilmielnik,2024-07-31 11:49:10+00:00,['kamilmielnik'],2024-08-05 14:30:54+00:00,2024-08-05 09:18:49+00:00,https://github.com/metabase/metabase/pull/46322,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2268959405, 'issue_id': 2439854019, 'author': 'kamilmielnik', 'body': '@metabase-bot backport release-x.50.x', 'created_at': datetime.datetime(2024, 8, 5, 12, 30, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2268961348, 'issue_id': 2439854019, 'author': 'github-actions[bot]', 'body': '@kamilmielnik something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10248835757)', 'created_at': datetime.datetime(2024, 8, 5, 12, 31, 4, tzinfo=datetime.timezone.utc)}]","kamilmielnik (Issue Creator) on (2024-08-05 12:30:04 UTC): @metabase-bot backport release-x.50.x

github-actions[bot] on (2024-08-05 12:31:04 UTC): @kamilmielnik something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10248835757)

"
2439624393,pull_request,closed,,Consider the first 10 lines when inferring upload separator,"Closes https://github.com/metabase/metabase/issues/45295

### Description

Generalizes the separator inference algorithm to consider more lines, for extra robustness.",crisptrutski,2024-07-31 09:51:37+00:00,['crisptrutski'],2024-08-07 13:36:39+00:00,2024-08-07 13:36:38+00:00,https://github.com/metabase/metabase/pull/46321,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2262454491, 'issue_id': 2439624393, 'author': 'crisptrutski', 'body': 'Some uploads related e2e tests are timing out now, need to investigate them.', 'created_at': datetime.datetime(2024, 8, 1, 8, 56, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2262648226, 'issue_id': 2439624393, 'author': 'crisptrutski', 'body': 'It turns out that this change merely exposed an existing issue, discussed in [this slack thread](https://metaboat.slack.com/archives/C04S696LRUM/p1722505131445879).', 'created_at': datetime.datetime(2024, 8, 1, 10, 2, 27, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-08-01 08:56:31 UTC): Some uploads related e2e tests are timing out now, need to investigate them.

crisptrutski (Issue Creator) on (2024-08-01 10:02:27 UTC): It turns out that this change merely exposed an existing issue, discussed in [this slack thread](https://metaboat.slack.com/archives/C04S696LRUM/p1722505131445879).

"
2439590317,pull_request,closed,,test: reduce flakiness by waiting longer for loader to disappear,"This PR reduces flakiness overall and particularly in the `MetadataTableSettings`

in some cases 1s not enough for loader to disappear on potato machines, so let's increase it and wait a bit more.

To test flakiness locally I ran `yarn jest` in one tab to overload CPU and in second tab.

```
hyperfine --runs 50 ""node 'node_modules/.bin/jest' '/Users/uladzimirhavenchyk/p/metabase/frontend/src/metabase/admin/datamodel/metadata/components/MetadataTableSettings/MetadataTableSettings.unit.spec.tsx'"" --show-output
```

[hyperfine](https://github.com/sharkdp/hyperfine) is a tool that allows to repeat command and gather results, kind of local stress-test.

it used to fail with 1s timeout and passed with 3s timeout

<img width=""774"" alt=""image"" src=""https://github.com/user-attachments/assets/1efbc67d-53a4-4676-bfc4-4c02fef5466a"">

[example of flaky test](https://github.com/metabase/metabase/actions/runs/10178553689/job/28152409000?pr=45902)
",uladzimirdev,2024-07-31 09:34:57+00:00,['uladzimirdev'],2024-07-31 14:10:30+00:00,2024-07-31 12:12:05+00:00,https://github.com/metabase/metabase/pull/46320,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]",[],
2439475264,pull_request,closed,,Fix x-ray generate invalid query for table with Date column,"Fixes https://github.com/metabase/metabase/issues/46249

In the reproduction step of the issue, we're generating a breakout on the `customer.create_date` column with `:minute` breakout, this is invalid because the base type of this column is `:type/Date`.

The temporal unit is inferred by the `metabase.xrays.automagic-dashboards.interesting/optimal-temporal-resolution` function that takes a field and uses its fingerprint info of datetime `earliest and lastest` to get a temporal unit.
The fix here is to guard this function from returning an invalid unit.

### How to test:
1. Create a db with this sql
```sql
CREATE TABLE shows (
    name TEXT,
    event_date DATE,
);

INSERT INTO shows (name, event_date)
VALUES ('taylor swift concert', '2024-07-31');

```
2. sync it and x-ray on the `shows` table
3. You should be able to save the x-ray successfully",qnkhuat,2024-07-31 08:42:47+00:00,['qnkhuat'],2024-08-01 06:34:53+00:00,2024-08-01 06:34:52+00:00,https://github.com/metabase/metabase/pull/46317,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2439383388,pull_request,closed,,[Manual backport 49] Fix sync indexes mark all fields with same name as indexed if one of them is,#46313,qnkhuat,2024-07-31 07:53:16+00:00,[],2024-07-31 11:54:02+00:00,2024-07-31 11:54:02+00:00,https://github.com/metabase/metabase/pull/46316,[],"[{'comment_id': 2260296492, 'issue_id': 2439383388, 'author': 'replay-io[bot]', 'body': '<h3></h3>\n<table>\n  <tbody>\n    <tr>\n      <td><b>Status</b></td>\n      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=f90ff02f-2b6d-498f-bea9-a70caee3bebd"" target=""_blank"">Complete ↗︎</a></td>\n    </tr>\n    <tr>\n      <td><b>Commit</b></td>\n      <td>7dd72b4962f85fcc57a3e5dd22c8037890a51a87</td>\n    </tr>\n    <tr>\n      <td valign=""top""><b>Results</b></td>\n      <td><div>⚠️ <b>1 Flaky</b></div>\n<div>✅ <b>2379 Passed</b></div>\n</td>\n    </tr>\n  </tbody>\n</table>', 'created_at': datetime.datetime(2024, 7, 31, 11, 26, 51, tzinfo=datetime.timezone.utc)}]","replay-io[bot] on (2024-07-31 11:26:51 UTC): <h3></h3>
<table>
  <tbody>
    <tr>
      <td><b>Status</b></td>
      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=f90ff02f-2b6d-498f-bea9-a70caee3bebd"" target=""_blank"">Complete ↗︎</a></td>
    </tr>
    <tr>
      <td><b>Commit</b></td>
      <td>7dd72b4962f85fcc57a3e5dd22c8037890a51a87</td>
    </tr>
    <tr>
      <td valign=""top""><b>Results</b></td>
      <td><div>⚠️ <b>1 Flaky</b></div>
<div>✅ <b>2379 Passed</b></div>
</td>
    </tr>
  </tbody>
</table>

"
2439342854,pull_request,closed,,🚧 test bun install,"> [!IMPORTANT]
> For those employed by Metabase: if you are merging into master, please add either a `backport` or a `no-backport` label to this PR. You will not be able to merge until you do this step. Refer to the section [Do I need to backport this PR?](https://www.notion.so/metabase/Metabase-Branching-Strategy-6eb577d5f61142aa960a626d6bbdfeb3?pvs=4#89f80d6f17714a0198aeb66c0efd1b71) in the Metabase Branching Strategy document for more details. If you're not employed by Metabase, this section does not apply to you, and the label will be taken care of by your reviewer.

> **Warning**
>
> If that is your first contribution to Metabase, please sign the [Contributor License Agreement](https://docs.google.com/a/metabase.com/forms/d/1oV38o7b9ONFSwuzwmERRMi9SYrhYeOrkbmNaq9pOJ_E/viewform) (unless it's a tiny documentation change). Also, if you're attempting to fix a translation issue, please submit your changes to our [POEditor project](https://poeditor.com/join/project/ynjQmwSsGh) instead of opening a PR.

Closes https://github.com/metabase/metabase/issues/[issue_number]

### Description

Describe the overall approach and the problem being solved.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. New question -> Sample Dataset -> ...
2. ...

### Demo

_Upload a demo video or before/after screenshots if sensible or remove the section_

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",uladzimirdev,2024-07-31 07:30:12+00:00,['uladzimirdev'],2025-01-20 19:32:41+00:00,2025-01-20 19:32:41+00:00,https://github.com/metabase/metabase/pull/46315,"[('.Team/DevEx', '')]",[],
2439340795,pull_request,closed,,"🤖 backported ""Fix sync indexes mark all fields with same name as indexed if one of them is""",#46313,github-automation-metabase,2024-07-31 07:29:02+00:00,"['qnkhuat', 'github-automation-metabase']",2024-08-02 08:51:58+00:00,2024-08-02 08:51:57+00:00,https://github.com/metabase/metabase/pull/46314,"[('.Team/Workflows', 'aka BEC'), ('was-backported', 'apply this to PRs that are themselves backports')]",[],
2439018160,pull_request,closed,,Fix sync indexes mark all fields with same name as indexed if one of them is,Closes https://github.com/metabase/metabase/issues/46312,qnkhuat,2024-07-31 03:13:27+00:00,['qnkhuat'],2024-07-31 07:46:05+00:00,2024-07-31 07:27:35+00:00,https://github.com/metabase/metabase/pull/46313,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2259877277, 'issue_id': 2439018160, 'author': 'qnkhuat', 'body': '@metabase-bot backport release-x.49.x', 'created_at': datetime.datetime(2024, 7, 31, 7, 42, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2259882477, 'issue_id': 2439018160, 'author': 'github-actions[bot]', 'body': '@qnkhuat something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10176154280)', 'created_at': datetime.datetime(2024, 7, 31, 7, 46, 4, tzinfo=datetime.timezone.utc)}]","qnkhuat (Issue Creator) on (2024-07-31 07:42:54 UTC): @metabase-bot backport release-x.49.x

github-actions[bot] on (2024-07-31 07:46:04 UTC): @qnkhuat something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10176154280)

"
2438974159,pull_request,closed,,[perf] Add `dev.perf.dashboard-perf` scripts to build a big dashboard,"### Description

This creates many things:
- A new database in any driver (tested on Postgres, YMMV)
- 100 tables
    - with 100 columns each, of many types
    - and with 100 rows of random data each
- 100 MBQL models, one for each table, that returns the whole thing
- 100 MBQL queries, one for each model, that does `COUNT`
- 1 dashboard
    - with 19 filters (9 int category fields, 10 string category fields)
    - with all 100 `COUNT` queries in one tab
        - all wired to all 19 filters

This exposes some serious perf issues on both BE and FE, even from a
cursory glance.
",bshepherdson,2024-07-31 02:21:04+00:00,['bshepherdson'],2025-02-04 01:31:40+00:00,2025-02-04 01:31:40+00:00,https://github.com/metabase/metabase/pull/46311,"[('Stale', 'Stale PRs that will be auto-closed'), ('.Team/Querying', '')]","[{'comment_id': 2259514159, 'issue_id': 2438974159, 'author': 'bshepherdson', 'body': '* **#46311** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46311?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 31, 2, 21, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603450122, 'issue_id': 2438974159, 'author': 'github-actions[bot]', 'body': 'This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.', 'created_at': datetime.datetime(2025, 1, 21, 1, 31, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2632557924, 'issue_id': 2438974159, 'author': 'github-actions[bot]', 'body': 'This pull request was closed because it had no activity for more than 90 days.', 'created_at': datetime.datetime(2025, 2, 4, 1, 31, 39, tzinfo=datetime.timezone.utc)}]","bshepherdson (Issue Creator) on (2024-07-31 02:21:17 UTC): * **#46311** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46311?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

github-actions[bot] on (2025-01-21 01:31:32 UTC): This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.

github-actions[bot] on (2025-02-04 01:31:39 UTC): This pull request was closed because it had no activity for more than 90 days.

"
2438879384,pull_request,closed,,Backend Dependency Bump for 52,"Closes #44330

## Major Bumps

[bigml/histogram 4.1.4 -> 5.0.0](https://github.com/bigmlcom/histogram/commit/ada60dbdf305f1b458aa9968bfc4fb363b68a27e)
[com.fasterxml.woodstox/woodstox-core 6.6.1 -> 7.0.0](https://github.com/FasterXML/woodstox/blob/master/release-notes/VERSION)

## Minor Bumps

[buddy/buddy-core 1.11.423 -> 1.12.0-420](https://github.com/funcool/buddy-core/blob/master/CHANGES.md)
[buddy/buddy-sign 3.5.351 -> 3.6.1-359](https://github.com/funcool/buddy-sign/blob/master/CHANGES.md)
[cheshire/cheshire 5.12.0 -> 5.13.0](https://cljdoc.org/d/cheshire/cheshire/5.13.0/doc/changelog) (changelog appears to be out of date)
--- continue adding changelog links here
clj-http/clj-http                  3.12.3 -> 3.13.0
com.google.guava               33.1.0-jre -> 33.2.1-jre
commons-codec/commons-codec        1.16.1 -> 1.17.1
commons-io/commons-io              2.15.1 -> 2.16.1
commons-net/commons-net            3.10.0 -> 3.11.1
commons-validator/commons-validator 1.8.0 -> 1.9.0
instaparse/instaparse              1.4.12 -> 1.5.0
net.clojars.wkok/openai-clojure    0.16.0 -> 0.18.1
org.apache.commons/commons-lang3   3.14.0 -> 3.15.0
org.apache.poi/poi                  5.2.5 -> 5.3.0
org.apache.poi/poi-ooxml            5.2.5 -> 5.3.0
org.apache.sshd/sshd-core          2.12.1 -> 2.13.1
org.jsoup/jsoup                    1.17.2 -> 1.18.1
org.threeten/threeten-extra         1.7.2 -> 1.8.0",adam-james-v,2024-07-31 00:27:49+00:00,['adam-james-v'],2024-11-27 17:13:05+00:00,2024-11-27 17:13:04+00:00,https://github.com/metabase/metabase/pull/46309,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2262853555, 'issue_id': 2438879384, 'author': 'piranha', 'body': 'Vertica errors seem legit, I propose removing it from this batch update.', 'created_at': datetime.datetime(2024, 8, 1, 11, 54, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2262905014, 'issue_id': 2438879384, 'author': 'crisptrutski', 'body': 'It would be nice to link the changelogs for all the libraries with major version bumps 🙏 \r\n\r\nNot sure the terminology, but `0.x` to `0.y` often also has breaking changes.', 'created_at': datetime.datetime(2024, 8, 1, 12, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2393891007, 'issue_id': 2438879384, 'author': 'piranha', 'body': ""Let's wait until 51 is cut to merge it :)"", 'created_at': datetime.datetime(2024, 10, 4, 14, 50, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2501387139, 'issue_id': 2438879384, 'author': 'trunk-io[bot]', 'body': ""<!-- Trunk Test Analytics -->\n\n\n[![Static Badge](https://img.shields.io/badge/1_test-0eedf863-purple)](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment) &ensp; [![Static Badge](https://img.shields.io/badge/1-failed-crimson)](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment&runConclusion=FAILURE) &ensp; [![Static Badge](https://img.shields.io/badge/0-flaky-red)](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment&runConclusion=FAILURE) &ensp; [![Static Badge](https://img.shields.io/badge/0-quarantined-yellow)](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment&runConclusion=QUARANTINED)\n\n\n| Failed Test | Failure Summary | Logs |\n| --- | --- | --- |\n| <code>converting question to a native query (metabase\\#15946, metabase\\#32121, metabase\\#38181) should work for both simple and nested questions based on...</code> | The expected text was not found in the element after 4 seconds, containing 'Small Marble Shoes'. | [Logs\xa0↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment&runConclusion=FAILURE&runId=0c47b4b0-073e-58b5-937a-76e63c3e5c2d) |\n<sub>\n\n[View Full Report ↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment) ⋅ [Docs](https://docs.trunk.io/flaky-tests?utm_source=gh-comment)\n\n</sub>"", 'created_at': datetime.datetime(2024, 11, 26, 16, 48, 2, tzinfo=datetime.timezone.utc)}]","piranha on (2024-08-01 11:54:48 UTC): Vertica errors seem legit, I propose removing it from this batch update.

crisptrutski on (2024-08-01 12:22:00 UTC): It would be nice to link the changelogs for all the libraries with major version bumps 🙏 

Not sure the terminology, but `0.x` to `0.y` often also has breaking changes.

piranha on (2024-10-04 14:50:45 UTC): Let's wait until 51 is cut to merge it :)

trunk-io[bot] on (2024-11-26 16:48:02 UTC): <!-- Trunk Test Analytics -->


[![Static Badge](https://img.shields.io/badge/1_test-0eedf863-purple)](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment) &ensp; [![Static Badge](https://img.shields.io/badge/1-failed-crimson)](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment&runConclusion=FAILURE) &ensp; [![Static Badge](https://img.shields.io/badge/0-flaky-red)](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment&runConclusion=FAILURE) &ensp; [![Static Badge](https://img.shields.io/badge/0-quarantined-yellow)](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment&runConclusion=QUARANTINED)


| Failed Test | Failure Summary | Logs |
| --- | --- | --- |
| <code>converting question to a native query (metabase\#15946, metabase\#32121, metabase\#38181) should work for both simple and nested questions based on...</code> | The expected text was not found in the element after 4 seconds, containing 'Small Marble Shoes'. | [Logs ↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment&runConclusion=FAILURE&runId=0c47b4b0-073e-58b5-937a-76e63c3e5c2d) |
<sub>

[View Full Report ↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46309?repo=metabase/metabase&commitHash=0eedf8631e93326415c6f1d078305a02b2bd36b3&utm_source=gh-comment) ⋅ [Docs](https://docs.trunk.io/flaky-tests?utm_source=gh-comment)

</sub>

"
2438871738,pull_request,closed,,fix viz settings not persisted during question edit,"Closes https://github.com/metabase/metabase/issues/41276

### Description

We used `getDefaultColumns` to compute the default `graph.dimensions` and `graph.metrics` settings. The problem this was that `getDefaultColumns` returns `null` for both metrics and dimensions with the dataset has 0 rows. The dataset will have 0 rows when a required filter value is missing, so saving the question in that state will cause `graph.dimensions` and `graph.metrics` to both be overwritten with `[null]`.

The solution is to first check if `getDefaultColumns` returns `null` for the dimension/metric columns. If it does return `null`, and there is an existing value for `graph.dimensions` or `graph.metrics`, use the existing value instead in order to preserve the setting.

### How to verify

1. Create a native question with a filter needed in the query.
2. Save the question as a line chart with selected dimension and metric columns.
3. Remove the filter value, run the query (should error), edit the question by changing a filter name, then save again.
4. Re-add the filter value, the line chart should appear again with the same dimension and metric columns.

### Demo

**Before**

https://github.com/user-attachments/assets/f9843228-4113-4a75-81f7-c035549e7157

**After**

https://github.com/user-attachments/assets/56e251d2-b978-48d6-85fd-f88325636896

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",EmmadUsmani,2024-07-31 00:17:35+00:00,['EmmadUsmani'],2024-08-02 02:37:29+00:00,2024-08-02 02:37:28+00:00,https://github.com/metabase/metabase/pull/46308,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2259404675, 'issue_id': 2438871738, 'author': 'EmmadUsmani', 'body': '* **#46308** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46308?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 31, 0, 17, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2259408447, 'issue_id': 2438871738, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 58d7b2ca84600703ea98f7067dbd349e9005b562...de098b16af98da2dd91ce22580d3d04596d0e4c4.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/lib/settings/graph.js<br>frontend/src/metabase/visualizations/shared/settings/cartesian-chart.ts |', 'created_at': datetime.datetime(2024, 7, 31, 0, 22, 2, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-07-31 00:17:51 UTC): * **#46308** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46308?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

github-actions[bot] on (2024-07-31 00:22:02 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 58d7b2ca84600703ea98f7067dbd349e9005b562...de098b16af98da2dd91ce22580d3d04596d0e4c4.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/lib/settings/graph.js<br>frontend/src/metabase/visualizations/shared/settings/cartesian-chart.ts |

"
2438825021,pull_request,closed,,Export Formatting Correctness,"
Several bugs exist around the correctness of export formatting, this aims to fix them.

Fixes #27374

When a model has viz settings/metadata changed after save, the download won't incorporate said changes. At least it's clear that scale doesn't work.

Fixes #43039
Fixes #43164

Column formatting on aggregated columns (eg. a sum of a currency column) now works in Excel Exports too, plus a test was added to `metabase.api.downloads-exports-test` to cover this.

Here's a screenshot of a custom Expression with formatting applied in the export (works for both csv and Excel).
![image](https://github.com/user-attachments/assets/0908f22d-7d6f-4caf-bb2d-b6f4d5cac8fc)

Fixes #43040 

The number formatter for csv exports didn't merge in `global-type-settings`, where the formatter for the xlsx namespace does. This uses the common `metabase.query-processor.streaming.common/global-type-settings` to grab the relevant settings.
",adam-james-v,2024-07-30 23:20:56+00:00,['adam-james-v'],2024-08-09 19:50:14+00:00,2024-08-09 19:50:12+00:00,https://github.com/metabase/metabase/pull/46306,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2438785206,pull_request,closed,,🍒 Manual Backport: Run without Replay (#45799),"Manual backport #45799 

This blocked our release of 49.22 because the pre-release job checks out the tests at the commit we're releasing - but the workflow itself runs from the master branch - so there was a mis-match between the workflow, which was expecting chromium, and the checked-out old code, which was expecting replay. ",iethree,2024-07-30 22:35:01+00:00,['iethree'],2024-07-31 15:59:42+00:00,2024-07-31 15:59:41+00:00,https://github.com/metabase/metabase/pull/46305,"[('.Team/AdminWebapp', 'Admin and Webapp team'), ('was-backported', 'apply this to PRs that are themselves backports')]",[],
2438781172,pull_request,closed,,Add v0.50.18 to the list of releases,Like it says on the tin 😁,github-automation-metabase,2024-07-30 22:30:20+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-31 12:08:34+00:00,2024-07-31 12:00:17+00:00,https://github.com/metabase/metabase/pull/46304,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2438774594,pull_request,closed,,"🤖 backported ""Update Translations for v50.19""",#46015,github-automation-metabase,2024-07-30 22:23:05+00:00,"['iethree', 'github-automation-metabase']",2024-07-31 22:08:42+00:00,2024-07-31 22:08:40+00:00,https://github.com/metabase/metabase/pull/46303,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2438674542,pull_request,closed,,Properly handle SMTP Settings environment variables,"Closes https://github.com/metabase/metabase/issues/45445

### Description

The reported problem was that you can't send test emails from this form when all settings are set by environment variable. In reality there were a bunch of problems with this form.


1. Disabled inputs when SMTP settings are set by environment variable
2. Enabled the test button when one or more SMTP settings are set by environment variable
3. Updated validation to be sensitive to whether settings are set by environment variable
4. disabled `clear` button when all settings were set via environment variable.
5. Fixed the security type selection and update the setting options to match the type definitions elsewhere
6. Added unit tests for this component
7. Fixed a bunch of type mismatches, some of which caused errors.


![Screen Shot 2024-07-30 at 2 58 39 PM](https://github.com/user-attachments/assets/3e5fecdd-a6f2-4548-ba20-33548532b04a)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-07-30 21:03:01+00:00,['iethree'],2024-08-02 17:21:58+00:00,2024-08-02 17:21:57+00:00,https://github.com/metabase/metabase/pull/46302,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2265585064, 'issue_id': 2438674542, 'author': 'rafpaf', 'body': 'Might be nice to localize the error messages in `src/metabase/api/email.clj` if a backender can knock that out in a few minutes', 'created_at': datetime.datetime(2024, 8, 2, 14, 54, 10, tzinfo=datetime.timezone.utc)}]","rafpaf on (2024-08-02 14:54:10 UTC): Might be nice to localize the error messages in `src/metabase/api/email.clj` if a backender can knock that out in a few minutes

"
2438640239,pull_request,closed,,Don't create PR Env on external PRs,"### Description

Stops PR Env creation on external PRs. If the PR has the label `External` then PR Env will not be created.

### How to verify
Create a PR with the label `External`. Add the label `PR-Env`. Ensure the PR Env isn't created.",oreonl,2024-07-30 20:39:24+00:00,['oreonl'],2024-10-08 16:19:14+00:00,2024-07-30 21:23:49+00:00,https://github.com/metabase/metabase/pull/46301,"[('.CI & Tests', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.DX', 'Developer experience and QoL related.'), ('.Team/DevEx', '')]",[],
2438588725,pull_request,closed,,docs - correct tar command,Updates `tar` command. `tar` expects a name for the file (`<archive-filename>`).,jeff-bruemmer,2024-07-30 20:04:50+00:00,['jeff-bruemmer'],2024-07-31 11:59:31+00:00,2024-07-31 11:56:52+00:00,https://github.com/metabase/metabase/pull/46299,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2438571969,pull_request,closed,,Add product categories to release notes,"## Changes

This PR updates:

- Release notes script to bucket issues into product category based on product area labels.
- Release notes copy.
- Tests for release notes script.

## Release notes as generated by current master branch

Issues are NOT grouped by product category.

```
**Upgrading**
    
    You can download a .jar of the release, or get the latest on Docker. Make sure to back up your Metabase
    database before you upgrade! Need help? Check out our [upgrading instructions](https://metabase.com/docs/latest/operations-guide/upgrading-metabase.html).
    
    Docker image: [`metabase/metabase:v0.2.3`](https://hub.docker.com/r/metabase/metabase/tags)
    Download the JAR here: https://downloads.metabase.com/v0.2.3/metabase.jar
    
    **Notes**
    
    SHA-256 checksum for the v0.2.3 JAR:
    
    ```
    1234567890abcdef
    ```
    
    <details>
    <summary><h2>Changelog</h2></summary>
    
    **Enhancements**
    
    - Feature Issue (#2)
    
    **Bug fixes**
    
    - Bug Issue (#1)
    
    **Already Fixed**
    
    Issues that we have recently confirmed to have been fixed at some point in the past.
    
    - Issue Already Fixed (#3)
    
    **Under the Hood**
    
    - Issue That Users Don't Care About (#4)
    
    </details>
```
## Release notes as generated by this PR

Issues ARE grouped by product category (within each type of issue: Enhancement, Bug fix, etc).

```
## Upgrading
    
    > Before you upgrade, back up your Metabase application database!
    
    Check out our [upgrading instructions](https://metabase.com/docs/latest/operations-guide/upgrading-metabase).
    
    Docker image: [`metabase/metabase:v0.2.3`](https://hub.docker.com/r/metabase/metabase/tags)
    Download the JAR here: https://downloads.metabase.com/v0.2.3/metabase.jar
    
    ## Notes
    
    SHA-256 checksum for the v0.2.3 JAR:
    
    ```
    1234567890abcdef
    ```
    
    <details>
    <summary><h2>Changelog</h2></summary>
    
    ### Enhancements
    
    **Querying**
    
    - Feature Issue (#2)
    
    **Reporting**
    
    - Another feature issue (#5)
    
    ### Bug fixes
    
    **Embedding**
    
    - Bug Issue (#1)
    
    **Other**
    
    - A bug fix that lacks a category label (#6)
    
    ### Already Fixed
    
    Issues confirmed to have been fixed in a previous release.
    
    **Embedding**
    
    - Issue Already Fixed (#3)
    
    ### Under the Hood
    
    **Administration**
    
    - Issue That Users Don't Care About (#4)
    
    </details>
```",jeff-bruemmer,2024-07-30 19:54:38+00:00,"['jeff-bruemmer', 'iethree']",2024-10-08 16:18:37+00:00,2024-08-06 21:49:06+00:00,https://github.com/metabase/metabase/pull/46298,"[('.Building & Releasing', ''), ('no-backport', 'Do not backport this PR to any branch')]",[],
2438557828,pull_request,closed,,"🤖 backported ""Show error when geojson coordinates are outside lat/lng bounds""",#46064,github-automation-metabase,2024-07-30 19:45:37+00:00,"['npfitz', 'github-automation-metabase']",2024-07-30 20:12:23+00:00,2024-07-30 20:12:22+00:00,https://github.com/metabase/metabase/pull/46296,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2438548095,pull_request,closed,,Add product categories to release notes,WIP,jeff-bruemmer,2024-07-30 19:40:07+00:00,['jeff-bruemmer'],2024-07-30 19:55:11+00:00,2024-07-30 19:55:11+00:00,https://github.com/metabase/metabase/pull/46295,[],[],
2438547258,pull_request,closed,,don't run pr envs on external,"### Description

Stops PR Env creation on external PRs. If the PR has the label `External` then PR Env will not be created.

### How to verify
Create a PR with the label `External`. Add the label `PR-Env`. Ensure the PR Env isn't created.
",oreonl,2024-07-30 19:39:42+00:00,['oreonl'],2024-07-30 20:38:12+00:00,2024-07-30 20:38:12+00:00,https://github.com/metabase/metabase/pull/46294,"[('.CI & Tests', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.DX', 'Developer experience and QoL related.'), ('.Team/DevEx', '')]",[],
2438498516,pull_request,closed,,fix(webapp): Fix collection path overlap issues,"Closes #43568 - there are screenshots in that issue showing the broken behavior on `master`

Gif:
![Kapture 2024-07-30 at 15.13.57.gif](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/utGnP2ljFMMNOgi82vVn/881f53d3-188e-4ada-b683-e7d4a3b8cd0f.gif)

I haven't written tests for this because I think the ROI for that is not high enough. Reviewers, feel free to push back on this.",rafpaf,2024-07-30 19:08:46+00:00,['rafpaf'],2024-08-06 15:15:47+00:00,2024-08-06 15:15:47+00:00,https://github.com/metabase/metabase/pull/46293,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2259027075, 'issue_id': 2438498516, 'author': 'rafpaf', 'body': '> [!WARNING]\n> <b>This pull request is not mergeable via GitHub because a downstack PR is open. Once all requirements are satisfied, merge this PR as a stack <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46293?utm_source=stack-comment-downstack-mergeability-warning"" >on Graphite</a>.</b>\n> <a href=""https://graphite.dev/docs/merge-pull-requests"">Learn more</a>\n\n* **#46293** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46293?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* **#46287** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46287?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 30, 19, 9, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2269846180, 'issue_id': 2438498516, 'author': 'iethree', 'body': ""I think you've got a bad rebase going on \r\n\r\n![Screen Shot 2024-08-05 at 2 18 41 PM](https://github.com/user-attachments/assets/3d868934-21ab-407c-90dd-9387abd60100)"", 'created_at': datetime.datetime(2024, 8, 5, 20, 19, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2271543562, 'issue_id': 2438498516, 'author': 'rafpaf', 'body': 'Will fix this downstream of the new collection path PR, #46530', 'created_at': datetime.datetime(2024, 8, 6, 15, 15, 45, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-07-30 19:09:06 UTC): * **#46293** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46293?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* **#46287** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46287?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

iethree on (2024-08-05 20:19:08 UTC): I think you've got a bad rebase going on 

![Screen Shot 2024-08-05 at 2 18 41 PM](https://github.com/user-attachments/assets/3d868934-21ab-407c-90dd-9387abd60100)

rafpaf (Issue Creator) on (2024-08-06 15:15:45 UTC): Will fix this downstream of the new collection path PR, #46530

"
2438467459,pull_request,closed,,Migration: collection.is_excluded_from_autocleanup,A migration to add the `collection.is_excluded_from_autocleanup` flag.,johnswanson,2024-07-30 18:49:13+00:00,['johnswanson'],2025-02-04 15:10:16+00:00,2025-02-04 01:31:41+00:00,https://github.com/metabase/metabase/pull/46291,"[('Stale', 'Stale PRs that will be auto-closed'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2603450142, 'issue_id': 2438467459, 'author': 'github-actions[bot]', 'body': 'This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.', 'created_at': datetime.datetime(2025, 1, 21, 1, 31, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2632557955, 'issue_id': 2438467459, 'author': 'github-actions[bot]', 'body': 'This pull request was closed because it had no activity for more than 90 days.', 'created_at': datetime.datetime(2025, 2, 4, 1, 31, 40, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-01-21 01:31:33 UTC): This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.

github-actions[bot] on (2025-02-04 01:31:40 UTC): This pull request was closed because it had no activity for more than 90 days.

"
2438413486,pull_request,closed,,fix db connection form icons,"Closes https://github.com/metabase/metabase/issues/46088

### Description

Fixes icons and tooltips in database connection forms. Also [deduplicates the double icon/tooltip situation](https://metaboat.slack.com/archives/C064EB1UE5P/p1722361463738979).

Before | After
--- | ---
![Screen Shot 2024-07-30 at 12 14 37 PM](https://github.com/user-attachments/assets/ec33a701-9a14-4437-b98f-742f351d4bb3) | ![Screen Shot 2024-07-30 at 12 13 58 PM](https://github.com/user-attachments/assets/a4daeb24-10dd-4ebd-8d69-14d1ac0b5393)


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-07-30 18:15:24+00:00,['iethree'],2024-08-01 18:22:19+00:00,2024-08-01 18:22:18+00:00,https://github.com/metabase/metabase/pull/46290,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2438371842,pull_request,closed,,45003 entity picker recents context,"Closes https://github.com/metabase/metabase/issues/45003

### Description
PR changes the request that the data picker makes to fetch recents, but also moves the selection logging to the individual pickers so that it works for both picker modals with and without confirmation buttons.

### How to verify
1. New question -> Sample Dataset -> Pick a table
2. Re-open the data picker, and you should see the table you just picked in the recents tab of the data picker

### Demo
![chrome_LfFKEElMXW](https://github.com/user-attachments/assets/08224b42-0426-483c-ac6c-c306e0331595)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",npfitz,2024-07-30 17:51:10+00:00,['npfitz'],2024-08-08 14:57:14+00:00,2024-08-08 14:57:11+00:00,https://github.com/metabase/metabase/pull/46289,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2261146420, 'issue_id': 2438371842, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 9eea034bb207df77f7040fb15d83ad7b55d4b1f8...307eb7d39b4c811405a4881d43f7d324716ad3c4.\n\n| Notify | File(s) |\n|-|-|\n| @ranquild | frontend/src/metabase/timelines/common/components/MoveTimelineModal/MoveTimelineModal.tsx |', 'created_at': datetime.datetime(2024, 7, 31, 18, 22, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2261537050, 'issue_id': 2438371842, 'author': 'iethree', 'body': ""One more thing, it looks like this isn't working for questions and models\r\n\r\nhttps://www.loom.com/share/74b369c3280a42d3929faf110d5381fc\r\n\r\nSeems that your new handleOnChange functions aren't called for non-confirm-button selections in those pickers. I think we need to conditionally log in `handleItemSelect` if the item is a question or a model"", 'created_at': datetime.datetime(2024, 7, 31, 22, 4, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2271621669, 'issue_id': 2438371842, 'author': 'iethree', 'body': 'this looks good, but I think this is blocked by the backend [model/dataset mixup](https://metaboat.slack.com/archives/C064EB1UE5P/p1722519098893339) 🥴', 'created_at': datetime.datetime(2024, 8, 6, 15, 53, 38, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-31 18:22:53 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 9eea034bb207df77f7040fb15d83ad7b55d4b1f8...307eb7d39b4c811405a4881d43f7d324716ad3c4.

| Notify | File(s) |
|-|-|
| @ranquild | frontend/src/metabase/timelines/common/components/MoveTimelineModal/MoveTimelineModal.tsx |

iethree on (2024-07-31 22:04:24 UTC): One more thing, it looks like this isn't working for questions and models

https://www.loom.com/share/74b369c3280a42d3929faf110d5381fc

Seems that your new handleOnChange functions aren't called for non-confirm-button selections in those pickers. I think we need to conditionally log in `handleItemSelect` if the item is a question or a model

iethree on (2024-08-06 15:53:38 UTC): this looks good, but I think this is blocked by the backend [model/dataset mixup](https://metaboat.slack.com/archives/C064EB1UE5P/p1722519098893339) 🥴

"
2438343979,pull_request,closed,,"fix low contrast on night theme embed frame ""Export as pdf""","# Description

- updates the color of the export button to use the brand color (see the loki screenshots for the diff)
- updates the tabs color in night mode (see the screenshots [attached here](https://github.com/metabase/metabase/pull/46288/files#r1699972834) for the diff

The second change is technically changing some code used also in internal, but the end result should be the same


Slack thread: https://metaboat.slack.com/archives/C063Q3F1HPF/p1721235904328959",npretto,2024-07-30 17:35:17+00:00,['npretto'],2024-10-08 16:18:58+00:00,2024-08-02 12:56:15+00:00,https://github.com/metabase/metabase/pull/46288,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2438310431,pull_request,closed,,fix(webapp): Move collection path component into `common/` for future re-use in Admin / Performance,"![image.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/utGnP2ljFMMNOgi82vVn/76b478b9-ae90-4f77-bc37-36939215ae96.png)

On master, ellipsified collection paths are needed only in **Browse models**, so the components that support paths like that were stored alongside the **Browse models** code. In a downstream branch, these ellipsified paths will be needed in **Admin / Performance / Dashboard and question caching**. In this PR, the components and related utilities and types have been moved into higher-level folders, like `/frontend/src/metabase/common/`. This way, the Admin / Performance components do not need to import anything from `/frontend/src/metabase/browse/`.",rafpaf,2024-07-30 17:14:17+00:00,['rafpaf'],2024-08-06 15:07:30+00:00,2024-08-06 15:07:30+00:00,https://github.com/metabase/metabase/pull/46287,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2258832402, 'issue_id': 2438310431, 'author': 'rafpaf', 'body': '* **#46293** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46293?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46287** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46287?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 30, 17, 14, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2259118332, 'issue_id': 2438310431, 'author': 'graphite-app[bot]', 'body': '### Graphite Automations\n<details><summary><a href=""https://app.graphite.dev/automations/?org=metabase&ruleId=Yrh2LAyyUc6276rpQngn&ref=gt-automation-github-comment"">""Warn authors when publishing large PRs""</a> took an action on this PR • (07/30/24)</summary><p>1 teammate was notified to this PR based on Raphael Krut-Landau\'s automation.</p></details>', 'created_at': datetime.datetime(2024, 7, 30, 20, 5, 11, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-07-30 17:14:26 UTC): * **#46293** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46293?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46287** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46287?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

graphite-app[bot] on (2024-07-30 20:05:11 UTC): ### Graphite Automations
<details><summary><a href=""https://app.graphite.dev/automations/?org=metabase&ruleId=Yrh2LAyyUc6276rpQngn&ref=gt-automation-github-comment"">""Warn authors when publishing large PRs""</a> took an action on this PR • (07/30/24)</summary><p>1 teammate was notified to this PR based on Raphael Krut-Landau's automation.</p></details>

"
2438299302,pull_request,closed,,Quick Followup to Pull #45691,"Since I set auto-merge to #45691, I missed some bits of review feedback. Luckily, nothing was blocking, so these are small readability/docs changes",adam-james-v,2024-07-30 17:07:42+00:00,['adam-james-v'],2024-07-31 17:20:53+00:00,2024-07-31 15:56:15+00:00,https://github.com/metabase/metabase/pull/46286,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2438270706,pull_request,closed,,"backport ""fix: populate param-fields for named fields on public dashboards"" to 49",Backports https://github.com/metabase/metabase/pull/44452,ranquild,2024-07-30 16:50:12+00:00,['ranquild'],2024-07-30 18:40:42+00:00,2024-07-30 17:39:04+00:00,https://github.com/metabase/metabase/pull/46285,"[('.Team/Querying', ''), ('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2258811776, 'issue_id': 2438270706, 'author': 'replay-io[bot]', 'body': '<h3></h3>\n<table>\n  <tbody>\n    <tr>\n      <td><b>Status</b></td>\n      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=e5623cea-f3c6-4d38-981a-b166320c2a6e"" target=""_blank"">Complete ↗︎</a></td>\n    </tr>\n    <tr>\n      <td><b>Commit</b></td>\n      <td>cb17bd2983122ac80001db823d7576cc79943b09</td>\n    </tr>\n    <tr>\n      <td valign=""top""><b>Results</b></td>\n      <td><div>❌ <b>2 Failed</b></div>\n<div>⚠️ <b>4 Flaky</b></div>\n<div>✅ <b>2376 Passed</b></div>\n</td>\n    </tr>\n  </tbody>\n</table>', 'created_at': datetime.datetime(2024, 7, 30, 17, 3, 6, tzinfo=datetime.timezone.utc)}]","replay-io[bot] on (2024-07-30 17:03:06 UTC): <h3></h3>
<table>
  <tbody>
    <tr>
      <td><b>Status</b></td>
      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=e5623cea-f3c6-4d38-981a-b166320c2a6e"" target=""_blank"">Complete ↗︎</a></td>
    </tr>
    <tr>
      <td><b>Commit</b></td>
      <td>cb17bd2983122ac80001db823d7576cc79943b09</td>
    </tr>
    <tr>
      <td valign=""top""><b>Results</b></td>
      <td><div>❌ <b>2 Failed</b></div>
<div>⚠️ <b>4 Flaky</b></div>
<div>✅ <b>2376 Passed</b></div>
</td>
    </tr>
  </tbody>
</table>

"
2438258655,pull_request,closed,,Filter popover dark theme part 2,"Part of #45723 
### Description
This PR styles all date filters
- All options
- Month and Year
- Single date
- Date range
- Relative date

### How to verify

Create a dashboard and add all the above date filters, and link them to a field.

### Demo
See the loki snapshots, and before/after comparison in inline comments.

### Checklist
- [x] Tests have been added/updated to cover changes in this PR (Loki snapshots)",WiNloSt,2024-07-30 16:42:49+00:00,[],2024-08-01 09:07:52+00:00,2024-08-01 09:07:50+00:00,https://github.com/metabase/metabase/pull/46284,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2261043195, 'issue_id': 2438258655, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff d8ceb5b5e9d37aa9712bfd028ec7611073ef0fad...c7845f011be653fb50cd668f42470be6121aab05.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/inputs/MultiSelect/MultiSelect.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/Select.styled.tsx |', 'created_at': datetime.datetime(2024, 7, 31, 17, 46, 50, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-31 17:46:50 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff d8ceb5b5e9d37aa9712bfd028ec7611073ef0fad...c7845f011be653fb50cd668f42470be6121aab05.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/inputs/MultiSelect/MultiSelect.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Select/Select.styled.tsx |

"
2438236379,pull_request,closed,,Clean up query modifier for validating card references,"### Description

This cleans up the code that modifies the cards for validation query, to lean on existing helpers.",crisptrutski,2024-07-30 16:31:24+00:00,['crisptrutski'],2024-07-30 20:01:19+00:00,2024-07-30 20:01:17+00:00,https://github.com/metabase/metabase/pull/46283,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2258754952, 'issue_id': 2438236379, 'author': 'crisptrutski', 'body': '> [!WARNING]\n> <b>This pull request is not mergeable via GitHub because a downstack PR is open. Once all requirements are satisfied, merge this PR as a stack <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46283?utm_source=stack-comment-downstack-mergeability-warning"" >on Graphite</a>.</b>\n> <a href=""https://graphite.dev/docs/merge-pull-requests"">Learn more</a>\n\n* **#46283** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46283?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* **#46185** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46185?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46143** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46143?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46128** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46128?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46101** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46101?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 30, 16, 31, 43, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-07-30 16:31:43 UTC): * **#46283** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46283?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* **#46185** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46185?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46143** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46143?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46128** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46128?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46101** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46101?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2438233684,pull_request,closed,,"🤖 backported ""Pass parameter values as JSON""","  #46250
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-30 16:30:29+00:00,"['ranquild', 'github-automation-metabase']",2024-07-30 17:42:20+00:00,2024-07-30 17:42:19+00:00,https://github.com/metabase/metabase/pull/46282,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2438191333,pull_request,closed,,ci: enable video recordings for failing cypress tests,"Closes https://github.com/metabase/metabase/issues/46492

### Description

Enable cypress video recordings for failing tests only. Cypress doesn't allow to record video only for the failing test, os their official solution is to record everything and then remove everything you don't need 🤯 

video recording works only in ""run"" mode, `cypress open` records nothing

### How to verify

- change any spec to fail (e.g. `node ./e2e/runner/run_cypress_tests.js --spec e2e/test/scenarios/dashboard/dashboard-back-navigation.cy.spec.js` and change something, so test fails - add `.only` to the test you've changed)
- run it locally in ""run"" mode (e.g. `node ./e2e/runner/run_cypress_tests.js --spec e2e/test/scenarios/dashboard/dashboard-back-navigation.cy.spec.js`), make sure spec failed
- open mocha report (e.g. `open cypress/reports/mochareports/fail-dashboard-back-navigation.html`) and check if the video for your failed spec is available in the bottom of the page and it's playable
- verify that `cypress/videos` contains video of the failed spec only
<img width=""680"" alt=""image"" src=""https://github.com/user-attachments/assets/0a4977db-0960-4b84-84a4-d455f20d5f7f"">



### Demo

<img width=""1254"" alt=""image"" src=""https://github.com/user-attachments/assets/d643e83b-15e7-4626-b1c6-17947322c927"">",uladzimirdev,2024-07-30 16:06:54+00:00,['uladzimirdev'],2024-08-05 21:32:05+00:00,2024-08-05 21:32:03+00:00,https://github.com/metabase/metabase/pull/46281,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]",[],
2438183584,pull_request,closed,,[manual backport] Handle double-quotes in table and schema name in privileges query (#46268),This PR manually backports https://github.com/metabase/metabase/pull/46268 to 49,calherries,2024-07-30 16:02:46+00:00,['calherries'],2024-07-30 21:18:44+00:00,2024-07-30 21:18:18+00:00,https://github.com/metabase/metabase/pull/46280,"[('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2258721681, 'issue_id': 2438183584, 'author': 'replay-io[bot]', 'body': '<h3></h3>\n<table>\n  <tbody>\n    <tr>\n      <td><b>Status</b></td>\n      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=6283ee79-d902-499b-bba4-4959dcb9eda8"" target=""_blank"">Complete ↗︎</a></td>\n    </tr>\n    <tr>\n      <td><b>Commit</b></td>\n      <td>a337c98fd749e2bcf3ecbcd4164a1daa5fb1f7ac</td>\n    </tr>\n    <tr>\n      <td valign=""top""><b>Results</b></td>\n      <td><div>⚠️ <b>4 Flaky</b></div>\n<div>✅ <b>2376 Passed</b></div>\n</td>\n    </tr>\n  </tbody>\n</table>', 'created_at': datetime.datetime(2024, 7, 30, 16, 14, 29, tzinfo=datetime.timezone.utc)}]","replay-io[bot] on (2024-07-30 16:14:29 UTC): <h3></h3>
<table>
  <tbody>
    <tr>
      <td><b>Status</b></td>
      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=6283ee79-d902-499b-bba4-4959dcb9eda8"" target=""_blank"">Complete ↗︎</a></td>
    </tr>
    <tr>
      <td><b>Commit</b></td>
      <td>a337c98fd749e2bcf3ecbcd4164a1daa5fb1f7ac</td>
    </tr>
    <tr>
      <td valign=""top""><b>Results</b></td>
      <td><div>⚠️ <b>4 Flaky</b></div>
<div>✅ <b>2376 Passed</b></div>
</td>
    </tr>
  </tbody>
</table>

"
2438171266,pull_request,closed,,dx: drop eslint-loader,"[context](https://metaboat.slack.com/archives/C505ZNNH4/p1721633811130359)

TL;DR seems nobody uses it",uladzimirdev,2024-07-30 15:56:18+00:00,['uladzimirdev'],2024-10-08 16:19:13+00:00,2024-07-31 13:11:06+00:00,https://github.com/metabase/metabase/pull/46279,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]",[],
2438131791,pull_request,closed,,"🤖 backported ""do not run licenses step only when the value is true""",#46272,github-automation-metabase,2024-07-30 15:35:47+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-07-30 16:45:03+00:00,2024-07-30 16:45:02+00:00,https://github.com/metabase/metabase/pull/46278,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2438103924,pull_request,closed,,make search results filterable by concrete ids,"Cache admin needs an API where it can retrieve instances identified by ids. Our collection endpoint is not suitable since those items can be from different collections. Adding more data to cache API feels like too much code is necessary. So search seems like the best API for this.

I've also thought about adding kind of like nested-query-string API (so `ids=urlencoded(card=9&dashboard=10)`), but maybe that's adding too much complexity given that one page will generate only two queries max (one for cards and one for dashboards).

Also fixes a bug with cache listing where not supplying collection id would filter only for root collection.",piranha,2024-07-30 15:21:48+00:00,['piranha'],2024-08-01 07:50:58+00:00,2024-07-31 11:54:07+00:00,https://github.com/metabase/metabase/pull/46276,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2258832380, 'issue_id': 2438103924, 'author': 'rafpaf', 'body': '* **#42990** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/42990?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46276** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46276?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @piranha and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 30, 17, 14, 25, tzinfo=datetime.timezone.utc)}]","rafpaf on (2024-07-30 17:14:25 UTC): * **#42990** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/42990?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46276** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46276?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @piranha and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2438082707,pull_request,closed,,"🤖 backported ""Allow double-quotes in table and schema name in postgres sync""",#46268,github-automation-metabase,2024-07-30 15:11:44+00:00,"['calherries', 'github-automation-metabase']",2024-07-30 20:39:06+00:00,2024-07-30 20:39:06+00:00,https://github.com/metabase/metabase/pull/46274,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2438031320,pull_request,closed,,do not run licenses step only when the value is true,we need to explicitly compare env variable with `true` as false it treated as positive value,uladzimirdev,2024-07-30 14:48:08+00:00,['uladzimirdev'],2024-07-30 16:45:32+00:00,2024-07-30 15:35:00+00:00,https://github.com/metabase/metabase/pull/46272,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]",[],
2437943302,pull_request,closed,,"🤖 backported ""ci: Fix E2E flake for the reproduction #21559""",#46269,github-automation-metabase,2024-07-30 14:10:54+00:00,"['nemanjaglumac', 'github-automation-metabase']",2024-07-30 14:37:13+00:00,2024-07-30 14:37:12+00:00,https://github.com/metabase/metabase/pull/46271,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2437862669,pull_request,closed,,"🤖 backported ""fix(webapp/sidenav): Fix bookmark reordering""","  #45632
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-30 13:35:52+00:00,"['rafpaf', 'github-automation-metabase']",2024-07-30 14:54:35+00:00,2024-07-30 14:54:34+00:00,https://github.com/metabase/metabase/pull/46270,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2437848940,pull_request,closed,,ci: Fix E2E flake for the reproduction #21559,"### What does this PR accomplish?
It fixes a flaky reproduction for #21559 by waiting for the dashboard to re-render.
It removes the flaky tag from this test.

### Example of a failure
https://github.com/metabase/metabase/actions/runs/10154937318/job/28081553208#step:12:399
![issue 21559 -- should respect dashboard card visualization (metabase#21559) (failed) (attempt 2)](https://github.com/user-attachments/assets/9982601b-3d96-4127-b67f-8673a18d3e42)

### Explanation
We can see from this screenshot that Cypress already clicked on the ""subscriptions"" icon, but the sidebar never opened. I am pretty convinced that this is due to the dashboard re-rendering after we hide ""Edited a few seconds ago..."" text below the dashboard title. In fact, this is the culprit behind many dashboard flakes.

### Solution
Wait until that ""history text"" disappears and only then try to click on elements. This might make this test one second slower, but it improves its resiliency.

### Additional Notes
This PR also improves some assertions by scoping them to the correct selectors.
And it also replaces deprecated Cypress custom commands with equivalent functional helpers.

### Stress-test
| burn ins| status | run |
|-|-|-|
| 10/10 | ✅ | https://github.com/metabase/metabase/actions/runs/10163092286 |
|100/100 | ✅ | https://github.com/metabase/metabase/actions/runs/10163186508|",nemanjaglumac,2024-07-30 13:29:44+00:00,['nemanjaglumac'],2024-07-30 14:37:40+00:00,2024-07-30 14:10:08+00:00,https://github.com/metabase/metabase/pull/46269,"[('.CI & Tests', ''), ('backport', 'Automatically create PR on current release branch on merge'), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2437846176,pull_request,closed,,Allow double-quotes in table and schema name in postgres sync,"Resolves https://github.com/metabase/metabase/issues/46265

This PR fixes a bug in the query that gets executed in the postgres implementation of `metabase.driver.sql-jdbc.sync.interface/current-user-table-privileges`. The query is executed during sync.

The problem is the query cannot handle double-quotes in either a schema or table name. `pg_catalog.has_any_column_privilege` and `pg_catalog.has_table_privilege` require that the table identifier has double-quotes escaped if the identifier is surrounded by double quotes.

This PR must be backported to 49.",calherries,2024-07-30 13:28:30+00:00,['calherries'],2024-07-30 15:59:11+00:00,2024-07-30 15:10:57+00:00,https://github.com/metabase/metabase/pull/46268,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2258689683, 'issue_id': 2437846176, 'author': 'calherries', 'body': '@metabase-bot backport release-x.49.x', 'created_at': datetime.datetime(2024, 7, 30, 15, 58, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2258691622, 'issue_id': 2437846176, 'author': 'github-actions[bot]', 'body': '@calherries something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10165719882)', 'created_at': datetime.datetime(2024, 7, 30, 15, 59, 9, tzinfo=datetime.timezone.utc)}]","calherries (Issue Creator) on (2024-07-30 15:58:08 UTC): @metabase-bot backport release-x.49.x

github-actions[bot] on (2024-07-30 15:59:09 UTC): @calherries something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10165719882)

"
2437789277,pull_request,closed,,Disable Validation API if Analysis is disabled,"### Description

The query validation tool will not behave correctly if query analysis is disabled.

This PR gates the API behind that feature, and makes it visible to admins.

Thread here: https://metaboat.slack.com/archives/C06V3JMECH2/p1721809657496249",crisptrutski,2024-07-30 13:01:59+00:00,['crisptrutski'],2024-10-08 16:18:19+00:00,2024-08-08 12:09:26+00:00,https://github.com/metabase/metabase/pull/46266,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2273163509, 'issue_id': 2437789277, 'author': 'crisptrutski', 'body': '@tsmacdonald Yes, thread [here](https://metaboat.slack.com/archives/C06V3JMECH2/p1721809657496249)\r\n\r\nAdded him as  reviewer here also, to comment on response code etc', 'created_at': datetime.datetime(2024, 8, 7, 10, 38, 36, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-08-07 10:38:36 UTC): @tsmacdonald Yes, thread [here](https://metaboat.slack.com/archives/C06V3JMECH2/p1721809657496249)

Added him as  reviewer here also, to comment on response code etc

"
2437294187,pull_request,closed,,Avoid adding temporal-unit to lhs cols,"Closes https://github.com/metabase/metabase/issues/21133

### Description

This PR enables use of indexes in native query's `FieldFilter` expansions. That is achieved by removing LHS casts from temporal types.

For `:type/Date` columns nothing special is required -- original logic generates dates and uses sql's _between_ for matching.

For `:type/DateTime` columns ranges are generated that are used in _gte lt_ matching expression.

It might make sense to unify the _between_ vs _gte lt_ in the future to rather make things simpler. (If there is any reason against it please let me know in the review.)
",lbrdnk,2024-07-30 08:58:25+00:00,['lbrdnk'],2024-08-01 18:16:39+00:00,2024-08-01 18:16:37+00:00,https://github.com/metabase/metabase/pull/46262,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2437075074,pull_request,closed,,Bump athena dependencies,Running CI for external contribution #46229,piranha,2024-07-30 07:08:06+00:00,['piranha'],2025-02-05 11:40:06+00:00,2024-07-30 08:34:30+00:00,https://github.com/metabase/metabase/pull/46261,"[('do not merge', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2436971517,pull_request,closed,,"🤖 backported ""build: disable licenses generation for e2e tests""",#46225,github-automation-metabase,2024-07-30 06:03:30+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-07-30 11:23:06+00:00,2024-07-30 11:23:05+00:00,https://github.com/metabase/metabase/pull/46260,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2436620130,pull_request,closed,,"🤖 backported ""Indicate in-progress exports""","  #45697
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-30 00:02:36+00:00,"['alxnddr', 'github-automation-metabase']",2024-07-31 00:13:44+00:00,2024-07-31 00:13:44+00:00,https://github.com/metabase/metabase/pull/46257,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2258662567, 'issue_id': 2436620130, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff c323ffc90972e7f04c020c19d561e0d1edf61efb...872848a8b0794ca719b6409fc1aa1f39b27dc1a5.\n\n| Notify | File(s) |\n|-|-|\n| @ranquild | frontend/src/metabase/status/components/DatabaseStatusSmall/DatabaseStatusSmall.tsx<br>frontend/src/metabase/status/components/DownloadsStatus/DownloadsStatus.tsx<br>frontend/src/metabase/status/components/DownloadsStatus/DownloadsStatus.unit.spec.tsx<br>frontend/src/metabase/status/components/DownloadsStatus/index.ts<br>frontend/src/metabase/status/components/DownloadsStatusLarge/DownloadsStatusLarge.stories.tsx<br>frontend/src/metabase/status/components/DownloadsStatusLarge/DownloadsStatusLarge.tsx<br>frontend/src/metabase/status/components/DownloadsStatusLarge/index.ts<br>frontend/src/metabase/status/components/DownloadsStatusSmall/DownloadsStatusSmall.tsx<br>frontend/src/metabase/status/components/DownloadsStatusSmall/index.ts<br>frontend/src/metabase/status/components/PublicStatusListing/PublicStatusListing.styled.tsx<br>frontend/src/metabase/status/components/PublicStatusListing/PublicStatusListing.tsx<br>frontend/src/metabase/status/components/PublicStatusListing/index.ts<br>frontend/src/metabase/status/components/StatusLarge/StatusLarge.tsx<br>frontend/src/metabase/status/components/StatusListing/StatusListing.tsx<br>frontend/src/metabase/status/components/StatusListing/StatusListing.unit.spec.tsx<br>frontend/src/metabase/status/components/utils/downloads.ts<br>frontend/src/metabase/status/components/utils/status.ts<br>frontend/src/metabase/status/hooks/use-check-active-downloads-before-unload.ts<br>frontend/src/metabase/status/hooks/use-status-visibility.ts |', 'created_at': datetime.datetime(2024, 7, 30, 15, 44, 12, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-30 15:44:12 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff c323ffc90972e7f04c020c19d561e0d1edf61efb...872848a8b0794ca719b6409fc1aa1f39b27dc1a5.

| Notify | File(s) |
|-|-|
| @ranquild | frontend/src/metabase/status/components/DatabaseStatusSmall/DatabaseStatusSmall.tsx<br>frontend/src/metabase/status/components/DownloadsStatus/DownloadsStatus.tsx<br>frontend/src/metabase/status/components/DownloadsStatus/DownloadsStatus.unit.spec.tsx<br>frontend/src/metabase/status/components/DownloadsStatus/index.ts<br>frontend/src/metabase/status/components/DownloadsStatusLarge/DownloadsStatusLarge.stories.tsx<br>frontend/src/metabase/status/components/DownloadsStatusLarge/DownloadsStatusLarge.tsx<br>frontend/src/metabase/status/components/DownloadsStatusLarge/index.ts<br>frontend/src/metabase/status/components/DownloadsStatusSmall/DownloadsStatusSmall.tsx<br>frontend/src/metabase/status/components/DownloadsStatusSmall/index.ts<br>frontend/src/metabase/status/components/PublicStatusListing/PublicStatusListing.styled.tsx<br>frontend/src/metabase/status/components/PublicStatusListing/PublicStatusListing.tsx<br>frontend/src/metabase/status/components/PublicStatusListing/index.ts<br>frontend/src/metabase/status/components/StatusLarge/StatusLarge.tsx<br>frontend/src/metabase/status/components/StatusListing/StatusListing.tsx<br>frontend/src/metabase/status/components/StatusListing/StatusListing.unit.spec.tsx<br>frontend/src/metabase/status/components/utils/downloads.ts<br>frontend/src/metabase/status/components/utils/status.ts<br>frontend/src/metabase/status/hooks/use-check-active-downloads-before-unload.ts<br>frontend/src/metabase/status/hooks/use-status-visibility.ts |

"
2436599363,pull_request,closed,,feat(sdk): Add edit mode for interactive dashboard component,"Closes https://github.com/metabase/metabase/issues/46160

### Description

This adds EditableDashboard component - editable version of InteractiveDashboard.

#### TODO:
- ✅ Fix theming for editable dashboard.
- Add tests (unit + e2e)
- ✅ check dashboard `onLoad` handlers
- ✅ Check which embedding params we have to support in edit mode.
- ✅ Add SDK storybook setup instructions - added in a separate PR

#### Split into separate tasks:
- Handle z-index configuration for legacy modals (or migrate old dashboard modals to mantine)

### How to verify

Run embedding storybook
Check EditableDashboard story

### Demo

_Upload a demo video or before/after screenshots if sensible or remove the section_

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",deniskaber,2024-07-29 23:40:42+00:00,['deniskaber'],2024-08-12 13:33:37+00:00,2024-08-12 13:33:35+00:00,https://github.com/metabase/metabase/pull/46255,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', ''), ('loki-update', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2257197801, 'issue_id': 2436599363, 'author': 'github-actions[bot]', 'body': '@deniskaber You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 7, 29, 23, 41, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2273034381, 'issue_id': 2436599363, 'author': 'heypoom', 'body': '@deniskaber from testing this in Shoppy, looks like when we click on ""edit"" without a full-height parent container, the height of the dashboard will be very small. This only happens when we click on the ""edit"" button.\r\n\r\n![CleanShot 2567-08-07 at 16 27 52@2x](https://github.com/user-attachments/assets/3d6cbf8e-f367-4086-8760-36682a729c31)\r\n\r\nSetting a full height e.g. with `<Stack h=""100vh"">` parent container does the trick. I wonder if we can add a full-height container, so the user doesn\'t have to do this manually.\r\n\r\n![CleanShot 2567-08-07 at 16 29 19@2x](https://github.com/user-attachments/assets/836a6924-db54-42d5-9c4d-e619090ef8a0)', 'created_at': datetime.datetime(2024, 8, 7, 9, 30, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2274419543, 'issue_id': 2436599363, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 8dbe62736464c8ad281e56103460004f89c9e997...01300bfa74b42fa13068753bf36ad7cddcb468e4.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/visualizations/SmartScalar/SettingsComponents/ComparisonPicker.tsx |\n| @kdoh | frontend/src/metabase/ui/components/inputs/Select/SelectItem/SelectItem.tsx<br>frontend/src/metabase/ui/components/navigation/NavLink/NavLink.styled.tsx<br>frontend/src/metabase/ui/components/navigation/Tabs/Tabs.styled.tsx<br>frontend/src/metabase/ui/components/overlays/Modal/Modal.styled.tsx<br>frontend/src/metabase/ui/components/overlays/Popover/Popover.styled.tsx |\n| @ranquild | frontend/src/metabase/sharing/components/SharingSidebar/tests/setup.tsx |', 'created_at': datetime.datetime(2024, 8, 7, 21, 58, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2275194488, 'issue_id': 2436599363, 'author': 'WiNloSt', 'body': 'Opening a card viz settings modal looks weird in user apps.\r\n\r\n#### Repro\r\n1. Edit a dashboard\r\n2. Hover over a question, click edit viz settings icon\r\n\r\n![image](https://github.com/user-attachments/assets/4442ac64-3a80-4731-ae43-776b35e7e30d)', 'created_at': datetime.datetime(2024, 8, 8, 8, 0, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2275984307, 'issue_id': 2436599363, 'author': 'deniskaber', 'body': ""> Opening a card viz settings modal looks weird in user apps.\r\n> \r\n> #### Repro\r\n> 1. Edit a dashboard\r\n> 2. Hover over a question, click edit viz settings icon\r\n> \r\n> ![image](https://private-user-images.githubusercontent.com/1937582/356133987-4442ac64-3a80-4731-ae43-776b35e7e30d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MjMxMjc2NzgsIm5iZiI6MTcyMzEyNzM3OCwicGF0aCI6Ii8xOTM3NTgyLzM1NjEzMzk4Ny00NDQyYWM2NC0zYTgwLTQ3MzEtYWU0My03NzZiMzVlN2UzMGQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI0MDgwOCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNDA4MDhUMTQyOTM4WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9N2UwYTVkZDJmNWNkMTVhMzY4ODI4MmQ2ZmQxOTA4ZTFmMGQzZGVkNmYzOWViMzdhZDMwNTg1NDcwNmRiN2Q4MyZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QmYWN0b3JfaWQ9MCZrZXlfaWQ9MCZyZXBvX2lkPTAifQ.VRisikodu7SBgPgU6qRfkumBr0KiG3ovir2Aq7BAP1Y)\r\n\r\nYes, this happens because we use high z-index value for the left menu in Shoppy. We need a way to configure SDK modals z-index. Let's address this in a separate issue. We might even have a task for this already."", 'created_at': datetime.datetime(2024, 8, 8, 14, 32, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2276039307, 'issue_id': 2436599363, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@deniskaber You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 8, 14, 57, 27, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-29 23:41:06 UTC): @deniskaber You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

heypoom on (2024-08-07 09:30:24 UTC): @deniskaber from testing this in Shoppy, looks like when we click on ""edit"" without a full-height parent container, the height of the dashboard will be very small. This only happens when we click on the ""edit"" button.

![CleanShot 2567-08-07 at 16 27 52@2x](https://github.com/user-attachments/assets/3d6cbf8e-f367-4086-8760-36682a729c31)

Setting a full height e.g. with `<Stack h=""100vh"">` parent container does the trick. I wonder if we can add a full-height container, so the user doesn't have to do this manually.

![CleanShot 2567-08-07 at 16 29 19@2x](https://github.com/user-attachments/assets/836a6924-db54-42d5-9c4d-e619090ef8a0)

github-actions[bot] on (2024-08-07 21:58:23 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 8dbe62736464c8ad281e56103460004f89c9e997...01300bfa74b42fa13068753bf36ad7cddcb468e4.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/visualizations/SmartScalar/SettingsComponents/ComparisonPicker.tsx |
| @kdoh | frontend/src/metabase/ui/components/inputs/Select/SelectItem/SelectItem.tsx<br>frontend/src/metabase/ui/components/navigation/NavLink/NavLink.styled.tsx<br>frontend/src/metabase/ui/components/navigation/Tabs/Tabs.styled.tsx<br>frontend/src/metabase/ui/components/overlays/Modal/Modal.styled.tsx<br>frontend/src/metabase/ui/components/overlays/Popover/Popover.styled.tsx |
| @ranquild | frontend/src/metabase/sharing/components/SharingSidebar/tests/setup.tsx |

WiNloSt on (2024-08-08 08:00:26 UTC): Opening a card viz settings modal looks weird in user apps.

#### Repro
1. Edit a dashboard
2. Hover over a question, click edit viz settings icon

![image](https://github.com/user-attachments/assets/4442ac64-3a80-4731-ae43-776b35e7e30d)

deniskaber (Issue Creator) on (2024-08-08 14:32:46 UTC): Yes, this happens because we use high z-index value for the left menu in Shoppy. We need a way to configure SDK modals z-index. Let's address this in a separate issue. We might even have a task for this already.

github-actions[bot] on (2024-08-08 14:57:27 UTC): <!---conventional commit reminder comment ID-->
@deniskaber You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2436533638,pull_request,closed,,Automatic Nightly Patch Releases,"Closes https://github.com/metabase/metabase/issues/46231

### Description

![Screen Shot 2024-07-29 at 4 54 09 PM](https://github.com/user-attachments/assets/59c9d71e-3073-4a8f-ae95-5ea401c6a506)


**1. New workflow: Auto Patch ([sample run](https://github.com/iethree/metabase/actions/runs/10152755714))**
- runs nightly on weekdays, or can be triggered to run manually for a single version
- scheduled runs attempt to release from 2 recent release branches
- checks git tags to find the last released version on that branch and increments by one patch
- checks the commits on the branch to find the last one with green CI
- if the last green commit hasn't been released yet, it triggers the existing build job with a new `auto` flag

**2. tag-for-release workflow update** ([sample run](https://github.com/iethree/metabase/actions/runs/10152759657))
- passes through the `auto` flag 

**3. pre-release testing workflow update** ([sample run](https://github.com/iethree/metabase/actions/runs/10152782187))
  - if the `auto` flag is present, it automatically triggers the publish job upon successful completion 

**4. Publish workflow update** ([sample run](https://github.com/iethree/metabase/actions/runs/10152995787))
  - receives the new `auto` tag, and for auto-releases:
	  - does not generate release notes
	  - does not update version-info.json
	  - does not push latest tagged docker image
	  - does not trigger docs updates
	  - does not close/open any milestones
	  - has a slightly different end-of-release slack message ([example](https://metaboat.slack.com/archives/C01BWAZJE0N/p1722293519946239?thread_ts=1722292848.599809&cid=C01BWAZJE0N))


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-07-29 22:48:33+00:00,['iethree'],2024-08-01 16:35:36+00:00,2024-08-01 16:35:35+00:00,https://github.com/metabase/metabase/pull/46254,"[('.Building & Releasing', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2436503555,pull_request,closed,,Add Timeseries insights even when Custom Columns exist,"WIP

Fixes #46244

I don't know why it was (maybe still is) required that the :other columns be empty before providing insights, so need confidence that the condition can be removed before merging this

Fixes #44349

The trendline is powered by insights as well. For datasets over 20 entries (most datasets), sampling is required. A reservoir sampling approach works well, but has randomness in its implementation. We need to keep that, but memoizing the sampling function should allow the exact same sample to be used if the input dataset has not changed, which was not the case before.

Like with the other solution, I have to validate/verify that this change is ok, and that it doesn't break the entire purpose of the reservoir sampler. TBD
",adam-james-v,2024-07-29 22:31:37+00:00,['adam-james-v'],2024-08-12 17:00:36+00:00,2024-08-12 17:00:34+00:00,https://github.com/metabase/metabase/pull/46253,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2436248321,pull_request,closed,,Upgrade webpack to v5.93.0,Upgrading webpack to latest,paoliniluis,2024-07-29 20:04:17+00:00,['paoliniluis'],2024-10-08 16:19:21+00:00,2024-07-30 02:09:24+00:00,https://github.com/metabase/metabase/pull/46251,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2265333392, 'issue_id': 2436248321, 'author': 'enicolasgomez', 'body': 'LTA MAL', 'created_at': datetime.datetime(2024, 8, 2, 12, 52, 31, tzinfo=datetime.timezone.utc)}]","enicolasgomez on (2024-08-02 12:52:31 UTC): LTA MAL

"
2436220335,pull_request,closed,,Pass parameter values as JSON,"Fixes https://github.com/metabase/metabase/issues/46240

The problem was that we pass parameter values as separate query string params in embeded cards & dashboards. It looks like this `?param1=A&param2=10&param3=true`. The issue is that we cannot correctly parse these parameters on the BE since any type information was lost during the parameter values serialization. Is `10` a number or a string? Is `true` a boolean or a string? We don't know. We could do either 1) pass parameters from the FE in another way where this information is not lost OR 2) find the corresponding fields for each parameter, check their types, and convert the values correctly. The latter is difficult and could be a performance concern, so this PR implements 1).

Now parameter values are passed as `?parameters=<json>`. This is exactly the same as public dashboards work right now. To maintain backward compatibility we still accept separate parameter values if `parameters` is not present or when it cannot be parsed. I thought that breaking the API contract for `query` endpoints is not acceptable in a patch release.

How to verify:
- Enable embedding in Admin
- New -> Question -> Products -> Save as `Q1`
- New -> Dashboard -> Add `Q1` -> Add Text filter for `Product.Category` -> Set the parameter to be just `Input` -> Save
- Share -> Embed -> Static -> Enable the parameter -> Preview -> Look and feel
- Try to enter a numeric value in the parameter widget
- The query should not fail. There should be no results.
- We have e2e tests that check embedded cards & dashboards and downloads in them.",ranquild,2024-07-29 19:48:42+00:00,['ranquild'],2024-10-25 17:12:26+00:00,2024-07-30 16:29:43+00:00,https://github.com/metabase/metabase/pull/46250,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2258711300, 'issue_id': 2436220335, 'author': 'nemanjaglumac', 'body': 'Tried everything I could think of in this scenario.\r\nRequired filter, default values, editable, locked, export PDF, download xlsx, csv, json...\r\n\r\nEverything works like a charm!\r\n🚀', 'created_at': datetime.datetime(2024, 7, 30, 16, 9, 2, tzinfo=datetime.timezone.utc)}]","nemanjaglumac on (2024-07-30 16:09:02 UTC): Tried everything I could think of in this scenario.
Required filter, default values, editable, locked, export PDF, download xlsx, csv, json...

Everything works like a charm!
🚀

"
2436162207,pull_request,closed,,[manual backport] Increase slack upload timeout to 20 seconds #46235,"Manually backports https://github.com/metabase/metabase/pull/46235 to 49.

",calherries,2024-07-29 19:19:00+00:00,['calherries'],2024-07-30 08:28:00+00:00,2024-07-30 08:27:31+00:00,https://github.com/metabase/metabase/pull/46248,"[('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2256739628, 'issue_id': 2436162207, 'author': 'replay-io[bot]', 'body': '<h3></h3>\n<table>\n  <tbody>\n    <tr>\n      <td><b>Status</b></td>\n      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=26706693-f118-4cf9-822e-937e276e6956"" target=""_blank"">Complete ↗︎</a></td>\n    </tr>\n    <tr>\n      <td><b>Commit</b></td>\n      <td>d246ed2b6426503823c7ec544ca3671387b24e8f</td>\n    </tr>\n    <tr>\n      <td valign=""top""><b>Results</b></td>\n      <td><div>✅ <b>2380 Passed</b></div>\n</td>\n    </tr>\n  </tbody>\n</table>', 'created_at': datetime.datetime(2024, 7, 29, 19, 30, 41, tzinfo=datetime.timezone.utc)}]","replay-io[bot] on (2024-07-29 19:30:41 UTC): <h3></h3>
<table>
  <tbody>
    <tr>
      <td><b>Status</b></td>
      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=26706693-f118-4cf9-822e-937e276e6956"" target=""_blank"">Complete ↗︎</a></td>
    </tr>
    <tr>
      <td><b>Commit</b></td>
      <td>d246ed2b6426503823c7ec544ca3671387b24e8f</td>
    </tr>
    <tr>
      <td valign=""top""><b>Results</b></td>
      <td><div>✅ <b>2380 Passed</b></div>
</td>
    </tr>
  </tbody>
</table>

"
2436130776,pull_request,closed,,TESTING no admin mode,"what if we just put admin settings in the main app?

![Screen Shot 2024-07-29 at 1 01 12 PM](https://github.com/user-attachments/assets/55c57fcc-f5a2-49bb-90a0-3c0416f3b032)
",iethree,2024-07-29 19:01:29+00:00,['iethree'],2025-02-04 16:05:07+00:00,2024-08-02 21:42:38+00:00,https://github.com/metabase/metabase/pull/46247,"[('.Team/AdminWebapp', 'Admin and Webapp team'), ('PR-Env', 'See https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458')]","[{'comment_id': 2266179703, 'issue_id': 2436130776, 'author': 'iethree', 'body': 'closing this for now, I think it served its purpose. see [discussion](https://metaboat.slack.com/archives/C064EB1UE5P/p1722284878779739?thread_ts=1721333788.215309&cid=C064EB1UE5P)', 'created_at': datetime.datetime(2024, 8, 2, 21, 42, 38, tzinfo=datetime.timezone.utc)}]","iethree (Issue Creator) on (2024-08-02 21:42:38 UTC): closing this for now, I think it served its purpose. see [discussion](https://metaboat.slack.com/archives/C064EB1UE5P/p1722284878779739?thread_ts=1721333788.215309&cid=C064EB1UE5P)

"
2436098702,pull_request,closed,,"🤖 backported ""Increase slack upload timeout to 20 seconds""",#46235,github-automation-metabase,2024-07-29 18:43:09+00:00,"['calherries', 'github-automation-metabase']",2024-07-29 19:32:18+00:00,2024-07-29 19:32:17+00:00,https://github.com/metabase/metabase/pull/46246,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2436085253,pull_request,closed,,sankey chart,"Epic https://github.com/metabase/metabase/issues/29671
Closes https://github.com/metabase/metabase/issues/29671
Closes https://github.com/metabase/metabase/issues/11888

PR with visual specs https://github.com/metabase/metabase/pull/49457

### Description

Implements a basic sankey chart.

### Demo

<video src=""https://github.com/user-attachments/assets/7991ef19-7cc4-4d75-9bdf-d50fddfb1358"" />

",alxnddr,2024-07-29 18:36:14+00:00,['alxnddr'],2024-11-22 17:52:12+00:00,2024-11-22 17:52:09+00:00,https://github.com/metabase/metabase/pull/46245,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team'), ('PR-Env', 'See https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458')]","[{'comment_id': 2349650352, 'issue_id': 2436085253, 'author': 'deepfates', 'body': 'Hi, curious when we might expect to see Sankey charts land in main. Any projections on this?', 'created_at': datetime.datetime(2024, 9, 13, 17, 48, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2375460248, 'issue_id': 2436085253, 'author': 'alxnddr', 'body': 'Hey @deepfates 👋 Unfortunately, it is unlikely we could prioritize this into the upcoming 51 release that should happen roughly in a week. We scheduled the Sankey for 52 which will get released in a couple of more months', 'created_at': datetime.datetime(2024, 9, 25, 23, 48, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2474518403, 'issue_id': 2436085253, 'author': 'trunk-io[bot]', 'body': '<!-- Trunk Test Analytics -->\n\n\n![Static Badge](https://img.shields.io/badge/8_tests-c1b2e2b5-purple) &ensp; ![Static Badge](https://img.shields.io/badge/0-failed-crimson) &ensp; ![Static Badge](https://img.shields.io/badge/8-flaky-red) &ensp; ![Static Badge](https://img.shields.io/badge/0-quarantined-yellow)\n\n\n| Flaky Test | Failure Summary | Logs |\n| --- | --- | --- |\n| <code>login-history-test</code> |  | [Logs\xa0↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment&runConclusion=FAILURE&runId=b014cce7-348b-5c12-b120-94d5b21ab0af) |\n| <code>ldap-enabled-test</code> |  | [Logs\xa0↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment&runConclusion=FAILURE&runId=3501b4a6-1864-5e5b-a1ea-4b4b36dd84e0) |\n| <code>ldap-settings-test</code> |  | [Logs\xa0↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment&runConclusion=FAILURE&runId=e1c99238-b900-5e03-be01-f31ef542c1a8) |\n| <code>google-settings-test</code> |  | [Logs\xa0↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment&runConclusion=FAILURE&runId=f705ddbe-ebd4-527e-b36b-03f03c72d837) |\n\n[... and 4 more](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment&runConclusion=FAILURE)\n<sub>\n\n[View Full Report ↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment) ⋅ [Docs](https://docs.trunk.io/flaky-tests/github-pull-request-comments?utm_source=gh-comment)\n\n</sub>', 'created_at': datetime.datetime(2024, 11, 13, 19, 18, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2492349582, 'issue_id': 2436085253, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 379cf342d3b635e942c2e44c40a5f574522c1c64...c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/index.ts<br>frontend/src/metabase/ui/components/icons/Icon/icons/sankey.svg |', 'created_at': datetime.datetime(2024, 11, 21, 21, 14, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2492363208, 'issue_id': 2436085253, 'author': 'github-actions[bot]', 'body': '👋 Deploying a preview environment for commit c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb.\n✅ Preview:\n    https://pr46245.coredev.metabase.com\n🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)\n<!-- Sticky Pull Request Comment -->', 'created_at': datetime.datetime(2024, 11, 21, 21, 22, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2493838199, 'issue_id': 2436085253, 'author': 'kdoh', 'body': ""I'm still seeing the bug where tool tips auto close after a few seconds without me moving my mouse. Running Firefox Developer (133.0b9).\r\n\r\nOther than that, things are looking solid from my run through but I think that's a core blocking bug."", 'created_at': datetime.datetime(2024, 11, 22, 14, 2, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2494000663, 'issue_id': 2436085253, 'author': 'alxnddr', 'body': ""> I'm still seeing the bug where tool tips auto close after a few seconds without me moving my mouse. Running Firefox Developer (133.0b9).\r\n\r\nI moved this into a separate issue since it is not related to Sankey chart — https://github.com/metabase/metabase/issues/50309"", 'created_at': datetime.datetime(2024, 11, 22, 15, 20, 38, tzinfo=datetime.timezone.utc)}]","deepfates on (2024-09-13 17:48:22 UTC): Hi, curious when we might expect to see Sankey charts land in main. Any projections on this?

alxnddr (Issue Creator) on (2024-09-25 23:48:16 UTC): Hey @deepfates 👋 Unfortunately, it is unlikely we could prioritize this into the upcoming 51 release that should happen roughly in a week. We scheduled the Sankey for 52 which will get released in a couple of more months

trunk-io[bot] on (2024-11-13 19:18:38 UTC): <!-- Trunk Test Analytics -->


![Static Badge](https://img.shields.io/badge/8_tests-c1b2e2b5-purple) &ensp; ![Static Badge](https://img.shields.io/badge/0-failed-crimson) &ensp; ![Static Badge](https://img.shields.io/badge/8-flaky-red) &ensp; ![Static Badge](https://img.shields.io/badge/0-quarantined-yellow)


| Flaky Test | Failure Summary | Logs |
| --- | --- | --- |
| <code>login-history-test</code> |  | [Logs ↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment&runConclusion=FAILURE&runId=b014cce7-348b-5c12-b120-94d5b21ab0af) |
| <code>ldap-enabled-test</code> |  | [Logs ↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment&runConclusion=FAILURE&runId=3501b4a6-1864-5e5b-a1ea-4b4b36dd84e0) |
| <code>ldap-settings-test</code> |  | [Logs ↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment&runConclusion=FAILURE&runId=e1c99238-b900-5e03-be01-f31ef542c1a8) |
| <code>google-settings-test</code> |  | [Logs ↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment&runConclusion=FAILURE&runId=f705ddbe-ebd4-527e-b36b-03f03c72d837) |

[... and 4 more](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment&runConclusion=FAILURE)
<sub>

[View Full Report ↗︎](https://app.trunk.io/metabase/flaky-tests/pr/46245?repo=metabase/metabase&commitHash=c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb&utm_source=gh-comment) ⋅ [Docs](https://docs.trunk.io/flaky-tests/github-pull-request-comments?utm_source=gh-comment)

</sub>

github-actions[bot] on (2024-11-21 21:14:32 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 379cf342d3b635e942c2e44c40a5f574522c1c64...c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/index.ts<br>frontend/src/metabase/ui/components/icons/Icon/icons/sankey.svg |

github-actions[bot] on (2024-11-21 21:22:02 UTC): 👋 Deploying a preview environment for commit c1b2e2b5d1f157f5f9ba572f98ef03156afc44fb.
✅ Preview:
    https://pr46245.coredev.metabase.com
🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)
<!-- Sticky Pull Request Comment -->

kdoh on (2024-11-22 14:02:01 UTC): I'm still seeing the bug where tool tips auto close after a few seconds without me moving my mouse. Running Firefox Developer (133.0b9).

Other than that, things are looking solid from my run through but I think that's a core blocking bug.

alxnddr (Issue Creator) on (2024-11-22 15:20:38 UTC): I moved this into a separate issue since it is not related to Sankey chart — https://github.com/metabase/metabase/issues/50309

"
2435909600,pull_request,closed,,deps: update testing packages,"Closes https://github.com/metabase/metabase/issues/46264

### Description

Upgrade libraries. The main change here - testing libraries now have `@testing-library/dom` as a peer dependency to avoid flakes because of duplicated dom package",uladzimirdev,2024-07-29 16:59:19+00:00,['uladzimirdev'],2024-07-30 12:56:01+00:00,2024-07-30 12:55:59+00:00,https://github.com/metabase/metabase/pull/46242,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]",[],
2435898637,pull_request,closed,,"🤖 backported ""[perf] Better CLJC memoization; bounded strategy, fast versions""",#46199,github-automation-metabase,2024-07-29 16:53:46+00:00,"['bshepherdson', 'github-automation-metabase']",2024-07-29 17:43:44+00:00,2024-07-29 17:43:43+00:00,https://github.com/metabase/metabase/pull/46241,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2435741979,pull_request,closed,,"🤖 backported ""Infer id numeric columns as non metrics""",#45662,github-automation-metabase,2024-07-29 15:35:21+00:00,"['alxnddr', 'github-automation-metabase']",2024-07-29 16:05:25+00:00,2024-07-29 16:05:24+00:00,https://github.com/metabase/metabase/pull/46239,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2435733275,pull_request,closed,,"🤖 backported ""Avoid all tables in memory during sync""","  #46193
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-29 15:31:06+00:00,"['calherries', 'github-automation-metabase']",2024-07-30 14:40:20+00:00,2024-07-30 14:40:16+00:00,https://github.com/metabase/metabase/pull/46238,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2435604194,pull_request,closed,,"🤖 backported ""e2e: Rewrite dashboard card resizing spec""",#46212,github-automation-metabase,2024-07-29 14:36:43+00:00,"['nemanjaglumac', 'github-automation-metabase']",2024-07-31 11:47:58+00:00,2024-07-31 11:47:55+00:00,https://github.com/metabase/metabase/pull/46236,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2435514634,pull_request,closed,,Increase slack upload timeout to 20 seconds,"Resolves https://github.com/metabase/metabase/issues/46227

This PR increases the slack upload timeout to 20 seconds, from 3 seconds. ",calherries,2024-07-29 13:59:49+00:00,['calherries'],2024-07-29 19:12:20+00:00,2024-07-29 18:42:19+00:00,https://github.com/metabase/metabase/pull/46235,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2256703734, 'issue_id': 2435514634, 'author': 'calherries', 'body': '@metabase-bot backport release-x.49.x', 'created_at': datetime.datetime(2024, 7, 29, 19, 11, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2256705650, 'issue_id': 2435514634, 'author': 'github-actions[bot]', 'body': '@calherries something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10150355494)', 'created_at': datetime.datetime(2024, 7, 29, 19, 12, 19, tzinfo=datetime.timezone.utc)}]","calherries (Issue Creator) on (2024-07-29 19:11:13 UTC): @metabase-bot backport release-x.49.x

github-actions[bot] on (2024-07-29 19:12:19 UTC): @calherries something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10150355494)

"
2435381968,pull_request,closed,,test: do not allow cypress to raise an error on timeline hover,"### Description

Attempt to address the issue with cypress left bar which raises errors on hover.

### How to verify

- run any e2e test
- try to hover over different steps
- make sure there is no 100500 errors in the console

### Before

https://github.com/user-attachments/assets/6ecbafed-b2e5-478f-a7a5-64018965708a


### After

https://github.com/user-attachments/assets/972536af-fcc0-4a6f-a7ca-6526c61fcbed






",uladzimirdev,2024-07-29 13:07:37+00:00,['uladzimirdev'],2024-08-02 16:20:27+00:00,2024-08-02 15:48:36+00:00,https://github.com/metabase/metabase/pull/46230,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]",[],
2435353549,pull_request,closed,,Bump athena dependencies,"### Description

* Bump aws-java-sdk-core to 1.12.765
* Bump athena-jdbc to 3.2.0

Needed as there is an indirect dependency to a version of jackson core that has [a denial of service problem](https://security.snyk.io/vuln/SNYK-JAVA-COMFASTERXMLJACKSONCORE-7569538) that our CI has picked up.

### How to verify

Running Snyk as part of our CI, we flagged the below up
![image](https://github.com/user-attachments/assets/80ff5397-a5de-4251-8fef-cf7753fc9802)

I've checked the dependencies for the AWS SDK on Maven and it's using 2.12 of Jackson so I imagine the 2.14 comes from the athena-jdbc driver.

**I don't know how destructive this dependency change is as I don't have exposure to the changes made in the AWS driver**, but I think if this is a minor enough change it would be good to prevent the issue and allow our CI to be accurate 😄 

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",elken,2024-07-29 12:58:24+00:00,"['piranha', 'lbrdnk']",2024-11-01 16:08:16+00:00,2024-10-31 16:57:17+00:00,https://github.com/metabase/metabase/pull/46229,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2255876160, 'issue_id': 2435353549, 'author': 'elken', 'body': 'I just signed the CLA :)', 'created_at': datetime.datetime(2024, 7, 29, 13, 1, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2257730101, 'issue_id': 2435353549, 'author': 'piranha', 'body': ""Ehh, [Athena driver test is failing](https://github.com/metabase/metabase/actions/runs/10157768148/job/28088499643?pr=46261). I'm not an expert in Athena, so I wonder if you know what's going on?"", 'created_at': datetime.datetime(2024, 7, 30, 8, 6, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2257740807, 'issue_id': 2435353549, 'author': 'elken', 'body': ""I am not, but it seems to claim a number of missing packages so I guess the version bump isn't a simple one :( \r\n\r\nI'll try and spend some time today to look into the changes required then, sorry :smile:"", 'created_at': datetime.datetime(2024, 7, 30, 8, 11, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2257784478, 'issue_id': 2435353549, 'author': 'lbrdnk', 'body': ""Hey @elken, thanks for the contribution in making! I've attempted to upgrade Athena to 3.2 in my WIP PR https://github.com/metabase/metabase/pull/43489.\r\n\r\nIf I recall correctly, there is still some exception about `GetQueryResultsStream` logged when query is executed against our Athena instances.\r\n\r\nFeel free to re-use what's in that PR, but mind that exception has to be resolved for this to be merged. (For that you'd _probably_ need an actual Athena instance.)"", 'created_at': datetime.datetime(2024, 7, 30, 8, 33, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2257789108, 'issue_id': 2435353549, 'author': 'elken', 'body': ""> Hey @elken, thanks for the contribution in making! I've attempted to upgrade Athena to 3.2 in my WIP PR #43489.\r\n> \r\n> If I recall correctly, there is still some exception about `GetQueryResultsStream` logged when query is executed against our Athena instances.\r\n> \r\n> Feel free to re-use what's in that PR, but mind that exception has to be resolved for this to be merged. (For that you'd _probably_ need an actual Athena instance.)\r\n\r\nOh wonderful, looks like yours supersedes mine then! If you could also bump the AWS SDK dep then it makes this PR redundant and also resolves the CVE :smile:"", 'created_at': datetime.datetime(2024, 7, 30, 8, 35, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2257789755, 'issue_id': 2435353549, 'author': 'lbrdnk', 'body': 'I think we should link this PR to https://github.com/metabase/metabase/issues/35965.', 'created_at': datetime.datetime(2024, 7, 30, 8, 35, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2257793287, 'issue_id': 2435353549, 'author': 'elken', 'body': '> I think we should link this PR to #35965.\r\n\r\nWell yours makes this redundant, so if the concentration is shifted to yours instead I can just close this :smile: thank you!', 'created_at': datetime.datetime(2024, 7, 30, 8, 37, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2310990986, 'issue_id': 2435353549, 'author': 'camsaul', 'body': ""The Athena driver artifacts we use live in a S3 bucket we host so you can't bump the version unless we upload it to our S3 bucket first"", 'created_at': datetime.datetime(2024, 8, 26, 20, 7, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2450243677, 'issue_id': 2435353549, 'author': 'dpsutton', 'body': ""I'm running `clj -X:deps tree :aliases '[:ee :drivers]'` and I see the following for jackson core:\r\n\r\n```shell\r\n❯ ag jackson-core deps\r\n95:  X com.fasterxml.jackson.core/jackson-core 2.17.0 :superseded\r\n496:      . com.fasterxml.jackson.core/jackson-core 2.17.2 :newer-version\r\n533:        . com.fasterxml.jackson.core/jackson-core 2.17.2\r\n775:  X com.fasterxml.jackson.core/jackson-core 2.15.2 :older-version\r\n777:    X com.fasterxml.jackson.core/jackson-core 2.15.2 :older-version\r\n779:    X com.fasterxml.jackson.core/jackson-core 2.15.2 :older-version\r\n884:        X com.fasterxml.jackson.core/jackson-core 2.8.7 :older-version\r\n```\r\n\r\nWe Are using `2.17.2` which is brought in from \r\n\r\n```\r\n  . metabase/athena /Users/dan/projects/work/metabase/modules/drivers/athena\r\n    . com.amazonaws/aws-java-sdk-core 1.12.770\r\n      X commons-logging/commons-logging 1.1.3 :older-version\r\n      X commons-codec/commons-codec 1.15 :use-top\r\n      X org.apache.httpcomponents/httpclient 4.5.13 :older-version\r\n      X com.fasterxml.jackson.core/jackson-databind 2.17.2 :use-top\r\n      . com.fasterxml.jackson.dataformat/jackson-dataformat-cbor 2.17.2 :newer-version\r\n        X com.fasterxml.jackson.core/jackson-databind 2.17.2 :use-top\r\n        . com.fasterxml.jackson.core/jackson-core 2.17.2\r\n```\r\n\r\nIf we needed to just modify this dep, we can easily accomplish this by setting an explicit version in the athena metabase driver or metabase itself."", 'created_at': datetime.datetime(2024, 10, 31, 15, 59, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2450382997, 'issue_id': 2435353549, 'author': 'elken', 'body': '@paoliniluis why is this closed?', 'created_at': datetime.datetime(2024, 10, 31, 17, 1, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2450670180, 'issue_id': 2435353549, 'author': 'paoliniluis', 'body': '@elken check the comment from Dan up above', 'created_at': datetime.datetime(2024, 10, 31, 19, 32, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2451609329, 'issue_id': 2435353549, 'author': 'elken', 'body': ""@paoliniluis yes but that doesn't change the fact this code is still needed. If this is already done in another PR it would be useful to link to that rather than blindly closing issues all the time :)"", 'created_at': datetime.datetime(2024, 11, 1, 9, 49, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2452117360, 'issue_id': 2435353549, 'author': 'paoliniluis', 'body': ""@elken maybe I didn't explain myself correctly: the dependencies that you see in your scanner are already bumped and what your CI is returning is a false positive. I would suggest that you check this manually by running the command that Dan mentioned above and check https://clojure.org/reference/dep_expansion.\r\n\r\nAs we've done in the past, we do help government agencies that run Metabase via our support ticketing system, so in case you have any questions please contact us directly"", 'created_at': datetime.datetime(2024, 11, 1, 15, 56, 5, tzinfo=datetime.timezone.utc)}]","elken (Issue Creator) on (2024-07-29 13:01:38 UTC): I just signed the CLA :)

piranha (Assginee) on (2024-07-30 08:06:10 UTC): Ehh, [Athena driver test is failing](https://github.com/metabase/metabase/actions/runs/10157768148/job/28088499643?pr=46261). I'm not an expert in Athena, so I wonder if you know what's going on?

elken (Issue Creator) on (2024-07-30 08:11:17 UTC): I am not, but it seems to claim a number of missing packages so I guess the version bump isn't a simple one :( 

I'll try and spend some time today to look into the changes required then, sorry :smile:

lbrdnk (Assginee) on (2024-07-30 08:33:22 UTC): Hey @elken, thanks for the contribution in making! I've attempted to upgrade Athena to 3.2 in my WIP PR https://github.com/metabase/metabase/pull/43489.

If I recall correctly, there is still some exception about `GetQueryResultsStream` logged when query is executed against our Athena instances.

Feel free to re-use what's in that PR, but mind that exception has to be resolved for this to be merged. (For that you'd _probably_ need an actual Athena instance.)

elken (Issue Creator) on (2024-07-30 08:35:39 UTC): Oh wonderful, looks like yours supersedes mine then! If you could also bump the AWS SDK dep then it makes this PR redundant and also resolves the CVE :smile:

lbrdnk (Assginee) on (2024-07-30 08:35:59 UTC): I think we should link this PR to https://github.com/metabase/metabase/issues/35965.

elken (Issue Creator) on (2024-07-30 08:37:45 UTC): Well yours makes this redundant, so if the concentration is shifted to yours instead I can just close this :smile: thank you!

camsaul on (2024-08-26 20:07:08 UTC): The Athena driver artifacts we use live in a S3 bucket we host so you can't bump the version unless we upload it to our S3 bucket first

dpsutton on (2024-10-31 15:59:16 UTC): I'm running `clj -X:deps tree :aliases '[:ee :drivers]'` and I see the following for jackson core:

```shell
❯ ag jackson-core deps
95:  X com.fasterxml.jackson.core/jackson-core 2.17.0 :superseded
496:      . com.fasterxml.jackson.core/jackson-core 2.17.2 :newer-version
533:        . com.fasterxml.jackson.core/jackson-core 2.17.2
775:  X com.fasterxml.jackson.core/jackson-core 2.15.2 :older-version
777:    X com.fasterxml.jackson.core/jackson-core 2.15.2 :older-version
779:    X com.fasterxml.jackson.core/jackson-core 2.15.2 :older-version
884:        X com.fasterxml.jackson.core/jackson-core 2.8.7 :older-version
```

We Are using `2.17.2` which is brought in from 

```
  . metabase/athena /Users/dan/projects/work/metabase/modules/drivers/athena
    . com.amazonaws/aws-java-sdk-core 1.12.770
      X commons-logging/commons-logging 1.1.3 :older-version
      X commons-codec/commons-codec 1.15 :use-top
      X org.apache.httpcomponents/httpclient 4.5.13 :older-version
      X com.fasterxml.jackson.core/jackson-databind 2.17.2 :use-top
      . com.fasterxml.jackson.dataformat/jackson-dataformat-cbor 2.17.2 :newer-version
        X com.fasterxml.jackson.core/jackson-databind 2.17.2 :use-top
        . com.fasterxml.jackson.core/jackson-core 2.17.2
```

If we needed to just modify this dep, we can easily accomplish this by setting an explicit version in the athena metabase driver or metabase itself.

elken (Issue Creator) on (2024-10-31 17:01:17 UTC): @paoliniluis why is this closed?

paoliniluis on (2024-10-31 19:32:37 UTC): @elken check the comment from Dan up above

elken (Issue Creator) on (2024-11-01 09:49:36 UTC): @paoliniluis yes but that doesn't change the fact this code is still needed. If this is already done in another PR it would be useful to link to that rather than blindly closing issues all the time :)

paoliniluis on (2024-11-01 15:56:05 UTC): @elken maybe I didn't explain myself correctly: the dependencies that you see in your scanner are already bumped and what your CI is returning is a false positive. I would suggest that you check this manually by running the command that Dan mentioned above and check https://clojure.org/reference/dep_expansion.

As we've done in the past, we do help government agencies that run Metabase via our support ticketing system, so in case you have any questions please contact us directly

"
2435317956,pull_request,closed,,MS1: Open notebook data source in new tab,"### Description
This PR addresses the milestone 1 from #46201.
It implements linking to the data source from a notebook mode and opening it in a new tab/window by cmd/ctrl clicking on it (depends on the OS).

### How to verify
1. Open any entity (except Metrics) in the notebook mode (raw table, question, model)
2. Command (meta) or Ctrl click on the data source
3. A new tab/window should open with that source in a simple (chill mode)

Alternatively, run the accompanied E2E tests.

![image](https://github.com/user-attachments/assets/ac632864-23f3-424a-bc98-6f2435a6de08)


### Demo

https://metaboat.slack.com/archives/C0645JP1W81/p1722265651662729?thread_ts=1722257844.614529&cid=C0645JP1W81

### Checklist

- [x] Tests have been added/updated to cover changes in this PR

### Additional comments
- This PR seems to already implement the milestone 2 (joins) of #46201, but I'll add tests for it separately.
- The tooltip (milestone 3) will also be implemented separately.
- Sandboxing E2E test cases will be implemented in a follow-up PR.",nemanjaglumac,2024-07-29 12:43:15+00:00,['nemanjaglumac'],2024-10-08 16:18:37+00:00,2024-08-06 22:18:36+00:00,https://github.com/metabase/metabase/pull/46228,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', ''), ('PR-Env', 'See https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458')]","[{'comment_id': 2271255672, 'issue_id': 2435317956, 'author': 'AlessioLaiso', 'body': 'Two things I\'d suggest improving:\r\n- Cmd+click works, but mouse scrollwheel click doesn\'t. This should also work.\r\n- (Nice to have but not mandatory) In the screenshot below, can we make the ""Orders"" in the join row also work?\r\n<img width=""341"" alt=""Screenshot 2024-08-06 at 14 08 38"" src=""https://github.com/user-attachments/assets/419c5781-a3db-4be9-9dd9-e7c0e48531e6"">', 'created_at': datetime.datetime(2024, 8, 6, 13, 9, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2271261720, 'issue_id': 2435317956, 'author': 'nemanjaglumac', 'body': '> can we make the ""Orders"" in the join row also work?\r\n\r\nThis is the simplest possible case that comes up rarely in reality. Most of the time you\'d see ""Previous results"".\r\nTrying to distinguish between ""what are the previous results"" and the simple table will complicate things a lot in the code while providing little additional benefit to users IMO.\r\n\r\nWould it be ok if we start with only the actual tables/questions/models being linked first?', 'created_at': datetime.datetime(2024, 8, 6, 13, 12, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2271286886, 'issue_id': 2435317956, 'author': 'AlessioLaiso', 'body': ""> Would it be ok if we start with only the actual tables/questions/models being linked first?\r\n\r\nYes, that's ok. As mentioned above, this would be more a nice to have than a must have."", 'created_at': datetime.datetime(2024, 8, 6, 13, 23, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2271350436, 'issue_id': 2435317956, 'author': 'ranquild', 'body': ""Yes we currently can't make it work for the left-hand-side part of the join."", 'created_at': datetime.datetime(2024, 8, 6, 13, 51, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2272064514, 'issue_id': 2435317956, 'author': 'github-actions[bot]', 'body': '👋 Deploying a preview environment for commit 40f8fc93e9236ef11f9717231e1cbf4b34290069.\n✅ Preview:\n    https://pr46228.coredev.metabase.com\n🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)\n<!-- Sticky Pull Request Comment -->', 'created_at': datetime.datetime(2024, 8, 6, 20, 10, 35, tzinfo=datetime.timezone.utc)}]","AlessioLaiso on (2024-08-06 13:09:18 UTC): Two things I'd suggest improving:
- Cmd+click works, but mouse scrollwheel click doesn't. This should also work.
- (Nice to have but not mandatory) In the screenshot below, can we make the ""Orders"" in the join row also work?
<img width=""341"" alt=""Screenshot 2024-08-06 at 14 08 38"" src=""https://github.com/user-attachments/assets/419c5781-a3db-4be9-9dd9-e7c0e48531e6"">

nemanjaglumac (Issue Creator) on (2024-08-06 13:12:11 UTC): This is the simplest possible case that comes up rarely in reality. Most of the time you'd see ""Previous results"".
Trying to distinguish between ""what are the previous results"" and the simple table will complicate things a lot in the code while providing little additional benefit to users IMO.

Would it be ok if we start with only the actual tables/questions/models being linked first?

AlessioLaiso on (2024-08-06 13:23:49 UTC): Yes, that's ok. As mentioned above, this would be more a nice to have than a must have.

ranquild on (2024-08-06 13:51:29 UTC): Yes we currently can't make it work for the left-hand-side part of the join.

github-actions[bot] on (2024-08-06 20:10:35 UTC): 👋 Deploying a preview environment for commit 40f8fc93e9236ef11f9717231e1cbf4b34290069.
✅ Preview:
    https://pr46228.coredev.metabase.com
🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)
<!-- Sticky Pull Request Comment -->

"
2435206998,pull_request,closed,,deps: update react-use and remove resolutions,"Closes https://github.com/metabase/metabase/issues/45425

### Description

Remove resolutions as the the problematic package `fast-loops` was removed from the upstream package

### How to verify

CI is green",uladzimirdev,2024-07-29 11:49:59+00:00,['uladzimirdev'],2024-07-30 06:04:36+00:00,2024-07-30 06:04:34+00:00,https://github.com/metabase/metabase/pull/46226,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]",[],
2435078766,pull_request,closed,,build: disable licenses generation for e2e tests,"it turned out if we restore node_modules from cache at CI, it's enough for `yarn --frozen-lockfile --prefer-offline` to avoid fetching packages from yarn registry, but the step that generates licenses actually re-fetches packages from yarn registry for some reason and I didn't find a way to skip it, especially when it takes ~50s of the build.

so we can drop licenses generation at CI for e2e tests, but we'll keep them in a build that happens after a merge to master as this build is reused later for release.

[context](https://metaboat.slack.com/archives/C0669P4AF9N/p1722000023982779?thread_ts=1721925885.352739&cid=C0669P4AF9N)


### Before ~47s
<img width=""419"" alt=""Screenshot 2024-07-29 at 14 40 44"" src=""https://github.com/user-attachments/assets/173da6a8-1f31-4f05-be5e-4951ff9cac15"">


### After - 1ms


<img width=""387"" alt=""Screenshot 2024-07-29 at 14 40 20"" src=""https://github.com/user-attachments/assets/1f22f4dd-9df5-4850-9e2d-9787bc679aeb"">
",uladzimirdev,2024-07-29 10:46:34+00:00,['uladzimirdev'],2024-07-30 11:23:31+00:00,2024-07-30 06:02:47+00:00,https://github.com/metabase/metabase/pull/46225,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]",[],
2434903342,pull_request,closed,,[manual backport] Make Redshift sync much more robust,"Backports https://github.com/metabase/metabase/pull/46021 to 49

Currently backports to 49 are effectively blocked from passing CI since https://github.com/metabase/metabase/pull/45268 landed on master. Backporting this PR should fix that",calherries,2024-07-29 09:23:47+00:00,['calherries'],2024-07-29 13:20:30+00:00,2024-07-29 10:04:10+00:00,https://github.com/metabase/metabase/pull/46224,"[('.Team/Workflows', 'aka BEC'), ('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2255459651, 'issue_id': 2434903342, 'author': 'replay-io[bot]', 'body': '<h3></h3>\n<table>\n  <tbody>\n    <tr>\n      <td><b>Status</b></td>\n      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=d92b3ecf-3428-47f9-945e-0de3f59f23f1"" target=""_blank"">Complete ↗︎</a></td>\n    </tr>\n    <tr>\n      <td><b>Commit</b></td>\n      <td>42803dc0d9714e6c1db4981c94ea2251c84e7031</td>\n    </tr>\n    <tr>\n      <td valign=""top""><b>Results</b></td>\n      <td><div>⚠️ <b>2 Flaky</b></div>\n<div>✅ <b>2378 Passed</b></div>\n</td>\n    </tr>\n  </tbody>\n</table>', 'created_at': datetime.datetime(2024, 7, 29, 9, 36, 41, tzinfo=datetime.timezone.utc)}]","replay-io[bot] on (2024-07-29 09:36:41 UTC): <h3></h3>
<table>
  <tbody>
    <tr>
      <td><b>Status</b></td>
      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=d92b3ecf-3428-47f9-945e-0de3f59f23f1"" target=""_blank"">Complete ↗︎</a></td>
    </tr>
    <tr>
      <td><b>Commit</b></td>
      <td>42803dc0d9714e6c1db4981c94ea2251c84e7031</td>
    </tr>
    <tr>
      <td valign=""top""><b>Results</b></td>
      <td><div>⚠️ <b>2 Flaky</b></div>
<div>✅ <b>2378 Passed</b></div>
</td>
    </tr>
  </tbody>
</table>

"
2434871383,pull_request,closed,,`cursor:pointer` on `ParameterValueWidget`,"Re-adds `cursor: pointer` to the `ParameterValueWidget`. I can't seem to take screenshots with a cursor, so if you'd like to see the change then you'll need to pull down the branch",oisincoveney,2024-07-29 09:09:05+00:00,['oisincoveney'],2024-10-08 16:19:18+00:00,2024-07-30 07:52:43+00:00,https://github.com/metabase/metabase/pull/46223,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2434808556,pull_request,closed,,Update SDK version to 0.1.25,Update Readme version references and published npm package version to 0.1.25,github-automation-metabase,2024-07-29 08:38:57+00:00,"['oisincoveney', 'github-automation-metabase']",2024-10-08 16:19:25+00:00,2024-07-29 08:43:27+00:00,https://github.com/metabase/metabase/pull/46222,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2255340797, 'issue_id': 2434808556, 'author': 'github-actions[bot]', 'body': '@github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 7, 29, 8, 39, 19, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-29 08:39:19 UTC): @github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2434657642,pull_request,closed,,support hhmm timezone format,Running CI for external contribution #46172,crisptrutski,2024-07-29 07:24:06+00:00,['crisptrutski'],2024-08-14 06:57:25+00:00,2024-08-14 06:57:24+00:00,https://github.com/metabase/metabase/pull/46220,"[('backport', 'Automatically create PR on current release branch on merge'), ('do not merge', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2255819157, 'issue_id': 2434657642, 'author': 'crisptrutski', 'body': 'Waiting on a small fix in the actual branch', 'created_at': datetime.datetime(2024, 7, 29, 12, 37, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2287991953, 'issue_id': 2434657642, 'author': 'crisptrutski', 'body': 'The associated contribution has been merged.', 'created_at': datetime.datetime(2024, 8, 14, 6, 57, 24, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-07-29 12:37:10 UTC): Waiting on a small fix in the actual branch

crisptrutski (Issue Creator) on (2024-08-14 06:57:24 UTC): The associated contribution has been merged.

"
2434654813,pull_request,closed,,support hhmm timezone format,Running CI for external contribution #46172,crisptrutski,2024-07-29 07:22:54+00:00,['crisptrutski'],2024-07-30 20:20:36+00:00,2024-07-29 07:23:20+00:00,https://github.com/metabase/metabase/pull/46219,"[('.Team/Workflows', 'aka BEC')]",[],
2434645488,pull_request,closed,,[Notification] Record Task History when pulse sends channel message,"Context: https://metaboat.slack.com/archives/C0641E4PB9B/p1720639429925279

Record a task history when sending a channel message. In retry, we concatenate retry errors into one task history. Its status will be a success if the retry succeeds, failed if the retry eventually fails.

Once we move the retry to the channel, we can move this there.",qnkhuat,2024-07-29 07:17:58+00:00,['qnkhuat'],2024-08-26 05:35:42+00:00,2024-08-26 05:35:40+00:00,https://github.com/metabase/metabase/pull/46218,"[('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2273422617, 'issue_id': 2434645488, 'author': 'calherries', 'body': ""I'm not sure this is worth blocking on, but it doesn't seem ideal to me to have one task history entry for each failed retry. If there's a ton of failures happening on concurrently executing pulses the troubleshooting page is going to be a bit of a nightmare. You won't be able to easily tell if the pulses are succeeding at being sent or not at a glance - you'll only be able to see whether particular retries succeeded or not. But users probably care about pulses being sent more than whether particular retries succeeded or not.\r\n\r\nIf it takes many retries to send a pulse, I think it would be nicer to collect the data for all failures in one map (maybe with an atom similar to `retry-count`). The data I have in mind is everything in this `task_details` map:\r\nhttps://github.com/metabase/metabase/blob/c4e6be1dc5a13c10b22bf93a6e28a0181baf3bb9/src/metabase/models/task_history.clj#L121-L127\r\nInstead of one of these maps, you would see a list of them under one task."", 'created_at': datetime.datetime(2024, 8, 7, 13, 2, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2293089353, 'issue_id': 2434645488, 'author': 'qnkhuat', 'body': 'Good point! asking @luizarakaki  in https://metaboat.slack.com/archives/C0641E4PB9B/p1723797588051769?thread_ts=1720639429.925279&cid=C0641E4PB9B', 'created_at': datetime.datetime(2024, 8, 16, 8, 40, 13, tzinfo=datetime.timezone.utc)}]","calherries on (2024-08-07 13:02:41 UTC): I'm not sure this is worth blocking on, but it doesn't seem ideal to me to have one task history entry for each failed retry. If there's a ton of failures happening on concurrently executing pulses the troubleshooting page is going to be a bit of a nightmare. You won't be able to easily tell if the pulses are succeeding at being sent or not at a glance - you'll only be able to see whether particular retries succeeded or not. But users probably care about pulses being sent more than whether particular retries succeeded or not.

If it takes many retries to send a pulse, I think it would be nicer to collect the data for all failures in one map (maybe with an atom similar to `retry-count`). The data I have in mind is everything in this `task_details` map:
https://github.com/metabase/metabase/blob/c4e6be1dc5a13c10b22bf93a6e28a0181baf3bb9/src/metabase/models/task_history.clj#L121-L127
Instead of one of these maps, you would see a list of them under one task.

qnkhuat (Issue Creator) on (2024-08-16 08:40:13 UTC): Good point! asking @luizarakaki  in https://metaboat.slack.com/archives/C0641E4PB9B/p1723797588051769?thread_ts=1720639429.925279&cid=C0641E4PB9B

"
2434644571,pull_request,closed,,"🤖 backported ""Structure e2e API helpers""",  #46041,github-automation-metabase,2024-07-29 07:17:25+00:00,"['kamilmielnik', 'github-automation-metabase']",2024-07-29 08:41:52+00:00,2024-07-29 08:41:50+00:00,https://github.com/metabase/metabase/pull/46217,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2433027382,pull_request,closed,,How loading up huge app-dbs should work,"Adresses: #44922

This PR introduces a new namespace `src.dev.add-load` that provides a utility for generating and loading test data in the app-db for Metabase. It works similarly to `with-temp`, but uses a data oriented api, and is not limited to ~400 inserts at a time, because it does not use the program stack to track every single insertion.

Checkout [the docstring](https://github.com/metabase/metabase/pull/46214/files#diff-815d2335d3813ebce8b35fa057fbdb9cf5c9f3d34f06ba4c7df5ed5f262160b0R31-R105) for the rationale.
",escherize,2024-07-26 21:55:37+00:00,['escherize'],2025-02-04 18:14:54+00:00,2024-08-15 18:13:59+00:00,https://github.com/metabase/metabase/pull/46214,"[('do not merge', ''), ('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2270406207, 'issue_id': 2433027382, 'author': 'qnkhuat', 'body': 'nice stuff, have you looked at https://github.com/metabase/metabase/blob/a792ca29d934b4f813b68b826f72552ab34999b8/enterprise/backend/test/metabase_enterprise/serialization/v2/e2e_test.clj#L115 ?', 'created_at': datetime.datetime(2024, 8, 6, 5, 20, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2270588741, 'issue_id': 2433027382, 'author': 'piranha', 'body': ""That's a cool idea! I think it would be cool to use this as a`with-temp` backend, so for one-off cases you won't need to write destructuring.\r\n\r\nAlso, in lieu of Ngoc's remark, have you seen [datapotato](https://github.com/donut-party/datapotato)? It's what (archived) specmonstah repo recommends now, and I wonder if it would make sense to employ this to generate more random data in our tests."", 'created_at': datetime.datetime(2024, 8, 6, 7, 36, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2286589704, 'issue_id': 2433027382, 'author': 'escherize', 'body': 'I think making it easy to write bigger, more complex scenarios is a win, whether we end up using datapotato or however it happens. \r\n\r\nThis approach can be the foundation for the [kitchen-sink instance]() too, because in this world, the kitchen sink is simply a longer list of 3-tuples, similar to how `mt/with-temp` takes them.\r\n\r\nFor load-testing we can focus on adding e.g. 10000 users, or permissions, and link them together quite simply doing it in a data-oriented way makes that extremely easy. Examples are in the docstring for [from-script](https://github.com/metabase/metabase/pull/46214/files#diff-815d2335d3813ebce8b35fa057fbdb9cf5c9f3d34f06ba4c7df5ed5f262160b0R30).', 'created_at': datetime.datetime(2024, 8, 13, 15, 54, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2291886707, 'issue_id': 2433027382, 'author': 'escherize', 'body': 'I don\'t want to see this in the github ""needs review"" posting, but still think it\'s good.', 'created_at': datetime.datetime(2024, 8, 15, 18, 13, 59, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-08-06 05:20:51 UTC): nice stuff, have you looked at https://github.com/metabase/metabase/blob/a792ca29d934b4f813b68b826f72552ab34999b8/enterprise/backend/test/metabase_enterprise/serialization/v2/e2e_test.clj#L115 ?

piranha on (2024-08-06 07:36:28 UTC): That's a cool idea! I think it would be cool to use this as a`with-temp` backend, so for one-off cases you won't need to write destructuring.

Also, in lieu of Ngoc's remark, have you seen [datapotato](https://github.com/donut-party/datapotato)? It's what (archived) specmonstah repo recommends now, and I wonder if it would make sense to employ this to generate more random data in our tests.

escherize (Issue Creator) on (2024-08-13 15:54:09 UTC): I think making it easy to write bigger, more complex scenarios is a win, whether we end up using datapotato or however it happens. 

This approach can be the foundation for the [kitchen-sink instance]() too, because in this world, the kitchen sink is simply a longer list of 3-tuples, similar to how `mt/with-temp` takes them.

For load-testing we can focus on adding e.g. 10000 users, or permissions, and link them together quite simply doing it in a data-oriented way makes that extremely easy. Examples are in the docstring for [from-script](https://github.com/metabase/metabase/pull/46214/files#diff-815d2335d3813ebce8b35fa057fbdb9cf5c9f3d34f06ba4c7df5ed5f262160b0R30).

escherize (Issue Creator) on (2024-08-15 18:13:59 UTC): I don't want to see this in the github ""needs review"" posting, but still think it's good.

"
2432984308,pull_request,closed,,e2e: Rewrite dashboard card resizing spec,"### What does this PR accomplish?
- Speeds up dashboard-card-resizing spec by 100% in CI
- Removes the flakiness (confirmed by stress-testing)
- Simplifies test cases without losing the confidence that the feature works
- Improves assertions
- Improves the quality of the code by following Cypress' best practices (no more selectors stored as variable that you access later)

> [!Note]
> This whole spec now runs in about 45s while it previously took 1:35-1:45.

### Notable changes
1. ""should not allow cards to be resized smaller than min height""
    - Removed the part where we first manually resize cards UP (in consultation with @oisincoveney )
    - We're now starting by creating each card from some large size (18x10) using the API
    - We then resize those cards manually and assert that they cannot be shrunk smaller than their min size
2. ""should prevent link dashboard card overflows (metabase#31701)""
    - Improved readability of a helper function
    - Improved the test speed by simply rearranging how and when we loop through each viewport size
    - Reduced the number of setup, visits, etc. by merging two tests into one

### Stress-test
- [dashboard card resizing - min size](https://github.com/metabase/metabase/actions/runs/10116710768) (previous notorious flake) - 50/50 :white_check_mark: in half the time it took previously
- [dashboard card resizing - repro 31701](https://github.com/metabase/metabase/actions/runs/10117264648) - 100/100 :white_check_mark: (now runs in 7 seconds, from 25-30s before)
- the whole spec 5/5 ✅ (https://github.com/metabase/metabase/actions/runs/10117379736)
- the whole spec 50/50 ✅ (https://github.com/metabase/metabase/actions/runs/10117580416)",nemanjaglumac,2024-07-26 21:12:29+00:00,['nemanjaglumac'],2024-07-31 11:48:22+00:00,2024-07-29 14:35:57+00:00,https://github.com/metabase/metabase/pull/46212,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2432951716,pull_request,closed,,Add `:relative-time-interval` mbql function,"Closes https://github.com/metabase/metabase/issues/45942
Closes https://github.com/metabase/metabase/issues/34573

### Description

This PR adds `:relative-time-interval` mbql function and modifies FE to generate relative datetime filters using it.

Function has a following signature `column, value, bucket, offsetValue, offsetBucket`. `options` are not used as I found them redundant at this point. `value` and `offsetValue` are allowed to be integer only at this point.

Function is desugared into form as follows `[:and [:>=..] [:<..]]` in desugar qp middleware.

More context [on slack](https://metaboat.slack.com/archives/C04DN5VRQM6/p1721849734133429).

### How to verify

Run modified and new tests, or verify manually following reproductions in the linked issues.

### Checklist

- [X] Tests have been added/updated to cover changes in this PR
",lbrdnk,2024-07-26 20:42:57+00:00,['lbrdnk'],2024-08-01 09:12:16+00:00,2024-08-01 09:12:14+00:00,https://github.com/metabase/metabase/pull/46211,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2259948568, 'issue_id': 2432951716, 'author': 'lbrdnk', 'body': ""@ranquild, thank you for the review. My understanding is, that if the _offset_ relative date filter is in use, we provide no current option. I think adding options to `relative-time-interval` will make sense in a follow up, _if we decide_ to remove the `time-interval` in favor of `relative-time-interval`.\r\n\r\nThat would require further modifications to `relative-time-interval`, namely aforementioned _include current_ and update to handling of empty offset (I've set the schema to int atm).\r\n\r\nThat would be ihmo step the right direction because we could shrink the code base (even just a small) bit and make things less complex."", 'created_at': datetime.datetime(2024, 7, 31, 8, 25, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2259957835, 'issue_id': 2432951716, 'author': 'lbrdnk', 'body': ""That said, if you expand up the change in `frontend/src/metabase-lib/filter.ts`, you'll see the good old `time-interval` is still in use there for the _current_ case. As per my previous comment, I believe removing it (or changing `time-interval` to use `relative-time-interval` logic) could be the right follow up for this PR."", 'created_at': datetime.datetime(2024, 7, 31, 8, 30, 59, tzinfo=datetime.timezone.utc)}]","lbrdnk (Issue Creator) on (2024-07-31 08:25:44 UTC): @ranquild, thank you for the review. My understanding is, that if the _offset_ relative date filter is in use, we provide no current option. I think adding options to `relative-time-interval` will make sense in a follow up, _if we decide_ to remove the `time-interval` in favor of `relative-time-interval`.

That would require further modifications to `relative-time-interval`, namely aforementioned _include current_ and update to handling of empty offset (I've set the schema to int atm).

That would be ihmo step the right direction because we could shrink the code base (even just a small) bit and make things less complex.

lbrdnk (Issue Creator) on (2024-07-31 08:30:59 UTC): That said, if you expand up the change in `frontend/src/metabase-lib/filter.ts`, you'll see the good old `time-interval` is still in use there for the _current_ case. As per my previous comment, I believe removing it (or changing `time-interval` to use `relative-time-interval` logic) could be the right follow up for this PR.

"
2432951441,pull_request,closed,,"🤖 backported ""Fix the homepage dashboard being loaded everywhere""","  #46202
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-26 20:42:42+00:00,"['ranquild', 'github-automation-metabase']",2024-07-26 21:27:28+00:00,2024-07-26 21:27:27+00:00,https://github.com/metabase/metabase/pull/46210,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2432894230,pull_request,closed,,[manual backport] Skip long values in JSON unfolding query (#46089),"Manual backport of https://github.com/metabase/metabase/pull/46089

The only conflict was in the driver changelog.",calherries,2024-07-26 20:02:21+00:00,['calherries'],2024-07-29 13:31:29+00:00,2024-07-29 13:30:58+00:00,https://github.com/metabase/metabase/pull/46208,"[('.Team/Workflows', 'aka BEC'), ('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2253447444, 'issue_id': 2432894230, 'author': 'replay-io[bot]', 'body': '<h3></h3>\n<table>\n  <tbody>\n    <tr>\n      <td><b>Status</b></td>\n      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=d6192d0b-07fc-4320-b557-121efebc5a16"" target=""_blank"">Complete ↗︎</a></td>\n    </tr>\n    <tr>\n      <td><b>Commit</b></td>\n      <td>fca518b0f315fba6ffb5237343c92e4623177c94</td>\n    </tr>\n    <tr>\n      <td valign=""top""><b>Results</b></td>\n      <td><div>⚠️ <b>1 Flaky</b></div>\n<div>✅ <b>2379 Passed</b></div>\n</td>\n    </tr>\n  </tbody>\n</table>', 'created_at': datetime.datetime(2024, 7, 26, 20, 16, 37, tzinfo=datetime.timezone.utc)}]","replay-io[bot] on (2024-07-26 20:16:37 UTC): <h3></h3>
<table>
  <tbody>
    <tr>
      <td><b>Status</b></td>
      <td width=""2000""><a href=""https://app.replay.io/team/dzoyNTM4ZjRmOC05YmFlLTRiYjYtYjljYi1jOGYzOWUyMjRhZWY=/runs?testRunId=d6192d0b-07fc-4320-b557-121efebc5a16"" target=""_blank"">Complete ↗︎</a></td>
    </tr>
    <tr>
      <td><b>Commit</b></td>
      <td>fca518b0f315fba6ffb5237343c92e4623177c94</td>
    </tr>
    <tr>
      <td valign=""top""><b>Results</b></td>
      <td><div>⚠️ <b>1 Flaky</b></div>
<div>✅ <b>2379 Passed</b></div>
</td>
    </tr>
  </tbody>
</table>

"
2432890069,pull_request,closed,,"🤖 backported ""docs - link fixes""",#46200,github-automation-metabase,2024-07-26 20:00:18+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-26 20:01:53+00:00,2024-07-26 20:01:52+00:00,https://github.com/metabase/metabase/pull/46207,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2432857874,pull_request,closed,,"🤖 backported ""Remove unused dimension options from query_metadata""",#46195,github-automation-metabase,2024-07-26 19:36:20+00:00,"['ranquild', 'github-automation-metabase']",2024-07-26 20:28:29+00:00,2024-07-26 20:28:28+00:00,https://github.com/metabase/metabase/pull/46205,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2432817182,pull_request,closed,,"🤖 backported ""[perf] Fix memoization based on `dashboard_load_id`""","  #45809
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-26 19:03:04+00:00,"['bshepherdson', 'github-automation-metabase']",2024-07-30 13:19:36+00:00,2024-07-30 13:19:35+00:00,https://github.com/metabase/metabase/pull/46204,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2432740293,pull_request,closed,,Fix the homepage dashboard being loaded everywhere,"Follow-up for https://github.com/metabase/metabase/pull/43836

Previously the homepage dashboard was loaded everywhere even when the homepage was not visited. This PR fixes the issue by splitting the `useHomepageDashboard` hook into 2 and fixing the case with the homepage dashboard being archived during the session with a redux state update.

How to verify:
- Set a custom homepage dashboard
- Open another dashboard
- Reload the page. There should be only 1 dashboard loaded.

Before
<img width=""1321"" alt=""Screenshot 2024-07-26 at 13 51 19"" src=""https://github.com/user-attachments/assets/be75bfcc-8650-4e7f-9b1a-6f8ab808583c"">

After
<img width=""1322"" alt=""Screenshot 2024-07-26 at 13 51 48"" src=""https://github.com/user-attachments/assets/9199f2c8-be87-4e71-a14e-8d62cb3da58a"">

",ranquild,2024-07-26 18:06:40+00:00,['ranquild'],2024-07-26 21:27:53+00:00,2024-07-26 20:41:52+00:00,https://github.com/metabase/metabase/pull/46202,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2432697169,pull_request,closed,,docs - link fixes,Fixes some anchor links.,jeff-bruemmer,2024-07-26 17:46:45+00:00,['jeff-bruemmer'],2024-07-26 20:02:19+00:00,2024-07-26 19:59:29+00:00,https://github.com/metabase/metabase/pull/46200,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2432666762,pull_request,closed,,"[perf] Better CLJC memoization; bounded strategy, fast versions","### Description

Expands and refactors `metabase.util.memoize` to support better cross-platform memoization.

**Better basic memoization**

Use `clojure.core.memoize/memo` (and its clone in CLJS) rather than `clojure.core/memoize` for
the ""everything forever"" strategy.

**Bounded memoization**

There are a few places (eg. `u/kebab-case-en`) where we want zero-overhead *hits* and expect the input space
to be fixed. To guard against runaway memory usage, this **bounded** strategy dumps the entire cache when it
overflows. It logs an INFO level note when that happens - the intent here is that the threshold should never
actually get hit!

**Fast JVM versions**

In the special case where the function to memoize takes exactly 1 argument which is a valid map key, we can
use `ConcurrentHashMap.computeIfAbsent` as the basis of the cache and have much less overhead.

`fast-memo` and `fast-bounded` implement this in CLJ; in CLJS they just call `memo` and `bounded`.

### How to verify

This should be a transparent change that reduces the CPU and memory overhead of memoized functions like
`u/kebab-case-en`. Behavior of the app should not change.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",bshepherdson,2024-07-26 17:35:24+00:00,['bshepherdson'],2024-07-29 17:44:14+00:00,2024-07-29 16:53:02+00:00,https://github.com/metabase/metabase/pull/46199,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2253194814, 'issue_id': 2432666762, 'author': 'bshepherdson', 'body': '* **#46199** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46199?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 26, 17, 35, 43, tzinfo=datetime.timezone.utc)}]","bshepherdson (Issue Creator) on (2024-07-26 17:35:43 UTC): * **#46199** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46199?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2432631052,pull_request,closed,,"🤖 backported ""Add v0.50.17 to the list of releases""",#46197,github-automation-metabase,2024-07-26 17:09:11+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-26 17:52:30+00:00,2024-07-26 17:52:28+00:00,https://github.com/metabase/metabase/pull/46198,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2432612391,pull_request,closed,,Add v0.50.17 to the list of releases,Like it says on the tin 😁,github-automation-metabase,2024-07-26 16:56:55+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-26 17:53:02+00:00,2024-07-26 17:08:12+00:00,https://github.com/metabase/metabase/pull/46197,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2432608184,pull_request,closed,,"🤖 backported ""Filter invalid recent and search items in move modal""",#46086,github-automation-metabase,2024-07-26 16:53:46+00:00,"['iethree', 'github-automation-metabase']",2024-07-26 17:21:57+00:00,2024-07-26 17:21:56+00:00,https://github.com/metabase/metabase/pull/46196,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2432552847,pull_request,closed,,Remove unused dimension options from query_metadata,Cuts the API response by 50%; -1 DB call.,ranquild,2024-07-26 16:15:37+00:00,['ranquild'],2024-07-26 20:28:58+00:00,2024-07-26 19:35:27+00:00,https://github.com/metabase/metabase/pull/46195,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2432519324,pull_request,closed,,Webhooks Admin Section,"Closes https://github.com/metabase/metabase/issues/45574

### Description
Replaces the `Slack` setting in admin with `Notifications`, which allows users to create / update / delete Webhooks.
[Figma Link](https://www.figma.com/design/kYE1YkXvpH8S1DzNZc1YUC/Enable-users-to-create-custom-webhook-notification-channels?node-id=1537-1757&t=Boa1XupAc9iH81XI-0)

### How to verify

1. Go to admin -> notifications
2. Create a new notification (note that a valid URL is needed to accept a post request)
3. Ensure that field validation is working.
4. Update and delete notifications as well.

### Demo

### Checklist

- [s] Tests have been added/updated to cover changes in this PR
",npfitz,2024-07-26 15:54:35+00:00,['npfitz'],2024-08-15 18:59:27+00:00,2024-08-15 18:59:24+00:00,https://github.com/metabase/metabase/pull/46194,"[('.Team/AdminWebapp', 'Admin and Webapp team'), ('PR-Env', 'See https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458')]","[{'comment_id': 2253049233, 'issue_id': 2432519324, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 5878de31fde0820289f6ecedeb83e9b5aeb232a9...fdf4f158c0c8bdcea49e57232450a9cc56a68937.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/index.ts<br>frontend/src/metabase/ui/components/icons/Icon/icons/webhook.svg<br>frontend/src/metabase/ui/components/inputs/Chip/Chip.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Chip/index.ts<br>frontend/src/metabase/ui/components/inputs/index.ts<br>frontend/src/metabase/ui/theme.ts |', 'created_at': datetime.datetime(2024, 7, 26, 15, 55, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2289565563, 'issue_id': 2432519324, 'author': 'github-actions[bot]', 'body': '👋 Deploying a preview environment for commit fdf4f158c0c8bdcea49e57232450a9cc56a68937.\n✅ Preview:\n    https://pr46194.coredev.metabase.com\n🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)\n<!-- Sticky Pull Request Comment -->', 'created_at': datetime.datetime(2024, 8, 14, 18, 33, 35, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-26 15:55:58 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 5878de31fde0820289f6ecedeb83e9b5aeb232a9...fdf4f158c0c8bdcea49e57232450a9cc56a68937.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/index.ts<br>frontend/src/metabase/ui/components/icons/Icon/icons/webhook.svg<br>frontend/src/metabase/ui/components/inputs/Chip/Chip.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Chip/index.ts<br>frontend/src/metabase/ui/components/inputs/index.ts<br>frontend/src/metabase/ui/theme.ts |

github-actions[bot] on (2024-08-14 18:33:35 UTC): 👋 Deploying a preview environment for commit fdf4f158c0c8bdcea49e57232450a9cc56a68937.
✅ Preview:
    https://pr46194.coredev.metabase.com
🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)
<!-- Sticky Pull Request Comment -->

"
2432453448,pull_request,closed,,Avoid all tables in memory during sync,"Pursuant towards https://github.com/metabase/metabase/issues/46209

There are a few places in the sync code where we realize all sync-able tables for a database in a vector only to reduce over them.

This PR replaces those instances by reducing over a reducible collection of tables using `t2/reducible-select`.

It also changes the order in which we refingerprint tables. Before, we refingerprint tables in a random order. Now, we refingerprint tables starting from the earliest fingerprinted field according to its `last_analyzed` timestamp. The reason I had to do this is because we cannot call `shuffle` on a collection of tables that is merely reducible, but this approach is better anyway.",calherries,2024-07-26 15:15:44+00:00,['calherries'],2024-07-30 14:40:42+00:00,2024-07-29 15:30:18+00:00,https://github.com/metabase/metabase/pull/46193,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2255707309, 'issue_id': 2432453448, 'author': 'qnkhuat', 'body': 'would be nice to see how this affect the memory during sync.\r\n\r\nI have this small script\r\n```\r\n(future\r\n (def max-memory-usage (atom 0))\r\n (doseq [_ (range 10000)]\r\n   (let [memory-usage (float (/ (- (.. Runtime getRuntime totalMemory) (.. Runtime getRuntime freeMemory)) 1024 1000))]\r\n     (swap! max-memory-usage max memory-usage)\r\n     (log/info (format ""Memory usage: %f MB, Max memory usage: %f MB"" memory-usage @max-memory-usage)))\r\n   (Thread/sleep 500)))\r\n```\r\n\r\nthat periodically print out the memory usage; if you want, we can do a comparison to see if the maximum memory is reduced between this and the master for a big db.', 'created_at': datetime.datetime(2024, 7, 29, 11, 41, 10, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-07-29 11:41:10 UTC): would be nice to see how this affect the memory during sync.

I have this small script
```
(future
 (def max-memory-usage (atom 0))
 (doseq [_ (range 10000)]
   (let [memory-usage (float (/ (- (.. Runtime getRuntime totalMemory) (.. Runtime getRuntime freeMemory)) 1024 1000))]
     (swap! max-memory-usage max memory-usage)
     (log/info (format ""Memory usage: %f MB, Max memory usage: %f MB"" memory-usage @max-memory-usage)))
   (Thread/sleep 500)))
```

that periodically print out the memory usage; if you want, we can do a comparison to see if the maximum memory is reduced between this and the master for a big db.

"
2432428138,pull_request,closed,,"🤖 backported ""[perf] Add a test for the Clojure-side `lib.cache/side-channel-cache`""",#46133,github-automation-metabase,2024-07-26 15:01:28+00:00,"['bshepherdson', 'github-automation-metabase']",2024-07-26 18:48:03+00:00,2024-07-26 18:48:03+00:00,https://github.com/metabase/metabase/pull/46190,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2432386015,pull_request,closed,,"🤖 backported ""Populate newly created metrics in recents""","  #46166
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-26 14:38:40+00:00,"['iethree', 'github-automation-metabase']",2024-07-26 22:01:50+00:00,2024-07-26 22:01:44+00:00,https://github.com/metabase/metabase/pull/46188,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2253566556, 'issue_id': 2432386015, 'author': 'iethree', 'body': ""whoops! no need to backport. new metrics aren't in v50"", 'created_at': datetime.datetime(2024, 7, 26, 22, 1, 44, tzinfo=datetime.timezone.utc)}]","iethree (Assginee) on (2024-07-26 22:01:44 UTC): whoops! no need to backport. new metrics aren't in v50

"
2432295942,pull_request,closed,,"🤖 backported ""Add e2e tests for 45831 - instance analytics db appearing in permissions""",#46061,github-automation-metabase,2024-07-26 13:52:58+00:00,"['iethree', 'github-automation-metabase']",2024-07-26 14:19:46+00:00,2024-07-26 14:19:45+00:00,https://github.com/metabase/metabase/pull/46187,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2432272629,pull_request,closed,,"🤖 backported ""Skip long values in JSON unfolding query""","  #46089
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-26 13:43:29+00:00,"['calherries', 'github-automation-metabase']",2024-07-29 07:50:46+00:00,2024-07-29 07:50:44+00:00,https://github.com/metabase/metabase/pull/46186,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2253389437, 'issue_id': 2432272629, 'author': 'github-actions[bot]', 'body': '@calherries something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10116895073)', 'created_at': datetime.datetime(2024, 7, 26, 19, 57, 49, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-26 19:57:49 UTC): @calherries something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10116895073)

"
2432249704,pull_request,closed,,Detect queries referencing unknown tables,"Closes https://github.com/metabase/metabase/issues/45028

This improves the errors returned from the Query Reference Validation API:

- It now differentiates between tables that don't exist, and those that are inactive
- It also detect issues with tables where there are no field references, e.g. `COUNT(*)`",crisptrutski,2024-07-26 13:30:55+00:00,['crisptrutski'],2024-08-01 14:17:05+00:00,2024-08-01 14:17:03+00:00,https://github.com/metabase/metabase/pull/46185,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2252773302, 'issue_id': 2432249704, 'author': 'crisptrutski', 'body': '* **#46283** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46283?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46185** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46185?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* **#46143** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46143?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46128** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46128?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46101** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46101?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 26, 13, 31, 17, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-07-26 13:31:17 UTC): * **#46283** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46283?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46185** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46185?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* **#46143** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46143?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46128** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46128?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46101** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46101?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2432218343,pull_request,closed,,[DO NOT MERGE] CSS modules for `normal-filter-summarize-button`,I added CSS modules for Filter and Summarize buttons!,oisincoveney,2024-07-26 13:14:20+00:00,['oisincoveney'],2024-07-29 08:16:44+00:00,2024-07-29 08:16:44+00:00,https://github.com/metabase/metabase/pull/46182,"[('.Team/Embedding', '')]",[],
2432086509,pull_request,closed,,Add tests for #45452,Adds tests for #45452,oisincoveney,2024-07-26 12:01:48+00:00,['oisincoveney'],2024-10-08 16:19:30+00:00,2024-07-26 15:34:10+00:00,https://github.com/metabase/metabase/pull/46178,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2431574755,pull_request,closed,,Fix loading state on the new model page,"Fixes #44813



This PR addresses a UI bug where an empty state was shown instead of a loading state on the new model page.

### Changes:
- Implemented a loading state in `NewModelOptions` to ensure the loading state is displayed while data is being fetched.
- Used the `LoadingAndErrorWrapper` component to manage the loading and error states.
- Updated related tests to check for the presence of the loading state and its removal after the data is loaded.

These changes ensure that the empty state is only shown when appropriate, improving the user experience during data fetching.

---

Tips:

- Make sure to test changes before merging.
- **Submit a ""Request Changes"" review and I'll address it.**
- Close this PR with a comment if it's obviously incorrect. This will improve my future PRs.
- Go to the [Tusk activity logs](https://usetusk.ai/app/task/07fb1112-5b89-4996-a151-2743eb6a5195?client=3086848b-0d35-4181-be6a-28e39c94ef4d) or [issue](https://github.com/metabase/metabase/issues/44813) to see more details.",use-tusk[bot],2024-07-26 07:06:37+00:00,[],2024-07-26 09:13:03+00:00,2024-07-26 09:13:03+00:00,https://github.com/metabase/metabase/pull/46174,[],[],
2431495768,pull_request,closed,,Put SDK client and version into data on-thread,"Closes: #45952

Well, we know dynamic vars don't cross thread boundaries, but what I didn't catch was that sometimes we can insert query metadata inth the query_executions table on another thread, in which case we will drop the `sdk/*client*` and `sdk/*version*` values.

This captures the data on-thread into a map that's passed between threads.",escherize,2024-07-26 06:09:41+00:00,['escherize'],2024-07-26 16:48:08+00:00,2024-07-26 16:48:07+00:00,https://github.com/metabase/metabase/pull/46173,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2431468061,pull_request,closed,,Support hhmm timezone format,"Closes https://github.com/metabase/metabase/issues/43915

### Description

Try a custom formatter if the default formatter for OffsetDateTime doesn't work

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",duncanmak,2024-07-26 05:44:24+00:00,[],2024-08-15 13:57:27+00:00,2024-08-12 16:04:17+00:00,https://github.com/metabase/metabase/pull/46172,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC'), ('External', 'PR from an external contributor.')]","[{'comment_id': 2252277201, 'issue_id': 2431468061, 'author': 'crisptrutski', 'body': ""This looks reasonable to me. \r\n\r\nIt's unfortunately that we need more parsing phases and exception handling, at some point it would be nice to collapse this all down to a single pass with a unified grammar.\r\n\r\nCan you please just update [this test](https://github.com/metabase/metabase/blob/bab905c069c2215c04dda8f0df2a97d00a878c1b/test/metabase/upload_test.clj#L604) as well, so we have more end-to-end coverage?"", 'created_at': datetime.datetime(2024, 7, 26, 8, 53, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2252277648, 'issue_id': 2431468061, 'author': 'crisptrutski', 'body': 'Thanks for the contribution!', 'created_at': datetime.datetime(2024, 7, 26, 8, 53, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2254176016, 'issue_id': 2431468061, 'author': 'duncanmak', 'body': ""@crisptrutski is there anything else I need to do to get this PR merged?\r\n\r\nI'm new to the repo and I see that some of the checks listed above are failing - is it because I forgot to update something, or are some of the checks known to fail?\r\n\r\nThanks for the quick review!"", 'created_at': datetime.datetime(2024, 7, 27, 15, 15, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2254234275, 'issue_id': 2431468061, 'author': 'crisptrutski', 'body': ""I'm not sure why most of the tests failed, it looks like a CI problem.\r\n\r\nI'm going to push a quick commit adding that private metadata and see if my elevated permissions help it build.\r\n\r\nUpdate: nope. Will follow up with my team mates on Monday."", 'created_at': datetime.datetime(2024, 7, 27, 19, 28, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2255301147, 'issue_id': 2431468061, 'author': 'crisptrutski', 'body': 'OK so CI has run properly now 🙂 \r\n\r\nUnfortunately there is a test that has been broken:\r\n\r\n```\r\n FAIL in metabase.upload-test/detect-schema-offset-datetimes-test (upload_test.clj:237)\r\n\r\n:h2\r\n Dates\r\nexpected: {:not_datetime :metabase.upload.types/varchar-255,\r\n           :offset_datetime :metabase.upload.types/offset-datetime}\r\n  actual: {:not_datetime :metabase.upload.types/offset-datetime,\r\n           :offset_datetime :metabase.upload.types/offset-datetime}\r\n```\r\n\r\nFrom a quick look, it seems that leap days on non leap years are now being accepted by the new formatter:\r\n\r\n```\r\n               [""Offset Datetime,Not Datetime""\r\n                ""2022-01-01T00:00:00-01:00,2023-02-28T00:00:00-01:00""\r\n                ""2022-01-01T00:00:00-01:00,2023-02-29T00:00:00-01:00""\r\n                ""2022-01-01T00:00:00Z,2023-02-29T00:00:00-01:00""]))))))\r\n```', 'created_at': datetime.datetime(2024, 7, 29, 8, 19, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2259157538, 'issue_id': 2431468061, 'author': 'duncanmak', 'body': ""@crisptrutski I'm still working on this, sorry, I've been busy with other things in the past few days. I'd like to get this PR merged by the end of this week."", 'created_at': datetime.datetime(2024, 7, 30, 20, 31, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2259195143, 'issue_id': 2431468061, 'author': 'crisptrutski', 'body': 'No problem - end of week will still be great!', 'created_at': datetime.datetime(2024, 7, 30, 20, 56, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2268954803, 'issue_id': 2431468061, 'author': 'crisptrutski', 'body': ""@duncanmak think you'll have time to tie this up this week? Shout if you need a hand 🙂"", 'created_at': datetime.datetime(2024, 8, 5, 12, 27, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2276654057, 'issue_id': 2431468061, 'author': 'duncanmak', 'body': ""@crisptrutski Sorry this took a while, I got it to pass all the tests locally, can you give this another look?\r\n\r\nI'm not completely happy with how this worked out, but if it passes all the tests, maybe this PR is still good enough to go in?\r\n\r\nI thought of a different approach: Use instaparse to extract the relevant values from the input string, and then use the OffsetDateTime/of constructor to create value. Doing so would avoid the multiple (somewhat specific) exception catch blocks, and the code will have a simpler control flow. \r\n\r\nI'm not sure such a small feature warrants writing a custom parser, but I do see that Instaparse if already in `deps.edn`.\r\n\r\n----\r\n\r\nI ran the following tests locally:\r\n\r\n```\r\nclojure -X:dev:test :only metabase.upload.types-test\r\nclojure -X:dev:test :only metabase.upload-test\r\n```"", 'created_at': datetime.datetime(2024, 8, 8, 21, 8, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2283525833, 'issue_id': 2431468061, 'author': 'crisptrutski', 'body': 'Thanks for the perseverance here, but unfortunately this wasn\'t quite right yet. It turns out there was actually a bug in our tests, and when I fixed that this branch was still failing.\r\n\r\nI did a bit of digging, and found that there\'s a ""resolver"" property on the formatter that can be configured to validate the actual date. For some reason the default implementation silently rounds down to the nearest real date, dubious 😄 \r\n\r\nI also wasn\'t able to reproduce the same exception message that you were checking for. I think matching on just the type is fine, but I found myself getting  different exception to yours. Let\'s see what happens when CI runs, perhaps this is JDK version specific, but that seems unlikely.\r\n\r\nLastly, there was a bug in the exception handling - we would no longer be catching the other exception types around the initial parse attempt, so we would no longer be doing the expected substitution with our own custom exception.\r\n\r\nSince the fixes to all of these were rather minor, I hope you don\'t mind that I\'ve pushed the relevant tweaks. I\'ll still make sure that you get credit for this change in the final merge.', 'created_at': datetime.datetime(2024, 8, 12, 9, 44, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2283750068, 'issue_id': 2431468061, 'author': 'crisptrutski', 'body': ""@duncanmak The build is now passing. I've also rebased it on the latest master and added a final commit in your name so that you'll get the credit in the squashed commit. Let me know if you're happy for me to merge. Thanks again for this contribution!"", 'created_at': datetime.datetime(2024, 8, 12, 11, 44, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2284035595, 'issue_id': 2431468061, 'author': 'duncanmak', 'body': ""Let's merge this in!"", 'created_at': datetime.datetime(2024, 8, 12, 13, 44, 30, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-07-26 08:53:27 UTC): This looks reasonable to me. 

It's unfortunately that we need more parsing phases and exception handling, at some point it would be nice to collapse this all down to a single pass with a unified grammar.

Can you please just update [this test](https://github.com/metabase/metabase/blob/bab905c069c2215c04dda8f0df2a97d00a878c1b/test/metabase/upload_test.clj#L604) as well, so we have more end-to-end coverage?

crisptrutski on (2024-07-26 08:53:44 UTC): Thanks for the contribution!

duncanmak (Issue Creator) on (2024-07-27 15:15:30 UTC): @crisptrutski is there anything else I need to do to get this PR merged?

I'm new to the repo and I see that some of the checks listed above are failing - is it because I forgot to update something, or are some of the checks known to fail?

Thanks for the quick review!

crisptrutski on (2024-07-27 19:28:24 UTC): I'm not sure why most of the tests failed, it looks like a CI problem.

I'm going to push a quick commit adding that private metadata and see if my elevated permissions help it build.

Update: nope. Will follow up with my team mates on Monday.

crisptrutski on (2024-07-29 08:19:33 UTC): OK so CI has run properly now 🙂 

Unfortunately there is a test that has been broken:

```
 FAIL in metabase.upload-test/detect-schema-offset-datetimes-test (upload_test.clj:237)

:h2
 Dates
expected: {:not_datetime :metabase.upload.types/varchar-255,
           :offset_datetime :metabase.upload.types/offset-datetime}
  actual: {:not_datetime :metabase.upload.types/offset-datetime,
           :offset_datetime :metabase.upload.types/offset-datetime}
```

From a quick look, it seems that leap days on non leap years are now being accepted by the new formatter:

```
               [""Offset Datetime,Not Datetime""
                ""2022-01-01T00:00:00-01:00,2023-02-28T00:00:00-01:00""
                ""2022-01-01T00:00:00-01:00,2023-02-29T00:00:00-01:00""
                ""2022-01-01T00:00:00Z,2023-02-29T00:00:00-01:00""]))))))
```

duncanmak (Issue Creator) on (2024-07-30 20:31:17 UTC): @crisptrutski I'm still working on this, sorry, I've been busy with other things in the past few days. I'd like to get this PR merged by the end of this week.

crisptrutski on (2024-07-30 20:56:24 UTC): No problem - end of week will still be great!

crisptrutski on (2024-08-05 12:27:43 UTC): @duncanmak think you'll have time to tie this up this week? Shout if you need a hand 🙂

duncanmak (Issue Creator) on (2024-08-08 21:08:09 UTC): @crisptrutski Sorry this took a while, I got it to pass all the tests locally, can you give this another look?

I'm not completely happy with how this worked out, but if it passes all the tests, maybe this PR is still good enough to go in?

I thought of a different approach: Use instaparse to extract the relevant values from the input string, and then use the OffsetDateTime/of constructor to create value. Doing so would avoid the multiple (somewhat specific) exception catch blocks, and the code will have a simpler control flow. 

I'm not sure such a small feature warrants writing a custom parser, but I do see that Instaparse if already in `deps.edn`.

----

I ran the following tests locally:

```
clojure -X:dev:test :only metabase.upload.types-test
clojure -X:dev:test :only metabase.upload-test
```

crisptrutski on (2024-08-12 09:44:48 UTC): Thanks for the perseverance here, but unfortunately this wasn't quite right yet. It turns out there was actually a bug in our tests, and when I fixed that this branch was still failing.

I did a bit of digging, and found that there's a ""resolver"" property on the formatter that can be configured to validate the actual date. For some reason the default implementation silently rounds down to the nearest real date, dubious 😄 

I also wasn't able to reproduce the same exception message that you were checking for. I think matching on just the type is fine, but I found myself getting  different exception to yours. Let's see what happens when CI runs, perhaps this is JDK version specific, but that seems unlikely.

Lastly, there was a bug in the exception handling - we would no longer be catching the other exception types around the initial parse attempt, so we would no longer be doing the expected substitution with our own custom exception.

Since the fixes to all of these were rather minor, I hope you don't mind that I've pushed the relevant tweaks. I'll still make sure that you get credit for this change in the final merge.

crisptrutski on (2024-08-12 11:44:57 UTC): @duncanmak The build is now passing. I've also rebased it on the latest master and added a final commit in your name so that you'll get the credit in the squashed commit. Let me know if you're happy for me to merge. Thanks again for this contribution!

duncanmak (Issue Creator) on (2024-08-12 13:44:30 UTC): Let's merge this in!

"
2431332989,pull_request,closed,,"🤖 backported ""fix(admin/nav): Ensure that the ""Exit admin"" button can be clicked regardless of locale or viewport size""","  #45882
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-26 03:23:37+00:00,"['rafpaf', 'github-automation-metabase']",2024-07-31 02:06:22+00:00,2024-07-31 02:06:21+00:00,https://github.com/metabase/metabase/pull/46171,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2431304138,pull_request,closed,,"🤖 backported ""Some Email/Attachment Improvements and Fixes""",#45691,github-automation-metabase,2024-07-26 02:45:46+00:00,"['adam-james-v', 'github-automation-metabase']",2024-07-26 11:09:19+00:00,2024-07-26 11:09:17+00:00,https://github.com/metabase/metabase/pull/46169,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2431053389,pull_request,closed,,perf: Allocation improvements on sync-db/fingerprinting path,"A follow-up to https://github.com/metabase/metabase/pull/46103.

I focused on optimizing allocation overhead and brought the total allocation size in the same 3tbl x 800col x 1 row benchmark from 24.45GB to 20.45GB (16% reduction). The absolute run time doesn't seem to change much from it, but relieving some memory and GC pressure is worth doing.",alexander-yakushev,2024-07-25 22:07:36+00:00,['alexander-yakushev'],2024-10-08 16:19:27+00:00,2024-07-26 20:29:09+00:00,https://github.com/metabase/metabase/pull/46167,"[('no-backport', 'Do not backport this PR to any branch')]",[],
2431019254,pull_request,closed,,Populate newly created metrics in recents,"
Closes https://github.com/metabase/metabase/issues/44223

### Description

Newly-created metrics were not being added to recents upon creation because we were not re-fetching their card via GET after we sent the creation POST.  This updates the logic (thanks @kamilmielnik!) that detects what urls should trigger a card fetch so that that api endpoint gets called when a metric is newly created.

![Screen Shot 2024-07-25 at 3 36 42 PM](https://github.com/user-attachments/assets/50baca02-84ae-41f6-b179-4f0ec89f5ed9)

### How to verify

- create any new metric
- click the search bar
- see your new metric in recents!

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-07-25 21:41:11+00:00,['iethree'],2024-07-26 16:45:46+00:00,2024-07-26 14:37:54+00:00,https://github.com/metabase/metabase/pull/46166,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2431009856,pull_request,closed,,"🤖 backported ""e2e: Fix dashboard card resizing flake""",#46158,github-automation-metabase,2024-07-25 21:33:24+00:00,"['nemanjaglumac', 'github-automation-metabase']",2024-07-25 21:59:51+00:00,2024-07-25 21:59:50+00:00,https://github.com/metabase/metabase/pull/46165,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2431007036,pull_request,closed,,"🤖 backported ""Add Azure managed identity support""","  #46011
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-25 21:30:58+00:00,"['metamben', 'github-automation-metabase']",2024-07-26 14:51:54+00:00,2024-07-26 14:51:52+00:00,https://github.com/metabase/metabase/pull/46164,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2430983635,pull_request,closed,,Document E2E mongo connectivity workaround,"### What does this PR accomplish?
Provides the solution (workaround) to people who have issues connecting to our QA DB Mongo when running E2E tests locally on arm based processors.

Kudos to @calherries for this discovery!
[Related Slack thread](https://metaboat.slack.com/archives/C010L1Z4F9S/p1711010259048049?thread_ts=1710966249.031669&cid=C010L1Z4F9S).",nemanjaglumac,2024-07-25 21:11:28+00:00,['nemanjaglumac'],2024-10-08 16:19:33+00:00,2024-07-25 21:47:07+00:00,https://github.com/metabase/metabase/pull/46162,"[('Type:Documentation', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', ''), ('.Team/DevEx', '')]",[],
2430953888,pull_request,closed,,Migrate DashboardSidebars to TS,"Relates to https://github.com/metabase/metabase/issues/46160

### Description

Migrate DashboardSidebars to TS
Removed nasty `ts-expect-error` in frontend/src/metabase/dashboard/containers/DashboardApp/DashboardApp.tsx.

### How to verify

CI should pass
",deniskaber,2024-07-25 20:48:14+00:00,['deniskaber'],2024-10-08 16:19:27+00:00,2024-07-26 20:54:33+00:00,https://github.com/metabase/metabase/pull/46161,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2430939870,pull_request,closed,,"🤖 backported ""fix(admin/performance): Fix default time bug in Schedule policy""","  #45915
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-25 20:38:01+00:00,"['rafpaf', 'github-automation-metabase']",2024-07-26 14:17:32+00:00,2024-07-26 14:17:30+00:00,https://github.com/metabase/metabase/pull/46159,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2251431564, 'issue_id': 2430939870, 'author': 'rafpaf', 'body': ""@uladzimirdev Could you take a look at `e2e/support/config.js` to make sure I didn't mess anything up in there? There was a small merge conflict relating to the imports"", 'created_at': datetime.datetime(2024, 7, 25, 21, 31, 55, tzinfo=datetime.timezone.utc)}]","rafpaf (Assginee) on (2024-07-25 21:31:55 UTC): @uladzimirdev Could you take a look at `e2e/support/config.js` to make sure I didn't mess anything up in there? There was a small merge conflict relating to the imports

"
2430906210,pull_request,closed,,e2e: Fix dashboard card resizing flake,"### What does this PR accomplish?
It tries to reduce the flakiness of a single test in the whole spec that's been marked as flaky.

### Example of a typical failure:
- https://github.com/metabase/metabase/actions/runs/10094535264/job/27914011753#step:12:253
![image](https://github.com/user-attachments/assets/dc4d8764-c530-4155-bbc5-cc3b3d6eb50c)

### Explanation
Without the ability to really examine the full replay of a test that failed in CI, I can only assume that saving a dashboard and trying to edit it again was causing the failures. Most likely some re-rendering that prevented Cypress from clicking on ""Edit dashboard"". See the screenshot above.

### Solution
Remove this sequence as it doesn't make sense anyway
```js
saveDashboard();
editDashboard();
```

We are already in the edit dashboard mode. No need to save only to edit again.
The only reason why you'd save it was to assert on the card sizes. And since that doesn't happen in this test, I can only conclude that this sequence is redundant.

### Additional notes
> [!Important]
> Never **ever** store Cypress selectors in a variable! This doesn't work how you'd expect it.
> Please read [this section](https://docs.cypress.io/guides/references/best-practices#Assigning-Return-Values) from Cypress' best practices.

### Stress-test
- 5/5 ✅ https://github.com/metabase/metabase/actions/runs/10100465772
- 10/10 ✅ https://github.com/metabase/metabase/actions/runs/10100549777
- 20/20 ✅  (in progress) https://github.com/metabase/metabase/actions/runs/10100668786",nemanjaglumac,2024-07-25 20:13:18+00:00,['nemanjaglumac'],2024-07-25 22:00:19+00:00,2024-07-25 21:32:35+00:00,https://github.com/metabase/metabase/pull/46158,"[('.CI & Tests', ''), ('backport', 'Automatically create PR on current release branch on merge'), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2430847606,pull_request,closed,,"🤖 backported ""Saving SDK data for embedding statistics""","  #45954
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-25 19:31:03+00:00,"['escherize', 'github-automation-metabase']",2024-07-25 19:55:36+00:00,2024-07-25 19:55:35+00:00,https://github.com/metabase/metabase/pull/46157,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2251290518, 'issue_id': 2430847606, 'author': 'escherize', 'body': 'Decided not to backport this.', 'created_at': datetime.datetime(2024, 7, 25, 19, 55, 35, tzinfo=datetime.timezone.utc)}]","escherize (Assginee) on (2024-07-25 19:55:35 UTC): Decided not to backport this.

"
2430829759,pull_request,closed,,docs - notes on memory usage,Updates some docs on memory usage and troubleshooting. Specifically talks about how JVM memory usage differs from Metabase's memory usage.,jeff-bruemmer,2024-07-25 19:18:51+00:00,['jeff-bruemmer'],2024-08-16 14:15:07+00:00,2024-08-16 13:34:49+00:00,https://github.com/metabase/metabase/pull/46156,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2263334224, 'issue_id': 2430829759, 'author': 'paoliniluis', 'body': 'This PR should shed light on https://github.com/metabase/metabase/issues/12060', 'created_at': datetime.datetime(2024, 8, 1, 15, 17, 46, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-08-01 15:17:46 UTC): This PR should shed light on https://github.com/metabase/metabase/issues/12060

"
2430668785,pull_request,closed,,"🤖 backported ""Request-level caching for sandboxes""",#46138,github-automation-metabase,2024-07-25 17:56:59+00:00,"['noahmoss', 'github-automation-metabase']",2024-07-25 18:46:12+00:00,2024-07-25 18:46:11+00:00,https://github.com/metabase/metabase/pull/46155,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2430521760,pull_request,closed,,"🤖 backported ""Localize 'Settings' in command palette""",#46124,github-automation-metabase,2024-07-25 16:37:05+00:00,"['rafpaf', 'github-automation-metabase']",2024-07-25 17:04:03+00:00,2024-07-25 17:04:02+00:00,https://github.com/metabase/metabase/pull/46153,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2430475414,pull_request,closed,,[#44984] Ensure consistent information icon display across all cards in dashboards,"This PR addresses an inconsistency in the display of the information icon (i) across different card types in dashboards. Previously, only the number card showed the information icon without requiring a hover action. With these changes, the information icon will now be consistently displayed for all card types that have a description, improving data accessibility for users.

Changes include:
- Adding a consistent rendering of the information icon for all card types in the `DashCardInner` component.
- Removing conditional rendering specifically for number cards.
- Ensuring proper z-index handling in the `DashCardRoot` component.
- Updating the icon size to be consistent across all usages.

---

Tips:

- Make sure to test changes before merging.
- **Submit a ""Request Changes"" review and I'll address it.**
- Close this PR with a comment if it's obviously incorrect. This will improve my future PRs.
- Go to the [Tusk activity logs](https://usetusk.ai/app/task/b6c409c8-07a6-493b-a71a-ca434210a7d4?client=3086848b-0d35-4181-be6a-28e39c94ef4d) or [issue](https://github.com/metabase/metabase/issues/44984) to see more details.",use-tusk[bot],2024-07-25 16:21:10+00:00,[],2024-07-25 16:22:13+00:00,2024-07-25 16:22:11+00:00,https://github.com/metabase/metabase/pull/46152,[],[],
2430455735,pull_request,closed,,Fix redshift flakes in describe-database,"Resolves https://github.com/metabase/metabase/issues/45874

This PR fixes the redshift flakes in `metabase.driver/describe-database` and removes the previously added auto-retry logic.

I don't want to backport this yet because it feels a little risky to go out to all customers on a minor version.

The tricky part is proving that the set of tables returned by the new method is the same as the old method under all configurations. There have been holes in our test coverage before.",calherries,2024-07-25 16:14:42+00:00,[],2025-02-04 01:31:43+00:00,2025-02-04 01:31:42+00:00,https://github.com/metabase/metabase/pull/46151,"[('Stale', 'Stale PRs that will be auto-closed'), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2251910969, 'issue_id': 2430455735, 'author': 'qnkhuat', 'body': 'Do you know why Redshift suddenly flaked more recently? This behavior was there for a long time.', 'created_at': datetime.datetime(2024, 7, 26, 3, 54, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2252296467, 'issue_id': 2430455735, 'author': 'calherries', 'body': ""yeah, Cam turned on dropping tables after redshift CSV upload tests completed. Previously I left the tables around to avoid flakes. It was for https://github.com/metabase/metabase/pull/45268\r\n\r\nI'll investigate why the redshift job is failing later today and then add the team for review"", 'created_at': datetime.datetime(2024, 7, 26, 9, 4, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2256198576, 'issue_id': 2430455735, 'author': 'calherries', 'body': 'I tested with this code from Cam\'s https://github.com/metabase/metabase/issues/45874, and it passed:\r\n\r\n```\r\n(mt/test-driver :redshift\r\n    ;; make sure test data is loaded\r\n    (mt/db)\r\n    ;; create a DIFFERENT schema than our unique-session-schema to fill with trash asynchronously\r\n    (let [do-with-connection (fn [f]\r\n                               (sql-jdbc.execute/do-with-connection-with-options\r\n                                :redshift\r\n                                (sql-jdbc.conn/connection-details->spec :redshift @redshift.test/db-connection-details)\r\n                                {:write? true}\r\n                                f))\r\n          schema             (str (redshift.test/unique-session-schema) ""_2"")]\r\n      (locking println (println ""UNIQUE SESSION SCHEMA ="" (redshift.test/unique-session-schema)))\r\n      (try\r\n        (do-with-connection\r\n         (fn [^java.sql.Connection conn]\r\n           (with-open [stmt (.createStatement conn)]\r\n             (.execute stmt (format ""CREATE SCHEMA IF NOT EXISTS \\""%s\\"";"" schema)))))\r\n        ;; now asynchronously load a bunch of trash into the schema\r\n        (let [fut (future\r\n                    (do-with-connection\r\n                     (fn [^java.sql.Connection conn]\r\n                       (with-open [stmt (.createStatement conn)]\r\n                         (dotimes [_ 100]\r\n                           (let [table (str/lower-case (mt/random-name))]\r\n                             (locking println (println ""CREATING AND DROPPING"" schema table))\r\n                             (.execute stmt (format ""CREATE TABLE \\""%s\\"".\\""%s\\"" (id INTEGER);"" schema table))\r\n                             (.execute stmt (format ""DROP TABLE \\""%s\\"".\\""%s\\"";"" schema table))))))))]\r\n          (try\r\n            ;; now run sync a bunch of times and make sure it completes ok.\r\n            (dotimes [i 100]\r\n              (locking println (println ""Sync #"" i))\r\n              (let [sync-tables (:tables (driver/describe-database :redshift (mt/db)))]\r\n                (doseq [{sync-table-name :name, :as synced-table} sync-tables]\r\n                  (testing (format ""\\nsynced table: %s"" (u/pprint-to-str synced-table))\r\n                    (is (or (str/starts-with? sync-table-name ""test_data_"")\r\n                            (= sync-table-name ""extsales"")\r\n                            (#{""ioczvlzuryxmervumwrn"" ""umcwdqwjjaagvmrgrdhi""} sync-table-name)))))))\r\n            (finally\r\n              ;; cancel the async trash-loading future if it\'s still running.\r\n              (future-cancel fut))))\r\n        (finally\r\n          ;; clean up after ourselves and drop the test schema.\r\n          (do-with-connection\r\n           (fn [^java.sql.Connection conn]\r\n             (with-open [stmt (.createStatement conn)]\r\n               (.execute stmt (format ""DROP SCHEMA \\""%s\\"";"" schema)))))))))\r\n```', 'created_at': datetime.datetime(2024, 7, 29, 15, 8, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2256700143, 'issue_id': 2430455735, 'author': 'calherries', 'body': 'Sadly this isn\'t preventing the flakes yet, even if it passes Cam\'s test. \r\n\r\nexample flake: https://github.com/metabase/metabase/actions/runs/10146759756/job/28055615894?pr=46151#step:3:1233\r\n```\r\nERROR in metabase.upload-test/with-upload-table!-and-do-with-uploaded-example-csv!-test (execute.clj:760)\r\nwith-upload-table! and do-with-uploaded-example-csv! should ACTUALLY clean up after themselves \r\n:redshift\r\n\r\nexpected: (= original-table-names (table-names))\r\n  actual: \r\n                clojure.lang.ExceptionInfo: Error executing query: ERROR: schema ""metabase_cache_ba490_109"" does not exist\r\n    driver: :redshift\r\n    params: nil\r\n       sql: [""select""\r\n             ""  table_name as name,""\r\n             ""  schema_name as schema,""\r\n             ""  table_type as type,""\r\n             ""  remarks as description""\r\n             ""from""\r\n             ""  svv_redshift_tables t""\r\n             ""where""\r\n             ""  schema_name ! ~ \'^information_schema|catalog_history|pg_|metabase_cache_\'""\r\n             ""  and database_name = current_database()""\r\n             ...]\r\ncom.amazon.redshift.util.RedshiftException: ERROR: schema ""metabase_cache_ba490_109"" does not exist\r\n              SQLState: ""3F000""\r\n```\r\n\r\nSeems like there\'s something the test is not capturing', 'created_at': datetime.datetime(2024, 7, 29, 19, 9, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2297103420, 'issue_id': 2430455735, 'author': 'calherries', 'body': ""The changes in this PR fix the problem for dropping tables; [this test](https://github.com/metabase/metabase/pull/46151/files#diff-f22bf00b3a1cf03bc8f66bdb66949d3a08465617121f062b74711a96bb67a33fR549) passes when retries are disabled.\r\n\r\nBut it doesn't solve the problem for dropping schemas; [this test](https://github.com/metabase/metabase/pull/46151/files#diff-f22bf00b3a1cf03bc8f66bdb66949d3a08465617121f062b74711a96bb67a33fR549) fails."", 'created_at': datetime.datetime(2024, 8, 19, 17, 44, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603450172, 'issue_id': 2430455735, 'author': 'github-actions[bot]', 'body': 'This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.', 'created_at': datetime.datetime(2025, 1, 21, 1, 31, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2632557986, 'issue_id': 2430455735, 'author': 'github-actions[bot]', 'body': 'This pull request was closed because it had no activity for more than 90 days.', 'created_at': datetime.datetime(2025, 2, 4, 1, 31, 42, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-07-26 03:54:46 UTC): Do you know why Redshift suddenly flaked more recently? This behavior was there for a long time.

calherries (Issue Creator) on (2024-07-26 09:04:40 UTC): yeah, Cam turned on dropping tables after redshift CSV upload tests completed. Previously I left the tables around to avoid flakes. It was for https://github.com/metabase/metabase/pull/45268

I'll investigate why the redshift job is failing later today and then add the team for review

calherries (Issue Creator) on (2024-07-29 15:08:26 UTC): I tested with this code from Cam's https://github.com/metabase/metabase/issues/45874, and it passed:

```
(mt/test-driver :redshift
    ;; make sure test data is loaded
    (mt/db)
    ;; create a DIFFERENT schema than our unique-session-schema to fill with trash asynchronously
    (let [do-with-connection (fn [f]
                               (sql-jdbc.execute/do-with-connection-with-options
                                :redshift
                                (sql-jdbc.conn/connection-details->spec :redshift @redshift.test/db-connection-details)
                                {:write? true}
                                f))
          schema             (str (redshift.test/unique-session-schema) ""_2"")]
      (locking println (println ""UNIQUE SESSION SCHEMA ="" (redshift.test/unique-session-schema)))
      (try
        (do-with-connection
         (fn [^java.sql.Connection conn]
           (with-open [stmt (.createStatement conn)]
             (.execute stmt (format ""CREATE SCHEMA IF NOT EXISTS \""%s\"";"" schema)))))
        ;; now asynchronously load a bunch of trash into the schema
        (let [fut (future
                    (do-with-connection
                     (fn [^java.sql.Connection conn]
                       (with-open [stmt (.createStatement conn)]
                         (dotimes [_ 100]
                           (let [table (str/lower-case (mt/random-name))]
                             (locking println (println ""CREATING AND DROPPING"" schema table))
                             (.execute stmt (format ""CREATE TABLE \""%s\"".\""%s\"" (id INTEGER);"" schema table))
                             (.execute stmt (format ""DROP TABLE \""%s\"".\""%s\"";"" schema table))))))))]
          (try
            ;; now run sync a bunch of times and make sure it completes ok.
            (dotimes [i 100]
              (locking println (println ""Sync #"" i))
              (let [sync-tables (:tables (driver/describe-database :redshift (mt/db)))]
                (doseq [{sync-table-name :name, :as synced-table} sync-tables]
                  (testing (format ""\nsynced table: %s"" (u/pprint-to-str synced-table))
                    (is (or (str/starts-with? sync-table-name ""test_data_"")
                            (= sync-table-name ""extsales"")
                            (#{""ioczvlzuryxmervumwrn"" ""umcwdqwjjaagvmrgrdhi""} sync-table-name)))))))
            (finally
              ;; cancel the async trash-loading future if it's still running.
              (future-cancel fut))))
        (finally
          ;; clean up after ourselves and drop the test schema.
          (do-with-connection
           (fn [^java.sql.Connection conn]
             (with-open [stmt (.createStatement conn)]
               (.execute stmt (format ""DROP SCHEMA \""%s\"";"" schema)))))))))
```

calherries (Issue Creator) on (2024-07-29 19:09:02 UTC): Sadly this isn't preventing the flakes yet, even if it passes Cam's test. 

example flake: https://github.com/metabase/metabase/actions/runs/10146759756/job/28055615894?pr=46151#step:3:1233
```
ERROR in metabase.upload-test/with-upload-table!-and-do-with-uploaded-example-csv!-test (execute.clj:760)
with-upload-table! and do-with-uploaded-example-csv! should ACTUALLY clean up after themselves 
:redshift

expected: (= original-table-names (table-names))
  actual: 
                clojure.lang.ExceptionInfo: Error executing query: ERROR: schema ""metabase_cache_ba490_109"" does not exist
    driver: :redshift
    params: nil
       sql: [""select""
             ""  table_name as name,""
             ""  schema_name as schema,""
             ""  table_type as type,""
             ""  remarks as description""
             ""from""
             ""  svv_redshift_tables t""
             ""where""
             ""  schema_name ! ~ '^information_schema|catalog_history|pg_|metabase_cache_'""
             ""  and database_name = current_database()""
             ...]
com.amazon.redshift.util.RedshiftException: ERROR: schema ""metabase_cache_ba490_109"" does not exist
              SQLState: ""3F000""
```

Seems like there's something the test is not capturing

calherries (Issue Creator) on (2024-08-19 17:44:17 UTC): The changes in this PR fix the problem for dropping tables; [this test](https://github.com/metabase/metabase/pull/46151/files#diff-f22bf00b3a1cf03bc8f66bdb66949d3a08465617121f062b74711a96bb67a33fR549) passes when retries are disabled.

But it doesn't solve the problem for dropping schemas; [this test](https://github.com/metabase/metabase/pull/46151/files#diff-f22bf00b3a1cf03bc8f66bdb66949d3a08465617121f062b74711a96bb67a33fR549) fails.

github-actions[bot] on (2025-01-21 01:31:35 UTC): This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.

github-actions[bot] on (2025-02-04 01:31:42 UTC): This pull request was closed because it had no activity for more than 90 days.

"
2430405172,pull_request,closed,,Updating Tusk Sanity GitHub workflow,"This PR updates the Tusk Sanity GitHub workflow to the repo. This will allow Tusk to automatically lint, build, and test code - resulting in higher quality PRs.

This workflow will only be run when you trigger Tusk to work on an issue. If you have any questions, please contact [support@usetusk.ai](mailto:support@usetusk.ai).",use-tusk[bot],2024-07-25 15:58:53+00:00,[],2024-10-08 16:19:41+00:00,2024-07-25 16:19:00+00:00,https://github.com/metabase/metabase/pull/46150,"[('no-backport', 'Do not backport this PR to any branch')]",[],
2430312399,pull_request,closed,,"[serdes] convert database, card and dashboard with friends to using spec","This converts a few models to using new spec - with Dashboard being arguably the most complex (with double nesting) in our codebase.

I think the new `nested` helper turned out to be nice, much nicer than track-nested-stuff-manually approach we had before. It handles three different cases - when there are no entity ids, when entity ids are actually identity hashes, and when there are normal entity ids. But IMO a bit of complexity is worth the result, in usage locations it's succinct and clear. It's not handling `:position` though - we decided to store that explicitly.

I did not go to making FKs determine what to do from db schema — mostly because it'll require changing calling convention and I don't want to do that until everything is done by specification rather than raw code.

References #43068 

",piranha,2024-07-25 15:28:52+00:00,['piranha'],2024-08-14 06:58:38+00:00,2024-08-12 13:19:58+00:00,https://github.com/metabase/metabase/pull/46147,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2430291944,pull_request,closed,,test(jest): get rid of warnings about duplicate manual mock,"### Description

Get rid of the warning 

```
jest-haste-map: duplicate manual mock found: index
  The following files share their name; please delete one of them:
    * <rootDir>/frontend/src/metabase/components/ExplicitSize/__mocks__/index.ts
    * <rootDir>/frontend/src/metabase/query_builder/components/NativeQueryEditor/__mocks__/index.ts
```

[context](https://metaboat.slack.com/archives/C0669P4AF9N/p1721827674299859)

### How to verify

`yarn jest` shouldn't print this warning

### Demo

<img width=""1230"" alt=""image"" src=""https://github.com/user-attachments/assets/39eebb03-6783-483d-a850-4888accf6c9f"">

",uladzimirdev,2024-07-25 15:22:02+00:00,['uladzimirdev'],2024-10-08 16:19:25+00:00,2024-07-29 10:03:27+00:00,https://github.com/metabase/metabase/pull/46146,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]",[],
2430265936,pull_request,closed,,"🤖 backported ""[E2E] Rewrite and expand repro #27643""",#45887,github-automation-metabase,2024-07-25 15:12:14+00:00,"['nemanjaglumac', 'github-automation-metabase']",2024-07-25 15:41:57+00:00,2024-07-25 15:41:56+00:00,https://github.com/metabase/metabase/pull/46145,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2430264081,pull_request,closed,,"🤖 backported ""Bigquery Pagination Use next page to get proper results""",#46095,github-automation-metabase,2024-07-25 15:11:28+00:00,"['adam-james-v', 'github-automation-metabase']",2024-07-25 16:03:24+00:00,2024-07-25 16:03:23+00:00,https://github.com/metabase/metabase/pull/46144,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2430173124,pull_request,closed,,Detect queries referencing unknown fields,"Closes https://github.com/metabase/metabase/issues/45027

### Description

This change modifies the Query Analysis persistence to also record columns which could not be resolved to fields we've previously found during a sync. It then exposes these new rows as a new kind of error in the Query Reference Validation API.",crisptrutski,2024-07-25 14:45:53+00:00,['crisptrutski'],2024-07-30 16:31:43+00:00,2024-07-30 09:28:54+00:00,https://github.com/metabase/metabase/pull/46143,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2250628534, 'issue_id': 2430173124, 'author': 'crisptrutski', 'body': '* **#46283** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46283?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46185** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46185?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46143** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46143?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* **#46128** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46128?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46101** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46101?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 25, 15, 9, 59, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-07-25 15:09:59 UTC): * **#46283** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46283?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46185** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46185?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46143** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46143?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* **#46128** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46128?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46101** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46101?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2430143531,pull_request,closed,,Upgrade Spark deps,Let's see if this passes the tests,paoliniluis,2024-07-25 14:37:11+00:00,['paoliniluis'],2025-02-05 17:05:47+00:00,2024-08-30 20:31:20+00:00,https://github.com/metabase/metabase/pull/46142,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2322293411, 'issue_id': 2430143531, 'author': 'paoliniluis', 'body': ""This won't pass the tests so closing"", 'created_at': datetime.datetime(2024, 8, 30, 20, 31, 20, tzinfo=datetime.timezone.utc)}]","paoliniluis (Issue Creator) on (2024-08-30 20:31:20 UTC): This won't pass the tests so closing

"
2430134471,pull_request,closed,,"🤖 backported ""Add v0.50.16 to the list of releases""",#46118,github-automation-metabase,2024-07-25 14:34:01+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-25 14:35:43+00:00,2024-07-25 14:35:42+00:00,https://github.com/metabase/metabase/pull/46141,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2430109025,pull_request,closed,,[#44813] Fix empty state issue by showing loading state in new model page,"**Note:** This branch was not able to pass automated checks, but the failure seems unrelated to the task.

This PR addresses the issue where an empty state is displayed instead of a loading state on the new model page. The problem was particularly noticeable with network throttling during data fetching.

Changes:
- Implemented `DelayedLoadingAndErrorWrapper` component in `ModelDetailPage` to show a loading spinner while data is being fetched.
- Removed the premature return of the NotFound component for archived models.
- Updated the `useEffect` hook to include a null check for the model.
- Enhanced existing unit tests to cover the new loading and error states.

These changes ensure that the user sees a loading indicator while data is being fetched, improving the user experience on the new model page.

---

Tips:

- Make sure to test changes before merging.
- **Submit a ""Request Changes"" review and I'll address it.**
- Close this PR with a comment if it's obviously incorrect. This will improve my future PRs.
- Go to the [Tusk activity logs](https://usetusk.ai/app/task/07fb1112-5b89-4996-a151-2743eb6a5195?client=3086848b-0d35-4181-be6a-28e39c94ef4d) or [issue](https://github.com/metabase/metabase/issues/44813) to see more details.",use-tusk[bot],2024-07-25 14:24:38+00:00,[],2024-07-26 01:18:22+00:00,2024-07-26 01:18:20+00:00,https://github.com/metabase/metabase/pull/46139,[],[],
2430102038,pull_request,closed,,Request-level caching for sandboxes,"Adds request-level caching for sandboxes, similar to how we do caching for data permissions.",noahmoss,2024-07-25 14:21:29+00:00,['noahmoss'],2024-07-25 18:46:44+00:00,2024-07-25 17:55:17+00:00,https://github.com/metabase/metabase/pull/46138,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2250448849, 'issue_id': 2430102038, 'author': 'noahmoss', 'body': '* **#46138** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46138?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 25, 14, 21, 46, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-07-25 14:21:46 UTC): * **#46138** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46138?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2430092428,pull_request,closed,,"🤖 backported ""Make the sandbox cleanup logic more robust, and reorganize some perms code for better testing""",#46102,github-automation-metabase,2024-07-25 14:17:11+00:00,"['noahmoss', 'github-automation-metabase']",2024-07-25 15:06:39+00:00,2024-07-25 15:06:38+00:00,https://github.com/metabase/metabase/pull/46136,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2430088462,pull_request,closed,,"🤖 backported ""Number formatter Reports correct Decimal places for negative Numbers""",#46104,github-automation-metabase,2024-07-25 14:15:22+00:00,"['adam-james-v', 'github-automation-metabase']",2024-07-25 15:03:24+00:00,2024-07-25 15:03:23+00:00,https://github.com/metabase/metabase/pull/46135,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2430012750,pull_request,closed,,Remove extra scrollbars from summarization sidebar,"Fixes #45452 

before:
<img width=""353"" alt=""image"" src=""https://github.com/user-attachments/assets/8b33cdc2-9184-4829-a2a2-5545e1115d8d"">


after:
<img width=""359"" alt=""image"" src=""https://github.com/user-attachments/assets/322b00d5-4e3a-4996-9afd-3fe8501d6b47"">
",oisincoveney,2024-07-25 13:43:29+00:00,['oisincoveney'],2024-07-25 16:26:04+00:00,2024-07-25 16:26:02+00:00,https://github.com/metabase/metabase/pull/46134,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2250510330, 'issue_id': 2430012750, 'author': 'github-actions[bot]', 'body': '@oisincoveney You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 7, 25, 14, 42, 36, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-25 14:42:36 UTC): @oisincoveney You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2430005995,pull_request,closed,,[perf] Add a test for the Clojure-side `lib.cache/side-channel-cache`,"This was missed in the original PR #45394 due to clumsy `git`
wrangling; my bad.

",bshepherdson,2024-07-25 13:40:17+00:00,['bshepherdson'],2024-07-26 18:48:28+00:00,2024-07-26 15:00:27+00:00,https://github.com/metabase/metabase/pull/46133,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2250351482, 'issue_id': 2430005995, 'author': 'bshepherdson', 'body': '* **#46133** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46133?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 25, 13, 40, 32, tzinfo=datetime.timezone.utc)}]","bshepherdson (Issue Creator) on (2024-07-25 13:40:32 UTC): * **#46133** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46133?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2430000716,pull_request,closed,,download_results_clicked event,"Part of MS3 of https://github.com/metabase/metabase/issues/42628

This PR adds the `downloads_results_clicked` event with the following schema:
```
resource_type: ""question"" | ""dashcard"" | ""ad-hoc-question"",
accessed_via: ""internal"" | ""public-link"" | ""static-embed"" | ""interactive-iframe-embed"" | ""sdk-embed"",
export_type: ""png"" | ""csv"" etc
```

To make the implementation easier I did a bit of refactor, before this pr we had a `getDatasetParams` that based on the presence of various fields and ids determined which kind of resource we were trying to download and returned its endpoint.

I moved the logic to determine the resource type to `getDownloadedResourceType`, it returns the kind of resource (question/dashcard,ad-hoc-question) and how it's accessed (internal, public-link, etc) so I can use those values for the analytics.

I then changed `getDatasetParams` to use the return value of `getDownloadedResourceType` to return the endpoints


Asking review also to @metabase/core-frontend-dashviz because of the event added in main MB",npretto,2024-07-25 13:37:55+00:00,['npretto'],2024-08-01 17:03:18+00:00,2024-08-01 17:03:16+00:00,https://github.com/metabase/metabase/pull/46132,"[('.Team/Embedding', '')]",[],
2429901819,pull_request,closed,,"🤖 backported ""Don't show ""Download results"" button until dashcard query is complete""","  #46060
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-25 12:57:43+00:00,"['kulyk', 'github-automation-metabase']",2024-07-26 14:50:13+00:00,2024-07-26 14:50:11+00:00,https://github.com/metabase/metabase/pull/46131,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2429789741,pull_request,closed,,Manual backport — Fix document title when opening a multi-series question from dashboard,Manual backport of https://github.com/metabase/metabase/pull/46004,kulyk,2024-07-25 12:03:24+00:00,['kulyk'],2024-07-25 16:31:39+00:00,2024-07-25 16:31:14+00:00,https://github.com/metabase/metabase/pull/46130,"[('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2250163055, 'issue_id': 2429789741, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 0813d74e5936a6d48687f43b7882d5bf20eac4d6...330e856db465cf1a20d2ec0532cfc3154ca67764.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/visualizations/CartesianChart/CartesianChart.tsx |', 'created_at': datetime.datetime(2024, 7, 25, 12, 4, 50, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-25 12:04:50 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 0813d74e5936a6d48687f43b7882d5bf20eac4d6...330e856db465cf1a20d2ec0532cfc3154ca67764.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/visualizations/CartesianChart/CartesianChart.tsx |

"
2429766027,pull_request,closed,,[#44591] Fix inconsistent scaling of info icons based on question name length,"This PR addresses the issue where the 'i' icon on the collection screen scales inconsistently based on the length of the question's name, particularly when names are truncated with ellipses. The primary changes include the introduction of an `IconContainer` component to standardize the icon size across various components, ensuring that the icons maintain a consistent appearance regardless of the surrounding text length. This fix has been applied across multiple components where the icon is used. Please review the changes to ensure that the fix works as intended across different screen sizes and question name lengths.

---

Tips:

- Make sure to test changes before merging.
- **Submit a ""Request Changes"" review and I'll address it.**
- Close this PR with a comment if it's obviously incorrect. This will improve my future PRs.
- Go to the [Tusk activity logs](https://usetusk.ai/app/task/fb74d305-0337-4798-a2ed-18ef3bfa90be?client=3086848b-0d35-4181-be6a-28e39c94ef4d) or [issue](https://github.com/metabase/metabase/issues/44591) to see more details.",use-tusk[bot],2024-07-25 11:50:59+00:00,[],2024-07-26 09:13:22+00:00,2024-07-26 09:13:22+00:00,https://github.com/metabase/metabase/pull/46129,[],"[{'comment_id': 2250167327, 'issue_id': 2429766027, 'author': 'use-tusk[bot]', 'body': 'Addressing your review. View [activity logs](https://usetusk.ai/app/task/fb74d305-0337-4798-a2ed-18ef3bfa90be?client=3086848b-0d35-4181-be6a-28e39c94ef4d) for details.', 'created_at': datetime.datetime(2024, 7, 25, 12, 7, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2250173141, 'issue_id': 2429766027, 'author': 'use-tusk[bot]', 'body': ""@ranquild your review will **not** be addressed. Re-submit your review after I finish addressing NevRA's review."", 'created_at': datetime.datetime(2024, 7, 25, 12, 10, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2250193187, 'issue_id': 2429766027, 'author': 'use-tusk[bot]', 'body': ""@NevRA I've addressed your review. Add another review if minor changes are needed."", 'created_at': datetime.datetime(2024, 7, 25, 12, 21, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2250194822, 'issue_id': 2429766027, 'author': 'use-tusk[bot]', 'body': 'Addressing your review. View [activity logs](https://usetusk.ai/app/task/fb74d305-0337-4798-a2ed-18ef3bfa90be?client=3086848b-0d35-4181-be6a-28e39c94ef4d) for details.', 'created_at': datetime.datetime(2024, 7, 25, 12, 22, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2250365980, 'issue_id': 2429766027, 'author': 'use-tusk[bot]', 'body': ""@ranquild I've addressed your review, but the automated checks are failing. If the PR is still not correct, consider closing it with a comment explaining why. This will improve my future PRs."", 'created_at': datetime.datetime(2024, 7, 25, 13, 46, 58, tzinfo=datetime.timezone.utc)}]","use-tusk[bot] (Issue Creator) on (2024-07-25 12:07:17 UTC): Addressing your review. View [activity logs](https://usetusk.ai/app/task/fb74d305-0337-4798-a2ed-18ef3bfa90be?client=3086848b-0d35-4181-be6a-28e39c94ef4d) for details.

use-tusk[bot] (Issue Creator) on (2024-07-25 12:10:25 UTC): @ranquild your review will **not** be addressed. Re-submit your review after I finish addressing NevRA's review.

use-tusk[bot] (Issue Creator) on (2024-07-25 12:21:51 UTC): @NevRA I've addressed your review. Add another review if minor changes are needed.

use-tusk[bot] (Issue Creator) on (2024-07-25 12:22:47 UTC): Addressing your review. View [activity logs](https://usetusk.ai/app/task/fb74d305-0337-4798-a2ed-18ef3bfa90be?client=3086848b-0d35-4181-be6a-28e39c94ef4d) for details.

use-tusk[bot] (Issue Creator) on (2024-07-25 13:46:58 UTC): @ranquild I've addressed your review, but the automated checks are failing. If the PR is still not correct, consider closing it with a comment explaining why. This will improve my future PRs.

"
2429734648,pull_request,closed,,"Track table references, even if we don't query their columns","References https://github.com/metabase/metabase/issues/45028

### Description

Queries like `SELECT (*) FROM foo` do not reference any queries, yet their table references should still be tracked - for example to handle renaming.

This is a pure refactor, we do not start to persist this additional data yet.",crisptrutski,2024-07-25 11:33:46+00:00,['crisptrutski'],2024-10-08 16:19:23+00:00,2024-07-29 13:02:10+00:00,https://github.com/metabase/metabase/pull/46128,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2250112499, 'issue_id': 2429734648, 'author': 'crisptrutski', 'body': '* **#46283** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46283?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46185** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46185?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46143** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46143?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46128** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46128?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* **#46101** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46101?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 25, 11, 34, 2, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-07-25 11:34:02 UTC): * **#46283** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46283?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46185** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46185?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46143** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46143?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46128** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46128?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* **#46101** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46101?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2429665751,pull_request,closed,,"🤖 backported ""Make drivers build in parallel rather than sequentially""",#45897,github-automation-metabase,2024-07-25 10:57:47+00:00,"['paoliniluis', 'github-automation-metabase']",2024-07-25 11:46:21+00:00,2024-07-25 11:46:20+00:00,https://github.com/metabase/metabase/pull/46126,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2429583715,pull_request,closed,,"🤖 backported ""Enable e2e repro for the issue #38181""",#46082,github-automation-metabase,2024-07-25 10:15:08+00:00,"['lbrdnk', 'github-automation-metabase']",2024-07-25 10:41:49+00:00,2024-07-25 10:41:49+00:00,https://github.com/metabase/metabase/pull/46125,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2429557070,pull_request,closed,,Localize 'Settings' in command palette,"![image.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/utGnP2ljFMMNOgi82vVn/7e3cc05e-1d19-41e4-a424-2dca68eac93a.png)

Closes #46123
",rafpaf,2024-07-25 10:02:19+00:00,['rafpaf'],2024-07-25 16:36:21+00:00,2024-07-25 16:36:19+00:00,https://github.com/metabase/metabase/pull/46124,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2249953418, 'issue_id': 2429557070, 'author': 'rafpaf', 'body': '* **#46124** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46124?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 25, 10, 2, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2250868445, 'issue_id': 2429557070, 'author': 'rafpaf', 'body': '### Merge activity\n\n* **Jul 25, 12:17 PM EDT**: @rafpaf started a stack merge that includes this pull request via [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/46124).\n* **Jul 25, 12:18 PM EDT**: [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/46124) couldn\'t merge this PR because it failed optional checks and ""ignore optional checks"" was not selected.', 'created_at': datetime.datetime(2024, 7, 25, 16, 17, 55, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-07-25 10:02:35 UTC): * **#46124** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46124?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

rafpaf (Issue Creator) on (2024-07-25 16:17:55 UTC): ### Merge activity

* **Jul 25, 12:17 PM EDT**: @rafpaf started a stack merge that includes this pull request via [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/46124).
* **Jul 25, 12:18 PM EDT**: [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/46124) couldn't merge this PR because it failed optional checks and ""ignore optional checks"" was not selected.

"
2429530811,pull_request,closed,,"🤖 backported ""Fix document title when opening a multi-series question from dashboard""","  #46004
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-25 09:51:10+00:00,"['kulyk', 'github-automation-metabase']",2024-07-25 12:03:54+00:00,2024-07-25 12:03:50+00:00,https://github.com/metabase/metabase/pull/46122,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2250161369, 'issue_id': 2429530811, 'author': 'kulyk', 'body': 'Manual backport: #46130', 'created_at': datetime.datetime(2024, 7, 25, 12, 3, 50, tzinfo=datetime.timezone.utc)}]","kulyk (Assginee) on (2024-07-25 12:03:50 UTC): Manual backport: #46130

"
2429514864,pull_request,closed,,"🤖 backported ""Refactor e2e dashboard helpers to TypeScript""",  #46037,github-automation-metabase,2024-07-25 09:43:04+00:00,"['kamilmielnik', 'github-automation-metabase']",2024-07-26 08:51:46+00:00,2024-07-26 08:51:45+00:00,https://github.com/metabase/metabase/pull/46121,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2429472914,pull_request,closed,,Try the latest Chrome 127 [WIP],"> [!IMPORTANT]
> For those employed by Metabase: if you are merging into master, please add either a `backport` or a `no-backport` label to this PR. You will not be able to merge until you do this step. Refer to the section [Do I need to backport this PR?](https://www.notion.so/metabase/Metabase-Branching-Strategy-6eb577d5f61142aa960a626d6bbdfeb3?pvs=4#89f80d6f17714a0198aeb66c0efd1b71) in the Metabase Branching Strategy document for more details. If you're not employed by Metabase, this section does not apply to you, and the label will be taken care of by your reviewer.

> **Warning**
>
> If that is your first contribution to Metabase, please sign the [Contributor License Agreement](https://docs.google.com/a/metabase.com/forms/d/1oV38o7b9ONFSwuzwmERRMi9SYrhYeOrkbmNaq9pOJ_E/viewform) (unless it's a tiny documentation change). Also, if you're attempting to fix a translation issue, please submit your changes to our [POEditor project](https://poeditor.com/join/project/ynjQmwSsGh) instead of opening a PR.

Closes https://github.com/metabase/metabase/issues/[issue_number]

### Description

Describe the overall approach and the problem being solved.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. New question -> Sample Dataset -> ...
2. ...

### Demo

_Upload a demo video or before/after screenshots if sensible or remove the section_

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",nemanjaglumac,2024-07-25 09:22:57+00:00,['nemanjaglumac'],2024-07-25 12:22:44+00:00,2024-07-25 12:22:40+00:00,https://github.com/metabase/metabase/pull/46120,"[('do not merge', ''), ('.Team/Querying', '')]","[{'comment_id': 2250194621, 'issue_id': 2429472914, 'author': 'nemanjaglumac', 'body': 'Nope!', 'created_at': datetime.datetime(2024, 7, 25, 12, 22, 40, tzinfo=datetime.timezone.utc)}]","nemanjaglumac (Issue Creator) on (2024-07-25 12:22:40 UTC): Nope!

"
2429352879,pull_request,closed,,Add v0.50.16 to the list of releases,Like it says on the tin 😁,github-automation-metabase,2024-07-25 08:26:16+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-25 14:36:08+00:00,2024-07-25 14:33:16+00:00,https://github.com/metabase/metabase/pull/46118,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2429134168,pull_request,closed,,"🤖 backported ""Fix accidental comma in location.svg""",#46056,github-automation-metabase,2024-07-25 06:30:47+00:00,"['kamilmielnik', 'github-automation-metabase']",2024-07-25 06:35:02+00:00,2024-07-25 06:35:01+00:00,https://github.com/metabase/metabase/pull/46117,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2249561243, 'issue_id': 2429134168, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff cdbb88a4d79218d86be918761b9f3018e947da74...1ebdc63bb3766875bdd47c31a2dbeee9a9b11b16.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/location.svg |', 'created_at': datetime.datetime(2024, 7, 25, 6, 32, 14, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-25 06:32:14 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff cdbb88a4d79218d86be918761b9f3018e947da74...1ebdc63bb3766875bdd47c31a2dbeee9a9b11b16.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/location.svg |

"
2429082658,pull_request,closed,,Updating Tusk Sanity GitHub workflow,"This PR updates the Tusk Sanity GitHub workflow to the repo. This will allow Tusk to automatically lint, build, and test code - resulting in higher quality PRs.

This workflow will only be run when you trigger Tusk to work on an issue. If you have any questions, please contact [support@usetusk.ai](mailto:support@usetusk.ai).",use-tusk[bot],2024-07-25 05:52:18+00:00,[],2024-10-08 16:19:44+00:00,2024-07-25 10:55:25+00:00,https://github.com/metabase/metabase/pull/46116,"[('.CI & Tests', ''), ('no-backport', 'Do not backport this PR to any branch')]",[],
2428925595,pull_request,closed,,[Notification] Deactivate channels will delete PulseChannel,"Part of milestone 2.3 of https://github.com/metabase/metabase/issues/43822

Context: https://metaboat.slack.com/archives/C07318NQ5M2/p1721879160523279

",qnkhuat,2024-07-25 03:55:13+00:00,['qnkhuat'],2024-07-29 13:45:04+00:00,2024-07-29 13:45:02+00:00,https://github.com/metabase/metabase/pull/46115,"[('.Team/Workflows', 'aka BEC')]",[],
2428911708,pull_request,closed,,"🤖 backported ""[perf] Add a Clojure-side impl for `lib.cache/side-channel-cache`""",#45394,github-automation-metabase,2024-07-25 03:43:01+00:00,"['bshepherdson', 'github-automation-metabase']",2024-07-25 07:59:32+00:00,2024-07-25 07:59:31+00:00,https://github.com/metabase/metabase/pull/46114,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2428905689,pull_request,closed,,[Notification] audit log for channel create and update,"Part of milestone 3 of https://github.com/metabase/metabase/issues/43822

Record audit log event :channel-create for POST /api/channel
Record audit log event :channel-update for PUT /api/channel/:id

Audit details only include [:id, :name, :description, :type, :enabled]",qnkhuat,2024-07-25 03:35:35+00:00,['qnkhuat'],2024-07-29 14:31:13+00:00,2024-07-29 14:31:11+00:00,https://github.com/metabase/metabase/pull/46113,"[('.Team/Workflows', 'aka BEC')]",[],
2428741694,pull_request,closed,,Fix for temporal unit parameters in click behaviors,"Epic https://github.com/metabase/metabase/issues/42118
Closes https://github.com/metabase/metabase/issues/46069

Fixes an issue with temporal-unit parameters and dashboard click behaviors found during a bugbash.

How to verify:
- Create a question -> Products -> Save
- Create a question -> Orders -> Count -> Breakout by Created At -> Save
- Add both questions to a dashboard
- Add a temporal unit parameter and connect to Orders.CreatedAt
- Click behaviors for the Orders question -> Select any column -> Update dashboard filter -> Select the temporal unit parameter -> Should say that there are no available targets
- Click behaviors for the Products question -> Select Category -> Update dashboard filter -> Select the temporal unit parameter -> Should allow to map -> Save
- Clicking on the Category will now reset the temporal unit parameter because the value is not a valid temporal unit. 
- Valid values would work. To test this, you could create a SQL question that returns strings like `hour`, `day` and use it instead of Products.",ranquild,2024-07-25 01:07:32+00:00,['ranquild'],2024-07-26 12:40:04+00:00,2024-07-26 12:40:02+00:00,https://github.com/metabase/metabase/pull/46112,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2428664176,pull_request,closed,,"🤖 backported ""Revert ""fix: param-fields when native model is aggregated""""",#46108,github-automation-metabase,2024-07-24 23:57:28+00:00,"['ranquild', 'github-automation-metabase']",2024-07-25 01:09:55+00:00,2024-07-25 01:09:53+00:00,https://github.com/metabase/metabase/pull/46109,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2428611385,pull_request,closed,,"Revert ""fix: param-fields when native model is aggregated""",Reverts metabase/metabase#45068,ranquild,2024-07-24 23:07:35+00:00,['ranquild'],2024-07-25 01:10:20+00:00,2024-07-24 23:56:39+00:00,https://github.com/metabase/metabase/pull/46108,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2428610811,pull_request,closed,,"🤖 backported ""ci: Fix request timeout in E2E dashboard filters flake""",#46091,github-automation-metabase,2024-07-24 23:06:56+00:00,"['nemanjaglumac', 'github-automation-metabase']",2024-07-25 14:51:13+00:00,2024-07-25 14:51:12+00:00,https://github.com/metabase/metabase/pull/46107,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2428596639,pull_request,closed,,Use regular mantine buttons for filter and summarize buttons in query builder,"No functional, and very small visual changes here, but makes things more uniform, and will make things look not-stupid in https://github.com/metabase/metabase/pull/46097 because all the border sizes and buttons will match.

. | .
--- | ---
Before | ![Screen Shot 2024-07-24 at 4 53 36 PM](https://github.com/user-attachments/assets/a4cc7abd-1f63-431b-bdca-59520cb92b12)
After | ![Screen Shot 2024-07-24 at 4 54 02 PM](https://github.com/user-attachments/assets/091845a1-4858-4d69-8efe-9176958c22d6)

![buttons](https://github.com/user-attachments/assets/01723570-f2b9-4875-adcd-af134f0e42ac)


Existing coverage should handle these button clicks thoroughly.",iethree,2024-07-24 22:55:15+00:00,['iethree'],2024-10-08 16:19:22+00:00,2024-07-29 17:31:20+00:00,https://github.com/metabase/metabase/pull/46106,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2249131395, 'issue_id': 2428596639, 'author': 'dhuniverse', 'body': '* Pulled the branch. \r\n* Checked on click behavior. Border size is now at (0.8px). Is this the right across the entire app? If so, looks good to me. However, it seemed the stoybook mantine button has border at (1px). \r\n* **Is 0.8px for the border size the new standard**?\r\nAdded Maz.', 'created_at': datetime.datetime(2024, 7, 25, 0, 52, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2249141453, 'issue_id': 2428596639, 'author': 'mazameli', 'body': ""I'm a little sad to lose the background color on hover on these, especially because now the hover effect for the `Filter` button is really subtle because the dark purple isn't super different from text-dark. Other than that I find this pretty unobjectionable.\r\n\r\nI'm tagging @AlessioLaiso for a review, too, since to me this falls under the query builder / chill mode."", 'created_at': datetime.datetime(2024, 7, 25, 0, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2250331724, 'issue_id': 2428596639, 'author': 'AlessioLaiso', 'body': ""> I'm a little sad to lose the background color on hover on these, especially because now the hover effect for the `Filter` button is really subtle because the dark purple isn't super different from text-dark. Other than that I find this pretty unobjectionable.\r\n> \r\n> I'm tagging @AlessioLaiso for a review, too, since to me this falls under the query builder / chill mode.\r\n\r\nAgreed. Would it be possible to keep the background color on hover?"", 'created_at': datetime.datetime(2024, 7, 25, 13, 31, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2250566966, 'issue_id': 2428596639, 'author': 'iethree', 'body': '> Agreed. Would it be possible to keep the background color on hover?\r\n\r\nAnything for @mazameli', 'created_at': datetime.datetime(2024, 7, 25, 14, 54, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2251000810, 'issue_id': 2428596639, 'author': 'iethree', 'body': 'updated hover states. @oisincoveney might like these less 😬 \r\n\r\n![Screen Shot 2024-07-25 at 11 01 53 AM](https://github.com/user-attachments/assets/ea6d6a3b-072b-4c5c-96a1-217c0ee9ee8f)', 'created_at': datetime.datetime(2024, 7, 25, 17, 7, 50, tzinfo=datetime.timezone.utc)}]","dhuniverse on (2024-07-25 00:52:36 UTC): * Pulled the branch. 
* Checked on click behavior. Border size is now at (0.8px). Is this the right across the entire app? If so, looks good to me. However, it seemed the stoybook mantine button has border at (1px). 
* **Is 0.8px for the border size the new standard**?
Added Maz.

mazameli on (2024-07-25 00:59:00 UTC): I'm a little sad to lose the background color on hover on these, especially because now the hover effect for the `Filter` button is really subtle because the dark purple isn't super different from text-dark. Other than that I find this pretty unobjectionable.

I'm tagging @AlessioLaiso for a review, too, since to me this falls under the query builder / chill mode.

AlessioLaiso on (2024-07-25 13:31:28 UTC): Agreed. Would it be possible to keep the background color on hover?

iethree (Issue Creator) on (2024-07-25 14:54:29 UTC): Anything for @mazameli

iethree (Issue Creator) on (2024-07-25 17:07:50 UTC): updated hover states. @oisincoveney might like these less 😬 

![Screen Shot 2024-07-25 at 11 01 53 AM](https://github.com/user-attachments/assets/ea6d6a3b-072b-4c5c-96a1-217c0ee9ee8f)

"
2428554343,pull_request,closed,,Number formatter Reports correct Decimal places for negative Numbers,"Fixes #41640

Prior to this, the number formatter would get the incorrect number of decimal places for negative numbers.

The way the decimal places count is derived works as follows:

 - convert number to a string
 - split the string on the separator (decimal, comma, whatever the instance has set)
 - destructure that split into [int decimal]
 - count decimal to get the number of decimals.

That all works for positive numbers, but for negative numbers, the regex was just splitting on 'not digits', so we got an extra group due to the leading negative sign. This would incorrectly destructure  the 'int' part of the number into the count, thus we would always get 1 instead of the correct value.

This fixes it by just taking last instead of destructuring.",adam-james-v,2024-07-24 22:09:47+00:00,['adam-james-v'],2024-07-25 14:14:38+00:00,2024-07-25 14:14:36+00:00,https://github.com/metabase/metabase/pull/46104,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2428528880,pull_request,closed,,[perf] Improve DB syncing times,"The benchmark I used is the reduced version of this dataset: https://drive.google.com/file/d/1VhY_Kr7bSWAmnpj3AK2e8ayVTPyOniOj/view?usp=sharing, but I only use 3 tables from it (3tables x 800colums x 1row). On `master` on my machine, the full sync time (add db + fingerprinting + updating field values) is 1.5 minutes. With the suggested commits, I brought it down to 1 minute (~33% reduction).

Nothing controversial here besides caching the attempt to load EE namespaces. This should be fine unless you support a case where EE namespaces suddenly appear on classpath during server operation and Metabase picks it up?",alexander-yakushev,2024-07-24 21:46:03+00:00,['alexander-yakushev'],2024-10-08 16:19:45+00:00,2024-07-25 10:16:14+00:00,https://github.com/metabase/metabase/pull/46103,"[('no-backport', 'Do not backport this PR to any branch')]",[],
2428527008,pull_request,closed,,"Make the sandbox cleanup logic more robust, and reorganize some perms code for better testing","1. Makes sandbox deletion more robust. When permissions for a db/schema/table change, we go through and ensure that any sandboxes that are no longer relevant are properly deleted. The existing logic had hard-coded permission values (i.e. `:unrestricted`, `:blocked`) but this isn't robust for when new permission values are added (like `:legacy-no-self-service`)
2. Reorganizes some permissions code to improve test coverage. The reason this wasn't caught before is that all the tests in `metabase.models.data-permissions.graph` were testing `update-data-perms-graph!*` instead of the actual entrypoint, `update-data-perms-graph!`. This was mainly because the latter also checks revision numbers, which are annoying to get correct in tests that don't care about concurrent updates.
	* To fix this I've moved some pieces of `update-data-perms-graph!` into the `PUT /api/permissions/graph` API handler, specifically logging permission changes, checking revision numbers, and saving the revision to the `permissions_revision` table. The helper functions for these I've moved to `metabase.permissions.util` since they're used from other namespaces as well.
	* Then, I've updated the permissions graph tests to call `update-data-perms-graph!` directly so that they _also_ exercise `delete-impersonations-if-needed-after-permissions-change!` and `delete-gtaps-if-needed-after-permissions-change!`",noahmoss,2024-07-24 21:44:27+00:00,['noahmoss'],2024-07-25 15:07:13+00:00,2024-07-25 14:16:19+00:00,https://github.com/metabase/metabase/pull/46102,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2248952391, 'issue_id': 2428527008, 'author': 'noahmoss', 'body': '* **#46102** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46102?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 24, 21, 44, 52, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-07-24 21:44:52 UTC): * **#46102** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46102?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2428491595,pull_request,closed,,Track column references whether they resolve to Fields or not,"Refers https://github.com/metabase/metabase/issues/45027

### Description

This refactor updates the plumbing between Metabase and Macaw such that column references which do not resolve to Fields are not implicitly dropped.

This prepares us to persist these records, once the underlying database model is updated.",crisptrutski,2024-07-24 21:17:03+00:00,['crisptrutski'],2024-10-08 16:19:24+00:00,2024-07-29 11:39:09+00:00,https://github.com/metabase/metabase/pull/46101,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2255323028, 'issue_id': 2428491595, 'author': 'crisptrutski', 'body': '* **#46283** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46283?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46185** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46185?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46143** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46143?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46128** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46128?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46101** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46101?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 29, 8, 30, 29, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-07-29 08:30:29 UTC): * **#46283** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46283?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46185** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46185?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46143** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46143?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46128** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46128?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46101** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46101?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2428470482,pull_request,closed,,"🤖 backported ""docs - notes on view data vis""",#46093,github-automation-metabase,2024-07-24 21:06:25+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-24 21:08:05+00:00,2024-07-24 21:08:04+00:00,https://github.com/metabase/metabase/pull/46099,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2428469093,pull_request,closed,,"🤖 backported ""docs - note on projected coordinates""",#46079,github-automation-metabase,2024-07-24 21:05:20+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-24 21:06:52+00:00,2024-07-24 21:06:51+00:00,https://github.com/metabase/metabase/pull/46098,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2428430989,pull_request,closed,,test(sdk) Update the Query Editor Button,"Closes https://github.com/metabase/metabase/issues/46096


### Description

Before | After
---|---
![Screen Shot 2024-07-24 at 2 37 33 PM](https://github.com/user-attachments/assets/6e56c540-d492-4389-8ac6-1179a0631a3c) | ![Screen Shot 2024-08-02 at 1 39 13 PM](https://github.com/user-attachments/assets/cdf3874d-98e0-4a04-ae5c-be3199530e14)


notebook side:
![Screen Shot 2024-08-02 at 1 39 22 PM](https://github.com/user-attachments/assets/f93d587f-39ac-4462-9dfb-6ee31f3965b8)


![qb header update](https://github.com/user-attachments/assets/c92cdab2-6d21-4daf-a03e-a7910fb23576)


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-07-24 20:38:29+00:00,['iethree'],2024-08-02 22:18:50+00:00,2024-08-02 22:18:48+00:00,https://github.com/metabase/metabase/pull/46097,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('PR-Env', 'See https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458')]","[{'comment_id': 2257067129, 'issue_id': 2428430989, 'author': 'iethree', 'body': ""> 1. I'd love it if these buttons could all look the same. The Show Editor button's height and borders are currently different.\r\n\r\nI have now rebased this branch off of master to pull in recent changes to those buttons, they should now be perfectly identical in this branch as well.\r\n\r\n![Screen Shot 2024-07-29 at 3 45 35 PM](https://github.com/user-attachments/assets/6f475176-9516-4409-a799-c4136ae488a8)\r\n\r\n> 2. I don't love that the Show Visualization button is present from a totally new GUI question, and would prefer that it only appears for saved questions, or for cases where you've arrived in the editor via the Show Editor button. If that's unavoidable or costlier than we're willing to spend right now, I think I can live with it.\r\n\r\nI will make this change in another branch since it's essentially a new feature: context-sensitive notebook button, and not just a simple visual change. #46252"", 'created_at': datetime.datetime(2024, 7, 29, 21, 47, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2266028835, 'issue_id': 2428430989, 'author': 'github-actions[bot]', 'body': '@iethree You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 2, 19, 37, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2266125213, 'issue_id': 2428430989, 'author': 'github-actions[bot]', 'body': '@iethree You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 2, 20, 46, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2266168490, 'issue_id': 2428430989, 'author': 'github-actions[bot]', 'body': '@iethree You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 2, 21, 31, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2266179553, 'issue_id': 2428430989, 'author': 'github-actions[bot]', 'body': '👋 Deploying a preview environment for commit 5dccbbf6fdd3a7529a0d75d92683bbd3e615d0bd.\n✅ Preview:\n    https://pr46097.coredev.metabase.com\n🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)\n<!-- Sticky Pull Request Comment -->', 'created_at': datetime.datetime(2024, 8, 2, 21, 42, 30, tzinfo=datetime.timezone.utc)}]","iethree (Issue Creator) on (2024-07-29 21:47:26 UTC): I have now rebased this branch off of master to pull in recent changes to those buttons, they should now be perfectly identical in this branch as well.

![Screen Shot 2024-07-29 at 3 45 35 PM](https://github.com/user-attachments/assets/6f475176-9516-4409-a799-c4136ae488a8)


I will make this change in another branch since it's essentially a new feature: context-sensitive notebook button, and not just a simple visual change. #46252

github-actions[bot] on (2024-08-02 19:37:53 UTC): @iethree You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-02 20:46:38 UTC): @iethree You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-02 21:31:24 UTC): @iethree You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-02 21:42:30 UTC): 👋 Deploying a preview environment for commit 5dccbbf6fdd3a7529a0d75d92683bbd3e615d0bd.
✅ Preview:
    https://pr46097.coredev.metabase.com
🗒️ [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)
<!-- Sticky Pull Request Comment -->

"
2428409955,pull_request,closed,,Bigquery Pagination Use next page to get proper results,"Fixes #45953

This issue showed up in the export but is not exclusive to exports. It seems likely that this bug actually existed in all of our results, but it's not exactly easy to spot in the App since we show only the first 2000 rows from any given query, but a download will show the full set, making it clear that there's an issue.

It also only shows up around 100,000 rows because the page size is left unset by default, and is probably decently large, so you don't see the duplication problem until you make a query that rolls over more than 1 page anyway.

I think that the page size will be reached sooner the more columns you have, so you may see the bug on fewer rows if you have a table with lots of columns. 

In any case, the fix is quite simple: we need to pass the new page to the values iterator in `reducible-bigquery-results` and things should be ok.
",adam-james-v,2024-07-24 20:23:50+00:00,['adam-james-v'],2024-07-25 15:10:35+00:00,2024-07-25 15:10:34+00:00,https://github.com/metabase/metabase/pull/46095,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2428396631,pull_request,closed,,docs - notes on view data vis,Clarify the visibility of the **View data** setting in OSS.,jeff-bruemmer,2024-07-24 20:17:07+00:00,['jeff-bruemmer'],2024-07-24 21:08:34+00:00,2024-07-24 21:05:33+00:00,https://github.com/metabase/metabase/pull/46093,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2428393018,pull_request,closed,,ci: Fix request timeout in E2E dashboard filters flake,"### What does this PR accomplish?
It fixes an E2E flake in dashboard filters reproductions that had one intercepted request timing out from time to time.

### Example of a failure
https://github.com/metabase/metabase/actions/runs/10076690074/job/27857992893?pr=46048#step:13:313

![issues 15279 and 24500 -- corrupted dashboard filter should still appear in the UI without breaking other filters (metabase#15279, metabase#24500) (failed) (attempt 2)](https://github.com/user-attachments/assets/4b7373cf-a11d-4153-9cfd-403fb181c5a9)

### Explanation
I am not entirely sure why was this happening. It could be a potato CI runner, or it could be some weirdness in the UI.

### Solution
1. Limit the number of rows to speed things up
2. Make the interception url much more specific

Even after this, the test was still failing in [6/50 stress-test scenarios](https://github.com/metabase/metabase/actions/runs/10083660257).

So as the final solution, **I've removed the intercepts altogether.** 

> [Note]
> As an added bonus, this PR also improves the assertions which improves the correctness of this repro.

### Stress-test (in progress)
50/50 ✅ https://github.com/metabase/metabase/actions/runs/10083873537",nemanjaglumac,2024-07-24 20:14:43+00:00,['nemanjaglumac'],2024-07-25 14:51:40+00:00,2024-07-24 23:06:02+00:00,https://github.com/metabase/metabase/pull/46091,"[('.CI & Tests', ''), ('backport', 'Automatically create PR on current release branch on merge'), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2428382688,pull_request,closed,,Skip long values in JSON unfolding query,"Resolves https://github.com/metabase/metabase/issues/45163

### Why OOM errors can happen during JSON unfolding

In `describe-json-fields`, we fetch a sample of 500 rows of data into a ResultSet object from the database. We select all the JSON columns in the table at once for these rows. If there are sufficiently large JSON values among this sample we exhaust the heap space. This is all without even starting to parse the values. We could decrease the fetch size and fetch the data in batches, but doing that will make sync slower.

### The solution

This PR limits the size of each value that can be returned from the query.

Until recently (after https://github.com/metabase/metabase/pull/42638) we had a limit of 50,000 characters in a JSON string before we would attempt to parse a JSON value. This PR restores that 50,000 character limit, but in the query instead. If there is a JSON value that is longer than 50,000 characters, the query will return NULL in its place.

This PR technically constitutes a breaking change because it may result in some fields becoming inactive that would previously would be active. I still think we should backport it to 49 and 50, because that scenario seems relatively unlikely, the behaviour is the same as before https://github.com/metabase/metabase/pull/42638, and it is outweighed by the benefit of fixing the OOM errors.

### How to verify manually

```
;; launch Metabase with 4 GB of maximum heap space by setting -Xmx4g option in deps.edn

(require
 '[cheshire.core :as json]
 '[clojure.java.jdbc :as jdbc]
 '[metabase.driver.sql-jdbc.connection :as sql-jdbc.conn]
 '[metabase.sync :as sync]
 '[metabase.test :as mt]
 '[toucan2.core :as t2])

;; Create a new test db:
(mt/defdataset test-db [])
(mt/with-driver :postgres (mt/dataset test-db (def db (mt/db))))

;; Set up the table:
(let [j (json/encode {""a"" (repeat 10000000 ""x"")})]
  (with-open [conn (jdbc/get-connection (sql-jdbc.conn/db->pooled-connection-spec db))]
    (jdbc/execute! {:connection conn} ""CREATE TABLE IF NOT EXISTS large_jsonb_test (id SERIAL PRIMARY KEY, data JSONB)"")
    (jdbc/execute! {:connection conn} ""TRUNCATE TABLE large_jsonb_test"")
    (dotimes [_ 100]
      (jdbc/execute! {:connection conn} [(str ""INSERT INTO large_jsonb_test ( data ) VALUES (?::jsonb)"") j]))))

(-> (:bytes (first (t2/query db ""SELECT sum(pg_column_size(data)) as bytes FROM large_jsonb_test;"")))
    (/ 1024 1024)
    float)
;; => 140 MB or so

;; the sync-fields step will fail with an OOM error before the change, and succeed after the change.
(sync/sync-database! db {:scan :schema})
```

This should be backported to 49. 
The new Druid JDBC driver will be implemented separately (issue: https://github.com/metabase/metabase/issues/46137), because it's currently difficult to use a new test dataset.",calherries,2024-07-24 20:07:37+00:00,['calherries'],2024-07-29 13:21:47+00:00,2024-07-26 13:42:39+00:00,https://github.com/metabase/metabase/pull/46089,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2251906126, 'issue_id': 2428382688, 'author': 'qnkhuat', 'body': ""It would be nice to see the analysis here:\r\n- I'm interested in whether there are more memory-intensive parts\r\n- how much of an improvement does this make"", 'created_at': datetime.datetime(2024, 7, 26, 3, 47, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2252411155, 'issue_id': 2428382688, 'author': 'calherries', 'body': '@qnkhuat I can provide more analysis but what exactly is stopping us from landing this in its current state? The steps under `How to verify manually` already prove this is a bottleneck and that this change relieves it', 'created_at': datetime.datetime(2024, 7, 26, 10, 1, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2252418211, 'issue_id': 2428382688, 'author': 'calherries', 'body': ""To be fair what we do not know yet, is whether this is the bottleneck that every customer getting an OOM is hitting. But I think it's a reasonable guess given the data LeAnn has given me in [this sheet](https://docs.google.com/spreadsheets/d/1vAL8HwgAmsAE-WhzdzTLsPDhsY6MvaixQiKPLE2YSf8/edit?gid=100008772#gid=100008772)"", 'created_at': datetime.datetime(2024, 7, 26, 10, 3, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2253375511, 'issue_id': 2428382688, 'author': 'calherries', 'body': '@metabase-bot backport release-x.49.x', 'created_at': datetime.datetime(2024, 7, 26, 19, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2253380666, 'issue_id': 2428382688, 'author': 'github-actions[bot]', 'body': '@calherries something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10116879708)', 'created_at': datetime.datetime(2024, 7, 26, 19, 56, 2, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-07-26 03:47:27 UTC): It would be nice to see the analysis here:
- I'm interested in whether there are more memory-intensive parts
- how much of an improvement does this make

calherries (Issue Creator) on (2024-07-26 10:01:30 UTC): @qnkhuat I can provide more analysis but what exactly is stopping us from landing this in its current state? The steps under `How to verify manually` already prove this is a bottleneck and that this change relieves it

calherries (Issue Creator) on (2024-07-26 10:03:52 UTC): To be fair what we do not know yet, is whether this is the bottleneck that every customer getting an OOM is hitting. But I think it's a reasonable guess given the data LeAnn has given me in [this sheet](https://docs.google.com/spreadsheets/d/1vAL8HwgAmsAE-WhzdzTLsPDhsY6MvaixQiKPLE2YSf8/edit?gid=100008772#gid=100008772)

calherries (Issue Creator) on (2024-07-26 19:55:00 UTC): @metabase-bot backport release-x.49.x

github-actions[bot] on (2024-07-26 19:56:02 UTC): @calherries something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10116879708)

"
2428333048,pull_request,closed,,Filter invalid recent and search items in move modal,"Closes #45248 

### Description

When moving collections, you should not be able to move a parent collection into one of its children. This is enforced in the collection picker tree, but recents and search would present invalid options. Note: the API prevented any invalid moves, but we should remove them from the UI in the first place to avoid frustrating users with invalid options.


Note: `Inner Collection` is a subcollection of `Outer Collection`, and should not be shown as a valid move target. you also can't move a collection into itself.

. | Before | After
--|--|--
recents | ![Screen Shot 2024-07-24 at 1 30 38 PM](https://github.com/user-attachments/assets/31da0b01-1ee7-4efa-9364-ace91eeabe10) | ![Screen Shot 2024-07-24 at 1 30 16 PM](https://github.com/user-attachments/assets/8668b9fb-19be-4d6b-a5a0-8c0dc16c521d)
search | ![Screen Shot 2024-07-24 at 1 30 43 PM](https://github.com/user-attachments/assets/05543926-db09-4971-bb9b-1152ab5a747a) | ![Screen Shot 2024-07-24 at 1 30 23 PM](https://github.com/user-attachments/assets/7a0aafbb-ecc8-45fc-a94d-847f11b39dc9)


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-07-24 19:36:08+00:00,['iethree'],2024-07-26 16:52:51+00:00,2024-07-26 16:52:49+00:00,https://github.com/metabase/metabase/pull/46086,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2251376359, 'issue_id': 2428333048, 'author': 'rafpaf', 'body': '👀', 'created_at': datetime.datetime(2024, 7, 25, 20, 52, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2251399084, 'issue_id': 2428333048, 'author': 'rafpaf', 'body': 'I think I can ""move"" a collection into its _current_ parent via the recents tab. Would changing this be part of solving this bug?\n\nYou can see the collection hierarchy on the left\n![image.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/utGnP2ljFMMNOgi82vVn/fd45e45b-6b86-43d7-ab59-e2dc6a29b95a.png)', 'created_at': datetime.datetime(2024, 7, 25, 21, 8, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2251414258, 'issue_id': 2428333048, 'author': 'iethree', 'body': '> I think I can ""move"" a collection into its _current_ parent via the recents tab. Would changing this be part of solving this bug?\r\n> \r\n> You can see the collection hierarchy on the left ![image.png](https://camo.githubusercontent.com/0c16b7c64130e88bb111752b15d3ad2bbdcdeafb2878ee09994edcddf51ff430/68747470733a2f2f67726170686974652d757365722d75706c6f616465642d6173736574732d70726f642e73332e616d617a6f6e6177732e636f6d2f7574476e50326c6a464d4d4e4f6769383276566e2f66643435653435622d366238362d343364372d616235392d6532646336613239623935612e706e67)\r\n\r\nI don\'t think that\'s in the scope of this bug. moving a collection to the place it already resides is a valid operation according to the API. If you think that should be a prohibited operation, we should file a different bug.', 'created_at': datetime.datetime(2024, 7, 25, 21, 19, 5, tzinfo=datetime.timezone.utc)}]","rafpaf on (2024-07-25 20:52:44 UTC): 👀

rafpaf on (2024-07-25 21:08:12 UTC): I think I can ""move"" a collection into its _current_ parent via the recents tab. Would changing this be part of solving this bug?

You can see the collection hierarchy on the left
![image.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/utGnP2ljFMMNOgi82vVn/fd45e45b-6b86-43d7-ab59-e2dc6a29b95a.png)

iethree (Issue Creator) on (2024-07-25 21:19:05 UTC): I don't think that's in the scope of this bug. moving a collection to the place it already resides is a valid operation according to the API. If you think that should be a prohibited operation, we should file a different bug.

"
2428302160,pull_request,closed,,[WIP] Add right-excluded option to between clause,"WIP

Closes https://github.com/metabase/metabase/issues/[issue_number]

### Description

Describe the overall approach and the problem being solved.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. New question -> Sample Dataset -> ...
2. ...

### Demo

_Upload a demo video or before/after screenshots if sensible or remove the section_

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",lbrdnk,2024-07-24 19:15:33+00:00,['lbrdnk'],2024-08-05 08:53:56+00:00,2024-08-05 08:53:56+00:00,https://github.com/metabase/metabase/pull/46083,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2268526673, 'issue_id': 2428302160, 'author': 'lbrdnk', 'body': 'Closing in favor of https://github.com/metabase/metabase/pull/46438.', 'created_at': datetime.datetime(2024, 8, 5, 8, 53, 56, tzinfo=datetime.timezone.utc)}]","lbrdnk (Issue Creator) on (2024-08-05 08:53:56 UTC): Closing in favor of https://github.com/metabase/metabase/pull/46438.

"
2428291271,pull_request,closed,,Enable e2e repro for the issue #38181,"Enable e2e repro for the issue #38181, fixed by the PR https://github.com/metabase/metabase/pull/45566.",lbrdnk,2024-07-24 19:08:34+00:00,['lbrdnk'],2024-07-25 10:42:18+00:00,2024-07-25 10:14:22+00:00,https://github.com/metabase/metabase/pull/46082,"[('.CI & Tests', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2428236624,pull_request,closed,,Loosen N+1 query detection again,"I tightened this up by removing the condition here, thinking that CI would catch it if it was necessary - but I'm getting failures in development. Oops - didn't realize that this defmethod wasn't actually applied during CI runs.

Let's add this condition in for now, to prevent frustration in dev. We should probably also consider moving this to a different namespace where it will be ""on"" during CI or it might lead to further issues like this.",johnswanson,2024-07-24 18:38:04+00:00,['johnswanson'],2024-10-08 16:19:39+00:00,2024-07-25 18:44:19+00:00,https://github.com/metabase/metabase/pull/46081,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2428233114,pull_request,closed,,feat(sdk): CLI to bootstrap an embedding-ready Metabase instance,"### Description

Bootstraps an embedding-ready Metabase instance without requiring a manual instance configuration.

### How to verify

- Run `yarn build-embedding-sdk-cli:watch` in a terminal
- If you already have an old MB instance, run `docker rm -f metabase-enterprise-embedding` first
- Run `node resources/embedding-sdk/dist/cli.js start` in another terminal

### Demo

<div>
    <a href=""https://www.loom.com/share/c907bcd9476b4e05942c689a80a90a4d"">
      <p>July 26 - React 17 compat and CLI for embedding-ready Metabase instance - Watch Video</p>
    </a>
    <a href=""https://www.loom.com/share/c907bcd9476b4e05942c689a80a90a4d"">
      <img style=""max-width:300px;"" src=""https://cdn.loom.com/sessions/thumbnails/c907bcd9476b4e05942c689a80a90a4d-8228aaf31b1c7708-full-play.gif"">
    </a>
  </div>",heypoom,2024-07-24 18:35:44+00:00,['heypoom'],2024-10-08 16:18:32+00:00,2024-08-07 15:24:33+00:00,https://github.com/metabase/metabase/pull/46080,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2428216449,pull_request,closed,,docs - note on projected coordinates,"Specifies that Metabase supports geographic coordinates (lat/long), not projected coordinates.",jeff-bruemmer,2024-07-24 18:24:58+00:00,['jeff-bruemmer'],2024-07-24 21:07:24+00:00,2024-07-24 21:04:26+00:00,https://github.com/metabase/metabase/pull/46079,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2428135715,pull_request,closed,,[perf] Fetch query metadata with DB calls directly - v50,Backport of https://github.com/metabase/metabase/pull/45891,ranquild,2024-07-24 17:39:36+00:00,['ranquild'],2024-07-24 18:37:47+00:00,2024-07-24 18:37:21+00:00,https://github.com/metabase/metabase/pull/46077,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2428104527,pull_request,closed,,update `dashboard_pdf_exported` and use it in embedding context,"Closes https://github.com/metabase/metabase/issues/46007

### Description

Since we added pdf export to public/embedded dashboards, this pr changes `dashboard_pdf_exported` to accept a new field `dashboard_accessed_via` that tells us how the dashboard was accesses (internal, public link, static embed, sdk, interactive embedding).

For public/static scenarios we decided to not pass the dashboard id (as it would be either a signed jwt, or a uuid) and after [this slack thread](https://metaboat.slack.com/archives/C010L1Z4F9S/p1721746019685229?thread_ts=1721745811.912789&cid=C010L1Z4F9S) we opted to send 0 instead of making the field not required, so that we don't have to create a new table for the event.

Asking review also to @metabase/core-frontend-dashviz as this changes the event sent from the FE",npretto,2024-07-24 17:21:10+00:00,['npretto'],2024-08-01 08:31:58+00:00,2024-08-01 08:31:55+00:00,https://github.com/metabase/metabase/pull/46076,"[('.Team/Embedding', '')]",[],
2428092960,pull_request,closed,,"🤖 backported ""Remove unused properties from query_metadata""","  #45858
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-24 17:14:26+00:00,"['ranquild', 'github-automation-metabase']",2024-07-24 23:09:27+00:00,2024-07-24 23:09:25+00:00,https://github.com/metabase/metabase/pull/46075,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2428066203,pull_request,closed,,ci: patch esbuild preprocessor to show errors in watch mode,"Related to https://github.com/metabase/metabase/pull/46062

![image (11)](https://github.com/user-attachments/assets/5a95bb22-9088-4ef4-ab4f-f9897a3247fe)

if you have a build error, cypress will crash and show this error in watch mode. Before it would use the last successful build and you'd never noticed it
",uladzimirdev,2024-07-24 16:59:22+00:00,['uladzimirdev'],2024-10-08 16:19:34+00:00,2024-07-25 21:22:06+00:00,https://github.com/metabase/metabase/pull/46074,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]","[{'comment_id': 2250114454, 'issue_id': 2428066203, 'author': 'nemanjaglumac', 'body': 'Will you open the PR in the source repo as well?', 'created_at': datetime.datetime(2024, 7, 25, 11, 35, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2250467078, 'issue_id': 2428066203, 'author': 'uladzimirdev', 'body': ""@nemanjaglumac it's there, I added the link as a comment, but maybe it's not very readable 😬 \r\n\r\nhttps://github.com/metabase/metabase/pull/46074/files#diff-f336e116917424abbc798526bf3e09a2231170560074cd47cb938532737fcda8R11"", 'created_at': datetime.datetime(2024, 7, 25, 14, 28, 19, tzinfo=datetime.timezone.utc)}]","nemanjaglumac on (2024-07-25 11:35:16 UTC): Will you open the PR in the source repo as well?

uladzimirdev (Issue Creator) on (2024-07-25 14:28:19 UTC): @nemanjaglumac it's there, I added the link as a comment, but maybe it's not very readable 😬 

https://github.com/metabase/metabase/pull/46074/files#diff-f336e116917424abbc798526bf3e09a2231170560074cd47cb938532737fcda8R11

"
2428064724,pull_request,closed,,Ellipsify long dashboard filter values (strings only),"Closes #46189

Sets a max width for string filter widgets so they don't go off-screen if a value is long enough

### To verify

1. Open a dashboard with at least one question
2. Add a string filter (don't forget to link it to a column so the filter is visible after leaving editing mode)
3. When editing the string filter, set pick ""Input box"" in the ""How should people filter on this column?"" section of the filter sidebar
4. Save the dashboard
5. Add a long enough value (could be a few sentences)
6. Ensure the filter component doesn't go off-screen and that it ellipsifies its contents. Ensure you can hover the filter and see the full value in a tooltip
7. Ensure filters look as expected with shorter values

### Demo

**Before**

![before](https://github.com/user-attachments/assets/c0f65717-ed36-4087-bc1b-160a7ca1e163)

**After**

![after](https://github.com/user-attachments/assets/ec934789-4062-4143-ad2b-4a44eaa01203)
",kulyk,2024-07-24 16:58:25+00:00,['kulyk'],2024-08-13 15:38:04+00:00,2024-08-13 15:38:02+00:00,https://github.com/metabase/metabase/pull/46073,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2428019396,pull_request,closed,,feat(question): Make two messages in the question footer - query runtime and cache age - more useful,"Closes https://github.com/metabase/metabase/issues/46009

### Description

In the question footer, there are two messages describing aspects of the query's run: the execution time, and the age of the cache. This PR implements a new look for these messages:

![image.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/utGnP2ljFMMNOgi82vVn/a78617b8-251d-4ae7-88aa-a4440b0d0781.png)

Instead of showing both messages, we just show one. Tooltips provide more detailed information.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR",rafpaf,2024-07-24 16:30:53+00:00,['rafpaf'],2024-07-25 19:09:04+00:00,2024-07-25 19:09:02+00:00,https://github.com/metabase/metabase/pull/46072,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2248447832, 'issue_id': 2428019396, 'author': 'rafpaf', 'body': '* **#46072** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46072?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 24, 16, 31, 12, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-07-24 16:31:12 UTC): * **#46072** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46072?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2428001773,pull_request,closed,,bind ts4 to avoid implicit updates,"[context](https://metaboat.slack.com/archives/C505ZNNH4/p1721757334687389)

seems cypress implicitly took ts5 from postcss package, so let's bind it to 4.7.2 in release branch, master uses 5.4.5",uladzimirdev,2024-07-24 16:20:44+00:00,['uladzimirdev'],2024-08-21 09:01:22+00:00,2024-08-21 09:01:20+00:00,https://github.com/metabase/metabase/pull/46070,"[('.Team/Querying', '')]",[],
2427989344,pull_request,closed,,feat(sdk): Add API keys for development mode,"Adds API keys back to the `SDKConfig` and allows users to use the SDK with API keys as long as they are on `localhost`.

Most of the changes were made in `use-init-data`, and added some pattern matching to hopefully make the logic a little easier to follow. Let me know what you think.

There are also a few small changes (overflow classes, etc) that are made solely to ensure that the Filter, Summarize, and Notebook components remain its container.

",oisincoveney,2024-07-24 16:14:01+00:00,['oisincoveney'],2024-10-08 16:19:26+00:00,2024-07-29 08:17:37+00:00,https://github.com/metabase/metabase/pull/46067,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2248416251, 'issue_id': 2427989344, 'author': 'github-actions[bot]', 'body': '@oisincoveney You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 7, 24, 16, 14, 27, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-24 16:14:27 UTC): @oisincoveney You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2427972737,pull_request,closed,,Fix a race condition with models creation,"Follow up for https://github.com/metabase/metabase/pull/45959

Because of a bad check in an e2e test I didn't catch an issue that we don't re-run the model query after it was created. This PR fixes the issue.",ranquild,2024-07-24 16:05:59+00:00,['ranquild'],2024-10-08 16:19:46+00:00,2024-07-24 21:51:59+00:00,https://github.com/metabase/metabase/pull/46066,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2248911909, 'issue_id': 2427972737, 'author': 'nemanjaglumac', 'body': ""[The failure](https://github.com/metabase/metabase/actions/runs/10082833933/job/27880874702?pr=46066#step:13:313) you're running into is a flake and will be fixed by https://github.com/metabase/metabase/pull/46091"", 'created_at': datetime.datetime(2024, 7, 24, 21, 15, 25, tzinfo=datetime.timezone.utc)}]","nemanjaglumac on (2024-07-24 21:15:25 UTC): [The failure](https://github.com/metabase/metabase/actions/runs/10082833933/job/27880874702?pr=46066#step:13:313) you're running into is a flake and will be fixed by https://github.com/metabase/metabase/pull/46091

"
2427957581,pull_request,closed,,Allow stress testing E2E tests with PostgresDB,"https://metaboat.slack.com/archives/C5XHN8GLW/p1721748951758109

It wasn't possible since we hard-coded mongo when stress-testing.

Stress testing results using `gh workflow run e2e-stress-test-flake-fix.yml --ref allow-running-postgres-db-in-e2e-stress-test-workflow -f xxxx`
- [Mongo test with `qa_db: none`](https://github.com/metabase/metabase/actions/runs/10079989506): ❌ Tests seem to be automatically skipped.
- [Mongo test with `qa_db: mongo`](https://github.com/metabase/metabase/actions/runs/10079991722): ✅
- [Postgres test with `qa_db: none`](https://github.com/metabase/metabase/actions/runs/10079997496): ❌ Tests would fail when calling `restore(""postgres-12"")` since we never make Postgres snapshot with `qa_db: none`
- [Postgres test with `qa_db: postgres`](https://github.com/metabase/metabase/actions/runs/10079996138): ✅
- [Normal test with `qa_db: none`](https://github.com/metabase/metabase/actions/runs/10080002722): ✅",WiNloSt,2024-07-24 15:58:52+00:00,['WiNloSt'],2024-10-08 16:19:43+00:00,2024-07-25 12:03:35+00:00,https://github.com/metabase/metabase/pull/46065,"[('.CI & Tests', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2427955874,pull_request,closed,,Show error when geojson coordinates are outside lat/lng bounds,"Closes https://github.com/metabase/metabase/issues/39767
### Description

Describe the overall approach and the problem being solved.
Adds an error message when GeoJSON file contains coordinates that are outside lat/lng bounds. We compute this when creating loading a map file in the `Add a map` modal.

Describe the steps to verify that the changes are working as expected.

1. Admin -> Settings -> Maps
2. Click add a map, and use one of the URLs in the linked issue
3. Click Load
4. You should see an error displayed. Try using a known GeoJSON file that uses lat/lng coordinates and it should work as normal

### Demo
![image](https://github.com/user-attachments/assets/8a967acf-7c25-4c59-8cd8-644c314d1e0e)

### Checklist
- [x] Tests have been added/updated to cover changes in this PR
",npfitz,2024-07-24 15:58:12+00:00,['npfitz'],2024-07-30 19:44:52+00:00,2024-07-30 19:44:50+00:00,https://github.com/metabase/metabase/pull/46064,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2427902646,pull_request,closed,,perf/fix schedule 8am bug 2,"### Description

Adds custom resolvers for svg files which couldn't be loaded by esbuild for some reason

![image (11)](https://github.com/user-attachments/assets/5a95bb22-9088-4ef4-ab4f-f9897a3247fe)


### How to verify

ci is green",uladzimirdev,2024-07-24 15:37:34+00:00,['uladzimirdev'],2024-07-25 10:26:54+00:00,2024-07-25 10:26:52+00:00,https://github.com/metabase/metabase/pull/46062,"[('.Team/DevEx', '')]","[{'comment_id': 2248328969, 'issue_id': 2427902646, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 65e38984e8fce1da975d0dbb1ccc7ec553a84d24...89c3f1dbc4075df891c155ce78db34f958832aa0.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/TableInteractive/TableInteractive.jsx<br>frontend/src/metabase/visualizations/lib/settings/column.js<br>frontend/src/metabase/visualizations/visualizations/ObjectDetail.jsx<br>frontend/src/metabase/visualizations/visualizations/Table.tsx |', 'created_at': datetime.datetime(2024, 7, 24, 15, 38, 58, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-24 15:38:58 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 65e38984e8fce1da975d0dbb1ccc7ec553a84d24...89c3f1dbc4075df891c155ce78db34f958832aa0.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/TableInteractive/TableInteractive.jsx<br>frontend/src/metabase/visualizations/lib/settings/column.js<br>frontend/src/metabase/visualizations/visualizations/ObjectDetail.jsx<br>frontend/src/metabase/visualizations/visualizations/Table.tsx |

"
2427876838,pull_request,closed,,Add e2e tests for 45831 - instance analytics db appearing in permissions,Adds e2e tests further covering #45831,iethree,2024-07-24 15:25:30+00:00,['iethree'],2024-07-26 14:20:13+00:00,2024-07-26 13:52:13+00:00,https://github.com/metabase/metabase/pull/46061,"[('.CI & Tests', ''), ('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2427852628,pull_request,closed,,"Don't show ""Download results"" button until dashcard query is complete","Fixes #46019

Fixes dashcard menu had the ""Download results"" button while the card's query was still running

### To verify

1. Create a dashboard with at least one card
2. (Optionally) Enable network throttling
3. Open the dashboard page
4. Ensure you can't see the dashboard ellipsis menu until the query is complete

### Demo

https://github.com/user-attachments/assets/37230b79-2b5d-4488-a7c0-221a1f45ac4a

",kulyk,2024-07-24 15:13:51+00:00,['kulyk'],2024-07-25 12:56:56+00:00,2024-07-25 12:56:54+00:00,https://github.com/metabase/metabase/pull/46060,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2427794717,pull_request,closed,,"🤖 backported ""ci: Fix ace editor E2E typing flakes""",Automatic backport of #46048 with the manual conflict resolution.,github-automation-metabase,2024-07-24 14:49:11+00:00,"['nemanjaglumac', 'github-automation-metabase']",2024-07-24 15:33:54+00:00,2024-07-24 15:33:52+00:00,https://github.com/metabase/metabase/pull/46058,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2427788106,pull_request,closed,,"🤖 backported ""Embedding Parameter Values set in Tokens work properly when `nil` or empty list""","  #45771
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-24 14:46:18+00:00,"['adam-james-v', 'github-automation-metabase']",2024-07-24 19:21:24+00:00,2024-07-24 19:21:22+00:00,https://github.com/metabase/metabase/pull/46057,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2427783992,pull_request,closed,,Fix accidental comma in location.svg,"### Description

I found it because I added `have.text` assertion on an element with icon and text inside, and a comma suddenly appeared.
See [source diff](https://github.com/user-attachments/assets/44a6f758-0343-4a37-af28-22a8599210c6) for text diff.

",kamilmielnik,2024-07-24 14:44:29+00:00,['kamilmielnik'],2024-07-25 06:35:33+00:00,2024-07-25 06:29:58+00:00,https://github.com/metabase/metabase/pull/46056,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2248209230, 'issue_id': 2427783992, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 50d0c35a77eeeecd67c37d3f6e7a088a7b8da950...e3b0513bb74ce26c6c7594c37c554141df99b3cf.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/location.svg |', 'created_at': datetime.datetime(2024, 7, 24, 14, 47, 1, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-24 14:47:01 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 50d0c35a77eeeecd67c37d3f6e7a088a7b8da950...e3b0513bb74ce26c6c7594c37c554141df99b3cf.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/location.svg |

"
2427708791,pull_request,closed,,Disallow multi-stage metrics,"Product doc https://www.notion.so/metabase/Querying-and-combining-metrics-defined-on-the-same-data-source-1229f547df8140ce9c6f96cd707d28a5

Reuses the mechanism for disallow nested queries when the database doesn't support it.

How to verify:
- New -> Metric
- Select a table
- Select an aggregation
- You cannot add post-aggregation clauses

<img width=""1329"" alt=""Screenshot 2024-07-24 at 10 11 31"" src=""https://github.com/user-attachments/assets/3d346e45-11d8-43be-aa54-b8a941b446cb"">
",ranquild,2024-07-24 14:12:02+00:00,['ranquild'],2024-10-08 16:19:50+00:00,2024-07-24 16:12:43+00:00,https://github.com/metabase/metabase/pull/46054,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2427632798,pull_request,closed,,fix: use correct schema version for embed flow analytics,"Fix after [update static_embed_code_copied to use downloads (+227 −24)](https://github.com/metabase/metabase/pull/45944)

It wasn't caught by expectNoBadSnowplowEvents,It seems like snowplow-micro doesn't detect errors in nested objects?",npretto,2024-07-24 13:42:08+00:00,['npretto'],2024-07-25 07:25:25+00:00,2024-07-25 07:25:23+00:00,https://github.com/metabase/metabase/pull/46053,"[('.Team/Embedding', '')]",[],
2427608277,pull_request,closed,,"🤖 backported ""Fix broken `details-only` check in viz ""","  #45959
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-24 13:33:31+00:00,"['ranquild', 'github-automation-metabase']",2024-07-24 19:31:53+00:00,2024-07-24 19:31:52+00:00,https://github.com/metabase/metabase/pull/46052,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2248206314, 'issue_id': 2427608277, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff fab11f44b570491a3e4c76508183e8b1ee8a5849...277a6ecc8bc1cdb5f32fb7337dbcf2ff8cfd858e.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/TableInteractive/TableInteractive.jsx<br>frontend/src/metabase/visualizations/lib/settings/column.js<br>frontend/src/metabase/visualizations/visualizations/ObjectDetail.jsx<br>frontend/src/metabase/visualizations/visualizations/Table.tsx |', 'created_at': datetime.datetime(2024, 7, 24, 14, 45, 42, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-24 14:45:42 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff fab11f44b570491a3e4c76508183e8b1ee8a5849...277a6ecc8bc1cdb5f32fb7337dbcf2ff8cfd858e.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/TableInteractive/TableInteractive.jsx<br>frontend/src/metabase/visualizations/lib/settings/column.js<br>frontend/src/metabase/visualizations/visualizations/ObjectDetail.jsx<br>frontend/src/metabase/visualizations/visualizations/Table.tsx |

"
2427490591,pull_request,closed,,"Update ""Clear"" and ""Reset"" buttons","Closes #45983

Existing issues found when working on this:
- #46177
- #46263

### Description

For specs see (2) and ""Button logic"" in the [product doc](https://www.notion.so/metabase/Reset-dashboard-filters-eeb554324b00457bb1daa250b41bf0e5?d=3eca849ea95b444e962fe2a0898643a6#b386d706a7ca4c6499cab56e8a486974)
Implements """"Clear"" & ""Reset"" buttons"" part of the testing plan: #45977

There are 40 screenshots updated in the PR due to a small sub-pixel shift of the chevron icon (17359be5c35c8e2dd1958e61e5743feddb143925).

### How to verify

Subject: ""Clear"" & ""Reset"" buttons in dashboard & native question filter inputs.
Check all types of filters and default value input in parameter sidebar.

More info in the testing plan: #45977.

### Caveats (existing)

- Chevron icon
  - Always displayed in Dashboard Filters because all Dashboard Filters are actually dropdowns
  - In SQL Filters displayed only for Date Filters and non-required, non-input-box Field Filters


### Demo

#### Dashboard filters

https://github.com/user-attachments/assets/d80aa558-68c9-43a9-8e96-c352f2220ef7

#### Native question filters

https://github.com/user-attachments/assets/4f1afe4f-ca6e-4ae1-ac90-3bcc47270903

",kamilmielnik,2024-07-24 12:42:53+00:00,['kamilmielnik'],2024-08-05 08:48:07+00:00,2024-08-05 08:48:05+00:00,https://github.com/metabase/metabase/pull/46050,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2258566759, 'issue_id': 2427490591, 'author': 'github-actions[bot]', 'body': '👋 Deploying a preview environment for commit 23db0211f761512673ada48ce5ff7f787015f015.\n✅ Preview:\n    https://pr46050.coredev.metabase.com\n<!-- Sticky Pull Request Comment -->', 'created_at': datetime.datetime(2024, 7, 30, 15, 0, 3, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-30 15:00:03 UTC): 👋 Deploying a preview environment for commit 23db0211f761512673ada48ce5ff7f787015f015.
✅ Preview:
    https://pr46050.coredev.metabase.com
<!-- Sticky Pull Request Comment -->

"
2427484240,pull_request,closed,,"🤖 backported ""test: wait for element to be rendered in flaky test""",#45978,github-automation-metabase,2024-07-24 12:40:02+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-07-24 12:58:34+00:00,2024-07-24 12:58:33+00:00,https://github.com/metabase/metabase/pull/46049,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2427468805,pull_request,closed,,ci: Fix ace editor E2E typing flakes,"### What does this PR accomplish?
It fixes some of the most recent E2E typing flakes that seem to be more exacerbated in combination with the ace_editor.

We are using the UI flow to start a new question or a model in way too many places. This PR creates two new helpers that will open the new native question/model page programmatically by providing the base64 encoded query.

**It is possible to pre-select a database and a query, if needed.**

> [!Important]
> These new helpers *do not* return the ace editor on purpose so that you can't chain `.type()` on it!

**Before** ❌ 
```js
startNewNativeQuestion().type(""select 1"");
```

**Now** ✅ 
```js
startNewNativeQuestion();
focusNativeEditor().type(""select 1"");
```

### Next steps
I plan to start applying these new helpers to a lot of other tests that haven't been flaky to begin with. For now it's important to keep the PR reasonably small to minimize the chances of merge conflicts.

The new helper I'm thinking about:
```ts
startNewNativeQuery();
enterNativeQuery(query: string, config: { runQuery: boolean, delay: number});
```",nemanjaglumac,2024-07-24 12:32:05+00:00,['nemanjaglumac'],2024-07-24 15:34:20+00:00,2024-07-24 14:48:23+00:00,https://github.com/metabase/metabase/pull/46048,"[('backport', 'Automatically create PR on current release branch on merge'), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2427466026,pull_request,closed,,"🤖 backported ""dx: clean output folder before building jar""",#45911,github-automation-metabase,2024-07-24 12:30:46+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-07-24 13:11:55+00:00,2024-07-24 13:11:54+00:00,https://github.com/metabase/metabase/pull/46047,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2427442999,pull_request,closed,,"🤖 backported ""Add repro for 38041""",#46003,github-automation-metabase,2024-07-24 12:19:23+00:00,"['npfitz', 'github-automation-metabase']",2024-07-24 12:46:16+00:00,2024-07-24 12:46:15+00:00,https://github.com/metabase/metabase/pull/46046,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2427416867,pull_request,closed,,Fix default viz settings are ignored when saving a question from raw table view,"Closes #41612

Fixes an issue when saving a new question while being in the ""view raw data"" mode won't include default visualization settings. The problem is that when entering the ""raw data"" view, we're patching the card in the [`getRawSeries` selector](https://github.com/metabase/metabase/blob/ae14aa31bc3038200f6109f8628690a77b0b7502/frontend/src/metabase/query_builder/selectors.js#L722), and then use that ""table"" series when constructing default viz settings [in `getSubmittableQuestion`](https://github.com/metabase/metabase/blob/ae14aa31bc3038200f6109f8628690a77b0b7502/frontend/src/metabase/query_builder/selectors.js#L1117). Fixed by constructing a separate series object in `getSubmittableQuestion`. I considered moving out this logic closer to the visualization itself, but it seems like other parts of the QB might expect a ""table"" series

### To verify

1. New > Question > Sample Database > Count of Orders by Created At
2. Set the visualization to ""line""
3. Click the ""table"" icon at the bottom to enter the raw data view
4. Save the question while being in the raw data view
5. Ensure the card object in `POST /api/card` request body contains `graph.metrics` and `graph.dimensions` viz settings",kulyk,2024-07-24 12:07:08+00:00,['kulyk'],2024-08-07 00:06:14+00:00,2024-08-07 00:06:13+00:00,https://github.com/metabase/metabase/pull/46045,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2247745006, 'issue_id': 2427416867, 'author': 'github-actions[bot]', 'body': '@kulyk You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 7, 24, 12, 7, 31, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-24 12:07:31 UTC): @kulyk You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2427403655,pull_request,closed,,Update SDK version to 0.1.24,Update Readme version references and published npm package version to 0.1.24,github-automation-metabase,2024-07-24 12:00:11+00:00,"['heypoom', 'github-automation-metabase']",2024-10-08 16:19:51+00:00,2024-07-24 12:04:10+00:00,https://github.com/metabase/metabase/pull/46044,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2247732149, 'issue_id': 2427403655, 'author': 'github-actions[bot]', 'body': '@github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 7, 24, 12, 0, 33, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-24 12:00:33 UTC): @github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2427400712,pull_request,closed,,docs(sdk): readme updates on react 17 partial compatibility,Updates the README with current status of React 17 compatibility,heypoom,2024-07-24 11:58:32+00:00,['heypoom'],2024-10-08 16:19:48+00:00,2024-07-24 17:34:26+00:00,https://github.com/metabase/metabase/pull/46043,"[('no-backport', 'Do not backport this PR to any branch')]",[],
2427378280,pull_request,closed,,Fix driver changelog for 0.50.16 entries,"This fixes an the driver changelog incorrectly resolved merge conflict in https://github.com/metabase/metabase/pull/44654 which added a couple of entries for 0.50.16 in the middle of the entries fro 0.51.0.

The PR also makes the indentation consistent.

I've already incorporated these changes into the backport, so there's no need to backport this.
https://github.com/metabase/metabase/pull/46027",calherries,2024-07-24 11:47:17+00:00,['calherries'],2024-10-08 16:19:44+00:00,2024-07-25 11:43:32+00:00,https://github.com/metabase/metabase/pull/46042,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2427324231,pull_request,closed,,Structure e2e API helpers,"### Description

I was refactoring `cy.createQuestionAndDashboard` to a TS function helper and then I had to make a choice where to put that helper. There were 2 candidates (`e2e-dashboard-helpers.ts` & `e2e-question-helpers.ts`) but none of them looked better than the other. So I tried to zoom out and see if there's another place where this helper belongs and then I realized we can separate UI helpers from API helpers. Now when you see ""dashboard helpers"" file, you should expect it to only contain functions that help you interact with the dashboard page UI in the app. Functions that perform API requests without interacting with app UI will now live separately. This is similar to how we used to structure now-deprecated Cypress commands (`support/commands/api` & `support/commands/ui`).

This PR:
- Moves all simple (i.e. without any assertions) API helpers defined in TS to `e2e/support/helpers/api`
  - This is part of an effort to structure e2e helpers better; 1st step - keep API helpers separately from UI helpers
  - 1 helper exported per file - extra discoverability
  - Important helper types can be exported from `e2e/support/helpers/api` as needed
- Refactors `cy.createQuestionAndDashboard` command to a TS function helper and deprecates `cy.createQuestionAndDashboard`
- Merges all TypeScript API-specific Cypress command definitions into a single file: `e2e/support/commands/api/index.ts`
- Explicitly specifies return types in all API helpers

### How to verify

CI is green.",kamilmielnik,2024-07-24 11:20:40+00:00,['kamilmielnik'],2024-07-29 08:42:17+00:00,2024-07-29 07:16:34+00:00,https://github.com/metabase/metabase/pull/46041,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2427048907,pull_request,closed,,Fix E2E models flake 35039,"### What does this PR accomplish?
It fixes the models E2E flake (#35039) by updating the reproduction to use the API instead of UI.

This was important not only for the sake of flake fixing, but because the original issue #35039 cannot be reproduced anymore using the UI.

### Previous CI failure example
https://github.com/metabase/metabase/actions/runs/10064164841/job/27821774739#step:13:497 
![issues 35039 and 37009 -- should show columns available in the model (metabase#35039) (metabase#37009) (failed) (attempt 2)](https://github.com/user-attachments/assets/43f71003-e109-41c0-b6c6-0fcdd23d2d02)

### Explanation
Based on the screenshot above, I can conclude that this was caused by a Cypress mistyping (which seems to be unreliable combined with the ace_editor). It probably submitted the malformed query.

### Stress-test
50/50 ✅  https://github.com/metabase/metabase/actions/runs/10074095710",nemanjaglumac,2024-07-24 09:27:16+00:00,['nemanjaglumac'],2024-10-08 16:19:53+00:00,2024-07-24 10:44:52+00:00,https://github.com/metabase/metabase/pull/46038,"[('.CI & Tests', ''), ('backport', 'Automatically create PR on current release branch on merge'), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2427046734,pull_request,closed,,Refactor e2e dashboard helpers to TypeScript,"### Description

- Refactors the following files to TypeScript:
  - `e2e/support/commands/api/dashboard.js`
  - `e2e/support/helpers/e2e-dashboard-helpers.js`
- Extracts `archiveDashboard` & `createDashboard` helpers and deprecates `cy.archiveDashboard` & `cy.createDashboard` commands

### How to verify

CI is green.",kamilmielnik,2024-07-24 09:26:34+00:00,['kamilmielnik'],2024-07-26 08:52:13+00:00,2024-07-25 09:42:13+00:00,https://github.com/metabase/metabase/pull/46037,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2426798362,pull_request,closed,,e2e: Try older version of Chrome (v108) [WIP],,nemanjaglumac,2024-07-24 07:24:29+00:00,['nemanjaglumac'],2024-07-25 15:02:01+00:00,2024-07-25 15:01:59+00:00,https://github.com/metabase/metabase/pull/46036,"[('backport', 'Automatically create PR on current release branch on merge'), ('do not merge', ''), ('.Team/Querying', '')]","[{'comment_id': 2250601740, 'issue_id': 2426798362, 'author': 'nemanjaglumac', 'body': 'Abandoning for now.', 'created_at': datetime.datetime(2024, 7, 25, 15, 1, 59, tzinfo=datetime.timezone.utc)}]","nemanjaglumac (Issue Creator) on (2024-07-25 15:01:59 UTC): Abandoning for now.

"
2426656857,pull_request,closed,,"🤖 backported ""[perf] Only update ParameterCard when it changes""",#45901,github-automation-metabase,2024-07-24 05:52:04+00:00,"['qnkhuat', 'github-automation-metabase']",2024-07-24 10:20:50+00:00,2024-07-24 10:20:50+00:00,https://github.com/metabase/metabase/pull/46035,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2426642813,pull_request,closed,,[Notification] Remove channel details for users without write perms,"Only returns channel.details for Admin or Setting managers

Epic: https://github.com/metabase/metabase/issues/43822",qnkhuat,2024-07-24 05:40:17+00:00,['qnkhuat'],2024-07-24 09:22:45+00:00,2024-07-24 09:22:43+00:00,https://github.com/metabase/metabase/pull/46034,"[('.Team/Workflows', 'aka BEC')]",[],
2426566006,pull_request,closed,,[Notification] Serdes channel,"Part of milestone 3 of https://github.com/metabase/metabase/issues/43822

Add a test to ensure serdes for Channel works properly.

Also add a unique index for `channel.name` because we use it as the entity-id for serdes. See [context](https://github.com/metabase/metabase/pull/46031#issue-2426566006)",qnkhuat,2024-07-24 04:25:37+00:00,['qnkhuat'],2024-07-25 08:47:24+00:00,2024-07-25 08:47:22+00:00,https://github.com/metabase/metabase/pull/46031,"[('.Team/Workflows', 'aka BEC')]",[],
2426396694,pull_request,closed,,"🤖 backported ""Make Redshift sync much more robust""","  #46021
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-24 01:26:55+00:00,"['camsaul', 'github-automation-metabase']",2024-07-24 05:10:10+00:00,2024-07-24 05:10:09+00:00,https://github.com/metabase/metabase/pull/46030,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2426152251,pull_request,closed,,"🤖 backported ""Skip syncing field values for oracle CLOB columns""","  #44654
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-23 21:20:20+00:00,"['calherries', 'github-automation-metabase']",2024-07-24 14:38:36+00:00,2024-07-24 14:38:34+00:00,https://github.com/metabase/metabase/pull/46027,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2426124816,pull_request,closed,,"🤖 backported ""docs - mysql appdb note""",#45956,github-automation-metabase,2024-07-23 21:02:40+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-23 21:04:20+00:00,2024-07-23 21:04:19+00:00,https://github.com/metabase/metabase/pull/46026,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2426079920,pull_request,closed,,Migrate field ref-based column keys in `column_settings`,"Related to https://github.com/metabase/metabase/pull/46383

We had a lot of migrations to maintain field refs in `column_settings` in the past, and I hope this is the last migration.

Currently, we have 2 column keys used in `column_settings` - field ref-based (`[""ref"", [""field"", 1, null]]`) and name-based (`[""name"", ""ID""]`). We use(d) field-ref keys for simple cases where a query is based on a raw table, and name-based in more complex cases (this is simplified). This was error prone because of the following reasons:
- Makes it very hard to do any MBQL changes/fixes because every change would require a custom migration
- Field ref-based keys omit `:binning` and `temporal-unit` options, making it impossible to have columns that differ only by this options
- Some changes to a query (new stage etc) would trigger field ref changes and loss of all settings
- Any bugs with field refs (self joins etc) automatically result in bugs in viz settings

This PR migrates all `column_settings` keys to name-based keys. The FE in the referenced PR supports both field ref- and name-based keys for the keys that would not be migrated by this migration (no `result_metadata`).

How to verify:
- Switch to the base branch (master)
- Create questions with `column_settings`. These are formatting settings for columns. E.g. New -> Orders -> Visualize, click on column headers -> Gear icon -> Change column title -> Save question
- Checkout this branch and run
- All your viz settings should be migrated. There should be no visual changes. Export should continue working and it should use the updated settings.
- You can check that the settings are migrated by inspecting Network and making sure that `[""name"", ...]` keys are used in `column_settings` in `visualization_settings`.",ranquild,2024-07-23 20:34:03+00:00,['ranquild'],2024-10-08 16:18:27+00:00,2024-08-07 23:37:53+00:00,https://github.com/metabase/metabase/pull/46025,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2253368194, 'issue_id': 2426079920, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff bfc6838a7b2056950bff61e1947742d427820259...e68efdf4fb28bc4345b9480c9b1738e2fa32749d.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/echarts/cartesian/model/axis.ts<br>frontend/src/metabase/visualizations/lib/settings/column.unit.spec.js<br>frontend/src/metabase/visualizations/lib/settings/visualization.js<br>frontend/src/metabase/visualizations/shared/settings/column.ts |', 'created_at': datetime.datetime(2024, 7, 26, 19, 48, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2273385464, 'issue_id': 2426079920, 'author': 'ranquild', 'body': ""@calherries that's correct. Both the FE and BE support legacy column keys and there are many existing tests for this behavior. My expectations, based on stats, is that this migration will convert 80% of all legacy column keys in viz settings; the other 20% will be slowly migrated by the FE - it overwrites column keys on change."", 'created_at': datetime.datetime(2024, 8, 7, 12, 44, 6, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-26 19:48:37 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff bfc6838a7b2056950bff61e1947742d427820259...e68efdf4fb28bc4345b9480c9b1738e2fa32749d.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/echarts/cartesian/model/axis.ts<br>frontend/src/metabase/visualizations/lib/settings/column.unit.spec.js<br>frontend/src/metabase/visualizations/lib/settings/visualization.js<br>frontend/src/metabase/visualizations/shared/settings/column.ts |

ranquild (Issue Creator) on (2024-08-07 12:44:06 UTC): @calherries that's correct. Both the FE and BE support legacy column keys and there are many existing tests for this behavior. My expectations, based on stats, is that this migration will convert 80% of all legacy column keys in viz settings; the other 20% will be slowly migrated by the FE - it overwrites column keys on change.

"
2425969621,pull_request,closed,,Some improvements to the REST API for query field validation,"Fixes (bits of): https://github.com/metabase/metabase/issues/44976

- Allow filtering on collection
- Add effective_ancestors to collection data",johnswanson,2024-07-23 19:32:54+00:00,[],2024-10-08 16:19:07+00:00,2024-07-31 19:28:02+00:00,https://github.com/metabase/metabase/pull/46024,"[('no-backport', 'Do not backport this PR to any branch')]",[],
2425915319,pull_request,closed,,Docstrings and refinements to the query-analysis module,"Closes https://github.com/metabase/metabase/issues/45720

### Description

- Add namespace docstrings.
- Expand on function docstrings.
- Finesse wording and add guidance.
- Disable more components based on settings.
",crisptrutski,2024-07-23 19:06:25+00:00,['crisptrutski'],2024-07-24 10:56:24+00:00,2024-07-24 10:56:21+00:00,https://github.com/metabase/metabase/pull/46023,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2425900306,pull_request,closed,,"🤖 backported ""Don't trigger onChange when create dialog is open""",#45989,github-automation-metabase,2024-07-23 18:59:16+00:00,"['npfitz', 'github-automation-metabase']",2024-07-23 19:28:31+00:00,2024-07-23 19:28:30+00:00,https://github.com/metabase/metabase/pull/46022,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2425896613,pull_request,closed,,Make Redshift sync much more robust,Add auto-retry logic to Redshift `describe-database` as a temporary workaround for #45874 to fix CI flakes,camsaul,2024-07-23 18:57:51+00:00,['camsaul'],2024-07-29 13:20:39+00:00,2024-07-24 01:26:08+00:00,https://github.com/metabase/metabase/pull/46021,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2255419339, 'issue_id': 2425896613, 'author': 'calherries', 'body': '@metabase-bot backport release-x.49.x', 'created_at': datetime.datetime(2024, 7, 29, 9, 17, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2255421603, 'issue_id': 2425896613, 'author': 'github-actions[bot]', 'body': '@calherries something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10141545592)', 'created_at': datetime.datetime(2024, 7, 29, 9, 18, 37, tzinfo=datetime.timezone.utc)}]","calherries on (2024-07-29 09:17:32 UTC): @metabase-bot backport release-x.49.x

github-actions[bot] on (2024-07-29 09:18:37 UTC): @calherries something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10141545592)

"
2425872443,pull_request,closed,,"🤖 backported ""Fix several problems with the localization of the Performance feature""","  #45773
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-23 18:44:13+00:00,"['rafpaf', 'github-automation-metabase']",2024-07-24 03:04:31+00:00,2024-07-24 03:04:29+00:00,https://github.com/metabase/metabase/pull/46020,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2246772723, 'issue_id': 2425872443, 'author': 'rafpaf', 'body': '### Merge activity\n\n* **Jul 23, 11:04 PM EDT**: @rafpaf merged this pull request with [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/46020).', 'created_at': datetime.datetime(2024, 7, 24, 3, 4, 30, tzinfo=datetime.timezone.utc)}]","rafpaf (Assginee) on (2024-07-24 03:04:30 UTC): ### Merge activity

* **Jul 23, 11:04 PM EDT**: @rafpaf merged this pull request with [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/46020).

"
2425852716,pull_request,closed,,"🤖 backported ""Add v0.50.15 to the list of releases""",#46017,github-automation-metabase,2024-07-23 18:32:44+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-23 18:34:14+00:00,2024-07-23 18:34:13+00:00,https://github.com/metabase/metabase/pull/46018,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2425826996,pull_request,closed,,Add v0.50.15 to the list of releases,Like it says on the tin 😁,github-automation-metabase,2024-07-23 18:17:16+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-07-23 18:34:42+00:00,2024-07-23 18:31:53+00:00,https://github.com/metabase/metabase/pull/46017,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2425824493,pull_request,closed,,"🤖 backported ""Fix e2e-models-metadata flakes""",#45995,github-automation-metabase,2024-07-23 18:15:38+00:00,"['ranquild', 'github-automation-metabase']",2024-07-23 18:55:53+00:00,2024-07-23 18:55:52+00:00,https://github.com/metabase/metabase/pull/46016,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2425815239,pull_request,closed,,Update Translations for v50.19,"Update translations from POEditor for v50.15 ([128 new strings](https://github.com/metabase/metabase/actions/runs/10064019899/job/27820063308#step:6:887))


See [translation update documentation](https://www.notion.so/metabase/Process-for-updating-translations-421db70048fe400da1153ad0b61102f4)

## To Do

- [x] Upload new strings to POEditor
- [x] Message contributors on POEditor (manual)
- [x] Copy source strings to english language (manual)
- [x] Download translations from POEditor (github action)
- [x] Merge this PR and backport to the release branch (manual)
",github-actions[bot],2024-07-23 18:09:49+00:00,['iethree'],2024-08-06 15:47:09+00:00,2024-07-30 22:22:18+00:00,https://github.com/metabase/metabase/pull/46015,"[('Customization/i18n', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2425813071,pull_request,closed,,Abandon deduplicating queue due to a race condition,"Closes https://github.com/metabase/metabase/issues/46010

### Description

The more advanced version of the queue appears to have a race condition, but I can't figure out how it occurs.

We probably don't need this optimization, so removing this variant for now.",crisptrutski,2024-07-23 18:08:38+00:00,['crisptrutski'],2024-07-24 09:09:55+00:00,2024-07-24 09:09:54+00:00,https://github.com/metabase/metabase/pull/46014,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2425744231,pull_request,closed,,Use the new private defn,"we have `mu/defn-` now, so let's actually use it",escherize,2024-07-23 17:36:11+00:00,['escherize'],2024-10-08 16:19:41+00:00,2024-07-25 16:01:45+00:00,https://github.com/metabase/metabase/pull/46013,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2425710768,pull_request,closed,,fix(sdk): support React 17 backwards compatibility,"Closes https://github.com/metabase/metabase/issues/45713

### Description

Dropping support for React 17 means that most of the SDK customers can't use the SDK. The incompatibility with React 17 is caused by:

- [Upgrading react-redux to v9](https://github.com/metabase/metabase/pull/44339) - it uses useSyncExternalStore without any compatibility shims, which is only available in React 18. RTK 2.0 seems to [require](https://redux.js.org/usage/migrations/migrating-rtk-2) react-redux v9. We need to monkey-patch `React.useSyncExternalStore` so that it works for React 17.
- Use of `createRoot` in `TableInteractive`, which is not supported in React 17
- Back button crashing because of it not returning `null`

### How to verify

- Setup a test application using React 17 and the Embedding SDK
  - Alternatively, you could use the `test-react-17` branch of Shoppy (shown in the demo video below), but the CSS are pretty broken because of downgrading from Mantine v7 to Mantine v6. This is an issue with Shoppy's use of Mantine v7, not with the SDK.
- The SDK should still work fine. Try the following code paths:
  - Static Questions
  - Interactive Questions
  - Drill Downs to Interactive Questions (tables) 
  - Interactive Dashboards

### Demo

<div>
    <a href=""https://www.loom.com/share/c30f61fbc94d42d5ae975a15446f022f"">
      <p>React 17 backwards compatibility - Watch Video</p>
    </a>
    <a href=""https://www.loom.com/share/c30f61fbc94d42d5ae975a15446f022f"">
      <img style=""max-width:300px;"" src=""https://cdn.loom.com/sessions/thumbnails/c30f61fbc94d42d5ae975a15446f022f-3e80a821b599d1cd-full-play.gif"">
    </a>
  </div>

### Notes

- Will add sanity checks specifically for React 17 in a separate PR (see https://github.com/metabase/metabase/issues/45714), it'll take time to setup though.",heypoom,2024-07-23 17:16:28+00:00,['heypoom'],2024-07-24 10:25:24+00:00,2024-07-24 10:25:22+00:00,https://github.com/metabase/metabase/pull/46012,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2246124247, 'issue_id': 2425710768, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff fad4fe4c85a8393c50aca6f93f36a95b9c71bb4f...4aa94aa2fcae2cb23f4636299ba28637ef225407.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/TableInteractive/TableInteractive.jsx |', 'created_at': datetime.datetime(2024, 7, 23, 19, 28, 44, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-23 19:28:44 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff fad4fe4c85a8393c50aca6f93f36a95b9c71bb4f...4aa94aa2fcae2cb23f4636299ba28637ef225407.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/TableInteractive/TableInteractive.jsx |

"
2425684269,pull_request,closed,,Add Azure managed identity support,"This builds on #44261 implementing milestone 1 of the epic #43348 and implements milestones 2 and 3.

Full testing requires access to an Azure environment, which @luizarakaki can provide. Without that, the UI part can be tested by adding a new Postgres database to Metabase.

Azure Managed Identity UI

<img width=""641"" alt=""image"" src=""https://github.com/user-attachments/assets/14aaee65-ae73-4c53-b2bc-b1eda98de7c0"">

OAuth UI

<img width=""640"" alt=""image"" src=""https://github.com/user-attachments/assets/eaf9f944-b414-4037-96d8-7fa85fe84b06"">
",metamben,2024-07-23 17:00:42+00:00,['metamben'],2024-07-26 14:52:19+00:00,2024-07-25 21:30:11+00:00,https://github.com/metabase/metabase/pull/46011,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2425617600,pull_request,closed,,"🤖 backported ""Fix Analytics DB Appearing in Permissions""",#45831,github-automation-metabase,2024-07-23 16:26:25+00:00,"['iethree', 'github-automation-metabase']",2024-07-23 22:25:41+00:00,2024-07-23 22:25:40+00:00,https://github.com/metabase/metabase/pull/46008,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2425597885,pull_request,closed,,Creating Tusk Sanity GitHub workflow,"This PR adds the Tusk Sanity GitHub workflow to the repo. This will allow Tusk to automatically lint, build, and test code - resulting in higher quality PRs.

This workflow will only be run when you trigger Tusk to work on an issue. If you have any questions, please contact [support@usetusk.ai](mailto:support@usetusk.ai).",use-tusk[bot],2024-07-23 16:16:23+00:00,[],2024-10-08 16:19:59+00:00,2024-07-23 16:20:26+00:00,https://github.com/metabase/metabase/pull/46006,"[('.CI & Tests', ''), ('no-backport', 'Do not backport this PR to any branch')]",[],
2425586734,pull_request,closed,,Fix document title when opening a multi-series question from dashboard,"Closes #42165

Fixes an issue when opening a multi-series question from a dashboard, the document title becomes the name of the first series instead of the question name. This happened because [`onOpenQuestion` handler](https://github.com/metabase/metabase/blob/4c1964db7ecd89e5901618d3983bbe4db133c85e/frontend/src/metabase/visualizations/visualizations/CartesianChart/use-chart-events.ts#L60) wasn't receiving a proper `cardId` argument and was using an unexpected card object from a transformed series.

### To verify

1. New > Question > Sample Database > Orders > Count by PEOPLE.SOURCE and ORDERS.CREATED_AT > Save
2. Create a dashboard with the question from step 1, add a date parameter and connect it to ORDERS.CREATED_AT
3. Click the dashboard card name
4. Ensure the document.title uses the question name instead of a series name (Affiliate)

### Demo

**Before**

https://github.com/user-attachments/assets/d42ced5c-d935-40e1-98a7-4339774592ea

**After**

https://github.com/user-attachments/assets/12e01f04-5818-4e53-ac1e-7d74109cdf15",kulyk,2024-07-23 16:10:17+00:00,['kulyk'],2024-07-25 09:50:26+00:00,2024-07-25 09:50:24+00:00,https://github.com/metabase/metabase/pull/46004,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2245662712, 'issue_id': 2425586734, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 4c1964db7ecd89e5901618d3983bbe4db133c85e...d1d929e86dca5e363e58a493791085dfa993115b.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/visualizations/CartesianChart/CartesianChart.tsx |', 'created_at': datetime.datetime(2024, 7, 23, 16, 11, 40, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-23 16:11:40 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 4c1964db7ecd89e5901618d3983bbe4db133c85e...d1d929e86dca5e363e58a493791085dfa993115b.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/visualizations/CartesianChart/CartesianChart.tsx |

"
2425581989,pull_request,closed,,Add repro for 38041,"Closes https://github.com/metabase/metabase/issues/38041

### Description
While #38041 was already fixed in master by the time it was triaged, I wanted to add a quick check to an existing test to ensure it stays that way.

### How to verify
Green CI

### Checklist
- [s] Tests have been added/updated to cover changes in this PR
",npfitz,2024-07-23 16:07:44+00:00,['npfitz'],2024-07-24 12:18:40+00:00,2024-07-24 12:18:38+00:00,https://github.com/metabase/metabase/pull/46003,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2425557972,pull_request,closed,,Decouple query analysis models from validation API,"### Description

This is a small refactoring to encapsulate the way that query analysis is stored, such that the Query Reference Validation API can be independently maintained. This should help to enforce a better module boundary between the relevant teams.",crisptrutski,2024-07-23 15:55:43+00:00,['crisptrutski'],2024-10-08 16:19:55+00:00,2024-07-24 07:21:36+00:00,https://github.com/metabase/metabase/pull/46002,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2425530139,pull_request,closed,,"🤖 backported ""Fix dashboard subscription E2E flake 24223""",Automatic backport of #45993 with the manual conflict resolution.,github-automation-metabase,2024-07-23 15:42:08+00:00,"['nemanjaglumac', 'github-automation-metabase']",2024-07-24 06:51:10+00:00,2024-07-24 06:51:08+00:00,https://github.com/metabase/metabase/pull/46001,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2425476064,pull_request,closed,,"🤖 backported ""Make the i18n artifacts build in parallel rather than sequentially""",#45898,github-automation-metabase,2024-07-23 15:16:43+00:00,"['paoliniluis', 'github-automation-metabase']",2024-07-24 10:58:03+00:00,2024-07-24 10:58:02+00:00,https://github.com/metabase/metabase/pull/46000,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2425473851,pull_request,closed,,fix(sdk): throw errors when sdk hooks are used outside of redux context,"### Description

Throw an error when `useMetabaseAuthStatus` is used outside of the Redux context.

### How to verify

- Call the `useMetabaseAuthStatus` hook in a React component outside of `MetabaseProvider`
- An error should be thrown.

### Demo

![CleanShot 2567-07-23 at 22 59 46@2x](https://github.com/user-attachments/assets/11195c81-eb02-46c8-8ba7-c901dfa6327d)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",heypoom,2024-07-23 15:15:43+00:00,['heypoom'],2024-10-08 16:19:52+00:00,2024-07-24 11:12:42+00:00,https://github.com/metabase/metabase/pull/45999,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2425459599,pull_request,closed,,Cross branch migration testing workflow,"Adds a new github workflow that is triggered when any migration file is updated, which does the following:
1. Checks out master
2. Starts up Metabase with a specific DB type and version as the app DB (postgres/mysql/mariadb/h2)
	* I'm reusing all the docker images that we use in driver tests here 
4. Checks out the pull request branch
5. Starts up Metabase again with the same app DB and checks that migrations run successfully

This should ensure that an instance that has previously run all the commits on master will be able to run the migration without error, and avoid future issues like https://github.com/metabase/metabase/issues/45967

Reviewers: please review carefully because I am not super well-versed with github actions. It seems to be working but I mainly pieced this together from reading the existing code so let me know if I'm missing anything.",noahmoss,2024-07-23 15:09:20+00:00,['noahmoss'],2024-10-08 16:19:47+00:00,2024-07-24 17:37:27+00:00,https://github.com/metabase/metabase/pull/45998,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2245516773, 'issue_id': 2425459599, 'author': 'noahmoss', 'body': '* **#45998** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/45998?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 23, 15, 9, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2245853672, 'issue_id': 2425459599, 'author': 'noahmoss', 'body': ""Here's an example of a failed workflow in which I edited a MySQL/MariaDB-only migration in-place: https://github.com/metabase/metabase/actions/runs/10063595332/job/27818680269?pr=45998\r\n\r\nThe health check correctly times out for those DBs but passes for postgres/h2.\r\n\r\nIt's not ideal that it just times out without showing the error that Liquibase throws when Metabase starts up. If anyone has a pointer for how to adjust that I'd love to fix it."", 'created_at': datetime.datetime(2024, 7, 23, 17, 39, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2248454057, 'issue_id': 2425459599, 'author': 'noahmoss', 'body': ""@iethree I think I've addressed your comments, and also fixed the logging in a roundabout way (writing the logs from the background process to a file and then `cat`ing it if we detect that Metabase exited early).\r\n\r\nHere's a new example workflow run: https://github.com/metabase/metabase/actions/runs/10080432773/job/27870152448?pr=45998"", 'created_at': datetime.datetime(2024, 7, 24, 16, 34, 38, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-07-23 15:09:34 UTC): * **#45998** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/45998?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

noahmoss (Issue Creator) on (2024-07-23 17:39:40 UTC): Here's an example of a failed workflow in which I edited a MySQL/MariaDB-only migration in-place: https://github.com/metabase/metabase/actions/runs/10063595332/job/27818680269?pr=45998

The health check correctly times out for those DBs but passes for postgres/h2.

It's not ideal that it just times out without showing the error that Liquibase throws when Metabase starts up. If anyone has a pointer for how to adjust that I'd love to fix it.

noahmoss (Issue Creator) on (2024-07-24 16:34:38 UTC): @iethree I think I've addressed your comments, and also fixed the logging in a roundabout way (writing the logs from the background process to a file and then `cat`ing it if we detect that Metabase exited early).

Here's a new example workflow run: https://github.com/metabase/metabase/actions/runs/10080432773/job/27870152448?pr=45998

"
2425402168,pull_request,closed,,"🤖 backported ""dx: make fe stress test faster""",#45980,github-automation-metabase,2024-07-23 14:44:20+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-07-23 14:46:01+00:00,2024-07-23 14:46:00+00:00,https://github.com/metabase/metabase/pull/45996,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2425385270,pull_request,closed,,Fix e2e-models-metadata flakes,Stress test https://github.com/metabase/metabase/actions/runs/10063093462,ranquild,2024-07-23 14:37:33+00:00,['ranquild'],2024-07-23 18:56:19+00:00,2024-07-23 18:14:53+00:00,https://github.com/metabase/metabase/pull/45995,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2425363607,pull_request,closed,,"🤖 backported ""Fix - Calendar widget jumps when switching months""",#45803,github-automation-metabase,2024-07-23 14:28:22+00:00,"['kamilmielnik', 'github-automation-metabase']",2024-07-23 14:55:19+00:00,2024-07-23 14:55:18+00:00,https://github.com/metabase/metabase/pull/45994,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2245412936, 'issue_id': 2425363607, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 1de8b2ba50ab95a31de74a6d3f13bcbf5f4210de...5030600aadbcbbdb4f5e26abae011c9fb37ded8f.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/inputs/Calendar/Calendar.styled.tsx |', 'created_at': datetime.datetime(2024, 7, 23, 14, 29, 45, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-23 14:29:45 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 1de8b2ba50ab95a31de74a6d3f13bcbf5f4210de...5030600aadbcbbdb4f5e26abae011c9fb37ded8f.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/inputs/Calendar/Calendar.styled.tsx |

"
2425304569,pull_request,closed,,Fix dashboard subscription E2E flake 24223,"### What does this PR accomplish?
It fixes an E2E flake for the dashboard subscription #24223 by rewriting it to use API for the setup. I have no idea why did we use the UI for a fairly complex dashboard setup in the first place.

The general rule is to use API for the setup in areas where we just want to test the effects of a setup and not the flow needed for that setup.

### Stress-test
50/50 ✅ https://github.com/metabase/metabase/actions/runs/10061310313",nemanjaglumac,2024-07-23 14:02:48+00:00,['nemanjaglumac'],2024-07-24 06:51:39+00:00,2024-07-23 15:41:18+00:00,https://github.com/metabase/metabase/pull/45993,"[('backport', 'Automatically create PR on current release branch on merge'), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2425298368,pull_request,closed,,Migration workflow test,,noahmoss,2024-07-23 14:00:21+00:00,[],2024-07-23 15:04:30+00:00,2024-07-23 15:04:30+00:00,https://github.com/metabase/metabase/pull/45992,[],[],
2425277252,pull_request,closed,,"🤖 backported ""Add v0.50.14 to the list of releases""",#45958,github-automation-metabase,2024-07-23 13:50:56+00:00,"['alexyarosh', 'github-automation-metabase']",2024-07-23 13:52:38+00:00,2024-07-23 13:52:37+00:00,https://github.com/metabase/metabase/pull/45991,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2425251219,pull_request,closed,,"🤖 backported ""Set validCheckSum for permissions migration to ANY""",#45981,github-automation-metabase,2024-07-23 13:39:41+00:00,"['noahmoss', 'github-automation-metabase']",2024-07-23 14:29:37+00:00,2024-07-23 14:29:36+00:00,https://github.com/metabase/metabase/pull/45990,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2425241096,pull_request,closed,,Don't trigger onChange when create dialog is open,"Closes https://github.com/metabase/metabase/issues/45360

### Description
When the create dashboard dialog is open on the dashboard picker and you press enter, the button bar was picking up the keypress and calling `onConfirm` with the currently selected value. This change adds another condition to `canConfirm` so that this handler won't fire when the create dialog is open (we handle this the same way already in the collection pciker)

### How to verify
1. Go to any question
2. Menu -> Add to dashboard
3. Select a dashboard, then click ""Create a new dashboard""
4. press enter. Nothing should happen. If you fill out the dashboard name and press enter, it should create the dashboard and preselect it in the modal.


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",npfitz,2024-07-23 13:35:24+00:00,['npfitz'],2024-07-23 18:58:22+00:00,2024-07-23 18:58:20+00:00,https://github.com/metabase/metabase/pull/45989,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2425240485,pull_request,closed,,"🤖 backported ""Fix editing models with metadata overrides""","  #45951
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-23 13:35:12+00:00,"['ranquild', 'github-automation-metabase']",2024-07-23 14:11:29+00:00,2024-07-23 14:11:28+00:00,https://github.com/metabase/metabase/pull/45988,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2425182980,pull_request,closed,,fix webpack refresh in static mode,"fix hot refresh logic: we have a case when the app is built in cold mode, but not in production mode",uladzimirdev,2024-07-23 13:10:14+00:00,['uladzimirdev'],2024-10-08 16:19:58+00:00,2024-07-23 16:56:28+00:00,https://github.com/metabase/metabase/pull/45987,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]",[],
2425153323,pull_request,closed,,Rename feature to query-reference-validation,"### Description

Since query identifiers can reference more than just tables, it is prudent to rename this feature before it goes out into the world.
",crisptrutski,2024-07-23 12:57:25+00:00,['crisptrutski'],2024-10-08 16:19:57+00:00,2024-07-23 17:42:02+00:00,https://github.com/metabase/metabase/pull/45986,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2425113390,pull_request,closed,,"🤖 backported ""Fix the (object detail) flake for repro 39477""",#45973,github-automation-metabase,2024-07-23 12:38:10+00:00,"['nemanjaglumac', 'github-automation-metabase']",2024-07-23 13:07:14+00:00,2024-07-23 13:07:12+00:00,https://github.com/metabase/metabase/pull/45985,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2425062479,pull_request,closed,,Update SDK version to 0.1.23,Update Readme version references and published npm package version to 0.1.23,github-automation-metabase,2024-07-23 12:14:20+00:00,"['heypoom', 'github-automation-metabase']",2024-10-08 16:20:01+00:00,2024-07-23 12:18:31+00:00,https://github.com/metabase/metabase/pull/45982,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2245083946, 'issue_id': 2425062479, 'author': 'github-actions[bot]', 'body': '@github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\n\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 7, 23, 12, 14, 43, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-23 12:14:43 UTC): @github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.

Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2425031320,pull_request,closed,,Set validCheckSum for permissions migration to ANY,"Fixes https://github.com/metabase/metabase/issues/45967

The `validCheckSum` was for the Postgres version, but the MySQL version has a slightly different checkSum",noahmoss,2024-07-23 12:01:01+00:00,['noahmoss'],2024-07-23 13:38:55+00:00,2024-07-23 13:38:54+00:00,https://github.com/metabase/metabase/pull/45981,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2245045336, 'issue_id': 2425031320, 'author': 'noahmoss', 'body': '* **#45981** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/45981?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 23, 12, 1, 15, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-07-23 12:01:15 UTC): * **#45981** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/45981?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2425017057,pull_request,closed,,dx: make fe stress test faster,"### Description

Before we used to rebuild cljs files for every jest test run, now we build cljs files once, besides that in this PR we clean up a command to run jest and disable jest cache between runs

an example of the job https://github.com/metabase/metabase/actions/runs/10058675989/job/27802288485


### After

<img width=""983"" alt=""image"" src=""https://github.com/user-attachments/assets/d7c6dc68-1836-4621-bfbb-c6a6fd6e0e3c"">
",uladzimirdev,2024-07-23 11:54:16+00:00,['uladzimirdev'],2024-07-23 14:46:27+00:00,2024-07-23 14:43:28+00:00,https://github.com/metabase/metabase/pull/45980,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]",[],
2424945016,pull_request,closed,,"🤖 backported ""ci: Fix the native snippet flake""",#45976,github-automation-metabase,2024-07-23 11:20:24+00:00,"['nemanjaglumac', 'github-automation-metabase']",2024-07-23 11:50:44+00:00,2024-07-23 11:50:43+00:00,https://github.com/metabase/metabase/pull/45979,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2424938466,pull_request,closed,,test: wait for element to be rendered in flaky test,"### Description

[test is flaky](https://metaboat.slack.com/archives/C5XHN8GLW/p1721728505717639)

the root cause of flakiness seems in the number of re-renderings after ""setup"" function is called in test - I managed to get at least 3 renders, so we have to wait for elements to appear in the DOM longer. 

<img width=""1515"" alt=""image"" src=""https://github.com/user-attachments/assets/06e3c7f6-aa75-4080-b5a0-0f97250997b1"">

all 4 cases were updated to wait up to 10s (plus a bonus test which didn't fail _yet_)


The simplest solution I found is to wait longer, stress test passes on master, so it's not that easy to catch this flake https://github.com/metabase/metabase/actions/runs/10058675989/job/27802288485

### How to verify

CI is green

- stress ✅ https://github.com/metabase/metabase/actions/runs/10076378830/job/27856627057",uladzimirdev,2024-07-23 11:16:49+00:00,['uladzimirdev'],2024-07-24 12:59:06+00:00,2024-07-24 12:39:07+00:00,https://github.com/metabase/metabase/pull/45978,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]",[],
2424869019,pull_request,closed,,ci: Fix the native snippet flake,"### What does this PR accomplish?
It fixes the native snippet E2E flake by waiting for the ace editor to fully render.

The example of a failure.
Cypress starts typing, then the UI re-renders and it loses the first ""s"", so the editor only sees ""elect {{snippet: stuff-snippet}}"".
![scenarios  question  snippets -- should let you create and use a snippet burning 35 of 50 (failed)](https://github.com/user-attachments/assets/c6578c1b-3334-42c3-860d-e003e1d65d41)

### Explanation
We briefly display the loading state for databases to determine whether or not to display the database dropdown selector. Furthermore, if there's only one database or if we remembered the last selected database in metabase settings, the UI will still flicker ever so slightly between the data selector and the ""chosen/selected"" database being directly shown in the native editor.

This all causes ace editor to re-render.
It's possible that the cause should be fixed at the source but for the sake of the expediency, this PR puts some guards in place for the related native editor helpers. These guards will not get in the way even if we fix the FE source code in the future.

### Stress-test
- 50/50 ✅ https://github.com/metabase/metabase/actions/runs/10057185526
- 100/100 ✅ https://github.com/metabase/metabase/actions/runs/10057283973",nemanjaglumac,2024-07-23 10:43:12+00:00,['nemanjaglumac'],2024-07-23 11:51:10+00:00,2024-07-23 11:19:38+00:00,https://github.com/metabase/metabase/pull/45976,"[('.CI & Tests', ''), ('backport', 'Automatically create PR on current release branch on merge'), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2424856777,pull_request,closed,,Disable tracking for perf test,"This is an analysis of the impact of usage metadata tracking we added in https://github.com/metabase/metabase/issues/38229
In this branch, I disabled all the tracking and compare it against master(with tracking enabled)

Note: the tracking version only includes tracking of: view_count, report_dashboard.last_viewed_at, report_card.last_used_at. Field usage is already disabled on master.

Test spec: https://www.notion.so/metabase/Perf-Testing-Plan-Usage-data-tracking-5c9a6b7cf1444d97b338437ef673d12b?pvs=4

### Method
- The postgres DB is created with this [sql](https://gist.github.com/qnkhuat/1dc6af93365875ec372ce01936340104)
- Dashboard is created using this script: https://gist.github.com/qnkhuat/23552c5defc9db007de83f463a85e681
it creates a dashboard with 20 cards, each is a simple query against the table from the above DB
- Create 1 admin user (crowberto) and 1 sandboxed user (rasta)
- Spinning up each metabase jar with `java -Xms512m -Xmx8196m -jar {{JAR_FILE}}`
- Monitor using visual VM
- Stress testing using k6 with this [script](https://gist.github.com/qnkhuat/2b0ddf64b2b5c339f20ccf7bb53d02b6). It gets the dashboard, query_metadata and executes all the cards. Setup with a constant 8 users for 10mins. 
- Out of 10 users, 8 will be admins, 2 will be sandboxed users and rotate sign-in.

I did this a few times with each jar and saw consistent results.

Conclusion: I don't see much difference in CPU and memory usage on both master and 50. The # interations from k6 are quite the same too.

## 50: tracking vs no tracking

Viewing the dashboard makes:
- 6040 db calls in total with tracking
- 6012 db calls without tracking

### Postgres
no tracking (3bcd4a4b57a53b8a17ce82746d05f99baf65e495)
<img width=""1496"" alt=""Screenshot 2024-08-06 at 18 14 15 (2)"" src=""https://github.com/user-attachments/assets/0f121b0e-3c21-485b-9429-079ea09e1374"">


with tracking  (branch: [50-with-tracking](https://github.com/metabase/metabase/compare/release-x.50.x...50-with-tracking?expand=1))
<img width=""1496"" alt=""Screenshot 2024-08-06 at 18 02 59 (2)"" src=""https://github.com/user-attachments/assets/ce184a12-1f9a-4102-bdb1-9cff1265830f"">


### Mysql
no tracking (3bcd4a4b57a53b8a17ce82746d05f99baf65e495)

<img width=""1496"" alt=""Screenshot 2024-08-06 at 19 19 10 (2)"" src=""https://github.com/user-attachments/assets/06d5c0df-2775-4a34-b367-f1541a0214c1"">


with tracking (branch: [50-with-tracking](https://github.com/metabase/metabase/compare/release-x.50.x...50-with-tracking?expand=1))
<img width=""1496"" alt=""Screenshot 2024-08-06 at 19 08 05 (2)"" src=""https://github.com/user-attachments/assets/cf7aea9c-9c07-460b-a811-49c32071c07d"">


# API calls
| Scenario          | Endpoint                                          | Command                                                                                                    | Siege Result                                                                                           |
|-------------------|---------------------------------------------------|------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| **Admin - With Tracking** | `/api/dashboard/10`                                | `siege --concurrent=15 --time=60s --header=""Cookie: $ADMIN"" ""http://localhost:3000/api/dashboard/10""` | Transactions: 85 hits<br>Availability: 100.00 %<br>Elapsed time: 60.06 secs<br>Response time: 10.04 secs<br>Transaction rate: 1.42 trans/sec<br>Throughput: 1.97 MB/sec<br>Longest transaction: 18.76<br>Shortest transaction: 7.08 |
| **Admin - Without Tracking** | `/api/dashboard/10`                                | `siege --concurrent=15 --time=60s --header=""Cookie: $ADMIN"" ""http://localhost:3000/api/dashboard/10""| Transactions: 86 hits<br>Availability: 100.00 %<br>Elapsed time: 60.11 secs<br>Response time: 9.59 secs<br>Transaction rate: 1.43 trans/sec<br>Throughput: 1.99 MB/sec<br>Longest transaction: 12.68<br>Shortest transaction: 7.73 |
| **Admin - With Tracking** | `/api/dashboard/10/query_metadata`                  | `siege --concurrent=15 --time=60s --header=""Cookie: $ADMIN"" ""http://localhost:3000/api/dashboard/10/query_metadata""` | Transactions: 30 hits<br>Availability: 100.00 %<br>Elapsed time: 60.80 secs<br>Response time: 22.34 secs<br>Transaction rate: 0.49 trans/sec<br>Throughput: 0.26 MB/sec<br>Longest transaction: 25.01<br>Shortest transaction: 19.02 |
| **Admin - Without Tracking** | `/api/dashboard/10/query_metadata`                  | `siege --concurrent=15 --time=60s --header=""Cookie: $ADMIN"" ""http://localhost:3000/api/dashboard/10/query_metadata""` | Transactions: 30 hits<br>Availability: 100.00 %<br>Elapsed time: 60.25 secs<br>Response time: 21.98 secs<br>Transaction rate: 0.50 trans/sec<br>Throughput: 0.27 MB/sec<br>Longest transaction: 24.12<br>Shortest transaction: 18.69 |
| **Sandboxed - With Tracking** | `/api/dashboard/10`                                | `siege --concurrent=15 --time=60s --header=""Cookie: $SANDBOXED"" ""http://localhost:3000/api/dashboard/10""` | Transactions: 136 hits<br>Availability: 100.00 %<br>Elapsed time: 60.07 secs<br>Response time: 6.30 secs<br>Transaction rate: 2.26 trans/sec<br>Throughput: 1.32 MB/sec<br>Longest transaction: 8.03<br>Shortest transaction: 4.85 |
| **Sandboxed - Without Tracking** | `/api/dashboard/10`                                | `siege --concurrent=15 --time=60s --header=""Cookie: $SANDBOXED"" ""http://localhost:3000/api/dashboard/10""` | Transactions: 140 hits<br>Availability: 100.00 %<br>Elapsed time: 60.87 secs<br>Response time: 6.28 secs<br>Transaction rate: 2.30 trans/sec<br>Throughput: 1.34 MB/sec<br>Longest transaction: 8.06<br>Shortest transaction: 5.27 |
| **Sandboxed - With Tracking** | `/api/dashboard/10/query_metadata`                  | `siege --concurrent=15 --time=60s --header=""Cookie: $SANDBOXED"" ""http://localhost:3000/api/dashboard/10/query_metadata""` | Transactions: 46 hits<br>Availability: 100.00 %<br>Elapsed time: 61.00 secs<br>Response time: 18.73 secs<br>Transaction rate: 0.75 trans/sec<br>Throughput: 0.40 MB/sec<br>Longest transaction: 20.51<br>Shortest transaction: 12.48 |
| **Sandboxed - Without Tracking** | `/api/dashboard/10/query_metadata`                  | `siege --concurrent=15 --time=60s --header=""Cookie: $SANDBOXED"" ""http://localhost:3000/api/dashboard/10/query_metadata""` | Transactions: 37 hits<br>Availability: 100.00 %<br>Elapsed time: 60.96 secs<br>Response time: 19.98 secs<br>Transaction rate: 0.61 trans/sec<br>Throughput: 0.32 MB/sec<br>Longest transaction: 22.90<br>Shortest transaction: 12.86 |

",qnkhuat,2024-07-23 10:36:58+00:00,['qnkhuat'],2024-08-07 10:30:44+00:00,2024-08-07 10:30:44+00:00,https://github.com/metabase/metabase/pull/45975,"[('.Team/Workflows', 'aka BEC')]",[],
2424748706,pull_request,closed,,🍒 Backport: Quarantine dashboard-card-resizing flake,,nemanjaglumac,2024-07-23 09:44:41+00:00,['nemanjaglumac'],2024-07-23 09:46:28+00:00,2024-07-23 09:46:27+00:00,https://github.com/metabase/metabase/pull/45974,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2424736059,pull_request,closed,,Fix the (object detail) flake for repro 39477,"### What does this PR accomplish?
This PR fixes the E2E flake (repro for #39477).

The example of a previous failure:
https://github.com/metabase/metabase/actions/runs/10055141486/job/27792441862#step:11:471
![scenarios  question  object details -- shows correct object detail card for questions with joins after clicking on view details (metabase#39477) (failed) (attempt 2)](https://github.com/user-attachments/assets/9142621c-9ae1-43b0-83b6-c26ec1122a01)

### Explanation
It misclicked.
It was supposed to click on the third row, but it clicked on the fourth one instead.

I am not entirely sure what's the root cause, but we're using a more specific selector in this updated test version. It should make sure that we click on an object detail trigger for that specific row.

### Stress-test
50/50 ✅ https://github.com/metabase/metabase/actions/runs/10057774847",nemanjaglumac,2024-07-23 09:38:24+00:00,['nemanjaglumac'],2024-07-23 13:07:42+00:00,2024-07-23 12:37:22+00:00,https://github.com/metabase/metabase/pull/45973,"[('.CI & Tests', ''), ('backport', 'Automatically create PR on current release branch on merge'), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2424727785,pull_request,closed,,Quarantine dashboard-card-resizing flake,,nemanjaglumac,2024-07-23 09:34:36+00:00,['nemanjaglumac'],2024-10-08 16:20:02+00:00,2024-07-23 09:43:11+00:00,https://github.com/metabase/metabase/pull/45972,"[('Type:Tech Debt', 'or Refactoring'), ('.CI & Tests', '')]",[],
2424691942,pull_request,closed,,Track queries with inactive tables,"### Description

This change distinguishes between references to columns that are inactive within active tables, and those that reference tables that are themselves inactive.

This also flattens the errors so that it's a bit less of faff to group them.",crisptrutski,2024-07-23 09:17:47+00:00,['crisptrutski'],2024-10-08 16:20:00+00:00,2024-07-23 14:29:04+00:00,https://github.com/metabase/metabase/pull/45971,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2424594773,pull_request,closed,,Tweak failure map size and test,"### Description

Increase failure map size, and improve the test.

The map size had been set ridiculously slow to help with debugging, and I forgot to increase it again.

The test had toothless assertion - we needed to record a failure more times before it would block further retries.",crisptrutski,2024-07-23 08:31:30+00:00,['crisptrutski'],2024-10-08 16:20:02+00:00,2024-07-23 10:02:55+00:00,https://github.com/metabase/metabase/pull/45970,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2424589088,pull_request,closed,,"🤖 backported ""[cache] remove mentions of removed cache settings from docs""","  #45921
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-07-23 08:28:38+00:00,"['piranha', 'github-automation-metabase']",2024-07-23 11:26:45+00:00,2024-07-23 11:26:43+00:00,https://github.com/metabase/metabase/pull/45969,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2424540154,pull_request,closed,,Gracefully handle ignored errors during sync,"Closes https://github.com/metabase/metabase/issues/45948

### Description

When the `*log-exceptions-and-continue?*` option is set, each `sync-operation` will return any internal exceptions, rather than throwing them.

Unfortunately the `sync-database!` operation makes the assumption that each return value is a map, and so we will throw a type error in practice whenever any step has failed.

With this change, the higher level method will also swallow the errors.

I am not sure if this is the correct behavior, perhaps this will only serve to make flakes more subtle.",crisptrutski,2024-07-23 08:03:34+00:00,['crisptrutski'],2024-08-06 15:24:06+00:00,2024-08-06 15:24:05+00:00,https://github.com/metabase/metabase/pull/45968,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2245433227, 'issue_id': 2424540154, 'author': 'crisptrutski', 'body': ""Tracking task history as a tree is nice, but I'm not sure it's worth biting that off just to resolve this bug?\r\n\r\nI'd like to get this bug nipped as quick as possible, as we hit it often in CI.\r\n\r\nAs for testing, what kind of test do you think is relevant? We could trigger deterministic failure with some kind of `with-redefs`, but I'm not sure I see the value in that really, very superficial.\r\n\r\nUpdate: OK cool, yeah I guess fake driver is better than stubbing out a method."", 'created_at': datetime.datetime(2024, 7, 23, 14, 36, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2245511889, 'issue_id': 2424540154, 'author': 'qnkhuat', 'body': 'Cam has a test here https://github.com/metabase/metabase/issues/45948#issuecomment-2243784774', 'created_at': datetime.datetime(2024, 7, 23, 15, 7, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2255789211, 'issue_id': 2424540154, 'author': 'crisptrutski', 'body': ""OK great, now that I'm sure this is the right direction I can work on that test"", 'created_at': datetime.datetime(2024, 7, 29, 12, 23, 30, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-07-23 14:36:27 UTC): Tracking task history as a tree is nice, but I'm not sure it's worth biting that off just to resolve this bug?

I'd like to get this bug nipped as quick as possible, as we hit it often in CI.

As for testing, what kind of test do you think is relevant? We could trigger deterministic failure with some kind of `with-redefs`, but I'm not sure I see the value in that really, very superficial.

Update: OK cool, yeah I guess fake driver is better than stubbing out a method.

qnkhuat on (2024-07-23 15:07:26 UTC): Cam has a test here https://github.com/metabase/metabase/issues/45948#issuecomment-2243784774

crisptrutski (Issue Creator) on (2024-07-29 12:23:30 UTC): OK great, now that I'm sure this is the right direction I can work on that test

"
2424494756,pull_request,closed,,"🤖 backported ""we had unlimited xrays since 2018 and it is time to end this madness""",#45909,github-automation-metabase,2024-07-23 07:40:28+00:00,"['piranha', 'github-automation-metabase']",2024-07-23 12:05:39+00:00,2024-07-23 12:05:38+00:00,https://github.com/metabase/metabase/pull/45966,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2424334963,pull_request,closed,,"🤖 backported ""Add temporal bucketing to expression references""",#45492,github-automation-metabase,2024-07-23 06:07:58+00:00,"['lbrdnk', 'github-automation-metabase']",2024-07-23 06:57:50+00:00,2024-07-23 06:57:49+00:00,https://github.com/metabase/metabase/pull/45965,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2424334421,pull_request,closed,,"🤖 backported ""Move `parse-currency` to `util.jvm` ns""",#45939,github-automation-metabase,2024-07-23 06:07:32+00:00,"['lbrdnk', 'github-automation-metabase']",2024-07-23 07:26:23+00:00,2024-07-23 07:26:22+00:00,https://github.com/metabase/metabase/pull/45964,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2424262632,pull_request,closed,,Creating Tusk Sanity GitHub workflow,"This PR adds the Tusk Sanity GitHub workflow to the repo. This will allow Tusk to automatically lint, build, and test code - resulting in higher quality PRs.

This workflow will only be run when you trigger Tusk to work on an issue. If you have any questions, please contact [support@usetusk.ai](mailto:support@usetusk.ai).",use-tusk[bot],2024-07-23 05:02:30+00:00,[],2024-07-23 16:20:10+00:00,2024-07-23 16:20:10+00:00,https://github.com/metabase/metabase/pull/45963,[],[],
2424188348,pull_request,closed,,Add mu/defn- as private counterpart to mu/defn,"Found myself reaching for this but it didn't exist so I figured I would try to add it. Just adds a private version of `mu/defn` called `mu/defn-`, implemented pretty much the same way as `clojure.core/defn-`",noahmoss,2024-07-23 03:57:50+00:00,['noahmoss'],2024-10-08 16:19:56+00:00,2024-07-23 20:54:06+00:00,https://github.com/metabase/metabase/pull/45962,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2244203120, 'issue_id': 2424188348, 'author': 'noahmoss', 'body': '* **#45962** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/45962?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 7, 23, 3, 58, 8, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-07-23 03:58:08 UTC): * **#45962** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/45962?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> 👈
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2424096816,pull_request,closed,,Super fast pivot table QP,"Resolves #29348
Fixes #46029

Implementation of the Pivot QP that combines all constituent queries into a single `UNION ALL` query and runs it as a single query instead of running as many as several dozen queries sequentially. MASSIVE performance boost.

This was implemented by 

a) new logic to generate subqueries that return the results in the shape we want without requiring any post-processing
b) a new driver method `metabase.driver/EXPERIMENTAL-execute-multiple-queries`, currently implemented by `:sql-jdbc`, that combines multiple native queries into a single query with `UNION ALL` and runs it once.

For now the legacy implementation is still around so drivers that do not implement `metabase.driver/EXPERIMENTAL-execute-multiple-queries` (i.e., MongoDB) will still work. (See also #15008 -- I don't think they're currently enabled for MongoDB but we should easily be able to enable them).

The new driver method is `EXPERIMENTAL` because I see it as a hopefully temporary stepping stone rather than a long-term solution. In the long run, we should add native `:union-all` support to MBQL itself, so we can use it in more places than just the top-level of a query. This will also unlock using a pivot query as a source for another query, etc.

Another possibly even better option would be to native support for something like [`GROUPING SETS`](https://www.postgresql.org/docs/16/queries-table-expressions.html#QUERIES-GROUPING-SETS) or [`ROLLUP`](https://dba.stackexchange.com/questions/143397/using-group-by-with-rollup-on-column-that-contains-null) which would improve performance even more.

But that's harder to get right across multiple databases, so I didn't want to let the perfect be the enemy of the good here. This is still a huge performance boost for relatively little work.

(This PR mostly seems so big because I shuffled stuff around and added a ton of new tests. The actual important changes are relatively minor.)

The new implementation is way easier to understand than the old pivot QP impl which should make further improvements easier in the future. Between this PR and my PR #40141 from a few months ago the pivot QP code is 100x easier to understand now
",camsaul,2024-07-23 02:17:46+00:00,[],2025-01-23 22:02:06+00:00,2025-01-08 17:53:45+00:00,https://github.com/metabase/metabase/pull/45961,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2424095755,pull_request,closed,,[Notification] Update http details schema,"these keys are unused, remove them to avoid confusion.",qnkhuat,2024-07-23 02:16:42+00:00,['qnkhuat'],2024-07-29 11:31:29+00:00,2024-07-29 11:31:27+00:00,https://github.com/metabase/metabase/pull/45960,"[('.Team/Workflows', 'aka BEC')]",[],
2423998504,pull_request,closed,,Fix broken `details-only` check in viz ,"Follow up for https://github.com/metabase/metabase/pull/33828
Fixes https://github.com/metabase/metabase/issues/33844

The fix above was implemented incorrectly and only worked for new columns added to the query. For existing columns the `visibility_type` setting was broken. This PR fixes the issue (hopefully for good).",ranquild,2024-07-23 00:22:43+00:00,['ranquild'],2024-07-24 20:44:16+00:00,2024-07-24 13:32:45+00:00,https://github.com/metabase/metabase/pull/45959,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2244032392, 'issue_id': 2423998504, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 8724560f5247f27709361efc30374bf0cdabaf4c...300dbdd9753e092b74e4ab283f22cd71c2314f87.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/TableInteractive/TableInteractive.jsx<br>frontend/src/metabase/visualizations/lib/settings/column.js<br>frontend/src/metabase/visualizations/visualizations/ObjectDetail.jsx<br>frontend/src/metabase/visualizations/visualizations/Table.tsx |', 'created_at': datetime.datetime(2024, 7, 23, 0, 24, 11, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-07-23 00:24:11 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 8724560f5247f27709361efc30374bf0cdabaf4c...300dbdd9753e092b74e4ab283f22cd71c2314f87.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/TableInteractive/TableInteractive.jsx<br>frontend/src/metabase/visualizations/lib/settings/column.js<br>frontend/src/metabase/visualizations/visualizations/ObjectDetail.jsx<br>frontend/src/metabase/visualizations/visualizations/Table.tsx |

"
