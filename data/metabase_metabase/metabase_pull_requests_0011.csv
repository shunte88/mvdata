id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2510348547,pull_request,closed,,Fix admin override for public actions,"* Replaces `(binding [api/*current-user-permissions-set* (delay #{""/""})] ...)` with `(mw.session/as-admin ...)` so that perm checks are (correctly) skipped when executing public actions.
* Fixes a couple other instances of the above in tests for consistency, though I don't have evidence they were causing issues
* Ensures that that the `advanced-permissions` feature is enabled in public actions test so that it correctly catches this issue in CI

Resolves https://github.com/metabase/metabase/issues/47704",noahmoss,2024-09-06 12:42:34+00:00,['noahmoss'],2024-09-06 21:14:07+00:00,2024-09-06 21:14:05+00:00,https://github.com/metabase/metabase/pull/47717,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2333969650, 'issue_id': 2510348547, 'author': 'noahmoss', 'body': '* **#47717** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47717?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 9, 6, 12, 42, 52, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-09-06 12:42:52 UTC): * **#47717** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47717?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2510313839,pull_request,closed,,"ü§ñ backported ""perf: Optimize some query processor functions""",#47658,github-automation-metabase,2024-09-06 12:23:16+00:00,"['alexander-yakushev', 'github-automation-metabase']",2024-09-06 15:28:20+00:00,2024-09-06 15:28:19+00:00,https://github.com/metabase/metabase/pull/47716,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2510052300,pull_request,closed,,fix(sdk): default font not working,"
Fixes the font being the literal string `""var(....` if we don't pass a theme to the provider:

<img width=""317"" alt=""image"" src=""https://github.com/user-attachments/assets/6fe954ec-c979-4435-9bc5-183ee2f9f239"">

Part of https://github.com/metabase/metabase/issues/47624

PS: i'll like to add some test as this was a regression, but possibly when i'll finish with https://github.com/metabase/metabase/issues/47624 ",npretto,2024-09-06 09:59:21+00:00,['npretto'],2024-10-08 16:15:18+00:00,2024-09-06 15:40:33+00:00,https://github.com/metabase/metabase/pull/47712,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2333708409, 'issue_id': 2510052300, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@npretto You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 9, 6, 9, 59, 42, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-06 09:59:42 UTC): <!---conventional commit reminder comment ID-->
@npretto You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2510045736,pull_request,closed,,docs(sdk): Improvements to SDK readme,"* Move limitations to the top and update list
* Rename `fetchRequestToken` function
* Add link to live demo
* Update suggested MB version to latest stable  ",albertoperdomo,2024-09-06 09:56:07+00:00,['albertoperdomo'],2024-10-08 16:13:51+00:00,2024-10-02 16:36:51+00:00,https://github.com/metabase/metabase/pull/47711,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2333702655, 'issue_id': 2510045736, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@albertoperdomo You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 9, 6, 9, 56, 25, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-06 09:56:25 UTC): <!---conventional commit reminder comment ID-->
@albertoperdomo You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2509891273,pull_request,closed,,"ü§ñ backported ""Always allow localhost:* on CORS""",#47663,github-automation-metabase,2024-09-06 08:55:57+00:00,"['WiNloSt', 'github-automation-metabase']",2024-09-06 16:12:35+00:00,2024-09-06 16:12:34+00:00,https://github.com/metabase/metabase/pull/47710,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2509807964,pull_request,closed,,Fix missed spots still using dynamic user vars for search,"Missed two spots where we still used dynamic variables when constructing the searchable entities query. One of them was a blocker for building the search index for some of the models.

We still use dynamic variables for on the non-trivial indexed-entities search path, and in the rendering, but neither of those are blockers for me.",crisptrutski,2024-09-06 08:13:46+00:00,['crisptrutski'],2024-10-08 16:15:19+00:00,2024-09-06 10:16:58+00:00,https://github.com/metabase/metabase/pull/47709,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2333738839, 'issue_id': 2509807964, 'author': 'crisptrutski', 'body': '### Merge activity\n\n* **Sep 6, 6:16 AM EDT**: @crisptrutski started a stack merge that includes this pull request via [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/47709).\n* **Sep 6, 6:16 AM EDT**: @crisptrutski merged this pull request with [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/47709).', 'created_at': datetime.datetime(2024, 9, 6, 10, 16, 32, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-09-06 10:16:32 UTC): ### Merge activity

* **Sep 6, 6:16 AM EDT**: @crisptrutski started a stack merge that includes this pull request via [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/47709).
* **Sep 6, 6:16 AM EDT**: @crisptrutski merged this pull request with [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/47709).

"
2509701913,pull_request,closed,,clojure 1.12.0,,piranha,2024-09-06 07:15:49+00:00,['piranha'],2024-10-08 16:15:20+00:00,2024-09-06 08:40:33+00:00,https://github.com/metabase/metabase/pull/47708,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2333503239, 'issue_id': 2509701913, 'author': 'crisptrutski', 'body': 'HELL YEAH - been champing at the bit for some of these improvements ‚ù§Ô∏è', 'created_at': datetime.datetime(2024, 9, 6, 8, 16, 7, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-09-06 08:16:07 UTC): HELL YEAH - been champing at the bit for some of these improvements ‚ù§Ô∏è

"
2509545029,pull_request,closed,,[Notification] Notification and subscription,"Epic: https://github.com/metabase/metabase/issues/47438

This resolves the first 2 points of the milestone 1:
- It adds 2 tables: notification and notification_subscription
- Introduces a new event type: `:event/notification` and makes sure all published events will trigger `event/notification`. This then checks for subscribed notifications and sends them.
- introduce a new module: notification. However, the functionality is currently limited.

In short, this PR tries to make the bridge between system event <-> notification.

In the next PR, we will then work on the notification <-> channel part.",qnkhuat,2024-09-06 05:24:49+00:00,['qnkhuat'],2024-09-11 15:41:49+00:00,2024-09-11 15:41:46+00:00,https://github.com/metabase/metabase/pull/47707,"[('.Team/Workflows', 'aka BEC')]",[],
2509126885,pull_request,closed,,Split ChartType components into files,"This PR:
- Splits `ChartType` components into separate files
- Moves the logic of displaying chart types away from the sidebar component into its own component (for use within the SDK)
- Removes the dependence of ML elements from the inner components (i.e. `question`, `result`, `query`) so we can give more customization options to users in the future. For example, maybe they want to use a list of visualizations rather than the current grid of circles


I'll fix the tests tomorrow (PDT) but if y'all have feedback on the code I would appreciate it.",oisincoveney,2024-09-06 00:26:17+00:00,['oisincoveney'],2024-09-06 19:33:17+00:00,2024-09-06 19:33:17+00:00,https://github.com/metabase/metabase/pull/47706,"[('.Team/Embedding', '')]",[],
2508955797,pull_request,closed,,More question details in sidebar,"Closes https://github.com/metabase/metabase/issues/47673

### Description

Adds more detailed information to Question Info sidesheets:

![Screen Shot 2024-09-10 at 2 21 38 PM](https://github.com/user-attachments/assets/794af6e7-1258-4073-a432-8929a52580f7)


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-09-05 22:49:26+00:00,['iethree'],2024-09-12 20:36:19+00:00,2024-09-12 20:36:19+00:00,https://github.com/metabase/metabase/pull/47705,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2338772236, 'issue_id': 2508955797, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff e3c94e4a1b84ff0094f3c4a12752db2ccc0e55a7...384b2a697ce66ecf109220d81040f1724bd65fa3.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/globe.svg<br>frontend/src/metabase/ui/components/icons/Icon/icons/index.ts |', 'created_at': datetime.datetime(2024, 9, 9, 18, 7, 57, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-09 18:07:57 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff e3c94e4a1b84ff0094f3c4a12752db2ccc0e55a7...384b2a697ce66ecf109220d81040f1724bd65fa3.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/globe.svg<br>frontend/src/metabase/ui/components/icons/Icon/icons/index.ts |

"
2508687951,pull_request,closed,,docs - update api docs,Updates API docs.,jeff-bruemmer,2024-09-05 20:51:22+00:00,['jeff-bruemmer'],2024-10-08 16:15:22+00:00,2024-09-05 20:56:19+00:00,https://github.com/metabase/metabase/pull/47703,"[('Type:Documentation', ''), ('no-backport', 'Do not backport this PR to any branch')]",[],
2508667928,pull_request,closed,,Add docs url to the metric editor,"Epic https://github.com/metabase/metabase/issues/47147
Closes https://github.com/metabase/metabase/issues/47151

How to verify:
- New -> Metric
- There should be a link in the top right corner of the editor to the metric docs page

<img width=""1454"" alt=""Screenshot 2024-09-06 at 11 38 36"" src=""https://github.com/user-attachments/assets/e765b32f-e387-4e7b-ae15-1186d9b52dbc"">

",ranquild,2024-09-05 20:37:31+00:00,['ranquild'],2024-09-06 17:49:03+00:00,2024-09-06 17:49:01+00:00,https://github.com/metabase/metabase/pull/47702,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2508623383,pull_request,closed,,show additional columns in the tooltip,"[Product doc](https://www.notion.so/metabase/Migrate-tooltips-to-ECharts-for-more-predictable-behavior-364f2c71f3b248f1b839960af037279c?pvs=4#7ca169aadbd94b6da20966bba46b6658)

### Description

Adds the ability to display additional columns from dataset in the tooltip. Applies to line/area/bar/combo charts.

### How to verify

1) New -> Orders: Count, Avg of Total, Avg of Subtotal group by Created At: month -> line/area/bar/combo display
2) Ensure tooltip shows only series data
3) Remove all but Count series, enable all other columns to be shown in the tooltip
4) Ensure tooltip shows other columns in the tooltip
5) Add a breakout Product -> Category
6) Ensure tooltip shows additional columns right below the hovered series 

### Demo

<img width=""851"" alt=""Screenshot 2024-09-05 at 4 04 46‚ÄØPM"" src=""https://github.com/user-attachments/assets/18a4af45-7209-4a5a-8d33-3d69e910aa66"">

<video src=""https://github.com/user-attachments/assets/bf329fec-5dad-4347-a94b-4b664079ff19"" />

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",alxnddr,2024-09-05 20:08:11+00:00,['alxnddr'],2024-10-08 16:15:04+00:00,2024-09-09 21:59:40+00:00,https://github.com/metabase/metabase/pull/47700,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2332545876, 'issue_id': 2508623383, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff f0ac75a392b34bbbdca8bdb6aefe5c25e12b1fb4...ef3955a52d32b7b5f16ab025d05b97752a5a986e.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/inputs/MultiAutocomplete/MultiAutocomplete.tsx |', 'created_at': datetime.datetime(2024, 9, 5, 20, 9, 31, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-05 20:09:31 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff f0ac75a392b34bbbdca8bdb6aefe5c25e12b1fb4...ef3955a52d32b7b5f16ab025d05b97752a5a986e.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/inputs/MultiAutocomplete/MultiAutocomplete.tsx |

"
2508575260,pull_request,closed,,Question Settings Sidesheet,"Closes #47133

### Description

Adds question/metric/model settings sidebar which contains
- Model persistence settings
- Question caching settings
- Metric caching settings

and removes model persistence toggle from the question overflow menu

![Screen Shot 2024-09-06 at 3 10 10 PM](https://github.com/user-attachments/assets/843acc6d-e4b6-492d-b6e9-6cd135a142ad)
![Screen Shot 2024-09-06 at 3 09 05 PM](https://github.com/user-attachments/assets/ce9744e5-c5c4-4cc4-88a2-ef982f871868)
![Screen Shot 2024-09-06 at 3 08 51 PM](https://github.com/user-attachments/assets/f71b4d63-0909-497c-bed1-8ee1d39a5191)




![Screen Shot 2024-09-05 at 1 36 31 PM](https://github.com/user-attachments/assets/8dc1eb55-3956-4f60-ab0d-504640308a13)




### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-09-05 19:36:43+00:00,['iethree'],2024-09-06 21:57:15+00:00,2024-09-06 21:57:12+00:00,https://github.com/metabase/metabase/pull/47699,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2332497593, 'issue_id': 2508575260, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 3b634c20f8149188ac335fe93f37e88b05c721fd...d4f0c0b8e5cb13cc12dcb2fe896d845bad9f345a.\n\n| Notify | File(s) |\n|-|-|\n| @ranquild | frontend/src/metabase/home/components/HomePage/HomePage.tsx |', 'created_at': datetime.datetime(2024, 9, 5, 19, 38, 12, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-05 19:38:12 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 3b634c20f8149188ac335fe93f37e88b05c721fd...d4f0c0b8e5cb13cc12dcb2fe896d845bad9f345a.

| Notify | File(s) |
|-|-|
| @ranquild | frontend/src/metabase/home/components/HomePage/HomePage.tsx |

"
2508550370,pull_request,closed,,"Remove confusing ""can"" from static-embedding.md page","> [!IMPORTANT]
> For those employed by Metabase: if you are merging into master, please add either a `backport` or a `no-backport` label to this PR. You will not be able to merge until you do this step. Refer to the section [Do I need to backport this PR?](https://www.notion.so/metabase/Metabase-Branching-Strategy-6eb577d5f61142aa960a626d6bbdfeb3?pvs=4#89f80d6f17714a0198aeb66c0efd1b71) in the Metabase Branching Strategy document for more details. If you're not employed by Metabase, this section does not apply to you, and the label will be taken care of by your reviewer.

> **Warning**
>
> If that is your first contribution to Metabase, please sign the [Contributor License Agreement](https://docs.google.com/a/metabase.com/forms/d/1oV38o7b9ONFSwuzwmERRMi9SYrhYeOrkbmNaq9pOJ_E/viewform) (unless it's a tiny documentation change). Also, if you're attempting to fix a translation issue, please submit your changes to our [POEditor project](https://poeditor.com/join/project/ynjQmwSsGh) instead of opening a PR.

Closes https://github.com/metabase/metabase/issues/[issue_number]

(Small typo fix - I discarded the above)

### Description

This sentence was previously confusing with ""can can't"". I'm still learning about Metabase, but I'm pretty sure we just want ""can't""

### How to verify

(I'm hoping the docs sping up a preview site to view. I'm new to Metabase contributing and changing the docs)



### Checklist

- [N/A] Tests have been added/updated to cover changes in this PR
",zachazar,2024-09-05 19:21:07+00:00,[],2025-01-21 18:25:55+00:00,2025-01-21 18:25:50+00:00,https://github.com/metabase/metabase/pull/47698,"[('Stale', 'Stale PRs that will be auto-closed')]","[{'comment_id': 2603449781, 'issue_id': 2508550370, 'author': 'github-actions[bot]', 'body': 'This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.', 'created_at': datetime.datetime(2025, 1, 21, 1, 31, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2605453461, 'issue_id': 2508550370, 'author': 'zachazar', 'body': 'Closing. Fixed in https://github.com/metabase/metabase/pull/52036', 'created_at': datetime.datetime(2025, 1, 21, 18, 25, 50, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-01-21 01:31:08 UTC): This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.

zachazar (Issue Creator) on (2025-01-21 18:25:50 UTC): Closing. Fixed in https://github.com/metabase/metabase/pull/52036

"
2508528029,pull_request,closed,,Fix startup loading page only working on the root URL,"> [!IMPORTANT]
> For those employed by Metabase: if you are merging into master, please add either a `backport` or a `no-backport` label to this PR. You will not be able to merge until you do this step. Refer to the section [Do I need to backport this PR?](https://www.notion.so/metabase/Metabase-Branching-Strategy-6eb577d5f61142aa960a626d6bbdfeb3?pvs=4#89f80d6f17714a0198aeb66c0efd1b71) in the Metabase Branching Strategy document for more details. If you're not employed by Metabase, this section does not apply to you, and the label will be taken care of by your reviewer.

> **Warning**
>
> If that is your first contribution to Metabase, please sign the [Contributor License Agreement](https://docs.google.com/a/metabase.com/forms/d/1oV38o7b9ONFSwuzwmERRMi9SYrhYeOrkbmNaq9pOJ_E/viewform) (unless it's a tiny documentation change). Also, if you're attempting to fix a translation issue, please submit your changes to our [POEditor project](https://poeditor.com/join/project/ynjQmwSsGh) instead of opening a PR.

### Description

Fix the startup loading page being broken on non-root URLs (e.g. `/admin/settings/setup`).

### How to verify

1. Restart your Metabase server
2. While it is starting up, go to a page to see the loading animation. Go to e.g. `/admin/settings/setup` instead of `/`.
3. The loading animation page should work on any page.

### Demo

Note: I have NOT built and tested this, but I believe the fix should be this simple.

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",stefansundin,2024-09-05 19:07:24+00:00,[],2024-12-19 20:30:19+00:00,2024-12-19 20:30:19+00:00,https://github.com/metabase/metabase/pull/47697,[],[],
2508514041,pull_request,closed,,"ü§ñ backported ""Catch Errors in Download process and only write error message""",#47482,github-automation-metabase,2024-09-05 18:58:42+00:00,"['adam-james-v', 'github-automation-metabase']",2024-09-05 21:22:34+00:00,2024-09-05 21:22:33+00:00,https://github.com/metabase/metabase/pull/47696,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2508452884,pull_request,closed,,"ü§ñ backported ""Revert multiple inheritance with SnowflakeVariant""",#47680,github-automation-metabase,2024-09-05 18:22:18+00:00,"['ranquild', 'github-automation-metabase']",2024-09-06 16:25:33+00:00,2024-09-06 16:25:32+00:00,https://github.com/metabase/metabase/pull/47695,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2508408366,pull_request,closed,,"ü§ñ backported ""Support field remapping in pivot queries""","  #47592
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-05 17:56:51+00:00,"['metamben', 'github-automation-metabase']",2024-09-06 14:16:43+00:00,2024-09-06 14:16:40+00:00,https://github.com/metabase/metabase/pull/47693,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2508361131,pull_request,closed,,"Recalculate ""graph.metrics"" and ""graph.dimensions"" if empty","Fixes #36027

Updates the `isValid` check for `graph.dimensions` and `graph.metrics` viz settings to return false if their current value is empty, but there're available columns returned by `getDefaultDimensions` and `getDefaultMetrics`. As a result, we should end up with fewer situations when Metabase doesn't render a chart at all even though all the data is available

**To verify** repeat repro steps from #36027",kulyk,2024-09-05 17:29:40+00:00,['kulyk'],2024-09-09 10:43:31+00:00,2024-09-09 10:43:29+00:00,https://github.com/metabase/metabase/pull/47692,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2332280040, 'issue_id': 2508361131, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 5cc1dbfe2c77176128d03c444967e83fb04778c8...921de086d44f3e1f652beef06dca1126b9373941.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/lib/settings/graph.js |', 'created_at': datetime.datetime(2024, 9, 5, 17, 31, 10, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-05 17:31:10 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 5cc1dbfe2c77176128d03c444967e83fb04778c8...921de086d44f3e1f652beef06dca1126b9373941.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/lib/settings/graph.js |

"
2508355738,pull_request,closed,,"ü§ñ backported ""perf: Miscellaneous card rendering improvements""",#47679,github-automation-metabase,2024-09-05 17:26:38+00:00,"['alexander-yakushev', 'github-automation-metabase']",2024-09-05 18:48:59+00:00,2024-09-05 18:48:58+00:00,https://github.com/metabase/metabase/pull/47691,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2508252042,pull_request,closed,,Open aggregation popover automatically for metrics,"Epic https://github.com/metabase/metabase/issues/47147
Closes https://github.com/metabase/metabase/issues/47150
Depends on https://github.com/metabase/metabase/pull/47368

How to verify:
- New -> Metric -> Orders
- See ""Count"" being auto-added with the popover auto-opened. 

<img width=""1391"" alt=""Screenshot 2024-09-05 at 12 29 35"" src=""https://github.com/user-attachments/assets/aa558396-1e4e-4796-82d4-171803211d63"">

",ranquild,2024-09-05 16:29:30+00:00,['ranquild'],2024-09-05 19:52:31+00:00,2024-09-05 19:52:29+00:00,https://github.com/metabase/metabase/pull/47689,"[('.Team/Querying', '')]",[],
2508229465,pull_request,closed,,Simplify backend Snowplow API in preparation for migrating stats ping to Snowplow,"The current API for tracking an event with Snowplow looks like this:

```
(snowplow/track-event! ::snowplow/event-keyword user-id payload) 
```

This has a few problems:
* It assumes that every schema includes multiple events, disambiguated with an `event` keyword. This is not the case for https://github.com/metabase/metabase/issues/40868
* It requires manually maintaining an `event->schema` map to determine the schema which should be used for a given event
* It requires the caller to always explicitly pass in `user-id` when 99% of the time it is using `api/*current-user-id*`

I've reworked the API to look like this:
```
(snowplow/track-event! ::snowplow/schema-keyword payload)
```

* `payload` can include `:event :event-keyword` but it's not required. This treats `:event` as a normal value in the payload instead of a special required property (since we're moving away from it)
* `user-id` can be optionally passed in as the third argument; otherwise it will default to `api/*current-user-id*`
* This gets rid of the `event->schema` map since the schema is always passed in explicitly

I've also adjusted the tracker to be initialized on startup rather than being wrapped in a delay and initialized on demand. In practice it initializes very quickly and I was running into some weird test failures when running in the REPL, so I think this is worth it for the sake of simplicity.

Backporting this PR since it doesn't change behavior at all, so it seems worth having it in 50 to avoid some future backport conflicts.",noahmoss,2024-09-05 16:18:27+00:00,['noahmoss'],2024-10-01 22:15:54+00:00,2024-09-06 20:49:21+00:00,https://github.com/metabase/metabase/pull/47687,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2332151369, 'issue_id': 2508229465, 'author': 'noahmoss', 'body': '* **#47687** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47687?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 9, 5, 16, 18, 41, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-09-05 16:18:41 UTC): * **#47687** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47687?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2508196110,pull_request,closed,,Introduce `enable-embedding-sdk` toggle,"Closes https://github.com/metabase/metabase/issues/47682

### Description

Introduce the toggle to enable/disable embedding SDK.

The toggle is added to 2 places:
1. Embedding SDK card
2. Embedding SDK settings page

You don't need to care much about the BE change since it will be replaced by an actual implementation from milestone 0 eventually anyway.

### How to verify


### Demo

![image](https://github.com/user-attachments/assets/fb57ecc3-6e1e-4375-b9c9-232922ed71b6)

![image](https://github.com/user-attachments/assets/f6b44089-ef75-4c62-8ebe-286956d3e998)


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",WiNloSt,2024-09-05 16:03:50+00:00,['WiNloSt'],2024-09-10 04:40:28+00:00,2024-09-09 13:35:23+00:00,https://github.com/metabase/metabase/pull/47686,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2332122422, 'issue_id': 2508196110, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 60405632abd42066bbca104924dad730a5f92ca7...dc5d95cd893b11173e774b915b85c6a7b73f991d.\n\nNo notifications.', 'created_at': datetime.datetime(2024, 9, 5, 16, 5, 20, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-05 16:05:20 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 60405632abd42066bbca104924dad730a5f92ca7...dc5d95cd893b11173e774b915b85c6a7b73f991d.

No notifications.

"
2508154177,pull_request,closed,,Show Scalar metric value on Browse metrics page,"Closes https://github.com/metabase/metabase/issues/47796

### Description

Render the latest value of a scalar metric on the browse metrics page.


1. Make sure you have at least one scalar metric (ie. a metric that renders as a single value)
2. Click `Metrics` in the sidebar
3. Make sure the value rendered in the metrics table is the correct value

### Demo

<img width=""1474"" alt=""Screenshot 2024-09-10 at 13 48 40"" src=""https://github.com/user-attachments/assets/cec24cdf-f64a-4721-a499-27cab745c156"">",romeovs,2024-09-05 15:45:47+00:00,['romeovs'],2024-09-10 16:47:40+00:00,2024-09-10 16:47:39+00:00,https://github.com/metabase/metabase/pull/47685,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2508145921,pull_request,closed,,Bump Hawk version to latest and enable partitioning with size = 1,This is experimental to see which tests of ours break when Hawk's partitioning code changes the order tests are run in,camsaul,2024-09-05 15:41:47+00:00,['camsaul'],2024-09-06 00:16:30+00:00,2024-09-06 00:16:28+00:00,https://github.com/metabase/metabase/pull/47684,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]",[],
2508109691,pull_request,closed,,Bump Hawk version to latest,,camsaul,2024-09-05 15:25:12+00:00,['camsaul'],2024-09-06 00:16:16+00:00,2024-09-06 00:16:14+00:00,https://github.com/metabase/metabase/pull/47683,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]",[],
2508089422,pull_request,closed,,üèéÔ∏èüöÄüèéÔ∏èüöÄ üèéÔ∏èüöÄ SHAVE 7 MINUTES OFF OF NON-CORE DRIVER TEST RUNS IN CI üèéÔ∏èüöÄüèéÔ∏èüöÄ üèéÔ∏èüöÄ,"1. ~~Split up our the slowest CI jobs (MySQL and MariaDB) into two separate jobs (one to run the first half of the tests and one to run the second half of the tests) using the new test partitioning features I added to Hawk in https://github.com/metabase/hawk/pull/28 and https://github.com/metabase/hawk/pull/31~~ Split into PR https://github.com/metabase/metabase/pull/48422
2. Add Kondo linter to require that all namespaces that use `test-driver` or `test-drivers` are marked `^:mb/driver-tests`; for non-core drivers (ones other than MySQL/Postgres/H2) only run tests in these namespaces using the new `:only-tags` feature I added to Hawk in https://github.com/metabase/hawk/pull/32 (see Slack thread https://metaboat.slack.com/archives/CKZEMT1MJ/p1726079799434709 for more details) -- this shaves off 7-8 minutes for non-core-driver tests
3. Add Kondo linter to ensure that we don't use `:mb/once` in namespaces that use `test-driver` or `test-drivers` and fix broken tests
4. Fix a lot of broken tests that fail if we only run half of the test suite

Once this lands I'll probably do a follow-on to split Postgres and H2 into two jobs as well so they're not the new bottlenecks",camsaul,2024-09-05 15:16:57+00:00,['camsaul'],2024-10-08 16:13:21+00:00,2024-10-08 04:32:13+00:00,https://github.com/metabase/metabase/pull/47681,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]",[],
2508011808,pull_request,closed,,Revert multiple inheritance with SnowflakeVariant,"Fixes https://github.com/metabase/metabase/issues/47639
Revert type hierarchy changes in https://github.com/metabase/metabase/pull/45674

The original PR aimed to solve expression type checking issue with Snowflake's `VARIANT`. It allowed executing existing queries but broke the notebook editor. This PR relies on the fact that we don't have expression type checking anymore; we need to derive the `:type/SnowflakeVariant` directly from `:type/*` to make the FE allow only `is-null` and `not-null` operators by default.

The expression editor doesn't check argument types and will allow anything atm.",ranquild,2024-09-05 14:44:44+00:00,['ranquild'],2024-09-05 18:21:31+00:00,2024-09-05 18:21:29+00:00,https://github.com/metabase/metabase/pull/47680,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2507990274,pull_request,closed,,perf: Miscellaneous card rendering improvements,"1. Convert SQL rows to vectors using a more efficient custom `juxt` implementation.
2. Once more, clojure.java-time conversions bring a lot of overhead, use direct interop in the hot place I've identified.
",alexander-yakushev,2024-09-05 14:36:47+00:00,['alexander-yakushev'],2024-10-01 22:17:41+00:00,2024-09-05 17:25:49+00:00,https://github.com/metabase/metabase/pull/47679,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2507969316,pull_request,closed,,"ü§ñ backported ""[insights] Simplify args to simple-linear-regresion""",#47665,github-automation-metabase,2024-09-05 14:28:57+00:00,"['alexander-yakushev', 'github-automation-metabase']",2024-09-05 15:24:16+00:00,2024-09-05 15:24:15+00:00,https://github.com/metabase/metabase/pull/47678,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2507963211,pull_request,closed,,Fix Transparent disabled state on mantine switch label,"
### Description

Before 

![Screen Shot 2024-09-05 at 8 25 57 AM](https://github.com/user-attachments/assets/e3c7e02a-67fb-4d2e-a890-ae1850983eed)

After

![Screen Shot 2024-09-05 at 8 24 54 AM](https://github.com/user-attachments/assets/3f13dd00-c3c8-4549-b883-83c1fd814eb3)

",iethree,2024-09-05 14:26:41+00:00,['iethree'],2024-10-01 22:16:20+00:00,2024-09-06 13:12:08+00:00,https://github.com/metabase/metabase/pull/47677,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2331835496, 'issue_id': 2507963211, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 2af9fff059e33564fe0a849271e2511be3eded54...517681ece70d24f59b3418ca9e8e5d38759041f1.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/inputs/Switch/Switch.styled.tsx |', 'created_at': datetime.datetime(2024, 9, 5, 14, 28, 5, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-05 14:28:05 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 2af9fff059e33564fe0a849271e2511be3eded54...517681ece70d24f59b3418ca9e8e5d38759041f1.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/inputs/Switch/Switch.styled.tsx |

"
2507929290,pull_request,closed,,[serdes] option to dump full stacktraces on errors,"basically what subject says, in process of debugging #47660 and #47520",piranha,2024-09-05 14:14:22+00:00,['piranha'],2024-10-01 22:16:08+00:00,2024-09-06 13:25:39+00:00,https://github.com/metabase/metabase/pull/47676,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2507894416,pull_request,closed,,feat(dashboards): Add info sidesheet,"_in design review_

Adds new info sidesheet to dashboard

Figma:
![image.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/utGnP2ljFMMNOgi82vVn/b38e6c33-0226-4779-8b60-87865d3af056.png)

This branch:
![image](https://github.com/user-attachments/assets/da7ac5e1-f9bf-4dd4-b2cc-e3d94a7131c8)

These items shown in the Figma are not added in this PR:
* Status
* Creator
* Visibility
* Entity IDs for specific dashboard tabs
* The third ""insights"" tab at the top

Closes #47130

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR",rafpaf,2024-09-05 14:00:18+00:00,['rafpaf'],2025-02-04 17:34:20+00:00,2024-09-12 21:02:42+00:00,https://github.com/metabase/metabase/pull/47672,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2331764374, 'issue_id': 2507894416, 'author': 'rafpaf', 'body': '* **#47871** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47871?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#47256** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47256?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#47672** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47672?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* **#47100** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47100?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 9, 5, 14, 0, 35, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-09-05 14:00:35 UTC): * **#47871** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47871?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#47256** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47256?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#47672** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47672?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* **#47100** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47100?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2507878252,pull_request,closed,,"ü§ñ backported ""docs - embedding params edits""",#47635,github-automation-metabase,2024-09-05 13:53:46+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-09-05 13:55:18+00:00,2024-09-05 13:55:17+00:00,https://github.com/metabase/metabase/pull/47671,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2507762354,pull_request,closed,,"ü§ñ backported ""newsletter-toggle-clicked event""",#47410,github-automation-metabase,2024-09-05 13:07:17+00:00,"['npretto', 'github-automation-metabase']",2024-09-05 13:57:01+00:00,2024-09-05 13:57:00+00:00,https://github.com/metabase/metabase/pull/47669,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2331640238, 'issue_id': 2507762354, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 1546f0093b15922ebf5f7c020286a55b6e778e0f...4ce8208b8decc9ed4f19913c12549174f353e2e4.\n\n| Notify | File(s) |\n|-|-|\n| @ranquild | frontend/src/metabase/setup/components/CompletedStep/CompletedStep.tsx |', 'created_at': datetime.datetime(2024, 9, 5, 13, 8, 42, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-05 13:08:42 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 1546f0093b15922ebf5f7c020286a55b6e778e0f...4ce8208b8decc9ed4f19913c12549174f353e2e4.

| Notify | File(s) |
|-|-|
| @ranquild | frontend/src/metabase/setup/components/CompletedStep/CompletedStep.tsx |

"
2507760950,pull_request,closed,,"ü§ñ backported ""Fix query type and respect user parameters in search""","  #47631
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-05 13:06:38+00:00,"['crisptrutski', 'github-automation-metabase']",2024-09-06 09:28:39+00:00,2024-09-06 09:28:39+00:00,https://github.com/metabase/metabase/pull/47668,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2333648322, 'issue_id': 2507760950, 'author': 'crisptrutski', 'body': ""We don't need it, and the conflict is rather messy."", 'created_at': datetime.datetime(2024, 9, 6, 9, 28, 39, tzinfo=datetime.timezone.utc)}]","crisptrutski (Assginee) on (2024-09-06 09:28:39 UTC): We don't need it, and the conflict is rather messy.

"
2507737503,pull_request,closed,,"ü§ñ backported ""Dashboard subscriptions and alerts should exclude archived cards""","  #47650
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-05 12:56:26+00:00,"['qnkhuat', 'github-automation-metabase']",2024-09-05 14:00:35+00:00,2024-09-05 14:00:34+00:00,https://github.com/metabase/metabase/pull/47667,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2507703544,pull_request,closed,,"ü§ñ backported ""Revert ""Hide upload config when data warehouse is attached""""","  #47611
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-05 12:46:03+00:00,"['devurandom', 'github-automation-metabase']",2024-09-06 10:33:40+00:00,2024-09-06 10:33:38+00:00,https://github.com/metabase/metabase/pull/47666,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2507583703,pull_request,closed,,[insights] Simplify args to simple-linear-regresion,As was discussed in #47651.,alexander-yakushev,2024-09-05 12:00:41+00:00,['alexander-yakushev'],2024-10-01 22:17:54+00:00,2024-09-05 14:28:08+00:00,https://github.com/metabase/metabase/pull/47665,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2507581165,pull_request,closed,,"ü§ñ backported ""[serdes] improve dir detection""",#47653,github-automation-metabase,2024-09-05 11:59:23+00:00,"['piranha', 'github-automation-metabase']",2024-09-05 12:57:11+00:00,2024-09-05 12:57:10+00:00,https://github.com/metabase/metabase/pull/47664,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2507438934,pull_request,closed,,Always allow localhost:* on CORS,"Closes https://github.com/metabase/metabase/issues/47615

### Description

This is a temporary measure until the https://github.com/metabase/metabase/issues/46970 is shipped.

This is needed because we're shipping the CLI, and users can't test the SDK without having a license currently.

### How to verify

1. Run Metabase OSS and enable embedding
2. Run a dev server with a different port
3. open devtool and run
    ```ts
    fetch('http://localhost:3000/api/session/properties')
    ```
4. Observe the network tab, and the request should go through.

### Demo
1. Running OSS
![Screenshot 2024-09-05 at 6 02 56‚ÄØPM](https://github.com/user-attachments/assets/284a62b2-8241-40f0-ba14-423f93225008)
2. Fetch request is successful with `Access-Control-Allow-Origin` header in the response.
![Screenshot 2024-09-05 at 6 03 18‚ÄØPM](https://github.com/user-attachments/assets/9b2163bb-cdb1-4ac0-b42f-5749cdc852f7)


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",WiNloSt,2024-09-05 10:49:00+00:00,['WiNloSt'],2024-09-06 09:17:44+00:00,2024-09-06 08:55:08+00:00,https://github.com/metabase/metabase/pull/47663,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Embedding', '')]","[{'comment_id': 2333568275, 'issue_id': 2507438934, 'author': 'qnkhuat', 'body': ""Is it for dev/tetsting purposes? if so I'll feel more comfortable if we guard it with a `(or config/is-dev? config/is-test?)` condition"", 'created_at': datetime.datetime(2024, 9, 6, 8, 52, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2333573380, 'issue_id': 2507438934, 'author': 'WiNloSt', 'body': ""> Is it for dev/tetsting purposes? if so I'll feel more comfortable if we guard it with a `(or config/is-dev? config/is-test?)` condition\r\n\r\nFor customers using the SDK. We have a CLI for customers to play around with the SDK, and it will run Metabase's Docker image `metabase/metabase-enterprise:latest`\r\n\r\nwould it be possible to run Docker in dev mode?"", 'created_at': datetime.datetime(2024, 9, 6, 8, 55, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2333578697, 'issue_id': 2507438934, 'author': 'WiNloSt', 'body': '@qnkhuat Please note that this feature will be delivered regardless in https://github.com/metabase/metabase/issues/46970. You can check that epic and product doc for more details. Feels free to add comments on the product doc too.', 'created_at': datetime.datetime(2024, 9, 6, 8, 58, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2333621847, 'issue_id': 2507438934, 'author': 'qnkhuat', 'body': ""> would it be possible to run Docker in dev mode?\r\nIt's possible, but we should not recommend people doing that bc dev mode can mean a lot of things :D.\r\n\r\nUpon reading the epic and product doc I think using the feature flag makes sense. But I do wonder if we want to give customers a way to turn this off? like with an env or something."", 'created_at': datetime.datetime(2024, 9, 6, 9, 14, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2333623695, 'issue_id': 2507438934, 'author': 'WiNloSt', 'body': ""> > would it be possible to run Docker in dev mode?\r\n> > It's possible, but we should not recommend people doing that bc dev mode can mean a lot of things :D.\r\n> \r\n> Upon reading the epic and product doc I think using the feature flag makes sense. But I do wonder if we want to give customers a way to turn this off? like with an env or something.\r\n\r\nNope, we don't allow turning off `localhost:*` for consistency. If you have any concern please write in the product doc, so we could discuss more üôè"", 'created_at': datetime.datetime(2024, 9, 6, 9, 15, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2333625067, 'issue_id': 2507438934, 'author': 'qnkhuat', 'body': ""then it's all good to me. Thanks and sorry for the noise :)"", 'created_at': datetime.datetime(2024, 9, 6, 9, 16, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2333627897, 'issue_id': 2507438934, 'author': 'WiNloSt', 'body': ""No worries, that's a legit concern. Thanks for bringing it up üí™"", 'created_at': datetime.datetime(2024, 9, 6, 9, 17, 42, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-09-06 08:52:54 UTC): Is it for dev/tetsting purposes? if so I'll feel more comfortable if we guard it with a `(or config/is-dev? config/is-test?)` condition

WiNloSt (Issue Creator) on (2024-09-06 08:55:40 UTC): For customers using the SDK. We have a CLI for customers to play around with the SDK, and it will run Metabase's Docker image `metabase/metabase-enterprise:latest`

would it be possible to run Docker in dev mode?

WiNloSt (Issue Creator) on (2024-09-06 08:58:20 UTC): @qnkhuat Please note that this feature will be delivered regardless in https://github.com/metabase/metabase/issues/46970. You can check that epic and product doc for more details. Feels free to add comments on the product doc too.

qnkhuat on (2024-09-06 09:14:18 UTC): It's possible, but we should not recommend people doing that bc dev mode can mean a lot of things :D.

Upon reading the epic and product doc I think using the feature flag makes sense. But I do wonder if we want to give customers a way to turn this off? like with an env or something.

WiNloSt (Issue Creator) on (2024-09-06 09:15:22 UTC): Nope, we don't allow turning off `localhost:*` for consistency. If you have any concern please write in the product doc, so we could discuss more üôè

qnkhuat on (2024-09-06 09:16:07 UTC): then it's all good to me. Thanks and sorry for the noise :)

WiNloSt (Issue Creator) on (2024-09-06 09:17:42 UTC): No worries, that's a legit concern. Thanks for bringing it up üí™

"
2507316936,pull_request,closed,,"ü§ñ backported ""perf: Add more timeseries insights optimizations""",#47651,github-automation-metabase,2024-09-05 09:51:26+00:00,"['alexander-yakushev', 'github-automation-metabase']",2024-09-05 12:16:32+00:00,2024-09-05 12:16:31+00:00,https://github.com/metabase/metabase/pull/47662,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2507211034,pull_request,closed,,"fix(sdk): fix typescript type references to ""embedding-sdk"" not resolving","Closes https://github.com/metabase/metabase/issues/47627

### Description

Fixes the fixup script so it now replaces both top-level imports e.g. `import whatever from ""embedding-sdk""` and imports with slash, e.g. `import whatever from ""embedding-sdk/foo/bar""`

### How to verify

- `yarn build-embedding-sdk`
   - This actually runs `yarn embedding-sdk:fixup-types-imports` under the hood
- Go to `resources/embedding-sdk/dist/enterprise/frontend/src/embedding-sdk`
   - Open full text search in your IDE of choice
   - Search for `from ""embedding-sdk""` - you should notice they are all prefixed by `from ""@metabase/embedding-sdk-react/dist/...`
- Now go to your React project, and run this command `rm -rf node_modules/@metabase && yarn add file:../metabase/resources/embedding-sdk && rm -rf node_modules/.vite`
- Look at the types for `CreateQuestion` and `InteractiveQuestion`, they should resolve fine now.
   - Notice that there is no more reference to ""embedding-sdk"" there

### Demo

Before

![image](https://github.com/user-attachments/assets/fe7f418a-cfce-47fe-a58b-59c9a2434261)

After

![CleanShot 2567-09-05 at 16 07 42@2x](https://github.com/user-attachments/assets/0cc142ee-9dfc-41c2-bdab-e4a6f84366e7)",heypoom,2024-09-05 09:05:12+00:00,['heypoom'],2024-09-05 16:48:48+00:00,2024-09-05 16:48:47+00:00,https://github.com/metabase/metabase/pull/47659,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2507183614,pull_request,closed,,perf: Optimize some query processor functions,"1. Making `mapv` faster and more memory-efficient for small (<32 elements) vectors improves response times for all kinds of queries.
2. In `result-int->string` which is called for each returned row that has at least one FK, instead of doing `update` on a vector, rebuild the entire vector with `mapv`. Use a boolean mask to know which column is FK and has to be stringified.",alexander-yakushev,2024-09-05 08:52:56+00:00,['alexander-yakushev'],2024-10-01 22:16:35+00:00,2024-09-06 12:22:21+00:00,https://github.com/metabase/metabase/pull/47658,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2507019089,pull_request,closed,,"ü§ñ backported ""API endpoint dox generation should resolve schemas from the registry ""","  #47634
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-05 07:36:48+00:00,"['camsaul', 'github-automation-metabase']",2024-09-11 16:58:57+00:00,2024-09-11 16:58:56+00:00,https://github.com/metabase/metabase/pull/47654,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2506993726,pull_request,closed,,[serdes] improve dir detection,"Dir detection is failing sometimes and would be nice to get a more informative error. And also check if maybe top-level is the actual directory.

[Context for the change](https://metaboat.slack.com/archives/C013N8XL286/p1725472279378119)",piranha,2024-09-05 07:26:07+00:00,['piranha'],2024-10-01 22:18:55+00:00,2024-09-05 11:58:35+00:00,https://github.com/metabase/metabase/pull/47653,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2506974809,pull_request,closed,,Use i18n-appropriate string interpolation for card copying,"Come to find out languages like Turkish put the `X` first in ""Copy of `X`""

(I happened to notice this in Cam's recent blog post)
",tsmacdonald,2024-09-05 07:18:58+00:00,['tsmacdonald'],2024-10-08 16:15:29+00:00,2024-09-05 08:32:30+00:00,https://github.com/metabase/metabase/pull/47652,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2330791444, 'issue_id': 2506974809, 'author': 'crisptrutski', 'body': 'I like the resonance of cycling the order of letters in `str` to cycle the ordering in the translated message :-)', 'created_at': datetime.datetime(2024, 9, 5, 7, 21, 37, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-09-05 07:21:37 UTC): I like the resonance of cycling the order of letters in `str` to cycle the ordering in the translated message :-)

"
2506957464,pull_request,closed,,perf: Add more timeseries insights optimizations,"Follow-up to #47414 and #47424.

1. More efficient `last-2` implementation (significant since it goes over every row in the table).
2. Optimiz—É generation of the validation sample to only create tuples from rows for the values that got into the sample, not for each one.
3. A bit hackish rewrite of `simple-linear-regression` to separately accept the ""link functions"". With the current implementation where only fx and fy are passed, having to perform `math/log` on boxed numbers (and return boxed numbers too) allocates quite a lot of Double instances. The proposed change at least removes the need to box on the way out of the accessor function.",alexander-yakushev,2024-09-05 07:10:09+00:00,['alexander-yakushev'],2024-10-01 22:19:10+00:00,2024-09-05 09:50:33+00:00,https://github.com/metabase/metabase/pull/47651,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2506799110,pull_request,closed,,Dashboard subscriptions and alerts should exclude archived cards,Fixes https://github.com/metabase/metabase/issues/47649,qnkhuat,2024-09-05 05:23:44+00:00,['qnkhuat'],2024-09-05 12:55:30+00:00,2024-09-05 12:55:29+00:00,https://github.com/metabase/metabase/pull/47650,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2506609461,pull_request,closed,,Add .swc to gitignore in the v50 release branch,For convenience ignore `.swc` directory in the release branch as well in order not to see it when switching from master,alxnddr,2024-09-05 01:58:46+00:00,['alxnddr'],2024-09-05 14:03:39+00:00,2024-09-05 14:03:13+00:00,https://github.com/metabase/metabase/pull/47648,"[('.Team/DashViz', 'Dashboard and Viz team')]",[],
2506604738,pull_request,closed,,"ü§ñ backported ""fix hidden pivot table scroll bar in QB""","  #47629
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-05 01:53:42+00:00,"['alxnddr', 'github-automation-metabase']",2024-09-05 02:41:14+00:00,2024-09-05 02:41:13+00:00,https://github.com/metabase/metabase/pull/47647,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2330449142, 'issue_id': 2506604738, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff b2de5adc00bb858683ffd2e4458db3e3aae36fc4...1fad83b629a27c7f041501b3441aa01e99dbe83a.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.styled.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.tsx |', 'created_at': datetime.datetime(2024, 9, 5, 1, 56, 46, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-05 01:56:46 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff b2de5adc00bb858683ffd2e4458db3e3aae36fc4...1fad83b629a27c7f041501b3441aa01e99dbe83a.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.styled.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.tsx |

"
2506577057,pull_request,closed,,"ü§ñ backported ""Store ::nil markers in CachedMetadataProvider for failed lookups""","  #47589
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-05 01:21:14+00:00,"['appleby', 'github-automation-metabase']",2024-09-13 22:10:21+00:00,2024-09-13 22:10:19+00:00,https://github.com/metabase/metabase/pull/47646,"[('.Team/Querying', ''), ('was-backported', 'apply this to PRs that are themselves backports')]",[],
2506500830,pull_request,closed,,"ü§ñ backported ""docs: clarify cumulative aggregations""",#47545,github-automation-metabase,2024-09-04 23:57:48+00:00,"['alexyarosh', 'github-automation-metabase']",2024-09-04 23:59:16+00:00,2024-09-04 23:59:15+00:00,https://github.com/metabase/metabase/pull/47645,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2506487477,pull_request,closed,,Use `:description` instead of `:doc/message` for Malli docstrings,"I added `:doc/message` a while back for things when working on code to generate documentation for Malli schemas, but I didn't realize the existing Malli `describe` utils and our wrappers around that were already using `:description` for the same purpose... we don't need two competing standards here. Change `:doc/message` to match up with everything else",camsaul,2024-09-04 23:45:36+00:00,['camsaul'],2024-10-08 16:15:27+00:00,2024-09-05 14:31:28+00:00,https://github.com/metabase/metabase/pull/47643,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]",[],
2506466961,pull_request,closed,,Fix LSP for defendpoint,"We were all annoyed by it, but jumping to definition with LSP inside `defendpoint` was completely broken. Anyways after literally weeks of trying to figure out why I managed to fix it. 

I wrote up my findings here https://camsaul.com/clojure/2024/09/03/debugging-clojure-lsp-jump-to-definition.html if anyone else wants to know how to debug LSP + custom Kondo hooks.",camsaul,2024-09-04 23:21:33+00:00,['camsaul'],2024-10-08 16:15:27+00:00,2024-09-05 14:31:14+00:00,https://github.com/metabase/metabase/pull/47641,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]","[{'comment_id': 2330586039, 'issue_id': 2506466961, 'author': 'qnkhuat', 'body': 'Thanks Cam!', 'created_at': datetime.datetime(2024, 9, 5, 4, 44, 29, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-09-05 04:44:29 UTC): Thanks Cam!

"
2506436792,pull_request,closed,,"ü§ñ backported ""Entity id translation analytics""","  #47432
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-04 22:49:10+00:00,"['escherize', 'github-automation-metabase']",2024-09-09 15:18:21+00:00,2024-09-09 15:18:19+00:00,https://github.com/metabase/metabase/pull/47640,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2334698496, 'issue_id': 2506436792, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 1bbf501a7cf801e5e12c59de37aac3b2c5fbdd69...724303c55b6184a57a0410cf8d6bb7ea6c8adfbc.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/inputs/Switch/Switch.styled.tsx |', 'created_at': datetime.datetime(2024, 9, 6, 19, 37, 48, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-06 19:37:48 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 1bbf501a7cf801e5e12c59de37aac3b2c5fbdd69...724303c55b6184a57a0410cf8d6bb7ea6c8adfbc.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/inputs/Switch/Switch.styled.tsx |

"
2506420513,pull_request,closed,,"ü§ñ backported ""fix: sqlserver handle uniqueidentifier uuids""",#47544,github-automation-metabase,2024-09-04 22:32:20+00:00,"['snoe', 'github-automation-metabase']",2024-09-06 16:08:10+00:00,2024-09-06 16:08:10+00:00,https://github.com/metabase/metabase/pull/47638,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2506399246,pull_request,closed,,Adds enable-embedding-sdk,"resolves #47521

- deprecate `enable-embedding` setting
- replace usages of enable-embedding setting (except in direct tests)
- updating enable-embedding-sdk sends snowplow messages",escherize,2024-09-04 22:11:42+00:00,['escherize'],2024-09-09 22:36:17+00:00,2024-09-09 22:29:35+00:00,https://github.com/metabase/metabase/pull/47637,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2332410260, 'issue_id': 2506399246, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff d74acdaa0ef38d09b235c1d3928bedee0e6f0194...6a0e70b7d72eb902b538bbc2643a3348da903d2f.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/skeletons/ChartSkeleton/ChartSkeleton.unit.spec.tsx<br>frontend/src/metabase/visualizations/index.ts<br>frontend/src/metabase/visualizations/shared/utils/sizes.ts<br>frontend/src/metabase/visualizations/types/visualization.ts<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.stories.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.styled.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.tsx |\n| @kdoh | frontend/src/metabase/ui/components/inputs/Switch/Switch.styled.tsx<br>frontend/src/metabase/ui/index.ts<br>frontend/src/metabase/ui/utils/colors.ts |\n| @ranquild | frontend/src/metabase/setup/actions.ts<br>frontend/src/metabase/setup/components/CompletedStep/CompletedStep.tsx<br>frontend/src/metabase/setup/tests/common.unit.spec.tsx<br>frontend/src/metabase/setup/tests/premium-pro-cloud.unit.spec.tsx<br>frontend/src/metabase/setup/tests/premium-pro-selfhosted.unit.spec.tsx<br>frontend/src/metabase/setup/tests/premium-starter-cloud.unit.spec.tsx<br>frontend/src/metabase/sharing/components/SharingMenu/MenuItems/EmbedMenuItem.tsx<br>frontend/src/metabase/sharing/components/SharingMenu/test/setup.tsx |', 'created_at': datetime.datetime(2024, 9, 5, 18, 43, 36, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-05 18:43:36 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff d74acdaa0ef38d09b235c1d3928bedee0e6f0194...6a0e70b7d72eb902b538bbc2643a3348da903d2f.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/skeletons/ChartSkeleton/ChartSkeleton.unit.spec.tsx<br>frontend/src/metabase/visualizations/index.ts<br>frontend/src/metabase/visualizations/shared/utils/sizes.ts<br>frontend/src/metabase/visualizations/types/visualization.ts<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.stories.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.styled.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.tsx |
| @kdoh | frontend/src/metabase/ui/components/inputs/Switch/Switch.styled.tsx<br>frontend/src/metabase/ui/index.ts<br>frontend/src/metabase/ui/utils/colors.ts |
| @ranquild | frontend/src/metabase/setup/actions.ts<br>frontend/src/metabase/setup/components/CompletedStep/CompletedStep.tsx<br>frontend/src/metabase/setup/tests/common.unit.spec.tsx<br>frontend/src/metabase/setup/tests/premium-pro-cloud.unit.spec.tsx<br>frontend/src/metabase/setup/tests/premium-pro-selfhosted.unit.spec.tsx<br>frontend/src/metabase/setup/tests/premium-starter-cloud.unit.spec.tsx<br>frontend/src/metabase/sharing/components/SharingMenu/MenuItems/EmbedMenuItem.tsx<br>frontend/src/metabase/sharing/components/SharingMenu/test/setup.tsx |

"
2506290447,pull_request,closed,,Add a quick test for perms on timeline API,"We had a security issue where it was possible to query timelines without having the requisite permissions on the collection. This test checks to make sure this doesn't happen again.

Fixes #47135 ",johnswanson,2024-09-04 21:01:23+00:00,['johnswanson'],2024-09-05 20:16:26+00:00,2024-09-05 20:16:25+00:00,https://github.com/metabase/metabase/pull/47636,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2506217352,pull_request,closed,,docs - embedding params edits,"- Removes docs on setting locale.
- Consolidates docs on appearance settings.",jeff-bruemmer,2024-09-04 20:30:35+00:00,['jeff-bruemmer'],2024-10-01 22:18:07+00:00,2024-09-05 13:52:56+00:00,https://github.com/metabase/metabase/pull/47635,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2506200768,pull_request,closed,,API endpoint dox generation should resolve schemas from the registry ,"Fixes #46799

`defendpoint` forms that had a schema like `{type ::card-type}` didn't have meaningful auto-generated dox since the old code didn't know how to resolve schemas from our registry. This PR fixes that.

I had to do a little work here to make sure resolving something like `[:schema {:description ""whatever""} ::abc]` wouldn't drop the meaningful `:description` key",camsaul,2024-09-04 20:19:26+00:00,['camsaul'],2024-09-05 07:36:02+00:00,2024-09-05 07:36:01+00:00,https://github.com/metabase/metabase/pull/47634,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]",[],
2506118148,pull_request,closed,,Pass is-superuser? from the top,"This is a clean-up PR which avoids defensive lazy calculation of is-superuser?

I made this a separate PR as I expect there to be some blood with tests, which I hope for CI to flush out.",crisptrutski,2024-09-04 19:27:33+00:00,['crisptrutski'],2024-09-05 10:12:29+00:00,2024-09-05 10:12:28+00:00,https://github.com/metabase/metabase/pull/47632,"[('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2329815122, 'issue_id': 2506118148, 'author': 'crisptrutski', 'body': '> [!WARNING]\n> <b>This pull request is not mergeable via GitHub because a downstack PR is open. Once all requirements are satisfied, merge this PR as a stack <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47632?utm_source=stack-comment-downstack-mergeability-warning"" >on Graphite</a>.</b>\n> <a href=""https://graphite.dev/docs/merge-pull-requests"">Learn more</a>\n\n* **#47632** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47632?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* **#47631** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47631?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 9, 4, 19, 27, 48, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-09-04 19:27:48 UTC): * **#47632** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47632?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* **#47631** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47631?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2506116527,pull_request,closed,,Fix query type and respect user parameters in search,"### Description

This PR consists of some minor fix-ups which will smooth the path to creating a Full-Text Search index.

1. It's optional to provide a search string, but if its omitted we throw a type error for the query we build. We make `:where` optional so that it type checks and we can re-use this query for building the index.
2. Despite search taking the current user and their permissions as first class arguments, when calling down into the collection properties the dynamic scope variables are used instead. This updates the sub-query building function to use the function scoped variables. This will make it easier for us to index every item.
3. The query for super user permissions was overly complex, and perhaps slow for engines with less intelligent query optimizers. While I'm here I simplified it a bit.

~~There's some awkward defensive coding around whether we've populated `is-superuser?` in the search context. I have another PR for that which I'll merge into this one if its simple enough.~~ Fixed.",crisptrutski,2024-09-04 19:26:31+00:00,['crisptrutski'],2024-10-08 16:15:28+00:00,2024-09-05 13:05:50+00:00,https://github.com/metabase/metabase/pull/47631,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2329813649, 'issue_id': 2506116527, 'author': 'crisptrutski', 'body': '* **#47632** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47632?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#47631** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47631?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 9, 4, 19, 26, 49, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-09-04 19:26:49 UTC): * **#47632** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47632?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#47631** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47631?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2506049131,pull_request,closed,,[Permissions] Warn group can‚Äôt view native queries w/ Blocked schema/table access,"Helps w/ #47547

Product direction in Slack thread: https://metaboat.slack.com/archives/C05NXACAG1G/p1725315407578979

### Description

Adds warning message on Blocked schemas or tables
![CleanShot 2024-09-20 at 14 49 16@2x](https://github.com/user-attachments/assets/779d6b77-f6bf-4474-a93a-c20251c8f204)

### How to verify

- Have a db with View Data set to ""Can View"" for a All Users group
- Drill down into the schema or table view
- Change a schema/table to Blocked
- Tooltip should appear with message (note another message will appear if you chose another group and the default group has more permissive access)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",sloansparger,2024-09-04 18:44:16+00:00,['sloansparger'],2024-09-25 15:42:57+00:00,2024-09-25 14:54:58+00:00,https://github.com/metabase/metabase/pull/47630,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2334553801, 'issue_id': 2506049131, 'author': 'iethree', 'body': 'one other little nit, that I\'m not even sure what the right behavior is, but if you have a blocked schema, and then go into it and set a table to ""can view"", you still see the warning until you click save and it automatically switches the schema to granular. feels weird, but like I said, not entirely sure what it should do in this case.\r\n\r\n![Screen Shot 2024-09-06 at 11 50 48 AM](https://github.com/user-attachments/assets/ac8870af-4787-46e4-96df-596fa59c963e)', 'created_at': datetime.datetime(2024, 9, 6, 17, 52, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2374334705, 'issue_id': 2506049131, 'author': 'sloansparger', 'body': 'Copy approved by Jeff üëç', 'created_at': datetime.datetime(2024, 9, 25, 14, 54, 46, tzinfo=datetime.timezone.utc)}]","iethree on (2024-09-06 17:52:20 UTC): one other little nit, that I'm not even sure what the right behavior is, but if you have a blocked schema, and then go into it and set a table to ""can view"", you still see the warning until you click save and it automatically switches the schema to granular. feels weird, but like I said, not entirely sure what it should do in this case.

![Screen Shot 2024-09-06 at 11 50 48 AM](https://github.com/user-attachments/assets/ac8870af-4787-46e4-96df-596fa59c963e)

sloansparger (Issue Creator) on (2024-09-25 14:54:46 UTC): Copy approved by Jeff üëç

"
2506001061,pull_request,closed,,fix hidden pivot table scroll bar in QB,"Closes https://github.com/metabase/metabase/issues/47595

### Description

Caused by https://github.com/metabase/metabase/pull/47102 specifically the part that attempted to address https://github.com/metabase/metabase/issues/47019 which requires hiding scroll bars in the dashboard editing mode. By a mistake scrollbars were hidden in all editing modes including QB.

### How to verify

Enable scrollbars visibility:
<img width=""412"" alt=""Screenshot 2024-09-04 at 2 12 34‚ÄØPM"" src=""https://github.com/user-attachments/assets/d2b5d227-94a5-489f-af7a-f8c026d85502"">

- Create a Pivot table in QB
- Ensure scroll bars are visible (they were hidden but scroll with trackpad gestures or mouse still worked, the issue is with visibility)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",alxnddr,2024-09-04 18:13:59+00:00,['alxnddr'],2024-09-05 01:52:55+00:00,2024-09-05 01:52:53+00:00,https://github.com/metabase/metabase/pull/47629,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team'), ('loki-update', '')]",[],
2505985460,pull_request,closed,,add more e2e tests for offset feature,"Closes https://github.com/metabase/metabase/issues/47168
Closes https://github.com/metabase/metabase/issues/47806 - contains testing plan

### Description

Adds tests to cover offset functionality",uladzimirdev,2024-09-04 18:03:59+00:00,['uladzimirdev'],2024-09-13 17:23:34+00:00,2024-09-13 17:23:32+00:00,https://github.com/metabase/metabase/pull/47628,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2347223535, 'issue_id': 2505985460, 'author': 'uladzimirdev', 'body': '@ranquild I rewrote tests using UI, could you please take a look?', 'created_at': datetime.datetime(2024, 9, 12, 20, 55, 3, tzinfo=datetime.timezone.utc)}]","uladzimirdev (Issue Creator) on (2024-09-12 20:55:03 UTC): @ranquild I rewrote tests using UI, could you please take a look?

"
2505923963,pull_request,closed,,New can-run/can-save restrictions for metrics,"Epic https://github.com/metabase/metabase/issues/47147
Closes https://github.com/metabase/metabase/issues/47149
Corresponding FE PR https://github.com/metabase/metabase/pull/47368

New metric restrictions:
- 0-1 breakouts
- breakouts only on Date or DateTime columns",ranquild,2024-09-04 17:25:41+00:00,['ranquild'],2024-09-05 20:54:15+00:00,2024-09-05 20:54:14+00:00,https://github.com/metabase/metabase/pull/47626,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2505907448,pull_request,closed,,"ü§ñ backported ""rename event -> simple_event and trackEvent -> trackSimpleEvent""",#47608,github-automation-metabase,2024-09-04 17:16:59+00:00,"['npretto', 'github-automation-metabase']",2024-09-04 18:05:21+00:00,2024-09-04 18:05:20+00:00,https://github.com/metabase/metabase/pull/47625,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2505773966,pull_request,closed,,Pass string auto param to ee-extra,"

### Description

ee-extra builds have not been auto-approving and merging because this was expecting a string, not a boolean. Data types in github actions are confusing ü•¥ 
",iethree,2024-09-04 16:06:56+00:00,['iethree'],2024-10-08 16:15:35+00:00,2024-09-04 16:11:37+00:00,https://github.com/metabase/metabase/pull/47623,"[('.Building & Releasing', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2505737719,pull_request,closed,,Fix visualization with warnings doesn't work when embedding,"> [!note]
> This PRs directly target 50, because the code is already fixed on master, but the fix is a part of a feature which shouldn't be backported.

Closes https://github.com/metabase/metabase/issues/47617

### Description

This fixes by preventing the visualization from repeatedly updating the same warning causing the infinite loop. I don't quite grasp why this only happens on the static embed/public embed yet. But applying the same code from `master` works, so I'll go with that for simplicity.

### How to verify

Follow the repro step in #47617

### Demo
<img width=""941"" alt=""Screenshot 2024-09-04 at 10 45 00‚ÄØPM"" src=""https://github.com/user-attachments/assets/a27977ae-1a66-4d59-b21b-09b08737c0d6"">


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",WiNloSt,2024-09-04 15:48:49+00:00,['WiNloSt'],2024-09-05 14:51:20+00:00,2024-09-05 14:51:18+00:00,https://github.com/metabase/metabase/pull/47622,"[('.Team/Embedding', '')]","[{'comment_id': 2329429008, 'issue_id': 2505737719, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff d40b0287c95fb3433b97c42ec05f08f5fde3263f...cae9618188c11041566d1107785526bcb8bae53d.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/Visualization/Visualization.jsx |', 'created_at': datetime.datetime(2024, 9, 4, 15, 50, 15, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-04 15:50:15 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff d40b0287c95fb3433b97c42ec05f08f5fde3263f...cae9618188c11041566d1107785526bcb8bae53d.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/Visualization/Visualization.jsx |

"
2505697943,pull_request,closed,,feat(sdk): proof-of-concept for auto-generating documentation from types,"> [!IMPORTANT]
> For those employed by Metabase: if you are merging into master, please add either a `backport` or a `no-backport` label to this PR. You will not be able to merge until you do this step. Refer to the section [Do I need to backport this PR?](https://www.notion.so/metabase/Metabase-Branching-Strategy-6eb577d5f61142aa960a626d6bbdfeb3?pvs=4#89f80d6f17714a0198aeb66c0efd1b71) in the Metabase Branching Strategy document for more details. If you're not employed by Metabase, this section does not apply to you, and the label will be taken care of by your reviewer.

> **Warning**
>
> If that is your first contribution to Metabase, please sign the [Contributor License Agreement](https://docs.google.com/a/metabase.com/forms/d/1oV38o7b9ONFSwuzwmERRMi9SYrhYeOrkbmNaq9pOJ_E/viewform) (unless it's a tiny documentation change). Also, if you're attempting to fix a translation issue, please submit your changes to our [POEditor project](https://poeditor.com/join/project/ynjQmwSsGh) instead of opening a PR.

Closes https://github.com/metabase/metabase/issues/[issue_number]

### Description

Describe the overall approach and the problem being solved.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. New question -> Sample Dataset -> ...
2. ...

### Demo

_Upload a demo video or before/after screenshots if sensible or remove the section_

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",heypoom,2024-09-04 15:30:21+00:00,['heypoom'],2024-12-17 10:53:39+00:00,2024-12-17 10:53:39+00:00,https://github.com/metabase/metabase/pull/47620,"[('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2505524006,pull_request,closed,,"ü§ñ backported ""fix time series with data gaps stacked bar charts crash when enabling segments labels""",#47599,github-automation-metabase,2024-09-04 14:24:21+00:00,"['alxnddr', 'github-automation-metabase']",2024-09-04 19:16:18+00:00,2024-09-04 19:16:17+00:00,https://github.com/metabase/metabase/pull/47619,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2329216064, 'issue_id': 2505524006, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff d40b0287c95fb3433b97c42ec05f08f5fde3263f...f126d4af2c2fcf8658fed435942947e8baa7fec3.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/echarts/cartesian/chart-measurements/index.ts |', 'created_at': datetime.datetime(2024, 9, 4, 14, 25, 44, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-04 14:25:44 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff d40b0287c95fb3433b97c42ec05f08f5fde3263f...f126d4af2c2fcf8658fed435942947e8baa7fec3.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/echarts/cartesian/chart-measurements/index.ts |

"
2505515759,pull_request,closed,,Fix `:selected?` property of `visible-columns` (CLJS only),Closes https://github.com/metabase/metabase/issues/47575,ranquild,2024-09-04 14:21:05+00:00,['ranquild'],2024-09-04 16:15:53+00:00,2024-09-04 16:15:52+00:00,https://github.com/metabase/metabase/pull/47618,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2505442489,pull_request,closed,,Fix: Create api token modal now shows error from backend ,"For example if name is taken. 

Closes https://github.com/metabase/metabase/issues/47552

### Description

The modal for creating an API token didn't take into consideration whether the request was successful or not. If we got an error from backend, the next step (showing the API token) was shown (independent of if a token was generated or not).

This change now renders the error message coming from backend, if any. Giving the user a chance to change the name and try again. 

Remaning issue: The submit button still says ""Success"" (with green background) for a few seconds, even if there was an error. 

I also took the opportunity to disable the submit button if the request is in the air (i.e. `response.isLoading`)

### How to verify

1. Go to 'Admin settings -> Authentication'
2. Click ""Manage"" button in the 'API token' section.
3. Click ""Create API Key"" and generate a token with name ""Foo"".
4. Again, click ""Create API Key"" and generate another token with the same name, ""Foo"".
5. The error message should now show up next to the Submit button saying: ""An API key with this name already exists.""  

### Demo

<img width=""489"" alt=""image"" src=""https://github.com/user-attachments/assets/ff086df4-c5e5-44ca-bf2d-f3be664c7e33"">

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",antonhedstrom,2024-09-04 13:51:18+00:00,[],2024-12-18 07:36:54+00:00,2024-12-17 17:43:52+00:00,https://github.com/metabase/metabase/pull/47616,[],"[{'comment_id': 2548969376, 'issue_id': 2505442489, 'author': 'rafpaf', 'body': ""Thank you, @antonhedstrom. I've moved your code along with a tweak from me into this PR: https://github.com/metabase/metabase/pull/51395"", 'created_at': datetime.datetime(2024, 12, 17, 16, 34, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2549150938, 'issue_id': 2505442489, 'author': 'rafpaf', 'body': ""Closing this in favor of #51395. @antonhedstrom, thank you for your perceptiveness. And your hard work on this. When this merges, your name will be on the commit. I'll be a co-author, to facilitate `git blame`'ing."", 'created_at': datetime.datetime(2024, 12, 17, 17, 43, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2549164491, 'issue_id': 2505442489, 'author': 'rafpaf', 'body': ""I regret having to stamp this with a red badge. It's not stoplight red - it's a bullfighter red. It means go. We'll be using your code."", 'created_at': datetime.datetime(2024, 12, 17, 17, 46, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2550570434, 'issue_id': 2505442489, 'author': 'antonhedstrom', 'body': ""> Closing this in favor of #51395. @antonhedstrom, thank you for your perceptiveness. And your hard work on this. When this merges, your name will be on the commit. I'll be a co-author, to facilitate `git blame`'ing.\r\n\r\nHehe that is not a big deal for me, the UX is more important :) I noticed that there was a request for a test or two, but that will be handled in the new PR then I guess? Do you want me to take a look on that?"", 'created_at': datetime.datetime(2024, 12, 18, 7, 36, 52, tzinfo=datetime.timezone.utc)}]","rafpaf on (2024-12-17 16:34:15 UTC): Thank you, @antonhedstrom. I've moved your code along with a tweak from me into this PR: https://github.com/metabase/metabase/pull/51395

rafpaf on (2024-12-17 17:43:32 UTC): Closing this in favor of #51395. @antonhedstrom, thank you for your perceptiveness. And your hard work on this. When this merges, your name will be on the commit. I'll be a co-author, to facilitate `git blame`'ing.

rafpaf on (2024-12-17 17:46:29 UTC): I regret having to stamp this with a red badge. It's not stoplight red - it's a bullfighter red. It means go. We'll be using your code.

antonhedstrom (Issue Creator) on (2024-12-18 07:36:52 UTC): Hehe that is not a big deal for me, the UX is more important :) I noticed that there was a request for a test or two, but that will be handled in the new PR then I guess? Do you want me to take a look on that?

"
2505403543,pull_request,closed,,"ü§ñ backported ""Update default locked parameter value""",#47607,github-automation-metabase,2024-09-04 13:36:16+00:00,"['WiNloSt', 'github-automation-metabase']",2024-09-04 14:07:08+00:00,2024-09-04 14:07:07+00:00,https://github.com/metabase/metabase/pull/47614,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2505038100,pull_request,closed,,"Manual backport ‚Äî Followup on ""Fix crash when navigating between bookmarked dashboards""",Manual backport of #47400,kulyk,2024-09-04 11:13:32+00:00,['kulyk'],2024-09-04 13:15:16+00:00,2024-09-04 13:15:14+00:00,https://github.com/metabase/metabase/pull/47612,"[('.Team/DashViz', 'Dashboard and Viz team')]",[],
2505009507,pull_request,closed,,"Revert ""Hide upload config when data warehouse is attached""","The way this was implemented, it also hid the section for management
of uploaded CSV files.  Further, admins might want to intentionally
switch from uploading to the data warehouse provided by Metabase to
one of their own.

This reverts commit fbaf58ad032afd3283baa3d6c7fb056ac6a23b8a.

This needs to be backported to v50.

References: https://github.com/metabase/harbormaster/issues/5121
References: https://metaboat.slack.com/archives/C032LFJFANL/p1725296255637989
",devurandom,2024-09-04 11:00:47+00:00,['devurandom'],2024-10-01 22:18:45+00:00,2024-09-05 12:45:09+00:00,https://github.com/metabase/metabase/pull/47611,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2504909509,pull_request,closed,,clean output folder to avoid bloating,"[context](https://metaboat.slack.com/archives/C0669P4AF9N/p1725441431575749)

it looks like output folder can bloat and because of that building jar locally becomes extremely slow.

we need to remove dist folders explicitly",uladzimirdev,2024-09-04 10:18:52+00:00,['uladzimirdev'],2024-10-08 16:15:33+00:00,2024-09-04 16:23:12+00:00,https://github.com/metabase/metabase/pull/47609,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2504898703,pull_request,closed,,rename event -> simple_event and trackEvent -> trackSimpleEvent,"
### Description

This renames `event` to simple event to make it clear that it's a specific schema for *simple* events, not a base event that all the others ""inherit""/extend.

Briefly discussed here: https://metaboat.slack.com/archives/C01MS7DQKR6/p1725022707669739?thread_ts=1724940664.655259&cid=C01MS7DQKR6",npretto,2024-09-04 10:14:32+00:00,['npretto'],2024-10-01 22:20:51+00:00,2024-09-04 17:16:02+00:00,https://github.com/metabase/metabase/pull/47608,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Embedding', '')]",[],
2504796498,pull_request,closed,,Update default locked parameter value,"Closes https://github.com/metabase/metabase/issues/47570

### Description

Since #40292, we will fail all static embed with locked parameter with values `null`. So, to make the static embed preview works without requiring users inputing all locked parameters values, we need to update the default value accordingly from `null` to `[]`

### How to verify

1. Embed a native question or a dashboard with a a parameter.
1. When embedding change the parameter type to `locked`
1. Click Preview and you should see the dashboard card/question render with results.

### Demo

![image](https://github.com/user-attachments/assets/6a17f898-b283-4ab8-9922-5a4ce2f85b47)


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",WiNloSt,2024-09-04 09:30:50+00:00,['WiNloSt'],2024-09-04 13:35:21+00:00,2024-09-04 13:35:19+00:00,https://github.com/metabase/metabase/pull/47607,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Embedding', '')]","[{'comment_id': 2328388487, 'issue_id': 2504796498, 'author': 'WiNloSt', 'body': '@adam-james-v I requested your review because you originally created these tests.', 'created_at': datetime.datetime(2024, 9, 4, 9, 39, 5, tzinfo=datetime.timezone.utc)}]","WiNloSt (Issue Creator) on (2024-09-04 09:39:05 UTC): @adam-james-v I requested your review because you originally created these tests.

"
2504772798,pull_request,closed,,fix(sdk): fix ResizeObserver error in the ExplicitSize component,"Closes https://github.com/metabase/metabase/issues/43304

### Description

In the Cypress CI and in the Embedding SDK, we often see this error: ""ResizeObserver loop completed with undelivered notifications.""

This is caused by layout thrashing in our use of resizeObserver in the ExplicitSize component. Per https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver#observation_errors

> As long as the error event does not fire indefinitely, resize observer will settle and produce a stable, likely correct, layout. However, visitors may see a flash of broken layout, as a sequence of changes expected to happen in a single frame is instead happening over multiple frames. If you want to prevent these errors, the solution depends on what your intended effect is. If you actually intend to have an infinite loop, you just need to defer the resizing code in your ResizeObserver callback to after the browser repaints. You can put it into a requestAnimationFrame callback.

### Demo

Before

![CleanShot 2567-09-04 at 16 16 48@2x](https://github.com/user-attachments/assets/1fc97ba3-23a5-4d5e-be64-611559d086a5)

After

![CleanShot 2567-09-04 at 16 30 38@2x](https://github.com/user-attachments/assets/57b1a7e9-5109-4c37-bff5-d5ed07a793f4)

### How to verify

- Run the SDK with create-react-app. Don't use Vite, or you won't see the error.
   - Option 1: You can test this with Jeff's example here: https://github.com/metabase/metabase-nodejs-react-sdk-embedding-sample.
   - Option 2: you can run `npx @metabase/embedding-sdk-react@latest start` in your own create-react-app setup. IMO this is a bit faster.
- You should see the error as per the above screenshot without this PR.
- With this PR, the above error should go away.
   - PS. If someone has ideas on how to regression-test this let me know. I can't even reproduce it on Cypress CI, so no idea how to test against that.",heypoom,2024-09-04 09:21:15+00:00,['heypoom'],2024-10-02 23:44:12+00:00,2024-10-02 23:44:12+00:00,https://github.com/metabase/metabase/pull/47606,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Embedding', '')]","[{'comment_id': 2328390782, 'issue_id': 2504772798, 'author': 'uladzimirdev', 'body': ""@heypoom it's a big problem, and I've tried many fixes for it already. Related issue is https://github.com/cypress-io/cypress/issues/27415\r\n\r\nwe also have a handler in cypress that must catch all errors like this https://github.com/metabase/metabase/blob/master/e2e/support/cypress.js#L29\r\n\r\nif this happens in embedding sdk and your PR fixes it, I'm fine with it, but I doubt it's a proper solution"", 'created_at': datetime.datetime(2024, 9, 4, 9, 40, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2328578275, 'issue_id': 2504772798, 'author': 'npretto', 'body': 'I noticed mantine has a hook that does something similar: https://github.com/mantinedev/mantine/blob/v6/src/mantine-hooks/src/use-resize-observer/use-resize-observer.ts\r\nIt seems we have some custom logic around around print media though so we may not be able to ""simply"" use that hook.\r\n\r\nEdit: actually, maybe most of our custom logic is there as work arounds because we were not using requestAnimationFrame? should we try to use the hook from mantine and see if it works?', 'created_at': datetime.datetime(2024, 9, 4, 10, 56, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2332512716, 'issue_id': 2504772798, 'author': 'heypoom', 'body': '(just skipping some tests temporarily, just to see what other tests are failing)', 'created_at': datetime.datetime(2024, 9, 5, 19, 48, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2389987528, 'issue_id': 2504772798, 'author': 'heypoom', 'body': ""Will be superseded by @oisincoveney's PR following https://github.com/metabase/metabase/pull/48109"", 'created_at': datetime.datetime(2024, 10, 2, 23, 44, 12, tzinfo=datetime.timezone.utc)}]","uladzimirdev on (2024-09-04 09:40:17 UTC): @heypoom it's a big problem, and I've tried many fixes for it already. Related issue is https://github.com/cypress-io/cypress/issues/27415

we also have a handler in cypress that must catch all errors like this https://github.com/metabase/metabase/blob/master/e2e/support/cypress.js#L29

if this happens in embedding sdk and your PR fixes it, I'm fine with it, but I doubt it's a proper solution

npretto on (2024-09-04 10:56:58 UTC): I noticed mantine has a hook that does something similar: https://github.com/mantinedev/mantine/blob/v6/src/mantine-hooks/src/use-resize-observer/use-resize-observer.ts
It seems we have some custom logic around around print media though so we may not be able to ""simply"" use that hook.

Edit: actually, maybe most of our custom logic is there as work arounds because we were not using requestAnimationFrame? should we try to use the hook from mantine and see if it works?

heypoom (Issue Creator) on (2024-09-05 19:48:09 UTC): (just skipping some tests temporarily, just to see what other tests are failing)

heypoom (Issue Creator) on (2024-10-02 23:44:12 UTC): Will be superseded by @oisincoveney's PR following https://github.com/metabase/metabase/pull/48109

"
2504703191,pull_request,closed,,add more stuff to migrations doc,"I have added a few points it's missing plus tried to rewrite so it's shorter phrases and more structured, to make it look more like a checklist than a rant.

Much easier to read side-by-side rather than as unified diff.",piranha,2024-09-04 08:51:32+00:00,['piranha'],2024-10-08 16:15:36+00:00,2024-09-04 11:06:16+00:00,https://github.com/metabase/metabase/pull/47605,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2504682705,pull_request,closed,,"ü§ñ backported ""upgrade webpack to address security issue""",  #47585,github-automation-metabase,2024-09-04 08:42:01+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-09-06 17:42:07+00:00,2024-09-06 17:42:06+00:00,https://github.com/metabase/metabase/pull/47604,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2504420747,pull_request,closed,,[Notification] POC: system event,,qnkhuat,2024-09-04 06:27:52+00:00,[],2024-09-30 01:53:10+00:00,2024-09-30 01:53:10+00:00,https://github.com/metabase/metabase/pull/47602,[],[],
2504038647,pull_request,closed,,fix time series with data gaps stacked bar charts crash when enabling segments labels,"Closes https://github.com/metabase/metabase/issues/45717

### Description

Fix time series with data gaps stacked bar charts crash when enabling segments labels.

### How to verify

```
select '2024-06-23 00:00:00' as date, 'a' as value_type,	14080 as value
UNION ALL
select '2024-07-24 00:00:00' as date,	'd' as value_type,	0 as value
```

- Create a stacked bar chart where: `date` is x-axis dimension, `value_type` is breakout and `value` is metric.
- Enable segment labels or all labels
- Ensure it does not crash


### Demo

Before
<img width=""1764"" alt=""Screenshot 2024-09-03 at 7 56 24‚ÄØPM"" src=""https://github.com/user-attachments/assets/95511d16-12f2-4059-bfe1-86e928806974"">

After
<img width=""2542"" alt=""Screenshot 2024-09-03 at 7 56 45‚ÄØPM"" src=""https://github.com/user-attachments/assets/b3cc49a3-3fdb-40c3-89e1-8588916a71bf"">

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",alxnddr,2024-09-04 00:18:28+00:00,['alxnddr'],2024-09-04 14:23:26+00:00,2024-09-04 14:23:24+00:00,https://github.com/metabase/metabase/pull/47599,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2503988519,pull_request,closed,,"ü§ñ backported ""Add v0.50.24 to the list of releases""",#47591,github-automation-metabase,2024-09-03 23:27:51+00:00,"['alexyarosh', 'github-automation-metabase']",2024-09-03 23:29:21+00:00,2024-09-03 23:29:21+00:00,https://github.com/metabase/metabase/pull/47598,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2503857989,pull_request,closed,,"ü§ñ backported ""docs: pro callout for subscriptions""",#47593,github-automation-metabase,2024-09-03 21:52:26+00:00,"['alexyarosh', 'github-automation-metabase']",2024-09-03 21:53:53+00:00,2024-09-03 21:53:53+00:00,https://github.com/metabase/metabase/pull/47594,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2503829569,pull_request,closed,,docs: pro callout for subscriptions,[slack ](https://metaboat.slack.com/archives/C03G7SHKFNW/p1725397507114879),alexyarosh,2024-09-03 21:33:59+00:00,['alexyarosh'],2024-09-03 21:54:23+00:00,2024-09-03 21:51:40+00:00,https://github.com/metabase/metabase/pull/47593,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2503820264,pull_request,closed,,Support field remapping in pivot queries,"Closes https://github.com/metabase/metabase/issues/46919

### Description

The way we handle pivot queries since v50 does not take remapped fields into account. Remapped fields are fields automatically added by the query processor based on metadata. This PR collects the remapped fields and adjusts the pivot query's breakout combination to account for them.

To make our lives easier, this PR changes how the breakouts are generated. Previously, it could happen that in some queries the selected breakouts appeared in a different order than in the original query. With this change, such inversions will not occur.

### How to verify

Use the repo steps from issue #46919 and look at the new unit tests. A unit test reproducing the query in the bug issue is included.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",metamben,2024-09-03 21:28:21+00:00,['metamben'],2024-09-05 17:55:49+00:00,2024-09-05 17:55:48+00:00,https://github.com/metabase/metabase/pull/47592,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2503806486,pull_request,closed,,Add v0.50.24 to the list of releases,Like it says on the tin üòÅ,github-automation-metabase,2024-09-03 21:18:28+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-09-03 23:29:46+00:00,2024-09-03 23:27:03+00:00,https://github.com/metabase/metabase/pull/47591,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2503781226,pull_request,closed,,fix: bigquery add null checks to result processing,"Fixes #47339

On the related issue there are different stacktraces indicating likely sources of null pointer exceptions.

1. `.getNextPage` is likely returning a nil value. I was unable to reproduce this but one thing I did notice is that `hasNextPage` is recommended over checking `.getNextPageToken`. Added nil handling around `page` possibly being nil.

2. `cancel-chan` may be triggered before processing begins and such `execute-bigquery` would pass nil as a TableResult to the initial reducer. Testing if cancel-chan happens at just the right moment would be too flaky for CI testing but I was able to reproduce this locally and is fixed by the nil handling added.

3. `cancel-chan` may be triggered during query processing. This is covered by a test now.
",snoe,2024-09-03 21:02:10+00:00,['snoe'],2024-09-09 15:47:30+00:00,2024-09-09 15:47:28+00:00,https://github.com/metabase/metabase/pull/47590,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Drivers', '')]",[],
2503732890,pull_request,closed,,Store ::nil markers in CachedMetadataProvider for failed lookups,"Closes https://github.com/metabase/metabase/issues/39326

### Description

Store ::nil markers in CachedMetadataProvider for any ids for which the wrapped/uncached upstream provider fails to return
metadatas. This prevents repeatedly querying the uncached-provider for ids that don't exist.

The downside is that if the uncached-provider suddenly starts returning metadata for an id that previously did not
exist, we won't pick up on it, but the assumption here is that this is no different / worse than cache invalidation
for existing ids that happen to change after we cache them.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",appleby,2024-09-03 20:32:55+00:00,['appleby'],2024-09-05 01:20:27+00:00,2024-09-05 01:20:26+00:00,https://github.com/metabase/metabase/pull/47589,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2503608058,pull_request,closed,,[QP] Correctly handle `:lib/internal-remap` columns in `:result_metadata`,"Fixes #45938.

### Description

Remapping is handled at the top level of the query, and should be
ignored for inner queries. This PR hides it from `results_metadata` on
source queries.

It also fixes the interaction with `large-int-id` logic to make big
integers JS-safe.

### How to verify

1. Set up an ID column with an **internal** remap
    - (Remapping based on a fixed drop-down list, not another column.)
2. Create a model which **joins** in that column and does a breakout on it.
3. Consume that model from a question

Before this change, it will error with the message in #45938. With this change, it will remap correctly.
I also fixed a tangential issue with the `large-int-id` and internal remapping.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",bshepherdson,2024-09-03 19:23:57+00:00,['bshepherdson'],2024-10-17 20:40:30+00:00,2024-09-09 19:48:46+00:00,https://github.com/metabase/metabase/pull/47587,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2327259500, 'issue_id': 2503608058, 'author': 'bshepherdson', 'body': '* **#47587** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47587?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 9, 3, 19, 24, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2420526265, 'issue_id': 2503608058, 'author': 'jordanell', 'body': 'Are there any plans to get this into an upcoming release? My team is desperately awaiting this on Metabase cloud to fix several issues we are having.', 'created_at': datetime.datetime(2024, 10, 17, 20, 40, 29, tzinfo=datetime.timezone.utc)}]","bshepherdson (Issue Creator) on (2024-09-03 19:24:18 UTC): * **#47587** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47587?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

jordanell on (2024-10-17 20:40:29 UTC): Are there any plans to get this into an upcoming release? My team is desperately awaiting this on Metabase cloud to fix several issues we are having.

"
2503578283,pull_request,closed,,upgrade webpack to address security issue,closes https://github.com/metabase/metabase/security/dependabot/158,uladzimirdev,2024-09-03 19:08:02+00:00,['uladzimirdev'],2024-09-06 17:42:31+00:00,2024-09-04 08:41:11+00:00,https://github.com/metabase/metabase/pull/47585,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2503559964,pull_request,closed,,"ü§ñ backported ""upgrade micromatch to address security issue""",#47571,github-automation-metabase,2024-09-03 18:57:54+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-09-03 19:52:42+00:00,2024-09-03 19:52:41+00:00,https://github.com/metabase/metabase/pull/47583,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2503539518,pull_request,closed,,Toggle series visibility from chart legend (pie charts),"Implements #2697 for pie charts ([product doc](https://www.notion.so/metabase/Let-users-hide-show-series-by-clicking-on-the-legend-90a5ec138b534f039136ea7f377252b8?pvs=4)) and effectively closes #2697

Allows to toggle series visibility from the chart legend by clicking the legend item dot (FWIW, series visibility set like that isn't meant to be persisted). Also, updates the `pie.rows` visualization setting widget to better distinguish its ""hide"" action from the new legend behavior (similarly to `graph.series_order` in cartesian charts)

### To verify

1. Create a multi-series chart (e.g., Count of Orders per Product Category)
2. Ensure you can click the legend dots to show/hide the slice
3. Ensure you can't hide the last slice
4. Ensure you can hide the ""Other"" slice
5. In chill mode, ensure you can manage slice order and related settings via the ""Data"" tab

### Demo

https://github.com/user-attachments/assets/b0a32d8c-0d3c-442a-98a4-40e973469dcb

",kulyk,2024-09-03 18:46:56+00:00,['kulyk'],2024-09-09 16:37:13+00:00,2024-09-09 16:37:11+00:00,https://github.com/metabase/metabase/pull/47581,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2327194118, 'issue_id': 2503539518, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 7e228527c9460e57eb630e60d353e85ea7d123a1...24969e9a95caf05551c2f196ccd5b205337e69c5.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/ChartWithLegend.jsx<br>frontend/src/metabase/visualizations/components/LegendHorizontal.jsx<br>frontend/src/metabase/visualizations/components/LegendItem.jsx<br>frontend/src/metabase/visualizations/components/LegendVertical.jsx<br>frontend/src/metabase/visualizations/components/legend/LegendItemDot.tsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingSeriesOrder.tsx<br>frontend/src/metabase/visualizations/echarts/pie/constants.ts<br>frontend/src/metabase/visualizations/echarts/pie/model/index.ts<br>frontend/src/metabase/visualizations/echarts/pie/model/types.ts<br>frontend/src/metabase/visualizations/echarts/pie/option.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/PieChart.tsx<br>frontend/src/metabase/visualizations/visualizations/PieChart/chart-definition.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/use-chart-events.ts |', 'created_at': datetime.datetime(2024, 9, 3, 18, 48, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2334103915, 'issue_id': 2503539518, 'author': 'kulyk', 'body': '@kdoh, thanks for the review, everything should be addressed now, please take another look üôè \r\n\r\nhttps://github.com/user-attachments/assets/442d5cb6-c9b4-49bb-858b-8464f4e127ee', 'created_at': datetime.datetime(2024, 9, 6, 13, 50, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2334814300, 'issue_id': 2503539518, 'author': 'kdoh', 'body': ""@kulyk The jumping is fixed but I'm still seeing alignment issues. Just checked on both Firefox Dev (my daily browser) and Safari and seeing the spacing issue still on my machine.\r\n\r\n![Screenshot 2024-09-06 at 5 08 26\u202fPM](https://github.com/user-attachments/assets/e637a8e9-80f0-4201-8d10-c2ddb633a354)"", 'created_at': datetime.datetime(2024, 9, 6, 21, 9, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2338414273, 'issue_id': 2503539518, 'author': 'kulyk', 'body': '@kdoh, the alignment should be fixed now, please take a look üôè Thanks!\r\n\r\n![CleanShot 2024-09-09 at 16 20 47@2x](https://github.com/user-attachments/assets/4afdda13-28a4-4440-9908-28a795ce010a)', 'created_at': datetime.datetime(2024, 9, 9, 15, 21, 5, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-03 18:48:25 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 7e228527c9460e57eb630e60d353e85ea7d123a1...24969e9a95caf05551c2f196ccd5b205337e69c5.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/ChartWithLegend.jsx<br>frontend/src/metabase/visualizations/components/LegendHorizontal.jsx<br>frontend/src/metabase/visualizations/components/LegendItem.jsx<br>frontend/src/metabase/visualizations/components/LegendVertical.jsx<br>frontend/src/metabase/visualizations/components/legend/LegendItemDot.tsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingSeriesOrder.tsx<br>frontend/src/metabase/visualizations/echarts/pie/constants.ts<br>frontend/src/metabase/visualizations/echarts/pie/model/index.ts<br>frontend/src/metabase/visualizations/echarts/pie/model/types.ts<br>frontend/src/metabase/visualizations/echarts/pie/option.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/PieChart.tsx<br>frontend/src/metabase/visualizations/visualizations/PieChart/chart-definition.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/use-chart-events.ts |

kulyk (Issue Creator) on (2024-09-06 13:50:19 UTC): @kdoh, thanks for the review, everything should be addressed now, please take another look üôè 

https://github.com/user-attachments/assets/442d5cb6-c9b4-49bb-858b-8464f4e127ee

kdoh on (2024-09-06 21:09:20 UTC): @kulyk The jumping is fixed but I'm still seeing alignment issues. Just checked on both Firefox Dev (my daily browser) and Safari and seeing the spacing issue still on my machine.

![Screenshot 2024-09-06 at 5 08 26‚ÄØPM](https://github.com/user-attachments/assets/e637a8e9-80f0-4201-8d10-c2ddb633a354)

kulyk (Issue Creator) on (2024-09-09 15:21:05 UTC): @kdoh, the alignment should be fixed now, please take a look üôè Thanks!

![CleanShot 2024-09-09 at 16 20 47@2x](https://github.com/user-attachments/assets/4afdda13-28a4-4440-9908-28a795ce010a)

"
2503487961,pull_request,closed,,"ü§ñ backported ""Don't update updated_at when setting last_used_at on a card""",#47574,github-automation-metabase,2024-09-03 18:19:21+00:00,"['noahmoss', 'github-automation-metabase']",2024-09-03 19:10:20+00:00,2024-09-03 19:10:19+00:00,https://github.com/metabase/metabase/pull/47580,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2503408894,pull_request,closed,,"ü§ñ backported ""docs - note on DuckDB""",#47577,github-automation-metabase,2024-09-03 17:30:41+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-09-03 17:32:14+00:00,2024-09-03 17:32:13+00:00,https://github.com/metabase/metabase/pull/47578,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2503397450,pull_request,closed,,docs - note on DuckDB,"For now, DuckDB driver is only available for self-hosted Metabases.
",jeff-bruemmer,2024-09-03 17:24:04+00:00,['jeff-bruemmer'],2024-09-03 17:32:48+00:00,2024-09-03 17:29:49+00:00,https://github.com/metabase/metabase/pull/47577,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2503379379,pull_request,closed,,Don't update updated_at when setting last_used_at on a card,"A Card's `updated_at` value is used to compute the hash for identifying a user's sandboxed field values. If this hash changes, the field values cache is invalidated and we need to fetch field values again.

There are a couple places where we're needlessly updating `updated_at` in the course of a Card's execution when no updates to the Card definition are actually taking place:
* When setting `last_used_at`
* When updating `result_metadata`

This causes the field values cache to be invalidated essentially every time a dashboard loads. I've fixed these spots in this PR and added tests to ensure that they don't update `:updated_at`.",noahmoss,2024-09-03 17:12:54+00:00,['noahmoss'],2024-09-03 19:10:46+00:00,2024-09-03 18:18:31+00:00,https://github.com/metabase/metabase/pull/47574,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2327038926, 'issue_id': 2503379379, 'author': 'noahmoss', 'body': '* **#47574** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47574?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 9, 3, 17, 13, 11, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-09-03 17:13:11 UTC): * **#47574** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47574?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2503349053,pull_request,closed,,"ü§ñ backported ""Add v0.49.25 to the list of releases""",#47572,github-automation-metabase,2024-09-03 16:54:24+00:00,"['alexyarosh', 'github-automation-metabase']",2024-09-03 16:55:58+00:00,2024-09-03 16:55:57+00:00,https://github.com/metabase/metabase/pull/47573,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2503336881,pull_request,closed,,Add v0.49.25 to the list of releases,Like it says on the tin üòÅ,github-automation-metabase,2024-09-03 16:47:10+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-09-03 16:56:23+00:00,2024-09-03 16:53:36+00:00,https://github.com/metabase/metabase/pull/47572,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2503334376,pull_request,closed,,upgrade micromatch to address security issue,"closes https://github.com/metabase/metabase/security/dependabot/155
closes https://github.com/metabase/metabase/security/dependabot/156",uladzimirdev,2024-09-03 16:45:39+00:00,['uladzimirdev'],2024-09-03 19:53:09+00:00,2024-09-03 18:57:03+00:00,https://github.com/metabase/metabase/pull/47571,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2503241661,pull_request,closed,,feat(sdk): support `locale` prop on `MetabaseProvider`,"Related to https://github.com/metabase/metabase/issues/47533

I left code comments and github comments on the pr so it should be self-explanatory",npretto,2024-09-03 15:56:51+00:00,['npretto'],2024-10-08 16:13:40+00:00,2024-10-03 14:28:08+00:00,https://github.com/metabase/metabase/pull/47569,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2326882886, 'issue_id': 2503241661, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@npretto You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 9, 3, 15, 57, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2391174161, 'issue_id': 2503241661, 'author': 'npretto', 'body': ""@WiNloSt can you check if the CORS issue you've having is caused/made worse by this PR?"", 'created_at': datetime.datetime(2024, 10, 3, 11, 24, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2391189395, 'issue_id': 2503241661, 'author': 'WiNloSt', 'body': ""> @WiNloSt can you check if the CORS issue you've having is caused/made worse by this PR?\r\n\r\n@npretto It works for me now that this PR doesn't include the BE change.\r\n\r\n![image](https://github.com/user-attachments/assets/625ea2b6-c107-4210-bc03-7f25a190954a)"", 'created_at': datetime.datetime(2024, 10, 3, 11, 31, 38, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-03 15:57:12 UTC): <!---conventional commit reminder comment ID-->
@npretto You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

npretto (Issue Creator) on (2024-10-03 11:24:37 UTC): @WiNloSt can you check if the CORS issue you've having is caused/made worse by this PR?

WiNloSt on (2024-10-03 11:31:38 UTC): @npretto It works for me now that this PR doesn't include the BE change.

![image](https://github.com/user-attachments/assets/625ea2b6-c107-4210-bc03-7f25a190954a)

"
2503175957,pull_request,closed,,"ü§ñ backported ""[MBQL lib] Allow temporal bucketing of Date(Time) expressions""","  #47427
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-03 15:28:51+00:00,"['bshepherdson', 'github-automation-metabase']",2024-09-03 21:49:26+00:00,2024-09-03 21:49:25+00:00,https://github.com/metabase/metabase/pull/47568,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2502886255,pull_request,closed,,Recent metrics,"Closes https://github.com/metabase/metabase/issues/47383

This PR is a follow up for https://github.com/metabase/metabase/pull/47391, merge that first.

### Description

Show recent metrics on the Browse metrics page.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. Make sure you have some existing metrics (more than 9)
2. Visit `/browse/metrics`
3. Recent metrics should show up

### Demo
<img width=""1474"" alt=""Screenshot 2024-09-03 at 15 27 02"" src=""https://github.com/user-attachments/assets/37955921-4cc5-4bc5-af1b-41234b0f2873"">

",romeovs,2024-09-03 13:27:07+00:00,['romeovs'],2024-09-09 16:51:12+00:00,2024-09-09 16:51:11+00:00,https://github.com/metabase/metabase/pull/47557,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2338606185, 'issue_id': 2502886255, 'author': 'romeovs', 'body': 'Closing this for now as we will be taking a different approach', 'created_at': datetime.datetime(2024, 9, 9, 16, 51, 12, tzinfo=datetime.timezone.utc)}]","romeovs (Issue Creator) on (2024-09-09 16:51:12 UTC): Closing this for now as we will be taking a different approach

"
2502619757,pull_request,closed,,"ü§ñ backported ""[serdes] reveal exception causes""",#47551,github-automation-metabase,2024-09-03 11:23:48+00:00,"['piranha', 'github-automation-metabase']",2024-09-03 12:15:19+00:00,2024-09-03 12:15:18+00:00,https://github.com/metabase/metabase/pull/47556,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2502454073,pull_request,closed,,Rename 'Date Filter' to 'All Options' in field filters,"Following a [Slack thread](https://metaboat.slack.com/archives/C01LQQ2UW03/p1725044483092269):

> When selecting a type of date filter for a dashboard filter, there's an ""All Options"" option. When selecting the type of the filter widget for a field filter, the option that produces the same type of widget is called ""Date Filter"" instead (other options are called the same).
>
> Could we rename this option for the field filter to also be ""All Options""? For consistency, but also because ""Date Filter"" is overloaded already and it becomes confusing (is someone saying ""date filter"" referring to a basic filter but with date variable type, or field filter with ""date filter"" widget type?...)

This PR does just that.

### To verify

1. New ‚Üí SQL Query
2. `SELECT {{ x }}`
3. Change the variable type to `Field Filter` ‚Üí `Accounts` ‚Üí `Created At`
4. Change `Filter widget type` and make sure the `All Options` dropdown item exists",romeovs,2024-09-03 10:04:14+00:00,['romeovs'],2024-10-08 16:15:30+00:00,2024-09-05 07:26:06+00:00,https://github.com/metabase/metabase/pull/47553,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2502315855,pull_request,closed,,[serdes] reveal exception causes,"I still don't want users' eyes to bleed looking at (unnecessary?) stacktraces, but we need to be able to see exception causes to determine what is going wrong

references #47520
",piranha,2024-09-03 09:01:19+00:00,['piranha'],2024-09-03 12:15:52+00:00,2024-09-03 11:23:01+00:00,https://github.com/metabase/metabase/pull/47551,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2502105182,pull_request,closed,,"ü§ñ backported ""Use app DB for query execution metrics""","  #46586
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-03 07:15:44+00:00,"['piranha', 'github-automation-metabase']",2024-09-03 08:49:00+00:00,2024-09-03 08:49:00+00:00,https://github.com/metabase/metabase/pull/47549,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2501645538,pull_request,closed,,"ü§ñ backported ""Implement a simple greedy approximation for dedupe-joins""",#47529,github-automation-metabase,2024-09-02 22:34:59+00:00,"['metamben', 'github-automation-metabase']",2024-09-03 19:03:43+00:00,2024-09-03 19:03:42+00:00,https://github.com/metabase/metabase/pull/47548,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2501628217,pull_request,closed,,feat(sdk): Add chart viz selection for `InteractiveQuestion`,,oisincoveney,2024-09-02 22:09:11+00:00,['oisincoveney'],2024-09-06 22:42:49+00:00,2024-09-06 22:42:49+00:00,https://github.com/metabase/metabase/pull/47546,"[('.Team/Embedding', '')]",[],
2501558473,pull_request,closed,,docs: clarify cumulative aggregations,[see slack thread](https://metaboat.slack.com/archives/C01R1JY03J4/p1725300174850099),alexyarosh,2024-09-02 20:35:17+00:00,['alexyarosh'],2024-10-01 22:20:17+00:00,2024-09-04 23:56:57+00:00,https://github.com/metabase/metabase/pull/47545,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2327635240, 'issue_id': 2501558473, 'author': 'alexyarosh', 'body': '@jeff-bruemmer I consolidated the articles and the images. A bit concerned about redirects still because the links in product are to specific version docs rather than latest', 'created_at': datetime.datetime(2024, 9, 3, 23, 43, 43, tzinfo=datetime.timezone.utc)}]","alexyarosh (Issue Creator) on (2024-09-03 23:43:43 UTC): @jeff-bruemmer I consolidated the articles and the images. A bit concerned about redirects still because the links in product are to specific version docs rather than latest

"
2501538483,pull_request,closed,,fix: sqlserver handle uniqueidentifier uuids,"Fixes #46148

Include sqlserver in `uuid-type` handling as its `uniqueidentifier` type stores uuids.
",snoe,2024-09-02 20:12:32+00:00,['snoe'],2024-09-04 22:31:27+00:00,2024-09-04 22:31:26+00:00,https://github.com/metabase/metabase/pull/47544,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Drivers', '')]",[],
2501526639,pull_request,closed,,Add CardDisplayType type to narrow values for charts,Adds some strings to the `CardDisplayType` so that we can have some TS autocomplete when we're working with Visualization types. I've post-fixed the type with `string & unknown` since I am under the impression that we allow custom chart identifiers. Let me know if that's totally false - if that's the case then we can just remove that part of the type.,oisincoveney,2024-09-02 19:59:10+00:00,['oisincoveney'],2024-10-08 16:15:21+00:00,2024-09-05 21:51:50+00:00,https://github.com/metabase/metabase/pull/47543,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2325341518, 'issue_id': 2501526639, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 42394d2737a3684abe936c383a9f59c01e9897cd...000982243cd04558d979d6ce1a30d0e99df12119.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/skeletons/ChartSkeleton/ChartSkeleton.unit.spec.tsx<br>frontend/src/metabase/visualizations/index.ts<br>frontend/src/metabase/visualizations/shared/utils/sizes.ts<br>frontend/src/metabase/visualizations/types/visualization.ts |', 'created_at': datetime.datetime(2024, 9, 2, 22, 16, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2327555483, 'issue_id': 2501526639, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@oisincoveney You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 9, 3, 22, 32, 43, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-02 22:16:46 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 42394d2737a3684abe936c383a9f59c01e9897cd...000982243cd04558d979d6ce1a30d0e99df12119.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/skeletons/ChartSkeleton/ChartSkeleton.unit.spec.tsx<br>frontend/src/metabase/visualizations/index.ts<br>frontend/src/metabase/visualizations/shared/utils/sizes.ts<br>frontend/src/metabase/visualizations/types/visualization.ts |

github-actions[bot] on (2024-09-03 22:32:43 UTC): <!---conventional commit reminder comment ID-->
@oisincoveney You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2501526446,pull_request,closed,,feat(sdk): Filter DataPicker models for `CreateQuestion`,"Adds filtering for the DataPicker by passing the `models` prop from the Notebook component into the `DataStep` component.

In terms of why this PR has a lot of files, I wanted to ensure that the props are accurately reflected in each ""passing down"" of the data, so that's why there's quite a few `Pick` statements and things like that. They won't affect the functionality at all, but if we do decide to add a new type to the filter, then we will immediately know if there's a type issue",oisincoveney,2024-09-02 19:58:56+00:00,['oisincoveney'],2024-10-08 16:14:27+00:00,2024-09-25 16:30:02+00:00,https://github.com/metabase/metabase/pull/47542,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2334569767, 'issue_id': 2501526446, 'author': 'oisincoveney', 'body': ""@metabase/core-frontend-querying - Since this is more or less in your realm, it might make more sense for y'all to review this. Basically, the only thing SDK-related in this code is passing the `models` prop to the QB notebook"", 'created_at': datetime.datetime(2024, 9, 6, 18, 3, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2334782431, 'issue_id': 2501526446, 'author': 'oisincoveney', 'body': '> Should we consider adding a context? I don\'t think we should drill down props like this.\r\n> \r\n> Btw - the types are off in terms of what type depends on which, but this would be reverted if we add a context.\r\n\r\ntotally up for a context üòÑ I didn\'t want to get to ""context-happy"" for this change, but if you also think it makes sense then let\'s do it', 'created_at': datetime.datetime(2024, 9, 6, 20, 43, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2373312222, 'issue_id': 2501526446, 'author': 'oisincoveney', 'body': '> 1. [""table"", ""card"", ""dataset"", ""metric""]\r\n\r\nAh, I see what you mean - instead of including `metric` when we have \'hasMetrics=true\' we should just exclude `metric` when \'hasMetrics=false\'?\r\n\r\nIf that\'s the case then I\'ve pushed that change - I\'ll merge it after one final confirmation later today when you\'re awake üòÑ', 'created_at': datetime.datetime(2024, 9, 25, 7, 45, 9, tzinfo=datetime.timezone.utc)}]","oisincoveney (Issue Creator) on (2024-09-06 18:03:17 UTC): @metabase/core-frontend-querying - Since this is more or less in your realm, it might make more sense for y'all to review this. Basically, the only thing SDK-related in this code is passing the `models` prop to the QB notebook

oisincoveney (Issue Creator) on (2024-09-06 20:43:36 UTC): totally up for a context üòÑ I didn't want to get to ""context-happy"" for this change, but if you also think it makes sense then let's do it

oisincoveney (Issue Creator) on (2024-09-25 07:45:09 UTC): Ah, I see what you mean - instead of including `metric` when we have 'hasMetrics=true' we should just exclude `metric` when 'hasMetrics=false'?

If that's the case then I've pushed that change - I'll merge it after one final confirmation later today when you're awake üòÑ

"
2501524410,pull_request,closed,,Migrate Chart Type Selectors to mantine,Converts Chart Type Sidebar selectors to mantine. This will hopefully make theming easier when we use these components in the SDK.,oisincoveney,2024-09-02 19:56:38+00:00,['oisincoveney'],2024-09-06 18:08:39+00:00,2024-09-06 18:08:39+00:00,https://github.com/metabase/metabase/pull/47541,"[('.Team/Embedding', '')]","[{'comment_id': 2325286207, 'issue_id': 2501524410, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 723357adfe3fcc9b59c47b2baa715882ff3755b8...f8feddc9bfd7542ebb96394c9c8b9ee02ae7a239.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/buttons/ActionIcon/ActionIcon.styled.tsx<br>frontend/src/metabase/ui/components/utils/Space/index.ts<br>frontend/src/metabase/ui/components/utils/index.ts |', 'created_at': datetime.datetime(2024, 9, 2, 20, 43, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2334577799, 'issue_id': 2501524410, 'author': 'oisincoveney', 'body': 'closing since #47706 is a better rendition of this', 'created_at': datetime.datetime(2024, 9, 6, 18, 8, 39, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-02 20:43:50 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 723357adfe3fcc9b59c47b2baa715882ff3755b8...f8feddc9bfd7542ebb96394c9c8b9ee02ae7a239.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/buttons/ActionIcon/ActionIcon.styled.tsx<br>frontend/src/metabase/ui/components/utils/Space/index.ts<br>frontend/src/metabase/ui/components/utils/index.ts |

oisincoveney (Issue Creator) on (2024-09-06 18:08:39 UTC): closing since #47706 is a better rendition of this

"
2501522712,pull_request,closed,,Fix text alignment for dashboard text card,"Closes https://github.com/metabase/metabase/issues/46078

### Description

Fixes an accidental change from `align-end` to `align-start` [here](https://github.com/metabase/metabase/pull/40457/commits/2fdb4fbea9717c1bcca1479175e0777397e29805#diff-a2ba33a5dd0199912039c945da46e149555b84243e5653ee32d017f04643d684R23)

I haven't added any tests here - I'm not sure if there would be any intent to test this behaviour.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. Create a new dashboard
2. Add a text card with some text
3. Change the Horizontal Alignment of the text card to ""Right""
4. The text should now display right-aligned.

### Demo

Screenshot of before:
<img width=""1209"" alt=""Screenshot 2024-09-02 at 20 49 48"" src=""https://github.com/user-attachments/assets/d2a3a7bd-f28b-4827-b549-907f0835d50c"">

Screenshot of after:
<img width=""1209"" alt=""Screenshot 2024-09-02 at 20 50 20"" src=""https://github.com/user-attachments/assets/588cca81-afdb-431e-8312-8410be290220"">


### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",amardatar,2024-09-02 19:54:42+00:00,[],2024-09-18 06:38:51+00:00,2024-09-17 18:31:02+00:00,https://github.com/metabase/metabase/pull/47540,"[('backport', 'Automatically create PR on current release branch on merge'), ('External', 'PR from an external contributor.')]","[{'comment_id': 2356623845, 'issue_id': 2501522712, 'author': 'nemanjaglumac', 'body': 'Thank you for the contribution @amardatar \r\nNice catch!', 'created_at': datetime.datetime(2024, 9, 17, 18, 29, 38, tzinfo=datetime.timezone.utc)}]","nemanjaglumac on (2024-09-17 18:29:38 UTC): Thank you for the contribution @amardatar 
Nice catch!

"
2501511814,pull_request,closed,,Remove phantom tooltips when there is no label on tooltip,"Closes #47515 

Ensures that tooltips don't appear when there is no label accompanying them. Currently we're running into issues where a tooltip will appear with no text and it just looks bad: 


![image](https://github.com/user-attachments/assets/93e3cef7-1c0b-4025-aff9-09dacbeb35e7)



Now, we've removed those by adding a `disabled` prop on the tooltips when no label exists. I've added this logic for the left and right icon tooltips on the (now deprecated) `Input` component.",oisincoveney,2024-09-02 19:42:41+00:00,['oisincoveney'],2024-09-03 21:39:32+00:00,2024-09-03 21:39:30+00:00,https://github.com/metabase/metabase/pull/47539,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2501411364,pull_request,closed,,fix(sdk): Add `onSave` behavior to `QuestionEditor`,Adds an `onSave` prop to the `QuestionEditor`,oisincoveney,2024-09-02 18:06:23+00:00,['oisincoveney'],2024-10-08 16:15:37+00:00,2024-09-03 21:39:48+00:00,https://github.com/metabase/metabase/pull/47538,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2501331658,pull_request,closed,,Convert Chart Type Visualization buttons to Mantine,"> [!IMPORTANT]
> For those employed by Metabase: if you are merging into master, please add either a `backport` or a `no-backport` label to this PR. You will not be able to merge until you do this step. Refer to the section [Do I need to backport this PR?](https://www.notion.so/metabase/Metabase-Branching-Strategy-6eb577d5f61142aa960a626d6bbdfeb3?pvs=4#89f80d6f17714a0198aeb66c0efd1b71) in the Metabase Branching Strategy document for more details. If you're not employed by Metabase, this section does not apply to you, and the label will be taken care of by your reviewer.

> **Warning**
>
> If that is your first contribution to Metabase, please sign the [Contributor License Agreement](https://docs.google.com/a/metabase.com/forms/d/1oV38o7b9ONFSwuzwmERRMi9SYrhYeOrkbmNaq9pOJ_E/viewform) (unless it's a tiny documentation change). Also, if you're attempting to fix a translation issue, please submit your changes to our [POEditor project](https://poeditor.com/join/project/ynjQmwSsGh) instead of opening a PR.

Closes https://github.com/metabase/metabase/issues/[issue_number]

### Description

Describe the overall approach and the problem being solved.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. New question -> Sample Dataset -> ...
2. ...

### Demo

_Upload a demo video or before/after screenshots if sensible or remove the section_

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",oisincoveney,2024-09-02 16:47:58+00:00,['oisincoveney'],2024-09-27 14:57:37+00:00,2024-09-27 14:57:36+00:00,https://github.com/metabase/metabase/pull/47534,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2325094880, 'issue_id': 2501331658, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@oisincoveney You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 9, 2, 16, 48, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2379473880, 'issue_id': 2501331658, 'author': 'oisincoveney', 'body': 'this branch is outdated, closing', 'created_at': datetime.datetime(2024, 9, 27, 14, 57, 36, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-02 16:48:18 UTC): <!---conventional commit reminder comment ID-->
@oisincoveney You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

oisincoveney (Issue Creator) on (2024-09-27 14:57:36 UTC): this branch is outdated, closing

"
2501249834,pull_request,closed,,"ü§ñ backported ""Disallow duplicate order-by clauses in ::lib.schema.order-by/order-bys""","  #47489
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-02 15:45:48+00:00,"['appleby', 'github-automation-metabase']",2024-09-02 22:17:38+00:00,2024-09-02 22:17:37+00:00,https://github.com/metabase/metabase/pull/47532,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2501163797,pull_request,closed,,"ü§ñ backported ""Use consistent approach for disabling permission checks in QP to fix sandboxing error in downloads""",#47481,github-automation-metabase,2024-09-02 14:55:11+00:00,"['noahmoss', 'github-automation-metabase']",2024-09-02 19:04:18+00:00,2024-09-02 19:04:17+00:00,https://github.com/metabase/metabase/pull/47530,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2501114702,pull_request,closed,,Implement a simple greedy approximation for dedupe-joins,"Closes https://github.com/metabase/metabase/issues/46905

### Description

The original `dedupe-joins` function found optimal solutions but had exponential runtime, so people could create enough linked filters to make Metabase hang for a long time.

I implemented a very simple greedy algorithm that might deliver suboptimal solutions, but should be fast enough for normal number of filters.

### How to verify

See the unit tests, one of which is the case from #46905.
",metamben,2024-09-02 14:31:12+00:00,['metamben'],2024-09-02 22:34:13+00:00,2024-09-02 22:34:10+00:00,https://github.com/metabase/metabase/pull/47529,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2325311292, 'issue_id': 2501114702, 'author': 'metamben', 'body': ""> You forgot to humble-brag about the sweet sweet benchmark speedups here üòâ . The following joins now take < 1ms, down from [6.3 minutes in the old code](https://github.com/metabase/metabase/issues/46905#issuecomment-2292483873) according to the linked issue!\r\n\r\nI mentioned that the old function would take ages to give a solution. On the other hand, I don't have much to brag about, I'm solving a much easier problem (and I didn't optimize the solution)."", 'created_at': datetime.datetime(2024, 9, 2, 21, 22, 49, tzinfo=datetime.timezone.utc)}]","metamben (Issue Creator) on (2024-09-02 21:22:49 UTC): I mentioned that the old function would take ages to give a solution. On the other hand, I don't have much to brag about, I'm solving a much easier problem (and I didn't optimize the solution).

"
2501011074,pull_request,closed,,Add embedding SDK admin settings tests,"Closes https://github.com/metabase/metabase/issues/47501

### Description

Add embedding SDK card unit tests. Please note that the in-card toggle isn't implemented yet, and some of the spec that ties to the new settings not yet added aren't here. Also, the CORS origin input isn't disabled when the embedding is disabled because it's supposed to be disabled when the new `enable-embedding-sdk` is introduced.

This PR adds some missing static embed tests and new embedding SDK card tests and its settings page.

There are only input tests in the settings page, and it's only enabled on EE with `embedding` token (until `embedding-sdk` is added).

The logic to disable when `enable-embedding-sdk: false` will be added once the settings is introduced in the next PR.

### How to verify

All unit tests pass.


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",WiNloSt,2024-09-02 13:39:59+00:00,['WiNloSt'],2024-09-04 14:24:00+00:00,2024-09-04 14:23:58+00:00,https://github.com/metabase/metabase/pull/47519,"[('.Team/Embedding', '')]",[],
2500978692,pull_request,closed,,Fix migration ID of metabase_database.is_attached_dwh for backport,"This migration is supposed to be backported to v50 and thus needs a v50
migration ID.  Since v51.2024-08-27T00:00:00 was already applied to dev
instances, we set `preConditions[].onFail = ""MARK_RAN""`, so that if the
table is already present, the backdated migration does not fail.  See
the discussion on PR #47419 for more details.

This will not need an (automatic) backport, since I will include it in
PR #47419.

Fixes: 592360c9fae73c2b4bd92dd99c28bb8637de283c
References: https://github.com/metabase/metabase/pull/47419#discussion_r1738929516
",devurandom,2024-09-02 13:24:53+00:00,['devurandom'],2024-09-03 13:21:16+00:00,2024-09-03 13:21:14+00:00,https://github.com/metabase/metabase/pull/47517,"[('no-backport', 'Do not backport this PR to any branch')]",[],
2500957238,pull_request,closed,,"ü§ñ backported ""Use table name in inactive table error if user has access to it""",#47484,github-automation-metabase,2024-09-02 13:15:31+00:00,"['noahmoss', 'github-automation-metabase']",2024-09-03 19:41:09+00:00,2024-09-03 19:41:08+00:00,https://github.com/metabase/metabase/pull/47516,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2500806583,pull_request,closed,,Refine 'last' version logic,"

### Description

On friday, our [automation messed up](https://metaboat.slack.com/archives/C864UT5CZ/p1725064243922599) and tried to re-release an already-released patch version: `v50.23.1` This was because I changed the ""last version"" logic in https://github.com/metabase/metabase/pull/47377 to ignore patches when determining the ""last"" release. The problem is, for some purposes we want to ignore patches and some, we don't. So I introduced an ""ignorePatches"" flag to account for this. Now:

- when we want to find the last major/minor version release (like when we want to find all commits since the last set of release notes went out) we pass the `ignorePatches` flag
- when we want the last release of any kind, like when we want to calculate the version number for the next nightly patch, the `ignorePatches` flag defaults to false

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-09-02 12:09:13+00:00,['iethree'],2024-10-08 16:15:40+00:00,2024-09-03 13:09:03+00:00,https://github.com/metabase/metabase/pull/47512,"[('.Building & Releasing', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2500763281,pull_request,closed,,"backport ""[serdes] a bit more valuable ns docstring""","Backport of #47445, #47499",piranha,2024-09-02 11:48:46+00:00,['piranha'],2024-09-02 15:21:35+00:00,2024-09-02 15:21:34+00:00,https://github.com/metabase/metabase/pull/47511,"[('.Team/Workflows', 'aka BEC'), ('was-backported', 'apply this to PRs that are themselves backports')]",[],
2500756408,pull_request,closed,,Remove more metabse settings,"part of #47565

### Description

Removes more usages of the long-deprecated `MetabseSettings`. No functional changes

",iethree,2024-09-02 11:45:35+00:00,['iethree'],2024-10-08 16:14:46+00:00,2024-09-12 18:38:58+00:00,https://github.com/metabase/metabase/pull/47510,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2324555057, 'issue_id': 2500756408, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 0435633e7074e7f99af38460e701cb2ce739d17f...1b42d2515fb642c627aaf75abd80aced865f6381.\n\n| Notify | File(s) |\n|-|-|\n| @ranquild | frontend/src/metabase/home/components/HomeHelpCard/HomeHelpCard.tsx<br>frontend/src/metabase/setup/components/CloudMigrationHelp/CloudMigrationHelp.tsx |', 'created_at': datetime.datetime(2024, 9, 2, 11, 47, 1, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-02 11:47:01 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 0435633e7074e7f99af38460e701cb2ce739d17f...1b42d2515fb642c627aaf75abd80aced865f6381.

| Notify | File(s) |
|-|-|
| @ranquild | frontend/src/metabase/home/components/HomeHelpCard/HomeHelpCard.tsx<br>frontend/src/metabase/setup/components/CloudMigrationHelp/CloudMigrationHelp.tsx |

"
2500729053,pull_request,closed,,"ü§ñ backported ""Followup on ""Fix crash when navigating between bookmarked dashboards""""","  #47400
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-02 11:33:19+00:00,"['kulyk', 'github-automation-metabase']",2024-09-04 11:14:00+00:00,2024-09-04 11:13:58+00:00,https://github.com/metabase/metabase/pull/47509,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2328626122, 'issue_id': 2500729053, 'author': 'kulyk', 'body': 'Will be backported in #47612', 'created_at': datetime.datetime(2024, 9, 4, 11, 13, 58, tzinfo=datetime.timezone.utc)}]","kulyk (Assginee) on (2024-09-04 11:13:58 UTC): Will be backported in #47612

"
2500654773,pull_request,closed,,Update SDK version to 0.1.34,Update Readme version references and published npm package version to 0.1.34,github-automation-metabase,2024-09-02 10:58:27+00:00,"['heypoom', 'github-automation-metabase']",2024-10-08 16:15:44+00:00,2024-09-02 11:03:11+00:00,https://github.com/metabase/metabase/pull/47508,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2324451262, 'issue_id': 2500654773, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 9, 2, 11, 2, 53, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-09-02 11:02:53 UTC): <!---conventional commit reminder comment ID-->
@github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2500646915,pull_request,closed,,"ü§ñ backported ""Use original display name for fields in uploaded tables""",#47303,github-automation-metabase,2024-09-02 10:54:30+00:00,"['crisptrutski', 'github-automation-metabase']",2024-09-02 12:16:58+00:00,2024-09-02 12:16:57+00:00,https://github.com/metabase/metabase/pull/47507,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2500530755,pull_request,closed,,Remove useMemo from tabs computation,"Closes #47502

### Description

Addresses feedback about unnecessary `useMemo`: https://github.com/metabase/metabase/pull/47309#discussion_r1738880979

Initially I wanted to extract `getTabs` function in `EntityPickerModal` and `DataPickerModal`, but it's not great and produces many changes (many imports + many props need to be passed)
Instead, I removed `useMemo` and used IIFEs in these 2 cases. Diff is simple now.


### How to verify

App should work the same. CI is green.",kamilmielnik,2024-09-02 09:58:34+00:00,['kamilmielnik'],2024-09-09 07:26:54+00:00,2024-09-09 07:26:51+00:00,https://github.com/metabase/metabase/pull/47505,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2500529860,pull_request,closed,,"ü§ñ backported ""Use function arguments rather than a dynamic var""","  #47469
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-09-02 09:58:07+00:00,"['crisptrutski', 'github-automation-metabase']",2024-09-02 11:19:31+00:00,2024-09-02 11:19:30+00:00,https://github.com/metabase/metabase/pull/47504,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2500493532,pull_request,closed,,"ü§ñ backported ""Simplify finding metrics in Summarize""","#46887

Had to manually rewrite test since the legacy metrics and the metrics v2 tests differed so much. ",github-automation-metabase,2024-09-02 09:40:53+00:00,"['romeovs', 'github-automation-metabase']",2024-09-03 16:29:16+00:00,2024-09-03 16:29:14+00:00,https://github.com/metabase/metabase/pull/47503,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2500331408,pull_request,closed,,[serdes] fix grammar mistakes in the doc,"I don't know what happened in #47445, because I've added Tim's suggestion to a batch, clicked ""commit batch"" and then... IDK?",piranha,2024-09-02 08:25:21+00:00,['piranha'],2024-10-08 16:15:46+00:00,2024-09-02 08:59:53+00:00,https://github.com/metabase/metabase/pull/47499,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2500273851,pull_request,closed,,Upgrade Macaw to 0.2.10,"Includes https://github.com/metabase/macaw/pull/97, which will prevent some false positives",tsmacdonald,2024-09-02 07:58:29+00:00,['tsmacdonald'],2024-10-08 16:15:47+00:00,2024-09-02 08:49:52+00:00,https://github.com/metabase/metabase/pull/47498,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2500025779,pull_request,closed,,Change duration to duration_ms,"### Description

Our current schema had the issue that `duration` was marked as required field even though it did not exist (`duration_ms` existed instead). This updates the schema to match the version we have deployed.

Note that the diff looks a bit crazy because of the different order but there are 2 things fixed:

* `duartion` -> `duration_ms`
* `version`: This one was wrongly still at `1-0-0` and was updated to `1-0-1`",Somtom,2024-09-02 05:22:46+00:00,['Somtom'],2024-12-19 10:35:36+00:00,2024-12-19 10:35:36+00:00,https://github.com/metabase/metabase/pull/47496,[],[],
2498760866,pull_request,closed,,"ü§ñ backported ""perf: Optimize insights and fingerprinting of time series""",#47414,github-automation-metabase,2024-08-31 09:57:25+00:00,"['alexander-yakushev', 'github-automation-metabase']",2024-08-31 10:48:19+00:00,2024-08-31 10:48:18+00:00,https://github.com/metabase/metabase/pull/47491,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2498655142,pull_request,closed,,"ü§ñ backported ""Bugfix part2 snowflake variants in attachments 46981""",#47488,github-automation-metabase,2024-08-31 05:58:18+00:00,"['adam-james-v', 'github-automation-metabase']",2024-08-31 14:40:47+00:00,2024-08-31 14:40:46+00:00,https://github.com/metabase/metabase/pull/47490,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2498546996,pull_request,closed,,Disallow duplicate order-by clauses in ::lib.schema.order-by/order-bys,"Closes https://github.com/metabase/metabase/issues/39384

### Description

1. Update `::lib.schema.order-by/order-bys` to reject duplicate order-by clauses, ignoring uuids.
2. Move `query-processor.util/remove-lib-uuids` to `lib.schema.util`
3. Fix a couple of pre-existing tests that were using duplicate order-bys in remove_replace_test.cljc
4. Add a bunch of tests

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",appleby,2024-08-31 01:47:58+00:00,['appleby'],2024-09-02 15:45:04+00:00,2024-09-02 15:45:03+00:00,https://github.com/metabase/metabase/pull/47489,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2498459818,pull_request,closed,,Bugfix part2 snowflake variants in attachments 46981,"Fixes #46981

I was walking home from lunch and had a mundane yet useful realization, a mild epiphany, if you will. 
The fix for Snowflake Variants breaking downloads in this PR: https://github.com/metabase/metabase/pull/47434

Missed the xlsx export code path. This PR uses the same approach to fix that, and provides a test to confirm.",adam-james-v,2024-08-31 00:21:24+00:00,['adam-james-v'],2024-08-31 05:57:30+00:00,2024-08-31 05:57:30+00:00,https://github.com/metabase/metabase/pull/47488,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2498227446,pull_request,closed,,"ü§ñ backported ""fix prepare-containers action""","  #47480
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-30 21:53:36+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-09-02 07:08:08+00:00,2024-09-02 07:08:03+00:00,https://github.com/metabase/metabase/pull/47485,[],"[{'comment_id': 2323973690, 'issue_id': 2498227446, 'author': 'uladzimirdev', 'body': ""not needed as the problematic PR wasn't backported"", 'created_at': datetime.datetime(2024, 9, 2, 7, 8, 3, tzinfo=datetime.timezone.utc)}]","uladzimirdev (Assginee) on (2024-09-02 07:08:03 UTC): not needed as the problematic PR wasn't backported

"
2498198801,pull_request,closed,,Use table name in inactive table error if user has access to it,"If the user has data access to an inactive table (despite it being inactive), let's use it in the error message when they try to query it. If not, let's just use the table ID.",noahmoss,2024-08-30 21:30:54+00:00,['noahmoss'],2024-09-03 19:41:35+00:00,2024-09-02 13:14:39+00:00,https://github.com/metabase/metabase/pull/47484,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2322365203, 'issue_id': 2498198801, 'author': 'noahmoss', 'body': '* **#47484** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47484?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 30, 21, 31, 10, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-08-30 21:31:10 UTC): * **#47484** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47484?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2498135891,pull_request,closed,,Catch Errors in Download process and only write error message,"Fixes Private [233](https://github.com/metabase/metabase-private/issues/233)

Dissoc parts from the error that might contain viz-settings.
Adds a test confirming that viz-settings are no longer included in the error that gets written to the file.",adam-james-v,2024-08-30 20:36:04+00:00,['adam-james-v'],2024-10-01 22:17:07+00:00,2024-09-05 18:57:53+00:00,https://github.com/metabase/metabase/pull/47482,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2498116666,pull_request,closed,,Use consistent approach for disabling permission checks in QP to fix sandboxing error in downloads,"There are several places in the query processor where we want to disable permission checks for a specific function call‚Äîsuch as preprocessing a query or getting its expected columns when applying sandboxing rules.

Previously this was being done inconsistently. Some spots were using `metabase.server.middleware.session/as-admin` which just binds `api/*is-superuser?*` to `true`. Other spots were just binding `api/*current-user-id*` to `nil` to override the current user. 

Binding `*current-user-id*` doesn't work well for this purpose post-v50 permissions refactor, especially with the new perms caching mechanism. This is the root cause of https://github.com/metabase/metabase/issues/47478: sandboxing middleware recursively processes the query with `*current-user-id*` set to `nil`. This hits the `apply-download-limit` middleware which is a preprocessing middleware, unlike the normal perms middleware which is an execution middleware. And it tries to look up the perms for a `nil` user in the cache, returning an empty set, and defaulting to the lowest permission level.

Because `apply-download-limit` and `apply-sandboxing` are the only perms-related preprocessing middleware, I don't think this issue affects other perm checking aside from this specific interaction.

Resolves https://github.com/metabase/metabase/issues/47478",noahmoss,2024-08-30 20:22:14+00:00,['noahmoss'],2024-09-02 14:54:23+00:00,2024-09-02 14:54:22+00:00,https://github.com/metabase/metabase/pull/47481,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2322282316, 'issue_id': 2498116666, 'author': 'noahmoss', 'body': '* **#47481** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47481?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 30, 20, 22, 34, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-08-30 20:22:34 UTC): * **#47481** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47481?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2498114809,pull_request,closed,,fix prepare-containers action,"### Description

Fixes broken stress test and warnings from actions about the missing inputs


<img width=""1125"" alt=""image"" src=""https://github.com/user-attachments/assets/4f265552-b8a1-4a89-b91a-a952c672cc12"">


### Demo

example of broken stress job https://github.com/metabase/metabase/actions/runs/10634180945/job/29480938439

example of the fixed stress job https://github.com/metabase/metabase/actions/runs/10638714831/job/29495256322
",uladzimirdev,2024-08-30 20:20:51+00:00,['uladzimirdev'],2024-10-08 16:15:49+00:00,2024-08-30 21:52:48+00:00,https://github.com/metabase/metabase/pull/47480,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2498023885,pull_request,closed,,"ü§ñ backported ""Disallow connection impersonation roles which are not single strings""",#47474,github-automation-metabase,2024-08-30 19:17:25+00:00,"['noahmoss', 'github-automation-metabase']",2024-08-30 20:09:12+00:00,2024-08-30 20:09:11+00:00,https://github.com/metabase/metabase/pull/47479,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2497899200,pull_request,closed,,"ü§ñ backported ""fix(admin/performance): Don't show tooltip on default policy""","  #47319
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-30 17:56:35+00:00,"['rafpaf', 'github-automation-metabase']",2024-09-10 15:31:16+00:00,2024-09-10 15:31:13+00:00,https://github.com/metabase/metabase/pull/47476,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2497869372,pull_request,closed,,Disallow connection impersonation roles which are not single strings,"It's possible to have user attributes that are arrays, since we'll store anything passed in via SSO in the DB as a json blob. But this isn't an officially supported behavior (you can't set this kind of value via the UI), and if you try to use this kind of value for impersonation, we don't know how to handle it.

We may eventually use this to set multiple roles at once for DBs that support it, but that may require a UI change and a new driver method. So for now let's just return a better error message if someone tries to do this.",noahmoss,2024-08-30 17:39:00+00:00,['noahmoss'],2024-08-30 20:09:37+00:00,2024-08-30 19:16:34+00:00,https://github.com/metabase/metabase/pull/47474,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2322043137, 'issue_id': 2497869372, 'author': 'noahmoss', 'body': '* **#47474** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47474?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 30, 17, 39, 15, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-08-30 17:39:15 UTC): * **#47474** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47474?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2497821301,pull_request,closed,,POC to investigate EE plugins usage in the sdk,"This is a POC to see how much work it would be to use ee plugins in the sdk.

I left inline comments in the PR to explain the changes, but the tldr is that I wrapped all the side effects of importing the ee plugins in a function and call it when we have some token features.

This breaks some unit test, i checked two of the files and it seems like the tests are doing something not officially supported, like changing the token features inside the same file (for example `frontend/src/metabase/admin/settings/app/components/SettingsEditor/tests/auth.unit.spec.tsx`). Or not calling the appropriate helpers to activate the plugins (because the test is located in the enterprise folder and is testing util function imported from the ee folder).",npretto,2024-08-30 17:09:52+00:00,['npretto'],2025-02-04 14:55:09+00:00,2024-09-02 13:04:07+00:00,https://github.com/metabase/metabase/pull/47473,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2322001762, 'issue_id': 2497821301, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@npretto You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 30, 17, 10, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2322003774, 'issue_id': 2497821301, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 0677d95bdc69f71d05a30104e4a2f3e726e02bbe...679af95d269cdf39881563fbe252aad29d3d182b.\n\n| Notify | File(s) |\n|-|-|\n| @ranquild | enterprise/frontend/src/metabase-enterprise/whitelabel/index.js |', 'created_at': datetime.datetime(2024, 8, 30, 17, 11, 42, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-30 17:10:14 UTC): <!---conventional commit reminder comment ID-->
@npretto You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-30 17:11:42 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 0677d95bdc69f71d05a30104e4a2f3e726e02bbe...679af95d269cdf39881563fbe252aad29d3d182b.

| Notify | File(s) |
|-|-|
| @ranquild | enterprise/frontend/src/metabase-enterprise/whitelabel/index.js |

"
2497794661,pull_request,closed,,Fix some minor collections issues,"- explicitly provide access to the trash to all users, in the same way we provide access to personal collections. Due to migration order, we don't necessarily have a permissions row with the correct `perm_type`, `perm_value`, and `collection_id` for the Trash collection. That's ok - we don't actually move things to the Trash, so there isn't any item where `collection_id=$trash.id` - but this may affect things like effective ancestors for children of the trash. Let's be explicit about the permissions that users have.

- replace a case where we manually calculated effective location and then got the parent_id with just hydrating `:effective_parent`. This should be more efficient, and better to have this logic in one place.

- replace the simple hydration method for `effective-location-path` with a batched hydration method that fetches `visible-collection-ids` *once* and then uses it to figure out the effective location path for each collection passed.
",johnswanson,2024-08-30 16:55:44+00:00,['johnswanson'],2024-09-12 12:11:11+00:00,2024-09-11 14:20:24+00:00,https://github.com/metabase/metabase/pull/47472,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2497698226,pull_request,closed,,docs - update API docs,Also includes update to card `POST` endpoint.,jeff-bruemmer,2024-08-30 16:21:10+00:00,['jeff-bruemmer'],2024-10-08 16:15:51+00:00,2024-08-30 17:25:34+00:00,https://github.com/metabase/metabase/pull/47471,"[('Type:Documentation', ''), ('no-backport', 'Do not backport this PR to any branch')]",[],
2497677901,pull_request,closed,,"ü§ñ backported ""Snowflake Variant Type should not prevent downloads or attachments""",#47434,github-automation-metabase,2024-08-30 16:13:35+00:00,"['adam-james-v', 'github-automation-metabase']",2024-08-30 17:08:31+00:00,2024-08-30 17:08:30+00:00,https://github.com/metabase/metabase/pull/47470,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2497673372,pull_request,closed,,Use function arguments rather than a dynamic var,"Closes https://github.com/metabase/metabase/issues/47467

### Description

This gets rid of the `serdes/*current*` dynamic variable.

Instead, if you need access to it you can use the `-with-context` variant your transformation function.",crisptrutski,2024-08-30 16:11:23+00:00,['crisptrutski'],2024-09-02 09:57:20+00:00,2024-09-02 09:57:18+00:00,https://github.com/metabase/metabase/pull/47469,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2497671386,pull_request,closed,,"ü§ñ backported ""fix: bigquery handle local date params as date""",#47423,github-automation-metabase,2024-08-30 16:10:28+00:00,"['snoe', 'github-automation-metabase']",2024-08-30 17:40:38+00:00,2024-08-30 17:40:37+00:00,https://github.com/metabase/metabase/pull/47468,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2497617055,pull_request,closed,,Update SDK version to 0.1.33,Update Readme version references and published npm package version to 0.1.33,github-automation-metabase,2024-08-30 15:53:30+00:00,"['heypoom', 'github-automation-metabase']",2024-10-08 16:15:53+00:00,2024-08-30 15:58:13+00:00,https://github.com/metabase/metabase/pull/47466,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2321743271, 'issue_id': 2497617055, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 30, 15, 53, 51, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-30 15:53:51 UTC): <!---conventional commit reminder comment ID-->
@github-automation-metabase You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2497463238,pull_request,closed,,Fix the trash permissions issue,"Adds a new v50 migration immediately following the Trash migration that re-populates the new permissions columns added in
`v49.2024-08-21T08:33:10`.

If the v49 migration ran first, the new Trash permissions don't have populated values for the new columns (`perm_type`, `perm_value`, and `collection_id`).
",johnswanson,2024-08-30 14:58:24+00:00,['johnswanson'],2025-02-04 15:10:59+00:00,2024-08-30 15:40:57+00:00,https://github.com/metabase/metabase/pull/47463,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2321678489, 'issue_id': 2497463238, 'author': 'johnswanson', 'body': ""We don't actually need this. We don't actually move anything to the trash, so there's nothing that has a `collection_id=[the trash collection id]`, so this has no impact."", 'created_at': datetime.datetime(2024, 8, 30, 15, 40, 57, tzinfo=datetime.timezone.utc)}]","johnswanson (Issue Creator) on (2024-08-30 15:40:57 UTC): We don't actually need this. We don't actually move anything to the trash, so there's nothing that has a `collection_id=[the trash collection id]`, so this has no impact.

"
2497447831,pull_request,closed,,"ü§ñ backported ""fix trend lines scaling""",#47361,github-automation-metabase,2024-08-30 14:51:37+00:00,"['alxnddr', 'github-automation-metabase']",2024-08-30 16:13:22+00:00,2024-08-30 16:13:22+00:00,https://github.com/metabase/metabase/pull/47462,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2321512595, 'issue_id': 2497447831, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 4146eb6e222152796934ff9025669e576cac2208...e7deb5eff91daad613d50fe694737a61e1020ab7.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/echarts/cartesian/model/dataset.ts<br>frontend/src/metabase/visualizations/echarts/cartesian/model/trend-line.ts<br>frontend/src/metabase/visualizations/echarts/cartesian/model/types.ts |', 'created_at': datetime.datetime(2024, 8, 30, 14, 53, 3, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-30 14:53:03 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 4146eb6e222152796934ff9025669e576cac2208...e7deb5eff91daad613d50fe694737a61e1020ab7.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/echarts/cartesian/model/dataset.ts<br>frontend/src/metabase/visualizations/echarts/cartesian/model/trend-line.ts<br>frontend/src/metabase/visualizations/echarts/cartesian/model/types.ts |

"
2497427094,pull_request,closed,,Experiment on how to track migration durations,"Scrappy little experiment on how to track the individual migration times

We've updated the log level to INFO for liquibase which is useful. See https://github.com/metabase/metabase/issues/47396 for the nicer information we have in logs.

But we should make this a first-class queryable datapoint.

To that effort, there's a [ChangeExecListener Interface](https://javadoc.io/static/org.liquibase/liquibase-core/4.20.0/liquibase/changelog/visitor/ChangeExecListener.html) in liquibase. 

This prototypes how we can capture this information. 
- capture id and duration
- should add whether it's up or down
- note because of migrating up and down, each can happen multiple times.
- store in the app-db (it's annoying that `databasechangelog` doesn't actually include a duration)


In this draft PR I'm just `tap>`ing the results. We would do something else with this. Also the architecture here isn't representative of what we would ship.

```clojure
{
...
""v51.2024-08-05T16:00:01"" {:start 1725028274070
                                 :end 1725028274073
                                 :duration 3}
      ""v51.2024-05-13T15:30:57"" {:start 1725028273150
                                 :end 1725028273151
                                 :duration 1}
      ""v50.2024-01-09T13:53:54"" {:start 1725028271978
                                 :end 1725028271979
                                 :duration 1}
}
```",dpsutton,2024-08-30 14:43:09+00:00,['dpsutton'],2025-02-04 01:31:23+00:00,2025-02-04 01:31:22+00:00,https://github.com/metabase/metabase/pull/47461,"[('Stale', 'Stale PRs that will be auto-closed')]","[{'comment_id': 2603449816, 'issue_id': 2497427094, 'author': 'github-actions[bot]', 'body': 'This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.', 'created_at': datetime.datetime(2025, 1, 21, 1, 31, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2632557557, 'issue_id': 2497427094, 'author': 'github-actions[bot]', 'body': 'This pull request was closed because it had no activity for more than 90 days.', 'created_at': datetime.datetime(2025, 2, 4, 1, 31, 21, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-01-21 01:31:10 UTC): This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.

github-actions[bot] on (2025-02-04 01:31:21 UTC): This pull request was closed because it had no activity for more than 90 days.

"
2497423720,pull_request,closed,,Fix Trash migration,"The Trash migration was added a long time ago.

We recently added a v49 migration to add and populate the columns `perm_type`, `perm_value`, and `collection_id` to the `permissions` table.

If the Trash migration runs first, everything is ok: we create the trash and the relevant permissions rows, and then the v49 migration runs and populates the `perm_type`, `perm_value`, and `collection_id` columns.

However, if the v49 migration runs first, everything is not ok: we create and populate the columns, *then* create the Trash permissions, which end up with `null` values for those columns.

This change modifies the Trash migration to populate the missing columns.

I am confused that this is passing CI - locally, I get test failures without this change.",johnswanson,2024-08-30 14:41:40+00:00,['johnswanson'],2025-02-04 15:11:00+00:00,2024-08-30 14:56:43+00:00,https://github.com/metabase/metabase/pull/47460,"[('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2497420647,pull_request,closed,,"ü§ñ backported ""Trigger BE tests when test_resources are updated""",#47455,github-automation-metabase,2024-08-30 14:40:21+00:00,"['crisptrutski', 'github-automation-metabase']",2024-08-30 14:41:58+00:00,2024-08-30 14:41:57+00:00,https://github.com/metabase/metabase/pull/47459,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2497413854,pull_request,closed,,[WIP] Maintain tab state in Entity Picker,"Closes #47454

Depends on #47309

### Description

Uses `keepMounted` prop to maintain state of tabs in entity picker on navigation.
Ideally tab state should be refactored (lifted up) but it'd be a large change and we can do that later on (see [Slack](https://metaboat.slack.com/archives/C0645JP1W81/p1725883604211259)).

The disadvantage is that the tabs are always present in DOM after opening, which breaks e2e tests (Cypress still ""sees"" the elements which user doesn't). Most of the changes in this PR are to make sure proper e2e helpers are used when dealing with entity picker (`data-testid=""entity-picker-active-tab""` is used to indicate which tab is the active one).

### How to verify

CI is green.
Tab state is remembered when navigating through tabs in the entity picker.


### Demo

#### Before

https://github.com/user-attachments/assets/bbd11968-905d-44e7-a858-f9edad871469


#### After

https://github.com/user-attachments/assets/90aef6a5-6fea-4198-9cd2-422f506bf8ca

",kamilmielnik,2024-08-30 14:37:35+00:00,['kamilmielnik'],2024-09-10 09:45:01+00:00,2024-09-10 09:44:58+00:00,https://github.com/metabase/metabase/pull/47458,"[('do not merge', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2340181604, 'issue_id': 2497413854, 'author': 'kamilmielnik', 'body': 'Closing in favor of #47794 due to:\r\n- enormous amount of errors from cypress complaining that things re-render asynchronously\r\n- difficulties with typing', 'created_at': datetime.datetime(2024, 9, 10, 9, 44, 58, tzinfo=datetime.timezone.utc)}]","kamilmielnik (Issue Creator) on (2024-09-10 09:44:58 UTC): Closing in favor of #47794 due to:
- enormous amount of errors from cypress complaining that things re-render asynchronously
- difficulties with typing

"
2497372821,pull_request,closed,,fix flakiness,"> [!IMPORTANT]
> For those employed by Metabase: if you are merging into master, please add either a `backport` or a `no-backport` label to this PR. You will not be able to merge until you do this step. Refer to the section [Do I need to backport this PR?](https://www.notion.so/metabase/Metabase-Branching-Strategy-6eb577d5f61142aa960a626d6bbdfeb3?pvs=4#89f80d6f17714a0198aeb66c0efd1b71) in the Metabase Branching Strategy document for more details. If you're not employed by Metabase, this section does not apply to you, and the label will be taken care of by your reviewer.

> **Warning**
>
> If that is your first contribution to Metabase, please sign the [Contributor License Agreement](https://docs.google.com/a/metabase.com/forms/d/1oV38o7b9ONFSwuzwmERRMi9SYrhYeOrkbmNaq9pOJ_E/viewform) (unless it's a tiny documentation change). Also, if you're attempting to fix a translation issue, please submit your changes to our [POEditor project](https://poeditor.com/join/project/ynjQmwSsGh) instead of opening a PR.

Closes https://github.com/metabase/metabase/issues/[issue_number]

### Description

Describe the overall approach and the problem being solved.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. New question -> Sample Dataset -> ...
2. ...

### Demo

_Upload a demo video or before/after screenshots if sensible or remove the section_

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",uladzimirdev,2024-08-30 14:19:07+00:00,['uladzimirdev'],2024-09-15 13:25:38+00:00,2024-09-15 13:25:36+00:00,https://github.com/metabase/metabase/pull/47457,"[('.Team/Querying', '')]",[],
2497333720,pull_request,closed,,"ü§ñ backported ""Check joins in lib.metadata/editable?""","  #47421
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-30 14:02:41+00:00,"['metamben', 'github-automation-metabase']",2024-09-03 16:00:48+00:00,2024-09-03 16:00:46+00:00,https://github.com/metabase/metabase/pull/47456,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2497314822,pull_request,closed,,Trigger BE tests when test_resources are updated,"Our tests depend on these files, so we should run them.",crisptrutski,2024-08-30 13:55:22+00:00,['crisptrutski'],2024-08-30 14:42:28+00:00,2024-08-30 14:39:32+00:00,https://github.com/metabase/metabase/pull/47455,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2497278369,pull_request,closed,,Notifications Followup,"Closes https://github.com/metabase/metabase/issues/47452

### Description
Adds breadcrumbs to the Slack admin page, updates placeholder text and adds some more e2e tests

### How to verify

Describe the steps to verify that the changes are working as expected.

1. Admin -> Settings -> Notification Channels -> Slack
2. You should see breadcrumbs near the top of the page
3. Go back to notifications and open the form to create a new webhook
4. Choose API Key as your auth type, and note the updated placeholder for `Key`

### Demo

![image](https://github.com/user-attachments/assets/329a39de-ab36-423e-8e4f-8fc2154499e7)
![image](https://github.com/user-attachments/assets/b848d440-f23f-475e-950f-cb2c7832773f)


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",npfitz,2024-08-30 13:39:37+00:00,['npfitz'],2024-09-04 15:51:30+00:00,2024-09-04 15:51:29+00:00,https://github.com/metabase/metabase/pull/47453,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2497255866,pull_request,closed,,Add serialization baseline for Channel,"Resolves [failing test](https://github.com/metabase/metabase/actions/runs/10630740259/job/29471439573?pr=47310) on master, due to race condition between PRs",crisptrutski,2024-08-30 13:30:27+00:00,['crisptrutski'],2024-10-08 16:15:55+00:00,2024-08-30 13:32:24+00:00,https://github.com/metabase/metabase/pull/47451,"[('no-backport', 'Do not backport this PR to any branch')]",[],
2497167899,pull_request,closed,,Query ref validation: fix non-deterministic sort,"... and the associated flaky test!
",johnswanson,2024-08-30 12:57:49+00:00,['johnswanson'],2024-10-08 16:15:49+00:00,2024-08-30 19:08:11+00:00,https://github.com/metabase/metabase/pull/47449,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2497047617,pull_request,closed,,fix(sdk): Use modal instead of hacky form for saving questions,"Fixes https://github.com/metabase/metabase/issues/47346

Uses a modal for saving questions instead of the weird overlay form that was being used in the `QuestionEditor`",oisincoveney,2024-08-30 12:06:16+00:00,['oisincoveney'],2024-09-06 20:16:50+00:00,2024-09-06 20:16:48+00:00,https://github.com/metabase/metabase/pull/47448,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2321025915, 'issue_id': 2497047617, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 38dcee804c0009f14e51a077b7338df6a5846dea...655f2861ce516650df010ff0d1143b7c1f01f0ba.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/utils/colors.ts |', 'created_at': datetime.datetime(2024, 8, 30, 12, 7, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2332586192, 'issue_id': 2497047617, 'author': 'oisincoveney', 'body': ""@npretto I know you were having issues with this PR - I've made a few changes so let me know if it works for you now"", 'created_at': datetime.datetime(2024, 9, 5, 20, 36, 2, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-30 12:07:56 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 38dcee804c0009f14e51a077b7338df6a5846dea...655f2861ce516650df010ff0d1143b7c1f01f0ba.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/utils/colors.ts |

oisincoveney (Issue Creator) on (2024-09-05 20:36:02 UTC): @npretto I know you were having issues with this PR - I've made a few changes so let me know if it works for you now

"
2496952991,pull_request,closed,,Add isLoadingTabs prop to EntityPicker,"Closes https://github.com/metabase/metabase/issues/46775

### Description
Sometimes when displaying the entity picker, we need to do some async work to determine what tabs need to be shown. This means that as it's determined that tabs are valid, they will become available. This PR introduces 2 changes:

- Introduces an `isLoadingTabs` prop to the `EntityPickerModal` that can be managed by the parent
- Uses `isLoadingTabs` and `isLoadingRecents` to conditionally show a ~loading spinner~ skeleton content while tabs are being determined

This allows us to manage the tabs we pass in, as well as the tabs that are conditionally added by the `EntityPickerModal`

### How to verify
1. Find a way to slow down `/api/activity/recents?context=selections`
2. Go to New -> Question
3. You should see a loading state until the call to recents is done, and all tabs will appear at the same time

### Demo
![chrome_uqfEOEaMoT](https://github.com/user-attachments/assets/b5eb9717-de64-4d7e-a371-54956d373962)

### Checklist
- [x] Tests have been added/updated to cover changes in this PR
",npfitz,2024-08-30 11:16:20+00:00,['npfitz'],2024-10-03 13:57:02+00:00,2024-10-03 13:56:57+00:00,https://github.com/metabase/metabase/pull/47447,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2321888790, 'issue_id': 2496952991, 'author': 'iethree', 'body': ""product concern here for @luizarakaki or @mazameli : this could feel slow since we won't show anything in the entityPicker until recents load, even if we have the data for the file picker üò¢  I don't know a way it could be better, any ideas?"", 'created_at': datetime.datetime(2024, 8, 30, 16, 31, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2379677412, 'issue_id': 2496952991, 'author': 'npfitz', 'body': '@mazameli replaced the loading spinner with some skeletons.\r\n\r\n![chrome_uqfEOEaMoT](https://github.com/user-attachments/assets/b5eb9717-de64-4d7e-a371-54956d373962)', 'created_at': datetime.datetime(2024, 9, 27, 16, 42, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2380087542, 'issue_id': 2496952991, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 93cd63aca941d4289a59da394b176e356acd0760...e199a7734f41724c592530b213f97b642b31ea87.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/feedback/Skeleton/Skeleton.styled.tsx |', 'created_at': datetime.datetime(2024, 9, 27, 21, 34, 2, tzinfo=datetime.timezone.utc)}]","iethree on (2024-08-30 16:31:50 UTC): product concern here for @luizarakaki or @mazameli : this could feel slow since we won't show anything in the entityPicker until recents load, even if we have the data for the file picker üò¢  I don't know a way it could be better, any ideas?

npfitz (Issue Creator) on (2024-09-27 16:42:56 UTC): @mazameli replaced the loading spinner with some skeletons.

![chrome_uqfEOEaMoT](https://github.com/user-attachments/assets/b5eb9717-de64-4d7e-a371-54956d373962)

github-actions[bot] on (2024-09-27 21:34:02 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 93cd63aca941d4289a59da394b176e356acd0760...e199a7734f41724c592530b213f97b642b31ea87.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/feedback/Skeleton/Skeleton.styled.tsx |

"
2496827670,pull_request,closed,,Update serialization fixtures to track new database field,"An extra field was added to the dump in parallel to us adding the end-to-end tests.
",crisptrutski,2024-08-30 10:19:20+00:00,['crisptrutski'],2024-10-08 16:15:56+00:00,2024-08-30 10:21:08+00:00,https://github.com/metabase/metabase/pull/47446,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2496820419,pull_request,closed,,[serdes] a bit more valuable ns docstring,"Fixes #46039

It is by no means complete, but I tried to write so that a person encountering this stuff for the first time has pointers at what to read and how to deal with serialization. To be honest, would love to hear any feedback, because I'm so deep in it that I'm probably absolutely missing what is not clear about serialization.",piranha,2024-08-30 10:15:41+00:00,['piranha'],2024-09-02 08:09:25+00:00,2024-09-02 08:09:23+00:00,https://github.com/metabase/metabase/pull/47445,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2321537673, 'issue_id': 2496820419, 'author': 'piranha', 'body': '@devurandom and @qnkhuat would be really glad to get a comment or thumbs up from you :)', 'created_at': datetime.datetime(2024, 8, 30, 15, 1, 45, tzinfo=datetime.timezone.utc)}]","piranha (Issue Creator) on (2024-08-30 15:01:45 UTC): @devurandom and @qnkhuat would be really glad to get a comment or thumbs up from you :)

"
2496643122,pull_request,closed,,"ü§ñ backported ""Add test against serialization YAML format changing""",#47349,github-automation-metabase,2024-08-30 08:58:09+00:00,"['crisptrutski', 'github-automation-metabase']",2024-08-30 09:51:45+00:00,2024-08-30 09:51:44+00:00,https://github.com/metabase/metabase/pull/47443,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2320561268, 'issue_id': 2496643122, 'author': 'crisptrutski', 'body': ""Manually updated this with some changes from the version in master:\r\n\r\n1. Added dump for LegacyMetric by using `round-trip-test/add-to-baseline!`\r\n2. Remove two fields from Collection spec that don't exist yet in v50.\r\n3. Removed `source_card_id` from fixtures, that's a metrics v2 field that's not in v50 yet.\r\n\r\nThe latter issue was a bug in v50 by backporting the collection spec, that hadn't broken any tests!"", 'created_at': datetime.datetime(2024, 8, 30, 9, 0, 53, tzinfo=datetime.timezone.utc)}]","crisptrutski (Assginee) on (2024-08-30 09:00:53 UTC): Manually updated this with some changes from the version in master:

1. Added dump for LegacyMetric by using `round-trip-test/add-to-baseline!`
2. Remove two fields from Collection spec that don't exist yet in v50.
3. Removed `source_card_id` from fixtures, that's a metrics v2 field that's not in v50 yet.

The latter issue was a bug in v50 by backporting the collection spec, that hadn't broken any tests!

"
2496627628,pull_request,closed,,fix(sdk): Add toggle for saving questions,Adds a prop called `isSaveEnabled` on `InteractiveQuestion` to allow users to enable and disable saving a question to their Metabase instance.,oisincoveney,2024-08-30 08:51:15+00:00,['oisincoveney'],2024-10-08 16:15:42+00:00,2024-09-02 17:59:07+00:00,https://github.com/metabase/metabase/pull/47442,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2496602909,pull_request,closed,,Indicate which column is used in reference validator sort test,"### Description 

This test [flaked](https://github.com/metabase/metabase/actions/runs/10626182151/job/29457436993#step:4:523) recently, and without these `testing` blocks its not possible to see which was the cause.",crisptrutski,2024-08-30 08:39:56+00:00,['crisptrutski'],2024-10-08 16:15:45+00:00,2024-09-02 09:02:04+00:00,https://github.com/metabase/metabase/pull/47441,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2321311236, 'issue_id': 2496602909, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 550f9c36d741cc018af736ed2e6a3a1d7f109173...f324e70f00b7fa9c58d9575b770b15ca19707187.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/index.ts<br>frontend/src/metabase/ui/components/icons/Icon/icons/webhook.svg<br>frontend/src/metabase/ui/components/inputs/Chip/Chip.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Chip/index.ts<br>frontend/src/metabase/ui/components/inputs/index.ts<br>frontend/src/metabase/ui/theme.ts |', 'created_at': datetime.datetime(2024, 8, 30, 13, 44, 55, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-30 13:44:55 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 550f9c36d741cc018af736ed2e6a3a1d7f109173...f324e70f00b7fa9c58d9575b770b15ca19707187.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/index.ts<br>frontend/src/metabase/ui/components/icons/Icon/icons/webhook.svg<br>frontend/src/metabase/ui/components/inputs/Chip/Chip.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Chip/index.ts<br>frontend/src/metabase/ui/components/inputs/index.ts<br>frontend/src/metabase/ui/theme.ts |

"
2496517614,pull_request,closed,,Use published version of Hawk,,tsmacdonald,2024-08-30 07:58:00+00:00,['tsmacdonald'],2024-10-08 16:15:57+00:00,2024-08-30 09:31:04+00:00,https://github.com/metabase/metabase/pull/47440,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2496423186,pull_request,closed,,"ü§ñ backported ""perf: Perform string->datetime conversion once during timeseries insights""",#47424,github-automation-metabase,2024-08-30 07:10:17+00:00,"['alexander-yakushev', 'github-automation-metabase']",2024-08-30 08:01:28+00:00,2024-08-30 08:01:27+00:00,https://github.com/metabase/metabase/pull/47439,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2496121157,pull_request,closed,,"ü§ñ backported ""fix formatting null values adds prefix and suffix""",#47435,github-automation-metabase,2024-08-30 03:22:29+00:00,"['alxnddr', 'github-automation-metabase']",2024-08-30 03:54:53+00:00,2024-08-30 03:54:53+00:00,https://github.com/metabase/metabase/pull/47437,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2495852840,pull_request,closed,,fix formatting null values adds prefix and suffix,"Closes https://github.com/metabase/metabase/issues/42867

### Description

Fixes formatting: when formatting `null` we should ignore suffix and prefix and just return null to avoid strings `prefix_null_suffix`

### How to verify

To repro it on a pivot table as in the issue create the following sql query in H2 sample DB:
```sql
SELECT 
    id,
    CASE 
        WHEN id % 3 = 0 THEN 'Category A'
        WHEN id % 3 = 1 THEN 'Category B'
        ELSE 'Category C'
    END AS category1,
    CASE 
        WHEN id % 4 = 0 THEN 'Type 1'
        WHEN id % 4 = 1 THEN 'Type 2'
        WHEN id % 4 = 2 THEN 'Type 3'
        ELSE 'Type 4'
    END AS category2,
    CASE 
        WHEN id % 5 = 0 THEN 'Region X'
        WHEN id % 5 = 1 THEN 'Region Y'
        WHEN id % 5 = 2 THEN 'Region Z'
        WHEN id % 5 = 3 THEN 'Region W'
        ELSE 'Region V'
    END AS category3,
    CASE WHEN id % 2 = 0 THEN ROUND(RAND() * 1000, 2) ELSE NULL END AS metric1,
    CASE WHEN id % 2 = 1 THEN ROUND(RAND() * 100, 2) ELSE NULL END AS metric2,
    CASE WHEN id % 2 = 0 THEN ROUND(RAND() * 50, 2) ELSE NULL END AS metric3
FROM SYSTEM_RANGE(1, 50) AS t(id)
```

Click Explore results, and create the following pivot table:
<img width=""1042"" alt=""Screenshot 2024-08-29 at 7 53 57‚ÄØPM"" src=""https://github.com/user-attachments/assets/943bd29f-b1b5-4b9f-95fb-c6f8c1fbece4"">

Add prefix and suffix to metric columns and ensure nulls are not rendered as `prefix_null_suffix`.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",alxnddr,2024-08-29 23:55:23+00:00,['alxnddr'],2024-08-30 03:21:37+00:00,2024-08-30 03:21:35+00:00,https://github.com/metabase/metabase/pull/47435,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2495810761,pull_request,closed,,Snowflake Variant Type should not prevent downloads or attachments,"Fixes #46981

The :type/SnowflakeVariant key matches 2 methods in `metabase.query-processor.streaming.common/global-type-settings`.

In this case, it seems that the variant type can be any type, so we shouldn't try to guess anything here, except if the user has provided a :semantic_type, which we can use.

Otherwise, we'll keep going without formatting details about the variant column, which is likely fine already, as it should result in strings in the export/attachments.",adam-james-v,2024-08-29 23:17:23+00:00,['adam-james-v'],2024-08-30 16:12:44+00:00,2024-08-30 16:12:42+00:00,https://github.com/metabase/metabase/pull/47434,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2495706530,pull_request,closed,,Remove `MetabaseSettings.docsUrl()`,"Prep for https://github.com/metabase/metabase/issues/41189

### Description

MetabaseSettings has been deprecated for a *long* time. This removes one major use of it `MetabaseSettings.docsUrl()` and replaces it with a more developer-friendly hook: `useDocsUrl`. 

Before
```ts
import MetabaseSettings from ""metabse/lib/settings"";
import { useSelector } from ""metabase/lib/settings""
import { getShowMetabaseLinks } from ""metabase/selectors/whitelabel"";
...
const showMetabaseLinks = useSelector(getShowMetabaseLinks);
const url = MetabaseSettings.docsUrl(""dashboards/actions"");
```

After
```ts
import { useDocsUrl } from ""metabase/common/hooks"";
...
const { url, showMetabaseLinks } = useDocsUrl(""dashboards/actions"");
```

One other item of note is that we had to update a lint rule: `no-unconditional-metabase-links-render` to remind users that they need to destructure the `showMetabaseLinks` property out of this hook and use it to conditionally render metabase links to account for whitelabel settings.

Now, when the lint rule reminds you to do the conditional check, you don't need a new import, you just need to destructure the value out of the same hook. üòÅ 

### How to verify

No functional changes, just less deprecated code in use. ‚ò∫Ô∏è 

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-08-29 22:44:51+00:00,['iethree'],2024-10-08 16:15:50+00:00,2024-08-30 18:42:22+00:00,https://github.com/metabase/metabase/pull/47433,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2319202431, 'issue_id': 2495706530, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff b0dbb38e74d62500fee3a087aa9b9e5eddaa691f...4d5e052092af2fe72efcc84e10b8f034916b8d3b.\n\n| Notify | File(s) |\n|-|-|\n| @ranquild | frontend/src/metabase/setup/components/DataUsageStep/DataUsageStep.tsx<br>frontend/src/metabase/setup/components/SetupHelp/SetupHelp.tsx<br>frontend/src/metabase/sharing/components/AddEditSidebar/CaveatMessage/CaveatMessage.jsx |', 'created_at': datetime.datetime(2024, 8, 29, 22, 47, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2321419168, 'issue_id': 2495706530, 'author': 'npfitz', 'body': 'Actually, since this morning, there is another docs url in `frontend/src/metabase/admin/settings/notifications/WebhookForm.tsx` that should also be converted', 'created_at': datetime.datetime(2024, 8, 30, 14, 21, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2321421252, 'issue_id': 2495706530, 'author': 'iethree', 'body': ""> Actually, since this morning, there is another docs url in `frontend/src/metabase/admin/settings/notifications/WebhookForm.tsx` that should also be converted\r\n\r\nüò±  thanks. I'll kill that one too. Also gotta update some tests"", 'created_at': datetime.datetime(2024, 8, 30, 14, 21, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2322135420, 'issue_id': 2495706530, 'author': 'iethree', 'body': ""> Actually, since this morning, there is another docs url in `frontend/src/metabase/admin/settings/notifications/WebhookForm.tsx` that should also be converted\r\n\r\nactually that one is fine, it's using the selector already which is still fine üëç"", 'created_at': datetime.datetime(2024, 8, 30, 18, 42, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-29 22:47:06 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff b0dbb38e74d62500fee3a087aa9b9e5eddaa691f...4d5e052092af2fe72efcc84e10b8f034916b8d3b.

| Notify | File(s) |
|-|-|
| @ranquild | frontend/src/metabase/setup/components/DataUsageStep/DataUsageStep.tsx<br>frontend/src/metabase/setup/components/SetupHelp/SetupHelp.tsx<br>frontend/src/metabase/sharing/components/AddEditSidebar/CaveatMessage/CaveatMessage.jsx |

npfitz on (2024-08-30 14:21:09 UTC): Actually, since this morning, there is another docs url in `frontend/src/metabase/admin/settings/notifications/WebhookForm.tsx` that should also be converted

iethree (Issue Creator) on (2024-08-30 14:21:52 UTC): üò±  thanks. I'll kill that one too. Also gotta update some tests

iethree (Issue Creator) on (2024-08-30 18:42:00 UTC): actually that one is fine, it's using the selector already which is still fine üëç

"
2495691517,pull_request,closed,,Entity id translation analytics,"Resolves #47360

Tracks entity id translations, keeps a reduction of statuses in a defsetting so that it will work in a multi-tenant system.

API:

`update-translation-count!` - Called by the functions that translate entity ids into ids, with the statuses of how things went.

`get-and-clear-translation-count!` - Meant to be called when computing the anonymous statistics pings. This returns the totals for each status `:ok`, `:not-found`, `:invalid`, and `:total` which is all of them .. totaled. This also resets the tally for each status to 0.

",escherize,2024-08-29 22:32:45+00:00,['escherize'],2024-09-04 22:48:20+00:00,2024-09-04 22:48:19+00:00,https://github.com/metabase/metabase/pull/47432,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2495681118,pull_request,closed,,fix formatting applied to percent change,"Closes https://github.com/metabase/metabase/issues/47373

### Description

Describe the overall approach and the problem being solved. There is no such issue in `master` branch because we've reworked tooltips.

### How to verify

- Create a time series line/area/bar chart
- Apply formatting to the metric column: apply prefix/suffix
- Hover chart data points to see the tooltip
- Ensure the formatting has not applied to the percent change

### Demo

<img width=""648"" alt=""Screenshot 2024-08-29 at 6 20 22‚ÄØPM"" src=""https://github.com/user-attachments/assets/3ba600ed-9cdb-4167-b4a0-f20a2899fc92"">

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",alxnddr,2024-08-29 22:23:16+00:00,['alxnddr'],2024-08-30 03:21:59+00:00,2024-08-30 03:21:57+00:00,https://github.com/metabase/metabase/pull/47431,"[('.Team/DashViz', 'Dashboard and Viz team')]",[],
2495665856,pull_request,closed,,"ü§ñ backported ""Static embed dashboard and question endpoints""","  #47270
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-29 22:09:57+00:00,"['escherize', 'github-automation-metabase']",2024-09-06 20:10:27+00:00,2024-09-06 20:10:27+00:00,https://github.com/metabase/metabase/pull/47430,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2495593107,pull_request,closed,,"ü§ñ backported ""Add v0.50.23 to the list of releases""",#47422,github-automation-metabase,2024-08-29 21:16:12+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-29 21:17:46+00:00,2024-08-29 21:17:46+00:00,https://github.com/metabase/metabase/pull/47429,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2495458902,pull_request,closed,,[WIP] fix: bigquery external sheets with no rows,wip for CI testing,snoe,2024-08-29 19:54:00+00:00,['snoe'],2024-09-25 21:57:48+00:00,2024-09-25 21:57:46+00:00,https://github.com/metabase/metabase/pull/47428,"[('do not merge', ''), ('.Team/Drivers', '')]",[],
2495456607,pull_request,closed,,[MBQL lib] Allow temporal bucketing of Date(Time) expressions,"Fixes #47341.

### Description

The QP now supports temporal bucketing of custom expressions, but that has
not been surfaced in the UI until now.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. Use a database other than H2, since it doesn't support time zones.
1. New question -> Anything with a DateTime column
1. Create a custom expression like `convertTimezone([Date Column], ""America/New_York"", ""UTC"")`
1. Break out by that expression

The temporal bucketing should work in the UI and in the query results, save properly, etc.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",bshepherdson,2024-08-29 19:52:48+00:00,['bshepherdson'],2024-09-03 15:27:57+00:00,2024-09-03 15:27:56+00:00,https://github.com/metabase/metabase/pull/47427,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2318818833, 'issue_id': 2495456607, 'author': 'bshepherdson', 'body': '* **#47427** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47427?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 29, 19, 53, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2318966527, 'issue_id': 2495456607, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 57b91425d5c7474e2fd22dac5bd4c489f85d83fe...ff241a7b72ebadd57c283051aa5928629bf88c65.\n\nNo notifications.', 'created_at': datetime.datetime(2024, 8, 29, 20, 52, 10, tzinfo=datetime.timezone.utc)}]","bshepherdson (Issue Creator) on (2024-08-29 19:53:02 UTC): * **#47427** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47427?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

github-actions[bot] on (2024-08-29 20:52:10 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 57b91425d5c7474e2fd22dac5bd4c489f85d83fe...ff241a7b72ebadd57c283051aa5928629bf88c65.

No notifications.

"
2495327213,pull_request,closed,,perf: Perform string->datetime conversion once during timeseries insights,"This is a crucial insights optimization that deserves its own PR (and it's maximally uncontroversial).

In the current implementation, the reducing function that performs insights on a timeseries-like data (data with exactly one datetime column) performs pairwise analysis on a timeseries column and each data column. For each pair, the timeseries column is converted string->datetime every time. That explains why I'm seeing so much date conversion work and addressed some of it in the previous PRs.

The patch makes sure that the conversion happens early and only once.

In my synthetic benchmark (timeseries table with ~20 data columns, 20k rows displayed on a dashboard, this is what I'm getting before the patch:

```
Time per call: 2.49 s   Alloc per call: 5,036,408,480b
Time per call: 2.31 s   Alloc per call: 5,036,259,688b
Time per call: 2.38 s   Alloc per call: 5,036,259,088b
Time per call: 2.47 s   Alloc per call: 5,036,259,432b
```

After the patch:

```
Time per call: 1.07 s   Alloc per call: 1,982,806,768b
Time per call: 1.11 s   Alloc per call: 1,982,807,480b
Time per call: 1.25 s   Alloc per call: 1,982,808,592b
Time per call: 1.24 s   Alloc per call: 1,982,804,896b
```
",alexander-yakushev,2024-08-29 19:00:18+00:00,['alexander-yakushev'],2024-08-30 08:01:58+00:00,2024-08-30 07:09:22+00:00,https://github.com/metabase/metabase/pull/47424,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2495325200,pull_request,closed,,fix: bigquery handle local date params as date,"Fixes #30602

We were overriding localdate in bigquery driver to produce offsetdatetimes for no apparent reason. This causes a number of problems when dealing with date type columns.
",snoe,2024-08-29 18:59:16+00:00,['snoe'],2024-08-30 16:09:32+00:00,2024-08-30 16:09:31+00:00,https://github.com/metabase/metabase/pull/47423,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Drivers', '')]",[],
2495301381,pull_request,closed,,Add v0.50.23 to the list of releases,Like it says on the tin üòÅ,github-automation-metabase,2024-08-29 18:47:16+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-29 21:18:16+00:00,2024-08-29 21:15:21+00:00,https://github.com/metabase/metabase/pull/47422,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2495300474,pull_request,closed,,Check joins in lib.metadata/editable?,"Fixes #37751
Fixes #37753

### Description

This is the implementation of @ranquild's [suggestion](https://github.com/metabase/metabase/issues/37751#issuecomment-2195392865).

The result is not beautiful:
<img width=""768"" alt=""image"" src=""https://github.com/user-attachments/assets/be1297a8-1598-46ca-bd9d-68af467e7c6e"">

 
### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",metamben,2024-08-29 18:46:48+00:00,['metamben'],2024-08-30 14:01:54+00:00,2024-08-30 14:01:53+00:00,https://github.com/metabase/metabase/pull/47421,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2321347628, 'issue_id': 2495300474, 'author': 'lbrdnk', 'body': 'Based on the linked comment, the fix addresses also the issue #37753, right?', 'created_at': datetime.datetime(2024, 8, 30, 13, 57, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2321356687, 'issue_id': 2495300474, 'author': 'metamben', 'body': '> Based on the linked comment, the fix addresses also the issue #37753, right?\r\n\r\nRight.', 'created_at': datetime.datetime(2024, 8, 30, 14, 0, 56, tzinfo=datetime.timezone.utc)}]","lbrdnk on (2024-08-30 13:57:41 UTC): Based on the linked comment, the fix addresses also the issue #37753, right?

metamben (Issue Creator) on (2024-08-30 14:00:56 UTC): Right.

"
2495156802,pull_request,closed,,"ü§ñ backported ""Hide attached DWH database details""","Backport:
* https://github.com/metabase/metabase/pull/47247
* https://github.com/metabase/metabase/pull/47517
* https://github.com/metabase/metabase/pull/47469
* https://github.com/metabase/metabase/pull/47446

  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-29 17:37:41+00:00,"['devurandom', 'github-automation-metabase']",2024-09-06 13:16:31+00:00,2024-09-06 13:16:02+00:00,https://github.com/metabase/metabase/pull/47419,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2320542996, 'issue_id': 2495156802, 'author': 'devurandom', 'body': 'Requested review on the backport from everyone who had reviewed https://github.com/metabase/metabase/pull/47247.', 'created_at': datetime.datetime(2024, 8, 30, 8, 54, 8, tzinfo=datetime.timezone.utc)}]","devurandom (Assginee) on (2024-08-30 08:54:08 UTC): Requested review on the backport from everyone who had reviewed https://github.com/metabase/metabase/pull/47247.

"
2495152212,pull_request,closed,,Bump Kondo version to 2024.08.29,A day after I bumped the Kondo `2024.08.01` another new version was released! Time to bump the version again,camsaul,2024-08-29 17:35:28+00:00,['camsaul'],2024-10-08 16:15:31+00:00,2024-09-05 00:22:43+00:00,https://github.com/metabase/metabase/pull/47418,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]","[{'comment_id': 2318541152, 'issue_id': 2495152212, 'author': 'noahmoss', 'body': ""Looks like it's creating a couple new warnings"", 'created_at': datetime.datetime(2024, 8, 29, 18, 11, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2322182593, 'issue_id': 2495152212, 'author': 'camsaul', 'body': 'All these new warnings are legit:\r\n\r\n```\r\nenterprise/backend/src/metabase_enterprise/airgap.clj:15:65: warning: Return schema should go before vector.\r\nenterprise/backend/src/metabase_enterprise/airgap.clj:21:39: warning: Return schema should go before vector.\r\nsrc/metabase/api/activity.clj:208:9: warning: Return schema should go before vector.\r\nsrc/metabase/public_settings/premium_features.clj:139:9: warning: Return schema should go before vector.\r\nsrc/metabase/search/impl.clj:640:53: warning: Return schema should go before vector.\r\n```\r\n\r\nThe new Kondo version is already catching new stuff for us!', 'created_at': datetime.datetime(2024, 8, 30, 19, 12, 32, tzinfo=datetime.timezone.utc)}]","noahmoss on (2024-08-29 18:11:39 UTC): Looks like it's creating a couple new warnings

camsaul (Issue Creator) on (2024-08-30 19:12:32 UTC): All these new warnings are legit:

```
enterprise/backend/src/metabase_enterprise/airgap.clj:15:65: warning: Return schema should go before vector.
enterprise/backend/src/metabase_enterprise/airgap.clj:21:39: warning: Return schema should go before vector.
src/metabase/api/activity.clj:208:9: warning: Return schema should go before vector.
src/metabase/public_settings/premium_features.clj:139:9: warning: Return schema should go before vector.
src/metabase/search/impl.clj:640:53: warning: Return schema should go before vector.
```

The new Kondo version is already catching new stuff for us!

"
2495082325,pull_request,closed,,"ü§ñ backported ""Migrate Tooltip in FormField to mantine to fix z-index issue""",#47314,github-automation-metabase,2024-08-29 16:58:14+00:00,"['noahmoss', 'github-automation-metabase']",2024-08-29 17:32:17+00:00,2024-08-29 17:32:16+00:00,https://github.com/metabase/metabase/pull/47417,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2495076092,pull_request,closed,,Allow group deletion via SCIM,Implements a `DELETE` group endpoint for SCIM. Pretty straightforward. See [here](https://metaboat.slack.com/archives/C064EB1UE5P/p1724947151989099) for context,noahmoss,2024-08-29 16:55:14+00:00,['noahmoss'],2024-10-08 16:15:51+00:00,2024-08-30 18:00:35+00:00,https://github.com/metabase/metabase/pull/47416,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2318371881, 'issue_id': 2495076092, 'author': 'noahmoss', 'body': '* **#47416** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47416?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 29, 16, 55, 32, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-08-29 16:55:32 UTC): * **#47416** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47416?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2495069177,pull_request,closed,,"ü§ñ backported ""Update instance_analytics for 50 major release""","  #47323
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-29 16:51:55+00:00,"['luizarakaki', 'github-automation-metabase']",2024-08-30 22:02:59+00:00,2024-08-30 22:02:59+00:00,https://github.com/metabase/metabase/pull/47415,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2495065063,pull_request,closed,,perf: Optimize insights and fingerprinting of time series,"Can be reviewed commit by commit.

1. Improved `redux.core/juxt` and made our functions use it. This is a placeholder before these changes are merged and released in a redux library fork. Completely rewrote `simple-linear-regression` from kixi.stats to allocate less and use primitive math more.

2. Rewrote `fingerprinters/with-error-handling` because the current implementation produced a lot of garbage in closure allocations since `try-catch` is very sensitive to positioning and will compile into functions and closures where it can be avoided if written by hand.

Same single-table benchmark as #47424, 20k rows displayed.

```
Before:

Time per call: 1.62 s      Alloc per call: 1,983,336,344b
Time per call: 1.52 s      Alloc per call: 1,983,146,208b
Time per call: 1.20 s      Alloc per call: 1,983,140,328b
Time per call: 1.55 s      Alloc per call: 1,983,141,464b
Time per call: 1.45 s      Alloc per call: 1,983,130,136b

After:

Time per call: 507.29 ms   Alloc per call: 427,498,416b
Time per call: 615.39 ms   Alloc per call: 427,494,792b
Time per call: 615.08 ms   Alloc per call: 427,495,176b
Time per call: 503.81 ms   Alloc per call: 427,495,624b
Time per call: 523.84 ms   Alloc per call: 427,494,920b
```

<img width=""270"" alt=""image"" src=""https://github.com/user-attachments/assets/395df0d7-90b4-4333-b003-4c85ad3fe7a9"">
",alexander-yakushev,2024-08-29 16:50:08+00:00,['alexander-yakushev'],2024-08-31 10:48:42+00:00,2024-08-31 09:56:37+00:00,https://github.com/metabase/metabase/pull/47414,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2321366379, 'issue_id': 2495065063, 'author': 'alexander-yakushev', 'body': 'Tests seem to be broken on master. This PR is ready to be reviewed.', 'created_at': datetime.datetime(2024, 8, 30, 14, 3, 6, tzinfo=datetime.timezone.utc)}]","alexander-yakushev (Issue Creator) on (2024-08-30 14:03:06 UTC): Tests seem to be broken on master. This PR is ready to be reviewed.

"
2494997760,pull_request,closed,,Manual backport of #47262,Backport of #47262,metamben,2024-08-29 16:18:01+00:00,['metamben'],2024-08-30 13:40:06+00:00,2024-08-30 13:40:04+00:00,https://github.com/metabase/metabase/pull/47413,[],[],
2494972660,pull_request,closed,,"ü§ñ backported ""Fixup backported migrations""","  #47398
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-29 16:06:48+00:00,"['johnswanson', 'github-automation-metabase']",2024-08-29 17:06:34+00:00,2024-08-29 17:06:33+00:00,https://github.com/metabase/metabase/pull/47412,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2494952896,pull_request,closed,,"ü§ñ backported ""Flake Jail Update""","  #47407
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-29 15:58:55+00:00,"['iethree', 'github-automation-metabase']",2024-08-30 17:50:24+00:00,2024-08-30 17:50:24+00:00,https://github.com/metabase/metabase/pull/47411,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2494938849,pull_request,closed,,newsletter-toggle-clicked event,"Closes https://github.com/metabase/metabase/issues/47280

It uses the new generic event schema to track opt-in/opt-out from the newsletter in the setup",npretto,2024-08-29 15:53:45+00:00,['npretto'],2024-09-05 13:06:18+00:00,2024-09-05 13:06:17+00:00,https://github.com/metabase/metabase/pull/47410,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Embedding', '')]","[{'comment_id': 2318217970, 'issue_id': 2494938849, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 28a737bc23fc812499006b5273a44418f931e4ef...dda628b4835e69bc4b8e013abc3f16f64aaa14b9.\n\n| Notify | File(s) |\n|-|-|\n| @ranquild | frontend/src/metabase/setup/components/CompletedStep/CompletedStep.tsx |', 'created_at': datetime.datetime(2024, 8, 29, 15, 55, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2318271975, 'issue_id': 2494938849, 'author': 'ranquild', 'body': ""@npretto I'll deal with backporting the base PR today, just FY."", 'created_at': datetime.datetime(2024, 8, 29, 16, 16, 34, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-29 15:55:07 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 28a737bc23fc812499006b5273a44418f931e4ef...dda628b4835e69bc4b8e013abc3f16f64aaa14b9.

| Notify | File(s) |
|-|-|
| @ranquild | frontend/src/metabase/setup/components/CompletedStep/CompletedStep.tsx |

ranquild on (2024-08-29 16:16:34 UTC): @npretto I'll deal with backporting the base PR today, just FY.

"
2494903286,pull_request,closed,,"ü§ñ backported ""Minor schema fixes before pushing to Snowcat Cloud""","  #47403
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-29 15:39:04+00:00,"['ranquild', 'Somtom', 'github-automation-metabase']",2024-08-30 03:28:20+00:00,2024-08-30 03:28:19+00:00,https://github.com/metabase/metabase/pull/47409,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2494897507,pull_request,closed,,"ü§ñ backported ""Add new generic analytics event and bring types to trackSchemaEvent""","  #46972
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-29 15:36:42+00:00,"['ranquild', 'github-automation-metabase']",2024-08-30 04:37:54+00:00,2024-08-30 04:37:53+00:00,https://github.com/metabase/metabase/pull/47408,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2319891143, 'issue_id': 2494897507, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff f7c10c3311d8f6a204f7158b99d8dfb43b21c2b4...143831ce69e8e374387179f08b0033c999ee6b47.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/lib/settings/analytics.ts |\n| @ranquild | frontend/src/metabase/home/components/EmbedHomepage/analytics.ts<br>frontend/src/metabase/setup/analytics.ts |', 'created_at': datetime.datetime(2024, 8, 30, 3, 22, 56, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-30 03:22:56 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff f7c10c3311d8f6a204f7158b99d8dfb43b21c2b4...143831ce69e8e374387179f08b0033c999ee6b47.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/lib/settings/analytics.ts |
| @ranquild | frontend/src/metabase/home/components/EmbedHomepage/analytics.ts<br>frontend/src/metabase/setup/analytics.ts |

"
2494848750,pull_request,closed,,Flake Jail Update,these tests are flaky most of the time and blocking lots of open PRs,iethree,2024-08-29 15:21:06+00:00,['iethree'],2024-10-08 16:16:03+00:00,2024-08-29 15:58:08+00:00,https://github.com/metabase/metabase/pull/47407,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2494848746,pull_request,closed,,"ü§ñ backported ""Increase log level to INFO from error""",Had to fix a backport. I think someone sorted the list of `name` in the xml file. Just copied the file from the underlying branch so the only thing happening is the intentional change.,github-automation-metabase,2024-08-29 15:21:06+00:00,"['perivamsi', 'github-automation-metabase']",2024-08-29 17:01:17+00:00,2024-08-29 17:00:51+00:00,https://github.com/metabase/metabase/pull/47406,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2494789501,pull_request,closed,,"ü§ñ backported ""Fix failed to backfill cache config due to number overflow""",  #47390,github-automation-metabase,2024-08-29 15:10:19+00:00,"['perivamsi', 'github-automation-metabase']",2024-08-29 16:16:10+00:00,2024-08-29 16:16:10+00:00,https://github.com/metabase/metabase/pull/47405,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2494714701,pull_request,closed,,"ü§ñ backported ""Exclude inactive tables from the perms cache, and block queries over inactive tables in the QP""","  #47363
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-29 14:49:38+00:00,"['noahmoss', 'github-automation-metabase']",2024-08-29 17:05:27+00:00,2024-08-29 17:05:27+00:00,https://github.com/metabase/metabase/pull/47404,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2494634557,pull_request,closed,,Minor schema fixes before pushing to Snowcat Cloud,This PR fixes some minor schema issues I identified when adding the schemas to Snowplow.,Somtom,2024-08-29 14:21:43+00:00,['Somtom'],2024-08-30 03:28:46+00:00,2024-08-29 15:38:11+00:00,https://github.com/metabase/metabase/pull/47403,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2494617863,pull_request,closed,,"ü§ñ backported ""Add Malay Language Support""","  #47138

‚úÖ   Conflict resolved",github-automation-metabase,2024-08-29 14:18:18+00:00,"['iethree', 'github-automation-metabase']",2024-08-30 18:43:59+00:00,2024-08-30 18:43:57+00:00,https://github.com/metabase/metabase/pull/47402,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2494613601,pull_request,closed,,Milestone Check Perms Fix (for real this time) üòÖ ,"follow up to #47377 

OK, found the issue with the milestone check action. There's a problem with the `graphql` method on the `github` object provided by github actions, so I used a separately imported `graphql` method, and it all works as expected.

[Test Run](https://github.com/metabase/metabase/actions/runs/10617716014/job/29431239971?pr=47401)
[Test Slack Message](https://metaboat.slack.com/archives/C01BWAZJE0N/p1724944062907979)",iethree,2024-08-29 14:17:45+00:00,['iethree'],2024-10-08 16:16:01+00:00,2024-08-29 19:08:26+00:00,https://github.com/metabase/metabase/pull/47401,"[('.Building & Releasing', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2494565040,pull_request,closed,,"Followup on ""Fix crash when navigating between bookmarked dashboards""","Followup for #47311 addressing @kamilmielnik's feedback:

1. Added an E2E repro test using Cypress request throttling
2. Switched to a type-guard for better type-safety",kulyk,2024-08-29 14:06:45+00:00,['kulyk'],2024-09-04 13:15:43+00:00,2024-09-02 11:32:31+00:00,https://github.com/metabase/metabase/pull/47400,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2321845678, 'issue_id': 2494565040, 'author': 'kulyk', 'body': 'Thanks @kamilmielnik! All should be addressed now üëç', 'created_at': datetime.datetime(2024, 8, 30, 16, 21, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2324505313, 'issue_id': 2494565040, 'author': 'kulyk', 'body': ""@kamilmielnik not sure what was causing that failure, but I merged in the latest `master` and [it's gone now](https://github.com/metabase/metabase/actions/runs/10665813178)"", 'created_at': datetime.datetime(2024, 9, 2, 11, 27, 20, tzinfo=datetime.timezone.utc)}]","kulyk (Issue Creator) on (2024-08-30 16:21:43 UTC): Thanks @kamilmielnik! All should be addressed now üëç

kulyk (Issue Creator) on (2024-09-02 11:27:20 UTC): @kamilmielnik not sure what was causing that failure, but I merged in the latest `master` and [it's gone now](https://github.com/metabase/metabase/actions/runs/10665813178)

"
2494521960,pull_request,closed,,Fixup backported migrations,"These migrations will be backported to v49.

Three changes:

- update IDs/locations of the migrations to v49 vs v51

- add one preCondition (when adding the foreign key constraint)

- add `onFail: MARK_RAN` to the index preconditions. I forgot this
before, so it blows up when the precondition doesn't hold.",johnswanson,2024-08-29 13:52:27+00:00,['johnswanson'],2024-08-29 16:06:00+00:00,2024-08-29 16:05:58+00:00,https://github.com/metabase/metabase/pull/47398,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2494510553,pull_request,closed,,Increase log level to INFO from error,"Closes #47396

logs before:
```
2024-08-29 08:37:03,836 INFO db.liquibase :: Checking if Database has unrun migrations...
2024-08-29 08:37:04,045 INFO db.liquibase :: Database has unrun migrations. Checking if migration lock is taken...
2024-08-29 08:37:04,047 INFO db.liquibase :: No migration lock found.
2024-08-29 08:37:04,047 INFO db.liquibase :: Migration lock acquired.
2024-08-29 08:37:04,167 INFO db.liquibase :: Running 83 migrations ...
```

logs after:

```
2024-08-29 08:39:45,019 INFO db.liquibase :: Running 83 migrations ...
...
2024-08-29 08:39:45,166 INFO liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-06-27T00:00:00::calherries ran successfully in 0ms
2024-08-29 08:39:45,182 INFO liquibase.changelog :: Columns is_defective_duplicate(boolean) added to metabase_field
2024-08-29 08:39:45,182 INFO liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-06-27T00:00:01::calherries ran successfully in 14ms
2024-08-29 08:39:45,199 INFO liquibase.changelog :: Custom SQL executed
2024-08-29 08:39:45,200 INFO liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-06-27T00:00:02::calherries ran successfully in 16ms
2024-08-29 08:39:45,202 INFO liquibase.changelog :: Foreign key fk_field_parent_ref_field_id dropped
2024-08-29 08:39:45,202 INFO liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-06-27T00:00:03::calherries ran successfully in 1ms
2024-08-29 08:39:45,204 INFO liquibase.changelog :: Foreign key constraint added to metabase_field (parent_id)
2024-08-29 08:39:45,205 INFO liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-06-27T00:00:04::calherries ran successfully in 2ms
...
```
",dpsutton,2024-08-29 13:48:18+00:00,['dpsutton'],2024-08-29 15:20:21+00:00,2024-08-29 15:20:20+00:00,https://github.com/metabase/metabase/pull/47397,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2494493741,pull_request,closed,,"backported ""Much better collection permission performance"" (#47251)","Oh boy, a backport of a backport!

This backports https://github.com/metabase/metabase/pull/47251 which was a backport of https://github.com/metabase/metabase/pull/46942.

The changes are the same (modulo merge conflicts) as in https://github.com/metabase/metabase/pull/47251 plus https://github.com/metabase/metabase/pull/47398.

* Much better collection permission performance (#46942)

PREFACE: THIS IS A BACKPORT COMMIT. And it was a painful one, because some previous very relevant changes hadn't been backported. So there are some changes from the original, non-backported, commit:

- removed all support for getting the trash collection, getting things that were `archived_directly`, or getting collections by `archive_operation_id`. None of these exist in this branch.

- in this branch, functions like `permissions-set->visible-collection-ids` did not check for archived status or anything other than permissions. On `master`, they do. So, the new function that replaced them,
`collection/visible-collection-filter-clause`, also checks for archived status as well as permissions. To resolve this, I chose to just default `collection/visible-collection-filter-clause` to ignore archived status and return both archived and unarchived collections.

On to the original commit message:

There are a few separate changes here:

- Migrations: add and populate indexed columns perm_value, perm_type, and collection_id to permissions

These fields allows us to efficiently run queries based on collection permissions in the DB without string manipulation. Keeping the table as permissions allows us to do this migration in-place. Note that in some cases collections may have been deleted from the database without deleting the associated permissions row (since there was no foreign key before). We need to be defensive here: if we have a permissions row without a corresponding collection, delete the row before running the rest of the migration.

- Write perm_value, perm_type, and collection_id for new collection permissions

A very simple before-insert method sets these fields before a collection permission is written to the DB.

- Replace collection/permissions-set->visible-collection-ids and collection/visible-collection-ids->honeysql-filter-clause with collection/honeysql-filter-clause

Previously, just about everywhere we used permissions-set->visible-collection-ids, what we were essentially doing was an in-app join: select all the collection IDs you have permission on, then convert it to a SQL clause like WHERE collection_id IN ( all of those collection IDs).

Replace both of these with honeysql-filter-clause, which uses the new fields we added to permissions above to construct a honeysql filter representing ""all the collections I have permissions on"", without needing to round-trip them to the application and back to the DB.

Of course, we can then write a function visible-collection-ids, which uses honeysql-filter-clause, for those cases where we do actually need the whole bunch in the application (we use this, for example, when constructing the effective-location for a collection).

I also added one more toggle to the VisibilityConfig that's passed into the honeysql-filter-clause (and used to be passed to permissions-set->visible-collection-ids), allowing you to select only the effective children of some collection.

* Backport: Speed up calculation of effective_ancestors

https://github.com/metabase/metabase/pull/47324

Previously, `visible-collection-ids` was effectively ""free"" in that we'd cached `collection-id->collection` for *all* collections, within a single request, and then locally filtered it for permissions without needing to hit the database again.

To be honest, there is probably a better fix for this - we're repeatedly calling `visible-collection-ids` when we probably could just save a single copy of it and use it when calculating the effective location of every collection.

However, this is a very quick and low-risk fix, and I want to prioritize getting this done, and then we can improve it later.

Locally, I copied down the database from stats and timed the `/api/search?model_ancestors=true` endpoint.

Before my ""speedup"" PR (https://github.com/metabase/metabase/pull/46942) it took ~7 seconds to return results.

After my ""speedup"" PR, it took ~15s to return results. :grimace:

With this change, it takes 818ms to return results. :tada:",johnswanson,2024-08-29 13:42:22+00:00,['johnswanson'],2024-09-03 15:36:40+00:00,2024-09-03 15:36:38+00:00,https://github.com/metabase/metabase/pull/47395,"[('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2494414343,pull_request,closed,,"ü§ñ backported ""locale query string support on public links and static embeds""","  #47186


The code I changed in the original PR is not present here because the refactor was not backported.

The fix is implemented here: https://github.com/metabase/metabase/pull/47393/files#diff-0a7dea40bcaaf115c6e0e7edbf5d2590754965dab67744e00e52e60b5c33f9efR35

Notice it's only one whitelist compared to the original PR because in v50 it's the same component used in multiple places that does the url cleanup (fun fact: the cleanup is only done if there are visible filters in the dashboard, as it's the ui component that does it)

Also the tests needed to be updated (second commit) as the button I was using in the test is not in v50 üôÉ ",github-automation-metabase,2024-08-29 13:15:30+00:00,"['npretto', 'github-automation-metabase']",2024-08-30 15:54:05+00:00,2024-08-30 15:54:03+00:00,https://github.com/metabase/metabase/pull/47393,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2494206719,pull_request,closed,,Metrics dot menu,"Closes https://github.com/metabase/metabase/issues/47322

### Description
Adds a ""..."" menu to the metrics items on the Browse Metrics page to show a context menu with the following items:

- bookmark
- move to trash
- open collection

### To test

1. Make sure you have at least on metric
2. Click metrics in the navigation sidebar
3. Make sure the metrics in the browse metrics page have a ""..."" menu and the menu items work as expected.
 ",romeovs,2024-08-29 11:45:48+00:00,['romeovs'],2024-09-10 14:14:05+00:00,2024-09-10 14:14:03+00:00,https://github.com/metabase/metabase/pull/47391,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2494180031,pull_request,closed,,Fix failed to backfill cache config due to number overflow,fixes #47394 47394,qnkhuat,2024-08-29 11:32:31+00:00,['qnkhuat'],2024-08-29 15:09:26+00:00,2024-08-29 15:09:25+00:00,https://github.com/metabase/metabase/pull/47390,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2494039665,pull_request,closed,,"ü§ñ backported ""update slack-web-api in release helper: brings axios with fixed vuln""",#47385,github-automation-metabase,2024-08-29 10:20:49+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-08-29 10:24:59+00:00,2024-08-29 10:24:58+00:00,https://github.com/metabase/metabase/pull/47389,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2494009319,pull_request,closed,,"ü§ñ backported ""update aws-java-sdk-core: brings in new jackson with fixed vulnerability""",#47384,github-automation-metabase,2024-08-29 10:06:08+00:00,"['piranha', 'github-automation-metabase']",2024-08-29 11:17:55+00:00,2024-08-29 11:17:54+00:00,https://github.com/metabase/metabase/pull/47388,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2493828536,pull_request,closed,,[notification] channel serdes spec,Tests are failing on the feature branch https://github.com/metabase/metabase/actions/runs/10608327582/job/29402219686?pr=45201#step:4:1014,qnkhuat,2024-08-29 08:48:10+00:00,['qnkhuat'],2024-08-29 10:35:42+00:00,2024-08-29 10:35:41+00:00,https://github.com/metabase/metabase/pull/47386,"[('.Team/Workflows', 'aka BEC')]",[],
2493632838,pull_request,closed,,update slack-web-api in release helper: brings axios with fixed vuln,"it's in release-helper, but why not update if it fixes stuff",piranha,2024-08-29 07:12:09+00:00,['piranha'],2024-08-29 10:25:25+00:00,2024-08-29 10:20:01+00:00,https://github.com/metabase/metabase/pull/47385,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2493625780,pull_request,closed,,update aws-java-sdk-core: brings in new jackson with fixed vulnerability,fixes security alert,piranha,2024-08-29 07:08:02+00:00,['piranha'],2024-08-29 11:18:20+00:00,2024-08-29 10:05:19+00:00,https://github.com/metabase/metabase/pull/47384,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2317285939, 'issue_id': 2493625780, 'author': 'piranha', 'body': '@metabase-bot backport release-x.49.x', 'created_at': datetime.datetime(2024, 8, 29, 10, 37, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2317288082, 'issue_id': 2493625780, 'author': 'github-actions[bot]', 'body': '@piranha something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10613451268)', 'created_at': datetime.datetime(2024, 8, 29, 10, 39, 1, tzinfo=datetime.timezone.utc)}]","piranha (Issue Creator) on (2024-08-29 10:37:55 UTC): @metabase-bot backport release-x.49.x

github-actions[bot] on (2024-08-29 10:39:01 UTC): @piranha something went wrong while creating a backport [[Logs]](https://github.com/metabase/metabase/actions/runs/10613451268)

"
2493468014,pull_request,closed,,Fix formatting on master,Fix this formating error on master,qnkhuat,2024-08-29 05:11:57+00:00,['qnkhuat'],2024-10-08 16:16:08+00:00,2024-08-29 07:15:11+00:00,https://github.com/metabase/metabase/pull/47382,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2493351947,pull_request,closed,,Bigquery verify bignumeric fingerprint and bin,"Fixes #28573

Field values must be scanned.

In 45.3, these fields were not being fingerprinted properly. (tag `v1.45.3`) In a 45 point release that appears to have been fixed. (branch `release-x.45.x`) Confirmed fixed in master, adding test
",snoe,2024-08-29 03:07:27+00:00,['snoe'],2024-08-30 16:08:49+00:00,2024-08-30 16:08:48+00:00,https://github.com/metabase/metabase/pull/47381,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Drivers', '')]",[],
2493297917,pull_request,closed,,[Notification] fix cyclic deps,"the feature branch be-check is failing due to cyclic deps: https://github.com/metabase/metabase/actions/runs/10578335391/job/29308268988
instead of loading channel namespaces preemptively, we load them when we start MB",qnkhuat,2024-08-29 02:06:51+00:00,['qnkhuat'],2024-08-29 10:27:58+00:00,2024-08-29 10:27:57+00:00,https://github.com/metabase/metabase/pull/47379,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2316577806, 'issue_id': 2493297917, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff b6602d562cc58ca6a46974fe2305396ec70f3e83...6a73f2f8155c4a1790083d105e611abc516cda53.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/lib/save-chart-image.ts<br>frontend/src/metabase/visualizations/visualizations/RowChart/utils/events.ts<br>frontend/src/metabase/visualizations/visualizations/RowChart/utils/events.unit.spec.ts |\n| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/index.ts<br>frontend/src/metabase/ui/components/icons/Icon/icons/webhook.svg<br>frontend/src/metabase/ui/components/inputs/Chip/Chip.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Chip/index.ts<br>frontend/src/metabase/ui/components/inputs/index.ts<br>frontend/src/metabase/ui/theme.ts |', 'created_at': datetime.datetime(2024, 8, 29, 2, 8, 28, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-29 02:08:28 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff b6602d562cc58ca6a46974fe2305396ec70f3e83...6a73f2f8155c4a1790083d105e611abc516cda53.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/lib/save-chart-image.ts<br>frontend/src/metabase/visualizations/visualizations/RowChart/utils/events.ts<br>frontend/src/metabase/visualizations/visualizations/RowChart/utils/events.unit.spec.ts |
| @kdoh | frontend/src/metabase/ui/components/icons/Icon/icons/index.ts<br>frontend/src/metabase/ui/components/icons/Icon/icons/webhook.svg<br>frontend/src/metabase/ui/components/inputs/Chip/Chip.styled.tsx<br>frontend/src/metabase/ui/components/inputs/Chip/index.ts<br>frontend/src/metabase/ui/components/inputs/index.ts<br>frontend/src/metabase/ui/theme.ts |

"
2493252616,pull_request,closed,,Enable native pivot xlsx and Incrementally add rows to Native Pivot xlsx exports,"This PR adds a boolean env var `MB_TEMP_NATIVE_PIVOT_EXPORTS` which enables the 'native pivot' feature in Downloads of xlsx files.

Targeting the 50 branch only for now, as pivot export improvements are being added holistically in 51.
Relevant Slack thread discussing this:

https://metaboat.slack.com/archives/C01LQQ2UW03/p1724874779867859",adam-james-v,2024-08-29 01:11:22+00:00,['adam-james-v'],2024-08-30 18:16:52+00:00,2024-08-30 18:16:26+00:00,https://github.com/metabase/metabase/pull/47378,"[('.Team/DashViz', 'Dashboard and Viz team')]",[],
2493130536,pull_request,closed,,Update milestone check workflow,"- use `GH_TOKEN` instead of `GITHUB_TOKEN` to hopefully fix CI permission error ü§û 
- update milestone check logic to ignore patch releases when determining when the ""last"" release was for the purpose of milestone correctness
- update milestone check logic to ignore documentation PRs
",iethree,2024-08-28 23:14:15+00:00,['iethree'],2024-10-08 16:16:08+00:00,2024-08-29 13:39:19+00:00,https://github.com/metabase/metabase/pull/47377,"[('.Building & Releasing', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2493059504,pull_request,closed,,"ü§ñ backported ""Fix CSV uploads for non-ASCII headers""","  #47297
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-28 22:00:46+00:00,"['crisptrutski', 'github-automation-metabase']",2024-08-30 14:22:05+00:00,2024-08-30 14:22:04+00:00,https://github.com/metabase/metabase/pull/47372,"[('.Team/Workflows', 'aka BEC'), ('was-backported', 'apply this to PRs that are themselves backports')]",[],
2493048106,pull_request,closed,,Simplify question cache e2e tests,"Simplification of #45231 
",iethree,2024-08-28 21:50:37+00:00,['iethree'],2024-08-29 22:51:07+00:00,2024-08-29 22:51:05+00:00,https://github.com/metabase/metabase/pull/47371,"[('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2493045878,pull_request,closed,,Update Kondo to `2024.08.01` and add `deps.edn` aliases to run from the JVM,"I wanted to upgrade Kondo to the latest version but realized that it's sort of a problem that you can't easily switch between versions when you install the command-line version of `clj-kondo` thru Homebrew or whatever -- this is especially an issue between branches since the 50.x branch will still be targeting `2023.09.07` while `master` is targeting `2024.08.01` -- it's ridiculous to have to reinstall different versions of Kondo when switching branches.

So instead I added a new `clojure -M:kondo` alias so we can pin a specific version in `deps.edn` and run that specific version from the JVM.

You can now run Kondo locally without having to install `clj-kondo` like this:

```sh
clojure -M:kondo --lint src test

clojure -M:kondo --version

clojure -M:kondo --debug --lint src/metabase/broken_file.clj
```

I also added a `:kondo/all` alias to lint everything: 

```sh
clojure -M:kondo:kondo/all
```

This also has the added benefit of us not having to download and install Kondo in every CI run since the JVM Kondo dep lives in `~/.m2` and can get cached between runs just like every other dep. And it's one less thing to install for anyone trying to set things up locally!

### Performance

I don't know if it's because of upgrades in Kondo or what but linting **everything** is actually a little faster for me now than the old CLI version was.

### `clj-kondo --parallel --lint ...` (old version)

```sh
dirs=$(find modules/drivers enterprise/backend \
            -maxdepth 2 \
            -type d \
            -name src -or -name test)

command=""time clj-kondo --parallel --lint bin src test $dirs""

$command

real    1m5.064s
user    1m24.885s
sys     0m5.797s
```

### `clojure -M:kondo/kondo-all` with `--parallel`

```sh
time clojure -M:kondo:kondo/all

real    0m50.266s
user    3m31.058s
sys     0m4.081s
```

### `clojure -M:kondo/kondo-all` without `--parallel`

```sh
time clojure -M:kondo:kondo/all
linting took 59193ms, errors: 0, warnings: 0

real    1m4.243s
user    1m58.180s
sys     0m3.849s
```

Linting just single files or whatever is predictably slower because of the JVM startup overhead of a few seconds, but that should only really matter for editors, right? So you probably still want to configure your editor to use LSP or the CLI version of Kondo.
",camsaul,2024-08-28 21:48:33+00:00,['camsaul'],2024-10-08 16:16:02+00:00,2024-08-29 17:24:33+00:00,https://github.com/metabase/metabase/pull/47370,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]",[],
2492976318,pull_request,closed,,Cards in dashboards: milestone 1 (backend),"- migrations to add `report_card.dashboard_id`, and an index/foreign key for it
- accept a `dashboard_id` parameter for `POST /api/card/`
- accept a `dashboard_id` parameter for `PUT /api/card/`
- return `dashboard_id` from the search API
- do not show dashboard questions without a DashboardCard in the search API
- do not show dashboard questions in the autocomplete API
- modifies `POST /api/dashboard/:id/copy` to always copy dashboard questions
- modifies `PUT /api/dashboard/:id` to automatically move dashboard questions along with the dashboard
- modifies the Search API to allow including (or not) dashboard questions

Product doc: https://www.notion.so/metabase/Enable-saving-questions-directly-to-dashboards-and-make-this-the-default-path-a84be6e0540241189b251401fb35ca91#f9bbd61d8bc442ab8eaf908c680394b4

Epic: https://github.com/metabase/metabase/issues/47326",johnswanson,2024-08-28 20:56:15+00:00,['johnswanson'],2025-02-04 01:31:24+00:00,2025-02-04 01:31:23+00:00,https://github.com/metabase/metabase/pull/47369,"[('Stale', 'Stale PRs that will be auto-closed'), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2337328156, 'issue_id': 2492976318, 'author': 'crisptrutski', 'body': ""PS sorry if I'm reviewing prematurely, I see it was automation on the migrations file that had added BEC to review."", 'created_at': datetime.datetime(2024, 9, 9, 7, 23, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603449835, 'issue_id': 2492976318, 'author': 'github-actions[bot]', 'body': 'This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.', 'created_at': datetime.datetime(2025, 1, 21, 1, 31, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2632557595, 'issue_id': 2492976318, 'author': 'github-actions[bot]', 'body': 'This pull request was closed because it had no activity for more than 90 days.', 'created_at': datetime.datetime(2025, 2, 4, 1, 31, 23, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-09-09 07:23:24 UTC): PS sorry if I'm reviewing prematurely, I see it was automation on the migrations file that had added BEC to review.

github-actions[bot] on (2025-01-21 01:31:12 UTC): This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.

github-actions[bot] on (2025-02-04 01:31:23 UTC): This pull request was closed because it had no activity for more than 90 days.

"
2492883185,pull_request,closed,,Metrics notebook step restrictions,"Epic https://github.com/metabase/metabase/issues/47147
Closes https://github.com/metabase/metabase/issues/47152
Closes https://github.com/metabase/metabase/issues/47588
Corresponding BE PR https://github.com/metabase/metabase/pull/47626

Changes:
- Data step - after selecting data source the ""count"" aggregation is applied automatically
- Summarize step - only 1 aggregation which cannot be removed
- Breakout step - 0 or 1 breakouts, can be removed, only date or datetime columns

Note - opening the aggregation popover would be done separately. 

<img width=""1307"" alt=""Screenshot 2024-09-03 at 15 30 53"" src=""https://github.com/user-attachments/assets/bb33bdb9-06d9-4962-acd7-f5f745c380f5"">
<img width=""1287"" alt=""Screenshot 2024-09-03 at 15 31 23"" src=""https://github.com/user-attachments/assets/cbb16416-976c-4ad9-a71d-553139d9c14d"">
",ranquild,2024-08-28 19:56:28+00:00,['ranquild'],2024-09-05 19:23:52+00:00,2024-09-05 19:23:50+00:00,https://github.com/metabase/metabase/pull/47368,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2332469758, 'issue_id': 2492883185, 'author': 'alxnddr', 'body': '> Data step - after selecting data source the ""count"" aggregation is applied automatically\r\n> Summarize step - only 1 aggregation which cannot be removed\r\n> Breakout step - 0 or 1 breakouts, can be removed, only date or datetime columns\r\n\r\nShould we disable ""Compare to the past""? I can add more columns using it but it is not possible to save the metric or remove the columns\r\n\r\n<img width=""1317"" alt=""Screenshot 2024-09-05 at 3 18 12\u202fPM"" src=""https://github.com/user-attachments/assets/bb51dab0-7265-47af-a2b1-8ee50be6217e"">', 'created_at': datetime.datetime(2024, 9, 5, 19, 19, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2332471329, 'issue_id': 2492883185, 'author': 'ranquild', 'body': '@alxnddr ""Should we disable ""Compare to the past"" - yes we should, I was going to do that separately.', 'created_at': datetime.datetime(2024, 9, 5, 19, 20, 59, tzinfo=datetime.timezone.utc)}]","alxnddr on (2024-09-05 19:19:55 UTC): Should we disable ""Compare to the past""? I can add more columns using it but it is not possible to save the metric or remove the columns

<img width=""1317"" alt=""Screenshot 2024-09-05 at 3 18 12‚ÄØPM"" src=""https://github.com/user-attachments/assets/bb51dab0-7265-47af-a2b1-8ee50be6217e"">

ranquild (Issue Creator) on (2024-09-05 19:20:59 UTC): @alxnddr ""Should we disable ""Compare to the past"" - yes we should, I was going to do that separately.

"
2492786255,pull_request,closed,,Realign migration ids,"resolves #47336

When backporting this, I changed the migration id for it (which is illegal). I am updating it on the master branch as @qnkhuat reccomended. This makes more sense than doing it on the release branch because:

1. we don't want v51 migrations in the `release-x.50.x` branch.
2. this passes the [downgrade check](https://github.com/metabase/metabase/blob/854b3c5668dc0286658983065d52a45f40bb78cf/src/metabase/db/setup.clj#L123) we do on startup
3. this way we don't need to backport _this_ change",escherize,2024-08-28 18:54:30+00:00,['escherize'],2024-08-29 22:46:07+00:00,2024-08-29 22:46:06+00:00,https://github.com/metabase/metabase/pull/47367,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2492723437,pull_request,closed,,"ü§ñ backported ""Adding schema name to recents, search results in CP""","  #47255
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-28 18:18:51+00:00,"['npfitz', 'github-automation-metabase']",2024-08-29 11:55:04+00:00,2024-08-29 11:55:02+00:00,https://github.com/metabase/metabase/pull/47366,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2492722518,pull_request,closed,,"ü§ñ backported ""Support ctrl + click on command palette links again""",#47328,github-automation-metabase,2024-08-28 18:18:16+00:00,"['npfitz', 'github-automation-metabase']",2024-08-28 18:53:03+00:00,2024-08-28 18:53:02+00:00,https://github.com/metabase/metabase/pull/47365,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2492721836,pull_request,closed,,"ü§ñ backported ""Populate permission cache only for one DB at a time""","  #47332
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-28 18:17:53+00:00,"['noahmoss', 'github-automation-metabase']",2024-08-28 19:23:33+00:00,2024-08-28 19:23:32+00:00,https://github.com/metabase/metabase/pull/47364,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2492721717,pull_request,closed,,"Exclude inactive tables from the perms cache, and block queries over inactive tables in the QP","* Excludes inactive tables from the permissions cache. This is the same optimization I initially included in https://github.com/metabase/metabase/pull/47332
* Explicitly rejects queries on inactive tables in the permissions QP middleware. This ensures consistent behavior for saved questions using tables that were subsequently deleted, and thus marked as inactive. See [here](https://metaboat.slack.com/archives/C064EB1UE5P/p1724865614315129?thread_ts=1724864863.352419&cid=C064EB1UE5P) for product justification.

Pursuant to https://github.com/metabase/metabase/issues/47276",noahmoss,2024-08-28 18:17:48+00:00,['noahmoss'],2024-08-29 17:05:55+00:00,2024-08-29 14:48:48+00:00,https://github.com/metabase/metabase/pull/47363,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2315986916, 'issue_id': 2492721717, 'author': 'noahmoss', 'body': '* **#47363** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47363?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 28, 18, 18, 20, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-08-28 18:18:20 UTC): * **#47363** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47363?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2492692459,pull_request,closed,,Support multiple bucketings of a column in nested queries,"Fixes #46644

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",metamben,2024-08-28 18:00:09+00:00,['metamben'],2024-08-28 22:41:10+00:00,2024-08-28 22:41:08+00:00,https://github.com/metabase/metabase/pull/47362,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2492662566,pull_request,closed,,fix trend lines scaling,"Closes https://github.com/metabase/metabase/issues/47351

### Description

Introduced in https://github.com/metabase/metabase/pull/43668. The scaling formatting setting implementation has changed significantly in the PR and updating trend lines to support it got missing.

This PR scales the trend lines dataset to match the original scaled dataset when scaling settings are applied.

### How to verify

- New -> Orders: Count group by Created At -> make it a line chart
- Enable trend lines
- Go to the ""Data"" tab, under ""Y-axis"" section open the formatting settings for ""Count""
- Set ""Multiply by a number"" to 0.01 
- Ensure the trend line appears correctly

### Demo

Before
<img width=""1120"" alt=""Screenshot 2024-08-28 at 1 38 17‚ÄØPM"" src=""https://github.com/user-attachments/assets/a35b2305-c4f6-402f-9be7-2a41807f91ba"">

After
<img width=""1488"" alt=""Screenshot 2024-08-28 at 1 38 01‚ÄØPM"" src=""https://github.com/user-attachments/assets/9a3321dd-3520-4db1-b303-4c3297b8d18b"">


### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",alxnddr,2024-08-28 17:41:25+00:00,['alxnddr'],2024-08-30 14:50:46+00:00,2024-08-30 14:50:45+00:00,https://github.com/metabase/metabase/pull/47361,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2492489718,pull_request,closed,,"ü§ñ backported ""Fix crash when navigating between bookmarked dashboards""",#47311,github-automation-metabase,2024-08-28 16:01:21+00:00,"['kulyk', 'github-automation-metabase']",2024-08-28 16:33:51+00:00,2024-08-28 16:33:50+00:00,https://github.com/metabase/metabase/pull/47358,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2492429002,pull_request,closed,,"Revert ""Add :legacy/merge-indents? to .cljfmt.edn (#47345)""",Reverts attempt to make cljfmt work with vscode as it seems to cause problems as in https://github.com/metabase/metabase/actions/runs/10598919594/job/29372665653?pr=47332,lbrdnk,2024-08-28 15:30:52+00:00,['lbrdnk'],2024-10-08 16:16:15+00:00,2024-08-28 15:32:41+00:00,https://github.com/metabase/metabase/pull/47357,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2492380180,pull_request,closed,,Quieter Patch Releases,"### Description

- Auto-merging ee-extra PRs seems to work well, and reviews were merely perfunctory, so they will now always [auto-merge](https://metaboat.slack.com/archives/C864UT5CZ/p1724857146273149?thread_ts=1724751785.038469&cid=C864UT5CZ) if tests pass for both minor and patch releases.
- [EMs will no longer be tagged on releases](https://metaboat.slack.com/archives/C864UT5CZ/p1724373962585969?thread_ts=1724372984.555279&cid=C864UT5CZ), since they don't have to review EE-extra PRs
- We will [no longer create cloud update issue for patches](https://metaboat.slack.com/archives/C864UT5CZ/p1724772027102349), since we don't want to set a patch to a default.

",iethree,2024-08-28 15:08:27+00:00,['iethree'],2024-10-08 16:16:12+00:00,2024-08-28 16:12:48+00:00,https://github.com/metabase/metabase/pull/47356,"[('.Building & Releasing', ''), ('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2492355490,pull_request,closed,,typed action event,"Quick poc, we would define events like

```ts
type SetupNewsLetterToggleClicked = ActionEvent<
  ""setup-newsletter-toggle-clicked"",
  { eventDetail: ""opted-in"" | ""opted-out"" }
>;
```

And then use the track function like
```ts
trackActionEvent(""setup-newsletter-toggle-clicked"", {
  eventDetail: ""opted-in"",
});
```

If we wanna go with this we should probably make an analytics folder to split types in multiple files to avoid circular deps.

Something like
analytics/analytics.ts (current file)
analytics/types.ts (the generic types also for the ActionEvent)
analytics/action-events.ts (that contains the `AnyActionEvent` (or whatever we'llname it) to list all possible events)",npretto,2024-08-28 14:58:49+00:00,['npretto'],2025-02-04 14:55:08+00:00,2024-09-02 07:51:28+00:00,https://github.com/metabase/metabase/pull/47355,"[('.Team/Embedding', '')]",[],
2492309353,pull_request,closed,,Convert Save Question Form to mantine,[discussion](https://metaboat.slack.com/archives/C057WD5L0JG/p1724231593867429),oisincoveney,2024-08-28 14:44:42+00:00,[],2024-09-24 21:25:12+00:00,2024-09-24 21:25:12+00:00,https://github.com/metabase/metabase/pull/47354,[],"[{'comment_id': 2372414732, 'issue_id': 2492309353, 'author': 'iethree', 'body': 'closing this for now so github stops yelling at me. These problems will be fixed as part of https://github.com/metabase/metabase/issues/45941', 'created_at': datetime.datetime(2024, 9, 24, 21, 25, 12, tzinfo=datetime.timezone.utc)}]","iethree on (2024-09-24 21:25:12 UTC): closing this for now so github stops yelling at me. These problems will be fixed as part of https://github.com/metabase/metabase/issues/45941

"
2492262396,pull_request,open,,Dashboard Viz: Prevent 'Popover' on clicking 'View More',"Closes https://github.com/metabase/metabase/issues/42790

### Description

Changes with this PR should prevent popover on Expanding/Collapsing body in detail of Sample Database.

### How to verify

1. Go to Database -> Sample Database -> Review Table -> Detail Visualization 
2. Click on View more/less
3. On clicking, filter popup should not appear unless user explicitly clicks on the body text.

### Demo

_Upload a demo video or before/after screenshots if sensible or remove the section_

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",ashishdaulatabad,2024-08-28 14:31:15+00:00,[],2025-01-28 01:31:05+00:00,,https://github.com/metabase/metabase/pull/47353,"[('Stale', 'Stale PRs that will be auto-closed')]","[{'comment_id': 2617438288, 'issue_id': 2492262396, 'author': 'github-actions[bot]', 'body': 'This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.', 'created_at': datetime.datetime(2025, 1, 28, 1, 31, 3, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-01-28 01:31:03 UTC): This pull request has had no activity for 90 days, it will be closed in 2 weeks if no further activity occurs.

"
2492200349,pull_request,closed,,"ü§ñ backported ""fix(admin/performance): Ensure that adding or removing default values doesn't make cache policy form count as dirty""","  #46543
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-28 14:10:55+00:00,"['rafpaf', 'github-automation-metabase']",2024-09-10 15:33:41+00:00,2024-09-10 15:33:39+00:00,https://github.com/metabase/metabase/pull/47352,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2492060345,pull_request,closed,,"ü§ñ backported ""[QP] Return datetimes in SQL Server, even with date-sized truncation""",#47248,github-automation-metabase,2024-08-28 13:19:05+00:00,"['bshepherdson', 'github-automation-metabase']",2024-08-28 14:11:43+00:00,2024-08-28 14:11:42+00:00,https://github.com/metabase/metabase/pull/47350,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2492029113,pull_request,closed,,Add test against serialization YAML format changing,"Closes https://github.com/metabase/metabase/issues/47222

### Description

This adds a test to check that our YAML output is stable across loading and then dumping again.

If there are differences when running from the REPL, the `dev/serialization_deltas` folder will be populated with pairs of files for further examination. Typically the diff shown in the test output should be enough though.

### Notes

1. There is a lot of noise from adding the baseline files, but that's all in the first commit. I recommend looking directly at the second commit. Or just the first file üòÜ 
2. I first though to use a zipfile for the baseline, to avoid bloating diffs and checkouts, but then thought for future changes it will be nice to see the diff in the review. Also we have the `instance_analytics` data unzipped as well, so there's some precedent.
3. The dump is fairly minimal for now, but it is easy to augment in future.",crisptrutski,2024-08-28 13:06:35+00:00,['crisptrutski'],2024-08-30 08:57:15+00:00,2024-08-30 08:57:14+00:00,https://github.com/metabase/metabase/pull/47349,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2315294958, 'issue_id': 2492029113, 'author': 'piranha', 'body': ""I think this makes sense, but one thing that's a bit weird in setup like this is actually updating it with new data and new scenarios. Like what do you do if you want to add an action?.."", 'created_at': datetime.datetime(2024, 8, 28, 13, 16, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2315307341, 'issue_id': 2492029113, 'author': 'crisptrutski', 'body': ""> I think this makes sense, but one thing that's a bit weird in setup like this is actually updating it with new data and new scenarios. Like what do you do if you want to add an action?..\r\n\r\nWhat I did is go to the corresponding storage test, and replaced its reference to a temp directory with a reference to the baseline directory where I accumulated outputs.\r\n\r\nI should actually make that more convenient + document it."", 'created_at': datetime.datetime(2024, 8, 28, 13, 22, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2315659594, 'issue_id': 2492029113, 'author': 'crisptrutski', 'body': ""> I think this makes sense, but one thing that's a bit weird in setup like this is actually updating it with new data and new scenarios. Like what do you do if you want to add an action?..\r\n\r\nMade a helper, and added some tests to prod people with when and how to use it. Let me know what you think."", 'created_at': datetime.datetime(2024, 8, 28, 15, 21, 9, tzinfo=datetime.timezone.utc)}]","piranha on (2024-08-28 13:16:56 UTC): I think this makes sense, but one thing that's a bit weird in setup like this is actually updating it with new data and new scenarios. Like what do you do if you want to add an action?..

crisptrutski (Issue Creator) on (2024-08-28 13:22:19 UTC): What I did is go to the corresponding storage test, and replaced its reference to a temp directory with a reference to the baseline directory where I accumulated outputs.

I should actually make that more convenient + document it.

crisptrutski (Issue Creator) on (2024-08-28 15:21:09 UTC): Made a helper, and added some tests to prod people with when and how to use it. Let me know what you think.

"
2492027594,pull_request,closed,,feat(sdk): add the create question component demo to the cli,"Closes https://github.com/metabase/metabase/issues/47343

### Description

Adds a quick demo for the `<CreateQuestion />` component to the CLI's generated React components.

### How to verify

- Run `yarn build-embedding-sdk-cli:watch` in one terminal to build the CLI
- Create an empty React project with Vite
- Run `docker rm -f metabase-enterprise-embedding && yarn add file:../metabase/resources/embedding-sdk && npx @metabase/embedding-sdk-react start`
  - This kills existing Docker container, links the built SDK to your React project, then starts the CLI.
  - This only works if your metabase repo is adjacent to the React project. If not, adjust the `file:..` part
- Follow the flow. Import the `<AnalyticsPage />` React component per the instructions and play with it.
- Play with the ""create question"" button on the right side.

### Limitations

The `CreateQuestion` component currently only queries tables - it has `{models: ""tables""}` as part of the query payload. We'll update the code sample once https://github.com/metabase/metabase/issues/47347 is implemented in the SDK.

This PR should be merged before these SDK improvements are integrated, in which I will update the code snippet once again in a separate PR:
- https://github.com/metabase/metabase/issues/47464
- https://github.com/metabase/metabase/issues/47346
- https://github.com/metabase/metabase/issues/47347

### Demo

<div>
    <a href=""https://www.loom.com/share/8fddd34d0792497aaf922e609aade57a"">
      <p>Create Question - CLI Demo - Watch Video</p>
    </a>
    <a href=""https://www.loom.com/share/8fddd34d0792497aaf922e609aade57a"">
      <img style=""max-width:300px;"" src=""https://cdn.loom.com/sessions/thumbnails/8fddd34d0792497aaf922e609aade57a-8a2ff4858abe2bcf-full-play.gif"">
    </a>
  </div>

The permissions of the ""Our models"" collection should now be ""curate"" for the sandboxed users, and the 3 chosen models should now be created in the ""Our models"" collection.

<img src=""https://github.com/user-attachments/assets/58369dd7-28e8-4382-90f1-313e6be3a516"" width=""300""> ",heypoom,2024-08-28 13:05:58+00:00,['oisincoveney'],2024-09-09 09:48:26+00:00,2024-09-09 09:48:24+00:00,https://github.com/metabase/metabase/pull/47348,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2491865467,pull_request,closed,,Make cljfmt work with vscode,`cljfmt` stopped working for me after recent changes to our formatting config. Change in this PR makes it work correctly again. Reference to docs can be found in a comment.,lbrdnk,2024-08-28 11:50:27+00:00,['lbrdnk'],2024-10-08 16:16:14+00:00,2024-08-28 13:54:31+00:00,https://github.com/metabase/metabase/pull/47345,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2491223709,pull_request,closed,,[backport] add a test to check that openapi definitions can be generated,Backport of #44586,piranha,2024-08-28 06:52:33+00:00,['piranha'],2024-08-28 10:10:45+00:00,2024-08-28 10:10:40+00:00,https://github.com/metabase/metabase/pull/47335,"[('.Team/Workflows', 'aka BEC'), ('was-backported', 'apply this to PRs that are themselves backports')]",[],
2490713124,pull_request,closed,,"ü§ñ backported ""fix stacked row tooltip shows null values""",#47333,github-automation-metabase,2024-08-28 02:00:44+00:00,"['alxnddr', 'github-automation-metabase']",2024-08-28 02:33:50+00:00,2024-08-28 02:33:50+00:00,https://github.com/metabase/metabase/pull/47334,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2313941718, 'issue_id': 2490713124, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 58eda67f6d8a6884c9788e6842496f318ac4f206...aeb93d724309f8f864b31b07fdb4b15d8728124a.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/visualizations/RowChart/utils/events.ts<br>frontend/src/metabase/visualizations/visualizations/RowChart/utils/events.unit.spec.ts |', 'created_at': datetime.datetime(2024, 8, 28, 2, 2, 5, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-28 02:02:05 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 58eda67f6d8a6884c9788e6842496f318ac4f206...aeb93d724309f8f864b31b07fdb4b15d8728124a.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/visualizations/RowChart/utils/events.ts<br>frontend/src/metabase/visualizations/visualizations/RowChart/utils/events.unit.spec.ts |

"
2490676713,pull_request,closed,,fix stacked row tooltip shows null values,"Closes https://github.com/metabase/metabase/issues/46396

### Description

Tooltip on stacked row charts should not show null values, this PR fixes this.

### How to verify

```sql
select 'foo' d, 10 m1, 20 m2, null m3, 1 m4
union all select 'bar', null, null, 1, null
```

- create the native query
- assign ""d"" column to y-axis, assign other columns to x-axis
- make it stacked
- ensure when you hover on any bar the tooltip does not show null values

### Demo

<img width=""1272"" alt=""Screenshot 2024-08-27 at 9 25 07‚ÄØPM"" src=""https://github.com/user-attachments/assets/a2db419f-fcb1-41c0-b9a6-76e4f7d445d0"">

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",alxnddr,2024-08-28 01:27:21+00:00,['alxnddr'],2024-08-28 01:59:54+00:00,2024-08-28 01:59:54+00:00,https://github.com/metabase/metabase/pull/47333,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2490572383,pull_request,closed,,Populate permission cache only for one DB at a time,"Splits up the permissions cache so that we fetch it on-demand only for a single DB at a time. I've converted it from a `delay` to an atom that contains both the cached `perms`, and a set of `db-ids` which we've already fetched.

I've also excluded deactivated tables when fetching perms, both straight from the DB as well as when the cache is populated. These tables are essentially invisible to the application so this should be safe.

Also bumped methodical to include https://github.com/camsaul/methodical/pull/150. I'd normally do this as a separate PR but I want to save time getting these in.

Resolves https://github.com/metabase/metabase/issues/47276

### Timing

Here's a timing comparison on an instance with 10 DBs with 1,000 tables each, with permissions set granularly at the table-level for multiple permission types. This shows the request timing when a non-admin does a refresh of a dashboard that includes one card over the sample databases, but doesn't touch any of the large databases.

In this situation, the slow `query_metadata` and `query` API calls have been eliminated. The `database` call time has been cut in half, and this call is only done once on the initial page load, so it's less impactful.

On master             |  On PR branch
:-------------------------:|:-------------------------:
![](https://github.com/user-attachments/assets/ef473a21-c998-46b4-bb0d-1671518bdd27)  |  ![](https://github.com/user-attachments/assets/456d1e06-4f35-4762-88e1-a26e79edd428)",noahmoss,2024-08-28 00:12:19+00:00,['noahmoss'],2024-08-28 18:16:51+00:00,2024-08-28 18:16:50+00:00,https://github.com/metabase/metabase/pull/47332,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2313784792, 'issue_id': 2490572383, 'author': 'noahmoss', 'body': '* **#47332** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47332?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 28, 0, 12, 35, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-08-28 00:12:35 UTC): * **#47332** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47332?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2490390702,pull_request,closed,,"ü§ñ backported ""docs - clarify caching doc""",#47330,github-automation-metabase,2024-08-27 21:17:00+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-27 21:18:28+00:00,2024-08-27 21:18:27+00:00,https://github.com/metabase/metabase/pull/47331,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2490362451,pull_request,closed,,docs - clarify caching doc,"Minor note re: ""Don't cache results"".",jeff-bruemmer,2024-08-27 21:09:51+00:00,['jeff-bruemmer'],2024-08-27 21:18:53+00:00,2024-08-27 21:16:09+00:00,https://github.com/metabase/metabase/pull/47330,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2490253128,pull_request,closed,,Support ctrl + click on command palette links again,"Closes https://github.com/metabase/metabase/issues/45205

### Description
Migrating the location changing logic from the command palette action back to the link element. Should support regular click, ctrl + click, right click -> new tab and keyboard navigation + enter.  (I only know how to write tests for 2 of those though üò¢ )

### How to verify
1. Open the command palette
2. Search for something
3. hold ctrl when clicking on a result. it should open in a new tab.

### Demo
![chrome_P2aAC3J2vI](https://github.com/user-attachments/assets/2bc77c0e-0e05-4957-b59b-c72f4db2c729)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",npfitz,2024-08-27 20:20:09+00:00,['npfitz'],2024-08-28 18:17:26+00:00,2024-08-28 18:17:24+00:00,https://github.com/metabase/metabase/pull/47328,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2490243948,pull_request,closed,,Manual backport of #47155,https://github.com/metabase/metabase/pull/47155,metamben,2024-08-27 20:14:12+00:00,['metamben'],2024-08-28 00:04:35+00:00,2024-08-28 00:04:05+00:00,https://github.com/metabase/metabase/pull/47327,[],[],
2490150102,pull_request,closed,,"ü§ñ backported ""Ensure that CI checks fail if cljs tests fail""","  #47192
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-27 19:16:38+00:00,"['appleby', 'github-automation-metabase']",2024-08-27 23:39:33+00:00,2024-08-27 23:39:31+00:00,https://github.com/metabase/metabase/pull/47325,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2313388534, 'issue_id': 2490150102, 'author': 'appleby', 'body': ""Resolved conflicts in legacy-ref-test related to a metrics test that depends on changes that weren't backported.\r\n\r\nRelevant unbackported changes in 460ac41f6f7a31c4f705c4bdfe53af8e8c65e164"", 'created_at': datetime.datetime(2024, 8, 27, 19, 53, 5, tzinfo=datetime.timezone.utc)}]","appleby (Assginee) on (2024-08-27 19:53:05 UTC): Resolved conflicts in legacy-ref-test related to a metrics test that depends on changes that weren't backported.

Relevant unbackported changes in 460ac41f6f7a31c4f705c4bdfe53af8e8c65e164

"
2490110459,pull_request,closed,,Speed up calculation of effective_ancestors,"Previously, `visible-collection-ids` was effectively ""free"" in that we'd cached `collection-id->collection` for *all* collections, within a single request, and then locally filtered it for permissions without needing to hit the database again.

To be honest, there is probably a better fix for this - we're repeatedly calling `visible-collection-ids` when we probably could just save a single copy of it and use it when calculating the effective location of every collection.

However, this is a very quick and low-risk fix, and I want to prioritize getting this done, and then we can improve it later.

Locally, I copied down the database from stats and timed the `/api/search?model_ancestors=true` endpoint.

Before my ""speedup"" PR (https://github.com/metabase/metabase/pull/46942) it took ~7 seconds to return results.

After my ""speedup"" PR, it took ~15s to return results. üò¨ 

With this change, it takes <1s to return results. :tada:
",johnswanson,2024-08-27 18:54:35+00:00,['johnswanson'],2024-10-08 16:16:17+00:00,2024-08-27 20:56:41+00:00,https://github.com/metabase/metabase/pull/47324,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2490087006,pull_request,closed,,Update instance_analytics for 50 major release,Serialized using 50.22,luizarakaki,2024-08-27 18:41:49+00:00,['luizarakaki'],2024-08-30 22:03:27+00:00,2024-08-29 16:51:06+00:00,https://github.com/metabase/metabase/pull/47323,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2314602795, 'issue_id': 2490087006, 'author': 'crisptrutski', 'body': ""It seems that the audit instance is running version `80813cb`, which is an old version of master which predated the bug-bashing involved in the refactor. It seems that this issue was fixed before the changes as a whole were backported, so I think we're in the clear."", 'created_at': datetime.datetime(2024, 8, 28, 7, 59, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2315478510, 'issue_id': 2490087006, 'author': 'luizarakaki', 'body': ""> It seems that the audit instance is running version `80813cb`, which is an old version of master which predated the bug-bashing involved in the refactor. It seems that this issue was fixed before the changes as a whole were backported, so I think we're in the clear.\r\n\r\nYeah, my mistake. I used to serialize using a local jar, but now we do it using the API and for some reason the instance was outdated. I restarted the instance and it is now following `master` again.\r\n\r\nYamls look good now"", 'created_at': datetime.datetime(2024, 8, 28, 14, 21, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2317108565, 'issue_id': 2490087006, 'author': 'piranha', 'body': '@luizarakaki I wonder if ""fix another random fk"" is done by hands or by fixing it on stats?', 'created_at': datetime.datetime(2024, 8, 29, 9, 13, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2317863554, 'issue_id': 2490087006, 'author': 'luizarakaki', 'body': '> @luizarakaki I wonder if ""fix another random fk"" is done by hands or by fixing it on stats?\r\n\r\nI\'m fixing these issues in the source instance: audit-dev. We don\'t use Stats to develop audit content', 'created_at': datetime.datetime(2024, 8, 29, 14, 24, 12, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-08-28 07:59:47 UTC): It seems that the audit instance is running version `80813cb`, which is an old version of master which predated the bug-bashing involved in the refactor. It seems that this issue was fixed before the changes as a whole were backported, so I think we're in the clear.

luizarakaki (Issue Creator) on (2024-08-28 14:21:24 UTC): Yeah, my mistake. I used to serialize using a local jar, but now we do it using the API and for some reason the instance was outdated. I restarted the instance and it is now following `master` again.

Yamls look good now

piranha on (2024-08-29 09:13:50 UTC): @luizarakaki I wonder if ""fix another random fk"" is done by hands or by fixing it on stats?

luizarakaki (Issue Creator) on (2024-08-29 14:24:12 UTC): I'm fixing these issues in the source instance: audit-dev. We don't use Stats to develop audit content

"
2490047803,pull_request,closed,,"ü§ñ backported ""Improve Clear cache button text and question refresh button tooltip""","  #46791
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-27 18:17:32+00:00,"['rafpaf', 'github-automation-metabase']",2024-09-11 12:59:43+00:00,2024-09-11 12:59:41+00:00,https://github.com/metabase/metabase/pull/47321,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2490039456,pull_request,closed,,fix(admin/performance): Don't show tooltip on default policy,"This branch removes the tooltip shown here in Admin / Performance when you hover your mouse over the default policy:
![image.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/utGnP2ljFMMNOgi82vVn/0d0dec42-a75c-4f5b-8e13-ae40f68c9428.png)

That tooltip is misplaced, since that button represents the default caching policy. The tooltip is used elsewhere to mean ""this item is following the default policy, rather than a special policy assigned to the item"".

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",rafpaf,2024-08-27 18:12:29+00:00,['rafpaf'],2024-09-10 15:31:42+00:00,2024-08-30 17:55:49+00:00,https://github.com/metabase/metabase/pull/47319,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2313214910, 'issue_id': 2490039456, 'author': 'rafpaf', 'body': '* **#47319** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47319?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 27, 18, 12, 49, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-08-27 18:12:49 UTC): * **#47319** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47319?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2490018919,pull_request,closed,,"correctly parse collection id, update path state on handleNewDashboard","Closes https://github.com/metabase/metabase/issues/47000

### Description
This PR corrects 2 issues. The first is updating `getCollectionId` to correctly pull the collection id from a dashboard. The second is to update `handleNewDashboard` to account for the case when you create a new dashboard in a previously empty collection.

### How to verify

Describe the steps to verify that the changes are working as expected.

1. Ensure you have an empty collection, and a collection that contains a dashboard
2. New question -> Sample Dataset -> Orders -> Save -> Add to Dashboard
3. Select the empty collections
4. Click ""Create a new dashboard"". Populate a name and click `Create`.
5. The new dashboard should appear in the entity picker and be selected.

_Do the same steps again, but this time select the collection that has a dashboard in it_ (This worked previously)
_Do the same steps one more time, but this time select a dashboard, then click ""create a new dashboard"". The new dashboard should appear as a sibling as the one you had selected_

### Demo
![chrome_IzkWlsW9lH](https://github.com/user-attachments/assets/91cfe3c3-eedd-443a-b22f-e54e046f825d)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",npfitz,2024-08-27 17:59:08+00:00,['npfitz'],2024-09-13 15:24:19+00:00,2024-09-13 15:24:18+00:00,https://github.com/metabase/metabase/pull/47318,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2489974702,pull_request,closed,,"ü§ñ backported ""docs - notes on public links""",#47315,github-automation-metabase,2024-08-27 17:31:49+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-28 19:52:14+00:00,2024-08-28 19:52:13+00:00,https://github.com/metabase/metabase/pull/47317,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2489969301,pull_request,closed,,"ü§ñ backported ""zoom-in-timeseries-drill: do not include :hour and :minute for DATE columns""","  #46997
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-27 17:28:47+00:00,"['appleby', 'github-automation-metabase']",2024-08-27 23:28:11+00:00,2024-08-27 23:28:10+00:00,https://github.com/metabase/metabase/pull/47316,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2313188846, 'issue_id': 2489969301, 'author': 'appleby', 'body': 'Resolved conflicts in zoom_in_timeseries.cljc by replacing unbackported `mu/defn-` with `mu/defn ^:private`.\r\n\r\nPR with `mu/defn-` changes: https://github.com/metabase/metabase/pull/46013', 'created_at': datetime.datetime(2024, 8, 27, 17, 57, 12, tzinfo=datetime.timezone.utc)}]","appleby (Assginee) on (2024-08-27 17:57:12 UTC): Resolved conflicts in zoom_in_timeseries.cljc by replacing unbackported `mu/defn-` with `mu/defn ^:private`.

PR with `mu/defn-` changes: https://github.com/metabase/metabase/pull/46013

"
2489967359,pull_request,closed,,docs - notes on public links,Clarifies that only admins can create public links.,jeff-bruemmer,2024-08-27 17:27:44+00:00,['jeff-bruemmer'],2024-08-28 19:52:45+00:00,2024-08-27 17:31:00+00:00,https://github.com/metabase/metabase/pull/47315,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2489854198,pull_request,closed,,Migrate Tooltip in FormField to mantine to fix z-index issue,"Picked up a small FE issue for a change of pace! Resolves #41953 which was introduced by #38298 and seems to be the result of the modal z-index being [hardcoded at 200](https://github.com/metabase/metabase/blob/nm-fix-collection-type-tooltip/frontend/src/metabase/ui/components/overlays/Modal/Modal.styled.tsx#L5) which is greater than the [z-index of 4](https://github.com/metabase/metabase/blob/nm-fix-collection-type-tooltip/frontend/src/metabase/components/Popover/constants.ts) which is hardcoded for the Popover component.

I saw the deprecation notice in `Tooltip.tsx` that it's deprecated in favor of the Mantine tooltip in metabase/ui, so I swapped it in in the `FormField` component, and that seems to fix the issue. I also set the `multiline` prop so that the long text doesn't overflow the viewport on small screen widths.

Please let me know if this is the wrong way to go about this. Also not sure if any testing is needed/appropriate here but I'm happy to add some. üôè 

Before             |  After
:-------------------------:|:-------------------------:
![](https://github.com/user-attachments/assets/654ba2d2-b5d3-47e3-91a8-87049bae471c)  |  ![](https://github.com/user-attachments/assets/8abbde61-a69d-4d21-b7fd-745b8122a4f3)",noahmoss,2024-08-27 16:27:27+00:00,['noahmoss'],2024-08-29 16:57:27+00:00,2024-08-29 16:57:27+00:00,https://github.com/metabase/metabase/pull/47314,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2313020516, 'issue_id': 2489854198, 'author': 'noahmoss', 'body': '* **#47314** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47314?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 27, 16, 27, 43, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-08-27 16:27:43 UTC): * **#47314** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47314?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2489842110,pull_request,closed,,Make metric metadata keep the metric's name,"This is a fix for the problem reported in #40355, which is fixed separately for v50 (see #47262) and backported to v49.

### Description

Make sure that the name of the metric column produced by returned-columns matches the name of the aggregation (which is same as the name of the metric).

### How to verify

Do the repro steps of @zbodi74 from issue #40355. There should be no error, the query should be executed properly.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",metamben,2024-08-27 16:21:59+00:00,['metamben'],2024-10-08 16:16:07+00:00,2024-08-29 14:25:43+00:00,https://github.com/metabase/metabase/pull/47313,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2489800193,pull_request,closed,,Download Rows Limit Should work in 49,"Fixes #47263

In backporting the MB_DOWNLOAD_ROWS_LIMIT to 49, one necesssary change was missed and the default constraints were being applied to subscription downloads.

This PR fixes that oversight and also adds a test to verify correctly applied limits in subscription attachments.

 ",adam-james-v,2024-08-27 16:03:06+00:00,['adam-james-v'],2024-08-27 19:07:22+00:00,2024-08-27 19:07:21+00:00,https://github.com/metabase/metabase/pull/47312,"[('.Team/DashViz', 'Dashboard and Viz team')]",[],
2489799896,pull_request,closed,,Fix crash when navigating between bookmarked dashboards,"Fixes #47170

The PR updates the dashboard fetching logic, so it no longer calls `setErrorPage` for canceled request exceptions.

Would appreciate ideas on test coverage for this: I believe a Cypress test would be too flaky for bugs like that, and I failed to tune request timing/sequencing in a Jest test for this :/

### To verify

1. Create and bookmark 2 dashboards
2. Open app sidebar
3. Throttle your network (or use stats instance) or be quick with the next steps
4. Navigate to 1st dashboard
5. Open app sidebar
6. Navigate to 2nd dashboard
7. Ensure there're no visible errors

### Demo

**Before**

https://github.com/user-attachments/assets/0f1d7ff3-3f04-4683-951a-534e02de5895

**After**

https://github.com/user-attachments/assets/abec24e1-5b90-4086-a240-e7e92a14a404

",kulyk,2024-08-27 16:02:58+00:00,['kulyk'],2024-08-29 14:07:45+00:00,2024-08-28 16:00:33+00:00,https://github.com/metabase/metabase/pull/47311,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2315251672, 'issue_id': 2489799896, 'author': 'kulyk', 'body': ""> Fix itself looks good. Regarding tests, it might not be the most useful/accurate test, but something that you can do easily is extracting the body of `handleLoadDashboard` into its own function, and using mock functions in jest making sure that `setErrorPage` is not called when `isCancelled` is true\r\n\r\nThanks! I've tried to do that, but IMO it ended up making the code harder to parse and reason about. And, as you mentioned, the test itself ends up being not so robust and useful. I gonna merge this as is, but happy to tweak this if we come up with something"", 'created_at': datetime.datetime(2024, 8, 28, 12, 58, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2317777920, 'issue_id': 2489799896, 'author': 'kulyk', 'body': '@kamilmielnik thank you for great suggestions! Implemented in #47400', 'created_at': datetime.datetime(2024, 8, 29, 14, 7, 43, tzinfo=datetime.timezone.utc)}]","kulyk (Issue Creator) on (2024-08-28 12:58:35 UTC): Thanks! I've tried to do that, but IMO it ended up making the code harder to parse and reason about. And, as you mentioned, the test itself ends up being not so robust and useful. I gonna merge this as is, but happy to tweak this if we come up with something

kulyk (Issue Creator) on (2024-08-29 14:07:43 UTC): @kamilmielnik thank you for great suggestions! Implemented in #47400

"
2489469285,pull_request,closed,,"ü§ñ backported ""Delete old serialization extension points and fallbacks""","  #47273
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-27 14:01:11+00:00,"['crisptrutski', 'github-automation-metabase']",2024-09-02 06:55:43+00:00,2024-09-02 06:55:42+00:00,https://github.com/metabase/metabase/pull/47310,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2489438225,pull_request,closed,,Maintain selected folder state in Entity Picker,"Closes #47288

### Description

This PR is targeted against an integration branch.

It's a bit difficult to summarize what's happening in this PR so I left explanatory comments throughout the PR.
Here's the goal: https://github.com/metabase/metabase/pull/47309/files#r1738528413

Initially this PR was supposed to use `keepMounted` prop on `Tabs` component but it broke an insane amount of tests, so I will tackle that separately: #47454

### How to verify

App should work the same as before (Dashboard picker, Collection picker, Data picker, Question picker).
CI should be green.
",kamilmielnik,2024-08-27 13:50:03+00:00,['kamilmielnik'],2024-09-02 09:32:24+00:00,2024-09-02 09:32:22+00:00,https://github.com/metabase/metabase/pull/47309,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2489428323,pull_request,closed,,"ü§ñ backported ""Entity id translation service""","  #47094
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-27 13:46:30+00:00,"['escherize', 'github-automation-metabase']",2024-09-04 21:09:37+00:00,2024-09-04 21:09:36+00:00,https://github.com/metabase/metabase/pull/47308,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2489385151,pull_request,closed,,"ü§ñ backported ""Add v0.49.24 to the list of releases""",#47300,github-automation-metabase,2024-08-27 13:31:33+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-27 13:34:01+00:00,2024-08-27 13:34:00+00:00,https://github.com/metabase/metabase/pull/47307,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2489344560,pull_request,closed,,"ü§ñ backported ""Add v0.50.22 to the list of releases""",#47275,github-automation-metabase,2024-08-27 13:18:05+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-27 13:19:46+00:00,2024-08-27 13:19:46+00:00,https://github.com/metabase/metabase/pull/47305,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2489256212,pull_request,closed,,Use original display name for fields in uploaded tables,"### Description

It's not a great experience when using foreign languages to have obfuscated field names for CSV uploads.

This change makes sure we preserve the pre-munged name in the display name.",crisptrutski,2024-08-27 12:44:50+00:00,['crisptrutski'],2024-09-02 12:17:36+00:00,2024-09-02 10:53:42+00:00,https://github.com/metabase/metabase/pull/47303,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2312785080, 'issue_id': 2489256212, 'author': 'crisptrutski', 'body': ""> That imperative `let` in `update-with-csv!` gets thornier and thornier, but that's not really your fault. Looks good to me\r\n\r\nThis test suite can use a big clean-up, and I think there's a really practical reason to do so!\r\n\r\nI think it's one of the biggest contributors to CI runtime as it really hammers the databases, especially redshift. Most of these tests don't need to touch the database."", 'created_at': datetime.datetime(2024, 8, 27, 14, 50, 54, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-08-27 14:50:54 UTC): This test suite can use a big clean-up, and I think there's a really practical reason to do so!

I think it's one of the biggest contributors to CI runtime as it really hammers the databases, especially redshift. Most of these tests don't need to touch the database.

"
2489183528,pull_request,closed,,"ü§ñ backported ""Fix flaky test update-db-to-never-scan-values-on-demand-test""",#47295,github-automation-metabase,2024-08-27 12:16:54+00:00,"['qnkhuat', 'github-automation-metabase']",2024-08-29 10:12:49+00:00,2024-08-29 10:12:48+00:00,https://github.com/metabase/metabase/pull/47302,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2489078813,pull_request,closed,,Add v0.49.24 to the list of releases,Like it says on the tin üòÅ,github-automation-metabase,2024-08-27 11:35:32+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-27 13:34:30+00:00,2024-08-27 13:30:44+00:00,https://github.com/metabase/metabase/pull/47300,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2489030307,pull_request,closed,,"ü§ñ backported ""Stop serializing LegacyMetric""","  #47268
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-27 11:11:58+00:00,"['crisptrutski', 'github-automation-metabase']",2024-08-28 19:12:54+00:00,2024-08-28 19:12:54+00:00,https://github.com/metabase/metabase/pull/47299,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2316075280, 'issue_id': 2489030307, 'author': 'crisptrutski', 'body': 'It looks like we are still serializing this model in v50, so aborting this.', 'created_at': datetime.datetime(2024, 8, 28, 19, 12, 54, tzinfo=datetime.timezone.utc)}]","crisptrutski (Assginee) on (2024-08-28 19:12:54 UTC): It looks like we are still serializing this model in v50, so aborting this.

"
2488988055,pull_request,closed,,add uladzimirdev to querying team,Move @uladzimirdev back to querying team,uladzimirdev,2024-08-27 10:54:19+00:00,['uladzimirdev'],2024-10-08 16:16:23+00:00,2024-08-27 11:05:05+00:00,https://github.com/metabase/metabase/pull/47298,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2488987926,pull_request,closed,,Fix CSV uploads for non-ASCII headers,"Closes https://github.com/metabase/metabase/issues/47279### 

### Description

It turns out that we had a chink in our support for non-ASCII characters - column names that start with a non-ASCII character.

This is a bit subtle, and due to the combination of our munging technique and how HoneySQL handles function calls.

- For munging, we use a shared helper that uses URL encoding internally, which prefixes escape sequences with `%`
- HoneySQL interprets keywords starting with `%` as function calls (with no argument).

~~The fix is pretty straight forward, if you namespace a field to qualify it, HoneySQL then knows it is a field.~~ For some reason this did not work for MySQL based engines, so I found another solution - manually formatting the references and putting them in `:raw` blocks.",crisptrutski,2024-08-27 10:54:16+00:00,['crisptrutski'],2024-08-28 22:01:41+00:00,2024-08-28 21:59:58+00:00,https://github.com/metabase/metabase/pull/47297,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2488858380,pull_request,closed,,Fix flaky test update-db-to-never-scan-values-on-demand-test,"[Flaky run](https://github.com/metabase/metabase/actions/runs/10568352226/job/29280015374#step:7:1747)

The flaky assertion is a sanity check that after adding a database, we add the 2 default quartz triggers for sync.

This is currently done in the `post-insert` hook.

I have exhausted all options for how it could flake, and I suspect that it's because Quartz added the trigger async.

So, I added a retry with a timeout for it.",qnkhuat,2024-08-27 09:58:28+00:00,['qnkhuat'],2024-08-29 10:13:14+00:00,2024-08-27 12:16:06+00:00,https://github.com/metabase/metabase/pull/47295,"[('backport', 'Automatically create PR on current release branch on merge'), ('flaky-test-fix', ''), ('.Team/Workflows', 'aka BEC')]",[],
2488732636,pull_request,closed,,"ü§ñ backported ""Use Serialization spec for Collection""","  #47240
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-27 09:06:45+00:00,"['crisptrutski', 'github-automation-metabase']",2024-08-29 09:12:06+00:00,2024-08-29 09:12:06+00:00,https://github.com/metabase/metabase/pull/47287,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2488699362,pull_request,closed,,"ü§ñ backported ""Fix action serialization dependencies""",#47278,github-automation-metabase,2024-08-27 08:53:39+00:00,"['crisptrutski', 'github-automation-metabase']",2024-08-27 12:40:35+00:00,2024-08-27 12:40:34+00:00,https://github.com/metabase/metabase/pull/47285,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2488664632,pull_request,closed,,"ü§ñ backported ""Refactor e2e helpers and commands to TypeScript function helpers""",  #47237,github-automation-metabase,2024-08-27 08:37:03+00:00,"['kamilmielnik', 'github-automation-metabase']",2024-08-27 09:35:02+00:00,2024-08-27 09:35:01+00:00,https://github.com/metabase/metabase/pull/47283,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2488488196,pull_request,closed,,Fix action serialization dependencies,"Closes https://github.com/metabase/metabase/issues/47230

### Description

~~We're seeing a strange flake related to serialization since some of the recent refactoring, but have not been able to reproduce it locally.~~ This PR adds some logging to help diagnose the issue.

We found what caused this flake - the change to how we serialize actions to stop merging in their inheritance tables. We were looking in the wrong place for the query's dataset_query, and therefore not tracking those dependencies at all.",crisptrutski,2024-08-27 07:10:43+00:00,['crisptrutski'],2024-08-27 08:52:45+00:00,2024-08-27 08:52:44+00:00,https://github.com/metabase/metabase/pull/47278,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2488466953,pull_request,closed,,Browse metrics page,"Closes https://github.com/metabase/metabase/issues/47011

- Adds a simple browse metrics page
- Fixes an issue where markdown descriptions on the models page were not rendered as markdown
- This PR was copying a lot of code from the `/browse/models` page, and that code was getting a lot of review comments, so I applied them to the original code too.

## To verify

- Make sure you have some metrics created
- Click the `Metrics` title in the sidebar
- You should be taken to the `/browse/metrics` page, where you see all your metrics
- Play around with sorting


<img width=""1474"" alt=""Screenshot 2024-08-27 at 16 35 38"" src=""https://github.com/user-attachments/assets/9b4314d9-4d1c-441d-a3ff-789dd376c1dd"">

",romeovs,2024-08-27 06:59:27+00:00,['romeovs'],2024-09-09 09:39:25+00:00,2024-09-09 09:39:23+00:00,https://github.com/metabase/metabase/pull/47277,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2330780100, 'issue_id': 2488466953, 'author': 'romeovs', 'body': ""@AlessioLaiso we don't have a way to currently show the source name for metrics. It was decided we would roll out a simpler page that mimics the models page first. I can leave out the collection column, but I cannot (yet) put a source column in its place.\r\n\r\nI have removed the icons in the name column."", 'created_at': datetime.datetime(2024, 9, 5, 7, 15, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2331683247, 'issue_id': 2488466953, 'author': 'AlessioLaiso', 'body': ""@romeovs I see, thank you. Then, it will be fine for this first version. Let's update this later."", 'created_at': datetime.datetime(2024, 9, 5, 13, 26, 43, tzinfo=datetime.timezone.utc)}]","romeovs (Issue Creator) on (2024-09-05 07:15:17 UTC): @AlessioLaiso we don't have a way to currently show the source name for metrics. It was decided we would roll out a simpler page that mimics the models page first. I can leave out the collection column, but I cannot (yet) put a source column in its place.

I have removed the icons in the name column.

AlessioLaiso on (2024-09-05 13:26:43 UTC): @romeovs I see, thank you. Then, it will be fine for this first version. Let's update this later.

"
2488128498,pull_request,closed,,Add v0.50.22 to the list of releases,Like it says on the tin üòÅ,github-automation-metabase,2024-08-27 02:31:07+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-27 13:20:12+00:00,2024-08-27 13:17:17+00:00,https://github.com/metabase/metabase/pull/47275,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2488028494,pull_request,closed,,"ü§ñ backported ""Remove failing assertion in CLJS diagnose-expression-test""",#47271,github-automation-metabase,2024-08-27 00:38:09+00:00,"['appleby', 'github-automation-metabase']",2024-08-27 16:24:34+00:00,2024-08-27 16:24:33+00:00,https://github.com/metabase/metabase/pull/47274,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2487988240,pull_request,closed,,Delete old serialization extension points and fallbacks,"Closes https://github.com/metabase/metabase/issues/47223

I've taken some liberties with the instructions, following the spirit:

- Require specs
- Remove defmethod overrides
- Remove fallbacks
- Inline where natural",crisptrutski,2024-08-26 23:55:29+00:00,['crisptrutski'],2024-08-27 14:00:23+00:00,2024-08-27 14:00:22+00:00,https://github.com/metabase/metabase/pull/47273,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2311309315, 'issue_id': 2487988240, 'author': 'crisptrutski', 'body': '* **#47273** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47273?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* **#47268** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47268?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#47240** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47240?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 26, 23, 55, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2311977082, 'issue_id': 2487988240, 'author': 'crisptrutski', 'body': ""> That's nice, but I also wish for more consistent naming.\r\n> \r\n> I'm also thinking if a follow-up PR makes sense to remove dynamic bindings (i.e. changing import/export signature to be like `[value key instance]`). I did not do that because `*import-fk*` and the like were used in lots of places, but now it seems more doable/logical?\r\n\r\nTotally agree on both counts"", 'created_at': datetime.datetime(2024, 8, 27, 9, 9, 13, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-08-26 23:55:46 UTC): * **#47273** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47273?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* **#47268** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47268?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#47240** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47240?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

crisptrutski (Issue Creator) on (2024-08-27 09:09:13 UTC): Totally agree on both counts

"
2487928718,pull_request,closed,,Remove failing assertion in CLJS diagnose-expression-test,"### Description

Per slack discussion here, this CLJS test started failing after changes in #47245.

https://metaboat.slack.com/archives/C013N8XL286/p1724711461313089?thread_ts=1724414568.662469&cid=C013N8XL286

I have an open PR to fix the CLJS checks in CI #47192, but haven't been able to get the CI green to merge it.

### How to verify

`yarn test-cljs`

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",appleby,2024-08-26 22:55:42+00:00,['appleby'],2024-08-27 16:25:01+00:00,2024-08-27 00:37:18+00:00,https://github.com/metabase/metabase/pull/47271,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2487928079,pull_request,closed,,Static embed dashboard and question endpoints,"resolves #47267

We need to support entity ids in tokens. There are 2 places that ids can be in Tokens, one for cards and one for dashboards. At each location we know for a fact what model that id corresponds to, so we can translate entity_ids if needed.

So every time we decode a token, we now pass the card and/or dashboard ids through :

```
(api.common.embed/->id <model> <entity_id or id>)
```

which looks up the `id`, if an entity_id is passed in, or just returns the `id` otherwise.

----

Dear Reviewers: many of these commits are noise and already in master, from #47094. You'll see there are only a few files changed",escherize,2024-08-26 22:55:05+00:00,['escherize'],2024-08-29 22:09:13+00:00,2024-08-29 22:09:11+00:00,https://github.com/metabase/metabase/pull/47270,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2487921590,pull_request,closed,,"ü§ñ backported ""Don't encrypt boolean settings (by default)""",#47179,github-automation-metabase,2024-08-26 22:48:55+00:00,"['johnswanson', 'github-automation-metabase']",2024-08-26 23:39:13+00:00,2024-08-26 23:39:13+00:00,https://github.com/metabase/metabase/pull/47269,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2487920877,pull_request,closed,,Stop serializing LegacyMetric,"Pretty self explanatory. This forms part of https://github.com/metabase/metabase/issues/43068.

~~Unlike the other Serdes improvements, I am not backporting. It's surprising to break backwards compatibility within the same major version.~~ Ah this was actually dead code, so back it goes.",crisptrutski,2024-08-26 22:48:13+00:00,['crisptrutski'],2024-10-08 16:16:22+00:00,2024-08-27 11:11:09+00:00,https://github.com/metabase/metabase/pull/47268,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2311240469, 'issue_id': 2487920877, 'author': 'crisptrutski', 'body': '* **#47273** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47273?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#47268** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47268?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* **#47240** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47240?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 26, 22, 48, 28, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-08-26 22:48:28 UTC): * **#47273** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47273?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#47268** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47268?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* **#47240** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47240?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @crisptrutski and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2487840328,pull_request,closed,,"ü§ñ backported ""[MBQL lib] Disable expression type checking entirely""",#47245,github-automation-metabase,2024-08-26 21:45:04+00:00,"['ranquild', 'github-automation-metabase']",2024-08-26 22:37:21+00:00,2024-08-26 22:37:20+00:00,https://github.com/metabase/metabase/pull/47265,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2487831460,pull_request,closed,,Bump MS SQL Driver to 12.8.1,"Lotsa fixes for this, specifically https://github.com/metabase/metabase/issues/41025 on 12.7
",paoliniluis,2024-08-26 21:37:53+00:00,['paoliniluis'],2024-10-08 16:16:21+00:00,2024-08-27 13:47:27+00:00,https://github.com/metabase/metabase/pull/47264,"[('no-backport', 'Do not backport this PR to any branch')]",[],
2487798216,pull_request,closed,,Make metrics inherit their aggregation's name,"Closes #40355

### Description

Bring metabase lib in sync with the query processor, which expects the metric column to be named the same as the aggregation in its definition is named.

### How to verify

Do the repro steps of @zbodi74 from #40355. There should be no error, the query should be executed properly.

Note that version 51 doesn't use legacy metrics, that's why this fix is implemented here and gets backported to 49.

The same issue exists on master too in a different form, I'll fix that separately.

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",metamben,2024-08-26 21:14:39+00:00,['metamben'],2024-08-29 14:26:05+00:00,2024-08-29 14:26:03+00:00,https://github.com/metabase/metabase/pull/47262,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2487793994,pull_request,closed,,docs - saml page edits and SLO,"- Cleans up SAML page.
- Adds note about SLO",jeff-bruemmer,2024-08-26 21:11:35+00:00,['jeff-bruemmer'],2024-10-03 20:50:58+00:00,2024-10-03 20:47:57+00:00,https://github.com/metabase/metabase/pull/47261,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2487736041,pull_request,closed,,"ü§ñ backported ""fix import order in the files with disabled rules""","  #47217
  ",github-automation-metabase,2024-08-26 20:37:51+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-08-27 13:43:46+00:00,2024-08-27 13:43:45+00:00,https://github.com/metabase/metabase/pull/47259,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2312310230, 'issue_id': 2487736041, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff b6a9f496f27100c6b0bf9c9f0bbb4b6813582701...071d211b7752a056b4ba0d46a3fa4883ff77c260.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/LeafletMap.jsx<br>frontend/src/metabase/visualizations/lib/settings.unit.spec.js<br>frontend/src/metabase/visualizations/lib/settings/column.js |', 'created_at': datetime.datetime(2024, 8, 27, 11, 31, 43, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-27 11:31:43 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff b6a9f496f27100c6b0bf9c9f0bbb4b6813582701...071d211b7752a056b4ba0d46a3fa4883ff77c260.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/LeafletMap.jsx<br>frontend/src/metabase/visualizations/lib/settings.unit.spec.js<br>frontend/src/metabase/visualizations/lib/settings/column.js |

"
2487732043,pull_request,closed,,"ü§ñ backported ""docs - locale for static and public links""",#47194,github-automation-metabase,2024-08-26 20:35:29+00:00,"['jeff-bruemmer', 'github-automation-metabase']",2024-08-26 20:37:00+00:00,2024-08-26 20:36:59+00:00,https://github.com/metabase/metabase/pull/47258,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2487708886,pull_request,closed,,"ü§ñ backported ""docs: serialization clarification""",#45480,github-automation-metabase,2024-08-26 20:24:11+00:00,"['alexyarosh', 'github-automation-metabase']",2024-08-26 20:25:40+00:00,2024-08-26 20:25:39+00:00,https://github.com/metabase/metabase/pull/47257,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2487698112,pull_request,closed,,feat(dashboards): Add sidesheet for dashboard settings,"_in design review_

This PR adds the new settings sidesheet for dashboards

![image.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/utGnP2ljFMMNOgi82vVn/514dc7eb-d208-493e-aa93-fa63b40c6507.png)

These items shown in the screenshot are not added in this PR:
* Timezone
* Persist model info

Closes #47131",rafpaf,2024-08-26 20:18:45+00:00,['rafpaf'],2025-02-04 17:34:19+00:00,2024-09-30 20:55:06+00:00,https://github.com/metabase/metabase/pull/47256,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2311011978, 'issue_id': 2487698112, 'author': 'rafpaf', 'body': '> [!WARNING]\n> <b>This pull request is not mergeable via GitHub because a downstack PR is open. Once all requirements are satisfied, merge this PR as a stack <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47256?utm_source=stack-comment-downstack-mergeability-warning"" >on Graphite</a>.</b>\n> <a href=""https://graphite.dev/docs/merge-pull-requests"">Learn more</a>\n\n* **#47871** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47871?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#47256** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47256?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* **#47672** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47672?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#47100** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47100?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 26, 20, 18, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2344644335, 'issue_id': 2487698112, 'author': 'graphite-app[bot]', 'body': '### Graphite Automations\n<details><summary><a href=""https://app.graphite.dev/automations/?org=metabase&ruleId=Yrh2LAyyUc6276rpQngn&ref=gt-automation-github-comment"">""Warn authors when publishing large PRs""</a> took an action on this PR ‚Ä¢ (09/11/24)</summary><p>1 teammate was notified to this PR based on Raphael Krut-Landau\'s automation.</p></details>', 'created_at': datetime.datetime(2024, 9, 11, 20, 30, 10, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-08-26 20:18:59 UTC): * **#47871** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47871?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#47256** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47256?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* **#47672** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47672?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#47100** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47100?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

graphite-app[bot] on (2024-09-11 20:30:10 UTC): ### Graphite Automations
<details><summary><a href=""https://app.graphite.dev/automations/?org=metabase&ruleId=Yrh2LAyyUc6276rpQngn&ref=gt-automation-github-comment"">""Warn authors when publishing large PRs""</a> took an action on this PR ‚Ä¢ (09/11/24)</summary><p>1 teammate was notified to this PR based on Raphael Krut-Landau's automation.</p></details>

"
2487683325,pull_request,closed,,"Adding schema name to recents, search results in CP","Closes https://github.com/metabase/metabase/issues/44460

### Description
Adds the schema name as contextual info when displaying recent items that are tables in the command palette and data picker, as well as search results in the command palette

### How to verify
1. New question -> table -> select a table
2. Re-open the data picker and go to the recents tab. You should see the table you selected with the database and schema name as parent info
3. Open the command palette, search for a table and select it
4. re-open the command palette. The recents section should show you the table you just selected with database and schema info in the subtext

### Demo
![image](https://github.com/user-attachments/assets/3f59c5bc-fdf7-4580-abcf-ef487afb7099)
![image](https://github.com/user-attachments/assets/f13c98ce-5b6d-4b81-bf5b-dd0f2bcd5c72)

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",npfitz,2024-08-26 20:10:40+00:00,['npfitz'],2024-08-28 18:17:43+00:00,2024-08-28 18:17:41+00:00,https://github.com/metabase/metabase/pull/47255,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2487649410,pull_request,closed,,"ü§ñ backported ""Update appearance.md""",#36538,github-automation-metabase,2024-08-26 19:51:44+00:00,"['camsaul', 'github-automation-metabase']",2024-08-26 19:53:12+00:00,2024-08-26 19:53:11+00:00,https://github.com/metabase/metabase/pull/47253,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2487619576,pull_request,closed,,"ü§ñ backported ""fix(dashboard): In dashboard value source modal, after closing question picker modal, don't also close the first modal""",#47242,github-automation-metabase,2024-08-26 19:34:25+00:00,"['rafpaf', 'github-automation-metabase']",2024-08-26 20:25:11+00:00,2024-08-26 20:25:10+00:00,https://github.com/metabase/metabase/pull/47252,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2487564936,pull_request,closed,,"ü§ñ backported ""Much better collection permission performance""","  #46942

This was a painful backport, because some
previous very relevant changes hadn't been backported. So there are some
changes from the original, non-backported, commit:

- removed all support for getting the trash collection, getting things
that were `archived_directly`, or getting collections by
`archive_operation_id`. None of these exist in this branch.

- in this branch, functions like
`permissions-set->visible-collection-ids` did not check for archived
status or anything other than permissions. On `master`, they do. So, the
new function that replaced them,
`collection/visible-collection-filter-clause`, also checks for archived
status as well as permissions. To resolve this, I chose to just default
`collection/visible-collection-filter-clause` to ignore archived status
and return both archived and unarchived collections.

  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-26 19:07:20+00:00,"['johnswanson', 'github-automation-metabase']",2024-08-29 02:22:52+00:00,2024-08-28 19:09:41+00:00,https://github.com/metabase/metabase/pull/47251,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2315837490, 'issue_id': 2487564936, 'author': 'johnswanson', 'body': ""@noahmoss would you be able to take a quick pass on this and let me know if my changes from the original commit make sense?\r\n\r\nSpecifically, I:\r\n- removed all support for the trash collection, `archived_directly`, and `archive_operation_id` (they don't exist in this branch), and\r\n- default to returning all collections, whether archived or not, since that's what `permissions-set->visible-collection-ids` did in this branch"", 'created_at': datetime.datetime(2024, 8, 28, 16, 51, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2316589260, 'issue_id': 2487564936, 'author': 'qnkhuat', 'body': ""We shouldn't have v51 migrations in a v50. Same reasons I commented [here](https://github.com/metabase/metabase/pull/47367#pullrequestreview-2267519967)"", 'created_at': datetime.datetime(2024, 8, 29, 2, 22, 51, tzinfo=datetime.timezone.utc)}]","johnswanson (Assginee) on (2024-08-28 16:51:42 UTC): @noahmoss would you be able to take a quick pass on this and let me know if my changes from the original commit make sense?

Specifically, I:
- removed all support for the trash collection, `archived_directly`, and `archive_operation_id` (they don't exist in this branch), and
- default to returning all collections, whether archived or not, since that's what `permissions-set->visible-collection-ids` did in this branch

qnkhuat on (2024-08-29 02:22:51 UTC): We shouldn't have v51 migrations in a v50. Same reasons I commented [here](https://github.com/metabase/metabase/pull/47367#pullrequestreview-2267519967)

"
2487539075,pull_request,closed,,Add `isDateOrDateTime`,"It's a common need for the FE to check whether something is a date column. We don't usually care if it's just Date or DateTime. Currently we do that (incorrectly) by using either `isTemporal` or `isDateWithoutTime` functions. This PR introduces `isDateOrDateTime` function and fixes places where the other functions were used.

When I started to use `isDateOrDateTime` I faced issues that it returns `false` for date columns with extraction temporal units. This is expected. I tried to remove the temporal unit with `(lib/with-temporal-unit column nil)` but it didn't work and the effective type remained the same. This PR also fixes this issue by following what we do in `with-temporal-bucket` for `:field` - setting the `::original-effective-type` and using it when removing the temporal unit.",ranquild,2024-08-26 18:52:07+00:00,['ranquild'],2024-10-08 16:16:16+00:00,2024-08-28 02:30:27+00:00,https://github.com/metabase/metabase/pull/47250,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2310926438, 'issue_id': 2487539075, 'author': 'camsaul', 'body': ""Why don't you call it something like `isDateOrDateTime`. Sometimes it's important to differentiate dates versus datetimes, for example you don't want to show a time picker for a date column but it's ok for a datetime column. Naming this `isDate` seems like it could be potentially confusing there and lead to bugs in the future"", 'created_at': datetime.datetime(2024, 8, 26, 19, 31, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2310935118, 'issue_id': 2487539075, 'author': 'ranquild', 'body': '@camsaul agree, fixed', 'created_at': datetime.datetime(2024, 8, 26, 19, 35, 48, tzinfo=datetime.timezone.utc)}]","camsaul on (2024-08-26 19:31:35 UTC): Why don't you call it something like `isDateOrDateTime`. Sometimes it's important to differentiate dates versus datetimes, for example you don't want to show a time picker for a date column but it's ok for a datetime column. Naming this `isDate` seems like it could be potentially confusing there and lead to bugs in the future

ranquild (Issue Creator) on (2024-08-26 19:35:48 UTC): @camsaul agree, fixed

"
2487517892,pull_request,closed,,[WIP] bigquery temporal type excision,Work in progress,snoe,2024-08-26 18:39:19+00:00,['snoe'],2024-09-25 21:56:26+00:00,2024-09-25 21:56:26+00:00,https://github.com/metabase/metabase/pull/47249,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Drivers', '')]",[],
2487467519,pull_request,closed,,"[QP] Return datetimes in SQL Server, even with date-sized truncation","Previously, truncating a `:type/DateTime` column by `:month` or `:day`
would return a `:type/Date`, which subtly broke the query.

In particular, if you try to order-by the breakout column `Created At (month)`
then it would not get de-duplicated, causing a SQL error about conflicting
ORDER BY clauses.

Fixes #46992.

The existing and new tests together check that:
1. Actual `:type/Date` columns are left alone
2. Bucketed `:type/DateTime` columns are `CAST` back to `datetime2`
3. The `:result_metadata` types are accurate in both cases.

### How to verify

1. Connect a MS SQL Server database
2. Breakout on a `:type/DateTime` column like `Orders.CREATED_AT`
3. Switch to table view
4. Click the `Created At` header and sort on it
5. Observe the query still works

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",bshepherdson,2024-08-26 18:13:50+00:00,['bshepherdson'],2024-08-28 13:18:12+00:00,2024-08-28 13:18:10+00:00,https://github.com/metabase/metabase/pull/47248,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2310787899, 'issue_id': 2487467519, 'author': 'bshepherdson', 'body': '* **#47248** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47248?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 26, 18, 14, 8, tzinfo=datetime.timezone.utc)}]","bshepherdson (Issue Creator) on (2024-08-26 18:14:08 UTC): * **#47248** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47248?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2487360247,pull_request,closed,,Hide attached DWH database details,"== Goal ==

Hide attached DWH database details from anyone incl. admins:
* Do not show them in the UI
* Do not permit to change them
* Do not serialize them

The aim is that customers cannot gain access to (parts of) credentials,
and they cannot break a feature they are paying for by changing
connection details.

Database details are already generally excluded from H2 dump snapshots
(see `metabase.cmd.copy/*copy-h2-database-details*`), thus nothing
changes there.

== Implementation ==

The Metabase backend already contains provisions in the implementation
of `metabase.models.interface/to-json` for `:model/Database` to hide the
`details` of the database in HTTP responses, if the user lacks write
permission on the database.  We utilize this by adding an
`is_attached_dwh` column to the `database` table and rejecting
`metabase.models.interface/can-write?` when this flag is enabled.  In
the ""admin"" UI, we show a replacement text instead of the edit form when
the flag is set.  (It might be correct to show this whenever `details`
is absent.  See below for possible follow-up work.)

However, several sections of the frontend code expected the `details`
field to always be present.  In order to make `details` optional, as the
backend seems to handle it, we fix the respective code to treat this
case in the way that appears appropriate in the context.

== How to test ==

=== New behaviour ===

Setting the `is_attached_dwh` field hides the database details:

1. Configure a database as described in https://www.metabase.com/docs/latest/configuring-metabase/config-file#databases.
   - In addition to the fields you would normally set, also set
     `is_attached_dwh: true`.
   - This also works when adding this flag to a database that previously
     did not have this flag set.
2. Start your Metabase instance.
3. Verify the database shows up in the ""admin"" section
   (`/admin/databases`).
4. Verify that clicking the database to see its details only reveals
   ""This database cannot be modified.""
5. Verify that responses from the backend do not include a `details`
   field for this database.

=== Original behaviour ===

Behaviour without setting the `is_attached_dwh` field is unchanged:

1. Configure a database as described in https://www.metabase.com/docs/latest/configuring-metabase/config-file#databases.
   - Only set the fields you would normally set.  Do not set
     `is_attached_dwh` (or set it to `false`).
2. Start your Metabase instance.
3. Verify the database shows up in the ""admin"" section
   (`/admin/databases`).
4. Verify that clicking the database to see its details only reveal the
   regular edit form, showing connection fields like `host`, `user`,
   etc. with the values you configured.

== How this will be rolled out ==

1. Upgrade existing Metabase Cloud instances with data warehouse to a
   Metabase version that supports `is_attached_dwh`.
2. Set `is_attached_dwh` in the database section of the config file for
   Metabase Cloud instances with a data warehouse.

== Possible follow-up work ==

In https://github.com/metabase/metabase/issues/25715, absent
`database.details` was identified as a bug.  Since then, `details` was
made `NOT NULL` in the application database, so this bug can no longer
occur.  However, today backend responses can be missing the `details`
field, if the current user lacks write permission to the database
setting (see above).  Fully re-evaluating #25715 in this context is
outside the scope of this PR.

Closes: https://github.com/metabase/harbormaster/issues/5051",devurandom,2024-08-26 17:17:45+00:00,['devurandom'],2024-09-02 13:29:57+00:00,2024-08-29 17:36:54+00:00,https://github.com/metabase/metabase/pull/47247,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2318260556, 'issue_id': 2487360247, 'author': 'devurandom', 'body': ""> One thing I noticed is that in EE, if you have a database that is a dwh, it will not show up in the list of DBs in the admin page. This is because in EE only, we pass the query param `exclude_uneditable_details: true`, which excludes it from the list. I'm not sure if that is intentional or not\r\n\r\nThanks!  Even in EE admins should be able to see that their DWH exists, they just should not be able to edit it.  I fixed that in https://github.com/metabase/metabase/pull/47247/commits/bf2dbdd72b731b5ec82ae376591f5becba160d13.\r\n\r\nI did not have to change `GET /:id`, because we do not pass `exclude_uneditable_details` when requesting that.  (`PLUGIN_FEATURE_LEVEL_PERMISSIONS.databaseDetailsQueryProps` is only used in `frontend/src/metabase/admin/databases/containers/DatabaseListApp.jsx` and `frontend/src/metabase/admin/databases/components/DatabaseList/DatabaseList.jsx`.)"", 'created_at': datetime.datetime(2024, 8, 29, 16, 11, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2318449675, 'issue_id': 2487360247, 'author': 'npfitz', 'body': 'Change to the endpoint looks good to me! Thanks @devurandom', 'created_at': datetime.datetime(2024, 8, 29, 17, 29, 50, tzinfo=datetime.timezone.utc)}]","devurandom (Issue Creator) on (2024-08-29 16:11:53 UTC): Thanks!  Even in EE admins should be able to see that their DWH exists, they just should not be able to edit it.  I fixed that in https://github.com/metabase/metabase/pull/47247/commits/bf2dbdd72b731b5ec82ae376591f5becba160d13.

I did not have to change `GET /:id`, because we do not pass `exclude_uneditable_details` when requesting that.  (`PLUGIN_FEATURE_LEVEL_PERMISSIONS.databaseDetailsQueryProps` is only used in `frontend/src/metabase/admin/databases/containers/DatabaseListApp.jsx` and `frontend/src/metabase/admin/databases/components/DatabaseList/DatabaseList.jsx`.)

npfitz on (2024-08-29 17:29:50 UTC): Change to the endpoint looks good to me! Thanks @devurandom

"
2487293137,pull_request,closed,,Improve impersonation.clj to handle role collections as well,"> [!IMPORTANT]
> For those employed by Metabase: if you are merging into master, please add either a `backport` or a `no-backport` label to this PR. You will not be able to merge until you do this step. Refer to the section [Do I need to backport this PR?](https://www.notion.so/metabase/Metabase-Branching-Strategy-6eb577d5f61142aa960a626d6bbdfeb3?pvs=4#89f80d6f17714a0198aeb66c0efd1b71) in the Metabase Branching Strategy document for more details. If you're not employed by Metabase, this section does not apply to you, and the label will be taken care of by your reviewer.

> **Warning**
>
> If that is your first contribution to Metabase, please sign the [Contributor License Agreement](https://docs.google.com/a/metabase.com/forms/d/1oV38o7b9ONFSwuzwmERRMi9SYrhYeOrkbmNaq9pOJ_E/viewform) (unless it's a tiny documentation change). Also, if you're attempting to fix a translation issue, please submit your changes to our [POEditor project](https://poeditor.com/join/project/ynjQmwSsGh) instead of opening a PR.

Closes https://github.com/metabase/metabase/issues/[issue_number]

### Description

When using impersonation, some SSO systems tend to provide collection data instead of string data; such that the following error occurs:

```
class clojure.lang.PersistentVector cannot be cast to class java.lang.CharSequence (clojure.lang.PersistentVector is in unnamed module of loader 'app'; java.lang.CharSequence is in module java.base of loader 'bootstrap')
...
metabase_enterprise.advanced_permissions.driver.impersonation$connection_impersonation_role.invokeStatic(impersonation.clj:73)
```
This merge request provides a solution. I ensured that the changed method **connection-impersonation-role** serves as the single source of truth for the role string.

It would be great if you could merge this.

### How to verify

Set up SSO which returns json/collection data in the configured impersonation database field as described [here](https://www.metabase.com/learn/metabase-basics/administration/permissions/impersonation#:~:text=Impersonation%20is%20a%20permissions%20setting,your%20database%20executes%20the%20query.)
",s-huk,2024-08-26 16:42:55+00:00,[],2024-08-31 12:00:53+00:00,2024-08-30 17:34:52+00:00,https://github.com/metabase/metabase/pull/47246,[],"[{'comment_id': 2311004088, 'issue_id': 2487293137, 'author': 'noahmoss', 'body': 'Hi @s-huk, thank you for your contribution!\r\n\r\nI\'d like to understand the problem a bit better before we merge this. Do you have an example of what the ""collection"" role value looks like? And SSO type & identity provider are you using?', 'created_at': datetime.datetime(2024, 8, 26, 20, 14, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2311907482, 'issue_id': 2487293137, 'author': 's-huk', 'body': 'ok, if you insist, it might take some time to gather more information how this text variable ""role"" might turn out to be of type PersistentVector (i.e. collection of Strings) instead of String (or CharSequence)... \r\n\r\nSee the error... it just happens when using Metabase Pro with our SSO (keycloak, more specifically I guess JWT via Keycloak/OIDC)... \r\n\r\nBut is all of this really relevant? I hoped you would embrace every piece of code in the direction of type validation/conversion (without asking too much), because Metabase seems to lack much of such type validation/conversion code in general.', 'created_at': datetime.datetime(2024, 8, 27, 8, 37, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2312131664, 'issue_id': 2487293137, 'author': 's-huk', 'body': 'I added issue #47296 to make it more clear', 'created_at': datetime.datetime(2024, 8, 27, 10, 19, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2315123479, 'issue_id': 2487293137, 'author': 'noahmoss', 'body': '@s-huk I certainly want to fix the exception here, but I am trying to understand whether concatenating the values together with commas is the correct approach. `connection-impersonation-role` is supposed to return a string which can be used in a `SET ROLE` command (or the equivalent for different drivers). With this fix, the role would be something like `""a,b,c""`‚Äîdoes that make sense? This is the context I was missing.\r\n\r\nNow that I see from the issue that you\'re using the Clickhouse driver, it does seem that it supports setting multiple roles separated by commas is supported. But this is a driver-specific implementation so this concatenation should be done in the [Clickhouse driver](https://github.com/ClickHouse/metabase-clickhouse-driver/), which is a third-party driver that we don\'t own.\r\n\r\nI think this is the path forward:\r\n1. Metabase should only call `str/blank?` if the role value is a string; otherwise, if the value is a list, we should keep it as-is and pass it into `driver/set-role!`\r\n2. The Clickhouse driver should decide how to format the list as a string in its implementation of `set-role-statement`.\r\n\r\nIf you\'d like to update this PR with step 1 (+ a test) I\'m happy to review again and merge it in. Otherwise we can close this PR and I can make the fix in the near future.', 'created_at': datetime.datetime(2024, 8, 28, 11, 55, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2316956255, 'issue_id': 2487293137, 'author': 's-huk', 'body': ""@noahmoss Knowing the metabase coding style, I already anticipated that you would think this way, so we already built a modified version of the ClickHouse driver a week ago. **So, it would acceptable for us to proceed as you suggest and modify the ClickHouse driver**, but... really? Do you really insist on spaghettifying type insecurity into all possible drivers?\r\n\r\nSome more background to consider: Many DBMS (like MySQL 8, ClickHouse, Oracle) allow multiple roles to be activated simultaneously. The syntax is always the same (roles separated by comma). Others, like DB2 and PostgreSQL, seem to allow only one role to be activated at a time.\r\n\r\nAs the core code maintainer, you could define the types of your interface's variables - document, validate, standardize them... but you really don't want to do this, do you?"", 'created_at': datetime.datetime(2024, 8, 29, 7, 59, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2320469609, 'issue_id': 2487293137, 'author': 's-huk', 'body': 'Hi again, this was not an eristic question. I will cooperate if you and your team are 100 % sure that you want to proceed as you suggested. Are you sure?', 'created_at': datetime.datetime(2024, 8, 30, 8, 24, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2322037240, 'issue_id': 2487293137, 'author': 'noahmoss', 'body': ""@s-huk I've discussed with our product team and we've concluded that setting multiple roles at once via an array was not in the original design for the impersonation feature, so we will relabel the issue as a feature request and prioritize it accordingly. In addition, I will put up a separate PR to return a better error message for these cases.\r\n\r\nUntil we support this use case officially, you may be able to work around this by storing the concatenated list of roles as a string directly in the user attributes.\r\n\r\nThank you for drawing our attention to this issue, and for being willing to submit a patch."", 'created_at': datetime.datetime(2024, 8, 30, 17, 34, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2322857749, 'issue_id': 2487293137, 'author': 's-huk', 'body': 'Sounds reasonable so far.\r\n\r\nAnd now let\'s get the harvest of our insights: Why don\'t we just merge this PR, and add this description to your user impersonation documentation: \r\n```\r\nIf the database role attribute is not a string but a collection of strings (like a JSON array), then it will automatically be reduced to a comma-separated String. For exmaple, collections like [""a"", ""b"", ""c""] will automatically be reduced to ""a,b,c"".\r\n```\r\n\r\nThis would make all of us happy, because...\r\n\r\n- You wouldn\'t have to fix the bug anymore.\r\n- Databases that can activate only one role\r\n  - ...could work with text (as currently) or singleton collections as well\r\n  - ...should return the most reasonable error message in case of multiple comma-separated values\r\n- Databases which can activate more than one role...\r\n  - ...could work with text (as currently) or comma-separated input as well\r\n\r\nAnd existing drivers wouldn\'t have to be modified nor bothered, because reducing a collection of roles to a comma-separated role string aligns with the SQL syntax of every possible driver\'s SQL dialect.\r\n\r\n**Under the bottom line**: Roughly nothing would have to be done, and you wouldn\'t have to impair the quality of your software. Or am I missing something?', 'created_at': datetime.datetime(2024, 8, 31, 10, 42, 28, tzinfo=datetime.timezone.utc)}]","noahmoss on (2024-08-26 20:14:15 UTC): Hi @s-huk, thank you for your contribution!

I'd like to understand the problem a bit better before we merge this. Do you have an example of what the ""collection"" role value looks like? And SSO type & identity provider are you using?

s-huk (Issue Creator) on (2024-08-27 08:37:09 UTC): ok, if you insist, it might take some time to gather more information how this text variable ""role"" might turn out to be of type PersistentVector (i.e. collection of Strings) instead of String (or CharSequence)... 

See the error... it just happens when using Metabase Pro with our SSO (keycloak, more specifically I guess JWT via Keycloak/OIDC)... 

But is all of this really relevant? I hoped you would embrace every piece of code in the direction of type validation/conversion (without asking too much), because Metabase seems to lack much of such type validation/conversion code in general.

s-huk (Issue Creator) on (2024-08-27 10:19:54 UTC): I added issue #47296 to make it more clear

noahmoss on (2024-08-28 11:55:18 UTC): @s-huk I certainly want to fix the exception here, but I am trying to understand whether concatenating the values together with commas is the correct approach. `connection-impersonation-role` is supposed to return a string which can be used in a `SET ROLE` command (or the equivalent for different drivers). With this fix, the role would be something like `""a,b,c""`‚Äîdoes that make sense? This is the context I was missing.

Now that I see from the issue that you're using the Clickhouse driver, it does seem that it supports setting multiple roles separated by commas is supported. But this is a driver-specific implementation so this concatenation should be done in the [Clickhouse driver](https://github.com/ClickHouse/metabase-clickhouse-driver/), which is a third-party driver that we don't own.

I think this is the path forward:
1. Metabase should only call `str/blank?` if the role value is a string; otherwise, if the value is a list, we should keep it as-is and pass it into `driver/set-role!`
2. The Clickhouse driver should decide how to format the list as a string in its implementation of `set-role-statement`.

If you'd like to update this PR with step 1 (+ a test) I'm happy to review again and merge it in. Otherwise we can close this PR and I can make the fix in the near future.

s-huk (Issue Creator) on (2024-08-29 07:59:26 UTC): @noahmoss Knowing the metabase coding style, I already anticipated that you would think this way, so we already built a modified version of the ClickHouse driver a week ago. **So, it would acceptable for us to proceed as you suggest and modify the ClickHouse driver**, but... really? Do you really insist on spaghettifying type insecurity into all possible drivers?

Some more background to consider: Many DBMS (like MySQL 8, ClickHouse, Oracle) allow multiple roles to be activated simultaneously. The syntax is always the same (roles separated by comma). Others, like DB2 and PostgreSQL, seem to allow only one role to be activated at a time.

As the core code maintainer, you could define the types of your interface's variables - document, validate, standardize them... but you really don't want to do this, do you?

s-huk (Issue Creator) on (2024-08-30 08:24:36 UTC): Hi again, this was not an eristic question. I will cooperate if you and your team are 100 % sure that you want to proceed as you suggested. Are you sure?

noahmoss on (2024-08-30 17:34:53 UTC): @s-huk I've discussed with our product team and we've concluded that setting multiple roles at once via an array was not in the original design for the impersonation feature, so we will relabel the issue as a feature request and prioritize it accordingly. In addition, I will put up a separate PR to return a better error message for these cases.

Until we support this use case officially, you may be able to work around this by storing the concatenated list of roles as a string directly in the user attributes.

Thank you for drawing our attention to this issue, and for being willing to submit a patch.

s-huk (Issue Creator) on (2024-08-31 10:42:28 UTC): Sounds reasonable so far.

And now let's get the harvest of our insights: Why don't we just merge this PR, and add this description to your user impersonation documentation: 
```
If the database role attribute is not a string but a collection of strings (like a JSON array), then it will automatically be reduced to a comma-separated String. For exmaple, collections like [""a"", ""b"", ""c""] will automatically be reduced to ""a,b,c"".
```

This would make all of us happy, because...

- You wouldn't have to fix the bug anymore.
- Databases that can activate only one role
  - ...could work with text (as currently) or singleton collections as well
  - ...should return the most reasonable error message in case of multiple comma-separated values
- Databases which can activate more than one role...
  - ...could work with text (as currently) or comma-separated input as well

And existing drivers wouldn't have to be modified nor bothered, because reducing a collection of roles to a comma-separated role string aligns with the SQL syntax of every possible driver's SQL dialect.

**Under the bottom line**: Roughly nothing would have to be done, and you wouldn't have to impair the quality of your software. Or am I missing something?

"
2487268601,pull_request,closed,,[MBQL lib] Disable expression type checking entirely,"Fixes #44431.

### Description

Our type checking is too strict to support some legitimate use cases that
have no workaround at present. We can bring back this type-checking
eventually, once it's possible to correctly express things like
automatic coercion of strings to numbers in `SUM` aggregations.

### How to verify

For example, MySQL automatic string to number coercion.

1. Have a MySQL database with a table with a `VARCHAR` column that contains numbers.
2. Use a custom expression to `SUM` this column.
3. It works!

### Demo

![2024-08-26-123025_534x505_scrot](https://github.com/user-attachments/assets/96ff6b3a-5326-484c-a160-b48982313d2e)
![2024-08-26-123050_1024x1164_scrot](https://github.com/user-attachments/assets/3132d42a-4b38-48a8-9e0f-89340ffb54dd)
![2024-08-26-123100_405x202_scrot](https://github.com/user-attachments/assets/90185258-0558-46c1-bc0b-77fcd9f8936f)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",bshepherdson,2024-08-26 16:32:14+00:00,['bshepherdson'],2024-08-26 21:44:19+00:00,2024-08-26 21:44:18+00:00,https://github.com/metabase/metabase/pull/47245,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2310609187, 'issue_id': 2487268601, 'author': 'bshepherdson', 'body': '* **#47245** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47245?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 26, 16, 32, 37, tzinfo=datetime.timezone.utc)}]","bshepherdson (Issue Creator) on (2024-08-26 16:32:37 UTC): * **#47245** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47245?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2487238020,pull_request,closed,,"ü§ñ backported ""Fix error message in Create API Key modal""",#47161,github-automation-metabase,2024-08-26 16:16:27+00:00,"['rafpaf', 'github-automation-metabase']",2024-08-26 16:55:53+00:00,2024-08-26 16:55:53+00:00,https://github.com/metabase/metabase/pull/47244,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2487191489,pull_request,closed,,"fix(dashboard): In dashboard value source modal, after closing question picker modal, don't also close the first modal","Fixes #46149

To test, follow the reproduction instructions in #46149 and see that only the top modal is closed, not the modal behind it:

1. Create a dashboard
2. Add a text filter
3. Under ""How should people filter on this column?"", click Edit
4. Click ""Pick a modal or question""
5. Close that modal
6. On this branch (unlike master): The ""Selectable values"" modal remains open",rafpaf,2024-08-26 15:54:59+00:00,['rafpaf'],2024-08-26 19:33:36+00:00,2024-08-26 19:33:34+00:00,https://github.com/metabase/metabase/pull/47242,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2310538546, 'issue_id': 2487191489, 'author': 'rafpaf', 'body': '* **#47242** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47242?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 26, 15, 55, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2310929863, 'issue_id': 2487191489, 'author': 'rafpaf', 'body': '### Merge activity\n\n* **Aug 26, 3:33 PM EDT**: @rafpaf merged this pull request with [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/47242).', 'created_at': datetime.datetime(2024, 8, 26, 19, 33, 35, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-08-26 15:55:23 UTC): * **#47242** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47242?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

rafpaf (Issue Creator) on (2024-08-26 19:33:35 UTC): ### Merge activity

* **Aug 26, 3:33 PM EDT**: @rafpaf merged this pull request with [Graphite](https://app.graphite.dev/github/pr/metabase/metabase/47242).

"
2487179660,pull_request,closed,,Use Serialization spec for Collection,"Closes https://github.com/metabase/metabase/issues/47226

### Description

The last one in an epic saga!",crisptrutski,2024-08-26 15:48:36+00:00,['crisptrutski'],2024-08-27 09:05:59+00:00,2024-08-27 09:05:57+00:00,https://github.com/metabase/metabase/pull/47240,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2487147849,pull_request,closed,,"ü§ñ backported ""Use more precise query contexts when recording execution of public downloads""","  #47201
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-26 15:31:37+00:00,"['noahmoss', 'github-automation-metabase']",2024-08-27 12:09:12+00:00,2024-08-27 12:09:11+00:00,https://github.com/metabase/metabase/pull/47239,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2487091507,pull_request,closed,,Refactor e2e helpers and commands to TypeScript function helpers,"### Description

Similar to #46934, continuing this effort.

Refactors the following custom Cypress commands to TypeScript function helpers:
- `cy.createTimeline`
- `cy.createTimelineEvent`
- `cy.createTimelineWithEvents`

And this helper to TypeScript:
- `enterCustomColumnDetails` ([before](https://github.com/user-attachments/assets/f53eb960-21d7-4fb6-8306-e1d06d1ad9a3) & [after](https://github.com/user-attachments/assets/ec5ad06b-08ae-4d5d-b30b-b8a5706f7c44))
",kamilmielnik,2024-08-26 15:03:33+00:00,['kamilmielnik'],2024-08-27 09:35:27+00:00,2024-08-27 08:36:11+00:00,https://github.com/metabase/metabase/pull/47237,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2486796570,pull_request,closed,,"ü§ñ backported ""Fix `DateTimeRange` substitution for open ranges""",#47175,github-automation-metabase,2024-08-26 12:52:34+00:00,"['lbrdnk', 'github-automation-metabase']",2024-08-26 17:34:19+00:00,2024-08-26 17:34:18+00:00,https://github.com/metabase/metabase/pull/47233,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2486767025,pull_request,closed,,Disable query analysis queuing for query changes in prod,[Fixes #47180],tsmacdonald,2024-08-26 12:38:25+00:00,['tsmacdonald'],2024-08-27 14:38:54+00:00,2024-08-27 14:38:53+00:00,https://github.com/metabase/metabase/pull/47231,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2486703477,pull_request,closed,,"feat(sdk): improve license, mock server and post-install for embedding cli","### Description

Improves the license and post-install flow per [the feedback](https://www.notion.so/metabase/CLI-PR-review-8a9be6a85d214910af165e12b1cdfaf0?pvs=4). It allows skipping the license step, allows assigning multiple tenancy columns to user attributes, generates and auto-installs the mock server for you with your package manager of choice, and adds a step-by-step post-installation guide.

### How to verify

- Run `yarn build-embedding-sdk-cli:watch` in one terminal to build the CLI
- Create an empty React project with Vite
- Run `docker rm -f metabase-enterprise-embedding && yarn add file:../metabase/resources/embedding-sdk && npx @metabase/embedding-sdk-react start`
  - This kills existing Docker container, links the built SDK to your React project, then starts the CLI.
  - This only works if your metabase repo is adjacent to the React project. If not, adjust the `file:..` part

### Demo

[Private Loom](https://www.loom.com/share/2639749306e5416fb20c77925a487e7a?sid=c4d22ef9-0544-48c1-b7f4-abb0029f1d80)",heypoom,2024-08-26 12:08:05+00:00,['heypoom'],2024-10-08 16:15:45+00:00,2024-09-02 09:44:37+00:00,https://github.com/metabase/metabase/pull/47229,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2315777904, 'issue_id': 2486703477, 'author': 'heypoom', 'body': 'TODO: [address new feedback](https://www.notion.so/metabase/CLI-PR-review-2d2db46826ec42d8a4165972e9e22c2f?pvs=4)', 'created_at': datetime.datetime(2024, 8, 28, 16, 18, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2324020683, 'issue_id': 2486703477, 'author': 'WiNloSt', 'body': ""@heypoom Is this expected after skipping the license now? \r\n![image](https://github.com/user-attachments/assets/1c76bf7b-d9d9-4d6e-ad74-1dce9faf20e6)\r\n\r\nIt seems we need to extract part of [Feature flag and settings for SDK](https://www.notion.so/metabase/Feature-flag-and-settings-for-SDK-8ed424c776194528b6332c5fc2510a0c), that always allow `localhost:*` to master otherwise, we won't be able to test this as [`embedding-app-origin` requires a valid token](https://www.metabase.com/docs/latest/configuring-metabase/environment-variables#mb_embedding_app_origin), so we couldn't test this without a valid token."", 'created_at': datetime.datetime(2024, 9, 2, 7, 34, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2324055539, 'issue_id': 2486703477, 'author': 'heypoom', 'body': ""@WiNloSt It is supposed to fallback to API keys instead of JWT authentication if the license has been skipped. You're right, I think the problem is that even when we are using API keys for authentication, valid CORS headers are still needed for `localhost:*`. We'll need to wait for that part to be merged first.\r\n\r\n```ts\r\n  // Fallback to API keys when user switching is not enabled.\r\n  if (userSwitcherEnabled) {\r\n    apiKeyOrJwtConfig += `jwtProviderUri: \\`\\${BASE_SSO_API}/sso/metabase\\`,`;\r\n    imports = `import { AnalyticsContext, BASE_SSO_API } from './analytics-provider'`;\r\n  } else {\r\n    apiKeyOrJwtConfig += `apiKey: '${apiKey}'`;\r\n    imports = `import { AnalyticsContext } from './analytics-provider'`;\r\n  }\r\n```"", 'created_at': datetime.datetime(2024, 9, 2, 7, 52, 45, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2024-08-28 16:18:35 UTC): TODO: [address new feedback](https://www.notion.so/metabase/CLI-PR-review-2d2db46826ec42d8a4165972e9e22c2f?pvs=4)

WiNloSt on (2024-09-02 07:34:14 UTC): @heypoom Is this expected after skipping the license now? 
![image](https://github.com/user-attachments/assets/1c76bf7b-d9d9-4d6e-ad74-1dce9faf20e6)

It seems we need to extract part of [Feature flag and settings for SDK](https://www.notion.so/metabase/Feature-flag-and-settings-for-SDK-8ed424c776194528b6332c5fc2510a0c), that always allow `localhost:*` to master otherwise, we won't be able to test this as [`embedding-app-origin` requires a valid token](https://www.metabase.com/docs/latest/configuring-metabase/environment-variables#mb_embedding_app_origin), so we couldn't test this without a valid token.

heypoom (Issue Creator) on (2024-09-02 07:52:45 UTC): @WiNloSt It is supposed to fallback to API keys instead of JWT authentication if the license has been skipped. You're right, I think the problem is that even when we are using API keys for authentication, valid CORS headers are still needed for `localhost:*`. We'll need to wait for that part to be merged first.

```ts
  // Fallback to API keys when user switching is not enabled.
  if (userSwitcherEnabled) {
    apiKeyOrJwtConfig += `jwtProviderUri: \`\${BASE_SSO_API}/sso/metabase\`,`;
    imports = `import { AnalyticsContext, BASE_SSO_API } from './analytics-provider'`;
  } else {
    apiKeyOrJwtConfig += `apiKey: '${apiKey}'`;
    imports = `import { AnalyticsContext } from './analytics-provider'`;
  }
```

"
2486562191,pull_request,closed,,"ü§ñ backported ""[openapi] do not die when :query-params is not a map""","#44549

resolves #46901",metabase-bot[bot],2024-08-26 10:50:16+00:00,['piranha'],2024-08-26 13:58:54+00:00,2024-08-26 13:11:19+00:00,https://github.com/metabase/metabase/pull/47225,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2486538508,pull_request,closed,,"ü§ñ backported ""Add database type adjustments to server side generated temporal values""",#47039,github-automation-metabase,2024-08-26 10:37:05+00:00,"['lbrdnk', 'github-automation-metabase']",2024-08-26 12:09:37+00:00,2024-08-26 12:09:36+00:00,https://github.com/metabase/metabase/pull/47224,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2486484507,pull_request,closed,,[serdes] query action depends on stuff in its dataset_query,"no backport since it's the issue I discovered working on #47049 and it's fixed in there, so it's kind of a forward-port :)",piranha,2024-08-26 10:09:39+00:00,['piranha'],2024-10-08 16:16:29+00:00,2024-08-26 15:59:39+00:00,https://github.com/metabase/metabase/pull/47220,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2486446232,pull_request,closed,,fix import order in the files with disabled rules,"### Description

There were a few `eslint-disable import/order` rules. changing the imports order previously led to the circular dependencies problem, it's not a problem anymore, so we can remove `eslint-disable import/order`

### How to verify

CI is green",uladzimirdev,2024-08-26 09:51:46+00:00,['uladzimirdev'],2024-08-27 13:44:10+00:00,2024-08-26 20:36:56+00:00,https://github.com/metabase/metabase/pull/47217,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]","[{'comment_id': 2309815719, 'issue_id': 2486446232, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 2bb3eedecb55d6ba247d859b2c1b0205e35bf220...c3f5ef87101fd893b31e4574da7eaa0a0d2760d3.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/LeafletMap.jsx<br>frontend/src/metabase/visualizations/lib/settings.unit.spec.js<br>frontend/src/metabase/visualizations/lib/settings/column.js |', 'created_at': datetime.datetime(2024, 8, 26, 9, 54, 11, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-26 09:54:11 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 2bb3eedecb55d6ba247d859b2c1b0205e35bf220...c3f5ef87101fd893b31e4574da7eaa0a0d2760d3.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/LeafletMap.jsx<br>frontend/src/metabase/visualizations/lib/settings.unit.spec.js<br>frontend/src/metabase/visualizations/lib/settings/column.js |

"
2486405407,pull_request,closed,,Track query analysis failures,"This improves how we track queries that cannot be analyzed, by adding a status column to the parent record.

This also fixes a small bug in the sweeper, where it would repeat analysis of cards without any query fields.",crisptrutski,2024-08-26 09:33:05+00:00,['crisptrutski'],2024-10-08 16:16:24+00:00,2024-08-26 23:35:01+00:00,https://github.com/metabase/metabase/pull/47216,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]",[],
2486250914,pull_request,closed,,Move Group elements to the group components,,oisincoveney,2024-08-26 08:20:11+00:00,['oisincoveney'],2024-08-27 11:55:00+00:00,2024-08-27 11:54:58+00:00,https://github.com/metabase/metabase/pull/47215,"[('.Team/Embedding', '')]",[],
2486250278,pull_request,closed,,Remove unused props from right view and view footer,,oisincoveney,2024-08-26 08:19:52+00:00,['oisincoveney'],2024-08-27 11:20:09+00:00,2024-08-27 11:20:07+00:00,https://github.com/metabase/metabase/pull/47214,"[('.Team/Embedding', '')]",[],
2486249011,pull_request,closed,,Remove drilled props from ViewFooter components,"Removes drilled props from ViewFooter components. I've done this to make moving components and features to the SDK easier in the future - this helps modularize the components by encapsulating the dispatch and selectors from redux into the specific components where its needed, helping us move important bits and pieces to the SDK.

One main question was if we should be doing this, since there are some situations where we won't want redux data but rather data from props. We can sort these out on a component-by-component basis, whether that means creating a wrapper for SDK-specific data or using contexts. ",oisincoveney,2024-08-26 08:19:15+00:00,['oisincoveney'],2024-10-08 16:15:41+00:00,2024-09-02 18:51:21+00:00,https://github.com/metabase/metabase/pull/47213,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2486248248,pull_request,closed,,Remove ButtonBar,"Nukes `ButtonBar` from existence. It's a component that is made to be reused but in practice never is.

Basically, what ButtonBar does is create a `flex` container with `flex-direction:row` where the left and right containers are `flex:1`, which keeps the center component in the middle.  This is essentially what the styled component was doing, and was just doing the same with props and checking for the existence of components in the center (which I think was unnecessary).",oisincoveney,2024-08-26 08:18:52+00:00,['oisincoveney'],2024-10-08 16:15:56+00:00,2024-08-30 10:12:09+00:00,https://github.com/metabase/metabase/pull/47212,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2486200827,pull_request,closed,,feat(sdk): Use stable IDs in SDK components,"Uses https://github.com/metabase/metabase/pull/47094 to allow for stable IDs in SDK.

**_How to test_**
Now, you should just be able to use an entity ID in the `InteractiveQuestion` or `InteractiveDashboard` components and it should ‚ú® just work ‚ú®.

Right now, the best way to get an entity ID is to examine the network request when you are loading a dashboard or a question. When you go to a dashboard or question page, open up the `Network` Devtools tab, find a dashboard/question API call that loads the data, and then find the `entity_id` entry. You can then use that key for testing.

Ideally we'll have a _much_ easier way of getting this key in the future. For now, this is what we have to do üôÉ 

<img width=""872"" alt=""image"" src=""https://github.com/user-attachments/assets/23702025-9fb8-4e06-aeb7-c33389e667a1"">

<img width=""332"" alt=""image"" src=""https://github.com/user-attachments/assets/d3c5e2f1-7057-412d-bda6-42966e23de41"">

",oisincoveney,2024-08-26 07:54:28+00:00,['oisincoveney'],2024-10-08 16:15:41+00:00,2024-09-02 18:10:03+00:00,https://github.com/metabase/metabase/pull/47210,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2314681778, 'issue_id': 2486200827, 'author': 'oisincoveney', 'body': ""@heypoom @WiNloSt I've made some changes to the typing for BaseEntityID and added some type guards. I think it'll be better in terms of clamping down on types (i.e. not allowing _any_ string in the `entity_id` field) and added a `createMockEntityId` function so that we don't have random strings all the time.\r\n\r\nThe commit to view is here: [Add createMockEntityId and tighten BaseEntityID type to only accept n‚Ä¶](https://github.com/metabase/metabase/pull/47210/commits/1f5d6546a3c0f5f998f12b799b2719df7ce65839)"", 'created_at': datetime.datetime(2024, 8, 28, 8, 34, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2317493176, 'issue_id': 2486200827, 'author': 'npretto', 'body': 'I talked with Oisin and he let me push some TS magic to make the hook easier to use and with a stricter typing: c470b4dfd9af2bd4595dd613e9981593f6f1c70a', 'created_at': datetime.datetime(2024, 8, 29, 12, 19, 18, tzinfo=datetime.timezone.utc)}]","oisincoveney (Issue Creator) on (2024-08-28 08:34:14 UTC): @heypoom @WiNloSt I've made some changes to the typing for BaseEntityID and added some type guards. I think it'll be better in terms of clamping down on types (i.e. not allowing _any_ string in the `entity_id` field) and added a `createMockEntityId` function so that we don't have random strings all the time.

The commit to view is here: [Add createMockEntityId and tighten BaseEntityID type to only accept n‚Ä¶](https://github.com/metabase/metabase/pull/47210/commits/1f5d6546a3c0f5f998f12b799b2719df7ce65839)

npretto on (2024-08-29 12:19:18 UTC): I talked with Oisin and he let me push some TS magic to make the hook easier to use and with a stricter typing: c470b4dfd9af2bd4595dd613e9981593f6f1c70a

"
2485472947,pull_request,closed,,add sunburst to pie chart,"Closes https://github.com/metabase/metabase/issues/47209
Closes https://github.com/metabase/metabase/issues/8563

### Description

Adds a sunburst feature to the pie chart, using up to three dimension columns.

### How to verify

1. Create a question with three dimensions, one metric, see example below

<img width=""1210"" alt=""Screenshot 2024-09-26 at 2 48 39 PM"" src=""https://github.com/user-attachments/assets/d54740f8-9fbb-4747-be23-9d4ac60a0d38"">

2. Visualize as pie chart, should have automatically select dimension and metric columns

### Demo

<img width=""579"" alt=""Screenshot 2024-09-26 at 2 49 14 PM"" src=""https://github.com/user-attachments/assets/cf211e84-a2c4-4995-9259-421dcfd07279"">

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",EmmadUsmani,2024-08-25 21:29:23+00:00,['EmmadUsmani'],2024-10-03 22:26:48+00:00,2024-10-02 22:39:18+00:00,https://github.com/metabase/metabase/pull/47208,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team'), ('PR-Env', 'See https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458')]","[{'comment_id': 2309001116, 'issue_id': 2485472947, 'author': 'EmmadUsmani', 'body': '* **#47208** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47208?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* **#46607** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46607?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46505** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46505?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* **#46466** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46466?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 25, 21, 29, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2309001538, 'issue_id': 2485472947, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 3fd17081b26b985f0e564bc48f77ea18aa166fec...9e345ccfa09ffe630c928e580e491b379261744d.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/components/ChartTooltip/EChartsTooltip/EChartsTooltip.tsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingColorPicker/ChartSettingColorPicker.tsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingOrderedItems/ChartSettingOrderedItems.tsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingSeriesOrder.tsx<br>frontend/src/metabase/visualizations/components/settings/ColumnItem/ColumnItem.tsx<br>frontend/src/metabase/visualizations/echarts/pie/constants.ts<br>frontend/src/metabase/visualizations/echarts/pie/format.ts<br>frontend/src/metabase/visualizations/echarts/pie/model/index.ts<br>frontend/src/metabase/visualizations/echarts/pie/model/types.ts<br>frontend/src/metabase/visualizations/echarts/pie/option.ts<br>frontend/src/metabase/visualizations/echarts/pie/tooltip.tsx<br>frontend/src/metabase/visualizations/echarts/pie/types.ts<br>frontend/src/metabase/visualizations/echarts/pie/util/colors.ts<br>frontend/src/metabase/visualizations/echarts/pie/util/index.ts<br>frontend/src/metabase/visualizations/echarts/tooltip/index.tsx<br>frontend/src/metabase/visualizations/shared/settings/pie.ts<br>frontend/src/metabase/visualizations/types/hover.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/DimensionsWidget.modules.css<br>frontend/src/metabase/visualizations/visualizations/PieChart/DimensionsWidget.tsx<br>frontend/src/metabase/visualizations/visualizations/PieChart/PieChart.tsx<br>frontend/src/metabase/visualizations/visualizations/PieChart/PieRowsPicker.tsx<br>frontend/src/metabase/visualizations/visualizations/PieChart/chart-definition.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/use-chart-events.ts |\n| @ranquild | frontend/src/metabase/lib/colors/palette.ts |', 'created_at': datetime.datetime(2024, 8, 25, 21, 30, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2379728070, 'issue_id': 2485472947, 'author': 'EmmadUsmani', 'body': '@cdeweyx Thanks for the quick review and feedback!\r\n\r\n- Drill through not being available on the ""other"" slice is intentional, since we haven\'t had drills available on that slice before on the pie chart. We could add it in the future, although the functionality would likely be limited to just `Filter by this value`, since we can\'t easily write an MBQL query that returns the rows for the other slice.\r\n\r\n- Yeah improving the color logic would require some investigation. I think I\'ll focus on merging the sunburst as is first, and if I have time next week I can look into this.', 'created_at': datetime.datetime(2024, 9, 27, 17, 14, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2380068452, 'issue_id': 2485472947, 'author': 'cdeweyx', 'body': '> @cdeweyx Thanks for the quick review and feedback!\r\n> \r\n> * Drill through not being available on the ""other"" slice is intentional, since we haven\'t had drills available on that slice before on the pie chart. We could add it in the future, although the functionality would likely be limited to just `Filter by this value`, since we can\'t easily write an MBQL query that returns the rows for the other slice.\r\n> * Yeah improving the color logic would require some investigation. I think I\'ll focus on merging the sunburst as is first, and if I have time next week I can look into this.\r\n\r\nGotcha, both sound reasonable to me. Let\'s merge this üëç', 'created_at': datetime.datetime(2024, 9, 27, 21, 14, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2389567854, 'issue_id': 2485472947, 'author': 'EmmadUsmani', 'body': ""@alxnddr Thanks, yeah I can try to do that. Are there any specific cases you'd like to test regarding click behavior?"", 'created_at': datetime.datetime(2024, 10, 2, 19, 58, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2389571017, 'issue_id': 2485472947, 'author': 'alxnddr', 'body': ""> Are there any specific cases you'd like to test regarding click behavior?\r\n\r\n@EmmadUsmani it would be great to verify that clicks on circles on all levels pass correct data for example when interpolating URLs or setting dashboard filter values"", 'created_at': datetime.datetime(2024, 10, 2, 20, 0, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2389774327, 'issue_id': 2485472947, 'author': 'github-actions[bot]', 'body': 'üëã Deploying a preview environment for commit 9e345ccfa09ffe630c928e580e491b379261744d.\n‚úÖ Preview:\n    https://pr47208.coredev.metabase.com\nüóíÔ∏è [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)\n<!-- Sticky Pull Request Comment -->', 'created_at': datetime.datetime(2024, 10, 2, 22, 7, 58, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-08-25 21:29:40 UTC): * **#47208** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47208?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* **#46607** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46607?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46505** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46505?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* **#46466** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/46466?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a>
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

github-actions[bot] on (2024-08-25 21:30:51 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 3fd17081b26b985f0e564bc48f77ea18aa166fec...9e345ccfa09ffe630c928e580e491b379261744d.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/components/ChartTooltip/EChartsTooltip/EChartsTooltip.tsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingColorPicker/ChartSettingColorPicker.tsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingOrderedItems/ChartSettingOrderedItems.tsx<br>frontend/src/metabase/visualizations/components/settings/ChartSettingSeriesOrder.tsx<br>frontend/src/metabase/visualizations/components/settings/ColumnItem/ColumnItem.tsx<br>frontend/src/metabase/visualizations/echarts/pie/constants.ts<br>frontend/src/metabase/visualizations/echarts/pie/format.ts<br>frontend/src/metabase/visualizations/echarts/pie/model/index.ts<br>frontend/src/metabase/visualizations/echarts/pie/model/types.ts<br>frontend/src/metabase/visualizations/echarts/pie/option.ts<br>frontend/src/metabase/visualizations/echarts/pie/tooltip.tsx<br>frontend/src/metabase/visualizations/echarts/pie/types.ts<br>frontend/src/metabase/visualizations/echarts/pie/util/colors.ts<br>frontend/src/metabase/visualizations/echarts/pie/util/index.ts<br>frontend/src/metabase/visualizations/echarts/tooltip/index.tsx<br>frontend/src/metabase/visualizations/shared/settings/pie.ts<br>frontend/src/metabase/visualizations/types/hover.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/DimensionsWidget.modules.css<br>frontend/src/metabase/visualizations/visualizations/PieChart/DimensionsWidget.tsx<br>frontend/src/metabase/visualizations/visualizations/PieChart/PieChart.tsx<br>frontend/src/metabase/visualizations/visualizations/PieChart/PieRowsPicker.tsx<br>frontend/src/metabase/visualizations/visualizations/PieChart/chart-definition.ts<br>frontend/src/metabase/visualizations/visualizations/PieChart/use-chart-events.ts |
| @ranquild | frontend/src/metabase/lib/colors/palette.ts |

EmmadUsmani (Issue Creator) on (2024-09-27 17:14:35 UTC): @cdeweyx Thanks for the quick review and feedback!

- Drill through not being available on the ""other"" slice is intentional, since we haven't had drills available on that slice before on the pie chart. We could add it in the future, although the functionality would likely be limited to just `Filter by this value`, since we can't easily write an MBQL query that returns the rows for the other slice.

- Yeah improving the color logic would require some investigation. I think I'll focus on merging the sunburst as is first, and if I have time next week I can look into this.

cdeweyx on (2024-09-27 21:14:44 UTC): Gotcha, both sound reasonable to me. Let's merge this üëç

EmmadUsmani (Issue Creator) on (2024-10-02 19:58:33 UTC): @alxnddr Thanks, yeah I can try to do that. Are there any specific cases you'd like to test regarding click behavior?

alxnddr on (2024-10-02 20:00:23 UTC): @EmmadUsmani it would be great to verify that clicks on circles on all levels pass correct data for example when interpolating URLs or setting dashboard filter values

github-actions[bot] on (2024-10-02 22:07:58 UTC): üëã Deploying a preview environment for commit 9e345ccfa09ffe630c928e580e491b379261744d.
‚úÖ Preview:
    https://pr47208.coredev.metabase.com
üóíÔ∏è [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)
<!-- Sticky Pull Request Comment -->

"
2484443242,pull_request,closed,,Add logging catch around query analysis worker,"I'm still trying to track down the queuing issue that causes certain cards to get ignored for analysis, while continuing to analyze others. I cannot reproduce it in either dev (patched to run in prod mode) or in an ephemeral environment (with [logging cranked to 11](https://github.com/metabase/metabase/pull/47128)).

The only theory I have is that somehow the card is becoming a poison pill, so adding catch-all exception logging.

1. Add a catch for unexpected errors, to log it.
2. End loop on an unexpected error - let the job get rescheduled in < 1m. This is an easy way to avoid spinning.
3. Move where we check whether the feature is enabled, so that we still clear the queue if disabled.",crisptrutski,2024-08-24 09:42:26+00:00,['crisptrutski'],2024-10-08 16:16:31+00:00,2024-08-26 10:25:16+00:00,https://github.com/metabase/metabase/pull/47206,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2484036920,pull_request,closed,,"ü§ñ backported ""Fix `mu/fn` and `mu/defn` support for map schemas on key-value args """,#47153,github-automation-metabase,2024-08-23 23:26:09+00:00,"['camsaul', 'github-automation-metabase']",2024-08-24 00:20:11+00:00,2024-08-24 00:20:10+00:00,https://github.com/metabase/metabase/pull/47205,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2483927816,pull_request,closed,,"ü§ñ backported ""Strip expression metadata for field expression""","  #47155
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-23 21:31:21+00:00,"['metamben', 'github-automation-metabase']",2024-08-25 21:21:18+00:00,2024-08-25 21:21:17+00:00,https://github.com/metabase/metabase/pull/47204,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2483916346,pull_request,closed,,(WIP) Add github-actions to jest reporters,,rafpaf,2024-08-23 21:21:00+00:00,['rafpaf'],2024-08-30 18:02:06+00:00,2024-08-30 18:02:06+00:00,https://github.com/metabase/metabase/pull/47203,"[('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2307831830, 'issue_id': 2483916346, 'author': 'rafpaf', 'body': 'I just noticed that we explored adding this last September https://github.com/metabase/metabase/pull/34175', 'created_at': datetime.datetime(2024, 8, 23, 21, 26, 20, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-08-23 21:26:20 UTC): I just noticed that we explored adding this last September https://github.com/metabase/metabase/pull/34175

"
2483909374,pull_request,closed,,fix echarts tooltip positioning,"[Slack report](https://metaboat.slack.com/archives/C064QMXEV9N/p1724420805312869)

### Description

The ECharts tooltip was incorrectly positioned due to a typo: https://github.com/metabase/metabase/pull/47202/files#diff-51212fbc38534d26a2519dd4d790de89d8c0246fc9354fb2aae57d75d9571bebL41

### How to verify

Create a single series line chart with a time dimension and put it on a dashboard to the right
Ensure tooltip does not go out of the screen

### Demo

**Before**
<img width=""285"" alt=""Screenshot 2024-08-23 at 5 14 10‚ÄØPM"" src=""https://github.com/user-attachments/assets/749e86f6-29cf-4e75-821b-66b6f4237d54"">

**After**
<img width=""445"" alt=""Screenshot 2024-08-23 at 5 13 47‚ÄØPM"" src=""https://github.com/user-attachments/assets/a225b51c-4062-42e6-b629-d429e2ae76b8"">

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",alxnddr,2024-08-23 21:16:00+00:00,['alxnddr'],2024-10-08 16:16:33+00:00,2024-08-23 22:27:01+00:00,https://github.com/metabase/metabase/pull/47202,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2483866920,pull_request,closed,,Use more precise query contexts when recording execution of public downloads,"We've been recording query executions for embedded downloads using the contexts `:embedded-csv-download`, `:embedded-xlsx-download`, and `:embedded-json-download`. But for public downloads we were just using `:public-question` for all of these cases. This PR adds equivalent contexts for public downloads: `:public-csv-download`, `:public-xlsx-download`, and `:public-json-download`.

Resolves https://github.com/metabase/metabase/issues/45147

To be precise, the original issue title is slightly wrong: the downloads _were_ being logged, but were indistinguishable from normal queries. ",noahmoss,2024-08-23 20:46:11+00:00,['noahmoss'],2024-08-26 15:27:07+00:00,2024-08-26 15:27:05+00:00,https://github.com/metabase/metabase/pull/47201,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2307788195, 'issue_id': 2483866920, 'author': 'noahmoss', 'body': '* **#47201** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47201?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 23, 20, 46, 32, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2024-08-23 20:46:32 UTC): * **#47201** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47201?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @noahmoss and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2483804152,pull_request,closed,,Summarize step changes for metrics,"Epic https://github.com/metabase/metabase/issues/47147
Closes https://github.com/metabase/metabase/issues/47148

Changes for metrics:
- ""Summarize"" step title becomes ""Formula""
- ""Default time dimension"" title for breakouts
- Cannot remove the summarize step

Implementation details:
- Allows a custom `StepHeader` component for a step. Because of the layout issues, we need to have the breakout title in 2 places. This is extensively tested.
- While not used in `SummarizeStepHeader`, `steps` do not allow reverting the summarize step.

<img width=""1728"" alt=""Screenshot 2024-08-23 at 21 54 54"" src=""https://github.com/user-attachments/assets/51e02b72-ceea-467a-a64f-6ceb6649549b"">
<img width=""952"" alt=""Screenshot 2024-08-23 at 21 55 05"" src=""https://github.com/user-attachments/assets/a4679c0a-95f8-4c1c-a4d1-292ca217d40f"">
<img width=""948"" alt=""Screenshot 2024-08-23 at 21 55 34"" src=""https://github.com/user-attachments/assets/db0e24bd-e9df-4fe5-89fa-46229de5bea7"">
",ranquild,2024-08-23 19:59:19+00:00,['ranquild'],2024-08-27 19:25:50+00:00,2024-08-27 19:25:50+00:00,https://github.com/metabase/metabase/pull/47200,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]",[],
2483723253,pull_request,closed,,"ü§ñ backported ""[Permissions] Data permissions graph utils reorganization""",#47023,github-automation-metabase,2024-08-23 19:08:11+00:00,"['sloansparger', 'github-automation-metabase']",2024-08-23 19:44:25+00:00,2024-08-23 19:44:24+00:00,https://github.com/metabase/metabase/pull/47199,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2483563758,pull_request,closed,,"ü§ñ backported ""Fix issues with column matching for multiple breakouts of the same column""","  #46979
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-23 17:22:37+00:00,"['ranquild', 'github-automation-metabase']",2024-08-29 15:11:19+00:00,2024-08-29 15:11:17+00:00,https://github.com/metabase/metabase/pull/47195,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2483557004,pull_request,closed,,docs - locale for static and public links,"How to set locale for static and public links.

Also tacked on a small formatting fix.",jeff-bruemmer,2024-08-23 17:18:44+00:00,['jeff-bruemmer'],2024-08-26 20:37:37+00:00,2024-08-26 20:34:33+00:00,https://github.com/metabase/metabase/pull/47194,"[('Type:Documentation', ''), ('backport', 'Automatically create PR on current release branch on merge')]",[],
2483476966,pull_request,closed,,Ensure that CI checks fail if cljs tests fail,"### Description

Ensure that if `yarn test-cljs` fails it fails the CI checks

When configured to autorun, the command `shadow-cljs compile test` will exit with success even if test failures occur in the node test. See https://github.com/thheller/shadow-cljs/issues/425

In order to ensure our CI checks fail when cljs tests fail, we need to invoke node directly. To prevent running the tests twice, remove `:autorun true` from the `:test` target in shadow-cljs.edn.

Prior to this change, the command exits successfully, even though some tests are failing. After this change, test failures cause the yarn command to fail (and any currently failing tests have been fixed or disabled).

### How to verify

Describe the steps to verify that the changes are working as expected.

`yarn test-cljs`

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",appleby,2024-08-23 16:26:36+00:00,['appleby'],2024-08-27 23:39:56+00:00,2024-08-27 19:15:50+00:00,https://github.com/metabase/metabase/pull/47192,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2307428756, 'issue_id': 2483476966, 'author': 'appleby', 'body': ""Not sure if this wants to be back ported or not. I've added a no-backport label for now, feel free to change if anyone feels it should be back ported."", 'created_at': datetime.datetime(2024, 8, 23, 16, 34, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2310627886, 'issue_id': 2483476966, 'author': 'appleby', 'body': ""> Not sure if this wants to be back ported or not. I've added a no-backport label for now, feel free to change if anyone feels it should be back ported.\r\n\r\nActually, I think we do want to backport this. Updated the label to `backport`"", 'created_at': datetime.datetime(2024, 8, 26, 16, 42, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2310961161, 'issue_id': 2483476966, 'author': 'appleby', 'body': ""> Good catch. I swear I saw the test-cljs job fail on CI before but maybe something changed at some point\r\n\r\nThey were modified at some point to prevent running the tests twice in CI, but that broke the CI checks. To be fair it's an easy thing to miss since no tests were failing at the time, and if you didn't know about shadow-cljs behavior, it's reasonable to assume that `shadow-cljs compile test` will exit with failure if any tests fail."", 'created_at': datetime.datetime(2024, 8, 26, 19, 50, 29, tzinfo=datetime.timezone.utc)}]","appleby (Issue Creator) on (2024-08-23 16:34:15 UTC): Not sure if this wants to be back ported or not. I've added a no-backport label for now, feel free to change if anyone feels it should be back ported.

appleby (Issue Creator) on (2024-08-26 16:42:59 UTC): Actually, I think we do want to backport this. Updated the label to `backport`

appleby (Issue Creator) on (2024-08-26 19:50:29 UTC): They were modified at some point to prevent running the tests twice in CI, but that broke the CI checks. To be fair it's an easy thing to miss since no tests were failing at the time, and if you didn't know about shadow-cljs behavior, it's reasonable to assume that `shadow-cljs compile test` will exit with failure if any tests fail.

"
2483462028,pull_request,closed,,Move Notebook to metabase/querying,"Epic https://github.com/metabase/metabase/issues/47147
Moves the component with subcomponents to metabase/querying/notebook.",ranquild,2024-08-23 16:16:12+00:00,['ranquild'],2024-08-26 13:41:00+00:00,2024-08-26 13:40:58+00:00,https://github.com/metabase/metabase/pull/47191,"[('.Team/Querying', '')]",[],
2483417747,pull_request,closed,,Remove unneeded index.ts files in querying,"Epic https://github.com/metabase/metabase/issues/47147
Follow up for https://github.com/metabase/metabase/pull/47160

Removes unneeded re-exports.",ranquild,2024-08-23 15:47:42+00:00,['ranquild'],2024-10-08 16:16:30+00:00,2024-08-26 14:13:52+00:00,https://github.com/metabase/metabase/pull/47190,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2307355171, 'issue_id': 2483417747, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@ranquild You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 23, 15, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2307356859, 'issue_id': 2483417747, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 839717c9613832cd8529dedd4decb5057255e74b...559c185b5f35f92c903e4726db30e7bc1ec15450.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/click-actions/Mode/Mode.ts<br>frontend/src/metabase/visualizations/components/settings/ChartSettingTableColumns/ChartSettingTableColumns.tsx |', 'created_at': datetime.datetime(2024, 8, 23, 15, 49, 6, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-23 15:48:00 UTC): <!---conventional commit reminder comment ID-->
@ranquild You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-23 15:49:06 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 839717c9613832cd8529dedd4decb5057255e74b...559c185b5f35f92c903e4726db30e7bc1ec15450.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/click-actions/Mode/Mode.ts<br>frontend/src/metabase/visualizations/components/settings/ChartSettingTableColumns/ChartSettingTableColumns.tsx |

"
2483398945,pull_request,closed,,Add a new SDK setting page and it's dependencies,"Closes https://github.com/metabase/metabase/issues/47185

### Description
>[!Note]
> Please note that since this PR fixes quite a lot of existing tests, I'd rather add new tests in a separate PR to make reviewing much more easier.

This PR only add UIs for the new embedding SDK settings page. 

### How to verify

With pro license with `embedding` feature flag (we'll use this until we added `embedding-sdk` to the test token)
- Go to embedding settings page, and see that you can configure embedding SDK for react.
- Click `Configure` should bring you to the SDK settings page
- You should be able to modify the input (more logic around disabling would be added once we added `enable-embedding-sdk` in the next task)

With OSS
- Go to embedding settings page, and see that you can try out embedding SDK for react.
- Click `Try it out` should bring you to the SDK settings page
- The input should be disabled.

### Demo

#### EE
- ![image](https://github.com/user-attachments/assets/47936728-74ba-445b-a1b9-fdb6a659087a)
- ![image](https://github.com/user-attachments/assets/7527db0c-dcac-4fa1-9bd8-014d0cc0ff7a)
- ![image](https://github.com/user-attachments/assets/e432ff8f-4a3f-476b-a562-053aa7201ce8)

#### OSS
- ![image](https://github.com/user-attachments/assets/b1e14953-8500-4fe4-9028-b185e1e02020)
- ![image](https://github.com/user-attachments/assets/66db60df-d963-45c4-8bf7-9d162c5b0e52)
- ![image](https://github.com/user-attachments/assets/20dc46ac-fd19-420b-9cb8-b63b19579c01)





### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",WiNloSt,2024-08-23 15:35:59+00:00,['WiNloSt'],2024-09-04 07:16:59+00:00,2024-09-03 17:13:40+00:00,https://github.com/metabase/metabase/pull/47189,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2320506176, 'issue_id': 2483398945, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 9053d6fe2b8a9500e67559d35d39259a8a87c4f6...8366ed7348ef661206d796f8f94a63c34b519690.\n\n| Notify | File(s) |\n|-|-|\n| @kdoh | frontend/src/metabase/ui/components/inputs/Input/Input.styled.tsx |', 'created_at': datetime.datetime(2024, 8, 30, 8, 39, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2327039777, 'issue_id': 2483398945, 'author': 'WiNloSt', 'body': ""[Got a green light](https://metaboat.slack.com/archives/C063Q3F1HPF/p1725381207533429?thread_ts=1725351519.627739&cid=C063Q3F1HPF) from our designer on the new color. So I'll merge this new color as is."", 'created_at': datetime.datetime(2024, 9, 3, 17, 13, 38, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-30 08:39:42 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 9053d6fe2b8a9500e67559d35d39259a8a87c4f6...8366ed7348ef661206d796f8f94a63c34b519690.

| Notify | File(s) |
|-|-|
| @kdoh | frontend/src/metabase/ui/components/inputs/Input/Input.styled.tsx |

WiNloSt (Issue Creator) on (2024-09-03 17:13:38 UTC): [Got a green light](https://metaboat.slack.com/archives/C063Q3F1HPF/p1725381207533429?thread_ts=1725351519.627739&cid=C063Q3F1HPF) from our designer on the new color. So I'll merge this new color as is.

"
2483328747,pull_request,closed,,Move stale endpoint to /ee/stale/${collection-id},"It's an enterprise-only endpoint, so it makes sense to put the whole thing under enterprise.",johnswanson,2024-08-23 14:56:39+00:00,['johnswanson'],2024-10-08 16:14:59+00:00,2024-09-10 21:36:12+00:00,https://github.com/metabase/metabase/pull/47188,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2483260436,pull_request,closed,,locale query string support on public links and static embeds,"This pr addresses [Support language localization in static embedding](https://www.notion.so/metabase/Support-language-localization-in-static-embedding-0307665e3008435d9bb2b3fff8148d7d).

The feature was apparently already working with one small caveat: we have some code that removes all querystring parameters that are not filters, this refreshing the page losing the locale as reported [by Jeff on slack](https://metaboat.slack.com/archives/C01R1JY03J4/p1724432620858359?thread_ts=1724416506.249269&cid=C01R1JY03J4)

The rest of the code changes are tests for the 4 different contexts (public/static, question/dashboard) ",npretto,2024-08-23 14:20:59+00:00,['npretto'],2024-08-30 15:54:36+00:00,2024-08-29 13:14:42+00:00,https://github.com/metabase/metabase/pull/47186,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Embedding', '')]",[],
2483240964,pull_request,closed,,Re-add `creator` to query validation API,I accidentally removed this in a previous commit üòÖ ,johnswanson,2024-08-23 14:10:33+00:00,['johnswanson'],2024-10-08 16:16:30+00:00,2024-08-26 14:50:28+00:00,https://github.com/metabase/metabase/pull/47183,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2483120879,pull_request,closed,,Don't encrypt boolean settings (by default),"We have tooling to disable encryption on settings even when the `MB_ENCRYPTION_SECRET_KEY` is set. Turn it on by default for all boolean settings, which don't need to be encrypted.

I also optimized the code that decrypts settings on startup because I didn't want to delay startup if someone had set a bunch of boolean settings. With 20 set, the old version added about 200+ ms to startup, about 10ms per boolean setting, whether or not it was encrypted or in the DB already. The optimized version selects all the never-encrypt values from the database at once (a bit silly, but we also just exclude raw `true` and `false` values so we don't bother checking them) and updates them if they're encrypted - this adds ~40ms to startup with 20 encrypted boolean settings (about 2ms per boolean setting) and ~5ms to startup on subsequent runs, when no encrypted values are in the DB.

Fixes #47101 ",johnswanson,2024-08-23 13:11:21+00:00,['johnswanson'],2024-08-26 22:48:05+00:00,2024-08-26 22:48:04+00:00,https://github.com/metabase/metabase/pull/47179,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2483116060,pull_request,closed,,Lower logging level for query analysis,"This logging has served its purpose, and we don't want it making its way into the next release.",crisptrutski,2024-08-23 13:08:56+00:00,['crisptrutski'],2024-10-08 16:16:37+00:00,2024-08-23 14:00:50+00:00,https://github.com/metabase/metabase/pull/47178,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2483099135,pull_request,closed,,"ü§ñ backported ""[serialization] extract subtree should hydrate entities""","  #47171
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-23 12:59:49+00:00,"['qnkhuat', 'github-automation-metabase']",2024-08-24 04:38:54+00:00,2024-08-24 04:38:54+00:00,https://github.com/metabase/metabase/pull/47177,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2308081698, 'issue_id': 2483099135, 'author': 'piranha', 'body': 'will be done together in #47049', 'created_at': datetime.datetime(2024, 8, 24, 4, 38, 54, tzinfo=datetime.timezone.utc)}]","piranha on (2024-08-24 04:38:54 UTC): will be done together in #47049

"
2483046177,pull_request,closed,,"ü§ñ backported ""Update UTM tags in static embed modal links""","  #47116

Changes from the original PR:
- backport changes from `LookAndFeelSettings` to `AppearanceSettings`, we discussed that we won't change the UTM tag and will leave the `utm_content` as is as `static-embed-settings-look-and-feel`
- Add an additional upgrade URL in `AppearanceSettings` since the URL on master is handled by an upsell UI, the URL is the same as on master.",github-automation-metabase,2024-08-23 12:32:15+00:00,"['WiNloSt', 'github-automation-metabase']",2024-08-23 14:13:48+00:00,2024-08-23 14:13:46+00:00,https://github.com/metabase/metabase/pull/47176,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2483036427,pull_request,closed,,Fix `DateTimeRange` substitution for open ranges,"Closes https://github.com/metabase/metabase/issues/47172

This PR fixes replacement snippet generation for open ranges.

Additionally adds E2E reproduction for this issue, which confirms it's been fixed.

The assertion when the question is in the dashboard
<img width=""1993"" alt=""image"" src=""https://github.com/user-attachments/assets/e214c59f-f24e-4ca8-bd65-2f5ad8de0386"">

The final assertion on the question itself
<img width=""1993"" alt=""image"" src=""https://github.com/user-attachments/assets/3d4b6abe-98a9-4b49-824b-53758a756698"">",lbrdnk,2024-08-23 12:26:57+00:00,['lbrdnk'],2024-08-26 12:51:47+00:00,2024-08-26 12:51:45+00:00,https://github.com/metabase/metabase/pull/47175,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]","[{'comment_id': 2307232209, 'issue_id': 2483036427, 'author': 'nemanjaglumac', 'body': 'And just for the good measure, this is how the test behaves without a fix\r\n\r\nDashboard\r\n<img width=""1992"" alt=""image"" src=""https://github.com/user-attachments/assets/1a77d05a-4040-4f4e-84d9-90857135790a"">\r\n\r\nQuestion\r\n<img width=""1993"" alt=""image"" src=""https://github.com/user-attachments/assets/fc0f2b1d-464f-43d7-b926-40672974164e"">', 'created_at': datetime.datetime(2024, 8, 23, 14, 39, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2307667691, 'issue_id': 2483036427, 'author': 'nemanjaglumac', 'body': '> Would it make sense to add a backend test for this?\r\n> \r\n> test/metabase/driver/sql/parameters/substitution_test.clj\r\n\r\nI wanted to ask/propose the same.\r\nRegardless of the E2E test, we should probably have additional backend test(s).\r\n\r\nIt is ok to add them later, as a follow up, if we want to close the P1 asap. Just please create an issue for it, if you decide to do it like that.', 'created_at': datetime.datetime(2024, 8, 23, 19, 12, 29, tzinfo=datetime.timezone.utc)}]","nemanjaglumac on (2024-08-23 14:39:15 UTC): And just for the good measure, this is how the test behaves without a fix

Dashboard
<img width=""1992"" alt=""image"" src=""https://github.com/user-attachments/assets/1a77d05a-4040-4f4e-84d9-90857135790a"">

Question
<img width=""1993"" alt=""image"" src=""https://github.com/user-attachments/assets/fc0f2b1d-464f-43d7-b926-40672974164e"">

nemanjaglumac on (2024-08-23 19:12:29 UTC): I wanted to ask/propose the same.
Regardless of the E2E test, we should probably have additional backend test(s).

It is ok to add them later, as a follow up, if we want to close the P1 asap. Just please create an issue for it, if you decide to do it like that.

"
2483013047,pull_request,closed,,Update SDK version to 0.1.32,Update Readme version references and published npm package version to 0.1.32,github-automation-metabase,2024-08-23 12:13:49+00:00,"['heypoom', 'github-automation-metabase']",2024-10-08 16:16:32+00:00,2024-08-26 07:23:57+00:00,https://github.com/metabase/metabase/pull/47174,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2306967918, 'issue_id': 2483013047, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 23, 12, 14, 7, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-23 12:14:07 UTC): <!---conventional commit reminder comment ID-->
@WiNloSt You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

"
2482814195,pull_request,closed,,[serialization] extract subtree should hydrate entities,,qnkhuat,2024-08-23 10:15:55+00:00,['qnkhuat'],2024-08-26 10:09:54+00:00,2024-08-23 12:59:03+00:00,https://github.com/metabase/metabase/pull/47171,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2482677643,pull_request,closed,,fix(sdk): apply the default viz height only in visualization view,"Closes https://github.com/metabase/metabase/issues/46825

### Description

Fixes the interactive question's filters panel being cut-off due to the default visualization height. We only apply the default viz height when in the visualization view, and there is no parent height available. We fallback to full-height if the parent height is already available.

```jsx
<div className=""App"" style={{ width: 1200, height: 800 }}>
  <InteractiveQuestion questionId={158} />
</div>
```

Note: we can't test this without E2E, as react-testing-library doesn't actually have layout engine that defines the height, so `useElementSize` doesn't take effect

### How to verify

- Use the above code sample
- The default visualization height should only take effect when in the Visualization tab, and there is no parent height available.

### Demo

Without parent height defined:

https://github.com/user-attachments/assets/f90e85fc-d790-4470-b8c1-47e0bedce839",heypoom,2024-08-23 09:04:50+00:00,['oisincoveney'],2024-08-23 11:56:37+00:00,2024-08-23 11:56:35+00:00,https://github.com/metabase/metabase/pull/47169,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2306644629, 'issue_id': 2482677643, 'author': 'heypoom', 'body': '(adding tests)', 'created_at': datetime.datetime(2024, 8, 23, 9, 6, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2306645105, 'issue_id': 2482677643, 'author': 'oisincoveney', 'body': ""this isn't a fix though, is it? this seems like a bandaid"", 'created_at': datetime.datetime(2024, 8, 23, 9, 6, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2306654999, 'issue_id': 2482677643, 'author': 'heypoom', 'body': ""@oisincoveney this happens only when the height prop is not passed though, so it's really because of the viz default height. or, would you rather move the default height to the QuestionVisualization instead?"", 'created_at': datetime.datetime(2024, 8, 23, 9, 12, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2306663942, 'issue_id': 2482677643, 'author': 'heypoom', 'body': '@oisincoveney `QuestionVisualization` has `useSdkElementSize` which measures the element size by ref though, so I suppose we can compute the default values there if the element height is 0.\r\n\r\nHowever, it looks like `useSdkElementSize` is also setting a default height via `(width ? width / 9 : 500)`, which I don\'t think takes effect today because of `getDefaultVizHeight`\r\n\r\nFor reference, here\'s `useSdkElementSize`\r\n\r\n```ts\r\nimport { useElementSize } from ""@mantine/hooks"";\r\n\r\nexport const useSdkElementSize = () => {\r\n  const { height, ref, width } = useElementSize();\r\n\r\n  // Some of our components by default don\'t have a specified height (i.e. the Visualization component)\r\n  // and are rendering with a height of 0. This is a workaround to set a default height for those components.\r\n  const elementHeight = height || (width ? width / 9 : 500);\r\n\r\n  return { height: elementHeight, ref, width };\r\n};\r\n```\r\n\r\nAnd here\'s `getDefaultVizHeight`\r\n\r\n```ts\r\n/**\r\n * How many pixels are in each cell?\r\n *\r\n * The card size default height are measured in number of cells,\r\n * so a display size of 5 cells would be 5 * VIZ_CELL_HEIGHT pixels tall.\r\n **/\r\nconst VIZ_CELL_HEIGHT = 50;\r\n\r\ntype VisualizationSize = { width: number; height: number };\r\n\r\nconst VISUALIZATION_SIZES: {\r\n  [key: CardDisplayType]: {\r\n    min: VisualizationSize;\r\n    default: VisualizationSize;\r\n  };\r\n} = CARD_SIZE_DEFAULTS_JSON;\r\n\r\n/**\r\n * Default height for each visualization type.\r\n *\r\n * The values are derived from the visualization\'s default size in the dashboard.\r\n */\r\nexport function getDefaultVizHeight(type: CardDisplayType): number {\r\n  return VISUALIZATION_SIZES?.[type]?.default?.height * VIZ_CELL_HEIGHT;\r\n}\r\n```', 'created_at': datetime.datetime(2024, 8, 23, 9, 17, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2306666554, 'issue_id': 2482677643, 'author': 'oisincoveney', 'body': ""> this happens only when the height prop is not passed though\r\n\r\nIf the height prop isn't passed through, we should be going 100% width and height like the filter and summarize components, no? We shouldn't have different defaults for each component\r\n\r\nThe only reason `useSdkElementSize` has a weird height is if there is just no height that comes from the outer Box, so we have to have some default value. Otherwise, if the Box takes up the whole space (which, as a 100% width and height div, it should), then the visualization should match that"", 'created_at': datetime.datetime(2024, 8, 23, 9, 18, 58, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2024-08-23 09:06:38 UTC): (adding tests)

oisincoveney (Assginee) on (2024-08-23 09:06:54 UTC): this isn't a fix though, is it? this seems like a bandaid

heypoom (Issue Creator) on (2024-08-23 09:12:27 UTC): @oisincoveney this happens only when the height prop is not passed though, so it's really because of the viz default height. or, would you rather move the default height to the QuestionVisualization instead?

heypoom (Issue Creator) on (2024-08-23 09:17:27 UTC): @oisincoveney `QuestionVisualization` has `useSdkElementSize` which measures the element size by ref though, so I suppose we can compute the default values there if the element height is 0.

However, it looks like `useSdkElementSize` is also setting a default height via `(width ? width / 9 : 500)`, which I don't think takes effect today because of `getDefaultVizHeight`

For reference, here's `useSdkElementSize`

```ts
import { useElementSize } from ""@mantine/hooks"";

export const useSdkElementSize = () => {
  const { height, ref, width } = useElementSize();

  // Some of our components by default don't have a specified height (i.e. the Visualization component)
  // and are rendering with a height of 0. This is a workaround to set a default height for those components.
  const elementHeight = height || (width ? width / 9 : 500);

  return { height: elementHeight, ref, width };
};
```

And here's `getDefaultVizHeight`

```ts
/**
 * How many pixels are in each cell?
 *
 * The card size default height are measured in number of cells,
 * so a display size of 5 cells would be 5 * VIZ_CELL_HEIGHT pixels tall.
 **/
const VIZ_CELL_HEIGHT = 50;

type VisualizationSize = { width: number; height: number };

const VISUALIZATION_SIZES: {
  [key: CardDisplayType]: {
    min: VisualizationSize;
    default: VisualizationSize;
  };
} = CARD_SIZE_DEFAULTS_JSON;

/**
 * Default height for each visualization type.
 *
 * The values are derived from the visualization's default size in the dashboard.
 */
export function getDefaultVizHeight(type: CardDisplayType): number {
  return VISUALIZATION_SIZES?.[type]?.default?.height * VIZ_CELL_HEIGHT;
}
```

oisincoveney (Assginee) on (2024-08-23 09:18:58 UTC): If the height prop isn't passed through, we should be going 100% width and height like the filter and summarize components, no? We shouldn't have different defaults for each component

The only reason `useSdkElementSize` has a weird height is if there is just no height that comes from the outer Box, so we have to have some default value. Otherwise, if the Box takes up the whole space (which, as a 100% width and height div, it should), then the visualization should match that

"
2482544013,pull_request,closed,,[Epic] Show columns from all stages in the dashboard filters,"Closes #46519
Closes #19744

### Description

Integration branch for #46519
",kamilmielnik,2024-08-23 07:51:56+00:00,['kamilmielnik'],2024-11-22 22:49:13+00:00,2024-11-22 22:49:10+00:00,https://github.com/metabase/metabase/pull/47167,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2411172637, 'issue_id': 2482544013, 'author': 'kamilmielnik', 'body': 'Reference for sanity: https://github.com/metabase/metabase/pull/47167/commits/3373c1862e9da488c3ac827fa634a35853b34117 passes the CI 100% ([image](https://github.com/user-attachments/assets/6cb5b381-e62f-4eaf-842a-f4c81b1b74f0))', 'created_at': datetime.datetime(2024, 10, 14, 13, 2, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2428982974, 'issue_id': 2482544013, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@metamben You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 10, 22, 11, 6, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2446618993, 'issue_id': 2482544013, 'author': 'kamilmielnik', 'body': 'Reference for sanity: 20762b21db654647c13433e6cd3b79fa7a06ba7d passes the CI 100%.', 'created_at': datetime.datetime(2024, 10, 30, 11, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2470180779, 'issue_id': 2482544013, 'author': 'trunk-io[bot]', 'body': '<!-- Trunk Test Analytics -->\n\n\n![Static Badge](https://img.shields.io/badge/16_tests-cb7d3dae-purple) &ensp; ![Static Badge](https://img.shields.io/badge/0-failed-crimson) &ensp; ![Static Badge](https://img.shields.io/badge/0-flaky-red) &ensp; ![Static Badge](https://img.shields.io/badge/0-quarantined-yellow)\n\n\n<sub>\n\n[View Full Report ‚ÜóÔ∏é](https://app.trunk.io/metabase/flaky-tests/pr/47167?repo=metabase/metabase&commitHash=cb7d3dae3388a511e7cf25a4c1ebb3a238deed00&utm_source=gh-comment) ‚ãÖ [Docs](https://docs.trunk.io/flaky-tests/github-pull-request-comments?utm_source=gh-comment)\n\n</sub>', 'created_at': datetime.datetime(2024, 11, 12, 10, 38, 41, tzinfo=datetime.timezone.utc)}]","kamilmielnik (Issue Creator) on (2024-10-14 13:02:15 UTC): Reference for sanity: https://github.com/metabase/metabase/pull/47167/commits/3373c1862e9da488c3ac827fa634a35853b34117 passes the CI 100% ([image](https://github.com/user-attachments/assets/6cb5b381-e62f-4eaf-842a-f4c81b1b74f0))

github-actions[bot] on (2024-10-22 11:06:46 UTC): <!---conventional commit reminder comment ID-->
@metamben You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

kamilmielnik (Issue Creator) on (2024-10-30 11:05:00 UTC): Reference for sanity: 20762b21db654647c13433e6cd3b79fa7a06ba7d passes the CI 100%.

trunk-io[bot] on (2024-11-12 10:38:41 UTC): <!-- Trunk Test Analytics -->


![Static Badge](https://img.shields.io/badge/16_tests-cb7d3dae-purple) &ensp; ![Static Badge](https://img.shields.io/badge/0-failed-crimson) &ensp; ![Static Badge](https://img.shields.io/badge/0-flaky-red) &ensp; ![Static Badge](https://img.shields.io/badge/0-quarantined-yellow)


<sub>

[View Full Report ‚ÜóÔ∏é](https://app.trunk.io/metabase/flaky-tests/pr/47167?repo=metabase/metabase&commitHash=cb7d3dae3388a511e7cf25a4c1ebb3a238deed00&utm_source=gh-comment) ‚ãÖ [Docs](https://docs.trunk.io/flaky-tests/github-pull-request-comments?utm_source=gh-comment)

</sub>

"
2482448075,pull_request,closed,,"ü§ñ backported ""perf: [insights] Use direct conversions in ->millis-from-epoch to avoid clojure.java-time overhead""",#47145,github-automation-metabase,2024-08-23 06:53:57+00:00,"['alexander-yakushev', 'github-automation-metabase']",2024-08-23 08:39:06+00:00,2024-08-23 08:39:05+00:00,https://github.com/metabase/metabase/pull/47164,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2482370606,pull_request,closed,,"ü§ñ backported ""perf: [date-2.parse] Add a fastpath for timestamps that are likely ISO timestamps""","  #47143
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-23 05:56:19+00:00,"['alexander-yakushev', 'github-automation-metabase']",2024-08-23 07:10:12+00:00,2024-08-23 07:10:11+00:00,https://github.com/metabase/metabase/pull/47163,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2482155296,pull_request,closed,,[E2E] Remove the `default-ee` spec,"Closes #47095

### Description

Improvements based on these internal slack threads: https://metaboat.slack.com/archives/C505ZNNH4/p1722611219985539
https://metaboat.slack.com/archives/C505ZNNH4/p1724187422396359

Removes the `default-ee` snapshot in favor of a util that restricts all of a groups permissions. Full reason in threads. The hope is for folks to make better assertions using the helpers utilized in  #46465 to assert that permissions have been set up correctly and that the data under test is in fact sandboxed.

### How to verify

- Remove calls to `blockUserGroupPermissions` and see that the tests fail 

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",sloansparger,2024-08-23 03:16:56+00:00,['sloansparger'],2024-09-23 21:27:57+00:00,2024-09-23 21:27:55+00:00,https://github.com/metabase/metabase/pull/47162,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2482114465,pull_request,closed,,Fix error message in Create API Key modal,"Removes a silly and easy-to-encounter error message from the Create API Key modal

To see the message, focus the ""Select a group"" dropdown and then move the focus somewhere else without selecting an option.

here's the buggy error message:
![image.png](https://graphite-user-uploaded-assets-prod.s3.amazonaws.com/utGnP2ljFMMNOgi82vVn/66d94dec-f407-4e7d-a350-1ecb0af93d64.png)

In this branch the message now reads ""Select a group"". (This repeats the text in the placeholder. This is just a quick/simple solution)",rafpaf,2024-08-23 02:25:30+00:00,['rafpaf'],2024-08-26 16:56:23+00:00,2024-08-26 16:15:19+00:00,https://github.com/metabase/metabase/pull/47161,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2306066920, 'issue_id': 2482114465, 'author': 'rafpaf', 'body': '* **#47161** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47161?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 23, 2, 25, 45, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-08-23 02:25:45 UTC): * **#47161** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47161?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @rafpaf and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2482091629,pull_request,closed,,Add subfolders in metabase/querying,"Epic https://github.com/metabase/metabase/issues/47147

Adds `drills`, `fields`, `filters`, `viz-settings` subfolders. Moves files around, renames subcomponents. The only real code change is `style={{flex: 1}}` from `className={CS.flex1}`. Everything else is untouched. 

The idea is to move `notebook` to `metabase/querying` in a separate PR as well, and I wanted to have more structure.",ranquild,2024-08-23 01:58:52+00:00,['ranquild'],2024-10-08 16:16:37+00:00,2024-08-23 13:39:47+00:00,https://github.com/metabase/metabase/pull/47160,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2306040438, 'issue_id': 2482091629, 'author': 'github-actions[bot]', 'body': '<!---conventional commit reminder comment ID-->\n@ranquild You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.\nHere are all the supported types that will be shown in the changelog:\n- `feat`\n- `fix`\n- `perf`\n\nThese types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.\n\nPlease also make sure to include `sdk` scope, otherwise, the changelog will not include this task.\n\nFor example, these are valid PR titles:\n- `feat(sdk): Add interactive dashboard component`\n- `feat(sdk): Support theming pie chart`\n- `fix(sdk): Fix static dashboard crash`', 'created_at': datetime.datetime(2024, 8, 23, 1, 59, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2306042483, 'issue_id': 2482091629, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 65b3ef01d40696ee81e8fa2a7465116f6890303b...bc5ef3c7ed327c1357c2e47705dcdbc2b86683fe.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/click-actions/Mode/Mode.ts<br>frontend/src/metabase/visualizations/components/settings/ChartSettingTableColumns/ChartSettingTableColumns.tsx |', 'created_at': datetime.datetime(2024, 8, 23, 2, 0, 18, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-23 01:59:23 UTC): <!---conventional commit reminder comment ID-->
@ranquild You have modified embedding SDK code. Please make sure the PR title follows [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) style.
Here are all the supported types that will be shown in the changelog:
- `feat`
- `fix`
- `perf`

These types `docs`, `style`, `refactor`, `test`, `build`, and `ci` are also encouraged for non-changelog related tasks.

Please also make sure to include `sdk` scope, otherwise, the changelog will not include this task.

For example, these are valid PR titles:
- `feat(sdk): Add interactive dashboard component`
- `feat(sdk): Support theming pie chart`
- `fix(sdk): Fix static dashboard crash`

github-actions[bot] on (2024-08-23 02:00:18 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 65b3ef01d40696ee81e8fa2a7465116f6890303b...bc5ef3c7ed327c1357c2e47705dcdbc2b86683fe.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/click-actions/Mode/Mode.ts<br>frontend/src/metabase/visualizations/components/settings/ChartSettingTableColumns/ChartSettingTableColumns.tsx |

"
2482085636,pull_request,closed,,remove static viz import from pie chart option,"Thread https://metaboat.slack.com/archives/C505ZNNH4/p1723203837352799?thread_ts=1723201440.582679&cid=C505ZNNH4

### Description

Importing `truncateText` from the static viz directory caused our bundle size to increase significantly. In this PR we remove that import, and replace it with an import for a similar function in the main app directory. We had to create a similar `truncateText` function from scratch since one didn't already exist.

### How to verify

Create a pie chart where dimension values have long names, or with a long prefix/suffix for the metric in column settings, add to a dashboard on a small dashcard, hover a slice or legend item and confirm truncation still works.

### Demo

<img width=""417"" alt=""Screenshot 2024-08-22 at 6 50 33 PM"" src=""https://github.com/user-attachments/assets/9bc7b39b-3aa7-4378-841d-f722e3ae72af"">

### Checklist

- [ ] Tests have been added/updated to cover changes in this PR

Covered by existing storybook test for truncation.
",EmmadUsmani,2024-08-23 01:52:38+00:00,['EmmadUsmani'],2024-10-08 16:15:32+00:00,2024-09-04 18:49:23+00:00,https://github.com/metabase/metabase/pull/47159,"[('no-backport', 'Do not backport this PR to any branch')]","[{'comment_id': 2306030201, 'issue_id': 2482085636, 'author': 'EmmadUsmani', 'body': '* **#47159** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47159?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 23, 1, 52, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2306042442, 'issue_id': 2482085636, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 9f706d5433030d6aefa97367d380b3fcf9cf5b01...5f53c46cf1dd0ad5f72274e29233f14f4897937c.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/echarts/pie/option.ts<br>frontend/src/metabase/visualizations/lib/text.ts<br>frontend/src/metabase/visualizations/lib/text.unit.spec.ts |', 'created_at': datetime.datetime(2024, 8, 23, 2, 0, 16, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Issue Creator) on (2024-08-23 01:52:53 UTC): * **#47159** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47159?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @EmmadUsmani and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

github-actions[bot] on (2024-08-23 02:00:16 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 9f706d5433030d6aefa97367d380b3fcf9cf5b01...5f53c46cf1dd0ad5f72274e29233f14f4897937c.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/echarts/pie/option.ts<br>frontend/src/metabase/visualizations/lib/text.ts<br>frontend/src/metabase/visualizations/lib/text.unit.spec.ts |

"
2481758103,pull_request,closed,,Question Info + Settings Sidesheets,"Closes https://github.com/metabase/metabase/issues/47132

### Description

Converts the info sidebars for questions, models, and metrics into sidesheets ü•≥ 

No new functionality, just rearranged and glowed up.

. | .
--- | ---
Model Info | ![Screen Shot 2024-09-03 at 3 24 20 PM](https://github.com/user-attachments/assets/d83e281d-c5a2-42d9-af6e-4ec92999549b)
Model History | ![Screen Shot 2024-09-03 at 3 24 26 PM](https://github.com/user-attachments/assets/e5d0b6b1-2fdc-45db-958b-ab6617eb8e5c)
Question Info | ![Screen Shot 2024-09-03 at 3 24 39 PM](https://github.com/user-attachments/assets/74ae5f9d-f7ae-47cf-9275-130d13344a2a)
Question cache settings |  ![Screen Shot 2024-09-03 at 3 24 43 PM](https://github.com/user-attachments/assets/07616bf5-5c9c-4caf-89c9-9b1498cc3f63)






### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",iethree,2024-08-22 21:20:17+00:00,['iethree'],2024-09-09 18:24:51+00:00,2024-09-09 18:24:49+00:00,https://github.com/metabase/metabase/pull/47157,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2305669971, 'issue_id': 2481758103, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 18e669c04665f559e3d98241388ce20b01aeef0d...f3ec6ef27bb4a9e81ca22c79e35c400019e69a53.\n\nNo notifications.', 'created_at': datetime.datetime(2024, 8, 22, 21, 21, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2334802565, 'issue_id': 2481758103, 'author': 'iethree', 'body': '> This looks great. I agree that your z-index approach is simpler; I\'ll carry that over to the dashboard sidesheet.\r\n> \r\n> One small thing, the cache form opener button has a slightly different look in Figma. Worth adding now, or is that ""new functionality"" to be added in a downstream PR?\r\n> \r\n> ![image.png](https://camo.githubusercontent.com/cfad93497ea94280efac9ebbacd06b18bab4a5d042d0f1c57ebc12aefea850a3/68747470733a2f2f67726170686974652d757365722d75706c6f616465642d6173736574732d70726f642e73332e616d617a6f6e6177732e636f6d2f7574476e50326c6a464d4d4e4f6769383276566e2f37363130653764382d336364382d343734612d386632312d3937626564343066383132372e706e67)\r\n\r\ngood catch. I will update in https://github.com/metabase/metabase/pull/47699, which does a lot with caching\r\n\r\nedit: updated here: https://github.com/metabase/metabase/pull/47699/commits/48a66e8e4a4c5bc010dcb5cfeb09ba38401b4770', 'created_at': datetime.datetime(2024, 9, 6, 21, 0, 17, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-22 21:21:39 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 18e669c04665f559e3d98241388ce20b01aeef0d...f3ec6ef27bb4a9e81ca22c79e35c400019e69a53.

No notifications.

iethree (Issue Creator) on (2024-09-06 21:00:17 UTC): good catch. I will update in https://github.com/metabase/metabase/pull/47699, which does a lot with caching

edit: updated here: https://github.com/metabase/metabase/pull/47699/commits/48a66e8e4a4c5bc010dcb5cfeb09ba38401b4770

"
2481743041,pull_request,closed,,add doc alias for generating docs,"Adds `doc` alias for updating docs.

Like `run`, but set to `prod` so that the env var docs cmd picks up defaults for prod, as defaults may differ for some defsettings between dev and prod, e.g., `db-query-timeout-minutes`.",jeff-bruemmer,2024-08-22 21:13:03+00:00,['jeff-bruemmer'],2024-11-19 21:51:13+00:00,2024-11-19 21:07:12+00:00,https://github.com/metabase/metabase/pull/47156,"[('backport', 'Automatically create PR on current release branch on merge')]",[],
2481708612,pull_request,closed,,Strip expression metadata for field expression,Fixes #44940.,metamben,2024-08-22 20:54:38+00:00,['metamben'],2024-08-23 21:30:30+00:00,2024-08-23 21:30:30+00:00,https://github.com/metabase/metabase/pull/47155,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Querying', '')]",[],
2481603689,pull_request,closed,,"[QP, debug] Fix preprocessing diffs in Portal","The Portal diff view wants `[before after]` pairs of the original data,
not the three-part output of `clojure.data/diff`. This fixes the
`qp.debug/debug>` output from the preprocessing middleware to emit
correct diffs.

Also, since the diffs are not useful when the query is converted between
legacy and pMBQL, this also attaches the *converted* input query to the
output query's Clojure metadata, and this converted value is used as the
basis for the diff.

",bshepherdson,2024-08-22 19:56:54+00:00,['bshepherdson'],2024-10-08 16:15:54+00:00,2024-08-30 14:51:24+00:00,https://github.com/metabase/metabase/pull/47154,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Querying', '')]","[{'comment_id': 2305525485, 'issue_id': 2481603689, 'author': 'bshepherdson', 'body': '* **#47154** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47154?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà\n* `master`\n\nThis stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>\n<h2></h2>\n\n Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>\n  <!-- Current dependencies on/for this PR: -->', 'created_at': datetime.datetime(2024, 8, 22, 19, 57, 11, tzinfo=datetime.timezone.utc)}]","bshepherdson (Issue Creator) on (2024-08-22 19:57:11 UTC): * **#47154** <a href=""https://app.graphite.dev/github/pr/metabase/metabase/47154?utm_source=stack-comment-icon"" target=""_blank""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""10px"" height=""10px""/></a> üëà
* `master`

This stack of pull requests is managed by Graphite. <a href=""https://stacking.dev/?utm_source=stack-comment"">Learn more about stacking.</a>
<h2></h2>

 Join @bshepherdson and the rest of your teammates on <a href=""https://graphite.dev?utm-source=stack-comment""><img src=""https://static.graphite.dev/graphite-32x32-black.png"" alt=""Graphite"" width=""11px"" height=""11px""/> <b>Graphite</b></a>
  <!-- Current dependencies on/for this PR: -->

"
2481590226,pull_request,closed,,Fix `mu/fn` and `mu/defn` support for map schemas on key-value args ,"Things like

```clj
(mu/defn my-fn [& {:as options} :- [:map [:type :keyword]]]
  (:type options))
```

now validate input correctly.

Fixes #46864 

Also made a small tweak to the cljfmt config (for `let*`, only used in one file) and fixed some errors with the `./bin/cljfmt-updated.sh` and `kondo-updated.sh` scripts I found when trying them on a different computer",camsaul,2024-08-22 19:48:36+00:00,['camsaul'],2024-08-28 21:19:39+00:00,2024-08-23 23:25:23+00:00,https://github.com/metabase/metabase/pull/47153,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/DevEx', '')]",[],
2481479210,pull_request,closed,,perf: [insights] Use direct conversions in ->millis-from-epoch to avoid clojure.java-time overhead,"https://github.com/dm3/clojure.java-time has a smart and powerful conversion mechanism that computes and traverses a graph of transformations to reach from one datatype to another. But this happens at runtime and brings significant CPU and memory overhead.

This PR replaces` jt/to-millis-from-epoch` with direct method calls in a very hot function. The conversions are straightforward enough to save on the overhead here.

A sidequest here would be to redo clj.java-time to compute the transforms at compile time or improve the path caching. But this is a significant endeavor, so I wouldn't rush to do it if for our purposes fixing a couple hot functions on our side is enough.",alexander-yakushev,2024-08-22 18:39:35+00:00,['alexander-yakushev'],2024-08-23 08:39:32+00:00,2024-08-23 06:53:09+00:00,https://github.com/metabase/metabase/pull/47145,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2306447587, 'issue_id': 2481479210, 'author': 'piranha', 'body': 'It looks like `->millis-from-epoch` could be a protocol üòÅ', 'created_at': datetime.datetime(2024, 8, 23, 7, 15, 3, tzinfo=datetime.timezone.utc)}]","piranha on (2024-08-23 07:15:03 UTC): It looks like `->millis-from-epoch` could be a protocol üòÅ

"
2481467755,pull_request,closed,,"ü§ñ backported ""extending table component features""","  #47030
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-22 18:32:38+00:00,"['npfitz', 'github-automation-metabase']",2024-08-23 14:49:20+00:00,2024-08-23 14:49:18+00:00,https://github.com/metabase/metabase/pull/47144,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2481464093,pull_request,closed,,perf: [date-2.parse] Add a fastpath for timestamps that are likely ISO timestamps,"In a synthetic benchmark I've made for myself (Posgres, a table of soccer matches with 100k rows), rendering a card takes ~1.6 sec on average (as reported by ""How long the query took"" status). The table contains mostly plain values and one column of timestamps (dates). A large chunk of that time is spent parsing Strings into datetimes with `metabase.util.date-2.parse`. That function uses a complicated composite parser that can handle many different timestamp representations. However, my hunch (correct me here if I'm wrong) is that most databases would yield timestamps in a relatively stable format, like Postgres returns an ISO_INSTANT timestamp `""1970-01-01T00:00:00Z""`.

The idea is to check if the timestamp has length that matches ISO_INSTANT format, and if so, try to parse it with the much faster DateTimeFormatter.ISO_INSTANT parser. If parsing fails, fall back to the regular composite parser. If the fast path is successful, we get a tremendous improvement of parsing a single datetime in ~800 ns (compared to ~4.4 us for the full parser). The worst drawback is adding ~1us for failed attempts per timestamp that is exactly 20 characters long but is not an INSTANT.

After the patch, the card rendering time improves twofold: from 1.6 sec to 800 ms.",alexander-yakushev,2024-08-22 18:30:13+00:00,['alexander-yakushev'],2024-08-23 07:10:35+00:00,2024-08-23 05:55:31+00:00,https://github.com/metabase/metabase/pull/47143,"[('backport', 'Automatically create PR on current release branch on merge')]","[{'comment_id': 2305414689, 'issue_id': 2481464093, 'author': 'alexander-yakushev', 'body': ""If there are other common timestamp formats that some databases return dates in, it might make sense to add fastpathes for those too. I defer to others' knowledge on this."", 'created_at': datetime.datetime(2024, 8, 22, 18, 45, 27, tzinfo=datetime.timezone.utc)}]","alexander-yakushev (Issue Creator) on (2024-08-22 18:45:27 UTC): If there are other common timestamp formats that some databases return dates in, it might make sense to add fastpathes for those too. I defer to others' knowledge on this.

"
2481427476,pull_request,closed,,"ü§ñ backported ""Properly detect when Snowflake is using a local key file when expanding connection properties ""","  #46348
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-22 18:09:22+00:00,"['noahmoss', 'github-automation-metabase']",2024-08-23 13:49:01+00:00,2024-08-23 13:48:59+00:00,https://github.com/metabase/metabase/pull/47142,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2481389070,pull_request,closed,,"ü§ñ backported ""recents updates to better support metrics""","  #47032
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-22 17:48:54+00:00,"['escherize', 'github-automation-metabase']",2024-09-06 15:42:18+00:00,2024-09-06 15:42:17+00:00,https://github.com/metabase/metabase/pull/47141,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2481238644,pull_request,closed,,Add Malay Language Support,"

### Description

Adds Malay Language support to metabase, thanks to the hard work of our community translators in [POEditor](https://poeditor.com/projects/view?id=200535) ‚ù§Ô∏è 

",iethree,2024-08-22 16:20:30+00:00,['iethree'],2024-08-30 18:44:24+00:00,2024-08-29 14:17:29+00:00,https://github.com/metabase/metabase/pull/47138,"[('Customization/i18n', ''), ('backport', 'Automatically create PR on current release branch on merge'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2481193190,pull_request,closed,,"ü§ñ backported ""fix pivot table overflow""","  #47102
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-22 15:56:44+00:00,"['alxnddr', 'github-automation-metabase']",2024-08-22 16:34:09+00:00,2024-08-22 16:34:08+00:00,https://github.com/metabase/metabase/pull/47137,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2305126753, 'issue_id': 2481193190, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff a5ca6b92ff8c17be748d1e013ce99f3f3ba4640c...daa5c020e7e796a7ce88d610135f85a094813191.\n\n| Notify | File(s) |\n|-|-|\n| @alxnddr | frontend/src/metabase/visualizations/types/visualization.ts<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.styled.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTableCell.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/stories-data.ts |', 'created_at': datetime.datetime(2024, 8, 22, 16, 1, 41, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-22 16:01:41 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff a5ca6b92ff8c17be748d1e013ce99f3f3ba4640c...daa5c020e7e796a7ce88d610135f85a094813191.

| Notify | File(s) |
|-|-|
| @alxnddr | frontend/src/metabase/visualizations/types/visualization.ts<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.styled.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTable.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/PivotTableCell.tsx<br>frontend/src/metabase/visualizations/visualizations/PivotTable/stories-data.ts |

"
2481009391,pull_request,closed,,"[serdes] a few improvements, instance_analytics cleanup script","I'm a bit worried about `[""name"", ...]` changing to `[""ref"",...]`.

`result_metadata.fk_target_field_id` change is from Alberto's bug
`source_card_id` is from #46356",piranha,2024-08-22 14:58:09+00:00,['piranha'],2024-08-26 10:09:58+00:00,2024-08-24 05:04:01+00:00,https://github.com/metabase/metabase/pull/47136,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2306966951, 'issue_id': 2481009391, 'author': 'piranha', 'body': ""@ranquild oh, thanks, I'll look into that. I wonder though why it's not migrated - this is the export from stats..."", 'created_at': datetime.datetime(2024, 8, 23, 12, 13, 28, tzinfo=datetime.timezone.utc)}]","piranha (Issue Creator) on (2024-08-23 12:13:28 UTC): @ranquild oh, thanks, I'll look into that. I wonder though why it's not migrated - this is the export from stats...

"
2480932006,pull_request,closed,,ci: put failing tests into e2e job summary,"Closes https://github.com/metabase/metabase/issues/47444

### Description

Add job summary to simplify search of the failing tests, so far solution is pretty straightforward, later on we can combine reports from different jobs into one using mochawesome-merge

### How to verify

check the failing job Summary page https://github.com/metabase/metabase/actions/runs/10629389381?pr=47134
### Demo

<img width=""1579"" alt=""image"" src=""https://github.com/user-attachments/assets/0240fb57-ee67-42e7-8e06-eb9f8385e01d"">


",uladzimirdev,2024-08-22 14:25:19+00:00,['uladzimirdev'],2024-08-30 22:28:44+00:00,2024-08-30 22:28:43+00:00,https://github.com/metabase/metabase/pull/47134,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/DevEx', '')]","[{'comment_id': 2310890917, 'issue_id': 2480932006, 'author': 'camsaul', 'body': 'What is this supposed to look like? This is what I see\r\n\r\n![image](https://github.com/user-attachments/assets/d00174c5-a480-4783-a93e-3b9a13c7d659)', 'created_at': datetime.datetime(2024, 8, 26, 19, 11, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2311050531, 'issue_id': 2480932006, 'author': 'uladzimirdev', 'body': ""~~nope, @camsaul. it's not ready for review üòÖ~~\r\n\r\nready for review!"", 'created_at': datetime.datetime(2024, 8, 26, 20, 40, 36, tzinfo=datetime.timezone.utc)}]","camsaul on (2024-08-26 19:11:54 UTC): What is this supposed to look like? This is what I see

![image](https://github.com/user-attachments/assets/d00174c5-a480-4783-a93e-3b9a13c7d659)

uladzimirdev (Issue Creator) on (2024-08-26 20:40:36 UTC): ~~nope, @camsaul. it's not ready for review üòÖ~~

ready for review!

"
2480822300,pull_request,closed,,"ü§ñ backported ""Don't allow viewing a timeline without coll perms""",#46863,github-automation-metabase,2024-08-22 13:39:01+00:00,"['johnswanson', 'github-automation-metabase']",2024-08-22 14:33:24+00:00,2024-08-22 14:33:23+00:00,https://github.com/metabase/metabase/pull/47129,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2480818751,pull_request,closed,,Log alllllll the query analysis queueing things ,"Every now and then it seems like cards aren't getting analyzed on stats. I can't reproduce this locally. I've read all the relevant code through ten times over, and have no ideas.

The idea here is to println debug the way to stability.

Ideally this doesn't get merged, and is just used to spin up a cloud environment.",crisptrutski,2024-08-22 13:37:29+00:00,['crisptrutski'],2024-08-27 16:03:22+00:00,2024-08-27 16:03:22+00:00,https://github.com/metabase/metabase/pull/47128,"[('no-backport', 'Do not backport this PR to any branch'), ('PR-Env', 'See https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458')]","[{'comment_id': 2306923689, 'issue_id': 2480818751, 'author': 'github-actions[bot]', 'body': 'üëã Deploying a preview environment for commit 650c5e2325de6c396498d98012da6e661e6ad45f.\n‚úÖ Preview:\n    https://pr47128.coredev.metabase.com\nüóíÔ∏è [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)\n<!-- Sticky Pull Request Comment -->', 'created_at': datetime.datetime(2024, 8, 23, 11, 46, 42, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-23 11:46:42 UTC): üëã Deploying a preview environment for commit 650c5e2325de6c396498d98012da6e661e6ad45f.
‚úÖ Preview:
    https://pr47128.coredev.metabase.com
üóíÔ∏è [login instructions](https://www.notion.so/metabase/Ephemeral-PR-Environments-c74a3710c87a460dbf4fc0007a001458)
<!-- Sticky Pull Request Comment -->

"
2480791048,pull_request,closed,,"ü§ñ backported ""[serdes] extract result_metadata.fk_target_field_id""",#47122,github-automation-metabase,2024-08-22 13:25:16+00:00,"['piranha', 'github-automation-metabase']",2024-08-22 14:17:58+00:00,2024-08-22 14:17:57+00:00,https://github.com/metabase/metabase/pull/47127,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2480748620,pull_request,closed,,Split and convert ViewFooter elements to TS,"Converts `ViewFooter` to TS. There should be no changes to functionality or test runs in this PR.

The idea for this PRs and others following it will be to allow us to use features from the View component in the SDK in the future.",oisincoveney,2024-08-22 13:07:08+00:00,['oisincoveney'],2024-10-08 16:16:13+00:00,2024-08-28 15:45:04+00:00,https://github.com/metabase/metabase/pull/47126,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]",[],
2480712812,pull_request,closed,,"ü§ñ backported ""Fix n+1 when getting field values for dashboard""","  #47113
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-22 12:50:51+00:00,"['qnkhuat', 'github-automation-metabase']",2024-08-23 03:59:10+00:00,2024-08-23 03:59:09+00:00,https://github.com/metabase/metabase/pull/47125,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2480660371,pull_request,closed,,[serdes] extract result_metadata.fk_target_field_id,"Fixes an issue with `result_metadata.fk_target_field_id` being extracted as a simple integer id (which is incorrect after importing).

Note the `NOTE` - it's there because `instance_analytics` needs to be updated first. So I need this merged, then a new export of instance analytics, and then it can be dropped.",piranha,2024-08-22 12:25:54+00:00,['piranha'],2024-08-22 14:18:34+00:00,2024-08-22 13:24:24+00:00,https://github.com/metabase/metabase/pull/47122,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2480642612,pull_request,closed,,[serdes] keep nulls in export when there are nulls in the db,"this retains previous behavior, so that 1) diffs are smaller and 2) actual nulls will get into target database",piranha,2024-08-22 12:17:05+00:00,['piranha'],2024-08-26 10:09:51+00:00,2024-08-22 13:05:31+00:00,https://github.com/metabase/metabase/pull/47121,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2480537610,pull_request,closed,,"ü§ñ backported ""handle warnings from reselect about broken selectors rules""",#47076,github-automation-metabase,2024-08-22 11:23:31+00:00,"['uladzimirdev', 'github-automation-metabase']",2024-08-22 11:56:29+00:00,2024-08-22 11:56:29+00:00,https://github.com/metabase/metabase/pull/47120,"[('was-backported', 'apply this to PRs that are themselves backports')]","[{'comment_id': 2304428898, 'issue_id': 2480537610, 'author': 'github-actions[bot]', 'body': '<!-- codenotify:CODENOTIFY report -->\n[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 75f66d9d30c1a2b0b3047a22a3a25192022cc255...929c714a00b36295fcc0ae51729a36d611ede4e7.\n\n| Notify | File(s) |\n|-|-|\n| @ranquild | frontend/src/metabase/status/components/FileUploadStatus/FileUploadStatus.tsx |', 'created_at': datetime.datetime(2024, 8, 22, 11, 24, 54, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2024-08-22 11:24:54 UTC): <!-- codenotify:CODENOTIFY report -->
[Codenotify](https://github.com/sourcegraph/codenotify): Notifying subscribers in CODENOTIFY files for diff 75f66d9d30c1a2b0b3047a22a3a25192022cc255...929c714a00b36295fcc0ae51729a36d611ede4e7.

| Notify | File(s) |
|-|-|
| @ranquild | frontend/src/metabase/status/components/FileUploadStatus/FileUploadStatus.tsx |

"
2480529555,pull_request,closed,,Bump macaw to 0.2.6,"There are no behavior changes in this bump, just optimizations.

The updates account for a 50% time and 80% memory decrease in sample queries in the library call itself.

Metabase adds a bunch more overhead on top, so net improvement won't be as drastic.",crisptrutski,2024-08-22 11:19:14+00:00,['crisptrutski'],2024-10-08 16:16:42+00:00,2024-08-22 13:05:49+00:00,https://github.com/metabase/metabase/pull/47119,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Workflows', 'aka BEC')]",[],
2480511969,pull_request,closed,,"ü§ñ backported ""Add support for pipe separator in CSVs""",#47114,github-automation-metabase,2024-08-22 11:09:52+00:00,"['crisptrutski', 'github-automation-metabase']",2024-08-22 12:41:13+00:00,2024-08-22 12:41:12+00:00,https://github.com/metabase/metabase/pull/47117,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2480439695,pull_request,closed,,Update UTM tags in static embed modal links,"Closes https://github.com/metabase/metabase/issues/45422

### Description

Update the upgrade URL for all places that call `getUpgradeUrl` with the following change:
- change `utm_media` to `utm_content`
- change `utm_source` to `source_plan`
- add `utm_source=product`
- add `utm_medium=upsell`
- add `utm_campaign` (only for the link in the static embed flow for simplicity)

Update the UTM tags following our [new format](https://www.notion.so/metabase/Product-UTM-Instrumentation-fc47f3584d5b48bea2e0ad02cda0376d) in the following 4 places in static embed flow:

![Screenshot 2024-08-22 at 5 49 46‚ÄØPM](https://github.com/user-attachments/assets/8bf2fca7-8a77-48a9-81e9-b153bdc7af0c)

#### New link
https://www.metabase.com/product/embedded-analytics?utm_source=product&utm_medium=upsell&utm_campaign=embedding-interactive&utm_content=static-embed-popover&source_plan=oss

#### Old link
https://www.metabase.com/product/embedded-analytics?utm_source=oss&utm_media=static-embed-popover


![Screenshot 2024-08-22 at 5 51 46‚ÄØPM](https://github.com/user-attachments/assets/7201b03b-3533-4afc-a25d-91b908969e0c)

#### New link
https://www.metabase.com/docs/latest/embedding/static-embedding.html?utm_source=product&utm_medium=docs&utm_campaign=embedding-static&utm_content=static-embed-settings-overview&source_plan=oss

#### Old link
https://www.metabase.com/docs/latest/embedding/static-embedding.html?utm_source=oss&utm_media=static-embed-settings-overview

![Screenshot 2024-08-22 at 5 52 34‚ÄØPM](https://github.com/user-attachments/assets/eed613d4-c047-4ec7-bfaf-ba40eb27e170)

#### New link
https://www.metabase.com/docs/latest/embedding/static-embedding.html?utm_source=product&utm_medium=docs&utm_campaign=embedding-static&utm_content=static-embed-settings-look-and-feel&source_plan=oss#customizing-the-appearance-of-static-embeds

#### Old link
https://www.metabase.com/docs/latest/embedding/static-embedding.html?utm_source=oss&utm_media=static-embed-settings-appearance#customizing-the-appearance-of-static-embeds

![Screenshot 2024-08-22 at 5 52 55‚ÄØPM](https://github.com/user-attachments/assets/c26d0bf7-6c77-4f10-a238-85fcbf5c47fe)

#### New link
https://www.metabase.com/upgrade/?utm_source=product&utm_medium=upsell&utm_campaign=embedding-static-font&utm_content=static-embed-settings-look-and-feel&source_plan=oss&utm_users=7

#### Old link
https://www.metabase.com/upgrade/?utm_media=static-embed-settings-appearance&utm_source=oss&utm_users=7


### How to verify


### Checklist

- [ ] Tests have been added/updated to cover changes in this PR
",WiNloSt,2024-08-22 10:35:00+00:00,['WiNloSt'],2024-08-23 12:31:27+00:00,2024-08-23 12:31:26+00:00,https://github.com/metabase/metabase/pull/47116,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Embedding', '')]","[{'comment_id': 2306513821, 'issue_id': 2480439695, 'author': 'WiNloSt', 'body': 'We [decided](https://metaboat.slack.com/archives/C063Q3F1HPF/p1724399768211849?thread_ts=1724077872.663639&cid=C063Q3F1HPF) to backport this to have cleaner data sooner than later', 'created_at': datetime.datetime(2024, 8, 23, 7, 57, 31, tzinfo=datetime.timezone.utc)}]","WiNloSt (Issue Creator) on (2024-08-23 07:57:31 UTC): We [decided](https://metaboat.slack.com/archives/C063Q3F1HPF/p1724399768211849?thread_ts=1724077872.663639&cid=C063Q3F1HPF) to backport this to have cleaner data sooner than later

"
2480215574,pull_request,closed,,Fix iframe resizer not working,"Closes https://github.com/metabase/metabase/issues/47061

### Description

This fixes the issue where iframe-resizer not working on static embedded dashboards

### How to verify

Run the Cypress test `e2e/test/scenarios/embedding/embedding-dashboard.cy.spec.js`'s ""should resize iframe to dashboard content size (metabase#47061)""

### Demo

#### After
![image](https://github.com/user-attachments/assets/ada85e81-34a4-47dc-b36f-a0387e723696)


#### Before
![Screenshot 2024-08-21 at 5 30 25‚ÄØPM](https://github.com/user-attachments/assets/6f079997-8e84-48a6-aa14-39f271d7c608)

### Checklist

- [x] Tests have been added/updated to cover changes in this PR
",WiNloSt,2024-08-22 08:56:01+00:00,['WiNloSt'],2024-08-22 10:49:04+00:00,2024-08-22 10:49:02+00:00,https://github.com/metabase/metabase/pull/47115,"[('no-backport', 'Do not backport this PR to any branch'), ('.Team/Embedding', '')]","[{'comment_id': 2304142814, 'issue_id': 2480215574, 'author': 'WiNloSt', 'body': ""not backporting because this doesn't happen in v50"", 'created_at': datetime.datetime(2024, 8, 22, 8, 59, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2304359664, 'issue_id': 2480215574, 'author': 'WiNloSt', 'body': '> Both code and test results looks good to me. To confirm my understanding, the root cause is the use of `require.ensure` being incompatible with SWC?\r\n\r\nYes, that is correct.', 'created_at': datetime.datetime(2024, 8, 22, 10, 48, 50, tzinfo=datetime.timezone.utc)}]","WiNloSt (Issue Creator) on (2024-08-22 08:59:33 UTC): not backporting because this doesn't happen in v50

WiNloSt (Issue Creator) on (2024-08-22 10:48:50 UTC): Yes, that is correct.

"
2480163337,pull_request,closed,,Add support for pipe separator in CSVs,"### Description

This adds support for a `|` (pipe) separator in CSVs. I saw from DuckDB that this is another popular option. It also improves the error message if we can't determine the separator. Action some grammar linting while I'm here too.",crisptrutski,2024-08-22 08:30:15+00:00,['crisptrutski'],2024-08-22 12:41:41+00:00,2024-08-22 11:09:01+00:00,https://github.com/metabase/metabase/pull/47114,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2480055031,pull_request,closed,,Fix n+1 when getting field values for dashboard,"1b of https://github.com/metabase/metabase/issues/45780

Results: Calling `GET /api/dashboard/:id` on the ""E-commerce insights"" that has 4 filters
**Before**
33 calls
[before.csv](https://github.com/user-attachments/files/16707109/queries12175938864117816972.csv)

**After**
29 calls
[after.csv](https://github.com/user-attachments/files/16707130/queries5625071427222021509.csv)
",qnkhuat,2024-08-22 07:34:05+00:00,['qnkhuat'],2024-08-23 03:59:35+00:00,2024-08-22 12:49:54+00:00,https://github.com/metabase/metabase/pull/47113,"[('backport', 'Automatically create PR on current release branch on merge'), ('.Team/Workflows', 'aka BEC')]",[],
2480034155,pull_request,closed,,"ü§ñ backported ""Fix SchemaItem type""",#47068,github-automation-metabase,2024-08-22 07:22:14+00:00,"['kamilmielnik', 'github-automation-metabase']",2024-08-22 07:54:49+00:00,2024-08-22 07:54:48+00:00,https://github.com/metabase/metabase/pull/47112,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2479863983,pull_request,closed,,[Notification] Fix unable to update multiple channels per type,"Previously, we assumed that alerts could only have one destination for each channel type. This is because we only have 1 slack or 1 email connection.

With HTTP, we can have more than 1 HTTP channel. This PR fixes it so that we can enable multiple HTTP channels for an alert.
[Context](https://metaboat.slack.com/archives/C07318NQ5M2/p1724296690717229)",qnkhuat,2024-08-22 05:20:44+00:00,['qnkhuat'],2024-08-23 03:02:09+00:00,2024-08-23 03:01:58+00:00,https://github.com/metabase/metabase/pull/47111,"[('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2304613886, 'issue_id': 2479863983, 'author': 'crisptrutski', 'body': ""I can't see anything in this PR adding the cyclic dependency that's breaking the build ü§∑"", 'created_at': datetime.datetime(2024, 8, 22, 13, 0, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2304902627, 'issue_id': 2479863983, 'author': 'qnkhuat', 'body': ""yea the build CI is failing upstream too, I'll fix it there"", 'created_at': datetime.datetime(2024, 8, 22, 15, 2, 30, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-08-22 13:00:34 UTC): I can't see anything in this PR adding the cyclic dependency that's breaking the build ü§∑

qnkhuat (Issue Creator) on (2024-08-22 15:02:30 UTC): yea the build CI is failing upstream too, I'll fix it there

"
2479512272,pull_request,closed,,"ü§ñ backported ""Ensure blocked tables downgrade into blocked dbs""","  #47093
  > [!IMPORTANT]
  > Manual conflict resolution is required.
  Checkout the branch and run `./backport.sh` script. Force push your changes after cherry-picking.",github-automation-metabase,2024-08-22 01:23:28+00:00,"['escherize', 'github-automation-metabase']",2024-08-22 03:18:30+00:00,2024-08-22 03:18:29+00:00,https://github.com/metabase/metabase/pull/47110,"[('was-backported', 'apply this to PRs that are themselves backports')]",[],
2479494198,pull_request,closed,,fix auto request review fail,,perivamsi,2024-08-22 01:04:39+00:00,['perivamsi'],2024-08-22 01:07:18+00:00,2024-08-22 01:06:51+00:00,https://github.com/metabase/metabase/pull/47109,"[('no-backport', 'Do not backport this PR to any branch')]",[],
2479467868,pull_request,closed,,Backport `cljfmt` config and run against 50,This is to minimize the diff between `master` and 50 and reduce merge conflicts,camsaul,2024-08-22 00:29:40+00:00,['camsaul'],2024-08-22 15:58:43+00:00,2024-08-22 15:58:12+00:00,https://github.com/metabase/metabase/pull/47108,[],[],
