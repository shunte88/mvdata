id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2272613305,issue,open,,Loading test data for Snowflake (and other DBs) is ridiculously slow,"It takes like 4 minutes to load the test data for Snowflake, surely there must be some way we can speed this up using [`COPY INTO`](https://docs.snowflake.com/en/sql-reference/sql/copy-into-location) or something like that.

```
load-data for snowflake 2024_04_30_e15f5997_60ab_4c7d_8fde_164a001da04c_tz-test-data users took 1.8 s
load-data for snowflake 2024_04_30_e15f5997_60ab_4c7d_8fde_164a001da04c_tz-test-data categories took 2.0 s
load-data for snowflake 2024_04_30_e15f5997_60ab_4c7d_8fde_164a001da04c_tz-test-data venues took 1.6 s
load-data for snowflake 2024_04_30_e15f5997_60ab_4c7d_8fde_164a001da04c_tz-test-data checkins took 7.0 s
load-data for snowflake 2024_04_30_e15f5997_60ab_4c7d_8fde_164a001da04c_tz-test-data products took 1.9 s
load-data for snowflake 2024_04_30_e15f5997_60ab_4c7d_8fde_164a001da04c_tz-test-data people took 38.7 s
load-data for snowflake 2024_04_30_e15f5997_60ab_4c7d_8fde_164a001da04c_tz-test-data reviews took 9.0 s
load-data for snowflake 2024_04_30_e15f5997_60ab_4c7d_8fde_164a001da04c_tz-test-data orders took 2.8 mins
Sync :snowflake Database test-data (reference H2 duration: 1.1 s) took 30.5 s
```",camsaul,2024-04-30 22:55:05+00:00,[],2025-02-04 20:29:50+00:00,,https://github.com/metabase/metabase/issues/42081,"[('Type:Tech Debt', 'or Refactoring'), ('.CI & Tests', ''), ('Database/Snowflake', ''), ('.Backend', ''), ('.DX', 'Developer experience and QoL related.'), ('.Team/DevEx', '')]","[{'comment_id': 2088409941, 'issue_id': 2272613305, 'author': 'paoliniluis', 'body': 'https://community.snowflake.com/s/article/How-to-Load-Terabytes-Into-Snowflake-Speeds-Feeds-and-Techniques', 'created_at': datetime.datetime(2024, 5, 1, 12, 40, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2115921105, 'issue_id': 2272613305, 'author': 'camsaul', 'body': 'This actually applies to a lot of our drivers, we can use `COPY`/`COPY INTO` for most of them to load data in a fast manner. I would love to separate out the code for generating the SQL to load test data from the code that actually loads it. I took a shot at this in https://github.com/metabase/metabase/pull/27903 but it needs more work to get over the line', 'created_at': datetime.datetime(2024, 5, 16, 18, 20, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2115923829, 'issue_id': 2272613305, 'author': 'camsaul', 'body': 'Another idea worth looking into is maybe consolidating all of the test data into a single database and loading everything just once', 'created_at': datetime.datetime(2024, 5, 16, 18, 21, 51, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-05-01 12:40:42 UTC): https://community.snowflake.com/s/article/How-to-Load-Terabytes-Into-Snowflake-Speeds-Feeds-and-Techniques

camsaul (Issue Creator) on (2024-05-16 18:20:15 UTC): This actually applies to a lot of our drivers, we can use `COPY`/`COPY INTO` for most of them to load data in a fast manner. I would love to separate out the code for generating the SQL to load test data from the code that actually loads it. I took a shot at this in https://github.com/metabase/metabase/pull/27903 but it needs more work to get over the line

camsaul (Issue Creator) on (2024-05-16 18:21:51 UTC): Another idea worth looking into is maybe consolidating all of the test data into a single database and loading everything just once

"
2272568287,issue,closed,completed,Ctrl + click on Search results and recent items,,npfitz,2024-04-30 22:12:56+00:00,['npfitz'],2024-05-02 18:40:44+00:00,2024-05-02 18:40:44+00:00,https://github.com/metabase/metabase/issues/42078,[],[],
2272449689,issue,closed,completed,Snowflake temporal extract operators like `hour-of-day` do not respect report timezone,"If the report timezone is `-10:00` we would expect `get-hour` for a `timestamptz` like `""2011-12-31T15:30:54-10:00""` to return `15`, however it currently returns `1` (value for the timestamp when it is normalized to UTC)

Try enabling `metabase.query-processor-test.timezones-test/general-timezone-support-test` for Snowflake to see more examples of things that are broken

```clj
(deftest x-test
  (mt/test-driver :snowflake
    (mt/dataset metabase.query-processor-test.timezones-test/all-dates-leap-year
      (mt/with-temporary-setting-values [report-timezone ""Pacific/Honolulu""]
        (let [query (mt/mbql-query alldates
                      {:expressions {""hour-of-day"" [:temporal-extract $dt :hour-of-day]}
                       :fields      [$dt
                                     [:expression ""hour-of-day""]]
                       :order-by [[:asc $id]]
                       :limit 5})]
          (mt/with-native-query-testing-context query
            (is (= [[""2011-12-31T15:30:54-10:00"" 15]
                    [""2012-01-01T15:30:54-10:00"" 15]
                    [""2012-01-02T15:30:54-10:00"" 15]
                    [""2012-01-03T15:30:54-10:00"" 15]
                    [""2012-01-04T15:30:54-10:00"" 15]]
                   (mt/rows (qp/process-query query))))))))))
```

```                   
Native Query =
SELECT
  ""source"".""dt"" AS ""dt"",
  ""source"".""hour-of-day"" AS ""hour-of-day""
FROM
  (
    SELECT
      ""PUBLIC"".""alldates"".""id"" AS ""id"",
      ""PUBLIC"".""alldates"".""dt"" AS ""dt"",
      DATE_PART(""hour"", ""PUBLIC"".""alldates"".""dt"") AS ""hour-of-day""
    FROM
      ""2024_04_30_e15f5997_60ab_4c7d_8fde_164a001da04c_all-dates-leap-year"".""PUBLIC"".""alldates""
  ) AS ""source""
ORDER BY
  ""source"".""id"" ASC
LIMIT
  5

{:params nil}


expected: [[""2011-12-31T15:30:54-10:00"" 15]
           [""2012-01-01T15:30:54-10:00"" 15]
           [""2012-01-02T15:30:54-10:00"" 15]
           [""2012-01-03T15:30:54-10:00"" 15]
           [""2012-01-04T15:30:54-10:00"" 15]]
  actual: [[""2011-12-31T15:30:54-10:00"" 1]
           [""2012-01-01T15:30:54-10:00"" 1]
           [""2012-01-02T15:30:54-10:00"" 1]
           [""2012-01-03T15:30:54-10:00"" 1]
           [""2012-01-04T15:30:54-10:00"" 1]]                   
```",camsaul,2024-04-30 21:06:03+00:00,['camsaul'],2024-08-28 02:10:45+00:00,2024-05-01 03:24:21+00:00,https://github.com/metabase/metabase/issues/42073,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Processor', ''), ('Misc/Timezones', ''), ('Database/Snowflake', ''), ('.Team/Querying', '')]",[],
2272372568,issue,closed,completed,Admin CSV Table Cleanup UI,"[designs](https://www.figma.com/file/adwVx31Cb5yI5lhW4iYa4v/Let-people-delete-previous-CSV-uploads-and-their-underlying-table?type=design&node-id=1273-8245&mode=design&t=WYFxBUIkLcV4kX5I-0)

- [x] add uploaded table list to upload settings page
- [x] deletion confirmation modal
- [ ] pagination
- [x] single deletion
- [x] multi-deletion
- [ ] deletion progress display
- [ ] deletion toasts
- [ ] handle failure case",iethree,2024-04-30 20:10:42+00:00,['iethree'],2024-08-21 21:21:41+00:00,2024-05-09 15:27:48+00:00,https://github.com/metabase/metabase/issues/42069,"[('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2303034791, 'issue_id': 2272372568, 'author': 'addison-grant', 'body': 'Is there a plan to release this to Open Source?', 'created_at': datetime.datetime(2024, 8, 21, 21, 21, 40, tzinfo=datetime.timezone.utc)}]","addison-grant on (2024-08-21 21:21:40 UTC): Is there a plan to release this to Open Source?

"
2272156538,issue,closed,completed,[FE] dependentMetadata changes,FE changes for https://github.com/metabase/metabase/issues/42056,ranquild,2024-04-30 18:00:15+00:00,['ranquild'],2024-05-01 19:45:42+00:00,2024-05-01 19:45:42+00:00,https://github.com/metabase/metabase/issues/42060,[],[],
2272134471,issue,closed,completed,Dashboard Subscriptions Heading Cards - URI Illegal character in opaque part,"### Describe the bug

If you have a Heading Card on a dashboard such as the following, you encounter URI errors when trying to send a subscription and it's not sent. 
Strange thing is I can reproduce this majority of the time (90%) but there have been times where I don't encounter the issue and the subscription is sent.

<br>

<img width=""249"" alt=""Screenshot 2024-04-30 at 12 18 21 PM"" src=""https://github.com/metabase/metabase/assets/17398657/d9b54497-2178-484c-b5c2-da020d913867"">

<br> 

<img width=""224"" alt=""Screenshot 2024-04-30 at 12 18 35 PM"" src=""https://github.com/metabase/metabase/assets/17398657/dff91c16-8501-4f7c-a799-f2074d6b90da"">


### To Reproduce

1. Create a dashboard with a Heading Card
2. Make sure it has 'http', 'https', or 'www' as part of the name
3. Send subscription


### Expected behavior

Send the Heading text as displayed on the dashboard

### Logs

2024-04-30 12:19:06,397 ERROR middleware.log :: POST /api/pulse/test 500 119.8 ms (40 DB calls) 
{:via
 [{:type java.lang.IllegalArgumentException,
   :message ""Illegal character in opaque part at index 6: https:\\/\\/www\\.ESPN\\.com"",
   :at [java.net.URI create ""URI.java"" 883]}
  {:type java.net.URISyntaxException,
   :message ""Illegal character in opaque part at index 6: https:\\/\\/www\\.ESPN\\.com"",
   :at [java.net.URI$Parser fail ""URI.java"" 2913]}],
 :trace
 [[java.net.URI$Parser fail ""URI.java"" 2913]
  [java.net.URI$Parser checkChars ""URI.java"" 3084]
  [java.net.URI$Parser parse ""URI.java"" 3120]
  [java.net.URI <init> ""URI.java"" 600]
  [java.net.URI create ""URI.java"" 881]
  [java.net.URI resolve ""URI.java"" 1066]
  [metabase.pulse.markdown$resolve_uri invokeStatic ""markdown.clj"" 209]
  [metabase.pulse.markdown$resolve_uri invoke ""markdown.clj"" 200]
  [metabase.pulse.markdown$fn$reify$reify__75162 resolveLink ""markdown.clj"" 403]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer resolveLink ""HtmlRenderer.java"" 599]
  [com.vladsch.flexmark.html.renderer.LinkResolverContext resolveLink ""LinkResolverContext.java"" 66]
  [com.vladsch.flexmark.html.renderer.CoreNodeRenderer render ""CoreNodeRenderer.java"" 583]
  [com.vladsch.flexmark.html.renderer.NodeRenderingHandler render ""NodeRenderingHandler.java"" 16]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer renderNode ""HtmlRenderer.java"" 779]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer renderChildrenNode ""HtmlRenderer.java"" 798]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer renderChildren ""HtmlRenderer.java"" 790]
  [com.vladsch.flexmark.html.renderer.CoreNodeRenderer render ""CoreNodeRenderer.java"" 420]
  [com.vladsch.flexmark.html.renderer.NodeRenderingHandler render ""NodeRenderingHandler.java"" 16]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer renderNode ""HtmlRenderer.java"" 779]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer renderChildrenNode ""HtmlRenderer.java"" 798]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer renderChildren ""HtmlRenderer.java"" 790]
  [com.vladsch.flexmark.html.renderer.CoreNodeRenderer lambda$render$1 ""CoreNodeRenderer.java"" 132]
  [com.vladsch.flexmark.util.html.HtmlAppendableBase tag ""HtmlAppendableBase.java"" 349]
  [com.vladsch.flexmark.util.html.HtmlAppendableBase tagLine ""HtmlAppendableBase.java"" 398]
  [com.vladsch.flexmark.html.renderer.CoreNodeRenderer render ""CoreNodeRenderer.java"" 132]
  [com.vladsch.flexmark.html.renderer.NodeRenderingHandler render ""NodeRenderingHandler.java"" 16]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer renderNode ""HtmlRenderer.java"" 779]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer renderChildrenNode ""HtmlRenderer.java"" 798]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer renderChildren ""HtmlRenderer.java"" 790]
  [com.vladsch.flexmark.html.renderer.CoreNodeRenderer render ""CoreNodeRenderer.java"" 113]
  [com.vladsch.flexmark.html.renderer.NodeRenderingHandler render ""NodeRenderingHandler.java"" 16]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer renderNode ""HtmlRenderer.java"" 761]
  [com.vladsch.flexmark.html.HtmlRenderer$MainNodeRenderer render ""HtmlRenderer.java"" 683]
  [com.vladsch.flexmark.html.HtmlRenderer render ""HtmlRenderer.java"" 213]
  [com.vladsch.flexmark.html.HtmlRenderer render ""HtmlRenderer.java"" 197]
  [com.vladsch.flexmark.html.HtmlRenderer render ""HtmlRenderer.java"" 230]
  [metabase.pulse.markdown$fn__75175 invokeStatic ""markdown.clj"" 427]
  [metabase.pulse.markdown$fn__75175 invoke ""markdown.clj"" 424]
  [clojure.lang.MultiFn invoke ""MultiFn.java"" 234]
  [metabase.email.messages$render_part invokeStatic ""messages.clj"" 447]
  [metabase.email.messages$render_part invoke ""messages.clj"" 440]
  [metabase.email.messages$render_message_body$fn__76388$fn__76389 invoke ""messages.clj"" 497]
  [clojure.core$mapv$fn__8535 invoke ""core.clj"" 6980]
  [clojure.core.protocols$fn__8249 invokeStatic ""protocols.clj"" 168]
  [clojure.core.protocols$fn__8249 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$mapv invokeStatic ""core.clj"" 6971]
  [clojure.core$mapv invoke ""core.clj"" 6971]
  [metabase.email.messages$render_message_body$fn__76388 invoke ""messages.clj"" 497]
  [metabase.email.messages$render_message_body invokeStatic ""messages.clj"" 496]
  [metabase.email.messages$render_message_body invoke ""messages.clj"" 494]
  [metabase.email.messages$render_pulse_email invokeStatic ""messages.clj"" 523]
  [metabase.email.messages$render_pulse_email invoke ""messages.clj"" 520]
  [metabase.pulse$fn__99877 invokeStatic ""pulse.clj"" 442]
  [metabase.pulse$fn__99877 invoke ""pulse.clj"" 431]
  [clojure.lang.MultiFn invoke ""MultiFn.java"" 239]
  [metabase.pulse$parts__GT_notifications$iter__99952__99956$fn__99957$fn__99958 invoke ""pulse.clj"" 513]
  [metabase.pulse$parts__GT_notifications$iter__99952__99956$fn__99957 invoke ""pulse.clj"" 511]
  [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
  [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
  [clojure.lang.RT seq ""RT.java"" 535]
  [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
  [clojure.core$seq__5467 invoke ""core.clj"" 139]
  [metabase.pulse$send_notifications_BANG_ invokeStatic ""pulse.clj"" 566]
  [metabase.pulse$send_notifications_BANG_ invoke ""pulse.clj"" 565]
  [metabase.pulse$send_pulse_BANG_ invokeStatic ""pulse.clj"" 593]
  [metabase.pulse$send_pulse_BANG_ doInvoke ""pulse.clj"" 574]
  [clojure.lang.RestFn invoke ""RestFn.java"" 410]
  [metabase.api.pulse$fn__102148 invokeStatic ""pulse.clj"" 349]
  [metabase.api.pulse$fn__102148 invoke ""pulse.clj"" 331]
  [compojure.core$wrap_response$fn__44656 invoke ""core.clj"" 160]
  [compojure.core$wrap_route_middleware$fn__44640 invoke ""core.clj"" 132]
  [compojure.core$wrap_route_info$fn__44645 invoke ""core.clj"" 139]
  [compojure.core$wrap_route_matches$fn__44649 invoke ""core.clj"" 151]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44649 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44649 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44649 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44649 invoke ""core.clj"" 152]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668 invoke ""core.clj"" 200]
  [metabase.pulse.preview$style_tag_nonce_middleware$fn__100297 invoke ""preview.clj"" 165]
  [metabase.server.middleware.auth$enforce_authentication$fn__94729 invoke ""auth.clj"" 17]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__44696 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668 invoke ""core.clj"" 200]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668 invoke ""core.clj"" 200]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668 invoke ""core.clj"" 200]
  [metabase.api.routes$fn__102755$fn__102756 invoke ""routes.clj"" 65]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668 invoke ""core.clj"" 200]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [metabase.server.routes$fn__102920$fn__102921 doInvoke ""routes.clj"" 72]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__44696 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44649 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44649 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44649 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 199]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668 invoke ""core.clj"" 200]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__44696 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668$f__44669$respond_SINGLEQUOTE___44670 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44700 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668 invoke ""core.clj"" 200]
  [compojure.core$routes$fn__44668$f__44669 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44668 invoke ""core.clj"" 200]
  [metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__99528 invoke ""exceptions.clj"" 108]
  [metabase.server.middleware.exceptions$catch_api_exceptions$fn__99525 invoke ""exceptions.clj"" 96]
  [metabase.server.middleware.log$log_api_call$fn__105236$fn__105237$fn__105238 invoke ""log.clj"" 216]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invokeStatic ""diagnostic.clj"" 18]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invoke ""diagnostic.clj"" 12]
  [metabase.server.middleware.log$log_api_call$fn__105236$fn__105237 invoke ""log.clj"" 208]
  [toucan2.execute$do_with_call_counts invokeStatic ""execute.clj"" 112]
  [toucan2.execute$do_with_call_counts invoke ""execute.clj"" 103]
  [metabase.server.middleware.log$log_api_call$fn__105236 invoke ""log.clj"" 207]
  [metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__110024 invoke ""browser_cookie.clj"" 40]
  [metabase.server.middleware.security$add_security_headers$fn__99484 invoke ""security.clj"" 182]
  [metabase.server.middleware.json$wrap_json_body$fn__46013 invoke ""json.clj"" 67]
  [metabase.server.middleware.offset_paging$handle_paging$fn__85642 invoke ""offset_paging.clj"" 43]
  [metabase.server.middleware.json$wrap_streamed_json_response$fn__46031 invoke ""json.clj"" 103]
  [ring.middleware.keyword_params$wrap_keyword_params$fn__110291 invoke ""keyword_params.clj"" 55]
  [ring.middleware.params$wrap_params$fn__110310 invoke ""params.clj"" 77]
  [metabase.server.middleware.misc$maybe_set_site_url$fn__67240 invoke ""misc.clj"" 61]
  [metabase.server.middleware.session$reset_session_timeout$fn__72663 invoke ""session.clj"" 543]
  [metabase.server.middleware.session$bind_current_user$fn__72629$fn__72630 invoke ""session.clj"" 438]
  [metabase.server.middleware.session$do_with_current_user invokeStatic ""session.clj"" 417]
  [metabase.server.middleware.session$do_with_current_user invoke ""session.clj"" 401]
  [metabase.server.middleware.session$bind_current_user$fn__72629 invoke ""session.clj"" 437]
  [metabase.server.middleware.session$wrap_current_user_info$fn__72612 invoke ""session.clj"" 376]
  [metabase.server.middleware.session$wrap_session_id$fn__72584 invoke ""session.clj"" 255]
  [metabase.server.middleware.auth$wrap_static_api_key$fn__94737 invoke ""auth.clj"" 30]
  [ring.middleware.cookies$wrap_cookies$fn__110211 invoke ""cookies.clj"" 194]
  [metabase.server.middleware.misc$add_content_type$fn__67222 invoke ""misc.clj"" 29]
  [metabase.server.middleware.misc$disable_streaming_buffering$fn__67248 invoke ""misc.clj"" 78]
  [ring.middleware.gzip$wrap_gzip$fn__110253 invoke ""gzip.clj"" 86]
  [metabase.server.middleware.misc$bind_request$fn__67251 invoke ""misc.clj"" 95]
  [metabase.server.middleware.ssl$redirect_to_https_middleware$fn__110040 invoke ""ssl.clj"" 41]
  [metabase.server$async_proxy_handler$fn__67662 invoke ""server.clj"" 78]
  [metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a handle nil -1]
  [org.eclipse.jetty.server.handler.StatisticsHandler handle ""StatisticsHandler.java"" 173]
  [org.eclipse.jetty.server.handler.HandlerWrapper handle ""HandlerWrapper.java"" 122]
  [org.eclipse.jetty.server.Server handle ""Server.java"" 563]
  [org.eclipse.jetty.server.HttpChannel$RequestDispatchable dispatch ""HttpChannel.java"" 1598]
  [org.eclipse.jetty.server.HttpChannel dispatch ""HttpChannel.java"" 753]
  [org.eclipse.jetty.server.HttpChannel handle ""HttpChannel.java"" 501]
  [org.eclipse.jetty.server.HttpConnection onFillable ""HttpConnection.java"" 287]
  [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded ""AbstractConnection.java"" 314]
  [org.eclipse.jetty.io.FillInterest fillable ""FillInterest.java"" 100]
  [org.eclipse.jetty.io.SelectableChannelEndPoint$1 run ""SelectableChannelEndPoint.java"" 53]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy runTask ""AdaptiveExecutionStrategy.java"" 421]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy consumeTask ""AdaptiveExecutionStrategy.java"" 390]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy tryProduce ""AdaptiveExecutionStrategy.java"" 277]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy run ""AdaptiveExecutionStrategy.java"" 199]
  [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run ""ReservedThreadExecutor.java"" 411]
  [org.eclipse.jetty.util.thread.QueuedThreadPool runJob ""QueuedThreadPool.java"" 969]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner doRunJob ""QueuedThreadPool.java"" 1194]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run ""QueuedThreadPool.java"" 1149]
  [java.lang.Thread run ""Thread.java"" 829]],
 :cause ""Illegal character in opaque part at index 6: https:\\/\\/www\\.ESPN\\.com"",
 :message ""Illegal character in opaque part at index 6: https:\\/\\/www\\.ESPN\\.com""}

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""13.5.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""America/Chicago""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mongo"",
      ""bigquery-cloud-sdk"",
      ""mysql"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.3""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-22"",
      ""tag"": ""v1.49.7"",
      ""hash"": ""f0ff786""
    },
    ""settings"": {
      ""report-timezone"": ""UTC""
    }
  }
}
```


### Severity

P3

### Additional context

_No response_",FilmonK,2024-04-30 17:46:43+00:00,[],2025-01-16 18:11:06+00:00,2025-01-10 01:22:34+00:00,https://github.com/metabase/metabase/issues/42057,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Pulses', 'Now called Subscriptions'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2578560645, 'issue_id': 2272134471, 'author': 'tsplude', 'body': 'For posterity,\n\nWe escape special characters in dashboard header cards [here](https://github.com/metabase/metabase/blob/f3e7f3e1c2fbc3320676e4637a36d515daaf5933/src/metabase/notification/payload/execute.clj#L111)\n\nWhich doesn\'t play nicely when the html renderer recognizes a link and tries to put it in an `<a href=...` tag [here](https://github.com/metabase/metabase/blob/f3e7f3e1c2fbc3320676e4637a36d515daaf5933/src/metabase/channel/impl/email.clj#L75)\n\n<img width=""886"" alt=""Image"" src=""https://github.com/user-attachments/assets/e1c935d2-a550-4967-941e-a6dabf4e8153"" />', 'created_at': datetime.datetime(2025, 1, 8, 20, 12, 37, tzinfo=datetime.timezone.utc)}]","tsplude on (2025-01-08 20:12:37 UTC): For posterity,

We escape special characters in dashboard header cards [here](https://github.com/metabase/metabase/blob/f3e7f3e1c2fbc3320676e4637a36d515daaf5933/src/metabase/notification/payload/execute.clj#L111)

Which doesn't play nicely when the html renderer recognizes a link and tries to put it in an `<a href=...` tag [here](https://github.com/metabase/metabase/blob/f3e7f3e1c2fbc3320676e4637a36d515daaf5933/src/metabase/channel/impl/email.clj#L75)

<img width=""886"" alt=""Image"" src=""https://github.com/user-attachments/assets/e1c935d2-a550-4967-941e-a6dabf4e8153"" />

"
2272117384,issue,closed,completed,[BE] dependentMetadata changes,"Currently creating new metrics doesn't always work correctly because of lack of metadata. Let's change `dependentMetadata` to take these cases into account:

### metadata for query - changes to an existing function

```
dependentMetadata(
  query: Query,
  cardId: number | null,
  cardType: CardType
): DependentItem[]
```

If `cardType` is `model` or `metric`, it should
- Add a virtual table for `cardId`
- Add all dependent metadata for an ad-hoc question based on `cardId`

### metadata for creating a new query based on a table/card - new function

```
tableOrCardDependentMetadata(
  metadataProvider: MetadataProvider, 
  tableId: TableId
 ): DependentItem[]
```

When attempting to create a new query based on a table/card, we need to load metadata upfront:
- In all cases, add a virtual table for `tableId`.
- If the card for `tableId` is `metric`, add additional metadata required to be able to call `queryFromTableOrCardMetadata` for `tableId`

FE PoC using these functions https://github.com/metabase/metabase/pull/42063

Please note that we call all these functions recursively. After each call we try to load all new items, and then re-create the metadata object (and query) and call the function again. We do that until we stop getting new items.",ranquild,2024-04-30 17:34:57+00:00,"['ranquild', 'metamben']",2024-05-02 03:35:41+00:00,2024-05-01 19:45:45+00:00,https://github.com/metabase/metabase/issues/42056,[],[],
2272108202,issue,open,,Composed MLv2 metadata providers cannot override a Setting value with `nil`,"Due to the way the composed metadata provider works, we have no way to distinguish `nil` from the Setting not being found entirely

```clj
(defn- object-for-id [f id metadata-providers]
  (some (fn [provider]
          (f provider id))
        metadata-providers))
```",camsaul,2024-04-30 17:29:06+00:00,['camsaul'],2025-02-04 20:27:14+00:00,,https://github.com/metabase/metabase/issues/42055,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/MBQL', ''), ('.Backend', ''), ('.metabase-lib', 'Label for tracking all issues related to the shared CLJC metabase-lib'), ('.Team/Querying', '')]",[],
2272101376,issue,closed,completed,truncated button text in JWT signing modal,"Not sure if this is new or has always been the case but the JWT setup page has a button with truncated text (should say `Generate key` I believe)

[Slack Message](https://metaboat.slack.com/archives/C064EB1UE5P/p1714421387468889?thread_ts=1714421387.468889&cid=C064EB1UE5P)",iethree,2024-04-30 17:25:31+00:00,[],2025-01-23 20:54:38+00:00,2025-01-23 20:54:38+00:00,https://github.com/metabase/metabase/issues/42054,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Administration/Auth/SSO', 'Enterprise SSO like SAML and JWT'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2271964969,issue,closed,completed,"When updating a filter value in chill mode, the order of the columns is messed up","### Describe the bug

When updating a filter value in chill mode, the order of the columns is messed up.

### To Reproduce

1. Go to stats https://stats.metabase.com/question/4859
2. Click on filters on the top bar
3. Click on the filter `Created At is in the previous week, starting 16 weeks ago`
4. Change the value of starting from, from 16 to 17 weeks
5. Click on update filter
6. The order of the columns is not preserved, notice the 2nd column is now different.

Slack thread w/ Loom https://metaboat.slack.com/archives/C01LQQ2UW03/p1714409454229319

blocked by [RFC](https://www.notion.so/metabase/Tech-Remove-field-refs-from-viz-settings-bec453dc75bd40efb54a1ddb83acd536)

> there is viz settings -> cols mismatch as cols's format of the field_ref is `['field', 'created_at']` for some columns and viz settings use `['field', 34]` where 34 is created_at id, the issue can't be addressed in the current state of field_refs, so we expect it to be fixable after RFC gets implemented



### Expected behavior

The order of the columns is preserved

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Stats Built on 2024-04-30 Hash: 389886d
```


### Severity

P2

### Additional context

_No response_",albertoperdomo,2024-04-30 16:22:46+00:00,['ranquild'],2024-07-15 21:00:42+00:00,2024-07-05 19:41:38+00:00,https://github.com/metabase/metabase/issues/42049,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]","[{'comment_id': 2089875992, 'issue_id': 2271964969, 'author': 'zbodi74', 'body': 'This has also been reported by a customer in `v1.49.7`.', 'created_at': datetime.datetime(2024, 5, 2, 8, 18, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2096088700, 'issue_id': 2271964969, 'author': 'albertoperdomo', 'body': 'The order of columns is also messed up jas well when sorting by a specific column.', 'created_at': datetime.datetime(2024, 5, 6, 14, 0, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2096243833, 'issue_id': 2271964969, 'author': 'uladzimirdev', 'body': ""@albertoperdomo you're right, this problem is related to the latest rework to MLv2, I'm trying to understand where we should fix it - FE or BE"", 'created_at': datetime.datetime(2024, 5, 6, 15, 0, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2173245903, 'issue_id': 2271964969, 'author': 'uladzimirdev', 'body': ""To clarify, it's impossible to compare columns atm, to fix this bug we need to rework field_refs management"", 'created_at': datetime.datetime(2024, 6, 17, 12, 17, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2229426552, 'issue_id': 2271964969, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.50.14](https://github.com/metabase/metabase/milestone/254)', 'created_at': datetime.datetime(2024, 7, 15, 21, 0, 41, tzinfo=datetime.timezone.utc)}]","zbodi74 on (2024-05-02 08:18:50 UTC): This has also been reported by a customer in `v1.49.7`.

albertoperdomo (Issue Creator) on (2024-05-06 14:00:37 UTC): The order of columns is also messed up jas well when sorting by a specific column.

uladzimirdev on (2024-05-06 15:00:39 UTC): @albertoperdomo you're right, this problem is related to the latest rework to MLv2, I'm trying to understand where we should fix it - FE or BE

uladzimirdev on (2024-06-17 12:17:37 UTC): To clarify, it's impossible to compare columns atm, to fix this bug we need to rework field_refs management

github-actions[bot] on (2024-07-15 21:00:41 UTC): 🚀 This should also be released by [v0.50.14](https://github.com/metabase/metabase/milestone/254)

"
2271927983,issue,closed,completed,Redshift syncs different databases at once which causes confusion in the Metadata,"### Describe the bug

Relevant thread https://metaboat.slack.com/archives/C04DN5VRQM6/p1714479864467729 but in summary in 49 we updated the sync driver methods to solve [Getting fields in (Redshift) is slow](https://github.com/metabase/metabase/issues/38492#top). 

### To Reproduce

Metabase during table scans is sending out querys like:

```
select c.column_name, c.data_type, c.ordinal_position, c.schema_name, c.table_name
from svv_all_columns as c
         left join (select tc.table_schema, tc.table_name, kc.column_name
                    from information_schema.table_constraints as tc
                             join information_schema.key_column_usage as kc
                                  on tc.constraint_name = kc.constraint_name and tc.table_schema = kc.table_schema and
                                     tc.table_name = kc.table_name
                    where tc.constraint_type = 'PRIMARY KEY') as pk
                   on c.schema_name = pk.table_schema and c.table_name = pk.table_name and
                      c.column_name = pk.column_name
where c.schema_name !~ '^information_schema|catalog_history|pg_' AND c.table_name = 'table'
```

Which gets all the columns for a particular Table for a given Database. The problem we are experiencing is that if you have a Prod Database and Dev Database and each of those DBs have a similar table with a different set of columns then metabase is ending up combining the columns of the two tables which are found in two different schemas together. 

The following shows an images which shows the above query being run (I added the database column) and it fetches columns from different DBs which shouldn't be possible:

<img width=""818"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/2343f039-394d-45ae-b644-88854a4e0ea2"">

To replicate:

1) created 2 connections Data Warehouse Prod Test and Data Warehouse Staging Test
2) using same user as the original connection: ""metabase"" ... So same user with same password is used to create this connection
3) Query the svv_all_columns and get the columns from both databases

Since we changed how the sync works and started using the jdbc we are learning about [redshift parameter groups](https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-parameter-groups.html) (aka cluster parameter groups), and I we think those might be very relevant here to reproduce the issue. So the issue is potentially caused by those two parameters:

datashare_enabled: if this is “on” or “off”
external_database: if this is “on” or “off”

### Expected behavior

Sync is performed only to 1 database

### Logs

_No response_

### Information about your Metabase installation

```JSON
1.49
```


### Severity

Breaks questions which start referencing columns that are not really there

### Additional context

_No response_",Tony-metabase,2024-04-30 16:10:23+00:00,['calherries'],2024-06-03 17:56:09+00:00,2024-05-03 12:20:08+00:00,https://github.com/metabase/metabase/issues/42045,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Redshift', None), ('.Backend', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2090326858, 'issue_id': 2271927983, 'author': 'darksciencebase', 'body': '[slack thread](https://metaboat.slack.com/archives/C04DN5VRQM6/p1714479864467729)', 'created_at': datetime.datetime(2024, 5, 2, 12, 1, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2092907072, 'issue_id': 2271927983, 'author': 'Tony-metabase', 'body': 'This got fixed with the following backport https://github.com/metabase/metabase/pull/41068/files', 'created_at': datetime.datetime(2024, 5, 3, 12, 20, 8, tzinfo=datetime.timezone.utc)}]","darksciencebase on (2024-05-02 12:01:29 UTC): [slack thread](https://metaboat.slack.com/archives/C04DN5VRQM6/p1714479864467729)

Tony-metabase (Issue Creator) on (2024-05-03 12:20:08 UTC): This got fixed with the following backport https://github.com/metabase/metabase/pull/41068/files

"
2271809361,issue,open,,Add example and used functions to Lib.displayInfo for ColumnExtraction,"We are doing some custom matching on the `tag` of a `ColumnExtractionInfo` in a couple of cases:
- to determine the expression functions used for analytics (like [here](https://github.com/metabase/metabase/pull/41774/files#diff-ffb7607d0db4d8e894f3c8c47aab19ca22f80cb0eb7f0698163a6e3bf66290abR18))
- to create examples for the extraction (like [here](https://github.com/metabase/metabase/pull/41578/files/8f8d023f2a3e461d2e091f3b23d2db6a53e83554#diff-abf1cc880c7f231f949166fc74dd592f4a6102f143f67c98146c0d390a089c33R6))

To avoid this from being so fragile, it would be better if we could return the relevant info from `Lib.displayInfo` for the extraction instead.
",romeovs,2024-04-30 15:23:02+00:00,[],2024-04-30 15:23:02+00:00,,https://github.com/metabase/metabase/issues/42039,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2271696398,issue,closed,not_planned,"BE flakes: vertica QP tests flake with ""Execution canceled by operator"" error","There are 3-6 vertica flakes a day in query processor tests recently, and the last 5 failures have all been for the same reason. It's a relatively recent phenomenon according to [this question](https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBGbGFraW5lc3MiLCJkZXNjcmlwdGlvbiI6IkZsYWtleSB0ZXN0cyBmb3IgTWV0YWJhc2UgZnJvbSB3b3JrZmxvdyBqb2JzIHBlciB0ZXN0L2pvYi9ydW4vYnJhbmNoL2NvbW1pdC4gVXBkYXRlZCBkYWlseS4iLCJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoyNiwidHlwZSI6InF1ZXJ5IiwicXVlcnkiOnsiYnJlYWtvdXQiOltbImZpZWxkIiwid29ya2Zsb3dfcnVuX3N0YXJ0ZWRfYXQiLHsiYmFzZS10eXBlIjoidHlwZS9EYXRlVGltZVdpdGhMb2NhbFRaIiwidGVtcG9yYWwtdW5pdCI6ImRheSJ9XV0sImFnZ3JlZ2F0aW9uIjpbWyJjb3VudCJdXSwic291cmNlLXRhYmxlIjoiY2FyZF9fMTQ4MjgiLCJmaWx0ZXIiOlsiYW5kIixbIj0iLFsiZmllbGQiLCJ3b3JrZmxvd19qb2JfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sImJlLXRlc3RzLXZlcnRpY2EtZWUiXSxbInRpbWUtaW50ZXJ2YWwiLFsiZmllbGQiLCJ3b3JrZmxvd19ydW5fc3RhcnRlZF9hdCIseyJiYXNlLXR5cGUiOiJ0eXBlL0RhdGVUaW1lV2l0aExvY2FsVFoifV0sLTQwLCJkYXkiXV19fSwiZGlzcGxheSI6ImxpbmUiLCJwYXJhbWV0ZXJzIjpbXSwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6eyJ0YWJsZS5waXZvdF9jb2x1bW4iOiJyZXBvc2l0b3J5IiwidGFibGUuY2VsbF9jb2x1bW4iOiJ0ZXN0cyJ9LCJvcmlnaW5hbF9jYXJkX2lkIjoxNDgyOH0=):

<img width=""1697"" alt=""image"" src=""https://github.com/metabase/metabase/assets/39073188/8d0639e7-7ede-4472-96d6-cefc5826bc0d"">

They're all happening on different tests.

Example run: https://github.com/metabase/metabase/actions/runs/8894307603/job/24422318435?pr=41882#step:5:1144
`metabase.query-processor-test.breakout-test/binning-with-source-card-with-explicit-joins-test`

Example run: https://github.com/metabase/metabase/actions/runs/8885414686/job/24396737646#step:5:1291
`metabase.query-processor-test.filter-test/contains-case-sensitive-test-2`

Example run:
https://github.com/metabase/metabase/actions/runs/8885258720/job/24396229317#step:5:1214
`metabase.query-processor-test.filter-test/text-equals-nil-empty-string-test-2`

The errors all look very similar to the one below, and all due to this error: ""ERROR: Execution canceled by operator"".
```
ERROR in metabase.query-processor-test.breakout-test/binning-with-source-card-with-explicit-joins-test (execute.clj:709)
Uncaught exception, not in assertion.

                       clojure.lang.ExceptionInfo: Error executing query: [Vertica][VJDBC](3322) ERROR: Execution canceled by operator
    driver: :vertica
    params: nil
       sql: [""-- Metabase""
             ""SELECT""
             ""  (""
             ""    FLOOR(((\""source\"".\""People__longitude\"" - -180.0) / 20.0)) * 20.0""
             ""  ) + -180.0 AS \""People__longitude\"",""
             ""  COUNT(*) AS \""count\""""
             ""FROM""
             ""  (""
             ""    SELECT""
             ""      \""public\"".\""test_data_orders\"".\""id\"" AS \""id\"",""
             ...]
      type: :invalid-query
                   java.sql.SQLTransientException: [Vertica][VJDBC](3322) ERROR: Execution canceled by operator
     SQLState: ""57014""
    errorCode: 3322
com.vertica.support.exceptions.TransientException: [Vertica][VJDBC](3322) ERROR: Execution canceled by operator
        columnNumber: -1
         customState: ""57014""
           diagState: #object[com.vertica.support.exceptions.DiagState 0x7d44cdfc ""DIAG_GENERAL_ERROR""]
    messageKeyOrText: ""[Vertica][VJDBC](3322) ERROR: Execution canceled by operator""
           rowNumber: -1
```

",calherries,2024-04-30 14:48:01+00:00,[],2024-12-13 16:43:36+00:00,2024-12-13 16:43:36+00:00,https://github.com/metabase/metabase/issues/42035,"[('.Backend', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]",[],
2271591674,issue,closed,completed,[dc.js migration] Set missing values to zero setting does not work,"https://metaboat.slack.com/archives/C05NQSWPRMK/p1714485965491349

For time series charts we need to interpolate missing x-axis values given the unit and set y-axis values to zero",alxnddr,2024-04-30 14:14:21+00:00,['alxnddr'],2024-05-03 17:41:59+00:00,2024-05-03 02:12:09+00:00,https://github.com/metabase/metabase/issues/42030,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2271586828,issue,closed,completed,[FE] Use default display for metrics,,ranquild,2024-04-30 14:12:19+00:00,['ranquild'],2024-05-02 03:35:27+00:00,2024-04-30 14:58:29+00:00,https://github.com/metabase/metabase/issues/42028,[],[],
2271538047,issue,closed,not_planned,BE flake: metabase.driver.bigquery-cloud-sdk-test/query-drive-external-tables,"This is the 2nd most frequent failing flake in the last 90 days for bigquery: 8 times. ([source](https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBmbGFrZXMgYnkgc3VpdGUgbmFtZSBhbmQgdGVzdCBuYW1lIChub3QgUVApIiwiZGVzY3JpcHRpb24iOiJodHRwczovL3N0YXRzLm1ldGFiYXNlLmNvbS9tb2RlbC8xNDgyOC10ZXN0LWZsYWtpbmVzcyIsImRhdGFzZXRfcXVlcnkiOnsiZGF0YWJhc2UiOjI2LCJ0eXBlIjoicXVlcnkiLCJxdWVyeSI6eyJhZ2dyZWdhdGlvbiI6W1siY291bnQiXSxbIm1heCIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl91cmwiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dXSxbIm1heCIsWyJmaWVsZCIsIndvcmtmbG93X3J1bl9zdGFydGVkX2F0Iix7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWVXaXRoTG9jYWxUWiIsInRlbXBvcmFsLXVuaXQiOiJtaW51dGUifV1dXSwiYnJlYWtvdXQiOltbImZpZWxkIiwic3VpdGVfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sWyJmaWVsZCIsInRlc3RfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sWyJmaWVsZCIsIndvcmtmbG93X3J1bl9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwid29ya2Zsb3dfam9iX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dXSwib3JkZXItYnkiOltbImRlc2MiLFsiYWdncmVnYXRpb24iLDBdXV0sInNvdXJjZS10YWJsZSI6ImNhcmRfXzE0ODI4IiwiZmlsdGVyIjpbImFuZCIsWyJ0aW1lLWludGVydmFsIixbImZpZWxkIiwid29ya2Zsb3dfcnVuX3N0YXJ0ZWRfYXQiLHsiYmFzZS10eXBlIjoidHlwZS9EYXRlVGltZVdpdGhMb2NhbFRaIn1dLC05MCwiZGF5Il0sWyJkb2VzLW5vdC1jb250YWluIixbImZpZWxkIiwic3VpdGVfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sInF1ZXJ5LXByb2Nlc3NvciIseyJjYXNlLXNlbnNpdGl2ZSI6ZmFsc2V9XSxbImNvbnRhaW5zIixbImZpZWxkIiwid29ya2Zsb3dfam9iX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJiZS10ZXN0cy0iLHsiY2FzZS1zZW5zaXRpdmUiOmZhbHNlfV0sWyI9IixbImZpZWxkIiwid29ya2Zsb3dfam9iX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJiZS10ZXN0cy1iaWdxdWVyeS1jbG91ZC1zZGstZWUiXV19fSwiZGlzcGxheSI6InRhYmxlIiwiZGlzcGxheUlzTG9ja2VkIjp0cnVlLCJwYXJhbWV0ZXJzIjpbXSwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6eyJ0YWJsZS5waXZvdF9jb2x1bW4iOiJzdWl0ZV9uYW1lIiwidGFibGUuY2VsbF9jb2x1bW4iOiJjb3VudCIsInRhYmxlLnBpdm90IjpmYWxzZSwiY29sdW1uX3NldHRpbmdzIjp7IltcIm5hbWVcIixcImNvdW50XCJdIjp7ImNvbHVtbl90aXRsZSI6IkNvdW50ICg3ZCkifSwiW1wibmFtZVwiLFwibWF4XCJdIjp7ImNvbHVtbl90aXRsZSI6Ikxhc3QgZmFpbGVkIHJ1biJ9LCJbXCJuYW1lXCIsXCJtYXhfMlwiXSI6eyJjb2x1bW5fdGl0bGUiOiJMYXN0IGZhaWxlZCBkYXRlIiwiZGF0ZV9zdHlsZSI6Ik1NTU0gRCwgWVlZWSIsInRpbWVfZW5hYmxlZCI6bnVsbH19fSwib3JpZ2luYWxfY2FyZF9pZCI6MTUyMTJ9)) That's once every 12 days

Example run: https://github.com/metabase/metabase/actions/runs/8894162696/job/24421872003?pr=41974",calherries,2024-04-30 13:51:20+00:00,[],2024-12-13 16:45:37+00:00,2024-12-13 16:45:37+00:00,https://github.com/metabase/metabase/issues/42027,"[('flaky-test-fix', '')]",[],
2270589289,issue,open,,JSON unfolding [Bigquery],"**Is your feature request related to a problem? Please describe.**
As MySQL and PostgresSQL has, I would like to use JSON unfolding on Bigquery

**Describe the solution you'd like**
Using JSON unfolding on Bigquery

**How important is this feature to you?**
I wouls glad to have this feature to allow stakeholders to Query Build JSON structures from UI

**Additional context**
As we can't use Bigquery nested records on Query Builder we are transforming nested records to JSON to be friendly accessed

Thanks in advance!
",ArnauKokoro,2024-04-30 06:12:30+00:00,[],2025-02-04 20:30:55+00:00,,https://github.com/metabase/metabase/issues/42012,"[('Administration/Metadata & Sync', ''), ('Type:New Feature', ''), ('Database/BigQuery', ''), ('.Completeness', '')]","[{'comment_id': 2582485302, 'issue_id': 2270589289, 'author': 'danharper83', 'body': 'Also looking for this, is this a limitation of Metabase or BigQuery?', 'created_at': datetime.datetime(2025, 1, 10, 11, 27, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582853431, 'issue_id': 2270589289, 'author': 'paoliniluis', 'body': '@danharper83 Metabase for now, we need to teach Metabase how to understand fields with JSON and build queries based on this', 'created_at': datetime.datetime(2025, 1, 10, 14, 36, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2589598554, 'issue_id': 2270589289, 'author': 'danharper83', 'body': '@paoliniluis I\'ve looked further into the database I have been given and the BigQuery field type is called ""RECORD"" \n\nI guess this is some kind of native big query field type?', 'created_at': datetime.datetime(2025, 1, 14, 10, 52, 26, tzinfo=datetime.timezone.utc)}]","danharper83 on (2025-01-10 11:27:09 UTC): Also looking for this, is this a limitation of Metabase or BigQuery?

paoliniluis on (2025-01-10 14:36:43 UTC): @danharper83 Metabase for now, we need to teach Metabase how to understand fields with JSON and build queries based on this

danharper83 on (2025-01-14 10:52:26 UTC): @paoliniluis I've looked further into the database I have been given and the BigQuery field type is called ""RECORD"" 

I guess this is some kind of native big query field type?

"
2270311158,issue,closed,not_planned,Unable to connect to MongoDB,"### Describe the bug

Trying to connect to MongoDB in `master` branch but times out.

Tried local MongoDB and cloud-hosted Atlas MongoDB

### To Reproduce

1. Run [MongoDB](https://hub.docker.com/layers/metabase/qa-databases/mongo-sample-latest/images/sha256-75947bc7287fd54fbf51237ec72e581b7149f97ce6a57fcaec604f033b145895?context=explore)
2. Try to connect to MongoDB
3. Connection fails with timeout error message

### Expected behavior

- expect to connect to MongoDB

### Logs

```
[e6c98a3f-81d6-44b2-8123-b1c9def8cd7b] 2024-04-29T21:19:25-04:00 WARN metabase.api.common Unexpected parameters at [:post ""/api/database""]: [:is_sample :refingerprint]
Please add them to the schema or remove them from the API client
[e6c98a3f-81d6-44b2-8123-b1c9def8cd7b] 2024-04-29T21:19:35-04:00 ERROR metabase.driver.util Failed to connect to Database,java.util.concurrent.TimeoutException: Timed out after 10.0 s,	at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:287),	at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:279),	at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:294),	at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:290),	at metabase.driver.util$can_connect_with_details_QMARK_.invokeStatic(util.clj:145),	at metabase.driver.util$can_connect_with_details_QMARK_.doInvoke(util.clj:134),	at clojure.lang.RestFn.invoke(RestFn.java:442),	at metabase.api.database$test_database_connection.invokeStatic(database.clj:724),	at metabase.api.database$test_database_connection.doInvoke(database.clj:714),	at clojure.lang.RestFn.invoke(RestFn.java:464),	at metabase.api.database$fn__122195$_AMPERSAND_f__122196.invoke(database.clj:772),	at metabase.api.database$fn__122195$fn__122203.invoke(database.clj:758),	at metabase.api.database$fn__122218.invokeStatic(database.clj:799),	at metabase.api.database$fn__122218.invoke(database.clj:782),	at compojure.core$wrap_response$fn__12079.invoke(core.clj:160),	at compojure.core$wrap_route_middleware$fn__12063.invoke(core.clj:132),	at compojure.core$wrap_route_info$fn__12068.invoke(core.clj:139),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:151),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:152),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at metabase.server.middleware.auth$enforce_authentication$fn__111191.invoke(auth.clj:18),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at compojure.core$make_context$handler__12159.invoke(core.clj:290),	at compojure.core$make_context$fn__12163.invoke(core.clj:300),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at metabase.api.routes$fn__132772$fn__132775.invoke(routes.clj:73),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at metabase.server.routes$fn__133064$fn__133065.doInvoke(routes.clj:73),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at compojure.core$make_context$handler__12159.invoke(core.clj:290),	at compojure.core$make_context$fn__12163.invoke(core.clj:300),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at metabase.server.routes$fn__133047$fn__133049.invoke(routes.clj:47),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__111411.invoke(exceptions.clj:107),	at metabase.server.middleware.exceptions$catch_api_exceptions$fn__111408.invoke(exceptions.clj:96),	at metabase.server.middleware.log$log_api_call$fn__111635$fn__111636$fn__111637.invoke(log.clj:222),	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:18),	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12),	at metabase.server.middleware.log$log_api_call$fn__111635$fn__111636.invoke(log.clj:213),	at toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112),	at toucan2.execute$do_with_call_counts.invoke(execute.clj:103),	at metabase.server.middleware.log$log_api_call$fn__111635.invoke(log.clj:212),	at metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__111236.invoke(browser_cookie.clj:40),	at metabase.server.middleware.security$add_security_headers$fn__111359.invoke(security.clj:177),	at ring.middleware.json$wrap_json_body$fn__133359.invoke(json.clj:64),	at metabase.server.middleware.offset_paging$handle_paging$fn__111668.invoke(offset_paging.clj:43),	at metabase.server.middleware.json$wrap_streamed_json_response$fn__71092.invoke(json.clj:83),	at ring.middleware.keyword_params$wrap_keyword_params$fn__133456.invoke(keyword_params.clj:55),	at ring.middleware.params$wrap_params$fn__133483.invoke(params.clj:77),	at metabase.server.middleware.misc$maybe_set_site_url$fn__81207.invoke(misc.clj:60),	at metabase.server.middleware.session$reset_session_timeout$fn__91911.invoke(session.clj:545),	at metabase.server.middleware.session$bind_current_user$fn__91869$fn__91870.invoke(session.clj:440),	at metabase.server.middleware.session$do_with_current_user.invokeStatic(session.clj:419),	at metabase.server.middleware.session$do_with_current_user.invoke(session.clj:402),	at metabase.server.middleware.session$bind_current_user$fn__91869.invoke(session.clj:439),	at metabase.server.middleware.session$wrap_current_user_info$fn__91846.invoke(session.clj:377),	at metabase.server.middleware.session$wrap_session_id$fn__91818.invoke(session.clj:256),	at metabase.server.middleware.auth$wrap_static_api_key$fn__111199.invoke(auth.clj:32),	at ring.middleware.cookies$wrap_cookies$fn__133271.invoke(cookies.clj:200),	at metabase.server.middleware.misc$add_content_type$fn__81189.invoke(misc.clj:28),	at metabase.server.middleware.misc$disable_streaming_buffering$fn__81215.invoke(misc.clj:77),	at ring.middleware.gzip$wrap_gzip$fn__133321.invoke(gzip.clj:86),	at metabase.server.middleware.misc$bind_request$fn__81218.invoke(misc.clj:94),	at metabase.server.middleware.ssl$redirect_to_https_middleware$fn__111693.invoke(ssl.clj:41),	at metabase.server$async_proxy_handler$fn__72106.invoke(server.clj:77),	at metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source),	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173),	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122),	at org.eclipse.jetty.server.Server.handle(Server.java:563),	at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598),	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753),	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501),	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287),	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314),	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100),	at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199),	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411),	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969),	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194),	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149),	at java.base/java.lang.Thread.run(Thread.java:829)
[e6c98a3f-81d6-44b2-8123-b1c9def8cd7b] 2024-04-29T21:19:45-04:00 ERROR metabase.driver.util Failed to connect to Database,java.util.concurrent.TimeoutException: Timed out after 10.0 s,	at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:287),	at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:279),	at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:294),	at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:290),	at metabase.driver.util$can_connect_with_details_QMARK_.invokeStatic(util.clj:145),	at metabase.driver.util$can_connect_with_details_QMARK_.doInvoke(util.clj:134),	at clojure.lang.RestFn.invoke(RestFn.java:442),	at metabase.api.database$test_database_connection.invokeStatic(database.clj:724),	at metabase.api.database$test_database_connection.doInvoke(database.clj:714),	at clojure.lang.RestFn.invoke(RestFn.java:425),	at metabase.api.database$fn__122195$_AMPERSAND_f__122196.invoke(database.clj:778),	at metabase.api.database$fn__122195$fn__122203.invoke(database.clj:758),	at metabase.api.database$fn__122218.invokeStatic(database.clj:799),	at metabase.api.database$fn__122218.invoke(database.clj:782),	at compojure.core$wrap_response$fn__12079.invoke(core.clj:160),	at compojure.core$wrap_route_middleware$fn__12063.invoke(core.clj:132),	at compojure.core$wrap_route_info$fn__12068.invoke(core.clj:139),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:151),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:152),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at metabase.server.middleware.auth$enforce_authentication$fn__111191.invoke(auth.clj:18),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at compojure.core$make_context$handler__12159.invoke(core.clj:290),	at compojure.core$make_context$fn__12163.invoke(core.clj:300),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at metabase.api.routes$fn__132772$fn__132775.invoke(routes.clj:73),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at metabase.server.routes$fn__133064$fn__133065.doInvoke(routes.clj:73),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at compojure.core$make_context$handler__12159.invoke(core.clj:290),	at compojure.core$make_context$fn__12163.invoke(core.clj:300),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at metabase.server.routes$fn__133047$fn__133049.invoke(routes.clj:47),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__111411.invoke(exceptions.clj:107),	at metabase.server.middleware.exceptions$catch_api_exceptions$fn__111408.invoke(exceptions.clj:96),	at metabase.server.middleware.log$log_api_call$fn__111635$fn__111636$fn__111637.invoke(log.clj:222),	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:18),	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12),	at metabase.server.middleware.log$log_api_call$fn__111635$fn__111636.invoke(log.clj:213),	at toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112),	at toucan2.execute$do_with_call_counts.invoke(execute.clj:103),	at metabase.server.middleware.log$log_api_call$fn__111635.invoke(log.clj:212),	at metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__111236.invoke(browser_cookie.clj:40),	at metabase.server.middleware.security$add_security_headers$fn__111359.invoke(security.clj:177),	at ring.middleware.json$wrap_json_body$fn__133359.invoke(json.clj:64),	at metabase.server.middleware.offset_paging$handle_paging$fn__111668.invoke(offset_paging.clj:43),	at metabase.server.middleware.json$wrap_streamed_json_response$fn__71092.invoke(json.clj:83),	at ring.middleware.keyword_params$wrap_keyword_params$fn__133456.invoke(keyword_params.clj:55),	at ring.middleware.params$wrap_params$fn__133483.invoke(params.clj:77),	at metabase.server.middleware.misc$maybe_set_site_url$fn__81207.invoke(misc.clj:60),	at metabase.server.middleware.session$reset_session_timeout$fn__91911.invoke(session.clj:545),	at metabase.server.middleware.session$bind_current_user$fn__91869$fn__91870.invoke(session.clj:440),	at metabase.server.middleware.session$do_with_current_user.invokeStatic(session.clj:419),	at metabase.server.middleware.session$do_with_current_user.invoke(session.clj:402),	at metabase.server.middleware.session$bind_current_user$fn__91869.invoke(session.clj:439),	at metabase.server.middleware.session$wrap_current_user_info$fn__91846.invoke(session.clj:377),	at metabase.server.middleware.session$wrap_session_id$fn__91818.invoke(session.clj:256),	at metabase.server.middleware.auth$wrap_static_api_key$fn__111199.invoke(auth.clj:32),	at ring.middleware.cookies$wrap_cookies$fn__133271.invoke(cookies.clj:200),	at metabase.server.middleware.misc$add_content_type$fn__81189.invoke(misc.clj:28),	at metabase.server.middleware.misc$disable_streaming_buffering$fn__81215.invoke(misc.clj:77),	at ring.middleware.gzip$wrap_gzip$fn__133321.invoke(gzip.clj:86),	at metabase.server.middleware.misc$bind_request$fn__81218.invoke(misc.clj:94),	at metabase.server.middleware.ssl$redirect_to_https_middleware$fn__111693.invoke(ssl.clj:41),	at metabase.server$async_proxy_handler$fn__72106.invoke(server.clj:77),	at metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source),	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173),	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122),	at org.eclipse.jetty.server.Server.handle(Server.java:563),	at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598),	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753),	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501),	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287),	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314),	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100),	at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199),	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411),	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969),	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194),	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149),	at java.base/java.lang.Thread.run(Thread.java:829)
[e6c98a3f-81d6-44b2-8123-b1c9def8cd7b] 2024-04-29T21:19:45-04:00 ERROR metabase.api.database Cannot connect to Database,clojure.lang.ExceptionInfo: Timed out after 10.0 s {:message ""Timed out after 10.0 s""},	at metabase.driver.util$can_connect_with_details_QMARK_.invokeStatic(util.clj:163),	at metabase.driver.util$can_connect_with_details_QMARK_.doInvoke(util.clj:134),	at clojure.lang.RestFn.invoke(RestFn.java:442),	at metabase.api.database$test_database_connection.invokeStatic(database.clj:724),	at metabase.api.database$test_database_connection.doInvoke(database.clj:714),	at clojure.lang.RestFn.invoke(RestFn.java:425),	at metabase.api.database$fn__122195$_AMPERSAND_f__122196.invoke(database.clj:778),	at metabase.api.database$fn__122195$fn__122203.invoke(database.clj:758),	at metabase.api.database$fn__122218.invokeStatic(database.clj:799),	at metabase.api.database$fn__122218.invoke(database.clj:782),	at compojure.core$wrap_response$fn__12079.invoke(core.clj:160),	at compojure.core$wrap_route_middleware$fn__12063.invoke(core.clj:132),	at compojure.core$wrap_route_info$fn__12068.invoke(core.clj:139),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:151),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:152),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at metabase.server.middleware.auth$enforce_authentication$fn__111191.invoke(auth.clj:18),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at compojure.core$make_context$handler__12159.invoke(core.clj:290),	at compojure.core$make_context$fn__12163.invoke(core.clj:300),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$make_context$fn__12163.invoke(core.clj:301),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at clojure.lang.Var.invoke(Var.java:393),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at metabase.api.routes$fn__132772$fn__132775.invoke(routes.clj:73),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at clojure.lang.AFn.applyToHelper(AFn.java:160),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at metabase.server.routes$fn__133064$fn__133065.doInvoke(routes.clj:73),	at clojure.lang.RestFn.invoke(RestFn.java:436),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at compojure.core$make_context$handler__12159.invoke(core.clj:290),	at compojure.core$make_context$fn__12163.invoke(core.clj:300),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at compojure.core$wrap_route_matches$fn__12072.invoke(core.clj:153),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091$f__12092$respond_SINGLEQUOTE___12093.invoke(core.clj:197),	at metabase.server.routes$fn__133047$fn__133049.invoke(routes.clj:47),	at compojure.core$routes$fn__12091$f__12092.invoke(core.clj:198),	at compojure.core$routes$fn__12091.invoke(core.clj:200),	at metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__111411.invoke(exceptions.clj:107),	at metabase.server.middleware.exceptions$catch_api_exceptions$fn__111408.invoke(exceptions.clj:96),	at metabase.server.middleware.log$log_api_call$fn__111635$fn__111636$fn__111637.invoke(log.clj:222),	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:18),	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12),	at metabase.server.middleware.log$log_api_call$fn__111635$fn__111636.invoke(log.clj:213),	at toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112),	at toucan2.execute$do_with_call_counts.invoke(execute.clj:103),	at metabase.server.middleware.log$log_api_call$fn__111635.invoke(log.clj:212),	at metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__111236.invoke(browser_cookie.clj:40),	at metabase.server.middleware.security$add_security_headers$fn__111359.invoke(security.clj:177),	at ring.middleware.json$wrap_json_body$fn__133359.invoke(json.clj:64),	at metabase.server.middleware.offset_paging$handle_paging$fn__111668.invoke(offset_paging.clj:43),	at metabase.server.middleware.json$wrap_streamed_json_response$fn__71092.invoke(json.clj:83),	at ring.middleware.keyword_params$wrap_keyword_params$fn__133456.invoke(keyword_params.clj:55),	at ring.middleware.params$wrap_params$fn__133483.invoke(params.clj:77),	at metabase.server.middleware.misc$maybe_set_site_url$fn__81207.invoke(misc.clj:60),	at metabase.server.middleware.session$reset_session_timeout$fn__91911.invoke(session.clj:545),	at metabase.server.middleware.session$bind_current_user$fn__91869$fn__91870.invoke(session.clj:440),	at metabase.server.middleware.session$do_with_current_user.invokeStatic(session.clj:419),	at metabase.server.middleware.session$do_with_current_user.invoke(session.clj:402),	at metabase.server.middleware.session$bind_current_user$fn__91869.invoke(session.clj:439),	at metabase.server.middleware.session$wrap_current_user_info$fn__91846.invoke(session.clj:377),	at metabase.server.middleware.session$wrap_session_id$fn__91818.invoke(session.clj:256),	at metabase.server.middleware.auth$wrap_static_api_key$fn__111199.invoke(auth.clj:32),	at ring.middleware.cookies$wrap_cookies$fn__133271.invoke(cookies.clj:200),	at metabase.server.middleware.misc$add_content_type$fn__81189.invoke(misc.clj:28),	at metabase.server.middleware.misc$disable_streaming_buffering$fn__81215.invoke(misc.clj:77),	at ring.middleware.gzip$wrap_gzip$fn__133321.invoke(gzip.clj:86),	at metabase.server.middleware.misc$bind_request$fn__81218.invoke(misc.clj:94),	at metabase.server.middleware.ssl$redirect_to_https_middleware$fn__111693.invoke(ssl.clj:41),	at metabase.server$async_proxy_handler$fn__72106.invoke(server.clj:77),	at metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source),	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173),	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122),	at org.eclipse.jetty.server.Server.handle(Server.java:563),	at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598),	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753),	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501),	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287),	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314),	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100),	at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277),	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199),	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411),	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969),	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194),	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149),	at java.base/java.lang.Thread.run(Thread.java:829),Caused by: java.util.concurrent.TimeoutException: Timed out after 10.0 s,	at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:287),	at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:279),	at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:294),	at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:290),	at metabase.driver.util$can_connect_with_details_QMARK_.invokeStatic(util.clj:145),	... 181 more
[e6c98a3f-81d6-44b2-8123-b1c9def8cd7b] 2024-04-29T21:19:45-04:00 DEBUG metabase.server.middleware.log POST /api/database 400 20.1 s (0 DB calls) {:metabase-user-id 1} 
{:message ""Timed out after 10.0 s""}

```

### Information about your Metabase installation

```JSON
- Broken in `master` as of `256835b0c0773509bce880831273a07ecde694fd`
- works in v1.49.7
```


### Severity

P1: Master regression of common functionality

### Additional context

_No response_",likeshumidity,2024-04-30 01:25:01+00:00,[],2024-04-30 18:16:10+00:00,2024-04-30 18:16:09+00:00,https://github.com/metabase/metabase/issues/42011,"[('Type:Bug', 'Product defects'), ('Database/Mongo', None), ('.Needs Triage', ''), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature')]","[{'comment_id': 2086386805, 'issue_id': 2270311158, 'author': 'lbrdnk', 'body': 'Closing as per [the discussion on slack](https://metaboat.slack.com/archives/C05NXACAG1G/p1714440313756029).', 'created_at': datetime.datetime(2024, 4, 30, 18, 16, 10, tzinfo=datetime.timezone.utc)}]","lbrdnk on (2024-04-30 18:16:10 UTC): Closing as per [the discussion on slack](https://metaboat.slack.com/archives/C05NXACAG1G/p1714440313756029).

"
2270293242,issue,closed,completed,Unable to filter on MongoDB ObjectId type fields if configured as Entity Key,"### Describe the bug

MongoDB ObjectId type fields set as Entity Key do nothing when selected for filtering in the notebook editor.

Similar to https://github.com/metabase/metabase/issues/38288 but happening in GUI questions as well.

Clicking here:
![image](https://github.com/metabase/metabase/assets/8808703/51faf884-f3d5-47d5-9d94-f63c11646555)

Does nothing:
![image](https://github.com/metabase/metabase/assets/8808703/d3236d59-e240-42e6-bddb-e3b0a04f79cd)


### To Reproduce

1. Add [MongoDB Sample Database](https://hub.docker.com/layers/metabase/qa-databases/mongo-sample-5/images/sha256-0d0d0199277d88a4f10de5f234e5101db62378381736e476979da4a8a69eb54b?context=explore) as data source
2. New > Question > Raw Data > `MongoDB Sample Database from qa-databases` > Accounts
3. Click Add filters or narrow your answer
4. Click the first ID in the list (see note below)
5. Nothing happens (this is the bug)

If ObjectId `_id` field set as `No semantic type` or `Category` instead of `Entity Key`, the filter works.

NOTE: There is another ID in the list, but it is a different data type. The one that does not work is `_id` which is `type/MongoBSONID`.
![image](https://github.com/metabase/metabase/assets/8808703/ed95ad0e-cc41-4603-a4bb-1750b61fe8e2)


### Expected behavior

- Should be able to filter on Entity Keys with MongoDB like on any other supported database Entity Key

### Logs

no errors on frontend or backend logs

### Information about your Metabase installation

```JSON
- Broken in Metabase v1.49.7 and v1.49.6
- Worked in 1.48.10
```


### Severity

P1: Common functionality not working, regression

### Additional context

Related to:
- https://github.com/metabase/metabase/issues/38288 (refers to native queries only)

May be related to:
- https://github.com/metabase/metabase/issues/38469
- https://github.com/metabase/metabase/issues/38311",likeshumidity,2024-04-30 01:01:59+00:00,[],2024-05-02 17:39:15+00:00,2024-05-01 15:14:02+00:00,https://github.com/metabase/metabase/issues/42010,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Mongo', None), ('Administration/Metadata & Sync', ''), ('Administration/Table Metadata', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.')]",[],
2270138528,issue,closed,completed,BigQuery - Can't sync materialized views since 1.49.0,"### Describe the bug

Testing in 1.49.7.
Not able to successfully sync Materialized Views in BigQuery and run into the following error:

> java.lang.ClassCastException: class com.google.cloud.bigquery.AutoValue_MaterializedViewDefinition cannot be cast to class com.google.cloud.bigquery.StandardTableDefinition (com.google.cloud.bigquery.AutoValue_MaterializedViewDefinition and com.google.cloud.bigquery.StandardTableDefinition are in unnamed module of loader clojure.lang.DynamicClassLoader @4f5d587c)

<br>

Metadata for the materialized view within Admin Settings will not be brought in.
Attempting to query or browse the data will give a ""no fields found"" message. 

<img width=""703"" alt=""Screenshot 2024-04-29 at 5 51 25 PM"" src=""https://github.com/metabase/metabase/assets/17398657/3d639c21-400c-4900-ae86-452d0967496a"">

<br>
<br>

Tested syncing on **1.49.0** and encounter the same issue.
Syncing functions correctly **1.48.7**.


### To Reproduce

1. Create materialized view in BigQuery
2. Sync database

It doesn't matter whether this is an update to an existing materialized view, or a newly created one.

### Expected behavior

For the sync to function as it did prior to 1.49.0.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""13.5.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""America/Chicago""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mongo"",
      ""bigquery-cloud-sdk"",
      ""mysql"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.3""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-22"",
      ""tag"": ""v1.49.7"",
      ""hash"": ""f0ff786""
    },
    ""settings"": {
      ""report-timezone"": ""UTC""
    }
  }
}
```


### Severity

P1 - Not able to sync Materialized Views or query them

### Additional context

_No response_",FilmonK,2024-04-29 23:04:28+00:00,['qnkhuat'],2024-05-08 10:30:37+00:00,2024-05-03 12:47:36+00:00,https://github.com/metabase/metabase/issues/42008,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Administration/Metadata & Sync', ''), ('Database/BigQuery', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2099105592, 'issue_id': 2270138528, 'author': 'Mjoubrel', 'body': 'Hello Ngoc,\r\n\r\nI noticed the issue\xa0has been addressed, thanks a lot.\r\n\r\nDo you\xa0know when the fix will be available for Cloud users?\r\n\r\nBest,\r\n\r\nMathieu Joubrel\r\n+33 6 73 17 81 74\r\nBook a meeting\r\n\r\nOn Fri, May 03, 2024 at 14:47:56, Ngoc Khuat < ***@***.*** > wrote:\r\n\r\n> \r\n> \r\n> \r\n> Closed #42008 ( https://github.com/metabase/metabase/issues/42008 ) as\r\n> completed via #42092 ( https://github.com/metabase/metabase/pull/42092 ).\r\n> \r\n> \r\n> \r\n> —\r\n> Reply to this email directly, view it on GitHub (\r\n> https://github.com/metabase/metabase/issues/42008#event-12696026302 ) , or\r\n> unsubscribe (\r\n> https://github.com/notifications/unsubscribe-auth/AMKG75L32FUGJ26ZZXMH5BLZAOBPZAVCNFSM6AAAAABG7F42FKVHI2DSMVQWIX3LMV45UABCJFZXG5LFIV3GK3TUJZXXI2LGNFRWC5DJN5XDWMJSGY4TMMBSGYZTAMQ\r\n> ).\r\n> You are receiving this because you are subscribed to this thread. Message\r\n> ID: <metabase/metabase/issue/42008/issue_event/12696026302 @ github. com>\r\n> \r\n> \r\n>', 'created_at': datetime.datetime(2024, 5, 7, 18, 58, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2099551710, 'issue_id': 2270138528, 'author': 'qnkhuat', 'body': ""The fix will be included in 49.9. but it hasn't been released, so I don't have an exact date for you. If you're on the cloud, please email us so our success engineer can support you."", 'created_at': datetime.datetime(2024, 5, 8, 1, 15, 31, tzinfo=datetime.timezone.utc)}]","Mjoubrel on (2024-05-07 18:58:15 UTC): Hello Ngoc,

I noticed the issue has been addressed, thanks a lot.

Do you know when the fix will be available for Cloud users?

Best,

Mathieu Joubrel
+33 6 73 17 81 74
Book a meeting

On Fri, May 03, 2024 at 14:47:56, Ngoc Khuat < ***@***.*** > wrote:

qnkhuat (Assginee) on (2024-05-08 01:15:31 UTC): The fix will be included in 49.9. but it hasn't been released, so I don't have an exact date for you. If you're on the cloud, please email us so our success engineer can support you.

"
2269915009,issue,closed,completed,Cumulative count/sum grouping should ORDER BY first and PARTITION BY all other breakouts,"**Is your feature request related to a problem? Please describe.**

Currently, to do cumulative count with a breakout, it needs to be grouped by the breakout first. E.g. To do cumulative count of accounts over time by plan, you need to group by Plan Name first, followed by Created At. That is not intuitive for users as users would intuitively group by Created At first and then followed by the Plan Name -- the reverse order. 

Another way of thinking about this is, if a user starts with total cumulative count for all plans, and then wants to break that by plan, currently it is not as easy as adding an additional group of Plan Name but it also requires the user to reorder the grouping. Without reordering, the counts are wrong. If the user adds the grouping in the Summarize side bar, it's not possible to reorder there without removing the initial group first. 

**Describe the solution you'd like**

Ideally, it should work regardless of the grouping order, however if we have to pick one, then the reverse order from current implementation would be more intuitive, so Created At first followed by Plan Name. With that setup, it is easy to add the 2nd grouping when starting with total / one grouping only or switch to another 2nd grouping. 

**Describe alternatives you've considered**

Existing behavior and remember to have the groups in the right order, otherwise the counts will be wrong. 

**How important is this feature to you?**

It would make the cumulative count feature easier to use with breakouts. 
",maxzheng,2024-04-29 20:28:48+00:00,['camsaul'],2024-08-28 02:10:45+00:00,2024-05-03 00:50:46+00:00,https://github.com/metabase/metabase/issues/42003,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2089205257, 'issue_id': 2269915009, 'author': 'camsaul', 'body': 'See also original issue #2862 and Slack thread https://metaboat.slack.com/archives/C05MPF0TM3L/p1714084449574689', 'created_at': datetime.datetime(2024, 5, 1, 22, 2, 22, tzinfo=datetime.timezone.utc)}]","camsaul (Assginee) on (2024-05-01 22:02:22 UTC): See also original issue #2862 and Slack thread https://metaboat.slack.com/archives/C05MPF0TM3L/p1714084449574689

"
2269897948,issue,closed,completed,[BE] QP: column corresponding a metric aggregation should have the name of the metric,The test case `should apply metrics including filter to the nested question (metabase#12507)` in `e2e/test/scenarios/question/nested.cy.spec.js` fails because it gets the name generated for the aggregation in the definition of the metric.,metamben,2024-04-29 20:19:22+00:00,['snoe'],2024-05-02 17:09:26+00:00,2024-05-02 17:09:25+00:00,https://github.com/metabase/metabase/issues/42001,[],"[{'comment_id': 2091089858, 'issue_id': 2269897948, 'author': 'snoe', 'body': 'Looks like this was fixed by FE changes', 'created_at': datetime.datetime(2024, 5, 2, 17, 9, 25, tzinfo=datetime.timezone.utc)}]","snoe (Assginee) on (2024-05-02 17:09:25 UTC): Looks like this was fixed by FE changes

"
2269796908,issue,open,,"""Display Values"" for FK Relationships Don't work if the Keys are Character Types","### Describe the bug

Set up a table in Metabase that has a foreign key relationship targeting another table. The ""display value"" is configured to show a value from the other table. If you set up a filter that shows the list of values the chose ""display value"" works if the entityID is an INT type. If it's a test/varchar then it works briefly when you first set it up) but the name quits displaying pretty quickly.

### To Reproduce

1. Create TableA with a variable character entity ID and a ""aName"" column
2. Create TableB with a few of the varchar IDs from TableA
3. On TableB set the entityID as a foreign key and target TableA. Set ""Filtering on this field"" to ""List"" (if necessary) and set the display value to ""aName""
4. Create a Question that lists records from TableA, add to a dashboard
5. Create a dashboard that filters on entityID from tableA
6. Note that the pretty name displays in the filter as expected, but only briefly
7. After a couple of minutes and a refresh it falls back to duplicating the IDs only

This behavior happens with text filters or ID filters set up from the dashboard. This behavior also occurs on field filters on the questions.

### Expected behavior

If a foreign key relationship is defined and a ""display value"" is set we should see that display value in the the dropdown menus.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.133.1-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2"",
      ""bigquery-cloud-sdk"",
      ""mysql"",
      ""snowflake""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.22 (Debian 11.22-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-11"",
      ""tag"": ""v1.49.5"",
      ""hash"": ""31c4887""
    },
    ""settings"": {
      ""report-timezone"": ""Asia/Tokyo""
    }
  }
}
```


### Severity

Not exactly a blocker but it has a significant impact on usability in cases where we'd expect this to work.

### Additional context

The filters technically work but their usability is arguable - no one knows what these long strings actually refer to in the underlying datasets.

Loom recording: https://www.loom.com/share/e12d05a433c34cc4a63e11d2568eb684",ixipixi,2024-04-29 19:27:12+00:00,[],2025-02-04 20:28:57+00:00,,https://github.com/metabase/metabase/issues/41999,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Querying/Remapping', 'Remapped display values, whether human-readable values or Field->Field remappings'), ('.Team/Querying', '')]","[{'comment_id': 2083529985, 'issue_id': 2269796908, 'author': 'gnaryak', 'body': ""Thanks for writing this up. The primary keys in our transactional database are UUID's. During our ETL process, I convert the UUID's to Text columns when I bring the data into our reporting database. This allows them to be shown in a dashboard filter. Metabase gave me errors if I left them as UUID columns. Now I am trying to display a more user-friendly column from a foreign key relationship to represent that id column. It'd sure be nice if Metabase's foreign key display value capabilities were compatible with fields of any data type. Thanks!"", 'created_at': datetime.datetime(2024, 4, 29, 19, 44, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2123112711, 'issue_id': 2269796908, 'author': 'Mendes11', 'body': 'All my tables have UUIDs as primary keys, and I am experiencing the same issue. Names are not shown, despite they are getting returned from the /values call. \r\n\r\nIf I select Filter widget type to ""string"" in the variables panel, the names are shown, but then the filter doesn\'t work as it throws: ```class java.util.UUID cannot be cast to class java.lang.String (java.util.UUID and java.lang.String are in module java.base of loader \'bootstrap\')``` Then if I move it back to ID and save, it works, the names are shown but only until a refresh of the page. This is very frustrating and unusable\r\n\r\nList showing only UUIDs\r\n![image](https://github.com/metabase/metabase/assets/7904704/3f9a10f2-c819-4ec0-9bd9-b47ac8c2fcf8)\r\n\r\nValues Call\r\n![image](https://github.com/metabase/metabase/assets/7904704/6b5bac3b-5998-4b85-9d55-9e5948a08c91)\r\n\r\nVariable Configuration\r\n![image](https://github.com/metabase/metabase/assets/7904704/fb700cff-ddd6-4032-8e50-80e861d62345)\r\n\r\nTable Metadata\r\n![image](https://github.com/metabase/metabase/assets/7904704/7d6e2be8-fbed-44b0-8804-ec4cd7731daa)', 'created_at': datetime.datetime(2024, 5, 21, 17, 32, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2142734658, 'issue_id': 2269796908, 'author': 'bshepherdson', 'body': ""I'm assigning this to the QPD team to look at the underlying metadata and any accidental assumptions around numeric keys vs. string-like keys.\r\n\r\nThis may instead be an FE bug with filter widgets not respecting the remapping, it's not clear at a glance."", 'created_at': datetime.datetime(2024, 5, 31, 17, 58, 50, tzinfo=datetime.timezone.utc)}]","gnaryak on (2024-04-29 19:44:35 UTC): Thanks for writing this up. The primary keys in our transactional database are UUID's. During our ETL process, I convert the UUID's to Text columns when I bring the data into our reporting database. This allows them to be shown in a dashboard filter. Metabase gave me errors if I left them as UUID columns. Now I am trying to display a more user-friendly column from a foreign key relationship to represent that id column. It'd sure be nice if Metabase's foreign key display value capabilities were compatible with fields of any data type. Thanks!

Mendes11 on (2024-05-21 17:32:56 UTC): All my tables have UUIDs as primary keys, and I am experiencing the same issue. Names are not shown, despite they are getting returned from the /values call. 

If I select Filter widget type to ""string"" in the variables panel, the names are shown, but then the filter doesn't work as it throws: ```class java.util.UUID cannot be cast to class java.lang.String (java.util.UUID and java.lang.String are in module java.base of loader 'bootstrap')``` Then if I move it back to ID and save, it works, the names are shown but only until a refresh of the page. This is very frustrating and unusable

List showing only UUIDs
![image](https://github.com/metabase/metabase/assets/7904704/3f9a10f2-c819-4ec0-9bd9-b47ac8c2fcf8)

Values Call
![image](https://github.com/metabase/metabase/assets/7904704/6b5bac3b-5998-4b85-9d55-9e5948a08c91)

Variable Configuration
![image](https://github.com/metabase/metabase/assets/7904704/fb700cff-ddd6-4032-8e50-80e861d62345)

Table Metadata
![image](https://github.com/metabase/metabase/assets/7904704/7d6e2be8-fbed-44b0-8804-ec4cd7731daa)

bshepherdson on (2024-05-31 17:58:50 UTC): I'm assigning this to the QPD team to look at the underlying metadata and any accidental assumptions around numeric keys vs. string-like keys.

This may instead be an FE bug with filter widgets not respecting the remapping, it's not clear at a glance.

"
2269713797,issue,open,,Option to Change Metabase Background Color Across the App,"**Is your feature request related to a problem? Please describe.**
In this instance the problem we're trying to solve is differentiating between multiple different internal Metabase instances. 

**Describe the solution you'd like**
To be able to set a background color other than white for the entire Metabase Instance.

**Describe alternatives you've considered**
Different fonts, changing button colors and making other differentiating color palette changes to charts, etc, haven't been sufficient.


",ixipixi,2024-04-29 18:42:00+00:00,[],2025-02-04 20:31:02+00:00,,https://github.com/metabase/metabase/issues/41996,"[('Type:New Feature', ''), ('Administration/Whitelabel', 'Enterprise white labelling'), ('.Team/Embedding', '')]","[{'comment_id': 2083566139, 'issue_id': 2269713797, 'author': 'dhk', 'body': 'For those curious about what\'s driving the request...\r\nwe maintain an instance of metabase for our external customers; and another for our internal customers (ie company colleagues)\r\n\r\nWe have significantly different rules about what a person may build; internally. \r\n\r\nWe operate a shared-visibility model, courtesy of metabase\'s sandboxing feature, which means that we frequently share dashboards with our external customers so that everyone\'s looking at the same report.\r\n\r\nThis feature works terrifically well for us. No custom content. \r\n\r\nBut, we have this perennial problem where \r\n1. internal customer: ""please build a thing for us""\r\n1. me: right you are, here\'s the thing. We built it on the internal version of metabase\r\n1. \\ <some time passes\\>\r\n1. internal customer: ""my external customer can\'t see the thing. The URL 404\'s"" \r\n1. me: <sad face>sorry. it\'s internal only for now\r\n1. internal customer: ""can\'t you make it external""\r\n1. me: will take some work\r\netc, etc. \r\n\r\nyes, serialization and all the rest of it. \r\n\r\nSo, we think that if our internal customers see a dashboard that has a, say bright orange pink aspect to it, then they\'ll be all: Oh. this is internal use only""\r\n\r\nOther efforts at education have not been durable.', 'created_at': datetime.datetime(2024, 4, 29, 20, 5, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2122593390, 'issue_id': 2269713797, 'author': 'albertoperdomo', 'body': ""@ixipixi We recently implemented [custom background illustrations on the landing page](https://www.metabase.com/docs/master/configuring-metabase/appearance#landing-page). While this isn't different background colors, it could actually help with differentiating instances based on their background, maybe?"", 'created_at': datetime.datetime(2024, 5, 21, 13, 5, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2122918697, 'issue_id': 2269713797, 'author': 'albertoperdomo', 'body': 'Thanks for sharing the context around your need @dhk.\r\nWould custom background illustration help?', 'created_at': datetime.datetime(2024, 5, 21, 15, 42, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2122959471, 'issue_id': 2269713797, 'author': 'dhk', 'body': 'Yes.  Honestly. A collection of  sticks and an army  of proctors is probably  the end state solution', 'created_at': datetime.datetime(2024, 5, 21, 16, 3, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2491390536, 'issue_id': 2269713797, 'author': 'paoliniluis', 'body': '@ixipixi @albertoperdomo we could change the top bar color via env vars', 'created_at': datetime.datetime(2024, 11, 21, 14, 34, 15, tzinfo=datetime.timezone.utc)}]","dhk on (2024-04-29 20:05:11 UTC): For those curious about what's driving the request...
we maintain an instance of metabase for our external customers; and another for our internal customers (ie company colleagues)

We have significantly different rules about what a person may build; internally. 

We operate a shared-visibility model, courtesy of metabase's sandboxing feature, which means that we frequently share dashboards with our external customers so that everyone's looking at the same report.

This feature works terrifically well for us. No custom content. 

But, we have this perennial problem where 
1. internal customer: ""please build a thing for us""
1. me: right you are, here's the thing. We built it on the internal version of metabase
1. \ <some time passes\>
1. internal customer: ""my external customer can't see the thing. The URL 404's"" 
1. me: <sad face>sorry. it's internal only for now
1. internal customer: ""can't you make it external""
1. me: will take some work
etc, etc. 

yes, serialization and all the rest of it. 

So, we think that if our internal customers see a dashboard that has a, say bright orange pink aspect to it, then they'll be all: Oh. this is internal use only""

Other efforts at education have not been durable.

albertoperdomo on (2024-05-21 13:05:17 UTC): @ixipixi We recently implemented [custom background illustrations on the landing page](https://www.metabase.com/docs/master/configuring-metabase/appearance#landing-page). While this isn't different background colors, it could actually help with differentiating instances based on their background, maybe?

albertoperdomo on (2024-05-21 15:42:30 UTC): Thanks for sharing the context around your need @dhk.
Would custom background illustration help?

dhk on (2024-05-21 16:03:04 UTC): Yes.  Honestly. A collection of  sticks and an army  of proctors is probably  the end state solution

paoliniluis on (2024-11-21 14:34:15 UTC): @ixipixi @albertoperdomo we could change the top bar color via env vars

"
2269601581,issue,closed,completed,Add descriptions to search results,,npfitz,2024-04-29 17:43:11+00:00,['npfitz'],2024-05-02 14:17:52+00:00,2024-05-02 14:17:52+00:00,https://github.com/metabase/metabase/issues/41994,[],[],
2269581282,issue,closed,completed,[BE] Make sure that `model: metric` is used in all BE endpoints,At least `popular_items` and `recent_items` endpoints return `model: card` for metrics.,ranquild,2024-04-29 17:31:52+00:00,['snoe'],2024-04-29 20:15:56+00:00,2024-04-29 20:15:56+00:00,https://github.com/metabase/metabase/issues/41993,[],[],
2269546009,issue,open,,Offer more configurability for how legends are displayed (or not),PRD: https://www.notion.so/metabase/Offer-more-configurability-for-how-legends-are-displayed-or-not-6ee535c012b743ca8b05b7b9d9441585,alxnddr,2024-04-29 17:14:09+00:00,[],2025-02-04 20:31:40+00:00,,https://github.com/metabase/metabase/issues/41989,"[('Visualization/', ''), ('Type:New Feature', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Visualization/Legend', '')]",[],
2269545899,issue,open,,Let users hide / show series by clicking on the legend,PRD: https://www.notion.so/metabase/Let-users-hide-show-series-by-clicking-on-the-legend-90a5ec138b534f039136ea7f377252b8,alxnddr,2024-04-29 17:14:05+00:00,['EmmadUsmani'],2025-02-04 20:31:40+00:00,,https://github.com/metabase/metabase/issues/41988,"[('Visualization/', ''), ('Type:New Feature', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Visualization/Legend', '')]",[],
2269545781,issue,open,,Allow users to set colors for or within specific series,PRD: https://www.notion.so/metabase/Allow-users-to-set-colors-for-or-within-specific-series-22baeeee29b34ec880fe8eadc436b80d,alxnddr,2024-04-29 17:14:00+00:00,[],2024-04-29 17:23:10+00:00,,https://github.com/metabase/metabase/issues/41987,"[('Type:New Feature', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2269545679,issue,open,reopened,"Allow for grouping large category counts into ""other""",PRD: https://www.notion.so/metabase/Allow-for-grouping-large-category-counts-into-other-61660fc5206a48ed8ce12a19c2e6ef96,alxnddr,2024-04-29 17:13:56+00:00,['kulyk'],2025-02-04 20:31:20+00:00,,https://github.com/metabase/metabase/issues/41986,"[('Type:New Feature', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2269545586,issue,open,,Offer a separate left and right y-axis settings when split,PRD: https://www.notion.so/metabase/Offer-separate-left-and-right-y-axis-settings-when-split-70280ce79f664aefb20758c497a37a78,alxnddr,2024-04-29 17:13:52+00:00,['alxnddr'],2024-05-06 16:27:41+00:00,,https://github.com/metabase/metabase/issues/41985,"[('Type:New Feature', ''), ('Visualization/Chart Settings', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2269545471,issue,closed,not_planned,Provide the ability to specify a scale factor in scatter plots,https://www.notion.so/metabase/Provide-the-ability-to-specify-a-scale-factor-in-scatter-plots-a09a5b6356fa4ef7b2e126ec7eb95fa4,alxnddr,2024-04-29 17:13:48+00:00,[],2024-05-07 17:51:24+00:00,2024-05-06 16:12:45+00:00,https://github.com/metabase/metabase/issues/41984,"[('Type:New Feature', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2094926123, 'issue_id': 2269545471, 'author': 'cdeweyx', 'body': 'Pausing until we have higher conviction on this / hear more about the problem from customers: [Slack thread](https://metaboat.slack.com/archives/C064QMXEV9N/p1714938138808549?thread_ts=1714765064.408709&cid=C064QMXEV9N)', 'created_at': datetime.datetime(2024, 5, 5, 19, 43, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2098992535, 'issue_id': 2269545471, 'author': 'EmmadUsmani', 'body': 'https://github.com/metabase/metabase/pull/42351\r\n\r\nHad a very rough prototype locally, leaving the PR here for posterity if we ever revisit this', 'created_at': datetime.datetime(2024, 5, 7, 17, 51, 23, tzinfo=datetime.timezone.utc)}]","cdeweyx on (2024-05-05 19:43:59 UTC): Pausing until we have higher conviction on this / hear more about the problem from customers: [Slack thread](https://metaboat.slack.com/archives/C064QMXEV9N/p1714938138808549?thread_ts=1714765064.408709&cid=C064QMXEV9N)

EmmadUsmani on (2024-05-07 17:51:23 UTC): https://github.com/metabase/metabase/pull/42351

Had a very rough prototype locally, leaving the PR here for posterity if we ever revisit this

"
2269545379,issue,closed,completed,Let color be used as a dimension in scatter plots,PRD: https://www.notion.so/metabase/Let-color-be-used-as-a-dimension-in-scatter-plots-fb6ab01eee9d46d0bfb55efacdf92107,alxnddr,2024-04-29 17:13:45+00:00,[],2024-05-03 13:44:37+00:00,2024-05-03 13:44:37+00:00,https://github.com/metabase/metabase/issues/41983,"[('Type:New Feature', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2093054094, 'issue_id': 2269545379, 'author': 'cdeweyx', 'body': 'Closing, this is already supported well enough actually', 'created_at': datetime.datetime(2024, 5, 3, 13, 44, 37, tzinfo=datetime.timezone.utc)}]","cdeweyx on (2024-05-03 13:44:37 UTC): Closing, this is already supported well enough actually

"
2269545274,issue,open,,Add line of best fit to Scatter plots,PRD: https://www.notion.so/metabase/Add-line-of-best-fit-to-Scatter-plots-d106319360e1433987a78db00164a87e,alxnddr,2024-04-29 17:13:41+00:00,"['adam-james-v', 'EmmadUsmani']",2024-05-06 16:12:10+00:00,,https://github.com/metabase/metabase/issues/41982,"[('Type:New Feature', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2269545169,issue,closed,completed,Provide compact numbers for more readable y-axis tick values,PRD: https://www.notion.so/metabase/Provide-compact-numbers-for-more-readable-y-axis-tick-values-083a8174c9154d5a83897c5a28b5af3f,alxnddr,2024-04-29 17:13:37+00:00,['JesseSDevaney'],2024-05-17 07:04:12+00:00,2024-05-17 07:04:12+00:00,https://github.com/metabase/metabase/issues/41981,"[('Type:New Feature', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2269545049,issue,closed,completed,Offer option to display all data labels within stacked bar charts,"PRD: https://www.notion.so/metabase/Offer-option-to-display-all-data-labels-within-stacked-charts-d89e678e9c204d2cb03eb5132c3e5131

For v50 we reduced the scope to bar charts only",alxnddr,2024-04-29 17:13:33+00:00,['alxnddr'],2024-05-31 14:04:56+00:00,2024-05-31 14:04:56+00:00,https://github.com/metabase/metabase/issues/41980,"[('Type:New Feature', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2140881647, 'issue_id': 2269545049, 'author': 'alxnddr', 'body': 'Will be closed after the backport PR is merged: https://github.com/metabase/metabase/pull/43415', 'created_at': datetime.datetime(2024, 5, 30, 21, 19, 17, tzinfo=datetime.timezone.utc)}]","alxnddr (Issue Creator) on (2024-05-30 21:19:17 UTC): Will be closed after the backport PR is merged: https://github.com/metabase/metabase/pull/43415

"
2269544938,issue,closed,completed,Include percent change in tooltips for time series + funnel charts,PRD: https://www.notion.so/metabase/Include-percent-change-in-tooltips-for-time-series-funnel-charts-c9f38dbe0bf9457aa1e566e267521a1d,alxnddr,2024-04-29 17:13:29+00:00,['EmmadUsmani'],2024-05-06 18:48:09+00:00,2024-05-06 18:48:08+00:00,https://github.com/metabase/metabase/issues/41979,"[('Type:New Feature', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2269544841,issue,closed,completed,Let creators configure line thickness / pattern,"PRD: https://www.notion.so/metabase/Let-creators-configure-line-thickness-pattern-0e416172c38e497a85d9310973978880

Also, in the dc.js implementation we showed a thicker line for fewer data points. It would be great to add this behavior back in the scope of this project.",alxnddr,2024-04-29 17:13:25+00:00,['kulyk'],2024-05-03 15:33:25+00:00,2024-05-03 15:33:25+00:00,https://github.com/metabase/metabase/issues/41978,"[('Type:New Feature', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2269544721,issue,closed,completed,Allow non-zero and custom y-axis auto ranges,PRD: https://www.notion.so/metabase/Allow-non-zero-and-custom-y-axis-auto-ranges-b39801f44d35484daaa92132cd37d42b,alxnddr,2024-04-29 17:13:20+00:00,['alxnddr'],2024-05-01 21:35:30+00:00,2024-05-01 21:35:29+00:00,https://github.com/metabase/metabase/issues/41977,"[('Type:New Feature', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2269544590,issue,closed,completed,Support combo stacked charts,"PRD: https://www.notion.so/metabase/Add-support-for-combo-stacked-bar-charts-3f04bf541bcc4976bb81886d5c8bcd29


```[tasklist]
### Milestone 1: support combo stacking only on Combo viz type
- [ ] https://github.com/metabase/metabase/pull/42085
- [ ] https://github.com/metabase/metabase/issues/42195
- [ ] https://github.com/metabase/metabase/pull/42600
```
",alxnddr,2024-04-29 17:13:15+00:00,"['alxnddr', 'adam-james-v']",2024-05-16 21:40:48+00:00,2024-05-16 21:40:47+00:00,https://github.com/metabase/metabase/issues/41976,"[('Type:New Feature', ''), ('.Frontend', ''), ('.Backend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2269441996,issue,closed,completed,[Epic] Metabase 50 viz improvements,"**Links**
- plan: https://www.notion.so/metabase/Add-basic-viz-functionality-that-creators-are-missing-e367f5d7ce4b474e949c5c6a74548bda

**Projects**

```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/issues/41977
- [ ] https://github.com/metabase/metabase/issues/41978
- [ ] https://github.com/metabase/metabase/issues/41979
- [ ] https://github.com/metabase/metabase/issues/41976
- [ ] https://github.com/metabase/metabase/issues/41980
- [ ] https://github.com/metabase/metabase/issues/41981
```

**Postponed**
- https://github.com/metabase/metabase/issues/41982
- https://github.com/metabase/metabase/issues/41985
- https://github.com/metabase/metabase/issues/41988
- https://github.com/metabase/metabase/issues/41984
- https://github.com/metabase/metabase/issues/41986",alxnddr,2024-04-29 16:15:45+00:00,['alxnddr'],2024-06-10 14:53:59+00:00,2024-06-10 14:53:59+00:00,https://github.com/metabase/metabase/issues/41966,"[('.Epic', 'Feature Implementation or Project'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2269359487,issue,open,,sync_schema endpoint is synchronous when it should be asynchronous (only snowflake?),"### Describe the bug

We had a customer that reported that they were getting a 10 second timeout in the endpoint which I didn't believe... but trying to see what's going on I saw times exceeeding the millisecond time
![image](https://github.com/metabase/metabase/assets/1711649/0ce10562-8877-4197-ad0c-1b695f64cecf)

considering that this schedules the sync (it's not synchronous), then those many seconds should mean something

### To Reproduce

1) add a snowflake db
2) then force a sync
3) see the time the endpoint takes

### Expected behavior

should take milliseconds?

### Logs

NA

### Information about your Metabase installation

```JSON
v49.9
```


### Severity

P2

### Additional context

NA",paoliniluis,2024-04-29 15:36:27+00:00,[],2025-02-04 20:26:18+00:00,,https://github.com/metabase/metabase/issues/41964,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Performance', ''), ('Administration/Metadata & Sync', ''), ('Misc/API', ''), ('Database/Snowflake', ''), ('.Backend', ''), ('.Team/Drivers', '')]","[{'comment_id': 2111202727, 'issue_id': 2269359487, 'author': 'brettcvz', 'body': ""We have this with our snowflake db as well, I was running around in circles trying to figure out why the new schema wasn't showing up! v49.10, \r\n![image](https://github.com/metabase/metabase/assets/1316859/3cb15623-34b4-4045-8746-a5daa97c9fb1)\r\n\r\nExploring the code, I suspect this is the core issue: https://github.com/metabase/metabase/blob/master/modules/drivers/snowflake/src/metabase/driver/snowflake.clj#L501\r\n\r\nWe have schemas with hundreds of tables in them, so if this is making a network call per table in the schema it will certainly take longer than 10 seconds."", 'created_at': datetime.datetime(2024, 5, 14, 21, 56, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2111450802, 'issue_id': 2269359487, 'author': 'paoliniluis', 'body': ""@brettcvz do you see if there's any activity in snowflake when you press the button?"", 'created_at': datetime.datetime(2024, 5, 15, 2, 9, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2113216912, 'issue_id': 2269359487, 'author': 'brettcvz', 'body': 'When I click ""Sync database schema now,"" the button turns to ""Starting..."" for 10 seconds and then goes green with text of ""Sync triggered!""\r\n\r\nThe network request says otherwise:\r\n![image](https://github.com/metabase/metabase/assets/1316859/357c6709-456d-4af1-a4c9-46885166c4dd)\r\n\r\n(it\'s a 422 because the request asks for JSON and the response is `Timed out after 10.0 s`)\r\n\r\nSimilarly, the logs show a timeout.\r\n\r\nSo there\'s a few bugs here:\r\n1. The request seems to be doing something expensive synchronously when it purports to just be triggering a sync\r\n2. The request is failing after 10 seconds (something is probably unoptimized here)\r\n3. The user-facing UI shows everything is happy, but actually the request failed.', 'created_at': datetime.datetime(2024, 5, 15, 18, 41, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2113659485, 'issue_id': 2269359487, 'author': 'paoliniluis', 'body': 'gotcha, so nothing in Snowflake (no queries being fired at all)', 'created_at': datetime.datetime(2024, 5, 15, 23, 45, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2118016411, 'issue_id': 2269359487, 'author': 'brettcvz', 'body': 'Sorry I misunderstood - there is a query being fired: `SHOW OBJECTS IN DATABASE ""MAIN"";`.  In our warehouse this query regularly takes upwards of 10 seconds (typically 14-19s). When it takes longer than 10 seconds, the metabase timeout is triggered and the sync fails.', 'created_at': datetime.datetime(2024, 5, 17, 16, 58, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2118113748, 'issue_id': 2269359487, 'author': 'paoliniluis', 'body': 'thanks, I changed the name of the issue to reflect this', 'created_at': datetime.datetime(2024, 5, 17, 17, 49, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2181038572, 'issue_id': 2269359487, 'author': 'paoliniluis', 'body': 'Maybe we should try to make this somehow so it doesn’t time out?', 'created_at': datetime.datetime(2024, 6, 20, 15, 56, 20, tzinfo=datetime.timezone.utc)}]","brettcvz on (2024-05-14 21:56:05 UTC): We have this with our snowflake db as well, I was running around in circles trying to figure out why the new schema wasn't showing up! v49.10, 
![image](https://github.com/metabase/metabase/assets/1316859/3cb15623-34b4-4045-8746-a5daa97c9fb1)

Exploring the code, I suspect this is the core issue: https://github.com/metabase/metabase/blob/master/modules/drivers/snowflake/src/metabase/driver/snowflake.clj#L501

We have schemas with hundreds of tables in them, so if this is making a network call per table in the schema it will certainly take longer than 10 seconds.

paoliniluis (Issue Creator) on (2024-05-15 02:09:49 UTC): @brettcvz do you see if there's any activity in snowflake when you press the button?

brettcvz on (2024-05-15 18:41:37 UTC): When I click ""Sync database schema now,"" the button turns to ""Starting..."" for 10 seconds and then goes green with text of ""Sync triggered!""

The network request says otherwise:
![image](https://github.com/metabase/metabase/assets/1316859/357c6709-456d-4af1-a4c9-46885166c4dd)

(it's a 422 because the request asks for JSON and the response is `Timed out after 10.0 s`)

Similarly, the logs show a timeout.

So there's a few bugs here:
1. The request seems to be doing something expensive synchronously when it purports to just be triggering a sync
2. The request is failing after 10 seconds (something is probably unoptimized here)
3. The user-facing UI shows everything is happy, but actually the request failed.

paoliniluis (Issue Creator) on (2024-05-15 23:45:02 UTC): gotcha, so nothing in Snowflake (no queries being fired at all)

brettcvz on (2024-05-17 16:58:56 UTC): Sorry I misunderstood - there is a query being fired: `SHOW OBJECTS IN DATABASE ""MAIN"";`.  In our warehouse this query regularly takes upwards of 10 seconds (typically 14-19s). When it takes longer than 10 seconds, the metabase timeout is triggered and the sync fails.

paoliniluis (Issue Creator) on (2024-05-17 17:49:35 UTC): thanks, I changed the name of the issue to reflect this

paoliniluis (Issue Creator) on (2024-06-20 15:56:20 UTC): Maybe we should try to make this somehow so it doesn’t time out?

"
2269133172,issue,closed,completed,Beef up Recents 🥩 ,"related to https://github.com/metabase/metabase/issues/39528
[product doc ](https://www.notion.so/metabase/Add-Recents-tab-to-the-new-EntityPicker-component-895cd80f2b0f4e56a008a82b436c3a00?pm=c)

For the new recent item picker, we're going to need some changes to the activity/recents api

- We need to track the most recent 20 items that each user has ""touched"" (ie viewed) of each entity type	
	- question
	- model
	- table (probably don't need right now)
	- dashboard
	- collection
- for a collection to be ""recently viewed"" [means](https://metaboat.slack.com/archives/C064EB1UE5P/p1714504102513489?thread_ts=1714169076.361039&cid=C064EB1UE5P) that:
	- the collection was created
	- a dashboard or question was saved in the collection
	- a dashboard, question, or collection was moved into the collection
- We also need more information about each item than the current api provides
	- `can_write`
	- `last_touched` or some sort of proxy for sorting by most recently used (i think this is what the timestamp field in the recent_views table is doing)
	- parent information - collection name + authority level (eventually parent db for tables)
- While we're at it, can we make the payload for the recents endpoint conform more closely to search and/or collection items?
	- 	nesting `model_object` inside each recent item is a weird pattern that's used nowhere else and is completely unnecessary, we can just populate a `model` property on each item like we do elsewhere
	- we should probably update the popular items api to match


### Desired RecentItem Shape
(open to discussion)

```ts
interface RecentItem {
  id: number;
  name: string;
  model: string; // should differentiate between regular cards and ""dataset"" for models
  can_write: boolean;
  display: string; // for questions
  parent_collection: { // for non-tables
    id: number;
    name: string;
    authority_level: ""official"" | null; // for collections
  } | null;
  database: { // for tables
    id: number;
    name: string; // display name
  } | null;
  authority_level: ""official"" | null; // for collections
  moderated_status: ""verified"" | null; // for models
  timestamp: string; // last touched
}
```
```[tasklist]
### Tasks
- [x] update return from /activity/recent_views
- [x] track models as distinct from cards
- [x] update recents to preserve inside category (not just last 30 whatevers, but 20 cards, 20 dashboards, etc...)
- [x] Capture collection uses (add event for collection creation, event for moving card, dash, collection)
- [x] update /popular_items return shape to match recent_views
- [x] https://github.com/metabase/metabase/issues/42665
```
",iethree,2024-04-29 14:00:25+00:00,"['escherize', 'iethree']",2024-05-16 23:20:00+00:00,2024-05-16 23:19:59+00:00,https://github.com/metabase/metabase/issues/41957,"[('Organization/Collections', ''), ('.Backend', '')]",[],
2269132117,issue,closed,completed,[Epic] Selecting multiple values for all text filters,"**Links**
- [Product doc](https://www.notion.so/Offer-the-ability-to-select-multiple-values-for-all-text-filters-e41ed1d75702473683967ba57dd3a331?pvs=24)
- [Eng doc](https://www.notion.so/metabase/Tech-Selecting-multiple-values-for-all-text-filters-83aa3b8a803741e2b2e94e242cec85f3)
- Feature branch: None needed?

**Implementation Plan**
The goal of this milestone to have the feature parity with the current behavior for ""Is"" (`=`) and ""Is not"" (`!=`) filters.


```[tasklist]
## Milestone 1 (query builder)
- [x] #41958 
- [x] #42101 ([Figma](https://www.figma.com/file/9ya59GapN0pG4wOExkLsH1/Offer-the-ability-to-select-multiple-options-for-dropdowns-for-all-text-filters?type=design&node-id=4058-6459&mode=design&t=NmuEmlCotcDeQQPk-0))
```

```[tasklist]
## Milestone 2 (dashboard)
- [ ] https://github.com/metabase/metabase/pull/42404
- [x] Expand the dashboard filters to allow multi-select ([Figma](https://www.figma.com/file/9ya59GapN0pG4wOExkLsH1/Offer-the-ability-to-select-multiple-options-for-dropdowns-for-all-text-filters?type=design&node-id=4058-6531&mode=design&t=GZcx7ktU7yCQ6HnQ-0)) (https://github.com/metabase/metabase/pull/42013)
```


",bshepherdson,2024-04-29 13:59:56+00:00,['nemanjaglumac'],2024-05-16 13:28:36+00:00,2024-05-14 08:46:46+00:00,https://github.com/metabase/metabase/issues/41956,"[('.Epic', 'Feature Implementation or Project'), ('.Team/Querying', '')]",[],
2269048952,issue,closed,completed,"""Collection type"" tooltip is hidden behind the collection modal","### Describe the bug

The collection type tooltip renders behind the collection modal.

### To Reproduce

You'll need an enterprise Metabase edition for this.

1. Go to ""New > Collection""
2. Hover the `i` icon next to the ""Collection type""
3. See that the tooltip renders behind the modal

![image](https://github.com/metabase/metabase/assets/31325167/531a8f01-f706-4d0c-991b-2fadc538ba2d)



### Expected behavior

The tooltip should render in front of the modal and should not be obstructed.

### Logs

_No response_

### Information about your Metabase installation

```JSON
local dev, `master`, 48e4888, H2, Sample Database
```


### Severity

P3

### Additional context
Not present in `x.49.7`. This is a regression in `master` only.",nemanjaglumac,2024-04-29 13:25:53+00:00,['noahmoss'],2024-08-29 17:32:52+00:00,2024-08-29 16:57:28+00:00,https://github.com/metabase/metabase/issues/41953,"[('Type:Bug', 'Product defects'), ('.CSS', ''), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Organization/Collections', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2312919639, 'issue_id': 2269048952, 'author': 'noahmoss', 'body': 'Introduced by https://github.com/metabase/metabase/pull/38298', 'created_at': datetime.datetime(2024, 8, 27, 15, 44, 31, tzinfo=datetime.timezone.utc)}]","noahmoss (Assginee) on (2024-08-27 15:44:31 UTC): Introduced by https://github.com/metabase/metabase/pull/38298

"
2268728039,issue,closed,completed,Cartesian charts labels should inherit color from Mantine theme in React embedding,"Cartesian charts' axis labels and legends should inherit the color palette of the user-supplied Mantine theme. The color of the chart labels is currently hard-coded.

![CleanShot 2567-04-25 at 22 06 34@2x](https://github.com/metabase/metabase/assets/4714175/ba193696-3fe7-4799-ab32-fedd741db1b5)
",heypoom,2024-04-29 11:02:17+00:00,['heypoom'],2024-05-02 15:39:08+00:00,2024-05-02 15:39:08+00:00,https://github.com/metabase/metabase/issues/41949,[],[],
2268723959,issue,closed,completed,Expose basic theme configuration to the MetabaseProvider in embedding SDK,"Expose an optional `theme` prop in the SDK, which accepts a `MetabaseTheme` theme override object to apply to the inner `ThemeProvider`.",heypoom,2024-04-29 11:00:02+00:00,['heypoom'],2024-05-02 13:11:21+00:00,2024-05-02 09:31:17+00:00,https://github.com/metabase/metabase/issues/41948,[],[],
2268719625,issue,closed,completed,[Epic] Basic theming for React embedding SDK,"Allow SDK users to customize the appearance of React components in the interactive embedding SDK, by exposing a theme configuration prop to the MetabaseProvider.

We achieve this by converting a subset of Emotion components to use Mantine components from `metabase/ui`. This would allow a subset of user's themes (e.g. color palette, fonts, base font sizes) to be applied to the embedded components, such as tables, popovers and filters.

In addition, we will expose custom theme configurations for users to be able to customize specific theme options, which is then merged/injected into target component's styles. This epic focuses on basic theming to match the SDK user's app branding, such as color palette, base font sizes, font family and line height.

**Links**
- [product doc](https://www.notion.so/metabase/Theming-CSS-overrides-c2522c9fb85d43669cf86e650a27bf68?pvs=4)
- [tech doc](https://www.notion.so/metabase/Metabase-Embedding-SDK-for-React-theming-milestones-867fcecba0f74abd8158b6cd3164cac4?pvs=4)
- feature branch: `embedding-sdk-theming`

**Implementation Plan**


***Milestone 1***
```[tasklist]
### Expose theme configuration to MetabaseProvider
- [ ] https://github.com/metabase/metabase/issues/41948
- [ ] https://github.com/metabase/metabase/issues/42201
- [ ] https://github.com/metabase/metabase/issues/42214
```

***Milestone 2***
```[tasklist]
### Basic theming for question visualizations
- [ ] https://github.com/metabase/metabase/issues/41949
- [ ] https://github.com/metabase/metabase/issues/42157
- [ ] https://github.com/metabase/metabase/issues/42321
- [ ] https://github.com/metabase/metabase/issues/42199
- [ ] https://github.com/metabase/metabase/issues/42159
- [ ] https://github.com/metabase/metabase/issues/42158
```

***Milestone 3***
```[tasklist]
### Basic theming for interactive questions
- [ ] https://github.com/metabase/metabase/issues/42560
```",heypoom,2024-04-29 10:57:42+00:00,"['WiNloSt', 'heypoom']",2024-05-17 15:32:48+00:00,2024-05-17 15:32:28+00:00,https://github.com/metabase/metabase/issues/41947,"[('Type:New Feature', ''), ('.Epic', 'Feature Implementation or Project'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2117858666, 'issue_id': 2268719625, 'author': 'heypoom', 'body': ""@albertoperdomo @NevRA note that all tasks on this epic are merged, therefore let's close it."", 'created_at': datetime.datetime(2024, 5, 17, 15, 32, 47, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2024-05-17 15:32:47 UTC): @albertoperdomo @NevRA note that all tasks on this epic are merged, therefore let's close it.

"
2268697092,issue,open,,Serialization breaks when there's an x-ray of a model of internal analytics,"### Describe the bug

make an x-ray of the query log model and then export/import it, it will break

### To Reproduce

1) x-ray the ""query log"" model
2) do an export and then an import
3) see the error

### Expected behavior

It should just work

### Logs

```
2024-04-29 10:42:37,581 INFO v2.load :: Loading Database  > Table  > Field 
clojure.lang.ExceptionInfo: Failed to read file for Database  > Table  > Field  {:path [{:model ""Database"", :id nil} {:model ""Table"", :id nil} {:model ""Field"", :id nil}], :deps-chain #{[#ordered/map ([:id ""KypmvlTTRLfnnx5aF6MGJ""] [:model ""Card""])]}, :error :metabase-enterprise.serialization.v2.load/not-found, :toucan2/context-trace [[""resolve connection"" {:toucan2.connection/connectable metabase.db.connection.ApplicationDB}] [""resolve connection"" {:toucan2.connection/connectable :default}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}
	at metabase_enterprise.serialization.v2.load$load_one_BANG_$fn__106406.invoke(load.clj:52)
	at metabase_enterprise.serialization.v2.load$load_one_BANG_.invokeStatic(load.clj:49)
	at metabase_enterprise.serialization.v2.load$load_one_BANG_.invoke(load.clj:33)
	at metabase_enterprise.serialization.v2.load$load_deps_BANG_$loader__106400.invoke(load.clj:23)
	at clojure.lang.PersistentVector.reduce(PersistentVector.java:343)
	at clojure.core$reduce.invokeStatic(core.clj:6886)
	at clojure.core$reduce.invoke(core.clj:6869)
	at metabase_enterprise.serialization.v2.load$load_deps_BANG_.invokeStatic(load.clj:31)
	at metabase_enterprise.serialization.v2.load$load_deps_BANG_.invoke(load.clj:14)
	at metabase_enterprise.serialization.v2.load$load_one_BANG_.invokeStatic(load.clj:60)
	at metabase_enterprise.serialization.v2.load$load_one_BANG_.invoke(load.clj:33)
	at clojure.core.protocols$fn__8249.invokeStatic(protocols.clj:168)
	at clojure.core.protocols$fn__8249.invoke(protocols.clj:124)
	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
	at clojure.core$reduce.invokeStatic(core.clj:6887)
	at clojure.core$reduce.invoke(core.clj:6869)
	at metabase_enterprise.serialization.v2.load$load_metabase_BANG_$with_connection_STAR___106413$with_transaction_STAR___106414.invoke(load.clj:89)
	at toucan2.connection$bind_current_connectable_fn$fn__21143.invoke(connection.clj:104)
	at metabase.db.connection$do_transaction$thunk__32323.invoke(connection.clj:150)
	at metabase.db.connection$do_transaction.invokeStatic(connection.clj:162)
	at metabase.db.connection$do_transaction.invoke(connection.clj:146)
	at metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invokeStatic(connection.clj:199)
	at metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invoke(connection.clj:172)
	at clojure.lang.AFn.applyToHelper(AFn.java:165)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:457)
	at clojure.core$partial$fn__5908.invoke(core.clj:2643)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at methodical.impl.combo.threaded$fn__18233$fn__18234$fn__18237.invoke(threaded.clj:71)
	at methodical.impl.combo.threaded$reducer_fn$fn__18203$fn__18207.invoke(threaded.clj:23)
	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
	at clojure.core$reduce.invokeStatic(core.clj:6887)
	at clojure.core$reduce.invoke(core.clj:6869)
	at methodical.impl.combo.threaded$reducer_fn$fn__18203.invoke(threaded.clj:21)
	at clojure.core$comp$fn__5876.invoke(core.clj:2588)
	at methodical.impl.combo.threaded$combine_with_threader$fn__18213.invoke(threaded.clj:44)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invokeStatic(connection.clj:249)
	at toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invoke(connection.clj:245)
	at clojure.lang.AFn.applyToHelper(AFn.java:165)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:457)
	at clojure.core$partial$fn__5908.invoke(core.clj:2643)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:58)
	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:195)
	at metabase_enterprise.serialization.v2.load$load_metabase_BANG_$with_connection_STAR___106413.invoke(load.clj:79)
	at toucan2.connection$bind_current_connectable_fn$fn__21143.invoke(connection.clj:104)
	at toucan2.connection$bind_current_connectable_fn$fn__21143.invoke(connection.clj:104)
	at toucan2.connection$bind_current_connectable_fn$fn__21143.invoke(connection.clj:104)
	at toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource.invokeStatic(connection.clj:18)
	at toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource.invoke(connection.clj:15)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at clojure.core$partial$fn__5908.invoke(core.clj:2642)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at methodical.impl.combo.threaded$fn__18233$fn__18234$fn__18235.invoke(threaded.clj:70)
	at methodical.impl.combo.threaded$reducer_fn$fn__18203$fn__18207.invoke(threaded.clj:23)
	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
	at clojure.core$reduce.invokeStatic(core.clj:6887)
	at clojure.core$reduce.invoke(core.clj:6869)
	at methodical.impl.combo.threaded$reducer_fn$fn__18203.invoke(threaded.clj:21)
	at clojure.core$comp$fn__5876.invoke(core.clj:2587)
	at methodical.impl.combo.threaded$combine_with_threader$fn__18213.invoke(threaded.clj:43)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at clojure.core$partial$fn__5908.invoke(core.clj:2642)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193)
	at metabase.db.connection$do_with_connection_primary_method_default.invokeStatic(connection.clj:142)
	at metabase.db.connection$do_with_connection_primary_method_default.invoke(connection.clj:140)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at clojure.core$partial$fn__5908.invoke(core.clj:2642)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at methodical.impl.combo.threaded$fn__18233$fn__18234$fn__18235.invoke(threaded.clj:70)
	at methodical.impl.combo.threaded$reducer_fn$fn__18203$fn__18207.invoke(threaded.clj:23)
	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
	at clojure.core$reduce.invokeStatic(core.clj:6887)
	at clojure.core$reduce.invoke(core.clj:6869)
	at methodical.impl.combo.threaded$reducer_fn$fn__18203.invoke(threaded.clj:21)
	at clojure.core$comp$fn__5876.invoke(core.clj:2587)
	at methodical.impl.combo.threaded$combine_with_threader$fn__18213.invoke(threaded.clj:43)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at clojure.core$partial$fn__5908.invoke(core.clj:2642)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193)
	at toucan2.connection$do_with_connection_primary_method_.invokeStatic(connection.clj:204)
	at toucan2.connection$do_with_connection_primary_method_.invoke(connection.clj:194)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at clojure.core$partial$fn__5908.invoke(core.clj:2642)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at methodical.impl.combo.threaded$fn__18233$fn__18234$fn__18235.invoke(threaded.clj:70)
	at methodical.impl.combo.threaded$reducer_fn$fn__18203$fn__18207.invoke(threaded.clj:23)
	at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
	at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
	at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
	at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
	at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
	at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
	at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
	at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
	at clojure.core$reduce.invokeStatic(core.clj:6887)
	at clojure.core$reduce.invoke(core.clj:6869)
	at methodical.impl.combo.threaded$reducer_fn$fn__18203.invoke(threaded.clj:21)
	at clojure.core$comp$fn__5876.invoke(core.clj:2587)
	at methodical.impl.combo.threaded$combine_with_threader$fn__18213.invoke(threaded.clj:43)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
	at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:436)
	at clojure.core$partial$fn__5908.invoke(core.clj:2642)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
	at clojure.lang.RestFn.invoke(RestFn.java:421)
	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193)
	at metabase_enterprise.serialization.v2.load$load_metabase_BANG_.invokeStatic(load.clj:79)
	at metabase_enterprise.serialization.v2.load$load_metabase_BANG_.doInvoke(load.clj:75)
	at clojure.lang.RestFn.invoke(RestFn.java:423)
	at metabase_enterprise.serialization.cmd$v2_load_internal_BANG_.invokeStatic(cmd.clj:102)
	at metabase_enterprise.serialization.cmd$v2_load_internal_BANG_.doInvoke(cmd.clj:83)
	at clojure.lang.RestFn.invoke(RestFn.java:464)
	at metabase_enterprise.serialization.cmd$v2_load_BANG_$fn__106446.invoke(cmd.clj:114)
	at metabase_enterprise.serialization.cmd$v2_load_BANG_.invokeStatic(cmd.clj:113)
	at metabase_enterprise.serialization.cmd$v2_load_BANG_.invoke(cmd.clj:104)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.Var.applyTo(Var.java:705)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.cmd$call_enterprise.invokeStatic(cmd.clj:54)
	at metabase.cmd$call_enterprise.doInvoke(cmd.clj:43)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at metabase.cmd$import.invokeStatic(cmd.clj:191)
	at metabase.cmd$import.doInvoke(cmd.clj:188)
	at clojure.lang.RestFn.invoke(RestFn.java:410)
	at clojure.lang.AFn.applyToHelper(AFn.java:154)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.cmd$run_cmd$fn__108438.invoke(cmd.clj:301)
	at metabase.cmd$run_cmd.invokeStatic(cmd.clj:300)
	at metabase.cmd$run_cmd.invoke(cmd.clj:290)
	at clojure.lang.Var.invoke(Var.java:388)
	at metabase.core$run_cmd.invokeStatic(core.clj:181)
	at metabase.core$run_cmd.invoke(core.clj:179)
	at metabase.core$entrypoint.invokeStatic(core.clj:203)
	at metabase.core$entrypoint.doInvoke(core.clj:198)
	at clojure.lang.RestFn.applyTo(RestFn.java:137)
	at clojure.lang.Var.applyTo(Var.java:705)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
	at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
	at clojure.lang.RestFn.applyTo(RestFn.java:137)
	at metabase.bootstrap.main(Unknown Source)
Caused by: java.lang.NullPointerException
	at metabase.util.yaml$from_file.invokeStatic(yaml.clj:36)
	at metabase.util.yaml$from_file.doInvoke(yaml.clj:33)
	at clojure.lang.RestFn.invoke(RestFn.java:423)
	at metabase_enterprise.serialization.v2.ingest$ingest_file.invokeStatic(ingest.clj:55)
	at metabase_enterprise.serialization.v2.ingest$ingest_file.invoke(ingest.clj:50)
	at metabase_enterprise.serialization.v2.ingest.YamlIngestion.ingest_one(ingest.clj:88)
	at metabase_enterprise.serialization.v2.load$load_one_BANG_$fn__106406.invoke(load.clj:50)
	... 244 more
Command failed with exception: Failed to read file for Database  > Table  > Field 

```

### Information about your Metabase installation

```JSON
v49, postgres
```


### Severity

P2

### Additional context

NA",paoliniluis,2024-04-29 10:45:37+00:00,[],2025-02-04 20:26:37+00:00,,https://github.com/metabase/metabase/issues/41946,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Operation/Serialization', 'Enterprise contents migration'), ('Administration/Usage analytics', 'Pro and Enterprise meta analytics, fka audit'), ('.Team/Workflows', 'aka BEC')]",[],
2268652044,issue,open,,Card with error returns a 2xx http code in the response,"### Describe the bug

If you run into https://github.com/metabase/metabase/issues/41944, you'll see that /api/dataset returns an exception but a 202 response code
![image](https://github.com/metabase/metabase/assets/1711649/12ff938f-3d09-4148-8cdd-3fd2ed10eb8e)
![image](https://github.com/metabase/metabase/assets/1711649/2718250b-b741-43ae-a60c-109295685804)


### To Reproduce

1) reproduce the issue 41944
2) see that the API calls return a 202 code, but they should be returning error codes

### Expected behavior

Return 5xx codes

### Logs

NA

### Information about your Metabase installation

```JSON
v49
```


### Severity

P2

### Additional context

_No response_",paoliniluis,2024-04-29 10:21:43+00:00,[],2025-02-04 20:27:57+00:00,,https://github.com/metabase/metabase/issues/41945,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2237774584, 'issue_id': 2268652044, 'author': 'snoe', 'body': 'Possible dupe of #28676', 'created_at': datetime.datetime(2024, 7, 18, 23, 31, 52, tzinfo=datetime.timezone.utc)}]","snoe on (2024-07-18 23:31:52 UTC): Possible dupe of #28676

"
2268644375,issue,open,,X-Raying a model from metabase analytics generates a buggy card,"### Describe the bug

Just tried to x-ray a model from metabase analytics and got a card with an error
![image](https://github.com/metabase/metabase/assets/1711649/20dc4679-400c-4069-ac40-ab1b5d743702)

clicking on the card you'll see
![image](https://github.com/metabase/metabase/assets/1711649/097fc3c5-29de-4fd3-a829-fb060480edf9)


### To Reproduce

1) start Metabase enterprise
2) go to Metabase analytics
3) x-ray any table

### Expected behavior

It should not generate cards with errors

### Logs

```
2024-04-29 10:16:43,879 ERROR middleware.catch-exceptions :: Error processing query: Failed to fetch :metadata/column 1559
{:database_id 13371337,
 :started_at #t ""2024-04-29T10:16:43.843836Z[GMT]"",
 :via
 [{:status :failed,
   :class clojure.lang.ExceptionInfo,
   :error ""Error resolving Fields in query: Failed to fetch :metadata/column 1559"",
   :stacktrace
   [""--> query_processor.middleware.resolve_fields$resolve_fields.invokeStatic(resolve_fields.clj:32)""
    ""query_processor.middleware.resolve_fields$resolve_fields.invoke(resolve_fields.clj:22)""
    ""query_processor.middleware.upgrade_field_literals$upgrade_field_literals.invokeStatic(upgrade_field_literals.clj:109)""
    ""query_processor.middleware.upgrade_field_literals$upgrade_field_literals.invoke(upgrade_field_literals.clj:91)""
    ""query_processor$preprocess_STAR_$fn__73403.invoke(query_processor.clj:164)""
    ""query_processor$preprocess_STAR_.invokeStatic(query_processor.clj:162)""
    ""query_processor$preprocess_STAR_.invoke(query_processor.clj:157)""
    ""query_processor$fn__73411$combined_pre_process__73412$combined_pre_process_STAR___73413.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66697.invoke(fetch_source_query.clj:299)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72154$fn__72158.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72154.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67324$fn__67325.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67324.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72151.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72456.invoke(normalize_query.clj:38)""
    ""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$fn__79812$handle_audit_app_internal_queries__79813$fn__79815.invoke(handle_audit_queries.clj:142)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72102.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71217.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72387.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72988.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62838$thunk__62840.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62838.invoke(reducible.clj:132)""
    ""query_processor.reducible$sync_qp$qp_STAR___62850.doInvoke(reducible.clj:153)""
    ""query_processor$process_userland_query.invokeStatic(query_processor.clj:402)""
    ""query_processor$process_userland_query.doInvoke(query_processor.clj:398)""
    ""query_processor$process_query_and_save_execution_BANG_.invokeStatic(query_processor.clj:416)""
    ""query_processor$process_query_and_save_execution_BANG_.invoke(query_processor.clj:406)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invokeStatic(query_processor.clj:431)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invoke(query_processor.clj:421)""
    ""api.dataset$run_query_async$fn__94633.invoke(dataset.clj:79)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53268$fn__53270.invoke(streaming.clj:168)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53268.invoke(streaming.clj:167)""
    ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)""
    ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)""
    ""async.streaming_response$do_f_async$task__43763.invoke(streaming_response.clj:88)""],
   :error_type :qp,
   :ex-data
   {:field-ids #{210 213 1559 208 214 216 198 215 211 207 209 212},
    :query
    {:database 13371337,
     :query
     {:aggregation [[:distinct [:field 1559 {:source-field 215}]]],
      :source-card-id 28,
      :source-query {:source-table 21},
      :source-metadata
      [{:description nil,
        :semantic_type :type/PK,
        :coercion_strategy nil,
        :name ""entity_id"",
        :settings nil,
        :fk_target_field_id nil,
        :field_ref [:field 198 nil],
        :effective_type :type/Integer,
        :id 198,
        :visibility_type :normal,
        :display_name ""Entity ID"",
        :base_type :type/Integer}
       {:description nil,
        :semantic_type :type/PK,
        :coercion_strategy nil,
        :name ""entity_qualified_id"",
        :settings nil,
        :fk_target_field_id nil,
        :field_ref [:field 216 nil],
        :effective_type :type/Text,
        :id 216,
        :visibility_type :normal,
        :display_name ""Entity Qualified ID"",
        :base_type :type/Text}
       {:description nil,
        :semantic_type :type/CreationTimestamp,
        :coercion_strategy nil,
        :unit :default,
        :name ""created_at"",
        :settings nil,
        :fk_target_field_id nil,
        :field_ref [:field 211 {:temporal-unit :default}],
        :effective_type :type/DateTimeWithLocalTZ,
        :id 211,
        :visibility_type :normal,
        :display_name ""Created At"",
        :base_type :type/DateTimeWithLocalTZ}
       {:description nil,
        :semantic_type :type/UpdatedTimestamp,
        :coercion_strategy nil,
        :unit :default,
        :name ""updated_at"",
        :settings nil,
        :fk_target_field_id nil,
        :field_ref [:field 210 {:temporal-unit :default}],
        :effective_type :type/DateTimeWithLocalTZ,
        :id 210,
        :visibility_type :normal,
        :display_name ""Updated At"",
        :base_type :type/DateTimeWithLocalTZ}
       {:description nil,
        :semantic_type :type/Name,
        :coercion_strategy nil,
        :name ""name"",
        :settings nil,
        :fk_target_field_id nil,
        :field_ref [:field 208 nil],
        :effective_type :type/Text,
        :id 208,
        :visibility_type :normal,
        :display_name ""Name"",
        :base_type :type/Text}
       {:description nil,
        :semantic_type :type/Name,
        :coercion_strategy nil,
        :name ""display_name"",
        :settings nil,
        :fk_target_field_id nil,
        :field_ref [:field 209 nil],
        :effective_type :type/Text,
        :id 209,
        :visibility_type :normal,
        :display_name ""Display Name"",
        :base_type :type/Text}
       {:description nil,
        :semantic_type :type/Description,
        :coercion_strategy nil,
        :name ""description"",
        :settings nil,
        :fk_target_field_id nil,
        :field_ref [:field 207 nil],
        :effective_type :type/Text,
        :id 207,
        :visibility_type :normal,
        :display_name ""Description"",
        :base_type :type/Text}
       {:description ""True if table is available in the data source. False if it not found in sync anymore."",
        :semantic_type :type/Category,
        :coercion_strategy nil,
        :name ""active"",
        :settings nil,
        :fk_target_field_id nil,
        :field_ref [:field 214 nil],
        :effective_type :type/Boolean,
        :id 214,
        :visibility_type :normal,
        :display_name ""Active"",
        :base_type :type/Boolean}
       {:description nil,
        :semantic_type :type/FK,
        :coercion_strategy nil,
        :name ""database_id"",
        :settings nil,
        :fk_target_field_id 1559,
        :field_ref [:field 215 nil],
        :effective_type :type/Integer,
        :id 215,
        :visibility_type :normal,
        :display_name ""Database ID"",
        :base_type :type/Integer}
       {:description nil,
        :semantic_type nil,
        :coercion_strategy nil,
        :name ""schema"",
        :settings nil,
        :fk_target_field_id nil,
        :field_ref [:field 212 nil],
        :effective_type :type/Text,
        :id 212,
        :visibility_type :normal,
        :display_name ""Schema"",
        :base_type :type/Text}
       {:description nil,
        :semantic_type :type/Category,
        :coercion_strategy nil,
        :name ""is_upload"",
        :settings nil,
        :fk_target_field_id nil,
        :field_ref [:field 213 nil],
        :effective_type :type/Boolean,
        :id 213,
        :visibility_type :normal,
        :display_name ""Is Upload"",
        :base_type :type/Boolean}],
      :source-query/dataset? true},
     :type :query,
     :middleware
     {:js-int-to-string? true,
      :add-default-userland-constraints? true,
      :metabase.query-processor.middleware.constraints/add-userland-constraints? true},
     :info
     {:executed-by 1,
      :context :ad-hoc,
      :card-id 28,
      :metadata/dataset-metadata
      [{:semantic_type :type/PK,
        :name ""entity_id"",
        :field_ref [:field 198 nil],
        :effective_type :type/Integer,
        :id 198,
        :visibility_type :normal,
        :display_name ""Entity ID"",
        :base_type :type/Integer}
       {:semantic_type :type/PK,
        :name ""entity_qualified_id"",
        :field_ref [:field 216 nil],
        :effective_type :type/Text,
        :id 216,
        :visibility_type :normal,
        :display_name ""Entity Qualified ID"",
        :base_type :type/Text}
       {:semantic_type :type/CreationTimestamp,
        :unit :default,
        :name ""created_at"",
        :field_ref [:field 211 {:temporal-unit :default}],
        :effective_type :type/DateTimeWithLocalTZ,
        :id 211,
        :visibility_type :normal,
        :display_name ""Created At"",
        :base_type :type/DateTimeWithLocalTZ}
       {:semantic_type :type/UpdatedTimestamp,
        :unit :default,
        :name ""updated_at"",
        :field_ref [:field 210 {:temporal-unit :default}],
        :effective_type :type/DateTimeWithLocalTZ,
        :id 210,
        :visibility_type :normal,
        :display_name ""Updated At"",
        :base_type :type/DateTimeWithLocalTZ}
       {:semantic_type :type/Name,
        :name ""name"",
        :field_ref [:field 208 nil],
        :effective_type :type/Text,
        :id 208,
        :visibility_type :normal,
        :display_name ""Name"",
        :base_type :type/Text}
       {:semantic_type :type/Name,
        :name ""display_name"",
        :field_ref [:field 209 nil],
        :effective_type :type/Text,
        :id 209,
        :visibility_type :normal,
        :display_name ""Display Name"",
        :base_type :type/Text}
       {:semantic_type :type/Description,
        :name ""description"",
        :field_ref [:field 207 nil],
        :effective_type :type/Text,
        :id 207,
        :visibility_type :normal,
        :display_name ""Description"",
        :base_type :type/Text}
       {:description ""True if table is available in the data source. False if it not found in sync anymore."",
        :semantic_type :type/Category,
        :name ""active"",
        :field_ref [:field 214 nil],
        :effective_type :type/Boolean,
        :id 214,
        :visibility_type :normal,
        :display_name ""Active"",
        :base_type :type/Boolean}
       {:semantic_type :type/FK,
        :name ""database_id"",
        :fk_target_field_id 1559,
        :field_ref [:field 215 nil],
        :effective_type :type/Integer,
        :id 215,
        :visibility_type :normal,
        :display_name ""Database ID"",
        :base_type :type/Integer}
       {:name ""schema"",
        :field_ref [:field 212 nil],
        :effective_type :type/Text,
        :id 212,
        :visibility_type :normal,
        :display_name ""Schema"",
        :base_type :type/Text}
       {:semantic_type :type/Category,
        :name ""is_upload"",
        :field_ref [:field 213 nil],
        :effective_type :type/Boolean,
        :id 213,
        :visibility_type :normal,
        :display_name ""Is Upload"",
        :base_type :type/Boolean}],
      :query-hash #object[""[B"" 0x1c46c1af ""[B@1c46c1af""]}},
    :type :qp}}],
 :action_id nil,
 :error_type :invalid-query,
 :json_query
 {:database 13371337,
  :query {:aggregation [[""distinct"" [""field"" 1559 {:source-field 215}]]], :source-table ""card__28""},
  :type ""query"",
  :parameters [],
  :middleware {:js-int-to-string? true, :add-default-userland-constraints? true}},
 :native nil,
 :status :failed,
 :class clojure.lang.ExceptionInfo,
 :stacktrace
 [""--> query_processor.store$missing_bulk_metadata_error.invokeStatic(store.clj:182)""
  ""query_processor.store$missing_bulk_metadata_error.invoke(store.clj:181)""
  ""query_processor.store$bulk_metadata$fn__50919.invoke(store.clj:221)""
  ""query_processor.store$bulk_metadata.invokeStatic(store.clj:219)""
  ""query_processor.store$bulk_metadata.invoke(store.clj:189)""
  ""query_processor.middleware.resolve_fields$resolve_fields_with_ids_BANG_.invokeStatic(resolve_fields.clj:13)""
  ""query_processor.middleware.resolve_fields$resolve_fields_with_ids_BANG_.invoke(resolve_fields.clj:11)""
  ""query_processor.middleware.resolve_fields$resolve_fields.invokeStatic(resolve_fields.clj:30)""
  ""query_processor.middleware.resolve_fields$resolve_fields.invoke(resolve_fields.clj:22)""
  ""query_processor.middleware.upgrade_field_literals$upgrade_field_literals.invokeStatic(upgrade_field_literals.clj:109)""
  ""query_processor.middleware.upgrade_field_literals$upgrade_field_literals.invoke(upgrade_field_literals.clj:91)""
  ""query_processor$preprocess_STAR_$fn__73403.invoke(query_processor.clj:164)""
  ""query_processor$preprocess_STAR_.invokeStatic(query_processor.clj:162)""
  ""query_processor$preprocess_STAR_.invoke(query_processor.clj:157)""
  ""query_processor$fn__73411$combined_pre_process__73412$combined_pre_process_STAR___73413.invoke(query_processor.clj:259)""
  ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66697.invoke(fetch_source_query.clj:299)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72154$fn__72158.invoke(resolve_database_and_driver.clj:77)""
  ""driver$do_with_driver.invokeStatic(driver.clj:97)""
  ""driver$do_with_driver.invoke(driver.clj:92)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72154.invoke(resolve_database_and_driver.clj:76)""
  ""query_processor.middleware.store$initialize_store$fn__67324$fn__67325.invoke(store.clj:14)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.middleware.store$initialize_store$fn__67324.invoke(store.clj:13)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72151.invoke(resolve_database_and_driver.clj:60)""
  ""query_processor.middleware.normalize_query$normalize$fn__72456.invoke(normalize_query.clj:38)""
  ""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$fn__79812$handle_audit_app_internal_queries__79813$fn__79815.invoke(handle_audit_queries.clj:142)""
  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72102.invoke(enterprise.clj:103)""
  ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71217.invoke(constraints.clj:104)""
  ""query_processor.middleware.process_userland_query$process_userland_query$fn__72387.invoke(process_userland_query.clj:156)""
  ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72988.invoke(catch_exceptions.clj:171)""
  ""query_processor.reducible$async_qp$qp_STAR___62838$thunk__62840.invoke(reducible.clj:126)""
  ""query_processor.reducible$async_qp$qp_STAR___62838.invoke(reducible.clj:132)""
  ""query_processor.reducible$sync_qp$qp_STAR___62850.doInvoke(reducible.clj:153)""
  ""query_processor$process_userland_query.invokeStatic(query_processor.clj:402)""
  ""query_processor$process_userland_query.doInvoke(query_processor.clj:398)""
  ""query_processor$process_query_and_save_execution_BANG_.invokeStatic(query_processor.clj:416)""
  ""query_processor$process_query_and_save_execution_BANG_.invoke(query_processor.clj:406)""
  ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invokeStatic(query_processor.clj:431)""
  ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invoke(query_processor.clj:421)""
  ""api.dataset$run_query_async$fn__94633.invoke(dataset.clj:79)""
  ""query_processor.streaming$streaming_response_STAR_$fn__53268$fn__53270.invoke(streaming.clj:168)""
  ""query_processor.streaming$streaming_response_STAR_$fn__53268.invoke(streaming.clj:167)""
  ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)""
  ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)""
  ""async.streaming_response$do_f_async$task__43763.invoke(streaming_response.clj:88)""],
 :card_id 28,
 :context :ad-hoc,
 :error ""Failed to fetch :metadata/column 1559"",
 :row_count 0,
 :running_time 0,
 :preprocessed nil,
 :ex-data
 {:status-code 400,
  :type :invalid-query,
  :metadata-provider
  (metabase.lib.metadata.cached-provider/cached-metadata-provider (metabase.lib.metadata.jvm/->UncachedApplicationDatabaseMetadataProvider 13371337)),
  :metadata-type :metadata/column,
  :id 1559},
 :data {:rows [], :cols []}}
```

### Information about your Metabase installation

```JSON
v49.6 with a postgres db
```


### Severity

p3

### Additional context

NA",paoliniluis,2024-04-29 10:17:40+00:00,[],2025-02-04 20:28:43+00:00,,https://github.com/metabase/metabase/issues/41944,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/X-rays', ''), ('.Backend', ''), ('Administration/Usage analytics', 'Pro and Enterprise meta analytics, fka audit'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2268089126,issue,open,,Analyze the evolution of an indicator thoughout,"I would like to analyze the temporal evolution of an indicator. That is to say, For instance, if yesterday, my indicator equaled X and today equals Y. I would like to have a graphic with X and Y as values.

The question may have an option that users can check / uncheck to watch the evolution of this query.
As all queries are not subject to this feature, It could be nice to implement this feature as an option of a query.

An other option may be to put the period time between two registrations of the value of the indicator according to the dynamic of the indicator)",Pierre-PSUD,2024-04-29 04:20:03+00:00,[],2025-02-04 20:31:02+00:00,,https://github.com/metabase/metabase/issues/41938,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2082122094, 'issue_id': 2268089126, 'author': 'paoliniluis', 'body': 'you mean like a period-over-period indicator?', 'created_at': datetime.datetime(2024, 4, 29, 8, 12, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2083637260, 'issue_id': 2268089126, 'author': 'Pierre-PSUD', 'body': ""Well, I don't think it is a period-over-period. I mean, I want to analyze the evolution of the indicator itself.\r\n\r\nFor instance, my indicator counts the number of inhabitants in a city.\r\n(on my dashboard, I only see my indicator displaying one single figure : the number of inhabitants)\r\nMonth 1 : 1000\r\nMonth 2 : 1500\r\nMonth 3 : 1750\r\nMonth 4 : 1780\r\nMonth 5 : 2000\r\n\r\nAfter five months, I would like to analyze the evolution of the number of inhabitants in my city. The feature may then create a chart with the number of inhabitants (y values) and the months (x values).\r\n\r\nThe month-over-month period would have count the number of new inhabitants each month. But this is not what I want here. (It is possible I believe in Métabase yet).\r\n\r\nIs it clearer ? Thank you"", 'created_at': datetime.datetime(2024, 4, 29, 20, 49, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2567869835, 'issue_id': 2268089126, 'author': 'brunobergher', 'body': ""@Pierre-PSUD are you talking about snapshotting the value of a given metric at certain intervals and automatically creating a visualization of that number over time, when you're not able to calculate it yourself from historical data?"", 'created_at': datetime.datetime(2025, 1, 2, 14, 35, 46, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-29 08:12:35 UTC): you mean like a period-over-period indicator?

Pierre-PSUD (Issue Creator) on (2024-04-29 20:49:06 UTC): Well, I don't think it is a period-over-period. I mean, I want to analyze the evolution of the indicator itself.

For instance, my indicator counts the number of inhabitants in a city.
(on my dashboard, I only see my indicator displaying one single figure : the number of inhabitants)
Month 1 : 1000
Month 2 : 1500
Month 3 : 1750
Month 4 : 1780
Month 5 : 2000

After five months, I would like to analyze the evolution of the number of inhabitants in my city. The feature may then create a chart with the number of inhabitants (y values) and the months (x values).

The month-over-month period would have count the number of new inhabitants each month. But this is not what I want here. (It is possible I believe in Métabase yet).

Is it clearer ? Thank you

brunobergher on (2025-01-02 14:35:46 UTC): @Pierre-PSUD are you talking about snapshotting the value of a given metric at certain intervals and automatically creating a visualization of that number over time, when you're not able to calculate it yourself from historical data?

"
2267877264,issue,closed,completed,[FE] Preview of metric should show only 10 rows,,perivamsi,2024-04-28 23:31:13+00:00,['ranquild'],2024-04-30 14:19:29+00:00,2024-04-30 14:19:29+00:00,https://github.com/metabase/metabase/issues/41937,[],[],
2267877220,issue,closed,completed,"[FE] Rename ""edit query definition"" to ""edit metric definition""",,perivamsi,2024-04-28 23:31:06+00:00,['ranquild'],2024-04-30 13:56:07+00:00,2024-04-30 13:56:07+00:00,https://github.com/metabase/metabase/issues/41936,[],[],
2267877178,issue,closed,completed,"[FE] Change the order of aggregatable options (move basic metrics to the bottom, collapse it and move up common metrics, expand it)",,perivamsi,2024-04-28 23:31:00+00:00,['ranquild'],2024-05-02 18:37:06+00:00,2024-05-02 18:37:06+00:00,https://github.com/metabase/metabase/issues/41935,[],[],
2267877133,issue,closed,completed,[FE] The icon for a metric is incorrect in search results,Blocked by https://github.com/metabase/metabase/issues/41993,perivamsi,2024-04-28 23:30:53+00:00,['ranquild'],2024-04-30 13:56:10+00:00,2024-04-30 13:56:10+00:00,https://github.com/metabase/metabase/issues/41934,[],[],
2267877088,issue,closed,completed,[FE] Clearly define the constraints in metric aggregations and the user feedback when you can't save,,perivamsi,2024-04-28 23:30:46+00:00,['ranquild'],2024-04-30 15:44:50+00:00,2024-04-30 15:44:50+00:00,https://github.com/metabase/metabase/issues/41933,[],[],
2267877037,issue,closed,completed,[BE] Add newly joined metrics in the aggregation clause,,perivamsi,2024-04-28 23:30:36+00:00,['snoe'],2024-05-08 17:50:32+00:00,2024-05-08 17:50:32+00:00,https://github.com/metabase/metabase/issues/41932,[],[],
2267876963,issue,closed,completed,[BE] Stage one should show the name of the metric and not the name of the underlying table in joins,,perivamsi,2024-04-28 23:30:27+00:00,['metamben'],2024-05-24 14:10:27+00:00,2024-05-24 14:10:27+00:00,https://github.com/metabase/metabase/issues/41931,[],"[{'comment_id': 2123182401, 'issue_id': 2267876963, 'author': 'metamben', 'body': 'We are not joining metrics ATM.', 'created_at': datetime.datetime(2024, 5, 21, 18, 16, 41, tzinfo=datetime.timezone.utc)}]","metamben (Assginee) on (2024-05-21 18:16:41 UTC): We are not joining metrics ATM.

"
2267876904,issue,closed,completed,[BE] Metrics do not appear in recently viewed,,perivamsi,2024-04-28 23:30:18+00:00,['snoe'],2024-04-29 20:18:11+00:00,2024-04-29 20:18:11+00:00,https://github.com/metabase/metabase/issues/41930,[],"[{'comment_id': 2083588931, 'issue_id': 2267876904, 'author': 'snoe', 'body': 'This should be fixed by #41993', 'created_at': datetime.datetime(2024, 4, 29, 20, 18, 11, tzinfo=datetime.timezone.utc)}]","snoe (Assginee) on (2024-04-29 20:18:11 UTC): This should be fixed by #41993

"
2267876864,issue,closed,completed,[BE] Renaming a metric does not work,,perivamsi,2024-04-28 23:30:12+00:00,['metamben'],2024-04-30 15:33:10+00:00,2024-04-30 15:33:10+00:00,https://github.com/metabase/metabase/issues/41929,[],"[{'comment_id': 2083505719, 'issue_id': 2267876864, 'author': 'ranquild', 'body': 'Seems to be a BE bug \r\n<img width=""761"" alt=""Screenshot 2024-04-29 at 15 29 25"" src=""https://github.com/metabase/metabase/assets/8542534/491c323f-a07a-43b2-8ef0-b1f148a369b1"">', 'created_at': datetime.datetime(2024, 4, 29, 19, 29, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2083637986, 'issue_id': 2267876864, 'author': 'metamben', 'body': 'Seems to work for me: https://metaboat.slack.com/files/U03AN4TRM6Y/F0710H53ATY/metric-rename.mov', 'created_at': datetime.datetime(2024, 4, 29, 20, 49, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2085684252, 'issue_id': 2267876864, 'author': 'metamben', 'body': 'This should be fixed now on `metrics-v2`.', 'created_at': datetime.datetime(2024, 4, 30, 15, 33, 10, tzinfo=datetime.timezone.utc)}]","ranquild on (2024-04-29 19:29:40 UTC): Seems to be a BE bug 
<img width=""761"" alt=""Screenshot 2024-04-29 at 15 29 25"" src=""https://github.com/metabase/metabase/assets/8542534/491c323f-a07a-43b2-8ef0-b1f148a369b1"">

metamben (Assginee) on (2024-04-29 20:49:30 UTC): Seems to work for me: https://metaboat.slack.com/files/U03AN4TRM6Y/F0710H53ATY/metric-rename.mov

metamben (Assginee) on (2024-04-30 15:33:10 UTC): This should be fixed now on `metrics-v2`.

"
2267876829,issue,closed,completed,[BE] The run button (play icon) should only be enabled when the save button gets enabled,,perivamsi,2024-04-28 23:30:05+00:00,['metamben'],2024-04-30 15:36:04+00:00,2024-04-30 15:36:04+00:00,https://github.com/metabase/metabase/issues/41928,[],"[{'comment_id': 2083543357, 'issue_id': 2267876829, 'author': 'ranquild', 'body': '@snoe @metamben `can-run` needs to be updated to check for metrics. Effectively we would need to move the last stage checks from `can-save` to `can-run`.', 'created_at': datetime.datetime(2024, 4, 29, 19, 52, 48, tzinfo=datetime.timezone.utc)}]","ranquild on (2024-04-29 19:52:48 UTC): @snoe @metamben `can-run` needs to be updated to check for metrics. Effectively we would need to move the last stage checks from `can-save` to `can-run`.

"
2267876320,issue,closed,completed,[FE] UI changes to the QB for new metric,"These are all label/text changes to the query builder when the user does New > Metric

- Add `(optional)` to filters
- `Measure calculation` instead of `Summarize`
- Remove the `by` in the breakout

These are more involved changes that need additional details from the product side and probably should be spun off as separate issues
- `Primary time dimension` instead of nothing in the breakout
- Add the sidebar with the instruction (this needs to be spec-ed out)",perivamsi,2024-04-28 23:28:22+00:00,['ranquild'],2024-04-30 18:43:29+00:00,2024-04-30 18:43:29+00:00,https://github.com/metabase/metabase/issues/41927,[],"[{'comment_id': 2082791290, 'issue_id': 2267876320, 'author': 'luizarakaki', 'body': '`Primary time dimension` instead of nothing in the breakout\r\n\r\nThis requires new design input, as now it is possible to add multiple non-time dimensions there', 'created_at': datetime.datetime(2024, 4, 29, 13, 42, 24, tzinfo=datetime.timezone.utc)}]","luizarakaki on (2024-04-29 13:42:24 UTC): `Primary time dimension` instead of nothing in the breakout

This requires new design input, as now it is possible to add multiple non-time dimensions there

"
2267677975,issue,closed,completed,Can't print the full public dashboard,"### Describe the bug

I upgraded our metabase from 47.13 to 49.6.

Previously when displaying a public dashboard with a very long table so it could fit a table of 100 rows, when pressing Control + P, I could print the full length of the result. After the upgrade, I only can print the info that I'm looking not the full generated answers, like 20 rows.
<img width=""971"" alt=""Captura de pantalla 2024-04-28 a las 18 50 25"" src=""https://github.com/metabase/metabase/assets/10385633/b1317e06-5065-49fa-bf5b-044ab7e87229"">


### To Reproduce

1. Go to a public dashboard or question with a table with 100 rows
2. Click on Control + P in other to print



### Expected behavior

Multiple print pages are generated

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""es-ES"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.133+"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Madrid""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""oracle"",
      ""bigquery-cloud-sdk""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""13.13""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v0.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Madrid""
    }
  }
}
```


### Severity

annoying

### Additional context

_No response_",watollop,2024-04-28 16:51:08+00:00,['kulyk'],2024-08-16 09:18:30+00:00,2024-08-16 09:18:15+00:00,https://github.com/metabase/metabase/issues/41926,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('Sharing/Public', '')]","[{'comment_id': 2081553555, 'issue_id': 2267677975, 'author': 'paoliniluis', 'body': 'Hi, printing the page has always printed what you see, how is it able that you were able to see all the results?', 'created_at': datetime.datetime(2024, 4, 28, 16, 52, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2081555092, 'issue_id': 2267677975, 'author': 'watollop', 'body': 'Hi!, I used to create a dashboard with a very long table so it does not paginate, and then I could print all the rendered answers.', 'created_at': datetime.datetime(2024, 4, 28, 16, 57, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2082864485, 'issue_id': 2267677975, 'author': 'zbodi74', 'body': 'Confirmed for version 49.6. To reproduce the issue, add a table visualization to a dashboard and resize it to be very tall, extending it by scrolling down several screens. Then, share the dashboard publicly and compare the print previews of both the internal and shared versions. \r\nThe shared version will only have the first page in the print preview.', 'created_at': datetime.datetime(2024, 4, 29, 14, 11, 45, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-28 16:52:30 UTC): Hi, printing the page has always printed what you see, how is it able that you were able to see all the results?

watollop (Issue Creator) on (2024-04-28 16:57:37 UTC): Hi!, I used to create a dashboard with a very long table so it does not paginate, and then I could print all the rendered answers.

zbodi74 on (2024-04-29 14:11:45 UTC): Confirmed for version 49.6. To reproduce the issue, add a table visualization to a dashboard and resize it to be very tall, extending it by scrolling down several screens. Then, share the dashboard publicly and compare the print previews of both the internal and shared versions. 
The shared version will only have the first page in the print preview.

"
2266971557,issue,closed,not_planned,FE won't load the full query builder when using metabase analytics model,"### Describe the bug

Seems like a race condition in the frontend that doesn't load the full query builder on the first attempt
![image](https://github.com/metabase/metabase/assets/1711649/afa30a18-1044-46f2-b5d0-6b051d123952)

The workaround is to click the model name and select it again
![weird](https://github.com/metabase/metabase/assets/1711649/6c920f91-59d7-4610-bf61-c1ab1247fb25)

### To Reproduce

1) start metabase
2) go to new->question-> select any metabase analytics model

### Expected behavior

it should work straight from the first try

### Logs

NA

### Information about your Metabase installation

```JSON
v49
```


### Severity

P3

### Additional context

_No response_",paoliniluis,2024-04-27 11:22:11+00:00,[],2024-07-01 15:33:34+00:00,2024-06-26 09:51:49+00:00,https://github.com/metabase/metabase/issues/41925,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/Notebook', 'Items specific to the Custom/Notebook query builder'), ('.Team/Querying', '')]","[{'comment_id': 2191282482, 'issue_id': 2266971557, 'author': 'nemanjaglumac', 'body': 'Duplicate of #43088', 'created_at': datetime.datetime(2024, 6, 26, 9, 51, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2200472685, 'issue_id': 2266971557, 'author': 'darksciencebase', 'body': '@nemanjaglumac thanks for cleaning this up. please close duplicate issues with ""Close as not planned"", and not ""Close as completed"", it helps with the accuracy of the alert on the #engineering channel.', 'created_at': datetime.datetime(2024, 7, 1, 15, 33, 34, tzinfo=datetime.timezone.utc)}]","nemanjaglumac on (2024-06-26 09:51:49 UTC): Duplicate of #43088

darksciencebase on (2024-07-01 15:33:34 UTC): @nemanjaglumac thanks for cleaning this up. please close duplicate issues with ""Close as not planned"", and not ""Close as completed"", it helps with the accuracy of the alert on the #engineering channel.

"
2266875637,issue,closed,completed,Fail during upgrade from 48.3 to 49.7,"### Describe the bug

Hello! We use Metabase 0.48.3 with MariaDB 10.5 and have tried to update to the 0.49.7 version. During the updating process we got the migration error: `Limit of 32 on JSON nested strucures depth is reached in argument 1 to function 'json_extract'`. 

As i got right the error refer to MariaDB. We found several issues with such problem: 
https://jira.mariadb.org/browse/MDEV-30343
https://jira.mariadb.org/browse/MDEV-33437
In the new version of MariaDB this problem can be solved by new parameter - https://jira.mariadb.org/browse/MDEV-32854.

But the documentation says MariaDB 10.2 supported and migration process should be done without errors. 

### To Reproduce

Try to update the Metabase from 48.3 to 49.7.

### Expected behavior

Migrations should be done without errors.

### Logs

```
2024-04-27 09:33:49,912 ERROR liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-01-22T11:52:00::qnkhuat encountered an exception.

UPDATE SUMMARY
Run:                         19
Previously run:             262
Filtered out:                 5
-------------------------------
Total change sets:          286


FILTERED CHANGE SETS SUMMARY
DBMS mismatch:                5

2024-04-27 09:33:50,809 ERROR metabase.core :: Metabase Initialization FAILED
liquibase.exception.CommandExecutionException: liquibase.exception.LiquibaseException: liquibase.exception.MigrationFailedException: Migration failed for changeset migrations/001_update_migrations.yaml::v49.2024-01-22T11:52:00::qnkhuat:
     Reason: clojure.lang.ExceptionInfo: (conn=23045451) Limit of 32 on JSON nested strucures depth is reached in argument 1 to function 'json_extract' at position 1375 {:toucan2/context-trace [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"" {:toucan2.jdbc.query/sql-args [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""resolve connection"" {:toucan2.connection/connectable org.mariadb.jdbc.MariaDbConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}] {:toucan2.pipeline/rf #object[clojure.core$map$fn__5931$fn__5932 0x32fe84a5 ""clojure.core$map$fn__5931$fn__5932@32fe84a5""]} [""with compiled query"" {:toucan2.pipeline/compiled-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with built query"" {:toucan2.pipeline/built-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with resolved query"" {:toucan2.pipeline/resolved-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with parsed args"" {:toucan2.pipeline/query-type :toucan.result-type/*, :toucan2.pipeline/parsed-args {:connectable nil, :queryable [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}}] [""with model"" {:toucan2.pipeline/model nil}] [""resolve connection"" {:toucan2.connection/connectable org.mariadb.jdbc.MariaDbConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}
        at liquibase.command.CommandScope.execute(CommandScope.java:253)
        at liquibase.Liquibase.lambda$update$0(Liquibase.java:245)
        at liquibase.Scope.lambda$child$0(Scope.java:186)
        at liquibase.Scope.child(Scope.java:195)
        at liquibase.Scope.child(Scope.java:185)
        at liquibase.Scope.child(Scope.java:164)
        at liquibase.Liquibase.runInScope(Liquibase.java:1419)
        at liquibase.Liquibase.update(Liquibase.java:234)
        at liquibase.Liquibase.update(Liquibase.java:212)
        at liquibase.Liquibase.update(Liquibase.java:194)
        at metabase.db.liquibase$migrate_up_if_needed_BANG_.invokeStatic(liquibase.clj:305)
        at metabase.db.liquibase$migrate_up_if_needed_BANG_.invoke(liquibase.clj:287)
        at metabase.db.setup$migrate_BANG_$fn__51104.invoke(setup.clj:80)
        at metabase.db.liquibase$do_with_liquibase$f_STAR___48780.invoke(liquibase.clj:139)
        at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:142)
        at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:130)
        at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)
        at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)
        at clojure.lang.RestFn.invoke(RestFn.java:445)
        at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:147)
        at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:141)
        at metabase.db.setup$setup_db_BANG_$fn__51132$fn__51133.invoke(setup.clj:165)
        at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)
        at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)
        at metabase.db.setup$setup_db_BANG_$fn__51132.invoke(setup.clj:160)
        at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:159)
        at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:153)
        at metabase.db$setup_db_BANG_$fn__51152.invoke(db.clj:69)
        at metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)
        at metabase.db$setup_db_BANG_.invoke(db.clj:55)
        at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:116)
        at metabase.core$init_BANG__STAR_.invoke(core.clj:101)
        at metabase.core$init_BANG_.invokeStatic(core.clj:159)
        at metabase.core$init_BANG_.invoke(core.clj:154)
        at metabase.core$start_normally.invokeStatic(core.clj:171)
        at metabase.core$start_normally.invoke(core.clj:165)
        at metabase.core$entrypoint.invokeStatic(core.clj:204)
        at metabase.core$entrypoint.doInvoke(core.clj:198)
        at clojure.lang.RestFn.invoke(RestFn.java:397)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.Var.applyTo(Var.java:705)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
        at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
        at clojure.lang.RestFn.invoke(RestFn.java:397)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at metabase.bootstrap.main(Unknown Source)
Caused by: liquibase.exception.LiquibaseException: liquibase.exception.MigrationFailedException: Migration failed for changeset migrations/001_update_migrations.yaml::v49.2024-01-22T11:52:00::qnkhuat:
     Reason: clojure.lang.ExceptionInfo: (conn=23045451) Limit of 32 on JSON nested strucures depth is reached in argument 1 to function 'json_extract' at position 1375 {:toucan2/context-trace [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"" {:toucan2.jdbc.query/sql-args [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""resolve connection"" {:toucan2.connection/connectable org.mariadb.jdbc.MariaDbConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}] {:toucan2.pipeline/rf #object[clojure.core$map$fn__5931$fn__5932 0x32fe84a5 ""clojure.core$map$fn__5931$fn__5932@32fe84a5""]} [""with compiled query"" {:toucan2.pipeline/compiled-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with built query"" {:toucan2.pipeline/built-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with resolved query"" {:toucan2.pipeline/resolved-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with parsed args"" {:toucan2.pipeline/query-type :toucan.result-type/*, :toucan2.pipeline/parsed-args {:connectable nil, :queryable [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}}] [""with model"" {:toucan2.pipeline/model nil}] [""resolve connection"" {:toucan2.connection/connectable org.mariadb.jdbc.MariaDbConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}
        at liquibase.changelog.ChangeLogIterator.run(ChangeLogIterator.java:151)
        at liquibase.command.core.AbstractUpdateCommandStep.lambda$run$0(AbstractUpdateCommandStep.java:110)
        at liquibase.Scope.lambda$child$0(Scope.java:186)
        at liquibase.Scope.child(Scope.java:195)
        at liquibase.Scope.child(Scope.java:185)
        at liquibase.Scope.child(Scope.java:164)
        at liquibase.command.core.AbstractUpdateCommandStep.run(AbstractUpdateCommandStep.java:108)
        at liquibase.command.core.UpdateCommandStep.run(UpdateCommandStep.java:105)
        at liquibase.command.CommandScope.execute(CommandScope.java:217)
        ... 49 more
Caused by: liquibase.exception.MigrationFailedException: Migration failed for changeset migrations/001_update_migrations.yaml::v49.2024-01-22T11:52:00::qnkhuat:
     Reason: clojure.lang.ExceptionInfo: (conn=23045451) Limit of 32 on JSON nested strucures depth is reached in argument 1 to function 'json_extract' at position 1375 {:toucan2/context-trace [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"" {:toucan2.jdbc.query/sql-args [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""resolve connection"" {:toucan2.connection/connectable org.mariadb.jdbc.MariaDbConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}] {:toucan2.pipeline/rf #object[clojure.core$map$fn__5931$fn__5932 0x32fe84a5 ""clojure.core$map$fn__5931$fn__5932@32fe84a5""]} [""with compiled query"" {:toucan2.pipeline/compiled-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with built query"" {:toucan2.pipeline/built-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with resolved query"" {:toucan2.pipeline/resolved-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with parsed args"" {:toucan2.pipeline/query-type :toucan.result-type/*, :toucan2.pipeline/parsed-args {:connectable nil, :queryable [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}}] [""with model"" {:toucan2.pipeline/model nil}] [""resolve connection"" {:toucan2.connection/connectable org.mariadb.jdbc.MariaDbConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}
        at liquibase.changelog.ChangeSet.execute(ChangeSet.java:797)
        at liquibase.changelog.visitor.UpdateVisitor.executeAcceptedChange(UpdateVisitor.java:119)
        at liquibase.changelog.visitor.UpdateVisitor.visit(UpdateVisitor.java:68)
        at liquibase.changelog.ChangeLogIterator$2.lambda$run$0(ChangeLogIterator.java:133)
        at liquibase.Scope.lambda$child$0(Scope.java:186)
        at liquibase.Scope.child(Scope.java:195)
        at liquibase.Scope.child(Scope.java:185)
        at liquibase.Scope.child(Scope.java:164)
        at liquibase.changelog.ChangeLogIterator$2.run(ChangeLogIterator.java:122)
        at liquibase.Scope.lambda$child$0(Scope.java:186)
        at liquibase.Scope.child(Scope.java:195)
        at liquibase.Scope.child(Scope.java:185)
        at liquibase.Scope.child(Scope.java:164)
        at liquibase.Scope.child(Scope.java:252)
        at liquibase.Scope.child(Scope.java:256)
        at liquibase.changelog.ChangeLogIterator.run(ChangeLogIterator.java:89)
        ... 57 more
Caused by: clojure.lang.ExceptionInfo: (conn=23045451) Limit of 32 on JSON nested strucures depth is reached in argument 1 to function 'json_extract' at position 1375 {:toucan2/context-trace [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"" {:toucan2.jdbc.query/sql-args [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""resolve connection"" {:toucan2.connection/connectable org.mariadb.jdbc.MariaDbConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}] {:toucan2.pipeline/rf #object[clojure.core$map$fn__5931$fn__5932 0x32fe84a5 ""clojure.core$map$fn__5931$fn__5932@32fe84a5""]} [""with compiled query"" {:toucan2.pipeline/compiled-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with built query"" {:toucan2.pipeline/built-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with resolved query"" {:toucan2.pipeline/resolved-query [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}] [""with parsed args"" {:toucan2.pipeline/query-type :toucan.result-type/*, :toucan2.pipeline/parsed-args {:connectable nil, :queryable [""UPDATE revision\n               SET object = JSON_SET(\n                   object,\n                   '$.type',\n                   CASE\n                       WHEN JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) = 'true' THEN 'model'\n                       ELSE 'question'\n                   END)\n               WHERE model = 'Card' AND JSON_UNQUOTE(JSON_EXTRACT(object, '$.dataset')) IS NOT NULL;;""]}}] [""with model"" {:toucan2.pipeline/model nil}] [""resolve connection"" {:toucan2.connection/connectable org.mariadb.jdbc.MariaDbConnection}] [""resolve connection"" {:toucan2.connection/connectable nil}]]}
        at org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory.createException(ExceptionFactory.java:79)
        at org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory.create(ExceptionFactory.java:158)
        at org.mariadb.jdbc.MariaDbStatement.executeExceptionEpilogue(MariaDbStatement.java:262)
        at org.mariadb.jdbc.ClientSidePreparedStatement.executeInternal(ClientSidePreparedStatement.java:229)
        at org.mariadb.jdbc.ClientSidePreparedStatement.execute(ClientSidePreparedStatement.java:149)
        at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.execute(NewProxyPreparedStatement.java:67)
        at toucan2.jdbc.query$reduce_jdbc_query.invokeStatic(query.clj:40)
        at toucan2.jdbc.query$reduce_jdbc_query.invoke(query.clj:22)
        at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invokeStatic(pipeline.clj:19)
        at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invoke(pipeline.clj:9)
        at clojure.lang.AFn.applyToHelper(AFn.java:178)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.applyTo(RestFn.java:137)
        at clojure.core$apply.invokeStatic(core.clj:675)
        at clojure.core$partial$fn__5908.doInvoke(core.clj:2639)
        at clojure.lang.RestFn.applyTo(RestFn.java:146)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.applyTo(RestFn.java:137)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18237.invoke(threaded.clj:79)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203.invoke(threaded.clj:23)
        at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
        at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
        at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
        at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
        at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
        at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
        at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
        at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
        at clojure.core$reduce.invokeStatic(core.clj:6887)
        at clojure.core$reduce.invoke(core.clj:6869)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199.invoke(threaded.clj:21)
        at clojure.core$comp$fn__5876.doInvoke(core.clj:2589)
        at clojure.lang.RestFn.applyTo(RestFn.java:146)
        at clojure.core$apply.invokeStatic(core.clj:675)
        at clojure.core$apply.doInvoke(core.clj:662)
        at clojure.lang.RestFn.invoke(RestFn.java:533)
        at methodical.impl.combo.threaded$combine_with_threader$fn__18209.doInvoke(threaded.clj:46)
        at clojure.lang.RestFn.applyTo(RestFn.java:151)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.applyTo(RestFn.java:137)
        at clojure.core$apply.invokeStatic(core.clj:675)
        at clojure.core$apply.doInvoke(core.clj:662)
        at clojure.lang.RestFn.invoke(RestFn.java:533)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65)
        at methodical.impl.standard$invoke_multifn.doInvoke(standard.clj:47)
        at clojure.lang.RestFn.invoke(RestFn.java:594)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:199)
        at toucan2.pipeline$transduce_execute$with_connection_STAR___21462.invoke(pipeline.clj:78)
        at toucan2.connection$bind_current_connectable_fn$fn__21139.invoke(connection.clj:104)
        at toucan2.connection$bind_current_connectable_fn$fn__21139.invoke(connection.clj:104)
        at toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invokeStatic(connection.clj:13)
        at toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invoke(connection.clj:11)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at clojure.core$partial$fn__5908.invoke(core.clj:2642)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18231.invoke(threaded.clj:70)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203.invoke(threaded.clj:23)
        at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
        at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
        at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
        at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
        at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
        at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
        at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
        at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
        at clojure.core$reduce.invokeStatic(core.clj:6887)
        at clojure.core$reduce.invoke(core.clj:6869)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199.invoke(threaded.clj:21)
        at clojure.core$comp$fn__5876.invoke(core.clj:2587)
        at methodical.impl.combo.threaded$combine_with_threader$fn__18209.invoke(threaded.clj:43)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at clojure.core$partial$fn__5908.invoke(core.clj:2642)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193)
        at toucan2.connection$do_with_connection_primary_method_.invokeStatic(connection.clj:204)
        at toucan2.connection$do_with_connection_primary_method_.invoke(connection.clj:194)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at clojure.core$partial$fn__5908.invoke(core.clj:2642)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18231.invoke(threaded.clj:70)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203.invoke(threaded.clj:23)
        at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
        at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
        at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
        at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
        at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
        at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
        at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
        at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
        at clojure.core$reduce.invokeStatic(core.clj:6887)
        at clojure.core$reduce.invoke(core.clj:6869)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199.invoke(threaded.clj:21)
        at clojure.core$comp$fn__5876.invoke(core.clj:2587)
        at methodical.impl.combo.threaded$combine_with_threader$fn__18209.invoke(threaded.clj:43)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at clojure.core$partial$fn__5908.invoke(core.clj:2642)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193)
        at toucan2.pipeline$transduce_execute.invokeStatic(pipeline.clj:77)
        at toucan2.pipeline$transduce_execute.invoke(pipeline.clj:64)
        at clojure.lang.Var.invoke(Var.java:399)
        at toucan2.pipeline$transduce_compiled_query.invokeStatic(pipeline.clj:244)
        at toucan2.pipeline$transduce_compiled_query.invoke(pipeline.clj:240)
        at toucan2.pipeline$transduce_built_query.invokeStatic(pipeline.clj:252)
        at toucan2.pipeline$transduce_built_query.invoke(pipeline.clj:246)
        at toucan2.pipeline$transduce_query_primary_method_default.invokeStatic(pipeline.clj:272)
        at toucan2.pipeline$transduce_query_primary_method_default.invoke(pipeline.clj:269)
        at clojure.lang.AFn.applyToHelper(AFn.java:178)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.applyTo(RestFn.java:137)
        at clojure.core$apply.invokeStatic(core.clj:675)
        at clojure.core$partial$fn__5908.doInvoke(core.clj:2639)
        at clojure.lang.RestFn.applyTo(RestFn.java:146)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.applyTo(RestFn.java:137)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18237.invoke(threaded.clj:79)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203.invoke(threaded.clj:23)
        at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
        at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
        at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
        at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
        at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
        at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
        at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
        at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
        at clojure.core$reduce.invokeStatic(core.clj:6887)
        at clojure.core$reduce.invoke(core.clj:6869)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199.invoke(threaded.clj:21)
        at clojure.core$comp$fn__5876.doInvoke(core.clj:2589)
        at clojure.lang.RestFn.applyTo(RestFn.java:146)
        at clojure.core$apply.invokeStatic(core.clj:675)
        at clojure.core$apply.doInvoke(core.clj:662)
        at clojure.lang.RestFn.invoke(RestFn.java:533)
        at methodical.impl.combo.threaded$combine_with_threader$fn__18209.doInvoke(threaded.clj:46)
        at clojure.lang.RestFn.applyTo(RestFn.java:151)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.applyTo(RestFn.java:137)
        at clojure.core$apply.invokeStatic(core.clj:675)
        at clojure.core$apply.doInvoke(core.clj:662)
        at clojure.lang.RestFn.invoke(RestFn.java:533)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65)
        at methodical.impl.standard$invoke_multifn.doInvoke(standard.clj:47)
        at clojure.lang.RestFn.invoke(RestFn.java:594)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:199)
        at toucan2.pipeline$transduce_query_STAR_.invokeStatic(pipeline.clj:278)
        at toucan2.pipeline$transduce_query_STAR_.invoke(pipeline.clj:274)
        at toucan2.pipeline$transduce_with_model.invokeStatic(pipeline.clj:293)
        at toucan2.pipeline$transduce_with_model.invoke(pipeline.clj:280)
        at toucan2.pipeline$transduce_parsed.invokeStatic(pipeline.clj:309)
        at toucan2.pipeline$transduce_parsed.invoke(pipeline.clj:295)
        at toucan2.execute$fn__21578.invokeStatic(execute.clj:79)
        at toucan2.execute$fn__21578.invoke(execute.clj:77)
        at toucan2.execute$query_STAR_$query_STAR__STAR___21575.invoke(execute.clj:39)
        at toucan2.execute$query_STAR_$query_STAR__STAR___21575.invoke(execute.clj:33)
        at toucan2.execute$query_STAR_$query_STAR__STAR___21575.invoke(execute.clj:28)
        at toucan2.execute$query_STAR_$query_STAR__STAR___21575.invoke(execute.clj:25)
        at metabase.db.custom_migrations.CardRevisionAddType$with_connection_STAR___48530$with_transaction_STAR___48531.invoke(custom_migrations.clj:1011)
        at toucan2.connection$bind_current_connectable_fn$fn__21139.invoke(connection.clj:104)
        at metabase.db.connection$do_transaction$thunk__32319.invoke(connection.clj:150)
        at metabase.db.connection$do_transaction.invokeStatic(connection.clj:165)
        at metabase.db.connection$do_transaction.invoke(connection.clj:146)
        at metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invokeStatic(connection.clj:199)
        at metabase.db.connection$do_with_transaction_primary_method_java_sql_Connection.invoke(connection.clj:172)
        at clojure.lang.AFn.applyToHelper(AFn.java:165)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:457)
        at clojure.core$partial$fn__5908.invoke(core.clj:2643)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18233.invoke(threaded.clj:71)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203.invoke(threaded.clj:23)
        at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
        at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
        at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
        at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
        at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
        at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
        at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
        at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
        at clojure.core$reduce.invokeStatic(core.clj:6887)
        at clojure.core$reduce.invoke(core.clj:6869)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199.invoke(threaded.clj:21)
        at clojure.core$comp$fn__5876.invoke(core.clj:2588)
        at methodical.impl.combo.threaded$combine_with_threader$fn__18209.invoke(threaded.clj:44)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invokeStatic(connection.clj:249)
        at toucan2.connection$do_with_transaction_around_method_toucan2_connection_default.invoke(connection.clj:245)
        at clojure.lang.AFn.applyToHelper(AFn.java:165)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:457)
        at clojure.core$partial$fn__5908.invoke(core.clj:2643)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:58)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:195)
        at metabase.db.custom_migrations.CardRevisionAddType$with_connection_STAR___48530.invoke(custom_migrations.clj:996)
        at toucan2.connection$bind_current_connectable_fn$fn__21139.invoke(connection.clj:104)
        at toucan2.connection$bind_current_connectable_fn$fn__21139.invoke(connection.clj:104)
        at toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invokeStatic(connection.clj:13)
        at toucan2.jdbc.connection$do_with_connection_primary_method_java_sql_Connection.invoke(connection.clj:11)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at clojure.core$partial$fn__5908.invoke(core.clj:2642)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18231.invoke(threaded.clj:70)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203.invoke(threaded.clj:23)
        at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
        at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
        at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
        at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
        at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
        at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
        at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
        at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
        at clojure.core$reduce.invokeStatic(core.clj:6887)
        at clojure.core$reduce.invoke(core.clj:6869)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199.invoke(threaded.clj:21)
        at clojure.core$comp$fn__5876.invoke(core.clj:2587)
        at methodical.impl.combo.threaded$combine_with_threader$fn__18209.invoke(threaded.clj:43)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at clojure.core$partial$fn__5908.invoke(core.clj:2642)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193)
        at toucan2.connection$do_with_connection_primary_method_.invokeStatic(connection.clj:204)
        at toucan2.connection$do_with_connection_primary_method_.invoke(connection.clj:194)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at clojure.core$partial$fn__5908.invoke(core.clj:2642)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18231.invoke(threaded.clj:70)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203.invoke(threaded.clj:23)
        at clojure.lang.ArrayChunk.reduce(ArrayChunk.java:58)
        at clojure.core.protocols$fn__8244.invokeStatic(protocols.clj:136)
        at clojure.core.protocols$fn__8244.invoke(protocols.clj:124)
        at clojure.core.protocols$fn__8204$G__8199__8213.invoke(protocols.clj:19)
        at clojure.core.protocols$seq_reduce.invokeStatic(protocols.clj:31)
        at clojure.core.protocols$fn__8236.invokeStatic(protocols.clj:75)
        at clojure.core.protocols$fn__8236.invoke(protocols.clj:75)
        at clojure.core.protocols$fn__8178$G__8173__8191.invoke(protocols.clj:13)
        at clojure.core$reduce.invokeStatic(core.clj:6887)
        at clojure.core$reduce.invoke(core.clj:6869)
        at methodical.impl.combo.threaded$reducer_fn$fn__18199.invoke(threaded.clj:21)
        at clojure.core$comp$fn__5876.invoke(core.clj:2587)
        at methodical.impl.combo.threaded$combine_with_threader$fn__18209.invoke(threaded.clj:43)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:436)
        at clojure.core$partial$fn__5908.invoke(core.clj:2642)
        at clojure.lang.AFn.applyToHelper(AFn.java:156)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:31)
        at clojure.lang.RestFn.invoke(RestFn.java:421)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:193)
        at metabase.db.custom_migrations.CardRevisionAddType.execute(custom_migrations.clj:996)
        at liquibase.change.custom.CustomChangeWrapper.generateStatements(CustomChangeWrapper.java:169)
        at liquibase.database.AbstractJdbcDatabase.executeStatements(AbstractJdbcDatabase.java:1271)
        at liquibase.changelog.ChangeSet.execute(ChangeSet.java:755)
        ... 72 more
Caused by: java.sql.SQLTransientConnectionException: (conn=23045451) Limit of 32 on JSON nested strucures depth is reached in argument 1 to function 'json_extract' at position 1375
        ... 418 more
Caused by: org.mariadb.jdbc.internal.util.exceptions.MariaDbSqlException: Limit of 32 on JSON nested strucures depth is reached in argument 1 to function 'json_extract' at position 1375
        at org.mariadb.jdbc.internal.util.exceptions.MariaDbSqlException.of(MariaDbSqlException.java:34)
        at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.exceptionWithQuery(AbstractQueryProtocol.java:195)
        at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.exceptionWithQuery(AbstractQueryProtocol.java:178)
        at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.executeQuery(AbstractQueryProtocol.java:322)
        at org.mariadb.jdbc.ClientSidePreparedStatement.executeInternal(ClientSidePreparedStatement.java:220)
        ... 414 more
Caused by: java.sql.SQLException: Limit of 32 on JSON nested strucures depth is reached in argument 1 to function 'json_extract' at position 1375
        at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.readErrorPacket(AbstractQueryProtocol.java:1693)
        at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.readPacket(AbstractQueryProtocol.java:1555)
        at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.getResult(AbstractQueryProtocol.java:1518)
        at org.mariadb.jdbc.internal.protocol.AbstractQueryProtocol.executeQuery(AbstractQueryProtocol.java:319)
        ... 415 more
2024-04-27 09:33:50,827 INFO metabase.core :: Metabase Shutting Down ...
2024-04-27 09:33:50,828 INFO metabase.server :: Shutting Down Embedded Jetty Webserver
2024-04-27 09:33:50,837 WARN db.liquibase :: ()
2024-04-27 09:33:50,838 INFO metabase.core :: Metabase Shutdown COMPLETE
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.21+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.21"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.21+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.14.0-375.el9.x86_64"",
    ""user.language"": ""en""
  },
  ""metabase-info"": {
    ""databases"": [
      ""exasol"",
      ""mysql"",
      ""clickhouse"",
      ""mongo""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MariaDB"",
        ""version"": ""10.5.13-MariaDB-log""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-01-11"",
      ""tag"": ""v0.48.3"",
      ""hash"": ""80d8323""
    }
  }
}
```


### Severity

This blocks the use of the new version of Metabase

### Additional context

_No response_",ppavlov39,2024-04-27 06:49:50+00:00,['qnkhuat'],2024-06-03 13:19:53+00:00,2024-06-03 05:23:55+00:00,https://github.com/metabase/metabase/issues/41924,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Operation/Database Migrations', 'Issues with application DB migrations when launching Metabase'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2080438538, 'issue_id': 2266875637, 'author': 'paoliniluis', 'body': '@qnkhuat tagging you as you might be more familiar with the matter here', 'created_at': datetime.datetime(2024, 4, 27, 10, 3, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2081900240, 'issue_id': 2266875637, 'author': 'darksciencebase', 'body': '@paoliniluis this scope has been moved to another team, and @qnkhuat is OOO anyway.\r\ncc @dpsutton', 'created_at': datetime.datetime(2024, 4, 29, 5, 10, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2092719661, 'issue_id': 2266875637, 'author': 'mmoole', 'body': ""about the same error here, upgrading from v0.48.7 to v0.49.8:\r\n\r\n```trace\r\n2024-05-03 10:04:42,467 [main] INFO metabase.db.liquibase - No migration lock found.\r\n2024-05-03 10:04:42,887 [main] INFO metabase.db.liquibase - Running 58 migrations ...\r\n2024-05-03 10:04:52,877 [QuartzScheduler_MetabaseScheduler-hostname1714730692766_MisfireHandler] ERRORorg.quartz.impl.jdbcjobstore.JobStoreTX - MisfireHandler: Error handling misfires: Couldn't store trigger 'DEFAULT.metabase.task.truncate-audit-log.trigger' for 'DEFAULT.metabase.task.truncate-audit-log.job' job:Couldn't retrieve job because a required class was not found: metabase.task.truncate_audit_log.TruncateAuditLog\r\norg.quartz.JobPersistenceException: Couldn't store trigger 'DEFAULT.metabase.task.truncate-audit-log.trigger' for 'DEFAULT.metabase.task.truncate-audit-log.job' job:Couldn't retrieve job because a required class was not found: metabase.task.truncate_audit_log.TruncateAuditLog\r\n[....]\r\n2024-05-03 10:04:53,868 [main] ERRORliquibase.changelog - ChangeSet migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat encountered an exception.\r\n2024-05-03 10:04:53,912 [main] ERRORmetabase.core - Metabase Initialization FAILED\r\nliquibase.exception.CommandExecutionException: java.lang.ClassCastException: class java.lang.ExceptionInInitializerError cannot be cast to class java.lang.Exception (java.lang.ExceptionInInitializerError and java.lang.Exception are in module java.base of loader 'bootstrap')\r\n[...]\r\n2024-05-03 10:04:53,919 [Thread-9] INFO metabase.core - Metabase Shutting Down ...\r\n2024-05-03 10:04:53,919 [Thread-9] INFO metabase.server - Shutting Down Embedded Jetty Webserver\r\n2024-05-03 10:04:53,941 [Thread-9] WARN metabase.db.liquibase - ()\r\n2024-05-03 10:04:53,942 [Thread-9] INFO metabase.core - Metabase Shutdown COMPLETE\r\n```"", 'created_at': datetime.datetime(2024, 5, 3, 10, 20, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2113431939, 'issue_id': 2266875637, 'author': 'ZencareJake', 'body': ""Similar failure here:\r\n```\r\nReason: clojure.lang.ExceptionInfo: Unexpected character ('T' (code 84)): Expected space separating root-level values\r\nliquibase.exception.CommandExecutionException: liquibase.exception.LiquibaseException: liquibase.exception.MigrationFailedException: Migration failed for changeset migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat:\r\n2024-05-15 20:22:22,225 ERROR metabase.core :: Metabase Initialization FAILED\r\n... 236 more\r\nat [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 3]\r\nCaused by: com.fasterxml.jackson.core.JsonParseException: Unexpected character ('T' (code 84)): Expected space separating root-level values\r\n```\r\n@mmoole were you able ever to find a solution? I'm not certain that a downgrade is a viable supported solution so I hesitant to move back versions."", 'created_at': datetime.datetime(2024, 5, 15, 20, 49, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2113443340, 'issue_id': 2266875637, 'author': 'mmoole', 'body': ""I immediately retried the upgrade with v0.49.10 when it was available, and it gut stuck at the migration tasks. Restarting metabase didn't help: it complained about migration lock being present in the database.\r\nThen I again reset the database to the state before the upgrade, and upgraded again - and this time it went totally smoothly. \r\nI have no idea what prevented the first try. But now it's running ok.\r\nI also tested to upgrade from an earlier version from last October, and this also went smoothly."", 'created_at': datetime.datetime(2024, 5, 15, 20, 56, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2113450828, 'issue_id': 2266875637, 'author': 'ZencareJake', 'body': ""@mmoole thank you! I'll see if this will work in my case.\r\n\r\nAlso, I just looked through some closed issues and saw that this issue may be resolved in 49.11\r\nhttps://github.com/metabase/metabase/issues/42659#issuecomment-2112657115"", 'created_at': datetime.datetime(2024, 5, 15, 21, 2, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2113658627, 'issue_id': 2266875637, 'author': 'paoliniluis', 'body': '@ZencareJake try with 49.11, your db details are encrypted and that might be the issue here', 'created_at': datetime.datetime(2024, 5, 15, 23, 43, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2113658851, 'issue_id': 2266875637, 'author': 'paoliniluis', 'body': ""@darksciencebase should we close this? I don't know if we tackled this at some point"", 'created_at': datetime.datetime(2024, 5, 15, 23, 44, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2113901156, 'issue_id': 2266875637, 'author': 'qnkhuat', 'body': ""we didn't fix the issue with json extract limit."", 'created_at': datetime.datetime(2024, 5, 16, 2, 31, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2113921899, 'issue_id': 2266875637, 'author': 'ZencareJake', 'body': ""> @ZencareJake try with 49.11, your db details are encrypted and that might be the issue here\r\n\r\nI didn't specify in my original comment that those logs were from an attempt to initialize `v1.49.10` via the `metabase/metabase:latest` docker image. Should I manually pop up to `metabase/metabase:v1.49.11` manually? My assumption is that that's not tagged and released yet. Maybe I'm misunderstanding and there's a stable version I should downgrade to.\r\n\r\nEdit: I realized that you're suggesting I should try with the fix coming up in 49.11, I will do that! Thank you!"", 'created_at': datetime.datetime(2024, 5, 16, 2, 57, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2114294997, 'issue_id': 2266875637, 'author': 'darksciencebase', 'body': ""@ZencareJake you're right, 49.11 is not out yet, but is expected to be released today."", 'created_at': datetime.datetime(2024, 5, 16, 7, 43, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2115245502, 'issue_id': 2266875637, 'author': 'ZencareJake', 'body': '49.11 initialized successfully. Thank you team!', 'created_at': datetime.datetime(2024, 5, 16, 13, 26, 50, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-27 10:03:29 UTC): @qnkhuat tagging you as you might be more familiar with the matter here

darksciencebase on (2024-04-29 05:10:42 UTC): @paoliniluis this scope has been moved to another team, and @qnkhuat is OOO anyway.
cc @dpsutton

mmoole on (2024-05-03 10:20:55 UTC): about the same error here, upgrading from v0.48.7 to v0.49.8:

```trace
2024-05-03 10:04:42,467 [main] INFO metabase.db.liquibase - No migration lock found.
2024-05-03 10:04:42,887 [main] INFO metabase.db.liquibase - Running 58 migrations ...
2024-05-03 10:04:52,877 [QuartzScheduler_MetabaseScheduler-hostname1714730692766_MisfireHandler] ERRORorg.quartz.impl.jdbcjobstore.JobStoreTX - MisfireHandler: Error handling misfires: Couldn't store trigger 'DEFAULT.metabase.task.truncate-audit-log.trigger' for 'DEFAULT.metabase.task.truncate-audit-log.job' job:Couldn't retrieve job because a required class was not found: metabase.task.truncate_audit_log.TruncateAuditLog
org.quartz.JobPersistenceException: Couldn't store trigger 'DEFAULT.metabase.task.truncate-audit-log.trigger' for 'DEFAULT.metabase.task.truncate-audit-log.job' job:Couldn't retrieve job because a required class was not found: metabase.task.truncate_audit_log.TruncateAuditLog
[....]
2024-05-03 10:04:53,868 [main] ERRORliquibase.changelog - ChangeSet migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat encountered an exception.
2024-05-03 10:04:53,912 [main] ERRORmetabase.core - Metabase Initialization FAILED
liquibase.exception.CommandExecutionException: java.lang.ClassCastException: class java.lang.ExceptionInInitializerError cannot be cast to class java.lang.Exception (java.lang.ExceptionInInitializerError and java.lang.Exception are in module java.base of loader 'bootstrap')
[...]
2024-05-03 10:04:53,919 [Thread-9] INFO metabase.core - Metabase Shutting Down ...
2024-05-03 10:04:53,919 [Thread-9] INFO metabase.server - Shutting Down Embedded Jetty Webserver
2024-05-03 10:04:53,941 [Thread-9] WARN metabase.db.liquibase - ()
2024-05-03 10:04:53,942 [Thread-9] INFO metabase.core - Metabase Shutdown COMPLETE
```

ZencareJake on (2024-05-15 20:49:03 UTC): Similar failure here:
```
Reason: clojure.lang.ExceptionInfo: Unexpected character ('T' (code 84)): Expected space separating root-level values
liquibase.exception.CommandExecutionException: liquibase.exception.LiquibaseException: liquibase.exception.MigrationFailedException: Migration failed for changeset migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat:
2024-05-15 20:22:22,225 ERROR metabase.core :: Metabase Initialization FAILED
... 236 more
at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 3]
Caused by: com.fasterxml.jackson.core.JsonParseException: Unexpected character ('T' (code 84)): Expected space separating root-level values
```
@mmoole were you able ever to find a solution? I'm not certain that a downgrade is a viable supported solution so I hesitant to move back versions.

mmoole on (2024-05-15 20:56:57 UTC): I immediately retried the upgrade with v0.49.10 when it was available, and it gut stuck at the migration tasks. Restarting metabase didn't help: it complained about migration lock being present in the database.
Then I again reset the database to the state before the upgrade, and upgraded again - and this time it went totally smoothly. 
I have no idea what prevented the first try. But now it's running ok.
I also tested to upgrade from an earlier version from last October, and this also went smoothly.

ZencareJake on (2024-05-15 21:02:30 UTC): @mmoole thank you! I'll see if this will work in my case.

Also, I just looked through some closed issues and saw that this issue may be resolved in 49.11
https://github.com/metabase/metabase/issues/42659#issuecomment-2112657115

paoliniluis on (2024-05-15 23:43:49 UTC): @ZencareJake try with 49.11, your db details are encrypted and that might be the issue here

paoliniluis on (2024-05-15 23:44:10 UTC): @darksciencebase should we close this? I don't know if we tackled this at some point

qnkhuat (Assginee) on (2024-05-16 02:31:23 UTC): we didn't fix the issue with json extract limit.

ZencareJake on (2024-05-16 02:57:19 UTC): I didn't specify in my original comment that those logs were from an attempt to initialize `v1.49.10` via the `metabase/metabase:latest` docker image. Should I manually pop up to `metabase/metabase:v1.49.11` manually? My assumption is that that's not tagged and released yet. Maybe I'm misunderstanding and there's a stable version I should downgrade to.

Edit: I realized that you're suggesting I should try with the fix coming up in 49.11, I will do that! Thank you!

darksciencebase on (2024-05-16 07:43:13 UTC): @ZencareJake you're right, 49.11 is not out yet, but is expected to be released today.

ZencareJake on (2024-05-16 13:26:50 UTC): 49.11 initialized successfully. Thank you team!

"
2266654492,issue,open,,Allow Customizing or Removing Prefixes for Series on Multi-Series Cards,"**Is your feature request related to a problem? Please describe.**
When you add a series on top of a multi series card, every series in the legend is prefixed with the name of the card. This is often very long and makes the legend illegible.

**Describe the solution you'd like**
The option to set or remove the prefix entirely

**Describe alternatives you've considered**
Editing them one by one - this is fine if you have a few series but it gets cumbersome quickly if you have 20 + and/or multiple multi-series cards.

![Questionname](https://github.com/metabase/metabase/assets/13661163/ffd38f1e-9be3-4b2a-8f74-75d3050a58e3)

",ixipixi,2024-04-27 00:37:11+00:00,[],2025-02-04 20:31:41+00:00,,https://github.com/metabase/metabase/issues/41922,"[('Type:New Feature', ''), ('Reporting/Dashboards/Combined charts', 'Combining charts'), ('Visualization/Legend', '')]",[],
2266554134,issue,closed,completed,Check for the existence of Poifiles in temporary directory before creating XLSX files,"### Describe the bug

Had a customer run into an issue where they were getting the following errors when attempting to download results as an XLSX file.

> ERROR async.streaming-response :: Caught unexpected Exception in streaming response body 
> 
> metabase: java.lang.RuntimeException: java.nio.file.NoSuchFileException: /tmp/poifiles/poi-sxssf-sheet5437265569215382033.xml 
> 
> metabase: at org.apache.poi.xssf.streaming.SXSSFWorkbook.createAndRegisterSXSSFSheet(SXSSFWorkbook.java:728)
> 

They’re hosted in an AWS EC2 Linux instance that periodically runs **systemd-tmpfiles --clean** to clean everything within the /tmp directory.
What happens is Metabase can’t locate **'/tmp/poifiles/'** as it’s going through the process of creating the XLSX file.
I mention '/tmp/poifiles/' as an example but it’s wherever the **java.io.tmpdir** directory is pointing to, which can be found by running the following command.

`java -XshowSettings:properties -version`


In this particular situation, I did suggest creating an exclusion in the cleanup process so the 'poifiles' folder is not removed during cleanup.
However, as a precautionary measure, should we be checking if that directory exists before attempting to write to it?


### To Reproduce

1. Run Metabase as you normally would.

2. Test downloading results of a card an XLSX to confirm it's working

3. Identify the location of the 'poifiles' temp folder. Either programmatically or running the following command **java -XshowSettings:properties -version** and locating the value for **java.io.tmpdir** 

4. Remove the 'poifiles' folder

5. Download results of a card to XLSX and errors should occur as 'poifiles' can't be located

6. Restarting or manually creating 'poifiles' resolves the issue

### Expected behavior

Possibly checking if 'poifiles' folder exists before creating XLSX files

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""13.5.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""America/Chicago""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mongo"",
      ""bigquery-cloud-sdk"",
      ""mysql"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.3""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v1.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""UTC""
    }
  }
}
```


### Severity

P3 - There are work arounds and even restarting Metabase should resolve the issue.  However, a suggestion for improving customer experience.

### Additional context

_No response_",FilmonK,2024-04-26 21:57:06+00:00,[],2024-10-08 23:11:21+00:00,2024-10-08 21:17:38+00:00,https://github.com/metabase/metabase/issues/41919,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Export', ''), ('.Escalation', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2369644990, 'issue_id': 2266554134, 'author': 'mbosecke', 'body': 'For those who are looking for a workaround, you can create a file called `/etc/tmpfiles.d/metabase.conf` with the following contents to prevent `systemd-tmpfiles --clean` from removing this particular directory:\r\n```\r\n# Prevent metabase ""poifiles"" directory from being cleaned up\r\nd /tmp/poifiles 0755 metabase metabase -\r\n```\r\n\r\nSee:\r\n\r\n* `man systemd-tmpfiles`\r\n* `man tmpfiles.d`', 'created_at': datetime.datetime(2024, 9, 23, 22, 32, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2400542908, 'issue_id': 2266554134, 'author': 'dpsutton', 'body': 'This looks like an issue with the apache poi library that we use. I can trigger this by deleting the temp file right before downloading the file:\n\n```clojure\n  (let [f (io/file (str (System/getProperty ""java.io.tmpdir"") ""/poifiles""))]\n    (when (.exists f)\n      (doto f (.delete))))\n```\n\nThis is fixed in https://bz.apache.org/bugzilla/show_bug.cgi?id=69323  https://github.com/apache/poi/commit/5a977d1a7b70714e1efa1d780478394f63dc112a and appears to be slated for the next release 5.3.1\n![Image](https://github.com/user-attachments/assets/0e99f30a-4288-4a32-a7da-f9140f2adff4)\n\nhttps://poi.apache.org/changes.html#5.3.0\n\nUnfortunately this is not released yet. But will watch it\n\nIn the meantime we can add a quick check \n\n```clojure\n  (let [f (io/file (str (System/getProperty ""java.io.tmpdir"") ""/poifiles""))]\n    (when-not (.exists f)\n      (.mkdirs f)))\n```\nIt\'s really just finding the best place for this to always run before the workbook starts.', 'created_at': datetime.datetime(2024, 10, 8, 18, 26, 57, tzinfo=datetime.timezone.utc)}]","mbosecke on (2024-09-23 22:32:04 UTC): For those who are looking for a workaround, you can create a file called `/etc/tmpfiles.d/metabase.conf` with the following contents to prevent `systemd-tmpfiles --clean` from removing this particular directory:
```
# Prevent metabase ""poifiles"" directory from being cleaned up
d /tmp/poifiles 0755 metabase metabase -
```

See:

* `man systemd-tmpfiles`
* `man tmpfiles.d`

dpsutton on (2024-10-08 18:26:57 UTC): This looks like an issue with the apache poi library that we use. I can trigger this by deleting the temp file right before downloading the file:

```clojure
  (let [f (io/file (str (System/getProperty ""java.io.tmpdir"") ""/poifiles""))]
    (when (.exists f)
      (doto f (.delete))))
```

This is fixed in https://bz.apache.org/bugzilla/show_bug.cgi?id=69323  https://github.com/apache/poi/commit/5a977d1a7b70714e1efa1d780478394f63dc112a and appears to be slated for the next release 5.3.1
![Image](https://github.com/user-attachments/assets/0e99f30a-4288-4a32-a7da-f9140f2adff4)

https://poi.apache.org/changes.html#5.3.0

Unfortunately this is not released yet. But will watch it

In the meantime we can add a quick check 

```clojure
  (let [f (io/file (str (System/getProperty ""java.io.tmpdir"") ""/poifiles""))]
    (when-not (.exists f)
      (.mkdirs f)))
```
It's really just finding the best place for this to always run before the workbook starts.

"
2266545382,issue,closed,completed,Fix QP to allow step previews in query builder,"<img width=""1696"" alt=""image"" src=""https://github.com/metabase/metabase/assets/105012/6c384400-7dbb-4a9c-a236-f1a5e1782bc8"">
",snoe,2024-04-26 21:46:42+00:00,['snoe'],2024-04-29 20:16:31+00:00,2024-04-29 20:16:31+00:00,https://github.com/metabase/metabase/issues/41917,[],[],
2266537735,issue,closed,completed,FE: handle bulk actions for archived items,,sloansparger,2024-04-26 21:37:52+00:00,['sloansparger'],2024-04-26 21:52:18+00:00,2024-04-26 21:47:13+00:00,https://github.com/metabase/metabase/issues/41916,[],[],
2266537692,issue,closed,completed,FE: allow users to view archived question/models results while logged in,"```[tasklist]
### Tasks
- [x] allow users to view archive questions + models and hide/disable any edit action
- [x] allow users to view archive models and hide/disable any edit action
- [x] allow users to view archive collections and hide/disable any edit action
```
",sloansparger,2024-04-26 21:37:49+00:00,['sloansparger'],2024-04-26 21:52:17+00:00,2024-04-26 21:46:46+00:00,https://github.com/metabase/metabase/issues/41915,[],[],
2266537622,issue,closed,completed,"FE: handle new ""move to trash"" / ""restore"" / ""delete"" functionality for collections/dashboards/models/questions","```[tasklist]
### Tasks
- [x] add ""restore"" & ""permanently delete"" options to trash collection items
- [x] add archive banner to allow users to ""restore""   & ""permanently delete"" an archived entity while viewing it
- [x] enable users to view item in collection upon restoring an item
- [x] bug - dashboards/questions/models pages do not automatically show state updates + requires refresh to see archive/unarchive/delete
```
",sloansparger,2024-04-26 21:37:44+00:00,['sloansparger'],2024-04-26 21:52:14+00:00,2024-04-26 21:43:51+00:00,https://github.com/metabase/metabase/issues/41914,[],[],
2266537574,issue,closed,completed,FE: implement updated archive UI,"```[tasklist]
### Tasks
- [x] make trash collection not expandable in sidebar
- [x] add trash icon to trash collection in sidebar
- [x] add extra spacing above trash collection in sidebar
- [x] update ""Archive"" copy to ""Move to trash"" in collection list items
- [x] table headers should mention deleted by / deleted at instead of modified for trash collection
- [x] impl new empty trash collection state
- [x] don't render pins in root trash collection
```
",sloansparger,2024-04-26 21:37:41+00:00,['sloansparger'],2024-04-26 21:52:12+00:00,2024-04-26 21:41:30+00:00,https://github.com/metabase/metabase/issues/41913,[],[],
2266535766,issue,closed,completed,[Browse] Port moderation-related code to TS,,rafpaf,2024-04-26 21:35:47+00:00,[],2024-04-26 21:36:03+00:00,2024-04-26 21:36:03+00:00,https://github.com/metabase/metabase/issues/41912,[],"[{'comment_id': 2080150213, 'issue_id': 2266535766, 'author': 'rafpaf', 'body': 'Closed by #41756', 'created_at': datetime.datetime(2024, 4, 26, 21, 36, 3, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-04-26 21:36:03 UTC): Closed by #41756

"
2266528129,issue,closed,completed,[Browse] Port ItemsTable and related code to TS,,rafpaf,2024-04-26 21:27:26+00:00,[],2024-04-26 21:27:45+00:00,2024-04-26 21:27:44+00:00,https://github.com/metabase/metabase/issues/41911,[],"[{'comment_id': 2080138958, 'issue_id': 2266528129, 'author': 'rafpaf', 'body': 'Closed by #41911', 'created_at': datetime.datetime(2024, 4, 26, 21, 27, 44, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2024-04-26 21:27:44 UTC): Closed by #41911

"
2266514546,issue,open,,Cache models in the application database when the DW does not support model caching (e.g. Athena),"**Is your feature request related to a problem? Please describe.**
Field filters relying on a model for the dropdown values can be slow when querying Athena.

**Describe the solution you'd like**
Implement model caching similar to how queries are cached in the Metabase application database. https://www.metabase.com/docs/latest/configuring-metabase/caching

**Describe alternatives you've considered**
Trying to get Athena to re-use queries, but running into Metabase ID and Hash comment being included in the query

**How important is this feature to you?**
Very important. Users are not happy with the slow queries needed to populate their filter dropdowns. This would also manage costs by preventing these queries with data that changes maybe once a day from running against Athena.",cabarria,2024-04-26 21:12:42+00:00,[],2024-05-24 18:10:11+00:00,,https://github.com/metabase/metabase/issues/41910,"[('Type:New Feature', ''), ('Querying/Cache', '')]","[{'comment_id': 2080419056, 'issue_id': 2266514546, 'author': 'paoliniluis', 'body': 'Model caching for athena means that we will have to send ""CREATE SCHEMA"" AND ""SELECT INTO"" statements to the engine, which is... kinda hard\r\n\r\nBTW: you need to disable this from the Athena driver\r\n![image](https://github.com/metabase/metabase/assets/1711649/6e3bc79b-c7b7-4d7b-a4f0-f31e9f5a8449)', 'created_at': datetime.datetime(2024, 4, 27, 8, 43, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2082930168, 'issue_id': 2266514546, 'author': 'mayanala-coxauto', 'body': 'Hi, the steps listed here for model caching do not work for Athena ? \r\n\r\nhttps://www.metabase.com/docs/v0.48/data-modeling/models.html', 'created_at': datetime.datetime(2024, 4, 29, 14, 40, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2082932101, 'issue_id': 2266514546, 'author': 'cabarria', 'body': 'I thought caching happened on the metabase database not the connected database. As far as the setting shown above ""Include User ID and query hash in queries"". We can\'t find it anywhere. Is it supposed to be on the Athena Database connection settings? We are on 48.10.\r\n![image](https://github.com/metabase/metabase/assets/18726993/d9093381-806c-49eb-8437-9dd286971862)', 'created_at': datetime.datetime(2024, 4, 29, 14, 41, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2083475515, 'issue_id': 2266514546, 'author': 'paoliniluis', 'body': 'Question caching = app db\r\nModel caching = connected dw', 'created_at': datetime.datetime(2024, 4, 29, 19, 11, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2084437898, 'issue_id': 2266514546, 'author': 'cabarria', 'body': 'I modified the feature request to align with the desired outcome. Need to get dropdown models cached in the app database instead of Athena.', 'created_at': datetime.datetime(2024, 4, 30, 5, 57, 29, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-27 08:43:36 UTC): Model caching for athena means that we will have to send ""CREATE SCHEMA"" AND ""SELECT INTO"" statements to the engine, which is... kinda hard

BTW: you need to disable this from the Athena driver
![image](https://github.com/metabase/metabase/assets/1711649/6e3bc79b-c7b7-4d7b-a4f0-f31e9f5a8449)

mayanala-coxauto on (2024-04-29 14:40:55 UTC): Hi, the steps listed here for model caching do not work for Athena ? 

https://www.metabase.com/docs/v0.48/data-modeling/models.html

cabarria (Issue Creator) on (2024-04-29 14:41:52 UTC): I thought caching happened on the metabase database not the connected database. As far as the setting shown above ""Include User ID and query hash in queries"". We can't find it anywhere. Is it supposed to be on the Athena Database connection settings? We are on 48.10.
![image](https://github.com/metabase/metabase/assets/18726993/d9093381-806c-49eb-8437-9dd286971862)

paoliniluis on (2024-04-29 19:11:55 UTC): Question caching = app db
Model caching = connected dw

cabarria (Issue Creator) on (2024-04-30 05:57:29 UTC): I modified the feature request to align with the desired outcome. Need to get dropdown models cached in the app database instead of Athena.

"
2266505128,issue,closed,completed,expose collection names for models,,dpsutton,2024-04-26 21:04:06+00:00,['johnswanson'],2024-04-26 22:47:06+00:00,2024-04-26 22:47:06+00:00,https://github.com/metabase/metabase/issues/41909,[],[],
2266504650,issue,closed,completed,[Browse] Make ItemsTable customizable,"```[tasklist]
### Tasks
- [x] Let table have customizable columns
- [x] Make columns responsive
```
",rafpaf,2024-04-26 21:03:38+00:00,['rafpaf'],2024-05-03 14:43:01+00:00,2024-05-03 14:43:00+00:00,https://github.com/metabase/metabase/issues/41908,[],[],
2266481101,issue,open,,Have more detailed Custom Expression/Custom Column error messages,"**Is your feature request related to a problem? Please describe.**
It can be frustrating when you don't have a clue what the error message is telling you. 
For example: 

![Screenshot 2024-04-26 at 5 41 38 PM](https://github.com/metabase/metabase/assets/132273646/7b357114-d66d-4c1d-bc0a-3c908d003d9f)

**Describe the solution you'd like**
Maybe a link to a doc about how to troubleshoot custom expressions would be helpful for unexperienced users.
Or more accurate error responses

**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
Requested by a customer, internal ticket: [26419](https://metabase.zendesk.com/agent/tickets/26419)

**Additional context**
N/A
",ignacio-mb,2024-04-26 20:46:51+00:00,[],2024-04-26 20:46:52+00:00,,https://github.com/metabase/metabase/issues/41906,"[('Type:New Feature', ''), ('Querying/Notebook/Custom Column', ''), ('Querying/Notebook/Custom Expression', '')]",[],
2266470128,issue,open,,update timeseries.unit.spec.js according to the new x-ticks behavior,`frontend/src/metabase/visualizations/echarts/cartesian/utils/timeseries.unit.spec.js`,alxnddr,2024-04-26 20:36:56+00:00,[],2024-06-10 22:58:39+00:00,,https://github.com/metabase/metabase/issues/41905,"[('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.')]","[{'comment_id': 2159447016, 'issue_id': 2266470128, 'author': 'EmmadUsmani', 'body': 'I was able to complete half of this issue in https://github.com/metabase/metabase/pull/43421, but there\'s still one more test case that\'s commented out (see `FIXME` comment in the aforementioned file). Since I don\'t have bandwidth at the moment (working on https://github.com/metabase/metabase/issues/33281), I\'ll unassign myself from this issue and put it back in the ""Next"" column on our team board, for someone else to potentially pick up.', 'created_at': datetime.datetime(2024, 6, 10, 22, 58, 27, tzinfo=datetime.timezone.utc)}]","EmmadUsmani on (2024-06-10 22:58:27 UTC): I was able to complete half of this issue in https://github.com/metabase/metabase/pull/43421, but there's still one more test case that's commented out (see `FIXME` comment in the aforementioned file). Since I don't have bandwidth at the moment (working on https://github.com/metabase/metabase/issues/33281), I'll unassign myself from this issue and put it back in the ""Next"" column on our team board, for someone else to potentially pick up.

"
2266469891,issue,open,,Have Auto-split Y axis disabled by default,"**Is your feature request related to a problem? Please describe.**
You might don't want it by default and unexperienced users may want it to be always off

**Describe the solution you'd like**
Have it disabled by default, currently, it's enabled

**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
Requested by a customer, internal ticket: [26419](https://metabase.zendesk.com/agent/tickets/26419)

**Additional context**
N/A
",ignacio-mb,2024-04-26 20:36:43+00:00,[],2024-04-26 20:36:44+00:00,,https://github.com/metabase/metabase/issues/41904,"[('Type:New Feature', ''), ('Visualization/Chart Settings', '')]",[],
2266384205,issue,closed,completed,Add View All item to palette search results,,npfitz,2024-04-26 19:25:26+00:00,['npfitz'],2024-05-07 15:51:09+00:00,2024-05-07 15:51:09+00:00,https://github.com/metabase/metabase/issues/41901,"[('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2266321468,issue,closed,completed,QP changes to allow for joins,,snoe,2024-04-26 18:41:43+00:00,['snoe'],2024-04-26 21:47:01+00:00,2024-04-26 21:46:56+00:00,https://github.com/metabase/metabase/issues/41899,[],[],
2266292781,issue,open,,Cannot Subscribe to report with Time Field,"**Describe the bug**
We created a Question using the GUI. The Table has a Time field as column type Time.
When we try to send out the email subscription it fails to send out. Error given is:

""Unsupported field: MonthOfYear""

Hiding the time field from the question allows us to send out the report.

Some values in the Time field are NULL. Does that have any issues?

![image](https://github.com/metabase/metabase/assets/39813003/d248acb5-6404-45ac-89d0-2828941b59a9)



**Logs**

> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:00:27-07:00 INFO metabase.core 
> Metabase v0.49.7 (f0ff786) 
> 
> Copyright © 2024 Metabase, Inc. 
> 
> Metabase Enterprise Edition extensions are NOT PRESENT.
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:00:27-07:00 INFO metabase.core Starting Metabase in STANDALONE mode
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:00:28-07:00 INFO metabase.server Launching Embedded Jetty Webserver with config:
>  {:port 3000, :host ""0.0.0.0""}
> 
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:00:28-07:00 INFO metabase.core Starting Metabase version v0.49.7 (f0ff786) ...
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:00:28-07:00 INFO metabase.core System info:
>  {""file.encoding"" ""UTF-8"",
>  ""java.runtime.name"" ""OpenJDK Runtime Environment"",
>  ""java.runtime.version"" ""11.0.22+7"",
>  ""java.vendor"" ""Eclipse Adoptium"",
>  ""java.vendor.url"" ""https://adoptium.net/"",
>  ""java.version"" ""11.0.22"",
>  ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",
>  ""java.vm.version"" ""11.0.22+7"",
>  ""os.name"" ""Linux"",
>  ""os.version"" ""5.4.0-162-generic"",
>  ""user.language"" ""en"",
>  ""user.timezone"" ""GMT""}
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:16-07:00 INFO metabase.query-processor.card Question's average execution duration is 127.0 ms; using 'magic' TTL of 1000.0 ms 💾
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:16-07:00 INFO metabase.query-processor.middleware.cache Query took 112.0 ms to run; minimum for cache eligibility is 60.0 s; not eligible
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:16-07:00 DEBUG metabase.server.middleware.log GET /api/public/card/5aefe880-b92b-44cd-9d65-67f309371cf6/query 202 [ASYNC: completed] 161.3 ms (12 DB calls) App DB connections: 2/7 Jetty threads: 3/50 (3 idle, 0 queued) (88 total active threads) Queries in flight: 1 (0 queued); sqlserver DB 3 connections: 0/2 (0 threads blocked)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:16-07:00 INFO metabase.query-processor.middleware.cache Query took 131.0 ms to run; minimum for cache eligibility is 60.0 s; not eligible
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:16-07:00 DEBUG metabase.server.middleware.log GET /api/public/card/d4a28b1e-b1af-46f1-974d-4d240a052ee3/query 202 [ASYNC: completed] 173.7 ms (12 DB calls) App DB connections: 2/7 Jetty threads: 3/50 (3 idle, 0 queued) (88 total active threads) Queries in flight: 0 (0 queued); sqlserver DB 3 connections: 1/2 (0 threads blocked)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:17-07:00 DEBUG metabase.server.middleware.log GET /api/activity/recent_views 200 67.8 ms (7 DB calls) App DB connections: 3/7 Jetty threads: 5/50 (3 idle, 0 queued) (88 total active threads) Queries in flight: 0 (0 queued)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:17-07:00 DEBUG metabase.server.middleware.log GET /api/activity/popular_items 200 189.6 ms (10 DB calls) App DB connections: 1/7 Jetty threads: 4/50 (3 idle, 0 queued) (88 total active threads) Queries in flight: 0 (0 queued)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:18-07:00 DEBUG metabase.server.middleware.log GET /api/dashboard/207 200 51.9 ms (15 DB calls) App DB connections: 1/7 Jetty threads: 4/50 (3 idle, 0 queued) (88 total active threads) Queries in flight: 0 (0 queued)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:18-07:00 DEBUG metabase.server.middleware.log GET /api/pulse/form_input 200 1.6 ms (0 DB calls) App DB connections: 2/7 Jetty threads: 5/50 (3 idle, 0 queued) (88 total active threads) Queries in flight: 0 (0 queued)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:19-07:00 INFO metabase.query-processor.card Question's average execution duration is 166.0 ms; using 'magic' TTL of 2.0 s 💾
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:19-07:00 INFO metabase.query-processor.middleware.cache Query took 36.0 ms to run; minimum for cache eligibility is 60.0 s; not eligible
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:19-07:00 DEBUG metabase.server.middleware.log POST /api/dashboard/207/dashcard/758/card/718/query 202 [ASYNC: completed] 162.5 ms (20 DB calls) App DB connections: 1/7 Jetty threads: 3/50 (3 idle, 0 queued) (89 total active threads) Queries in flight: 0 (0 queued); sqlserver DB 3 connections: 0/2 (0 threads blocked)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:22-07:00 DEBUG metabase.server.middleware.log GET /api/pulse/form_input 200 1.5 ms (0 DB calls) App DB connections: 1/7 Jetty threads: 6/50 (3 idle, 0 queued) (89 total active threads) Queries in flight: 0 (0 queued)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:22-07:00 DEBUG metabase.server.middleware.log GET /api/pulse 200 6.2 ms (1 DB calls) App DB connections: 1/7 Jetty threads: 5/50 (3 idle, 0 queued) (89 total active threads) Queries in flight: 0 (0 queued)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:22-07:00 DEBUG metabase.server.middleware.log GET /api/user/recipients 200 22.9 ms (2 DB calls) App DB connections: 1/7 Jetty threads: 4/50 (3 idle, 0 queued) (89 total active threads) Queries in flight: 0 (0 queued)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:26-07:00 DEBUG metabase.server.middleware.log GET /api/public/card/5aefe880-b92b-44cd-9d65-67f309371cf6 200 4.5 ms (1 DB calls) App DB connections: 1/7 Jetty threads: 5/50 (3 idle, 0 queued) (89 total active threads) Queries in flight: 0 (0 queued)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:26-07:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 16.5 ms (1 DB calls) App DB connections: 1/7 Jetty threads: 4/50 (3 idle, 0 queued) (89 total active threads) Queries in flight: 0 (0 queued)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:27-07:00 DEBUG metabase.server.middleware.log GET /api/public/card/d4a28b1e-b1af-46f1-974d-4d240a052ee3 200 5.7 ms (1 DB calls) App DB connections: 2/7 Jetty threads: 6/50 (3 idle, 0 queued) (89 total active threads) Queries in flight: 0 (0 queued)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:27-07:00 INFO metabase.query-processor.card Question's average execution duration is 99.0 ms; using 'magic' TTL of 1000.0 ms 💾
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:27-07:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 15.0 ms (1 DB calls) App DB connections: 1/7 Jetty threads: 5/50 (3 idle, 0 queued) (90 total active threads) Queries in flight: 1 (0 queued)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:27-07:00 INFO metabase.query-processor.middleware.cache Query took 93.0 ms to run; minimum for cache eligibility is 60.0 s; not eligible
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:27-07:00 INFO metabase.query-processor.card Question's average execution duration is 130.0 ms; using 'magic' TTL of 1000.0 ms 💾
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:27-07:00 DEBUG metabase.server.middleware.log GET /api/public/card/5aefe880-b92b-44cd-9d65-67f309371cf6/query 202 [ASYNC: completed] 144.7 ms (12 DB calls) App DB connections: 2/7 Jetty threads: 4/50 (3 idle, 0 queued) (91 total active threads) Queries in flight: 1 (0 queued); sqlserver DB 3 connections: 0/2 (0 threads blocked)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:27-07:00 INFO metabase.query-processor.middleware.cache Query took 38.0 ms to run; minimum for cache eligibility is 60.0 s; not eligible
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:27-07:00 DEBUG metabase.server.middleware.log GET /api/public/card/d4a28b1e-b1af-46f1-974d-4d240a052ee3/query 202 [ASYNC: completed] 100.3 ms (12 DB calls) App DB connections: 2/7 Jetty threads: 3/50 (3 idle, 0 queued) (91 total active threads) Queries in flight: 0 (0 queued); sqlserver DB 3 connections: 0/2 (0 threads blocked)
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:29-07:00 INFO metabase.query-processor.card Question's average execution duration is 162.0 ms; using 'magic' TTL of 2.0 s 💾
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:29-07:00 INFO metabase.query-processor.middleware.cache Query took 32.0 ms to run; minimum for cache eligibility is 60.0 s; not eligible
> [5c4773a0-97cf-435f-8500-dd60fee47630] 2024-04-26T11:01:32-07:00 ERROR metabase.server.middleware.log POST /api/pulse/test 500 2.9 s (38 DB calls) 
> {:via
>  [{:type java.time.temporal.UnsupportedTemporalTypeException,
>    :message ""Unsupported field: MonthOfYear"",
>    :at [java.time.LocalTime get0 nil -1]}],
>  :trace
>  [[java.time.LocalTime get0 nil -1]
>   [java.time.LocalTime getLong nil -1]
>   [java.time.OffsetTime getLong nil -1]
>   [java.time.format.DateTimePrintContext getValue nil -1]
>   [java.time.format.DateTimeFormatterBuilder$NumberPrinterParser format nil -1]
>   [java.time.format.DateTimeFormatterBuilder$CompositePrinterParser format nil -1]
>   [java.time.format.DateTimeFormatter formatTo nil -1]
>   [java.time.format.DateTimeFormatter format nil -1]
>   [java_time.format$format invokeStatic ""format.clj"" 82]
>   [java_time.format$format invoke ""format.clj"" 66]
>   [metabase.formatter.datetime$reformat_temporal_str invokeStatic ""datetime.clj"" 31]
>   [metabase.formatter.datetime$reformat_temporal_str invoke ""datetime.clj"" 30]
>   [metabase.formatter.datetime$fn__52101 invokeStatic ""datetime.clj"" 194]
>   [metabase.formatter.datetime$fn__52101 invoke ""datetime.clj"" 192]
>   [clojure.lang.MultiFn invoke ""MultiFn.java"" 244]
>   [metabase.formatter.datetime$fn__52114 invokeStatic ""datetime.clj"" 209]
>   [metabase.formatter.datetime$fn__52114 invoke ""datetime.clj"" 206]
>   [clojure.lang.MultiFn invoke ""MultiFn.java"" 244]
>   [metabase.formatter.datetime$format_temporal_str invokeStatic ""datetime.clj"" 235]
>   [metabase.formatter.datetime$format_temporal_str invoke ""datetime.clj"" 225]
>   [metabase.formatter$fn__52373$create_formatter__52378$fn__52379$fn__52380 invoke ""formatter.clj"" 223]
>   [metabase.pulse.render.body$fn__73687$query_results__GT_row_seq__73692$fn__73696$iter__73700__73704$fn__73705$iter__73739__73743$fn__73744
>    invoke
>    ""body.clj""
>    154]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.Cons next ""Cons.java"" 39]
>   [clojure.lang.RT countFrom ""RT.java"" 653]
>   [clojure.lang.RT count ""RT.java"" 643]
>   [metabase.pulse.render.table$render_table_body$iter__73512__73516$fn__73517$iter__73551__73555$fn__73556
>    invoke
>    ""table.clj""
>    130]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2763]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 662]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2770]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 662]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [hiccup.compiler$render_element invokeStatic ""compiler.clj"" 78]
>   [hiccup.compiler$render_element invoke ""compiler.clj"" 72]
>   [hiccup.compiler$fn__59171 invokeStatic ""compiler.clj"" 85]
>   [hiccup.compiler$fn__59171 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2772]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.Cons next ""Cons.java"" 39]
>   [clojure.lang.RT next ""RT.java"" 713]
>   [clojure.core$next__5451 invokeStatic ""core.clj"" 64]
>   [clojure.core$str$fn__5531 invoke ""core.clj"" 559]
>   [clojure.core$str invokeStatic ""core.clj"" 557]
>   [clojure.core$str doInvoke ""core.clj"" 546]
>   [clojure.lang.RestFn applyTo ""RestFn.java"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 667]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2770]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 662]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [hiccup.compiler$render_element invokeStatic ""compiler.clj"" 78]
>   [hiccup.compiler$render_element invoke ""compiler.clj"" 72]
>   [hiccup.compiler$fn__59171 invokeStatic ""compiler.clj"" 85]
>   [hiccup.compiler$fn__59171 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2770]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 662]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [hiccup.compiler$render_element invokeStatic ""compiler.clj"" 78]
>   [hiccup.compiler$render_element invoke ""compiler.clj"" 72]
>   [hiccup.compiler$fn__59171 invokeStatic ""compiler.clj"" 85]
>   [hiccup.compiler$fn__59171 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2770]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 662]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [hiccup.compiler$render_element invokeStatic ""compiler.clj"" 78]
>   [hiccup.compiler$render_element invoke ""compiler.clj"" 72]
>   [hiccup.compiler$fn__59171 invokeStatic ""compiler.clj"" 85]
>   [hiccup.compiler$fn__59171 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2770]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 662]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [hiccup.compiler$render_element invokeStatic ""compiler.clj"" 78]
>   [hiccup.compiler$render_element invoke ""compiler.clj"" 72]
>   [hiccup.compiler$fn__59171 invokeStatic ""compiler.clj"" 85]
>   [hiccup.compiler$fn__59171 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2770]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 662]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [hiccup.compiler$render_element invokeStatic ""compiler.clj"" 78]
>   [hiccup.compiler$render_element invoke ""compiler.clj"" 72]
>   [hiccup.compiler$fn__59171 invokeStatic ""compiler.clj"" 85]
>   [hiccup.compiler$fn__59171 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2770]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 662]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [hiccup.compiler$render_element invokeStatic ""compiler.clj"" 78]
>   [hiccup.compiler$render_element invoke ""compiler.clj"" 72]
>   [hiccup.compiler$fn__59171 invokeStatic ""compiler.clj"" 85]
>   [hiccup.compiler$fn__59171 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2770]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 662]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [hiccup.compiler$render_element invokeStatic ""compiler.clj"" 78]
>   [hiccup.compiler$render_element invoke ""compiler.clj"" 72]
>   [hiccup.compiler$fn__59171 invokeStatic ""compiler.clj"" 85]
>   [hiccup.compiler$fn__59171 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2770]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 662]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [hiccup.compiler$render_element invokeStatic ""compiler.clj"" 78]
>   [hiccup.compiler$render_element invoke ""compiler.clj"" 72]
>   [hiccup.compiler$fn__59171 invokeStatic ""compiler.clj"" 85]
>   [hiccup.compiler$fn__59171 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.core$map$fn__5935 invoke ""core.clj"" 2770]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$apply invokeStatic ""core.clj"" 662]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [hiccup.compiler$fn__59173 invokeStatic ""compiler.clj"" 88]
>   [hiccup.compiler$fn__59173 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [hiccup.compiler$render_element invokeStatic ""compiler.clj"" 78]
>   [hiccup.compiler$render_element invoke ""compiler.clj"" 72]
>   [hiccup.compiler$fn__59171 invokeStatic ""compiler.clj"" 85]
>   [hiccup.compiler$fn__59171 invoke ""compiler.clj"" 82]
>   [hiccup.compiler$fn__59156$G__59151__59161 invoke ""compiler.clj"" 68]
>   [clojure.lang.Var invoke ""Var.java"" 384]
>   [metabase.email.messages$render_message_body invokeStatic ""messages.clj"" 504]
>   [metabase.email.messages$render_message_body invoke ""messages.clj"" 494]
>   [metabase.email.messages$render_pulse_email invokeStatic ""messages.clj"" 523]
>   [metabase.email.messages$render_pulse_email invoke ""messages.clj"" 520]
>   [metabase.pulse$fn__99152 invokeStatic ""pulse.clj"" 442]
>   [metabase.pulse$fn__99152 invoke ""pulse.clj"" 431]
>   [clojure.lang.MultiFn invoke ""MultiFn.java"" 239]
>   [metabase.pulse$parts__GT_notifications$iter__99227__99231$fn__99232$fn__99233 invoke ""pulse.clj"" 513]
>   [metabase.pulse$parts__GT_notifications$iter__99227__99231$fn__99232 invoke ""pulse.clj"" 511]
>   [clojure.lang.LazySeq sval ""LazySeq.java"" 42]
>   [clojure.lang.LazySeq seq ""LazySeq.java"" 51]
>   [clojure.lang.RT seq ""RT.java"" 535]
>   [clojure.core$seq__5467 invokeStatic ""core.clj"" 139]
>   [clojure.core$seq__5467 invoke ""core.clj"" 139]
>   [metabase.pulse$send_notifications_BANG_ invokeStatic ""pulse.clj"" 566]
>   [metabase.pulse$send_notifications_BANG_ invoke ""pulse.clj"" 565]
>   [metabase.pulse$send_pulse_BANG_ invokeStatic ""pulse.clj"" 593]
>   [metabase.pulse$send_pulse_BANG_ doInvoke ""pulse.clj"" 574]
>   [clojure.lang.RestFn invoke ""RestFn.java"" 410]
>   [metabase.api.pulse$fn__101423 invokeStatic ""pulse.clj"" 349]
>   [metabase.api.pulse$fn__101423 invoke ""pulse.clj"" 331]
>   [compojure.core$wrap_response$fn__44649 invoke ""core.clj"" 160]
>   [compojure.core$wrap_route_middleware$fn__44633 invoke ""core.clj"" 132]
>   [compojure.core$wrap_route_info$fn__44638 invoke ""core.clj"" 139]
>   [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 151]
>   [clojure.lang.Var invoke ""Var.java"" 393]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 153]
>   [clojure.lang.Var invoke ""Var.java"" 393]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 153]
>   [clojure.lang.Var invoke ""Var.java"" 393]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 153]
>   [clojure.lang.Var invoke ""Var.java"" 393]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 152]
>   [clojure.lang.Var invoke ""Var.java"" 393]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
>   [metabase.pulse.preview$style_tag_nonce_middleware$fn__99572 invoke ""preview.clj"" 165]
>   [metabase.server.middleware.auth$enforce_authentication$fn__94004 invoke ""auth.clj"" 17]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
>   [compojure.core$make_context$handler__44689 invoke ""core.clj"" 290]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 300]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [metabase.api.routes$fn__102030$fn__102033 invoke ""routes.clj"" 67]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
>   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
>   [clojure.lang.AFn applyTo ""AFn.java"" 144]
>   [clojure.core$apply invokeStatic ""core.clj"" 667]
>   [clojure.core$apply invoke ""core.clj"" 662]
>   [metabase.server.routes$fn__102195$fn__102196 doInvoke ""routes.clj"" 72]
>   [clojure.lang.RestFn invoke ""RestFn.java"" 436]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
>   [compojure.core$make_context$handler__44689 invoke ""core.clj"" 290]
>   [compojure.core$make_context$fn__44693 invoke ""core.clj"" 300]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 153]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 153]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 153]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
>   [metabase.server.routes$fn__102180$fn__102182 invoke ""routes.clj"" 49]
>   [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
>   [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
>   [metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__98803 invoke ""exceptions.clj"" 108]
>   [metabase.server.middleware.exceptions$catch_api_exceptions$fn__98800 invoke ""exceptions.clj"" 96]
>   [metabase.server.middleware.log$log_api_call$fn__102464$fn__102465$fn__102466 invoke ""log.clj"" 216]
>   [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invokeStatic ""diagnostic.clj"" 18]
>   [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invoke ""diagnostic.clj"" 12]
>   [metabase.server.middleware.log$log_api_call$fn__102464$fn__102465 invoke ""log.clj"" 208]
>   [toucan2.execute$do_with_call_counts invokeStatic ""execute.clj"" 112]
>   [toucan2.execute$do_with_call_counts invoke ""execute.clj"" 103]
>   [metabase.server.middleware.log$log_api_call$fn__102464 invoke ""log.clj"" 207]
>   [metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__104499 invoke ""browser_cookie.clj"" 40]
>   [metabase.server.middleware.security$add_security_headers$fn__98759 invoke ""security.clj"" 182]
>   [metabase.server.middleware.json$wrap_json_body$fn__46006 invoke ""json.clj"" 67]
>   [metabase.server.middleware.offset_paging$handle_paging$fn__84917 invoke ""offset_paging.clj"" 43]
>   [metabase.server.middleware.json$wrap_streamed_json_response$fn__46024 invoke ""json.clj"" 103]
>   [ring.middleware.keyword_params$wrap_keyword_params$fn__104766 invoke ""keyword_params.clj"" 55]
>   [ring.middleware.params$wrap_params$fn__104785 invoke ""params.clj"" 77]
>   [metabase.server.middleware.misc$maybe_set_site_url$fn__67233 invoke ""misc.clj"" 61]
>   [metabase.server.middleware.session$reset_session_timeout$fn__72656 invoke ""session.clj"" 543]
>   [metabase.server.middleware.session$bind_current_user$fn__72622$fn__72623 invoke ""session.clj"" 438]
>   [metabase.server.middleware.session$do_with_current_user invokeStatic ""session.clj"" 417]
>   [metabase.server.middleware.session$do_with_current_user invoke ""session.clj"" 401]
>   [metabase.server.middleware.session$bind_current_user$fn__72622 invoke ""session.clj"" 437]
>   [metabase.server.middleware.session$wrap_current_user_info$fn__72605 invoke ""session.clj"" 376]
>   [metabase.server.middleware.session$wrap_session_id$fn__72577 invoke ""session.clj"" 255]
>   [metabase.server.middleware.auth$wrap_static_api_key$fn__94012 invoke ""auth.clj"" 30]
>   [ring.middleware.cookies$wrap_cookies$fn__104686 invoke ""cookies.clj"" 194]
>   [metabase.server.middleware.misc$add_content_type$fn__67215 invoke ""misc.clj"" 29]
>   [metabase.server.middleware.misc$disable_streaming_buffering$fn__67241 invoke ""misc.clj"" 78]
>   [ring.middleware.gzip$wrap_gzip$fn__104728 invoke ""gzip.clj"" 86]
>   [metabase.server.middleware.misc$bind_request$fn__67244 invoke ""misc.clj"" 95]
>   [metabase.server.middleware.ssl$redirect_to_https_middleware$fn__104515 invoke ""ssl.clj"" 41]
>   [metabase.server$async_proxy_handler$fn__67655 invoke ""server.clj"" 78]
>   [metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a handle nil -1]
>   [org.eclipse.jetty.server.handler.StatisticsHandler handle ""StatisticsHandler.java"" 173]
>   [org.eclipse.jetty.server.handler.HandlerWrapper handle ""HandlerWrapper.java"" 122]
>   [org.eclipse.jetty.server.Server handle ""Server.java"" 563]
>   [org.eclipse.jetty.server.HttpChannel$RequestDispatchable dispatch ""HttpChannel.java"" 1598]
>   [org.eclipse.jetty.server.HttpChannel dispatch ""HttpChannel.java"" 753]
>   [org.eclipse.jetty.server.HttpChannel handle ""HttpChannel.java"" 501]
>   [org.eclipse.jetty.server.HttpConnection onFillable ""HttpConnection.java"" 287]
>   [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded ""AbstractConnection.java"" 314]
>   [org.eclipse.jetty.io.FillInterest fillable ""FillInterest.java"" 100]
>   [org.eclipse.jetty.io.SelectableChannelEndPoint$1 run ""SelectableChannelEndPoint.java"" 53]
>   [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy runTask ""AdaptiveExecutionStrategy.java"" 421]
>   [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy consumeTask ""AdaptiveExecutionStrategy.java"" 390]
>   [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy tryProduce ""AdaptiveExecutionStrategy.java"" 277]
>   [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy run ""AdaptiveExecutionStrategy.java"" 199]
>   [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run ""ReservedThreadExecutor.java"" 411]
>   [org.eclipse.jetty.util.thread.QueuedThreadPool runJob ""QueuedThreadPool.java"" 969]
>   [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner doRunJob ""QueuedThreadPool.java"" 1194]
>   [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run ""QueuedThreadPool.java"" 1149]
>   [java.lang.Thread run nil -1]],
>  :cause ""Unsupported field: MonthOfYear"",
>  :message ""Unsupported field: MonthOfYear""}
> 

**To Reproduce**
Steps to reproduce the behavior:
1. Create question with time field
2. Add to dashboard
3. Create subscription and email

**Expected behavior**
Email gets generated and sent

**Severity**
High severity for us as reports are mostly driven by Time fields

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.4.0-162-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""sqlserver"",
      ""h2"",
      ""oracle"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""13.2 (Debian 13.2-1.pgdg100+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-22"",
      ""tag"": ""v0.49.7"",
      ""hash"": ""f0ff786""
    },
    ""settings"": {
      ""report-timezone"": ""America/Los_Angeles""
    }
  }
}
```",raymondvchan,2024-04-26 18:21:37+00:00,[],2025-02-04 20:28:51+00:00,,https://github.com/metabase/metabase/issues/41897,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Alerts', ''), ('.Backend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2084932102, 'issue_id': 2266292781, 'author': 'zbodi74', 'body': ""@raymondvchan - Could you provide more details on how to reproduce the error? It would be helpful to know the type of database, DDL, the question and visualization settings you're using.\r\n\r\nI couldn't reproduce this on 49.7 using the default table visualization and the following DDL / DML:\r\nCREATE TABLE sample_schedule (\r\n                          id SERIAL PRIMARY KEY,\r\n                          date DATE NOT NULL,\r\n                          time TIME\r\n);\r\nINSERT INTO sample_schedule (date, time) VALUES\r\n                                      ('2024-07-13', NULL),\r\n                                      ('2024-07-13', NULL),\r\n                                      ('2024-04-25', '11:00:00'),\r\n                                      ('2024-04-18', '11:00:00'),\r\n                                      ('2024-04-25', '11:00:00');"", 'created_at': datetime.datetime(2024, 4, 30, 10, 25, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168987048, 'issue_id': 2266292781, 'author': 'paoliniluis', 'body': '@raymondvchan can you check the last comment?', 'created_at': datetime.datetime(2024, 6, 15, 0, 34, 58, tzinfo=datetime.timezone.utc)}]","zbodi74 on (2024-04-30 10:25:04 UTC): @raymondvchan - Could you provide more details on how to reproduce the error? It would be helpful to know the type of database, DDL, the question and visualization settings you're using.

I couldn't reproduce this on 49.7 using the default table visualization and the following DDL / DML:
CREATE TABLE sample_schedule (
                          id SERIAL PRIMARY KEY,
                          date DATE NOT NULL,
                          time TIME
);
INSERT INTO sample_schedule (date, time) VALUES
                                      ('2024-07-13', NULL),
                                      ('2024-07-13', NULL),
                                      ('2024-04-25', '11:00:00'),
                                      ('2024-04-18', '11:00:00'),
                                      ('2024-04-25', '11:00:00');

paoliniluis on (2024-06-15 00:34:58 UTC): @raymondvchan can you check the last comment?

"
2266290555,issue,open,,"Pivot tables have invalid `result_metadata` and this results in dashboard click behavior not showing the right column names in ""values you can reference""","### Describe the bug

1) Build a pivot table like
![image](https://github.com/metabase/metabase/assets/1711649/661596cd-7de0-467f-bfaa-c81ffee23b9d)

First quirk:
- you can't zoom in on the source, but you can do it on the ratings, counts or sums
![image](https://github.com/metabase/metabase/assets/1711649/6b453af3-60c6-4802-87b6-899927398021)
![image](https://github.com/metabase/metabase/assets/1711649/726af4af-c98e-4b43-a793-2de58ebee884)
![image](https://github.com/metabase/metabase/assets/1711649/6691adf3-b943-4363-bab1-bb6b527d00f0)

- if you configure the click behavior to send to a URL, the values you can use have not the right names: 
![image](https://github.com/metabase/metabase/assets/1711649/b9def3b4-7ab2-437d-ba41-59d4f9ddcc27)

- also +1 on the above issue: the columns source and rating don't appear for selection, although I believe (based on the second video of https://github.com/metabase/metabase/pull/39569) that they are both there in the metadata

- when clicking on the product rating or source, the click behaviour doesn't work
![pivot_table_cb](https://github.com/metabase/metabase/assets/1711649/7b1b5ac6-e539-41ab-9c4d-afd76f3d7110)



### To Reproduce

See above

### Expected behavior

All those cases should work

### Logs

NA

### Information about your Metabase installation

```JSON
v49
```


### Severity

P2

### Additional context

NA",paoliniluis,2024-04-26 18:19:53+00:00,[],2025-02-04 20:31:57+00:00,,https://github.com/metabase/metabase/issues/41896,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('Reporting/Dashboards/Click Behavior', ''), ('Querying/Drill Thrus', 'Refining existing queries with Drill Thrus'), ('.Team/Querying', '')]","[{'comment_id': 2147839927, 'issue_id': 2266290555, 'author': 'bshepherdson', 'body': 'The first of those quirks is coming from MBQL lib, which doesn\'t return a ""Zoom in"" drill for category columns - only for bins, time series and geography. This is WAI, though perhaps we really want it to work differently on pivot tables.\r\n\r\nThere\'s nothing to ""zoom in"" on for a category. We can\'t show you any finer detail, only filter to that category. That\'s what `= Doohickey` does, and that works. We could create a ""zoom in"" drill that did the same thing as the `=` filter, though that\'s a weird special case.\r\n\r\nThe other points I think are FE issues.', 'created_at': datetime.datetime(2024, 6, 4, 15, 34, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2187189634, 'issue_id': 2266290555, 'author': 'cdeweyx', 'body': 'Click behavior piece of this is the P1 here. [More context](https://metaboat.slack.com/archives/C064QMXEV9N/p1719254337822969).', 'created_at': datetime.datetime(2024, 6, 24, 18, 45, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2197138128, 'issue_id': 2266290555, 'author': 'cdeweyx', 'body': 'See first message in [this ticket](https://metabase.zendesk.com/agent/tickets/27305) for a repro video', 'created_at': datetime.datetime(2024, 6, 28, 15, 3, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2227566171, 'issue_id': 2266290555, 'author': 'perivamsi', 'body': 'Repro question https://stats.metabase.com/question/18727-repro-for-41896', 'created_at': datetime.datetime(2024, 7, 15, 1, 18, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2227582699, 'issue_id': 2266290555, 'author': 'perivamsi', 'body': 'There are 3 issues mentioned in this ticket\n\n1. Zoom in does not appear for category drill downs: This is expected.\n2. When a pivot table is added to a dashboard, during defining a custom click behavior, all the field refs don\'t appear in the ""values you can refer"" column and even when they do, they show up as weird strings. This is a problem and I will rename this issue to reflect that.\n3. Click behavior does not work on product rating or source - this is not reproducible, click behavior works for those columns.', 'created_at': datetime.datetime(2024, 7, 15, 1, 47, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2436169369, 'issue_id': 2266290555, 'author': 'ranquild', 'body': ""The problem is that `dashboard.dashcards[0].card.result_metadata` for this dashboard is not correct and does not include all aggregation columns. That's why the last 2 last aggregation columns do not appear in the `Values you can reference` list. It's interesting that the missing columns are actually available in query results. It seems to be a BE bug with `result_metadata` and not a FE issue.\n\n![Image](https://github.com/user-attachments/assets/9e95bfc8-9ca7-41a7-9f06-95f232d365f4)\n![Image](https://github.com/user-attachments/assets/6c60b126-7d8f-4655-a733-eecb2b58b15c)"", 'created_at': datetime.datetime(2024, 10, 24, 19, 20, 27, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2024-06-04 15:34:56 UTC): The first of those quirks is coming from MBQL lib, which doesn't return a ""Zoom in"" drill for category columns - only for bins, time series and geography. This is WAI, though perhaps we really want it to work differently on pivot tables.

There's nothing to ""zoom in"" on for a category. We can't show you any finer detail, only filter to that category. That's what `= Doohickey` does, and that works. We could create a ""zoom in"" drill that did the same thing as the `=` filter, though that's a weird special case.

The other points I think are FE issues.

cdeweyx on (2024-06-24 18:45:09 UTC): Click behavior piece of this is the P1 here. [More context](https://metaboat.slack.com/archives/C064QMXEV9N/p1719254337822969).

cdeweyx on (2024-06-28 15:03:37 UTC): See first message in [this ticket](https://metabase.zendesk.com/agent/tickets/27305) for a repro video

perivamsi on (2024-07-15 01:18:41 UTC): Repro question https://stats.metabase.com/question/18727-repro-for-41896

perivamsi on (2024-07-15 01:47:47 UTC): There are 3 issues mentioned in this ticket

1. Zoom in does not appear for category drill downs: This is expected.
2. When a pivot table is added to a dashboard, during defining a custom click behavior, all the field refs don't appear in the ""values you can refer"" column and even when they do, they show up as weird strings. This is a problem and I will rename this issue to reflect that.
3. Click behavior does not work on product rating or source - this is not reproducible, click behavior works for those columns.

ranquild on (2024-10-24 19:20:27 UTC): The problem is that `dashboard.dashcards[0].card.result_metadata` for this dashboard is not correct and does not include all aggregation columns. That's why the last 2 last aggregation columns do not appear in the `Values you can reference` list. It's interesting that the missing columns are actually available in query results. It seems to be a BE bug with `result_metadata` and not a FE issue.

![Image](https://github.com/user-attachments/assets/9e95bfc8-9ca7-41a7-9f06-95f232d365f4)
![Image](https://github.com/user-attachments/assets/6c60b126-7d8f-4655-a733-eecb2b58b15c)

"
2266148243,issue,closed,completed,Views are logged for cards in a dashboard even if the user didn't view the tab,"### Describe the bug

If a user views a dashboard, we add a `view_log` record and increment the `report_card.view_count` column for each card in the dashboard. If the dashboard has multiple tabs, we'll log views for cards on all tabs, even if the user never viewed it. We should only log and count views for the tabs users view.

[slack conversation](https://metaboat.slack.com/archives/C0641E4PB9B/p1714143102927189?thread_ts=1714129699.563259&cid=C0641E4PB9B)

### To Reproduce

1. Create a dashboard with a question in the second tab. Save it and view the first tab without viewing the second.
2. Query the app DB: `select * from view_log where model = 'card' and model_id = <id>;`, where <id> is the ID of the question.
You should see views for the question, even though you never visited the first tab.

### Expected behavior

views should only be logged if the user clicks on the tab containing the card.

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```


### Severity

low

### Additional context

_No response_",calherries,2024-04-26 16:45:58+00:00,['calherries'],2024-06-03 17:55:30+00:00,2024-05-31 23:51:43+00:00,https://github.com/metabase/metabase/issues/41892,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('.Backend', ''), ('.Team/Workflows', 'aka BEC'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2107501665, 'issue_id': 2266148243, 'author': 'luizarakaki', 'body': 'This is a high-priority P2 imo. Our audit logs must be right', 'created_at': datetime.datetime(2024, 5, 13, 12, 53, 56, tzinfo=datetime.timezone.utc)}]","luizarakaki on (2024-05-13 12:53:56 UTC): This is a high-priority P2 imo. Our audit logs must be right

"
2266017431,issue,closed,completed,Slack integration uses a deprecated API,"### Describe the bug

Slack integration uses a deprecated endpoint to upload files.

https://api.slack.com/changelog/2024-04-a-better-way-to-upload-files-is-here-to-stay
> The original web API method for uploading files to Slack, [files.upload](https://api.slack.com/methods/files.upload), is being sunset on March 11, 2025. Beginning May 8, 2024, newly-created apps will be unable to use this API method.
> 
> Apps & integrations should migrate away from files.upload and instead leverage a combination of two APIs: [files.getUploadURLExternal](https://api.slack.com/methods/files.getUploadURLExternal) and [files.completeUploadExternal](https://api.slack.com/methods/files.completeUploadExternal). The use of these two methods is more reliable, especially when uploading large files.
> 


### To Reproduce

n/a

### Expected behavior

Use the endpoints recommended instead of the deprecated one.

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```


### Severity

P1 - beginning May 8 it won't be possible to set up a new Slack integration

### Additional context

https://github.com/metabase/metabase/blob/dd66a69a264c10fe6cadb1860a45a77a1b5061d6/src/metabase/integrations/slack.clj#L321-L342",zbodi74,2024-04-26 15:23:34+00:00,['calherries'],2024-05-10 08:32:44+00:00,2024-04-30 14:19:01+00:00,https://github.com/metabase/metabase/issues/41890,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Alerts', ''), ('Notifications/Slack', ''), ('.Escalation', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2079612106, 'issue_id': 2266017431, 'author': 'paoliniluis', 'body': '![image](https://github.com/metabase/metabase/assets/1711649/fe6f97b8-7012-4503-a445-52e843f31816)', 'created_at': datetime.datetime(2024, 4, 26, 15, 25, 16, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-26 15:25:16 UTC): ![image](https://github.com/metabase/metabase/assets/1711649/fe6f97b8-7012-4503-a445-52e843f31816)

"
2265951348,issue,open,,"Dashboard should render empty cards till the ""required filter"" is selected","**Is your feature request related to a problem? Please describe.**
We launched the ""make filter required"" in v49, which many users love, but you need to set a default value to make it work.

**Describe the solution you'd like**
A customer requested that we make a slight change: remove the ""default value"" requirement. But render the dashboard blank when it loads on the first try

**Describe alternatives you've considered**
There's a weird workaround:
- set the filter to an input box
- set the default value to a random text
- then change the filter to a category
- make the filter mandatory

**How important is this feature to you?**
Requested by a customer

**Additional context**
NA
",paoliniluis,2024-04-26 14:49:35+00:00,[],2025-02-04 20:29:49+00:00,,https://github.com/metabase/metabase/issues/41888,"[('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]",[],
2265827976,issue,closed,not_planned,Examples in the extract column drill thru do not follow formatting rules,"### Describe the bug

The examples in the extract column drop down do not follow the users' formatting settings.

### To Reproduce

1. Browse data
2. Accounts
3. Click the Created At header
4. Select Extract day, month...
5. The examples do not follow formatting 

It shows `2023, 2024` but when you extract the values the values are formatted as `2,023` and `2,024`.

### Expected behavior

Examples should follow the users settings

### Logs

_none_

### Information about your Metabase installation

```JSON
- Metabase on master 40b17c926c40d524527a902521a8c683572089f8
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-04-26 13:46:36+00:00,[],2024-04-27 08:44:11+00:00,2024-04-27 08:44:11+00:00,https://github.com/metabase/metabase/issues/41884,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]",[],
2265827356,issue,open,,Examples in the extract column drill thru do not follow formatting rules,"### Describe the bug

The examples in the extract column drop down do not follow the users' formatting settings.

### To Reproduce

1. Browse data
2. Accounts
3. Click the Created At header
4. Select Extract day, month...
5. The examples do not follow formatting 

It shows `2023, 2024` but when you extract the values the values are formatted as `2,023` and `2,024`.

### Expected behavior

Examples should follow the users settings

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Metabase on master 40b17c926c40d524527a902521a8c683572089f8
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-04-26 13:46:16+00:00,[],2024-05-20 13:46:32+00:00,,https://github.com/metabase/metabase/issues/41883,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]",[],
2265585314,issue,closed,not_planned,Missing png export enum in API POST /api/card/:card-id/query/:export-format,"### Describe the bug

The `png` export-format is not supported on the [API](https://www.metabase.com/docs/latest/api/card#post-apicardcard-idqueryexport-format)

### To Reproduce

1. Get a token
2. Call `curl -H 'x-api-key: API_KEY' -X POST 'https://MB_HOST/api/card/694/query/png'`
3. The result is `{""errors"":{""export-format"":""enum of csv, api, xlsx, json""},""specific-errors"":{""export-format"":[""should be either csv, api, xlsx or json, received: \""png\""""]}}`


### Expected behavior

A png image should be returned

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:124.0) Gecko/20100101 Firefox/124.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.11.0-49-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""googleanalytics""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""13.4 (Debian 13.4-1.pgdg100+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-22"",
      ""tag"": ""v0.49.7"",
      ""hash"": ""f0ff786""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Brussels""
    }
  }
}
```


### Severity

It is blocking our automation

### Additional context

_No response_",turran,2024-04-26 11:29:03+00:00,[],2024-04-27 08:46:38+00:00,2024-04-27 08:46:37+00:00,https://github.com/metabase/metabase/issues/41879,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2079324334, 'issue_id': 2265585314, 'author': 'paoliniluis', 'body': ""Sorry, what are you trying to do? the PNG export is a frontend concept, we don't have a backend logic for generating something like a front end screenshot (it's handled by html2canvas)"", 'created_at': datetime.datetime(2024, 4, 26, 12, 48, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079740185, 'issue_id': 2265585314, 'author': 'turran', 'body': ""I was trying to programmatically fetch the generated image of a card/question. I saw on https://github.com/metabase/metabase/issues/4701 that this was supported. I wasn't aware this is a frontend concept. Are other export formats generated on the backend?"", 'created_at': datetime.datetime(2024, 4, 26, 16, 47, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2080419597, 'issue_id': 2265585314, 'author': 'paoliniluis', 'body': ""The PDF export of the dashboard and the PNG export of the cards are pure frontend.\r\n\r\nClosing this as I don't believe we'll do this anytime soon"", 'created_at': datetime.datetime(2024, 4, 27, 8, 46, 37, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-26 12:48:38 UTC): Sorry, what are you trying to do? the PNG export is a frontend concept, we don't have a backend logic for generating something like a front end screenshot (it's handled by html2canvas)

turran (Issue Creator) on (2024-04-26 16:47:03 UTC): I was trying to programmatically fetch the generated image of a card/question. I saw on https://github.com/metabase/metabase/issues/4701 that this was supported. I wasn't aware this is a frontend concept. Are other export formats generated on the backend?

paoliniluis on (2024-04-27 08:46:37 UTC): The PDF export of the dashboard and the PNG export of the cards are pure frontend.

Closing this as I don't believe we'll do this anytime soon

"
2264852385,issue,open,,GeoJSON map silently fails to load,"**Describe the bug**
I'm trying to use map visualization i have the goejson attached and i fill all the feilds and it doesnt wok just shows me empty page 

**To Reproduce**
Steps to reproduce the behavior:
1. Go to 'Settings'
2. Click on 'map'


4. See error
![Screenshot 2024-04-26 at 05 41 37](https://github.com/metabase/metabase/assets/34497804/e316fdd3-8ba5-42b8-bdbc-2e8c833a1131)

**Expected behavior**
A clear and concise description of what you expected to happen.
the map to show with the regions
**Screenshots**
If applicable, add screenshots to help explain your problem.
![Screenshot 2024-04-26 at 05 41 37](https://github.com/metabase/metabase/assets/34497804/e316fdd3-8ba5-42b8-bdbc-2e8c833a1131)

**Severity**
How severe an issue is this bug to you? Is this annoying, blocking some users, blocking an upgrade or blocking your usage of Metabase entirely?
Note: the more honest and specific you are here the more we will take you seriously.
not high
**Additional context**
Add any other context about the problem here.

**Metabase Diagnostic Info**
im using the public metabaseapp i also attached the file i tried both files non of them work
[regions.json](https://github.com/metabase/metabase/files/15124691/regions.json)

[map.json](https://github.com/metabase/metabase/files/15124689/map.json)


```json
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.213-201.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2"",
      ""mysql""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v1.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""Asia/Riyadh""
    }
  }
}
```",CovertError,2024-04-26 02:45:10+00:00,[],2024-05-31 17:35:37+00:00,,https://github.com/metabase/metabase/issues/41869,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Visualization/Maps', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('.Needs Clarification', 'Issue is incomplete or missing actionable information.')]","[{'comment_id': 2078847494, 'issue_id': 2264852385, 'author': 'paoliniluis', 'body': 'Can you please open the browser developer tools on the console and show the error when you click on the ""add map"" button?', 'created_at': datetime.datetime(2024, 4, 26, 8, 3, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2080049436, 'issue_id': 2264852385, 'author': 'CovertError', 'body': 'The issue is there is no error it just doesn’t do anything when I choose visualization and then I choose the the map it’s just a blank screen I use the metabase public app', 'created_at': datetime.datetime(2024, 4, 26, 20, 6, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2082516016, 'issue_id': 2264852385, 'author': 'adam-trevo', 'body': 'Hi I had a similar issue when using a map not in WGS84. I used geopandas to convert to WGS84 crs created a new geojson and it worked. Can you please check if this is your case? Anyway, metabase should warn of the issue.', 'created_at': datetime.datetime(2024, 4, 29, 11, 49, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2083472724, 'issue_id': 2264852385, 'author': 'paoliniluis', 'body': '@CovertError so you say that there’s no error in the browser console, is that correct?', 'created_at': datetime.datetime(2024, 4, 29, 19, 10, 17, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-26 08:03:47 UTC): Can you please open the browser developer tools on the console and show the error when you click on the ""add map"" button?

CovertError (Issue Creator) on (2024-04-26 20:06:19 UTC): The issue is there is no error it just doesn’t do anything when I choose visualization and then I choose the the map it’s just a blank screen I use the metabase public app

adam-trevo on (2024-04-29 11:49:24 UTC): Hi I had a similar issue when using a map not in WGS84. I used geopandas to convert to WGS84 crs created a new geojson and it worked. Can you please check if this is your case? Anyway, metabase should warn of the issue.

paoliniluis on (2024-04-29 19:10:17 UTC): @CovertError so you say that there’s no error in the browser console, is that correct?

"
2264841196,issue,closed,not_planned,map with goejson ,"**Describe the bug**
A clear and concise description of what the bug is.

**Logs**
Please include javascript console and server logs around the time this bug occurred. For information about how to get these, consult our [bug troubleshooting guide](https://metabase.com/docs/latest/troubleshooting-guide/bugs.html)

**To Reproduce**
Steps to reproduce the behavior:
1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**Severity**
How severe an issue is this bug to you? Is this annoying, blocking some users, blocking an upgrade or blocking your usage of Metabase entirely?
Note: the more honest and specific you are here the more we will take you seriously.

**Additional context**
Add any other context about the problem here.

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.213-201.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2"",
      ""mysql""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v1.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""Asia/Riyadh""
    }
  }
}
```",CovertError,2024-04-26 02:31:39+00:00,[],2024-04-26 07:59:46+00:00,2024-04-26 07:59:46+00:00,https://github.com/metabase/metabase/issues/41868,[],[],
2264788762,issue,closed,completed,"Snowflake always returns times truncated second precision, we should fix this for tests","Mostly important for tests, since all of the other DBs use millisecond precision meaning Snowflake results are different for no reason.

The default output format is `HH24:MI:SS` apparently 

https://docs.snowflake.com/en/sql-reference/parameters#time-output-format

```clj
(mt/test-driver :snowflake
  (mt/with-temporary-setting-values [report-timezone ""US/Pacific""]
    (mt/dataset attempted-murders
      (mt/rows
       (qp/process-query
        (-> (mt/native-query
              {:query ""SELECT time '00:23:18.331', '00:23:18.331'::time(9), time_from_parts(0, 23, 18, 123456789)""})
            (assoc-in [:middleware :format-rows?] false)))))))
;; => [[#t ""00:23:18"" #t ""00:23:18"" #t ""00:23:18""]]
```
",camsaul,2024-04-26 01:48:07+00:00,['camsaul'],2024-08-28 02:10:44+00:00,2024-05-01 03:24:21+00:00,https://github.com/metabase/metabase/issues/41866,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Processor', ''), ('.CI & Tests', ''), ('Database/Snowflake', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2264721992,issue,closed,completed,Snowflake UNIX timestamps interpreted as being in report timezone rather than UTC,"Leads to wrong values and incorrect results when filtering.

This is broken; see `metabase.query-processor-test.date-bucketing-test/sanity-check-test` (disabled for Snowflake) for example.",camsaul,2024-04-26 00:42:01+00:00,['camsaul'],2024-08-28 02:10:44+00:00,2024-05-01 03:24:20+00:00,https://github.com/metabase/metabase/issues/41863,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Processor', ''), ('.Correctness', ''), ('Database/Snowflake', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2264453436,issue,closed,completed,Issues connecting to Snowflake using RSA Keypair Authentication,"### Describe the bug

1.) We can not setup a connection to Snowflake using just a user account and private key. You'll receive the following:

> Private key provided is invalid or not supported: /private/var/folders/4r/57lvgm8n4xd4fw3cmtlr3p000000gn/T/metabase-secret_4618509373001869555.tmp: java.security.InvalidKeyException: IOException : DER input, Integer tag error

<br>

2.) Once a connection to Snowflake has been setup by entering a password along with a private key, we're using password for the primary authentication factor.


### To Reproduce

1.) I went through the steps provided in the following article and tested using a non encrypted and encrypted key.
https://docs.snowflake.com/en/user-guide/key-pair-auth

<br>

2.) I setup a database connection to Snowflake within Metabase without a password to receive the error:
> Private key provided is invalid or not supported: /private/var/folders/4r/57lvgm8n4xd4fw3cmtlr3p000000gn/T/metabase-secret_4618509373001869555.tmp: java.security.InvalidKeyException: IOException : DER input, Integer tag error

<br>

3.) I proceeded to add a password to the database setup in Metabase in order to establish connectivity to Snowflake

<br>

4.) I  confirmed the public fingerprint being used for the account in Snowflake and public key matches.
```
DESC USER <my user account>;
SELECT TRIM((SELECT ""value"" FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()))
  WHERE ""property"" = 'RSA_PUBLIC_KEY_FP'), 'SHA256:');
```

<br>

5.) I created a Node app using the example from[ Snowflake for Node app](https://docs.snowflake.com/en/developer-guide/node-js/nodejs-driver-authenticate#label-nodejs-key-pair-authentication) to test connectivity.

<br>

6.) Used the following query to show login history and the difference between Metabase and the Node app. 

```
SELECT *
FROM TABLE(snowflake.information_schema.login_history_by_user(USER_NAME => '<your user account>', result_limit => 10))
ORDER BY event_timestamp DESC;
```
<br>

Note the Node app using RSA Key pair for the primary authentication factor

<br>

<img width=""804"" alt=""Screenshot 2024-04-22 at 11 05 36 AM"" src=""https://github.com/metabase/metabase-private/assets/17398657/05cd36ab-1e55-4cb3-9bf3-3f4504c5fe2b"">


### Expected behavior

To be able to use RSA Key Pair Authentication

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""13.5.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""America/Chicago""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mongo"",
      ""bigquery-cloud-sdk"",
      ""snowflake"",
      ""mysql"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.3""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v1.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""UTC""
    }
  }
}
```


### Severity

P1 - Concern for users intending to use RSA authentication

### Additional context

Other related issues going back a year:
https://github.com/metabase/metabase/issues/31273
https://github.com/metabase/metabase/issues/26078
https://github.com/metabase/metabase-private/issues/194

<br>
<br>


Example Node app as reference

```
import crypto from 'crypto';
import fs from 'fs';
import snowflake from 'snowflake-sdk';

const privateKeyFile = fs.readFileSync('path to private p8 key');

const privateKeyObject = crypto.createPrivateKey({
  key: privateKeyFile,
  format: 'pem',
  passphrase: 'your token secret key/password'
});


const privateKey = privateKeyObject.export({
  format: 'pem',
  type: 'pkcs8'
});


const connection = snowflake.createConnection({
  authenticator: ""SNOWFLAKE_JWT"",
  privateKey: privateKey,
  account: 'your account name', // <-- Example: GK592.us-west-1.aws 
  username: 'user name used for authentication' 
});


function handleConnectionResult(err, conn) {
    if (err) {
      console.error(""Connection error:"", err); 
    
      return;
    }
  
    if (conn) {
      console.log(`Successfully connected. Connection ID: ${conn.getId()}`);
    } else {
      console.warn(""No connection returned from Snowflake.""); 
    }
  }
  

  connection.connect(handleConnectionResult);
```
",FilmonK,2024-04-25 20:36:39+00:00,['lbrdnk'],2025-02-07 23:30:57+00:00,2024-04-29 21:30:45+00:00,https://github.com/metabase/metabase/issues/41852,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Snowflake', ''), ('.Backend', ''), ('.Escalation', ''), ('.Team/Querying', '')]","[{'comment_id': 2078504609, 'issue_id': 2264453436, 'author': 'camsaul', 'body': ""We're using the Snowflake JDBC driver, not Node, do you have an example of it working with that? https://docs.snowflake.com/en/developer-guide/jdbc/jdbc"", 'created_at': datetime.datetime(2024, 4, 26, 2, 13, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079500086, 'issue_id': 2264453436, 'author': 'FilmonK', 'body': '@camsaul Sorry for the confusion, I understand we use the JDBC driver. \r\nThe reason I referenced Node is to compare the authentication factor Snowflake identifies when Metabase currently connects (Password factor) versus Node app (RSA Key factor).\r\nBetter shown in the image above under the ""First_Authentication_Factor"" column.\r\n\r\nI can give it a try later today with JDBC drivers.', 'created_at': datetime.datetime(2024, 4, 26, 14, 24, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2093287699, 'issue_id': 2264453436, 'author': 'Adovenmuehle', 'body': ""This didn't quite fix the issue. When attempting to save the `.p8` file without a password entered in the GUI, it fails and says `Looks like the database name is incorrect.` (If I save it with the password it works fine without changing any other parameters.) \r\nStrangely, it actually successfully logs in with the RSA Keypair\r\n```sql\r\nselect *\r\nfrom table(snowflake.information_schema.login_history_by_user(USER_NAME => 'METABASE', result_limit => 1000))\r\norder by event_timestamp desc;\r\n```\r\n![image](https://github.com/metabase/metabase/assets/27858/4cf75df2-2ecc-4c35-9e29-759f390bd5c0)\r\nHowever, it doesn't continue to use the keypair auth because it doesn't persist it. If you leave the page it'll warn you about discarding your changes and if you come back it'll revert to the password. It also reverts back to using password auth when logging in to snowflake."", 'created_at': datetime.datetime(2024, 5, 3, 15, 55, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2094786784, 'issue_id': 2264453436, 'author': 'lbrdnk', 'body': ""Hey @Adovenmuehle, I'm able to connect a cloud (also local) Metabase instance to Snowflake using private key. However, when my user's role does not have required privileges on the database I'm attempting to connect, I see the same error as you.\r\n\r\nI believe that every user should have the `SNOWFLAKE_SAMPLE_DATA` database accessible. Could you try to connect to that db? What's the result?\r\n\r\nThen, here's how I created the database and the user for testing: I've logged in as user that has privileges required to create a new user, database and grant privileges. Afterwards I've created the user and the database as follows.\r\n\r\n```\r\ncreate user ANOTHER_RSA_TEST_USER;\r\nalter user ANOTHER_RSA_TEST_USER set default_role = public;\r\nalter user ANOTHER_RSA_TEST_USER set rsa_public_key = <public key>;\r\n\r\ncreate database ANOTHER_RSA_TEST_DB;\r\ncreate table ANOTHER_RSA_TEST_DB.PUBLIC.ANOTHER_RSA_TEST_TABLE (id integer, name varchar);\r\ninsert into ANOTHER_RSA_TEST_DB.PUBLIC.ANOTHER_RSA_TEST_TABLE (id, name) values (1, 'John');\r\n\r\ngrant usage on database ANOTHER_RSA_TEST_DB to role PUBLIC;\r\ngrant usage on all schemas in database ANOTHER_RSA_TEST_DB to role PUBLIC;\r\ngrant select on all tables in database ANOTHER_RSA_TEST_DB to role PUBLIC;\r\n```\r\n\r\nWould you be able to setup the user and the database as described and try to connect using private key? If so, please make sure to input database name in case sensitive manner -- all caps in this case."", 'created_at': datetime.datetime(2024, 5, 5, 12, 23, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2146454961, 'issue_id': 2264453436, 'author': 'bombadil444', 'body': 'Came across same issue as @Adovenmuehle above when switching from Snowflake passphrase auth to key/pair auth.\r\n\r\nIn Snowflake, I needed to set a default role on the user I was trying to connect with that had access to the database. This resolved the issue.\r\n\r\nThe ""Role (required for connection impersonation)"" field seemed to work for passphrase auth, but apparently no longer applied when authenticating with a private key.\r\n\r\nThe `Looks like the database name is incorrect.` error message is generally unhelpful as it can pop up when the issue is actually to do with permissions.', 'created_at': datetime.datetime(2024, 6, 4, 2, 31, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2147761551, 'issue_id': 2264453436, 'author': 'Adovenmuehle', 'body': ""@bombadil444 your suggestion fixed it. However, one interesting thing, I _did_ have a default role set but it was lower case, I changed it to uppercase and it seemed to work. \r\n\r\nI now show the RSA_KEYPAIR auth in `FIRST_AUTHENTICATION_FACTOR` from \r\n```sql\r\nselect *\r\nfrom table(snowflake.information_schema.login_history_by_user(USER_NAME => 'METABASE', result_limit => 1000))\r\norder by event_timestamp desc;\r\n```\r\n\r\nOne slightly weird thing, when going back to the database settings page after saving it with the `.p8` file and no password, it shows `No file chosen` for the private key file, but a populated password.\r\n![image](https://github.com/metabase/metabase/assets/27858/5ba633b4-e92a-47f1-957e-78214cdae95b)\r\nI thought maybe it had reverted or my 1password was auto-filling it, but it's using the keypair authentication according to Snowflake so I'll trust that."", 'created_at': datetime.datetime(2024, 6, 4, 15, 0, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2644321428, 'issue_id': 2264453436, 'author': 'Numianlo', 'body': 'Connecting to Snowflake using RSA Keypair Authentication, getting the ""Looks like the database name is incorrect""\n\nTo solve this set a defaul_role on the user.\nexample: ALTER USER your_user SET DEFAULT_ROLE = <your_role> ;\n\nIf the user already has a default role,  but you are connecting using another role that this user also has, then you need to set the DEFAULT_SECONDARY_ROLES.\nexample: ALTER USER your_user SET DEFAULT_SECONDARY_ROLES = ( \'ALL\' );', 'created_at': datetime.datetime(2025, 2, 7, 23, 30, 55, tzinfo=datetime.timezone.utc)}]","camsaul on (2024-04-26 02:13:44 UTC): We're using the Snowflake JDBC driver, not Node, do you have an example of it working with that? https://docs.snowflake.com/en/developer-guide/jdbc/jdbc

FilmonK (Issue Creator) on (2024-04-26 14:24:24 UTC): @camsaul Sorry for the confusion, I understand we use the JDBC driver. 
The reason I referenced Node is to compare the authentication factor Snowflake identifies when Metabase currently connects (Password factor) versus Node app (RSA Key factor).
Better shown in the image above under the ""First_Authentication_Factor"" column.

I can give it a try later today with JDBC drivers.

Adovenmuehle on (2024-05-03 15:55:36 UTC): This didn't quite fix the issue. When attempting to save the `.p8` file without a password entered in the GUI, it fails and says `Looks like the database name is incorrect.` (If I save it with the password it works fine without changing any other parameters.) 
Strangely, it actually successfully logs in with the RSA Keypair
```sql
select *
from table(snowflake.information_schema.login_history_by_user(USER_NAME => 'METABASE', result_limit => 1000))
order by event_timestamp desc;
```
![image](https://github.com/metabase/metabase/assets/27858/4cf75df2-2ecc-4c35-9e29-759f390bd5c0)
However, it doesn't continue to use the keypair auth because it doesn't persist it. If you leave the page it'll warn you about discarding your changes and if you come back it'll revert to the password. It also reverts back to using password auth when logging in to snowflake.

lbrdnk (Assginee) on (2024-05-05 12:23:17 UTC): Hey @Adovenmuehle, I'm able to connect a cloud (also local) Metabase instance to Snowflake using private key. However, when my user's role does not have required privileges on the database I'm attempting to connect, I see the same error as you.

I believe that every user should have the `SNOWFLAKE_SAMPLE_DATA` database accessible. Could you try to connect to that db? What's the result?

Then, here's how I created the database and the user for testing: I've logged in as user that has privileges required to create a new user, database and grant privileges. Afterwards I've created the user and the database as follows.

```
create user ANOTHER_RSA_TEST_USER;
alter user ANOTHER_RSA_TEST_USER set default_role = public;
alter user ANOTHER_RSA_TEST_USER set rsa_public_key = <public key>;

create database ANOTHER_RSA_TEST_DB;
create table ANOTHER_RSA_TEST_DB.PUBLIC.ANOTHER_RSA_TEST_TABLE (id integer, name varchar);
insert into ANOTHER_RSA_TEST_DB.PUBLIC.ANOTHER_RSA_TEST_TABLE (id, name) values (1, 'John');

grant usage on database ANOTHER_RSA_TEST_DB to role PUBLIC;
grant usage on all schemas in database ANOTHER_RSA_TEST_DB to role PUBLIC;
grant select on all tables in database ANOTHER_RSA_TEST_DB to role PUBLIC;
```

Would you be able to setup the user and the database as described and try to connect using private key? If so, please make sure to input database name in case sensitive manner -- all caps in this case.

bombadil444 on (2024-06-04 02:31:09 UTC): Came across same issue as @Adovenmuehle above when switching from Snowflake passphrase auth to key/pair auth.

In Snowflake, I needed to set a default role on the user I was trying to connect with that had access to the database. This resolved the issue.

The ""Role (required for connection impersonation)"" field seemed to work for passphrase auth, but apparently no longer applied when authenticating with a private key.

The `Looks like the database name is incorrect.` error message is generally unhelpful as it can pop up when the issue is actually to do with permissions.

Adovenmuehle on (2024-06-04 15:00:53 UTC): @bombadil444 your suggestion fixed it. However, one interesting thing, I _did_ have a default role set but it was lower case, I changed it to uppercase and it seemed to work. 

I now show the RSA_KEYPAIR auth in `FIRST_AUTHENTICATION_FACTOR` from 
```sql
select *
from table(snowflake.information_schema.login_history_by_user(USER_NAME => 'METABASE', result_limit => 1000))
order by event_timestamp desc;
```

One slightly weird thing, when going back to the database settings page after saving it with the `.p8` file and no password, it shows `No file chosen` for the private key file, but a populated password.
![image](https://github.com/metabase/metabase/assets/27858/5ba633b4-e92a-47f1-957e-78214cdae95b)
I thought maybe it had reverted or my 1password was auto-filling it, but it's using the keypair authentication according to Snowflake so I'll trust that.

Numianlo on (2025-02-07 23:30:55 UTC): Connecting to Snowflake using RSA Keypair Authentication, getting the ""Looks like the database name is incorrect""

To solve this set a defaul_role on the user.
example: ALTER USER your_user SET DEFAULT_ROLE = <your_role> ;

If the user already has a default role,  but you are connecting using another role that this user also has, then you need to set the DEFAULT_SECONDARY_ROLES.
example: ALTER USER your_user SET DEFAULT_SECONDARY_ROLES = ( 'ALL' );

"
2264419347,issue,closed,completed,EntityForm itself,,npfitz,2024-04-25 20:18:34+00:00,['npfitz'],2024-04-26 18:04:14+00:00,2024-04-26 18:04:14+00:00,https://github.com/metabase/metabase/issues/41848,[],[],
2264374510,issue,closed,completed,migrate popular-items to rtk query,,iethree,2024-04-25 19:49:43+00:00,['iethree'],2024-04-26 20:48:02+00:00,2024-04-26 20:48:02+00:00,https://github.com/metabase/metabase/issues/41845,[],[],
2264374332,issue,closed,completed,migrate recent-items to use rtk query,,iethree,2024-04-25 19:49:37+00:00,['iethree'],2024-04-26 19:52:15+00:00,2024-04-26 19:52:15+00:00,https://github.com/metabase/metabase/issues/41844,[],[],
2264273107,issue,closed,duplicate,Question Title Loads before Custom Title on Dashboard Card,"### Describe the bug

If you set a custom name for a dashboard card on the dashboard, when you first load (or reload) the dashboard the Question title will display before the dashboard custom title takes it's place

### To Reproduce

1. Create a dashboard
2. Toss a few dashboard cards on it
3. On one of the card go into 'Visualization Options"" and change the title on the card
4. Save
5. Refresh and watch the card title

### Expected behavior

When you load a Dashboard that has a custom title on the dashboard card only show the custom title.

### Logs

_No response_

### Information about your Metabase installation

```JSON
https://www.loom.com/share/572275acd8dd45dca25831adbda1c79b
```


### Severity

annoying

### Additional context

{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.133.1-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2"",
      ""bigquery-cloud-sdk"",
      ""mysql"",
      ""snowflake""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.22 (Debian 11.22-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-11"",
      ""tag"": ""v1.49.5"",
      ""hash"": ""31c4887""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}",ixipixi,2024-04-25 18:46:30+00:00,[],2024-12-20 20:25:01+00:00,2024-12-20 20:25:01+00:00,https://github.com/metabase/metabase/issues/41843,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2077954162, 'issue_id': 2264273107, 'author': 'paoliniluis', 'body': ""This has always been like that since we first load what comes from the BE and then we write the titles on the FE. It's a simple change in the FE but it might introduce lag"", 'created_at': datetime.datetime(2024, 4, 25, 18, 48, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2557631314, 'issue_id': 2264273107, 'author': 'alxnddr', 'body': 'Duplicate of https://github.com/metabase/metabase/issues/50044', 'created_at': datetime.datetime(2024, 12, 20, 19, 51, 12, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-25 18:48:01 UTC): This has always been like that since we first load what comes from the BE and then we write the titles on the FE. It's a simple change in the FE but it might introduce lag

alxnddr on (2024-12-20 19:51:12 UTC): Duplicate of https://github.com/metabase/metabase/issues/50044

"
2264212914,issue,open,,Ability to set language at a dashboard level,"**Is your feature request related to a problem? Please describe.**
You may want to have different dashboards for different countries, and you need to set up different languages for them. Today, that's not possible

**Describe the solution you'd like**
Ability to set languages at a dashboard level

**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
Requested by a customer, internal ticket: 

**Additional context**
Related to https://github.com/metabase/metabase/issues/9508

",ignacio-mb,2024-04-25 18:12:13+00:00,[],2025-02-04 20:30:58+00:00,,https://github.com/metabase/metabase/issues/41842,"[('Type:New Feature', ''), ('Customization/i18n', '')]","[{'comment_id': 2324188307, 'issue_id': 2264212914, 'author': 'denics', 'body': 'Another customer supporting this request.', 'created_at': datetime.datetime(2024, 9, 2, 8, 54, 47, tzinfo=datetime.timezone.utc)}]","denics on (2024-09-02 08:54:47 UTC): Another customer supporting this request.

"
2264089191,issue,closed,completed,"[dc.js migration] ""show values for this series"" setting on dashcards no longer works","https://github.com/metabase/metabase/assets/37751258/3784bec1-b5ad-4baa-84bc-c2291c19f271

Beginning of the video shows it working on stats, but it doesn't do anything on the `echarts` branch.",EmmadUsmani,2024-04-25 17:06:59+00:00,['JesseSDevaney'],2024-04-26 16:56:56+00:00,2024-04-26 16:56:56+00:00,https://github.com/metabase/metabase/issues/41833,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2263954312,issue,open,,Actions appear when there are no user-created models,"### Describe the bug

I haven't created any models yet, but Metabase allows me to (begin to) create an action, although I can't actually save it. I do technically have access to models in the Metabase analytics collection but I can't associate actions to those models.
Basically, Metabase allows me to see something I can't actually use. 

### To Reproduce

1. Have an instance that has a Metabase analytics collection but does not have any user-created models.
2. Click on New.
3. Click on Action.
4. Select a database, type something, and try to Save.
5. There will be no available models to choose from to associate the action to -> unable to create an action


### Expected behavior

Models in the Metabase analytics collection should not activate the ability to create actions if the user hasn't created any models yet. i.e. actions should be hidden if there are no user-created models 

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.213-201.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-11"",
      ""tag"": ""v1.49.5"",
      ""hash"": ""31c4887""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

low

### Additional context

_No response_",jessicaul,2024-04-25 15:55:24+00:00,[],2025-02-06 10:12:01+00:00,,https://github.com/metabase/metabase/issues/41831,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/Models', 'aka Datasets'), ('Querying/Actions', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2077682374, 'issue_id': 2263954312, 'author': 'iethree', 'body': 'more context: we simply run a search api query with a limit of one (which is fairly slow) for this as part of the app bar component. we should probably have a dedicated `hasUserModels` endpoint for this that returns a boolean and gets cached appropriately.', 'created_at': datetime.datetime(2024, 4, 25, 16, 20, 56, tzinfo=datetime.timezone.utc)}]","iethree on (2024-04-25 16:20:56 UTC): more context: we simply run a search api query with a limit of one (which is fairly slow) for this as part of the app bar component. we should probably have a dedicated `hasUserModels` endpoint for this that returns a boolean and gets cached appropriately.

"
2263684666,issue,closed,completed,Referencing a Common Metric downstream of summarize block is broken due to unexpected generated SQL realiasing,"### Describe the bug

In the GUI, referencing a Common Metric downstream of a summarize block leads to SQL compilation error. This is due to the generated SQL not reusing the alias ""Metric Name"" and snake casing it to metric_name. 

As a consequence it leads to :

`SQL compilation error: error line 1 at position 11 invalid identifier '""source"".""metric_name""'`

See below an example of a metric reference failing and associated generated SQL : 

![Screenshot 2024-04-25 at 15 43 31](https://github.com/metabase/metabase/assets/24913696/ab5bd2fb-f501-4b3f-831b-1a3b60b80522)

```
SELECT
  SUM(""source"".""gmv_eur"") AS ""sum""
FROM
  (
    SELECT
      ""CORE"".""ORDER_ITEMS"".""REGION"" AS ""REGION"",
      SUM(
        CASE
          WHEN (""CORE"".""ORDER_ITEMS"".""STRIPE_CHARGE_ID"" IS NOT NULL)
         
   AND (""CORE"".""ORDER_ITEMS"".""CAPTURED_AT"" IS NOT NULL) THEN ""CORE"".""ORDER_ITEMS"".""TOTAL_PRICE"" * ""CORE"".""ORDER_ITEMS"".""LOCAL_CURRENCY_TO_EUR_RATE""
          ELSE 0.0
        END
      ) AS ""GMV EUR""
    FROM
      ""TRANSFORMED"".""CORE"".""ORDER_ITEMS""
   
GROUP BY
      ""CORE"".""ORDER_ITEMS"".""REGION""
   
ORDER BY
      ""CORE"".""ORDER_ITEMS"".""REGION"" ASC
  ) AS ""source""
  ```

### To Reproduce

1. Use version 1.49.6
2. Create a GUI question with a common metric
3. Try filtering, referencing it in summarize or in a custom column
4. See error


### Expected behavior

In the generated code of the first summarize block ""Metric Name"" is used to alias the metric column . This alias must be reused and not be snake cased here is the corrected sample code (line 2) .

```
SELECT
  SUM(""source"".""GMV EUR"") AS ""sum""
FROM
  (
    SELECT
      ""CORE"".""ORDER_ITEMS"".""REGION"" AS ""REGION"",
      SUM(
        CASE
          WHEN (""CORE"".""ORDER_ITEMS"".""STRIPE_CHARGE_ID"" IS NOT NULL)
         
   AND (""CORE"".""ORDER_ITEMS"".""CAPTURED_AT"" IS NOT NULL) THEN ""CORE"".""ORDER_ITEMS"".""TOTAL_PRICE"" * ""CORE"".""ORDER_ITEMS"".""LOCAL_CURRENCY_TO_EUR_RATE""
          ELSE 0.0
        END
      ) AS ""GMV EUR""
    FROM
      ""TRANSFORMED"".""CORE"".""ORDER_ITEMS""
   
GROUP BY
      ""CORE"".""ORDER_ITEMS"".""REGION""
   
ORDER BY
      ""CORE"".""ORDER_ITEMS"".""REGION"" ASC
  ) AS ""source""

### Logs

Logs won't help here.

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.213-201.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""snowflake""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v1.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""Etc/UTC""
    }
  }
}
```


### Severity

This is causing the usage of metrics experience to be very degraded but non blocking for advance user. Blocker for casual users.

### Additional context

_No response_",guillaume-chech,2024-04-25 14:04:14+00:00,[],2024-10-04 17:39:23+00:00,2024-10-04 17:39:15+00:00,https://github.com/metabase/metabase/issues/41829,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Querying', ''), ('Querying/Metrics', 'v2')]","[{'comment_id': 2394256349, 'issue_id': 2263684666, 'author': 'mngr', 'body': 'Fixed in 51', 'created_at': datetime.datetime(2024, 10, 4, 17, 39, 15, tzinfo=datetime.timezone.utc)}]","mngr on (2024-10-04 17:39:15 UTC): Fixed in 51

"
2263669758,issue,closed,completed,Add `can_write` to non-collection items returned by `/api/collection/:id/items`,"Currently, only collections returned by `/api/collection/:id/items` have a `can_write` property populated. In order to handle one edge case for https://github.com/metabase/metabase/pull/41559, we need to be able to tell if any given dashboard is writable by a user from the entity picker so that we don't trick users into thinking that they can add questions to dashboards if they only have read access to them.  There's  [a great e2e test](https://github.com/metabase/metabase/pull/41559/files#diff-6cdfd40516be52acccd3ea2933e6cc570defa38cfdf4ef9ace8559e25917015dR351-R352) covering this.

I think this change should be relative low cost, since all questions and dashboards in a collection should inherit the `can_write` property of their parent collection.  

**Note**: collections do not currently inherit the writable status of their parents. (though I wish they did 🙁 )

Previously, we had global access to all collection information, but one major benefit of the entity picker is that we no longer have to rely on the (very slow) `/api/collections` - but with this more atomic approach to item handling in the entity picker, we need more specific information populated on each collection item. This ultimately makes the whole thing easier because, increasingly, the api payloads from the backend are a transparent source of truth, and we're not creating inconsistent frankenstein state from various endpoints. ✨ 
",iethree,2024-04-25 13:58:42+00:00,['johnswanson'],2024-05-03 20:50:26+00:00,2024-05-03 20:50:26+00:00,https://github.com/metabase/metabase/issues/41827,"[('Misc/API', ''), ('Organization/Collections', '')]",[],
2263205971,issue,closed,completed,Filtering on text ids/foreign key not available in question editor,"**Describe the bug**
It seems that if an ID or foreign key variable is not an integer variable, we can only filter the variable on IS or IS NOT in a question. It wasn't the case before.

**Logs**
XXX

**To Reproduce**
Steps to reproduce the behavior:
1. Choose a table where the ids/foreign key are text variables (example stg_stripe_prod__charges table)
2. Filter on the id/foreign in the question editor
3. You only have two options available : is or is not. Are missing others like : is empty ...
4. For ids/foreign key whose type is integer those filters are available (example stg_production_db__events)

**Expected behavior**
We should have all the filter types available and not only is or is not.

**Screenshots**
If applicable, add screenshots to help explain your problem.
<img width=""1423"" alt=""Capture d’écran 2024-04-25 à 12 08 25"" src=""https://github.com/metabase/metabase/assets/130452786/e2e5619d-887c-4654-9384-be60041f2ff0"">

**Severity**
It is very annoying and important, we cannot have accurate informations displayed.


**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""fr-FR"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.213-201.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""snowflake""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v1.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""Etc/UTC""
    }
  }
}
```",Armelle20,2024-04-25 10:12:10+00:00,[],2024-06-24 16:47:36+00:00,2024-06-24 16:00:11+00:00,https://github.com/metabase/metabase/issues/41824,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]",[],
2262954625,issue,open,,Extend the option to send unformatted results to Alerts,"**Is your feature request related to a problem? Please describe.**
Currently you can download unformatted results:

<img width=""839"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/3f16b842-d45a-4977-b716-3f04713d3e0b"">

And you can also send unformatted results via dashboard subscriptions

<img width=""744"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/dc3491ff-5585-4366-8fd0-1f9596c91c97"">

But there is no option for Alerts

**Describe the solution you'd like**
The same option is given to the Alert UI portal:

<img width=""857"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/d14b8f21-50e9-429a-94cf-20189dc7deb6"">

**Describe alternatives you've considered**
None are available

**How important is this feature to you?**
It makes everything consistent and also lowers the impact of customers that are using alerts or have already alerts setup and are impacted.
",Tony-metabase,2024-04-25 08:07:00+00:00,[],2025-02-04 20:30:39+00:00,,https://github.com/metabase/metabase/issues/41822,"[('Priority:P2', 'Average run of the mill bug'), ('Type:New Feature', ''), ('Organization/Saved Questions', ''), ('Reporting/Alerts', ''), ('.Frontend', '')]","[{'comment_id': 2458748097, 'issue_id': 2262954625, 'author': 'carolusjoseph', 'body': '+1 My team need this feature too. because when get alert attachment, the amount already formatted and when open in excel being wrong..', 'created_at': datetime.datetime(2024, 11, 6, 5, 21, 50, tzinfo=datetime.timezone.utc)}]","carolusjoseph on (2024-11-06 05:21:50 UTC): +1 My team need this feature too. because when get alert attachment, the amount already formatted and when open in excel being wrong..

"
2262737579,issue,closed,completed,collections,,nemanjaglumac,2024-04-25 05:58:59+00:00,['nemanjaglumac'],2024-04-29 18:41:45+00:00,2024-04-29 18:41:45+00:00,https://github.com/metabase/metabase/issues/41818,[],[],
2262729794,issue,open,,Track open and bounce rates for subscriptions and alerts,"**Is your feature request related to a problem? Please describe.**
When sending out automated emails, it is helpful to know:
- what emails bounced
- what emails were opened

**Describe the solution you'd like**
- Enable integration with 3rd party for email open tracking (e.g. Hubspot)
- Enable built-in integration to track bounced and opened emails

**Describe alternatives you've considered**
- Use a different tool than Metabase to send emails discourages Metabase usage

**How important is this feature to you?**
- Improves ability of Metabase users to understand email receipt
- Requested once every few months as of 2024-04
- Having this data will enable email marketing analytics.  That way, customers could potentially leverage Metabase as the primary BI platform for email subscriptions to customers, for example.

**Additional context**
- #n/a
",likeshumidity,2024-04-25 05:53:36+00:00,[],2024-06-07 19:38:19+00:00,,https://github.com/metabase/metabase/issues/41817,"[('Reporting/Pulses', 'Now called Subscriptions'), ('Type:New Feature', ''), ('Misc/Emails', '')]","[{'comment_id': 2155418273, 'issue_id': 2262729794, 'author': 'ignacio-mb', 'body': 'Dupe of https://github.com/metabase/metabase/issues/38193?', 'created_at': datetime.datetime(2024, 6, 7, 19, 35, 25, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-06-07 19:35:25 UTC): Dupe of https://github.com/metabase/metabase/issues/38193?

"
2262229103,issue,open,,Support 3-Letter Country Codes for Map Visualizations,"**Is your feature request related to a problem? Please describe.**
In certain industries (like pharma) it's common to see 3-letter country codes in the data sets which is not supported in the map visualization in Metabase.

**Describe the solution you'd like**
It would be great if additional types of country codes were supported. The code type could be set from the visualization settings of the Map.

**Describe alternatives you've considered**
An intermediate mapping table that translates the 3 letter codes to the 2 letter codes. This works but it can be cumbersome to maintain and it introduces additional surface area for errors to occur.


",ixipixi,2024-04-24 21:36:41+00:00,[],2025-02-04 20:31:52+00:00,,https://github.com/metabase/metabase/issues/41806,"[('Administration/Metadata & Sync', ''), ('Type:New Feature', ''), ('Administration/Table Metadata', ''), ('Visualization/Maps', ''), ('Semantic Model', ''), ('Semantic Model/Dimensions', ''), ('Semantic Model/Units', '')]",[],
2261976881,issue,open,,Global default dashboard full width setting,"**Is your feature request related to a problem? Please describe.**
For customers that want Full Width dashboards they are updating this on every dashboard they create.

**Describe the solution you'd like**
An option in Settings (General, Appearance or anywhere that makes sense) to choose the global default for the dashboard width on new dashboards
",ixipixi,2024-04-24 19:00:21+00:00,[],2025-02-04 20:30:25+00:00,,https://github.com/metabase/metabase/issues/41797,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('Administration/Settings', '')]","[{'comment_id': 2075824170, 'issue_id': 2261976881, 'author': 'jon-chua-312', 'body': 'Our platform embeds Metabase and is typically used on desktop, rarely mobile. We have gotten immediate feedback that clients want to turn Whole Screen on for all Dashboards.', 'created_at': datetime.datetime(2024, 4, 24, 20, 55, 30, tzinfo=datetime.timezone.utc)}]","jon-chua-312 on (2024-04-24 20:55:30 UTC): Our platform embeds Metabase and is typically used on desktop, rarely mobile. We have gotten immediate feedback that clients want to turn Whole Screen on for all Dashboards.

"
2261967330,issue,open,,Improved Error Handling for Map Viz,"**Is your feature request related to a problem? Please describe.**
Given a list of countries plotted on a map, sometimes a country will not show up on the map because the code has a leading or trailing whitespace in it. We could also consider the case where there is a 2 digit code that doesn't correspond to a country code.

**Describe the solution you'd like**
I could think of a few options for handling this:

- Implementing string cleaning on ""country"" semantic types (doesn't handle accurately formatted but invalid codes)
- Indicate on the map viz settings that there are some invalid values in the data set (valuable even if it doesn't indicate which ones)
- Introduce a custom expression that would allow users to validate country codes

",ixipixi,2024-04-24 18:55:11+00:00,[],2024-05-17 14:43:07+00:00,,https://github.com/metabase/metabase/issues/41796,"[('Type:New Feature', ''), ('Visualization/Maps', '')]",[],
2261935685,issue,closed,not_planned,"INTs set as ""Category"" Type can be Treated as Numbers in the GUI Query Builder but not in Data Tab of Visualizations","### Describe the bug

Many INT type columns are automatically set to a type of ""Category on sync. They can be accessed in the GUI query builder and we can perform SUMs and other functions against them. When you get to the Visualization settings, however, most customization functionality is missing on the data tab.

![categorySum](https://github.com/metabase/metabase/assets/13661163/2815be42-5955-4fee-9179-d5d3a3a220e1)





### To Reproduce

1. Create a test table - this will work for Postgres:
2. 
CREATE TABLE testTable (
    intCol INT,
    catCol VARCHAR(10)
);

INSERT INTO testTable (intCol, catCol)
VALUES
    (3, 'Category1'),
    (4, 'Category1'),
    (1, 'Category2'),
    (4, 'Category2'),
    (7, 'Category2');

3. Sync the new table
4. Observe the 'intCol' column is set to Category type
5. Create a question that SUMs 'intCol' and groups by 'catCol'
6. Look at any viz type and note that there are no options to customize number formatting or style


### Expected behavior

If you can treat it like a number in the Query builder I'd expect to be able to treat like a number in the resulting visualization

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.133.1-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""snowflake"",
      ""h2"",
      ""bigquery-cloud-sdk"",
      ""mysql""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.22 (Debian 11.22-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-11"",
      ""tag"": ""v1.49.5"",
      ""hash"": ""31c4887""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Annoying

### Additional context

For users with a lot of columns that come in this way they have to manually update the semantic type on every synced field in order to get full functionality out of the viz settings.",ixipixi,2024-04-24 18:36:00+00:00,[],2024-05-10 05:18:58+00:00,2024-04-24 21:58:30+00:00,https://github.com/metabase/metabase/issues/41795,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2075915748, 'issue_id': 2261935685, 'author': 'ixipixi', 'body': 'Duplicate:\r\n\r\nhttps://github.com/metabase/metabase/issues/30431', 'created_at': datetime.datetime(2024, 4, 24, 21, 58, 30, tzinfo=datetime.timezone.utc)}]","ixipixi (Issue Creator) on (2024-04-24 21:58:30 UTC): Duplicate:

https://github.com/metabase/metabase/issues/30431

"
2261933462,issue,closed,completed,Tile maps are visualizations are broken,"### Describe the bug

**Broken only on Stats**

Tile maps aren't loading correct tiles:

<img width=""1726"" alt=""Screenshot 2024-04-24 at 3 31 57 PM"" src=""https://github.com/metabase/metabase/assets/14301985/2941a271-e687-4883-8552-134bcfe95208"">


### To Reproduce

1. New Question -> People table -> switch to the map view
2. Ensure latitude and longitude are set
3. See the map is not loaded: tiles are empty but data points are visible


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Stats, latest master
```


### Severity

Very high

### Additional context

_No response_",alxnddr,2024-04-24 18:34:36+00:00,['kulyk'],2024-06-05 12:42:58+00:00,2024-06-05 12:42:58+00:00,https://github.com/metabase/metabase/issues/41794,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Maps', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2149755798, 'issue_id': 2261933462, 'author': 'kulyk', 'body': 'Turned out to be a misconfig on stats. `map-tile-server-url` setting was set to a US states geojson for some reason', 'created_at': datetime.datetime(2024, 6, 5, 12, 42, 58, tzinfo=datetime.timezone.utc)}]","kulyk (Assginee) on (2024-06-05 12:42:58 UTC): Turned out to be a misconfig on stats. `map-tile-server-url` setting was set to a US states geojson for some reason

"
2261777102,issue,closed,completed,Cumulative aggregation with temporal bucketed breakout is broken on `master`,"https://stats.metabase.com/question/11692-total-accounts-by-plan-counts-are-wrong-due-to-bug-https-github-com-metabase-metabase-issues-2862

![image](https://github.com/metabase/metabase/assets/1455846/e8eacfd1-c740-4842-ad47-c4a4b391801a)

![image](https://github.com/metabase/metabase/assets/1455846/d934399b-8bc5-4373-b974-abaa5594f356)

Stacktrace:

```
0: ""clojure.lang.MultiFn.getFn(MultiFn.java:156)""
1: ""clojure.lang.MultiFn.invoke(MultiFn.java:233)""
2: ""--> lib.temporal_bucket$with_temporal_bucket.invokeStatic(temporal_bucket.cljc:130)""
3: ""lib.temporal_bucket$with_temporal_bucket.invoke(temporal_bucket.cljc:116)""
4: ""query_processor.util.transformations.nest_breakouts$update_metadata_from_previous_stage_to_produce_correct_ref_in_current_stage.invokeStatic(nest_breakouts.clj:49)""
5: ""query_processor.util.transformations.nest_breakouts$update_metadata_from_previous_stage_to_produce_correct_ref_in_current_stage.invoke(nest_breakouts.clj:43)""
6: ""query_processor.util.transformations.nest_breakouts$update_second_stage_refs$replace_60732__60733$fn__60739.invoke(nest_breakouts.clj:63)""
7: ""query_processor.util.transformations.nest_breakouts$update_second_stage_refs$replace_60732__60733.invoke(nest_breakouts.clj:63)""
8: ""lib.util.match.impl$replace_in_collection.invokeStatic(impl.cljc:48)""
9: ""lib.util.match.impl$replace_in_collection.invoke(impl.cljc:39)""
10: ""query_processor.util.transformations.nest_breakouts$update_second_stage_refs$replace_60732__60733.invoke(nest_breakouts.clj:63)""
11: ""lib.util.match.impl$replace_in_collection.invokeStatic(impl.cljc:48)""
12: ""lib.util.match.impl$replace_in_collection.invoke(impl.cljc:39)""
13: ""query_processor.util.transformations.nest_breakouts$update_second_stage_refs$replace_60732__60733.invoke(nest_breakouts.clj:63)""
14: ""lib.util.match.impl$replace_in_collection$iter__15622__15626$fn__15627.invoke(impl.cljc:45)""
15: ""lib.util.match.impl$replace_in_collection.invokeStatic(impl.cljc:44)""
16: ""lib.util.match.impl$replace_in_collection.invoke(impl.cljc:39)""
17: ""query_processor.util.transformations.nest_breakouts$update_second_stage_refs$replace_60732__60733.invoke(nest_breakouts.clj:63)""
18: ""query_processor.util.transformations.nest_breakouts$update_second_stage_refs.invokeStatic(nest_breakouts.clj:63)""
19: ""query_processor.util.transformations.nest_breakouts$update_second_stage_refs.invoke(nest_breakouts.clj:60)""
20: ""query_processor.util.transformations.nest_breakouts$new_second_stage.invokeStatic(nest_breakouts.clj:81)""
21: ""query_processor.util.transformations.nest_breakouts$new_second_stage.invoke(nest_breakouts.clj:70)""
22: ""query_processor.util.transformations.nest_breakouts$nest_breakouts_in_stage.invokeStatic(nest_breakouts.clj:89)""
23: ""query_processor.util.transformations.nest_breakouts$nest_breakouts_in_stage.invoke(nest_breakouts.clj:83)""
24: ""query_processor.util.transformations.nest_breakouts$nest_breakouts_in_stages_with_cumulative_aggregation$fn__60747.invoke(nest_breakouts.clj:106)""
25: ""lib.walk$walk_stages$fn__33568.invoke(walk.cljc:147)""
26: ""lib.walk$walk$fn__33564.invoke(walk.cljc:130)""
27: ""lib.walk$walk_stage_STAR_.invokeStatic(walk.cljc:66)""
28: ""lib.walk$walk_stage_STAR_.invoke(walk.cljc:55)""
29: ""lib.walk$walk_items_STAR_$fn__33549.invoke(walk.cljc:41)""
30: ""lib.walk$reduce_preserving_reduced$fn__33546.invoke(walk.cljc:22)""
31: ""lib.walk$reduce_preserving_reduced.invokeStatic(walk.cljc:18)""
32: ""lib.walk$reduce_preserving_reduced.invoke(walk.cljc:12)""
33: ""lib.walk$walk_items_STAR_.invokeStatic(walk.cljc:36)""
34: ""lib.walk$walk_items_STAR_.invoke(walk.cljc:29)""
35: ""lib.walk$walk_stages_STAR_.invokeStatic(walk.cljc:69)""
36: ""lib.walk$walk_stages_STAR_.invoke(walk.cljc:68)""
37: ""lib.walk$walk_query_STAR_.invokeStatic(walk.cljc:72)""
38: ""lib.walk$walk_query_STAR_.invoke(walk.cljc:71)""
39: ""lib.walk$walk.invokeStatic(walk.cljc:126)""
40: ""lib.walk$walk.invoke(walk.cljc:94)""
41: ""lib.walk$walk_stages.invokeStatic(walk.cljc:143)""
42: ""lib.walk$walk_stages.invoke(walk.cljc:138)""
43: ""query_processor.util.transformations.nest_breakouts$nest_breakouts_in_stages_with_cumulative_aggregation.invokeStatic(nest_breakouts.clj:101)""
44: ""query_processor.util.transformations.nest_breakouts$nest_breakouts_in_stages_with_cumulative_aggregation.invoke(nest_breakouts.clj:91)""
45: ""driver.sql.query_processor$nest_breakouts_in_queries_with_cumulative_aggregations.invokeStatic(query_processor.clj:1576)""
46: ""driver.sql.query_processor$nest_breakouts_in_queries_with_cumulative_aggregations.invoke(query_processor.clj:1572)""
47: ""driver.sql.query_processor$maybe_nest_breakouts_in_queries_with_cumulative_aggregations.invokeStatic(query_processor.clj:1592)""
48: ""driver.sql.query_processor$maybe_nest_breakouts_in_queries_with_cumulative_aggregations.invoke(query_processor.clj:1591)""
49: ""driver.sql.query_processor$fn__61675.invokeStatic(query_processor.clj:1597)""
50: ""driver.sql.query_processor$fn__61675.invoke(query_processor.clj:1595)""
51: ""driver.sql.query_processor$mbql__GT_honeysql.invokeStatic(query_processor.clj:1606)""
52: ""driver.sql.query_processor$mbql__GT_honeysql.invoke(query_processor.clj:1602)""
53: ""driver.sql.query_processor$mbql__GT_native.invokeStatic(query_processor.clj:1617)""
54: ""driver.sql.query_processor$mbql__GT_native.invoke(query_processor.clj:1613)""
55: ""driver.sql$fn__82280.invokeStatic(sql.clj:49)""
56: ""driver.sql$fn__82280.invoke(sql.clj:47)""
57: ""query_processor.compile$compile_STAR_.invokeStatic(compile.clj:15)""
58: ""query_processor.compile$compile_STAR_.invoke(compile.clj:11)""
59: ""query_processor.compile$compile_preprocessed$fn__63847.invoke(compile.clj:23)""
60: ""query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:215)""
61: ""query_processor.setup$do_with_qp_setup.invoke(setup.clj:206)""
62: ""query_processor.compile$compile_preprocessed.invokeStatic(compile.clj:21)""
63: ""query_processor.compile$compile_preprocessed.invoke(compile.clj:17)""
64: ""query_processor.compile$attach_compiled_query.invokeStatic(compile.clj:43)""
65: ""query_processor.compile$attach_compiled_query.invoke(compile.clj:35)""
66: ""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:45)""
67: ""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:43)""
68: ""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$fn__78016$handle_audit_app_internal_queries__78017$fn__78018.invoke(handle_audit_queries.clj:145)""
69: ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__62942.invoke(enterprise.clj:103)""
70: ""query_processor.middleware.process_userland_query$process_userland_query_middleware$fn__69803.invoke(process_userland_query.clj:183)""
71: ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__69872.invoke(catch_exceptions.clj:128)""
72: ""query_processor$process_query$fn__69909.invoke(query_processor.clj:78)""
73: ""query_processor.setup$do_with_canceled_chan$fn__63346.invoke(setup.clj:178)""
74: ""query_processor.setup$do_with_database_local_settings$fn__63341.invoke(setup.clj:170)""
75: ""query_processor.setup$do_with_driver$fn__63331$fn__63332.invoke(setup.clj:146)""
76: ""driver$do_with_driver.invokeStatic(driver.clj:97)""
77: ""driver$do_with_driver.invoke(driver.clj:92)""
78: ""query_processor.setup$do_with_driver$fn__63331.invoke(setup.clj:145)""
79: ""query_processor.setup$do_with_escape_alias_fn$fn__63336.invoke(setup.clj:155)""
80: ""query_processor.setup$do_with_metadata_provider$fn__63324$fn__63327.invoke(setup.clj:131)""
81: ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:170)""
82: ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
83: ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:159)""
84: ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
85: ""query_processor.setup$do_with_metadata_provider$fn__63324.invoke(setup.clj:130)""
86: ""query_processor.setup$do_with_resolved_database$fn__63318.invoke(setup.clj:108)""
87: ""query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:222)""
88: ""query_processor.setup$do_with_qp_setup.invoke(setup.clj:206)""
89: ""query_processor$process_query.invokeStatic(query_processor.clj:76)""
90: ""query_processor$process_query.invoke(query_processor.clj:69)""
91: ""query_processor.card$process_query_for_card_default_qp.invokeStatic(card.clj:169)""
92: ""query_processor.card$process_query_for_card_default_qp.invoke(card.clj:165)""
93: ""query_processor.card$process_query_for_card_default_run_fn$fn__95190$fn__95191.invoke(card.clj:176)""
94: ""query_processor.streaming$_streaming_response$fn__65585$fn__65586$fn__65587.invoke(streaming.clj:175)""
95: ""query_processor.streaming$_streaming_response$fn__65585$fn__65586.invoke(streaming.clj:174)""
96: ""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:165)""
97: ""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:152)""
98: ""query_processor.streaming$_streaming_response$fn__65585.invoke(streaming.clj:171)""
99: ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:68)""
```",camsaul,2024-04-24 17:07:36+00:00,['camsaul'],2024-04-26 19:40:51+00:00,2024-04-26 19:40:51+00:00,https://github.com/metabase/metabase/issues/41791,"[('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/Processor', ''), ('.Backend', '')]","[{'comment_id': 2075474699, 'issue_id': 2261777102, 'author': 'camsaul', 'body': 'Only when that query has a filter it looks like.', 'created_at': datetime.datetime(2024, 4, 24, 17, 30, 10, tzinfo=datetime.timezone.utc)}]","camsaul (Issue Creator) on (2024-04-24 17:30:10 UTC): Only when that query has a filter it looks like.

"
2261746180,issue,closed,not_planned,"Allow Metabase to not have a login screen, or alternative to allow authentication on the network level.","**Feature Request**

**Is your feature request related to a problem? Please describe.**
Authentication to occur on the network with Single Sign-on via an Identity Platform, outside of Metabase's scope. A reverse proxy would handle access via authentication/authorization. In effect, if a user gets to Metabase that means they're allowed to be there.

Alternatively, *I think* JWT can be used to achieve a similar effect with some re-directs in the middle.

**Describe the solution you'd like**
I'd like if a Metabase administrator had the option to disable users. Every user could be considered a ""Guest"". 

**Describe alternatives you've considered**
Alternatively, if JWT authentication was available that could work too. An unauthorized user would visit Metabase, get redirected to the SSO portal, and the SSO portal could recognize the user as already being authorized- thus forwarding the visitor back with a auth-token in the URL.

**How important is this feature to you?**
5/10. Right now, user adoption rate among nontechnical stakeholders is quite low and I believe this would improve that metric. 

**Additional context**
I see JWT is available on the Pro offering. This is a great offer with a large variety of great features, though we aren't at the stage where we can justify the $500/mo for everything included in the package. I believe having easier access can more quickly get us to higher adoption rates.
",MrChadMWood,2024-04-24 16:49:22+00:00,[],2024-04-24 21:08:59+00:00,2024-04-24 21:08:58+00:00,https://github.com/metabase/metabase/issues/41789,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2075847004, 'issue_id': 2261746180, 'author': 'paoliniluis', 'body': 'Duplicate/similar of https://github.com/metabase/metabase/issues/6709', 'created_at': datetime.datetime(2024, 4, 24, 21, 8, 58, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-24 21:08:58 UTC): Duplicate/similar of https://github.com/metabase/metabase/issues/6709

"
2261739719,issue,open,,Integer columns in Redshift external tables aren't receiving valid metadata,"### Describe the bug

 The following column type signatures are mapped incorrectly in Redshift. 
 ```
 company_type_id int(11)
 internal_corporate_id int(10) unsigned
 coop_cat tinyint(1)
```
These types seem to appear only in external tables with SERDE row format, see an example table definition attached below.

Column metadata becomes:
```
{
           ""database_type"": ""int(10) unsigned"",
           ""semantic_type"": null,
           ""base_type"": ""type/*"",
           ""effective"": ""type/*"",
           ""semantic_type"": null,
[...]
}
```

A related frontend issue is that the filter selector displays these with a circle fallback icon in front of their names,
<img width=""335"" alt=""image"" src=""https://github.com/metabase/metabase/assets/11080638/6172697f-38e5-4b5c-94d0-518bb7790a37"">

and when a problematic column is selected for filtering, the filter selector breaks down entirely.
https://github.com/metabase/metabase/assets/11080638/75372847-693a-4ab7-8022-518aa5320dc2

The workaround is to manually set the column type to a known type.

### To Reproduce

To reproduce the FE / filtering: override metadata for a field either in the API result or change it in the application database, so that {""semantic_type"": null, ""effective_type"": ""type/*"", ...} is returned.

I did not reproduce the BE / schema sync part. For that create an external table on Redshift with a definition similar to the one I attached.

### Expected behavior

BE: The correct effective and semantic type is determined for the data types listed above.
FE: Filtering should not break down even if some of the columns is not mapped correctly.

### Logs

_No response_

### Information about your Metabase installation

```JSON
1.49.6
```


### Severity

P2

### Additional context

Table definition that caused the problem:
```
CREATE EXTERNAL TABLE oms.company (
   id int(10) unsigned,
   omega_id varchar(32),
   company_type_id int(11),
   company_block_id int(11),
   company_format_id int(11),
   company_region_id int(11),
   name varchar(128),
   gln varchar(16),
   internal_corporate_id int(10) unsigned,
   invoice_customer_id int(11),
   legal_name varchar(128),
   created_at timestamp,
   updated_at timestamp,
   coop_cat tinyint(1)
)
ROW FORMAT SERDE ''
STORED AS INPUTFORMAT ''
OUTPUTFORMAT '' LOCATION '';
```",zbodi74,2024-04-24 16:45:09+00:00,[],2025-02-04 20:25:29+00:00,,https://github.com/metabase/metabase/issues/41788,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Database/Redshift', None), ('Administration/Metadata & Sync', ''), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2082455761, 'issue_id': 2261739719, 'author': 'calherries', 'body': ""Assigning myself to fix this. We don't have any tests for serde formatted columns and I'd never heard of them before. It's likely related to my recent changes to redshift sync: https://github.com/metabase/metabase/issues/39986\r\n\r\n@zbodi74 do you know if this behaviour changed recently? do you know a version that it worked correctly on?"", 'created_at': datetime.datetime(2024, 4, 29, 11, 17, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2082472975, 'issue_id': 2261739719, 'author': 'calherries', 'body': ""I'm pretty confident it was caused by https://github.com/metabase/metabase/pull/40123 which was first released in 49.1, but would help to confirm.\r\n\r\nIt looks like the JDBC driver function we used to use does a lot of special casing for external tables, that we don't do anymore:\r\nhttps://github.com/aws/amazon-redshift-jdbc-driver/blob/master/src/main/java/com/amazon/redshift/jdbc/RedshiftDatabaseMetaData.java#L3414-L3448"", 'created_at': datetime.datetime(2024, 4, 29, 11, 27, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2082650028, 'issue_id': 2261739719, 'author': 'zbodi74', 'body': '@calherries - Yes, that seems to be the case. The issue appeared right after an upgrade from 48.7 to 49.5.', 'created_at': datetime.datetime(2024, 4, 29, 12, 53, 23, tzinfo=datetime.timezone.utc)}]","calherries on (2024-04-29 11:17:14 UTC): Assigning myself to fix this. We don't have any tests for serde formatted columns and I'd never heard of them before. It's likely related to my recent changes to redshift sync: https://github.com/metabase/metabase/issues/39986

@zbodi74 do you know if this behaviour changed recently? do you know a version that it worked correctly on?

calherries on (2024-04-29 11:27:48 UTC): I'm pretty confident it was caused by https://github.com/metabase/metabase/pull/40123 which was first released in 49.1, but would help to confirm.

It looks like the JDBC driver function we used to use does a lot of special casing for external tables, that we don't do anymore:
https://github.com/aws/amazon-redshift-jdbc-driver/blob/master/src/main/java/com/amazon/redshift/jdbc/RedshiftDatabaseMetaData.java#L3414-L3448

zbodi74 (Issue Creator) on (2024-04-29 12:53:23 UTC): @calherries - Yes, that seems to be the case. The issue appeared right after an upgrade from 48.7 to 49.5.

"
2261708822,issue,closed,completed,[dc.js migration] missing combined card in subscription,"https://github.com/metabase/metabase/assets/37751258/45d2fe78-0e04-46d4-9d68-aa033137bf7a

When I add a series to combine two questions in to a single dashcard, in the subscription email I only see a single series on the chart. Furthermore, the chart title in the email is from the first question, yet the series being rendered is the second question, albeit with the first series color.",EmmadUsmani,2024-04-24 16:27:37+00:00,['adam-james-v'],2024-05-16 20:05:25+00:00,2024-05-16 20:05:25+00:00,https://github.com/metabase/metabase/issues/41787,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]","[{'comment_id': 2113467863, 'issue_id': 2261708822, 'author': 'dpsutton', 'body': 'This [commit](https://github.com/metabase/metabase/pull/41395/commits/25ec412bb196ed14e943392090da30ea0aa992c1?file-filters%5B%5D=.clj&show-viewed-files=true#diff-79c051a13f9e859c56dc5bffd3f145bb696e2da951d6ff45dc1fa38d4a3b9807) in the [echarts PR](https://github.com/metabase/metabase/pull/41395) stopped using `data`.\r\n\r\n#### Before:\r\n```clojure\r\n(s/defmethod render :javascript_visualization :- formatter/RenderedPulseCard\r\n  [_chart-type render-type _timezone-id card dashcard data]\r\n  (let [combined-cards-results                 (if dashcard\r\n                                                 (pu/execute-multi-card card dashcard)\r\n                                                 (pu/execute-card {:creator_id (:creator_id card)} (:id card)))\r\n        cards-with-data                        (map (fn [c d] {:card c :data d})\r\n                                                    (cons card (map :card combined-cards-results))\r\n                                                    (cons data (map #(get-in % [:result :data]) combined-cards-results))) ;; data blended here\r\n        dashcard-viz-settings                  (get dashcard :visualization_settings)\r\n        {rendered-type :type content :content} (js-svg/javascript-visualization cards-with-data dashcard-viz-settings)]\r\n```\r\n\r\n#### After\r\n\r\n```clojure\r\n(mu/defmethod render :javascript_visualization :- formatter/RenderedPulseCard\r\n  [_chart-type render-type _timezone-id card dashcard _data]\r\n  (let [combined-cards-results (if dashcard\r\n                                 (pu/execute-multi-card card dashcard)\r\n                                 [(pu/execute-card {:creator_id (:creator_id card)} (:id card))])\r\n        cards-with-data        (map\r\n                                (comp\r\n                                 add-dashcard-timeline-events\r\n                                 (fn [c d] {:card c :data d}))\r\n                                (map :card combined-cards-results)\r\n                                (map #(get-in % [:result :data]) combined-cards-results))\r\n```\r\n\r\nThe `data` coming into this function has the results of the base card. The error here is that `pu/execute-multi-card` sounds like it will the base card in addition to the series, but it seems it only runs the series and the caller has to manually blend the two. Seems a simple fix.', 'created_at': datetime.datetime(2024, 5, 15, 21, 15, 2, tzinfo=datetime.timezone.utc)}]","dpsutton on (2024-05-15 21:15:02 UTC): This [commit](https://github.com/metabase/metabase/pull/41395/commits/25ec412bb196ed14e943392090da30ea0aa992c1?file-filters%5B%5D=.clj&show-viewed-files=true#diff-79c051a13f9e859c56dc5bffd3f145bb696e2da951d6ff45dc1fa38d4a3b9807) in the [echarts PR](https://github.com/metabase/metabase/pull/41395) stopped using `data`.

#### Before:
```clojure
(s/defmethod render :javascript_visualization :- formatter/RenderedPulseCard
  [_chart-type render-type _timezone-id card dashcard data]
  (let [combined-cards-results                 (if dashcard
                                                 (pu/execute-multi-card card dashcard)
                                                 (pu/execute-card {:creator_id (:creator_id card)} (:id card)))
        cards-with-data                        (map (fn [c d] {:card c :data d})
                                                    (cons card (map :card combined-cards-results))
                                                    (cons data (map #(get-in % [:result :data]) combined-cards-results))) ;; data blended here
        dashcard-viz-settings                  (get dashcard :visualization_settings)
        {rendered-type :type content :content} (js-svg/javascript-visualization cards-with-data dashcard-viz-settings)]
```

#### After

```clojure
(mu/defmethod render :javascript_visualization :- formatter/RenderedPulseCard
  [_chart-type render-type _timezone-id card dashcard _data]
  (let [combined-cards-results (if dashcard
                                 (pu/execute-multi-card card dashcard)
                                 [(pu/execute-card {:creator_id (:creator_id card)} (:id card))])
        cards-with-data        (map
                                (comp
                                 add-dashcard-timeline-events
                                 (fn [c d] {:card c :data d}))
                                (map :card combined-cards-results)
                                (map #(get-in % [:result :data]) combined-cards-results))
```

The `data` coming into this function has the results of the base card. The error here is that `pu/execute-multi-card` sounds like it will the base card in addition to the series, but it seems it only runs the series and the caller has to manually blend the two. Seems a simple fix.

"
2261688194,issue,closed,completed,[Epic] Migrate to RTK Query,"After we finish with the Entity migration, we should take inventory of what endpoints are still left in [`services.js`](https://github.com/metabase/metabase/blob/master/frontend/src/metabase/services.js) and migrate those to RTK Query as well.

```[tasklist]
- [ ] #40788
- [ ] Services.js (list will be updated once we know what's left)
```",nemanjaglumac,2024-04-24 16:17:30+00:00,[],2024-06-06 20:22:30+00:00,2024-06-06 13:59:07+00:00,https://github.com/metabase/metabase/issues/41786,"[('Type:Tech Debt', 'or Refactoring'), ('.Epic', 'Feature Implementation or Project'), ('.Team/Querying', '')]","[{'comment_id': 2153344881, 'issue_id': 2261688194, 'author': 'nemanjaglumac', 'body': 'We reworked https://github.com/metabase/metabase/issues/40788 to include `services.js` in the Milestone 3.\r\nThis issue is no longer needed.', 'created_at': datetime.datetime(2024, 6, 6, 20, 22, 28, tzinfo=datetime.timezone.utc)}]","nemanjaglumac (Issue Creator) on (2024-06-06 20:22:28 UTC): We reworked https://github.com/metabase/metabase/issues/40788 to include `services.js` in the Milestone 3.
This issue is no longer needed.

"
2261560678,issue,closed,completed,Using Column picker to remove columns on model breaks question with ERROR: column source.name_2 does not exist   Position,"### Describe the bug

Using the Add or Remove Columns picker breaks question and shows unexpected duplicated values in list of columns

### To Reproduce

1. Visit https://stats.metabase.com/model/6759-ticket
2. Click the ⚙️ gear icon on bottom left to edit Visualization Settings
3. Click `Add or Remove Columns`
4. Uncheck ""Assignee ID"" (3rd from last column)
![image](https://github.com/metabase/metabase/assets/8808703/3666b89e-295f-4d60-b390-e8e0887a8726)

5. See error `ERROR: column source.name_2 does not exist  Position: 1703`

https://stats.metabase.com/question#eyJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoyNiwidHlwZSI6InF1ZXJ5IiwicXVlcnkiOnsiZmllbGRzIjpbWyJmaWVsZCIsImlkIix7ImJhc2UtdHlwZSI6InR5cGUvQmlnSW50ZWdlciJ9XSxbImZpZWxkIiwic3ViamVjdCIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sWyJmaWVsZCIsIm9yZ2FuaXphdGlvbl9uYW1lIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwiYXNzaWduZWVfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sWyJmaWVsZCIsInJlcXVlc3Rlcl9lbWFpbCIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sWyJmaWVsZCIsImRvbWFpbiIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sWyJmaWVsZCIsImNyZWF0ZWRfYXQiLHsiYmFzZS10eXBlIjoidHlwZS9EYXRlVGltZVdpdGhMb2NhbFRaIn1dLFsiZmllbGQiLCJhc3NpZ25lZV91cGRhdGVkX2F0Iix7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWVXaXRoTG9jYWxUWiJ9XSxbImZpZWxkIiwidXBkYXRlZF9hdCIseyJiYXNlLXR5cGUiOiJ0eXBlL0RhdGVUaW1lV2l0aExvY2FsVFoifV0sWyJmaWVsZCIsInN1cnZleV9jcmVhdGVkX2F0Iix7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWVXaXRoTG9jYWxUWiJ9XSxbImZpZWxkIiwiYXNzaWduZWVfZ3JvdXBfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sWyJmaWVsZCIsImlzX29wZW4iLHsiYmFzZS10eXBlIjoidHlwZS9Cb29sZWFuIn1dLFsiZmllbGQiLCJzdGF0dXMiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLCJ0aWNrZXRfcmVhc29uIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwiYml6X29wc19hcmVhIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwicHJvZHVjdF9hcmVhIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwic2VudF9zdXJ2ZXkiLHsiYmFzZS10eXBlIjoidHlwZS9Cb29sZWFuIn1dLFsiZmllbGQiLCJzYXRpc2ZhY3Rpb25fcmF0aW5nX3Njb3JlIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwic2F0aXNmYWN0aW9uX3JhdGluZ19jb21tZW50Iix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwidmlhX2NoYW5uZWwiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLCJyZWNpcGllbnQiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLCJzdWJtaXR0ZXJfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sWyJmaWVsZCIsImhhc19pbmNpZGVudHMiLHsiYmFzZS10eXBlIjoidHlwZS9Cb29sZWFuIn1dLFsiZmllbGQiLCJwcm9ibGVtX2lkIix7ImJhc2UtdHlwZSI6InR5cGUvQmlnSW50ZWdlciJ9XSxbImZpZWxkIiwidXJsIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwiZGVzY3JpcHRpb24iLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLCJvcmdhbml6YXRpb25faWQiLHsiYmFzZS10eXBlIjoidHlwZS9CaWdJbnRlZ2VyIn1dLFsiZmllbGQiLCJjdXN0b21lcl9pZCIseyJiYXNlLXR5cGUiOiJ0eXBlL0ludGVnZXIifV0sWyJmaWVsZCIsImFjY291bnRfaWQiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLCJncm91cF9pZCIseyJiYXNlLXR5cGUiOiJ0eXBlL0JpZ0ludGVnZXIifV0sWyJmaWVsZCIsImFzc2lnbmVlX2lkIix7ImJhc2UtdHlwZSI6InR5cGUvQmlnSW50ZWdlciJ9XSxbImZpZWxkIiwicmVxdWVzdGVyX2lkIix7ImJhc2UtdHlwZSI6InR5cGUvQmlnSW50ZWdlciJ9XSxbImZpZWxkIiwic3VibWl0dGVyX2lkIix7ImJhc2UtdHlwZSI6InR5cGUvQmlnSW50ZWdlciJ9XSxbImZpZWxkIiwic2F0aXNmYWN0aW9uX3JhdGluZ19pZCIseyJiYXNlLXR5cGUiOiJ0eXBlL0JpZ0ludGVnZXIifV0sWyJmaWVsZCIsImVtYWlsIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XSxbImZpZWxkIiwibmFtZV8yIix7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XV0sInNvdXJjZS10YWJsZSI6ImNhcmRfXzY3NTkifX0sImRpc3BsYXkiOiJ0YWJsZSIsInBhcmFtZXRlcnMiOltdLCJ2aXN1YWxpemF0aW9uX3NldHRpbmdzIjp7InRhYmxlLnBpdm90X2NvbHVtbiI6ImJpel9vcHNfYXJlYSIsInRhYmxlLmNlbGxfY29sdW1uIjoicHJvYmxlbV9pZCIsInRhYmxlLmNvbHVtbnMiOlt7Im5hbWUiOiJpZCIsImtleSI6IltcInJlZlwiLFtcImZpZWxkXCIsNTQ3ODAzLG51bGxdXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImZpZWxkIiw1NDc4MDMsbnVsbF19LHsibmFtZSI6InN1YmplY3QiLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU0NzgxMCxudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTQ3ODEwLG51bGxdfSx7Im5hbWUiOiJvcmdhbml6YXRpb25fbmFtZSIsImtleSI6IltcInJlZlwiLFtcImZpZWxkXCIsNTQ3ODI1LG51bGxdXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImZpZWxkIiw1NDc4MjUsbnVsbF19LHsibmFtZSI6ImFzc2lnbmVlX25hbWUiLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU0NzgzMixudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTQ3ODMyLG51bGxdfSx7Im5hbWUiOiJyZXF1ZXN0ZXJfZW1haWwiLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU0NzgyNyxudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTQ3ODI3LG51bGxdfSx7Im5hbWUiOiJkb21haW4iLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU1OTQxOCxudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTU5NDE4LG51bGxdfSx7Im5hbWUiOiJjcmVhdGVkX2F0Iiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MTYsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgxNix7InRlbXBvcmFsLXVuaXQiOiJkZWZhdWx0In1dfSx7Im5hbWUiOiJhc3NpZ25lZV91cGRhdGVkX2F0Iiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MTQsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgxNCx7InRlbXBvcmFsLXVuaXQiOiJkZWZhdWx0In1dfSx7Im5hbWUiOiJ1cGRhdGVkX2F0Iiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MTIsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgxMix7InRlbXBvcmFsLXVuaXQiOiJkZWZhdWx0In1dfSx7Im5hbWUiOiJzdXJ2ZXlfY3JlYXRlZF9hdCIsImtleSI6IltcInJlZlwiLFtcImZpZWxkXCIsNTU5NDE5LG51bGxdXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImZpZWxkIiw1NTk0MTkseyJ0ZW1wb3JhbC11bml0IjoiZGVmYXVsdCJ9XX0seyJuYW1lIjoiYXNzaWduZWVfZ3JvdXBfbmFtZSIsImtleSI6IltcInJlZlwiLFtcImZpZWxkXCIsNTQ3ODMzLG51bGxdXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImZpZWxkIiw1NDc4MzMsbnVsbF19LHsibmFtZSI6ImlzX29wZW4iLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU0NzgxOSxudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTQ3ODE5LG51bGxdfSx7Im5hbWUiOiJzdGF0dXMiLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU0NzgxNSxudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTQ3ODE1LG51bGxdfSx7Im5hbWUiOiJ0aWNrZXRfcmVhc29uIiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MjYsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgyNixudWxsXX0seyJuYW1lIjoiYml6X29wc19hcmVhIiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MjQsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgyNCxudWxsXX0seyJuYW1lIjoicHJvZHVjdF9hcmVhIiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MjEsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgyMSxudWxsXX0seyJuYW1lIjoic2VudF9zdXJ2ZXkiLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU0NzgxOCxudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTQ3ODE4LG51bGxdfSx7Im5hbWUiOiJzYXRpc2ZhY3Rpb25fcmF0aW5nX3Njb3JlIiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MDUsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgwNSxudWxsXX0seyJuYW1lIjoic2F0aXNmYWN0aW9uX3JhdGluZ19jb21tZW50Iiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MDksbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgwOSxudWxsXX0seyJuYW1lIjoidmlhX2NoYW5uZWwiLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU0NzgyMixudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTQ3ODIyLG51bGxdfSx7Im5hbWUiOiJyZWNpcGllbnQiLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU0NzgwOCxudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTQ3ODA4LG51bGxdfSx7Im5hbWUiOiJzdWJtaXR0ZXJfbmFtZSIsImtleSI6IltcInJlZlwiLFtcImZpZWxkXCIsNTQ3ODA0LG51bGxdXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImZpZWxkIiw1NDc4MDQsbnVsbF19LHsibmFtZSI6Imhhc19pbmNpZGVudHMiLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU0NzgzMCxudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTQ3ODMwLG51bGxdfSx7Im5hbWUiOiJwcm9ibGVtX2lkIiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MjgsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgyOCxudWxsXX0seyJuYW1lIjoidXJsIiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MTcsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgxNyxudWxsXX0seyJuYW1lIjoiZGVzY3JpcHRpb24iLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU0NzgwNixudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTQ3ODA2LG51bGxdfSx7Im5hbWUiOiJvcmdhbml6YXRpb25faWQiLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU0NzgzMSxudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTQ3ODMxLG51bGxdfSx7Im5hbWUiOiJjdXN0b21lcl9pZCIsImtleSI6IltcInJlZlwiLFtcImZpZWxkXCIsNTQ3ODIzLG51bGxdXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImZpZWxkIiw1NDc4MjMsbnVsbF19LHsibmFtZSI6ImFjY291bnRfaWQiLCJrZXkiOiJbXCJyZWZcIixbXCJmaWVsZFwiLDU2OTk0NyxudWxsXV0iLCJlbmFibGVkIjp0cnVlLCJmaWVsZFJlZiI6WyJmaWVsZCIsNTY5OTQ3LG51bGxdfSx7Im5hbWUiOiJncm91cF9pZCIsImtleSI6IltcInJlZlwiLFtcImZpZWxkXCIsNTQ3ODI5LG51bGxdXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImZpZWxkIiw1NDc4MjksbnVsbF19LHsibmFtZSI6ImFzc2lnbmVlX2lkIiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MjAsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgyMCxudWxsXX0seyJuYW1lIjoicmVxdWVzdGVyX2lkIiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MTEsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgxMSxudWxsXX0seyJuYW1lIjoic3VibWl0dGVyX2lkIiwia2V5IjoiW1wicmVmXCIsW1wiZmllbGRcIiw1NDc4MDcsbnVsbF1dIiwiZW5hYmxlZCI6dHJ1ZSwiZmllbGRSZWYiOlsiZmllbGQiLDU0NzgwNyxudWxsXX0seyJuYW1lIjoic2F0aXNmYWN0aW9uX3JhdGluZ19pZCIsImtleSI6IltcInJlZlwiLFtcImZpZWxkXCIsNTQ3ODEzLG51bGxdXSIsImVuYWJsZWQiOnRydWUsImZpZWxkUmVmIjpbImZpZWxkIiw1NDc4MTMsbnVsbF19XX0sIm9yaWdpbmFsX2NhcmRfaWQiOjY3NTl9ydWUsImZpZWxkUmVmIjpbImZpZWxkIiw1NDc4MTMsbnVsbF19XX0sIm9yaWdpbmFsX2NhcmRfaWQiOjY3NTl9

### Expected behavior

- expect to be able to uncheck/check
- expect only one Assignee ID to show up

### Logs


![image](https://github.com/metabase/metabase/assets/8808703/4f648407-e993-40e0-a0a7-38368a875fad)


Diagnostics:
- https://drive.google.com/file/d/13yt2TeuQ74VjijT660rf65h-7e0-rltL/view?usp=drive_link

### Information about your Metabase installation

```JSON
- `master` as of `9e9e310`
```


### Severity

P1: Regression, commonly used functionality

### Additional context

_No response_",likeshumidity,2024-04-24 15:22:01+00:00,['kamilmielnik'],2024-07-24 18:08:04+00:00,2024-06-27 12:09:04+00:00,https://github.com/metabase/metabase/issues/41785,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature'), ('.Team/Querying', '')]","[{'comment_id': 2147592441, 'issue_id': 2261560678, 'author': 'nemanjaglumac', 'body': '@likeshumidity this error message seems to point to the backend issue.\r\nWhat\'s interesting is that the Assignee ID shows up three times in the sidebar when you click ""Add or remove columns""\r\n![Screenshot 2024-06-04 at 15 47 37](https://github.com/metabase/metabase/assets/31325167/9c016f3d-21cc-4be8-b6b6-fecb50c8ced6)\r\n\r\nI\'m wondering how did it come to that?\r\nThe source of this issue most likely lies in the model definition.', 'created_at': datetime.datetime(2024, 6, 4, 13, 50, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2194378522, 'issue_id': 2261560678, 'author': 'kamilmielnik', 'body': 'Fixed by #44721.\r\nRelated BE issue: #44767', 'created_at': datetime.datetime(2024, 6, 27, 10, 54, 2, tzinfo=datetime.timezone.utc)}]","nemanjaglumac on (2024-06-04 13:50:53 UTC): @likeshumidity this error message seems to point to the backend issue.
What's interesting is that the Assignee ID shows up three times in the sidebar when you click ""Add or remove columns""
![Screenshot 2024-06-04 at 15 47 37](https://github.com/metabase/metabase/assets/31325167/9c016f3d-21cc-4be8-b6b6-fecb50c8ced6)

I'm wondering how did it come to that?
The source of this issue most likely lies in the model definition.

kamilmielnik (Assginee) on (2024-06-27 10:54:02 UTC): Fixed by #44721.
Related BE issue: #44767

"
2261497494,issue,closed,completed,Clicking existing filter breaks question based on model,"### Describe the bug

- crashed frontend in `master` when attempting to update a filter

### To Reproduce

1. Go to https://stats.metabase.com/model/6759-ticket
2. Filter on Assignee Name is null
![image](https://github.com/metabase/metabase/assets/8808703/14f1fb41-c970-4f12-adfc-b78b9a8ce211)


3. Click filter pill button
![image](https://github.com/metabase/metabase/assets/8808703/048a4bb3-79c0-46df-b0f4-8eccbd53737f)

4. Frontend crashes
![image](https://github.com/metabase/metabase/assets/8808703/f3835db7-13c9-4c8f-8e42-3021e5e1abd0)


### Expected behavior

_No response_

### Logs

![image](https://github.com/metabase/metabase/assets/8808703/bd057ed1-2e41-43eb-b3cf-94ea1e73b30b)

Diagnostics available here:
- https://drive.google.com/file/d/1JCMfeXUrg3555ST9ContgEtbgPqbcLDG/view?usp=drive_link

### Information about your Metabase installation

```JSON
- Metabase `master` as of `9e9e310`
```


### Severity

P1: Regression, Common functionality broken

### Additional context

_No response_",likeshumidity,2024-04-24 14:53:05+00:00,['ranquild'],2024-05-16 22:53:40+00:00,2024-05-16 22:51:40+00:00,https://github.com/metabase/metabase/issues/41783,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature'), ('.Team/Querying', '')]",[],
2261467438,issue,open,,[Testing plan] Custom column expression shortcuts ,"Testing plan for https://github.com/metabase/metabase/issues/41177

## Milestone 1 - Combine columns

- String column
  - Can combine with other string columns
  - Cannot combine columns if there are no other string columns
  - Default separator is ` ` (space)
- URL column
  - Can combine with other string columns
  - Cannot combine columns if there are no other string columns
  - Default separator is `/`
- Name of combined column defaults to the names of the merged column names separated with spaces
- Adding the same combination twice is possible, and names of columns are unique (e.g. ""URL Login"" and ""URL Login (2)"")
- Preview handles `null` values as empty strings

### Combined columns (e2e)

- Combined column name defaults to the names of the merged column names separated with spaces
- Adding the same combination twice is possible, and names of combined columns are unique (e.g. ""URL Login"" and ""URL Login (2)"")
- String column as a source
  - Default separator is ` ` (space)
- URL column as a source
  - Combined column is displayed as a link (viz settings)
  - Default separator is `/`
- Preview is updated after each change
  - after changing separator
  - after adding/removing/changing column
- Preview handles `null` values as empty strings
- Can combine multiple columns using different separators
  - Empty separator works (`separator === """"`)



### Milestone 2 - Extracted columns
- Adding the same extraction twice is possible, and names of columns are unique (e.g. `Year`, `Year (2)`)
- Hour of day
  - Column name should default to ""Hour of day""
  - The expression should use `hour()`
- Day of month
  - Column name should default to ""Day of month""
  - The expression should use `day()`
- Day of week
  - Column name should default to ""Day of week""
  - The expression should use `weekday()`
- Month
  - Column name should default to ""Month""
  - The expressions should use `month()`
- Quarter
  - Column name should default to ""Quarter""
  - The expression should use `quarter()`
- Year
  - Column name should default to ""Year""
  - Expression should use `year()`",romeovs,2024-04-24 14:39:25+00:00,[],2024-04-29 11:56:46+00:00,,https://github.com/metabase/metabase/issues/41782,"[('.TestingStrategy/FE', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2261321062,issue,closed,completed,[Docker] Migration from 0.49.5 to 0.49.6 or newer fails with csv plugin,"### Describe the bug

Hello!

we are running metabase inside docker (swarm). Currently we are not able to upgrade to a new version than `0.49.5`

Error: `ERROR liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat encountered an exception.`

Thank you for your work :)

### To Reproduce

Run v.0.49.5 and upgrade to 0.49.6 or 7


### Expected behavior

_No response_

### Logs
```
metabase_app.1.rg6y82ftxk7h@docker-02    | Metabase v0.49.6 (5abf130)
metabase_app.1.rg6y82ftxk7h@docker-02    |
metabase_app.1.rg6y82ftxk7h@docker-02    | Copyright © 2024 Metabase, Inc.
metabase_app.1.rg6y82ftxk7h@docker-02    |
metabase_app.1.rg6y82ftxk7h@docker-02    | Metabase Enterprise Edition extensions are NOT PRESENT.
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:10,214 INFO metabase.core :: Starting Metabase in STANDALONE mode
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:10,271 INFO metabase.server :: Launching Embedded Jetty Webserver with config:
metabase_app.1.rg6y82ftxk7h@docker-02    |  {:port 3000, :host ""0.0.0.0""}
metabase_app.1.rg6y82ftxk7h@docker-02    |
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:10,350 INFO metabase.core :: Starting Metabase version v0.49.6 (5abf130) ...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:10,354 INFO metabase.core :: System info:
metabase_app.1.rg6y82ftxk7h@docker-02    |  {""file.encoding"" ""UTF-8"",
metabase_app.1.rg6y82ftxk7h@docker-02    |  ""java.runtime.name"" ""OpenJDK Runtime Environment"",
metabase_app.1.rg6y82ftxk7h@docker-02    |  ""java.runtime.version"" ""11.0.22+7"",
metabase_app.1.rg6y82ftxk7h@docker-02    |  ""java.vendor"" ""Eclipse Adoptium"",
metabase_app.1.rg6y82ftxk7h@docker-02    |  ""java.vendor.url"" ""https://adoptium.net/"",
metabase_app.1.rg6y82ftxk7h@docker-02    |  ""java.version"" ""11.0.22"",
metabase_app.1.rg6y82ftxk7h@docker-02    |  ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",
metabase_app.1.rg6y82ftxk7h@docker-02    |  ""java.vm.version"" ""11.0.22+7"",
metabase_app.1.rg6y82ftxk7h@docker-02    |  ""os.name"" ""Linux"",
metabase_app.1.rg6y82ftxk7h@docker-02    |  ""os.version"" ""5.4.0-177-generic"",
metabase_app.1.rg6y82ftxk7h@docker-02    |  ""user.language"" ""en"",
metabase_app.1.rg6y82ftxk7h@docker-02    |  ""user.timezone"" ""GMT""}
metabase_app.1.rg6y82ftxk7h@docker-02    |
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:10,356 INFO metabase.plugins :: Loading plugins in /plugins...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:10,959 INFO util.files :: Extract file /modules/mongo.metabase-driver.jar -> /plugins/mongo.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:11,047 INFO util.files :: Extract file /modules/bigquery-cloud-sdk.metabase-driver.jar -> /plugins/bigquery-cloud-sdk.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:11,329 INFO util.files :: Extract file /modules/vertica.metabase-driver.jar -> /plugins/vertica.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:11,338 INFO util.files :: Extract file /modules/athena.metabase-driver.jar -> /plugins/athena.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:11,463 INFO util.files :: Extract file /modules/googleanalytics.metabase-driver.jar -> /plugins/googleanalytics.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:11,485 INFO util.files :: Extract file /modules/sqlite.metabase-driver.jar -> /plugins/sqlite.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:11,545 INFO util.files :: Extract file /modules/redshift.metabase-driver.jar -> /plugins/redshift.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:11,561 INFO util.files :: Extract file /modules/snowflake.metabase-driver.jar -> /plugins/snowflake.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:11,988 INFO util.files :: Extract file /modules/oracle.metabase-driver.jar -> /plugins/oracle.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:11,996 INFO util.files :: Extract file /modules/presto-jdbc.metabase-driver.jar -> /plugins/presto-jdbc.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,072 INFO util.files :: Extract file /modules/sparksql.metabase-driver.jar -> /plugins/sparksql.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,154 INFO util.files :: Extract file /modules/sqlserver.metabase-driver.jar -> /plugins/sqlserver.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,174 INFO util.files :: Extract file /modules/druid.metabase-driver.jar -> /plugins/druid.metabase-driver.jar
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,557 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,558 INFO driver.impl :: Registered driver :googleanalytics  🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,574 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,575 INFO driver.impl :: Registered driver :druid  🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,631 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,632 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,786 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,787 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,834 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,836 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,841 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :csv...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,843 INFO driver.impl :: Registered driver :csv (parents: [:sql-jdbc]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,857 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,858 INFO driver.impl :: Registered driver :mongo  🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,881 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,884 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,887 INFO plugins.dependencies :: Plugin 'Metabase Presto Driver' depends on plugin 'Presto Common Driver'
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,890 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? false
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,891 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver""]
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,933 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,934 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,950 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Oracle Driver due to required dependencies. Metabase requires the Oracle JDBC driver in order to connect to Oracle databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/oracle.html for more details.
metabase_app.1.rg6y82ftxk7h@docker-02    |
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,950 INFO plugins.dependencies :: Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? false
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,952 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver"" ""Metabase Oracle Driver""]
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,962 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,963 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,964 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,964 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,971 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,974 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,991 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :athena...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,991 INFO driver.impl :: Registered driver :athena (parents: [:sql-jdbc]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,994 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-common...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,994 INFO driver.impl :: Registered abstract driver :presto-common  🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,995 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? true
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,996 DEBUG plugins.initialize :: Dependencies satisfied; these plugins will now be loaded: [""Metabase Presto Driver""]
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,997 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:12,998 INFO driver.impl :: Registered driver :presto (parents: [:presto-common]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:13,033 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.
metabase_app.1.rg6y82ftxk7h@docker-02    |
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:13,035 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:13,035 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver"" ""Metabase Oracle Driver""]
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:13,044 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:13,049 INFO db.setup :: Verifying postgres Database Connection ...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:13,336 INFO db.setup :: Successfully verified PostgreSQL 13.14 (Debian 13.14-1.pgdg120+2) application database connection. ✅
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:13,337 INFO db.setup :: Checking if a database downgrade is required...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:14,385 INFO db.setup :: Running Database Migrations...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:14,426 INFO db.setup :: Setting up Liquibase...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:14,678 INFO db.setup :: Liquibase is ready.
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:14,678 INFO db.liquibase :: Checking if Database has unrun migrations...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:15,631 INFO db.liquibase :: Database has unrun migrations. Checking if migraton lock is taken...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:15,644 INFO db.liquibase :: No migration lock found.
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:16,155 INFO db.liquibase :: Running 1 migrations ...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:16,739 INFO driver.impl :: Initializing driver :sql...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:16,740 INFO driver.impl :: Initializing driver :sql-jdbc...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:16,741 INFO driver.impl :: Initializing driver :sqlserver...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:16,744 INFO plugins.classloader :: Added URL file:/plugins/sqlserver.metabase-driver.jar to classpath
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:16,746 DEBUG plugins.init-steps :: Loading plugin namespace metabase.driver.sqlserver...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,428 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,628 DEBUG plugins.jdbc-proxy :: Registering JDBC proxy driver for com.microsoft.sqlserver.jdbc.SQLServerDriver...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,631 INFO metabase.util ::  ⮦ Load lazy loading driver :sqlserver took 884.8 ms
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,660 INFO driver.impl :: Initializing driver :csv...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,666 INFO plugins.classloader :: Added URL file:/plugins/csv.metabase-driver.jar to classpath
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,666 DEBUG plugins.init-steps :: Loading plugin namespace metabase.driver.csv...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,677 ERROR liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat encountered an exception.
metabase_app.1.rg6y82ftxk7h@docker-02    |
metabase_app.1.rg6y82ftxk7h@docker-02    | UPDATE SUMMARY
metabase_app.1.rg6y82ftxk7h@docker-02    | Run:                          1
metabase_app.1.rg6y82ftxk7h@docker-02    | Previously run:             268
metabase_app.1.rg6y82ftxk7h@docker-02    | Filtered out:                17
metabase_app.1.rg6y82ftxk7h@docker-02    | -------------------------------
metabase_app.1.rg6y82ftxk7h@docker-02    | Total change sets:          286
metabase_app.1.rg6y82ftxk7h@docker-02    |
metabase_app.1.rg6y82ftxk7h@docker-02    |
metabase_app.1.rg6y82ftxk7h@docker-02    | FILTERED CHANGE SETS SUMMARY
metabase_app.1.rg6y82ftxk7h@docker-02    | DBMS mismatch:               17
metabase_app.1.rg6y82ftxk7h@docker-02    |
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,749 ERROR metabase.core :: Metabase Initialization FAILED
metabase_app.1.rg6y82ftxk7h@docker-02    | liquibase.exception.CommandExecutionException: java.lang.ClassCastException: class java.lang.ExceptionInInitializerError cannot be cast to class java.lang.Exception (java.lang.ExceptionInInitializerError and java.lang.Exception are in module java.base of loader 'bootstrap')
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.command.CommandScope.execute(CommandScope.java:253)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.Liquibase.lambda$update$0(Liquibase.java:245)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.Scope.lambda$child$0(Scope.java:186)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.Scope.child(Scope.java:195)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.Scope.child(Scope.java:185)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.Scope.child(Scope.java:164)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.Liquibase.runInScope(Liquibase.java:1419)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.Liquibase.update(Liquibase.java:234)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.Liquibase.update(Liquibase.java:212)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.Liquibase.update(Liquibase.java:194)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.liquibase$migrate_up_if_needed_BANG_.invokeStatic(liquibase.clj:305)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.liquibase$migrate_up_if_needed_BANG_.invoke(liquibase.clj:287)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.setup$migrate_BANG_$fn__51104.invoke(setup.clj:80)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.liquibase$do_with_liquibase$f_STAR___48780.invoke(liquibase.clj:139)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:142)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:130)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:445)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:147)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:141)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132$fn__51133.invoke(setup.clj:165)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132.invoke(setup.clj:160)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:159)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:153)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db$setup_db_BANG_$fn__51152.invoke(db.clj:69)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.db$setup_db_BANG_.invoke(db.clj:55)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:116)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.core$init_BANG__STAR_.invoke(core.clj:101)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.core$init_BANG_.invokeStatic(core.clj:159)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.core$init_BANG_.invoke(core.clj:154)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.core$start_normally.invokeStatic(core.clj:171)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.core$start_normally.invoke(core.clj:165)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.core$entrypoint.invokeStatic(core.clj:204)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.core$entrypoint.doInvoke(core.clj:198)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at clojure.lang.Var.applyTo(Var.java:705)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at clojure.core$apply.invokeStatic(core.clj:667)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at clojure.core$apply.invoke(core.clj:662)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at metabase.bootstrap.main(Unknown Source)
metabase_app.1.rg6y82ftxk7h@docker-02    | Caused by: java.lang.ClassCastException: class java.lang.ExceptionInInitializerError cannot be cast to class java.lang.Exception (java.lang.ExceptionInInitializerError and java.lang.Exception are in module java.base of loader 'bootstrap')
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.command.CommandScope.logPrimaryExceptionToMdc(CommandScope.java:287)
metabase_app.1.rg6y82ftxk7h@docker-02    |      at liquibase.command.CommandScope.execute(CommandScope.java:245)
metabase_app.1.rg6y82ftxk7h@docker-02    |      ... 49 more
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,761 INFO metabase.core :: Metabase Shutting Down ...
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,762 INFO metabase.server :: Shutting Down Embedded Jetty Webserver
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,768 WARN db.liquibase :: ()
metabase_app.1.rg6y82ftxk7h@docker-02    | 2024-04-24 13:27:17,769 INFO metabase.core :: Metabase Shutdown COMPLETE
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""de"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Edg/123.0.0.0"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.4.0-177-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""sqlserver"",
      ""csv""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""13.14 (Debian 13.14-1.pgdg120+2)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-11"",
      ""tag"": ""v0.49.5"",
      ""hash"": ""31c4887""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Berlin""
    }
  }
}
```


### Severity

blocking an upgrade 

### Additional context

_No response_",tdentwicklungsupport,2024-04-24 13:34:30+00:00,[],2024-04-25 11:18:23+00:00,2024-04-25 11:18:23+00:00,https://github.com/metabase/metabase/issues/41779,"[('Type:Bug', 'Product defects'), ('Operation/Database Migrations', 'Issues with application DB migrations when launching Metabase'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2074978620, 'issue_id': 2261321062, 'author': 'paoliniluis', 'body': 'ok this is weird as Metabase should not run any migration when moving between minor versions. Can you try running with MB_DB_AUTOMIGRATE=false?', 'created_at': datetime.datetime(2024, 4, 24, 13, 40, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2074988744, 'issue_id': 2261321062, 'author': 'tdentwicklungsupport', 'body': 'Hi @paoliniluis and thanks for the fast response\r\n\r\nI have the feeling something corrupted the database/migrations :)\r\n\r\nNew Log with ne information and `MB_DB_AUTOMIGRATE=false`:\r\n\r\n```\r\nmetabase_app.1.mp46w949fe9t@docker-02    | Metabase v0.49.7 (f0ff786)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | Copyright © 2024 Metabase, Inc.\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | Metabase Enterprise Edition extensions are NOT PRESENT.\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:05,563 INFO metabase.core :: Starting Metabase in STANDALONE mode\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:05,610 INFO metabase.server :: Launching Embedded Jetty Webserver with config:\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  {:port 3000, :host ""0.0.0.0""}\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:05,689 INFO metabase.core :: Starting Metabase version v0.49.7 (f0ff786) ...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:05,694 INFO metabase.core :: System info:\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  {""file.encoding"" ""UTF-8"",\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  ""java.runtime.name"" ""OpenJDK Runtime Environment"",\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  ""java.runtime.version"" ""11.0.22+7"",\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  ""java.vendor"" ""Eclipse Adoptium"",\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  ""java.vendor.url"" ""https://adoptium.net/"",\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  ""java.version"" ""11.0.22"",\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  ""java.vm.version"" ""11.0.22+7"",\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  ""os.name"" ""Linux"",\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  ""os.version"" ""5.4.0-177-generic"",\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  ""user.language"" ""en"",\r\nmetabase_app.1.mp46w949fe9t@docker-02    |  ""user.timezone"" ""GMT""}\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:05,696 INFO metabase.plugins :: Loading plugins in /plugins...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:06,259 INFO util.files :: Extract file /modules/athena.metabase-driver.jar -> /plugins/athena.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:06,470 INFO util.files :: Extract file /modules/presto-jdbc.metabase-driver.jar -> /plugins/presto-jdbc.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:06,549 INFO util.files :: Extract file /modules/snowflake.metabase-driver.jar -> /plugins/snowflake.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,035 INFO util.files :: Extract file /modules/oracle.metabase-driver.jar -> /plugins/oracle.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,043 INFO util.files :: Extract file /modules/googleanalytics.metabase-driver.jar -> /plugins/googleanalytics.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,073 INFO util.files :: Extract file /modules/vertica.metabase-driver.jar -> /plugins/vertica.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,089 INFO util.files :: Extract file /modules/mongo.metabase-driver.jar -> /plugins/mongo.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,131 INFO util.files :: Extract file /modules/redshift.metabase-driver.jar -> /plugins/redshift.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,148 INFO util.files :: Extract file /modules/sqlite.metabase-driver.jar -> /plugins/sqlite.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,213 INFO util.files :: Extract file /modules/sqlserver.metabase-driver.jar -> /plugins/sqlserver.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,238 INFO util.files :: Extract file /modules/sparksql.metabase-driver.jar -> /plugins/sparksql.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,327 INFO util.files :: Extract file /modules/druid.metabase-driver.jar -> /plugins/druid.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,341 INFO util.files :: Extract file /modules/bigquery-cloud-sdk.metabase-driver.jar -> /plugins/bigquery-cloud-sdk.metabase-driver.jar\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,861 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,862 INFO driver.impl :: Registered driver :googleanalytics  🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,874 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,875 INFO driver.impl :: Registered driver :druid  🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,889 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,890 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,046 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,047 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,063 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,064 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,067 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :csv...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,071 INFO driver.impl :: Registered driver :csv (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,085 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,089 INFO driver.impl :: Registered driver :mongo  🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,143 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,143 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,149 INFO plugins.dependencies :: Plugin \'Metabase Presto Driver\' depends on plugin \'Presto Common Driver\'\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,151 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? false\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,152 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver""]\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,164 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,166 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,181 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Oracle Driver due to required dependencies. Metabase requires the Oracle JDBC driver in order to connect to Oracle databases, but we can\'t ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/oracle.html for more details.\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,182 INFO plugins.dependencies :: Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? false\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,183 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver"" ""Metabase Oracle Driver""]\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,196 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,197 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,197 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,198 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,240 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,242 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,256 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :athena...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,257 INFO driver.impl :: Registered driver :athena (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,260 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-common...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,260 INFO driver.impl :: Registered abstract driver :presto-common  🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,262 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? true\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,263 DEBUG plugins.initialize :: Dependencies satisfied; these plugins will now be loaded: [""Metabase Presto Driver""]\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,264 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,265 INFO driver.impl :: Registered driver :presto (parents: [:presto-common]) 🚚\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,276 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can\'t ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,279 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,280 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Oracle Driver"" ""Metabase Vertica Driver""]\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,287 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,292 INFO db.setup :: Verifying postgres Database Connection ...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,565 INFO db.setup :: Successfully verified PostgreSQL 13.14 (Debian 13.14-1.pgdg120+2) application database connection. ✅\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,565 INFO db.setup :: Checking if a database downgrade is required...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:09,647 INFO db.setup :: Running Database Migrations...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:09,648 INFO db.setup :: Setting up Liquibase...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:10,078 INFO db.setup :: Liquibase is ready.\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,282 INFO db.setup :: Database Upgrade Required\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | NOTICE: Your database requires updates to work with this version of Metabase.\r\nmetabase_app.1.mp46w949fe9t@docker-02    | Please execute the following sql commands on your database before proceeding.\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | SET SEARCH_PATH TO public, ""$user"",""public"";\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | -- Lock Database\r\nmetabase_app.1.mp46w949fe9t@docker-02    | UPDATE public.databasechangeloglock SET LOCKED = TRUE, LOCKEDBY = \'4d32bea1ab17 (10.0.11.12)\', LOCKGRANTED = NOW() WHERE ID = 1 AND LOCKED = FALSE;\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | SET SEARCH_PATH TO public, ""$user"",""public"";\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | SET SEARCH_PATH TO public, ""$user"",""public"";\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | -- *********************************************************************\r\nmetabase_app.1.mp46w949fe9t@docker-02    | -- Update Database Script\r\nmetabase_app.1.mp46w949fe9t@docker-02    | -- *********************************************************************\r\nmetabase_app.1.mp46w949fe9t@docker-02    | -- Change Log: liquibase.yaml\r\nmetabase_app.1.mp46w949fe9t@docker-02    | -- Ran at: 4/24/24, 1:43 PM\r\nmetabase_app.1.mp46w949fe9t@docker-02    | -- Against: metabase@jdbc:postgresql://db:5432/metabase\r\nmetabase_app.1.mp46w949fe9t@docker-02    | -- Liquibase version: 4.25.1\r\nmetabase_app.1.mp46w949fe9t@docker-02    | -- *********************************************************************\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | -- Release Database Lock\r\nmetabase_app.1.mp46w949fe9t@docker-02    | SET SEARCH_PATH TO public, ""$user"",""public"";\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | UPDATE public.databasechangeloglock SET LOCKED = FALSE, LOCKEDBY = NULL, LOCKGRANTED = NULL WHERE ID = 1;\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | SET SEARCH_PATH TO public, ""$user"",""public"";\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | Once your database is updated try running the application again.\r\nmetabase_app.1.mp46w949fe9t@docker-02    |\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,345 ERROR metabase.core :: Metabase Initialization FAILED\r\nmetabase_app.1.mp46w949fe9t@docker-02    | java.lang.Exception: Database requires manual upgrade.\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$print_migrations_and_quit_if_needed_BANG_.invokeStatic(setup.clj:54)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$print_migrations_and_quit_if_needed_BANG_.invoke(setup.clj:39)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$migrate_BANG_$fn__51104.invoke(setup.clj:83)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.liquibase$do_with_liquibase$f_STAR___48780.invoke(liquibase.clj:139)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:142)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:130)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:445)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:147)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:141)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132$fn__51133.invoke(setup.clj:165)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132.invoke(setup.clj:160)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:159)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:153)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db$setup_db_BANG_$fn__51152.invoke(db.clj:69)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db$setup_db_BANG_.invoke(db.clj:55)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:116)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$init_BANG__STAR_.invoke(core.clj:101)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$init_BANG_.invokeStatic(core.clj:159)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$init_BANG_.invoke(core.clj:154)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$start_normally.invokeStatic(core.clj:171)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$start_normally.invoke(core.clj:165)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$entrypoint.invokeStatic(core.clj:204)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$entrypoint.doInvoke(core.clj:198)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.Var.applyTo(Var.java:705)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at clojure.core$apply.invokeStatic(core.clj:667)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at clojure.core$apply.invoke(core.clj:662)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)\r\nmetabase_app.1.mp46w949fe9t@docker-02    |      at metabase.bootstrap.main(Unknown Source)\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,362 INFO metabase.core :: Metabase Shutting Down ...\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,363 INFO metabase.server :: Shutting Down Embedded Jetty Webserver\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,373 WARN db.liquibase :: ()\r\nmetabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,374 INFO metabase.core :: Metabase Shutdown COMPLETE\r\n\r\n\r\n```', 'created_at': datetime.datetime(2024, 4, 24, 13, 44, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2075021716, 'issue_id': 2261321062, 'author': 'qnkhuat', 'body': 'Hi @tdentwicklungsupport \r\n\r\nCould you run it again with this log config?\r\n\r\n```\r\n<?xml version=""1.0"" encoding=""UTF-8""?>\r\n<Configuration>\r\n  <Appenders>\r\n    <Console name=""STDOUT"" target=""SYSTEM_OUT"" follow=""true"">\r\n      <PatternLayout pattern=""%date %level %logger{2} :: %message%n%throwable"">\r\n        <replace regex="":basic-auth \\\\[.*\\\\]"" replacement="":basic-auth [redacted]""/>\r\n      </PatternLayout>\r\n    </Console>\r\n\r\n    <!-- This file appender is provided as an example -->\r\n    <!--\r\n    <RollingFile name=""FILE"" fileName=""${logfile.path}/metabase.log"" filePattern=""${logfile.path}/metabase.log.%i"">\r\n      <Policies>\r\n        <SizeBasedTriggeringPolicy size=""500 MB""/>\r\n      </Policies>\r\n      <DefaultRolloverStrategy max=""2""/>\r\n      <PatternLayout pattern=""%d [%t] %-5p%c - %m%n"">\r\n        <replace regex="":basic-auth \\\\[.*\\\\]"" replacement="":basic-auth [redacted]""/>\r\n      </PatternLayout>\r\n    </RollingFile>\r\n    -->\r\n  </Appenders>\r\n\r\n  <Loggers>\r\n    <Logger name=""metabase"" level=""INFO""/>\r\n    <Logger name=""metabase-enterprise"" level=""INFO""/>\r\n    <Logger name=""metabase.metabot"" level=""DEBUG""/>\r\n    <Logger name=""metabase.plugins"" level=""DEBUG""/>\r\n    <Logger name=""metabase.server.middleware"" level=""DEBUG""/>\r\n    <Logger name=""metabase.query-processor.async"" level=""DEBUG""/>\r\n    <Logger name=""com.mchange"" level=""ERROR""/>\r\n    <Logger name=""org.quartz"" level=""TRACE""/>\r\n    <Logger name=""toucan2"" level=""DEBUG""/>\r\n    <Logger name=""liquibase"" level=""ERROR""/>\r\n    <Logger name=""net.snowflake.client.jdbc.SnowflakeConnectString"" level=""ERROR""/>\r\n\r\n    <Root level=""WARN"">\r\n      <AppenderRef ref=""STDOUT""/>\r\n    </Root>\r\n  </Loggers>\r\n</Configuration>\r\n```\r\n\r\nI want to get a more detailed log of what\'s going on.\r\n\r\nAlso, as a rule of thumb, always back up your db before migrating.', 'created_at': datetime.datetime(2024, 4, 24, 13, 59, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2075023900, 'issue_id': 2261321062, 'author': 'qnkhuat', 'body': 'See [this](https://www.metabase.com/docs/latest/configuring-metabase/log-configuration#using-log4j-2-with-docker) for how to run metabase with a custom log file', 'created_at': datetime.datetime(2024, 4, 24, 14, 0, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2075064396, 'issue_id': 2261321062, 'author': 'tdentwicklungsupport', 'body': '@qnkhuat see below (i guess it did work adding the custom logging)\r\n\r\n```\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | Metabase v0.49.7 (f0ff786)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | Copyright © 2024 Metabase, Inc.\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | Metabase Enterprise Edition extensions are NOT PRESENT.\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:38,020 INFO metabase.core :: Starting Metabase in STANDALONE mode\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:38,075 INFO metabase.server :: Launching Embedded Jetty Webserver with config:\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  {:port 3000, :host ""0.0.0.0""}\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:38,164 INFO metabase.core :: Starting Metabase version v0.49.7 (f0ff786) ...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:38,186 INFO metabase.core :: System info:\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  {""file.encoding"" ""UTF-8"",\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.runtime.name"" ""OpenJDK Runtime Environment"",\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.runtime.version"" ""11.0.22+7"",\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.vendor"" ""Eclipse Adoptium"",\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.vendor.url"" ""https://adoptium.net/"",\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.version"" ""11.0.22"",\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.vm.version"" ""11.0.22+7"",\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ""os.name"" ""Linux"",\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ""os.version"" ""5.4.0-177-generic"",\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ""user.language"" ""en"",\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ""user.timezone"" ""GMT""}\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:38,225 INFO metabase.plugins :: Loading plugins in /plugins...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,058 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,058 INFO driver.impl :: Registered driver :googleanalytics  🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,073 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,074 INFO driver.impl :: Registered driver :druid  🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,086 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,128 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,175 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,177 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,237 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,238 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,246 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :csv...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,247 INFO driver.impl :: Registered driver :csv (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,261 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,262 INFO driver.impl :: Registered driver :mongo  🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,327 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,330 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,334 INFO plugins.dependencies :: Plugin \'Metabase Presto Driver\' depends on plugin \'Presto Common Driver\'\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,336 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? false\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,336 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver""]\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,456 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,458 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,467 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Oracle Driver due to required dependencies. Metabase requires the Oracle JDBC driver in order to connect to Oracle databases, but we can\'t ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/oracle.html for more details.\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,468 INFO plugins.dependencies :: Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? false\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,470 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver"" ""Metabase Oracle Driver""]\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,481 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,482 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,483 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,483 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,528 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,529 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,541 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :athena...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,543 INFO driver.impl :: Registered driver :athena (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,549 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-common...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,555 INFO driver.impl :: Registered abstract driver :presto-common  🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,558 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? true\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,561 DEBUG plugins.initialize :: Dependencies satisfied; these plugins will now be loaded: [""Metabase Presto Driver""]\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,562 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,564 INFO driver.impl :: Registered driver :presto (parents: [:presto-common]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,582 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can\'t ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,585 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,587 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver"" ""Metabase Oracle Driver""]\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,633 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,637 INFO db.setup :: Verifying postgres Database Connection ...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,936 INFO db.setup :: Successfully verified PostgreSQL 13.14 (Debian 13.14-1.pgdg120+2) application database connection. ✅\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,937 INFO db.setup :: Checking if a database downgrade is required...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:41,034 INFO db.setup :: Running Database Migrations...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:41,035 INFO db.setup :: Setting up Liquibase...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:41,348 INFO db.setup :: Liquibase is ready.\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:41,348 INFO db.liquibase :: Checking if Database has unrun migrations...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:42,164 INFO db.liquibase :: Database has unrun migrations. Checking if migraton lock is taken...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:42,172 INFO db.liquibase :: No migration lock found.\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:42,653 INFO db.liquibase :: Running 1 migrations ...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,141 DEBUG toucan2.connection :: Resolve connection nil\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,144 DEBUG toucan2.connection :: Resolve connection org.postgresql.jdbc.PgConnection\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,147 DEBUG toucan2.connection :: do with transaction nil com.mchange.v2.c3p0.impl.NewProxyConnection\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,152 DEBUG toucan2.query :: Parse args for query type :toucan.query-type/select.instances (:model/Database)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,156 DEBUG toucan2.query :: Parsed => {:modelable :model/Database, :queryable {}}\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,158 DEBUG toucan2.model :: Resolved modelable :model/Database => model :model/Database\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,165 DEBUG toucan2.honeysql2 :: Building SELECT query for :model/Database with columns nil\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,171 DEBUG toucan2.honeysql2 :: => {:from [[:metabase_database]], :select [:*]}\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,172 DEBUG toucan2.query :: Apply kv-args nil\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,176 DEBUG toucan2.honeysql2 :: Compiling Honey SQL 2 with options {:dialect :metabase.db.setup/application-db, :quoted true, :quoted-snake false}\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,180 DEBUG toucan2.honeysql2 :: => [""SELECT * FROM \\""metabase_database\\""""]\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,230 DEBUG toucan2.connection :: Resolve connection nil\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,237 DEBUG toucan2.connection :: Resolve connection org.postgresql.jdbc.PgConnection\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,249 DEBUG jdbc.query :: Preparing JDBC query with next.jdbc options\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | {:concurrency :read-only,\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  :cursors :close,\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  :label-fn #<metabase.util$lower_case_en@52df2fd4>,\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  :read-columns #<metabase.db.jdbc_protocols$read_columns@1a6d1426>,\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  :result-type :forward-only}\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,254 DEBUG jdbc.query :: Query returned normal result set\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,256 DEBUG jdbc.result-set :: Reduce JDBC result set for model :model/Database with rf #<clojure.core$map$fn__5931$fn__5932@3805c478> and init []\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,262 DEBUG jdbc.result-set :: Getting modified column names with next.jdbc options\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | {:label-fn #<metabase.util$lower_case_en@52df2fd4>,\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  :qualifier-fn #<clojure.core$memoize$fn__6946@253be96d>,\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  :read-columns #<metabase.db.jdbc_protocols$read_columns@1a6d1426>,\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  :concurrency :read-only,\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  :cursors :close,\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |  ...}\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,276 DEBUG jdbc.result-set :: Column names: [:id :created_at :updated_at :name :description ...]\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,287 DEBUG jdbc.result-set :: Could not determine index of column name :start_of_week. Found: [:id :created_at :updated_at :name :description ...]\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,331 DEBUG jdbc.read :: Column 7 ""metabase_database.engine"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,336 DEBUG jdbc.read :: Fetching values in column 7 with (.getObject rs 7)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,340 INFO driver.impl :: Initializing driver :sql...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,341 INFO driver.impl :: Initializing driver :sql-jdbc...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,341 INFO driver.impl :: Initializing driver :sqlserver...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,342 INFO plugins.classloader :: Added URL file:/plugins/sqlserver.metabase-driver.jar to classpath\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,344 DEBUG plugins.init-steps :: Loading plugin namespace metabase.driver.sqlserver...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,030 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,276 DEBUG plugins.jdbc-proxy :: Registering JDBC proxy driver for com.microsoft.sqlserver.jdbc.SQLServerDriver...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,279 INFO metabase.util ::  ⮦ Load lazy loading driver :sqlserver took 934.9 ms\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,282 DEBUG jdbc.read :: Column 22 ""metabase_database.dbms_version"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,284 DEBUG jdbc.read :: Fetching values in column 22 with (.getObject rs 22)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,336 DEBUG jdbc.read :: Column 6 ""metabase_database.details"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,338 DEBUG jdbc.read :: Fetching values in column 6 with (.getObject rs 6)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,342 DEBUG jdbc.read :: Column 1 ""metabase_database.id"" is of JDBC type java.sql.Types/INTEGER, native type ""serial""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,345 DEBUG jdbc.read :: Fetching values in column 1 with (.getObject rs 1)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,346 DEBUG jdbc.read :: Column 2 ""metabase_database.created_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,349 DEBUG jdbc.read :: Fetching values in column 2 with (.getObject rs 2 java.time.OffsetDateTime)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,353 DEBUG jdbc.read :: Column 3 ""metabase_database.updated_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,353 DEBUG jdbc.read :: Fetching values in column 3 with (.getObject rs 3 java.time.OffsetDateTime)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,354 DEBUG jdbc.read :: Column 4 ""metabase_database.name"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,356 DEBUG jdbc.read :: Fetching values in column 4 with (.getObject rs 4)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,356 DEBUG jdbc.read :: Column 5 ""metabase_database.description"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,358 DEBUG jdbc.read :: Fetching values in column 5 with (.getObject rs 5)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,359 DEBUG jdbc.read :: Column 8 ""metabase_database.is_sample"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,361 DEBUG jdbc.read :: Fetching values in column 8 with (.getObject rs 8)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,362 DEBUG jdbc.read :: Column 9 ""metabase_database.is_full_sync"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,363 DEBUG jdbc.read :: Fetching values in column 9 with (.getObject rs 9)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,365 DEBUG jdbc.read :: Column 10 ""metabase_database.points_of_interest"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,366 DEBUG jdbc.read :: Fetching values in column 10 with (.getObject rs 10)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,368 DEBUG jdbc.read :: Column 11 ""metabase_database.caveats"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,368 DEBUG jdbc.read :: Fetching values in column 11 with (.getObject rs 11)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,369 DEBUG jdbc.read :: Column 12 ""metabase_database.metadata_sync_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,370 DEBUG jdbc.read :: Fetching values in column 12 with (.getObject rs 12)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,370 DEBUG jdbc.read :: Column 13 ""metabase_database.cache_field_values_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,371 DEBUG jdbc.read :: Fetching values in column 13 with (.getObject rs 13)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,372 DEBUG jdbc.read :: Column 14 ""metabase_database.timezone"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,374 DEBUG jdbc.read :: Fetching values in column 14 with (.getObject rs 14)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,375 DEBUG jdbc.read :: Column 15 ""metabase_database.is_on_demand"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,379 DEBUG jdbc.read :: Fetching values in column 15 with (.getObject rs 15)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,381 DEBUG jdbc.read :: Column 16 ""metabase_database.auto_run_queries"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,383 DEBUG jdbc.read :: Fetching values in column 16 with (.getObject rs 16)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,385 DEBUG jdbc.read :: Column 17 ""metabase_database.refingerprint"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,387 DEBUG jdbc.read :: Fetching values in column 17 with (.getObject rs 17)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,388 DEBUG jdbc.read :: Column 18 ""metabase_database.cache_ttl"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,389 DEBUG jdbc.read :: Fetching values in column 18 with (.getObject rs 18)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,426 DEBUG jdbc.read :: Column 19 ""metabase_database.initial_sync_status"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,428 DEBUG jdbc.read :: Fetching values in column 19 with (.getObject rs 19)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,429 DEBUG jdbc.read :: Column 20 ""metabase_database.creator_id"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,430 DEBUG jdbc.read :: Fetching values in column 20 with (.getObject rs 20)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,431 DEBUG jdbc.read :: Column 21 ""metabase_database.settings"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,431 DEBUG jdbc.read :: Fetching values in column 21 with (.getObject rs 21)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,432 DEBUG jdbc.read :: Column 23 ""metabase_database.is_audit"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,434 DEBUG jdbc.read :: Fetching values in column 23 with (.getObject rs 23)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,435 DEBUG jdbc.read :: Column 7 ""metabase_database.engine"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,436 DEBUG jdbc.read :: Fetching values in column 7 with (.getObject rs 7)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,437 DEBUG jdbc.read :: Column 22 ""metabase_database.dbms_version"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,438 DEBUG jdbc.read :: Fetching values in column 22 with (.getObject rs 22)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,439 DEBUG jdbc.read :: Column 6 ""metabase_database.details"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,441 DEBUG jdbc.read :: Fetching values in column 6 with (.getObject rs 6)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,442 DEBUG jdbc.read :: Column 1 ""metabase_database.id"" is of JDBC type java.sql.Types/INTEGER, native type ""serial""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,443 DEBUG jdbc.read :: Fetching values in column 1 with (.getObject rs 1)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,446 DEBUG jdbc.read :: Column 2 ""metabase_database.created_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,449 DEBUG jdbc.read :: Fetching values in column 2 with (.getObject rs 2 java.time.OffsetDateTime)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,450 DEBUG jdbc.read :: Column 3 ""metabase_database.updated_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,454 DEBUG jdbc.read :: Fetching values in column 3 with (.getObject rs 3 java.time.OffsetDateTime)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,455 DEBUG jdbc.read :: Column 4 ""metabase_database.name"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,457 DEBUG jdbc.read :: Fetching values in column 4 with (.getObject rs 4)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,458 DEBUG jdbc.read :: Column 5 ""metabase_database.description"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,458 DEBUG jdbc.read :: Fetching values in column 5 with (.getObject rs 5)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,459 DEBUG jdbc.read :: Column 8 ""metabase_database.is_sample"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,460 DEBUG jdbc.read :: Fetching values in column 8 with (.getObject rs 8)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,460 DEBUG jdbc.read :: Column 9 ""metabase_database.is_full_sync"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,461 DEBUG jdbc.read :: Fetching values in column 9 with (.getObject rs 9)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,462 DEBUG jdbc.read :: Column 10 ""metabase_database.points_of_interest"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,464 DEBUG jdbc.read :: Fetching values in column 10 with (.getObject rs 10)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,464 DEBUG jdbc.read :: Column 11 ""metabase_database.caveats"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,465 DEBUG jdbc.read :: Fetching values in column 11 with (.getObject rs 11)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,466 DEBUG jdbc.read :: Column 12 ""metabase_database.metadata_sync_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,466 DEBUG jdbc.read :: Fetching values in column 12 with (.getObject rs 12)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,467 DEBUG jdbc.read :: Column 13 ""metabase_database.cache_field_values_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,488 DEBUG jdbc.read :: Fetching values in column 13 with (.getObject rs 13)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,490 DEBUG jdbc.read :: Column 14 ""metabase_database.timezone"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,490 DEBUG jdbc.read :: Fetching values in column 14 with (.getObject rs 14)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,491 DEBUG jdbc.read :: Column 15 ""metabase_database.is_on_demand"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,492 DEBUG jdbc.read :: Fetching values in column 15 with (.getObject rs 15)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,493 DEBUG jdbc.read :: Column 16 ""metabase_database.auto_run_queries"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,494 DEBUG jdbc.read :: Fetching values in column 16 with (.getObject rs 16)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,494 DEBUG jdbc.read :: Column 17 ""metabase_database.refingerprint"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,495 DEBUG jdbc.read :: Fetching values in column 17 with (.getObject rs 17)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,496 DEBUG jdbc.read :: Column 18 ""metabase_database.cache_ttl"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,496 DEBUG jdbc.read :: Fetching values in column 18 with (.getObject rs 18)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,497 DEBUG jdbc.read :: Column 19 ""metabase_database.initial_sync_status"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,498 DEBUG jdbc.read :: Fetching values in column 19 with (.getObject rs 19)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,498 DEBUG jdbc.read :: Column 20 ""metabase_database.creator_id"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,499 DEBUG jdbc.read :: Fetching values in column 20 with (.getObject rs 20)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,499 DEBUG jdbc.read :: Column 21 ""metabase_database.settings"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,500 DEBUG jdbc.read :: Fetching values in column 21 with (.getObject rs 21)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,501 DEBUG jdbc.read :: Column 23 ""metabase_database.is_audit"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,526 DEBUG jdbc.read :: Fetching values in column 23 with (.getObject rs 23)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,528 DEBUG jdbc.read :: Column 7 ""metabase_database.engine"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,528 DEBUG jdbc.read :: Fetching values in column 7 with (.getObject rs 7)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,529 DEBUG jdbc.read :: Column 22 ""metabase_database.dbms_version"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,530 DEBUG jdbc.read :: Fetching values in column 22 with (.getObject rs 22)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,532 DEBUG jdbc.read :: Column 6 ""metabase_database.details"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,532 DEBUG jdbc.read :: Fetching values in column 6 with (.getObject rs 6)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,534 DEBUG jdbc.read :: Column 1 ""metabase_database.id"" is of JDBC type java.sql.Types/INTEGER, native type ""serial""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,534 DEBUG jdbc.read :: Fetching values in column 1 with (.getObject rs 1)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,535 DEBUG jdbc.read :: Column 2 ""metabase_database.created_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,536 DEBUG jdbc.read :: Fetching values in column 2 with (.getObject rs 2 java.time.OffsetDateTime)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,537 DEBUG jdbc.read :: Column 3 ""metabase_database.updated_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,537 DEBUG jdbc.read :: Fetching values in column 3 with (.getObject rs 3 java.time.OffsetDateTime)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,538 DEBUG jdbc.read :: Column 4 ""metabase_database.name"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,539 DEBUG jdbc.read :: Fetching values in column 4 with (.getObject rs 4)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,539 DEBUG jdbc.read :: Column 5 ""metabase_database.description"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,540 DEBUG jdbc.read :: Fetching values in column 5 with (.getObject rs 5)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,540 DEBUG jdbc.read :: Column 8 ""metabase_database.is_sample"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,541 DEBUG jdbc.read :: Fetching values in column 8 with (.getObject rs 8)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,542 DEBUG jdbc.read :: Column 9 ""metabase_database.is_full_sync"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,542 DEBUG jdbc.read :: Fetching values in column 9 with (.getObject rs 9)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,543 DEBUG jdbc.read :: Column 10 ""metabase_database.points_of_interest"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,544 DEBUG jdbc.read :: Fetching values in column 10 with (.getObject rs 10)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,544 DEBUG jdbc.read :: Column 11 ""metabase_database.caveats"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,545 DEBUG jdbc.read :: Fetching values in column 11 with (.getObject rs 11)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,545 DEBUG jdbc.read :: Column 12 ""metabase_database.metadata_sync_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,546 DEBUG jdbc.read :: Fetching values in column 12 with (.getObject rs 12)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,546 DEBUG jdbc.read :: Column 13 ""metabase_database.cache_field_values_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,547 DEBUG jdbc.read :: Fetching values in column 13 with (.getObject rs 13)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,548 DEBUG jdbc.read :: Column 14 ""metabase_database.timezone"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,548 DEBUG jdbc.read :: Fetching values in column 14 with (.getObject rs 14)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,549 DEBUG jdbc.read :: Column 15 ""metabase_database.is_on_demand"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,550 DEBUG jdbc.read :: Fetching values in column 15 with (.getObject rs 15)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,550 DEBUG jdbc.read :: Column 16 ""metabase_database.auto_run_queries"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,551 DEBUG jdbc.read :: Fetching values in column 16 with (.getObject rs 16)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,551 DEBUG jdbc.read :: Column 17 ""metabase_database.refingerprint"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,552 DEBUG jdbc.read :: Fetching values in column 17 with (.getObject rs 17)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,553 DEBUG jdbc.read :: Column 18 ""metabase_database.cache_ttl"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,553 DEBUG jdbc.read :: Fetching values in column 18 with (.getObject rs 18)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,554 DEBUG jdbc.read :: Column 19 ""metabase_database.initial_sync_status"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,554 DEBUG jdbc.read :: Fetching values in column 19 with (.getObject rs 19)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,555 DEBUG jdbc.read :: Column 20 ""metabase_database.creator_id"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,556 DEBUG jdbc.read :: Fetching values in column 20 with (.getObject rs 20)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,556 DEBUG jdbc.read :: Column 21 ""metabase_database.settings"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,557 DEBUG jdbc.read :: Fetching values in column 21 with (.getObject rs 21)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,557 DEBUG jdbc.read :: Column 23 ""metabase_database.is_audit"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,558 DEBUG jdbc.read :: Fetching values in column 23 with (.getObject rs 23)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,559 DEBUG jdbc.read :: Column 7 ""metabase_database.engine"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,560 DEBUG jdbc.read :: Fetching values in column 7 with (.getObject rs 7)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,560 DEBUG jdbc.read :: Column 22 ""metabase_database.dbms_version"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,561 DEBUG jdbc.read :: Fetching values in column 22 with (.getObject rs 22)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,562 DEBUG jdbc.read :: Column 6 ""metabase_database.details"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,563 DEBUG jdbc.read :: Fetching values in column 6 with (.getObject rs 6)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,564 DEBUG jdbc.read :: Column 1 ""metabase_database.id"" is of JDBC type java.sql.Types/INTEGER, native type ""serial""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,564 DEBUG jdbc.read :: Fetching values in column 1 with (.getObject rs 1)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,565 DEBUG jdbc.read :: Column 2 ""metabase_database.created_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,566 DEBUG jdbc.read :: Fetching values in column 2 with (.getObject rs 2 java.time.OffsetDateTime)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,566 DEBUG jdbc.read :: Column 3 ""metabase_database.updated_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,567 DEBUG jdbc.read :: Fetching values in column 3 with (.getObject rs 3 java.time.OffsetDateTime)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,567 DEBUG jdbc.read :: Column 4 ""metabase_database.name"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,568 DEBUG jdbc.read :: Fetching values in column 4 with (.getObject rs 4)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,569 DEBUG jdbc.read :: Column 5 ""metabase_database.description"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,569 DEBUG jdbc.read :: Fetching values in column 5 with (.getObject rs 5)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,570 DEBUG jdbc.read :: Column 8 ""metabase_database.is_sample"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,571 DEBUG jdbc.read :: Fetching values in column 8 with (.getObject rs 8)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,572 DEBUG jdbc.read :: Column 9 ""metabase_database.is_full_sync"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,572 DEBUG jdbc.read :: Fetching values in column 9 with (.getObject rs 9)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,573 DEBUG jdbc.read :: Column 10 ""metabase_database.points_of_interest"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,574 DEBUG jdbc.read :: Fetching values in column 10 with (.getObject rs 10)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,574 DEBUG jdbc.read :: Column 11 ""metabase_database.caveats"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,575 DEBUG jdbc.read :: Fetching values in column 11 with (.getObject rs 11)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,575 DEBUG jdbc.read :: Column 12 ""metabase_database.metadata_sync_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,576 DEBUG jdbc.read :: Fetching values in column 12 with (.getObject rs 12)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,577 DEBUG jdbc.read :: Column 13 ""metabase_database.cache_field_values_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,577 DEBUG jdbc.read :: Fetching values in column 13 with (.getObject rs 13)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,578 DEBUG jdbc.read :: Column 14 ""metabase_database.timezone"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,579 DEBUG jdbc.read :: Fetching values in column 14 with (.getObject rs 14)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,579 DEBUG jdbc.read :: Column 15 ""metabase_database.is_on_demand"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,580 DEBUG jdbc.read :: Fetching values in column 15 with (.getObject rs 15)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,580 DEBUG jdbc.read :: Column 16 ""metabase_database.auto_run_queries"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,581 DEBUG jdbc.read :: Fetching values in column 16 with (.getObject rs 16)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,582 DEBUG jdbc.read :: Column 17 ""metabase_database.refingerprint"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,582 DEBUG jdbc.read :: Fetching values in column 17 with (.getObject rs 17)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,583 DEBUG jdbc.read :: Column 18 ""metabase_database.cache_ttl"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,584 DEBUG jdbc.read :: Fetching values in column 18 with (.getObject rs 18)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,584 DEBUG jdbc.read :: Column 19 ""metabase_database.initial_sync_status"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,585 DEBUG jdbc.read :: Fetching values in column 19 with (.getObject rs 19)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,585 DEBUG jdbc.read :: Column 20 ""metabase_database.creator_id"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,586 DEBUG jdbc.read :: Fetching values in column 20 with (.getObject rs 20)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,587 DEBUG jdbc.read :: Column 21 ""metabase_database.settings"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,587 DEBUG jdbc.read :: Fetching values in column 21 with (.getObject rs 21)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,588 DEBUG jdbc.read :: Column 23 ""metabase_database.is_audit"" is of JDBC type java.sql.Types/BIT, native type ""bool""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,588 DEBUG jdbc.read :: Fetching values in column 23 with (.getObject rs 23)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,589 DEBUG jdbc.read :: Column 7 ""metabase_database.engine"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,590 DEBUG jdbc.read :: Fetching values in column 7 with (.getObject rs 7)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,591 INFO driver.impl :: Initializing driver :csv...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,592 INFO plugins.classloader :: Added URL file:/plugins/csv.metabase-driver.jar to classpath\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,592 DEBUG plugins.init-steps :: Loading plugin namespace metabase.driver.csv...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,631 ERROR liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat encountered an exception.\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | UPDATE SUMMARY\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | Run:                          1\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | Previously run:             268\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | Filtered out:                17\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | -------------------------------\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | Total change sets:          286\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | FILTERED CHANGE SETS SUMMARY\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | DBMS mismatch:               17\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,668 ERROR metabase.core :: Metabase Initialization FAILED\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | liquibase.exception.CommandExecutionException: java.lang.ClassCastException: class java.lang.ExceptionInInitializerError cannot be cast to class java.lang.Exception (java.lang.ExceptionInInitializerError and java.lang.Exception are in module java.base of loader \'bootstrap\')\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.command.CommandScope.execute(CommandScope.java:253)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Liquibase.lambda$update$0(Liquibase.java:245)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Scope.lambda$child$0(Scope.java:186)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Scope.child(Scope.java:195)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Scope.child(Scope.java:185)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Scope.child(Scope.java:164)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Liquibase.runInScope(Liquibase.java:1419)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Liquibase.update(Liquibase.java:234)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Liquibase.update(Liquibase.java:212)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Liquibase.update(Liquibase.java:194)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.liquibase$migrate_up_if_needed_BANG_.invokeStatic(liquibase.clj:305)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.liquibase$migrate_up_if_needed_BANG_.invoke(liquibase.clj:287)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$migrate_BANG_$fn__51104.invoke(setup.clj:80)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.liquibase$do_with_liquibase$f_STAR___48780.invoke(liquibase.clj:139)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:142)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:130)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:445)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:147)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:141)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132$fn__51133.invoke(setup.clj:165)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132.invoke(setup.clj:160)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:159)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:153)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db$setup_db_BANG_$fn__51152.invoke(db.clj:69)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db$setup_db_BANG_.invoke(db.clj:55)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:116)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$init_BANG__STAR_.invoke(core.clj:101)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$init_BANG_.invokeStatic(core.clj:159)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$init_BANG_.invoke(core.clj:154)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$start_normally.invokeStatic(core.clj:171)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$start_normally.invoke(core.clj:165)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$entrypoint.invokeStatic(core.clj:204)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$entrypoint.doInvoke(core.clj:198)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.Var.applyTo(Var.java:705)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.core$apply.invokeStatic(core.clj:667)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.core$apply.invoke(core.clj:662)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.bootstrap.main(Unknown Source)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | Caused by: java.lang.ClassCastException: class java.lang.ExceptionInInitializerError cannot be cast to class java.lang.Exception (java.lang.ExceptionInInitializerError and java.lang.Exception are in module java.base of loader \'bootstrap\')\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.command.CommandScope.logPrimaryExceptionToMdc(CommandScope.java:287)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.command.CommandScope.execute(CommandScope.java:245)\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    |      ... 49 more\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,678 INFO metabase.core :: Metabase Shutting Down ...\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,679 INFO metabase.server :: Shutting Down Embedded Jetty Webserver\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,685 WARN db.liquibase :: ()\r\nmetabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,686 INFO metabase.core :: Metabase Shutdown COMPLETE\r\n```', 'created_at': datetime.datetime(2024, 4, 24, 14, 18, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2076734664, 'issue_id': 2261321062, 'author': 'qnkhuat', 'body': 'hmm, the log is not really helpful.\r\n\r\nDid you do anything custom with your instance?\r\n\r\nAlso I see in the list of DBs you have `csv`. what is that?', 'created_at': datetime.datetime(2024, 4, 25, 9, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2076782225, 'issue_id': 2261321062, 'author': 'tdentwicklungsupport', 'body': '> Did you do anything custom with your instance?\r\n\r\nNothing i am aware of\r\n\r\n>Also I see in the list of DBs you have csv. what is that?\r\n\r\nThis was a csv plugin - removed that now\r\n\r\n\r\nAlso i see another error when upgrading directl from .5 to .7:\r\n` auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.`\r\n\r\n\r\n```\r\nmetabase_app.1.swfh5438l6ix@docker-02    | Metabase v0.49.7 (f0ff786)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |\r\nmetabase_app.1.swfh5438l6ix@docker-02    | Copyright © 2024 Metabase, Inc.\r\nmetabase_app.1.swfh5438l6ix@docker-02    |\r\nmetabase_app.1.swfh5438l6ix@docker-02    | Metabase Enterprise Edition extensions are NOT PRESENT.\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:18,085 INFO metabase.core :: Starting Metabase in STANDALONE mode\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:18,147 INFO metabase.server :: Launching Embedded Jetty Webserver with config:\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  {:port 3000, :host ""0.0.0.0""}\r\nmetabase_app.1.swfh5438l6ix@docker-02    |\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:18,247 INFO metabase.core :: Starting Metabase version v0.49.7 (f0ff786) ...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:18,252 INFO metabase.core :: System info:\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  {""file.encoding"" ""UTF-8"",\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  ""java.runtime.name"" ""OpenJDK Runtime Environment"",\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  ""java.runtime.version"" ""11.0.22+7"",\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  ""java.vendor"" ""Eclipse Adoptium"",\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  ""java.vendor.url"" ""https://adoptium.net/"",\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  ""java.version"" ""11.0.22"",\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  ""java.vm.version"" ""11.0.22+7"",\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  ""os.name"" ""Linux"",\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  ""os.version"" ""5.4.0-177-generic"",\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  ""user.language"" ""en"",\r\nmetabase_app.1.swfh5438l6ix@docker-02    |  ""user.timezone"" ""GMT""}\r\nmetabase_app.1.swfh5438l6ix@docker-02    |\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:18,255 INFO metabase.plugins :: Loading plugins in /plugins...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,387 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,426 INFO driver.impl :: Registered driver :googleanalytics  🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,440 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,441 INFO driver.impl :: Registered driver :druid  🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,453 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,455 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,537 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,543 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,567 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,568 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,583 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,583 INFO driver.impl :: Registered driver :mongo  🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,633 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,634 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,639 INFO plugins.dependencies :: Plugin \'Metabase Presto Driver\' depends on plugin \'Presto Common Driver\'\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,641 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? false\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,642 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver""]\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,650 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,651 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,658 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Oracle Driver due to required dependencies. Metabase requires the Oracle JDBC driver in order to connect to Oracle databases, but we can\'t ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/oracle.html for more details.\r\nmetabase_app.1.swfh5438l6ix@docker-02    |\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,659 INFO plugins.dependencies :: Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? false\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,660 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver"" ""Metabase Oracle Driver""]\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,747 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,748 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,749 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,750 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,754 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,754 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,768 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :athena...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,769 INFO driver.impl :: Registered driver :athena (parents: [:sql-jdbc]) 🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,775 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-common...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,776 INFO driver.impl :: Registered abstract driver :presto-common  🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,777 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? true\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,781 DEBUG plugins.initialize :: Dependencies satisfied; these plugins will now be loaded: [""Metabase Presto Driver""]\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,783 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,783 INFO driver.impl :: Registered driver :presto (parents: [:presto-common]) 🚚\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,791 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can\'t ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.\r\nmetabase_app.1.swfh5438l6ix@docker-02    |\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,792 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,793 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver"" ""Metabase Oracle Driver""]\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,830 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,833 INFO db.setup :: Verifying postgres Database Connection ...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:20,087 INFO db.setup :: Successfully verified PostgreSQL 13.14 (Debian 13.14-1.pgdg120+2) application database connection. ✅\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:20,088 INFO db.setup :: Checking if a database downgrade is required...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:21,244 INFO db.setup :: Running Database Migrations...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:21,245 INFO db.setup :: Setting up Liquibase...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:21,499 INFO db.setup :: Liquibase is ready.\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:21,499 INFO db.liquibase :: Checking if Database has unrun migrations...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:22,277 INFO db.liquibase :: Database has unrun migrations. Checking if migraton lock is taken...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:24,335 WARN util.jvm :: auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:26,342 WARN util.jvm :: auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:28,349 WARN util.jvm :: auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:30,363 WARN util.jvm :: auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:32,368 WARN util.jvm :: auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:34,374 ERROR metabase.core :: Metabase Initialization FAILED\r\nmetabase_app.1.swfh5438l6ix@docker-02    | liquibase.exception.LockException: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803.invoke(liquibase.clj:218)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:176)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:183)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:183)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:183)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:183)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:183)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$wait_for_migration_lock_to_be_cleared.invokeStatic(liquibase.clj:212)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$wait_for_migration_lock_to_be_cleared.invoke(liquibase.clj:207)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$migrate_up_if_needed_BANG_.invokeStatic(liquibase.clj:294)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$migrate_up_if_needed_BANG_.invoke(liquibase.clj:287)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$migrate_BANG_$fn__51104.invoke(setup.clj:80)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$do_with_liquibase$f_STAR___48780.invoke(liquibase.clj:139)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:142)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:130)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:445)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:147)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:141)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132$fn__51133.invoke(setup.clj:165)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132.invoke(setup.clj:160)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:159)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:153)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db$setup_db_BANG_$fn__51152.invoke(db.clj:69)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db$setup_db_BANG_.invoke(db.clj:55)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:116)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$init_BANG__STAR_.invoke(core.clj:101)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$init_BANG_.invokeStatic(core.clj:159)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$init_BANG_.invoke(core.clj:154)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$start_normally.invokeStatic(core.clj:171)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$start_normally.invoke(core.clj:165)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$entrypoint.invokeStatic(core.clj:204)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$entrypoint.doInvoke(core.clj:198)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.Var.applyTo(Var.java:705)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at clojure.core$apply.invokeStatic(core.clj:667)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at clojure.core$apply.invoke(core.clj:662)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)\r\nmetabase_app.1.swfh5438l6ix@docker-02    |      at metabase.bootstrap.main(Unknown Source)\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:34,384 INFO metabase.core :: Metabase Shutting Down ...\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:34,385 INFO metabase.server :: Shutting Down Embedded Jetty Webserver\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:34,399 WARN db.liquibase :: ()\r\nmetabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:34,402 INFO metabase.core :: Metabase Shutdown COMPLETE\r\n\r\n```', 'created_at': datetime.datetime(2024, 4, 25, 9, 41, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2076912506, 'issue_id': 2261321062, 'author': 'qnkhuat', 'body': 'can you run `java -jar metabase.jar migrate release-locks` ? this will force release the lock.\r\n\r\nAlso wdym by removing it? did you remove the DBs that use it as well?', 'created_at': datetime.datetime(2024, 4, 25, 10, 57, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2076929335, 'issue_id': 2261321062, 'author': 'tdentwicklungsupport', 'body': '> Also wdym by removing it? did you remove the DBs that use it as well?\r\n\r\nI remove the database and then the plugin\r\n\r\nAfter removing the plugin and running `java -jar metabase.jar migrate release-locks` it now works running 0.49.7 :)\r\n\r\nThank you @qnkhuat', 'created_at': datetime.datetime(2024, 4, 25, 11, 7, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-24 13:40:08 UTC): ok this is weird as Metabase should not run any migration when moving between minor versions. Can you try running with MB_DB_AUTOMIGRATE=false?

tdentwicklungsupport (Issue Creator) on (2024-04-24 13:44:50 UTC): Hi @paoliniluis and thanks for the fast response

I have the feeling something corrupted the database/migrations :)

New Log with ne information and `MB_DB_AUTOMIGRATE=false`:

```
metabase_app.1.mp46w949fe9t@docker-02    | Metabase v0.49.7 (f0ff786)
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | Copyright © 2024 Metabase, Inc.
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | Metabase Enterprise Edition extensions are NOT PRESENT.
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:05,563 INFO metabase.core :: Starting Metabase in STANDALONE mode
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:05,610 INFO metabase.server :: Launching Embedded Jetty Webserver with config:
metabase_app.1.mp46w949fe9t@docker-02    |  {:port 3000, :host ""0.0.0.0""}
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:05,689 INFO metabase.core :: Starting Metabase version v0.49.7 (f0ff786) ...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:05,694 INFO metabase.core :: System info:
metabase_app.1.mp46w949fe9t@docker-02    |  {""file.encoding"" ""UTF-8"",
metabase_app.1.mp46w949fe9t@docker-02    |  ""java.runtime.name"" ""OpenJDK Runtime Environment"",
metabase_app.1.mp46w949fe9t@docker-02    |  ""java.runtime.version"" ""11.0.22+7"",
metabase_app.1.mp46w949fe9t@docker-02    |  ""java.vendor"" ""Eclipse Adoptium"",
metabase_app.1.mp46w949fe9t@docker-02    |  ""java.vendor.url"" ""https://adoptium.net/"",
metabase_app.1.mp46w949fe9t@docker-02    |  ""java.version"" ""11.0.22"",
metabase_app.1.mp46w949fe9t@docker-02    |  ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",
metabase_app.1.mp46w949fe9t@docker-02    |  ""java.vm.version"" ""11.0.22+7"",
metabase_app.1.mp46w949fe9t@docker-02    |  ""os.name"" ""Linux"",
metabase_app.1.mp46w949fe9t@docker-02    |  ""os.version"" ""5.4.0-177-generic"",
metabase_app.1.mp46w949fe9t@docker-02    |  ""user.language"" ""en"",
metabase_app.1.mp46w949fe9t@docker-02    |  ""user.timezone"" ""GMT""}
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:05,696 INFO metabase.plugins :: Loading plugins in /plugins...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:06,259 INFO util.files :: Extract file /modules/athena.metabase-driver.jar -> /plugins/athena.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:06,470 INFO util.files :: Extract file /modules/presto-jdbc.metabase-driver.jar -> /plugins/presto-jdbc.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:06,549 INFO util.files :: Extract file /modules/snowflake.metabase-driver.jar -> /plugins/snowflake.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,035 INFO util.files :: Extract file /modules/oracle.metabase-driver.jar -> /plugins/oracle.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,043 INFO util.files :: Extract file /modules/googleanalytics.metabase-driver.jar -> /plugins/googleanalytics.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,073 INFO util.files :: Extract file /modules/vertica.metabase-driver.jar -> /plugins/vertica.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,089 INFO util.files :: Extract file /modules/mongo.metabase-driver.jar -> /plugins/mongo.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,131 INFO util.files :: Extract file /modules/redshift.metabase-driver.jar -> /plugins/redshift.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,148 INFO util.files :: Extract file /modules/sqlite.metabase-driver.jar -> /plugins/sqlite.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,213 INFO util.files :: Extract file /modules/sqlserver.metabase-driver.jar -> /plugins/sqlserver.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,238 INFO util.files :: Extract file /modules/sparksql.metabase-driver.jar -> /plugins/sparksql.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,327 INFO util.files :: Extract file /modules/druid.metabase-driver.jar -> /plugins/druid.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,341 INFO util.files :: Extract file /modules/bigquery-cloud-sdk.metabase-driver.jar -> /plugins/bigquery-cloud-sdk.metabase-driver.jar
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,861 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,862 INFO driver.impl :: Registered driver :googleanalytics  🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,874 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,875 INFO driver.impl :: Registered driver :druid  🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,889 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:07,890 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,046 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,047 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,063 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,064 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,067 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :csv...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,071 INFO driver.impl :: Registered driver :csv (parents: [:sql-jdbc]) 🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,085 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,089 INFO driver.impl :: Registered driver :mongo  🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,143 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,143 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,149 INFO plugins.dependencies :: Plugin 'Metabase Presto Driver' depends on plugin 'Presto Common Driver'
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,151 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? false
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,152 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver""]
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,164 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,166 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,181 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Oracle Driver due to required dependencies. Metabase requires the Oracle JDBC driver in order to connect to Oracle databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/oracle.html for more details.
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,182 INFO plugins.dependencies :: Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? false
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,183 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver"" ""Metabase Oracle Driver""]
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,196 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,197 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,197 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,198 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,240 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,242 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,256 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :athena...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,257 INFO driver.impl :: Registered driver :athena (parents: [:sql-jdbc]) 🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,260 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-common...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,260 INFO driver.impl :: Registered abstract driver :presto-common  🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,262 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? true
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,263 DEBUG plugins.initialize :: Dependencies satisfied; these plugins will now be loaded: [""Metabase Presto Driver""]
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,264 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,265 INFO driver.impl :: Registered driver :presto (parents: [:presto-common]) 🚚
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,276 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,279 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,280 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Oracle Driver"" ""Metabase Vertica Driver""]
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,287 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,292 INFO db.setup :: Verifying postgres Database Connection ...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,565 INFO db.setup :: Successfully verified PostgreSQL 13.14 (Debian 13.14-1.pgdg120+2) application database connection. ✅
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:08,565 INFO db.setup :: Checking if a database downgrade is required...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:09,647 INFO db.setup :: Running Database Migrations...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:09,648 INFO db.setup :: Setting up Liquibase...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:10,078 INFO db.setup :: Liquibase is ready.
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,282 INFO db.setup :: Database Upgrade Required
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | NOTICE: Your database requires updates to work with this version of Metabase.
metabase_app.1.mp46w949fe9t@docker-02    | Please execute the following sql commands on your database before proceeding.
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | SET SEARCH_PATH TO public, ""$user"",""public"";
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | -- Lock Database
metabase_app.1.mp46w949fe9t@docker-02    | UPDATE public.databasechangeloglock SET LOCKED = TRUE, LOCKEDBY = '4d32bea1ab17 (10.0.11.12)', LOCKGRANTED = NOW() WHERE ID = 1 AND LOCKED = FALSE;
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | SET SEARCH_PATH TO public, ""$user"",""public"";
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | SET SEARCH_PATH TO public, ""$user"",""public"";
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | -- *********************************************************************
metabase_app.1.mp46w949fe9t@docker-02    | -- Update Database Script
metabase_app.1.mp46w949fe9t@docker-02    | -- *********************************************************************
metabase_app.1.mp46w949fe9t@docker-02    | -- Change Log: liquibase.yaml
metabase_app.1.mp46w949fe9t@docker-02    | -- Ran at: 4/24/24, 1:43 PM
metabase_app.1.mp46w949fe9t@docker-02    | -- Against: metabase@jdbc:postgresql://db:5432/metabase
metabase_app.1.mp46w949fe9t@docker-02    | -- Liquibase version: 4.25.1
metabase_app.1.mp46w949fe9t@docker-02    | -- *********************************************************************
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | -- Release Database Lock
metabase_app.1.mp46w949fe9t@docker-02    | SET SEARCH_PATH TO public, ""$user"",""public"";
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | UPDATE public.databasechangeloglock SET LOCKED = FALSE, LOCKEDBY = NULL, LOCKGRANTED = NULL WHERE ID = 1;
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | SET SEARCH_PATH TO public, ""$user"",""public"";
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | Once your database is updated try running the application again.
metabase_app.1.mp46w949fe9t@docker-02    |
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,345 ERROR metabase.core :: Metabase Initialization FAILED
metabase_app.1.mp46w949fe9t@docker-02    | java.lang.Exception: Database requires manual upgrade.
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$print_migrations_and_quit_if_needed_BANG_.invokeStatic(setup.clj:54)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$print_migrations_and_quit_if_needed_BANG_.invoke(setup.clj:39)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$migrate_BANG_$fn__51104.invoke(setup.clj:83)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.liquibase$do_with_liquibase$f_STAR___48780.invoke(liquibase.clj:139)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:142)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:130)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)
metabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:445)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:147)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:141)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132$fn__51133.invoke(setup.clj:165)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132.invoke(setup.clj:160)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:159)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:153)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db$setup_db_BANG_$fn__51152.invoke(db.clj:69)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.db$setup_db_BANG_.invoke(db.clj:55)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:116)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$init_BANG__STAR_.invoke(core.clj:101)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$init_BANG_.invokeStatic(core.clj:159)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$init_BANG_.invoke(core.clj:154)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$start_normally.invokeStatic(core.clj:171)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$start_normally.invoke(core.clj:165)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$entrypoint.invokeStatic(core.clj:204)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.core$entrypoint.doInvoke(core.clj:198)
metabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)
metabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)
metabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)
metabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.Var.applyTo(Var.java:705)
metabase_app.1.mp46w949fe9t@docker-02    |      at clojure.core$apply.invokeStatic(core.clj:667)
metabase_app.1.mp46w949fe9t@docker-02    |      at clojure.core$apply.invoke(core.clj:662)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
metabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)
metabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)
metabase_app.1.mp46w949fe9t@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)
metabase_app.1.mp46w949fe9t@docker-02    |      at metabase.bootstrap.main(Unknown Source)
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,362 INFO metabase.core :: Metabase Shutting Down ...
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,363 INFO metabase.server :: Shutting Down Embedded Jetty Webserver
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,373 WARN db.liquibase :: ()
metabase_app.1.mp46w949fe9t@docker-02    | 2024-04-24 13:43:11,374 INFO metabase.core :: Metabase Shutdown COMPLETE


```

qnkhuat on (2024-04-24 13:59:37 UTC): Hi @tdentwicklungsupport 

Could you run it again with this log config?

```
<?xml version=""1.0"" encoding=""UTF-8""?>
<Configuration>
  <Appenders>
    <Console name=""STDOUT"" target=""SYSTEM_OUT"" follow=""true"">
      <PatternLayout pattern=""%date %level %logger{2} :: %message%n%throwable"">
        <replace regex="":basic-auth \\[.*\\]"" replacement="":basic-auth [redacted]""/>
      </PatternLayout>
    </Console>

    <!-- This file appender is provided as an example -->
    <!--
    <RollingFile name=""FILE"" fileName=""${logfile.path}/metabase.log"" filePattern=""${logfile.path}/metabase.log.%i"">
      <Policies>
        <SizeBasedTriggeringPolicy size=""500 MB""/>
      </Policies>
      <DefaultRolloverStrategy max=""2""/>
      <PatternLayout pattern=""%d [%t] %-5p%c - %m%n"">
        <replace regex="":basic-auth \\[.*\\]"" replacement="":basic-auth [redacted]""/>
      </PatternLayout>
    </RollingFile>
    -->
  </Appenders>

  <Loggers>
    <Logger name=""metabase"" level=""INFO""/>
    <Logger name=""metabase-enterprise"" level=""INFO""/>
    <Logger name=""metabase.metabot"" level=""DEBUG""/>
    <Logger name=""metabase.plugins"" level=""DEBUG""/>
    <Logger name=""metabase.server.middleware"" level=""DEBUG""/>
    <Logger name=""metabase.query-processor.async"" level=""DEBUG""/>
    <Logger name=""com.mchange"" level=""ERROR""/>
    <Logger name=""org.quartz"" level=""TRACE""/>
    <Logger name=""toucan2"" level=""DEBUG""/>
    <Logger name=""liquibase"" level=""ERROR""/>
    <Logger name=""net.snowflake.client.jdbc.SnowflakeConnectString"" level=""ERROR""/>

    <Root level=""WARN"">
      <AppenderRef ref=""STDOUT""/>
    </Root>
  </Loggers>
</Configuration>
```

I want to get a more detailed log of what's going on.

Also, as a rule of thumb, always back up your db before migrating.

qnkhuat on (2024-04-24 14:00:34 UTC): See [this](https://www.metabase.com/docs/latest/configuring-metabase/log-configuration#using-log4j-2-with-docker) for how to run metabase with a custom log file

tdentwicklungsupport (Issue Creator) on (2024-04-24 14:18:24 UTC): @qnkhuat see below (i guess it did work adding the custom logging)

```
metabase_app.1.dgnuznxn8lwy@docker-02    | Metabase v0.49.7 (f0ff786)
metabase_app.1.dgnuznxn8lwy@docker-02    |
metabase_app.1.dgnuznxn8lwy@docker-02    | Copyright © 2024 Metabase, Inc.
metabase_app.1.dgnuznxn8lwy@docker-02    |
metabase_app.1.dgnuznxn8lwy@docker-02    | Metabase Enterprise Edition extensions are NOT PRESENT.
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:38,020 INFO metabase.core :: Starting Metabase in STANDALONE mode
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:38,075 INFO metabase.server :: Launching Embedded Jetty Webserver with config:
metabase_app.1.dgnuznxn8lwy@docker-02    |  {:port 3000, :host ""0.0.0.0""}
metabase_app.1.dgnuznxn8lwy@docker-02    |
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:38,164 INFO metabase.core :: Starting Metabase version v0.49.7 (f0ff786) ...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:38,186 INFO metabase.core :: System info:
metabase_app.1.dgnuznxn8lwy@docker-02    |  {""file.encoding"" ""UTF-8"",
metabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.runtime.name"" ""OpenJDK Runtime Environment"",
metabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.runtime.version"" ""11.0.22+7"",
metabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.vendor"" ""Eclipse Adoptium"",
metabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.vendor.url"" ""https://adoptium.net/"",
metabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.version"" ""11.0.22"",
metabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",
metabase_app.1.dgnuznxn8lwy@docker-02    |  ""java.vm.version"" ""11.0.22+7"",
metabase_app.1.dgnuznxn8lwy@docker-02    |  ""os.name"" ""Linux"",
metabase_app.1.dgnuznxn8lwy@docker-02    |  ""os.version"" ""5.4.0-177-generic"",
metabase_app.1.dgnuznxn8lwy@docker-02    |  ""user.language"" ""en"",
metabase_app.1.dgnuznxn8lwy@docker-02    |  ""user.timezone"" ""GMT""}
metabase_app.1.dgnuznxn8lwy@docker-02    |
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:38,225 INFO metabase.plugins :: Loading plugins in /plugins...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,058 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,058 INFO driver.impl :: Registered driver :googleanalytics  🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,073 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,074 INFO driver.impl :: Registered driver :druid  🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,086 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,128 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,175 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,177 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,237 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,238 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,246 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :csv...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,247 INFO driver.impl :: Registered driver :csv (parents: [:sql-jdbc]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,261 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,262 INFO driver.impl :: Registered driver :mongo  🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,327 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,330 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,334 INFO plugins.dependencies :: Plugin 'Metabase Presto Driver' depends on plugin 'Presto Common Driver'
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,336 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? false
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,336 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver""]
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,456 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,458 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,467 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Oracle Driver due to required dependencies. Metabase requires the Oracle JDBC driver in order to connect to Oracle databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/oracle.html for more details.
metabase_app.1.dgnuznxn8lwy@docker-02    |
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,468 INFO plugins.dependencies :: Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? false
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,470 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver"" ""Metabase Oracle Driver""]
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,481 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,482 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,483 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,483 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,528 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,529 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,541 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :athena...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,543 INFO driver.impl :: Registered driver :athena (parents: [:sql-jdbc]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,549 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-common...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,555 INFO driver.impl :: Registered abstract driver :presto-common  🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,558 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? true
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,561 DEBUG plugins.initialize :: Dependencies satisfied; these plugins will now be loaded: [""Metabase Presto Driver""]
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,562 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,564 INFO driver.impl :: Registered driver :presto (parents: [:presto-common]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,582 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.
metabase_app.1.dgnuznxn8lwy@docker-02    |
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,585 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,587 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver"" ""Metabase Oracle Driver""]
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,633 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,637 INFO db.setup :: Verifying postgres Database Connection ...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,936 INFO db.setup :: Successfully verified PostgreSQL 13.14 (Debian 13.14-1.pgdg120+2) application database connection. ✅
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:39,937 INFO db.setup :: Checking if a database downgrade is required...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:41,034 INFO db.setup :: Running Database Migrations...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:41,035 INFO db.setup :: Setting up Liquibase...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:41,348 INFO db.setup :: Liquibase is ready.
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:41,348 INFO db.liquibase :: Checking if Database has unrun migrations...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:42,164 INFO db.liquibase :: Database has unrun migrations. Checking if migraton lock is taken...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:42,172 INFO db.liquibase :: No migration lock found.
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:42,653 INFO db.liquibase :: Running 1 migrations ...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,141 DEBUG toucan2.connection :: Resolve connection nil
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,144 DEBUG toucan2.connection :: Resolve connection org.postgresql.jdbc.PgConnection
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,147 DEBUG toucan2.connection :: do with transaction nil com.mchange.v2.c3p0.impl.NewProxyConnection
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,152 DEBUG toucan2.query :: Parse args for query type :toucan.query-type/select.instances (:model/Database)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,156 DEBUG toucan2.query :: Parsed => {:modelable :model/Database, :queryable {}}
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,158 DEBUG toucan2.model :: Resolved modelable :model/Database => model :model/Database
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,165 DEBUG toucan2.honeysql2 :: Building SELECT query for :model/Database with columns nil
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,171 DEBUG toucan2.honeysql2 :: => {:from [[:metabase_database]], :select [:*]}
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,172 DEBUG toucan2.query :: Apply kv-args nil
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,176 DEBUG toucan2.honeysql2 :: Compiling Honey SQL 2 with options {:dialect :metabase.db.setup/application-db, :quoted true, :quoted-snake false}
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,180 DEBUG toucan2.honeysql2 :: => [""SELECT * FROM \""metabase_database\""""]
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,230 DEBUG toucan2.connection :: Resolve connection nil
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,237 DEBUG toucan2.connection :: Resolve connection org.postgresql.jdbc.PgConnection
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,249 DEBUG jdbc.query :: Preparing JDBC query with next.jdbc options
metabase_app.1.dgnuznxn8lwy@docker-02    | {:concurrency :read-only,
metabase_app.1.dgnuznxn8lwy@docker-02    |  :cursors :close,
metabase_app.1.dgnuznxn8lwy@docker-02    |  :label-fn #<metabase.util$lower_case_en@52df2fd4>,
metabase_app.1.dgnuznxn8lwy@docker-02    |  :read-columns #<metabase.db.jdbc_protocols$read_columns@1a6d1426>,
metabase_app.1.dgnuznxn8lwy@docker-02    |  :result-type :forward-only}
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,254 DEBUG jdbc.query :: Query returned normal result set
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,256 DEBUG jdbc.result-set :: Reduce JDBC result set for model :model/Database with rf #<clojure.core$map$fn__5931$fn__5932@3805c478> and init []
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,262 DEBUG jdbc.result-set :: Getting modified column names with next.jdbc options
metabase_app.1.dgnuznxn8lwy@docker-02    | {:label-fn #<metabase.util$lower_case_en@52df2fd4>,
metabase_app.1.dgnuznxn8lwy@docker-02    |  :qualifier-fn #<clojure.core$memoize$fn__6946@253be96d>,
metabase_app.1.dgnuznxn8lwy@docker-02    |  :read-columns #<metabase.db.jdbc_protocols$read_columns@1a6d1426>,
metabase_app.1.dgnuznxn8lwy@docker-02    |  :concurrency :read-only,
metabase_app.1.dgnuznxn8lwy@docker-02    |  :cursors :close,
metabase_app.1.dgnuznxn8lwy@docker-02    |  ...}
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,276 DEBUG jdbc.result-set :: Column names: [:id :created_at :updated_at :name :description ...]
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,287 DEBUG jdbc.result-set :: Could not determine index of column name :start_of_week. Found: [:id :created_at :updated_at :name :description ...]
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,331 DEBUG jdbc.read :: Column 7 ""metabase_database.engine"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,336 DEBUG jdbc.read :: Fetching values in column 7 with (.getObject rs 7)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,340 INFO driver.impl :: Initializing driver :sql...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,341 INFO driver.impl :: Initializing driver :sql-jdbc...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,341 INFO driver.impl :: Initializing driver :sqlserver...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,342 INFO plugins.classloader :: Added URL file:/plugins/sqlserver.metabase-driver.jar to classpath
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:43,344 DEBUG plugins.init-steps :: Loading plugin namespace metabase.driver.sqlserver...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,030 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,276 DEBUG plugins.jdbc-proxy :: Registering JDBC proxy driver for com.microsoft.sqlserver.jdbc.SQLServerDriver...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,279 INFO metabase.util ::  ⮦ Load lazy loading driver :sqlserver took 934.9 ms
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,282 DEBUG jdbc.read :: Column 22 ""metabase_database.dbms_version"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,284 DEBUG jdbc.read :: Fetching values in column 22 with (.getObject rs 22)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,336 DEBUG jdbc.read :: Column 6 ""metabase_database.details"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,338 DEBUG jdbc.read :: Fetching values in column 6 with (.getObject rs 6)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,342 DEBUG jdbc.read :: Column 1 ""metabase_database.id"" is of JDBC type java.sql.Types/INTEGER, native type ""serial""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,345 DEBUG jdbc.read :: Fetching values in column 1 with (.getObject rs 1)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,346 DEBUG jdbc.read :: Column 2 ""metabase_database.created_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,349 DEBUG jdbc.read :: Fetching values in column 2 with (.getObject rs 2 java.time.OffsetDateTime)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,353 DEBUG jdbc.read :: Column 3 ""metabase_database.updated_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,353 DEBUG jdbc.read :: Fetching values in column 3 with (.getObject rs 3 java.time.OffsetDateTime)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,354 DEBUG jdbc.read :: Column 4 ""metabase_database.name"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,356 DEBUG jdbc.read :: Fetching values in column 4 with (.getObject rs 4)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,356 DEBUG jdbc.read :: Column 5 ""metabase_database.description"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,358 DEBUG jdbc.read :: Fetching values in column 5 with (.getObject rs 5)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,359 DEBUG jdbc.read :: Column 8 ""metabase_database.is_sample"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,361 DEBUG jdbc.read :: Fetching values in column 8 with (.getObject rs 8)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,362 DEBUG jdbc.read :: Column 9 ""metabase_database.is_full_sync"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,363 DEBUG jdbc.read :: Fetching values in column 9 with (.getObject rs 9)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,365 DEBUG jdbc.read :: Column 10 ""metabase_database.points_of_interest"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,366 DEBUG jdbc.read :: Fetching values in column 10 with (.getObject rs 10)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,368 DEBUG jdbc.read :: Column 11 ""metabase_database.caveats"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,368 DEBUG jdbc.read :: Fetching values in column 11 with (.getObject rs 11)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,369 DEBUG jdbc.read :: Column 12 ""metabase_database.metadata_sync_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,370 DEBUG jdbc.read :: Fetching values in column 12 with (.getObject rs 12)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,370 DEBUG jdbc.read :: Column 13 ""metabase_database.cache_field_values_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,371 DEBUG jdbc.read :: Fetching values in column 13 with (.getObject rs 13)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,372 DEBUG jdbc.read :: Column 14 ""metabase_database.timezone"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,374 DEBUG jdbc.read :: Fetching values in column 14 with (.getObject rs 14)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,375 DEBUG jdbc.read :: Column 15 ""metabase_database.is_on_demand"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,379 DEBUG jdbc.read :: Fetching values in column 15 with (.getObject rs 15)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,381 DEBUG jdbc.read :: Column 16 ""metabase_database.auto_run_queries"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,383 DEBUG jdbc.read :: Fetching values in column 16 with (.getObject rs 16)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,385 DEBUG jdbc.read :: Column 17 ""metabase_database.refingerprint"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,387 DEBUG jdbc.read :: Fetching values in column 17 with (.getObject rs 17)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,388 DEBUG jdbc.read :: Column 18 ""metabase_database.cache_ttl"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,389 DEBUG jdbc.read :: Fetching values in column 18 with (.getObject rs 18)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,426 DEBUG jdbc.read :: Column 19 ""metabase_database.initial_sync_status"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,428 DEBUG jdbc.read :: Fetching values in column 19 with (.getObject rs 19)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,429 DEBUG jdbc.read :: Column 20 ""metabase_database.creator_id"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,430 DEBUG jdbc.read :: Fetching values in column 20 with (.getObject rs 20)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,431 DEBUG jdbc.read :: Column 21 ""metabase_database.settings"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,431 DEBUG jdbc.read :: Fetching values in column 21 with (.getObject rs 21)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,432 DEBUG jdbc.read :: Column 23 ""metabase_database.is_audit"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,434 DEBUG jdbc.read :: Fetching values in column 23 with (.getObject rs 23)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,435 DEBUG jdbc.read :: Column 7 ""metabase_database.engine"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,436 DEBUG jdbc.read :: Fetching values in column 7 with (.getObject rs 7)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,437 DEBUG jdbc.read :: Column 22 ""metabase_database.dbms_version"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,438 DEBUG jdbc.read :: Fetching values in column 22 with (.getObject rs 22)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,439 DEBUG jdbc.read :: Column 6 ""metabase_database.details"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,441 DEBUG jdbc.read :: Fetching values in column 6 with (.getObject rs 6)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,442 DEBUG jdbc.read :: Column 1 ""metabase_database.id"" is of JDBC type java.sql.Types/INTEGER, native type ""serial""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,443 DEBUG jdbc.read :: Fetching values in column 1 with (.getObject rs 1)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,446 DEBUG jdbc.read :: Column 2 ""metabase_database.created_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,449 DEBUG jdbc.read :: Fetching values in column 2 with (.getObject rs 2 java.time.OffsetDateTime)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,450 DEBUG jdbc.read :: Column 3 ""metabase_database.updated_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,454 DEBUG jdbc.read :: Fetching values in column 3 with (.getObject rs 3 java.time.OffsetDateTime)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,455 DEBUG jdbc.read :: Column 4 ""metabase_database.name"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,457 DEBUG jdbc.read :: Fetching values in column 4 with (.getObject rs 4)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,458 DEBUG jdbc.read :: Column 5 ""metabase_database.description"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,458 DEBUG jdbc.read :: Fetching values in column 5 with (.getObject rs 5)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,459 DEBUG jdbc.read :: Column 8 ""metabase_database.is_sample"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,460 DEBUG jdbc.read :: Fetching values in column 8 with (.getObject rs 8)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,460 DEBUG jdbc.read :: Column 9 ""metabase_database.is_full_sync"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,461 DEBUG jdbc.read :: Fetching values in column 9 with (.getObject rs 9)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,462 DEBUG jdbc.read :: Column 10 ""metabase_database.points_of_interest"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,464 DEBUG jdbc.read :: Fetching values in column 10 with (.getObject rs 10)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,464 DEBUG jdbc.read :: Column 11 ""metabase_database.caveats"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,465 DEBUG jdbc.read :: Fetching values in column 11 with (.getObject rs 11)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,466 DEBUG jdbc.read :: Column 12 ""metabase_database.metadata_sync_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,466 DEBUG jdbc.read :: Fetching values in column 12 with (.getObject rs 12)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,467 DEBUG jdbc.read :: Column 13 ""metabase_database.cache_field_values_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,488 DEBUG jdbc.read :: Fetching values in column 13 with (.getObject rs 13)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,490 DEBUG jdbc.read :: Column 14 ""metabase_database.timezone"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,490 DEBUG jdbc.read :: Fetching values in column 14 with (.getObject rs 14)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,491 DEBUG jdbc.read :: Column 15 ""metabase_database.is_on_demand"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,492 DEBUG jdbc.read :: Fetching values in column 15 with (.getObject rs 15)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,493 DEBUG jdbc.read :: Column 16 ""metabase_database.auto_run_queries"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,494 DEBUG jdbc.read :: Fetching values in column 16 with (.getObject rs 16)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,494 DEBUG jdbc.read :: Column 17 ""metabase_database.refingerprint"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,495 DEBUG jdbc.read :: Fetching values in column 17 with (.getObject rs 17)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,496 DEBUG jdbc.read :: Column 18 ""metabase_database.cache_ttl"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,496 DEBUG jdbc.read :: Fetching values in column 18 with (.getObject rs 18)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,497 DEBUG jdbc.read :: Column 19 ""metabase_database.initial_sync_status"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,498 DEBUG jdbc.read :: Fetching values in column 19 with (.getObject rs 19)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,498 DEBUG jdbc.read :: Column 20 ""metabase_database.creator_id"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,499 DEBUG jdbc.read :: Fetching values in column 20 with (.getObject rs 20)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,499 DEBUG jdbc.read :: Column 21 ""metabase_database.settings"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,500 DEBUG jdbc.read :: Fetching values in column 21 with (.getObject rs 21)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,501 DEBUG jdbc.read :: Column 23 ""metabase_database.is_audit"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,526 DEBUG jdbc.read :: Fetching values in column 23 with (.getObject rs 23)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,528 DEBUG jdbc.read :: Column 7 ""metabase_database.engine"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,528 DEBUG jdbc.read :: Fetching values in column 7 with (.getObject rs 7)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,529 DEBUG jdbc.read :: Column 22 ""metabase_database.dbms_version"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,530 DEBUG jdbc.read :: Fetching values in column 22 with (.getObject rs 22)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,532 DEBUG jdbc.read :: Column 6 ""metabase_database.details"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,532 DEBUG jdbc.read :: Fetching values in column 6 with (.getObject rs 6)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,534 DEBUG jdbc.read :: Column 1 ""metabase_database.id"" is of JDBC type java.sql.Types/INTEGER, native type ""serial""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,534 DEBUG jdbc.read :: Fetching values in column 1 with (.getObject rs 1)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,535 DEBUG jdbc.read :: Column 2 ""metabase_database.created_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,536 DEBUG jdbc.read :: Fetching values in column 2 with (.getObject rs 2 java.time.OffsetDateTime)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,537 DEBUG jdbc.read :: Column 3 ""metabase_database.updated_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,537 DEBUG jdbc.read :: Fetching values in column 3 with (.getObject rs 3 java.time.OffsetDateTime)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,538 DEBUG jdbc.read :: Column 4 ""metabase_database.name"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,539 DEBUG jdbc.read :: Fetching values in column 4 with (.getObject rs 4)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,539 DEBUG jdbc.read :: Column 5 ""metabase_database.description"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,540 DEBUG jdbc.read :: Fetching values in column 5 with (.getObject rs 5)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,540 DEBUG jdbc.read :: Column 8 ""metabase_database.is_sample"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,541 DEBUG jdbc.read :: Fetching values in column 8 with (.getObject rs 8)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,542 DEBUG jdbc.read :: Column 9 ""metabase_database.is_full_sync"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,542 DEBUG jdbc.read :: Fetching values in column 9 with (.getObject rs 9)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,543 DEBUG jdbc.read :: Column 10 ""metabase_database.points_of_interest"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,544 DEBUG jdbc.read :: Fetching values in column 10 with (.getObject rs 10)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,544 DEBUG jdbc.read :: Column 11 ""metabase_database.caveats"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,545 DEBUG jdbc.read :: Fetching values in column 11 with (.getObject rs 11)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,545 DEBUG jdbc.read :: Column 12 ""metabase_database.metadata_sync_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,546 DEBUG jdbc.read :: Fetching values in column 12 with (.getObject rs 12)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,546 DEBUG jdbc.read :: Column 13 ""metabase_database.cache_field_values_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,547 DEBUG jdbc.read :: Fetching values in column 13 with (.getObject rs 13)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,548 DEBUG jdbc.read :: Column 14 ""metabase_database.timezone"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,548 DEBUG jdbc.read :: Fetching values in column 14 with (.getObject rs 14)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,549 DEBUG jdbc.read :: Column 15 ""metabase_database.is_on_demand"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,550 DEBUG jdbc.read :: Fetching values in column 15 with (.getObject rs 15)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,550 DEBUG jdbc.read :: Column 16 ""metabase_database.auto_run_queries"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,551 DEBUG jdbc.read :: Fetching values in column 16 with (.getObject rs 16)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,551 DEBUG jdbc.read :: Column 17 ""metabase_database.refingerprint"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,552 DEBUG jdbc.read :: Fetching values in column 17 with (.getObject rs 17)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,553 DEBUG jdbc.read :: Column 18 ""metabase_database.cache_ttl"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,553 DEBUG jdbc.read :: Fetching values in column 18 with (.getObject rs 18)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,554 DEBUG jdbc.read :: Column 19 ""metabase_database.initial_sync_status"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,554 DEBUG jdbc.read :: Fetching values in column 19 with (.getObject rs 19)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,555 DEBUG jdbc.read :: Column 20 ""metabase_database.creator_id"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,556 DEBUG jdbc.read :: Fetching values in column 20 with (.getObject rs 20)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,556 DEBUG jdbc.read :: Column 21 ""metabase_database.settings"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,557 DEBUG jdbc.read :: Fetching values in column 21 with (.getObject rs 21)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,557 DEBUG jdbc.read :: Column 23 ""metabase_database.is_audit"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,558 DEBUG jdbc.read :: Fetching values in column 23 with (.getObject rs 23)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,559 DEBUG jdbc.read :: Column 7 ""metabase_database.engine"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,560 DEBUG jdbc.read :: Fetching values in column 7 with (.getObject rs 7)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,560 DEBUG jdbc.read :: Column 22 ""metabase_database.dbms_version"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,561 DEBUG jdbc.read :: Fetching values in column 22 with (.getObject rs 22)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,562 DEBUG jdbc.read :: Column 6 ""metabase_database.details"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,563 DEBUG jdbc.read :: Fetching values in column 6 with (.getObject rs 6)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,564 DEBUG jdbc.read :: Column 1 ""metabase_database.id"" is of JDBC type java.sql.Types/INTEGER, native type ""serial""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,564 DEBUG jdbc.read :: Fetching values in column 1 with (.getObject rs 1)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,565 DEBUG jdbc.read :: Column 2 ""metabase_database.created_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,566 DEBUG jdbc.read :: Fetching values in column 2 with (.getObject rs 2 java.time.OffsetDateTime)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,566 DEBUG jdbc.read :: Column 3 ""metabase_database.updated_at"" is of JDBC type java.sql.Types/TIMESTAMP, native type ""timestamptz""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,567 DEBUG jdbc.read :: Fetching values in column 3 with (.getObject rs 3 java.time.OffsetDateTime)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,567 DEBUG jdbc.read :: Column 4 ""metabase_database.name"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,568 DEBUG jdbc.read :: Fetching values in column 4 with (.getObject rs 4)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,569 DEBUG jdbc.read :: Column 5 ""metabase_database.description"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,569 DEBUG jdbc.read :: Fetching values in column 5 with (.getObject rs 5)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,570 DEBUG jdbc.read :: Column 8 ""metabase_database.is_sample"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,571 DEBUG jdbc.read :: Fetching values in column 8 with (.getObject rs 8)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,572 DEBUG jdbc.read :: Column 9 ""metabase_database.is_full_sync"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,572 DEBUG jdbc.read :: Fetching values in column 9 with (.getObject rs 9)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,573 DEBUG jdbc.read :: Column 10 ""metabase_database.points_of_interest"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,574 DEBUG jdbc.read :: Fetching values in column 10 with (.getObject rs 10)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,574 DEBUG jdbc.read :: Column 11 ""metabase_database.caveats"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,575 DEBUG jdbc.read :: Fetching values in column 11 with (.getObject rs 11)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,575 DEBUG jdbc.read :: Column 12 ""metabase_database.metadata_sync_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,576 DEBUG jdbc.read :: Fetching values in column 12 with (.getObject rs 12)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,577 DEBUG jdbc.read :: Column 13 ""metabase_database.cache_field_values_schedule"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,577 DEBUG jdbc.read :: Fetching values in column 13 with (.getObject rs 13)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,578 DEBUG jdbc.read :: Column 14 ""metabase_database.timezone"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,579 DEBUG jdbc.read :: Fetching values in column 14 with (.getObject rs 14)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,579 DEBUG jdbc.read :: Column 15 ""metabase_database.is_on_demand"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,580 DEBUG jdbc.read :: Fetching values in column 15 with (.getObject rs 15)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,580 DEBUG jdbc.read :: Column 16 ""metabase_database.auto_run_queries"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,581 DEBUG jdbc.read :: Fetching values in column 16 with (.getObject rs 16)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,582 DEBUG jdbc.read :: Column 17 ""metabase_database.refingerprint"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,582 DEBUG jdbc.read :: Fetching values in column 17 with (.getObject rs 17)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,583 DEBUG jdbc.read :: Column 18 ""metabase_database.cache_ttl"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,584 DEBUG jdbc.read :: Fetching values in column 18 with (.getObject rs 18)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,584 DEBUG jdbc.read :: Column 19 ""metabase_database.initial_sync_status"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,585 DEBUG jdbc.read :: Fetching values in column 19 with (.getObject rs 19)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,585 DEBUG jdbc.read :: Column 20 ""metabase_database.creator_id"" is of JDBC type java.sql.Types/INTEGER, native type ""int4""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,586 DEBUG jdbc.read :: Fetching values in column 20 with (.getObject rs 20)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,587 DEBUG jdbc.read :: Column 21 ""metabase_database.settings"" is of JDBC type java.sql.Types/VARCHAR, native type ""text""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,587 DEBUG jdbc.read :: Fetching values in column 21 with (.getObject rs 21)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,588 DEBUG jdbc.read :: Column 23 ""metabase_database.is_audit"" is of JDBC type java.sql.Types/BIT, native type ""bool""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,588 DEBUG jdbc.read :: Fetching values in column 23 with (.getObject rs 23)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,589 DEBUG jdbc.read :: Column 7 ""metabase_database.engine"" is of JDBC type java.sql.Types/VARCHAR, native type ""varchar""
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,590 DEBUG jdbc.read :: Fetching values in column 7 with (.getObject rs 7)
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,591 INFO driver.impl :: Initializing driver :csv...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,592 INFO plugins.classloader :: Added URL file:/plugins/csv.metabase-driver.jar to classpath
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,592 DEBUG plugins.init-steps :: Loading plugin namespace metabase.driver.csv...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,631 ERROR liquibase.changelog :: ChangeSet migrations/001_update_migrations.yaml::v49.2024-04-09T10:00:03::qnkhuat encountered an exception.
metabase_app.1.dgnuznxn8lwy@docker-02    |
metabase_app.1.dgnuznxn8lwy@docker-02    | UPDATE SUMMARY
metabase_app.1.dgnuznxn8lwy@docker-02    | Run:                          1
metabase_app.1.dgnuznxn8lwy@docker-02    | Previously run:             268
metabase_app.1.dgnuznxn8lwy@docker-02    | Filtered out:                17
metabase_app.1.dgnuznxn8lwy@docker-02    | -------------------------------
metabase_app.1.dgnuznxn8lwy@docker-02    | Total change sets:          286
metabase_app.1.dgnuznxn8lwy@docker-02    |
metabase_app.1.dgnuznxn8lwy@docker-02    |
metabase_app.1.dgnuznxn8lwy@docker-02    | FILTERED CHANGE SETS SUMMARY
metabase_app.1.dgnuznxn8lwy@docker-02    | DBMS mismatch:               17
metabase_app.1.dgnuznxn8lwy@docker-02    |
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,668 ERROR metabase.core :: Metabase Initialization FAILED
metabase_app.1.dgnuznxn8lwy@docker-02    | liquibase.exception.CommandExecutionException: java.lang.ClassCastException: class java.lang.ExceptionInInitializerError cannot be cast to class java.lang.Exception (java.lang.ExceptionInInitializerError and java.lang.Exception are in module java.base of loader 'bootstrap')
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.command.CommandScope.execute(CommandScope.java:253)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Liquibase.lambda$update$0(Liquibase.java:245)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Scope.lambda$child$0(Scope.java:186)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Scope.child(Scope.java:195)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Scope.child(Scope.java:185)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Scope.child(Scope.java:164)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Liquibase.runInScope(Liquibase.java:1419)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Liquibase.update(Liquibase.java:234)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Liquibase.update(Liquibase.java:212)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.Liquibase.update(Liquibase.java:194)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.liquibase$migrate_up_if_needed_BANG_.invokeStatic(liquibase.clj:305)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.liquibase$migrate_up_if_needed_BANG_.invoke(liquibase.clj:287)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$migrate_BANG_$fn__51104.invoke(setup.clj:80)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.liquibase$do_with_liquibase$f_STAR___48780.invoke(liquibase.clj:139)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:142)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:130)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:445)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:147)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:141)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132$fn__51133.invoke(setup.clj:165)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132.invoke(setup.clj:160)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:159)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:153)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db$setup_db_BANG_$fn__51152.invoke(db.clj:69)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.db$setup_db_BANG_.invoke(db.clj:55)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:116)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$init_BANG__STAR_.invoke(core.clj:101)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$init_BANG_.invokeStatic(core.clj:159)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$init_BANG_.invoke(core.clj:154)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$start_normally.invokeStatic(core.clj:171)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$start_normally.invoke(core.clj:165)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$entrypoint.invokeStatic(core.clj:204)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.core$entrypoint.doInvoke(core.clj:198)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.Var.applyTo(Var.java:705)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.core$apply.invokeStatic(core.clj:667)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.core$apply.invoke(core.clj:662)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at metabase.bootstrap.main(Unknown Source)
metabase_app.1.dgnuznxn8lwy@docker-02    | Caused by: java.lang.ClassCastException: class java.lang.ExceptionInInitializerError cannot be cast to class java.lang.Exception (java.lang.ExceptionInInitializerError and java.lang.Exception are in module java.base of loader 'bootstrap')
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.command.CommandScope.logPrimaryExceptionToMdc(CommandScope.java:287)
metabase_app.1.dgnuznxn8lwy@docker-02    |      at liquibase.command.CommandScope.execute(CommandScope.java:245)
metabase_app.1.dgnuznxn8lwy@docker-02    |      ... 49 more
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,678 INFO metabase.core :: Metabase Shutting Down ...
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,679 INFO metabase.server :: Shutting Down Embedded Jetty Webserver
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,685 WARN db.liquibase :: ()
metabase_app.1.dgnuznxn8lwy@docker-02    | 2024-04-24 14:17:44,686 INFO metabase.core :: Metabase Shutdown COMPLETE
```

qnkhuat on (2024-04-25 09:16:00 UTC): hmm, the log is not really helpful.

Did you do anything custom with your instance?

Also I see in the list of DBs you have `csv`. what is that?

tdentwicklungsupport (Issue Creator) on (2024-04-25 09:41:59 UTC): Nothing i am aware of


This was a csv plugin - removed that now


Also i see another error when upgrading directl from .5 to .7:
` auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.`


```
metabase_app.1.swfh5438l6ix@docker-02    | Metabase v0.49.7 (f0ff786)
metabase_app.1.swfh5438l6ix@docker-02    |
metabase_app.1.swfh5438l6ix@docker-02    | Copyright © 2024 Metabase, Inc.
metabase_app.1.swfh5438l6ix@docker-02    |
metabase_app.1.swfh5438l6ix@docker-02    | Metabase Enterprise Edition extensions are NOT PRESENT.
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:18,085 INFO metabase.core :: Starting Metabase in STANDALONE mode
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:18,147 INFO metabase.server :: Launching Embedded Jetty Webserver with config:
metabase_app.1.swfh5438l6ix@docker-02    |  {:port 3000, :host ""0.0.0.0""}
metabase_app.1.swfh5438l6ix@docker-02    |
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:18,247 INFO metabase.core :: Starting Metabase version v0.49.7 (f0ff786) ...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:18,252 INFO metabase.core :: System info:
metabase_app.1.swfh5438l6ix@docker-02    |  {""file.encoding"" ""UTF-8"",
metabase_app.1.swfh5438l6ix@docker-02    |  ""java.runtime.name"" ""OpenJDK Runtime Environment"",
metabase_app.1.swfh5438l6ix@docker-02    |  ""java.runtime.version"" ""11.0.22+7"",
metabase_app.1.swfh5438l6ix@docker-02    |  ""java.vendor"" ""Eclipse Adoptium"",
metabase_app.1.swfh5438l6ix@docker-02    |  ""java.vendor.url"" ""https://adoptium.net/"",
metabase_app.1.swfh5438l6ix@docker-02    |  ""java.version"" ""11.0.22"",
metabase_app.1.swfh5438l6ix@docker-02    |  ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",
metabase_app.1.swfh5438l6ix@docker-02    |  ""java.vm.version"" ""11.0.22+7"",
metabase_app.1.swfh5438l6ix@docker-02    |  ""os.name"" ""Linux"",
metabase_app.1.swfh5438l6ix@docker-02    |  ""os.version"" ""5.4.0-177-generic"",
metabase_app.1.swfh5438l6ix@docker-02    |  ""user.language"" ""en"",
metabase_app.1.swfh5438l6ix@docker-02    |  ""user.timezone"" ""GMT""}
metabase_app.1.swfh5438l6ix@docker-02    |
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:18,255 INFO metabase.plugins :: Loading plugins in /plugins...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,387 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,426 INFO driver.impl :: Registered driver :googleanalytics  🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,440 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,441 INFO driver.impl :: Registered driver :druid  🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,453 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,455 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,537 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,543 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,567 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,568 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,583 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,583 INFO driver.impl :: Registered driver :mongo  🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,633 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,634 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,639 INFO plugins.dependencies :: Plugin 'Metabase Presto Driver' depends on plugin 'Presto Common Driver'
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,641 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? false
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,642 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver""]
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,650 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,651 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,658 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Oracle Driver due to required dependencies. Metabase requires the Oracle JDBC driver in order to connect to Oracle databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/oracle.html for more details.
metabase_app.1.swfh5438l6ix@docker-02    |
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,659 INFO plugins.dependencies :: Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? false
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,660 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver"" ""Metabase Oracle Driver""]
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,747 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,748 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,749 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,750 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,754 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,754 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,768 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :athena...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,769 INFO driver.impl :: Registered driver :athena (parents: [:sql-jdbc]) 🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,775 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-common...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,776 INFO driver.impl :: Registered abstract driver :presto-common  🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,777 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? true
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,781 DEBUG plugins.initialize :: Dependencies satisfied; these plugins will now be loaded: [""Metabase Presto Driver""]
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,783 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,783 INFO driver.impl :: Registered driver :presto (parents: [:presto-common]) 🚚
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,791 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.
metabase_app.1.swfh5438l6ix@docker-02    |
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,792 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,793 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver"" ""Metabase Oracle Driver""]
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,830 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:19,833 INFO db.setup :: Verifying postgres Database Connection ...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:20,087 INFO db.setup :: Successfully verified PostgreSQL 13.14 (Debian 13.14-1.pgdg120+2) application database connection. ✅
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:20,088 INFO db.setup :: Checking if a database downgrade is required...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:21,244 INFO db.setup :: Running Database Migrations...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:21,245 INFO db.setup :: Setting up Liquibase...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:21,499 INFO db.setup :: Liquibase is ready.
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:21,499 INFO db.liquibase :: Checking if Database has unrun migrations...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:22,277 INFO db.liquibase :: Database has unrun migrations. Checking if migraton lock is taken...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:24,335 WARN util.jvm :: auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:26,342 WARN util.jvm :: auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:28,349 WARN util.jvm :: auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:30,363 WARN util.jvm :: auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:32,368 WARN util.jvm :: auto-retry metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803@7ff31e4b: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:34,374 ERROR metabase.core :: Metabase Initialization FAILED
metabase_app.1.swfh5438l6ix@docker-02    | liquibase.exception.LockException: Database has migration lock; cannot run migrations. You can force-release these locks by running `java -jar metabase.jar migrate release-locks`.
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$wait_for_migration_lock_to_be_cleared$fn__48803.invoke(liquibase.clj:218)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:176)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:183)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:183)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:183)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:183)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invokeStatic(jvm.clj:183)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_auto_retries.invoke(jvm.clj:165)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$wait_for_migration_lock_to_be_cleared.invokeStatic(liquibase.clj:212)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$wait_for_migration_lock_to_be_cleared.invoke(liquibase.clj:207)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$migrate_up_if_needed_BANG_.invokeStatic(liquibase.clj:294)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$migrate_up_if_needed_BANG_.invoke(liquibase.clj:287)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$migrate_BANG_$fn__51104.invoke(setup.clj:80)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$do_with_liquibase$f_STAR___48780.invoke(liquibase.clj:139)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:142)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:130)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)
metabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:445)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:147)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:141)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132$fn__51133.invoke(setup.clj:165)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$setup_db_BANG_$fn__51132.invoke(setup.clj:160)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:159)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:153)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db$setup_db_BANG_$fn__51152.invoke(db.clj:69)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.db$setup_db_BANG_.invoke(db.clj:55)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:116)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$init_BANG__STAR_.invoke(core.clj:101)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$init_BANG_.invokeStatic(core.clj:159)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$init_BANG_.invoke(core.clj:154)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$start_normally.invokeStatic(core.clj:171)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$start_normally.invoke(core.clj:165)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$entrypoint.invokeStatic(core.clj:204)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.core$entrypoint.doInvoke(core.clj:198)
metabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)
metabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)
metabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)
metabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.Var.applyTo(Var.java:705)
metabase_app.1.swfh5438l6ix@docker-02    |      at clojure.core$apply.invokeStatic(core.clj:667)
metabase_app.1.swfh5438l6ix@docker-02    |      at clojure.core$apply.invoke(core.clj:662)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
metabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.RestFn.invoke(RestFn.java:397)
metabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.AFn.applyToHelper(AFn.java:152)
metabase_app.1.swfh5438l6ix@docker-02    |      at clojure.lang.RestFn.applyTo(RestFn.java:132)
metabase_app.1.swfh5438l6ix@docker-02    |      at metabase.bootstrap.main(Unknown Source)
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:34,384 INFO metabase.core :: Metabase Shutting Down ...
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:34,385 INFO metabase.server :: Shutting Down Embedded Jetty Webserver
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:34,399 WARN db.liquibase :: ()
metabase_app.1.swfh5438l6ix@docker-02    | 2024-04-25 09:39:34,402 INFO metabase.core :: Metabase Shutdown COMPLETE

```

qnkhuat on (2024-04-25 10:57:08 UTC): can you run `java -jar metabase.jar migrate release-locks` ? this will force release the lock.

Also wdym by removing it? did you remove the DBs that use it as well?

tdentwicklungsupport (Issue Creator) on (2024-04-25 11:07:00 UTC): I remove the database and then the plugin

After removing the plugin and running `java -jar metabase.jar migrate release-locks` it now works running 0.49.7 :)

Thank you @qnkhuat

"
2261208662,issue,closed,completed,Add an analytics event for extract column in the chill mode header,Add an [analytics event](https://www.notion.so/metabase/Part-of-column-is-extracted-via-column-header-button-6575d283efe542408781eb42cbaedc3d) for the extract column action in the chill mode header.,romeovs,2024-04-24 12:42:45+00:00,['romeovs'],2024-05-02 19:14:10+00:00,2024-05-02 19:14:10+00:00,https://github.com/metabase/metabase/issues/41773,"[('.Frontend', ''), ('.Team/Querying', '')]",[],
2261201930,issue,closed,completed,Add static examples for the different extract options (FE),"Add static examples for the different extraction options in the chill mode extraction.

### From
<img width=""231"" alt=""Screenshot 2024-04-24 at 14 41 48"" src=""https://github.com/metabase/metabase/assets/1250185/893b92e3-ab37-421c-849a-8d84ac296817"">

### To
<img width=""210"" alt=""Screenshot 2024-04-24 at 14 42 12"" src=""https://github.com/metabase/metabase/assets/1250185/3f977bc7-5fa1-45e0-b902-f47b3344140c"">
",romeovs,2024-04-24 12:39:23+00:00,['romeovs'],2024-04-26 13:26:59+00:00,2024-04-26 13:26:58+00:00,https://github.com/metabase/metabase/issues/41771,[],[],
2261201692,issue,closed,completed,[Epic] Extract column in chill mode follow-ups,"[product doc](https://www.notion.so/metabase/Extract-column-in-chill-mode-follow-ups-f6dd3184a3334544b844a61dd74d0b78)

## Implementation Plan


```[tasklist]
### Milestone 1
- [x] Add ""domain name and top level domain"" option (BE)
- [ ] https://github.com/metabase/metabase/issues/41771
- [ ] https://github.com/metabase/metabase/pull/41484
- [ ] https://github.com/metabase/metabase/pull/41540
- [ ] https://github.com/metabase/metabase/pull/41548
- [ ] https://github.com/metabase/metabase/issues/41773
- [ ] https://github.com/metabase/metabase/issues/42096
- [ ] https://github.com/metabase/metabase/issues/41350
```",romeovs,2024-04-24 12:39:16+00:00,['romeovs'],2024-05-03 11:41:57+00:00,2024-05-03 11:41:57+00:00,https://github.com/metabase/metabase/issues/41770,"[('.Frontend', ''), ('.Epic', 'Feature Implementation or Project'), ('.Team/Querying', '')]",[],
2260707414,issue,closed,completed,Add analytics events for combine shortcut in notebook editor,Add an analytics event for the [combine shortcut](https://www.notion.so/metabase/Extract-column-shortcut-is-used-in-the-notebook-editor-88d7f16b66ef49528eda6516036506cd).,romeovs,2024-04-24 08:24:37+00:00,['romeovs'],2024-04-30 12:03:44+00:00,2024-04-30 12:03:44+00:00,https://github.com/metabase/metabase/issues/41766,"[('.Frontend', ''), ('.Team/Querying', '')]",[],
2260646002,issue,closed,completed,Cannot find the new column in pick columns after alter schema and synced,"### Describe the bug

alter a table's schema to add a new column and sync schema manually in admin settings
we can see the new column when browse data  
![image](https://github.com/metabase/metabase/assets/8278560/3d170e0b-a8a4-46f1-912d-00b06caccbd7)
  
but pick columns in editor cannot see the new column  
![image](https://github.com/metabase/metabase/assets/8278560/d6d073e2-f457-4ba3-8733-7f5b0f1665d4)


although we can tell users to refresh or logout, but it's strange, especially users can see the new column in data but cannot pick the column in editor.

### To Reproduce

1. [DB] add a new column in a table which already synced in metabase
2. [Metabase] sync schema in admin settings
3. [Metabase] New a question and choose the table from raw data
4. [Metabase] click pick columns then can reporduce the issue


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Metabase version: v0.49.4
- Database: PostgreSQL
```


### Severity

blocking users

### Additional context

_No response_",jodotlearn,2024-04-24 07:58:22+00:00,['romeovs'],2024-10-08 17:05:41+00:00,2024-07-01 08:37:48+00:00,https://github.com/metabase/metabase/issues/41765,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('Querying/Cache', ''), ('.Team/Querying', '')]","[{'comment_id': 2074740448, 'issue_id': 2260646002, 'author': 'paoliniluis', 'body': 'Can you do a full browser refresh on the GUI editor?', 'created_at': datetime.datetime(2024, 4, 24, 11, 37, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2076081842, 'issue_id': 2260646002, 'author': 'jodotlearn', 'body': '> Can you do a full browser refresh on the GUI editor?\r\n\r\nworks fine if do full browser refresh on the GUI editor.', 'created_at': datetime.datetime(2024, 4, 25, 0, 18, 15, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-24 11:37:28 UTC): Can you do a full browser refresh on the GUI editor?

jodotlearn (Issue Creator) on (2024-04-25 00:18:15 UTC): works fine if do full browser refresh on the GUI editor.

"
2260205092,issue,closed,completed,[Epic] Improve pulse performance and debuggability,"**Links**
- eng doc: https://www.notion.so/metabase/Improve-Pulse-performance-and-debuggability-caa4921e7376452f8c721d30eb3a7bb9?pvs=4
- GH issues:
- https://github.com/metabase/metabase/issues/14613
- https://github.com/metabase/metabase/issues/38800
- https://github.com/metabase/metabase/issues/6648
- https://github.com/metabase/metabase/issues/3846
- https://github.com/metabase/metabase/issues/12084
- https://github.com/metabase/metabase/issues/8416
- https://github.com/metabase/metabase/issues/9436

```[tasklist]
### Milestone 1: Parallelizing send pulses (BE only)
- [ ] https://github.com/metabase/metabase/pull/41772
- [ ] https://github.com/metabase/metabase/pull/42331
```

```[tasklist]
### Milestone 2: Better granularity for pulse (postponed)
- [ ] BE: rework pulse_channel schema to accept a cron_schedule
- [ ] BE: rework API endpoints to accept cron_schedule
- [ ] FE: Update UI to now send a cron_schedule have better granularity config
```

```[tasklist]
### Milestone 3: Improve taskhistory
- [ ] https://github.com/metabase/metabase/pull/42372
```

```[tasklist]
### Milestone 4: Clean up SendPulse task when archiving dashboard
- [ ] https://github.com/metabase/metabase/pull/42558
```

",qnkhuat,2024-04-24 03:11:11+00:00,['qnkhuat'],2024-05-30 02:50:31+00:00,2024-05-17 18:55:57+00:00,https://github.com/metabase/metabase/issues/41764,"[('.Epic', 'Feature Implementation or Project'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2111478075, 'issue_id': 2260205092, 'author': 'qnkhuat', 'body': ""We've decided to postpone milestone 2 as we might refactor pulse soon."", 'created_at': datetime.datetime(2024, 5, 15, 2, 44, 55, tzinfo=datetime.timezone.utc)}]","qnkhuat (Issue Creator) on (2024-05-15 02:44:55 UTC): We've decided to postpone milestone 2 as we might refactor pulse soon.

"
2259794922,issue,closed,completed,Populate `collection_id` on cards and dashboards returned by `/api/collection/:id/items`,"[discussion](https://metaboat.slack.com/archives/C064EB1UE5P/p1713905038164669)

On the frontend, we were previously inserting `collection_id` on each item after the request returned based on the request parameter. I think we want to move away from magical patterns like this and, where possible, deal with data as it comes to us from the api so it's easier to understand and work with. 

To this end, can we get the `collection_id` populated for all cards and dashboards returned from `/api/collection/:id/items`?
",iethree,2024-04-23 21:25:18+00:00,['johnswanson'],2024-04-24 21:59:02+00:00,2024-04-24 21:59:02+00:00,https://github.com/metabase/metabase/issues/41760,"[('Organization/Collections', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2259770565,issue,closed,completed,[dc.js migration] Fix Linting Errors,- Epic: https://github.com/metabase/metabase/issues/36880,JesseSDevaney,2024-04-23 21:09:19+00:00,['JesseSDevaney'],2024-04-25 16:55:45+00:00,2024-04-25 16:55:45+00:00,https://github.com/metabase/metabase/issues/41758,"[('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2259688460,issue,open,,[BE] [QP] [Bug] Collecting field usages from preprocessed query fails,"### Describe the bug

Running a query with a filter like `[:= [:field 1] ""a"" ""b""]` produces an error like:
```
2024-04-23 19:46:48,169 ERROR middleware.process-userland-query :: Error saving query execution info
clojure.lang.ExceptionInfo: Invalid input: [""Valid column metadata, got: [:= {:lib/uuid \""8e27edc6-189e-4309-9303-f492bd083607\""} [:field {:base-type :type/Text, :source-field 40, :join-alias \""PRODUCTS__via__PRODUCT_ID\"", :lib/uuid \""3210e895-97c9-446f-95f3-ba552e9a74e2\""} 58] [:value {:effective_type :type/Text, :name \""CATEGORY\"", :base-type :type/Text, :semantic-type :type/Category, :database-type \""CHARACTER VARYING\"", :effective-type :type/Text, :lib/uuid \""889b1fbc-9eac-4101-b222-b36c5d08f6bf\""} \""Gadget\""]]""
```

### To Reproduce

Run the query below and observe the server logs.
<img width=""542"" alt=""image"" src=""https://github.com/metabase/metabase/assets/103100869/94a20dfd-f14b-4273-ad21-0f9ac8f90609"">


### Expected behavior

Should be able to extract the field. Either `metabase.lib.filter/filter-parts` has to be generalized to be able to deal with preprocessed (de-sugared) queries, or `metabase.query-processor.middleware.process-userland-query/process-userland-query-middleware` should call `field-usage/pmbql->field-usages` with the original query, not the preprocessed one.

### Logs

```
2024-04-23 19:46:48,169 ERROR middleware.process-userland-query :: Error saving query execution info
clojure.lang.ExceptionInfo: Invalid input: [""Valid column metadata, got: [:= {:lib/uuid \""8e27edc6-189e-4309-9303-f492bd083607\""} [:field {:base-type :type/Text, :source-field 40, :join-alias \""PRODUCTS__via__PRODUCT_ID\"", :lib/uuid \""3210e895-97c9-446f-95f3-ba552e9a74e2\""} 58] [:value {:effective_type :type/Text, :name \""CATEGORY\"", :base-type :type/Text, :semantic-type :type/Category, :database-type \""CHARACTER VARYING\"", :effective-type :type/Text, :lib/uuid \""889b1fbc-9eac-4101-b222-b36c5d08f6bf\""} \""Gadget\""]]"" ""Valid reference, must be one of these clauses: :aggregation, :expression, :field, :metric, :segment, got: [:= {:lib/uuid \""8e27edc6-189e-4309-9303-f492bd083607\""} [:field {:base-type :type/Text, :source-field 40, :join-alias \""PRODUCTS__via__PRODUCT_ID\"", :lib/uuid \""3210e895-97c9-446f-95f3-ba552e9a74e2\""} 58] [:value {:effective_type :type/Text, :name \""CATEGORY\"", :base-type :type/Text, :semantic-type :type/Category, :database-type \""CHARACTER VARYING\"", :effective-type :type/Text, :lib/uuid \""889b1fbc-9eac-4101-b222-b36c5d08f6bf\""} \""Gadget\""]]""] {:type :metabase.util.malli.fn/invalid-input, :error {:schema [:or :metabase.lib.schema.metadata/column :metabase.lib.schema.ref/ref], :value [:= {:lib/uuid ""8e27edc6-189e-4309-9303-f492bd083607""} [:field {:base-type :type/Text, :source-field 40, :join-alias ""PRODUCTS__via__PRODUCT_ID"", :lib/uuid ""3210e895-97c9-446f-95f3-ba552e9a74e2""} 58] [:value {:effective_type :type/Text, :name ""CATEGORY"", :base-type :type/Text, :semantic-type :type/Category, :database-type ""CHARACTER VARYING"", :effective-type :type/Text, :lib/uuid ""889b1fbc-9eac-4101-b222-b36c5d08f6bf""} ""Gadget""]], :errors ({:path [0 0], :in [], :schema [:map {:error/message ""Valid column metadata""} [:lib/type [:= :metadata/column]] [:name :string] [:base-type :metabase.lib.schema.common/base-type] [:id {:optional true} :metabase.lib.schema.id/field] [:display-name {:optional true} [:maybe :string]] [:effective-type {:optional true} [:maybe :metabase.lib.schema.common/base-type]] [:fk-field-id {:optional true} [:maybe :metabase.lib.schema.id/field]] [:fk-target-field-id {:optional true} [:maybe :metabase.lib.schema.id/field]] [:source-alias {:optional true} [:maybe :metabase.lib.schema.common/non-blank-string]] [:lib/expression-name {:optional true} [:maybe :metabase.lib.schema.common/non-blank-string]] [:lib/source {:optional true} [:ref :metabase.lib.schema.metadata/column-source]] [:lib/card-id {:optional true} [:maybe :metabase.lib.schema.id/card]] [:lib/source-column-alias {:optional true} [:maybe :metabase.lib.schema.common/non-blank-string]] [:lib/desired-column-alias {:optional true} [:maybe [:string {:min 1, :max 60}]]] [:selected? {:optional true} :boolean] [:has-field-values {:optional true} [:maybe [:ref :metabase.lib.schema.metadata/column.has-field-values]]] [:lib/external-remap {:optional true} [:maybe [:ref :metabase.lib.schema.metadata/column.remapping.external]]] [:lib/internal-remap {:optional true} [:maybe [:ref :metabase.lib.schema.metadata/column.remapping.internal]]]], :value [:= {:lib/uuid ""8e27edc6-189e-4309-9303-f492bd083607""} [:field {:base-type :type/Text, :source-field 40, :join-alias ""PRODUCTS__via__PRODUCT_ID"", :lib/uuid ""3210e895-97c9-446f-95f3-ba552e9a74e2""} 58] [:value {:effective_type :type/Text, :name ""CATEGORY"", :base-type :type/Text, :semantic-type :type/Category, :database-type ""CHARACTER VARYING"", :effective-type :type/Text, :lib/uuid ""889b1fbc-9eac-4101-b222-b36c5d08f6bf""} ""Gadget""]], :type :malli.core/invalid-type} {:path [1 0 1], :in [], :schema [:fn {:error/fn #function[metabase.lib.schema.ref/eval59566/fn--59567]} #function[metabase.lib.schema.ref/eval59566/fn--59570]], :value [:= {:lib/uuid ""8e27edc6-189e-4309-9303-f492bd083607""} [:field {:base-type :type/Text, :source-field 40, :join-alias ""PRODUCTS__via__PRODUCT_ID"", :lib/uuid ""3210e895-97c9-446f-95f3-ba552e9a74e2""} 58] [:value {:effective_type :type/Text, :name ""CATEGORY"", :base-type :type/Text, :semantic-type :type/Category, :database-type ""CHARACTER VARYING"", :effective-type :type/Text, :lib/uuid ""889b1fbc-9eac-4101-b222-b36c5d08f6bf""} ""Gadget""]]})}, :humanized [""Valid column metadata, got: [:= {:lib/uuid \""8e27edc6-189e-4309-9303-f492bd083607\""} [:field {:base-type :type/Text, :source-field 40, :join-alias \""PRODUCTS__via__PRODUCT_ID\"", :lib/uuid \""3210e895-97c9-446f-95f3-ba552e9a74e2\""} 58] [:value {:effective_type :type/Text, :name \""CATEGORY\"", :base-type :type/Text, :semantic-type :type/Category, :database-type \""CHARACTER VARYING\"", :effective-type :type/Text, :lib/uuid \""889b1fbc-9eac-4101-b222-b36c5d08f6bf\""} \""Gadget\""]]"" ""Valid reference, must be one of these clauses: :aggregation, :expression, :field, :metric, :segment, got: [:= {:lib/uuid \""8e27edc6-189e-4309-9303-f492bd083607\""} [:field {:base-type :type/Text, :source-field 40, :join-alias \""PRODUCTS__via__PRODUCT_ID\"", :lib/uuid \""3210e895-97c9-446f-95f3-ba552e9a74e2\""} 58] [:value {:effective_type :type/Text, :name \""CATEGORY\"", :base-type :type/Text, :semantic-type :type/Category, :database-type \""CHARACTER VARYING\"", :effective-type :type/Text, :lib/uuid \""889b1fbc-9eac-4101-b222-b36c5d08f6bf\""} \""Gadget\""]]""], :schema [:or :metabase.lib.schema.metadata/column :metabase.lib.schema.ref/ref], :value [:= {:lib/uuid ""8e27edc6-189e-4309-9303-f492bd083607""} [:field {:base-type :type/Text, :source-field 40, :join-alias ""PRODUCTS__via__PRODUCT_ID"", :lib/uuid ""3210e895-97c9-446f-95f3-ba552e9a74e2""} 58] [:value {:effective_type :type/Text, :name ""CATEGORY"", :base-type :type/Text, :semantic-type :type/Category, :database-type ""CHARACTER VARYING"", :effective-type :type/Text, :lib/uuid ""889b1fbc-9eac-4101-b222-b36c5d08f6bf""} ""Gadget""]], :fn-name find-matching-column}
	at metabase.lib.equality$fn__63590$fn__63618.invoke(equality.cljc:249)
	at metabase.lib.equality$fn__63590$_AMPERSAND_f__63593.invoke(equality.cljc:296)
	at metabase.lib.equality$fn__63590$fn__63618.invoke(equality.cljc:249)
	at metabase.lib.filter$fn__177046$_AMPERSAND_f__177047.invoke(filter.cljc:525)
	at metabase.lib.filter$fn__177046$fn__177056.invoke(filter.cljc:513)
	at metabase.models.field_usage$filter__GT_field_usage.invokeStatic(field_usage.clj:29)
	at metabase.models.field_usage$filter__GT_field_usage.invoke(field_usage.clj:27)
	at metabase.models.field_usage$stage__GT_field_usages$fn__177802.invoke(field_usage.clj:76)
	at clojure.core$keep$fn__8649.invoke(core.clj:7406)
	at clojure.lang.LazySeq.sval(LazySeq.java:42)
	at clojure.lang.LazySeq.seq(LazySeq.java:51)
	at clojure.lang.RT.seq(RT.java:535)
	at clojure.core$seq__5467.invokeStatic(core.clj:139)
	at clojure.core$concat$fn__5558.invoke(core.clj:727)
	at clojure.lang.LazySeq.sval(LazySeq.java:42)
	at clojure.lang.LazySeq.seq(LazySeq.java:51)
	at clojure.lang.RT.seq(RT.java:535)
	at clojure.core$seq__5467.invokeStatic(core.clj:139)
	at clojure.core$concat$cat__5560$fn__5561.invoke(core.clj:736)
	at clojure.lang.LazySeq.sval(LazySeq.java:42)
	at clojure.lang.LazySeq.seq(LazySeq.java:58)
	at clojure.lang.RT.seq(RT.java:535)
	at clojure.core$seq__5467.invokeStatic(core.clj:139)
	at clojure.core$seq__5467.invoke(core.clj:139)
	at metabase.query_processor.middleware.process_userland_query$save_execution_metadata_BANG__STAR_.invokeStatic(process_userland_query.clj:55)
	at metabase.query_processor.middleware.process_userland_query$save_execution_metadata_BANG__STAR_.invoke(process_userland_query.clj:47)
	at metabase.query_processor.middleware.process_userland_query$save_execution_metadata_BANG_$f__177848.invoke(process_userland_query.clj:72)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
```

### Information about your Metabase installation

```JSON
- Metabase commit d1a7cec69c10a84d19d403a37d1736cbb17bb582
```


### Severity

It prevents getting an accurate view of field usages.

### Additional context

_No response_",metamben,2024-04-23 20:10:08+00:00,[],2025-02-04 20:27:14+00:00,,https://github.com/metabase/metabase/issues/41754,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/MBQL', ''), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2073938549, 'issue_id': 2259688460, 'author': 'qnkhuat', 'body': ""`field-usage/pmbql->field-usages` expects a query with all sources and joins resolved. If we want to rework it to accept the original query then we'll need to call resolve cards ourselves, which means we'll need to use the `resolve-source-cards` middleware. \r\n\r\nThis is actually my original implement, but @bshepherdson pointed out that's mis-using QP middleware and I agree with that.\r\n\r\nSo I'd like to ask you to consider the other approach of making `lib/filter-parts` to work with the preprocessed filter"", 'created_at': datetime.datetime(2024, 4, 24, 3, 20, 39, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-04-24 03:20:39 UTC): `field-usage/pmbql->field-usages` expects a query with all sources and joins resolved. If we want to rework it to accept the original query then we'll need to call resolve cards ourselves, which means we'll need to use the `resolve-source-cards` middleware. 

This is actually my original implement, but @bshepherdson pointed out that's mis-using QP middleware and I agree with that.

So I'd like to ask you to consider the other approach of making `lib/filter-parts` to work with the preprocessed filter

"
2259601174,issue,open,,Additional Customization Options for Time Series Axis,"**Is your feature request related to a problem? Please describe.**
It would be nice to have more control over how date units are displayed on the time series. In some cases this could have a high impact on legibility of the chart. For example:

You have a bar chart visualization with a count() grouped by month. There is no data for a few months (a gap in results). If you use a time series there is a space where there are no results in the visualization but it's not really clear which months. For sets like this having explicit labels on every time unit would be valuable.

**Describe the solution you'd like**
It would be nice to be able to set the frequency of the labels on the axis. The idea is you could have a label for every X intervals:

- Every 1 interval would label every bar on the axis
- Every 2 intervals would be ""every other month"" on a result set grouped by month or ""every other week"" on a result set grouped by week

**Describe alternatives you've considered**
You can force each bar to be labelled if you use an ordinal scale for the axis but this introduces a different problem. Visually there is no longer a gap for the missing months. So unless you are reading the label very closely you're not going to visually understand that there are periods of time without results.

",ixipixi,2024-04-23 19:17:14+00:00,[],2024-05-17 14:42:50+00:00,,https://github.com/metabase/metabase/issues/41747,"[('Visualization/', ''), ('Type:New Feature', ''), ('Visualization/Chart Settings', '')]",[],
2259428694,issue,closed,not_planned,[BE] Metric display name includes breakouts,https://www.notion.so/metabase/metrics-v2-branch-feedback-6d60781742b44a1e96eaa80c72732da0?pvs=4#7d601eafbc6848eba0b55482d15c267e,snoe,2024-04-23 17:46:03+00:00,[],2024-05-06 12:37:44+00:00,2024-05-06 12:37:44+00:00,https://github.com/metabase/metabase/issues/41745,[],[],
2259427006,issue,closed,completed,[FE] Metric not appearing in collections,https://www.notion.so/metabase/metrics-v2-branch-feedback-6d60781742b44a1e96eaa80c72732da0?pvs=4#3c40b222cac44bd98e196c1c6ff90272,snoe,2024-04-23 17:45:12+00:00,['ranquild'],2024-04-30 13:55:53+00:00,2024-04-30 13:55:53+00:00,https://github.com/metabase/metabase/issues/41744,[],[],
2259426495,issue,closed,completed,[FE] Collection not showing in search result,https://www.notion.so/metabase/metrics-v2-branch-feedback-6d60781742b44a1e96eaa80c72732da0?pvs=4#55c79cf47a3a48e0a2563fa85c55503a,snoe,2024-04-23 17:44:58+00:00,['ranquild'],2024-04-30 13:56:14+00:00,2024-04-30 13:56:14+00:00,https://github.com/metabase/metabase/issues/41743,[],[],
2259089655,issue,closed,completed,Create demo API and dataset for products and orders in the embedding demo,,heypoom,2024-04-23 14:49:32+00:00,['heypoom'],2024-04-24 16:14:13+00:00,2024-04-24 16:14:13+00:00,https://github.com/metabase/metabase/issues/41732,[],[],
2259077736,issue,open,,Query requests gets duplicated and cancelled with Error in Static Embedding,"### Describe the bug

When showing a dashboard in Static Embedding that has any filter linked to a question will be run twice. First run will get cancelled with broken pipe error and the second time it runs without issues.

The query and data still loads it's more of a logging kind of issue cause it generates redundant logs. 

### To Reproduce

1. Go to New -> Question -> Sample Database -> Orders -> Count -> Save -> Add to Dashboard -> Link Date filter with Created At column

<img width=""1328"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/1f8510a5-4ba2-4c36-a7a8-a32642b0f045"">

2. Embed the dashboard and make the filter editable:

<img width=""1169"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/d50a5911-5617-4ba2-bbf4-c8d435a1b478"">

3. Open Network Developer Tools and access the embedded URL ... You will see the cancelled request

<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/80cd6994-6b81-4eb0-9eb3-29efb5b4927f"">

4. This can also be seen in the Query Log:

<img width=""1507"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/41e41c13-e48f-46d8-8dd4-7005ae98223b"">

Note: Same thing happens on preview:

<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/a6afede8-4a76-439d-a269-541316250c45"">

And it gets worse when there are a lot of cards since each card gets cancelled:

<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/b8f487bc-3eba-4d5a-a51c-b8738589223c"">


### Expected behavior

Queries don't get cancelled and just run

### Logs

```
[15cf1315-f7d6-4550-a784-46c53c0c78ed] 2024-04-23T14:45:57+02:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: Closed
{:database_id 4,
 :started_at #t ""2024-04-23T12:45:50.045671Z[GMT]"",
 :action_id nil,
 :json_query
 {:constraints {:max-results 10000, :max-results-bare-rows 2000},
  :type :query,
  :middleware {:js-int-to-string? true, :ignore-cached-results? false},
  :viz-settings {},
  :database 4,
  :query {:source-table 121, :aggregation [[:count]]},
  :parameters
  [{:type :date/all-options,
    :slug ""date_filter"",
    :id ""3ef4a7f"",
    :target [:dimension [:field 1076 {:base-type :type/DateTime}]]}],
  :async? true,
  :cache-ttl nil},
 :native {:query ""SELECT COUNT(*) AS \""count\"" FROM \""PUBLIC\"".\""ORDERS\"""", :params nil},
 :status :failed,
 :class org.eclipse.jetty.io.EofException,
 :stacktrace
 [""org.eclipse.jetty.server.HttpOutput.checkWritable(HttpOutput.java:750)""
  ""org.eclipse.jetty.server.HttpOutput.write(HttpOutput.java:780)""
  ""java.base/java.io.OutputStream.write(Unknown Source)""
  ""java.base/java.util.zip.GZIPOutputStream.writeHeader(Unknown Source)""
  ""java.base/java.util.zip.GZIPOutputStream.<init>(Unknown Source)""
  ""java.base/java.util.zip.GZIPOutputStream.<init>(Unknown Source)""
  ""--> async.streaming_response$output_stream_delay$fn__43773.invoke(streaming_response.clj:111)""
  ""async.streaming_response$delay_output_stream$fn__43782.invoke(streaming_response.clj:128)""
  ""async.streaming_response.proxy$java.io.OutputStream$ff19274a.write(Unknown Source)""
  ""query_processor.streaming.json$fn$reify__52442.finish_BANG_(json.clj:115)""
  ""query_processor.streaming$streaming_reducedf$fn__53218.invoke(streaming.clj:132)""
  ""api.public$public_reducedf$fn__96428.invoke(public.clj:134)""
  ""query_processor.context$reducedf.invokeStatic(context.clj:78)""
  ""query_processor.context$reducedf.invoke(context.clj:73)""
  ""query_processor.context.default$default_reducef.invokeStatic(default.clj:40)""
  ""query_processor.context.default$default_reducef.invoke(default.clj:25)""
  ""query_processor.context$reducef.invokeStatic(context.clj:70)""
  ""query_processor.context$reducef.invoke(context.clj:63)""
  ""query_processor.context.default$default_runf$respond_STAR___50541.invoke(default.clj:45)""
  ""driver.sql_jdbc.execute$execute_reducible_query$fn__79417.invoke(execute.clj:709)""
  ""driver.h2$fn__82400$fn__82402.invoke(h2.clj:535)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:317)""
  ""driver.h2$fn__82400.invokeStatic(h2.clj:526)""
  ""driver.h2$fn__82400.invoke(h2.clj:522)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:692)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:689)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
  ""driver.sql_jdbc$fn__112715.invokeStatic(sql_jdbc.clj:78)""
  ""driver.sql_jdbc$fn__112715.invoke(sql_jdbc.clj:76)""
  ""driver.h2$fn__82241.invokeStatic(h2.clj:272)""
  ""driver.h2$fn__82241.invoke(h2.clj:268)""
  ""query_processor.context$executef.invokeStatic(context.clj:60)""
  ""query_processor.context$executef.invoke(context.clj:49)""
  ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
  ""query_processor.context.default$default_runf.invoke(default.clj:42)""
  ""query_processor.context$runf.invokeStatic(context.clj:46)""
  ""query_processor.context$runf.invoke(context.clj:40)""
  ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
  ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
  ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72243.invoke(cache.clj:229)""
  ""query_processor.middleware.permissions$check_query_permissions$fn__66600.invoke(permissions.clj:140)""
  ""metabase_enterprise.advanced_permissions.query_processor.middleware.permissions$fn__107143$check_download_permissions__107144$fn__107145.invoke(permissions.clj:127)""
  ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72064.invoke(enterprise.clj:51)""
  ""metabase_enterprise.sandbox.query_processor.middleware.column_level_perms_check$fn__107988$maybe_apply_column_level_perms_check__107989$fn__107990.invoke(column_level_perms_check.clj:33)""
  ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72074.invoke(enterprise.clj:64)""
  ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71506.invoke(mbql_to_native.clj:24)""
  ""query_processor$fn__73411$combined_post_process__73416$combined_post_process_STAR___73417.invoke(query_processor.clj:262)""
  ""query_processor$fn__73411$combined_pre_process__73412$combined_pre_process_STAR___73413.invoke(query_processor.clj:259)""
  ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66697.invoke(fetch_source_query.clj:303)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72154$fn__72158.invoke(resolve_database_and_driver.clj:77)""
  ""driver$do_with_driver.invokeStatic(driver.clj:97)""
  ""driver$do_with_driver.invoke(driver.clj:92)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72154.invoke(resolve_database_and_driver.clj:76)""
  ""query_processor.middleware.store$initialize_store$fn__67324$fn__67325.invoke(store.clj:14)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.middleware.store$initialize_store$fn__67324.invoke(store.clj:13)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72151.invoke(resolve_database_and_driver.clj:60)""
  ""query_processor.middleware.normalize_query$normalize$fn__72456.invoke(normalize_query.clj:38)""
  ""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$fn__79812$handle_audit_app_internal_queries__79813$fn__79815.invoke(handle_audit_queries.clj:142)""
  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72102.invoke(enterprise.clj:103)""
  ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71217.invoke(constraints.clj:104)""
  ""query_processor.middleware.process_userland_query$process_userland_query$fn__72387.invoke(process_userland_query.clj:156)""
  ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72988.invoke(catch_exceptions.clj:171)""
  ""query_processor.reducible$async_qp$qp_STAR___62838$thunk__62840.invoke(reducible.clj:126)""
  ""query_processor.reducible$async_qp$qp_STAR___62838$fn__62842.invoke(reducible.clj:131)""],
 :card_id 132,
 :context :embedded-dashboard,
 :error ""Closed"",
 :row_count 0,
 :running_time 0,
 :preprocessed
 {:constraints {:max-results 10000, :max-results-bare-rows 2000},
  :type :query,
  :middleware {:js-int-to-string? true, :ignore-cached-results? false},
  :user-parameters
  [{:type :date/all-options,
    :slug ""date_filter"",
    :id ""3ef4a7f"",
    :target [:dimension [:field 1076 {:base-type :type/DateTime}]]}],
  :viz-settings {},
  :info {:executed-by 1, :context :embedded-dashboard, :card-id 132, :card-name ""Orders, Count"", :dashboard-id 31},
  :database 4,
  :query {:source-table 121, :aggregation [[:aggregation-options [:count] {:name ""count""}]]},
  :async? true},
 :data {:rows [], :cols []}}
```

### Information about your Metabase installation

```JSON
1.49.6 note that it happens in Chrome but not on Safari
```


### Severity

Minor since the query still runs but good to know why those get cancelled 

### Additional context

_No response_",Tony-metabase,2024-04-23 14:45:06+00:00,[],2025-02-04 20:25:49+00:00,,https://github.com/metabase/metabase/issues/41731,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Embedding/Static', 'Static embedding, previously known as signed embedding'), ('.Team/Embedding', '')]","[{'comment_id': 2072810488, 'issue_id': 2259077736, 'author': 'paoliniluis', 'body': 'Probably related to https://github.com/metabase/metabase/issues/36775?', 'created_at': datetime.datetime(2024, 4, 23, 15, 57, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2074537987, 'issue_id': 2259077736, 'author': 'staal', 'body': 'As noted, it occurs running in Arc or Chrome (with and without extensions) but not Safari, so it could be something chromium specific.', 'created_at': datetime.datetime(2024, 4, 24, 9, 42, 28, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-23 15:57:46 UTC): Probably related to https://github.com/metabase/metabase/issues/36775?

staal on (2024-04-24 09:42:28 UTC): As noted, it occurs running in Arc or Chrome (with and without extensions) but not Safari, so it could be something chromium specific.

"
2258295595,issue,closed,not_planned,occurs error when input a static string to expression in custom column,"### Describe the bug

occurs error when input a static string to expression in custom column, the same custom column expression in v0.48 works fine.
A sample is as follow, if cursor leaves the ""expression"" field (pic1), it will redirect to error page (pic2).

pic1.
![image](https://github.com/metabase/metabase/assets/8278560/22e76ad2-f952-4764-9598-34cc40503eca)

pic2.
![image](https://github.com/metabase/metabase/assets/8278560/cdf7e1ed-cfe8-4922-9fc8-84a460611581)


### To Reproduce

1. New a Question and choose any data
2. Add a custom column, and type any static string with double quote in expression field
3. Click the next field or other space (means to make the cursor not focus on the expression field)
4. See error


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Metabase version: v0.49.4
- Database: PostgreSQL
```


### Severity

blocking some key users

### Additional context

_No response_",jodotlearn,2024-04-23 08:41:52+00:00,[],2024-04-23 08:44:00+00:00,2024-04-23 08:44:00+00:00,https://github.com/metabase/metabase/issues/41718,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2071750237, 'issue_id': 2258295595, 'author': 'paoliniluis', 'body': 'duplicate of https://github.com/metabase/metabase/issues/34776', 'created_at': datetime.datetime(2024, 4, 23, 8, 44, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-23 08:44:00 UTC): duplicate of https://github.com/metabase/metabase/issues/34776

"
2258067471,issue,open,,Pivot CSV exports not all groups,"### Describe the bug

When pivoting data with multiple groupings the CSV export will not show all groupings.

### To Reproduce

1. Create a random question
2. Group it by two groupings
3. Visualize it as a pivot
4. Click on CSV export
5. See error: Only one group is shown


### Expected behavior

Every group should be shown in the CSV file

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""de-CH"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.146+"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.22""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-10"",
      ""tag"": ""v1.49.4"",
      ""hash"": ""0fdefcf""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Zurich""
    }
  }
}
```


### Severity

blocking some users

### Additional context

For example if we group by `Store Name` and `Shift Name` and export it as a CSV file, only the `Shift Name` will be shown in the file.
![image](https://github.com/metabase/metabase/assets/45994666/e9833180-fa90-4063-897c-7a5c43608a26)",rogerzwingli,2024-04-23 06:37:41+00:00,[],2025-02-04 20:31:56+00:00,,https://github.com/metabase/metabase/issues/41714,"[('Type:Bug', 'Product defects'), ('Reporting/Export', ''), ('.Backend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('.Team/DashViz', 'Dashboard and Viz team'), ('Reporting/Export/Pivot', 'Exporting data as pivoted tables')]","[{'comment_id': 2101122910, 'issue_id': 2258067471, 'author': 'adam-james-v', 'body': ""@rogerzwingli, Based on the csv filename, I suspect you're downloading from an unsaved question correct?\r\nYou can quickly check if it's saved or not by looking at the URL. If it's something like `yourdomain/question#someLongbase64Encoding`, then you know it's currently unsaved.\r\n\r\nI'm curious if you first save the question and then do a csv download from this saved question if you get a different result?\r\n\r\nIf that works, it may be a useful workaround for now. Regardless of that, this is indeed a bug to work on, I'd just like to confirm if it's related to the unsaved question code at all."", 'created_at': datetime.datetime(2024, 5, 8, 18, 4, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2111728988, 'issue_id': 2258067471, 'author': 'rogerzwingli', 'body': ""> @rogerzwingli, Based on the csv filename, I suspect you're downloading from an unsaved question correct? You can quickly check if it's saved or not by looking at the URL. If it's something like `yourdomain/question#someLongbase64Encoding`, then you know it's currently unsaved.\r\n> \r\n> I'm curious if you first save the question and then do a csv download from this saved question if you get a different result?\r\n> \r\n> If that works, it may be a useful workaround for now. Regardless of that, this is indeed a bug to work on, I'd just like to confirm if it's related to the unsaved question code at all.\r\n\r\n@adam-james-v It doesn't matter if the question is saved or unsaved. This bug will occur in both scenario."", 'created_at': datetime.datetime(2024, 5, 15, 6, 59, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2205911948, 'issue_id': 2258067471, 'author': 'rogerzwingli', 'body': '@adam-james-v Do you have any news according to this bug? Each day we are getting questions from our customers.', 'created_at': datetime.datetime(2024, 7, 3, 12, 1, 13, tzinfo=datetime.timezone.utc)}]","adam-james-v on (2024-05-08 18:04:07 UTC): @rogerzwingli, Based on the csv filename, I suspect you're downloading from an unsaved question correct?
You can quickly check if it's saved or not by looking at the URL. If it's something like `yourdomain/question#someLongbase64Encoding`, then you know it's currently unsaved.

I'm curious if you first save the question and then do a csv download from this saved question if you get a different result?

If that works, it may be a useful workaround for now. Regardless of that, this is indeed a bug to work on, I'd just like to confirm if it's related to the unsaved question code at all.

rogerzwingli (Issue Creator) on (2024-05-15 06:59:50 UTC): @adam-james-v It doesn't matter if the question is saved or unsaved. This bug will occur in both scenario.

rogerzwingli (Issue Creator) on (2024-07-03 12:01:13 UTC): @adam-james-v Do you have any news according to this bug? Each day we are getting questions from our customers.

"
2257707981,issue,closed,completed,Support creating questions with joined metrics,,perivamsi,2024-04-23 00:55:37+00:00,['metamben'],2024-04-30 15:52:20+00:00,2024-04-26 17:32:11+00:00,https://github.com/metabase/metabase/issues/41709,[],[],
2257600894,issue,open,,Null values in a pivot table can't be highlighted using the ' When Cell is Null' custom formatting condition,"### Describe the bug

We were trying to create a custom formatting rule that would highlight any null values in our pivot table, but the ""null"" cells were not being highlighted. When introspecting the data returned by the query in developer tools, we can see that the summed values that we were attempting to highlight if they were null are never actually null in the data returned by the query, but it appears that the pivot table instead ignores any data in the ""rows"" object where any of the breakouts are null.

For example:
If I have a pivot table with a sum aggregation broken out by name, type and year. There is a value in a row for 2021, but not 2022 and 2023. In the data.rows object array returned by the query I have several objects in the array that match my summed value. Each object contains a value for the sum, but for all but one object (where year=2021) at least one of the name, type or year breakout value is null. I imagine these null breakout values are what the pivot table is using to decide whether or not to display a value in the cell. I think because of this, the conditional formatting rule never considers the sum in the other years to be null and therefore won't highlight it in the pivot table.

### To Reproduce

1. Create a question that summarizes on a column broken out by a few other columns where the aggregated column will be null in some places once the table is pivoted
2. Pivot the table
3. Add a conditional formatting rule to highlight any of the cells where the value of the aggregation is null
4. The conditional formatting rule does not highlight the empty cells


### Expected behavior

Empty cells in a pivot table should be highlighted when the custom formatting rule is applied.

### Logs

_No response_

### Information about your Metabase installation

```JSON
Chrome: 124.0.6367.60
Ubuntu: 20.04
Database: Postgres
Metabase version: 0.49.6
Metabase internal database: Postgres
```


### Severity

annoying

### Additional context

_No response_",dleard,2024-04-22 23:00:36+00:00,[],2025-02-04 20:31:55+00:00,,https://github.com/metabase/metabase/issues/41708,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('.Reproduced', 'Issues reproduced in test (usually Cypress)'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2072550472, 'issue_id': 2257600894, 'author': 'paoliniluis', 'body': 'Is this in the pivot table viz, or in the table viz (which can be pivoted)?', 'created_at': datetime.datetime(2024, 4, 23, 14, 48, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2072688257, 'issue_id': 2257600894, 'author': 'dleard', 'body': '> Is this in the pivot table viz, or in the table viz (which can be pivoted)?\r\n\r\nOn the pivot table viz. Once the question is pivoted, records in the original question that don\'t have a value for a year have ""empty"" cells in the pivot table for those years. It\'s those cells in the pivot table viz that we were trying to highlight when null.', 'created_at': datetime.datetime(2024, 4, 23, 15, 23, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2239549134, 'issue_id': 2257600894, 'author': 'cdeweyx', 'body': 'Reproduced in stats [here](https://stats.metabase.com/question#eyJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoxLCJ0eXBlIjoicXVlcnkiLCJxdWVyeSI6eyJzb3VyY2UtdGFibGUiOjM1NTc0LCJhZ2dyZWdhdGlvbiI6W1siY291bnQiXSxbImF2ZyIsWyJmaWVsZCIsNTIxODUyLHsiYmFzZS10eXBlIjoidHlwZS9JbnRlZ2VyIiwic291cmNlLWZpZWxkIjo1MjE4OTd9XV1dLCJicmVha291dCI6W1siZmllbGQiLDUyMTg5OCx7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWUiLCJ0ZW1wb3JhbC11bml0IjoibW9udGgifV0sWyJmaWVsZCIsNTIxODk1LHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLDUyMTg5Myx7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XV19fSwiZGlzcGxheSI6InBpdm90IiwiZGlzcGxheUlzTG9ja2VkIjp0cnVlLCJ2aXN1YWxpemF0aW9uX3NldHRpbmdzIjp7InBpdm90X3RhYmxlLmNvbHVtbl9zcGxpdCI6eyJyb3dzIjpbWyJmaWVsZCIsNTIxODk1LHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLDUyMTg5OCx7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWUiLCJ0ZW1wb3JhbC11bml0IjoibW9udGgifV1dLCJjb2x1bW5zIjpbWyJmaWVsZCIsNTIxODkzLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dXSwidmFsdWVzIjpbWyJhZ2dyZWdhdGlvbiIsMF0sWyJhZ2dyZWdhdGlvbiIsMV1dfSwicGl2b3RfdGFibGUuY29sdW1uX3dpZHRocyI6eyJsZWZ0SGVhZGVyV2lkdGhzIjpbMTA5LDE0Ml0sInRvdGFsTGVmdEhlYWRlcldpZHRocyI6MjUxLCJ2YWx1ZUhlYWRlcldpZHRocyI6e319LCJ0YWJsZS5jb2x1bW5fZm9ybWF0dGluZyI6W3siY29sdW1ucyI6WyJjb3VudCJdLCJ0eXBlIjoic2luZ2xlIiwib3BlcmF0b3IiOiJpcy1udWxsIiwidmFsdWUiOiIiLCJjb2xvciI6IiNFRjhDOEMiLCJoaWdobGlnaHRfcm93IjpmYWxzZSwiaWQiOjB9XX0sInR5cGUiOiJxdWVzdGlvbiJ9)', 'created_at': datetime.datetime(2024, 7, 19, 16, 25, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2624472538, 'issue_id': 2257600894, 'author': 'lorem--ipsum', 'body': ""I would say this is not trivial, as there's no data behind those empty cell, which is why the formatters don't kick in."", 'created_at': datetime.datetime(2025, 1, 30, 13, 8, 39, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-23 14:48:51 UTC): Is this in the pivot table viz, or in the table viz (which can be pivoted)?

dleard (Issue Creator) on (2024-04-23 15:23:37 UTC): On the pivot table viz. Once the question is pivoted, records in the original question that don't have a value for a year have ""empty"" cells in the pivot table for those years. It's those cells in the pivot table viz that we were trying to highlight when null.

cdeweyx on (2024-07-19 16:25:04 UTC): Reproduced in stats [here](https://stats.metabase.com/question#eyJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoxLCJ0eXBlIjoicXVlcnkiLCJxdWVyeSI6eyJzb3VyY2UtdGFibGUiOjM1NTc0LCJhZ2dyZWdhdGlvbiI6W1siY291bnQiXSxbImF2ZyIsWyJmaWVsZCIsNTIxODUyLHsiYmFzZS10eXBlIjoidHlwZS9JbnRlZ2VyIiwic291cmNlLWZpZWxkIjo1MjE4OTd9XV1dLCJicmVha291dCI6W1siZmllbGQiLDUyMTg5OCx7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWUiLCJ0ZW1wb3JhbC11bml0IjoibW9udGgifV0sWyJmaWVsZCIsNTIxODk1LHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLDUyMTg5Myx7ImJhc2UtdHlwZSI6InR5cGUvVGV4dCJ9XV19fSwiZGlzcGxheSI6InBpdm90IiwiZGlzcGxheUlzTG9ja2VkIjp0cnVlLCJ2aXN1YWxpemF0aW9uX3NldHRpbmdzIjp7InBpdm90X3RhYmxlLmNvbHVtbl9zcGxpdCI6eyJyb3dzIjpbWyJmaWVsZCIsNTIxODk1LHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLFsiZmllbGQiLDUyMTg5OCx7ImJhc2UtdHlwZSI6InR5cGUvRGF0ZVRpbWUiLCJ0ZW1wb3JhbC11bml0IjoibW9udGgifV1dLCJjb2x1bW5zIjpbWyJmaWVsZCIsNTIxODkzLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dXSwidmFsdWVzIjpbWyJhZ2dyZWdhdGlvbiIsMF0sWyJhZ2dyZWdhdGlvbiIsMV1dfSwicGl2b3RfdGFibGUuY29sdW1uX3dpZHRocyI6eyJsZWZ0SGVhZGVyV2lkdGhzIjpbMTA5LDE0Ml0sInRvdGFsTGVmdEhlYWRlcldpZHRocyI6MjUxLCJ2YWx1ZUhlYWRlcldpZHRocyI6e319LCJ0YWJsZS5jb2x1bW5fZm9ybWF0dGluZyI6W3siY29sdW1ucyI6WyJjb3VudCJdLCJ0eXBlIjoic2luZ2xlIiwib3BlcmF0b3IiOiJpcy1udWxsIiwidmFsdWUiOiIiLCJjb2xvciI6IiNFRjhDOEMiLCJoaWdobGlnaHRfcm93IjpmYWxzZSwiaWQiOjB9XX0sInR5cGUiOiJxdWVzdGlvbiJ9)

lorem--ipsum on (2025-01-30 13:08:39 UTC): I would say this is not trivial, as there's no data behind those empty cell, which is why the formatters don't kick in.

"
2257565868,issue,open,,Effective type got set incorrectly for timestamp column leading to broken queries,"### Describe the bug

Specific date filters, like today, yesterday or on do not work on timestamp columns. They compare the timestamp with a date value, and so they return null results, even when there are valid values. The question ony works as expected when the timestamp column is cast as a date. This was not necessary before.

### To Reproduce

1. Create a question for a table that has a timestamp column and filter it for today or for a date where you know that there are values. (The screenshot below is a simple example)

![question-for-table-with-timestamp-filtering-today](https://github.com/metabase/metabase/assets/50032315/1b1a3ef4-2ef4-4ab6-8f6f-003ac9bab98d)

2. If you try to visualise the results, there are none.
3. The `WHERE` clause for the filter if the question is converted to SQL is 
```
""public"".""sales_invoice"".""approved_at"" = CAST(NOW() AS date)
```
4. But if the timestamp column is cast as date, then there are results. For example, this works

![sql-that-works](https://github.com/metabase/metabase/assets/50032315/8d76578f-19e9-4a40-b609-3d155afe2ff1)




### Expected behavior

The filter should return values for timestams that fall under the specific date

### Logs

_No response_

### Information about your Metabase installation

```JSON
Chrome: 124.0.6367.60
Ubuntu: 22.04
Database: Postgres
Metabase version: 0.49.6
Metabase internal database: Postgres
```


### Severity

Annoying. Some reports on dashboards no longer show data

### Additional context

_No response_",eleni-xar,2024-04-22 22:27:23+00:00,[],2025-02-04 20:27:56+00:00,,https://github.com/metabase/metabase/issues/41706,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Processor', ''), ('.Backend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]","[{'comment_id': 2071136784, 'issue_id': 2257565868, 'author': 'oselz', 'body': ""A workaround is to set the column type to some sort of timestamp (eg `Updated timestamp` - which doesn't match the use case here but at least works) and Metabase will then generate the correct filter SQL.\r\n\r\nIt would be nice if metabase understood that fields with no semantic type of column type timestamptz are datetimes, not dates."", 'created_at': datetime.datetime(2024, 4, 22, 23, 49, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2072547895, 'issue_id': 2257565868, 'author': 'paoliniluis', 'body': ""@eleni-xar can you give us some sample dataset so we can test this? if this is true then it's a major regression and we need to tackle it ASAP"", 'created_at': datetime.datetime(2024, 4, 23, 14, 48, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2073916594, 'issue_id': 2257565868, 'author': 'oselz', 'body': '@paoliniluis @eleni-xar is a member of my team.  I tried to create a reproducible test case, but couldn\'t find one.  \r\n\r\nFurther, undoing my workaround above (setting the type back to \'No semantic type\') does not reproduce the issue either.  I have resynced the table schema again since, so maybe that updated something (a resync did not fix the issue before I applied the workaround).\r\n\r\nWe recently upgraded metabase, but the logs restart at the upgrade and I cannot see what the previous version was.  There were 59 migrations run, if that helps narrow it down.\r\n\r\nThere are plenty of entries in the logs of the failed query as the Question was running on a dashboard with notifications 1/day and caused an exception each time.  Here is the log of one such exception: [metabase.log](https://github.com/metabase/metabase/files/15087151/metabase.log)\r\n\r\nA possibly pertinent extract from the above showing the failure to read the correct effective type even though the base type is known:\r\n```\r\n\r\nmetabase-1  |   {:source-table 135,\r\nmetabase-1  |    :aggregation [[:aggregation-options [:sum [:field 1744 nil]] {:name ""sum""}]],\r\nmetabase-1  |    :filter\r\nmetabase-1  |    [:and\r\nmetabase-1  |     [:!=\r\nmetabase-1  |      [:field 1750 {:temporal-unit :default}]\r\nmetabase-1  |      [:value\r\nmetabase-1  |       nil\r\nmetabase-1  |       {:base_type :type/DateTimeWithLocalTZ,\r\nmetabase-1  |        :effective_type :type/Date,\r\nmetabase-1  |        :coercion_strategy nil,\r\nmetabase-1  |        :semantic_type nil,\r\nmetabase-1  |        :database_type ""timestamptz"",\r\nmetabase-1  |        :name ""approved_at"",\r\nmetabase-1  |        :unit :default}]]\r\nmetabase-1  |     [:= [:field 1750 {:temporal-unit :default}] [:relative-datetime 0 :day]]]},\r\n```', 'created_at': datetime.datetime(2024, 4, 24, 2, 58, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2077269300, 'issue_id': 2257565868, 'author': 'm-matthes', 'body': ""Hi,\r\n\r\nI think we have an issue which might be related.\r\nI made several questions before the release, where I joined a table using a custom field based on now.\r\n\r\nBefore the release this worked perfectly, but after the latest release it doesn't.\r\n\r\nThe column of the table which I use for the join is a date column, where the 'now' function returns a datetime. \r\n\r\n![image](https://github.com/metabase/metabase/assets/100769490/8137e3cc-7d8a-4ca0-9afe-1e9d744076c4)\r\n\r\n![image](https://github.com/metabase/metabase/assets/100769490/a04c436f-e7a4-42bb-bc22-00cc652894d7)"", 'created_at': datetime.datetime(2024, 4, 25, 14, 0, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2077812749, 'issue_id': 2257565868, 'author': 'camsaul', 'body': 'Ok spent the morning investigating this, see https://metaboat.slack.com/archives/C052ZBWRG3W/p1714043564600349\r\n\r\nIt seems like the queries being generated are correct given the metadata, but somehow the `:effective_type` for the Field got incorrectly set to `:type/Date`.\r\n\r\nYou can verify that if the metadata is correct the correct query is generated with this test:\r\n\r\n```clj\r\n;;; passes\r\n(deftest ^:parallel generate-correct-filter-for-timestamp-against-now-test\r\n  (testing ""#41706""\r\n    (let [metadata-provider (lib.tu/merged-mock-metadata-provider\r\n                             meta/metadata-provider\r\n                             {:database {:engine :postgres}\r\n                              :fields   [{:id             (meta/id :orders :created-at)\r\n                                          :base-type      :type/DateTimeWithLocalTZ\r\n                                          :effective-type :type/DateTimeWithLocalTZ\r\n                                          :database-type ""timezonetz""\r\n                                          :semantic-type nil}]})\r\n          query             (-> (lib/query metadata-provider (lib.metadata/table metadata-provider (meta/id :orders)))\r\n                                (lib/filter (lib/not-null (lib.metadata/field metadata-provider (meta/id :orders :created-at))))\r\n                                (assoc :parameters [{:type   :date/relative\r\n                                                     :value  ""today""\r\n                                                     :target [:dimension [:field (meta/id :orders :created-at) nil]]}]))]\r\n      (driver/with-driver :postgres\r\n        (is (= {:query  [""SELECT""\r\n                         ""  \\""PUBLIC\\"".\\""ORDERS\\"".\\""ID\\"" AS \\""ID\\"",""\r\n                         ""  \\""PUBLIC\\"".\\""ORDERS\\"".\\""USER_ID\\"" AS \\""USER_ID\\"",""\r\n                         ""  \\""PUBLIC\\"".\\""ORDERS\\"".\\""PRODUCT_ID\\"" AS \\""PRODUCT_ID\\"",""\r\n                         ""  \\""PUBLIC\\"".\\""ORDERS\\"".\\""SUBTOTAL\\"" AS \\""SUBTOTAL\\"",""\r\n                         ""  \\""PUBLIC\\"".\\""ORDERS\\"".\\""TAX\\"" AS \\""TAX\\"",""\r\n                         ""  \\""PUBLIC\\"".\\""ORDERS\\"".\\""TOTAL\\"" AS \\""TOTAL\\"",""\r\n                         ""  \\""PUBLIC\\"".\\""ORDERS\\"".\\""DISCOUNT\\"" AS \\""DISCOUNT\\"",""\r\n                         ""  \\""PUBLIC\\"".\\""ORDERS\\"".\\""CREATED_AT\\"" AS \\""CREATED_AT\\"",""\r\n                         ""  \\""PUBLIC\\"".\\""ORDERS\\"".\\""QUANTITY\\"" AS \\""QUANTITY\\""""\r\n                         ""FROM""\r\n                         ""  \\""PUBLIC\\"".\\""ORDERS\\""""\r\n                         ""WHERE""\r\n                         ""  (\\""PUBLIC\\"".\\""ORDERS\\"".\\""CREATED_AT\\"" IS NOT NULL)""\r\n                         ""  AND (""\r\n                         ""    \\""PUBLIC\\"".\\""ORDERS\\"".\\""CREATED_AT\\"" >= CAST(NOW() AS date)""\r\n                         ""  )""\r\n                         ""  AND (""\r\n                         ""    \\""PUBLIC\\"".\\""ORDERS\\"".\\""CREATED_AT\\"" < CAST((NOW() + INTERVAL \'1 day\') AS date)""\r\n                         ""  )""\r\n                         ""LIMIT""\r\n                         ""  1048575""]\r\n                :params nil}\r\n               (-> (qp.compile/compile query)\r\n                   (update :query (fn [sql]\r\n                                    (str/split-lines (driver/prettify-native-form :postgres sql)))))))))))\r\n```\r\n\r\nIf you change `:effective-type` to `:type/Date` then you get the same issue where the SQL has\r\n\r\n```sql\r\n\\""PUBLIC\\"".\\""ORDERS\\"".\\""CREATED_AT\\"" = CAST(NOW() AS date)\r\n```\r\n\r\nI don\'t know how the effective type got set incorrectly, but it seems like the only places that set it are either `PUT /api/field/:id` (not sure if this actually set here in practice or not), and the Field metadata sync code -- we should investigate further and see if we can come up with a theory as to how the effective type got out of sync with base type and coercion strategy.\r\n\r\nI think the real way to fix this tho is to drop `effective_type` `from the app DB altogether since it\'s just derived from `base_type` and `coercion_strategy` and we can easily recalculate it on the fly. All we\'re doing by keeping it in the app DB is increasing our surface for bugs by having something that can maybe get out of sync with those columns', 'created_at': datetime.datetime(2024, 4, 25, 17, 36, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2077816178, 'issue_id': 2257565868, 'author': 'camsaul', 'body': 'Dropping priority as discussed in Slack thread and moving to BEC inbox since it seems like either an issue with sync or the REST API for editing metadata', 'created_at': datetime.datetime(2024, 4, 25, 17, 38, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2077834018, 'issue_id': 2257565868, 'author': 'paoliniluis', 'body': ""@eleni-xar unfortunately we weren't able to reproduce, so we're dropping the ball on this one till there's a reproduction we can make"", 'created_at': datetime.datetime(2024, 4, 25, 17, 48, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2082223734, 'issue_id': 2257565868, 'author': 'paoliniluis', 'body': ""@eleni-xar can you provide the DDL of the table? also, please provide the dump of the metabase_field table in the metabase app db on this table so we can see what's there"", 'created_at': datetime.datetime(2024, 4, 29, 9, 10, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2087390553, 'issue_id': 2257565868, 'author': 'eleni-xar', 'body': ""> @eleni-xar can you provide the DDL of the table? also, please provide the dump of the metabase_field table in the metabase app db on this table so we can see what's there\r\n\r\n@paoliniluis Please find the information you asked in the attached files. But also be aware that the problem no longer appears for us after we set the column type to some  timestamp semantic type\r\n[sales_invoice.ddl.txt](https://github.com/metabase/metabase/files/15171217/sales_invoice.ddl.txt)\r\n[metabase_field.csv](https://github.com/metabase/metabase/files/15171220/metabase_field.csv)"", 'created_at': datetime.datetime(2024, 4, 30, 21, 28, 50, tzinfo=datetime.timezone.utc)}]","oselz on (2024-04-22 23:49:41 UTC): A workaround is to set the column type to some sort of timestamp (eg `Updated timestamp` - which doesn't match the use case here but at least works) and Metabase will then generate the correct filter SQL.

It would be nice if metabase understood that fields with no semantic type of column type timestamptz are datetimes, not dates.

paoliniluis on (2024-04-23 14:48:11 UTC): @eleni-xar can you give us some sample dataset so we can test this? if this is true then it's a major regression and we need to tackle it ASAP

oselz on (2024-04-24 02:58:47 UTC): @paoliniluis @eleni-xar is a member of my team.  I tried to create a reproducible test case, but couldn't find one.  

Further, undoing my workaround above (setting the type back to 'No semantic type') does not reproduce the issue either.  I have resynced the table schema again since, so maybe that updated something (a resync did not fix the issue before I applied the workaround).

We recently upgraded metabase, but the logs restart at the upgrade and I cannot see what the previous version was.  There were 59 migrations run, if that helps narrow it down.

There are plenty of entries in the logs of the failed query as the Question was running on a dashboard with notifications 1/day and caused an exception each time.  Here is the log of one such exception: [metabase.log](https://github.com/metabase/metabase/files/15087151/metabase.log)

A possibly pertinent extract from the above showing the failure to read the correct effective type even though the base type is known:
```

metabase-1  |   {:source-table 135,
metabase-1  |    :aggregation [[:aggregation-options [:sum [:field 1744 nil]] {:name ""sum""}]],
metabase-1  |    :filter
metabase-1  |    [:and
metabase-1  |     [:!=
metabase-1  |      [:field 1750 {:temporal-unit :default}]
metabase-1  |      [:value
metabase-1  |       nil
metabase-1  |       {:base_type :type/DateTimeWithLocalTZ,
metabase-1  |        :effective_type :type/Date,
metabase-1  |        :coercion_strategy nil,
metabase-1  |        :semantic_type nil,
metabase-1  |        :database_type ""timestamptz"",
metabase-1  |        :name ""approved_at"",
metabase-1  |        :unit :default}]]
metabase-1  |     [:= [:field 1750 {:temporal-unit :default}] [:relative-datetime 0 :day]]]},
```

m-matthes on (2024-04-25 14:00:21 UTC): Hi,

I think we have an issue which might be related.
I made several questions before the release, where I joined a table using a custom field based on now.

Before the release this worked perfectly, but after the latest release it doesn't.

The column of the table which I use for the join is a date column, where the 'now' function returns a datetime. 

![image](https://github.com/metabase/metabase/assets/100769490/8137e3cc-7d8a-4ca0-9afe-1e9d744076c4)

![image](https://github.com/metabase/metabase/assets/100769490/a04c436f-e7a4-42bb-bc22-00cc652894d7)

camsaul on (2024-04-25 17:36:24 UTC): Ok spent the morning investigating this, see https://metaboat.slack.com/archives/C052ZBWRG3W/p1714043564600349

It seems like the queries being generated are correct given the metadata, but somehow the `:effective_type` for the Field got incorrectly set to `:type/Date`.

You can verify that if the metadata is correct the correct query is generated with this test:

```clj
;;; passes
(deftest ^:parallel generate-correct-filter-for-timestamp-against-now-test
  (testing ""#41706""
    (let [metadata-provider (lib.tu/merged-mock-metadata-provider
                             meta/metadata-provider
                             {:database {:engine :postgres}
                              :fields   [{:id             (meta/id :orders :created-at)
                                          :base-type      :type/DateTimeWithLocalTZ
                                          :effective-type :type/DateTimeWithLocalTZ
                                          :database-type ""timezonetz""
                                          :semantic-type nil}]})
          query             (-> (lib/query metadata-provider (lib.metadata/table metadata-provider (meta/id :orders)))
                                (lib/filter (lib/not-null (lib.metadata/field metadata-provider (meta/id :orders :created-at))))
                                (assoc :parameters [{:type   :date/relative
                                                     :value  ""today""
                                                     :target [:dimension [:field (meta/id :orders :created-at) nil]]}]))]
      (driver/with-driver :postgres
        (is (= {:query  [""SELECT""
                         ""  \""PUBLIC\"".\""ORDERS\"".\""ID\"" AS \""ID\"",""
                         ""  \""PUBLIC\"".\""ORDERS\"".\""USER_ID\"" AS \""USER_ID\"",""
                         ""  \""PUBLIC\"".\""ORDERS\"".\""PRODUCT_ID\"" AS \""PRODUCT_ID\"",""
                         ""  \""PUBLIC\"".\""ORDERS\"".\""SUBTOTAL\"" AS \""SUBTOTAL\"",""
                         ""  \""PUBLIC\"".\""ORDERS\"".\""TAX\"" AS \""TAX\"",""
                         ""  \""PUBLIC\"".\""ORDERS\"".\""TOTAL\"" AS \""TOTAL\"",""
                         ""  \""PUBLIC\"".\""ORDERS\"".\""DISCOUNT\"" AS \""DISCOUNT\"",""
                         ""  \""PUBLIC\"".\""ORDERS\"".\""CREATED_AT\"" AS \""CREATED_AT\"",""
                         ""  \""PUBLIC\"".\""ORDERS\"".\""QUANTITY\"" AS \""QUANTITY\""""
                         ""FROM""
                         ""  \""PUBLIC\"".\""ORDERS\""""
                         ""WHERE""
                         ""  (\""PUBLIC\"".\""ORDERS\"".\""CREATED_AT\"" IS NOT NULL)""
                         ""  AND (""
                         ""    \""PUBLIC\"".\""ORDERS\"".\""CREATED_AT\"" >= CAST(NOW() AS date)""
                         ""  )""
                         ""  AND (""
                         ""    \""PUBLIC\"".\""ORDERS\"".\""CREATED_AT\"" < CAST((NOW() + INTERVAL '1 day') AS date)""
                         ""  )""
                         ""LIMIT""
                         ""  1048575""]
                :params nil}
               (-> (qp.compile/compile query)
                   (update :query (fn [sql]
                                    (str/split-lines (driver/prettify-native-form :postgres sql)))))))))))
```

If you change `:effective-type` to `:type/Date` then you get the same issue where the SQL has

```sql
\""PUBLIC\"".\""ORDERS\"".\""CREATED_AT\"" = CAST(NOW() AS date)
```

I don't know how the effective type got set incorrectly, but it seems like the only places that set it are either `PUT /api/field/:id` (not sure if this actually set here in practice or not), and the Field metadata sync code -- we should investigate further and see if we can come up with a theory as to how the effective type got out of sync with base type and coercion strategy.

I think the real way to fix this tho is to drop `effective_type` `from the app DB altogether since it's just derived from `base_type` and `coercion_strategy` and we can easily recalculate it on the fly. All we're doing by keeping it in the app DB is increasing our surface for bugs by having something that can maybe get out of sync with those columns

camsaul on (2024-04-25 17:38:35 UTC): Dropping priority as discussed in Slack thread and moving to BEC inbox since it seems like either an issue with sync or the REST API for editing metadata

paoliniluis on (2024-04-25 17:48:50 UTC): @eleni-xar unfortunately we weren't able to reproduce, so we're dropping the ball on this one till there's a reproduction we can make

paoliniluis on (2024-04-29 09:10:01 UTC): @eleni-xar can you provide the DDL of the table? also, please provide the dump of the metabase_field table in the metabase app db on this table so we can see what's there

eleni-xar (Issue Creator) on (2024-04-30 21:28:50 UTC): @paoliniluis Please find the information you asked in the attached files. But also be aware that the problem no longer appears for us after we set the column type to some  timestamp semantic type
[sales_invoice.ddl.txt](https://github.com/metabase/metabase/files/15171217/sales_invoice.ddl.txt)
[metabase_field.csv](https://github.com/metabase/metabase/files/15171220/metabase_field.csv)

"
2257431936,issue,closed,completed,Sample Database doesn't start with any perms (on master),"### Describe the bug

Sample database doesn't start with any permissions when you start up a new instance of Metabase.

### To Reproduce

1. Start up Metabase with a fresh application database
2. View permissions for sample database

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Current master
```


### Severity

n/a

### Additional context

_No response_",noahmoss,2024-04-22 20:44:16+00:00,['calherries'],2024-04-24 07:58:53+00:00,2024-04-24 07:58:17+00:00,https://github.com/metabase/metabase/issues/41701,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Administration/Permissions', 'Collection or Data permissions'), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2074319739, 'issue_id': 2257431936, 'author': 'calherries', 'body': ""This doesn't require a milestone since it was only a regression on master"", 'created_at': datetime.datetime(2024, 4, 24, 7, 58, 53, tzinfo=datetime.timezone.utc)}]","calherries (Assginee) on (2024-04-24 07:58:53 UTC): This doesn't require a milestone since it was only a regression on master

"
2257261291,issue,open,,Ability to have chart sections and color them,"**Is your feature request related to a problem? Please describe.**
Ability to divide a chart in colors based on aggregations/summarizations and set colors to them.

**Describe the solution you'd like**
Something like this:
![Screenshot 2024-04-22 at 3 58 49 PM](https://github.com/metabase/metabase/assets/132273646/1cd129d9-9827-4db3-86f6-1078903d261d)

**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
Requested by a customer, internal ticket: [26252](https://metabase.zendesk.com/agent/tickets/26252)

**Additional context**
Related to https://github.com/metabase/metabase/issues/3168",ignacio-mb,2024-04-22 19:01:13+00:00,[],2024-04-22 19:01:14+00:00,,https://github.com/metabase/metabase/issues/41698,"[('Type:New Feature', ''), ('Visualization/Chart Settings', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.')]",[],
2257084232,issue,closed,completed,Create a mock API to simulate JWT-based authentication for the embedding demo,,heypoom,2024-04-22 17:20:51+00:00,['heypoom'],2024-04-29 10:01:08+00:00,2024-04-29 10:01:08+00:00,https://github.com/metabase/metabase/issues/41696,[],[],
2256767263,issue,closed,completed,Expression documentation popover renders white on white text,"### Describe the bug

The expression help text popover is rendering white text on a white background.

<img width=""488"" alt=""Screenshot 2024-04-22 at 16 53 19"" src=""https://github.com/metabase/metabase/assets/1250185/7b2ddfdc-4a34-4e68-a595-41dcb9eb44f2"">


### To Reproduce

1. Go to New Question → Orders
2. Click on Custom Column → Custom Expression
3. Type `case(`
4. The popover that shows up should show white on white text


### Expected behavior

The text should not be white on white.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:125.0) Gecko/20100101 Firefox/125.0"",
    ""vendor"": """"
  }
}
```


### Severity

P2

### Additional context

_No response_",romeovs,2024-04-22 14:58:20+00:00,[],2024-04-23 08:30:09+00:00,2024-04-23 08:30:09+00:00,https://github.com/metabase/metabase/issues/41688,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2256688704,issue,open,,Welcome to Metabase logo is tiny,"### Describe the bug

Explains for itself
![image](https://github.com/metabase/metabase/assets/1711649/e32d87a6-c4b9-4437-93c6-c123e10b725f)


### To Reproduce

1) start v49.6
2) see the logo

### Expected behavior

A normal logo

### Logs

NA

### Information about your Metabase installation

```JSON
v49.6
```


### Severity

P3

### Additional context

_No response_",paoliniluis,2024-04-22 14:27:34+00:00,[],2024-05-20 13:47:14+00:00,,https://github.com/metabase/metabase/issues/41687,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Design Needed', ''), ('.Frontend', ''), ('First Experience/Setup', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2256477964,issue,closed,completed,Create an ENV Variable that allows you to setup when a query would timeout,"**Is your feature request related to a problem? Please describe.**
I would like to execute queries that take more than 20 minutes. Currently we have hardcoded 20 minutes in our code [more than 20 min](https://github.com/metabase/metabase/blob/68fc6f4477bd0887bb131cbce2aec03b639a7000/src/metabase/query_processor/pipeline.clj#L100)

**Describe the solution you'd like**
An ENV Variable that would control this value so i can reduce or increase a query timeout

**Describe alternatives you've considered**
Forking the code and changing this directly

",Tony-metabase,2024-04-22 12:58:34+00:00,[],2024-08-06 08:48:15+00:00,2024-08-04 15:25:04+00:00,https://github.com/metabase/metabase/issues/41685,"[('Priority:P2', 'Average run of the mill bug'), ('Type:New Feature', ''), ('.Backend', ''), ('Operation/Environment variables', '')]","[{'comment_id': 2130231755, 'issue_id': 2256477964, 'author': 'cabarria', 'body': 'Any updates on this issue?', 'created_at': datetime.datetime(2024, 5, 24, 19, 29, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2136909755, 'issue_id': 2256477964, 'author': 'Timelessprod', 'body': 'Would be a much appreciated feature when unpacking JSON payloads which takes time', 'created_at': datetime.datetime(2024, 5, 29, 9, 2, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2270729726, 'issue_id': 2256477964, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.50.19](https://github.com/metabase/metabase/milestone/260)', 'created_at': datetime.datetime(2024, 8, 6, 8, 48, 13, tzinfo=datetime.timezone.utc)}]","cabarria on (2024-05-24 19:29:11 UTC): Any updates on this issue?

Timelessprod on (2024-05-29 09:02:25 UTC): Would be a much appreciated feature when unpacking JSON payloads which takes time

github-actions[bot] on (2024-08-06 08:48:13 UTC): 🚀 This should also be released by [v0.50.19](https://github.com/metabase/metabase/milestone/260)

"
2256452442,issue,open,,Metabase Analytics - Dashboard Overview Filters link to Content instead of Dashboards,"### Describe the bug

Dashboard Overview Filters link to Content instead of Dashboards .. .So you get collection, question and even Model names/IDs

### To Reproduce

Make sure you are running enterprise

1. Go to Metabase Analytics -> Dashboard Overview 
2. Click on Dashboard Name ->  Notice you get every object in metabase not just Dashboard Names

<img width=""1511"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/3fe986b1-0c51-4f78-b940-165de725dd7b"">

3. Same issue with Dashboard ID


### Expected behavior

Only get Dashboard Name/IDs 

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
Happens on 48, 49 and master
```


### Severity

Makes The Dashboard Overview obsolete 

### Additional context

_No response_",Tony-metabase,2024-04-22 12:48:09+00:00,[],2025-02-04 20:28:43+00:00,,https://github.com/metabase/metabase/issues/41684,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('.Backend', ''), ('Administration/Usage analytics', 'Pro and Enterprise meta analytics, fka audit'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2611002570, 'issue_id': 2256452442, 'author': 'luizarakaki', 'body': 'This is kind of a querying issue.<br><br>The dashboard filter shows all values for the content.name, but all cards in this dashboards are filtering type=dashboard.<br><br>We can workaround by adding a dummy filter and creating a linked filter', 'created_at': datetime.datetime(2025, 1, 23, 20, 57, 49, tzinfo=datetime.timezone.utc)}]","luizarakaki on (2025-01-23 20:57:49 UTC): This is kind of a querying issue.<br><br>The dashboard filter shows all values for the content.name, but all cards in this dashboards are filtering type=dashboard.<br><br>We can workaround by adding a dummy filter and creating a linked filter

"
2256357547,issue,closed,completed,Cannot tab through fields in Save Question modal,"### Describe the bug

Opening the save question modal, I want to be able to tab through the fields as I fill them out, but I am not able to

### To Reproduce

1. Create a question
2. Hit save and create a name
3. Confidently press the `tab` key and prepare to write a descriptive description
4. Sigh as you are forced to reach for the mouse to click the next field


### Expected behavior

Should be able to tab through fields

### Logs

_No response_

### Information about your Metabase installation

```JSON
current master
```


### Severity

annoying, but also isn't very a11y friendly

### Additional context

_No response_",npfitz,2024-04-22 12:01:26+00:00,['npfitz'],2024-04-25 20:17:33+00:00,2024-04-23 20:02:23+00:00,https://github.com/metabase/metabase/issues/41683,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround')]",[],
2256284821,issue,closed,not_planned,Oracle syncr ,"### Describe the bug

Erro ao sincronizar banco de dados Oracle 

### To Reproduce


Database is saved but does not synchronize metadata

### Expected behavior

_No response_

### Logs

[c949f2ad-3b7f-481d-b633-71d1feb08d3d] 2024-04-22T08:00:32-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 23:
/collection/namespace/snippets/root/
                      ^
Expected one of:
:end-of-string
""read""

[c949f2ad-3b7f-481d-b633-71d1feb08d3d] 2024-04-22T08:00:32-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 1:
/application/subscription/
^
Expected one of:
""/"" (followed by end-of-string)
""/query/db/""
""/data/db/""
""/collection/""
""/details""
""/data-model""
""/download""
""/block/db/""
""/db/""
""/execute/""


### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""pt-BR"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.0-94-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""oracle""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v0.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""America/Bahia""
    }
  }
}
```


### Severity

medium

### Additional context

_No response_",gabrielvinicius,2024-04-22 11:24:15+00:00,[],2024-04-25 17:45:24+00:00,2024-04-24 11:37:42+00:00,https://github.com/metabase/metabase/issues/41681,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2069148181, 'issue_id': 2256284821, 'author': 'paoliniluis', 'body': 'Please post entire logs', 'created_at': datetime.datetime(2024, 4, 22, 11, 25, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2069174505, 'issue_id': 2256284821, 'author': 'gabrielvinicius', 'body': '[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.core \r\nMetabase v0.49.6 (5abf130) \r\n\r\nCopyright © 2024 Metabase, Inc. \r\n\r\nMetabase Enterprise Edition extensions are NOT PRESENT.\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.core Starting Metabase in STANDALONE mode\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.server Launching Embedded Jetty Webserver with config:\r\n {:port 3000, :host ""0.0.0.0""}\r\n\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.core Starting Metabase version v0.49.6 (5abf130) ...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.core System info:\r\n {""file.encoding"" ""UTF-8"",\r\n ""java.runtime.name"" ""OpenJDK Runtime Environment"",\r\n ""java.runtime.version"" ""11.0.22+7"",\r\n ""java.vendor"" ""Eclipse Adoptium"",\r\n ""java.vendor.url"" ""https://adoptium.net/"",\r\n ""java.version"" ""11.0.22"",\r\n ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",\r\n ""java.vm.version"" ""11.0.22+7"",\r\n ""os.name"" ""Linux"",\r\n ""os.version"" ""5.15.0-94-generic"",\r\n ""user.language"" ""en"",\r\n ""user.timezone"" ""GMT""}\r\n\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.plugins Loading plugins in /plugins...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/xmlparserv2_sans_jaxp_services.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/oraclepki.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/ojdbc11.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/xdb.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/ucp11.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/orai18n.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/rsi.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/simplefan.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/ucp.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/xmlparserv2.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/ons.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/dms.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :snowflake...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :snowflake (parents: [:sql-jdbc]) 🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :redshift...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :redshift (parents: [:postgres]) 🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :sqlite (parents: [:sql-jdbc]) 🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :sqlite...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :presto-jdbc...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :sqlserver...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :druid  🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :druid...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :bigquery-cloud-sdk...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.dependencies Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can\'t ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.\r\n\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.dependencies Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.dependencies Plugins with unsatisfied deps: [""Metabase Vertica Driver""]\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :googleanalytics...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :googleanalytics  🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.dependencies Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? true\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :oracle...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :oracle (parents: [:sql-jdbc]) 🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :hive-like...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :sparksql...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :sparksql (parents: [:hive-like]) 🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :mongo  🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :mongo...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :athena...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :athena (parents: [:sql-jdbc]) 🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.core Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.db.setup Verifying h2 Database Connection ...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:49-03:00 INFO metabase.db.setup Successfully verified H2 2.1.214 (2022-06-13) application database connection. ✅\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:49-03:00 INFO metabase.db.setup Checking if a database downgrade is required...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:49-03:00 INFO metabase.db.setup Running Database Migrations...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:49-03:00 INFO metabase.db.setup Setting up Liquibase...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.db.setup Liquibase is ready.\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.db.liquibase Checking if Database has unrun migrations...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.db.liquibase No unrun migrations found.\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.db.setup Database Migrations Current ...  ✅\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.util Database setup took 1.9 s\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.impl.StdSchedulerFactory Using default implementation for ThreadExecutor\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.core.SchedulerSignalerImpl Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.core.QuartzScheduler Quartz Scheduler v.2.3.2 created.\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.impl.jdbcjobstore.JobStoreTX Using db table-based data access locking (synchronization).\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.impl.jdbcjobstore.JobStoreTX JobStoreTX initialized.\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.impl.StdSchedulerFactory Quartz scheduler \'MetabaseScheduler\' initialized from default resource file in Quartz package: \'quartz.properties\'\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.core.QuartzScheduler Scheduler meta-data: Quartz Scheduler (v2.3.2) \'MetabaseScheduler\' with instanceId \'02cf510249a91713785570587\'\r\n  Scheduler class: \'org.quartz.core.QuartzScheduler\' - running locally.\r\n  NOT STARTED.\r\n  Currently in standby mode.\r\n  Number of jobs executed: 0\r\n  Using thread pool \'org.quartz.simpl.SimpleThreadPool\' - with 10 threads.\r\n  Using job-store \'org.quartz.impl.jdbcjobstore.JobStoreTX\' - which supports persistence. and is clustered.\r\n\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.impl.StdSchedulerFactory Quartz scheduler version: 2.3.2\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.core.QuartzScheduler Scheduler MetabaseScheduler_$_02cf510249a91713785570587 paused.\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Task scheduler initialized into standby mode.\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Initializing task SyncDatabases\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Initializing task PersistRefresh\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task.sync-databases Updated default schedules for %d databases 0\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Inicializando driver :oracle...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Inicializando driver :sql-jdbc...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Inicializando driver :sql...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/oracle.metabase-driver.jar to classpath\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 DEBUG metabase.plugins.init-steps Carregando namespace de plugin metabase.driver.oracle...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Driver abstrato registrado :metabase.driver.sql.query-processor.empty-string-is-null/empty-string-is-null  🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Driver registrado :oracle (pais: [:sql-jdbc :metabase.driver.sql.query-processor.empty-string-is-null/empty-string-is-null]) 🚚\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 DEBUG metabase.plugins.jdbc-proxy Registrando driver de proxy JDBC para oracle.jdbc.OracleDriver...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.util Carregando Metabase driver :oracle took 60.8 ms\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Inicializando driver :metabase.driver.sql.query-processor.empty-string-is-null/empty-string-is-null...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Initializing task CheckForNewVersions\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Initializing task PersistPrune\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Initializing task SendAnonymousUsageStats\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task ModelIndexValues\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task RefreshSlackChannelsAndUsers\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task TruncateAuditTables\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task SendPulses\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task SendFollowUpEmails\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task SendCreatorSentimentEmails\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task TaskHistoryCleanup\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task SendWarnPulseRemovalEmail\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO org.quartz.impl.jdbcjobstore.JobStoreTX ClusterManager: Scanning for instance ""02cf510249a91713783542774""\'s failed in-progress jobs.\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO org.quartz.impl.jdbcjobstore.JobStoreTX ClusterManager: detected 1 failed or restarted instances.\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO org.quartz.core.QuartzScheduler Scheduler MetabaseScheduler_$_02cf510249a91713785570587 started.\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Task scheduler started\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.core Inicialização da metabase COMPLETA em 23.0 s\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task.refresh-slack-channel-user-cache O Slack não está configurado, não será possível atualizar o cache de usuários e canais.\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:33:00-03:00 INFO metabase.driver.impl Inicializando driver :h2...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:23-03:00 INFO metabase.util.i18n.impl Reading available locales from locales.clj...\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:24-03:00 INFO metabase.util.fonts Reading available fonts from /frontend_client/app/fonts\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:25-03:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 137.8 ms (6 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:25-03:00 DEBUG metabase.server.middleware.log GET /api/user/current 200 161.4 ms (10 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:25-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 21.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:27-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 10.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:29-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:31-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 11.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:33-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 10.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:35-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:37-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:39-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:41-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:43-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:45-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:47-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:49-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:51-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:53-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.6 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:55-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:57-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:59-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:01-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:03-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:05-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:07-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:09-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:12-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:14-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:16-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:18-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:20-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 10.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:22-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:24-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:26-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 11.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:28-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:30-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:32-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:34-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:36-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:38-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.2 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:40-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:42-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:44-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:46-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:48-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:50-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:52-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:54-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:57-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:59-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:01-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:03-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:05-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:07-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:09-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:11-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:13-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:15-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:17-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:18-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:19-03:00 DEBUG metabase.server.middleware.log GET /api/database/7 200 25.8 ms (7 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:20-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:22-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.6 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.audit-log 👂\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.driver-notifications 👂\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.last-login 👂\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.persisted-info 👂\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.recent-views 👂\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.revision 👂\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.schema 👂\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.sync-database 👂\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.view-log 👂\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 DEBUG metabase.server.middleware.log POST /api/database/7/sync_schema 200 881.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (39 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.sync.util STARTING: Sync metadata for oracle Database 7 \'\'atm\'\'\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:24-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 27.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (43 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 DEBUG metabase.server.middleware.log POST /api/database/7/rescan_values 200 14.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (44 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util STARTING: Cache field values in oracle Database 7 \'\'atm\'\'\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util FINISHED: step \'\'delete-expired-advanced-field-values\'\' for oracle Database 7 \'\'atm\'\' (595.1 µs)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util STARTING: step \'\'delete-expired-advanced-field-values\'\' for oracle Database 7 \'\'atm\'\'\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util FINISHED: step \'\'update-field-values\'\' for oracle Database 7 \'\'atm\'\' (211.4 µs)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util STARTING: step \'\'update-field-values\'\' for oracle Database 7 \'\'atm\'\'\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util FINISHED: Cache field values in oracle Database 7 \'\'atm\'\' (40.2 ms)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:26-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (45 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:27-03:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 6.0 ms (1 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/group 200 14.1 ms (2 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/2 200 27.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 23:\r\n/collection/namespace/snippets/root/\r\n                      ^\r\nExpected one of:\r\n:end-of-string\r\n""read""\r\n\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 1:\r\n/application/subscription/\r\n^\r\nExpected one of:\r\n""/"" (followed by end-of-string)\r\n""/query/db/""\r\n""/data/db/""\r\n""/collection/""\r\n""/details""\r\n""/data-model""\r\n""/download""\r\n""/block/db/""\r\n""/db/""\r\n""/execute/""\r\n\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/1 200 41.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.6 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:30-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:30-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 23:\r\n/collection/namespace/snippets/root/\r\n                      ^\r\nExpected one of:\r\n:end-of-string\r\n""read""\r\n\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:30-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 1:\r\n/application/subscription/\r\n^\r\nExpected one of:\r\n""/"" (followed by end-of-string)\r\n""/query/db/""\r\n""/data/db/""\r\n""/collection/""\r\n""/details""\r\n""/data-model""\r\n""/download""\r\n""/block/db/""\r\n""/db/""\r\n""/execute/""\r\n\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:30-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/1 200 11.2 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 WARN metabase.sync.util Error in sync step Sync metadata for oracle Database 7 \'\'atm\'\',java.sql.SQLRecoverableException: ORA-17008: Closed connection,https://docs.oracle.com/error-help/db/ora-17008/,\tat oracle.jdbc.driver.OracleStatement.ensureOpen(OracleStatement.java:5225),\tat oracle.jdbc.driver.OracleStatement.clearWarnings(OracleStatement.java:4043),\tat oracle.jdbc.driver.OracleStatement.prepareForNewResults(OracleStatement.java:4672),\tat oracle.jdbc.driver.T4CStatement.prepareForNewResults(T4CStatement.java:146),\tat oracle.jdbc.driver.OracleStatement.endOfResultSet(OracleStatement.java:4808),\tat oracle.jdbc.driver.InsensitiveScrollableResultSet.close(InsensitiveScrollableResultSet.java:307),\tat oracle.jdbc.driver.ForwardOnlyResultSet.close(ForwardOnlyResultSet.java:55),\tat com.mchange.v2.c3p0.impl.NewProxyResultSet.close(NewProxyResultSet.java:852),\tat metabase.driver.sql_jdbc.sync.common$reducible_results$reify__80909.reduce(common.clj:38),\tat clojure.core$transduce.invokeStatic(core.clj:6947),\tat clojure.core.Eduction.reduce(core.clj:7751),\tat clojure.core$transduce.invokeStatic(core.clj:6947),\tat clojure.core.Eduction.reduce(core.clj:7751),\tat clojure.core$reduce.invokeStatic(core.clj:6886),\tat clojure.core$into.invokeStatic(core.clj:6959),\tat clojure.core$into.invoke(core.clj:6951),\tat metabase.driver.sql_jdbc.sync.describe_database$describe_database$fn__81418$default_active_tbl_fn__81419.invoke(describe_database.clj:209),\tat metabase.driver.sql_jdbc.sync.describe_database$describe_database$fn__81418.invoke(describe_database.clj:220),\tat metabase.driver.sql_jdbc.execute$fn__79197$fn__79198.invoke(execute.clj:388),\tat metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334),\tat metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:317),\tat metabase.driver.sql_jdbc.execute$fn__79197.invokeStatic(execute.clj:382),\tat metabase.driver.sql_jdbc.execute$fn__79197.invoke(execute.clj:380),\tat clojure.lang.MultiFn.invoke(MultiFn.java:244),\tat metabase.driver.sql_jdbc.sync.describe_database$describe_database.invokeStatic(describe_database.clj:201),\tat metabase.driver.sql_jdbc.sync.describe_database$describe_database.invoke(describe_database.clj:196),\tat metabase.driver.sql_jdbc$fn__106749.invokeStatic(sql_jdbc.clj:90),\tat metabase.driver.sql_jdbc$fn__106749.invoke(sql_jdbc.clj:88),\tat clojure.lang.MultiFn.invoke(MultiFn.java:234),\tat metabase.sync.fetch_metadata$db_metadata.invokeStatic(fetch_metadata.clj:16),\tat metabase.sync.fetch_metadata$db_metadata.invoke(fetch_metadata.clj:13),\tat metabase.sync.sync_metadata$sync_db_metadata_BANG_$fn__82509.invoke(sync_metadata.clj:69),\tat metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:190),\tat metabase.sync.util$do_with_error_handling.invoke(util.clj:183),\tat clojure.core$partial$fn__5910.invoke(core.clj:2647),\tat metabase.driver$fn__49865.invokeStatic(driver.clj:778),\tat metabase.driver$fn__49865.invoke(driver.clj:778),\tat clojure.lang.MultiFn.invoke(MultiFn.java:239),\tat metabase.sync.util$sync_in_context$fn__60291.invoke(util.clj:166),\tat metabase.sync.util$with_db_logging_disabled$fn__60288.invoke(util.clj:158),\tat metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:131),\tat metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:125),\tat metabase.sync.util$with_start_and_finish_logging$fn__60275.invoke(util.clj:143),\tat metabase.sync.util$with_sync_events$fn__60270.invoke(util.clj:117),\tat metabase.sync.util$with_duplicate_ops_prevented$fn__60257.invoke(util.clj:89),\tat metabase.sync.util$do_sync_operation.invokeStatic(util.clj:215),\tat metabase.sync.util$do_sync_operation.invoke(util.clj:209),\tat metabase.sync.sync_metadata$sync_db_metadata_BANG_.invokeStatic(sync_metadata.clj:68),\tat metabase.sync.sync_metadata$sync_db_metadata_BANG_.invoke(sync_metadata.clj:65),\tat metabase.api.database$fn__98581$fn__98586.invoke(database.clj:999),\tat clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047),\tat clojure.lang.AFn.call(AFn.java:18),\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source),\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),\tat java.base/java.lang.Thread.run(Unknown Source)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util FINISHED: Sync metadata for oracle Database 7 \'\'atm\'\' (8.3 s)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util STARTING: Analyze data for oracle Database 7 \'\'atm\'\'\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util STARTING: step \'\'fingerprint-fields\'\' for oracle Database 7 \'\'atm\'\'\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util FINISHED: step \'\'fingerprint-fields\'\' for oracle Database 7 \'\'atm\'\' (22.8 ms)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util STARTING: step \'\'classify-fields\'\' for oracle Database 7 \'\'atm\'\'\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util FINISHED: step \'\'classify-fields\'\' for oracle Database 7 \'\'atm\'\' (579.1 µs)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util STARTING: step \'\'classify-tables\'\' for oracle Database 7 \'\'atm\'\'\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util FINISHED: step \'\'classify-tables\'\' for oracle Database 7 \'\'atm\'\' (1.4 ms)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 2 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util FINISHED: Analyze data for oracle Database 7 \'\'atm\'\' (40.3 ms)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:33-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/2 200 7.6 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:34-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:36-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.2 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:37-03:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 4.1 ms (1 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:38-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:40-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 6.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:42-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:44-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 6.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:46-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:48-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:50-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 23:\r\n/collection/namespace/snippets/root/\r\n                      ^\r\nExpected one of:\r\n:end-of-string\r\n""read""\r\n\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:50-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/2 200 8.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:50-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 1:\r\n/application/subscription/\r\n^\r\nExpected one of:\r\n""/"" (followed by end-of-string)\r\n""/query/db/""\r\n""/data/db/""\r\n""/collection/""\r\n""/details""\r\n""/data-model""\r\n""/download""\r\n""/block/db/""\r\n""/db/""\r\n""/execute/""\r\n\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:50-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/1 200 11.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:50-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 6.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:51-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/group 200 4.6 ms (2 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:51-03:00 DEBUG metabase.server.middleware.log GET /api/user 200 34.4 ms (4 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:51-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/membership 200 2.9 ms (1 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:52-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:53-03:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 4.0 ms (1 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:54-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)\r\n[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:56-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)', 'created_at': datetime.datetime(2024, 4, 22, 11, 38, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2070000835, 'issue_id': 2256284821, 'author': 'paoliniluis', 'body': 'Your problem is https://support.oracle.com/knowledge/Oracle%20Database%20Products/2774307_1.html, do you have an oracle subscription to check with the vendor what is wrong?\r\n\r\nAlso, I see that there\'s some corruption on the app db:\r\nErro ao parsear árvore de permissões Parse error at line 1, column 1:\r\n/application/subscription/\r\n^\r\nExpected one of:\r\n""/"" (followed by end-of-string)\r\n""/query/db/""\r\n""/data/db/""\r\n""/collection/""\r\n""/details""\r\n""/data-model""\r\n""/download""\r\n""/block/db/""\r\n""/db/""\r\n""/execute/""', 'created_at': datetime.datetime(2024, 4, 22, 15, 55, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2077374487, 'issue_id': 2256284821, 'author': 'gabrielvinicius', 'body': 'The session is being dropped because it is not validated when receiving the loan from the pool.\r\n\r\npool.setValidateConnectionOnBorrow(true);\r\n\r\n![WhatsApp Image 2024-04-24 at 15 24 22](https://github.com/metabase/metabase/assets/13459328/1cefed89-71c0-4bc2-bb80-f579b45e6693)', 'created_at': datetime.datetime(2024, 4, 25, 14, 39, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2077827311, 'issue_id': 2256284821, 'author': 'paoliniluis', 'body': '@gabrielvinicius how do you know that? we do validate the connections on check out\r\n\r\neither way, this seems to be the same as https://github.com/metabase/metabase/issues/36117', 'created_at': datetime.datetime(2024, 4, 25, 17, 45, 23, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 11:25:14 UTC): Please post entire logs

gabrielvinicius (Issue Creator) on (2024-04-22 11:38:57 UTC): [b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.core 
Metabase v0.49.6 (5abf130) 

Copyright © 2024 Metabase, Inc. 

Metabase Enterprise Edition extensions are NOT PRESENT.
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.core Starting Metabase in STANDALONE mode
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.server Launching Embedded Jetty Webserver with config:
 {:port 3000, :host ""0.0.0.0""}

[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.core Starting Metabase version v0.49.6 (5abf130) ...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.core System info:
 {""file.encoding"" ""UTF-8"",
 ""java.runtime.name"" ""OpenJDK Runtime Environment"",
 ""java.runtime.version"" ""11.0.22+7"",
 ""java.vendor"" ""Eclipse Adoptium"",
 ""java.vendor.url"" ""https://adoptium.net/"",
 ""java.version"" ""11.0.22"",
 ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",
 ""java.vm.version"" ""11.0.22+7"",
 ""os.name"" ""Linux"",
 ""os.version"" ""5.15.0-94-generic"",
 ""user.language"" ""en"",
 ""user.timezone"" ""GMT""}

[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:47-03:00 INFO metabase.plugins Loading plugins in /plugins...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/xmlparserv2_sans_jaxp_services.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/oraclepki.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/ojdbc11.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/xdb.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/ucp11.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/orai18n.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/rsi.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/simplefan.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/ucp.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/xmlparserv2.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/ons.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/dms.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :snowflake...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :snowflake (parents: [:sql-jdbc]) 🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :redshift...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :redshift (parents: [:postgres]) 🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :sqlite (parents: [:sql-jdbc]) 🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :sqlite...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :presto-jdbc...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :sqlserver...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :druid  🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :druid...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :bigquery-cloud-sdk...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.dependencies Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.

[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.dependencies Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.dependencies Plugins with unsatisfied deps: [""Metabase Vertica Driver""]
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :googleanalytics...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :googleanalytics  🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.plugins.dependencies Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? true
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :oracle...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :oracle (parents: [:sql-jdbc]) 🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :hive-like...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :sparksql...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :sparksql (parents: [:hive-like]) 🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :mongo  🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :mongo...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 DEBUG metabase.plugins.lazy-loaded-driver Registering lazy loading driver :athena...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.driver.impl Registered driver :athena (parents: [:sql-jdbc]) 🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.core Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:48-03:00 INFO metabase.db.setup Verifying h2 Database Connection ...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:49-03:00 INFO metabase.db.setup Successfully verified H2 2.1.214 (2022-06-13) application database connection. ✅
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:49-03:00 INFO metabase.db.setup Checking if a database downgrade is required...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:49-03:00 INFO metabase.db.setup Running Database Migrations...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:49-03:00 INFO metabase.db.setup Setting up Liquibase...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.db.setup Liquibase is ready.
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.db.liquibase Checking if Database has unrun migrations...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.db.liquibase No unrun migrations found.
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.db.setup Database Migrations Current ...  ✅
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.util Database setup took 1.9 s
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.impl.StdSchedulerFactory Using default implementation for ThreadExecutor
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.core.SchedulerSignalerImpl Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.core.QuartzScheduler Quartz Scheduler v.2.3.2 created.
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.impl.jdbcjobstore.JobStoreTX Using db table-based data access locking (synchronization).
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.impl.jdbcjobstore.JobStoreTX JobStoreTX initialized.
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.impl.StdSchedulerFactory Quartz scheduler 'MetabaseScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.core.QuartzScheduler Scheduler meta-data: Quartz Scheduler (v2.3.2) 'MetabaseScheduler' with instanceId '02cf510249a91713785570587'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.impl.jdbcjobstore.JobStoreTX' - which supports persistence. and is clustered.

[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.impl.StdSchedulerFactory Quartz scheduler version: 2.3.2
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO org.quartz.core.QuartzScheduler Scheduler MetabaseScheduler_$_02cf510249a91713785570587 paused.
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Task scheduler initialized into standby mode.
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Initializing task SyncDatabases
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Initializing task PersistRefresh
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task.sync-databases Updated default schedules for %d databases 0
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Inicializando driver :oracle...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Inicializando driver :sql-jdbc...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Inicializando driver :sql...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.plugins.classloader Added URL file:/plugins/oracle.metabase-driver.jar to classpath
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 DEBUG metabase.plugins.init-steps Carregando namespace de plugin metabase.driver.oracle...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Driver abstrato registrado :metabase.driver.sql.query-processor.empty-string-is-null/empty-string-is-null  🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Driver registrado :oracle (pais: [:sql-jdbc :metabase.driver.sql.query-processor.empty-string-is-null/empty-string-is-null]) 🚚
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 DEBUG metabase.plugins.jdbc-proxy Registrando driver de proxy JDBC para oracle.jdbc.OracleDriver...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.util Carregando Metabase driver :oracle took 60.8 ms
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.driver.impl Inicializando driver :metabase.driver.sql.query-processor.empty-string-is-null/empty-string-is-null...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Initializing task CheckForNewVersions
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Initializing task PersistPrune
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:50-03:00 INFO metabase.task Initializing task SendAnonymousUsageStats
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task ModelIndexValues
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task RefreshSlackChannelsAndUsers
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task TruncateAuditTables
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task SendPulses
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task SendFollowUpEmails
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task SendCreatorSentimentEmails
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task TaskHistoryCleanup
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Initializing task SendWarnPulseRemovalEmail
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO org.quartz.impl.jdbcjobstore.JobStoreTX ClusterManager: Scanning for instance ""02cf510249a91713783542774""'s failed in-progress jobs.
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO org.quartz.impl.jdbcjobstore.JobStoreTX ClusterManager: detected 1 failed or restarted instances.
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO org.quartz.core.QuartzScheduler Scheduler MetabaseScheduler_$_02cf510249a91713785570587 started.
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task Task scheduler started
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.core Inicialização da metabase COMPLETA em 23.0 s
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:32:51-03:00 INFO metabase.task.refresh-slack-channel-user-cache O Slack não está configurado, não será possível atualizar o cache de usuários e canais.
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:33:00-03:00 INFO metabase.driver.impl Inicializando driver :h2...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:23-03:00 INFO metabase.util.i18n.impl Reading available locales from locales.clj...
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:24-03:00 INFO metabase.util.fonts Reading available fonts from /frontend_client/app/fonts
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:25-03:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 137.8 ms (6 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:25-03:00 DEBUG metabase.server.middleware.log GET /api/user/current 200 161.4 ms (10 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:25-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 21.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:27-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 10.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:29-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:31-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 11.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:33-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 10.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:35-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:37-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:39-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:41-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:43-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:45-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:47-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:49-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:51-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:53-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.6 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:55-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:57-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:34:59-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:01-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:03-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:05-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:07-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:09-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:12-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:14-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:16-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:18-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:20-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 10.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:22-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:24-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (0 ocioso, 0 na fila) (37 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:26-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 11.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:28-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:30-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:32-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:34-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:36-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:38-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.2 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:40-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:42-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.5 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:44-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:46-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:48-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:50-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:52-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:54-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (2 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:57-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:35:59-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:01-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:03-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:05-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:07-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:09-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:11-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:13-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:15-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:17-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:18-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:19-03:00 DEBUG metabase.server.middleware.log GET /api/database/7 200 25.8 ms (7 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:20-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:22-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.6 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (35 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.audit-log 👂
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.driver-notifications 👂
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.last-login 👂
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.persisted-info 👂
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.recent-views 👂
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.revision 👂
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.schema 👂
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.sync-database 👂
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.events Carregando namespace de eventos: metabase.events.view-log 👂
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 DEBUG metabase.server.middleware.log POST /api/database/7/sync_schema 200 881.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (39 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:23-03:00 INFO metabase.sync.util STARTING: Sync metadata for oracle Database 7 ''atm''
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:24-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 27.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (43 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 DEBUG metabase.server.middleware.log POST /api/database/7/rescan_values 200 14.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (44 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util STARTING: Cache field values in oracle Database 7 ''atm''
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util FINISHED: step ''delete-expired-advanced-field-values'' for oracle Database 7 ''atm'' (595.1 µs)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util STARTING: step ''delete-expired-advanced-field-values'' for oracle Database 7 ''atm''
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util FINISHED: step ''update-field-values'' for oracle Database 7 ''atm'' (211.4 µs)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util STARTING: step ''update-field-values'' for oracle Database 7 ''atm''
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:25-03:00 INFO metabase.sync.util FINISHED: Cache field values in oracle Database 7 ''atm'' (40.2 ms)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:26-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (45 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:27-03:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 6.0 ms (1 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/group 200 14.1 ms (2 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/2 200 27.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 23:
/collection/namespace/snippets/root/
                      ^
Expected one of:
:end-of-string
""read""

[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 1:
/application/subscription/
^
Expected one of:
""/"" (followed by end-of-string)
""/query/db/""
""/data/db/""
""/collection/""
""/details""
""/data-model""
""/download""
""/block/db/""
""/db/""
""/execute/""

[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/1 200 41.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:28-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.6 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:30-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.7 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:30-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 23:
/collection/namespace/snippets/root/
                      ^
Expected one of:
:end-of-string
""read""

[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:30-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 1:
/application/subscription/
^
Expected one of:
""/"" (followed by end-of-string)
""/query/db/""
""/data/db/""
""/collection/""
""/details""
""/data-model""
""/download""
""/block/db/""
""/db/""
""/execute/""

[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:30-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/1 200 11.2 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 WARN metabase.sync.util Error in sync step Sync metadata for oracle Database 7 ''atm'',java.sql.SQLRecoverableException: ORA-17008: Closed connection,https://docs.oracle.com/error-help/db/ora-17008/,	at oracle.jdbc.driver.OracleStatement.ensureOpen(OracleStatement.java:5225),	at oracle.jdbc.driver.OracleStatement.clearWarnings(OracleStatement.java:4043),	at oracle.jdbc.driver.OracleStatement.prepareForNewResults(OracleStatement.java:4672),	at oracle.jdbc.driver.T4CStatement.prepareForNewResults(T4CStatement.java:146),	at oracle.jdbc.driver.OracleStatement.endOfResultSet(OracleStatement.java:4808),	at oracle.jdbc.driver.InsensitiveScrollableResultSet.close(InsensitiveScrollableResultSet.java:307),	at oracle.jdbc.driver.ForwardOnlyResultSet.close(ForwardOnlyResultSet.java:55),	at com.mchange.v2.c3p0.impl.NewProxyResultSet.close(NewProxyResultSet.java:852),	at metabase.driver.sql_jdbc.sync.common$reducible_results$reify__80909.reduce(common.clj:38),	at clojure.core$transduce.invokeStatic(core.clj:6947),	at clojure.core.Eduction.reduce(core.clj:7751),	at clojure.core$transduce.invokeStatic(core.clj:6947),	at clojure.core.Eduction.reduce(core.clj:7751),	at clojure.core$reduce.invokeStatic(core.clj:6886),	at clojure.core$into.invokeStatic(core.clj:6959),	at clojure.core$into.invoke(core.clj:6951),	at metabase.driver.sql_jdbc.sync.describe_database$describe_database$fn__81418$default_active_tbl_fn__81419.invoke(describe_database.clj:209),	at metabase.driver.sql_jdbc.sync.describe_database$describe_database$fn__81418.invoke(describe_database.clj:220),	at metabase.driver.sql_jdbc.execute$fn__79197$fn__79198.invoke(execute.clj:388),	at metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334),	at metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:317),	at metabase.driver.sql_jdbc.execute$fn__79197.invokeStatic(execute.clj:382),	at metabase.driver.sql_jdbc.execute$fn__79197.invoke(execute.clj:380),	at clojure.lang.MultiFn.invoke(MultiFn.java:244),	at metabase.driver.sql_jdbc.sync.describe_database$describe_database.invokeStatic(describe_database.clj:201),	at metabase.driver.sql_jdbc.sync.describe_database$describe_database.invoke(describe_database.clj:196),	at metabase.driver.sql_jdbc$fn__106749.invokeStatic(sql_jdbc.clj:90),	at metabase.driver.sql_jdbc$fn__106749.invoke(sql_jdbc.clj:88),	at clojure.lang.MultiFn.invoke(MultiFn.java:234),	at metabase.sync.fetch_metadata$db_metadata.invokeStatic(fetch_metadata.clj:16),	at metabase.sync.fetch_metadata$db_metadata.invoke(fetch_metadata.clj:13),	at metabase.sync.sync_metadata$sync_db_metadata_BANG_$fn__82509.invoke(sync_metadata.clj:69),	at metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:190),	at metabase.sync.util$do_with_error_handling.invoke(util.clj:183),	at clojure.core$partial$fn__5910.invoke(core.clj:2647),	at metabase.driver$fn__49865.invokeStatic(driver.clj:778),	at metabase.driver$fn__49865.invoke(driver.clj:778),	at clojure.lang.MultiFn.invoke(MultiFn.java:239),	at metabase.sync.util$sync_in_context$fn__60291.invoke(util.clj:166),	at metabase.sync.util$with_db_logging_disabled$fn__60288.invoke(util.clj:158),	at metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:131),	at metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:125),	at metabase.sync.util$with_start_and_finish_logging$fn__60275.invoke(util.clj:143),	at metabase.sync.util$with_sync_events$fn__60270.invoke(util.clj:117),	at metabase.sync.util$with_duplicate_ops_prevented$fn__60257.invoke(util.clj:89),	at metabase.sync.util$do_sync_operation.invokeStatic(util.clj:215),	at metabase.sync.util$do_sync_operation.invoke(util.clj:209),	at metabase.sync.sync_metadata$sync_db_metadata_BANG_.invokeStatic(sync_metadata.clj:68),	at metabase.sync.sync_metadata$sync_db_metadata_BANG_.invoke(sync_metadata.clj:65),	at metabase.api.database$fn__98581$fn__98586.invoke(database.clj:999),	at clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047),	at clojure.lang.AFn.call(AFn.java:18),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util FINISHED: Sync metadata for oracle Database 7 ''atm'' (8.3 s)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util STARTING: Analyze data for oracle Database 7 ''atm''
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util STARTING: step ''fingerprint-fields'' for oracle Database 7 ''atm''
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util FINISHED: step ''fingerprint-fields'' for oracle Database 7 ''atm'' (22.8 ms)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util STARTING: step ''classify-fields'' for oracle Database 7 ''atm''
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util FINISHED: step ''classify-fields'' for oracle Database 7 ''atm'' (579.1 µs)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util STARTING: step ''classify-tables'' for oracle Database 7 ''atm''
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util FINISHED: step ''classify-tables'' for oracle Database 7 ''atm'' (1.4 ms)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 2 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:32-03:00 INFO metabase.sync.util FINISHED: Analyze data for oracle Database 7 ''atm'' (40.3 ms)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:33-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/2 200 7.6 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:34-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:36-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.2 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:37-03:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 4.1 ms (1 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:38-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 9.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:40-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 6.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:42-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.0 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:44-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 6.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:46-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:48-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:50-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 23:
/collection/namespace/snippets/root/
                      ^
Expected one of:
:end-of-string
""read""

[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:50-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/2 200 8.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:50-03:00 ERROR metabase.models.permissions.parse Erro ao parsear árvore de permissões Parse error at line 1, column 1:
/application/subscription/
^
Expected one of:
""/"" (followed by end-of-string)
""/query/db/""
""/data/db/""
""/collection/""
""/details""
""/data-model""
""/download""
""/block/db/""
""/db/""
""/execute/""

[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:50-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/1 200 11.1 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:50-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 6.8 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:51-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/group 200 4.6 ms (2 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:51-03:00 DEBUG metabase.server.middleware.log GET /api/user 200 34.4 ms (4 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:51-03:00 DEBUG metabase.server.middleware.log GET /api/permissions/membership 200 2.9 ms (1 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:52-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.9 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:53-03:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 4.0 ms (1 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:54-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.4 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 6 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)
[b9a871da-c1de-4368-acd4-0bf0cf49b351] 2024-04-22T08:36:56-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.3 ms (3 chamadas ao banco de dados) Conexões com o banco de dados: 1 / 4 Threads do Jetty: 5 / 50 (1 ocioso, 0 na fila) (46 total de threads ativas) Consultas ativas: 0 (0 na fila)

paoliniluis on (2024-04-22 15:55:40 UTC): Your problem is https://support.oracle.com/knowledge/Oracle%20Database%20Products/2774307_1.html, do you have an oracle subscription to check with the vendor what is wrong?

Also, I see that there's some corruption on the app db:
Erro ao parsear árvore de permissões Parse error at line 1, column 1:
/application/subscription/
^
Expected one of:
""/"" (followed by end-of-string)
""/query/db/""
""/data/db/""
""/collection/""
""/details""
""/data-model""
""/download""
""/block/db/""
""/db/""
""/execute/""

gabrielvinicius (Issue Creator) on (2024-04-25 14:39:44 UTC): The session is being dropped because it is not validated when receiving the loan from the pool.

pool.setValidateConnectionOnBorrow(true);

![WhatsApp Image 2024-04-24 at 15 24 22](https://github.com/metabase/metabase/assets/13459328/1cefed89-71c0-4bc2-bb80-f579b45e6693)

paoliniluis on (2024-04-25 17:45:23 UTC): @gabrielvinicius how do you know that? we do validate the connections on check out

either way, this seems to be the same as https://github.com/metabase/metabase/issues/36117

"
2256106447,issue,closed,completed,Create app skeleton for embedding demo with app shell & routing,,heypoom,2024-04-22 09:57:45+00:00,['heypoom'],2024-04-24 08:23:04+00:00,2024-04-24 08:23:04+00:00,https://github.com/metabase/metabase/issues/41679,[],[],
2256100682,issue,closed,completed,[Epic] Demo Application for the Embedding SDK,"**Links**
- [📙 Product Document](https://www.notion.so/metabase/SDK-demo-app-81b34d07d573474fab810bf33e033fa5?pvs=4)

**Implementation Plan**

***Milestone 1***

```[tasklist]
### Analytics in Product List
- [x] https://github.com/metabase/metabase/issues/41679
- [x] https://github.com/metabase/metabase/issues/41696
- [x] https://github.com/metabase/metabase/issues/41732
- [x] Create product list page
- [x] Add static questions on order trends to the product list page (without drill-down)
```

***Milestone 2***
```[tasklist]
### Analytics in Product Detail
- [x] Create product detail analytics page
- [x] Embed a single ""orders over time"" interactive question with drill-down support
```

***Milestone 3***
> Depends on the availability of theming in the embedding SDK.

```[tasklist]
### Theming
- [x] Customize the fonts and color of the SDK components
```

***Milestone 4***
> Depends on the availability of dashboard embedding in the embedding SDK.

```[tasklist]
### Static Analytics Dashboard
- [x] Embed demo dashboards statically in the analytics section
```

***Milestone 5***
> Depends on the availability of interactive dashboards with drill-downs in the embedding SDK.

```[tasklist]
### Dashboard Drill-down
- [x] Implement interactive drill-down functionality in embedded dashboards
```

***Milestone 6***
> Depends on the support of multiple interactive questions in the embedding SDK.

```[tasklist]
### Multiple Interactive Questions
- [x] Add multiple interactive questions to the product detail page
```",heypoom,2024-04-22 09:55:06+00:00,[],2024-11-22 09:34:03+00:00,2024-11-22 09:33:49+00:00,https://github.com/metabase/metabase/issues/41678,"[('.Epic', 'Feature Implementation or Project')]",[],
2255639484,issue,open,,"Dedicated data storytelling infrastructure (originally ""blogging in Metabase"")","I'm sure you might be thinking _""haven't you heard of Wordpress!?""_ and I can imagine that you want to stay focused on what you do so well, but let me just chip in with what I think would bring crazy additional value to Metabase however it could be achieved: a built-in blogging functionality and a little frontend scaffolding to make it truly a self-contained data universe.

**Describe the solution you'd like**

I can see this sitting very naturally alongside the dashboard functionality and being very valuable when data teams are presenting internally or (in my use case, and I think this can be done well) when sharing some of the data that's behind authentication (in the ""Metaverse if you will!"") externally. Taking the data storytelling that Metabase does so well and putting a few words around it.

The ""website builder"" could be simply a static homepage generator which would automatically display for non-authenticated users (ie, the world at large) while those who are registered or want to register are directed towards a login. An obvious ""nice to have"" here would be the ability to embed any dashboard or embeddable object that's been created on the backend.

For example, an easy homepage template might be ""our last ten dashboards"" (filtering on those that are configured for public access).

**Describe alternatives you've considered**

The public dashboards are great but my mind turns to ""how can I take these standalone resources and bring them into something that connects the dots?"" And then I think about integrating all these visuals into a CMS. That's fine but I wonder if a frontend could do this.

**How important is this feature to you?**

I'm an open-source user attempting a very experimentary implementation for the purpose of creating an open access shared dataset visualisation library (sorry, that was a bit of a mouthful). In this use-case that's more storytelling than business data analysis quite important. For others, probably a lot less so.

**Additional context**

None. Enjoy Metabase a lot and think it's rather in unique in making data fun and friendly. The creative part of my brain naturally jumps to what other storytelling elements could be layered in!
",danielrosehill,2024-04-22 05:51:23+00:00,[],2025-02-04 20:30:56+00:00,,https://github.com/metabase/metabase/issues/41676,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted')]","[{'comment_id': 2068607273, 'issue_id': 2255639484, 'author': 'paoliniluis', 'body': 'So you want something that can help you tell stories about the data, is that correct?', 'created_at': datetime.datetime(2024, 4, 22, 6, 44, 11, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 06:44:11 UTC): So you want something that can help you tell stories about the data, is that correct?

"
2255282170,issue,closed,completed,Error Listing Dashboards in Modal (ex. Pick a dashboard to link to),"### Describe the bug

When I try to list dashboards in the modal view (for example when picking a dashboard to link from a question on a dashboard) an error occurs with the following message (below). This error started to appear when I upgrade to Metabase 0.49.6 OSS.

```Error executing SQL query: ERROR: failed to find conversion function from unknown to text SELECT * FROM ( SELECT 1 AS ""model_ranking"", ""d"".""id"", ""d"".""name"", ""d"".""description"", ""d"".""entity_id"", NULL AS ""display"", CAST(NULL AS boolean) AS ""collection_preview"", NULL AS ""dataset_query"", 'dashboard' AS ""model"", ""d"".""collection_position"", NULL AS ""authority_level"", CAST(NULL AS integer) AS ""personal_owner_id"", ""u"".""email"" AS ""last_edit_email"", ""u"".""first_name"" AS ""last_edit_first_name"", ""u"".""last_name"" AS ""last_edit_last_name"", NULL AS ""moderated_status"", NULL AS ""icon"", ""u"".""id"" AS ""last_edit_user"", ""r"".""timestamp"" AS ""last_edit_timestamp"", CAST(NULL AS integer) AS ""database_id"", NULL AS ""collection_type"", CAST(NULL AS integer) AS ""table_id"", CAST(NULL AS boolean) AS ""is_upload"", NULL AS ""query_type"" FROM ""report_dashboard"" AS ""d"" LEFT JOIN ""revision"" AS ""r"" ON (""r"".""model_id"" = ""d"".""id"") AND (""r"".""most_recent"" = TRUE) AND (""r"".""model"" = 'Dashboard') LEFT JOIN ""core_user"" AS ""u"" ON ""u"".""id"" = ""r"".""user_id"" WHERE (""collection_id"" = ?) AND (""archived"" = FALSE) AND (1 = 1) ) AS ""dummy_alias"" ORDER BY ( CASE WHEN ""authority_level"" = ? THEN ? ELSE ? END ) ASC, ( CASE WHEN ""collection_type"" IS NULL THEN ? ELSE ? END ) ASC, LOWER(""name"") ASC```

<img width=""200"" alt=""Screenshot 2024-04-21 at 4 51 30 PM"" src=""https://github.com/metabase/metabase/assets/44938179/f19cf343-3a58-4c50-927d-4a4d444ad46e"">

The error does not appear when the same modal is listing questions:

<img width=""200"" alt=""Screenshot 2024-04-21 at 4 52 19 PM"" src=""https://github.com/metabase/metabase/assets/44938179/c0766906-e7c2-48cd-bc5e-b5a4f6ddc889"">


### To Reproduce

The issue began to appear after upgrading to 0.49.6 from 0.47.

### Expected behavior

_No response_

### Logs

```
[82bc64df-e4f6-4433-8204-34fd4ab572ce] 2024-04-21T16:52:04-05:00 ERROR metabase.server.middleware.log GET /api/collection/root/items 500 24.4 ms (4 DB calls) 
{:via
 [{:type clojure.lang.ExceptionInfo,
   :message
   ""Error executing SQL query: ERROR: failed to find conversion function from unknown to text\n\nSELECT\n  *\nFROM\n  (\n    SELECT\n      1 AS \""model_ranking\"",\n      \""d\"".\""id\"",\n      \""d\"".\""name\"",\n      \""d\"".\""description\"",\n      \""d\"".\""entity_id\"",\n      NULL AS \""display\"",\n      CAST(NULL AS boolean) AS \""collection_preview\"",\n      NULL AS \""dataset_query\"",\n      'dashboard' AS \""model\"",\n      \""d\"".\""collection_position\"",\n      NULL AS \""authority_level\"",\n      CAST(NULL AS integer) AS \""personal_owner_id\"",\n      \""u\"".\""email\"" AS \""last_edit_email\"",\n      \""u\"".\""first_name\"" AS \""last_edit_first_name\"",\n      \""u\"".\""last_name\"" AS \""last_edit_last_name\"",\n      NULL AS \""moderated_status\"",\n      NULL AS \""icon\"",\n      \""u\"".\""id\"" AS \""last_edit_user\"",\n      \""r\"".\""timestamp\"" AS \""last_edit_timestamp\"",\n      CAST(NULL AS integer) AS \""database_id\"",\n      NULL AS \""collection_type\"",\n      CAST(NULL AS integer) AS \""table_id\"",\n      CAST(NULL AS boolean) AS \""is_upload\"",\n      NULL AS \""query_type\""\n    FROM\n      \""report_dashboard\"" AS \""d\""\n      LEFT JOIN \""revision\"" AS \""r\"" ON (\""r\"".\""model_id\"" = \""d\"".\""id\"")\n      AND (\""r\"".\""most_recent\"" = TRUE)\n      AND (\""r\"".\""model\"" = 'Dashboard')\n      LEFT JOIN \""core_user\"" AS \""u\"" ON \""u\"".\""id\"" = \""r\"".\""user_id\""\n    WHERE\n      (\""collection_id\"" IS NULL)\n      AND (\""archived\"" = FALSE)\n      AND (1 = 1)\n  ) AS \""dummy_alias\""\nORDER BY\n  (\n    CASE\n      WHEN \""authority_level\"" = ? THEN ?\n      ELSE ?\n    END\n  ) ASC,\n  (\n    CASE\n      WHEN \""collection_type\"" IS NULL THEN ?\n      ELSE ?\n    END\n  ) ASC,\n  LOWER(\""name\"") ASC"",
   :data
   {:sql
    [""SELECT""
     ""  *""
     ""FROM""
     ""  (""
     ""    SELECT""
     ""      1 AS \""model_ranking\"",""
     ""      \""d\"".\""id\"",""
     ""      \""d\"".\""name\"",""
     ""      \""d\"".\""description\"",""
     ""      \""d\"".\""entity_id\"",""
     ""      NULL AS \""display\"",""
     ""      CAST(NULL AS boolean) AS \""collection_preview\"",""
     ""      NULL AS \""dataset_query\"",""
     ""      'dashboard' AS \""model\"",""
     ""      \""d\"".\""collection_position\"",""
     ""      NULL AS \""authority_level\"",""
     ""      CAST(NULL AS integer) AS \""personal_owner_id\"",""
     ""      \""u\"".\""email\"" AS \""last_edit_email\"",""
     ""      \""u\"".\""first_name\"" AS \""last_edit_first_name\"",""
     ""      \""u\"".\""last_name\"" AS \""last_edit_last_name\"",""
     ""      NULL AS \""moderated_status\"",""
     ""      NULL AS \""icon\"",""
     ""      \""u\"".\""id\"" AS \""last_edit_user\"",""
     ""      \""r\"".\""timestamp\"" AS \""last_edit_timestamp\"",""
     ""      CAST(NULL AS integer) AS \""database_id\"",""
     ""      NULL AS \""collection_type\"",""
     ""      CAST(NULL AS integer) AS \""table_id\"",""
     ""      CAST(NULL AS boolean) AS \""is_upload\"",""
     ""      NULL AS \""query_type\""""
     ""    FROM""
     ""      \""report_dashboard\"" AS \""d\""""
     ""      LEFT JOIN \""revision\"" AS \""r\"" ON (\""r\"".\""model_id\"" = \""d\"".\""id\"")""
     ""      AND (\""r\"".\""most_recent\"" = TRUE)""
     ""      AND (\""r\"".\""model\"" = 'Dashboard')""
     ""      LEFT JOIN \""core_user\"" AS \""u\"" ON \""u\"".\""id\"" = \""r\"".\""user_id\""""
     ""    WHERE""
     ""      (\""collection_id\"" IS NULL)""
     ""      AND (\""archived\"" = FALSE)""
     ""      AND (1 = 1)""
     ""  ) AS \""dummy_alias\""""
     ""ORDER BY""
     ""  (""
     ""    CASE""
     ""      WHEN \""authority_level\"" = ? THEN ?""
     ""      ELSE ?""
     ""    END""
     ""  ) ASC,""
     ""  (""
     ""    CASE""
     ""      WHEN \""collection_type\"" IS NULL THEN ?""
     ""      ELSE ?""
     ""    END""
     ""  ) ASC,""
     ""  LOWER(\""name\"") ASC""],
    :args (""official"" 0 1 0 1),
    :uncompiled
    {:select [:*],
     :from
     [[{:union-all
        ({:select
          ([[:inline 1] :model_ranking]
           :d.id
           :d.name
           :d.description
           :d.entity_id
           [nil :display]
           [[:metabase.util.honey-sql-2/typed [:cast nil [:raw ""boolean""]] {:database-type ""boolean""}]
            :collection_preview]
           [nil :dataset_query]
           [[:metabase.util.honey-sql-2/literal ""dashboard""] :model]
           :d.collection_position
           [nil :authority_level]
           [[:metabase.util.honey-sql-2/typed [:cast nil [:raw ""integer""]] {:database-type ""integer""}]
            :personal_owner_id]
           [:u.email :last_edit_email]
           [:u.first_name :last_edit_first_name]
           [:u.last_name :last_edit_last_name]
           [nil :moderated_status]
           [nil :icon]
           [:u.id :last_edit_user]
           [:r.timestamp :last_edit_timestamp]
           [[:metabase.util.honey-sql-2/typed [:cast nil [:raw ""integer""]] {:database-type ""integer""}] :database_id]
           [nil :collection_type]
           [[:metabase.util.honey-sql-2/typed [:cast nil [:raw ""integer""]] {:database-type ""integer""}] :table_id]
           [[:metabase.util.honey-sql-2/typed [:cast nil [:raw ""boolean""]] {:database-type ""boolean""}] :is_upload]
           [nil :query_type]),
          :from [[:report_dashboard :d]],
          :left-join
          [[:revision :r]
           [:and
            [:= :r.model_id :d.id]
            [:= :r.most_recent true]
            [:= :r.model [:metabase.util.honey-sql-2/literal ""Dashboard""]]]
           [:core_user :u]
           [:= :u.id :r.user_id]],
          :where [:and [:= :collection_id nil] [:= :archived false] [:= [:inline 1] [:inline 1]]]})}
       :dummy_alias]],
     :order-by
     [[[[:case [:= :authority_level ""official""] 0 :else 1]] :asc]
      [[[:case [:= :collection_type nil] 0 :else 1]] :asc]
      [:%lower.name :asc]]}},
   :at [metabase.db.query$query invokeStatic ""query.clj"" 91]}
  {:type clojure.lang.ExceptionInfo,
   :message ""ERROR: failed to find conversion function from unknown to text"",
   :data
   {:toucan2/context-trace
    [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection""
      {:toucan2.jdbc.query/sql-args
       [""SELECT * FROM (SELECT 1 AS \""model_ranking\"", \""d\"".\""id\"", \""d\"".\""name\"", \""d\"".\""description\"", \""d\"".\""entity_id\"", NULL AS \""display\"", CAST(NULL AS boolean) AS \""collection_preview\"", NULL AS \""dataset_query\"", 'dashboard' AS \""model\"", \""d\"".\""collection_position\"", NULL AS \""authority_level\"", CAST(NULL AS integer) AS \""personal_owner_id\"", \""u\"".\""email\"" AS \""last_edit_email\"", \""u\"".\""first_name\"" AS \""last_edit_first_name\"", \""u\"".\""last_name\"" AS \""last_edit_last_name\"", NULL AS \""moderated_status\"", NULL AS \""icon\"", \""u\"".\""id\"" AS \""last_edit_user\"", \""r\"".\""timestamp\"" AS \""last_edit_timestamp\"", CAST(NULL AS integer) AS \""database_id\"", NULL AS \""collection_type\"", CAST(NULL AS integer) AS \""table_id\"", CAST(NULL AS boolean) AS \""is_upload\"", NULL AS \""query_type\"" FROM \""report_dashboard\"" AS \""d\"" LEFT JOIN \""revision\"" AS \""r\"" ON (\""r\"".\""model_id\"" = \""d\"".\""id\"") AND (\""r\"".\""most_recent\"" = TRUE) AND (\""r\"".\""model\"" = 'Dashboard') LEFT JOIN \""core_user\"" AS \""u\"" ON \""u\"".\""id\"" = \""r\"".\""user_id\"" WHERE (\""collection_id\"" IS NULL) AND (\""archived\"" = FALSE) AND (1 = 1)) AS \""dummy_alias\"" ORDER BY (CASE WHEN \""authority_level\"" = ? THEN ? ELSE ? END) ASC, (CASE WHEN \""collection_type\"" IS NULL THEN ? ELSE ? END) ASC, LOWER(\""name\"") ASC""
        ""official""
        0
        1
        0
        1]}]
     [""resolve connection"" {:toucan2.connection/connectable metabase.db.connection.ApplicationDB}]
     [""resolve connection"" {:toucan2.connection/connectable :default}]
     [""resolve connection"" {:toucan2.connection/connectable nil}]
     {:toucan2.pipeline/rf
      #object[clojure.core$map$fn__5931$fn__5932 0x4f8ad233 ""clojure.core$map$fn__5931$fn__5932@4f8ad233""]}
     [""with compiled query""
      {:toucan2.pipeline/compiled-query
       [""SELECT * FROM (SELECT 1 AS \""model_ranking\"", \""d\"".\""id\"", \""d\"".\""name\"", \""d\"".\""description\"", \""d\"".\""entity_id\"", NULL AS \""display\"", CAST(NULL AS boolean) AS \""collection_preview\"", NULL AS \""dataset_query\"", 'dashboard' AS \""model\"", \""d\"".\""collection_position\"", NULL AS \""authority_level\"", CAST(NULL AS integer) AS \""personal_owner_id\"", \""u\"".\""email\"" AS \""last_edit_email\"", \""u\"".\""first_name\"" AS \""last_edit_first_name\"", \""u\"".\""last_name\"" AS \""last_edit_last_name\"", NULL AS \""moderated_status\"", NULL AS \""icon\"", \""u\"".\""id\"" AS \""last_edit_user\"", \""r\"".\""timestamp\"" AS \""last_edit_timestamp\"", CAST(NULL AS integer) AS \""database_id\"", NULL AS \""collection_type\"", CAST(NULL AS integer) AS \""table_id\"", CAST(NULL AS boolean) AS \""is_upload\"", NULL AS \""query_type\"" FROM \""report_dashboard\"" AS \""d\"" LEFT JOIN \""revision\"" AS \""r\"" ON (\""r\"".\""model_id\"" = \""d\"".\""id\"") AND (\""r\"".\""most_recent\"" = TRUE) AND (\""r\"".\""model\"" = 'Dashboard') LEFT JOIN \""core_user\"" AS \""u\"" ON \""u\"".\""id\"" = \""r\"".\""user_id\"" WHERE (\""collection_id\"" IS NULL) AND (\""archived\"" = FALSE) AND (1 = 1)) AS \""dummy_alias\"" ORDER BY (CASE WHEN \""authority_level\"" = ? THEN ? ELSE ? END) ASC, (CASE WHEN \""collection_type\"" IS NULL THEN ? ELSE ? END) ASC, LOWER(\""name\"") ASC""
        ""official""
        0
        1
        0
        1]}]
     [""with built query""
      {:toucan2.pipeline/built-query
       [""SELECT * FROM (SELECT 1 AS \""model_ranking\"", \""d\"".\""id\"", \""d\"".\""name\"", \""d\"".\""description\"", \""d\"".\""entity_id\"", NULL AS \""display\"", CAST(NULL AS boolean) AS \""collection_preview\"", NULL AS \""dataset_query\"", 'dashboard' AS \""model\"", \""d\"".\""collection_position\"", NULL AS \""authority_level\"", CAST(NULL AS integer) AS \""personal_owner_id\"", \""u\"".\""email\"" AS \""last_edit_email\"", \""u\"".\""first_name\"" AS \""last_edit_first_name\"", \""u\"".\""last_name\"" AS \""last_edit_last_name\"", NULL AS \""moderated_status\"", NULL AS \""icon\"", \""u\"".\""id\"" AS \""last_edit_user\"", \""r\"".\""timestamp\"" AS \""last_edit_timestamp\"", CAST(NULL AS integer) AS \""database_id\"", NULL AS \""collection_type\"", CAST(NULL AS integer) AS \""table_id\"", CAST(NULL AS boolean) AS \""is_upload\"", NULL AS \""query_type\"" FROM \""report_dashboard\"" AS \""d\"" LEFT JOIN \""revision\"" AS \""r\"" ON (\""r\"".\""model_id\"" = \""d\"".\""id\"") AND (\""r\"".\""most_recent\"" = TRUE) AND (\""r\"".\""model\"" = 'Dashboard') LEFT JOIN \""core_user\"" AS \""u\"" ON \""u\"".\""id\"" = \""r\"".\""user_id\"" WHERE (\""collection_id\"" IS NULL) AND (\""archived\"" = FALSE) AND (1 = 1)) AS \""dummy_alias\"" ORDER BY (CASE WHEN \""authority_level\"" = ? THEN ? ELSE ? END) ASC, (CASE WHEN \""collection_type\"" IS NULL THEN ? ELSE ? END) ASC, LOWER(\""name\"") ASC""
        ""official""
        0
        1
        0
        1]}]
     [""with resolved query""
      {:toucan2.pipeline/resolved-query
       [""SELECT * FROM (SELECT 1 AS \""model_ranking\"", \""d\"".\""id\"", \""d\"".\""name\"", \""d\"".\""description\"", \""d\"".\""entity_id\"", NULL AS \""display\"", CAST(NULL AS boolean) AS \""collection_preview\"", NULL AS \""dataset_query\"", 'dashboard' AS \""model\"", \""d\"".\""collection_position\"", NULL AS \""authority_level\"", CAST(NULL AS integer) AS \""personal_owner_id\"", \""u\"".\""email\"" AS \""last_edit_email\"", \""u\"".\""first_name\"" AS \""last_edit_first_name\"", \""u\"".\""last_name\"" AS \""last_edit_last_name\"", NULL AS \""moderated_status\"", NULL AS \""icon\"", \""u\"".\""id\"" AS \""last_edit_user\"", \""r\"".\""timestamp\"" AS \""last_edit_timestamp\"", CAST(NULL AS integer) AS \""database_id\"", NULL AS \""collection_type\"", CAST(NULL AS integer) AS \""table_id\"", CAST(NULL AS boolean) AS \""is_upload\"", NULL AS \""query_type\"" FROM \""report_dashboard\"" AS \""d\"" LEFT JOIN \""revision\"" AS \""r\"" ON (\""r\"".\""model_id\"" = \""d\"".\""id\"") AND (\""r\"".\""most_recent\"" = TRUE) AND (\""r\"".\""model\"" = 'Dashboard') LEFT JOIN \""core_user\"" AS \""u\"" ON \""u\"".\""id\"" = \""r\"".\""user_id\"" WHERE (\""collection_id\"" IS NULL) AND (\""archived\"" = FALSE) AND (1 = 1)) AS \""dummy_alias\"" ORDER BY (CASE WHEN \""authority_level\"" = ? THEN ? ELSE ? END) ASC, (CASE WHEN \""collection_type\"" IS NULL THEN ? ELSE ? END) ASC, LOWER(\""name\"") ASC""
        ""official""
        0
        1
        0
        1]}]
     [""with parsed args""
      {:toucan2.pipeline/query-type :toucan.result-type/*,
       :toucan2.pipeline/parsed-args
       {:connectable nil,
        :queryable
        [""SELECT * FROM (SELECT 1 AS \""model_ranking\"", \""d\"".\""id\"", \""d\"".\""name\"", \""d\"".\""description\"", \""d\"".\""entity_id\"", NULL AS \""display\"", CAST(NULL AS boolean) AS \""collection_preview\"", NULL AS \""dataset_query\"", 'dashboard' AS \""model\"", \""d\"".\""collection_position\"", NULL AS \""authority_level\"", CAST(NULL AS integer) AS \""personal_owner_id\"", \""u\"".\""email\"" AS \""last_edit_email\"", \""u\"".\""first_name\"" AS \""last_edit_first_name\"", \""u\"".\""last_name\"" AS \""last_edit_last_name\"", NULL AS \""moderated_status\"", NULL AS \""icon\"", \""u\"".\""id\"" AS \""last_edit_user\"", \""r\"".\""timestamp\"" AS \""last_edit_timestamp\"", CAST(NULL AS integer) AS \""database_id\"", NULL AS \""collection_type\"", CAST(NULL AS integer) AS \""table_id\"", CAST(NULL AS boolean) AS \""is_upload\"", NULL AS \""query_type\"" FROM \""report_dashboard\"" AS \""d\"" LEFT JOIN \""revision\"" AS \""r\"" ON (\""r\"".\""model_id\"" = \""d\"".\""id\"") AND (\""r\"".\""most_recent\"" = TRUE) AND (\""r\"".\""model\"" = 'Dashboard') LEFT JOIN \""core_user\"" AS \""u\"" ON \""u\"".\""id\"" = \""r\"".\""user_id\"" WHERE (\""collection_id\"" IS NULL) AND (\""archived\"" = FALSE) AND (1 = 1)) AS \""dummy_alias\"" ORDER BY (CASE WHEN \""authority_level\"" = ? THEN ? ELSE ? END) ASC, (CASE WHEN \""collection_type\"" IS NULL THEN ? ELSE ? END) ASC, LOWER(\""name\"") ASC""
         ""official""
         0
         1
         0
         1]}}]
     [""with model"" {:toucan2.pipeline/model nil}]]},
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse ""QueryExecutorImpl.java"" 2725]}
  {:type org.postgresql.util.PSQLException,
   :message ""ERROR: failed to find conversion function from unknown to text"",
   :at [org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse ""QueryExecutorImpl.java"" 2725]}],
 :trace
 [[org.postgresql.core.v3.QueryExecutorImpl receiveErrorResponse ""QueryExecutorImpl.java"" 2725]
  [org.postgresql.core.v3.QueryExecutorImpl processResults ""QueryExecutorImpl.java"" 2412]
  [org.postgresql.core.v3.QueryExecutorImpl execute ""QueryExecutorImpl.java"" 371]
  [org.postgresql.jdbc.PgStatement executeInternal ""PgStatement.java"" 502]
  [org.postgresql.jdbc.PgStatement execute ""PgStatement.java"" 419]
  [org.postgresql.jdbc.PgPreparedStatement executeWithFlags ""PgPreparedStatement.java"" 194]
  [org.postgresql.jdbc.PgPreparedStatement execute ""PgPreparedStatement.java"" 180]
  [com.mchange.v2.c3p0.impl.NewProxyPreparedStatement execute ""NewProxyPreparedStatement.java"" 67]
  [toucan2.jdbc.query$reduce_jdbc_query invokeStatic ""query.clj"" 40]
  [toucan2.jdbc.query$reduce_jdbc_query invoke ""query.clj"" 22]
  [toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default
   invokeStatic
   ""pipeline.clj""
   19]
  [toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default
   invoke
   ""pipeline.clj""
   9]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 178]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$partial$fn__5908 doInvoke ""core.clj"" 2639]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18237 invoke ""threaded.clj"" 79]
  [methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18199 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 doInvoke ""core.clj"" 2589]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18209 doInvoke ""threaded.clj"" 46]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 151]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 65]
  [methodical.impl.standard$invoke_multifn doInvoke ""standard.clj"" 47]
  [clojure.lang.RestFn invoke ""RestFn.java"" 594]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 199]
  [toucan2.pipeline$transduce_execute$with_connection_STAR___21462 invoke ""pipeline.clj"" 78]
  [toucan2.connection$bind_current_connectable_fn$fn__21139 invoke ""connection.clj"" 104]
  [toucan2.connection$bind_current_connectable_fn$fn__21139 invoke ""connection.clj"" 104]
  [toucan2.connection$bind_current_connectable_fn$fn__21139 invoke ""connection.clj"" 104]
  [toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource invokeStatic ""connection.clj"" 18]
  [toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource invoke ""connection.clj"" 15]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18231 invoke ""threaded.clj"" 70]
  [methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18199 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 invoke ""core.clj"" 2587]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18209 invoke ""threaded.clj"" 43]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invokeStatic ""connection.clj"" 118]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invoke ""connection.clj"" 106]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 55]
  [methodical.impl.standard$invoke_multifn invoke ""standard.clj"" 47]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 193]
  [metabase.db.connection$do_with_connection_primary_method_default invokeStatic ""connection.clj"" 142]
  [metabase.db.connection$do_with_connection_primary_method_default invoke ""connection.clj"" 140]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18231 invoke ""threaded.clj"" 70]
  [methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18199 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 invoke ""core.clj"" 2587]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18209 invoke ""threaded.clj"" 43]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invokeStatic ""connection.clj"" 118]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invoke ""connection.clj"" 106]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 55]
  [methodical.impl.standard$invoke_multifn invoke ""standard.clj"" 47]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 193]
  [toucan2.connection$do_with_connection_primary_method_ invokeStatic ""connection.clj"" 204]
  [toucan2.connection$do_with_connection_primary_method_ invoke ""connection.clj"" 194]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18231 invoke ""threaded.clj"" 70]
  [methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18199 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 invoke ""core.clj"" 2587]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18209 invoke ""threaded.clj"" 43]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invokeStatic ""connection.clj"" 118]
  [toucan2.connection$do_with_connection_around_method_toucan2_connection_default invoke ""connection.clj"" 106]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2642]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 156]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 132]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn invoke ""RestFn.java"" 421]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 55]
  [methodical.impl.standard$invoke_multifn invoke ""standard.clj"" 47]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 193]
  [toucan2.pipeline$transduce_execute invokeStatic ""pipeline.clj"" 77]
  [toucan2.pipeline$transduce_execute invoke ""pipeline.clj"" 64]
  [clojure.lang.Var invoke ""Var.java"" 399]
  [toucan2.pipeline$transduce_compiled_query invokeStatic ""pipeline.clj"" 244]
  [toucan2.pipeline$transduce_compiled_query invoke ""pipeline.clj"" 240]
  [toucan2.pipeline$transduce_built_query invokeStatic ""pipeline.clj"" 252]
  [toucan2.pipeline$transduce_built_query invoke ""pipeline.clj"" 246]
  [toucan2.pipeline$transduce_query_primary_method_default invokeStatic ""pipeline.clj"" 272]
  [toucan2.pipeline$transduce_query_primary_method_default invoke ""pipeline.clj"" 269]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 178]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$partial$fn__5908 doInvoke ""core.clj"" 2639]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [methodical.impl.combo.threaded$fn__18229$fn__18230$fn__18237 invoke ""threaded.clj"" 79]
  [methodical.impl.combo.threaded$reducer_fn$fn__18199$fn__18203 invoke ""threaded.clj"" 23]
  [clojure.lang.ArrayChunk reduce ""ArrayChunk.java"" 58]
  [clojure.core.protocols$fn__8244 invokeStatic ""protocols.clj"" 136]
  [clojure.core.protocols$fn__8244 invoke ""protocols.clj"" 124]
  [clojure.core.protocols$fn__8204$G__8199__8213 invoke ""protocols.clj"" 19]
  [clojure.core.protocols$seq_reduce invokeStatic ""protocols.clj"" 31]
  [clojure.core.protocols$fn__8236 invokeStatic ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8236 invoke ""protocols.clj"" 75]
  [clojure.core.protocols$fn__8178$G__8173__8191 invoke ""protocols.clj"" 13]
  [clojure.core$reduce invokeStatic ""core.clj"" 6887]
  [clojure.core$reduce invoke ""core.clj"" 6869]
  [methodical.impl.combo.threaded$reducer_fn$fn__18199 invoke ""threaded.clj"" 21]
  [clojure.core$comp$fn__5876 doInvoke ""core.clj"" 2589]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 146]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.combo.threaded$combine_with_threader$fn__18209 doInvoke ""threaded.clj"" 46]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 151]
  [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 31]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 675]
  [clojure.core$apply doInvoke ""core.clj"" 662]
  [clojure.lang.RestFn invoke ""RestFn.java"" 533]
  [methodical.impl.standard$invoke_multifn invokeStatic ""standard.clj"" 65]
  [methodical.impl.standard$invoke_multifn doInvoke ""standard.clj"" 47]
  [clojure.lang.RestFn invoke ""RestFn.java"" 594]
  [methodical.impl.standard.StandardMultiFn invoke ""standard.clj"" 199]
  [toucan2.pipeline$transduce_query_STAR_ invokeStatic ""pipeline.clj"" 278]
  [toucan2.pipeline$transduce_query_STAR_ invoke ""pipeline.clj"" 274]
  [toucan2.pipeline$transduce_with_model invokeStatic ""pipeline.clj"" 293]
  [toucan2.pipeline$transduce_with_model invoke ""pipeline.clj"" 280]
  [toucan2.pipeline$transduce_parsed invokeStatic ""pipeline.clj"" 309]
  [toucan2.pipeline$transduce_parsed invoke ""pipeline.clj"" 295]
  [toucan2.execute$fn__21578 invokeStatic ""execute.clj"" 79]
  [toucan2.execute$fn__21578 invoke ""execute.clj"" 77]
  [toucan2.execute$query_STAR_$query_STAR__STAR___21575 invoke ""execute.clj"" 39]
  [toucan2.execute$query_STAR_$query_STAR__STAR___21575 invoke ""execute.clj"" 33]
  [toucan2.execute$query_STAR_$query_STAR__STAR___21575 invoke ""execute.clj"" 28]
  [toucan2.execute$query_STAR_$query_STAR__STAR___21575 invoke ""execute.clj"" 25]
  [metabase.db.query$query invokeStatic ""query.clj"" 88]
  [metabase.db.query$query doInvoke ""query.clj"" 72]
  [clojure.lang.RestFn invoke ""RestFn.java"" 410]
  [metabase.api.collection$collection_children_STAR_ invokeStatic ""collection.clj"" 724]
  [metabase.api.collection$collection_children_STAR_ invoke ""collection.clj"" 694]
  [metabase.api.collection$collection_children invokeStatic ""collection.clj"" 746]
  [metabase.api.collection$collection_children invoke ""collection.clj"" 733]
  [metabase.api.collection$fn__96758 invokeStatic ""collection.clj"" 859]
  [metabase.api.collection$fn__96758 invoke ""collection.clj"" 833]
  [compojure.core$wrap_response$fn__44649 invoke ""core.clj"" 160]
  [compojure.core$wrap_route_middleware$fn__44633 invoke ""core.clj"" 132]
  [compojure.core$wrap_route_info$fn__44638 invoke ""core.clj"" 139]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 151]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 152]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 153]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
  [metabase.server.middleware.auth$enforce_authentication$fn__93998 invoke ""auth.clj"" 17]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__44689 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [metabase.api.routes$fn__102024$fn__102027 invoke ""routes.clj"" 67]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [metabase.server.routes$fn__102189$fn__102190 doInvoke ""routes.clj"" 72]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__44689 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 152]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 152]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 152]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [metabase.server.routes$fn__102174$fn__102176 invoke ""routes.clj"" 49]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
  [metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__98797 invoke ""exceptions.clj"" 108]
  [metabase.server.middleware.exceptions$catch_api_exceptions$fn__98794 invoke ""exceptions.clj"" 96]
  [metabase.server.middleware.log$log_api_call$fn__102458$fn__102459$fn__102460 invoke ""log.clj"" 216]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invokeStatic ""diagnostic.clj"" 18]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invoke ""diagnostic.clj"" 12]
  [metabase.server.middleware.log$log_api_call$fn__102458$fn__102459 invoke ""log.clj"" 208]
  [toucan2.execute$do_with_call_counts invokeStatic ""execute.clj"" 112]
  [toucan2.execute$do_with_call_counts invoke ""execute.clj"" 103]
  [metabase.server.middleware.log$log_api_call$fn__102458 invoke ""log.clj"" 207]
  [metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__104493 invoke ""browser_cookie.clj"" 40]
  [metabase.server.middleware.security$add_security_headers$fn__98753 invoke ""security.clj"" 182]
  [metabase.server.middleware.json$wrap_json_body$fn__46006 invoke ""json.clj"" 67]
  [metabase.server.middleware.offset_paging$handle_paging$fn__84911 invoke ""offset_paging.clj"" 43]
  [metabase.server.middleware.json$wrap_streamed_json_response$fn__46024 invoke ""json.clj"" 103]
  [ring.middleware.keyword_params$wrap_keyword_params$fn__104760 invoke ""keyword_params.clj"" 55]
  [ring.middleware.params$wrap_params$fn__104779 invoke ""params.clj"" 77]
  [metabase.server.middleware.misc$maybe_set_site_url$fn__67232 invoke ""misc.clj"" 61]
  [metabase.server.middleware.session$reset_session_timeout$fn__72655 invoke ""session.clj"" 543]
  [metabase.server.middleware.session$bind_current_user$fn__72621$fn__72622 invoke ""session.clj"" 438]
  [metabase.server.middleware.session$do_with_current_user invokeStatic ""session.clj"" 417]
  [metabase.server.middleware.session$do_with_current_user invoke ""session.clj"" 401]
  [metabase.server.middleware.session$bind_current_user$fn__72621 invoke ""session.clj"" 437]
  [metabase.server.middleware.session$wrap_current_user_info$fn__72604 invoke ""session.clj"" 376]
  [metabase.server.middleware.session$wrap_session_id$fn__72576 invoke ""session.clj"" 255]
  [metabase.server.middleware.auth$wrap_static_api_key$fn__94006 invoke ""auth.clj"" 30]
  [ring.middleware.cookies$wrap_cookies$fn__104680 invoke ""cookies.clj"" 194]
  [metabase.server.middleware.misc$add_content_type$fn__67214 invoke ""misc.clj"" 29]
  [metabase.server.middleware.misc$disable_streaming_buffering$fn__67240 invoke ""misc.clj"" 78]
  [ring.middleware.gzip$wrap_gzip$fn__104722 invoke ""gzip.clj"" 86]
  [metabase.server.middleware.misc$bind_request$fn__67243 invoke ""misc.clj"" 95]
  [metabase.server.middleware.ssl$redirect_to_https_middleware$fn__104509 invoke ""ssl.clj"" 51]
  [metabase.server$async_proxy_handler$fn__67654 invoke ""server.clj"" 78]
  [metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a handle nil -1]
  [org.eclipse.jetty.server.handler.StatisticsHandler handle ""StatisticsHandler.java"" 173]
  [org.eclipse.jetty.server.handler.HandlerWrapper handle ""HandlerWrapper.java"" 122]
  [org.eclipse.jetty.server.Server handle ""Server.java"" 563]
  [org.eclipse.jetty.server.HttpChannel$RequestDispatchable dispatch ""HttpChannel.java"" 1598]
  [org.eclipse.jetty.server.HttpChannel dispatch ""HttpChannel.java"" 753]
  [org.eclipse.jetty.server.HttpChannel handle ""HttpChannel.java"" 501]
  [org.eclipse.jetty.server.HttpConnection onFillable ""HttpConnection.java"" 287]
  [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded ""AbstractConnection.java"" 314]
  [org.eclipse.jetty.io.FillInterest fillable ""FillInterest.java"" 100]
  [org.eclipse.jetty.io.SelectableChannelEndPoint$1 run ""SelectableChannelEndPoint.java"" 53]
  [org.eclipse.jetty.util.thread.QueuedThreadPool runJob ""QueuedThreadPool.java"" 969]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner doRunJob ""QueuedThreadPool.java"" 1194]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run ""QueuedThreadPool.java"" 1149]
  [java.lang.Thread run ""Thread.java"" 834]],
 :cause ""ERROR: failed to find conversion function from unknown to text"",
 :message
 ""Error executing SQL query: ERROR: failed to find conversion function from unknown to text\n\nSELECT\n  *\nFROM\n  (\n    SELECT\n      1 AS \""model_ranking\"",\n      \""d\"".\""id\"",\n      \""d\"".\""name\"",\n      \""d\"".\""description\"",\n      \""d\"".\""entity_id\"",\n      NULL AS \""display\"",\n      CAST(NULL AS boolean) AS \""collection_preview\"",\n      NULL AS \""dataset_query\"",\n      'dashboard' AS \""model\"",\n      \""d\"".\""collection_position\"",\n      NULL AS \""authority_level\"",\n      CAST(NULL AS integer) AS \""personal_owner_id\"",\n      \""u\"".\""email\"" AS \""last_edit_email\"",\n      \""u\"".\""first_name\"" AS \""last_edit_first_name\"",\n      \""u\"".\""last_name\"" AS \""last_edit_last_name\"",\n      NULL AS \""moderated_status\"",\n      NULL AS \""icon\"",\n      \""u\"".\""id\"" AS \""last_edit_user\"",\n      \""r\"".\""timestamp\"" AS \""last_edit_timestamp\"",\n      CAST(NULL AS integer) AS \""database_id\"",\n      NULL AS \""collection_type\"",\n      CAST(NULL AS integer) AS \""table_id\"",\n      CAST(NULL AS boolean) AS \""is_upload\"",\n      NULL AS \""query_type\""\n    FROM\n      \""report_dashboard\"" AS \""d\""\n      LEFT JOIN \""revision\"" AS \""r\"" ON (\""r\"".\""model_id\"" = \""d\"".\""id\"")\n      AND (\""r\"".\""most_recent\"" = TRUE)\n      AND (\""r\"".\""model\"" = 'Dashboard')\n      LEFT JOIN \""core_user\"" AS \""u\"" ON \""u\"".\""id\"" = \""r\"".\""user_id\""\n    WHERE\n      (\""collection_id\"" IS NULL)\n      AND (\""archived\"" = FALSE)\n      AND (1 = 1)\n  ) AS \""dummy_alias\""\nORDER BY\n  (\n    CASE\n      WHEN \""authority_level\"" = ? THEN ?\n      ELSE ?\n    END\n  ) ASC,\n  (\n    CASE\n      WHEN \""collection_type\"" IS NULL THEN ?\n      ELSE ?\n    END\n  ) ASC,\n  LOWER(\""name\"") ASC"",
 :sql
 [""SELECT""
  ""  *""
  ""FROM""
  ""  (""
  ""    SELECT""
  ""      1 AS \""model_ranking\"",""
  ""      \""d\"".\""id\"",""
  ""      \""d\"".\""name\"",""
  ""      \""d\"".\""description\"",""
  ""      \""d\"".\""entity_id\"",""
  ""      NULL AS \""display\"",""
  ""      CAST(NULL AS boolean) AS \""collection_preview\"",""
  ""      NULL AS \""dataset_query\"",""
  ""      'dashboard' AS \""model\"",""
  ""      \""d\"".\""collection_position\"",""
  ""      NULL AS \""authority_level\"",""
  ""      CAST(NULL AS integer) AS \""personal_owner_id\"",""
  ""      \""u\"".\""email\"" AS \""last_edit_email\"",""
  ""      \""u\"".\""first_name\"" AS \""last_edit_first_name\"",""
  ""      \""u\"".\""last_name\"" AS \""last_edit_last_name\"",""
  ""      NULL AS \""moderated_status\"",""
  ""      NULL AS \""icon\"",""
  ""      \""u\"".\""id\"" AS \""last_edit_user\"",""
  ""      \""r\"".\""timestamp\"" AS \""last_edit_timestamp\"",""
  ""      CAST(NULL AS integer) AS \""database_id\"",""
  ""      NULL AS \""collection_type\"",""
  ""      CAST(NULL AS integer) AS \""table_id\"",""
  ""      CAST(NULL AS boolean) AS \""is_upload\"",""
  ""      NULL AS \""query_type\""""
  ""    FROM""
  ""      \""report_dashboard\"" AS \""d\""""
  ""      LEFT JOIN \""revision\"" AS \""r\"" ON (\""r\"".\""model_id\"" = \""d\"".\""id\"")""
  ""      AND (\""r\"".\""most_recent\"" = TRUE)""
  ""      AND (\""r\"".\""model\"" = 'Dashboard')""
  ""      LEFT JOIN \""core_user\"" AS \""u\"" ON \""u\"".\""id\"" = \""r\"".\""user_id\""""
  ""    WHERE""
  ""      (\""collection_id\"" IS NULL)""
  ""      AND (\""archived\"" = FALSE)""
  ""      AND (1 = 1)""
  ""  ) AS \""dummy_alias\""""
  ""ORDER BY""
  ""  (""
  ""    CASE""
  ""      WHEN \""authority_level\"" = ? THEN ?""
  ""      ELSE ?""
  ""    END""
  ""  ) ASC,""
  ""  (""
  ""    CASE""
  ""      WHEN \""collection_type\"" IS NULL THEN ?""
  ""      ELSE ?""
  ""    END""
  ""  ) ASC,""
  ""  LOWER(\""name\"") ASC""],
 :args (""official"" 0 1 0 1),
 :uncompiled
 {:select [:*],
  :from
  [[{:union-all
     ({:select
       ([[:inline 1] :model_ranking]
        :d.id
        :d.name
        :d.description
        :d.entity_id
        [nil :display]
        [[:metabase.util.honey-sql-2/typed [:cast nil [:raw ""boolean""]] {:database-type ""boolean""}] :collection_preview]
        [nil :dataset_query]
        [[:metabase.util.honey-sql-2/literal ""dashboard""] :model]
        :d.collection_position
        [nil :authority_level]
        [[:metabase.util.honey-sql-2/typed [:cast nil [:raw ""integer""]] {:database-type ""integer""}] :personal_owner_id]
        [:u.email :last_edit_email]
        [:u.first_name :last_edit_first_name]
        [:u.last_name :last_edit_last_name]
        [nil :moderated_status]
        [nil :icon]
        [:u.id :last_edit_user]
        [:r.timestamp :last_edit_timestamp]
        [[:metabase.util.honey-sql-2/typed [:cast nil [:raw ""integer""]] {:database-type ""integer""}] :database_id]
        [nil :collection_type]
        [[:metabase.util.honey-sql-2/typed [:cast nil [:raw ""integer""]] {:database-type ""integer""}] :table_id]
        [[:metabase.util.honey-sql-2/typed [:cast nil [:raw ""boolean""]] {:database-type ""boolean""}] :is_upload]
        [nil :query_type]),
       :from [[:report_dashboard :d]],
       :left-join
       [[:revision :r]
        [:and
         [:= :r.model_id :d.id]
         [:= :r.most_recent true]
         [:= :r.model [:metabase.util.honey-sql-2/literal ""Dashboard""]]]
        [:core_user :u]
        [:= :u.id :r.user_id]],
       :where [:and [:= :collection_id nil] [:= :archived false] [:= [:inline 1] [:inline 1]]]})}
    :dummy_alias]],
  :order-by
  [[[[:case [:= :authority_level ""official""] 0 :else 1]] :asc]
   [[[:case [:= :collection_type nil] 0 :else 1]] :asc]
   [:%lower.name :asc]]}}
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""Java(TM) SE Runtime Environment"",
    ""java.runtime.version"": ""11.0.7+8-LTS"",
    ""java.vendor"": ""Oracle Corporation"",
    ""java.vendor.url"": ""https://openjdk.java.net/"",
    ""java.version"": ""11.0.7"",
    ""java.vm.name"": ""Java HotSpot(TM) 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.7+8-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""4.4.0-210-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Etc/UTC""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""clickhouse""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""9.5.24""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v0.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""Asia/Bahrain""
    }
  }
}
```


### Severity

Low

### Additional context

_No response_",falsaffa,2024-04-21 21:55:47+00:00,[],2024-04-26 16:24:52+00:00,2024-04-24 15:18:23+00:00,https://github.com/metabase/metabase/issues/41675,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2068656303, 'issue_id': 2255282170, 'author': 'paoliniluis', 'body': ""I have a strong feeling this is due to the version of Postgres you're using for the app db. Can you upgrade it to a newer version? let's say 15\r\n\r\nlet me know"", 'created_at': datetime.datetime(2024, 4, 22, 7, 16, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2071210063, 'issue_id': 2255282170, 'author': 'falsaffa', 'body': '@paoliniluis I upgrade to psql 10 and everything is now working (large upgrade to 15 planned this weekend). Thank you for pointing that out 😄', 'created_at': datetime.datetime(2024, 4, 23, 1, 3, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079708164, 'issue_id': 2255282170, 'author': 'watollop', 'body': 'Should be the minimum requirements of PSQL upgraded in the docu?\r\n\r\nhttps://www.metabase.com/docs/latest/installation-and-operation/migrating-from-h2#supported-databases-for-storing-your-metabase-application-data', 'created_at': datetime.datetime(2024, 4, 26, 16, 24, 51, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 07:16:07 UTC): I have a strong feeling this is due to the version of Postgres you're using for the app db. Can you upgrade it to a newer version? let's say 15

let me know

falsaffa (Issue Creator) on (2024-04-23 01:03:24 UTC): @paoliniluis I upgrade to psql 10 and everything is now working (large upgrade to 15 planned this weekend). Thank you for pointing that out 😄

watollop on (2024-04-26 16:24:51 UTC): Should be the minimum requirements of PSQL upgraded in the docu?

https://www.metabase.com/docs/latest/installation-and-operation/migrating-from-h2#supported-databases-for-storing-your-metabase-application-data

"
2255033847,issue,open,,Notify a user that another user is editing the question in real time to avoid conflicts,"**Is your feature request related to a problem? Please describe.**

Yes, this feature request addresses the issue of concurrent editing conflicts. Currently, when multiple users edit the same query or dashboard simultaneously, confusion can arise. The first editor might be unaware of changes made by a second editor, potentially leading to overwritten edits. This can be frustrating for both users and hinder collaboration.

**Describe the solution you'd like**

I have two solution for it:
- **Real-time editing notifications:** (Acknowledging complexity) Ideally, Metabase could display a message when a user opens a question for editing, indicating if another user is currently modifying it. This approach requires active monitoring of editor activity and might be more complex to implement.
- **""Save"" button revision notice:** A potentially simpler solution would be to leverage the existing revisions feature. Upon clicking ""Save,"" Metabase could display a notification if a new revision has been created since the user initially opened the resource for editing. This would alert the user to potential conflicts before saving their changes.

**Describe alternatives you've considered**

We haven't identified any effective workarounds within the current Metabase functionality. Manually checking for edits or relying solely on communication between users is not ideal and can hinder smooth collaboration.

**How important is this feature to you?**

This feature improves the user experience when teams are using Metabase collaboratively. It minimizes confusion, wasted effort caused by conflicting edits, and fosters a more productive collaborative environment.




Proposal for Notice on Save modal:
![image](https://github.com/metabase/metabase/assets/15375579/79ef9357-7c00-4501-90fc-1adcf0081d82)


Note: Edited by Gemini
",mrp97,2024-04-21 11:44:06+00:00,[],2024-04-22 06:46:11+00:00,,https://github.com/metabase/metabase/issues/41673,"[('Type:New Feature', ''), ('Organization/', '')]",[],
2254699909,issue,closed,not_planned,Using relative fields inside mongo pipeline new Date fails to pass the variable data.,"### Describe the bug

When performing the following aggregation pipeline, the BE fails to substitute the value and passes the literal string:

```json
[
    {
        ""$addFields"": {
            ""relative_time"": { ""$subtract"": [ISODate(), 86400000] }
        }
    },
    {
        ""$match"": {
        ""created_at"": {
            ""$lte"": ISODate(""$relative_time"")
        }
      }
    }
]
```

Getting the following error:
`Text '$relative_time' could not be parsed at index 0`

### To Reproduce

1. Create a new mongoDB query
2. Paste the pipeline in the issue above.
3. On stage ""$match"", replaces ""$created_at"" by the key in your document that contains a Date to compare.
4. Execute the query.
![Screenshot 2024-04-20 at 22 04 30](https://github.com/metabase/metabase/assets/54447877/f156cb8c-0de1-4aa6-bdf8-6d7ef59baa6f)


### Expected behavior

The query should return the same output as in MonogDB compass or when running the pipeline using Python. 
<img width=""1244"" alt=""Screenshot 2024-04-20 at 22 08 09"" src=""https://github.com/metabase/metabase/assets/54447877/a5c56c39-1301-44c0-9190-b4566a70d29d"">


### Logs

```json
{:status :failed,
   :class clojure.lang.ExceptionInfo,
   :error ""Unable to parse query: Failed to parse string as a date: $relative_time"",
   :stacktrace
   [""--> driver.mongo.query_processor$parse_query_string.invokeStatic(query_processor.clj:1384)""
    ""driver.mongo.query_processor$parse_query_string.invoke(query_processor.clj:1369)""
    ""driver.mongo.execute$execute_reducible_query.invokeStatic(execute.clj:186)""
    ""driver.mongo.execute$execute_reducible_query.invoke(execute.clj:182)""
    ""driver.mongo$fn__126386$f__122624__auto____126387.invoke(mongo.clj:320)""
    ""driver.mongo.connection$do_with_mongo_client$fn__122615.invoke(connection.clj:95)""
    ""util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:165)""
    ""util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154)""
    ""driver.mongo.connection$do_with_mongo_client.invokeStatic(connection.clj:90)""
    ""driver.mongo.connection$do_with_mongo_client.invoke(connection.clj:86)""
    ""driver.mongo$fn__126386.invokeStatic(mongo.clj:319)""
    ""driver.mongo$fn__126386.invoke(mongo.clj:317)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72236.invoke(cache.clj:229)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66593.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72057.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72067.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71499.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73404$combined_post_process__73409$combined_post_process_STAR___73410.invoke(query_processor.clj:262)""
    ""query_processor$fn__73404$combined_pre_process__73405$combined_pre_process_STAR___73406.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66690.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72147$fn__72151.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72147.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67317$fn__67318.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67317.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72144.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72449.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__72084$handle_audit_app_internal_queries__72085$fn__72087.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72095.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71210.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72380.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72981.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62831$thunk__62833.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62831.invoke(reducible.clj:132)""
    ""query_processor.reducible$sync_qp$qp_STAR___62843.doInvoke(reducible.clj:153)""
    ""query_processor$process_userland_query.invokeStatic(query_processor.clj:402)""
    ""query_processor$process_userland_query.doInvoke(query_processor.clj:398)""
    ""query_processor$process_query_and_save_execution_BANG_.invokeStatic(query_processor.clj:416)""
    ""query_processor$process_query_and_save_execution_BANG_.invoke(query_processor.clj:406)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invokeStatic(query_processor.clj:431)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invoke(query_processor.clj:421)""
    ""api.dataset$run_query_async$fn__93912.invoke(dataset.clj:79)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53261$fn__53263.invoke(streaming.clj:168)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53261.invoke(streaming.clj:167)""
    ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)""
    ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)""
    ""async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88)""],
   :error_type :invalid-query,
   :ex-data
   {:type :invalid-query,
    :query
    ""[\n    {\n        \""$addFields\"": {\n            \""relative_time\"": { \""$subtract\"": [ISODate(), 86400000] }\n        }\n    },\n    {\n        \""$match\"": {\n        \""created_at\"": {\n            \""$lte\"": ISODate(\""$relative_time\"")\n        }\n      }\n    }\n]""}}],
 :action_id nil,
 :error_type :invalid-query,
 :json_query
 {:database 3,
  :type ""native"",
  :native
  {:query
   ""[\n    {\n        \""$addFields\"": {\n            \""relative_time\"": { \""$subtract\"": [ISODate(), 86400000] }\n        }\n    },\n    {\n        \""$match\"": {\n        \""created_at\"": {\n            \""$lte\"": ISODate(\""$relative_time\"")\n        }\n      }\n    }\n]"",
   :template-tags {},
   :collection ""checkout_sessions_v1""},
  :parameters [],
  :middleware {:js-int-to-string? true, :add-default-userland-constraints? true}},
 :status :failed,
 :class java.time.format.DateTimeParseException,
 :stacktrace
 [""java.base/java.time.format.DateTimeFormatter.parseResolved0(Unknown Source)""
  ""java.base/java.time.format.DateTimeFormatter.parse(Unknown Source)""
  ""org.bson.json.DateTimeFormatter.parse(DateTimeFormatter.java:36)""
  ""org.bson.json.JsonReader.visitISODateTimeConstructor(JsonReader.java:830)""
  ""org.bson.json.JsonReader.readBsonType(JsonReader.java:226)""
  ""org.bson.codecs.BsonDocumentCodec.decode(BsonDocumentCodec.java:85)""
  ""org.bson.codecs.BsonDocumentCodec.decode(BsonDocumentCodec.java:42)""
  ""org.bson.internal.LazyCodec.decode(LazyCodec.java:53)""
  ""org.bson.codecs.BsonDocumentCodec.readValue(BsonDocumentCodec.java:104)""
  ""org.bson.codecs.BsonDocumentCodec.decode(BsonDocumentCodec.java:87)""
  ""org.bson.codecs.BsonDocumentCodec.decode(BsonDocumentCodec.java:42)""
  ""org.bson.internal.LazyCodec.decode(LazyCodec.java:53)""
  ""org.bson.codecs.BsonDocumentCodec.readValue(BsonDocumentCodec.java:104)""
  ""org.bson.codecs.BsonDocumentCodec.decode(BsonDocumentCodec.java:87)""
  ""org.bson.codecs.BsonDocumentCodec.decode(BsonDocumentCodec.java:42)""
  ""org.bson.codecs.BsonArrayCodec.readValue(BsonArrayCodec.java:102)""
  ""org.bson.codecs.BsonArrayCodec.decode(BsonArrayCodec.java:67)""
  ""org.bson.BsonArray.parse(BsonArray.java:87)""
  ""--> driver.mongo.query_processor$parse_query_string.invokeStatic(query_processor.clj:1382)""
  ""driver.mongo.query_processor$parse_query_string.invoke(query_processor.clj:1369)""
  ""driver.mongo.execute$execute_reducible_query.invokeStatic(execute.clj:186)""
  ""driver.mongo.execute$execute_reducible_query.invoke(execute.clj:182)""
  ""driver.mongo$fn__126386$f__122624__auto____126387.invoke(mongo.clj:320)""
  ""driver.mongo.connection$do_with_mongo_client$fn__122615.invoke(connection.clj:95)""
  ""util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:165)""
  ""util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154)""
  ""driver.mongo.connection$do_with_mongo_client.invokeStatic(connection.clj:90)""
  ""driver.mongo.connection$do_with_mongo_client.invoke(connection.clj:86)""
  ""driver.mongo$fn__126386.invokeStatic(mongo.clj:319)""
  ""driver.mongo$fn__126386.invoke(mongo.clj:317)""
  ""query_processor.context$executef.invokeStatic(context.clj:60)""
  ""query_processor.context$executef.invoke(context.clj:49)""
  ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
  ""query_processor.context.default$default_runf.invoke(default.clj:42)""
  ""query_processor.context$runf.invokeStatic(context.clj:46)""
  ""query_processor.context$runf.invoke(context.clj:40)""
  ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
  ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
  ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72236.invoke(cache.clj:229)""
  ""query_processor.middleware.permissions$check_query_permissions$fn__66593.invoke(permissions.clj:140)""
  ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__72057.invoke(enterprise.clj:51)""
  ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__72067.invoke(enterprise.clj:64)""
  ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71499.invoke(mbql_to_native.clj:24)""
  ""query_processor$fn__73404$combined_post_process__73409$combined_post_process_STAR___73410.invoke(query_processor.clj:262)""
  ""query_processor$fn__73404$combined_pre_process__73405$combined_pre_process_STAR___73406.invoke(query_processor.clj:259)""
  ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66690.invoke(fetch_source_query.clj:303)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72147$fn__72151.invoke(resolve_database_and_driver.clj:77)""
  ""driver$do_with_driver.invokeStatic(driver.clj:97)""
  ""driver$do_with_driver.invoke(driver.clj:92)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72147.invoke(resolve_database_and_driver.clj:76)""
  ""query_processor.middleware.store$initialize_store$fn__67317$fn__67318.invoke(store.clj:14)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.middleware.store$initialize_store$fn__67317.invoke(store.clj:13)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72144.invoke(resolve_database_and_driver.clj:60)""
  ""query_processor.middleware.normalize_query$normalize$fn__72449.invoke(normalize_query.clj:38)""
  ""query_processor.middleware.enterprise$fn__72084$handle_audit_app_internal_queries__72085$fn__72087.invoke(enterprise.clj:96)""
  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__72095.invoke(enterprise.clj:103)""
  ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71210.invoke(constraints.clj:104)""
  ""query_processor.middleware.process_userland_query$process_userland_query$fn__72380.invoke(process_userland_query.clj:156)""
  ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72981.invoke(catch_exceptions.clj:171)""
  ""query_processor.reducible$async_qp$qp_STAR___62831$thunk__62833.invoke(reducible.clj:126)""
  ""query_processor.reducible$async_qp$qp_STAR___62831.invoke(reducible.clj:132)""
  ""query_processor.reducible$sync_qp$qp_STAR___62843.doInvoke(reducible.clj:153)""
  ""query_processor$process_userland_query.invokeStatic(query_processor.clj:402)""
  ""query_processor$process_userland_query.doInvoke(query_processor.clj:398)""
  ""query_processor$process_query_and_save_execution_BANG_.invokeStatic(query_processor.clj:416)""
  ""query_processor$process_query_and_save_execution_BANG_.invoke(query_processor.clj:406)""
  ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invokeStatic(query_processor.clj:431)""
  ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invoke(query_processor.clj:421)""
  ""api.dataset$run_query_async$fn__93912.invoke(dataset.clj:79)""
  ""query_processor.streaming$streaming_response_STAR_$fn__53261$fn__53263.invoke(streaming.clj:168)""
  ""query_processor.streaming$streaming_response_STAR_$fn__53261.invoke(streaming.clj:167)""
  ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)""
  ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)""
  ""async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88)""],
 :card_id nil,
 :context :ad-hoc,
 :error ""Text '$relative_time' could not be parsed at index 0"",
 :row_count 0,
 :running_time 0,
 :data {:rows [], :cols []}}
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2.1 Safari/605.1.15"",
    ""vendor"": ""Apple Computer, Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.210-201.852.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mongo""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.1""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v0.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Madrid""
    }
  }
}
```


### Severity

Blocking usage

### Additional context

_No response_",aleixisp,2024-04-20 20:08:25+00:00,['lbrdnk'],2024-07-03 20:48:23+00:00,2024-06-27 19:27:33+00:00,https://github.com/metabase/metabase/issues/41670,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Mongo', None), ('Querying/Processor', '')]","[{'comment_id': 2067782869, 'issue_id': 2254699909, 'author': 'aleixisp', 'body': 'If you were to replace `ISODate` with `new Date(...)`\r\n\r\n```json\r\n[\r\n    {\r\n        ""$addFields"": {\r\n            ""relative_time"": { ""$subtract"": [ISODate(), 86400000] }\r\n        }\r\n    },\r\n    {\r\n        ""$match"": {\r\n        ""created_at"": {\r\n            ""$lte"": new Date(""$relative_time"")\r\n        }\r\n      }\r\n    }\r\n]\r\n```\r\n\r\nyou get the following error:\r\n```text\r\nJSON reader expected a date in \'EEE MMM dd yyyy HH:mm:ss z\' format but found \'$created_at\'.\r\n```', 'created_at': datetime.datetime(2024, 4, 20, 21, 15, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2071893998, 'issue_id': 2254699909, 'author': 'aleixisp', 'body': '@paoliniluis Can you provide an expected time when this will be addressed / fixed? So I can ping my DevOps team to update the integration as soon a new patch becomes available.\r\n\r\nSomething we can do on our side as a walk-around in the mean time? Anything we can do on our side to speed up the fix?\r\n\r\nLet me know.', 'created_at': datetime.datetime(2024, 4, 23, 9, 54, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2191963305, 'issue_id': 2254699909, 'author': 'lbrdnk', 'body': 'Hey @aleixisp! Thank you for the report.\r\n\r\nWe support aggregation pipelines in valid EJSON. Mongo provided java parser we are using is able to handle all EJSON modes ([parser docs](https://mongodb.github.io/mongo-java-driver/5.1/apidocs/bson/org/bson/json/JsonMode.html), [EJSON docs](https://www.mongodb.com/docs/manual/reference/mongodb-extended-json/)). I\'m afraid `ISODate(""$relative_time"")` violates that.\r\n\r\nHowever if you modify the query as follows (please ignore examples of various date representations; also I don\'t advise to mix those, but rather use one consistently), you should be able to get what you need.\r\n\r\n```\r\n[\r\n    {\r\n        ""$addFields"": { \r\n            ""relative_time"": { ""$subtract"": [ISODate(), 10000000000] },\r\n            ""shell_mode"": ISODate(""2024-06-06T06:06:06Z""),\r\n            ""shell_mode_js"": new Date(""Wed Jun 26 2024 06:06:06 GMT""),\r\n            ""relaxed_mode"": {""$date"": ""2024-06-06T06:06:06Z""},\r\n            ""canonical_mode"": {""$date"": {""$numberLong"": ""0""} }\r\n        },\r\n    },\r\n    {\r\n        ""$match"": {""$expr"": {""$gte"": [""$created_at"", ""$relative_time""] } } \r\n    }\r\n]\r\n```\r\n\r\nDoes that work for you?\r\n\r\n---\r\n\r\nAside: Example pipline executed in Metabase:\r\n<img width=""1496"" alt=""Screenshot 2024-06-26 at 17 09 38"" src=""https://github.com/metabase/metabase/assets/8920752/75428bdc-1e82-4f72-9f0d-b7a80a3f7891"">', 'created_at': datetime.datetime(2024, 6, 26, 15, 12, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2192174060, 'issue_id': 2254699909, 'author': 'aleixisp', 'body': 'hey @lbrdnk, My intention was to use ""$relative"" date so I can pass the value from dashboard filters to the query itself. These approaches are static in this sense and we couldn\'t use filter to get a specific date, (potentially even a date range)', 'created_at': datetime.datetime(2024, 6, 26, 16, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2192256304, 'issue_id': 2254699909, 'author': 'lbrdnk', 'body': 'If you need pass value from dashboard filter to the query, you should parametrize it first. See the screenshot. I\'m using text/string type of variable as later I\'ll pass the date _string_ to query verbatim.\r\n<img width=""1496"" alt=""Screenshot 2024-06-26 at 19 18 35"" src=""https://github.com/metabase/metabase/assets/8920752/5be3a319-2d7a-4d29-ab9d-30417028ff13"">\r\n\r\n---\r\n\r\nIf you add the former query to dashboard, you can link text filter to previously defined variable:\r\n<img width=""1496"" alt=""Screenshot 2024-06-26 at 19 17 40"" src=""https://github.com/metabase/metabase/assets/8920752/adab5c26-9b20-45ea-9912-6b1a7796b8c0"">\r\n\r\n---\r\n\r\nThen you could change the value of the variable on dashboard:\r\n<img width=""1496"" alt=""Screenshot 2024-06-26 at 19 20 03"" src=""https://github.com/metabase/metabase/assets/8920752/90a99ecb-bf1f-44b9-bea8-b74a36465092"">', 'created_at': datetime.datetime(2024, 6, 26, 17, 24, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2194461628, 'issue_id': 2254699909, 'author': 'lbrdnk', 'body': ""@aleixisp, you could also use variable of Date type there and connect corresponding filter to it when used on dashboard, if you remove the `ISODate` part and use only `{{x}}`. Are you able to achieve what's needed?"", 'created_at': datetime.datetime(2024, 6, 27, 11, 43, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2195515272, 'issue_id': 2254699909, 'author': 'lbrdnk', 'body': 'Closing as completed as I believe the provided approach should solve the problem of providing input to questions through dashboard filters.', 'created_at': datetime.datetime(2024, 6, 27, 19, 27, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2207249624, 'issue_id': 2254699909, 'author': 'aleixisp', 'body': 'Hey, sorry for the late reply. After some digging, I found the root issue, and probably I\'m missing some parts here. The filter works fine with DateTime fields, however, it\'s filling as our database uses ComplexDateTime [link](http://docs.mongoengine.org/apireference.html?highlight=datetimefield#fields)\r\n\r\nIn theory, we should be able to run filters and sortings, however seems to not work:\r\n\r\nFrom docs. \r\n> Derives from a StringField so you can do gte and lte filtering by using lexicographical comparison when filtering / sorting strings.\r\n\r\nI think the issue is that we are setting filters using ""Date"" as a Variable Type in Metabase however it\'s expecting a string.\r\nAm I missing something?\r\n\r\nRegards,\r\nAleix López', 'created_at': datetime.datetime(2024, 7, 3, 20, 48, 21, tzinfo=datetime.timezone.utc)}]","aleixisp (Issue Creator) on (2024-04-20 21:15:15 UTC): If you were to replace `ISODate` with `new Date(...)`

```json
[
    {
        ""$addFields"": {
            ""relative_time"": { ""$subtract"": [ISODate(), 86400000] }
        }
    },
    {
        ""$match"": {
        ""created_at"": {
            ""$lte"": new Date(""$relative_time"")
        }
      }
    }
]
```

you get the following error:
```text
JSON reader expected a date in 'EEE MMM dd yyyy HH:mm:ss z' format but found '$created_at'.
```

aleixisp (Issue Creator) on (2024-04-23 09:54:33 UTC): @paoliniluis Can you provide an expected time when this will be addressed / fixed? So I can ping my DevOps team to update the integration as soon a new patch becomes available.

Something we can do on our side as a walk-around in the mean time? Anything we can do on our side to speed up the fix?

Let me know.

lbrdnk (Assginee) on (2024-06-26 15:12:32 UTC): Hey @aleixisp! Thank you for the report.

We support aggregation pipelines in valid EJSON. Mongo provided java parser we are using is able to handle all EJSON modes ([parser docs](https://mongodb.github.io/mongo-java-driver/5.1/apidocs/bson/org/bson/json/JsonMode.html), [EJSON docs](https://www.mongodb.com/docs/manual/reference/mongodb-extended-json/)). I'm afraid `ISODate(""$relative_time"")` violates that.

However if you modify the query as follows (please ignore examples of various date representations; also I don't advise to mix those, but rather use one consistently), you should be able to get what you need.

```
[
    {
        ""$addFields"": { 
            ""relative_time"": { ""$subtract"": [ISODate(), 10000000000] },
            ""shell_mode"": ISODate(""2024-06-06T06:06:06Z""),
            ""shell_mode_js"": new Date(""Wed Jun 26 2024 06:06:06 GMT""),
            ""relaxed_mode"": {""$date"": ""2024-06-06T06:06:06Z""},
            ""canonical_mode"": {""$date"": {""$numberLong"": ""0""} }
        },
    },
    {
        ""$match"": {""$expr"": {""$gte"": [""$created_at"", ""$relative_time""] } } 
    }
]
```

Does that work for you?

---

Aside: Example pipline executed in Metabase:
<img width=""1496"" alt=""Screenshot 2024-06-26 at 17 09 38"" src=""https://github.com/metabase/metabase/assets/8920752/75428bdc-1e82-4f72-9f0d-b7a80a3f7891"">

aleixisp (Issue Creator) on (2024-06-26 16:39:00 UTC): hey @lbrdnk, My intention was to use ""$relative"" date so I can pass the value from dashboard filters to the query itself. These approaches are static in this sense and we couldn't use filter to get a specific date, (potentially even a date range)

lbrdnk (Assginee) on (2024-06-26 17:24:04 UTC): If you need pass value from dashboard filter to the query, you should parametrize it first. See the screenshot. I'm using text/string type of variable as later I'll pass the date _string_ to query verbatim.
<img width=""1496"" alt=""Screenshot 2024-06-26 at 19 18 35"" src=""https://github.com/metabase/metabase/assets/8920752/5be3a319-2d7a-4d29-ab9d-30417028ff13"">

---

If you add the former query to dashboard, you can link text filter to previously defined variable:
<img width=""1496"" alt=""Screenshot 2024-06-26 at 19 17 40"" src=""https://github.com/metabase/metabase/assets/8920752/adab5c26-9b20-45ea-9912-6b1a7796b8c0"">

---

Then you could change the value of the variable on dashboard:
<img width=""1496"" alt=""Screenshot 2024-06-26 at 19 20 03"" src=""https://github.com/metabase/metabase/assets/8920752/90a99ecb-bf1f-44b9-bea8-b74a36465092"">

lbrdnk (Assginee) on (2024-06-27 11:43:50 UTC): @aleixisp, you could also use variable of Date type there and connect corresponding filter to it when used on dashboard, if you remove the `ISODate` part and use only `{{x}}`. Are you able to achieve what's needed?

lbrdnk (Assginee) on (2024-06-27 19:27:34 UTC): Closing as completed as I believe the provided approach should solve the problem of providing input to questions through dashboard filters.

aleixisp (Issue Creator) on (2024-07-03 20:48:21 UTC): Hey, sorry for the late reply. After some digging, I found the root issue, and probably I'm missing some parts here. The filter works fine with DateTime fields, however, it's filling as our database uses ComplexDateTime [link](http://docs.mongoengine.org/apireference.html?highlight=datetimefield#fields)

In theory, we should be able to run filters and sortings, however seems to not work:

From docs. 

I think the issue is that we are setting filters using ""Date"" as a Variable Type in Metabase however it's expecting a string.
Am I missing something?

Regards,
Aleix López

"
2254406259,issue,closed,completed,"After #39120 , Dashboard subscription's Japanese filename of attachment is broken","### Describe the bug

After https://github.com/metabase/metabase/issues/39120 , the multibyte filename of Microsoft Excel xlsx attachment of subscription is percent encoded.
Before the issue, the filename is correctly encoded and I can easily identify and open the attached file.

And percent encoded filename of the attachment may become too long to open with Microsoft Excel.

### To Reproduce

1. Create question with a name in Japanese characters, for example ""テストSQL質問""
2. Assign the question to a dashboard.
3. Add email subscription with attached result xlsx file.
4. Open the email with your mail user agent, for example Gmail web UI, MIcrosoft Outook web UI, Mozilla Thunderbird 115 and Microsoft Outlook included in Microsoft 365 2203.


### Expected behavior

Proper filename in readable Japanese characters

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""NetBSD x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; NetBSD x86_64; rv:125.0) Gecko/20100101 Firefox/125.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.2-internal-adhoc.pkgsrc.jdk21u-jdk-21.0.2-13-1"",
    ""java.vendor"": ""N/A"",
    ""java.vendor.url"": ""https://openjdk.org/"",
    ""java.version"": ""21.0.2-internal"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.2-internal-adhoc.pkgsrc.jdk21u-jdk-21.0.2-13-1"",
    ""os.name"": ""NetBSD"",
    ""os.version"": ""10.99.10"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Asia/Tokyo""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v0.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

This blocks my update

### Additional context

My workaround is here.

```
diff --git a/src/metabase/email/messages.clj b/src/metabase/email/messages.clj
index 070c231588..178d94a6cd 100644
--- a/src/metabase/email/messages.clj
+++ b/src/metabase/email/messages.clj
@@ -380,7 +380,7 @@
     {:type         :attachment
      :content-type content-type
      :file-name    (format ""%s_%s.%s""
-                           (or (u/slugify card-name) ""query_result"")
+                           card-name
                            (u.date/format (t/zoned-date-time))
                            (name export-type))
      :content      (-> attachment-file .toURI .toURL)
```",ryoon,2024-04-20 06:16:33+00:00,['adam-james-v'],2024-05-14 01:05:56+00:00,2024-05-13 20:21:24+00:00,https://github.com/metabase/metabase/issues/41669,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Export', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2068669510, 'issue_id': 2254406259, 'author': 'paoliniluis', 'body': '@ryoon if you have a solution please open a PR so the team can review it', 'created_at': datetime.datetime(2024, 4, 22, 7, 24, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2081715059, 'issue_id': 2254406259, 'author': 'ryoon', 'body': 'I will try to submit my changes as a PR.', 'created_at': datetime.datetime(2024, 4, 29, 0, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2101743801, 'issue_id': 2254406259, 'author': 'ojjj13', 'body': 'Same happens to Chinese characters in Alerts. I am afraid it also affect other non-English languages.', 'created_at': datetime.datetime(2024, 5, 9, 1, 7, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2103255795, 'issue_id': 2254406259, 'author': 'adam-james-v', 'body': ""@ryoon , no need to create your own PR. I've looked at your fix and have a PR up that incorporates it, while still keeping a default filename (the 'query_result' part of the line you've changed).\r\n\r\nThank you for submitting this issue and your workaround! We'll work to get a fix in :)"", 'created_at': datetime.datetime(2024, 5, 9, 19, 7, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2103792813, 'issue_id': 2254406259, 'author': 'ryoon', 'body': '@adam-james-v Thank you. I do not understand tests for Metabase yet and I could not send a pull request.', 'created_at': datetime.datetime(2024, 5, 10, 3, 29, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2109082669, 'issue_id': 2254406259, 'author': 'ryoon', 'body': '@adam-james-v Thank you very much. I will update my Metabase instance to upcoming 0.49.11.', 'created_at': datetime.datetime(2024, 5, 14, 1, 5, 55, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 07:24:11 UTC): @ryoon if you have a solution please open a PR so the team can review it

ryoon (Issue Creator) on (2024-04-29 00:19:00 UTC): I will try to submit my changes as a PR.

ojjj13 on (2024-05-09 01:07:59 UTC): Same happens to Chinese characters in Alerts. I am afraid it also affect other non-English languages.

adam-james-v (Assginee) on (2024-05-09 19:07:46 UTC): @ryoon , no need to create your own PR. I've looked at your fix and have a PR up that incorporates it, while still keeping a default filename (the 'query_result' part of the line you've changed).

Thank you for submitting this issue and your workaround! We'll work to get a fix in :)

ryoon (Issue Creator) on (2024-05-10 03:29:40 UTC): @adam-james-v Thank you. I do not understand tests for Metabase yet and I could not send a pull request.

ryoon (Issue Creator) on (2024-05-14 01:05:55 UTC): @adam-james-v Thank you very much. I will update my Metabase instance to upcoming 0.49.11.

"
2254054335,issue,open,,EntityPicker Follow-Up Issues,"Follow up issues re #35564 

- [x] Remove ItemPicker and all its wrappers
- [x] https://github.com/metabase/metabase/issues/40297
- [x] Shift + Scroll does not scroll the picker horizontally - Ubuntu/Chrome and Ubuntu/Firefox (? works on my machine)
- [x] Make `return` key save/select from the picker modal
- [x] https://github.com/metabase/metabase/issues/40675
- [x] https://github.com/metabase/metabase/issues/40776
- [x] https://github.com/metabase/metabase/pull/41735
- [x] #42979
- [x] #42976
- [x] #42980
- [x] #42687 
- [x] #40950 
- [ ] https://github.com/metabase/metabase/issues/40924
- [ ] #45586
- [ ] #42274
- [ ] #43092
- [ ] #45592
- [ ] Remove ActionPicker
",iethree,2024-04-19 21:49:22+00:00,[],2025-01-03 16:55:11+00:00,,https://github.com/metabase/metabase/issues/41667,"[('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2254037983,issue,closed,not_planned,"FE: Correctly display archived/trashed collections, dashboards, and cards","```[tasklist]
### Tasks
```
",sloansparger,2024-04-19 21:34:21+00:00,['sloansparger'],2024-04-26 22:04:44+00:00,2024-04-26 22:04:44+00:00,https://github.com/metabase/metabase/issues/41665,[],[],
2253958305,issue,closed,completed,"API Endpoint: trash/untrash collections, models, and cards",,johnswanson,2024-04-19 20:42:00+00:00,['johnswanson'],2024-05-09 20:38:34+00:00,2024-05-09 20:38:34+00:00,https://github.com/metabase/metabase/issues/41661,[],[],
2253955420,issue,closed,completed,"Migration: Add `trashed_from_collection_id` to cards and dashboards, `trashed_from_location` to collections.",,johnswanson,2024-04-19 20:40:32+00:00,['johnswanson'],2024-04-26 21:10:36+00:00,2024-04-26 21:10:36+00:00,https://github.com/metabase/metabase/issues/41660,[],"[{'comment_id': 2080123352, 'issue_id': 2253955420, 'author': 'johnswanson', 'body': 'Resolved by https://github.com/metabase/metabase/pull/41529', 'created_at': datetime.datetime(2024, 4, 26, 21, 10, 36, tzinfo=datetime.timezone.utc)}]","johnswanson (Issue Creator) on (2024-04-26 21:10:36 UTC): Resolved by https://github.com/metabase/metabase/pull/41529

"
2253776572,issue,closed,completed,"if user changes data type to another and then selects again the previous data type, mappings should be restored",,uladzimirdev,2024-04-19 19:25:56+00:00,[],2024-05-02 20:40:43+00:00,2024-05-02 20:40:43+00:00,https://github.com/metabase/metabase/issues/41658,[],[],
2253570288,issue,closed,completed,"Token activation error persists, even after connectivity is restored","### Describe the bug

If a license activation attempt fails because token-check.metabase.com is not reachable or anything else prevents the token check API to be called, subsequent activation attempts continue to fail with the same error, even after the connectivity is restored. 
The issue persists until Metabase is restarted.

### To Reproduce

1. Set up a new instance
2. Disable connectivity to the token-check API (I just turned off my wifi connection while running Metabase locally)
3. In Admin Settings / Licencing, enter a valid token, and click Activate
4. Activation will time out
5. Now restore the connectivity
6. Try to activate the same token again
7.(!) The same validation timeout error occurs. 
The validation error will persist until Metabase is restarted.


### Expected behavior

Validation should be successful once the connectivity is restored.

### Logs

2024-04-19 17:38:58,209 DEBUG middleware.log :: GET /api/setting 200 47.0 ms (15 DB calls) App DB connections: 1/7 Jetty threads: 6/50 (4 idle, 0 queued) (46 total active threads) Queries in flight: 0 (0 queued)
2024-04-19 17:38:58,250 WARN middleware.log :: GET /api/premium-features/token/status 404 1.5 ms (0 DB calls)
""Not found.""
2024-04-19 17:39:04,645 ERROR public-settings.premium-features :: Error setting premium features token
clojure.lang.ExceptionInfo: Unable to validate token {:status-code 400, :error-details ""Token validation timed out.""}

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.75-0-virt"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Etc/UTC""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v1.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P2 - rare but confusing

### Additional context

_No response_",zbodi74,2024-04-19 17:56:38+00:00,['johnswanson'],2024-10-10 11:18:24+00:00,2024-09-30 21:22:13+00:00,https://github.com/metabase/metabase/issues/41654,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Administration/', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2068671929, 'issue_id': 2253570288, 'author': 'paoliniluis', 'body': '@zbodi74 is this JAR or Docker?', 'created_at': datetime.datetime(2024, 4, 22, 7, 25, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2068679369, 'issue_id': 2253570288, 'author': 'zbodi74', 'body': '@paoliniluis, I noticed this with Docker.', 'created_at': datetime.datetime(2024, 4, 22, 7, 29, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2068684002, 'issue_id': 2253570288, 'author': 'paoliniluis', 'body': '@zbodi74 check with the JAR then as this ""might"" be the docker layer being nasty', 'created_at': datetime.datetime(2024, 4, 22, 7, 32, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2096441208, 'issue_id': 2253570288, 'author': 'zbodi74', 'body': 'This problem also affects JAR deployments.\r\nAdditionally, it isn\'t limited to network errors. It can be triggered by any factor that prevents token validation. For instance, a customer faced a temporary certificate issue—likely due to the Java certificate store being refreshed. This resulted in an error {:message ""Unable to validate token"", :status-code 400, :error-details ""the trustAnchors parameter must be non-empty""} that got resolved by restarting Metabase.\r\nHowever it appears, it is only the manual licence check that fails persistently, once a periodic token check is successful, that also resolves the issue.', 'created_at': datetime.datetime(2024, 5, 6, 16, 27, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2404816168, 'issue_id': 2253570288, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.51](https://github.com/metabase/metabase/milestone/231)', 'created_at': datetime.datetime(2024, 10, 10, 11, 18, 23, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 07:25:37 UTC): @zbodi74 is this JAR or Docker?

zbodi74 (Issue Creator) on (2024-04-22 07:29:37 UTC): @paoliniluis, I noticed this with Docker.

paoliniluis on (2024-04-22 07:32:11 UTC): @zbodi74 check with the JAR then as this ""might"" be the docker layer being nasty

zbodi74 (Issue Creator) on (2024-05-06 16:27:40 UTC): This problem also affects JAR deployments.
Additionally, it isn't limited to network errors. It can be triggered by any factor that prevents token validation. For instance, a customer faced a temporary certificate issue—likely due to the Java certificate store being refreshed. This resulted in an error {:message ""Unable to validate token"", :status-code 400, :error-details ""the trustAnchors parameter must be non-empty""} that got resolved by restarting Metabase.
However it appears, it is only the manual licence check that fails persistently, once a periodic token check is successful, that also resolves the issue.

github-actions[bot] on (2024-10-10 11:18:23 UTC): 🚀 This should also be released by [v0.51](https://github.com/metabase/metabase/milestone/231)

"
2253468887,issue,closed,completed,Change the copy for card with SQL variables,"Update copy 

[design](https://www.figma.com/file/gs70ybpemgX6f1RjCZdvKH/Allow-dashboard-filter-type-to-be-changed-after-it's-added?type=design&node-id=2709-14631&mode=design&t=0RUuw1yGGWXPMxfi-0)",uladzimirdev,2024-04-19 17:02:00+00:00,['uladzimirdev'],2024-04-30 13:28:51+00:00,2024-04-30 13:28:51+00:00,https://github.com/metabase/metabase/issues/41647,[],[],
2253166088,issue,closed,completed,Migrate Down on 49 doesn't work,"### Describe the bug

Running migrate down on 49 will end up breaking the instance ... You are screwed if you don't have a backup

### To Reproduce

Deploy 1.49.6 and run the `java -jar metabase.jar migrate down` command

### Expected behavior

_No response_

### Logs

When you run the migrate down you will see those logs:

2024-04-18 16:21:44,470 INFO metabase.util :: Maximum memory available to JVM: 4.0 GB
2024-04-18 16:21:47,401 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓 
 For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html
2024-04-18 16:21:49,863 ERROR public-settings.premium-features :: Error validating token : Assert failed: Metabase DB is not yet set up
((requiring-resolve (quote metabase.db/db-is-set-up?)))
2024-04-18 16:21:56,408 INFO driver.impl :: Registered abstract driver :sql  🚚
2024-04-18 16:21:56,430 INFO driver.impl :: Registered abstract driver :sql-jdbc (parents: [:sql]) 🚚
2024-04-18 16:21:56,439 INFO metabase.util :: Load driver :sql-jdbc took 131.9 ms
2024-04-18 16:21:56,440 INFO driver.impl :: Registered driver :h2 (parents: [:sql-jdbc]) 🚚
2024-04-18 16:21:56,733 INFO driver.impl :: Registered driver :mysql (parents: [:sql-jdbc]) 🚚
2024-04-18 16:21:56,785 INFO driver.impl :: Registered driver :postgres (parents: [:sql-jdbc]) 🚚
2024-04-18 16:22:01,534 INFO metabase.core :: 
Metabase v1.49.7-SNAPSHOT (dc62587) 
Copyright © 2024 Metabase, Inc. 
Metabase Enterprise Edition extensions are PRESENT.
Usage of Metabase Enterprise Edition features are subject to the Metabase Commercial License. See https://www.metabase.com/license/commercial/ for details.
2024-04-18 16:22:02,750 INFO db.setup :: Setting up Liquibase...
2024-04-18 16:22:04,998 INFO db.setup :: Liquibase is ready.
2024-04-18 16:22:05,075 INFO db.liquibase :: Rolling back app database schema to version 48
2024-04-18 16:22:08,819 INFO db.custom-migrations :: No rollback for:  DeleteScanFieldValuesTriggerForDBThatTurnItOff
2024-04-18 16:22:09,419 INFO db.custom-migrations :: No rollback for:  DeleteTruncateAuditLogTask


Then when you try to load metabase on 1.48.11 you end up with metabase restart errors:

```
2024-04-18 20:48:34,942 INFO metabase.core :: Metabase Shutdown COMPLETE

2024-04-18 20:48:34,935 INFO metabase.server :: Shutting Down Embedded Jetty Webserver

2024-04-18 20:48:34,934 INFO metabase.core :: Metabase Shutting Down ...

2024-04-18 20:48:34,925 ERROR metabase.core :: Metabase Initialization FAILED

liquibase.exception.ValidationFailedException: Validation Failed:

203 changesets check sum

migrations/001_update_migrations.yaml::v00.00-000::qnkhuat was: 9:e346841fa1cd9d142e1237b37fdc8a20 but is now: 8:a59595109e74e7a2678a1b0dfd25f74a

migrations/001_update_migrations.yaml::v45.00-001::snoe was: 9:15c13a8aa3fdc72ef0c54f4cccfc39e1 but is now: 8:da99b71a4ac7eb662f6a95e69585935e

migrations/001_update_migrations.yaml::v45.00-002::snoe was: 9:d2c9f50f5a29947a07e4808957d63ab6 but is now: 8:6da7a6285edb138c404de0eeba209570

migrations/001_update_migrations.yaml::v45.00-003::snoe was: 9:dafaaf7c9f0efbf92670ea93c001f7a1 but is now: 8:512337d6d4af38016aa79585abbe03a1

migrations/001_update_migrations.yaml::v45.00-011::snoe was: 9:c539f152aa1c2287c5b602c7a395f9e8 but is now: 8:dcf1cda9f20dca4b6ff8101b13b98c4a

migrations/001_update_migrations.yaml::v45.00-012::snoe was: 9:b872219f47d12ec80db8f1731be4ce94 but is now: 8:aadf28229f585cff7c4b4c1918e558b2

migrations/001_update_migrations.yaml::v45.00-013::snoe was: 9:54c5d6a9659b7ae62e8c42f60f9620d2 but is now: 8:26dba276b14255d4346507a1a25d117b

migrations/001_update_migrations.yaml::v45.00-022::snoe was: 9:06e8a3ba8c4c5e5cf8e6aa3f35081cac but is now: 8:d46fa24e4d75a11b2e92aecbf39c6ee1

migrations/001_update_migrations.yaml::v45.00-023::snoe was: 9:082d296233ee6dbbf2871b9d93c3a6a4 but is now: 8:c6c1ff9ca3b62d4cda3a2d782dd86f2f

migrations/001_update_migrations.yaml::v45.00-025::metamben was: 9:2214b0d71acc8a8cf90781a2aca98664 but is now: 8:50a43cea3123ecdb602123825f5a7dbf

migrations/001_update_migrations.yaml::v45.00-026::snoe was: 9:9f2ce2d2d79d0dce365ddf3464d1f648 but is now: 8:ae77d4086998911877e3207fcf90c9c7

migrations/001_update_migrations.yaml::v45.00-027::snoe was: 9:73718f7b7c3fb4ef30f71dc6e6170528 but is now: 8:40c3c8391c1416a3bce09ca3c7237173

migrations/001_update_migrations.yaml::v45.00-028::camsaul was: 9:883315d70f3fc10b07858aa0e48ed9da but is now: 8:f8f68f80627aeb2ef7f28f2af2b5a31b

migrations/001_update_migrations.yaml::v45.00-029::camsaul was: 9:fe3b8aca811ef5b541f922a83c7ded8c but is now: 8:579957652133eab3ee023dd911162a1e

migrations/001_update_migrations.yaml::v45.00-030::camsaul was: 9:63da8f2f82baf396ad30f3fd451c501d but is now: 8:41eda097feb034c4d01b2dbda74753c8

migrations/001_update_migrations.yaml::v45.00-031::camsaul was: 9:3628c1c692bec0f7258ea983b18340b5 but is now: 8:6416e373e335dc1c12c7571af674dede

migrations/001_update_migrations.yaml::v45.00-032::camsaul was: 9:7a6f0320210b82c5eafe836ea98f477d but is now: 8:d97444fe24a2dca618a2804741335f6d

migrations/001_update_migrations.yaml::v45.00-033::camsaul was: 9:b93dab321e4a1fcaeb74d12b52867fd4 but is now: 8:34df79fc79e086ab05bb2fd79bb4e322

migrations/001_update_migrations.yaml::v45.00-034::camsaul was: 9:39c965f9dc521d2a1e196f645d11de9e but is now: 8:ba0505a87ef876026759cdcb4e704f41

migrations/001_update_migrations.yaml::v45.00-035::camsaul was: 9:207984e21c44681a6135592cab3d0f3f but is now: 8:dcee49781d80d9c4be5ad9dd51975a07

migrations/001_update_migrations.yaml::v45.00-036::snoe was: 9:8632f7a046e1094399c517b05f0feea3 but is now: 8:cd4009254bd2c56aaf281082038c1f0b

migrations/001_update_migrations.yaml::v45.00-037::snoe was: 9:6600702fb0cc9dcd8628fca8df9c0b39 but is now: 8:56f548cc84a53cc6d18302761ee71554

migrations/001_update_migrations.yaml::v45.00-038::camsaul was: 9:5ae52c12861e5eec6a2a9a8c5a442826 but is now: 8:c38ddc295206e807c7254581ed9566c3

migrations/001_update_migrations.yaml::v45.00-039::camsaul was: 9:7b331f47a0260218275c58fa21fdcc60 but is now: 8:2c539d76d3aead7f7366b15333132b30

migrations/001_update_migrations.yaml::v45.00-040::camsaul was: 9:6d6fb2c7cd62868b9878a951c8596cec but is now: 8:00ac7c24cfd3e7ea3a21f21f4e45dbcf

migrations/001_update_migrations.yaml::v45.00-041::camsaul was: 9:84d479472b81809b8067f72b28934954 but is now: 8:82dc368fa3e0163a06929da6e9556fe2

at liquibase.changelog.DatabaseChangeLog.validate(DatabaseChangeLog.java:354)

at liquibase.Liquibase.lambda$listUnrunChangeSets$16(Liquibase.java:1287)

at liquibase.Scope.lambda$child$0(Scope.java:194)

at liquibase.Scope.child(Scope.java:203)

at liquibase.Scope.child(Scope.java:193)

at liquibase.Scope.child(Scope.java:172)

at liquibase.Liquibase.runInScope(Liquibase.java:1618)

at liquibase.Liquibase.listUnrunChangeSets(Liquibase.java:1279)

at liquibase.Liquibase.listUnrunChangeSets(Liquibase.java:1270)

at metabase.db.liquibase$unrun_migrations$fn__48014.invoke(liquibase.clj:180)

at metabase.db.liquibase$do_with_liquibase$f_STAR___47999.invoke(liquibase.clj:134)

at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:137)

at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:125)

at metabase.db.liquibase$unrun_migrations.invokeStatic(liquibase.clj:179)

at metabase.db.liquibase$unrun_migrations.invoke(liquibase.clj:170)

at metabase.db.liquibase$migrate_up_if_needed_BANG_.invokeStatic(liquibase.clj:225)

at metabase.db.liquibase$migrate_up_if_needed_BANG_.invoke(liquibase.clj:221)

at metabase.db.setup$migrate_BANG_$fn__50231.invoke(setup.clj:80)

at metabase.db.liquibase$do_with_liquibase$f_STAR___47999.invoke(liquibase.clj:134)

at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:137)

at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:125)

at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)

at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)

at clojure.lang.RestFn.invoke(RestFn.java:445)

at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:148)

at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:142)

at metabase.db.setup$setup_db_BANG_$fn__50261$fn__50262.invoke(setup.clj:166)

at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)

at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)

at metabase.db.setup$setup_db_BANG_$fn__50261.invoke(setup.clj:161)

at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:160)

at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:154)

at metabase.db$setup_db_BANG_$fn__50275.invoke(db.clj:69)

at metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)

at metabase.db$setup_db_BANG_.invoke(db.clj:55)

at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:113)

at metabase.core$init_BANG__STAR_.invoke(core.clj:98)

at metabase.core$init_BANG_.invokeStatic(core.clj:156)

at metabase.core$init_BANG_.invoke(core.clj:151)

at metabase.core$start_normally.invokeStatic(core.clj:168)

at metabase.core$start_normally.invoke(core.clj:162)

at metabase.core$entrypoint.invokeStatic(core.clj:201)

at metabase.core$entrypoint.doInvoke(core.clj:195)

at clojure.lang.RestFn.invoke(RestFn.java:397)

at clojure.lang.AFn.applyToHelper(AFn.java:152)

at clojure.lang.RestFn.applyTo(RestFn.java:132)

at clojure.lang.Var.applyTo(Var.java:705)

at clojure.core$apply.invokeStatic(core.clj:667)

at clojure.core$apply.invoke(core.clj:662)

at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)

at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)

at clojure.lang.RestFn.invoke(RestFn.java:397)

at clojure.lang.AFn.applyToHelper(AFn.java:152)

at clojure.lang.RestFn.applyTo(RestFn.java:132)

at metabase.bootstrap.main(Unknown Source)

2024-04-18 20:48:34,549 INFO db.setup :: Liquibase is ready.

2024-04-18 20:48:34,549 INFO db.liquibase :: Checking if Database has unrun migrations...

2024-04-18 20:48:34,304 INFO db.setup :: Running Database Migrations...

2024-04-18 20:48:34,304 INFO db.setup :: Setting up Liquibase...

2024-04-18 20:48:33,796 INFO db.setup :: [36mChecking if a database downgrade is required...[0m

2024-04-18 20:48:33,795 INFO db.setup :: Successfully verified PostgreSQL 14.3 application database connection. ✅

2024-04-18 20:48:33,304 INFO db.setup :: [36mVerifying postgres Database Connection ...[0m

2024-04-18 20:48:33,302 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...

2024-04-18 20:48:33,292 DEBUG plugins.lazy-loaded-driver :: [35mRegistering lazy loading driver :mongo...[0m

2024-04-18 20:48:33,292 INFO driver.impl :: [34mRegistered driver :mongo[0m 🚚

2024-04-18 20:48:33,284 INFO driver.impl :: [34mRegistered driver :redshift[0m (parents: [:postgres]) 🚚

2024-04-18 20:48:33,283 DEBUG plugins.lazy-loaded-driver :: [35mRegistering lazy loading driver :redshift...[0m

2024-04-18 20:48:33,278 INFO driver.impl :: [34mRegistered driver :vertica[0m (parents: [:sql-jdbc]) 🚚

```

### Information about your Metabase installation

```JSON
1,49.6
```


### Severity

If by mistake you upgrade and decide to run a migrate down without taking a backup you are screwed

### Additional context

_No response_",Tony-metabase,2024-04-19 14:31:21+00:00,['escherize'],2024-06-20 20:56:59+00:00,2024-04-22 15:50:20+00:00,https://github.com/metabase/metabase/issues/41641,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Backend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.')]","[{'comment_id': 2171051077, 'issue_id': 2253166088, 'author': 'cheekamadu', 'body': 'Faced the same issue with Metabase v0.49.14. Rollback to 48 fails with\r\n\r\n```\r\nMetabase Enterprise Edition extensions are NOT PRESENT.\r\n2024-06-16 04:50:53,352 INFO db.setup :: Setting up Liquibase...\r\n2024-06-16 04:50:54,002 INFO db.setup :: Liquibase is ready.\r\n2024-06-16 04:50:54,006 INFO db.liquibase :: Rolling back app database schema to version 48\r\n2024-06-16 04:50:54,499 INFO db.custom-migrations :: No rollback for:  DeleteScanFieldValuesTriggerForDBThatTurnItOff\r\n2024-06-16 04:50:54,513 INFO db.custom-migrations :: No rollback for:  DeleteTruncateAuditLogTask\r\n```', 'created_at': datetime.datetime(2024, 6, 16, 5, 13, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2181549470, 'issue_id': 2253166088, 'author': 'arasmussen', 'body': 'Corrupted a database migrating down from 50 to 49, any shot at recovering it?', 'created_at': datetime.datetime(2024, 6, 20, 20, 56, 58, tzinfo=datetime.timezone.utc)}]","cheekamadu on (2024-06-16 05:13:37 UTC): Faced the same issue with Metabase v0.49.14. Rollback to 48 fails with

```
Metabase Enterprise Edition extensions are NOT PRESENT.
2024-06-16 04:50:53,352 INFO db.setup :: Setting up Liquibase...
2024-06-16 04:50:54,002 INFO db.setup :: Liquibase is ready.
2024-06-16 04:50:54,006 INFO db.liquibase :: Rolling back app database schema to version 48
2024-06-16 04:50:54,499 INFO db.custom-migrations :: No rollback for:  DeleteScanFieldValuesTriggerForDBThatTurnItOff
2024-06-16 04:50:54,513 INFO db.custom-migrations :: No rollback for:  DeleteTruncateAuditLogTask
```

arasmussen on (2024-06-20 20:56:58 UTC): Corrupted a database migrating down from 50 to 49, any shot at recovering it?

"
2253144076,issue,closed,completed,CSV download from dashboard is rounding negative floats to 1 decimal place,"**Describe the bug**
When I download a csv from a question within a dashboard, it rounds the float value to 1 decimal place. In the question, it displays the value as 2 decimal places. If I download as an xlsx, I get 2 decimal places. If I download from the question directly (ie not from the dashboard) then I get 2 decimal places for both csv and xlsx downloads

**Logs**
{:query
  ""SELECT \""reporting\"".\""reporting_wallet_report\"".\""running_balance\"" AS \""running_balance\"" FROM \""reporting\"".\""reporting_wallet_report\"" ORDER BY \""reporting\"".\""reporting_wallet_report\"".\""transaction_timestamp\"" DESC LIMIT 1"",
  :params nil},
 :status :failed,
 :class java.io.IOException,
 :stacktrace
 [""java.base/sun.nio.ch.FileDispatcherImpl.writev0(Native Method)""
  ""java.base/sun.nio.ch.SocketDispatcher.writev(Unknown Source)""
  ""java.base/sun.nio.ch.IOUtil.write(Unknown Source)""
  ""java.base/sun.nio.ch.IOUtil.write(Unknown Source)""
  ""java.base/sun.nio.ch.SocketChannelImpl.write(Unknown Source)""
  ""java.base/java.nio.channels.SocketChannel.write(Unknown Source)""
  ""org.eclipse.jetty.io.SocketChannelEndPoint.flush(SocketChannelEndPoint.java:110)""
  ""org.eclipse.jetty.io.WriteFlusher.flush(WriteFlusher.java:422)""
  ""org.eclipse.jetty.io.WriteFlusher.write(WriteFlusher.java:275)""
  ""org.eclipse.jetty.io.WriteFlusher.write(WriteFlusher.java:254)""
  ""org.eclipse.jetty.io.AbstractEndPoint.write(AbstractEndPoint.java:386)""
  ""org.eclipse.jetty.server.HttpConnection$SendCallback.process(HttpConnection.java:832)""
  ""org.eclipse.jetty.util.IteratingCallback.processing(IteratingCallback.java:243)""
  ""org.eclipse.jetty.util.IteratingCallback.iterate(IteratingCallback.java:224)""
  ""org.eclipse.jetty.server.HttpConnection.send(HttpConnection.java:589)""
  ""org.eclipse.jetty.server.HttpChannel.sendResponse(HttpChannel.java:1051)""
  ""org.eclipse.jetty.server.HttpChannel.write(HttpChannel.java:1123)""
  ""org.eclipse.jetty.server.HttpOutput.channelWrite(HttpOutput.java:270)""
  ""org.eclipse.jetty.server.HttpOutput.channelWrite(HttpOutput.java:254)""
  ""org.eclipse.jetty.server.HttpOutput.flush(HttpOutput.java:736)""
  ""java.base/java.util.zip.DeflaterOutputStream.flush(Unknown Source)""
  ""--> async.streaming_response$delay_output_stream$fn__43773.invoke(streaming_response.clj:123)""
  ""async.streaming_response.proxy$java.io.OutputStream$ff19274a.flush(Unknown Source)""
  ""query_processor.streaming.json$fn$reify__52362.finish_BANG_(json.clj:115)""
  ""query_processor.streaming$streaming_reducedf$fn__53138.invoke(streaming.clj:132)""
  ""query_processor.context$reducedf.invokeStatic(context.clj:78)""
  ""query_processor.context$reducedf.invoke(context.clj:73)""
  ""query_processor.context.default$default_reducef.invokeStatic(default.clj:40)""
  ""query_processor.context.default$default_reducef.invoke(default.clj:25)""
  ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___72125$fn__72126.invoke(cache.clj:201)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:83)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:73)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
  ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___72125.invoke(cache.clj:197)""
  ""query_processor.context$reducef.invokeStatic(context.clj:70)""
  ""query_processor.context$reducef.invoke(context.clj:63)""
  ""query_processor.context.default$default_runf$respond_STAR___50467.invoke(default.clj:45)""
  ""driver.sql_jdbc.execute$execute_reducible_query$fn__79250.invoke(execute.clj:709)""
  ""driver.sql_jdbc.execute$fn__79043$fn__79044.invoke(execute.clj:388)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:317)""
  ""driver.sql_jdbc.execute$fn__79043.invokeStatic(execute.clj:382)""
  ""driver.sql_jdbc.execute$fn__79043.invoke(execute.clj:380)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:692)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:689)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
  ""driver.sql_jdbc$fn__106638.invokeStatic(sql_jdbc.clj:78)""
  ""driver.sql_jdbc$fn__106638.invoke(sql_jdbc.clj:76)""
  ""query_processor.context$executef.invokeStatic(context.clj:60)""
  ""query_processor.context$executef.invoke(context.clj:49)""
  ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
  ""query_processor.context.default$default_runf.invoke(default.clj:42)""
  ""query_processor.context$runf.invokeStatic(context.clj:46)""
  ""query_processor.context$runf.invoke(context.clj:40)""
  ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
  ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
  ""query_processor.middleware.cache$run_query_with_cache.invokeStatic(cache.clj:202)""
  ""query_processor.middleware.cache$run_query_with_cache.invoke(cache.clj:186)""
  ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72138.invoke(cache.clj:228)""
  ""query_processor.middleware.permissions$check_query_permissions$fn__66516.invoke(permissions.clj:140)""
  ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__71959.invoke(enterprise.clj:51)""
  ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__71969.invoke(enterprise.clj:64)""
  ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71401.invoke(mbql_to_native.clj:24)""
  ""query_processor$fn__73306$combined_post_process__73311$combined_post_process_STAR___73312.invoke(query_processor.clj:262)""
  ""query_processor$fn__73306$combined_pre_process__73307$combined_pre_process_STAR___73308.invoke(query_processor.clj:259)""
  ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66613.invoke(fetch_source_query.clj:303)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72049$fn__72053.invoke(resolve_database_and_driver.clj:77)""
  ""driver$do_with_driver.invokeStatic(driver.clj:97)""
  ""driver$do_with_driver.invoke(driver.clj:92)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72049.invoke(resolve_database_and_driver.clj:76)""
  ""query_processor.middleware.store$initialize_store$fn__67219$fn__67220.invoke(store.clj:14)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.middleware.store$initialize_store$fn__67219.invoke(store.clj:13)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72046.invoke(resolve_database_and_driver.clj:60)""
  ""query_processor.middleware.normalize_query$normalize$fn__72351.invoke(normalize_query.clj:38)""
  ""query_processor.middleware.enterprise$fn__71986$handle_audit_app_internal_queries__71987$fn__71989.invoke(enterprise.clj:96)""
  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__71997.invoke(enterprise.clj:103)""
  ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71112.invoke(constraints.clj:104)""
  ""query_processor.middleware.process_userland_query$process_userland_query$fn__72282.invoke(process_userland_query.clj:156)""
  ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72883.invoke(catch_exceptions.clj:171)""
  ""query_processor.reducible$async_qp$qp_STAR___62758$thunk__62760.invoke(reducible.clj:126)""
  ""query_processor.reducible$async_qp$qp_STAR___62758$fn__62762.invoke(reducible.clj:131)""],
 :card_id 1443,
 :context :dashboard,
 :error ""Broken pipe"",
 :row_count 0,
 :running_time 0,
 :preprocessed
 {:constraints {:max-results 10000, :max-results-bare-rows 2000},
  :type :query,
  :middleware {:js-int-to-string? true, :ignore-cached-results? false},
  :user-parameters
  [{:type :string/=, :id ""b2768f9b"", :target [:dimension [:field 18190 nil]]}
   {:type :string/=, :id ""a9f90bc9"", :target [:dimension [:field 39317 {:base-type :type/Text}]]}],
  :viz-settings {},
  :info {:executed-by 61, :context :dashboard, :card-id 1443, :card-name ""Current Balance"", :dashboard-id 251},
  :database 2,
  :query
  {:source-table 1054,
   :order-by [[:desc [:field 19751 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :default}]]],
   :limit 1,
   :fields [[:field 19750 nil]]},
  :async? true,
  :cache-ttl 6},
 :data {:rows [], :cols []}}

[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:27+01:00 ERROR metabase.async.streaming-response Caught unexpected Exception in streaming response body,java.lang.NullPointerException: Deflater has been closed,	at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source),	at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source),	at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121),	at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source),	at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:58),	at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46),	at metabase.query_processor.streaming$streaming_response_STAR_$fn__53188.invoke(streaming.clj:176),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$with_bindings_STAR_.invokeStatic(core.clj:1990),	at clojure.core$with_bindings_STAR_.doInvoke(core.clj:1990),	at clojure.lang.RestFn.applyTo(RestFn.java:142),	at clojure.core$apply.invokeStatic(core.clj:671),	at clojure.core$bound_fn_STAR_$fn__5818.doInvoke(core.clj:2020),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69),	at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67),	at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88),	at clojure.lang.AFn.run(AFn.java:22),	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source)
[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:27+01:00 ERROR metabase.async.streaming-response Error writing error to output stream {:via [{:type java.lang.NullPointerException, :message Deflater has been closed, :at [java.util.zip.Deflater ensureOpen nil -1]}], :trace [[java.util.zip.Deflater ensureOpen nil -1] [java.util.zip.Deflater deflate nil -1] [java.util.zip.Deflater deflate nil -1] [java.util.zip.GZIPOutputStream finish nil -1] [java.util.zip.DeflaterOutputStream close nil -1] [metabase.async.streaming_response$delay_output_stream$fn__43771 invoke streaming_response.clj 121] [metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a close nil -1] [metabase.async.streaming_response$write_error_BANG_ invokeStatic streaming_response.clj 58] [metabase.async.streaming_response$write_error_BANG_ invoke streaming_response.clj 46] [metabase.query_processor.streaming$streaming_response_STAR_$fn__53188 invoke streaming.clj 176] [clojure.lang.AFn applyToHelper AFn.java 156] [clojure.lang.AFn applyTo AFn.java 144] [clojure.core$apply invokeStatic core.clj 667] [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1990] [clojure.core$with_bindings_STAR_ doInvoke core.clj 1990] [clojure.lang.RestFn applyTo RestFn.java 142] [clojure.core$apply invokeStatic core.clj 671] [clojure.core$bound_fn_STAR_$fn__5818 doInvoke core.clj 2020] [clojure.lang.RestFn invoke RestFn.java 421] [metabase.async.streaming_response$do_f_STAR_ invokeStatic streaming_response.clj 69] [metabase.async.streaming_response$do_f_STAR_ invoke streaming_response.clj 67] [metabase.async.streaming_response$do_f_async$task__43756 invoke streaming_response.clj 88] [clojure.lang.AFn run AFn.java 22] [java.util.concurrent.Executors$RunnableAdapter call nil -1] [java.util.concurrent.FutureTask run nil -1] [java.util.concurrent.ThreadPoolExecutor runWorker nil -1] [java.util.concurrent.ThreadPoolExecutor$Worker run nil -1] [java.lang.Thread run nil -1]], :cause Deflater has been closed, :_status 500},java.lang.NullPointerException: Deflater has been closed,	at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source),	at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source),	at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121),	at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source),	at java.base/sun.nio.cs.StreamEncoder.implClose(Unknown Source),	at java.base/sun.nio.cs.StreamEncoder.close(Unknown Source),	at java.base/java.io.OutputStreamWriter.close(Unknown Source),	at java.base/java.io.BufferedWriter.close(Unknown Source),	at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:61),	at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46),	at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78),	at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67),	at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88),	at clojure.lang.AFn.run(AFn.java:22),	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source)
[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:27+01:00 ERROR metabase.async.streaming-response bound-fn caught unexpected Exception,java.lang.NullPointerException: Deflater has been closed,	at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source),	at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source),	at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121),	at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source),	at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:58),	at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46),	at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78),	at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67),	at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88),	at clojure.lang.AFn.run(AFn.java:22),	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source)
[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:27+01:00 DEBUG metabase.server.middleware.log POST /api/dashboard/251/dashcard/1521/card/1443/query 202 [ASYNC: unexpected-error] 541.9 ms (20 DB calls) App DB connections: 2/15 Jetty threads: 2/50 (27 idle, 0 queued) (133 total active threads) Queries in flight: 4 (0 queued); postgres DB 2 connections: 0/3 (0 threads blocked)
[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:27+01:00 INFO metabase.query-processor.middleware.cache Query took 419.0 ms to run; minimum for cache eligibility is 5.0 s; not eligible
[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:27+01:00 DEBUG metabase.server.middleware.log POST /api/dashboard/251/dashcard/1521/card/1443/query 202 [ASYNC: completed] 586.6 ms (20 DB calls) App DB connections: 2/15 Jetty threads: 2/50 (27 idle, 0 queued) (133 total active threads) Queries in flight: 3 (0 queued); postgres DB 2 connections: 1/3 (0 threads blocked)
[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:27+01:00 INFO metabase.query-processor.middleware.cache Query took 442.0 ms to run; minimum for cache eligibility is 5.0 s; not eligible
[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:27+01:00 DEBUG metabase.server.middleware.log POST /api/dashboard/251/dashcard/1518/card/1429/query 202 [ASYNC: completed] 653.2 ms (20 DB calls) App DB connections: 3/15 Jetty threads: 2/50 (27 idle, 0 queued) (133 total active threads) Queries in flight: 2 (0 queued); postgres DB 2 connections: 3/3 (1 threads blocked)
[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:28+01:00 INFO metabase.query-processor.middleware.cache Query took 691.0 ms to run; minimum for cache eligibility is 5.0 s; not eligible
[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:28+01:00 DEBUG metabase.server.middleware.log POST /api/dashboard/251/dashcard/1957/card/1897/query 202 [ASYNC: completed] 871.6 ms (20 DB calls) App DB connections: 2/15 Jetty threads: 2/50 (27 idle, 0 queued) (133 total active threads) Queries in flight: 1 (0 queued); postgres DB 2 connections: 2/3 (0 threads blocked)
[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:28+01:00 INFO metabase.query-processor.middleware.cache Query took 708.0 ms to run; minimum for cache eligibility is 5.0 s; not eligible
[49ad5b68-4023-45ec-a9c3-5a8322d02562] 2024-04-19T15:06:28+01:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: Broken pipe
{:database_id 2,
 :started_at #t ""2024-04-19T14:06:27.356088Z[GMT]"",
 :via
 [{:status :failed,
   :class org.eclipse.jetty.io.EofException,
   :error nil,
   :stacktrace
   [""org.eclipse.jetty.io.SocketChannelEndPoint.flush(SocketChannelEndPoint.java:116)""
    ""org.eclipse.jetty.io.WriteFlusher.flush(WriteFlusher.java:422)""
    ""org.eclipse.jetty.io.WriteFlusher.write(WriteFlusher.java:275)""
    ""org.eclipse.jetty.io.WriteFlusher.write(WriteFlusher.java:254)""
    ""org.eclipse.jetty.io.AbstractEndPoint.write(AbstractEndPoint.java:386)""
    ""org.eclipse.jetty.server.HttpConnection$SendCallback.process(HttpConnection.java:832)""
    ""org.eclipse.jetty.util.IteratingCallback.processing(IteratingCallback.java:243)""
    ""org.eclipse.jetty.util.IteratingCallback.iterate(IteratingCallback.java:224)""
    ""org.eclipse.jetty.server.HttpConnection.send(HttpConnection.java:589)""
    ""org.eclipse.jetty.server.HttpChannel.sendResponse(HttpChannel.java:1051)""
    ""org.eclipse.jetty.server.HttpChannel.write(HttpChannel.java:1123)""
    ""org.eclipse.jetty.server.HttpOutput.channelWrite(HttpOutput.java:270)""
    ""org.eclipse.jetty.server.HttpOutput.channelWrite(HttpOutput.java:254)""
    ""org.eclipse.jetty.server.HttpOutput.flush(HttpOutput.java:736)""
    ""java.base/java.util.zip.DeflaterOutputStream.flush(Unknown Source)""
    ""--> async.streaming_response$delay_output_stream$fn__43773.invoke(streaming_response.clj:123)""
    ""async.streaming_response.proxy$java.io.OutputStream$ff19274a.flush(Unknown Source)""
    ""query_processor.streaming.json$fn$reify__52362.finish_BANG_(json.clj:115)""
    ""query_processor.streaming$streaming_reducedf$fn__53138.invoke(streaming.clj:132)""
    ""query_processor.context$reducedf.invokeStatic(context.clj:78)""
    ""query_processor.context$reducedf.invoke(context.clj:73)""
    ""query_processor.context.default$default_reducef.invokeStatic(default.clj:40)""
    ""query_processor.context.default$default_reducef.invoke(default.clj:25)""
    ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___72125$fn__72126.invoke(cache.clj:201)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:83)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:73)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
    ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___72125.invoke(cache.clj:197)""
    ""query_processor.context$reducef.invokeStatic(context.clj:70)""
    ""query_processor.context$reducef.invoke(context.clj:63)""
    ""query_processor.context.default$default_runf$respond_STAR___50467.invoke(default.clj:45)""
    ""driver.sql_jdbc.execute$execute_reducible_query$fn__79250.invoke(execute.clj:709)""
    ""driver.sql_jdbc.execute$fn__79043$fn__79044.invoke(execute.clj:388)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:317)""
    ""driver.sql_jdbc.execute$fn__79043.invokeStatic(execute.clj:382)""
    ""driver.sql_jdbc.execute$fn__79043.invoke(execute.clj:380)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:692)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:689)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
    ""driver.sql_jdbc$fn__106638.invokeStatic(sql_jdbc.clj:78)""
    ""driver.sql_jdbc$fn__106638.invoke(sql_jdbc.clj:76)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$run_query_with_cache.invokeStatic(cache.clj:202)""
    ""query_processor.middleware.cache$run_query_with_cache.invoke(cache.clj:186)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72138.invoke(cache.clj:228)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66516.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__71959.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__71969.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71401.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73306$combined_post_process__73311$combined_post_process_STAR___73312.invoke(query_processor.clj:262)""
    ""query_processor$fn__73306$combined_pre_process__73307$combined_pre_process_STAR___73308.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66613.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72049$fn__72053.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72049.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67219$fn__67220.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67219.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72046.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72351.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__71986$handle_audit_app_internal_queries__71987$fn__71989.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__71997.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71112.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72282.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72883.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62758$thunk__62760.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62758$fn__62762.invoke(reducible.clj:131)""]}],
 :action_id nil,
 :json_query
 {:constraints {:max-results 10000, :max-results-bare-rows 2000},
  :type :query,
  :middleware {:js-int-to-string? true, :ignore-cached-results? false},
  :viz-settings {:card.title ""Updated Timestamp"", :column_settings {""[\""name\"",\""max\""]"" {:time_style ""HH:mm""}}},
  :database 2,
  :query
  {:source-table 1054,
   :aggregation [[:max [:field 21984 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :minute}]]]},
  :parameters
  [{:type :string/=, :id ""b2768f9b"", :target [:dimension [:field 18190 nil]]}
   {:type :string/=, :id ""a9f90bc9"", :target [:dimension [:field 39317 {:base-type :type/Text}]]}],
  :async? true,
  :cache-ttl 8},
 :native
 {:query
  ""SELECT MAX(DATE_TRUNC('minute', \""reporting\"".\""reporting_wallet_report\"".\""updated_timestamp\"")) AS \""max\"" FROM \""reporting\"".\""reporting_wallet_report\"""",
  :params nil},
 :status :failed,
 :class java.io.IOException,
 :stacktrace
 [""java.base/sun.nio.ch.FileDispatcherImpl.writev0(Native Method)""
  ""java.base/sun.nio.ch.SocketDispatcher.writev(Unknown Source)""
  ""java.base/sun.nio.ch.IOUtil.write(Unknown Source)""
  ""java.base/sun.nio.ch.IOUtil.write(Unknown Source)""
  ""java.base/sun.nio.ch.SocketChannelImpl.write(Unknown Source)""
  ""java.base/java.nio.channels.SocketChannel.write(Unknown Source)""
  ""org.eclipse.jetty.io.SocketChannelEndPoint.flush(SocketChannelEndPoint.java:110)""
  ""org.eclipse.jetty.io.WriteFlusher.flush(WriteFlusher.java:422)""
  ""org.eclipse.jetty.io.WriteFlusher.write(WriteFlusher.java:275)""
  ""org.eclipse.jetty.io.WriteFlusher.write(WriteFlusher.java:254)""
  ""org.eclipse.jetty.io.AbstractEndPoint.write(AbstractEndPoint.java:386)""
  ""org.eclipse.jetty.server.HttpConnection$SendCallback.process(HttpConnection.java:832)""
  ""org.eclipse.jetty.util.IteratingCallback.processing(IteratingCallback.java:243)""
  ""org.eclipse.jetty.util.IteratingCallback.iterate(IteratingCallback.java:224)""
  ""org.eclipse.jetty.server.HttpConnection.send(HttpConnection.java:589)""
  ""org.eclipse.jetty.server.HttpChannel.sendResponse(HttpChannel.java:1051)""
  ""org.eclipse.jetty.server.HttpChannel.write(HttpChannel.java:1123)""
  ""org.eclipse.jetty.server.HttpOutput.channelWrite(HttpOutput.java:270)""
  ""org.eclipse.jetty.server.HttpOutput.channelWrite(HttpOutput.java:254)""
  ""org.eclipse.jetty.server.HttpOutput.flush(HttpOutput.java:736)""
  ""java.base/java.util.zip.DeflaterOutputStream.flush(Unknown Source)""
  ""--> async.streaming_response$delay_output_stream$fn__43773.invoke(streaming_response.clj:123)""
  ""async.streaming_response.proxy$java.io.OutputStream$ff19274a.flush(Unknown Source)""
  ""query_processor.streaming.json$fn$reify__52362.finish_BANG_(json.clj:115)""
  ""query_processor.streaming$streaming_reducedf$fn__53138.invoke(streaming.clj:132)""
  ""query_processor.context$reducedf.invokeStatic(context.clj:78)""
  ""query_processor.context$reducedf.invoke(context.clj:73)""
  ""query_processor.context.default$default_reducef.invokeStatic(default.clj:40)""
  ""query_processor.context.default$default_reducef.invoke(default.clj:25)""
  ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___72125$fn__72126.invoke(cache.clj:201)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:83)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:73)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
  ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___72125.invoke(cache.clj:197)""
  ""query_processor.context$reducef.invokeStatic(context.clj:70)""
  ""query_processor.context$reducef.invoke(context.clj:63)""
  ""query_processor.context.default$default_runf$respond_STAR___50467.invoke(default.clj:45)""
  ""driver.sql_jdbc.execute$execute_reducible_query$fn__79250.invoke(execute.clj:709)""
  ""driver.sql_jdbc.execute$fn__79043$fn__79044.invoke(execute.clj:388)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:317)""
  ""driver.sql_jdbc.execute$fn__79043.invokeStatic(execute.clj:382)""
  ""driver.sql_jdbc.execute$fn__79043.invoke(execute.clj:380)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:692)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:689)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
  ""driver.sql_jdbc$fn__106638.invokeStatic(sql_jdbc.clj:78)""
  ""driver.sql_jdbc$fn__106638.invoke(sql_jdbc.clj:76)""
  ""query_processor.context$executef.invokeStatic(context.clj:60)""
  ""query_processor.context$executef.invoke(context.clj:49)""
  ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
  ""query_processor.context.default$default_runf.invoke(default.clj:42)""
  ""query_processor.context$runf.invokeStatic(context.clj:46)""
  ""query_processor.context$runf.invoke(context.clj:40)""
  ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
  ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
  ""query_processor.middleware.cache$run_query_with_cache.invokeStatic(cache.clj:202)""
  ""query_processor.middleware.cache$run_query_with_cache.invoke(cache.clj:186)""
  ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72138.invoke(cache.clj:228)""
  ""query_processor.middleware.permissions$check_query_permissions$fn__66516.invoke(permissions.clj:140)""
  ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__71959.invoke(enterprise.clj:51)""
  ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__71969.invoke(enterprise.clj:64)""
  ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71401.invoke(mbql_to_native.clj:24)""
  ""query_processor$fn__73306$combined_post_process__73311$combined_post_process_STAR___73312.invoke(query_processor.clj:262)""
  ""query_processor$fn__73306$combined_pre_process__73307$combined_pre_process_STAR___73308.invoke(query_processor.clj:259)""
  ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66613.invoke(fetch_source_query.clj:303)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72049$fn__72053.invoke(resolve_database_and_driver.clj:77)""
  ""driver$do_with_driver.invokeStatic(driver.clj:97)""
  ""driver$do_with_driver.invoke(driver.clj:92)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72049.invoke(resolve_database_and_driver.clj:76)""
  ""query_processor.middleware.store$initialize_store$fn__67219$fn__67220.invoke(store.clj:14)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.middleware.store$initialize_store$fn__67219.invoke(store.clj:13)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72046.invoke(resolve_database_and_driver.clj:60)""
  ""query_processor.middleware.normalize_query$normalize$fn__72351.invoke(normalize_query.clj:38)""
  ""query_processor.middleware.enterprise$fn__71986$handle_audit_app_internal_queries__71987$fn__71989.invoke(enterprise.clj:96)""
  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__71997.invoke(enterprise.clj:103)""
  ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71112.invoke(constraints.clj:104)""
  ""query_processor.middleware.process_userland_query$process_userland_query$fn__72282.invoke(process_userland_query.clj:156)""
  ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72883.invoke(catch_exceptions.clj:171)""
  ""query_processor.reducible$async_qp$qp_STAR___62758$thunk__62760.invoke(reducible.clj:126)""
  ""query_processor.reducible$async_qp$qp_STAR___62758$fn__62762.invoke(reducible.clj:131)""],
 :card_id 1897,
 :context :dashboard,
 :error ""Broken pipe"",
 :row_count 0,
 :running_time 0,
 :preprocessed
 {:constraints {:max-results 10000, :max-results-bare-rows 2000},
  :type :query,
  :middleware {:js-int-to-string? true, :ignore-cached-results? false},
  :user-parameters
  [{:type :string/=, :id ""b2768f9b"", :target [:dimension [:field 18190 nil]]}
   {:type :string/=, :id ""a9f90bc9"", :target [:dimension [:field 39317 {:base-type :type/Text}]]}],
  :viz-settings {:card.title ""Updated Timestamp"", :column_settings {""[\""name\"",\""max\""]"" {:time_style ""HH:mm""}}},
  :info {:executed-by 61, :context :dashboard, :card-id 1897, :card-name ""Updated Timestamp"", :dashboard-id 251},
  :database 2,
  :query
  {:source-table 1054,
   :aggregation
   [[:aggregation-options
     [:max [:field 21984 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :minute}]]
     {:name ""max""}]]},
  :async? true,
  :cache-ttl 8},
 :data {:rows [], :cols []}}

**Severity**
How severe an issue is this bug to you? Is this annoying, blocking some users, blocking an upgrade or blocking your usage of Metabase entirely?
Note: the more honest and specific you are here the more we will take you seriously.

**Additional context**
Add any other context about the problem here.

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.210-201.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.9""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-02"",
      ""tag"": ""v0.49.3"",
      ""hash"": ""dba0992""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```",jkwalsh92,2024-04-19 14:20:40+00:00,['adam-james-v'],2024-07-25 15:03:52+00:00,2024-07-25 14:14:37+00:00,https://github.com/metabase/metabase/issues/41640,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Export', ''), ('.Escalation', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2068680239, 'issue_id': 2253144076, 'author': 'paoliniluis', 'body': 'hi, can you tell us if this is a GUI or SQL question? can you reproduce with the sample database? also, can you move to 49.6?', 'created_at': datetime.datetime(2024, 4, 22, 7, 30, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2086810977, 'issue_id': 2253144076, 'author': 'paoliniluis', 'body': ""@jkwalsh92 we need to know how to reproduce or we'll close the issue"", 'created_at': datetime.datetime(2024, 4, 30, 19, 29, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2086868289, 'issue_id': 2253144076, 'author': 'jkwalsh92', 'body': '@paoliniluis this is a gui issue and yep will try updating', 'created_at': datetime.datetime(2024, 4, 30, 19, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2111453675, 'issue_id': 2253144076, 'author': 'matid', 'body': '@paoliniluis We’ve run into this too. Here are steps to reproduce.\r\n\r\n1. Add a new native query.\r\n2. Use `select -0.57 proof` as the query\r\n3. Download full results as CSV, XLSX and JSON.\r\n\r\nThe CSV file I get on v1.49.8 is this:\r\n\r\n```\r\nproof\r\n-0.6\r\n```\r\n\r\nExpected result is:\r\n\r\n```\r\nproof\r\n-0.57\r\n```\r\n\r\nJSON returned is:\r\n\r\n```json\r\n[\r\n{""proof"":""-0.6""}\r\n]\r\n```\r\n\r\nexpected result is:\r\n\r\n```json\r\n[\r\n{""proof"":""-0.57""}\r\n]\r\n```\r\n\r\nXSLS has the correct value of `-0.57`.\r\n\r\nI’m running the query against a PostgreSQL database. Not sure how/if this is reproducible against other database types.', 'created_at': datetime.datetime(2024, 5, 15, 2, 12, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2112282735, 'issue_id': 2253144076, 'author': 'FilmonK', 'body': 'I’ve been testing this on versions 1.49.6, 1.49.8 and 1.49.10 with a postgres (15.3) table.\r\n\r\n<img width=""272"" alt=""Screenshot 2024-05-15 at 6 03 06 AM"" src=""https://github.com/metabase/metabase/assets/17398657/e25fac2f-7693-4ea6-a71b-069815689d53"">\r\n\r\n<br>\r\n<br>\r\n\r\n\r\nI’m using both the GUI and native sql to generate questions, present on dashboard, and export to CSV, XLS, and JSON.\r\nThey all have been exporting without the rounding issue.\r\n\r\n<br>\r\n<br>\r\n\r\nWhere I do encounter rounding is when running a query as you have but with a negative value.\r\n\r\n`SELECT -0.43 tax_value` will export as -0.4\r\n\r\nPositive values such as the following produce the expected results on downloads.\r\n```\r\nSELECT\xa0 0.43 tax_value\r\nSELECT\xa0 27.43 tax_value\r\nSELECT\xa0 8.48\xa0 tax_value\r\n```\r\n\r\nMatid, could you give that a try and see what results you get on your end?\r\nAlso, I’ll put this in the support ticket you’ve opened up as it’ll be easier to communicate there.', 'created_at': datetime.datetime(2024, 5, 15, 11, 30, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2176464530, 'issue_id': 2253144076, 'author': 'jkwalsh92', 'body': '@zbodi74 any update on this one?', 'created_at': datetime.datetime(2024, 6, 18, 16, 3, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2228916116, 'issue_id': 2253144076, 'author': 'dhelland', 'body': ""We're experiencing this issue, too. Any update? Thanks for your awesome work!"", 'created_at': datetime.datetime(2024, 7, 15, 16, 29, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2230662119, 'issue_id': 2253144076, 'author': 'djuarezg', 'body': 'We are experiencing the same issue but not just for CSV, also for the UI as well. No matter if we select Full ""Auto formatting"" instead of Compact, it still removes all the decimals and rounds to 2 (Before we were getting 7 decimals, now just 2).', 'created_at': datetime.datetime(2024, 7, 16, 11, 29, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2230824231, 'issue_id': 2253144076, 'author': 'paoliniluis', 'body': 'All this happens in v49?', 'created_at': datetime.datetime(2024, 7, 16, 12, 56, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2231370286, 'issue_id': 2253144076, 'author': 'dhelland', 'body': ""> All this happens in v49?\n\nWe're on 49.1. \n\nOf note, we're only seeing the behavior on negative numbers. So -4.35 downloads as -4.40, but 4.35 downloads correctly as 4.35."", 'created_at': datetime.datetime(2024, 7, 16, 16, 39, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2240092346, 'issue_id': 2253144076, 'author': 'paoliniluis', 'body': '@dhelland can you upgrade to the latest v49 and tell us if this keeps happening?', 'created_at': datetime.datetime(2024, 7, 19, 20, 57, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2241096691, 'issue_id': 2253144076, 'author': 'matid', 'body': 'We’re on v1.49.21 (most recent Metabase Cloud) and the issue still persists.', 'created_at': datetime.datetime(2024, 7, 20, 11, 30, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2246737345, 'issue_id': 2253144076, 'author': 'perivamsi', 'body': '[You can export the unformatted results of a question by holding the option key on a Mac or the Alt key on PC when selecting the file format for your download.](https://www.metabase.com/docs/latest/questions/sharing/exporting-results#exporting-unformatted-results)', 'created_at': datetime.datetime(2024, 7, 24, 2, 22, 38, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 07:30:06 UTC): hi, can you tell us if this is a GUI or SQL question? can you reproduce with the sample database? also, can you move to 49.6?

paoliniluis on (2024-04-30 19:29:12 UTC): @jkwalsh92 we need to know how to reproduce or we'll close the issue

jkwalsh92 (Issue Creator) on (2024-04-30 19:39:00 UTC): @paoliniluis this is a gui issue and yep will try updating

matid on (2024-05-15 02:12:17 UTC): @paoliniluis We’ve run into this too. Here are steps to reproduce.

1. Add a new native query.
2. Use `select -0.57 proof` as the query
3. Download full results as CSV, XLSX and JSON.

The CSV file I get on v1.49.8 is this:

```
proof
-0.6
```

Expected result is:

```
proof
-0.57
```

JSON returned is:

```json
[
{""proof"":""-0.6""}
]
```

expected result is:

```json
[
{""proof"":""-0.57""}
]
```

XSLS has the correct value of `-0.57`.

I’m running the query against a PostgreSQL database. Not sure how/if this is reproducible against other database types.

FilmonK on (2024-05-15 11:30:06 UTC): I’ve been testing this on versions 1.49.6, 1.49.8 and 1.49.10 with a postgres (15.3) table.

<img width=""272"" alt=""Screenshot 2024-05-15 at 6 03 06 AM"" src=""https://github.com/metabase/metabase/assets/17398657/e25fac2f-7693-4ea6-a71b-069815689d53"">

<br>
<br>


I’m using both the GUI and native sql to generate questions, present on dashboard, and export to CSV, XLS, and JSON.
They all have been exporting without the rounding issue.

<br>
<br>

Where I do encounter rounding is when running a query as you have but with a negative value.

`SELECT -0.43 tax_value` will export as -0.4

Positive values such as the following produce the expected results on downloads.
```
SELECT  0.43 tax_value
SELECT  27.43 tax_value
SELECT  8.48  tax_value
```

Matid, could you give that a try and see what results you get on your end?
Also, I’ll put this in the support ticket you’ve opened up as it’ll be easier to communicate there.

jkwalsh92 (Issue Creator) on (2024-06-18 16:03:33 UTC): @zbodi74 any update on this one?

dhelland on (2024-07-15 16:29:51 UTC): We're experiencing this issue, too. Any update? Thanks for your awesome work!

djuarezg on (2024-07-16 11:29:58 UTC): We are experiencing the same issue but not just for CSV, also for the UI as well. No matter if we select Full ""Auto formatting"" instead of Compact, it still removes all the decimals and rounds to 2 (Before we were getting 7 decimals, now just 2).

paoliniluis on (2024-07-16 12:56:31 UTC): All this happens in v49?

dhelland on (2024-07-16 16:39:03 UTC): We're on 49.1. 

Of note, we're only seeing the behavior on negative numbers. So -4.35 downloads as -4.40, but 4.35 downloads correctly as 4.35.

paoliniluis on (2024-07-19 20:57:03 UTC): @dhelland can you upgrade to the latest v49 and tell us if this keeps happening?

matid on (2024-07-20 11:30:15 UTC): We’re on v1.49.21 (most recent Metabase Cloud) and the issue still persists.

perivamsi on (2024-07-24 02:22:38 UTC): [You can export the unformatted results of a question by holding the option key on a Mac or the Alt key on PC when selecting the file format for your download.](https://www.metabase.com/docs/latest/questions/sharing/exporting-results#exporting-unformatted-results)

"
2253074723,issue,closed,completed,"Date format ""January 31, 2018"" missing day in csv download","### Describe the bug

For charts with the date format ""January 31, 2018"", if you download the data as csv, the dates are missing the day part e.g. April, 2024, 3 AM (instead of April 19, 2024, 3 AM). See 
[query_result_2024-04-19T13_40_01.148187Z.csv](https://github.com/metabase/metabase/files/15041189/query_result_2024-04-19T13_40_01.148187Z.csv). 
  
If you download as xslx the date is formatted correctly. 




### To Reproduce

1. Using the sample database, create a question using 'Orders'
2. Summarise 'Average of Tax' by 'Created At: Hour'
3. Visualise
4. Download as csv

![image](https://github.com/metabase/metabase/assets/167540815/104c229d-d340-4c65-ba13-9bdcae33c52b)



### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.213-201.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""redshift"",
      ""postgres"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v1.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""UTC""
    }
  }
}
```


### Severity

Moderate as it can be worked around by downloading xlsx instead

### Additional context

_No response_",sthomas-mflow,2024-04-19 13:48:48+00:00,['adam-james-v'],2024-05-02 09:37:05+00:00,2024-04-22 23:02:13+00:00,https://github.com/metabase/metabase/issues/41639,"[('Type:Bug', 'Product defects'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2066636623, 'issue_id': 2253074723, 'author': 'sthomas-mflow', 'body': ""I can't seem to add a label for it but I'm pretty sure this is a regression"", 'created_at': datetime.datetime(2024, 4, 19, 13, 52, 3, tzinfo=datetime.timezone.utc)}]","sthomas-mflow (Issue Creator) on (2024-04-19 13:52:03 UTC): I can't seem to add a label for it but I'm pretty sure this is a regression

"
2252766766,issue,closed,completed,Embedding Preview doesn't behave like Metabase Application when filter is locked and linked,"### Describe the bug

Currently Metabase `!=` Embedding Preview `!=` to Static Embedding ... none of those 3 situations behave the same. This bug will consider Metabase `!=` Embedding Preview

### To Reproduce

So i setup a dashboard with 3 filters all mapping to the column category but the first filter is linked to the second one:

![image](https://github.com/metabase/metabase/assets/110378427/fae84228-46fe-42f3-9114-8776fd1ba02e)

and when I try to filter on the first value (and assigning values to the other filters) using these filters:
(2nd) Text 1: Doohickey
(3rd) Text 2: Gizmo, Gadget

I get the proper results:

![image](https://github.com/metabase/metabase/assets/110378427/5ec8653a-cb76-44f7-995c-75687b8516df)

On the other hand i get completely different behaviour in preview embedding

![image](https://github.com/metabase/metabase/assets/110378427/e279db17-0ab8-46e9-8ed2-f18fee020479)


### Expected behavior

Metabase = Embedding Preview



### Logs

None that are relevant

### Information about your Metabase installation

```JSON
1.49.6
```


### Severity

Cosmetic because it's just at preview level

### Additional context

Similar to https://github.com/metabase/metabase/issues/41586",Tony-metabase,2024-04-19 11:39:49+00:00,['WiNloSt'],2024-05-09 14:23:34+00:00,2024-05-08 17:54:18+00:00,https://github.com/metabase/metabase/issues/41635,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Backend', ''), ('Embedding/Static', 'Static embedding, previously known as signed embedding'), ('.Team/Embedding', '')]","[{'comment_id': 2071332109, 'issue_id': 2252766766, 'author': 'WiNloSt', 'body': ""Since this issue is split from #41586. I'll repost [my comment](https://github.com/metabase/metabase/issues/41586#issuecomment-2066053566) which was specifically for the preview issue.\r\n\r\n> I can confirm that the preview and the embed behave differently. I updated the issue description with proper filter values to reproduce the issue. You need to set (3rd) Text 2 filter to have any values except Doohicky for this to happen.\r\n> \r\n> The difference in the behavior is that when we query on preview, we call `GET /api/dashboard/:id/params/:param-key/values` to get the values. This would behave differently from when we're actually call on the dashboard since it would pass the linked parameter in the URL `GET /api/dashboard/:id/params/:param-key/values?:linked-param-key=Doohickey`.\r\n> \r\n> When we call this on embed it's `GET /api/embed/dashboard/:jwt/params/:param-key/values`. And BE could use the parameter values inside the :jwt filter proper results.\r\n> \r\n> I think what we should do here is to add an equivalent endpoint in [`preview_embed`](https://github.com/metabase/metabase/blob/2ab84940ed15658a35a50049f260c688409c71c3/src/metabase/api/preview_embed.clj) endpoint so we could call `GET /api/preview_embed/dashboard/:jwt/params/:param-key/values` instead of using the dashboard endpoint."", 'created_at': datetime.datetime(2024, 4, 23, 3, 16, 52, tzinfo=datetime.timezone.utc)}]","WiNloSt (Assginee) on (2024-04-23 03:16:52 UTC): Since this issue is split from #41586. I'll repost [my comment](https://github.com/metabase/metabase/issues/41586#issuecomment-2066053566) which was specifically for the preview issue.

"
2252625172,issue,closed,completed,Uploaded model not showing latest rows appended to the underlying table,"### Describe the bug

When appending new rows to an existing Uploaded model it can appear that the action ""succeeds"" but no new data is actually added. This appears to be an issue with the model however, the underlying table appears to be updated as expected. Perhaps this is a caching issue?

This is sporadic issue and hard to reproduce, but one a given model is being affected the issue persists even when additional appends are made.

You can see the issue in action during [this portion of the Metabase 49 webinar](https://youtu.be/iig0-CoZLbw?si=irWaWpHZMdo7b2LV&t=1358). 🙈 

### To Reproduce

1. Go to [this uploaded model](https://stats.metabase.com/model/17094-pixarmovies)
2. Notice that 27 rows are being shown.
3. Append this file: [Pixar Movies(2).csv](https://github.com/metabase/metabase/files/15038812/Pixar.Movies.2.csv)
4. Wait for upload to succeed and model to refresh.
5. Notice that there are still only 27 rows being shown, i.e. it looks like nothing was appended.
6. Go to a [question that queries the underlying model directly](https://stats.metabase.com/question/17191-pixarmovies-direct-query-to-20240415131022/notebook).
7. Notice that there are a bunch of extra rows, a bunch of duplicates from the file above being appended multiple times.

Converting the model into a native question also appears to resolve the issue.

### Expected behavior

I expect the model to display all the newly appended rows after the upload succeeds.

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Server: stats.metabase.com 
- Built on: 2024-04-17
- Commit: 39cf70c
- Version: pre-50.0
```


### Severity

P2

### Additional context

_No response_",crisptrutski,2024-04-19 10:23:59+00:00,['crisptrutski'],2024-04-26 07:42:24+00:00,2024-04-23 17:14:02+00:00,https://github.com/metabase/metabase/issues/41630,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Models', 'aka Datasets')]","[{'comment_id': 2066384762, 'issue_id': 2252625172, 'author': 'crisptrutski', 'body': 'Interestingly enough the ""stale"" results are not cached according to the server response.\r\n\r\n![Screenshot 2024-04-19 at 13 31 40](https://github.com/metabase/metabase/assets/881351/70d07d0f-dafe-4642-a581-793466c00128)', 'created_at': datetime.datetime(2024, 4, 19, 11, 33, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2066419859, 'issue_id': 2252625172, 'author': 'crisptrutski', 'body': '~~@camsaul Do you have any idea why we\'re getting stale data when querying the model?~~ thanks Cal\r\n\r\n```sql\r\nselect table_id, dataset_query from report_card where id = 17094;\r\n```\r\ntable_id | dataset_query\r\n--|--\r\n50008 | `{""database"":26,""query"":{""source-table"":50008},""type"":""query""}`\r\n\r\nYet when we process the queries:\r\n\r\nQuery | Row count\r\n--|--\r\n`{""source-table"": ""card__17094""}` | 27\r\n`{""source-table"": 50008}`| 60', 'created_at': datetime.datetime(2024, 4, 19, 11, 57, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2066516953, 'issue_id': 2252625172, 'author': 'calherries', 'body': '(copied from slack)\r\n\r\nThis is an issue with using CSV uploads with model caching turned on.\r\n\r\nThis is what I did:\r\n1. I went to [this uploaded model](https://stats.metabase.com/model/17094-pixarmovies)\r\n2. Noticed that 27 rows are being shown.\r\n 3.  Turned off model caching. There’s now 60 rows\r\n\r\nSo the issue is with uploads, because model caching is working as expected. We should know to invalidate the model’s cache when a user uploads the rows to a table.\r\n\r\nIt’s a little complicated because we’d need to get the models that use the table, because append/replace are table APIs, not model ones. That’s relatively simple to do because we only need to invalidate models where the upload table is the base table for the model, and we can use `report_card.table_id`.', 'created_at': datetime.datetime(2024, 4, 19, 12, 53, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2066619545, 'issue_id': 2252625172, 'author': 'crisptrutski', 'body': 'Nice, good to know it\'s a fairly isolated issue. \r\n\r\nI\'m not sure that busting caches when we upload is the right call, there\'s another part of me that thinks it\'s very strange to automatically cache ""no-op"" models if that wouldn\'t give a perf benefit. There are at least three ways to fix it that I see:\r\n\r\n1. Cache busting.\r\n2. Being more selective about when models get automatic caching.\r\n3. Being more selective about when the cache is actually created / QP actually uses it.\r\n\r\nThere are pros and cons with each, going to chat to @luizarakaki about it.', 'created_at': datetime.datetime(2024, 4, 19, 13, 42, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2067042933, 'issue_id': 2252625172, 'author': 'crisptrutski', 'body': ""While (3) is quite attractive in some ways, it's a much lower level change. Option (1) is very localized and can be done internally by our team, and directly targets the user pain, so we're starting there - at least for patching 49.\r\n\r\nHere are the notes I made from our discussion: [notion](https://www.notion.so/metabase/CSV-Uploads-Model-Caching-90d966ea4b1c4fa09379559203f0406f)"", 'created_at': datetime.datetime(2024, 4, 19, 17, 55, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2068924858, 'issue_id': 2252625172, 'author': 'calherries', 'body': 'For reference, we have a similar problem with actions and model caching https://github.com/metabase/metabase/issues/33149. \r\n\r\ne.g. inserting a row with an action will not be reflected in metabase if model caching is enabled on the model', 'created_at': datetime.datetime(2024, 4, 22, 9, 30, 13, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-04-19 11:33:37 UTC): Interestingly enough the ""stale"" results are not cached according to the server response.

![Screenshot 2024-04-19 at 13 31 40](https://github.com/metabase/metabase/assets/881351/70d07d0f-dafe-4642-a581-793466c00128)

crisptrutski (Issue Creator) on (2024-04-19 11:57:53 UTC): ~~@camsaul Do you have any idea why we're getting stale data when querying the model?~~ thanks Cal

```sql
select table_id, dataset_query from report_card where id = 17094;
```
table_id | dataset_query
--|--
50008 | `{""database"":26,""query"":{""source-table"":50008},""type"":""query""}`

Yet when we process the queries:

Query | Row count
--|--
`{""source-table"": ""card__17094""}` | 27
`{""source-table"": 50008}`| 60

calherries on (2024-04-19 12:53:40 UTC): (copied from slack)

This is an issue with using CSV uploads with model caching turned on.

This is what I did:
1. I went to [this uploaded model](https://stats.metabase.com/model/17094-pixarmovies)
2. Noticed that 27 rows are being shown.
 3.  Turned off model caching. There’s now 60 rows

So the issue is with uploads, because model caching is working as expected. We should know to invalidate the model’s cache when a user uploads the rows to a table.

It’s a little complicated because we’d need to get the models that use the table, because append/replace are table APIs, not model ones. That’s relatively simple to do because we only need to invalidate models where the upload table is the base table for the model, and we can use `report_card.table_id`.

crisptrutski (Issue Creator) on (2024-04-19 13:42:38 UTC): Nice, good to know it's a fairly isolated issue. 

I'm not sure that busting caches when we upload is the right call, there's another part of me that thinks it's very strange to automatically cache ""no-op"" models if that wouldn't give a perf benefit. There are at least three ways to fix it that I see:

1. Cache busting.
2. Being more selective about when models get automatic caching.
3. Being more selective about when the cache is actually created / QP actually uses it.

There are pros and cons with each, going to chat to @luizarakaki about it.

crisptrutski (Issue Creator) on (2024-04-19 17:55:04 UTC): While (3) is quite attractive in some ways, it's a much lower level change. Option (1) is very localized and can be done internally by our team, and directly targets the user pain, so we're starting there - at least for patching 49.

Here are the notes I made from our discussion: [notion](https://www.notion.so/metabase/CSV-Uploads-Model-Caching-90d966ea4b1c4fa09379559203f0406f)

calherries on (2024-04-22 09:30:13 UTC): For reference, we have a similar problem with actions and model caching https://github.com/metabase/metabase/issues/33149. 

e.g. inserting a row with an action will not be reflected in metabase if model caching is enabled on the model

"
2252597379,issue,closed,completed,`dependent-metadata` does not return the table underlying the metric,"https://metaboat.slack.com/archives/C051AG38B2S/p1713276320308289?thread_ts=1713200875.104199&cid=C051AG38B2S

> dependent-metadata needs to be called twice when creating a metric based question. the first time around it would tell to load the metadata of the card, and the second time (when it can look at the metadata of the card), **it will tell to load the metadata of the table underlying the metric (card).**

The behavior in bold does not seem to work.

### Reproduction steps

1. `git checkout 41520-load-metadata`
2. New -> Metric
3. Select Orders table as source
4. Aggregate by Count
5. Run it and Save it
6. Start a new question
7. Choose previously created metric as a data source
8. Observe results of `dependentMetadata` calls in `loadMetadataForCard` - the orders table is never returned",kamilmielnik,2024-04-19 10:08:10+00:00,[],2024-08-28 02:10:42+00:00,2024-04-26 17:30:54+00:00,https://github.com/metabase/metabase/issues/41628,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Team/Querying', '')]",[],
2252578391,issue,open,,GuassDB driver,"GuassDB is a very popular MPP database in China, especially in large projects. I hope GuassDB can be supported to facilitate the use of metabase in large-scale projects",cowcomic,2024-04-19 09:58:23+00:00,[],2025-02-04 20:30:53+00:00,,https://github.com/metabase/metabase/issues/41627,"[('Database/', ''), ('Type:New Feature', '')]","[{'comment_id': 2066425619, 'issue_id': 2252578391, 'author': 'paoliniluis', 'body': 'Have you tried connecting to the db with the Postgres driver?', 'created_at': datetime.datetime(2024, 4, 19, 12, 1, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2207853674, 'issue_id': 2252578391, 'author': 'cowcomic', 'body': 'I tried to connect to guassdb by postgresql\r\n![image](https://github.com/metabase/metabase/assets/4745969/aca26df5-8928-43f6-9b89-411d5790af35)\r\n\r\n\r\nthe error as follows\r\n```\r\n[a0ec80b6-e8e3-4084-a3ab-8009bcc3597b] 2024-07-04T09:33:28+08:00 WARN metabase.sync.util Error in sync step Sync metadata for postgres Database 7 \'\'测试GuassDB\'\',org.postgresql.util.PSQLException: ERROR: relation ""pg_catalog.pg_matviews"" does not exist,  Position: 866,\r\n\tat org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725),\r\n\tat org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412),\r\n\tat org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371),\r\n\tat org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502),\r\n\tat org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419),\r\n\tat org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194),\r\n\tat org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:137),\r\n\tat com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:1471),\r\n\tat clojure.java.jdbc$execute_query_with_params.invokeStatic(jdbc.clj:1090),\r\n\tat clojure.java.jdbc$execute_query_with_params.invoke(jdbc.clj:1084),\r\n\tat clojure.java.jdbc$db_query_with_resultset_STAR_.invokeStatic(jdbc.clj:1106),\r\n\tat clojure.java.jdbc$db_query_with_resultset_STAR_.invoke(jdbc.clj:1093),\r\n\tat clojure.java.jdbc$query.invokeStatic(jdbc.clj:1182),\r\n\tat clojure.java.jdbc$query.invoke(jdbc.clj:1144),\r\n\tat clojure.java.jdbc$query.invokeStatic(jdbc.clj:1160),\r\n\tat clojure.java.jdbc$query.invoke(jdbc.clj:1144),\r\n\tat metabase.driver.postgres$fn__83866.invokeStatic(postgres.clj:861),\r\n\tat metabase.driver.postgres$fn__83866.doInvoke(postgres.clj:857),\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:425),\r\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:234),\r\n\tat metabase.driver.sql_jdbc.sync.describe_database$schema_PLUS_table_with_select_privileges.invokeStatic(describe_database.clj:119),\r\n\tat metabase.driver.sql_jdbc.sync.describe_database$schema_PLUS_table_with_select_privileges.invoke(describe_database.clj:117),\r\n\tat metabase.driver.sql_jdbc.sync.describe_database$have_select_privilege_fn.invokeStatic(describe_database.clj:137),\r\n\tat metabase.driver.sql_jdbc.sync.describe_database$have_select_privilege_fn.invoke(describe_database.clj:125),\r\n\tat metabase.driver.sql_jdbc.sync.describe_database$fast_active_tables.invokeStatic(describe_database.clj:159),\r\n\tat metabase.driver.sql_jdbc.sync.describe_database$fast_active_tables.doInvoke(describe_database.clj:148),\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:490),\r\n\tat metabase.driver.sql_jdbc.sync.describe_database$fn__81004.invokeStatic(describe_database.clj:167),\r\n\tat metabase.driver.sql_jdbc.sync.describe_database$fn__81004.invoke(describe_database.clj:165),\r\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:244),\r\n\tat metabase.driver.sql_jdbc.sync.describe_database$describe_database$fn__81023.invoke(describe_database.clj:218),\r\n\tat metabase.driver.sql_jdbc.execute$fn__78824$fn__78825.invoke(execute.clj:388),\r\n\tat metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334),\r\n\tat metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:317),\r\n\tat metabase.driver.sql_jdbc.execute$fn__78824.invokeStatic(execute.clj:382),\r\n\tat metabase.driver.sql_jdbc.execute$fn__78824.invoke(execute.clj:380),\r\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:244),\r\n\tat metabase.driver.sql_jdbc.sync.describe_database$describe_database.invokeStatic(describe_database.clj:201),\r\n\tat metabase.driver.sql_jdbc.sync.describe_database$describe_database.invoke(describe_database.clj:196),\r\n\tat metabase.driver.sql_jdbc$fn__106350.invokeStatic(sql_jdbc.clj:90),\r\n\tat metabase.driver.sql_jdbc$fn__106350.invoke(sql_jdbc.clj:88),\r\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:234),\r\n\tat metabase.sync.fetch_metadata$db_metadata.invokeStatic(fetch_metadata.clj:17),\r\n\tat metabase.sync.fetch_metadata$db_metadata.invoke(fetch_metadata.clj:14),\r\n\tat metabase.sync.sync_metadata$sync_db_metadata_BANG_$fn__82096.invoke(sync_metadata.clj:69),\r\n\tat metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:190),\r\n\tat metabase.sync.util$do_with_error_handling.invoke(util.clj:183),\r\n\tat clojure.core$partial$fn__5910.invoke(core.clj:2647),\r\n\tat metabase.driver$fn__49747.invokeStatic(driver.clj:759),\r\n\tat metabase.driver$fn__49747.invoke(driver.clj:759),\r\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:239),\r\n\tat metabase.sync.util$sync_in_context$fn__60065.invoke(util.clj:166),\r\n\tat metabase.sync.util$with_db_logging_disabled$fn__60062.invoke(util.clj:158),\r\n\tat metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:131),\r\n\tat metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:125),\r\n\tat metabase.sync.util$with_start_and_finish_logging$fn__60049.invoke(util.clj:143),\r\n\tat metabase.sync.util$with_sync_events$fn__60044.invoke(util.clj:117),\r\n\tat metabase.sync.util$with_duplicate_ops_prevented$fn__60031.invoke(util.clj:89),\r\n\tat metabase.sync.util$do_sync_operation.invokeStatic(util.clj:215),\r\n\tat metabase.sync.util$do_sync_operation.invoke(util.clj:209),\r\n\tat metabase.sync.sync_metadata$sync_db_metadata_BANG_.invokeStatic(sync_metadata.clj:68),\r\n\tat metabase.sync.sync_metadata$sync_db_metadata_BANG_.invoke(sync_metadata.clj:65),\r\n\tat metabase.sync$sync_database_BANG_$fn__82106.invoke(sync.clj:52),\r\n\tat metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:190),\r\n\tat metabase.sync.util$do_with_error_handling.invoke(util.clj:183),\r\n\tat clojure.core$partial$fn__5910.invoke(core.clj:2647),\r\n\tat metabase.driver$fn__49747.invokeStatic(driver.clj:759),\r\n\tat metabase.driver$fn__49747.invoke(driver.clj:759),\r\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:239),\r\n\tat metabase.sync.util$sync_in_context$fn__60065.invoke(util.clj:166),\r\n\tat metabase.sync.util$with_db_logging_disabled$fn__60062.invoke(util.clj:158),\r\n\tat metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:131),\r\n\tat metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:125),\r\n\tat metabase.sync.util$with_start_and_finish_logging$fn__60049.invoke(util.clj:143),\r\n\tat metabase.sync.util$with_sync_events$fn__60044.invoke(util.clj:117),\r\n\tat metabase.sync.util$with_duplicate_ops_prevented$fn__60031.invoke(util.clj:89),\r\n\tat metabase.sync.util$do_sync_operation.invokeStatic(util.clj:215),\r\n\tat metabase.sync.util$do_sync_operation.invoke(util.clj:209),\r\n\tat metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:51),\r\n\tat metabase.sync$sync_database_BANG_.invoke(sync.clj:37),\r\n\tat metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:46),\r\n\tat metabase.sync$sync_database_BANG_.invoke(sync.clj:37),\r\n\tat metabase.events.sync_database$publish_event_BANG__primary_method_metabase_events_sync_database_event$fn__103799.invoke(sync_database.clj:24),\r\n\tat clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047),\r\n\tat clojure.lang.AFn.call(AFn.java:18),\r\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source),\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),\r\n\tat java.base/java.lang.Thread.run(Unknown Source)\r\n[a0ec80b6-e8e3-4084-a3ab-8009bcc3597b] 2024-07-04T09:33:28+08:00 INFO metabase.sync.util FINISHED: Sync postgres Database 7 \'\'测试GuassDB\'\' (258.7 ms)\r\n[a0ec80b6-e8e3-4084-a3ab-8009bcc3597b] 2024-07-04T09:33:28+08:00 WARN metabase.sync.util Error in sync step Sync postgres Database 7 \'\'测试GuassDB\'\',java.lang.ClassCastException: class org.postgresql.util.PSQLException cannot be cast to class clojure.lang.Associative (org.postgresql.util.PSQLException and clojure.lang.Associative are in unnamed module of loader \'app\'),\r\n\tat clojure.lang.RT.assoc(RT.java:827),\r\n\tat clojure.core$assoc__5481.invokeStatic(core.clj:193),\r\n\tat clojure.core$assoc__5481.invoke(core.clj:192),\r\n\tat metabase.sync$sync_database_BANG_$fn__82106.invoke(sync.clj:52),\r\n\tat metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:190),\r\n\tat metabase.sync.util$do_with_error_handling.invoke(util.clj:183),\r\n\tat clojure.core$partial$fn__5910.invoke(core.clj:2647),\r\n\tat metabase.driver$fn__49747.invokeStatic(driver.clj:759),\r\n\tat metabase.driver$fn__49747.invoke(driver.clj:759),\r\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:239),\r\n\tat metabase.sync.util$sync_in_context$fn__60065.invoke(util.clj:166),\r\n\tat metabase.sync.util$with_db_logging_disabled$fn__60062.invoke(util.clj:158),\r\n\tat metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:131),\r\n\tat metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:125),\r\n\tat metabase.sync.util$with_start_and_finish_logging$fn__60049.invoke(util.clj:143),\r\n\tat metabase.sync.util$with_sync_events$fn__60044.invoke(util.clj:117),\r\n\tat metabase.sync.util$with_duplicate_ops_prevented$fn__60031.invoke(util.clj:89),\r\n\tat metabase.sync.util$do_sync_operation.invokeStatic(util.clj:215),\r\n\tat metabase.sync.util$do_sync_operation.invoke(util.clj:209),\r\n\tat metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:51),\r\n\tat metabase.sync$sync_database_BANG_.invoke(sync.clj:37),\r\n\tat metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:46),\r\n\tat metabase.sync$sync_database_BANG_.invoke(sync.clj:37),\r\n\tat metabase.events.sync_database$publish_event_BANG__primary_method_metabase_events_sync_database_event$fn__103799.invoke(sync_database.clj:24),\r\n\tat clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047),\r\n\tat clojure.lang.AFn.call(AFn.java:18),\r\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source),\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),\r\n\tat java.base/java.lang.Thread.run(Unknown Source)\r\n\r\n```', 'created_at': datetime.datetime(2024, 7, 4, 1, 47, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2402789697, 'issue_id': 2252578391, 'author': 'paoliniluis', 'body': ""So it seems that the GuassDB folks don't have the postgres views that we need to sync. I would suggest you to contact them @cowcomic"", 'created_at': datetime.datetime(2024, 10, 9, 16, 30, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2404212531, 'issue_id': 2252578391, 'author': 'cowcomic', 'body': ""> So it seems that the GuassDB folks don't have the postgres views that we need to sync. I would suggest you to contact them [@cowcomic](https://github.com/cowcomic)\n\nI also hope that metabase can directly support this driver"", 'created_at': datetime.datetime(2024, 10, 10, 7, 1, 33, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-19 12:01:48 UTC): Have you tried connecting to the db with the Postgres driver?

cowcomic (Issue Creator) on (2024-07-04 01:47:21 UTC): I tried to connect to guassdb by postgresql
![image](https://github.com/metabase/metabase/assets/4745969/aca26df5-8928-43f6-9b89-411d5790af35)


the error as follows
```
[a0ec80b6-e8e3-4084-a3ab-8009bcc3597b] 2024-07-04T09:33:28+08:00 WARN metabase.sync.util Error in sync step Sync metadata for postgres Database 7 ''测试GuassDB'',org.postgresql.util.PSQLException: ERROR: relation ""pg_catalog.pg_matviews"" does not exist,  Position: 866,
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725),
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412),
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371),
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502),
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419),
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194),
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:137),
	at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:1471),
	at clojure.java.jdbc$execute_query_with_params.invokeStatic(jdbc.clj:1090),
	at clojure.java.jdbc$execute_query_with_params.invoke(jdbc.clj:1084),
	at clojure.java.jdbc$db_query_with_resultset_STAR_.invokeStatic(jdbc.clj:1106),
	at clojure.java.jdbc$db_query_with_resultset_STAR_.invoke(jdbc.clj:1093),
	at clojure.java.jdbc$query.invokeStatic(jdbc.clj:1182),
	at clojure.java.jdbc$query.invoke(jdbc.clj:1144),
	at clojure.java.jdbc$query.invokeStatic(jdbc.clj:1160),
	at clojure.java.jdbc$query.invoke(jdbc.clj:1144),
	at metabase.driver.postgres$fn__83866.invokeStatic(postgres.clj:861),
	at metabase.driver.postgres$fn__83866.doInvoke(postgres.clj:857),
	at clojure.lang.RestFn.invoke(RestFn.java:425),
	at clojure.lang.MultiFn.invoke(MultiFn.java:234),
	at metabase.driver.sql_jdbc.sync.describe_database$schema_PLUS_table_with_select_privileges.invokeStatic(describe_database.clj:119),
	at metabase.driver.sql_jdbc.sync.describe_database$schema_PLUS_table_with_select_privileges.invoke(describe_database.clj:117),
	at metabase.driver.sql_jdbc.sync.describe_database$have_select_privilege_fn.invokeStatic(describe_database.clj:137),
	at metabase.driver.sql_jdbc.sync.describe_database$have_select_privilege_fn.invoke(describe_database.clj:125),
	at metabase.driver.sql_jdbc.sync.describe_database$fast_active_tables.invokeStatic(describe_database.clj:159),
	at metabase.driver.sql_jdbc.sync.describe_database$fast_active_tables.doInvoke(describe_database.clj:148),
	at clojure.lang.RestFn.invoke(RestFn.java:490),
	at metabase.driver.sql_jdbc.sync.describe_database$fn__81004.invokeStatic(describe_database.clj:167),
	at metabase.driver.sql_jdbc.sync.describe_database$fn__81004.invoke(describe_database.clj:165),
	at clojure.lang.MultiFn.invoke(MultiFn.java:244),
	at metabase.driver.sql_jdbc.sync.describe_database$describe_database$fn__81023.invoke(describe_database.clj:218),
	at metabase.driver.sql_jdbc.execute$fn__78824$fn__78825.invoke(execute.clj:388),
	at metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334),
	at metabase.driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:317),
	at metabase.driver.sql_jdbc.execute$fn__78824.invokeStatic(execute.clj:382),
	at metabase.driver.sql_jdbc.execute$fn__78824.invoke(execute.clj:380),
	at clojure.lang.MultiFn.invoke(MultiFn.java:244),
	at metabase.driver.sql_jdbc.sync.describe_database$describe_database.invokeStatic(describe_database.clj:201),
	at metabase.driver.sql_jdbc.sync.describe_database$describe_database.invoke(describe_database.clj:196),
	at metabase.driver.sql_jdbc$fn__106350.invokeStatic(sql_jdbc.clj:90),
	at metabase.driver.sql_jdbc$fn__106350.invoke(sql_jdbc.clj:88),
	at clojure.lang.MultiFn.invoke(MultiFn.java:234),
	at metabase.sync.fetch_metadata$db_metadata.invokeStatic(fetch_metadata.clj:17),
	at metabase.sync.fetch_metadata$db_metadata.invoke(fetch_metadata.clj:14),
	at metabase.sync.sync_metadata$sync_db_metadata_BANG_$fn__82096.invoke(sync_metadata.clj:69),
	at metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:190),
	at metabase.sync.util$do_with_error_handling.invoke(util.clj:183),
	at clojure.core$partial$fn__5910.invoke(core.clj:2647),
	at metabase.driver$fn__49747.invokeStatic(driver.clj:759),
	at metabase.driver$fn__49747.invoke(driver.clj:759),
	at clojure.lang.MultiFn.invoke(MultiFn.java:239),
	at metabase.sync.util$sync_in_context$fn__60065.invoke(util.clj:166),
	at metabase.sync.util$with_db_logging_disabled$fn__60062.invoke(util.clj:158),
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:131),
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:125),
	at metabase.sync.util$with_start_and_finish_logging$fn__60049.invoke(util.clj:143),
	at metabase.sync.util$with_sync_events$fn__60044.invoke(util.clj:117),
	at metabase.sync.util$with_duplicate_ops_prevented$fn__60031.invoke(util.clj:89),
	at metabase.sync.util$do_sync_operation.invokeStatic(util.clj:215),
	at metabase.sync.util$do_sync_operation.invoke(util.clj:209),
	at metabase.sync.sync_metadata$sync_db_metadata_BANG_.invokeStatic(sync_metadata.clj:68),
	at metabase.sync.sync_metadata$sync_db_metadata_BANG_.invoke(sync_metadata.clj:65),
	at metabase.sync$sync_database_BANG_$fn__82106.invoke(sync.clj:52),
	at metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:190),
	at metabase.sync.util$do_with_error_handling.invoke(util.clj:183),
	at clojure.core$partial$fn__5910.invoke(core.clj:2647),
	at metabase.driver$fn__49747.invokeStatic(driver.clj:759),
	at metabase.driver$fn__49747.invoke(driver.clj:759),
	at clojure.lang.MultiFn.invoke(MultiFn.java:239),
	at metabase.sync.util$sync_in_context$fn__60065.invoke(util.clj:166),
	at metabase.sync.util$with_db_logging_disabled$fn__60062.invoke(util.clj:158),
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:131),
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:125),
	at metabase.sync.util$with_start_and_finish_logging$fn__60049.invoke(util.clj:143),
	at metabase.sync.util$with_sync_events$fn__60044.invoke(util.clj:117),
	at metabase.sync.util$with_duplicate_ops_prevented$fn__60031.invoke(util.clj:89),
	at metabase.sync.util$do_sync_operation.invokeStatic(util.clj:215),
	at metabase.sync.util$do_sync_operation.invoke(util.clj:209),
	at metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:51),
	at metabase.sync$sync_database_BANG_.invoke(sync.clj:37),
	at metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:46),
	at metabase.sync$sync_database_BANG_.invoke(sync.clj:37),
	at metabase.events.sync_database$publish_event_BANG__primary_method_metabase_events_sync_database_event$fn__103799.invoke(sync_database.clj:24),
	at clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047),
	at clojure.lang.AFn.call(AFn.java:18),
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),
	at java.base/java.lang.Thread.run(Unknown Source)
[a0ec80b6-e8e3-4084-a3ab-8009bcc3597b] 2024-07-04T09:33:28+08:00 INFO metabase.sync.util FINISHED: Sync postgres Database 7 ''测试GuassDB'' (258.7 ms)
[a0ec80b6-e8e3-4084-a3ab-8009bcc3597b] 2024-07-04T09:33:28+08:00 WARN metabase.sync.util Error in sync step Sync postgres Database 7 ''测试GuassDB'',java.lang.ClassCastException: class org.postgresql.util.PSQLException cannot be cast to class clojure.lang.Associative (org.postgresql.util.PSQLException and clojure.lang.Associative are in unnamed module of loader 'app'),
	at clojure.lang.RT.assoc(RT.java:827),
	at clojure.core$assoc__5481.invokeStatic(core.clj:193),
	at clojure.core$assoc__5481.invoke(core.clj:192),
	at metabase.sync$sync_database_BANG_$fn__82106.invoke(sync.clj:52),
	at metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:190),
	at metabase.sync.util$do_with_error_handling.invoke(util.clj:183),
	at clojure.core$partial$fn__5910.invoke(core.clj:2647),
	at metabase.driver$fn__49747.invokeStatic(driver.clj:759),
	at metabase.driver$fn__49747.invoke(driver.clj:759),
	at clojure.lang.MultiFn.invoke(MultiFn.java:239),
	at metabase.sync.util$sync_in_context$fn__60065.invoke(util.clj:166),
	at metabase.sync.util$with_db_logging_disabled$fn__60062.invoke(util.clj:158),
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:131),
	at metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:125),
	at metabase.sync.util$with_start_and_finish_logging$fn__60049.invoke(util.clj:143),
	at metabase.sync.util$with_sync_events$fn__60044.invoke(util.clj:117),
	at metabase.sync.util$with_duplicate_ops_prevented$fn__60031.invoke(util.clj:89),
	at metabase.sync.util$do_sync_operation.invokeStatic(util.clj:215),
	at metabase.sync.util$do_sync_operation.invoke(util.clj:209),
	at metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:51),
	at metabase.sync$sync_database_BANG_.invoke(sync.clj:37),
	at metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:46),
	at metabase.sync$sync_database_BANG_.invoke(sync.clj:37),
	at metabase.events.sync_database$publish_event_BANG__primary_method_metabase_events_sync_database_event$fn__103799.invoke(sync_database.clj:24),
	at clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047),
	at clojure.lang.AFn.call(AFn.java:18),
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),
	at java.base/java.lang.Thread.run(Unknown Source)

```

paoliniluis on (2024-10-09 16:30:53 UTC): So it seems that the GuassDB folks don't have the postgres views that we need to sync. I would suggest you to contact them @cowcomic

cowcomic (Issue Creator) on (2024-10-10 07:01:33 UTC): I also hope that metabase can directly support this driver

"
2252547392,issue,closed,completed,`displayInfo` throws on queries using metrics,"### Reproduction steps

1. `git checkout metrics-v2`
2. New -> Metric
3. Select Orders table as source
4. Aggregate by Count
5. Run it and Save it
6. Open notebook editor

App crashes, this error is coming from `Lib.displayInfo` when trying to compute the info of the aggregation clause:

```
Error calculating display info for metric: Error calculating display info for metric: Error calculating metadata for :metadata/metric: metabase.lib.schema.expression/type-of: Don't know how to determine the type of {:id 319, :table-id 5, :name ""19/04 Metric Orders Count"", :description nil, :archived false, :definition {:database 1, :type ""query"", :query {:source-table 5, :aggregation [[""count""]]}}, :lib/type :metadata/metric}
```

### More details

When calling `Lib.toLegacyQuery(query)` on the `query` being passed to `Lib.displayInfo`, it looks like this:
```tsx
{
    ""database"": 1,
    ""type"": ""query"",
    ""query"": {
        ""aggregation"": [
            [
                ""metric"",
                321
            ]
        ],
        ""source-table"": ""card__321""
    }
}
```

The aggregation clause passed to `Lib.displayInfo` looks like this when serialized: ` ['metric', 321]`",kamilmielnik,2024-04-19 09:41:29+00:00,[],2024-08-28 02:10:42+00:00,2024-04-26 17:29:50+00:00,https://github.com/metabase/metabase/issues/41626,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Team/Querying', '')]","[{'comment_id': 2079799358, 'issue_id': 2252547392, 'author': 'perivamsi', 'body': 'not reproable with the new branch changes, closing it\r\n\r\nwe can reopen if needed', 'created_at': datetime.datetime(2024, 4, 26, 17, 29, 50, tzinfo=datetime.timezone.utc)}]","perivamsi on (2024-04-26 17:29:50 UTC): not reproable with the new branch changes, closing it

we can reopen if needed

"
2252416191,issue,closed,not_planned,[new sql search]The value of the query result is displayed abnormally  ,"### Describe the bug


![image](https://github.com/metabase/metabase/assets/18453612/eec86254-219b-47b6-997b-611c997167bb)

example:
Incorrect id display:1474863126805505000

Correct id display:1474863126805505024	

If the value is too large, the last two digits are automatically converted to 00 , The data cannot be used correctly

### To Reproduce

1. Go to SQL query page，http://127.0.0.1:3000/question
2.Input SQL
3. click search
4. See error


### Expected behavior

![image](https://github.com/metabase/metabase/assets/18453612/d2ef50af-8c42-46ac-b408-f40dc4c1b670)

Correct display


### Logs

_No response_

### Information about your Metabase installation

```JSON
Chrome 124.0.6367.60(arm64)

clickhouse

clickhouse.metabase-driver.jar 1.4.0
```


### Severity

Very serious

### Additional context

_No response_",Enderyu,2024-04-19 08:35:33+00:00,[],2024-04-22 07:34:14+00:00,2024-04-22 07:34:13+00:00,https://github.com/metabase/metabase/issues/41624,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2068687746, 'issue_id': 2252416191, 'author': 'paoliniluis', 'body': 'duplicate of https://github.com/metabase/metabase/issues/5816', 'created_at': datetime.datetime(2024, 4, 22, 7, 34, 13, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 07:34:13 UTC): duplicate of https://github.com/metabase/metabase/issues/5816

"
2251579941,issue,open,,Overflow menus in Events modal should close when you click outside of them,"### Describe the bug

These two popovers should close when you click anywhere outsides of them. Right now they only close when you click the `…` again or if you select a menu option.

![image](https://github.com/metabase/metabase/assets/2223916/fcaa2a65-8bae-4f0c-b6c3-7ffe1e7284a1)


### To Reproduce

1. Go to a collection and click the Events button
2. Click on any of the `…` menus at the top-level Events state, or within one of the timelines
3. Try clicking outside of the popover and see that it doesn't close (it should)


### Expected behavior

These popovers should close when you click anywhere outsides of them.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.213-201.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""druid"",
      ""postgres"",
      ""redshift"",
      ""mysql"",
      ""bigquery-cloud-sdk"",
      ""mongo"",
      ""h2"",
      ""snowflake""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-17"",
      ""tag"": ""vUNKNOWN"",
      ""hash"": ""39cf70c""
    },
    ""settings"": {
      ""report-timezone"": ""US/Pacific""
    }
  }
}
```


### Severity

P3 or P4

### Additional context

_No response_",mazameli,2024-04-18 21:17:30+00:00,[],2024-06-20 15:54:33+00:00,,https://github.com/metabase/metabase/issues/41617,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Organization/Collections', ''), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2251569595,issue,open,,Column Formatting Not applied for Date binned by Week,"### Describe the bug

If you have a column with dates binned by Week, they will not respect any column formatting options you may have applied:

![image](https://github.com/metabase/metabase/assets/21064735/1da9bfbe-c26d-42eb-957c-b6a042719efb)

I believe this is a frontend bug. Discovered while working on a fix for: https://github.com/metabase/metabase/issues/41492
Where the CSV exports have incorrect formatting.

In fixing that issue, I noticed that the export will use the column formatting but the App does not.

### To Reproduce

1. In the Sample Database, create a question with ""Orders""
2. Summarize -> Count of Rows by ""Created At -> Week""
3. Visualize
4. Change Visualization to 'Table'
5. On 'Created At' Column, change the date formatting to anything else

The column formatting settings won't be applied to the column.

### Expected behavior

The Created At: Week default format is a date range showing the week. Both the start and end dates should be formatted according to the specified column formatting.

### Logs

_No response_

### Information about your Metabase installation

```JSON
1.49.6
```


### Severity

P2

### Additional context

_No response_",adam-james-v,2024-04-18 21:11:23+00:00,[],2025-02-04 20:31:26+00:00,,https://github.com/metabase/metabase/issues/41616,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Visualization/Chart Settings', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2161722482, 'issue_id': 2251569595, 'author': 'stutimohindra', 'body': '@cdeweyx @adam-james-v .Can you verify in Pr screenshots if that is the correct expectation ?', 'created_at': datetime.datetime(2024, 6, 11, 22, 45, 28, tzinfo=datetime.timezone.utc)}]","stutimohindra on (2024-06-11 22:45:28 UTC): @cdeweyx @adam-james-v .Can you verify in Pr screenshots if that is the correct expectation ?

"
2251537867,issue,closed,completed,When saving a line chart with default settings while viewing data as table it does not persist the defaults for line chart,"## Description

For line/area/bar/combo/watefall/scatter charts we persist `graph.dimensions` and `graph.metrics` settings because in their definitions persistDefault is true. However, if you toggle raw data view when saving the question these settings defaults won't be saved. As the result this question won't appear compatible with other line charts when trying to combine it in a dashcard.

## Steps to reproduce
- New Orders -> Group by Created at -> Visualize
- At the bottom of the line chart toggle data view
- Save the question as Q1
- Repeat the same steps and save the question as Q2
- Add Q1 on a dashboard and try combine it with Q2
- The list does not show Q2 as a compatible question as well as any timeseries

",JesseSDevaney,2024-04-18 20:49:40+00:00,['kulyk'],2024-10-08 16:18:36+00:00,2024-08-07 00:06:14+00:00,https://github.com/metabase/metabase/issues/41612,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('Reporting/Dashboards/Combined charts', 'Combining charts'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2065380986, 'issue_id': 2251537867, 'author': 'alxnddr', 'body': 'Intersting, this modal is showing the list of compatible questions coming from the backend and the ECharts migration should not have changed it 🤔', 'created_at': datetime.datetime(2024, 4, 18, 21, 48, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2067356632, 'issue_id': 2251537867, 'author': 'alxnddr', 'body': ""@JesseSDevaney the behavior you described in the issue initially could be also reproduced on master so I updated the description of the issue. The spec failures are caused by https://github.com/metabase/metabase/issues/41290 which I'm looking at"", 'created_at': datetime.datetime(2024, 4, 19, 22, 30, 58, tzinfo=datetime.timezone.utc)}]","alxnddr on (2024-04-18 21:48:40 UTC): Intersting, this modal is showing the list of compatible questions coming from the backend and the ECharts migration should not have changed it 🤔

alxnddr on (2024-04-19 22:30:58 UTC): @JesseSDevaney the behavior you described in the issue initially could be also reproduced on master so I updated the description of the issue. The spec failures are caused by https://github.com/metabase/metabase/issues/41290 which I'm looking at

"
2251515764,issue,closed,completed,[dc.js migration] should show legend label for single value series breakout,"![image](https://github.com/metabase/metabase/assets/22608765/cc64893d-61d1-476e-886a-c4b40d94f715)

- Relevant test: https://github.com/metabase/metabase/blob/echarts/e2e/test/scenarios/visualizations-charts/line_chart.cy.spec.js#L241

---
![image](https://github.com/metabase/metabase/assets/22608765/a045593e-7185-488d-88f4-be55885cbbcf)

- Relevant test: https://github.com/metabase/metabase/blob/echarts/e2e/test/scenarios/visualizations-charts/line_chart.cy.spec.js#L569
",JesseSDevaney,2024-04-18 20:37:01+00:00,['alxnddr'],2024-04-19 19:25:21+00:00,2024-04-19 19:25:21+00:00,https://github.com/metabase/metabase/issues/41611,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2251504347,issue,closed,completed,"[dc.js migration] ""series not found"" error displayed when trying to chart a breakout series with an `(empty)` value","![Screenshot from 2024-04-18 16-28-02](https://github.com/metabase/metabase/assets/22608765/8c0d4cc8-12f5-42df-945b-1a22c8a5fe53)
![Screenshot from 2024-04-18 16-28-19](https://github.com/metabase/metabase/assets/22608765/548e2fa8-5a47-4057-82de-b80ef10375c3)
![Screenshot from 2024-04-18 16-28-13](https://github.com/metabase/metabase/assets/22608765/d3faba6e-4e6b-4ee4-b1ff-aa5e6df75917)

- Relevant test: https://github.com/metabase/metabase/blob/echarts/e2e/test/scenarios/visualizations-charts/line_chart.cy.spec.js#L146",JesseSDevaney,2024-04-18 20:29:29+00:00,['alxnddr'],2024-04-20 03:52:07+00:00,2024-04-20 03:52:07+00:00,https://github.com/metabase/metabase/issues/41610,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2251491976,issue,closed,completed,[dc.js migration] should display an error message when there are more series than the chart supports,"![image](https://github.com/metabase/metabase/assets/22608765/8b7162e3-7ca9-4585-852f-9a136f0259c6)

- Relevant tests:
  - https://github.com/metabase/metabase/blob/echarts/e2e/test/scenarios/visualizations-charts/line_chart.cy.spec.js#L80
  - https://github.com/metabase/metabase/blob/echarts/e2e/test/scenarios/visualizations-charts/bar_chart.cy.spec.js#L352",JesseSDevaney,2024-04-18 20:22:17+00:00,['alxnddr'],2024-04-19 19:25:56+00:00,2024-04-19 19:25:56+00:00,https://github.com/metabase/metabase/issues/41609,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2251480395,issue,open,,"""Previous results"" should appear when joining on more than 2 tables","### Describe the bug

When adding join conditions the headers are set as the name of the first table used in the conditions.
This is incorrect in case when adding conditions for more than 2 tables for the same join.
Here the Birth Date field is from People table, not Orders.
<img width=""1265"" alt=""Captura de ecrã 2024-04-18, às 21 45 07"" src=""https://github.com/metabase/metabase/assets/777800/380b9bb4-cbc1-4000-bfc4-da3ccf2b0ea1"">


### To Reproduce

1. Start new question
2. Choose Orders as data source
3. Join with People, keep auto added condition (Orders - User ID = People - ID)
4. Add another join, with products, keep auto added condition (Orders - Product ID = Products - ID)
5. Add a second condition, use any column from People - it will show Orders as a column header and the leftmost table name in the join anyway


### Expected behavior

When there are conditions for more than 2 tables for the same join, we should keep Previous results in the beginning of the join block and for each condition show the relevant name of the table for each column
<img width=""1266"" alt=""Captura de ecrã 2024-04-18, às 22 09 40"" src=""https://github.com/metabase/metabase/assets/777800/2c7093e0-cddd-4262-9861-89f44b75d40b"">


### Logs

_No response_

### Information about your Metabase installation

```JSON
last version
```


### Severity

Frustrating

### Additional context

_No response_",mngr,2024-04-18 20:14:46+00:00,[],2025-02-04 20:27:49+00:00,,https://github.com/metabase/metabase/issues/41607,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/MBQL', ''), ('.Backend', ''), ('Querying/Notebook', 'Items specific to the Custom/Notebook query builder'), ('.Team/Querying', '')]","[{'comment_id': 2068692952, 'issue_id': 2251480395, 'author': 'paoliniluis', 'body': 'This is interesting, thanks for pointing it out', 'created_at': datetime.datetime(2024, 4, 22, 7, 36, 35, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 07:36:35 UTC): This is interesting, thanks for pointing it out

"
2251460236,issue,open,,"Change error message on failed invalidation to ""There weren't any cached results to invalidate.""",see https://metaboat.slack.com/archives/C06KX7QECN4/p1713467534694649?thread_ts=1713220746.641399&cid=C06KX7QECN4,rafpaf,2024-04-18 20:01:35+00:00,[],2024-06-16 12:31:04+00:00,,https://github.com/metabase/metabase/issues/41606,[],[],
2251437180,issue,closed,completed,[dc.js migration] pin map does not allow dragging or brush filtering,"
https://github.com/metabase/metabase/assets/22608765/6cb6dc76-ae99-4578-a1a4-0881f20127b8

",JesseSDevaney,2024-04-18 19:48:13+00:00,['alxnddr'],2024-04-19 19:18:01+00:00,2024-04-19 19:18:01+00:00,https://github.com/metabase/metabase/issues/41605,"[('Priority:P2', 'Average run of the mill bug'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2251312084,issue,closed,completed,[Browse] Add list of models to /browse/models,"```[tasklist]
### Tasks
- [x] Add list
- [x] Add column: description
- [x] Add column: collection
- [x] Remove ellipsis menu from list of models
- [x] Remove title of 'type' column
- [x] Remove column: Last edited by
- [x] Remove column: Last edited at
- [x] possible refactor: port ItemsTable to TS
- [x] Make filters work again
- [x] Add popover for filters
- [x] Make non-drag-'n'-droppable
- [x] Make Browse databases work
- [x] Make Browse schemas work
- [x] Make Browse tables work
- [x] Make collection breadcrumbs responsive
```
",rafpaf,2024-04-18 18:34:03+00:00,['rafpaf'],2024-05-08 22:08:56+00:00,2024-05-08 22:08:55+00:00,https://github.com/metabase/metabase/issues/41603,[],[],
2251219853,issue,closed,completed,Azure AD SAML and SLO logout error,"### Describe the bug

Using AD SAML for SSO and Metabase 1.49.5.

You're presented with an error after signing off indicating the session index couldn't be located.
It doesn't prevent you from logging back in.
<img width=""604"" alt=""Screenshot 2024-04-18 at 12 10 16 PM"" src=""https://github.com/metabase/metabase/assets/17398657/7534e213-df21-4c6c-89dd-1215bba2cde7"">

<br>
<br>

A quick video of a session logging on and off.
https://www.loom.com/share/485466cf8fb7486ca5f955a774d363c8



### To Reproduce

1. Log into Metabase using AD based SAML
2. Log out


I’m not sure if it’s a case of not calling the Logout URL configured for the app in Azure, possibly redirecting to different url configurations in Azure, completely logging out the session during the call to 'auth/sso/logout' so there’s no SessionIndex to reference by Azure, or something else.

<img width=""676"" alt=""Screenshot 2024-04-18 at 12 19 20 PM"" src=""https://github.com/metabase/metabase/assets/17398657/31e4b06c-6ef2-4a0d-ab31-1a24e8171242"">

<img width=""720"" alt=""Screenshot 2024-04-18 at 11 55 03 AM"" src=""https://github.com/metabase/metabase/assets/17398657/ef0580c8-b44a-4da4-9f7f-003e4339c3ac"">


<br>
<br>

From the decoded SAML traces
Part of the Login XML:
```
<samlp:Response xmlns:samlp=""urn:oasis:names:tc:SAML:2.0:protocol""
                ID=""_474a4cac-8a29-4c29-a70f-ce65ccdb3563""
                Version=""2.0""
                IssueInstant=""2024-04-18T16:41:17.004Z""
                Destination=""https://fil-testjumper.hosted.staging.metabase.com/auth/sso""
                InResponseTo=""id-7956d9dc-65ba-4c73-b96f-d328e2aa9d1c""
                >
```


```
<AuthnStatement AuthnInstant=""2024-04-18T14:27:07.975Z""
                        SessionIndex=""_ab39c4e2-eced-436a-8064-bd1683566f00""
                        >
            <AuthnContext>
                <AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:Password</AuthnContextClassRef>
            </AuthnContext>
        </AuthnStatement>
```

<br>
<br>

Logout XML:
```
<samlp:LogoutRequest xmlns:saml=""urn:oasis:names:tc:SAML:2.0:assertion""
                     xmlns:samlp=""urn:oasis:names:tc:SAML:2.0:protocol""
                     Destination=""https://login.microsoftonline.com/74f046ab-2329-4440-a249-ed151b3148b8/saml2""
                     ID=""id10cff6ed-964c-46e4-9e34-f90efe028d72""
                     IssueInstant=""2024-04-18T16:38:14Z""
                     Version=""2.0""
                     >
    <saml:Issuer>metabase</saml:Issuer>
    <saml:NameID Format=""urn:oasis:names:tc:SAML:2.0:nameid-format:emailAddress"">filmonk@gmail.com</saml:NameID>
    <samlp:SessionIndex>SessionIndex_From_Authentication_Assertion</samlp:SessionIndex>
</samlp:LogoutRequest>
```





### Expected behavior

Log out from a session and not encounter the error.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.213-201.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mongo"",
      ""snowflake"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-11"",
      ""tag"": ""v1.49.5"",
      ""hash"": ""31c4887""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P2

### Additional context

_No response_",FilmonK,2024-04-18 17:34:21+00:00,['escherize'],2024-05-29 13:00:33+00:00,2024-05-29 13:00:33+00:00,https://github.com/metabase/metabase/issues/41600,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Administration/Auth/SSO', 'Enterprise SSO like SAML and JWT'), ('.Escalation', '')]","[{'comment_id': 2066598862, 'issue_id': 2251219853, 'author': 'PIrojahPerbak', 'body': '+1 for a solution for this', 'created_at': datetime.datetime(2024, 4, 19, 13, 32, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2117627644, 'issue_id': 2251219853, 'author': 'Tony-metabase', 'body': '@escherize the above seems to be fixed ... but there is still an issue when you logout. It seems that Azure is expecting a NameId but we are not passing it during the logout ... If you check the Attributes and Claims there is a NameId\r\n\r\n![image](https://github.com/metabase/metabase/assets/110378427/0ef10622-e83e-4a45-b614-87619cd92b12)', 'created_at': datetime.datetime(2024, 5, 17, 13, 37, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2128967825, 'issue_id': 2251219853, 'author': 'darksciencebase', 'body': 'https://github.com/metabase/metabase/pull/43022', 'created_at': datetime.datetime(2024, 5, 24, 8, 47, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2137359583, 'issue_id': 2251219853, 'author': 'bshepherdson', 'body': 'Fixed by #43022.', 'created_at': datetime.datetime(2024, 5, 29, 13, 0, 33, tzinfo=datetime.timezone.utc)}]","PIrojahPerbak on (2024-04-19 13:32:48 UTC): +1 for a solution for this

Tony-metabase on (2024-05-17 13:37:04 UTC): @escherize the above seems to be fixed ... but there is still an issue when you logout. It seems that Azure is expecting a NameId but we are not passing it during the logout ... If you check the Attributes and Claims there is a NameId

![image](https://github.com/metabase/metabase/assets/110378427/0ef10622-e83e-4a45-b614-87619cd92b12)

darksciencebase on (2024-05-24 08:47:04 UTC): https://github.com/metabase/metabase/pull/43022

bshepherdson on (2024-05-29 13:00:33 UTC): Fixed by #43022.

"
2251147651,issue,closed,not_planned,Cannot Upload Specific Custom Maps,"### Describe the bug

I have been using this data to great effect in uploading maps: https://github.com/faeldon/philippines-json-maps/tree/master/2023/geojson

I had no issues uploading geojson files from the folders 2023/country, 2023/provdists, 2023/regions. However, attempting to upload any geojson from 2023/municipalities folder will result in ""something's gone wrong"" error in Metabase

### To Reproduce

1. Go to '...'
Add a new map and input as url a raw geojson url from the 2023/municipalities folder. Sample: https://raw.githubusercontent.com/faeldon/philippines-json-maps/master/2023/geojson/municities/lowres/bgysubmuns-municity-1381300000.0.001.json
![image](https://github.com/metabase/metabase/assets/76050054/4c808b87-d800-477c-9795-98c8d634d87a)
3. Click on '....'
""Load""
6. See error
![image](https://github.com/metabase/metabase/assets/76050054/3f386e33-367f-4a8b-856d-6aa4dd702dc6)

### Expected behavior

Should be able to upload a map. Again, other geojson from the source found in 2023/country, 2023/provdists, 2023/regions all work. Just the ones under municipalities folder seem problematic. Note also that the files under municipalities can be loaded in https://geojson.io/ so I am not sure why uploading in Metabase is problematic for these files specifically. File size also does not seem to be too big.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.21+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.21"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.21+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.5.0-1017-azure"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mysql""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MySQL"",
        ""version"": ""8.0.36""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-01-05"",
      ""tag"": ""v0.48.2"",
      ""hash"": ""e66c075""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Annoying

### Additional context

_No response_",golfmachine13,2024-04-18 16:50:52+00:00,[],2024-04-23 03:58:39+00:00,2024-04-22 07:46:19+00:00,https://github.com/metabase/metabase/issues/41596,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2068711400, 'issue_id': 2251147651, 'author': 'paoliniluis', 'body': 'duplicate of https://github.com/metabase/metabase/issues/37715', 'created_at': datetime.datetime(2024, 4, 22, 7, 46, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2071362191, 'issue_id': 2251147651, 'author': 'golfmachine13', 'body': 'Yes, it was indeed similar to another issue. The geojson had a NULL. Thank\r\nyou!\r\n\r\nMichael Fong, MD\r\nPhysician Informaticist\r\nMedProjects Inc.\r\nwww.medprojects.com\r\n\r\nOn Mon, Apr 22, 2024, 3:46 PM Luis Paolini ***@***.***> wrote:\r\n\r\n> duplicate of #37715 <https://github.com/metabase/metabase/issues/37715>\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/metabase/metabase/issues/41596#issuecomment-2068711400>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/ASEG5BVHEOKARY2W64TECHLY6S56FAVCNFSM6AAAAABGNU6XTOVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDANRYG4YTCNBQGA>\r\n> .\r\n> You are receiving this because you authored the thread.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 4, 23, 3, 58, 38, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 07:46:19 UTC): duplicate of https://github.com/metabase/metabase/issues/37715

golfmachine13 (Issue Creator) on (2024-04-23 03:58:38 UTC): Yes, it was indeed similar to another issue. The geojson had a NULL. Thank
you!

Michael Fong, MD
Physician Informaticist
MedProjects Inc.
www.medprojects.com

On Mon, Apr 22, 2024, 3:46 PM Luis Paolini ***@***.***> wrote:

"
2251147282,issue,closed,not_planned,"Downloading files on public link, fails when using many filters","### Describe the bug

When downloading a table with selected filters, it generates a 502 error when it is a public link. However, when using the direct metabase link (no shared link), it downloads correctly.

Attached 502 error
![image](https://github.com/metabase/metabase/assets/61419471/176023fb-c0df-4fe0-9b0b-12a3c5c756fc)

Attached are the filters used
![image](https://github.com/metabase/metabase/assets/61419471/f27aecc7-3082-492e-b80f-90f45a32a2f0)

Attached file error
![image](https://github.com/metabase/metabase/assets/61419471/dc9b9048-9a13-45a5-9752-ceddb667a16c)
<img width=""296"" alt=""image"" src=""https://github.com/metabase/metabase/assets/61419471/213d2ee1-b707-49f5-bddc-9e372a3c30d1"">

We are using the latest version 0.49.6

### To Reproduce

1.- Create a public link with filters and select several in a table.
2.- download
3.- See behavior


### Expected behavior

You should be able to download and open the file without problems.

### Logs

**### NUMBER 1**

[eb9d4870-a313-4a7c-8ab8-8516268b24da] 2024-04-18T12:27:00-04:00 ERROR metabase.driver.util Failed to connect to Database,org.postgresql.util.PSQLException: Connection to pgsql-marfil:5432 refused. Check that the hostname and port are correct and that the postmaster is accepting TCP/IP connections.,	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:346),	at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:54),	at org.postgresql.jdbc.PgConnection.<init>(PgConnection.java:273),	at org.postgresql.Driver.makeConnection(Driver.java:446),	at org.postgresql.Driver.connect(Driver.java:298),	at java.sql/java.sql.DriverManager.getConnection(Unknown Source),	at java.sql/java.sql.DriverManager.getConnection(Unknown Source),	at clojure.java.jdbc$get_driver_connection.invokeStatic(jdbc.clj:271),	at clojure.java.jdbc$get_driver_connection.invoke(jdbc.clj:250),	at clojure.java.jdbc$get_connection.invokeStatic(jdbc.clj:411),	at clojure.java.jdbc$get_connection.invoke(jdbc.clj:274),	at clojure.java.jdbc$db_query_with_resultset_STAR_.invokeStatic(jdbc.clj:1111),	at clojure.java.jdbc$db_query_with_resultset_STAR_.invoke(jdbc.clj:1093),	at clojure.java.jdbc$query.invokeStatic(jdbc.clj:1182),	at clojure.java.jdbc$query.invoke(jdbc.clj:1144),	at clojure.java.jdbc$query.invokeStatic(jdbc.clj:1160),	at clojure.java.jdbc$query.invoke(jdbc.clj:1144),	at metabase.driver.sql_jdbc.connection$can_connect_with_spec_QMARK_.invokeStatic(connection.clj:326),	at metabase.driver.sql_jdbc.connection$can_connect_with_spec_QMARK_.invoke(connection.clj:323),	at metabase.driver.sql_jdbc.connection$can_connect_QMARK_$fn__51096.invoke(connection.clj:335),	at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection$fn__51078.invoke(connection.clj:311),	at metabase.util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:165),	at metabase.util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154),	at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invokeStatic(connection.clj:309),	at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invoke(connection.clj:305),	at metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invokeStatic(connection.clj:334),	at metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invoke(connection.clj:330),	at metabase.driver.sql_jdbc$fn__106731.invokeStatic(sql_jdbc.clj:49),	at metabase.driver.sql_jdbc$fn__106731.invoke(sql_jdbc.clj:47),	at clojure.lang.MultiFn.invoke(MultiFn.java:234),	at metabase.driver.util$can_connect_with_details_QMARK_$fn__60006.invoke(util.clj:148),	at clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047),	at clojure.lang.AFn.call(AFn.java:18),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source),Caused by: java.net.ConnectException: Connection refused (Connection refused),	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method),	at java.base/java.net.AbstractPlainSocketImpl.doConnect(Unknown Source),	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source),	at java.base/java.net.AbstractPlainSocketImpl.connect(Unknown Source),	at java.base/java.net.SocksSocketImpl.connect(Unknown Source),	at java.base/java.net.Socket.connect(Unknown Source),	at org.postgresql.core.PGStream.createSocket(PGStream.java:243),	at org.postgresql.core.PGStream.<init>(PGStream.java:98),	at org.postgresql.core.v3.ConnectionFactoryImpl.tryConnect(ConnectionFactoryImpl.java:136),	at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:262),	... 36 more

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""es-CL"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.179-168.710.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mongo""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.22""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-16"",
      ""tag"": ""v0.49.6"",
      ""hash"": ""5abf130""
    },
    ""settings"": {
      ""report-timezone"": ""America/Santiago""
    }
  }
}
```


### Severity

high

### Additional context

_No response_",NicolasPLG,2024-04-18 16:50:37+00:00,[],2024-04-22 17:01:58+00:00,2024-04-22 17:01:58+00:00,https://github.com/metabase/metabase/issues/41595,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2068714592, 'issue_id': 2251147282, 'author': 'paoliniluis', 'body': 'can you open the file with a text editor and show the results? the logs you posted say:\r\n""Failed to connect to Database,org.postgresql.util.PSQLException: Connection to pgsql-marfil:5432 refused"", which is an error connecting to the database', 'created_at': datetime.datetime(2024, 4, 22, 7, 47, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2069413614, 'issue_id': 2251147282, 'author': 'NicolasPLG', 'body': 'hello I attach what it tells me in the text editor\r\n\r\n----\r\n<html>\r\n<head><title>502 Bad Gateway</title></head>\r\n<body>\r\n<center><h1>502 Bad Gateway</h1></center>\r\n<hr><center>nginx</center>\r\n</body>\r\n</html>\r\n<!-- a padding to disable MSIE and Chrome friendly error page -->\r\n<!-- a padding to disable MSIE and Chrome friendly error page -->\r\n<!-- a padding to disable MSIE and Chrome friendly error page -->\r\n<!-- a padding to disable MSIE and Chrome friendly error page -->\r\n<!-- a padding to disable MSIE and Chrome friendly error page -->\r\n<!-- a padding to disable MSIE and Chrome friendly error page -->', 'created_at': datetime.datetime(2024, 4, 22, 13, 23, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2070249111, 'issue_id': 2251147282, 'author': 'paoliniluis', 'body': ""ok so the issue is simply that Metabase can't connect to the database or the database takes too much time to resolve the query, that's why you see a 502... (it's nginx cutting the connection after a long period of time)"", 'created_at': datetime.datetime(2024, 4, 22, 17, 1, 38, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 07:47:45 UTC): can you open the file with a text editor and show the results? the logs you posted say:
""Failed to connect to Database,org.postgresql.util.PSQLException: Connection to pgsql-marfil:5432 refused"", which is an error connecting to the database

NicolasPLG (Issue Creator) on (2024-04-22 13:23:08 UTC): hello I attach what it tells me in the text editor

----
<html>
<head><title>502 Bad Gateway</title></head>
<body>
<center><h1>502 Bad Gateway</h1></center>
<hr><center>nginx</center>
</body>
</html>
<!-- a padding to disable MSIE and Chrome friendly error page -->
<!-- a padding to disable MSIE and Chrome friendly error page -->
<!-- a padding to disable MSIE and Chrome friendly error page -->
<!-- a padding to disable MSIE and Chrome friendly error page -->
<!-- a padding to disable MSIE and Chrome friendly error page -->
<!-- a padding to disable MSIE and Chrome friendly error page -->

paoliniluis on (2024-04-22 17:01:38 UTC): ok so the issue is simply that Metabase can't connect to the database or the database takes too much time to resolve the query, that's why you see a 502... (it's nginx cutting the connection after a long period of time)

"
2251131926,issue,closed,completed,`SMTPConnectionForm`,,npfitz,2024-04-18 16:40:56+00:00,['npfitz'],2024-04-25 20:16:44+00:00,2024-04-25 20:16:44+00:00,https://github.com/metabase/metabase/issues/41593,[],[],
2251087291,issue,closed,completed,[Browse] Milestone 1: List models (using components of ItemsTable),"```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/issues/41911
- [ ] https://github.com/metabase/metabase/issues/41912
- [ ] https://github.com/metabase/metabase/pull/41952
- [ ] https://github.com/metabase/metabase/issues/41909
- [ ] https://github.com/metabase/metabase/issues/41908
- [ ] https://github.com/metabase/metabase/pull/41955
- [ ] https://github.com/metabase/metabase/issues/41603
- [ ] https://github.com/metabase/metabase/pull/41959
- [ ] https://github.com/metabase/metabase/pull/41960
- [ ] https://github.com/metabase/metabase/pull/42113
- [ ] https://github.com/metabase/metabase/pull/42111
- [ ] https://github.com/metabase/metabase/pull/42601
```
",rafpaf,2024-04-18 16:16:36+00:00,['rafpaf'],2024-05-21 20:25:45+00:00,2024-05-15 14:11:24+00:00,https://github.com/metabase/metabase/issues/41591,[],"[{'comment_id': 2080113127, 'issue_id': 2251087291, 'author': 'dpsutton', 'body': 'this seems like a duplicate layer of https://github.com/metabase/metabase/issues/41603', 'created_at': datetime.datetime(2024, 4, 26, 21, 0, 57, tzinfo=datetime.timezone.utc)}]","dpsutton on (2024-04-26 21:00:57 UTC): this seems like a duplicate layer of https://github.com/metabase/metabase/issues/41603

"
2251067178,issue,closed,completed,[Epic] Browse models,"**Links**
- [product doc](https://www.notion.so/metabase/Alignment-on-direction-for-Browse-Data-Models-v0-2-dbc94b4f013f4f59be309728f89bf143?pvs=26&qid=)
- [design loom](https://www.loom.com/share/fed338145e6e44c3b99b3c82b1c44913)




```[tasklist]
### Milestones
- [ ] https://github.com/metabase/metabase/issues/41591
- [ ] https://github.com/metabase/metabase/issues/42696
- [ ] https://github.com/metabase/metabase/issues/42298
```

```[tasklist]
### Post RC
- [ ] #42952
- [ ] #42570
```
",rafpaf,2024-04-18 16:06:37+00:00,['rafpaf'],2024-06-16 12:25:10+00:00,2024-06-16 12:25:09+00:00,https://github.com/metabase/metabase/issues/41590,"[('.Epic', 'Feature Implementation or Project')]",[],
2250983525,issue,closed,not_planned,Static Embedding doesn't behave like Metabase Application when filter is locked and linked,"### Describe the bug

Currently Metabase `!=` Embedding Preview `!=` to Static Embedding ... none of those 3 situations behave the same. This bug will consider Metabase `!=` to Static Embedding

### To Reproduce

So i setup a dashboard with 3 filters all mapping to the column category but the first filter is linked to the second one:

![image](https://github.com/metabase/metabase/assets/110378427/fae84228-46fe-42f3-9114-8776fd1ba02e)

and when I try to filter on the first value (and assigning values to the other filters) using these filters:
(2nd) Text 1: Doohickey
(3rd) Text 2: Gizmo, Gadget

I get the proper results:

![image](https://github.com/metabase/metabase/assets/110378427/5ec8653a-cb76-44f7-995c-75687b8516df)

On the other hand i get completely different behaviour in static embedding. Setup the following locked filters

<img width=""289"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/de2195f8-2c2b-4363-9a34-3e52d5a858d2"">

and check the static embed:

![image](https://github.com/metabase/metabase/assets/110378427/2668fc20-fee4-4ec4-90ff-631004dbc0d7)

My expectation here is that the embedding will show Doohickey since the 2 filters are locked and the second filter is linked with this one .

### Expected behavior

Metabase `=` Static Embedding 

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
1.49.6
```


### Severity

It's a blocker to me since it makes Static Embedding not working as expected

### Additional context

_No response_",Tony-metabase,2024-04-18 15:29:12+00:00,"['WiNloSt', 'adam-james-v']",2024-05-10 08:07:16+00:00,2024-04-24 16:26:15+00:00,https://github.com/metabase/metabase/issues/41586,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Backend', ''), ('Embedding/Static', 'Static embedding, previously known as signed embedding'), ('.Team/Embedding', '')]","[{'comment_id': 2064246871, 'issue_id': 2250983525, 'author': 'Tony-metabase', 'body': 'Also for reference https://github.com/metabase/metabase/issues/37914#issuecomment-1904104979 and https://github.com/metabase/metabase/pull/41342#issuecomment-2061198768', 'created_at': datetime.datetime(2024, 4, 18, 15, 30, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2066053566, 'issue_id': 2250983525, 'author': 'WiNloSt', 'body': ""I can confirm that the preview and the embed behave differently. I updated the issue description with proper filter values to reproduce the issue. You need to set (3rd) Text 2 filter to have any values except Doohicky for this to happen.\r\n\r\nThe difference in the behavior is that when we query on preview, we call `GET /api/dashboard/:id/params/:param-key/values` to get the values. This would behave differently from when we're actually call on the dashboard since it would pass the linked parameter in the URL `GET /api/dashboard/:id/params/:param-key/values?:linked-param-key=Doohickey`.\r\n\r\nWhen we call this on embed it's `GET /api/embed/dashboard/:jwt/params/:param-key/values`. And BE could use the parameter values inside the :jwt filter proper results.\r\n\r\nI think what we should do here is to add an equivalent endpoint in [`preview_embed`](https://github.com/metabase/metabase/blob/2ab84940ed15658a35a50049f260c688409c71c3/src/metabase/api/preview_embed.clj) endpoint so we could call `GET /api/preview_embed/dashboard/:jwt/params/:param-key/values` instead of using the dashboard endpoint."", 'created_at': datetime.datetime(2024, 4, 19, 8, 9, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2066395625, 'issue_id': 2250983525, 'author': 'Tony-metabase', 'body': 'Decided to split this into two ... Changed the description of this one and also opened this one to tackle embedding preview #41635', 'created_at': datetime.datetime(2024, 4, 19, 11, 40, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2070172730, 'issue_id': 2250983525, 'author': 'albertoperdomo', 'body': '@WiNloSt @Tony-metabase Can you help me with repro steps?\r\n\r\nThe first part of the steps is clear. I get to the point I have the dashboard. I select Doohickey in Text1 and Gizmo, Gadget in Text2. When I open Text I see Doohickey as only option.\r\n\r\nWhat are the steps to embed? Is any of the params Locked? That information seems missing. Also the screenshot shows some JSON. How does it look in the UI?', 'created_at': datetime.datetime(2024, 4, 22, 16, 40, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2070192260, 'issue_id': 2250983525, 'author': 'Tony-metabase', 'body': '@albertoperdomo That is my bad because when i split the two issues i took the information on the [other issue ](https://github.com/metabase/metabase/issues/41635)only ... I amended the steps', 'created_at': datetime.datetime(2024, 4, 22, 16, 45, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2070214784, 'issue_id': 2250983525, 'author': 'albertoperdomo', 'body': 'Thanks @Tony-metabase. The difference I observe is that text filters renders as a text input instead of as a dropdown. Is that it?', 'created_at': datetime.datetime(2024, 4, 22, 16, 52, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2070232582, 'issue_id': 2250983525, 'author': 'Tony-metabase', 'body': ""Correct but we need to be cautious here because as @WiNloSt mentioned even if it ends up showing a Dropdown filter it's not gonna show `Doohicky` with the linked and locked setup (as we are getting with metabase UI) ... We need to be very cautious here cause we don't want to expose sensitive information which the Locked filter would prevent"", 'created_at': datetime.datetime(2024, 4, 22, 16, 57, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2075368102, 'issue_id': 2250983525, 'author': 'Tony-metabase', 'body': 'Closing since this was a misunderstanding form my part I expected Metabase = Static Embedding but when locked filters and come into place and filters start to work as chained filters. So here metabase is working as expected  and we also got a note on our docs:\r\n\r\n Locked parameters may also limit the values that are shown in your [editable filter widgets](https://www.metabase.com/docs/latest/embedding/static-embedding-parameters#adding-a-filter-widget-to-a-static-embed)', 'created_at': datetime.datetime(2024, 4, 24, 16, 26, 15, tzinfo=datetime.timezone.utc)}]","Tony-metabase (Issue Creator) on (2024-04-18 15:30:41 UTC): Also for reference https://github.com/metabase/metabase/issues/37914#issuecomment-1904104979 and https://github.com/metabase/metabase/pull/41342#issuecomment-2061198768

WiNloSt (Assginee) on (2024-04-19 08:09:27 UTC): I can confirm that the preview and the embed behave differently. I updated the issue description with proper filter values to reproduce the issue. You need to set (3rd) Text 2 filter to have any values except Doohicky for this to happen.

The difference in the behavior is that when we query on preview, we call `GET /api/dashboard/:id/params/:param-key/values` to get the values. This would behave differently from when we're actually call on the dashboard since it would pass the linked parameter in the URL `GET /api/dashboard/:id/params/:param-key/values?:linked-param-key=Doohickey`.

When we call this on embed it's `GET /api/embed/dashboard/:jwt/params/:param-key/values`. And BE could use the parameter values inside the :jwt filter proper results.

I think what we should do here is to add an equivalent endpoint in [`preview_embed`](https://github.com/metabase/metabase/blob/2ab84940ed15658a35a50049f260c688409c71c3/src/metabase/api/preview_embed.clj) endpoint so we could call `GET /api/preview_embed/dashboard/:jwt/params/:param-key/values` instead of using the dashboard endpoint.

Tony-metabase (Issue Creator) on (2024-04-19 11:40:52 UTC): Decided to split this into two ... Changed the description of this one and also opened this one to tackle embedding preview #41635

albertoperdomo on (2024-04-22 16:40:17 UTC): @WiNloSt @Tony-metabase Can you help me with repro steps?

The first part of the steps is clear. I get to the point I have the dashboard. I select Doohickey in Text1 and Gizmo, Gadget in Text2. When I open Text I see Doohickey as only option.

What are the steps to embed? Is any of the params Locked? That information seems missing. Also the screenshot shows some JSON. How does it look in the UI?

Tony-metabase (Issue Creator) on (2024-04-22 16:45:53 UTC): @albertoperdomo That is my bad because when i split the two issues i took the information on the [other issue ](https://github.com/metabase/metabase/issues/41635)only ... I amended the steps

albertoperdomo on (2024-04-22 16:52:24 UTC): Thanks @Tony-metabase. The difference I observe is that text filters renders as a text input instead of as a dropdown. Is that it?

Tony-metabase (Issue Creator) on (2024-04-22 16:57:21 UTC): Correct but we need to be cautious here because as @WiNloSt mentioned even if it ends up showing a Dropdown filter it's not gonna show `Doohicky` with the linked and locked setup (as we are getting with metabase UI) ... We need to be very cautious here cause we don't want to expose sensitive information which the Locked filter would prevent

Tony-metabase (Issue Creator) on (2024-04-24 16:26:15 UTC): Closing since this was a misunderstanding form my part I expected Metabase = Static Embedding but when locked filters and come into place and filters start to work as chained filters. So here metabase is working as expected  and we also got a note on our docs:

 Locked parameters may also limit the values that are shown in your [editable filter widgets](https://www.metabase.com/docs/latest/embedding/static-embedding-parameters#adding-a-filter-widget-to-a-static-embed)

"
2250902604,issue,closed,completed,tasks,See https://github.com/metabase/metabase/pull/41452#discussion_r1570693189,kamilmielnik,2024-04-18 14:53:41+00:00,['nemanjaglumac'],2024-10-08 17:08:35+00:00,2024-06-07 19:20:51+00:00,https://github.com/metabase/metabase/issues/41580,[],[],
2250899090,issue,closed,completed,Druid driver with auth fails sync,"### Describe the bug

I've added a druid database, using _Authentication header_ - providing basic auth credentials. This immediately spewed an error, but... the database has been added and the datasource has been synced. Later when I visit metabase admin panel and try to sync this database, the request to sync will always fail.

### To Reproduce

1. Go to Databases in Admin panel
2. Create DB that uses Druid engine/driver
3. Use Authentication header to authenticate with basic auth
4. See error in logs/console


### Expected behavior

Properly authenticate requests when Druid uses basic auth.

### Logs
```
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.task.sync-databases Scheduling sync/analyze for database 22: trigger: metabase.task.sync-and-analyze.trigger.22
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.task.sync-databases Scheduling field-values for database 22: trigger: metabase.task.update-field-values.trigger.22
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: Sync druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: Sync metadata for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 ERROR metabase.server.middleware.log POST /api/database 500 175.8 ms (23 DB calls) 
{:via
 [{:type clojure.lang.ExceptionInfo,
   :message ""clj-http: status 401"",
   :data
   {:type :db,
    :request-url ""https://druid-test-router.DOMAIN:443/status"",
    :request-options {:content-type ""application/json;charset=UTF-8""},
    :response {:error ""Unauthorized request"", :errorMessage nil, :errorClass nil, :host ""druid-router""}},
   :at [metabase.driver.druid.client$do_request invokeStatic ""client.clj"" 49]}
  {:type clojure.lang.ExceptionInfo,
   :message ""clj-http: status 401"",
   :data
   {:cached nil,
    :request-time 9,
    :repeatable? false,
    :protocol-version {:name ""HTTP"", :major 1, :minor 1},
    :streaming? true,
    :http-client
    #object[org.apache.http.impl.client.InternalHttpClient 0x2e11e5a0 ""org.apache.http.impl.client.InternalHttpClient@2e11e5a0""],
    :chunked? false,
    :type :clj-http.client/unexceptional-status,
    :reason-phrase ""Unauthorized"",
    :headers
    {""Date"" ""Thu, 18 Apr 2024 14:44:29 GMT"",
     ""Content-Type"" ""application/json;charset=utf-8"",
     ""Content-Length"" ""92"",
     ""Connection"" ""close"",
     ""Cache-Control"" ""no-cache, no-store, max-age=0"",
     ""Content-Security-Policy"" ""frame-ancestors 'none'"",
     ""WWW-Authenticate"" ""Basic""},
    :orig-content-encoding nil,
    :status 401,
    :length 92,
    :body ""{\""error\"":\""Unauthorized request\"",\""errorMessage\"":null,\""errorClass\"":null,\""host\"":\""druid-router\""}"",
    :trace-redirects []},
   :at [slingshot.support$stack_trace invoke ""support.clj"" 201]}],
 :trace
 [[slingshot.support$stack_trace invoke ""support.clj"" 201]
  [clj_http.client$exceptions_response invokeStatic ""client.clj"" 241]
  [clj_http.client$exceptions_response invoke ""client.clj"" 232]
  [clj_http.client$wrap_exceptions$fn__27728 invoke ""client.clj"" 250]
  [clj_http.client$wrap_accept$fn__27940 invoke ""client.clj"" 728]
  [clj_http.client$wrap_accept_encoding$fn__27947 invoke ""client.clj"" 750]
  [clj_http.client$wrap_content_type$fn__27934 invoke ""client.clj"" 711]
  [clj_http.client$wrap_form_params$fn__28045 invoke ""client.clj"" 959]
  [clj_http.client$wrap_nested_params$fn__28066 invoke ""client.clj"" 993]
  [clj_http.client$wrap_flatten_nested_params$fn__28075 invoke ""client.clj"" 1017]
  [clj_http.client$wrap_method$fn__28013 invoke ""client.clj"" 893]
  [clj_http.cookies$wrap_cookies$fn__26977 invoke ""cookies.clj"" 128]
  [clj_http.links$wrap_links$fn__27405 invoke ""links.clj"" 63]
  [clj_http.client$wrap_unknown_host$fn__28083 invoke ""client.clj"" 1046]
  [clj_http.client$request_STAR_ invokeStatic ""client.clj"" 1174]
  [clj_http.client$request_STAR_ invoke ""client.clj"" 1167]
  [clj_http.client$get invokeStatic ""client.clj"" 1180]
  [clj_http.client$get doInvoke ""client.clj"" 1176]
  [clojure.lang.RestFn invoke ""RestFn.java"" 423]
  [metabase.driver.druid.client$do_request invokeStatic ""client.clj"" 35]
  [metabase.driver.druid.client$do_request doInvoke ""client.clj"" 22]
  [clojure.lang.RestFn invoke ""RestFn.java"" 425]
  [clojure.core$partial$fn__5908 invoke ""core.clj"" 2641]
  [metabase.driver.druid.sync$dbms_version$fn__114651 invoke ""sync.clj"" 68]
  [metabase.util.ssh$do_with_ssh_tunnel invokeStatic ""ssh.clj"" 165]
  [metabase.util.ssh$do_with_ssh_tunnel invoke ""ssh.clj"" 154]
  [metabase.driver.druid.sync$dbms_version invokeStatic ""sync.clj"" 67]
  [metabase.driver.druid.sync$dbms_version invoke ""sync.clj"" 63]
  [metabase.driver.druid$fn__114749 invokeStatic ""druid.clj"" 34]
  [metabase.driver.druid$fn__114749 invoke ""druid.clj"" 32]
  [clojure.lang.MultiFn invoke ""MultiFn.java"" 234]
  [metabase.api.database$fn__98471 invokeStatic ""database.clj"" 809]
  [metabase.api.database$fn__98471 invoke ""database.clj"" 764]
  [compojure.core$wrap_response$fn__44649 invoke ""core.clj"" 160]
  [compojure.core$wrap_route_middleware$fn__44633 invoke ""core.clj"" 132]
  [compojure.core$wrap_route_info$fn__44638 invoke ""core.clj"" 139]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 151]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 152]
  [clojure.lang.Var invoke ""Var.java"" 393]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
  [metabase.server.middleware.auth$enforce_authentication$fn__93927 invoke ""auth.clj"" 17]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__44689 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 301]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [metabase.api.routes$fn__101920$fn__101923 invoke ""routes.clj"" 67]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.core$apply invokeStatic ""core.clj"" 667]
  [clojure.core$apply invoke ""core.clj"" 662]
  [metabase.server.routes$fn__102085$fn__102086 doInvoke ""routes.clj"" 72]
  [clojure.lang.RestFn invoke ""RestFn.java"" 436]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
  [compojure.core$make_context$handler__44689 invoke ""core.clj"" 290]
  [compojure.core$make_context$fn__44693 invoke ""core.clj"" 300]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [compojure.core$wrap_route_matches$fn__44642 invoke ""core.clj"" 153]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661$f__44662$respond_SINGLEQUOTE___44663 invoke ""core.clj"" 197]
  [metabase.server.routes$fn__102070$fn__102072 invoke ""routes.clj"" 49]
  [compojure.core$routes$fn__44661$f__44662 invoke ""core.clj"" 198]
  [compojure.core$routes$fn__44661 invoke ""core.clj"" 200]
  [metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__98693 invoke ""exceptions.clj"" 108]
  [metabase.server.middleware.exceptions$catch_api_exceptions$fn__98690 invoke ""exceptions.clj"" 96]
  [metabase.server.middleware.log$log_api_call$fn__102353$fn__102354$fn__102355 invoke ""log.clj"" 216]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invokeStatic ""diagnostic.clj"" 18]
  [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invoke ""diagnostic.clj"" 12]
  [metabase.server.middleware.log$log_api_call$fn__102353$fn__102354 invoke ""log.clj"" 208]
  [toucan2.execute$do_with_call_counts invokeStatic ""execute.clj"" 112]
  [toucan2.execute$do_with_call_counts invoke ""execute.clj"" 103]
  [metabase.server.middleware.log$log_api_call$fn__102353 invoke ""log.clj"" 207]
  [metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__104389 invoke ""browser_cookie.clj"" 40]
  [metabase.server.middleware.security$add_security_headers$fn__84814 invoke ""security.clj"" 182]
  [metabase.server.middleware.json$wrap_json_body$fn__46006 invoke ""json.clj"" 67]
  [metabase.server.middleware.offset_paging$handle_paging$fn__84838 invoke ""offset_paging.clj"" 45]
  [metabase.server.middleware.json$wrap_streamed_json_response$fn__46024 invoke ""json.clj"" 103]
  [ring.middleware.keyword_params$wrap_keyword_params$fn__104656 invoke ""keyword_params.clj"" 55]
  [ring.middleware.params$wrap_params$fn__104675 invoke ""params.clj"" 77]
  [metabase.server.middleware.misc$maybe_set_site_url$fn__67134 invoke ""misc.clj"" 61]
  [metabase.server.middleware.session$reset_session_timeout$fn__72557 invoke ""session.clj"" 543]
  [metabase.server.middleware.session$bind_current_user$fn__72523$fn__72524 invoke ""session.clj"" 438]
  [metabase.server.middleware.session$do_with_current_user invokeStatic ""session.clj"" 417]
  [metabase.server.middleware.session$do_with_current_user invoke ""session.clj"" 401]
  [metabase.server.middleware.session$bind_current_user$fn__72523 invoke ""session.clj"" 437]
  [metabase.server.middleware.session$wrap_current_user_info$fn__72506 invoke ""session.clj"" 376]
  [metabase.server.middleware.session$wrap_session_id$fn__72478 invoke ""session.clj"" 255]
  [metabase.server.middleware.auth$wrap_static_api_key$fn__93935 invoke ""auth.clj"" 30]
  [ring.middleware.cookies$wrap_cookies$fn__104576 invoke ""cookies.clj"" 194]
  [metabase.server.middleware.misc$add_content_type$fn__67116 invoke ""misc.clj"" 29]
  [metabase.server.middleware.misc$disable_streaming_buffering$fn__67142 invoke ""misc.clj"" 78]
  [ring.middleware.gzip$wrap_gzip$fn__104618 invoke ""gzip.clj"" 86]
  [metabase.server.middleware.misc$bind_request$fn__67145 invoke ""misc.clj"" 95]
  [metabase.server.middleware.ssl$redirect_to_https_middleware$fn__104405 invoke ""ssl.clj"" 41]
  [metabase.server$async_proxy_handler$fn__67556 invoke ""server.clj"" 78]
  [metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a handle nil -1]
  [org.eclipse.jetty.server.handler.StatisticsHandler handle ""StatisticsHandler.java"" 173]
  [org.eclipse.jetty.server.handler.HandlerWrapper handle ""HandlerWrapper.java"" 122]
  [org.eclipse.jetty.server.Server handle ""Server.java"" 563]
  [org.eclipse.jetty.server.HttpChannel$RequestDispatchable dispatch ""HttpChannel.java"" 1598]
  [org.eclipse.jetty.server.HttpChannel dispatch ""HttpChannel.java"" 753]
  [org.eclipse.jetty.server.HttpChannel handle ""HttpChannel.java"" 501]
  [org.eclipse.jetty.server.HttpConnection onFillable ""HttpConnection.java"" 287]
  [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded ""AbstractConnection.java"" 314]
  [org.eclipse.jetty.io.FillInterest fillable ""FillInterest.java"" 100]
  [org.eclipse.jetty.io.SelectableChannelEndPoint$1 run ""SelectableChannelEndPoint.java"" 53]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy runTask ""AdaptiveExecutionStrategy.java"" 421]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy consumeTask ""AdaptiveExecutionStrategy.java"" 390]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy tryProduce ""AdaptiveExecutionStrategy.java"" 277]
  [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy run ""AdaptiveExecutionStrategy.java"" 199]
  [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run ""ReservedThreadExecutor.java"" 411]
  [org.eclipse.jetty.util.thread.QueuedThreadPool runJob ""QueuedThreadPool.java"" 969]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner doRunJob ""QueuedThreadPool.java"" 1194]
  [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run ""QueuedThreadPool.java"" 1149]
  [java.lang.Thread run nil -1]],
 :cause ""clj-http: status 401"",
 :data
 {:cached nil,
  :request-time 9,
  :repeatable? false,
  :protocol-version {:name ""HTTP"", :major 1, :minor 1},
  :streaming? true,
  :http-client
  #object[org.apache.http.impl.client.InternalHttpClient 0x2e11e5a0 ""org.apache.http.impl.client.InternalHttpClient@2e11e5a0""],
  :chunked? false,
  :type :clj-http.client/unexceptional-status,
  :reason-phrase ""Unauthorized"",
  :headers
  {""Date"" ""Thu, 18 Apr 2024 14:44:29 GMT"",
   ""Content-Type"" ""application/json;charset=utf-8"",
   ""Content-Length"" ""92"",
   ""Connection"" ""close"",
   ""Cache-Control"" ""no-cache, no-store, max-age=0"",
   ""Content-Security-Policy"" ""frame-ancestors 'none'"",
   ""WWW-Authenticate"" ""Basic""},
  :orig-content-encoding nil,
  :status 401,
  :length 92,
  :body ""{\""error\"":\""Unauthorized request\"",\""errorMessage\"":null,\""errorClass\"":null,\""host\"":\""druid-router\""}"",
  :trace-redirects []},
 :message ""clj-http: status 401"",
 :request-url ""https://druid-test-router.DOMAIN:443/status"",
 :request-options {:content-type ""application/json;charset=UTF-8""},
 :response {:error ""Unauthorized request"", :errorMessage nil, :errorClass nil, :host ""druid-router""}}

[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: step ''sync-dbms-version'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 WARN metabase.sync.util Error running step ''sync-dbms-version'' for druid Database 22 ''druid-test2'',clojure.lang.ExceptionInfo: clj-http: status 401 {:type :db, :request-url ""https://druid-test-router.DOMAIN:443/status"", :request-options {:content-type ""application/json;charset=UTF-8""}, :response {:error ""Unauthorized request"", :errorMessage nil, :errorClass nil, :host ""druid-router""}},	at metabase.driver.druid.client$do_request.invokeStatic(client.clj:49),	at metabase.driver.druid.client$do_request.doInvoke(client.clj:22),	at clojure.lang.RestFn.invoke(RestFn.java:425),	at clojure.core$partial$fn__5908.invoke(core.clj:2641),	at metabase.driver.druid.sync$dbms_version$fn__114651.invoke(sync.clj:68),	at metabase.util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:165),	at metabase.util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154),	at metabase.driver.druid.sync$dbms_version.invokeStatic(sync.clj:67),	at metabase.driver.druid.sync$dbms_version.invoke(sync.clj:63),	at metabase.driver.druid$fn__114749.invokeStatic(druid.clj:34),	at metabase.driver.druid$fn__114749.invoke(druid.clj:32),	at clojure.lang.MultiFn.invoke(MultiFn.java:234),	at metabase.sync.sync_metadata.dbms_version$sync_dbms_version_BANG_.invokeStatic(dbms_version.clj:20),	at metabase.sync.sync_metadata.dbms_version$sync_dbms_version_BANG_.invoke(dbms_version.clj:16),	at clojure.lang.AFn.applyToHelper(AFn.java:154),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.core$apply.invokeStatic(core.clj:669),	at clojure.core$apply.invoke(core.clj:662),	at metabase.sync.util$run_step_with_metadata$fn__60304.doInvoke(util.clj:462),	at clojure.lang.RestFn.invoke(RestFn.java:397),	at metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:131),	at metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:125),	at metabase.sync.util$with_start_and_finish_debug_logging.invokeStatic(util.clj:149),	at metabase.sync.util$with_start_and_finish_debug_logging.invoke(util.clj:145),	at metabase.sync.util$run_step_with_metadata.invokeStatic(util.clj:457),	at metabase.sync.util$run_step_with_metadata.invoke(util.clj:452),	at metabase.sync.util$run_sync_operation$fn__60383.invoke(util.clj:568),	at metabase.sync.util$run_sync_operation.invokeStatic(util.clj:566),	at metabase.sync.util$run_sync_operation.invoke(util.clj:560),	at metabase.sync.sync_metadata$sync_db_metadata_BANG_$fn__82369.invoke(sync_metadata.clj:70),	at metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:190),	at metabase.sync.util$do_with_error_handling.invoke(util.clj:183),	at clojure.core$partial$fn__5910.invoke(core.clj:2647),	at metabase.driver$fn__49798.invokeStatic(driver.clj:778),	at metabase.driver$fn__49798.invoke(driver.clj:778),	at clojure.lang.MultiFn.invoke(MultiFn.java:239),	at metabase.sync.util$sync_in_context$fn__60218.invoke(util.clj:166),	at metabase.sync.util$with_db_logging_disabled$fn__60215.invoke(util.clj:158),	at metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:131),	at metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:125),	at metabase.sync.util$with_start_and_finish_logging$fn__60202.invoke(util.clj:143),	at metabase.sync.util$with_sync_events$fn__60197.invoke(util.clj:117),	at metabase.sync.util$with_duplicate_ops_prevented$fn__60184.invoke(util.clj:89),	at metabase.sync.util$do_sync_operation.invokeStatic(util.clj:215),	at metabase.sync.util$do_sync_operation.invoke(util.clj:209),	at metabase.sync.sync_metadata$sync_db_metadata_BANG_.invokeStatic(sync_metadata.clj:68),	at metabase.sync.sync_metadata$sync_db_metadata_BANG_.invoke(sync_metadata.clj:65),	at metabase.sync$sync_database_BANG_$fn__82379.invoke(sync.clj:52),	at metabase.sync.util$do_with_error_handling.invokeStatic(util.clj:190),	at metabase.sync.util$do_with_error_handling.invoke(util.clj:183),	at clojure.core$partial$fn__5910.invoke(core.clj:2647),	at metabase.driver$fn__49798.invokeStatic(driver.clj:778),	at metabase.driver$fn__49798.invoke(driver.clj:778),	at clojure.lang.MultiFn.invoke(MultiFn.java:239),	at metabase.sync.util$sync_in_context$fn__60218.invoke(util.clj:166),	at metabase.sync.util$with_db_logging_disabled$fn__60215.invoke(util.clj:158),	at metabase.sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:131),	at metabase.sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:125),	at metabase.sync.util$with_start_and_finish_logging$fn__60202.invoke(util.clj:143),	at metabase.sync.util$with_sync_events$fn__60197.invoke(util.clj:117),	at metabase.sync.util$with_duplicate_ops_prevented$fn__60184.invoke(util.clj:89),	at metabase.sync.util$do_sync_operation.invokeStatic(util.clj:215),	at metabase.sync.util$do_sync_operation.invoke(util.clj:209),	at metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:51),	at metabase.sync$sync_database_BANG_.invoke(sync.clj:37),	at metabase.sync$sync_database_BANG_.invokeStatic(sync.clj:46),	at metabase.sync$sync_database_BANG_.invoke(sync.clj:37),	at metabase.events.sync_database$publish_event_BANG__primary_method_metabase_events_sync_database_event$fn__104093.invoke(sync_database.clj:24),	at clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047),	at clojure.lang.AFn.call(AFn.java:18),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source),Caused by: clojure.lang.ExceptionInfo: clj-http: status 401 {:cached nil, :request-time 8, :repeatable? false, :protocol-version {:name ""HTTP"", :major 1, :minor 1}, :streaming? true, :http-client #object[org.apache.http.impl.client.InternalHttpClient 0x55c644dc ""org.apache.http.impl.client.InternalHttpClient@55c644dc""], :chunked? false, :type :clj-http.client/unexceptional-status, :reason-phrase ""Unauthorized"", :headers {""Date"" ""Thu, 18 Apr 2024 14:44:29 GMT"", ""Content-Type"" ""application/json;charset=utf-8"", ""Content-Length"" ""92"", ""Connection"" ""close"", ""Cache-Control"" ""no-cache, no-store, max-age=0"", ""Content-Security-Policy"" ""frame-ancestors 'none'"", ""WWW-Authenticate"" ""Basic""}, :orig-content-encoding nil, :status 401, :length 92, :body ""{\""error\"":\""Unauthorized request\"",\""errorMessage\"":null,\""errorClass\"":null,\""host\"":\""druid-router\""}"", :trace-redirects []},	at slingshot.support$stack_trace.invoke(support.clj:201),	at clj_http.client$exceptions_response.invokeStatic(client.clj:241),	at clj_http.client$exceptions_response.invoke(client.clj:232),	at clj_http.client$wrap_exceptions$fn__27728.invoke(client.clj:250),	at clj_http.client$wrap_accept$fn__27940.invoke(client.clj:728),	at clj_http.client$wrap_accept_encoding$fn__27947.invoke(client.clj:750),	at clj_http.client$wrap_content_type$fn__27934.invoke(client.clj:711),	at clj_http.client$wrap_form_params$fn__28045.invoke(client.clj:959),	at clj_http.client$wrap_nested_params$fn__28066.invoke(client.clj:993),	at clj_http.client$wrap_flatten_nested_params$fn__28075.invoke(client.clj:1017),	at clj_http.client$wrap_method$fn__28013.invoke(client.clj:893),	at clj_http.cookies$wrap_cookies$fn__26977.invoke(cookies.clj:128),	at clj_http.links$wrap_links$fn__27405.invoke(links.clj:63),	at clj_http.client$wrap_unknown_host$fn__28083.invoke(client.clj:1046),	at clj_http.client$request_STAR_.invokeStatic(client.clj:1174),	at clj_http.client$request_STAR_.invoke(client.clj:1167),	at clj_http.client$get.invokeStatic(client.clj:1180),	at clj_http.client$get.doInvoke(client.clj:1176),	at clojure.lang.RestFn.invoke(RestFn.java:423),	at metabase.driver.druid.client$do_request.invokeStatic(client.clj:35),	... 73 more
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util FINISHED: step ''sync-dbms-version'' for druid Database 22 ''druid-test2'' (10.2 ms)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util FINISHED: step ''sync-timezone'' for druid Database 22 ''druid-test2'' (145.6 µs)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: step ''sync-tables'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: step ''sync-timezone'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.sync-metadata.sync-timezone :druid database 22 default timezone is nil
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.sync-metadata.tables Found new tables: (Table  ''wikipedia'')
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.sync-metadata.tables Updating table metadata for Table 4659 ''wikipedia''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 DEBUG metabase.server.middleware.log GET /api/database 200 6.4 ms (3 DB calls) App DB connections: 2/14 Jetty threads: 3/50 (4 idle, 0 queued) (126 total active threads) Queries in flight: 0 (0 queued)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util FINISHED: step ''sync-tables'' for druid Database 22 ''druid-test2'' (112.0 ms)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: step ''sync-fields'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util FINISHED: step ''sync-fields'' for druid Database 22 ''druid-test2'' (171.9 ms)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: step ''sync-fks'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util FINISHED: step ''sync-fks'' for druid Database 22 ''druid-test2'' (6.4 ms)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util FINISHED: step ''sync-indexes'' for druid Database 22 ''druid-test2'' (29.1 µs)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util FINISHED: step ''sync-metabase-metadata'' for druid Database 22 ''druid-test2'' (43.8 µs)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util FINISHED: step ''sync-table-privileges'' for druid Database 22 ''druid-test2'' (29.8 µs)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: step ''sync-indexes'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: step ''sync-metabase-metadata'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: step ''sync-table-privileges'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util FINISHED: Sync metadata for druid Database 22 ''druid-test2'' (403.8 ms)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: Analyze data for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.util STARTING: step ''fingerprint-fields'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 INFO metabase.sync.analyze fingerprint-fields Analyzed [************······································] 😒   25% Table 4659 ''wikipedia''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:29+02:00 WARN metabase.driver.druid.query-processor scan queries can only be sorted by the 'timestamp' column.
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:31+02:00 DEBUG metabase.server.middleware.log GET /api/database 200 7.0 ms (3 DB calls) App DB connections: 1/14 Jetty threads: 3/50 (4 idle, 0 queued) (127 total active threads) Queries in flight: 0 (0 queued)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.util FINISHED: step ''fingerprint-fields'' for druid Database 22 ''druid-test2'' (4.1 s)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.util STARTING: step ''classify-fields'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.analyze classify-fields Analyzed [*************************·························] 😬   50% Table 4659 ''wikipedia''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.util FINISHED: step ''classify-fields'' for druid Database 22 ''druid-test2'' (110.9 ms)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.util STARTING: step ''classify-tables'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.analyze classify-tables Analyzed [*************************************·············] 😋   75% Table 4659 ''wikipedia''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.util FINISHED: step ''classify-tables'' for druid Database 22 ''druid-test2'' (6.4 ms)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.util FINISHED: Analyze data for druid Database 22 ''druid-test2'' (4.3 s)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.util STARTING: Cache field values in druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.util STARTING: step ''delete-expired-advanced-field-values'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.util FINISHED: step ''delete-expired-advanced-field-values'' for druid Database 22 ''druid-test2'' (76.1 ms)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:33+02:00 INFO metabase.sync.util STARTING: step ''update-field-values'' for druid Database 22 ''druid-test2''
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:35+02:00 INFO metabase.sync.util FINISHED: step ''update-field-values'' for druid Database 22 ''druid-test2'' (2.0 s)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:35+02:00 INFO metabase.sync.util FINISHED: Cache field values in druid Database 22 ''druid-test2'' (2.1 s)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:35+02:00 INFO metabase.sync.util FINISHED: Sync druid Database 22 ''druid-test2'' (6.8 s)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:43+02:00 DEBUG metabase.server.middleware.log GET /api/user/current 200 12.5 ms (10 DB calls) App DB connections: 2/14 Jetty threads: 4/50 (3 idle, 0 queued) (127 total active threads) Queries in flight: 0 (0 queued)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:43+02:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 14.1 ms (7 DB calls) App DB connections: 1/14 Jetty threads: 3/50 (4 idle, 0 queued) (127 total active threads) Queries in flight: 0 (0 queued)
[53f4eed0-9bd8-4c1f-a417-2b3c4636099a] 2024-04-18T16:44:43+02:00 DEBUG metabase.server.middleware.log GET /api/database 200 6.7 ms (3 DB calls) App DB connections: 1/14 Jetty threads: 4/50 (3 idle, 0 queued) (127 total active threads) Queries in flight: 0 (0 queued)
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.184-175.731.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""athena"",
      ""druid"",
      ""postgres"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-02"",
      ""tag"": ""v0.49.3"",
      ""hash"": ""dba0992""
    },
    ""settings"": {
      ""report-timezone"": ""UTC""
    }
  }
}
```


### Severity

High

### Additional context

PR introducing auth to druid driver: https://github.com/metabase/metabase/pull/20412",jakubmatyszewski,2024-04-18 14:52:05+00:00,['lbrdnk'],2024-07-19 18:11:24+00:00,2024-07-19 17:16:41+00:00,https://github.com/metabase/metabase/issues/41579,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Druid', None), ('.Backend', ''), ('Administration/Databases', '')]","[{'comment_id': 2068718266, 'issue_id': 2250899090, 'author': 'paoliniluis', 'body': ""Hi @jakubmatyszewski we're about to launch a new Druid driver: https://github.com/metabase/metabase/issues/39938, can you wait for that new driver to land and let us know if this still happens?"", 'created_at': datetime.datetime(2024, 4, 22, 7, 49, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2068747108, 'issue_id': 2250899090, 'author': 'jakubmatyszewski', 'body': '@paoliniluis Can I kindly ask for estimated time frame in which you expect this to be delivered? Even vague estimation of weeks/months would be great.\r\nThanks!', 'created_at': datetime.datetime(2024, 4, 22, 8, 3, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2069152360, 'issue_id': 2250899090, 'author': 'paoliniluis', 'body': '@jakubmatyszewski weeks', 'created_at': datetime.datetime(2024, 4, 22, 11, 27, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2120363879, 'issue_id': 2250899090, 'author': 'jakubmatyszewski', 'body': ""I've seen that new druid-jdbc has been merged: https://github.com/metabase/metabase/pull/40293 but as for now it doesn't allow basic auth."", 'created_at': datetime.datetime(2024, 5, 20, 12, 28, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2192289849, 'issue_id': 2250899090, 'author': 'calherries', 'body': ""P1 because it's blocking Metabase usage"", 'created_at': datetime.datetime(2024, 6, 26, 17, 44, 42, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 07:49:37 UTC): Hi @jakubmatyszewski we're about to launch a new Druid driver: https://github.com/metabase/metabase/issues/39938, can you wait for that new driver to land and let us know if this still happens?

jakubmatyszewski (Issue Creator) on (2024-04-22 08:03:22 UTC): @paoliniluis Can I kindly ask for estimated time frame in which you expect this to be delivered? Even vague estimation of weeks/months would be great.
Thanks!

paoliniluis on (2024-04-22 11:27:27 UTC): @jakubmatyszewski weeks

jakubmatyszewski (Issue Creator) on (2024-05-20 12:28:46 UTC): I've seen that new druid-jdbc has been merged: https://github.com/metabase/metabase/pull/40293 but as for now it doesn't allow basic auth.

calherries on (2024-06-26 17:44:42 UTC): P1 because it's blocking Metabase usage

"
2250723365,issue,closed,completed,Enable scatterplot to plot datetime data,"**Is your feature request related to a problem? Please describe.**
To use a scatterplot, you need to ask a question that results in two numeric columns. I would like to be able to ask questions involving a datetime data column.

**Describe the solution you'd like**
The ability to specify a datetime column as one of the axes in a scatterplot.

**Describe alternatives you've considered**
As a workaround, users can convert their datetime data into an ""age"" integer using an expression like `datetimeDiff(now, [Date Column], ""day"") / 365`. In the interim, you may want to add this tip to the [scatterplot documentation page](https://www.metabase.com/docs/latest/questions/sharing/visualizations/scatterplot-or-bubble-chart).

**How important is this feature to you?**
Analyzing customer data over time is important. For example, to see trends in the types of products that are licensed over time, I can create a scatterplot using columns like ""purchase date"" and ""license duration"", with a series breakout for ""product family"". This gives me color-coded dots that show the type of products that are being purchased and for how long.

**Additional context**
Add any other context or screenshots about the feature request here.
",beefstew,2024-04-18 13:36:21+00:00,[],2025-01-02 14:41:29+00:00,2025-01-02 14:41:28+00:00,https://github.com/metabase/metabase/issues/41573,"[('Type:New Feature', ''), ('.Needs Triage', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2070295894, 'issue_id': 2250723365, 'author': 'paoliniluis', 'body': 'Hi, you can put timestamps in the x-axis\r\n![image](https://github.com/metabase/metabase/assets/1711649/850d552b-e05d-4207-9ac6-f535bba9bb8e)\r\n\r\n\r\nAm I wrong?', 'created_at': datetime.datetime(2024, 4, 22, 17, 14, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2567877810, 'issue_id': 2250723365, 'author': 'brunobergher', 'body': 'Closed from the apparently sufficient answer from @paoliniluis .', 'created_at': datetime.datetime(2025, 1, 2, 14, 41, 28, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 17:14:56 UTC): Hi, you can put timestamps in the x-axis
![image](https://github.com/metabase/metabase/assets/1711649/850d552b-e05d-4207-9ac6-f535bba9bb8e)


Am I wrong?

brunobergher on (2025-01-02 14:41:28 UTC): Closed from the apparently sufficient answer from @paoliniluis .

"
2250455529,issue,open,,Wrong Casting on Upload CSV to Model,"### Describe the bug

When we are uploading the CSV file that contains Yes/No values or 1/0 values. The column is automatically casted to Boolean.
We need same data whichever updated to be present in the Table/Model as well

### To Reproduce

Upload CSV File with Yes/No values or upload CSV with 1/0 values

### Expected behavior

The same data in CSV should be present after Upload to Metabase

### Logs

_No response_

### Information about your Metabase installation

```JSON
Metabase version - v0.47.7
```


### Severity

High

### Additional context

Kindly let me know if there is any alternate for this solution for time being",cons-barathan,2024-04-18 11:31:41+00:00,[],2024-05-13 15:08:21+00:00,,https://github.com/metabase/metabase/issues/41570,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Organization/Uploads', 'Direct data upload (CSV)')]","[{'comment_id': 2063704710, 'issue_id': 2250455529, 'author': 'crisptrutski', 'body': 'Hi there,\r\n\r\nUnfortunately at this time there is no way to opt-out of the way that we detect boolean columns.\r\n\r\nAs workarounds, the first things to occur to me are:\r\n\r\n1. You could edit the model to hide the raw table field, and add a custom column of the same name which re-calculates the desired format. See screenshots below.\r\n\r\n2. If you can get access to the underlying database, you could run some statements to alter the column type and data to the desired format.\r\n\r\nI understand that both of these are very manual steps, so it would be good to understand more about your use case to find a better long term solution.\r\n\r\n![Screenshot 2024-04-18 at 14 02 14](https://github.com/metabase/metabase/assets/881351/be0b11a3-62a6-407b-9a98-04a5b825fc3a)\r\n![Screenshot 2024-04-18 at 13 58 21](https://github.com/metabase/metabase/assets/881351/66fceb1d-d060-4bf5-8394-0e274e20323d)\r\n![Screenshot 2024-04-18 at 13 58 33](https://github.com/metabase/metabase/assets/881351/ffa852ec-c3f8-4472-9e7c-b861a3b7d790)\r\n![Screenshot 2024-04-18 at 14 01 53](https://github.com/metabase/metabase/assets/881351/18e6b3a8-dc1d-409e-813d-5db8a68ab1ac)', 'created_at': datetime.datetime(2024, 4, 18, 12, 3, 5, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-04-18 12:03:05 UTC): Hi there,

Unfortunately at this time there is no way to opt-out of the way that we detect boolean columns.

As workarounds, the first things to occur to me are:

1. You could edit the model to hide the raw table field, and add a custom column of the same name which re-calculates the desired format. See screenshots below.

2. If you can get access to the underlying database, you could run some statements to alter the column type and data to the desired format.

I understand that both of these are very manual steps, so it would be good to understand more about your use case to find a better long term solution.

![Screenshot 2024-04-18 at 14 02 14](https://github.com/metabase/metabase/assets/881351/be0b11a3-62a6-407b-9a98-04a5b825fc3a)
![Screenshot 2024-04-18 at 13 58 21](https://github.com/metabase/metabase/assets/881351/66fceb1d-d060-4bf5-8394-0e274e20323d)
![Screenshot 2024-04-18 at 13 58 33](https://github.com/metabase/metabase/assets/881351/ffa852ec-c3f8-4472-9e7c-b861a3b7d790)
![Screenshot 2024-04-18 at 14 01 53](https://github.com/metabase/metabase/assets/881351/18e6b3a8-dc1d-409e-813d-5db8a68ab1ac)

"
2250292993,issue,closed,completed,Indicate whether `dependent-metadata` needs to be called again,"Needed for #41520

https://metaboat.slack.com/archives/C051AG38B2S/p1713200875104199

> dependent-metadata needs to be called twice when creating a metric based question. the first time around it would tell to load the metadata of the card, and the second time (when it can look at the metadata of the card), it will tell to load the metadata of the table underlying the metric (card).

----

### Proposed API

#### Variant A - new function

```tsx
function hasCompleteMetadata(query: Query): boolean;
```

Alternative name suggestions:
- `hasAllDependentMetadata`
- `hasDependentMetadata`
- `hasAllMetadata`

#### Variant B - enhancing `dependentMetadata` result with this information

```tsx
function dependentMetadata(query: Query): {
  items: DependentItem[];
  hasCompleteMetadata: boolean; // subject to alternative name suggestions from Variant A
};
```
",kamilmielnik,2024-04-18 10:09:01+00:00,['metamben'],2024-04-18 19:50:44+00:00,2024-04-18 19:50:44+00:00,https://github.com/metabase/metabase/issues/41568,"[('.Backend', '')]","[{'comment_id': 2065134277, 'issue_id': 2250292993, 'author': 'metamben', 'body': 'Closing in accordance with the discussion in [slack](https://metaboat.slack.com/archives/C0643FZ5E83/p1713452628224769).', 'created_at': datetime.datetime(2024, 4, 18, 19, 50, 44, tzinfo=datetime.timezone.utc)}]","metamben (Assginee) on (2024-04-18 19:50:44 UTC): Closing in accordance with the discussion in [slack](https://metaboat.slack.com/archives/C0643FZ5E83/p1713452628224769).

"
2250287754,issue,closed,completed,Serialization import should not fail on hidden .yaml files,"And hopefully other (irrelevant to serialization process) files. [Relevant thread](https://metaboat.slack.com/archives/CEM835PJP/p1713350647830529)

Gist of a problem: some editing software was creating `.<entity-id>.yaml` files with unreadable content and we are just checking the extension of the file.",piranha,2024-04-18 10:06:24+00:00,[],2024-05-02 15:11:56+00:00,2024-04-30 08:26:09+00:00,https://github.com/metabase/metabase/issues/41567,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Workflows', 'aka BEC')]",[],
2250064854,issue,closed,not_planned,TypeError: Cannot read properties of null (reading 'dashcards'),"### Describe the bug

![image](https://github.com/metabase/metabase/assets/6830683/f64322ef-b93b-4201-9746-e33f6c0aa5e1)


### To Reproduce

1. Go to https://stats.metabase.com/
2. Click on Metabase logo in top-left corner of the app (do this until you see the error)
3. Observe JS console

> Uncaught (in promise) TypeError: Cannot read properties of null (reading 'dashcards')


### Expected behavior

No TypeError in JS console

### Information about your Metabase installation

master, 39cf70c


### Severity

P2
",kamilmielnik,2024-04-18 08:25:14+00:00,[],2024-06-14 07:02:05+00:00,2024-06-07 16:21:17+00:00,https://github.com/metabase/metabase/issues/41563,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2063441849, 'issue_id': 2250064854, 'author': 'uladzimirdev', 'body': 'similar to https://github.com/metabase/metabase/issues/34699', 'created_at': datetime.datetime(2024, 4, 18, 9, 33, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2155153575, 'issue_id': 2250064854, 'author': 'kulyk', 'body': 'Closing in favor of https://github.com/metabase/metabase/issues/43800', 'created_at': datetime.datetime(2024, 6, 7, 16, 21, 17, tzinfo=datetime.timezone.utc)}]","uladzimirdev on (2024-04-18 09:33:58 UTC): similar to https://github.com/metabase/metabase/issues/34699

kulyk on (2024-06-07 16:21:17 UTC): Closing in favor of https://github.com/metabase/metabase/issues/43800

"
2249583925,issue,open,,Formatting options for displaying time duration,"**Is your feature request related to a problem? Please describe.**
When I was tracking user online time, I found that there was no place to format the time unit ""seconds"" into ""hours:minutes:seconds.""

**Describe the solution you'd like**
I hope to add a way to format the displayed data.

**How important is this feature to you?**
For example, during your regular report with the boss, you look at a Metabase chart and say, ""Yesterday's total online time was 17600 seconds."" The boss will surely look at you with a puzzled expression. However, if it could be converted to ""4 hours 53 minutes 20 seconds,"" it would be the most user-friendly BI tool in the entire universe.

**Additional context**
As shown in the figure.
![image](https://github.com/metabase/metabase/assets/107522343/0dbb3f81-e362-4440-96df-2866a3c78930)",qilinxinan,2024-04-18 02:07:35+00:00,[],2025-02-04 20:31:26+00:00,,https://github.com/metabase/metabase/issues/41561,"[('Type:New Feature', ''), ('Visualization/Chart Settings', ''), ('Customization/Formatting', ''), ('Semantic Model', ''), ('Semantic Model/Dimensions', ''), ('Semantic Model/Units', '')]",[],
2249332312,issue,open,,Simplify Customization of Series Breakouts in Bar & Line Charts,"**Is your feature request related to a problem? Please describe.**
If there is a chart with a series breakout that has a lot of categories it is very cumbersome to update style and axis position settings because it needs to be done for each category individually. This is fine if there are just 5 or 10 but in some cases there are hundreds.

Imagine a dashboard with data aggregates by city on a dashboard that contains a filter for a state. Each time the state filter is updated you'll have a different list of cities - every city int he full result set would have to be updated in the viz settings if you needed to modify axis position or anything else.

**Describe the solution you'd like**
Given the above example, it would be nice to be able to set a default for every value in the series. So for the ""City"" axis set ""Left"" as the default axis position (an option to reset the values in the series to a new default would also be nice). You could still override this at a lower level if needed. it would also be great if there were a mechanism for batch editing these in the case that you do need to customize and you're working with hundreds of records - many of which won't be visible in the current left nav.


",ixipixi,2024-04-17 21:49:55+00:00,[],2024-04-17 21:52:51+00:00,,https://github.com/metabase/metabase/issues/41557,"[('Type:New Feature', ''), ('Customization/Formatting', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2249272177,issue,closed,completed,"Add ""gray"" to the color pallette for bar plots","**Is your feature request related to a problem? Please describe.**
When selecting from the color palette on a bar plot, there is no option for ""gray"".  Gray/grey is useful for sometimes highlighting a category that isn't critical or very important.

**Describe the solution you'd like**
Add a palette of ""GREY"" colors that can be used in bar plots.

**How important is this feature to you?**
Medium importance 

**Additional context**
<img width=""344"" alt=""Screenshot 2024-04-17 at 2 08 12 PM"" src=""https://github.com/metabase/metabase/assets/1548549/f36c5048-16d9-4664-9268-23a669ec411e"">
",ronrlin,2024-04-17 21:08:26+00:00,[],2025-02-02 18:50:13+00:00,2025-02-02 18:50:13+00:00,https://github.com/metabase/metabase/issues/41554,"[('Type:New Feature', ''), ('Visualization/Chart Settings', '')]","[{'comment_id': 2070654859, 'issue_id': 2249272177, 'author': 'ignacio-mb', 'body': 'Related to https://github.com/metabase/metabase/issues/6300', 'created_at': datetime.datetime(2024, 4, 22, 18, 56, 31, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-04-22 18:56:31 UTC): Related to https://github.com/metabase/metabase/issues/6300

"
2249220468,issue,closed,completed,[dc.js migration] waterfall chart with unaggregated time-series data is broken,https://github.com/metabase/metabase/assets/22608765/e309de82-27f5-4e11-8107-37e6f2a97872,JesseSDevaney,2024-04-17 20:30:19+00:00,['alxnddr'],2024-05-30 20:04:38+00:00,2024-05-30 20:04:33+00:00,https://github.com/metabase/metabase/issues/41551,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2249220364,issue,closed,completed,"[dc.js migration] waterfall chart ""total label name"" breaks with time-series x-axis scale","https://github.com/metabase/metabase/assets/22608765/248d0f40-ac5a-40c4-9770-628da2db8918

The issue is related to time zones

",JesseSDevaney,2024-04-17 20:30:15+00:00,['JesseSDevaney'],2024-04-25 18:15:15+00:00,2024-04-25 18:15:14+00:00,https://github.com/metabase/metabase/issues/41550,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]","[{'comment_id': 2077881629, 'issue_id': 2249220364, 'author': 'JesseSDevaney', 'body': 'Incidentally this was fixed by [PR #41456](https://github.com/metabase/metabase/pull/41456/files#diff-dc90c16d9b347f388490cd11463502b5a195f5ea4e72a219fd062dadff837b38)', 'created_at': datetime.datetime(2024, 4, 25, 18, 15, 14, tzinfo=datetime.timezone.utc)}]","JesseSDevaney (Issue Creator) on (2024-04-25 18:15:14 UTC): Incidentally this was fixed by [PR #41456](https://github.com/metabase/metabase/pull/41456/files#diff-dc90c16d9b347f388490cd11463502b5a195f5ea4e72a219fd062dadff837b38)

"
2249190158,issue,closed,completed,"Enable re-ordering fields in the summarize ""by"" field (Question builder)","Hello and thank you! I'm a new user with time-sensitive data analysis needs who figured it's faster to learn Metabase than muck about in Excel; and I'm pretty good with Excel. I recently encountered an issue that cost me significant time:

There is no way to re-order the columns in the ""by"" field. This is important functionality for two reasons:

1. When trying to build a stacked bar chart, I learned that the order in which I define my ""by"" criteria is very important. The field that I want to use to drive the stacking must be declared _first_ in the ""by"" field. Since there is no affordance for re-ordering, I assumed order did not matter; it took significant trial and error plus web searches to figure out the solution.
2. User work is lost when a ""Custom column"" is defined based on a column in the ""by"" field that must be moved. Worse, removing the column in the ""by"" field does not warn the user that their custom column will be automatically removed.

Luckily, the expression editor is so small and lacks an indenting feature, that users are likely to develop their complex expressions in a text editor and copy/paste them into the expression... helping prevent them from losing work.

Concrete example:
![Screenshot 2024-04-17 at 16 08 24](https://github.com/metabase/metabase/assets/2262454/f7268106-2c78-4988-bab3-413987ebd97a)
I needed the ability to re-order Geography and Product Code so that my stacked bar would work and the CNP Product custom column would not be automatically removed.",beefstew,2024-04-17 20:12:31+00:00,[],2024-11-06 15:09:53+00:00,2024-11-06 15:09:52+00:00,https://github.com/metabase/metabase/issues/41547,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2162932052, 'issue_id': 2249190158, 'author': 'gabriel-r', 'body': 'It seems weird that this issues is not a duplicate of one or many older ones.', 'created_at': datetime.datetime(2024, 6, 12, 12, 50, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2460018249, 'issue_id': 2249190158, 'author': 'mngr', 'body': ""We've implemented drag-to-reorder behavior in the Question Builder"", 'created_at': datetime.datetime(2024, 11, 6, 15, 9, 52, tzinfo=datetime.timezone.utc)}]","gabriel-r on (2024-06-12 12:50:52 UTC): It seems weird that this issues is not a duplicate of one or many older ones.

mngr on (2024-11-06 15:09:52 UTC): We've implemented drag-to-reorder behavior in the Question Builder

"
2249101384,issue,closed,completed,[dc.js migration] static-viz rendering errors when trying to access `visualization_settings`,"- Caught this when attempting to fix broken E2E spec: `reproductions/27427-static-viz-divide-by-zero.cy.spec.js`
- Could reproduce with the question created by the original issue: https://github.com/metabase/metabase/issues/27427. Although the original issue's error is different from this one, and I believe this is more specific to ECharts.

---
![Screenshot from 2024-04-17 15-07-04](https://github.com/metabase/metabase/assets/22608765/f32346ed-0b82-4c16-9c2d-5ae002f4f57b)


- Error occurring here: https://github.com/metabase/metabase/blob/echarts/frontend/src/metabase/visualizations/echarts/cartesian/model/index.ts#L45-L47
    - rawSeries data for a single card contains multiple series without any additional or useful information. Since there are multiple series, it tries to use the `card.visualization_settings` - which in this case, does not exist/is null",JesseSDevaney,2024-04-17 19:30:13+00:00,[],2024-04-18 20:09:06+00:00,2024-04-18 19:13:40+00:00,https://github.com/metabase/metabase/issues/41546,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2248967827,issue,closed,completed,`DatasetFieldMetadataSidebar`,,npfitz,2024-04-17 18:30:32+00:00,['npfitz'],2024-04-26 18:04:02+00:00,2024-04-26 18:04:02+00:00,https://github.com/metabase/metabase/issues/41539,[],[],
2248905991,issue,closed,completed,Final Milestone Adjustments,"```[tasklist]
### Tasks
- [x] Put Recent Items at the top of the list
- [x] Don't filter search results from the API
```
",npfitz,2024-04-17 18:00:31+00:00,['npfitz'],2024-04-26 18:34:47+00:00,2024-04-26 18:34:46+00:00,https://github.com/metabase/metabase/issues/41536,[],[],
2248694811,issue,open,,Customer embeds Metabase with 'header' and 'action_buttons' set to false but wants end users to access 'Export to PDF'.,"**Is your feature request related to a problem? Please describe.**
We have a customer that is embedding Metabase and setting the 'header' and 'action_buttons' [components](https://www.metabase.com/docs/latest/embedding/interactive-embedding#showing-or-hiding-metabase-ui-components) to FALSE. However, they would like for their end users to have access to ‘Export to PDF’.

**Describe alternatives you've considered**
Fortunately you can print to PDF from the workstation, or use browser extensions to help with this.

**How important is this feature to you?**
It's a nice to have for the workflow of the end users.

",FilmonK,2024-04-17 16:15:14+00:00,[],2024-05-21 13:01:52+00:00,,https://github.com/metabase/metabase/issues/41533,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Type:New Feature', ''), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('.Team/Embedding', '')]","[{'comment_id': 2063890099, 'issue_id': 2248694811, 'author': 'ignacio-mb', 'body': 'Related to https://github.com/metabase/metabase/issues/38477', 'created_at': datetime.datetime(2024, 4, 18, 13, 37, 40, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-04-18 13:37:40 UTC): Related to https://github.com/metabase/metabase/issues/38477

"
2248670440,issue,closed,completed,No visible alert for users when downloads fail,"### Describe the bug

When downloading full data results, if an error occurs, the frontend currently does not display any visible alert to the user, and the downloaded file will be corrupted. 

The error can be anything that interrupts the download - e.g. timeout caused by a slow query, or a Metabase OOM error or instance restart due to a large result set. 

This confuses the user who will likely re-attempt the same download several times before changing their query or giving up.

### To Reproduce

1. Create a native question `select pg_sleep(900) as a, 234 as b` and save it.
2. Open, and download the results (in any format).
3. Wait for the download
... time passes ...
4.(!) After a period (likely due to jetty or proxy timeout), notice that the ""spinning circle"" disappears and the download icon reappears.
5.(!) The downloaded file does not contain the expected data but an error message instead.

Alternatively, you can just Metabase between steps 3 and 4, no file will be downloaded, yet the frontend will not display any error indication.

### Expected behavior

The user should see a relevant and actionable alert when a download error happens. Ideally, any partially downloaded files should also be removed.

### Logs

Downloaded file contents:
```
<html>
<head>
<meta http-equiv=""Content-Type"" content=""text/html;charset=ISO-8859-1""/>
<title>Error 500 AsyncContext timeout</title>
</head>
<body><h2>HTTP ERROR 500 AsyncContext timeout</h2>
<table>
<tr><th>URI:</th><td>/api/card/87/query/xlsx</td></tr>
<tr><th>STATUS:</th><td>500</td></tr>
<tr><th>MESSAGE:</th><td>AsyncContext timeout</td></tr>
<tr><th>SERVLET:</th><td>-</td></tr>
</table>
<hr/><a href=""https://eclipse.org/jetty"">Powered by Jetty:// 11.0.20</a><hr/>

</body>
</html>
```

Console error:
```
downloading.ts:171  POST http://localhost:1495/api/card/87/query/xlsx?format_rows=false net::ERR_EMPTY_RESPONSE
```

DB Logs:
```
2024-04-17 15:44:28.173 UTC [20243] LOG:  execute <unnamed>: -- Metabase:: userID: 1 queryType: native queryHash: 1847d12cb0a569a24fe90dec8be60de1c8596700c67f46bad2229998e9cc5b14
        select pg_sleep(900) as a, 234 as b
24~2024-04-17 15:54:30.695 UTC [20243] ERROR:  canceling statement due to user request
```



### Information about your Metabase installation

```JSON
1.49.5
```


### Severity

P2, annoying and affects performance when users repeat their download attempts

### Additional context

_No response_",zbodi74,2024-04-17 16:05:15+00:00,['alxnddr'],2024-07-31 00:14:14+00:00,2024-07-30 00:01:51+00:00,https://github.com/metabase/metabase/issues/41532,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Backend', ''), ('Visualization/Download', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2245662900, 'issue_id': 2248670440, 'author': 'cdeweyx', 'body': 'Partially handled by https://github.com/metabase/metabase/pull/45697 but still remaining is: ""any partially downloaded files should also be removed""', 'created_at': datetime.datetime(2024, 7, 23, 16, 11, 47, tzinfo=datetime.timezone.utc)}]","cdeweyx on (2024-07-23 16:11:47 UTC): Partially handled by https://github.com/metabase/metabase/pull/45697 but still remaining is: ""any partially downloaded files should also be removed""

"
2248630965,issue,closed,completed," Customer wants Email Links to Redirect to Their Company Page with Embedded Metabase, Not Just Metabase","**Is your feature request related to a problem? Please describe.**
Our customer, who has multiple clients, has integrated Metabase into their company's webpage, which clients access by logging in. They offer subscriptions and want to ensure that when a user clicks on a link in an email from a subscription, it directs them to the company's webpage where Metabase is embedded, instead of leading them directly to Metabase.

This looks to be controlled by a template for subscriptions/pulses.
```
  <div class=""footer"" style=""font-size: 11px; width: max-content; margin: 0 auto"">
              Sent from <a href=""{{siteUrl}}"" style=""color: {{applicationColor}}"">{{siteUrl}}</a>.
              <a href=""{{notificationManagementUrl}}"" style=""color: {{applicationColor}}"">{{notificationText}}</a>
  </div>
```

**Describe alternatives you've considered**
Proxy that will handle the redirect with parameters

**How important is this feature to you?**
This will help the customer maintain a visual and workflow consistency for their end users.

**Additional context**
N/A
",FilmonK,2024-04-17 15:49:44+00:00,[],2024-05-29 15:28:19+00:00,2024-04-19 23:33:27+00:00,https://github.com/metabase/metabase/issues/41531,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Pulses', 'Now called Subscriptions'), ('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2067392938, 'issue_id': 2248630965, 'author': 'FilmonK', 'body': ""Late but found out about [MB_NOTIFICATION_LINK_BASE_URL](https://www.metabase.com/docs/latest/configuring-metabase/environment-variables#mb_notification_link_base_url) however doesn't appear to be working with initial tests. Will test next week and create an issue if need be."", 'created_at': datetime.datetime(2024, 4, 19, 23, 33, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2137695175, 'issue_id': 2248630965, 'author': 'ignacio-mb', 'body': '@FilmonK should this be closed as not planned instead as completed?', 'created_at': datetime.datetime(2024, 5, 29, 15, 28, 19, tzinfo=datetime.timezone.utc)}]","FilmonK (Issue Creator) on (2024-04-19 23:33:27 UTC): Late but found out about [MB_NOTIFICATION_LINK_BASE_URL](https://www.metabase.com/docs/latest/configuring-metabase/environment-variables#mb_notification_link_base_url) however doesn't appear to be working with initial tests. Will test next week and create an issue if need be.

ignacio-mb on (2024-05-29 15:28:19 UTC): @FilmonK should this be closed as not planned instead as completed?

"
2248522152,issue,closed,completed,Hovering on legend to see a specific series always shows first series as well,"Hovering on the legend for any series other than the first one, incorrectly always shows the first series for some reason. Happens on the question itself and on dashboards. [Internal example](https://stats.metabase.com/question/17107-assigned-tickets).

![Image](https://github.com/metabase/metabase/assets/16455495/ed77c4d5-0aaa-4b75-a848-c1a674071510)

",cdeweyx,2024-04-17 15:03:33+00:00,['alxnddr'],2024-05-17 15:26:09+00:00,2024-05-17 15:22:50+00:00,https://github.com/metabase/metabase/issues/41526,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/', ''), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2117844584, 'issue_id': 2248522152, 'author': 'alxnddr', 'body': 'Closed by https://github.com/metabase/metabase/pull/41395', 'created_at': datetime.datetime(2024, 5, 17, 15, 26, 8, tzinfo=datetime.timezone.utc)}]","alxnddr (Assginee) on (2024-05-17 15:26:08 UTC): Closed by https://github.com/metabase/metabase/pull/41395

"
2248487963,issue,open,,Counts are nuanced and we need a comprehensive solution,"Many things are based on counts of items, users, etc:
- admin checklist 
- billing
- usage stats

We also are including more content in an instance. In particular we have audit v2 and are starting to include sample content. This is throwing off our counts. Our usage of `toucan2.core/count` invites people to count things, forgetting that they need to exclude internal users, perhaps api keys; or exclude audit collections, etc.

We should create an API to enumerate things in the application and serve these needs. See
- https://github.com/metabase/metabase/issues/41335
- (another issue about ""Cal is going to exclude sample content and audit content from usage stats""): https://github.com/metabase/metabase/pull/41522

<details>
  <summary>Usages of `t2/count`:</summary>
  
```
src/metabase/analytics/stats.clj:173
(t2/count PermissionsGroup)

src/metabase/analytics/stats.clj:278
(t2/count Pulse :alert_condition nil)

src/metabase/analytics/stats.clj:289
(t2/count Pulse :alert_condition [:not= nil])

src/metabase/analytics/stats.clj:291
(t2/count Pulse :alert_condition [:not= nil] :alert_first_only true)

src/metabase/analytics/stats.clj:292
(t2/count Pulse :alert_condition [:not= nil] :alert_above_goal true)

src/metabase/analytics/stats.clj:341
(t2/count Segment)

src/metabase/analytics/stats.clj:346
(t2/count LegacyMetric)

src/metabase/api/api_key.clj:88
(t2/count :model/ApiKey)

src/metabase/api/persist.clj:73
(t2/count PersistedInfo :database_id [:in writable-db-ids])

src/metabase/api/setup.clj:173
(t2/count User)

src/metabase/api/setup.clj:174
(t2/count Card)

src/metabase/api/setup.clj:175
(t2/count Table)

src/metabase/api/task.clj:17
(t2/count TaskHistory)

src/metabase/api/user.clj:251
(t2/count :model/User (filter-clauses-without-paging clauses))

src/metabase/api/user.clj:259
(t2/count :model/User (filter-clauses-without-paging clauses))

src/metabase/embed/settings.clj:34
(t2/count :model/Card :enable_embedding true)

src/metabase/embed/settings.clj:35
(t2/count :model/Dashboard :enable_embedding true)

src/metabase/models/collection.clj:179
(t2/count Collection :id [:in ids])

src/metabase/models/dashboard.clj:487
(t2/count Collection :name [:like (format ""%s%%"" collection-name)] :location (collection/children-location (t2/select-one [Collection :location :id] :id parent-collection-id)))

src/metabase/models/pulse_channel.clj:165
(t2/count PulseChannel :pulse_id pulse-id :id [:not= pulse-channel-id])

src/metabase/models/pulse_channel_recipient.clj:20
(t2/count PulseChannelRecipient :pulse_channel_id channel-id :id [:not= pulse-channel-recipient-id])

src/metabase/models/user.clj:295
(t2/count User)

src/metabase/public_settings/premium_features.clj:69
(t2/count :model/User :is_active true :type :personal)

src/metabase/public_settings/premium_features.clj:147
(t2/count :model/User :is_active true :type :personal)

src/metabase/task/creator_sentiment_emails.clj:68
(t2/count :model/User :is_active true :type ""personal"")

src/metabase/task/creator_sentiment_emails.clj:69
(t2/count :model/Dashboard :archived false)

src/metabase/task/creator_sentiment_emails.clj:70
(t2/count :model/Database :is_audit false)

src/metabase/task/creator_sentiment_emails.clj:71
(t2/count :model/Card :archived false :type ""question"")

src/metabase/task/creator_sentiment_emails.clj:72
(t2/count :model/Card :archived false :type ""model"")

src/metabase/task/email_remove_legacy_pulse.clj:16
(t2/count :model/Pulse :dashboard_id nil :alert_condition nil :archived false)
```
</details>

<details>
<summary>Code for generating this list</summary>

```clojure
(ns nocommit.find
  (:require
   [clojure.java.io :as io]
   [clojure.spec.alpha :as s]
   [clojure.string :as str]
   [grasp.api :as g]))

(set! *warn-on-reflection* true)

(comment
  ;; if using a Clojure 1.12 alpha:
  (add-lib 'io.github.borkdude/grasp {:mvn/version ""0.1.4""})
  ;; otherwise use the :build alias to include it
  )

(defn find-usages
  ""Find all usages in src and enterprise/backend/src matching spec. Write the form and filename to ""
  [spec filename]
  (let [chomp (fn [s] (str/replace-first s ""file:/Users/dan/projects/work/metabase/"" """"))]
    (with-open [w ^java.io.BufferedWriter (io/writer filename)]
      (doseq [form (sort-by (comp :uri meta)
                            (concat (g/grasp ""src/"" spec)
                                    (g/grasp ""enterprise/backend/src"" spec)))]
        (io/copy (str (-> form meta :uri chomp) "":"" (-> form meta :line)) w)
        (.newLine w)
        (io/copy (pr-str form) w)
        (io/copy ""\n\n"" w)))))

(comment
  (find-usages (s/cat :fn (s/and symbol? (comp #{'toucan2.core/count} g/resolve-symbol))
                      :args (s/* any?))
               ""usages"")
  )
```
</details>

Can we make a comprehensive solution for this issue? Perhaps [discouraging use](https://github.com/metabase/metabase/blob/master/.clj-kondo/config.edn#L85) or [conditionally discouraging use](https://github.com/metabase/metabase/blob/master/.clj-kondo/config.edn#L693) (discouraging use of `t2` in metabase.lib code but not in the entire source tree).

",dpsutton,2024-04-17 14:48:33+00:00,[],2024-04-17 14:54:39+00:00,,https://github.com/metabase/metabase/issues/41524,"[('Priority:P2', 'Average run of the mill bug'), ('Misc/API', ''), ('Type:New Feature', ''), ('.Correctness', ''), ('Difficulty:Easy', ''), ('Administration/', ''), ('Administration/People', 'and Groups. Also user Account Settings')]",[],
2248410674,issue,closed,completed,Handle loading metadata of table underlying the metric when it's used as a data source,"> dependent-metadata needs to be called twice when creating a metric based question. the first time around it would tell to load the metadata of the card, and the second time (when it can look at the metadata of the card), it will tell to load the metadata of the table underlying the metric (card).


We can call `dependentMetadata` in cycles until it stops giving new items, see [Slack](https://metaboat.slack.com/archives/C0643FZ5E83/p1713459393713989?thread_ts=1713452628.224769&cid=C0643FZ5E83).",kamilmielnik,2024-04-17 14:14:22+00:00,['ranquild'],2024-04-30 00:00:00+00:00,2024-04-30 00:00:00+00:00,https://github.com/metabase/metabase/issues/41520,"[('.Frontend', ''), ('.Team/Querying', '')]",[],
2248345852,issue,closed,completed,Optimize structure of parameterSections - use hashmap,"rework code

```
 const option = parameterSections
      .find(section => section.id === sectionId)
      ?.options.find(opt => opt.type === operatorType);
```

so it returns a map where you can get option by `sectionId` and `operatorType`",uladzimirdev,2024-04-17 13:47:14+00:00,['uladzimirdev'],2024-05-02 14:58:09+00:00,2024-04-17 21:35:34+00:00,https://github.com/metabase/metabase/issues/41517,[],"[{'comment_id': 2062449589, 'issue_id': 2248345852, 'author': 'uladzimirdev', 'body': 'closed as design decision to see how it will go without any name generation, [context](https://metaboat.slack.com/archives/C0645JP1W81/p1713375189346359?thread_ts=1713285098.775039&cid=C0645JP1W81)', 'created_at': datetime.datetime(2024, 4, 17, 21, 37, 36, tzinfo=datetime.timezone.utc)}]","uladzimirdev (Issue Creator) on (2024-04-17 21:37:36 UTC): closed as design decision to see how it will go without any name generation, [context](https://metaboat.slack.com/archives/C0645JP1W81/p1713375189346359?thread_ts=1713285098.775039&cid=C0645JP1W81)

"
2248257890,issue,closed,completed,BE flake: `metabase.test.util-test/with-dynamic-redefs-test`,"Example run:
https://github.com/metabase/metabase/actions/runs/8721896635/job/23926656406?pr=41512#step:3:1278

Looks like it flakes every week or so
[https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBGbGFraW5lc3MiLCJkZXNjcmlwdGlvbiI6Ik[…]HVtbiI6InRlc3RzIn0sIm9yaWdpbmFsX2NhcmRfaWQiOjE0ODI4fQ==](https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBGbGFraW5lc3MiLCJkZXNjcmlwdGlvbiI6IkZsYWtleSB0ZXN0cyBmb3IgTWV0YWJhc2UgZnJvbSB3b3JrZmxvdyBqb2JzIHBlciB0ZXN0L2pvYi9ydW4vYnJhbmNoL2NvbW1pdC4gVXBkYXRlZCBkYWlseS4iLCJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoyNiwidHlwZSI6InF1ZXJ5IiwicXVlcnkiOnsic291cmNlLXRhYmxlIjoiY2FyZF9fMTQ4MjgiLCJmaWx0ZXIiOlsiPSIsWyJmaWVsZCIsInRlc3RfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sIndpdGgtZHluYW1pYy1yZWRlZnMtdGVzdCJdfX0sImRpc3BsYXkiOiJ0YWJsZSIsInBhcmFtZXRlcnMiOltdLCJ2aXN1YWxpemF0aW9uX3NldHRpbmdzIjp7InRhYmxlLnBpdm90X2NvbHVtbiI6InJlcG9zaXRvcnkiLCJ0YWJsZS5jZWxsX2NvbHVtbiI6InRlc3RzIn0sIm9yaWdpbmFsX2NhcmRfaWQiOjE0ODI4fQ==)",calherries,2024-04-17 13:07:24+00:00,['crisptrutski'],2024-04-22 14:57:17+00:00,2024-04-22 14:57:16+00:00,https://github.com/metabase/metabase/issues/41515,"[('flaky-test-fix', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2063753007, 'issue_id': 2248257890, 'author': 'crisptrutski', 'body': 'Now we wait, and check back on to see whether we have any more [flakes](https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBGbGFraW5lc3MiLCJkZXNjcmlwdGlvbiI6IkZsYWtleSB0ZXN0cyBmb3IgTWV0YWJhc2UgZnJvbSB3b3JrZmxvdyBqb2JzIHBlciB0ZXN0L2pvYi9ydW4vYnJhbmNoL2NvbW1pdC4gVXBkYXRlZCBkYWlseS4iLCJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoyNiwidHlwZSI6InF1ZXJ5IiwicXVlcnkiOnsic291cmNlLXRhYmxlIjoiY2FyZF9fMTQ4MjgiLCJmaWx0ZXIiOlsiPSIsWyJmaWVsZCIsInRlc3RfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sIndpdGgtZHluYW1pYy1yZWRlZnMtdGVzdCJdfX0sImRpc3BsYXkiOiJ0YWJsZSIsInBhcmFtZXRlcnMiOltdLCJ2aXN1YWxpemF0aW9uX3NldHRpbmdzIjp7InRhYmxlLnBpdm90X2NvbHVtbiI6InJlcG9zaXRvcnkiLCJ0YWJsZS5jZWxsX2NvbHVtbiI6InRlc3RzIn0sIm9yaWdpbmFsX2NhcmRfaWQiOjE0ODI4fQ==) in the next two weeks.', 'created_at': datetime.datetime(2024, 4, 18, 12, 29, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2066785231, 'issue_id': 2248257890, 'author': 'crisptrutski', 'body': ""The [last flake](https://github.com/metabase/metabase/actions/runs/8721896635) was 2 days ago, just before this merged.\r\n\r\nThe largest gap between failures we've seen before was 2w so perhaps we should wait 3w to be sure 😆"", 'created_at': datetime.datetime(2024, 4, 19, 15, 14, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2069772448, 'issue_id': 2248257890, 'author': 'crisptrutski', 'body': 'On second though, so much less hassle to just reopen if we see it flake again.', 'created_at': datetime.datetime(2024, 4, 22, 14, 57, 16, tzinfo=datetime.timezone.utc)}]","crisptrutski (Assginee) on (2024-04-18 12:29:23 UTC): Now we wait, and check back on to see whether we have any more [flakes](https://stats.metabase.com/question#eyJuYW1lIjoiVGVzdCBGbGFraW5lc3MiLCJkZXNjcmlwdGlvbiI6IkZsYWtleSB0ZXN0cyBmb3IgTWV0YWJhc2UgZnJvbSB3b3JrZmxvdyBqb2JzIHBlciB0ZXN0L2pvYi9ydW4vYnJhbmNoL2NvbW1pdC4gVXBkYXRlZCBkYWlseS4iLCJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoyNiwidHlwZSI6InF1ZXJ5IiwicXVlcnkiOnsic291cmNlLXRhYmxlIjoiY2FyZF9fMTQ4MjgiLCJmaWx0ZXIiOlsiPSIsWyJmaWVsZCIsInRlc3RfbmFtZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sIndpdGgtZHluYW1pYy1yZWRlZnMtdGVzdCJdfX0sImRpc3BsYXkiOiJ0YWJsZSIsInBhcmFtZXRlcnMiOltdLCJ2aXN1YWxpemF0aW9uX3NldHRpbmdzIjp7InRhYmxlLnBpdm90X2NvbHVtbiI6InJlcG9zaXRvcnkiLCJ0YWJsZS5jZWxsX2NvbHVtbiI6InRlc3RzIn0sIm9yaWdpbmFsX2NhcmRfaWQiOjE0ODI4fQ==) in the next two weeks.

crisptrutski (Assginee) on (2024-04-19 15:14:02 UTC): The [last flake](https://github.com/metabase/metabase/actions/runs/8721896635) was 2 days ago, just before this merged.

The largest gap between failures we've seen before was 2w so perhaps we should wait 3w to be sure 😆

crisptrutski (Assginee) on (2024-04-22 14:57:16 UTC): On second though, so much less hassle to just reopen if we see it flake again.

"
2248161224,issue,closed,completed,Replace body with params for RTK Query GET requests,"**Context**

https://redux-toolkit.js.org/rtk-query/api/fetchBaseQuery#setting-the-query-string

Update all query definitions of ""body"" usage with ""params"" like it's shown by the link

### How do we use it

```
query: body => ({
        method: ""GET"",
        url: ""/api/dashboard"",
        body,
      }),
```

### How it's written in docs

```
 query: (user: Record<string, string>) => ({
        url: `users`,
        // Assuming no `paramsSerializer` is specified, the user object is automatically converted
        // and produces a url like /api/users?first_name=test&last_name=example
        params: user
      }),
```




",uladzimirdev,2024-04-17 12:21:07+00:00,['nemanjaglumac'],2024-06-10 20:49:19+00:00,2024-06-07 20:59:51+00:00,https://github.com/metabase/metabase/issues/41511,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2247827417,issue,open,,Allow using native (SQL based) filter criteria in basic sandboxes,"**Is your feature request related to a problem? Please describe.**
With sandboxing it is often the case that tables have a similar structure, and the filtering should happen the same way for multiple tables. It would be nice to offer a way to set up sandboxing for multiple tables without having to define a separate question for each, when the filtering criteria is more complex than a set of `column` = `user attribute` clauses.

**Describe the solution you'd like**
In addition to 'Filter by a column in the table', also offer an option something like 'Filter by a native query condition', which would allow the user to enter a SQL snippet where variable references are replaced with the corresponding user attribute. 
For example, on Snowflake, this would allow someone to write:
  `company_id = any(string_to_array({{company_ids}},',')::bigint[])`
to allow checking the equality of a column with an attribute that has multiple entries.

**Describe alternatives you've considered**
Right now this is only possible of a native question is created for each table.

**How important is this feature to you?**
Nice to have.",zbodi74,2024-04-17 09:30:25+00:00,[],2024-04-17 09:31:26+00:00,,https://github.com/metabase/metabase/issues/41506,"[('Type:New Feature', ''), ('Administration/Data Sandboxes', 'Enterprise Sandboxing')]",[],
2247766719,issue,closed,completed,Text extraction modal,"Add column extraction modal to notebook editor.

<img width=""905"" alt=""Screenshot 2024-04-17 at 11 03 31"" src=""https://github.com/metabase/metabase/assets/1250185/d7ce8e7f-dd61-4fc5-98b5-fa7bc5a9aef1"">
",romeovs,2024-04-17 09:02:52+00:00,['romeovs'],2024-05-01 08:59:27+00:00,2024-05-01 08:59:27+00:00,https://github.com/metabase/metabase/issues/41504,"[('Type:New Feature', ''), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2247763457,issue,open,,Horizontal Scrollbars on Chrome Mac are not visible when using a mouse,"**Describe the bug**
On Chrome Mac (Sonoma) the horizontal scroll has disappear in plain tables and is imposible to scroll the content vertically with the mouse without using the trackpad.

**Logs**
Please include javascript console and server logs around the time this bug occurred. For information about how to get these, consult our [bug troubleshooting guide](https://metabase.com/docs/latest/troubleshooting-guide/bugs.html)

**To Reproduce**
Steps to reproduce the behavior:
1. Go to any table with several columns
2. Using only the mouse try to scroll right
3. See error

**Expected behavior**
The scroll bar should appear when the mouse cursor is near the bottom of the page

**Severity**
Is quite annoying

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""es-ES"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.213-201.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""bigquery-cloud-sdk"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-11"",
      ""tag"": ""v1.49.5"",
      ""hash"": ""31c4887""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```",gallardo79,2024-04-17 09:01:19+00:00,[],2024-06-26 17:45:38+00:00,,https://github.com/metabase/metabase/issues/41503,"[('.CSS', ''), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('Misc/Accessibility', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2247601086,issue,closed,not_planned,`driver/describe-database` flakes for redshift,"`driver/describe-database` still flakes occasionally for redshift. 

`metabase.driver-test/supports-schemas-matches-describe-database-test` flaked here

https://github.com/metabase/metabase/blob/160de76313bddc1cd4c3add8e6017d710a0fac1f/test/metabase/driver_test.clj#L68-L70

example run:
https://github.com/metabase/metabase/actions/runs/8703359539/job/23869375405#step:3:1463",calherries,2024-04-17 07:38:02+00:00,[],2024-12-13 16:46:17+00:00,2024-12-13 16:46:16+00:00,https://github.com/metabase/metabase/issues/41499,"[('flaky-test-fix', '')]",[],
2247591668,issue,open,,Permissions for a subcollection are not set if the admin frontend does not see the newly created subcollection,"### Describe the bug

Permissions for a subcollection are not set if the admin frontend does not see the newly created subcollection (which was created by another user in the meantime).

### To Reproduce

1. open admin settings
2. create a sub-collection by another user (in another PC)
3. set permission for some user/group, but in root collection for step2 (and firstly activate option ""Also change sub-collections"")
4. permission is not set for sub-collection created in step2

### Expected behavior

Set permissions on all sub-collections regardless of what the admin frontend currently sees.
(do not require a **manual** refresh of the admin frontend before setting permissions).

### Logs

_No response_

### Information about your Metabase installation

```JSON
Metabase v v0.49.4
```


### Severity

low

### Additional context

_No response_",CZvacko,2024-04-17 07:33:49+00:00,[],2024-06-20 15:55:46+00:00,,https://github.com/metabase/metabase/issues/41498,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Administration/Permissions', 'Collection or Data permissions'), ('.Frontend', ''), ('.Backend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2097877367, 'issue_id': 2247591668, 'author': 'Tony-metabase', 'body': ""@CZvacko it's not about seeing the newly created sub collection ... But the moment you go to the Permission tab what metabase does is leads the permission graph.\r\n\r\nThe moment something else gets added in the pool the permission graph will not be called again unless you refresh the permissions. So the occurrence you mention is really rare to happen if you don't stay stuck in the permission tab while changes are being done to the collection structure. \r\n\r\nDoes this happen often? Since it's very rare and I don't really see any possible solution for this apart from revamping the whole permission structure or the way metabase fetches current graphs"", 'created_at': datetime.datetime(2024, 5, 7, 9, 38, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2098186112, 'issue_id': 2247591668, 'author': 'CZvacko', 'body': ""I didn't mean a situation where two admins are setting permissions, but that one admin opens the permissions settings, but in the meantime the common user creates a new sub-collection (where the new permission settings don't apply).\r\n\r\nThis probably doesn't happen too often (maybe in a corporate environment with many users) but it is confusing. Could metabase at least check after setting permission graph that no new sub-collection was added in the meantime and inform admin user about it ? (then he can manually fix the discrepancy)"", 'created_at': datetime.datetime(2024, 5, 7, 11, 29, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2098209280, 'issue_id': 2247591668, 'author': 'Tony-metabase', 'body': ""Usually collections are pretty static because you as an Admin create a collection structure and then setup permissions before you start adding stuff in them ... Then normal users will be mostly using these objects and create in their personal collection.\r\n\r\nI guess that's why this wasn't flagged before cause it doesn't happen too often. Nonetheless what you are proposing is a good expected behaviour"", 'created_at': datetime.datetime(2024, 5, 7, 11, 43, tzinfo=datetime.timezone.utc)}]","Tony-metabase on (2024-05-07 09:38:13 UTC): @CZvacko it's not about seeing the newly created sub collection ... But the moment you go to the Permission tab what metabase does is leads the permission graph.

The moment something else gets added in the pool the permission graph will not be called again unless you refresh the permissions. So the occurrence you mention is really rare to happen if you don't stay stuck in the permission tab while changes are being done to the collection structure. 

Does this happen often? Since it's very rare and I don't really see any possible solution for this apart from revamping the whole permission structure or the way metabase fetches current graphs

CZvacko (Issue Creator) on (2024-05-07 11:29:19 UTC): I didn't mean a situation where two admins are setting permissions, but that one admin opens the permissions settings, but in the meantime the common user creates a new sub-collection (where the new permission settings don't apply).

This probably doesn't happen too often (maybe in a corporate environment with many users) but it is confusing. Could metabase at least check after setting permission graph that no new sub-collection was added in the meantime and inform admin user about it ? (then he can manually fix the discrepancy)

Tony-metabase on (2024-05-07 11:43:00 UTC): Usually collections are pretty static because you as an Admin create a collection structure and then setup permissions before you start adding stuff in them ... Then normal users will be mostly using these objects and create in their personal collection.

I guess that's why this wasn't flagged before cause it doesn't happen too often. Nonetheless what you are proposing is a good expected behaviour

"
2247514899,issue,closed,completed,Error message in LDAP settings,"### Describe the bug

Although everything should be set up correctly (it seems to work normally), a red error message ""**e.ldap-port?.trim is not a function**"" appears above the Save button. I didn't notice this in previous versions.

### To Reproduce

Settings is like:
FQDN for server name
636 for port
SSL
some LDAP user
some LDAP password
set Search base for user
set User filter
set Attribute for name

Appears only when creating mappings!



### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Metabase version v0.49.1 v0.49.4
```


### Severity

low

### Additional context

_No response_",CZvacko,2024-04-17 06:47:44+00:00,[],2024-06-10 20:23:47+00:00,2024-05-31 23:26:38+00:00,https://github.com/metabase/metabase/issues/41494,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Administration/Auth', 'Google Auth, LDAP, pw+email login'), ('.Frontend', ''), ('.Escalation', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2070255509, 'issue_id': 2247514899, 'author': 'paoliniluis', 'body': 'did you complete the port number in the ldap form?', 'created_at': datetime.datetime(2024, 4, 22, 17, 3, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2071695519, 'issue_id': 2247514899, 'author': 'CZvacko', 'body': 'Yes, the port has been specified, it can also be found in the internal database table (setting).', 'created_at': datetime.datetime(2024, 4, 23, 8, 14, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2089933816, 'issue_id': 2247514899, 'author': 'aboydude', 'body': 'same here, tested with version 0.49.1 and 0.49.7', 'created_at': datetime.datetime(2024, 5, 2, 8, 52, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2138410135, 'issue_id': 2247514899, 'author': 'cabarria', 'body': 'We are seeing the same error message on 0.49.11, 0.49.12, 1.49.11, and 1.49.12. We cannot make any changes to LDAP via the web interface, but we can using the API.', 'created_at': datetime.datetime(2024, 5, 29, 23, 24, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2143072206, 'issue_id': 2247514899, 'author': 'sloansparger', 'body': 'We have a fix on the way, but as a workaround if you re-enter the configured port you should be able to save the form from the web interface.', 'created_at': datetime.datetime(2024, 5, 31, 22, 51, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2145100438, 'issue_id': 2247514899, 'author': 'ignacio-mb', 'body': '@sloansparger should we add the 49.14 milestone?', 'created_at': datetime.datetime(2024, 6, 3, 12, 38, 26, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-22 17:03:26 UTC): did you complete the port number in the ldap form?

CZvacko (Issue Creator) on (2024-04-23 08:14:53 UTC): Yes, the port has been specified, it can also be found in the internal database table (setting).

aboydude on (2024-05-02 08:52:39 UTC): same here, tested with version 0.49.1 and 0.49.7

cabarria on (2024-05-29 23:24:35 UTC): We are seeing the same error message on 0.49.11, 0.49.12, 1.49.11, and 1.49.12. We cannot make any changes to LDAP via the web interface, but we can using the API.

sloansparger on (2024-05-31 22:51:14 UTC): We have a fix on the way, but as a workaround if you re-enter the configured port you should be able to save the form from the web interface.

ignacio-mb on (2024-06-03 12:38:26 UTC): @sloansparger should we add the 49.14 milestone?

"
2247071772,issue,closed,completed,"Default (formatted) CSV Export Returns ""Week #"" instead of Date","### Describe the bug

If you group data by week and then export the results, instead of the date in the date column you get ""Week 1"",""Week 2"" etc. This is different behavior from the Excel exports and different from v48.

### To Reproduce

1. In Sample Database create a question with ""Orders""
2. Group by ""Created At"" date w/ granularity of 1 week
3. Save Question -> Note date format in the table
4. Export as CSV (default formatted)
5. Note date format wasn't retained

Note: Exporting to excel results in the start date of the week exporting. This how it works in 4/8. this is also how CSV export worked in v48.


### Expected behavior

Date format should be retained on export

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.133.1-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres"",
      ""snowflake""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.22 (Debian 11.22-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-11"",
      ""tag"": ""v1.49.5"",
      ""hash"": ""31c4887""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

User that submitted the ticket can work around this by using the raw export option for now

### Additional context

_No response_",ixipixi,2024-04-17 00:18:43+00:00,['adam-james-v'],2024-05-02 09:36:58+00:00,2024-04-22 21:47:50+00:00,https://github.com/metabase/metabase/issues/41492,"[('Type:Bug', 'Product defects'), ('Reporting/Export', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2246986756,issue,closed,completed,Configuring sandboxed permissions in schemaless databases removes tables from the list,"### Describe the bug

when you open the sandboxing modal to configure permissions on a table in a schemaless db (mysql or sqlite), we lose all tables but the one being edited from the table list. then if you try to reopen the sandboxing modal, the app crashes.

this is likely due to the fact that on the frontend we create ""fake"" schema under the hood to make the ui work, but the metadata load for this modal is messing with that fiction

### To Reproduce

reproduces on mysql and sqlite

![permsbug](https://github.com/metabase/metabase/assets/30528226/cf42b1d9-0344-4296-913b-755654c9ac4c)


### Expected behavior

it should not remove the table list, and should not crash the app

### Logs

_No response_

### Information about your Metabase installation

```JSON
- latest master 2024-04-18
```


### Severity

p3, you can still configure permissions, just 1 table at a time

### Additional context

_No response_",iethree,2024-04-16 22:37:39+00:00,['sloansparger'],2024-05-22 20:14:16+00:00,2024-05-22 20:13:33+00:00,https://github.com/metabase/metabase/issues/41490,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Administration/Permissions', 'Collection or Data permissions'), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2125668064, 'issue_id': 2246986756, 'author': 'sloansparger', 'body': 'I solved this with the permissions UI updates as you can see here. Fix should go out in v50.\r\n\r\nhttps://www.loom.com/share/8ee6e27ac51f4e1795cef31673161715?sid=0db02096-c97e-4c42-9f38-72d4aa79e517', 'created_at': datetime.datetime(2024, 5, 22, 20, 13, 33, tzinfo=datetime.timezone.utc)}]","sloansparger (Assginee) on (2024-05-22 20:13:33 UTC): I solved this with the permissions UI updates as you can see here. Fix should go out in v50.

https://www.loom.com/share/8ee6e27ac51f4e1795cef31673161715?sid=0db02096-c97e-4c42-9f38-72d4aa79e517

"
2246862475,issue,closed,completed,Add SDK extensions PoC,,deniskaber,2024-04-16 20:49:59+00:00,['deniskaber'],2024-04-24 13:51:09+00:00,2024-04-24 13:51:09+00:00,https://github.com/metabase/metabase/issues/41487,"[('.Team/Embedding', '')]",[],
2246717215,issue,closed,completed,Leading zero in filter value in embedded dashboard breaks it,"### Describe the bug

Setting filter value to something like ""0001"" doesn't work anymore.  
Console log says `Uncaught SyntaxError: Unexpected number in JSON`

### To Reproduce

- Create a dashboard and add a question
- Add a filter to dashboard and tie to the question
- Enable embedding for the dashboard
- Generate the embedding link and open it
- Set the value of the filter to ""01"" and load the page again. It breaks.

### Expected behavior

_No response_

### Logs

JS Console Log: `SyntaxError: Unexpected number in JSON at position 1 (line 1 column 2)`
MB Server logs: No Error

### Information about your Metabase installation

```JSON
Metabase Version: 0.49.6 (upgraded from 47, so not sure at which version this issue started)
```


### Severity

Breaks the affected embedded dashboards

### Additional context
It's common for ID columns to start with zero. And they are used in embedding for filtering data.",vvaezian,2024-04-16 19:08:53+00:00,['deniskaber'],2024-04-18 21:54:07+00:00,2024-04-18 17:15:58+00:00,https://github.com/metabase/metabase/issues/41483,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('.Team/Embedding', '')]","[{'comment_id': 2059950144, 'issue_id': 2246717215, 'author': 'npretto', 'body': ""Seems like 2ffee750 is the first broken commit on the release branch for 49.\r\nBefore that, the url gets updated and `?id=01` becomes `?id=1`.\r\nIf you open the iframe url it works, i think it's something related to `isWithinIframe`, possibly https://github.com/metabase/metabase/blob/511618088f7704a57f12fe86609738e032550275/frontend/src/metabase/lib/embed.js#L44"", 'created_at': datetime.datetime(2024, 4, 16, 21, 27, 29, tzinfo=datetime.timezone.utc)}]","npretto on (2024-04-16 21:27:29 UTC): Seems like 2ffee750 is the first broken commit on the release branch for 49.
Before that, the url gets updated and `?id=01` becomes `?id=1`.
If you open the iframe url it works, i think it's something related to `isWithinIframe`, possibly https://github.com/metabase/metabase/blob/511618088f7704a57f12fe86609738e032550275/frontend/src/metabase/lib/embed.js#L44

"
2246582965,issue,closed,duplicate,"Ability to disable UI login entirely, users do not need to login.","**Is your feature request related to a problem? Please describe.**
No. Users can currently login to Metabase and Metabase has many features for enabling different kinds of authentication. I want to disable all of them and allow the intranet to handle authentication natively. If the user can access Metabase, they're already authenticated.

**Describe the solution you'd like**
Ability to completely turn off the need for login. Visiting the site for the first time would take you directly to the  home screen.

**Describe alternatives you've considered**
Alternatively, I've considered JWT authentication so that maybe Metabase can just be passed the existing credentials from when users logged into the intranet. 

**How important is this feature to you?**
It would be nice to have. Without it, I am required to find an alternative that Metabase supports. With it, I can simplify my environment to allow more authentication methods, which Metabase would not see.",MrChadMWood,2024-04-16 17:44:28+00:00,[],2025-01-02 14:45:50+00:00,2025-01-02 14:45:49+00:00,https://github.com/metabase/metabase/issues/41479,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2098212709, 'issue_id': 2246582965, 'author': 'Tony-metabase', 'body': '@MrChadMWood  How would metabase know which user is trying to access metabase? ... There needs to be some kind of authentication.\r\n\r\nElse you can use static embedding if you jsut want users to view dashbaords', 'created_at': datetime.datetime(2024, 5, 7, 11, 45, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2098259397, 'issue_id': 2246582965, 'author': 'MrChadMWood', 'body': '@Tony-metabase  I’m not sure why Metabase needs to know who the user is. What would be stopping the possibility of everyone having equal privileges and access to the same data? For example, let’s say if Metabase put a “Guest” button on the login screen, which just logs into a user named Guest.', 'created_at': datetime.datetime(2024, 5, 7, 12, 10, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2098275916, 'issue_id': 2246582965, 'author': 'Tony-metabase', 'body': ""Everything on metabase uses users for permissions for tracing and so on. If there are changes to a dashboard or a collection how would you know who did that change for example? \r\n\r\nWhat you are suggesting at least form my vision wouldn't really work in practice. If you just want people to view a dashboard then you can use static embedding"", 'created_at': datetime.datetime(2024, 5, 7, 12, 19, 15, tzinfo=datetime.timezone.utc)}, {'comment_id': 2567883945, 'issue_id': 2246582965, 'author': 'brunobergher', 'body': 'I think this is a duplicate of #7016, so I""ll close this deferring to it. Also worth noting it\'s unlikely we\'ll ever take this on, since it makes it _very_ easy for admins to make big mistakes, which we\'re not too fond of.', 'created_at': datetime.datetime(2025, 1, 2, 14, 45, 49, tzinfo=datetime.timezone.utc)}]","Tony-metabase on (2024-05-07 11:45:11 UTC): @MrChadMWood  How would metabase know which user is trying to access metabase? ... There needs to be some kind of authentication.

Else you can use static embedding if you jsut want users to view dashbaords

MrChadMWood (Issue Creator) on (2024-05-07 12:10:07 UTC): @Tony-metabase  I’m not sure why Metabase needs to know who the user is. What would be stopping the possibility of everyone having equal privileges and access to the same data? For example, let’s say if Metabase put a “Guest” button on the login screen, which just logs into a user named Guest.

Tony-metabase on (2024-05-07 12:19:15 UTC): Everything on metabase uses users for permissions for tracing and so on. If there are changes to a dashboard or a collection how would you know who did that change for example? 

What you are suggesting at least form my vision wouldn't really work in practice. If you just want people to view a dashboard then you can use static embedding

brunobergher on (2025-01-02 14:45:49 UTC): I think this is a duplicate of #7016, so I""ll close this deferring to it. Also worth noting it's unlikely we'll ever take this on, since it makes it _very_ easy for admins to make big mistakes, which we're not too fond of.

"
2246580006,issue,closed,completed,[Cache] Milestone 4: Dashboard configuration in userland,"```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/issues/42566
```
",rafpaf,2024-04-16 17:42:29+00:00,['rafpaf'],2024-06-03 16:38:37+00:00,2024-05-16 14:34:36+00:00,https://github.com/metabase/metabase/issues/41478,[],[],
2246521995,issue,open,,file input in bigquery driver form is not properly hidden in firefox,"Are the two buttons for the JSON file upload in BigQuery connection form intentional?

[Slack Message](https://metaboat.slack.com/archives/C01LQQ2UW03/p1713286824409119?thread_ts=1713286824.409119&cid=C01LQQ2UW03)",iethree,2024-04-16 17:06:01+00:00,[],2024-04-16 17:06:02+00:00,,https://github.com/metabase/metabase/issues/41476,"[('Type:Bug', 'Product defects'), ('Administration/Databases', ''), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2246475966,issue,closed,completed,Reset default value and Name after change of filter type or operator,[context](https://metaboat.slack.com/archives/C0645JP1W81/p1713285098775039),uladzimirdev,2024-04-16 16:37:02+00:00,['uladzimirdev'],2024-04-17 21:38:28+00:00,2024-04-17 21:38:28+00:00,https://github.com/metabase/metabase/issues/41475,[],[],
2246469358,issue,closed,completed,In-App cloud migration frontend,"[tech doc](https://www.notion.so/metabase/Tech-Productize-Cloud-migration-030865067e64417a96218588e6f91a72?pvs=4#640c5356f95649e6a6d554f63de417f1)

[product doc](https://www.notion.so/metabase/Productize-Cloud-migration-9ac517a86a5d4312ae4f0a37c9625e67?pvs=4#73f604b68ed04118953df5817cab1b19)

- [x] read only warning banner
- [x] migration settings page
- [x] migration status display
- [x] migration cancel button",iethree,2024-04-16 16:33:12+00:00,"['npfitz', 'sloansparger']",2024-05-16 21:41:34+00:00,2024-05-16 21:40:05+00:00,https://github.com/metabase/metabase/issues/41474,"[('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2246386280,issue,open,,[BE] Review Related metrics results,"[Here](https://github.com/metabase/metabase/pull/40932/files#r1563124195) should metrics be surfaced in similar-questions or should they remain limited to models and saved questions?
[Here](https://github.com/metabase/metabase/pull/40932/files#r1563127082) should we maintain canonical-metric for questions?
It's possible that how metrics fit against related things should be reviewed entirely.",snoe,2024-04-16 15:51:16+00:00,[],2024-05-20 18:21:04+00:00,,https://github.com/metabase/metabase/issues/41473,[],[],
2246281089,issue,closed,completed,Refactor api.cache to move business logic to models.cache_config,A bit of context in [this Slack thread](https://metaboat.slack.com/archives/C06KX7QECN4/p1713277690258889) (this is about modularization/APIs).,piranha,2024-04-16 15:00:49+00:00,['piranha'],2024-04-23 12:52:43+00:00,2024-04-23 12:52:43+00:00,https://github.com/metabase/metabase/issues/41471,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Workflows', 'aka BEC')]",[],
2246171908,issue,closed,completed,Performance hit after upgrade to 1.49.x,"### Describe the bug

After upgrading from 1.48.4 to 1.49.5 our dashboards take much longer to load. One dashboard contains 19 questions. Before the upgrade it took a couple of seconds. Now it takes up to 20 seconds to fully load the page. It is not just my pc, got complains from many colleagues. It is also not just one dashboard, but multiple.

### To Reproduce

Make a heavier dashboard on version 1.48 and measure its performance. Then upgrade to 1.49 and compare.

Hard for me to make a comparison now, because it would require a downgrade to 1.48. Is that even possible?

Here at least a screenshot of the network calls.
<img width=""1818"" alt=""image"" src=""https://github.com/metabase/metabase/assets/22885844/d2dd36d1-9a9e-43b4-890d-632d9820243f"">

I looked at one of the longer API requests of more than 5 seconds (see also the Metabase server logs). The underlying BigQuery query takes less than 1 second. It also did result in 0 rows, so the API response data json is small.

### Expected behavior

That the performance was not that impacted.

### Logs

[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:23+02:00 DEBUG metabase.server.middleware.log GET /api/user/current 200 25.1 ms (11 DB calls) App DB connections: 1/15 Jetty threads: 4/50 (25 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:23+02:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 27.9 ms (8 DB calls) App DB connections: 1/15 Jetty threads: 4/50 (25 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:23+02:00 DEBUG metabase.server.middleware.log GET /api/collection/root 200 11.9 ms (2 DB calls) App DB connections: 3/15 Jetty threads: 6/50 (25 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:23+02:00 DEBUG metabase.server.middleware.log GET /api/bookmark 200 8.3 ms (1 DB calls) App DB connections: 1/15 Jetty threads: 5/50 (25 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:23+02:00 DEBUG metabase.server.middleware.log GET /api/database 200 8.3 ms (3 DB calls) App DB connections: 1/15 Jetty threads: 5/50 (25 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:23+02:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 3.9 ms (1 DB calls) App DB connections: 1/15 Jetty threads: 4/50 (25 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:23+02:00 DEBUG metabase.server.middleware.log GET /api/collection/tree 200 53.5 ms (6 DB calls) App DB connections: 3/15 Jetty threads: 7/50 (24 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:23+02:00 DEBUG metabase.server.middleware.log GET /api/search 200 95.1 ms (5 DB calls) App DB connections: 2/15 Jetty threads: 7/50 (23 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:23+02:00 DEBUG metabase.server.middleware.log GET /api/dashboard/76 200 261.4 ms (48 DB calls) App DB connections: 1/15 Jetty threads: 5/50 (23 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:23+02:00 DEBUG metabase.server.middleware.log GET /api/pulse/form_input 200 3.1 ms (1 DB calls) App DB connections: 2/15 Jetty threads: 6/50 (25 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:23+02:00 DEBUG metabase.server.middleware.log GET /api/collection/102 200 15.6 ms (4 DB calls) App DB connections: 2/15 Jetty threads: 6/50 (25 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:24+02:00 DEBUG metabase.server.middleware.log GET /api/database/4/schemas 200 605.0 ms (4 DB calls) App DB connections: 14/15 Jetty threads: 27/50 (3 idle, 0 queued) (145 total active threads) Queries in flight: 2 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:24+02:00 DEBUG metabase.server.middleware.log GET /api/table/26967/query_metadata 200 810.1 ms (9 DB calls) App DB connections: 11/15 Jetty threads: 25/50 (3 idle, 0 queued) (145 total active threads) Queries in flight: 2 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:24+02:00 DEBUG metabase.server.middleware.log GET /api/table/26963/query_metadata 200 817.8 ms (11 DB calls) App DB connections: 10/15 Jetty threads: 25/50 (3 idle, 0 queued) (145 total active threads) Queries in flight: 2 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:24+02:00 DEBUG metabase.server.middleware.log GET /api/table/27089/query_metadata 200 911.4 ms (11 DB calls) App DB connections: 13/15 Jetty threads: 23/50 (5 idle, 0 queued) (145 total active threads) Queries in flight: 3 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:24+02:00 DEBUG metabase.server.middleware.log GET /api/table/26391/query_metadata 200 1.0 s (11 DB calls) App DB connections: 15/15 Jetty threads: 22/50 (6 idle, 0 queued) (145 total active threads) Queries in flight: 3 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:24+02:00 DEBUG metabase.server.middleware.log GET /api/field/366593 200 806.3 ms (7 DB calls) App DB connections: 13/15 Jetty threads: 21/50 (7 idle, 0 queued) (145 total active threads) Queries in flight: 5 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:24+02:00 DEBUG metabase.server.middleware.log GET /api/table/26828/query_metadata 200 998.2 ms (9 DB calls) App DB connections: 12/15 Jetty threads: 21/50 (7 idle, 0 queued) (145 total active threads) Queries in flight: 5 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/27104/query_metadata 200 1.1 s (9 DB calls) App DB connections: 15/15 Jetty threads: 20/50 (8 idle, 0 queued) (145 total active threads) Queries in flight: 4 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/field/366628 200 1.0 s (7 DB calls) App DB connections: 10/15 Jetty threads: 19/50 (9 idle, 0 queued) (145 total active threads) Queries in flight: 5 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/26933/query_metadata 200 1.2 s (11 DB calls) App DB connections: 10/15 Jetty threads: 18/50 (10 idle, 0 queued) (145 total active threads) Queries in flight: 5 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/27087/query_metadata 200 1.0 s (11 DB calls) App DB connections: 9/15 Jetty threads: 18/50 (10 idle, 0 queued) (145 total active threads) Queries in flight: 5 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/27059/query_metadata 200 1.2 s (11 DB calls) App DB connections: 13/15 Jetty threads: 18/50 (10 idle, 0 queued) (145 total active threads) Queries in flight: 5 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/26389/query_metadata 200 1.2 s (11 DB calls) App DB connections: 11/15 Jetty threads: 17/50 (11 idle, 0 queued) (145 total active threads) Queries in flight: 5 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/26903/query_metadata 200 1.1 s (11 DB calls) App DB connections: 13/15 Jetty threads: 17/50 (11 idle, 0 queued) (145 total active threads) Queries in flight: 7 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/field/366581 200 1.2 s (7 DB calls) App DB connections: 15/15 Jetty threads: 16/50 (12 idle, 0 queued) (145 total active threads) Queries in flight: 7 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/26982/query_metadata 200 1.4 s (11 DB calls) App DB connections: 15/15 Jetty threads: 16/50 (12 idle, 0 queued) (145 total active threads) Queries in flight: 7 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/26968/query_metadata 200 1.4 s (11 DB calls) App DB connections: 10/15 Jetty threads: 12/50 (16 idle, 0 queued) (145 total active threads) Queries in flight: 6 (1 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/10165/query_metadata 200 1.4 s (11 DB calls) App DB connections: 10/15 Jetty threads: 15/50 (13 idle, 0 queued) (145 total active threads) Queries in flight: 7 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/9912/query_metadata 200 1.2 s (9 DB calls) App DB connections: 8/15 Jetty threads: 12/50 (16 idle, 0 queued) (145 total active threads) Queries in flight: 7 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/27094/query_metadata 200 1.2 s (11 DB calls) App DB connections: 15/15 Jetty threads: 14/50 (14 idle, 0 queued) (145 total active threads) Queries in flight: 7 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/26936/query_metadata 200 1.4 s (11 DB calls) App DB connections: 8/15 Jetty threads: 9/50 (19 idle, 0 queued) (145 total active threads) Queries in flight: 8 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/27091/query_metadata 200 1.0 s (11 DB calls) App DB connections: 10/15 Jetty threads: 12/50 (16 idle, 0 queued) (145 total active threads) Queries in flight: 7 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/27058/query_metadata 200 1.4 s (9 DB calls) App DB connections: 14/15 Jetty threads: 13/50 (15 idle, 0 queued) (145 total active threads) Queries in flight: 7 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/26979/query_metadata 200 1.5 s (9 DB calls) App DB connections: 14/15 Jetty threads: 11/50 (18 idle, 0 queued) (145 total active threads) Queries in flight: 8 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/card/1301 200 1.3 s (13 DB calls) App DB connections: 10/15 Jetty threads: 11/50 (18 idle, 0 queued) (145 total active threads) Queries in flight: 8 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/27115/query_metadata 200 1.5 s (9 DB calls) App DB connections: 9/15 Jetty threads: 11/50 (18 idle, 0 queued) (145 total active threads) Queries in flight: 8 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/26934/query_metadata 200 1.1 s (11 DB calls) App DB connections: 6/15 Jetty threads: 6/50 (22 idle, 0 queued) (145 total active threads) Queries in flight: 9 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 INFO metabase.query-processor.middleware.cache Query took 424.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/26981/query_metadata 200 1.7 s (11 DB calls) App DB connections: 12/15 Jetty threads: 8/50 (20 idle, 0 queued) (145 total active threads) Queries in flight: 8 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1298/card/1279/query 202 [ASYNC: completed] 1.8 s (21 DB calls) App DB connections: 10/15 Jetty threads: 4/50 (24 idle, 0 queued) (145 total active threads) Queries in flight: 8 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log GET /api/table/26829/query_metadata 200 1.8 s (11 DB calls) App DB connections: 5/15 Jetty threads: 5/50 (23 idle, 0 queued) (146 total active threads) Queries in flight: 9 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1275/card/1317/query 202 [ASYNC: completed] 1.9 s (20 DB calls) App DB connections: 7/15 Jetty threads: 4/50 (24 idle, 0 queued) (145 total active threads) Queries in flight: 7 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 INFO metabase.query-processor.middleware.cache Query took 437.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 INFO metabase.query-processor.middleware.cache Query took 290.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1304/card/1311/query 202 [ASYNC: completed] 2.1 s (22 DB calls) App DB connections: 5/15 Jetty threads: 3/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 9 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 INFO metabase.query-processor.middleware.cache Query took 300.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/357/card/372/query 202 [ASYNC: completed] 2.1 s (20 DB calls) App DB connections: 6/15 Jetty threads: 3/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 8 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:25+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/2658/card/2613/query 202 [ASYNC: completed] 2.2 s (20 DB calls) App DB connections: 6/15 Jetty threads: 3/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 7 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:26+02:00 INFO metabase.query-processor.middleware.cache Query took 412.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/361/card/374/query 202 [ASYNC: completed] 2.2 s (21 DB calls) App DB connections: 1/15 Jetty threads: 3/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 6 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 INFO metabase.query-processor.middleware.cache Query took 282.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:26+02:00 INFO metabase.query-processor.middleware.cache Query took 419.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 INFO metabase.query-processor.middleware.cache Query took 478.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 INFO metabase.query-processor.middleware.cache Query took 400.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/2028/card/1996/query 202 [ASYNC: completed] 2.5 s (22 DB calls) App DB connections: 5/15 Jetty threads: 5/50 (24 idle, 0 queued) (145 total active threads) Queries in flight: 6 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1307/card/1310/query 202 [ASYNC: completed] 2.5 s (21 DB calls) App DB connections: 5/15 Jetty threads: 5/50 (24 idle, 0 queued) (145 total active threads) Queries in flight: 5 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/791/card/830/query 202 [ASYNC: completed] 2.5 s (20 DB calls) App DB connections: 4/15 Jetty threads: 4/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 5 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:26+02:00 INFO metabase.query-processor.middleware.cache Query took 342.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 INFO metabase.query-processor.middleware.cache Query took 794.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log GET /api/dashboard/76 200 2.4 s (48 DB calls) App DB connections: 6/15 Jetty threads: 5/50 (24 idle, 0 queued) (145 total active threads) Queries in flight: 5 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1306/card/376/query 202 [ASYNC: completed] 2.6 s (20 DB calls) App DB connections: 4/15 Jetty threads: 5/50 (24 idle, 0 queued) (145 total active threads) Queries in flight: 4 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1358/card/1376/query 202 [ASYNC: completed] 2.6 s (25 DB calls) App DB connections: 5/15 Jetty threads: 5/50 (24 idle, 0 queued) (145 total active threads) Queries in flight: 3 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1302/card/1304/query 202 [ASYNC: completed] 2.6 s (21 DB calls) App DB connections: 4/15 Jetty threads: 4/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 4 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1328/card/1362/query 202 [ASYNC: completed] 2.7 s (22 DB calls) App DB connections: 4/15 Jetty threads: 4/50 (24 idle, 0 queued) (145 total active threads) Queries in flight: 2 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:26+02:00 INFO metabase.query-processor.middleware.cache Query took 604.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1305/card/1309/query 202 [ASYNC: completed] 2.8 s (21 DB calls) App DB connections: 3/15 Jetty threads: 4/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 3 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/2094/card/2072/query 202 [ASYNC: completed] 2.8 s (22 DB calls) App DB connections: 2/15 Jetty threads: 4/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 2 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 INFO metabase.query-processor.middleware.cache Query took 386.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:26+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1312/card/1308/query 202 [ASYNC: completed] 2.9 s (27 DB calls) App DB connections: 2/15 Jetty threads: 3/50 (25 idle, 0 queued) (145 total active threads) Queries in flight: 1 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:27+02:00 INFO metabase.query-processor.middleware.cache Query took 1.1 s to run; minimum for cache eligibility is 2.0 s; not eligible
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:27+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1311/card/1332/query 202 [ASYNC: completed] 3.2 s (21 DB calls) App DB connections: 2/15 Jetty threads: 3/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 1 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:27+02:00 INFO metabase.query-processor.middleware.cache Query took 726.0 ms to run; minimum for cache eligibility is 2.0 s; not eligible
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:27+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/pivot/76/dashcard/1310/card/1289/query 202 [ASYNC: completed] 4.0 s (26 DB calls) App DB connections: 2/15 Jetty threads: 3/50 (25 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:28+02:00 DEBUG metabase.server.middleware.log GET /api/table/26388/query_metadata 200 53.8 ms (11 DB calls) App DB connections: 1/15 Jetty threads: 4/50 (25 idle, 0 queued) (145 total active threads) Queries in flight: 0 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:29+02:00 INFO metabase.query-processor.middleware.cache Query took 2.6 s to run; minimum for cache eligibility is 2.0 s; not eligible
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:29+02:00 DEBUG metabase.server.middleware.log POST /api/dashboard/76/dashcard/1313/card/1303/query 202 [ASYNC: completed] 5.2 s (26 DB calls) App DB connections: 2/15 Jetty threads: 4/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 0 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:29+02:00 DEBUG metabase.server.middleware.log GET /api/table/26966/query_metadata 200 31.3 ms (9 DB calls) App DB connections: 1/15 Jetty threads: 4/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 0 (0 queued)
[06106280-cca0-4acb-9608-a0fbbe7beb56] 2024-04-16T14:58:34+02:00 DEBUG metabase.server.middleware.log GET /api/action 200 33.7 ms (4 DB calls) App DB connections: 1/15 Jetty threads: 4/50 (25 idle, 0 queued) (143 total active threads) Queries in flight: 0 (0 queued)
[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:40+02:00 DEBUG metabase.server.middleware.log GET /api/table/26908/query_metadata 200 42.5 ms (11 DB calls) App DB connections: 1/15 Jetty threads: 4/50 (25 idle, 0 queued) (146 total active threads) Queries in flight: 0 (0 queued)

### Information about your Metabase installation

```JSON
- Browser: chrome Version 123.0.6312.124 (Official Build) (arm64)
- OS: MacOS 14.4.1 (23E224)
- Databases: Google BigQuery
- Metabase version: 1.49.5
- Metabase hosting: Docker
- Metabase internal database: Google CloudSQL PostgreSQL 13
```


### Severity

Medium

### Additional context

_No response_",nicklubbers,2024-04-16 14:12:17+00:00,['ranquild'],2024-06-20 13:31:58+00:00,2024-06-06 22:21:29+00:00,https://github.com/metabase/metabase/issues/41468,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Performance', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Team/Querying', '')]","[{'comment_id': 2059584429, 'issue_id': 2246171908, 'author': 'luizarakaki', 'body': 'Looks like we could repro this internally. If others hit this and have more info, please comment here as any more data is helpful.', 'created_at': datetime.datetime(2024, 4, 16, 17, 26, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2059585321, 'issue_id': 2246171908, 'author': 'luizarakaki', 'body': ""~Tagging as P1 while we investigate, may change if it isn't severe.~\r\n\r\nInconclusive investigation: [internal thread](https://metaboat.slack.com/archives/C01MS7DQKR6/p1713279128985999)"", 'created_at': datetime.datetime(2024, 4, 16, 17, 26, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2059960328, 'issue_id': 2246171908, 'author': 'luizarakaki', 'body': ""@nicklubbers we investigated this and couldn't get conclusive results. How many questions do you have in this dashboard?"", 'created_at': datetime.datetime(2024, 4, 16, 21, 35, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2060550093, 'issue_id': 2246171908, 'author': 'nicklubbers', 'body': 'I have 19 questions on the dashboard.\r\n\r\nAlso interesting from the internal log: `[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:29+02:00 INFO metabase.query-processor.middleware.cache Query took 2.6 s to run; minimum for cache eligibility is 2.0 s; not eligible` -- Bug? 2.6s is more than 2.0s thus it should be eligible.', 'created_at': datetime.datetime(2024, 4, 17, 7, 18, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2061327091, 'issue_id': 2246171908, 'author': 'nicklubbers', 'body': '@luizarakaki can I downgrade to version 1.48 or would that break things?\r\n\r\nIn the meantime I have tried: adding more pods (servers) to host Metabase, tried out different caching settings via Admin settings -> caching, and via Admin Settings -> Databases. No effect.', 'created_at': datetime.datetime(2024, 4, 17, 13, 56, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2061355256, 'issue_id': 2246171908, 'author': 'luizarakaki', 'body': ""If you have a backup and didn't develop much content after the upgrade, I advise to restore an application database backup from 1.48 and use the 1.48 version.\r\n\r\nOtherwise you can downgrade with `migrate down` https://www.metabase.com/docs/latest/installation-and-operation/upgrading-metabase#rolling-back-an-upgrade\r\n\r\nThis generally works, but restoring a backup is definitely safer."", 'created_at': datetime.datetime(2024, 4, 17, 14, 9, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2061357130, 'issue_id': 2246171908, 'author': 'luizarakaki', 'body': ""> Also interesting from the internal log: [23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:29+02:00 INFO metabase.query-processor.middleware.cache Query took 2.6 s to run; minimum for cache eligibility is 2.0 s; not eligible -- Bug? 2.6s is more than 2.0s thus it should be eligible.\r\n\r\nI'll take a look. When investigating this issue, I found some questions with the same problem."", 'created_at': datetime.datetime(2024, 4, 17, 14, 10, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2061646294, 'issue_id': 2246171908, 'author': 'nicklubbers', 'body': ""> If you have a backup and didn't develop much content after the upgrade, I advise to restore an application database backup from 1.48 and use the 1.48 version.\r\n> \r\n> Otherwise you can downgrade with `migrate down` https://www.metabase.com/docs/latest/installation-and-operation/upgrading-metabase#rolling-back-an-upgrade\r\n> \r\n> This generally works, but restoring a backup is definitely safer.\r\n\r\nUnfortunately there was content development since. Thus restoring a backup isn't really an option."", 'created_at': datetime.datetime(2024, 4, 17, 15, 59, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2076957162, 'issue_id': 2246171908, 'author': 'johanvdlaak', 'body': '@luizarakaki I\'m a colleague of the OP, and was wondering about:\r\n\r\n1) Did you find anything in your investigating about the ""Query took 2.6 s to run; minimum for cache eligibility is 2.0 s; not eligible"" problem?\r\n\r\n~~2) We\'re struggling attempting to setup a second instance of metabase (version 48.8) on a cloned database to be able to demonstrate the issue with very noticeable slowdown of the same dashboard between the versions (as compared to 49.3).~~\r\n\r\n~~We\'ve got the cloned instance running on a backup of the db (at version 49.3) and were able to successfully run the migrate down command.~~\r\n```\r\n+ downgrade-metabase-version-8s5zw › downgrade-metabase-version-container\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container Warning: environ value jdk-11.0.22+7 for key :java-version has been overwritten with 11.0.22\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:41,285 INFO metabase.util :: Maximum memory available to JVM: 338.4 MB\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:45,765 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container  For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,145 INFO driver.impl :: Registered abstract driver :sql  🚚\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,179 INFO driver.impl :: Registered abstract driver :sql-jdbc (parents: [:sql]) 🚚\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,188 INFO metabase.util :: Load driver :sql-jdbc took 123.3 ms\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,188 INFO driver.impl :: Registered driver :h2 (parents: [:sql-jdbc]) 🚚\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,441 INFO driver.impl :: Registered driver :mysql (parents: [:sql-jdbc]) 🚚\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,500 INFO driver.impl :: Registered driver :postgres (parents: [:sql-jdbc]) 🚚\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:45:00,390 INFO metabase.core ::\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container Metabase v0.49.3 (dba0992)\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container Copyright © 2024 Metabase, Inc.\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container Metabase Enterprise Edition extensions are NOT PRESENT.\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:45:00,882 INFO db.setup :: Setting up Liquibase...\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:45:02,467 INFO db.setup :: Liquibase is ready.\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:45:02,479 INFO db.liquibase :: Rolling back app database schema to version 48\r\ndowngrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:45:03,498 INFO db.custom-migrations :: No rollback for:  DeleteTruncateAuditLogTask\r\n- downgrade-metabase-version-8s5zw › downgrade-metabase-version-container\r\n```\r\n\r\n~~But when starting up metabase 0.48.8 on that migrated down database, it fails to start, and shows the following error:~~\r\n```\r\n2024-04-25 06:56:30,542 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\n2024-04-25 06:56:30,545 INFO db.setup :: Verifying postgres Database Connection ...\r\n2024-04-25 06:56:30,874 INFO db.setup :: Successfully verified PostgreSQL 13.13 application database connection. ✅\r\n2024-04-25 06:56:30,876 INFO db.setup :: Checking if a database downgrade is required...\r\n2024-04-25 06:56:32,102 INFO db.setup :: Running Database Migrations...\r\n2024-04-25 06:56:32,103 INFO db.setup :: Setting up Liquibase...\r\n2024-04-25 06:56:32,351 INFO db.setup :: Liquibase is ready.\r\n2024-04-25 06:56:32,352 INFO db.liquibase :: Checking if Database has unrun migrations...\r\n2024-04-25 06:56:32,942 ERROR metabase.core :: Metabase Initialization FAILED\r\nliquibase.exception.ValidationFailedException: Validation Failed:\r\n     203 changesets check sum\r\n          migrations/001_update_migrations.yaml::v00.00-000::qnkhuat was: 9:e346841fa1cd9d142e1237b37fdc8a20 but is now: 8:a59595109e74e7a2678a1b0dfd25f74a\r\n          migrations/001_update_migrations.yaml::v45.00-001::snoe was: 9:15c13a8aa3fdc72ef0c54f4cccfc39e1 but is now: 8:da99b71a4ac7eb662f6a95e69585935e\r\n          migrations/001_update_migrations.yaml::v45.00-002::snoe was: 9:d2c9f50f5a29947a07e4808957d63ab6 but is now: 8:6da7a6285edb138c404de0eeba209570\r\n          migrations/001_update_migrations.yaml::v45.00-003::snoe was: 9:dafaaf7c9f0efbf92670ea93c001f7a1 but is now: 8:512337d6d4af38016aa79585abbe03a1\r\n          migrations/001_update_migrations.yaml::v45.00-011::snoe was: 9:c539f152aa1c2287c5b602c7a395f9e8 but is now: 8:dcf1cda9f20dca4b6ff8101b13b98c4a\r\n          migrations/001_update_migrations.yaml::v45.00-012::snoe was: 9:b872219f47d12ec80db8f1731be4ce94 but is now: 8:aadf28229f585cff7c4b4c1918e558b2\r\n          migrations/001_update_migrations.yaml::v45.00-013::snoe was: 9:54c5d6a9659b7ae62e8c42f60f9620d2 but is now: 8:26dba276b14255d4346507a1a25d117b\r\n          migrations/001_update_migrations.yaml::v45.00-022::snoe was: 9:06e8a3ba8c4c5e5cf8e6aa3f35081cac but is now: 8:d46fa24e4d75a11b2e92aecbf39c6ee1\r\n          migrations/001_update_migrations.yaml::v45.00-023::snoe was: 9:082d296233ee6dbbf2871b9d93c3a6a4 but is now: 8:c6c1ff9ca3b62d4cda3a2d782dd86f2f\r\n          migrations/001_update_migrations.yaml::v45.00-025::metamben was: 9:2214b0d71acc8a8cf90781a2aca98664 but is now: 8:50a43cea3123ecdb602123825f5a7dbf\r\n          migrations/001_update_migrations.yaml::v45.00-026::snoe was: 9:9f2ce2d2d79d0dce365ddf3464d1f648 but is now: 8:ae77d4086998911877e3207fcf90c9c7\r\n          migrations/001_update_migrations.yaml::v45.00-027::snoe was: 9:73718f7b7c3fb4ef30f71dc6e6170528 but is now: 8:40c3c8391c1416a3bce09ca3c7237173\r\n          migrations/001_update_migrations.yaml::v45.00-028::camsaul was: 9:883315d70f3fc10b07858aa0e48ed9da but is now: 8:f8f68f80627aeb2ef7f28f2af2b5a31b\r\n          migrations/001_update_migrations.yaml::v45.00-029::camsaul was: 9:fe3b8aca811ef5b541f922a83c7ded8c but is now: 8:579957652133eab3ee023dd911162a1e\r\n          migrations/001_update_migrations.yaml::v45.00-030::camsaul was: 9:63da8f2f82baf396ad30f3fd451c501d but is now: 8:41eda097feb034c4d01b2dbda74753c8\r\n          migrations/001_update_migrations.yaml::v45.00-031::camsaul was: 9:3628c1c692bec0f7258ea983b18340b5 but is now: 8:6416e373e335dc1c12c7571af674dede\r\n          migrations/001_update_migrations.yaml::v45.00-032::camsaul was: 9:7a6f0320210b82c5eafe836ea98f477d but is now: 8:d97444fe24a2dca618a2804741335f6d\r\n          migrations/001_update_migrations.yaml::v45.00-033::camsaul was: 9:b93dab321e4a1fcaeb74d12b52867fd4 but is now: 8:34df79fc79e086ab05bb2fd79bb4e322\r\n          migrations/001_update_migrations.yaml::v45.00-034::camsaul was: 9:39c965f9dc521d2a1e196f645d11de9e but is now: 8:ba0505a87ef876026759cdcb4e704f41\r\n          migrations/001_update_migrations.yaml::v45.00-035::camsaul was: 9:207984e21c44681a6135592cab3d0f3f but is now: 8:dcee49781d80d9c4be5ad9dd51975a07\r\n          migrations/001_update_migrations.yaml::v45.00-036::snoe was: 9:8632f7a046e1094399c517b05f0feea3 but is now: 8:cd4009254bd2c56aaf281082038c1f0b\r\n          migrations/001_update_migrations.yaml::v45.00-037::snoe was: 9:6600702fb0cc9dcd8628fca8df9c0b39 but is now: 8:56f548cc84a53cc6d18302761ee71554\r\n          migrations/001_update_migrations.yaml::v45.00-038::camsaul was: 9:5ae52c12861e5eec6a2a9a8c5a442826 but is now: 8:c38ddc295206e807c7254581ed9566c3\r\n          migrations/001_update_migrations.yaml::v45.00-039::camsaul was: 9:7b331f47a0260218275c58fa21fdcc60 but is now: 8:2c539d76d3aead7f7366b15333132b30\r\n          migrations/001_update_migrations.yaml::v45.00-040::camsaul was: 9:6d6fb2c7cd62868b9878a951c8596cec but is now: 8:00ac7c24cfd3e7ea3a21f21f4e45dbcf\r\n          migrations/001_update_migrations.yaml::v45.00-041::camsaul was: 9:84d479472b81809b8067f72b28934954 but is now: 8:82dc368fa3e0163a06929da6e9556fe2\r\n\r\n\tat liquibase.changelog.DatabaseChangeLog.validate(DatabaseChangeLog.java:354)\r\n\tat liquibase.Liquibase.lambda$listUnrunChangeSets$16(Liquibase.java:1287)\r\n\tat liquibase.Scope.lambda$child$0(Scope.java:194)\r\n...\r\n\tat metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)\r\n\tat metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)\r\n\tat clojure.lang.RestFn.invoke(RestFn.java:397)\r\n\tat clojure.lang.AFn.applyToHelper(AFn.java:152)\r\n\tat clojure.lang.RestFn.applyTo(RestFn.java:132)\r\n\tat metabase.bootstrap.main(Unknown Source)\r\n2024-04-25 06:56:32,974 INFO metabase.core :: Metabase Shutting Down ...\r\n2024-04-25 06:56:32,981 INFO metabase.server :: Shutting Down Embedded Jetty Webserver\r\n2024-04-25 06:56:33,022 INFO metabase.core :: Metabase Shutdown COMPLETE\r\n```\r\n~~Do you have some advice on how we can proceed past this error (so that we can get 48.8 running in order to better be able to show what we\'re experiencing)?~~\r\n\r\n[EDIT] We\'ve succeeded in getting past the error ([by setting the checksum values to NULL](https://forum.liquibase.org/t/how-to-fix-validationfailedexception-in-liquibase-checksum/6780/6)) and now have the 48.8 version up and running. We\'ll provide a comparison of the same dashboard on both versions shortly.', 'created_at': datetime.datetime(2024, 4, 25, 11, 24, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2077309283, 'issue_id': 2246171908, 'author': 'nicklubbers', 'body': '### Comparison between .48.8 and .49.5.\r\n\r\n- Same dashboard with same filters. We load the first tab of 3 tabs in the dashboard.\r\n- Same caching settings via Admin Settings, and same caching settings via Databases -> BigQuery.\r\n- Same resources in Kubernetes.\r\n- Both cases we ran the same dashboard beforehand so any caching would be done already.\r\n\r\n### Version .48.8\r\n\r\nFinish: 7.22 s\r\nLongest `query` call took 5.23 s.\r\n\r\n![image](https://github.com/metabase/metabase/assets/22885844/50e7ab13-56a3-4a08-b971-2bebbc4815b8)\r\n![image](https://github.com/metabase/metabase/assets/22885844/d2d9417d-fd88-460e-bb3b-ac54712d8b2c)\r\n\r\n\r\n### Version .49.5\r\n\r\nFinish: **28.53 s**\r\nNotice a lag between in the batches of calls in the timeline.\r\nAlso notice that the individual calls take longer.\r\nLongest `query` call took 7.97 s.\r\n\r\n![image](https://github.com/metabase/metabase/assets/22885844/78f27001-a6d1-4478-b937-5c185239667d)\r\n![image](https://github.com/metabase/metabase/assets/22885844/91cf0fec-c579-42f2-b82f-8b3b752bc24c)', 'created_at': datetime.datetime(2024, 4, 25, 14, 13, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2077694384, 'issue_id': 2246171908, 'author': 'paoliniluis', 'body': ""@nicklubbers what's the server size?"", 'created_at': datetime.datetime(2024, 4, 25, 16, 27, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079325245, 'issue_id': 2246171908, 'author': 'nicklubbers', 'body': '@paoliniluis \r\n\r\nBoth .48 and .49 have:\r\n\r\n```\r\n  replicas: 2\r\n  resources:\r\n    limits:\r\n      cpu: ""4""\r\n      memory: 8Gi\r\n    requests:\r\n      cpu: ""2""\r\n      memory: 4Gi\r\n```\r\n\r\nDatabase:\r\n\r\n```\r\nvCPU: 1\r\nMemory: 3.75 GB\r\nSSD storage: 20GB\r\nCPU usage: around 16% over time\r\n\r\nMemory usage: peaks at 2.10 GiB\r\nActive connections: 40 (of max 100)\r\nStorage usage: 5GiB\r\n\r\nNo limits reached.\r\n```', 'created_at': datetime.datetime(2024, 4, 26, 12, 49, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2092028739, 'issue_id': 2246171908, 'author': 'jkeys089', 'body': 'We have a very similar setup (Google Cloud SQL postgres for the application db and BigQuery for data warehouse) and we\'re experiencing the same issue. I was able to track it to the application db but I\'m having some trouble understanding what, exactly, is causing the issue.\r\n\r\nAfter upgrading to v49.8 I noticed the postgres application db was having issues while looking at the system insights and query insights data:\r\n\r\n- Single slow query being run many times\r\n  <img width=""2253"" alt=""query_perf"" src=""https://github.com/metabase/metabase/assets/1695857/250208da-c758-44a9-b645-54fac9d342ec"">\r\n- Perhaps slow due to lock queue\r\n  ![wait_lock](https://github.com/metabase/metabase/assets/1695857/173ae1be-3264-4b80-a5bf-c9662894c16e)\r\n- Perhaps lock queue is impacted by hung / abandoned transactions\r\n  ![oldest_tx](https://github.com/metabase/metabase/assets/1695857/fb450bd1-0b88-4eea-af8c-922e3f007fee)\r\n\r\nRolling back to v49.3 worked but we also had to reboot the application db.\r\n\r\n@nicklubbers I wonder if you\'re seeing something similar in your postgres application db?', 'created_at': datetime.datetime(2024, 5, 3, 2, 19, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2095476384, 'issue_id': 2246171908, 'author': 'nicklubbers', 'body': '@jkeys089 \r\n\r\nI do not see such locking. Also no slow query being run multiple times when I look at the query insights.\r\n\r\n<img width=""692"" alt=""image"" src=""https://github.com/metabase/metabase/assets/22885844/ff804258-ea2b-4605-82ba-7aab17b8c832"">\r\n\r\n<img width=""697"" alt=""image"" src=""https://github.com/metabase/metabase/assets/22885844/bdbeaf97-455d-4db3-9998-fb442cf5bad6"">', 'created_at': datetime.datetime(2024, 5, 6, 8, 46, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2095566659, 'issue_id': 2246171908, 'author': 'nicklubbers', 'body': 'I have tried the following in an attempt to make Metabase faster again. Nothing helped.\r\n\r\nThe Postgress database has no issues, and the server (k8s pod) is overprovisioned. I feel like the data (either read from BigQuery, or from cache) is pretty fast, but it takes a long time for the browser to process the data in order to show the graphs. Running this with single page open in Chrome on a macbook pro.\r\n\r\nThe weird thing is that running .48 with the same setup does not have this problem. It is snappier and the the total dashboard takes 10sec to finish loading vs 25sec in version .49.\r\n\r\n@paoliniluis do you have any suggestions that I might try?\r\nOr do you know if something mayor changed in the frontend code related to this? \r\nCan I provide any other information that would help with debugging?\r\n\r\n-----\r\n\r\nAll the following did not help:\r\n- Allow more connections to the database: 30 (default; used with .48) → 80. Using `MB_APPLICATION_DB_MAX_CONNECTION_POOL_SIZE:  80`\r\n  ```\r\n  Database workload:\r\n  CPU utilization: does not go over 35% (12,7% P99)\r\n  Memory: stays under 60%\r\n  Connections: max 87 of 100 (Metabase 80 + 7 others)\r\n  Wait event types: Client, CPU, IO. Usually 1 or 2. Highest peak 4.\r\n  Disk utilization: 17,4%\r\n  ```\r\n  Nothing indicating that the DB is reaching any limits. Also note that 0.48 only had 30 max connections which was not a problem.\r\n\r\n- Allow more memory to be used by the java process: -Xmx3584m -Xms2048m Start with 2GB allow up to 3,5GB.\r\n\r\n  Changed the server (pod) settings from:\r\n  ```\r\n  Replicas: 2\r\n  Limits:\r\n    cpu:     2\r\n    memory:  4Gi\r\n  Requests:\r\n    cpu:     1\r\n    memory:  2Gi\r\n  ```\r\n  to\r\n  ```\r\n  Replicas: 1 (1 pod so maybe more efficient cache hits)\r\n  Limits:\r\n    cpu:     4\r\n    memory:  8Gi\r\n  Requests:\r\n    cpu:     2\r\n    memory:  4Gi\r\n  ```\r\n\r\n- Copied the slow dashboard with same questions and then removed elements:\r\n  - Removed one question because it was also not in 0.48 version.\r\n  - Removed the second and third tabs of the dashboard\r\n\r\n- Verified that the cache is working:\r\n  Set log level to debug. As described [here](https://www.metabase.com/docs/latest/configuring-metabase/log-configuration#using-log4j-2-with-docker).\r\n  - First enforcing caching all queries using the settings below. After running the dashboard once, you do indeed see that all the queries are read from cache the second time (i.g. no more ""Query took"" logs). However that does not speed up the dashboard loading.\r\n  ```\r\n  Admin settings -> Caching\r\n  SAVED QUESTIONS: enabled\r\n  MINIMUM QUERY DURATION: 0\r\n  CACHE TIME-TO-LIVE (TTL) MULTIPLIER: 600\r\n  MAX CACHE ENTRY SIZE: 100000\r\n  MODELS: enabled\r\n  Refresh models evey: 6 hours\r\n  \r\n  Databases -> BigQuery\r\n  Default result cache duration: Use instance default (TTL) [New in version 0.49]\r\n  \r\n  Logging:\r\n  Query took 498.0 ms to run; minimum for cache eligibility is 0.0 ns; eligible\r\n  Caching results for next time for query with hash ""58a430f4""\r\n  Caching results for query with hash ""58a430f4"".\r\n  ```\r\n  - Also tried using the same caching settings as with 0.48. No difference.\r\n  ```\r\n  Admin settings -> Caching\r\n  SAVED QUESTIONS: enabled\r\n  MINIMUM QUERY DURATION: 3\r\n  CACHE TIME-TO-LIVE (TTL) MULTIPLIER: 60\r\n  MAX CACHE ENTRY SIZE: 10000\r\n  MODELS: enabled\r\n  Refresh models evey: 6 hours\r\n  \r\n  Databases -> BigQuery\r\n  Default result cache duration: Use instance default (TTL) [New in version 0.49]\r\n  \r\n  Logging:\r\n  Query took 377.0 ms to run; minimum for cache eligibility is 3.0 s; not eligible\r\n  ```', 'created_at': datetime.datetime(2024, 5, 6, 9, 36, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2096186967, 'issue_id': 2246171908, 'author': 'nicklubbers', 'body': 'Comparing the network tab on version .48 and version .49 it looks like the newer version starts (or completes) the `query_metadata` calls sequentially. This in contrast to .48 where they seem to be executed in parallel. This could explain why it takes longer to load all graphs/questions.', 'created_at': datetime.datetime(2024, 5, 6, 14, 34, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2096537870, 'issue_id': 2246171908, 'author': 'paoliniluis', 'body': ""I'm finishing a telemetry tool to start measuring performance of the APIs in a few minutes. After that I'll start to investigate this, I needed to builf the tool to put this in our CI"", 'created_at': datetime.datetime(2024, 5, 6, 17, 20, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2113053339, 'issue_id': 2246171908, 'author': 'perivamsi', 'body': '[This PR ](https://github.com/metabase/metabase/pull/42655) might fix this issue.\r\n\r\nThe fix is scheduled to go out for v49.11.', 'created_at': datetime.datetime(2024, 5, 15, 17, 10, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2117626117, 'issue_id': 2246171908, 'author': 'johanvdlaak', 'body': 'Thanks for investigating and providing the bugfix.\r\n\r\nWe\'ve upgraded to v49.11 and can see significant performance gain on the first tab of the dashboard.\r\nIt now loads in about 10s, so not exactly as quick as before (8s in v48.8), but very much an improvement over the 25s (in v49.5). And the remaining difference might very well be caused by some changes done on this dashboard on our side in the mean time. So the bugfix definitely worked.\r\n\r\nHowever on the second tab (which has only 5 questions on it) we unexpectedly do not see the same result. Here the performance in v48.8 vs v49.11 still shows a big difference. And the network traffic shows something very interesting. It seems that in v49 it might be doing requests for all the questions on other tabs.\r\n\r\nNetwork requests of 2nd dashboard tab on v48.8\r\nFinish: ~ 5 seconds\r\n<img width=""2238"" alt=""image"" src=""https://github.com/metabase/metabase/assets/2833353/7c5af6c9-0da1-4904-acbc-af5a03553010"">\r\n\r\nNetwork requests of 2nd dashboard tab on v49.11\r\nFinish: ~ 10s\r\nNotice the number of `query` and `query_metadata` requests considering the tab only contains 5 questions.\r\n<img width=""2227"" alt=""image"" src=""https://github.com/metabase/metabase/assets/2833353/e6627b77-6a7d-49b6-b637-a5d40b81b8dd"">\r\n<img width=""2228"" alt=""image"" src=""https://github.com/metabase/metabase/assets/2833353/5c3d3b9c-6c0b-4c87-b96e-eaab9ba3087a"">\r\n\r\nIt seems we\'re running into another performance bug here. \r\nLet me know if you prefer to have this reported as a new github issue, or if it is fine to continue in this thread?', 'created_at': datetime.datetime(2024, 5, 17, 13, 36, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2129303783, 'issue_id': 2246171908, 'author': 'johanvdlaak', 'body': 'Did these fixes make it into version 49.12 that was released a few hours ago?\r\n\r\nThe milestones added above would indicate so, but going by the release notes of 49.12 it would appear not.', 'created_at': datetime.datetime(2024, 5, 24, 11, 31, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2129598424, 'issue_id': 2246171908, 'author': 'crisptrutski', 'body': 'Unfortunately they did not make it in on time, and the milestone was not updated when we made the call. \n\nIt should be in the next point release though.', 'created_at': datetime.datetime(2024, 5, 24, 13, 53, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2153736013, 'issue_id': 2246171908, 'author': 'ranquild', 'body': 'We reworked how dashboards are loaded in 0.50 to address this issue. Changes are large and we currently do not plan to backport them to 0.49. This might change in the future.', 'created_at': datetime.datetime(2024, 6, 7, 2, 22, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2180108922, 'issue_id': 2246171908, 'author': 'nicklubbers', 'body': '@ranquild We have updated from .49.12 to .50.6 and unfortunately see a significant performance decrease again.\r\nSee the screenshots below. The first screenshot shows the network calls on the first tab of our ""test"" dashboard that we used throughout this GH issue. The second screenshot shows the calls on the second tab.\r\n\r\nWill this issue be re-opened or should we create a new issue? For us the 50.6 version is too slow and we had to revert to .49.12 again.\r\n\r\n```\r\nTab 1\r\n.48.8: 7-8sec\r\n.49.5: 28sec\r\n.49.11: 10sec\r\n.50.6: 21.7sec (screenshot 1; note the query_metadata call of 10.44s!)\r\n\r\nTab 2\r\n.48.8: 5sec\r\n.49.5: -\r\n.49.11: 10sec\r\n.50.6: 20.19sec (screenshot 2; note the cancelled query calls and the query_metadata call of 12.80s!)\r\n```\r\nTab 1:\r\n![image](https://github.com/metabase/metabase/assets/22885844/1a4a1f91-349e-4b26-9e5f-2c7c1063e1c7)\r\n\r\n\r\nTab 2:\r\n![image](https://github.com/metabase/metabase/assets/22885844/f1e89267-9e7d-4bf7-b4ce-5d6ca7e07ef3)', 'created_at': datetime.datetime(2024, 6, 20, 8, 26, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2180707621, 'issue_id': 2246171908, 'author': 'paoliniluis', 'body': ""@nicklubbers, there's something going on in here https://github.com/metabase/metabase/issues/44359 that I strongly believe it's causing these issues. We're working as we speak on this"", 'created_at': datetime.datetime(2024, 6, 20, 13, 31, 57, tzinfo=datetime.timezone.utc)}]","luizarakaki on (2024-04-16 17:26:10 UTC): Looks like we could repro this internally. If others hit this and have more info, please comment here as any more data is helpful.

luizarakaki on (2024-04-16 17:26:45 UTC): ~Tagging as P1 while we investigate, may change if it isn't severe.~

Inconclusive investigation: [internal thread](https://metaboat.slack.com/archives/C01MS7DQKR6/p1713279128985999)

luizarakaki on (2024-04-16 21:35:38 UTC): @nicklubbers we investigated this and couldn't get conclusive results. How many questions do you have in this dashboard?

nicklubbers (Issue Creator) on (2024-04-17 07:18:31 UTC): I have 19 questions on the dashboard.

Also interesting from the internal log: `[23ce4c3d-6373-4477-9aa8-e2f7e0702447] 2024-04-16T14:58:29+02:00 INFO metabase.query-processor.middleware.cache Query took 2.6 s to run; minimum for cache eligibility is 2.0 s; not eligible` -- Bug? 2.6s is more than 2.0s thus it should be eligible.

nicklubbers (Issue Creator) on (2024-04-17 13:56:33 UTC): @luizarakaki can I downgrade to version 1.48 or would that break things?

In the meantime I have tried: adding more pods (servers) to host Metabase, tried out different caching settings via Admin settings -> caching, and via Admin Settings -> Databases. No effect.

luizarakaki on (2024-04-17 14:09:24 UTC): If you have a backup and didn't develop much content after the upgrade, I advise to restore an application database backup from 1.48 and use the 1.48 version.

Otherwise you can downgrade with `migrate down` https://www.metabase.com/docs/latest/installation-and-operation/upgrading-metabase#rolling-back-an-upgrade

This generally works, but restoring a backup is definitely safer.

luizarakaki on (2024-04-17 14:10:17 UTC): I'll take a look. When investigating this issue, I found some questions with the same problem.

nicklubbers (Issue Creator) on (2024-04-17 15:59:59 UTC): Unfortunately there was content development since. Thus restoring a backup isn't really an option.

johanvdlaak on (2024-04-25 11:24:21 UTC): @luizarakaki I'm a colleague of the OP, and was wondering about:

1) Did you find anything in your investigating about the ""Query took 2.6 s to run; minimum for cache eligibility is 2.0 s; not eligible"" problem?

~~2) We're struggling attempting to setup a second instance of metabase (version 48.8) on a cloned database to be able to demonstrate the issue with very noticeable slowdown of the same dashboard between the versions (as compared to 49.3).~~

~~We've got the cloned instance running on a backup of the db (at version 49.3) and were able to successfully run the migrate down command.~~
```
+ downgrade-metabase-version-8s5zw › downgrade-metabase-version-container
downgrade-metabase-version-8s5zw downgrade-metabase-version-container Warning: environ value jdk-11.0.22+7 for key :java-version has been overwritten with 11.0.22
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:41,285 INFO metabase.util :: Maximum memory available to JVM: 338.4 MB
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:45,765 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓
downgrade-metabase-version-8s5zw downgrade-metabase-version-container  For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,145 INFO driver.impl :: Registered abstract driver :sql  🚚
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,179 INFO driver.impl :: Registered abstract driver :sql-jdbc (parents: [:sql]) 🚚
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,188 INFO metabase.util :: Load driver :sql-jdbc took 123.3 ms
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,188 INFO driver.impl :: Registered driver :h2 (parents: [:sql-jdbc]) 🚚
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,441 INFO driver.impl :: Registered driver :mysql (parents: [:sql-jdbc]) 🚚
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:44:57,500 INFO driver.impl :: Registered driver :postgres (parents: [:sql-jdbc]) 🚚
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:45:00,390 INFO metabase.core ::
downgrade-metabase-version-8s5zw downgrade-metabase-version-container Metabase v0.49.3 (dba0992)
downgrade-metabase-version-8s5zw downgrade-metabase-version-container
downgrade-metabase-version-8s5zw downgrade-metabase-version-container Copyright © 2024 Metabase, Inc.
downgrade-metabase-version-8s5zw downgrade-metabase-version-container
downgrade-metabase-version-8s5zw downgrade-metabase-version-container Metabase Enterprise Edition extensions are NOT PRESENT.
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:45:00,882 INFO db.setup :: Setting up Liquibase...
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:45:02,467 INFO db.setup :: Liquibase is ready.
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:45:02,479 INFO db.liquibase :: Rolling back app database schema to version 48
downgrade-metabase-version-8s5zw downgrade-metabase-version-container 2024-04-24 13:45:03,498 INFO db.custom-migrations :: No rollback for:  DeleteTruncateAuditLogTask
- downgrade-metabase-version-8s5zw › downgrade-metabase-version-container
```

~~But when starting up metabase 0.48.8 on that migrated down database, it fails to start, and shows the following error:~~
```
2024-04-25 06:56:30,542 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
2024-04-25 06:56:30,545 INFO db.setup :: Verifying postgres Database Connection ...
2024-04-25 06:56:30,874 INFO db.setup :: Successfully verified PostgreSQL 13.13 application database connection. ✅
2024-04-25 06:56:30,876 INFO db.setup :: Checking if a database downgrade is required...
2024-04-25 06:56:32,102 INFO db.setup :: Running Database Migrations...
2024-04-25 06:56:32,103 INFO db.setup :: Setting up Liquibase...
2024-04-25 06:56:32,351 INFO db.setup :: Liquibase is ready.
2024-04-25 06:56:32,352 INFO db.liquibase :: Checking if Database has unrun migrations...
2024-04-25 06:56:32,942 ERROR metabase.core :: Metabase Initialization FAILED
liquibase.exception.ValidationFailedException: Validation Failed:
     203 changesets check sum
          migrations/001_update_migrations.yaml::v00.00-000::qnkhuat was: 9:e346841fa1cd9d142e1237b37fdc8a20 but is now: 8:a59595109e74e7a2678a1b0dfd25f74a
          migrations/001_update_migrations.yaml::v45.00-001::snoe was: 9:15c13a8aa3fdc72ef0c54f4cccfc39e1 but is now: 8:da99b71a4ac7eb662f6a95e69585935e
          migrations/001_update_migrations.yaml::v45.00-002::snoe was: 9:d2c9f50f5a29947a07e4808957d63ab6 but is now: 8:6da7a6285edb138c404de0eeba209570
          migrations/001_update_migrations.yaml::v45.00-003::snoe was: 9:dafaaf7c9f0efbf92670ea93c001f7a1 but is now: 8:512337d6d4af38016aa79585abbe03a1
          migrations/001_update_migrations.yaml::v45.00-011::snoe was: 9:c539f152aa1c2287c5b602c7a395f9e8 but is now: 8:dcf1cda9f20dca4b6ff8101b13b98c4a
          migrations/001_update_migrations.yaml::v45.00-012::snoe was: 9:b872219f47d12ec80db8f1731be4ce94 but is now: 8:aadf28229f585cff7c4b4c1918e558b2
          migrations/001_update_migrations.yaml::v45.00-013::snoe was: 9:54c5d6a9659b7ae62e8c42f60f9620d2 but is now: 8:26dba276b14255d4346507a1a25d117b
          migrations/001_update_migrations.yaml::v45.00-022::snoe was: 9:06e8a3ba8c4c5e5cf8e6aa3f35081cac but is now: 8:d46fa24e4d75a11b2e92aecbf39c6ee1
          migrations/001_update_migrations.yaml::v45.00-023::snoe was: 9:082d296233ee6dbbf2871b9d93c3a6a4 but is now: 8:c6c1ff9ca3b62d4cda3a2d782dd86f2f
          migrations/001_update_migrations.yaml::v45.00-025::metamben was: 9:2214b0d71acc8a8cf90781a2aca98664 but is now: 8:50a43cea3123ecdb602123825f5a7dbf
          migrations/001_update_migrations.yaml::v45.00-026::snoe was: 9:9f2ce2d2d79d0dce365ddf3464d1f648 but is now: 8:ae77d4086998911877e3207fcf90c9c7
          migrations/001_update_migrations.yaml::v45.00-027::snoe was: 9:73718f7b7c3fb4ef30f71dc6e6170528 but is now: 8:40c3c8391c1416a3bce09ca3c7237173
          migrations/001_update_migrations.yaml::v45.00-028::camsaul was: 9:883315d70f3fc10b07858aa0e48ed9da but is now: 8:f8f68f80627aeb2ef7f28f2af2b5a31b
          migrations/001_update_migrations.yaml::v45.00-029::camsaul was: 9:fe3b8aca811ef5b541f922a83c7ded8c but is now: 8:579957652133eab3ee023dd911162a1e
          migrations/001_update_migrations.yaml::v45.00-030::camsaul was: 9:63da8f2f82baf396ad30f3fd451c501d but is now: 8:41eda097feb034c4d01b2dbda74753c8
          migrations/001_update_migrations.yaml::v45.00-031::camsaul was: 9:3628c1c692bec0f7258ea983b18340b5 but is now: 8:6416e373e335dc1c12c7571af674dede
          migrations/001_update_migrations.yaml::v45.00-032::camsaul was: 9:7a6f0320210b82c5eafe836ea98f477d but is now: 8:d97444fe24a2dca618a2804741335f6d
          migrations/001_update_migrations.yaml::v45.00-033::camsaul was: 9:b93dab321e4a1fcaeb74d12b52867fd4 but is now: 8:34df79fc79e086ab05bb2fd79bb4e322
          migrations/001_update_migrations.yaml::v45.00-034::camsaul was: 9:39c965f9dc521d2a1e196f645d11de9e but is now: 8:ba0505a87ef876026759cdcb4e704f41
          migrations/001_update_migrations.yaml::v45.00-035::camsaul was: 9:207984e21c44681a6135592cab3d0f3f but is now: 8:dcee49781d80d9c4be5ad9dd51975a07
          migrations/001_update_migrations.yaml::v45.00-036::snoe was: 9:8632f7a046e1094399c517b05f0feea3 but is now: 8:cd4009254bd2c56aaf281082038c1f0b
          migrations/001_update_migrations.yaml::v45.00-037::snoe was: 9:6600702fb0cc9dcd8628fca8df9c0b39 but is now: 8:56f548cc84a53cc6d18302761ee71554
          migrations/001_update_migrations.yaml::v45.00-038::camsaul was: 9:5ae52c12861e5eec6a2a9a8c5a442826 but is now: 8:c38ddc295206e807c7254581ed9566c3
          migrations/001_update_migrations.yaml::v45.00-039::camsaul was: 9:7b331f47a0260218275c58fa21fdcc60 but is now: 8:2c539d76d3aead7f7366b15333132b30
          migrations/001_update_migrations.yaml::v45.00-040::camsaul was: 9:6d6fb2c7cd62868b9878a951c8596cec but is now: 8:00ac7c24cfd3e7ea3a21f21f4e45dbcf
          migrations/001_update_migrations.yaml::v45.00-041::camsaul was: 9:84d479472b81809b8067f72b28934954 but is now: 8:82dc368fa3e0163a06929da6e9556fe2

	at liquibase.changelog.DatabaseChangeLog.validate(DatabaseChangeLog.java:354)
	at liquibase.Liquibase.lambda$listUnrunChangeSets$16(Liquibase.java:1287)
	at liquibase.Scope.lambda$child$0(Scope.java:194)
...
	at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
	at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
	at clojure.lang.RestFn.invoke(RestFn.java:397)
	at clojure.lang.AFn.applyToHelper(AFn.java:152)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at metabase.bootstrap.main(Unknown Source)
2024-04-25 06:56:32,974 INFO metabase.core :: Metabase Shutting Down ...
2024-04-25 06:56:32,981 INFO metabase.server :: Shutting Down Embedded Jetty Webserver
2024-04-25 06:56:33,022 INFO metabase.core :: Metabase Shutdown COMPLETE
```
~~Do you have some advice on how we can proceed past this error (so that we can get 48.8 running in order to better be able to show what we're experiencing)?~~

[EDIT] We've succeeded in getting past the error ([by setting the checksum values to NULL](https://forum.liquibase.org/t/how-to-fix-validationfailedexception-in-liquibase-checksum/6780/6)) and now have the 48.8 version up and running. We'll provide a comparison of the same dashboard on both versions shortly.

nicklubbers (Issue Creator) on (2024-04-25 14:13:38 UTC): ### Comparison between .48.8 and .49.5.

- Same dashboard with same filters. We load the first tab of 3 tabs in the dashboard.
- Same caching settings via Admin Settings, and same caching settings via Databases -> BigQuery.
- Same resources in Kubernetes.
- Both cases we ran the same dashboard beforehand so any caching would be done already.

### Version .48.8

Finish: 7.22 s
Longest `query` call took 5.23 s.

![image](https://github.com/metabase/metabase/assets/22885844/50e7ab13-56a3-4a08-b971-2bebbc4815b8)
![image](https://github.com/metabase/metabase/assets/22885844/d2d9417d-fd88-460e-bb3b-ac54712d8b2c)


### Version .49.5

Finish: **28.53 s**
Notice a lag between in the batches of calls in the timeline.
Also notice that the individual calls take longer.
Longest `query` call took 7.97 s.

![image](https://github.com/metabase/metabase/assets/22885844/78f27001-a6d1-4478-b937-5c185239667d)
![image](https://github.com/metabase/metabase/assets/22885844/91cf0fec-c579-42f2-b82f-8b3b752bc24c)

paoliniluis on (2024-04-25 16:27:44 UTC): @nicklubbers what's the server size?

nicklubbers (Issue Creator) on (2024-04-26 12:49:10 UTC): @paoliniluis 

Both .48 and .49 have:

```
  replicas: 2
  resources:
    limits:
      cpu: ""4""
      memory: 8Gi
    requests:
      cpu: ""2""
      memory: 4Gi
```

Database:

```
vCPU: 1
Memory: 3.75 GB
SSD storage: 20GB
CPU usage: around 16% over time

Memory usage: peaks at 2.10 GiB
Active connections: 40 (of max 100)
Storage usage: 5GiB

No limits reached.
```

jkeys089 on (2024-05-03 02:19:26 UTC): We have a very similar setup (Google Cloud SQL postgres for the application db and BigQuery for data warehouse) and we're experiencing the same issue. I was able to track it to the application db but I'm having some trouble understanding what, exactly, is causing the issue.

After upgrading to v49.8 I noticed the postgres application db was having issues while looking at the system insights and query insights data:

- Single slow query being run many times
  <img width=""2253"" alt=""query_perf"" src=""https://github.com/metabase/metabase/assets/1695857/250208da-c758-44a9-b645-54fac9d342ec"">
- Perhaps slow due to lock queue
  ![wait_lock](https://github.com/metabase/metabase/assets/1695857/173ae1be-3264-4b80-a5bf-c9662894c16e)
- Perhaps lock queue is impacted by hung / abandoned transactions
  ![oldest_tx](https://github.com/metabase/metabase/assets/1695857/fb450bd1-0b88-4eea-af8c-922e3f007fee)

Rolling back to v49.3 worked but we also had to reboot the application db.

@nicklubbers I wonder if you're seeing something similar in your postgres application db?

nicklubbers (Issue Creator) on (2024-05-06 08:46:13 UTC): @jkeys089 

I do not see such locking. Also no slow query being run multiple times when I look at the query insights.

<img width=""692"" alt=""image"" src=""https://github.com/metabase/metabase/assets/22885844/ff804258-ea2b-4605-82ba-7aab17b8c832"">

<img width=""697"" alt=""image"" src=""https://github.com/metabase/metabase/assets/22885844/bdbeaf97-455d-4db3-9998-fb442cf5bad6"">

nicklubbers (Issue Creator) on (2024-05-06 09:36:39 UTC): I have tried the following in an attempt to make Metabase faster again. Nothing helped.

The Postgress database has no issues, and the server (k8s pod) is overprovisioned. I feel like the data (either read from BigQuery, or from cache) is pretty fast, but it takes a long time for the browser to process the data in order to show the graphs. Running this with single page open in Chrome on a macbook pro.

The weird thing is that running .48 with the same setup does not have this problem. It is snappier and the the total dashboard takes 10sec to finish loading vs 25sec in version .49.

@paoliniluis do you have any suggestions that I might try?
Or do you know if something mayor changed in the frontend code related to this? 
Can I provide any other information that would help with debugging?

-----

All the following did not help:
- Allow more connections to the database: 30 (default; used with .48) → 80. Using `MB_APPLICATION_DB_MAX_CONNECTION_POOL_SIZE:  80`
  ```
  Database workload:
  CPU utilization: does not go over 35% (12,7% P99)
  Memory: stays under 60%
  Connections: max 87 of 100 (Metabase 80 + 7 others)
  Wait event types: Client, CPU, IO. Usually 1 or 2. Highest peak 4.
  Disk utilization: 17,4%
  ```
  Nothing indicating that the DB is reaching any limits. Also note that 0.48 only had 30 max connections which was not a problem.

- Allow more memory to be used by the java process: -Xmx3584m -Xms2048m Start with 2GB allow up to 3,5GB.

  Changed the server (pod) settings from:
  ```
  Replicas: 2
  Limits:
    cpu:     2
    memory:  4Gi
  Requests:
    cpu:     1
    memory:  2Gi
  ```
  to
  ```
  Replicas: 1 (1 pod so maybe more efficient cache hits)
  Limits:
    cpu:     4
    memory:  8Gi
  Requests:
    cpu:     2
    memory:  4Gi
  ```

- Copied the slow dashboard with same questions and then removed elements:
  - Removed one question because it was also not in 0.48 version.
  - Removed the second and third tabs of the dashboard

- Verified that the cache is working:
  Set log level to debug. As described [here](https://www.metabase.com/docs/latest/configuring-metabase/log-configuration#using-log4j-2-with-docker).
  - First enforcing caching all queries using the settings below. After running the dashboard once, you do indeed see that all the queries are read from cache the second time (i.g. no more ""Query took"" logs). However that does not speed up the dashboard loading.
  ```
  Admin settings -> Caching
  SAVED QUESTIONS: enabled
  MINIMUM QUERY DURATION: 0
  CACHE TIME-TO-LIVE (TTL) MULTIPLIER: 600
  MAX CACHE ENTRY SIZE: 100000
  MODELS: enabled
  Refresh models evey: 6 hours
  
  Databases -> BigQuery
  Default result cache duration: Use instance default (TTL) [New in version 0.49]
  
  Logging:
  Query took 498.0 ms to run; minimum for cache eligibility is 0.0 ns; eligible
  Caching results for next time for query with hash ""58a430f4""
  Caching results for query with hash ""58a430f4"".
  ```
  - Also tried using the same caching settings as with 0.48. No difference.
  ```
  Admin settings -> Caching
  SAVED QUESTIONS: enabled
  MINIMUM QUERY DURATION: 3
  CACHE TIME-TO-LIVE (TTL) MULTIPLIER: 60
  MAX CACHE ENTRY SIZE: 10000
  MODELS: enabled
  Refresh models evey: 6 hours
  
  Databases -> BigQuery
  Default result cache duration: Use instance default (TTL) [New in version 0.49]
  
  Logging:
  Query took 377.0 ms to run; minimum for cache eligibility is 3.0 s; not eligible
  ```

nicklubbers (Issue Creator) on (2024-05-06 14:34:59 UTC): Comparing the network tab on version .48 and version .49 it looks like the newer version starts (or completes) the `query_metadata` calls sequentially. This in contrast to .48 where they seem to be executed in parallel. This could explain why it takes longer to load all graphs/questions.

paoliniluis on (2024-05-06 17:20:19 UTC): I'm finishing a telemetry tool to start measuring performance of the APIs in a few minutes. After that I'll start to investigate this, I needed to builf the tool to put this in our CI

perivamsi on (2024-05-15 17:10:12 UTC): [This PR ](https://github.com/metabase/metabase/pull/42655) might fix this issue.

The fix is scheduled to go out for v49.11.

johanvdlaak on (2024-05-17 13:36:23 UTC): Thanks for investigating and providing the bugfix.

We've upgraded to v49.11 and can see significant performance gain on the first tab of the dashboard.
It now loads in about 10s, so not exactly as quick as before (8s in v48.8), but very much an improvement over the 25s (in v49.5). And the remaining difference might very well be caused by some changes done on this dashboard on our side in the mean time. So the bugfix definitely worked.

However on the second tab (which has only 5 questions on it) we unexpectedly do not see the same result. Here the performance in v48.8 vs v49.11 still shows a big difference. And the network traffic shows something very interesting. It seems that in v49 it might be doing requests for all the questions on other tabs.

Network requests of 2nd dashboard tab on v48.8
Finish: ~ 5 seconds
<img width=""2238"" alt=""image"" src=""https://github.com/metabase/metabase/assets/2833353/7c5af6c9-0da1-4904-acbc-af5a03553010"">

Network requests of 2nd dashboard tab on v49.11
Finish: ~ 10s
Notice the number of `query` and `query_metadata` requests considering the tab only contains 5 questions.
<img width=""2227"" alt=""image"" src=""https://github.com/metabase/metabase/assets/2833353/e6627b77-6a7d-49b6-b637-a5d40b81b8dd"">
<img width=""2228"" alt=""image"" src=""https://github.com/metabase/metabase/assets/2833353/5c3d3b9c-6c0b-4c87-b96e-eaab9ba3087a"">

It seems we're running into another performance bug here. 
Let me know if you prefer to have this reported as a new github issue, or if it is fine to continue in this thread?

johanvdlaak on (2024-05-24 11:31:21 UTC): Did these fixes make it into version 49.12 that was released a few hours ago?

The milestones added above would indicate so, but going by the release notes of 49.12 it would appear not.

crisptrutski on (2024-05-24 13:53:48 UTC): Unfortunately they did not make it in on time, and the milestone was not updated when we made the call. 

It should be in the next point release though.

ranquild (Assginee) on (2024-06-07 02:22:37 UTC): We reworked how dashboards are loaded in 0.50 to address this issue. Changes are large and we currently do not plan to backport them to 0.49. This might change in the future.

nicklubbers (Issue Creator) on (2024-06-20 08:26:17 UTC): @ranquild We have updated from .49.12 to .50.6 and unfortunately see a significant performance decrease again.
See the screenshots below. The first screenshot shows the network calls on the first tab of our ""test"" dashboard that we used throughout this GH issue. The second screenshot shows the calls on the second tab.

Will this issue be re-opened or should we create a new issue? For us the 50.6 version is too slow and we had to revert to .49.12 again.

```
Tab 1
.48.8: 7-8sec
.49.5: 28sec
.49.11: 10sec
.50.6: 21.7sec (screenshot 1; note the query_metadata call of 10.44s!)

Tab 2
.48.8: 5sec
.49.5: -
.49.11: 10sec
.50.6: 20.19sec (screenshot 2; note the cancelled query calls and the query_metadata call of 12.80s!)
```
Tab 1:
![image](https://github.com/metabase/metabase/assets/22885844/1a4a1f91-349e-4b26-9e5f-2c7c1063e1c7)


Tab 2:
![image](https://github.com/metabase/metabase/assets/22885844/f1e89267-9e7d-4bf7-b4ce-5d6ca7e07ef3)

paoliniluis on (2024-06-20 13:31:57 UTC): @nicklubbers, there's something going on in here https://github.com/metabase/metabase/issues/44359 that I strongly believe it's causing these issues. We're working as we speak on this

"
2245982766,issue,closed,completed,"Tag type 'undefined' was used, but not specified in `tagTypes`","1. Create a collection
2. Open it

Check JS console for this error:
```
Tag type 'undefined' was used, but not specified in `tagTypes`!
```",kamilmielnik,2024-04-16 12:54:57+00:00,['nemanjaglumac'],2024-04-29 20:26:23+00:00,2024-04-29 20:26:23+00:00,https://github.com/metabase/metabase/issues/41467,"[('Type:Bug', 'Product defects'), ('.Frontend', ''), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature')]",[],
2245950958,issue,closed,not_planned,[Epic] Upsell system,"- final visual structure with redlines for engineering [on this figma](https://www.figma.com/file/kdZZogH2tWBVwnG03N7XXc/Upsell-System?type=design&node-id=491-8759&mode=design&t=TmLLwF1Tg9l2aQaM-11)
- final flows and final copy for the pilot set of cases [on this other figma](https://www.figma.com/file/kdZZogH2tWBVwnG03N7XXc/Upsell-System?type=design&node-id=476-9367&mode=design&t=TmLLwF1Tg9l2aQaM-11) page
- the system guidelines [on this notion](https://www.notion.so/metabase/Upsell-System-Guidelines-WIP-72ce6f7402fb4c93a165e904dcf7a93c?pvs=4)

exact scope TBD",luizarakaki,2024-04-16 12:43:09+00:00,[],2024-04-17 19:33:43+00:00,2024-04-17 19:33:43+00:00,https://github.com/metabase/metabase/issues/41466,"[('Administration/', ''), ('.Epic', 'Feature Implementation or Project'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2059225462, 'issue_id': 2245950958, 'author': 'iethree', 'body': 'can we use this one https://github.com/metabase/metabase/issues/41116 ?', 'created_at': datetime.datetime(2024, 4, 16, 14, 25, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2062072625, 'issue_id': 2245950958, 'author': 'luizarakaki', 'body': 'Sure', 'created_at': datetime.datetime(2024, 4, 17, 19, 33, 39, tzinfo=datetime.timezone.utc)}]","iethree on (2024-04-16 14:25:01 UTC): can we use this one https://github.com/metabase/metabase/issues/41116 ?

luizarakaki (Issue Creator) on (2024-04-17 19:33:39 UTC): Sure

"
2245786276,issue,closed,completed,No results and waiting for results overlap,"### Describe the bug

When you get no results on question and then fire up a new query, we don't seem to clear the background before rendering new copy

### To Reproduce

1. Open Sample database - Invoices
2. Filter by Date Received to be in 2089
3. Get no results
4. Remove the filter
5. See the blocks overlapping
![image](https://github.com/metabase/metabase/assets/777800/88146fba-f29f-4dfb-858b-f9d85ebec18b)



### Expected behavior

No results block should be hidden

### Logs

_No response_

### Information about your Metabase installation

```JSON
last version
```


### Severity

Just looking funky

### Additional context

_No response_",mngr,2024-04-16 11:18:24+00:00,['nemanjaglumac'],2024-07-08 14:02:50+00:00,2024-07-08 12:05:18+00:00,https://github.com/metabase/metabase/issues/41464,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('Querying/', ''), ('.Team/Querying', '')]",[],
2245491833,issue,closed,not_planned,Dragging links in the expression suggestion footer does not work,"### Describe the bug

Dragging links in the expression suggestion footer does not work.

### To Reproduce

1. New Question → Sample dataset → Orders
2. Add custom column
3. Try and drag the `View all functions` link

It is not possible to drag the link


### Expected behavior

Links should be draggable 

### Demo


https://github.com/metabase/metabase/assets/1250185/b165ba9f-0685-4f95-bc8b-66083efc31a4



### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:124.0) Gecko/20100101 Firefox/124.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-04-15"",
      ""src_hash"": ""3a5d1db95a2b9ddb623a8daae7b0f1d07aae0c55"",
      ""tag"": ""v1.48.1-SNAPSHOT"",
      ""hash"": ""a45b5b2""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3

### Additional context

This issue was introduced in https://github.com/metabase/metabase/pull/41267",romeovs,2024-04-16 08:48:46+00:00,[],2024-07-09 11:48:13+00:00,2024-07-09 11:48:13+00:00,https://github.com/metabase/metabase/issues/41463,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]","[{'comment_id': 2202810523, 'issue_id': 2245491833, 'author': 'kamilmielnik', 'body': 'Still reproducible in `master` at 213b6d2c81fbcb4805fa2ac071de1c5e8ea431a1', 'created_at': datetime.datetime(2024, 7, 2, 11, 16, 20, tzinfo=datetime.timezone.utc)}]","kamilmielnik on (2024-07-02 11:16:20 UTC): Still reproducible in `master` at 213b6d2c81fbcb4805fa2ac071de1c5e8ea431a1

"
2245254964,issue,open,,Metrics for models,"**Is your feature request related to a problem? Please describe.**
As of now, you can attach custom metrics to source tables but not to models. When the metric is attached to the underlying table, it does not propagate to models created on top of the table. This is counterproductive since it requires one to choose between defining models (and all the nice things that come with it) and having custom query-time metrics (a must-have for a serious BI-tool). 

**Describe the solution you'd like**
1. A possibility to attach custom metrics to models. 
2. If 1 for some reason is difficult to achieve: make it so that metrics defined on tables are propagated to models defined on top of those tables. 

**Describe alternatives you've considered**
1. Stop using models and let users interact directly with source tables. 

**How important is this feature to you?**
The possibility of defining query-time metrics that are applied on top of whatever aggregation is chosen is key for us (and for any data/analytics-heavy company). 

**Additional context**
-
",filipvitez,2024-04-16 06:51:15+00:00,[],2025-02-04 20:30:30+00:00,,https://github.com/metabase/metabase/issues/41460,"[('Type:New Feature', ''), ('Querying/Models', 'aka Datasets'), ('Querying/Metrics', 'v2'), ('Semantic Model', '')]","[{'comment_id': 2094090036, 'issue_id': 2245254964, 'author': 'MattKWill', 'body': ""This is why my company doesn't use models - currently you have to choose between metrics and models, and metrics are much more useful. If we could have both that would be amazing."", 'created_at': datetime.datetime(2024, 5, 4, 9, 9, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2565627189, 'issue_id': 2245254964, 'author': 'brunobergher', 'body': ""Folks, is this now fully handled with the new version of metrics, which isn't bound to tables anymore?"", 'created_at': datetime.datetime(2024, 12, 30, 15, 30, 37, tzinfo=datetime.timezone.utc)}]","MattKWill on (2024-05-04 09:09:52 UTC): This is why my company doesn't use models - currently you have to choose between metrics and models, and metrics are much more useful. If we could have both that would be amazing.

brunobergher on (2024-12-30 15:30:37 UTC): Folks, is this now fully handled with the new version of metrics, which isn't bound to tables anymore?

"
2245033560,issue,closed,completed,SAML with Keycloak - Single Logout failing,"### Describe the bug

After setting up SAML with keycloak, I'm unable to log out of the SSO user even though I have been successfully logged out of Keycloak. I get a `500` error even though the SAML Response is valid. 

### To Reproduce

1. Go to top right cog
2. Click on Sign out
4. See error


### Expected behavior

Return to Login Page

### Logs

SAML logout failed.

### Information about your Metabase installation

```JSON
- Metabase version: 1.49.5
- Environment: Kubernetes
- DB: Postgres
```


### Severity

blocking deployment of metabase

### Additional context

Post Binding URL is set in keycloak to `<server_uri>/auth/sso/handle_slo`  


decoded SAML response:

```
<samlp:LogoutResponse
  xmlns:samlp=""urn:oasis:names:tc:SAML:2.0:protocol""
  xmlns=""urn:oasis:names:tc:SAML:2.0:assertion""
  xmlns:saml=""urn:oasis:names:tc:SAML:2.0:assertion""
  Destination=""http://localhost:3000/auth/sso/handle_slo""
  ID=""<redacted>""
  InResponseTo=""<redacted>""
  IssueInstant=""2024-04-16T00:55:19.257Z""
  Version=""2.0"">
  <saml:Issuer>http://localhost:8080/realms/abc123</saml:Issuer>
  <dsig:Signature
    xmlns:dsig=""http://www.w3.org/2000/09/xmldsig#"">
    <dsig:SignedInfo>
      <dsig:CanonicalizationMethod
        Algorithm=""http://www.w3.org/2001/10/xml-exc-c14n#"" />
      <dsig:SignatureMethod
        Algorithm=""http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"" />
      <dsig:Reference
        URI=""<redacted>"">
        <dsig:Transforms>
          <dsig:Transform
            Algorithm=""http://www.w3.org/2000/09/xmldsig#enveloped-signature"" />
          <dsig:Transform
            Algorithm=""http://www.w3.org/2001/10/xml-exc-c14n#"" />
        </dsig:Transforms>
        <dsig:DigestMethod
          Algorithm=""http://www.w3.org/2001/04/xmlenc#sha256"" />
        <dsig:DigestValue><redacted></dsig:DigestValue>
      </dsig:Reference>
    </dsig:SignedInfo>
    <dsig:SignatureValue><redacted></dsig:SignatureValue>
    <dsig:KeyInfo>
      <dsig:X509Data>
        <dsig:X509Certificate><redacted></dsig:X509Certificate>
      </dsig:X509Data>
    </dsig:KeyInfo>
  </dsig:Signature>
  <samlp:Status>
    <samlp:StatusCode
      Value=""urn:oasis:names:tc:SAML:2.0:status:Success"" />
  </samlp:Status>
</samlp:LogoutResponse>
```",mcmluck,2024-04-16 03:50:00+00:00,['escherize'],2024-05-02 23:48:50+00:00,2024-05-02 23:48:50+00:00,https://github.com/metabase/metabase/issues/41457,"[('Type:Documentation', '')]","[{'comment_id': 2073612458, 'issue_id': 2245033560, 'author': 'escherize', 'body': 'Hello @mcmluck. Thanks for the bug report. I\'ve been looking into your issue.\r\n\r\nCan you help me out with some more info?\r\n\r\n> I get a 500 error even though the SAML Response is valid.\r\n\r\nDo you get the 500 from Metabase or from Keycloak? Please provide the error messages associated with this request.\r\n\r\n---\r\n\r\nI was able to make things work with the following Keycloak settings:\r\n\r\n<img width=""543"" alt=""Screenshot 2024-04-23 at 4 55 00\u202fPM"" src=""https://github.com/metabase/metabase/assets/343288/4125160c-cd4f-446b-847c-01e7c48f7396"">\r\n\r\n<img width=""723"" alt=""Screenshot 2024-04-23 at 4 54 28\u202fPM"" src=""https://github.com/metabase/metabase/assets/343288/d74e550d-1311-4ae7-a897-d9b2800a7c50"">\r\n\r\n\r\nDo those match what you have?', 'created_at': datetime.datetime(2024, 4, 23, 22, 56, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2074417472, 'issue_id': 2245033560, 'author': 'paoliniluis', 'body': 'This is a pending in our docs, we need to document everything we’ve done with SLO cc @jeff-bruemmer', 'created_at': datetime.datetime(2024, 4, 24, 8, 44, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079598907, 'issue_id': 2245033560, 'author': 'paoliniluis', 'body': '@mcmluck can you check our comments above?', 'created_at': datetime.datetime(2024, 4, 26, 15, 17, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2091917941, 'issue_id': 2245033560, 'author': 'mcmluck', 'body': 'Sorry for the late reply, yeah I have the settings like your screenshots. Not exactly sure what the exact issue was, but I think it was my own fault in adding complexity into the routing. Keycloak was port forwarded to localhost while metabase was exposed to the internal network. Once both were exposed, the SAML worked fine 👍', 'created_at': datetime.datetime(2024, 5, 2, 23, 48, 50, tzinfo=datetime.timezone.utc)}]","escherize (Assginee) on (2024-04-23 22:56:20 UTC): Hello @mcmluck. Thanks for the bug report. I've been looking into your issue.

Can you help me out with some more info?


Do you get the 500 from Metabase or from Keycloak? Please provide the error messages associated with this request.

---

I was able to make things work with the following Keycloak settings:

<img width=""543"" alt=""Screenshot 2024-04-23 at 4 55 00 PM"" src=""https://github.com/metabase/metabase/assets/343288/4125160c-cd4f-446b-847c-01e7c48f7396"">

<img width=""723"" alt=""Screenshot 2024-04-23 at 4 54 28 PM"" src=""https://github.com/metabase/metabase/assets/343288/d74e550d-1311-4ae7-a897-d9b2800a7c50"">


Do those match what you have?

paoliniluis on (2024-04-24 08:44:44 UTC): This is a pending in our docs, we need to document everything we’ve done with SLO cc @jeff-bruemmer

paoliniluis on (2024-04-26 15:17:23 UTC): @mcmluck can you check our comments above?

mcmluck (Issue Creator) on (2024-05-02 23:48:50 UTC): Sorry for the late reply, yeah I have the settings like your screenshots. Not exactly sure what the exact issue was, but I think it was my own fault in adding complexity into the routing. Keycloak was port forwarded to localhost while metabase was exposed to the internal network. Once both were exposed, the SAML worked fine 👍

"
2244892201,issue,open,reopened,[Cache] Final polish (up next: Migrate CacheConfigApi to RTK),"```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/issues/42635
- [ ] https://github.com/metabase/metabase/issues/41119
- [x] Add e2e tests. This will be complicated, since our test of the old cache invalidation UI was disabled due to a bug
- [x] Try Ryan's suggestion to avoid the useVerticallyOverflows hook (https://app.graphite.dev/github/pr/metabase/metabase/39234/Basic-cache-admin-UI?utm_source=gt-slack-notif#comment-PRRC_kwDOAczgH85cTMwl)
- [ ] https://github.com/metabase/metabase/issues/41606
- [ ] Improve look of sidebar cache section error messages (left-aligned, in a smaller font, with an error icon)
```

Not currently planned:
* Explore Ryan's suggestion to use different forms for different strategies (https://app.graphite.dev/github/pr/metabase/metabase/39234/Basic-cache-admin-UI?utm_source=gt-slack-notif#comment-PRRC_kwDOAczgH85cTRiE)",rafpaf,2024-04-16 01:04:39+00:00,['rafpaf'],2024-08-08 12:49:20+00:00,,https://github.com/metabase/metabase/issues/41455,[],[],
2244582526,issue,open,,Consider canceling jdbc queries also on dbms side,"While working on https://github.com/metabase/metabase/issues/39018, I've found out that query in the reproduction is canceled on the FE. However, query is left to finish computation on the dbms side. I believe it should get terminated also there.

To reproduce, execute the query from the linked issue in the native editor and press abort. Use the queries from https://github.com/metabase/metabase/issues/39018#issuecomment-2057318649 to confirm that query is still running on the dbms.

Apart from the Redshift, also other dbms should be tested.",lbrdnk,2024-04-15 20:43:26+00:00,['lbrdnk'],2025-02-04 20:27:55+00:00,,https://github.com/metabase/metabase/issues/41448,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2244453654,issue,closed,completed,Tab query param not applied in embed,"### Describe the bug

Hello everyone 👋 
We've noticed that in the latest version (v0.49.5) the `URL?tab=tab_id` is not applied when embedding a dashboard in an iframe. 
In our case we have `https://URL?tab=2-tab-2` but the iframe renders the tab with id `1-tab-1`

### Screenshot:
<img width=""1517"" alt=""Screenshot 2024-04-15 at 22 18 35"" src=""https://github.com/metabase/metabase/assets/24255041/712f5726-e333-4f2f-b59a-bd698fa42469"">


### To Reproduce

1. Create a dashboard with more than one tabs
2. Enable embedding for that dashboard
3. Create an embedding URL and defined a tab other than the first in the url of the embedded dashboard by appending ?tab=""TAB_ID"" in the url
4. Expect the embed to open the tab with id ""TAB_ID:
5. The embed loads the default tab (first one)


### Expected behavior

It should render the url defined tab like it did in previous versions

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Browser: Google Chrome Version 123.0.6312.123 (Official Build) (arm64)
- OS: Macos 14.4.1 Sonoma
- DB: PostgreSQL
- Metabase instance: self-hosted but happens on the cloud instance too
- Metabase version: `v0.49.5`
```


### Severity

High - blocks multiple users

### Additional context

_No response_",tboulis,2024-04-15 19:30:02+00:00,['npretto'],2024-04-16 10:23:21+00:00,2024-04-16 09:28:49+00:00,https://github.com/metabase/metabase/issues/41440,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('Embedding/Static', 'Static embedding, previously known as signed embedding'), ('.Team/Embedding', '')]","[{'comment_id': 2057655154, 'issue_id': 2244453654, 'author': 'saadbahir', 'body': 'I am encountering the same problem\r\n\r\nSeems like there are a lot of issues in `v49`', 'created_at': datetime.datetime(2024, 4, 15, 19, 31, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2057828801, 'issue_id': 2244453654, 'author': 'saadbahir', 'body': 'Hello @kulyk\r\n\r\nSorry to ping you like this but I wondered whether your [PR](https://github.com/metabase/metabase/commit/7efd8d3627171fa1805a543d4f8e36873a38296a) right here may have introduced this regression', 'created_at': datetime.datetime(2024, 4, 15, 21, 19, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2057928426, 'issue_id': 2244453654, 'author': 'saadbahir', 'body': '@deniskaber thank you for triaging this ticket!\r\n\r\nIf you have any suggestion that we can use to ""force"" the tab selection when we open the embed (using some sdk or post message), I would welcome it very much!', 'created_at': datetime.datetime(2024, 4, 15, 22, 36, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2058649197, 'issue_id': 2244453654, 'author': 'npretto', 'body': 'This has been fixed by https://github.com/metabase/metabase/pull/41399, a release should be made soon', 'created_at': datetime.datetime(2024, 4, 16, 9, 28, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2058655589, 'issue_id': 2244453654, 'author': 'npretto', 'body': ""To add some context, I think this is what's going on:\r\nhttps://github.com/metabase/metabase/pull/41399 doesn't render `<DashboardTabs>` unless we have tabs, `<DashboardTabs` calls `useDashboardTabs` which dispatches `initTabs` before we have the tabs loaded, causing the code to think we're selecting an invalid tab on the reducer and therefore setting the selected tab to null https://github.com/metabase/metabase/blob/5a7360d23b9c4048f1b99f86aa8daa5848367467/frontend/src/metabase/dashboard/actions/tabs.ts#L569-L578"", 'created_at': datetime.datetime(2024, 4, 16, 9, 32, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2058701438, 'issue_id': 2244453654, 'author': 'saadbahir', 'body': 'Thank you @npretto for your quick feedback!\r\n\r\nThis is a vital fix for us as we use Metabase Embedding at scale and this is currently breaking a lot of our workflows\r\n\r\nDo you please have any timeline on the release? are we talking hours or days?\r\nThank you for your help!', 'created_at': datetime.datetime(2024, 4, 16, 9, 56, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2058751519, 'issue_id': 2244453654, 'author': 'Tony-metabase', 'body': '@saadbahir we should be releasing 49.6 today so expect a couple of more hours for it to be available', 'created_at': datetime.datetime(2024, 4, 16, 10, 23, 20, tzinfo=datetime.timezone.utc)}]","saadbahir on (2024-04-15 19:31:01 UTC): I am encountering the same problem

Seems like there are a lot of issues in `v49`

saadbahir on (2024-04-15 21:19:55 UTC): Hello @kulyk

Sorry to ping you like this but I wondered whether your [PR](https://github.com/metabase/metabase/commit/7efd8d3627171fa1805a543d4f8e36873a38296a) right here may have introduced this regression

saadbahir on (2024-04-15 22:36:58 UTC): @deniskaber thank you for triaging this ticket!

If you have any suggestion that we can use to ""force"" the tab selection when we open the embed (using some sdk or post message), I would welcome it very much!

npretto (Assginee) on (2024-04-16 09:28:50 UTC): This has been fixed by https://github.com/metabase/metabase/pull/41399, a release should be made soon

npretto (Assginee) on (2024-04-16 09:32:05 UTC): To add some context, I think this is what's going on:
https://github.com/metabase/metabase/pull/41399 doesn't render `<DashboardTabs>` unless we have tabs, `<DashboardTabs` calls `useDashboardTabs` which dispatches `initTabs` before we have the tabs loaded, causing the code to think we're selecting an invalid tab on the reducer and therefore setting the selected tab to null https://github.com/metabase/metabase/blob/5a7360d23b9c4048f1b99f86aa8daa5848367467/frontend/src/metabase/dashboard/actions/tabs.ts#L569-L578

saadbahir on (2024-04-16 09:56:16 UTC): Thank you @npretto for your quick feedback!

This is a vital fix for us as we use Metabase Embedding at scale and this is currently breaking a lot of our workflows

Do you please have any timeline on the release? are we talking hours or days?
Thank you for your help!

Tony-metabase on (2024-04-16 10:23:20 UTC): @saadbahir we should be releasing 49.6 today so expect a couple of more hours for it to be available

"
2244447559,issue,closed,not_planned,Regression in 0.49.4:  Cannot Connect to RDS Postgres through SSH tunnel,"### Describe the bug

I upgraded from `0.49.3` to `0.49.4` and I got this error when trying to connecting my Postgres Database using an SSH tunnel

```
DefaultConnectFuture[EC2-INSTANCE-URI]: Failed (UnresolvedAddressException) to execute: null
```

After rolling back to `0.49.3` it worked again


### To Reproduce

1. Go to Admin Settings
2. Click on Database
3. Connected Postgres using SSH tunnel
4. See error


### Expected behavior

_No response_

### Logs

DefaultConnectFuture[EC2-INSTANCE-URI]: Failed (UnresolvedAddressException) to execute: null

### Information about your Metabase installation

```JSON
- Metabase version: `0.49.4`
- Database: Postgres (with SSH tunnel)
- Hosting Environment: Kubernetes
```


### Severity

P1

### Additional context

_No response_",saadbahir,2024-04-15 19:26:13+00:00,[],2024-11-19 17:41:23+00:00,2024-11-19 17:41:22+00:00,https://github.com/metabase/metabase/issues/41439,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Database/Postgres', None), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Drivers', '')]","[{'comment_id': 2057698984, 'issue_id': 2244447559, 'author': 'bshepherdson', 'body': ""That exception indicates that the address of the Postgres database could not be resolved. Nothing related to DB connections changed with 49.3. Without any further logs, there's no more I can say.\r\n\r\nCan you include the full server log? There may be something illuminating in it."", 'created_at': datetime.datetime(2024, 4, 15, 19, 57, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2057724464, 'issue_id': 2244447559, 'author': 'saadbahir', 'body': '> That exception indicates that the address of the Postgres database could not be resolved. Nothing related to DB connections changed with 49.3. Without any further logs, there\'s no more I can say.\r\n> \r\n> Can you include the full server log? There may be something illuminating in it.\r\n\r\nThank you @bshepherdson for your quick answer!\r\n\r\nApologies for the mistake! It\'s actually 49.4  \r\n\r\nI wil fix the original ticket\r\n\r\nHere are the full logs in the meantime\r\n\r\n```\r\n2024-04-15 20:12:28,245 ERROR driver.util :: Failed to connect to Database\r\norg.apache.sshd.common.SshException: DefaultConnectFuture[user@ecXXXXXXXXXXXXX.compute-1.amazonaws.com:22]: Failed (UnresolvedAddressException) to execute: null\r\n\tat org.apache.sshd.common.future.AbstractSshFuture.lambda$verifyResult$2(AbstractSshFuture.java:146)\r\n\tat org.apache.sshd.common.future.AbstractSshFuture.formatExceptionMessage(AbstractSshFuture.java:206)\r\n\tat org.apache.sshd.common.future.AbstractSshFuture.verifyResult(AbstractSshFuture.java:145)\r\n\tat org.apache.sshd.client.future.DefaultConnectFuture.verify(DefaultConnectFuture.java:55)\r\n\tat org.apache.sshd.client.future.DefaultConnectFuture.verify(DefaultConnectFuture.java:36)\r\n\tat metabase.util.ssh$start_ssh_tunnel_BANG_.invokeStatic(ssh.clj:81)\r\n\tat metabase.util.ssh$start_ssh_tunnel_BANG_.invoke(ssh.clj:73)\r\n\tat metabase.util.ssh$include_ssh_tunnel_BANG_.invokeStatic(ssh.clj:115)\r\n\tat metabase.util.ssh$include_ssh_tunnel_BANG_.invoke(ssh.clj:109)\r\n\tat metabase.util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:158)\r\n\tat metabase.util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154)\r\n\tat metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invokeStatic(connection.clj:309)\r\n\tat metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invoke(connection.clj:305)\r\n\tat metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invokeStatic(connection.clj:334)\r\n\tat metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invoke(connection.clj:330)\r\n\tat metabase.driver.sql_jdbc$fn__106676.invokeStatic(sql_jdbc.clj:49)\r\n\tat metabase.driver.sql_jdbc$fn__106676.invoke(sql_jdbc.clj:47)\r\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:234)\r\n\tat metabase.driver.util$can_connect_with_details_QMARK_$fn__59933.invoke(util.clj:148)\r\n\tat clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047)\r\n\tat clojure.lang.AFn.call(AFn.java:18)\r\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\r\n\tat java.base/java.lang.Thread.run(Unknown Source)\r\nCaused by: java.nio.channels.UnresolvedAddressException\r\n\tat java.base/sun.nio.ch.Net.checkAddress(Unknown Source)\r\n\tat java.base/sun.nio.ch.UnixAsynchronousSocketChannelImpl.implConnect(Unknown Source)\r\n\tat java.base/sun.nio.ch.AsynchronousSocketChannelImpl.connect(Unknown Source)\r\n\tat org.apache.sshd.common.io.nio2.Nio2Connector.connect(Nio2Connector.java:84)\r\n\tat org.apache.sshd.client.SshClient.doConnect(SshClient.java:665)\r\n\tat org.apache.sshd.client.SshClient.doConnect(SshClient.java:648)\r\n\tat org.apache.sshd.client.SshClient.connect(SshClient.java:552)\r\n\tat org.apache.sshd.client.SshClient.connect(SshClient.java:544)\r\n\tat org.apache.sshd.client.session.ClientSessionCreator.connect(ClientSessionCreator.java:74)\r\n\tat org.apache.sshd.client.session.ClientSessionCreator.connect(ClientSessionCreator.java:57)\r\n\tat metabase.util.ssh$start_ssh_tunnel_BANG_.invokeStatic(ssh.clj:80)\r\n\t... 19 more\r\n2024-04-15 20:12:28,251 ERROR api.database :: Cannot connect to Database\r\nclojure.lang.ExceptionInfo: DefaultConnectFuture[user@ecXXXXXXXXXXXXX.compute-1.amazonaws.com:22]: Failed (UnresolvedAddressException) to execute: null {:message ""DefaultConnectFuture[user@ecXXXXXXXXXXXXX.compute-1.amazonaws.com:22]: Failed (UnresolvedAddressException) to execute: null""}\r\n\tat metabase.driver.util$can_connect_with_details_QMARK_.invokeStatic(util.clj:165)\r\n\tat metabase.driver.util$can_connect_with_details_QMARK_.doInvoke(util.clj:136)\r\n\r\n```\r\n\r\nThe exact same connection worked fine between Metabase 47 until 49.3', 'created_at': datetime.datetime(2024, 4, 15, 20, 14, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2059121253, 'issue_id': 2244447559, 'author': 'likeshumidity', 'body': 'Are you using a hostname or IP address for the SSH host? @saadbahir', 'created_at': datetime.datetime(2024, 4, 16, 13, 39, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2060036479, 'issue_id': 2244447559, 'author': 'saadbahir', 'body': '> Are you using a hostname or IP address for the SSH host? @saadbahir\r\n\r\nI am using a Hostname', 'created_at': datetime.datetime(2024, 4, 16, 22, 50, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2060043343, 'issue_id': 2244447559, 'author': 'saadbahir', 'body': ""@likeshumidity I would like to note that the ssh connection works perfectly fine on the server that hosts our metabase instance\r\nOtherwise version 49.3 wouldn't work either\r\n\r\nI tried to find which commit might have introduced the regression but didn't find any success thus far ..."", 'created_at': datetime.datetime(2024, 4, 16, 22, 59, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2322503881, 'issue_id': 2244447559, 'author': 'paoliniluis', 'body': '@saadbahir does this keeps happening?', 'created_at': datetime.datetime(2024, 8, 30, 22, 34, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2486355585, 'issue_id': 2244447559, 'author': 'paoliniluis', 'body': 'Closing due to non response', 'created_at': datetime.datetime(2024, 11, 19, 17, 41, 22, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2024-04-15 19:57:45 UTC): That exception indicates that the address of the Postgres database could not be resolved. Nothing related to DB connections changed with 49.3. Without any further logs, there's no more I can say.

Can you include the full server log? There may be something illuminating in it.

saadbahir (Issue Creator) on (2024-04-15 20:14:14 UTC): Thank you @bshepherdson for your quick answer!

Apologies for the mistake! It's actually 49.4  

I wil fix the original ticket

Here are the full logs in the meantime

```
2024-04-15 20:12:28,245 ERROR driver.util :: Failed to connect to Database
org.apache.sshd.common.SshException: DefaultConnectFuture[user@ecXXXXXXXXXXXXX.compute-1.amazonaws.com:22]: Failed (UnresolvedAddressException) to execute: null
	at org.apache.sshd.common.future.AbstractSshFuture.lambda$verifyResult$2(AbstractSshFuture.java:146)
	at org.apache.sshd.common.future.AbstractSshFuture.formatExceptionMessage(AbstractSshFuture.java:206)
	at org.apache.sshd.common.future.AbstractSshFuture.verifyResult(AbstractSshFuture.java:145)
	at org.apache.sshd.client.future.DefaultConnectFuture.verify(DefaultConnectFuture.java:55)
	at org.apache.sshd.client.future.DefaultConnectFuture.verify(DefaultConnectFuture.java:36)
	at metabase.util.ssh$start_ssh_tunnel_BANG_.invokeStatic(ssh.clj:81)
	at metabase.util.ssh$start_ssh_tunnel_BANG_.invoke(ssh.clj:73)
	at metabase.util.ssh$include_ssh_tunnel_BANG_.invokeStatic(ssh.clj:115)
	at metabase.util.ssh$include_ssh_tunnel_BANG_.invoke(ssh.clj:109)
	at metabase.util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:158)
	at metabase.util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154)
	at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invokeStatic(connection.clj:309)
	at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invoke(connection.clj:305)
	at metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invokeStatic(connection.clj:334)
	at metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invoke(connection.clj:330)
	at metabase.driver.sql_jdbc$fn__106676.invokeStatic(sql_jdbc.clj:49)
	at metabase.driver.sql_jdbc$fn__106676.invoke(sql_jdbc.clj:47)
	at clojure.lang.MultiFn.invoke(MultiFn.java:234)
	at metabase.driver.util$can_connect_with_details_QMARK_$fn__59933.invoke(util.clj:148)
	at clojure.core$binding_conveyor_fn$fn__5823.invoke(core.clj:2047)
	at clojure.lang.AFn.call(AFn.java:18)
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.nio.channels.UnresolvedAddressException
	at java.base/sun.nio.ch.Net.checkAddress(Unknown Source)
	at java.base/sun.nio.ch.UnixAsynchronousSocketChannelImpl.implConnect(Unknown Source)
	at java.base/sun.nio.ch.AsynchronousSocketChannelImpl.connect(Unknown Source)
	at org.apache.sshd.common.io.nio2.Nio2Connector.connect(Nio2Connector.java:84)
	at org.apache.sshd.client.SshClient.doConnect(SshClient.java:665)
	at org.apache.sshd.client.SshClient.doConnect(SshClient.java:648)
	at org.apache.sshd.client.SshClient.connect(SshClient.java:552)
	at org.apache.sshd.client.SshClient.connect(SshClient.java:544)
	at org.apache.sshd.client.session.ClientSessionCreator.connect(ClientSessionCreator.java:74)
	at org.apache.sshd.client.session.ClientSessionCreator.connect(ClientSessionCreator.java:57)
	at metabase.util.ssh$start_ssh_tunnel_BANG_.invokeStatic(ssh.clj:80)
	... 19 more
2024-04-15 20:12:28,251 ERROR api.database :: Cannot connect to Database
clojure.lang.ExceptionInfo: DefaultConnectFuture[user@ecXXXXXXXXXXXXX.compute-1.amazonaws.com:22]: Failed (UnresolvedAddressException) to execute: null {:message ""DefaultConnectFuture[user@ecXXXXXXXXXXXXX.compute-1.amazonaws.com:22]: Failed (UnresolvedAddressException) to execute: null""}
	at metabase.driver.util$can_connect_with_details_QMARK_.invokeStatic(util.clj:165)
	at metabase.driver.util$can_connect_with_details_QMARK_.doInvoke(util.clj:136)

```

The exact same connection worked fine between Metabase 47 until 49.3

likeshumidity on (2024-04-16 13:39:47 UTC): Are you using a hostname or IP address for the SSH host? @saadbahir

saadbahir (Issue Creator) on (2024-04-16 22:50:43 UTC): I am using a Hostname

saadbahir (Issue Creator) on (2024-04-16 22:59:05 UTC): @likeshumidity I would like to note that the ssh connection works perfectly fine on the server that hosts our metabase instance
Otherwise version 49.3 wouldn't work either

I tried to find which commit might have introduced the regression but didn't find any success thus far ...

paoliniluis on (2024-08-30 22:34:35 UTC): @saadbahir does this keeps happening?

paoliniluis on (2024-11-19 17:41:22 UTC): Closing due to non response

"
2244350433,issue,closed,completed,[dc.js migration] tool-tip and axis column names should respect BE `display_name` values,"**Master**
![image](https://github.com/metabase/metabase/assets/22608765/0d800ca2-b85a-4b83-828a-c062701e386c)

**ECharts**
![image](https://github.com/metabase/metabase/assets/22608765/3dde93df-3f80-406b-992d-19b0bfb909df)


---
**Query**
![image](https://github.com/metabase/metabase/assets/22608765/35f4074c-24e7-46fb-9ef6-63c39523a37d)
",JesseSDevaney,2024-04-15 18:32:24+00:00,['EmmadUsmani'],2024-04-16 18:28:11+00:00,2024-04-16 18:28:11+00:00,https://github.com/metabase/metabase/issues/41437,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]","[{'comment_id': 2059696822, 'issue_id': 2244350433, 'author': 'EmmadUsmani', 'body': '<img width=""940"" alt=""Screenshot 2024-04-16 at 11 27 38 AM"" src=""https://github.com/metabase/metabase/assets/37751258/562d4ca7-5015-48c5-ab1f-61e27805b1c7"">\r\n\r\nThis was fixed by https://github.com/metabase/metabase/pull/41450', 'created_at': datetime.datetime(2024, 4, 16, 18, 28, 8, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Assginee) on (2024-04-16 18:28:08 UTC): <img width=""940"" alt=""Screenshot 2024-04-16 at 11 27 38 AM"" src=""https://github.com/metabase/metabase/assets/37751258/562d4ca7-5015-48c5-ab1f-61e27805b1c7"">

This was fixed by https://github.com/metabase/metabase/pull/41450

"
2244276308,issue,closed,not_planned,[Cache] Milestone 7: e2e testing (we might skip this),,rafpaf,2024-04-15 17:47:28+00:00,['rafpaf'],2024-04-15 21:32:05+00:00,2024-04-15 21:32:05+00:00,https://github.com/metabase/metabase/issues/41436,[],[],
2244229990,issue,closed,completed,[Cache] Schedule strategy follow up,,rafpaf,2024-04-15 17:20:54+00:00,[],2024-04-18 16:03:03+00:00,2024-04-18 16:03:03+00:00,https://github.com/metabase/metabase/issues/41434,[],[],
2244215566,issue,closed,completed,Add InvalidateNow button,"```[tasklist]
### Tasks
```
",rafpaf,2024-04-15 17:13:30+00:00,[],2024-04-18 18:26:59+00:00,2024-04-18 18:26:58+00:00,https://github.com/metabase/metabase/issues/41433,[],[],
2244204464,issue,closed,not_planned,Schedule strategy,,rafpaf,2024-04-15 17:06:17+00:00,[],2024-04-15 17:07:59+00:00,2024-04-15 17:07:59+00:00,https://github.com/metabase/metabase/issues/41431,[],[],
2244196462,issue,closed,not_planned,[Cache] Milestone 5: Collections,,rafpaf,2024-04-15 17:01:33+00:00,['rafpaf'],2024-04-15 21:32:08+00:00,2024-04-15 21:32:08+00:00,https://github.com/metabase/metabase/issues/41430,[],[],
2244196293,issue,closed,not_planned,[Cache] Milestone 4: Questions,,rafpaf,2024-04-15 17:01:27+00:00,['rafpaf'],2024-04-15 21:32:12+00:00,2024-04-15 21:32:12+00:00,https://github.com/metabase/metabase/issues/41429,[],[],
2244196167,issue,closed,not_planned,[Cache] Milestone 6: Query strategy (we might skip this),,rafpaf,2024-04-15 17:01:22+00:00,['rafpaf'],2024-04-15 21:32:01+00:00,2024-04-15 21:32:01+00:00,https://github.com/metabase/metabase/issues/41428,[],[],
2244196027,issue,closed,completed,[Cache] Milestone 3: Schedule strategy,"```[tasklist]
- [ ] https://github.com/metabase/metabase/issues/41292
- [ ] https://github.com/metabase/metabase/issues/41434
```
",rafpaf,2024-04-15 17:01:17+00:00,['rafpaf'],2024-04-18 16:04:31+00:00,2024-04-18 16:04:31+00:00,https://github.com/metabase/metabase/issues/41427,[],[],
2244195885,issue,closed,completed,"[Cache] Milestone 2: Follow-up work including ""Invalidate now""","```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/issues/41433
- [x] Measure minimum query duration in seconds (#40970)
- [x] Change default minimum query duration to 1 second (not 60 seconds) (#40970)
- [x] Move Invalidate now button to the top of the form along with the name of the database (#40972)
- [x] Create DelayedSpinner component (#41103)
- [x] Rename TTL to Multiplier
- [x] [not planned] Tweak: remove value from inputs (and just show placeholder) if it matches the default (and ensure form dirty status is correct)
- [x] [won't fix] Ensure that form fields can be tabbed into even when behind form buttons div (I have this in a branch but I'm not sure it's worth pursuing)
```
",rafpaf,2024-04-15 17:01:12+00:00,['rafpaf'],2024-04-18 16:04:40+00:00,2024-04-18 16:04:40+00:00,https://github.com/metabase/metabase/issues/41426,[],[],
2244195712,issue,closed,completed,[Cache] Milestone 1: Basic cache invalidation strategies for databases,"```[tasklist]
- [x] Add Performance tab (https://github.com/metabase/metabase/pull/39234)
- [x] Add data caching settings tab (https://github.com/metabase/metabase/pull/39234)
- [x] Add three-panel configuration editor (https://github.com/metabase/metabase/pull/39234)
- [x] Add don't cache (with no connection to backend (https://github.com/metabase/metabase/pull/39234)
- [x] Add TTL (with no connection to backend) (https://github.com/metabase/metabase/pull/39234)
- [x] Add don't cache (with real connection to backend) https://github.com/metabase/metabase/pull/39234
- [x] Add TTL (with real connection to backend) https://github.com/metabase/metabase/pull/39234
- [x] Split out enterprise-specific code #39234
- [x] Add configuration option for cache strategy: duration #39234
- [x] Add error messages to form (#39234)
- [x] Add confirmation modal before resetting databases to default (#39234)
- [x] Add confirmation modal before leaving page (#39234)
- [x] Remove superseded items from cache settings page (#39234)
- [x] Add basic unit tests (#39234)
- [x] Ensure ""reset all"" button shows different loading states (#39234)
- [x] Add background hover color to ""reset all"" button (#39234)
- [x] Ensure ""Save changes"" button says ""Save changes"" after form is edited (#39234)
- [x] Ensure ""Reset all to default"" button says ""Reset all to default"" when form is edited (#39234)
- [x] Add 'example' link with tooltip (#39234)
- [x] To say that the root strategy is ""nocache, delete it (#39234)
- [x] Use 'Reset all database caching policies to the default?' in the reset button confirmation modal (#39234)
- [x] Split StrategyEditorForDatabases into smaller components and hooks (#39234)
- [x] Split out enterprise code thoroughly
- [x] Tweak: reset button from 'Saved' to 'Save changes' when the user edits the form
```",rafpaf,2024-04-15 17:01:05+00:00,['rafpaf'],2024-04-15 17:19:46+00:00,2024-04-15 17:03:05+00:00,https://github.com/metabase/metabase/issues/41425,[],[],
2244171186,issue,closed,completed,Add Schedule strategy to Admin > Performance ,,rafpaf,2024-04-15 16:50:51+00:00,[],2024-04-15 16:55:36+00:00,2024-04-15 16:55:36+00:00,https://github.com/metabase/metabase/issues/41424,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2243860425,issue,open,,Moving a column while editing model Metadata gets you back to the beginning of the table,"### Describe the bug

Moving a column while editing model Metadata can be very frustrating. It gets you to the beginning of the table every time you move a column, and it doesn't let you drag it to the beginning as well.

### To Reproduce

1. Create a model with more than 10 columns
2. Move a column and see the error

https://github.com/metabase/metabase/assets/132273646/1f3ea101-d7f7-460a-8fae-26ad3c508fe7




### Expected behavior

Should maintain the current view and not bring you back to the beginning each time.

### Logs

_No response_

### Information about your Metabase installation

```JSON
- 49.3
```


### Severity

P3

### Additional context

_No response_",ignacio-mb,2024-04-15 14:39:49+00:00,[],2025-02-04 20:31:08+00:00,,https://github.com/metabase/metabase/issues/41419,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/Models', 'aka Datasets'), ('.Team/Querying', ''), ('.Possibly Already Fixed', 'This might already be fixed, e.g. because we fixed something similar to it recently. TODO-list'), ('Semantic Model', ''), ('Semantic Model/Models', '')]","[{'comment_id': 2206487116, 'issue_id': 2243860425, 'author': 'ranquild', 'body': 'Repro https://www.loom.com/share/4217f2c254754a68ad99634bc1b6b64f', 'created_at': datetime.datetime(2024, 7, 3, 15, 12, 8, tzinfo=datetime.timezone.utc)}]","ranquild on (2024-07-03 15:12:08 UTC): Repro https://www.loom.com/share/4217f2c254754a68ad99634bc1b6b64f

"
2243852646,issue,open,,Ability to change name for Link Cards,"**Is your feature request related to a problem? Please describe.**
I would like to add a Link Card but change the name of button

<img width=""1202"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/5ad95243-0524-49d0-8584-cafcb6cff98d"">


**Describe the solution you'd like**
Ability to change the name of a given Linked Card 

**Describe alternatives you've considered**
Using Markdowns but Linked Cards are more neat",Tony-metabase,2024-04-15 14:36:27+00:00,[],2024-04-15 14:36:34+00:00,,https://github.com/metabase/metabase/issues/41418,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('.Frontend', '')]",[],
2243849068,issue,closed,completed,Move Search to it's own action,"```[tasklist]
### Tasks
- [x] seem to have contextual state in the search list? (why?)
- [x] What to do with no results (make it clickable and go to search page?)
```
",npfitz,2024-04-15 14:34:51+00:00,['npfitz'],2024-04-25 20:58:09+00:00,2024-04-25 20:58:08+00:00,https://github.com/metabase/metabase/issues/41417,[],"[{'comment_id': 2078165172, 'issue_id': 2243849068, 'author': 'npfitz', 'body': ""Closing issue as a won't do. Team is currently exploring alternatives"", 'created_at': datetime.datetime(2024, 4, 25, 20, 58, 9, tzinfo=datetime.timezone.utc)}]","npfitz (Issue Creator) on (2024-04-25 20:58:09 UTC): Closing issue as a won't do. Team is currently exploring alternatives

"
2243790497,issue,open,,Ability to change font color for chart exports,"**Is your feature request related to a problem? Please describe.**
You might have dark-themed company colors, and all your presentations are dark. Currently, you can't change text color at an export level.

**Describe the solution you'd like**
Ability to customize text color for exports or at an instance level for exports.

**Describe alternatives you've considered**
Reverse proxy

**How important is this feature to you?**
Requested by a customer, internal ticket: [26500](https://metabase.zendesk.com/agent/tickets/26500)

**Additional context**
Goes hand in hand with https://github.com/metabase/metabase/issues/41413 for more customizations for exports
",ignacio-mb,2024-04-15 14:09:10+00:00,[],2024-04-15 14:09:11+00:00,,https://github.com/metabase/metabase/issues/41414,"[('Visualization/', ''), ('Type:New Feature', ''), ('Reporting/Export', '')]",[],
2243762157,issue,open,,Transparent background for chart export  ,"**Is your feature request related to a problem? Please describe.**
You might want to change chart background to match it to your organization's theme.

**Describe the solution you'd like**
An option to download/export charts with a transparent background.

**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
Requested by a customer, internal ticket: [26500](https://metabase.zendesk.com/agent/tickets/26500)

**Additional context**
N/A
",ignacio-mb,2024-04-15 13:57:02+00:00,[],2024-04-15 13:57:03+00:00,,https://github.com/metabase/metabase/issues/41413,"[('Visualization/', ''), ('Type:New Feature', ''), ('Reporting/Export', '')]",[],
2243473595,issue,closed,completed,Handle metrics in search,,kamilmielnik,2024-04-15 11:51:51+00:00,[],2024-04-15 12:02:57+00:00,2024-04-15 12:02:57+00:00,https://github.com/metabase/metabase/issues/41409,[],[],
2243332055,issue,closed,completed,Inconsistent styling in aggregation dropdown,"### Describe the bug

""Custom Expression"" button in aggregations dropdown is inconsistent with filters.



### To Reproduce

1. New Question → Sample data set → Orders
2. Add an aggregation 
3. Scroll down to the Custom Expression item

As you can see it is missing a border and a chevron like the filter does.


![image](https://github.com/metabase/metabase/assets/1250185/a091c311-2b92-43cd-b1e3-d815a6f2808e)
<img width=""463"" alt=""Screenshot 2024-04-15 at 12 42 09"" src=""https://github.com/metabase/metabase/assets/1250185/39d6170a-9dbf-4f95-9bd1-cd25405ab726"">


### Expected behavior

The styles should be consistent

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:124.0) Gecko/20100101 Firefox/124.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-04-11"",
      ""src_hash"": ""6c6fb78ac9f693ca14ae80f38f0bf9b3890c2772"",
      ""tag"": ""v1.48.1-SNAPSHOT"",
      ""hash"": ""9797bb1""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-04-15 10:42:54+00:00,['romeovs'],2024-04-23 15:33:35+00:00,2024-04-23 15:33:35+00:00,https://github.com/metabase/metabase/issues/41403,"[('Type:Bug', 'Product defects'), ('.Frontend', '')]",[],
2243279668,issue,open,,[ParseSQL] Prevent cards from saving (both create and update) if they have a destructive query,,tsmacdonald,2024-04-15 10:19:46+00:00,[],2024-04-22 15:22:52+00:00,,https://github.com/metabase/metabase/issues/41401,[],"[{'comment_id': 2069870623, 'issue_id': 2243279668, 'author': 'tsmacdonald', 'body': 'This is out of scope for the BEC team; removing it from our epic.', 'created_at': datetime.datetime(2024, 4, 22, 15, 22, 51, tzinfo=datetime.timezone.utc)}]","tsmacdonald (Issue Creator) on (2024-04-22 15:22:51 UTC): This is out of scope for the BEC team; removing it from our epic.

"
2243277242,issue,closed,completed,[ParseSQL] Get stale usages from MBQL queries as well; generate appropriate QueryFields,,tsmacdonald,2024-04-15 10:18:33+00:00,['piranha'],2024-04-30 09:23:55+00:00,2024-04-24 13:39:00+00:00,https://github.com/metabase/metabase/issues/41400,"[('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]",[],
2242923583,issue,closed,completed,Add a logic to reset mapping if new operator cannot be applied to the mapped column,"https://github.com/metabase/metabase/blob/fd6fab28caa8323f3002cc158265d7326c933a4d/frontend/src/metabase-lib/v1/parameters/utils/filters.js#L78
This is for a case when we change operator when we need to remove mapping",uladzimirdev,2024-04-15 07:31:06+00:00,['uladzimirdev'],2024-04-19 17:01:02+00:00,2024-04-19 17:01:02+00:00,https://github.com/metabase/metabase/issues/41397,[],[],
2242923233,issue,closed,completed,Allow changing parameter type and operator from the sidebar,Allow user to change parameter type and operator for existing parameters via parameters sidebar,uladzimirdev,2024-04-15 07:30:57+00:00,['uladzimirdev'],2024-04-17 12:23:34+00:00,2024-04-17 12:23:34+00:00,https://github.com/metabase/metabase/issues/41396,[],[],
2242651483,issue,closed,completed,Clicking in a dashboard filter too easily gets captured as an accidental drag which edits the dashboard,"### Describe the bug

When using a dashboard, if you click into a filter and hold the mouse button for fractionally longer than you should which ends up as a mouse drag, then the filter gets dragged as though you were editing the dashboard. In most instances this drag could be a single pixel and is completely unintentional but it puts the dashboard into the 'editing' mode which then surprises you later on when you try to leave or change something and it asks you to save, but you have no idea what you just did.

The 'drag' tolerance is way too sensitive, it should have a threshold of say 10 pixels. On top of this, even if you did drag but then end up dropping it back into its original location, in other words nothing has changed, then it should detect this and not trigger edit mode.

Compare this to normal inputs anywhere else in any other app. eg a click and drag in the metabase search box doesn't have any unexpected side effects.

### To Reproduce

1. Go to any dashboard with a filter where you have edit rights
2. Click on a filter while moving the mouse slightly
3. Noticed that metabase has unintentionally toggled into the dashboard edit mode


### Expected behavior

1) It should ignore drags under a certain threshold
2) and it should also not toggle editing, when a drag resulted in no change

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.210-201.852.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Australia/Melbourne""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mysql"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.7""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-03-21"",
      ""tag"": ""v1.49.1"",
      ""hash"": ""54ef5e9""
    },
    ""settings"": {
      ""report-timezone"": ""Australia/Sydney""
    }
  }
}
```


### Severity

It's annoying

### Additional context

_No response_",brendanheywood,2024-04-15 04:02:17+00:00,[],2024-04-15 08:27:38+00:00,2024-04-15 08:27:26+00:00,https://github.com/metabase/metabase/issues/41394,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2054958146, 'issue_id': 2242651483, 'author': 'perivamsi', 'body': '@brendanheywood thank you for reporting this. could you please add a video for this? I am not able to repro this based on the text description and a video of the bug would be helpful.', 'created_at': datetime.datetime(2024, 4, 15, 4, 20, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2055038389, 'issue_id': 2242651483, 'author': 'brendanheywood', 'body': ""thanks @perivamsi here is a gif, sorry the cursor isn't visible, but the first time I click in the input I am very careful to just click, the second click is a 'typical'click where the mouse is moving like 2 or 3 pixels and its enough to trigger the drag\r\n\r\n![Peek 2024-04-15 14-34](https://github.com/metabase/metabase/assets/187449/9ddb8655-bc59-4566-9e21-4e61e2354faa)"", 'created_at': datetime.datetime(2024, 4, 15, 4, 36, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2055177513, 'issue_id': 2242651483, 'author': 'perivamsi', 'body': 'Very helpful, thank you!', 'created_at': datetime.datetime(2024, 4, 15, 5, 3, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2056154687, 'issue_id': 2242651483, 'author': 'Tony-metabase', 'body': ""Upgrade to 49.5 should fix it, you are hitting https://github.com/metabase/metabase/issues/40663 ... It's a duplicate"", 'created_at': datetime.datetime(2024, 4, 15, 8, 27, 26, tzinfo=datetime.timezone.utc)}]","perivamsi on (2024-04-15 04:20:22 UTC): @brendanheywood thank you for reporting this. could you please add a video for this? I am not able to repro this based on the text description and a video of the bug would be helpful.

brendanheywood (Issue Creator) on (2024-04-15 04:36:52 UTC): thanks @perivamsi here is a gif, sorry the cursor isn't visible, but the first time I click in the input I am very careful to just click, the second click is a 'typical'click where the mouse is moving like 2 or 3 pixels and its enough to trigger the drag

![Peek 2024-04-15 14-34](https://github.com/metabase/metabase/assets/187449/9ddb8655-bc59-4566-9e21-4e61e2354faa)

perivamsi on (2024-04-15 05:03:52 UTC): Very helpful, thank you!

Tony-metabase on (2024-04-15 08:27:26 UTC): Upgrade to 49.5 should fix it, you are hitting https://github.com/metabase/metabase/issues/40663 ... It's a duplicate

"
2242485709,issue,closed,completed,Borders not respecting bordered=false parameter for static embedding,"### Describe the bug

After the upgrade to Version 49, all of our embedded dashboards are showing with borders. We are using the following embed settings:

theme=transparent&bordered=false&titled=false

This seems to be a bug in Version 49 that was not present in version 48.

### To Reproduce

1. Create a dashboard
2. Enable static embed
3. Choose theme as transparent
4. Choose bordered as false
5. Choose titled as false
6. Embed in website
7. Refresh page, and dashboard will show up with borders


### Expected behavior

There should not be any borders showing

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.213-201.855.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""snowflake"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.10""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-11"",
      ""tag"": ""v1.49.5"",
      ""hash"": ""31c4887""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Very annoying, affecting our branding in our product.

### Additional context

_No response_",air-rick,2024-04-15 01:12:38+00:00,['npretto'],2024-04-16 10:28:44+00:00,2024-04-16 07:02:13+00:00,https://github.com/metabase/metabase/issues/41393,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('.Team/Embedding', '')]","[{'comment_id': 2056237190, 'issue_id': 2242485709, 'author': 'npretto', 'body': '@air-rick is the border only showing up on the top side?', 'created_at': datetime.datetime(2024, 4, 15, 8, 45, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2056733808, 'issue_id': 2242485709, 'author': 'air-rick', 'body': 'No, it is showing up around each individual card\r\n\r\nOn Mon, Apr 15, 2024, 4:45\u202fPM Nicolò Pretto ***@***.***>\r\nwrote:\r\n\r\n> @air-rick <https://github.com/air-rick> is the border only showing up on\r\n> the top side?\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/metabase/metabase/issues/41393#issuecomment-2056237190>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AT55X5T7Z4Y67VYSCGTJ4PDY5OHSLAVCNFSM6AAAAABGGNLR5CVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDANJWGIZTOMJZGA>\r\n> .\r\n> You are receiving this because you were mentioned.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 4, 15, 12, 27, 22, tzinfo=datetime.timezone.utc)}]","npretto (Assginee) on (2024-04-15 08:45:03 UTC): @air-rick is the border only showing up on the top side?

air-rick (Issue Creator) on (2024-04-15 12:27:22 UTC): No, it is showing up around each individual card

On Mon, Apr 15, 2024, 4:45 PM Nicolò Pretto ***@***.***>
wrote:

"
2242399422,issue,closed,not_planned,"""Could not convert UTC to a ZoneOffset!"" when zoom in an aggregation element","### Describe the bug

I'm using Metabase to display a simple dashboard for my personal banking movement. I'm using MongoDb.
My documents have this structure:
![image](https://github.com/metabase/metabase/assets/71256977/f4c6b613-8f92-4a72-9e6c-df1eb7e1b6b4)

I've a question with a simple aggregation on date field that sum all expenses by day.

This is a visualization example:
![image](https://github.com/metabase/metabase/assets/71256977/5a608908-c94e-44e9-82da-a2da40d85dce)

But when I click on a spike and then on zoom in:
![image](https://github.com/metabase/metabase/assets/71256977/54b4f5e2-c6d3-4a3d-9659-2a18c9401ecd)

appears this error:
![image](https://github.com/metabase/metabase/assets/71256977/0b2bbf72-db6d-4af2-9a41-7ed3664128d5)


### To Reproduce

- Connect to a mongodb
- Insert a document like:
```
{
    ""_id"" : ""aaa"",
    ""date"" : ISODate(""2024-04-13T23:43:49.000+0000""),
    ""import"" : NumberInt(5),
    ""card"" : ""Mastercard 123,
    ""casual"" : ""Amazon Shopping""
}
```
- Create a question grouping by date
- Click on zoom in on UI visualization

### Expected behavior

It should show up single movements on that date.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36 Edg/123.0.0.0"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""19-ea+20-1369"",
    ""java.vendor"": ""Oracle Corporation"",
    ""java.vendor.url"": ""https://java.oracle.com/"",
    ""java.version"": ""19-ea"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""19-ea+20-1369"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.73-haos-raspi"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Rome""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mongo""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.2""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.3.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2022-05-02"",
      ""tag"": ""v0.43.0"",
      ""branch"": ""release-x.43.x"",
      ""hash"": ""ee686fc""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Rome""
    }
  }
}
```


### Severity

It's annoying

### Additional context

_No response_",claudiomerli,2024-04-14 22:25:53+00:00,[],2024-04-15 15:04:05+00:00,2024-04-15 14:58:31+00:00,https://github.com/metabase/metabase/issues/41392,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2057068268, 'issue_id': 2242399422, 'author': 'ignacio-mb', 'body': 'Hi @claudiomerli, you are running version 43, which is very old and unsupported. Please upgrade :)\r\n\r\nCool use case btw!', 'created_at': datetime.datetime(2024, 4, 15, 14, 58, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2057081247, 'issue_id': 2242399422, 'author': 'claudiomerli', 'body': 'Oh ok! I’m using an addon for home assistant thank at this point I think is not updated. Thank you!', 'created_at': datetime.datetime(2024, 4, 15, 15, 4, 3, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-04-15 14:58:31 UTC): Hi @claudiomerli, you are running version 43, which is very old and unsupported. Please upgrade :)

Cool use case btw!

claudiomerli (Issue Creator) on (2024-04-15 15:04:03 UTC): Oh ok! I’m using an addon for home assistant thank at this point I think is not updated. Thank you!

"
2242342659,issue,open,,Diplay image in map popup,"**Is your feature request related to a problem? Please describe.**
No problem!

**Describe the solution you'd like**
On hovering over a pin on map chart, if an image url is supplied, display the image in the popup with the rest of the info.

**Describe alternatives you've considered**
None

**How important is this feature to you?**
Medium

**Additional context**
![image](https://github.com/metabase/metabase/assets/149382782/a96a018f-1484-426b-a875-12fbfb29323a)

Qlik sense example
![image](https://github.com/metabase/metabase/assets/149382782/c1c49fb1-270c-43ae-8655-fa3acfc35705)

",hss-iullah,2024-04-14 20:05:50+00:00,[],2024-04-15 14:59:14+00:00,,https://github.com/metabase/metabase/issues/41391,"[('Type:New Feature', ''), ('Visualization/Maps', '')]",[],
2242242623,issue,open,,Tests failing in `metabase.api.native-query-snippet-test`,"### Describe the bug

There are 6 errors while running the 6 assertions in `metabase.api.native-query-snippet-test`

```
org.h2.jdbc.JdbcSQLSyntaxErrorException: Table ""PERMISSIONS_GROUP"" not found (this database is empty); SQL statement:                                                                                      
                                         SELECT * FROM ""PERMISSIONS_GROUP"" WHERE ""NAME"" = ? [42104-214]                                                                                                    
                SQL: ""SELECT * FROM \""PERMISSIONS_GROUP\"" WHERE \""NAME\"" = ?""                                                                                                                              
           SQLState: ""42S04""                                                                                                                                                                               
          errorCode: 42104
    originalMessage: ""Table \""PERMISSIONS_GROUP\"" not found (this database is empty)""
```

### To Reproduce

Run tests in `metabase.api.native-query-snippet-test`

```sh
clojure -X:dev:test :only metabase.api.native-query-snippet-test
```

### Expected behavior

Tests should pass

### Logs

_No response_

### Information about your Metabase installation

```JSON
master branch
```


### Severity

testing error

### Additional context

_No response_",puchka,2024-04-14 16:17:53+00:00,[],2025-02-04 20:27:53+00:00,,https://github.com/metabase/metabase/issues/41389,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2240711709,issue,closed,completed,Adding a string to UI question's custom column crashes Metabase,"### Describe the bug

Upon entering a string in UI query editor's custom column and clicking away, Metabase crashes

### To Reproduce

1. Go to UI query editor
2. Click on Custom Column
3. Enter a string with single or double quotes - example: 'Test'
4. Click somewhere in the dropdown, away from the input field
5. Metabase crashes
<img width=""1080"" alt=""Screenshot 2024-04-12 at 20 40 23"" src=""https://github.com/metabase/metabase/assets/18078190/2087606d-6cb9-4f96-9612-e96e5bcbfe62"">
<img width=""1080"" alt=""Screenshot 2024-04-12 at 20 40 31"" src=""https://github.com/metabase/metabase/assets/18078190/142f9026-65b5-4c01-a50f-1f38cbf39cf7"">



### Expected behavior

No crash

### Logs

_No response_

### Information about your Metabase installation

```JSON
Metabase v0.49.1
```


### Severity

P3?

### Additional context

_No response_",TLazarevic,2024-04-12 18:41:57+00:00,['ranquild'],2024-06-24 20:26:42+00:00,2024-06-24 16:08:01+00:00,https://github.com/metabase/metabase/issues/41381,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Querying/Notebook/Custom Expression', ''), ('.Team/Querying', '')]","[{'comment_id': 2186914347, 'issue_id': 2240711709, 'author': 'uladzimirdev', 'body': 'likely related\r\nhttps://github.com/metabase/metabase/issues/27671\r\nhttps://github.com/metabase/metabase/issues/34580', 'created_at': datetime.datetime(2024, 6, 24, 16, 2, 35, tzinfo=datetime.timezone.utc)}]","uladzimirdev on (2024-06-24 16:02:35 UTC): likely related
https://github.com/metabase/metabase/issues/27671
https://github.com/metabase/metabase/issues/34580

"
2240373438,issue,closed,completed,Migration on MySQL/MariaDB leads to having multiple revisions with latest=true which leads to repeated items in the FE,"### Describe the bug

Just upgraded to 0.49.5, self hosted, mariadb database.
We have multiple same entries in a collection, with only dashboards. It doesn't seem to happen on collections with queries.

### To Reproduce


Go to a collection containing dashboards and list it

### Expected behavior

We shouldn't have duplicates entries.

### Logs

metabase: 2024-04-12 17:16:15,724 DEBUG middleware.log :: #033[32mGET /api/collection/2/items 200 32,9 ms (5 appels de DB) Connexions App DB : 3/15 Threads Jetty : 4/50 (1 inactif, 0 en file d'attente) (112 total de threads actifs) Requêtes en cours : 0 (0 en file d'attente)#033[0m

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""fr-FR"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.21+9-LTS"",
    ""java.vendor"": ""Red Hat, Inc."",
    ""java.vendor.url"": ""https://www.redhat.com/"",
    ""java.version"": ""11.0.21"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.21+9-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""3.10.0-1160.105.1.el7.x86_64"",
    ""user.language"": ""fr"",
    ""user.timezone"": ""Europe/Paris""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mysql"",
      ""snowflake"",
      ""sqlserver""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MySQL"",
        ""version"": ""8.0.35""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-11"",
      ""tag"": ""v0.49.5"",
      ""hash"": ""31c4887""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

annoying

### Additional context

![mb](https://github.com/metabase/metabase/assets/42241744/00728122-98a0-4464-b5ab-cf8922853386)
",mdz0r,2024-04-12 15:19:34+00:00,['qnkhuat'],2024-12-24 11:38:33+00:00,2024-05-09 11:26:46+00:00,https://github.com/metabase/metabase/issues/41374,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/MySQL', None), ('Operation/Database Migrations', 'Issues with application DB migrations when launching Metabase'), ('.Escalation', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2052057430, 'issue_id': 2240373438, 'author': 'ignacio-mb', 'body': 'Hi @mdz0r, can you put https://yourmetabaseurl/api/collection on your browser and paste the JSON here? You can remove sensitive information if needed.', 'created_at': datetime.datetime(2024, 4, 12, 16, 10, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2052079219, 'issue_id': 2240373438, 'author': 'mdz0r', 'body': 'Here it is.\r\n[json_mb.txt](https://github.com/metabase/metabase/files/14961172/json_mb.txt)', 'created_at': datetime.datetime(2024, 4, 12, 16, 24, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2052096499, 'issue_id': 2240373438, 'author': 'ignacio-mb', 'body': '@mdz0r sorry, I meant to ask for the collection you are in. \r\nFor example, my URL is:  https://myurl.com/collection/40, so I need https://myurl.com/api/collection/40\r\nAre you using serialization?', 'created_at': datetime.datetime(2024, 4, 12, 16, 36, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2052106937, 'issue_id': 2240373438, 'author': 'mdz0r', 'body': 'What do you mean by serialization?\r\n\r\n/api/collection/2 :\r\n```\r\n{\r\n  ""authority_level"": null,\r\n  ""description"": null,\r\n  ""archived"": false,\r\n  ""slug"": ""000_dashboards"",\r\n  ""can_write"": true,\r\n  ""name"": ""000 Dashboards"",\r\n  ""personal_owner_id"": null,\r\n  ""type"": null,\r\n  ""effective_ancestors"": [\r\n    {\r\n      ""metabase.models.collection.root/is-root?"": true,\r\n      ""authority_level"": null,\r\n      ""name"": ""Nos analyses"",\r\n      ""is_personal"": false,\r\n      ""id"": ""root"",\r\n      ""can_write"": true\r\n    },\r\n    {\r\n      ""name"": ""xxxx"",\r\n      ""id"": 3,\r\n      ""personal_owner_id"": null,\r\n      ""can_write"": true\r\n    }\r\n  ],\r\n  ""effective_location"": ""/3/"",\r\n  ""parent_id"": 3,\r\n  ""id"": 2,\r\n  ""entity_id"": null,\r\n  ""location"": ""/3/"",\r\n  ""namespace"": null,\r\n  ""is_personal"": false,\r\n  ""created_at"": ""2020-07-17T14:06:49+02:00""\r\n}\r\n```\r\n/api/collection/2/items : returns the same dashboard multiple times :\r\n```\r\n    {\r\n      ""description"": null,\r\n      ""collection_position"": null,\r\n      ""database_id"": null,\r\n      ""name"": ""Global"",\r\n      ""id"": 52,\r\n      ""entity_id"": ""GR-MQpVfakfekZyzNk_S8"",\r\n      ""last-edit-info"": {\r\n        ""id"": 1,\r\n        ""timestamp"": ""2024-02-26T11:24:08+01:00""\r\n      },\r\n      ""model"": ""dashboard""\r\n    },\r\n    {\r\n      ""description"": null,\r\n      ""collection_position"": null,\r\n      ""database_id"": null,\r\n      ""name"": ""Global"",\r\n      ""id"": 52,\r\n      ""entity_id"": ""GR-MQpVfakfekZyzNk_S8"",\r\n      ""last-edit-info"": {\r\n        ""id"": 1,\r\n        ""timestamp"": ""2024-02-26T11:24:08+01:00""\r\n      },\r\n      ""model"": ""dashboard""\r\n    },\r\n    {\r\n      ""description"": null,\r\n      ""collection_position"": null,\r\n      ""database_id"": null,\r\n      ""name"": ""Global"",\r\n      ""id"": 52,\r\n      ""entity_id"": ""GR-MQpVfakfekZyzNk_S8"",\r\n      ""last-edit-info"": {\r\n        ""id"": 1,\r\n        ""timestamp"": ""2024-02-26T11:24:08+01:00""\r\n      },\r\n      ""model"": ""dashboard""\r\n    },\r\n    {\r\n      ""description"": null,\r\n      ""collection_position"": null,\r\n      ""database_id"": null,\r\n      ""name"": ""Global"",\r\n      ""id"": 52,\r\n      ""entity_id"": ""GR-MQpVfakfekZyzNk_S8"",\r\n      ""last-edit-info"": {\r\n        ""id"": 1,\r\n        ""timestamp"": ""2024-02-26T11:24:08+01:00""\r\n      },\r\n      ""model"": ""dashboard""\r\n    },\r\n```', 'created_at': datetime.datetime(2024, 4, 12, 16, 43, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2057243859, 'issue_id': 2240373438, 'author': 'mdz0r', 'body': 'Hello,\r\n\r\nDid a bit of drill down on this particular issue.\r\nIt\'s actually related to the `revision` table.\r\n\r\n```\r\nmysql> select count(*) from revision where model_id=52 and model = \'Dashboard\' and most_recent = true;\r\n+----------+\r\n| count(*) |\r\n+----------+\r\n|        4 |\r\n+----------+\r\n```\r\n\r\nI have actually several dashboards with multiple ""most_recent"" = true which I guess shouldnt happen.\r\n\r\n```\r\nmysql> select model_id, count(*) from revision where model = \'Dashboard\' and most_recent = true group by model_id having count(*)>1;\r\n+----------+----------+\r\n| model_id | count(*) |\r\n+----------+----------+\r\n|       15 |        3 |\r\n|       18 |        3 |\r\n|       20 |        4 |\r\n|       22 |        2 |\r\n|       21 |        2 |\r\n|       43 |        2 |\r\n|       40 |        2 |\r\n|       44 |        2 |\r\n|       52 |        4 |\r\n+----------+----------+\r\n9 rows in set (0,00 sec)\r\n```\r\n\r\n```\r\nmysql> select id,model,model_id,timestamp,most_recent from revision where model=\'Dashboard\' and model_id in (15,18,20,22,21,43,40,44,52) and most_recent=true;\r\n+------+-----------+----------+----------------------------+--------------------------+\r\n| id   | model     | model_id | timestamp                  | most_recent              |\r\n+------+-----------+----------+----------------------------+--------------------------+\r\n|  183 | Dashboard |       15 | 2020-01-14 16:49:30.000000 | 0x01                     |\r\n|  184 | Dashboard |       15 | 2020-01-14 16:49:30.000000 | 0x01                     |\r\n|  185 | Dashboard |       15 | 2020-01-14 16:49:30.000000 | 0x01                     |\r\n|  255 | Dashboard |       18 | 2020-01-29 14:09:02.000000 | 0x01                     |\r\n|  256 | Dashboard |       18 | 2020-01-29 14:09:02.000000 | 0x01                     |\r\n|  257 | Dashboard |       18 | 2020-01-29 14:09:02.000000 | 0x01                     |\r\n|  282 | Dashboard |       20 | 2020-04-07 16:44:47.000000 | 0x01                     |\r\n|  283 | Dashboard |       20 | 2020-04-07 16:44:47.000000 | 0x01                     |\r\n|  284 | Dashboard |       20 | 2020-04-07 16:44:47.000000 | 0x01                     |\r\n|  285 | Dashboard |       20 | 2020-04-07 16:44:47.000000 | 0x01                     |\r\n|  347 | Dashboard |       22 | 2020-04-10 11:26:32.000000 | 0x01                     |\r\n|  348 | Dashboard |       22 | 2020-04-10 11:26:32.000000 | 0x01                     |\r\n|  352 | Dashboard |       21 | 2020-04-10 11:27:34.000000 | 0x01                     |\r\n|  353 | Dashboard |       21 | 2020-04-10 11:27:34.000000 | 0x01                     |\r\n| 1356 | Dashboard |       43 | 2022-05-06 18:01:00.000000 | 0x01                     |\r\n| 1357 | Dashboard |       43 | 2022-05-06 18:01:00.000000 | 0x01                     |\r\n| 1637 | Dashboard |       40 | 2023-12-19 09:54:42.000000 | 0x01                     |\r\n| 1638 | Dashboard |       40 | 2023-12-19 09:54:42.000000 | 0x01                     |\r\n| 1729 | Dashboard |       44 | 2024-01-09 23:52:42.000000 | 0x01                     |\r\n| 1730 | Dashboard |       44 | 2024-01-09 23:52:42.000000 | 0x01                     |\r\n| 1979 | Dashboard |       52 | 2024-02-26 11:24:08.000000 | 0x01                     |\r\n| 1980 | Dashboard |       52 | 2024-02-26 11:24:08.000000 | 0x01                     |\r\n| 1981 | Dashboard |       52 | 2024-02-26 11:24:08.000000 | 0x01                     |\r\n| 1982 | Dashboard |       52 | 2024-02-26 11:24:08.000000 | 0x01                     |\r\n+------+-----------+----------+----------------------------+--------------------------+\r\n24 rows in set (0,00 sec)\r\n```\r\n\r\nWould it be OK to set most_recent = true on the most recent record for each dashboard ?', 'created_at': datetime.datetime(2024, 4, 15, 16, 19, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079645558, 'issue_id': 2240373438, 'author': 'sicarul', 'body': 'I\'m having the same issue with many dashboards\r\n<img width=""602"" alt=""image"" src=""https://github.com/metabase/metabase/assets/4952116/1d8d72ca-20d4-4251-94b1-35b0e0ee3f68"">', 'created_at': datetime.datetime(2024, 4, 26, 15, 44, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079683546, 'issue_id': 2240373438, 'author': 'mdz0r', 'body': 'Updating the revision table to keep the latest most_recent record = true fixed the issue for me.', 'created_at': datetime.datetime(2024, 4, 26, 16, 7, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079832095, 'issue_id': 2240373438, 'author': 'paoliniluis', 'body': '@mdz0r so you say that this was due to the revision table having multiple entries (same dashboard id) with ""true""?', 'created_at': datetime.datetime(2024, 4, 26, 17, 53, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2079871092, 'issue_id': 2240373438, 'author': 'mdz0r', 'body': 'Yep', 'created_at': datetime.datetime(2024, 4, 26, 18, 10, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2080440937, 'issue_id': 2240373438, 'author': 'paoliniluis', 'body': ""@qnkhuat assigning you also on this one as it's a migration MySQL migration specifically"", 'created_at': datetime.datetime(2024, 4, 27, 10, 13, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2100091528, 'issue_id': 2240373438, 'author': 'sfaut', 'body': ""Thx @mdz0r, I have fixed the problem with :\r\n\r\n```sql\r\ncreate table metabase.revision_bak like metabase.revision;\r\ninsert into metabase.revision_bak select all * from metabase.revision;\r\n\r\nstart transaction;\r\n\r\nwith duplicate_dashboard as (\r\n\t-- metabase.revision.timestamp is duplicate too, so I use metabase.revision.id and keep the last one\r\n\tselect all model_id, max(id) as last_most_recent \r\n\tfrom metabase.revision \r\n\twhere model = 'Dashboard' and most_recent = true \r\n\tgroup by 1\r\n\thaving count(*) > 1\r\n)\r\nupdate metabase.revision\r\nset most_recent = false\r\nwhere true\r\n\tand model = 'Dashboard'\r\n\tand model_id in (select all model_id from duplicate_dashboard)\r\n\tand id not in (select all last_most_recent from duplicate_dashboard)\r\n;\r\n\r\ncommit work;\r\n```"", 'created_at': datetime.datetime(2024, 5, 8, 8, 56, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-04-12 16:10:53 UTC): Hi @mdz0r, can you put https://yourmetabaseurl/api/collection on your browser and paste the JSON here? You can remove sensitive information if needed.

mdz0r (Issue Creator) on (2024-04-12 16:24:24 UTC): Here it is.
[json_mb.txt](https://github.com/metabase/metabase/files/14961172/json_mb.txt)

ignacio-mb on (2024-04-12 16:36:06 UTC): @mdz0r sorry, I meant to ask for the collection you are in. 
For example, my URL is:  https://myurl.com/collection/40, so I need https://myurl.com/api/collection/40
Are you using serialization?

mdz0r (Issue Creator) on (2024-04-12 16:43:28 UTC): What do you mean by serialization?

/api/collection/2 :
```
{
  ""authority_level"": null,
  ""description"": null,
  ""archived"": false,
  ""slug"": ""000_dashboards"",
  ""can_write"": true,
  ""name"": ""000 Dashboards"",
  ""personal_owner_id"": null,
  ""type"": null,
  ""effective_ancestors"": [
    {
      ""metabase.models.collection.root/is-root?"": true,
      ""authority_level"": null,
      ""name"": ""Nos analyses"",
      ""is_personal"": false,
      ""id"": ""root"",
      ""can_write"": true
    },
    {
      ""name"": ""xxxx"",
      ""id"": 3,
      ""personal_owner_id"": null,
      ""can_write"": true
    }
  ],
  ""effective_location"": ""/3/"",
  ""parent_id"": 3,
  ""id"": 2,
  ""entity_id"": null,
  ""location"": ""/3/"",
  ""namespace"": null,
  ""is_personal"": false,
  ""created_at"": ""2020-07-17T14:06:49+02:00""
}
```
/api/collection/2/items : returns the same dashboard multiple times :
```
    {
      ""description"": null,
      ""collection_position"": null,
      ""database_id"": null,
      ""name"": ""Global"",
      ""id"": 52,
      ""entity_id"": ""GR-MQpVfakfekZyzNk_S8"",
      ""last-edit-info"": {
        ""id"": 1,
        ""timestamp"": ""2024-02-26T11:24:08+01:00""
      },
      ""model"": ""dashboard""
    },
    {
      ""description"": null,
      ""collection_position"": null,
      ""database_id"": null,
      ""name"": ""Global"",
      ""id"": 52,
      ""entity_id"": ""GR-MQpVfakfekZyzNk_S8"",
      ""last-edit-info"": {
        ""id"": 1,
        ""timestamp"": ""2024-02-26T11:24:08+01:00""
      },
      ""model"": ""dashboard""
    },
    {
      ""description"": null,
      ""collection_position"": null,
      ""database_id"": null,
      ""name"": ""Global"",
      ""id"": 52,
      ""entity_id"": ""GR-MQpVfakfekZyzNk_S8"",
      ""last-edit-info"": {
        ""id"": 1,
        ""timestamp"": ""2024-02-26T11:24:08+01:00""
      },
      ""model"": ""dashboard""
    },
    {
      ""description"": null,
      ""collection_position"": null,
      ""database_id"": null,
      ""name"": ""Global"",
      ""id"": 52,
      ""entity_id"": ""GR-MQpVfakfekZyzNk_S8"",
      ""last-edit-info"": {
        ""id"": 1,
        ""timestamp"": ""2024-02-26T11:24:08+01:00""
      },
      ""model"": ""dashboard""
    },
```

mdz0r (Issue Creator) on (2024-04-15 16:19:20 UTC): Hello,

Did a bit of drill down on this particular issue.
It's actually related to the `revision` table.

```
mysql> select count(*) from revision where model_id=52 and model = 'Dashboard' and most_recent = true;
+----------+
| count(*) |
+----------+
|        4 |
+----------+
```

I have actually several dashboards with multiple ""most_recent"" = true which I guess shouldnt happen.

```
mysql> select model_id, count(*) from revision where model = 'Dashboard' and most_recent = true group by model_id having count(*)>1;
+----------+----------+
| model_id | count(*) |
+----------+----------+
|       15 |        3 |
|       18 |        3 |
|       20 |        4 |
|       22 |        2 |
|       21 |        2 |
|       43 |        2 |
|       40 |        2 |
|       44 |        2 |
|       52 |        4 |
+----------+----------+
9 rows in set (0,00 sec)
```

```
mysql> select id,model,model_id,timestamp,most_recent from revision where model='Dashboard' and model_id in (15,18,20,22,21,43,40,44,52) and most_recent=true;
+------+-----------+----------+----------------------------+--------------------------+
| id   | model     | model_id | timestamp                  | most_recent              |
+------+-----------+----------+----------------------------+--------------------------+
|  183 | Dashboard |       15 | 2020-01-14 16:49:30.000000 | 0x01                     |
|  184 | Dashboard |       15 | 2020-01-14 16:49:30.000000 | 0x01                     |
|  185 | Dashboard |       15 | 2020-01-14 16:49:30.000000 | 0x01                     |
|  255 | Dashboard |       18 | 2020-01-29 14:09:02.000000 | 0x01                     |
|  256 | Dashboard |       18 | 2020-01-29 14:09:02.000000 | 0x01                     |
|  257 | Dashboard |       18 | 2020-01-29 14:09:02.000000 | 0x01                     |
|  282 | Dashboard |       20 | 2020-04-07 16:44:47.000000 | 0x01                     |
|  283 | Dashboard |       20 | 2020-04-07 16:44:47.000000 | 0x01                     |
|  284 | Dashboard |       20 | 2020-04-07 16:44:47.000000 | 0x01                     |
|  285 | Dashboard |       20 | 2020-04-07 16:44:47.000000 | 0x01                     |
|  347 | Dashboard |       22 | 2020-04-10 11:26:32.000000 | 0x01                     |
|  348 | Dashboard |       22 | 2020-04-10 11:26:32.000000 | 0x01                     |
|  352 | Dashboard |       21 | 2020-04-10 11:27:34.000000 | 0x01                     |
|  353 | Dashboard |       21 | 2020-04-10 11:27:34.000000 | 0x01                     |
| 1356 | Dashboard |       43 | 2022-05-06 18:01:00.000000 | 0x01                     |
| 1357 | Dashboard |       43 | 2022-05-06 18:01:00.000000 | 0x01                     |
| 1637 | Dashboard |       40 | 2023-12-19 09:54:42.000000 | 0x01                     |
| 1638 | Dashboard |       40 | 2023-12-19 09:54:42.000000 | 0x01                     |
| 1729 | Dashboard |       44 | 2024-01-09 23:52:42.000000 | 0x01                     |
| 1730 | Dashboard |       44 | 2024-01-09 23:52:42.000000 | 0x01                     |
| 1979 | Dashboard |       52 | 2024-02-26 11:24:08.000000 | 0x01                     |
| 1980 | Dashboard |       52 | 2024-02-26 11:24:08.000000 | 0x01                     |
| 1981 | Dashboard |       52 | 2024-02-26 11:24:08.000000 | 0x01                     |
| 1982 | Dashboard |       52 | 2024-02-26 11:24:08.000000 | 0x01                     |
+------+-----------+----------+----------------------------+--------------------------+
24 rows in set (0,00 sec)
```

Would it be OK to set most_recent = true on the most recent record for each dashboard ?

sicarul on (2024-04-26 15:44:02 UTC): I'm having the same issue with many dashboards
<img width=""602"" alt=""image"" src=""https://github.com/metabase/metabase/assets/4952116/1d8d72ca-20d4-4251-94b1-35b0e0ee3f68"">

mdz0r (Issue Creator) on (2024-04-26 16:07:51 UTC): Updating the revision table to keep the latest most_recent record = true fixed the issue for me.

paoliniluis on (2024-04-26 17:53:56 UTC): @mdz0r so you say that this was due to the revision table having multiple entries (same dashboard id) with ""true""?

mdz0r (Issue Creator) on (2024-04-26 18:10:32 UTC): Yep

paoliniluis on (2024-04-27 10:13:24 UTC): @qnkhuat assigning you also on this one as it's a migration MySQL migration specifically

sfaut on (2024-05-08 08:56:00 UTC): Thx @mdz0r, I have fixed the problem with :

```sql
create table metabase.revision_bak like metabase.revision;
insert into metabase.revision_bak select all * from metabase.revision;

start transaction;

with duplicate_dashboard as (
	-- metabase.revision.timestamp is duplicate too, so I use metabase.revision.id and keep the last one
	select all model_id, max(id) as last_most_recent 
	from metabase.revision 
	where model = 'Dashboard' and most_recent = true 
	group by 1
	having count(*) > 1
)
update metabase.revision
set most_recent = false
where true
	and model = 'Dashboard'
	and model_id in (select all model_id from duplicate_dashboard)
	and id not in (select all last_most_recent from duplicate_dashboard)
;

commit work;
```

"
2240278278,issue,closed,completed,Hide a button if no cards are connected,,uladzimirdev,2024-04-12 14:31:20+00:00,['uladzimirdev'],2024-04-12 18:24:50+00:00,2024-04-12 18:24:50+00:00,https://github.com/metabase/metabase/issues/41371,[],[],
2240243146,issue,open,,Remove unused `POST /api/user/:id/send_invite` endpoint,"This endpoint still exists on the backend, and is defined on the frontend in both `services` and in the `Users` entity but it's not being called anywhere.

The last backend change:
https://github.com/metabase/metabase/pull/31398/files#diff-b0c224851be83561f142d58168ee2b5bb88452d535cb116e620616af3b858ed6L493-R495

Slack context:
https://metaboat.slack.com/archives/C01LQQ2UW03/p1712930250085399",nemanjaglumac,2024-04-12 14:11:53+00:00,[],2024-06-24 16:52:41+00:00,,https://github.com/metabase/metabase/issues/41369,"[('Type:Tech Debt', 'or Refactoring'), ('.Backend', ''), (':broom:', 'no-brainer cleanup issues to clear out when you have an hour left until EoD or something')]","[{'comment_id': 2056220387, 'issue_id': 2240243146, 'author': 'kamilmielnik', 'body': 'I see #41370 got closed but we can still remove references to this endpoint in the FE code.', 'created_at': datetime.datetime(2024, 4, 15, 8, 41, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2056616598, 'issue_id': 2240243146, 'author': 'nemanjaglumac', 'body': ""> I see #41370 got closed but we can still remove references to this endpoint in the FE code.\r\n\r\n@kamilmielnik yup, that's happening here https://github.com/metabase/metabase/pull/41312/commits/57e0130174ca02601c9c3012c3560615225d55e1"", 'created_at': datetime.datetime(2024, 4, 15, 11, 36, 59, tzinfo=datetime.timezone.utc)}]","kamilmielnik on (2024-04-15 08:41:31 UTC): I see #41370 got closed but we can still remove references to this endpoint in the FE code.

nemanjaglumac (Issue Creator) on (2024-04-15 11:36:59 UTC): @kamilmielnik yup, that's happening here https://github.com/metabase/metabase/pull/41312/commits/57e0130174ca02601c9c3012c3560615225d55e1

"
2240061478,issue,closed,completed,"Migrate global css in `frontend/src/metabase/public/components/EmbedFrame/EmbedFrame.module.css`, `frontend/src/metabase/parameters/components/ParameterValueWidget.module.css`",,oisincoveney,2024-04-12 12:32:14+00:00,['oisincoveney'],2024-04-17 06:34:03+00:00,2024-04-17 06:34:03+00:00,https://github.com/metabase/metabase/issues/41364,"[('.CSS', ''), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Team/Embedding', '')]",[],
2239794071,issue,closed,completed,"Migrate global css in `frontend/src/metabase/css/core/rounded.module.css`, `frontend/src/metabase/css/core/shadow.module.css`, `frontend/src/metabase/css/core/transitions.module.css`, `frontend/src/metabase/css/core/width.module.css`, `frontend/src/metabase/query_builder/components/DataSelector/DataSelector.module.css`","```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/pull/41357
- [ ] https://github.com/metabase/metabase/pull/41359
- [ ] https://github.com/metabase/metabase/pull/41360
- [ ] https://github.com/metabase/metabase/pull/41361
- [ ] https://github.com/metabase/metabase/pull/41362
```
",oisincoveney,2024-04-12 10:46:25+00:00,['oisincoveney'],2024-04-15 08:09:52+00:00,2024-04-15 08:09:52+00:00,https://github.com/metabase/metabase/issues/41356,"[('.CSS', ''), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Team/Embedding', '')]",[],
2239691462,issue,closed,completed,Migrate global css in `frontend/src/metabase/visualizations/components/Legend.module.css`,,oisincoveney,2024-04-12 10:14:30+00:00,['oisincoveney'],2024-04-15 08:10:09+00:00,2024-04-15 08:10:09+00:00,https://github.com/metabase/metabase/issues/41354,"[('.CSS', ''), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Team/Embedding', '')]",[],
2239684660,issue,closed,completed,[FE] Add `extract_via_column_header` analytics event,"`extract_via_column_header`

https://www.notion.so/metabase/0df8245abb8f46edbede12065d65e774?v=86c486a9c8904fb0ab086ad389f63f81

https://metaboat.slack.com/archives/C0645JP1W81/p1712845418159769

----

update event status in the doc once it's ready

----

This task should really go into #38964, but that epic has already been closed",kamilmielnik,2024-04-12 10:12:24+00:00,['romeovs'],2024-05-02 19:14:10+00:00,2024-05-02 19:14:10+00:00,https://github.com/metabase/metabase/issues/41353,"[('.Frontend', ''), ('.Team/Querying', '')]","[{'comment_id': 2091165429, 'issue_id': 2239684660, 'author': 'romeovs', 'body': 'Duplicate of https://github.com/metabase/metabase/issues/42093', 'created_at': datetime.datetime(2024, 5, 2, 17, 51, 1, tzinfo=datetime.timezone.utc)}]","romeovs (Assginee) on (2024-05-02 17:51:01 UTC): Duplicate of https://github.com/metabase/metabase/issues/42093

"
2239675248,issue,open,,[FE] Add analytics events for plus menu,"`combine_via_plus_modal`
`extract_via_plus_modal`

https://www.notion.so/metabase/0df8245abb8f46edbede12065d65e774?v=86c486a9c8904fb0ab086ad389f63f81

https://metaboat.slack.com/archives/C0645JP1W81/p1712845418159769

----

update event statuses in the doc once it's ready",kamilmielnik,2024-04-12 10:09:30+00:00,[],2024-04-12 10:11:36+00:00,,https://github.com/metabase/metabase/issues/41351,"[('.Frontend', ''), ('.Team/Querying', '')]",[],
2239670537,issue,closed,completed,[FE] Add `combine_via_column_header` analytics event,"`combine_via_column_header`

https://www.notion.so/metabase/0df8245abb8f46edbede12065d65e774?v=86c486a9c8904fb0ab086ad389f63f81

https://metaboat.slack.com/archives/C0645JP1W81/p1712845418159769

----

update event status in the doc once it's ready",kamilmielnik,2024-04-12 10:08:11+00:00,['romeovs'],2024-05-03 11:41:22+00:00,2024-05-03 11:41:15+00:00,https://github.com/metabase/metabase/issues/41350,"[('.Frontend', ''), ('.Team/Querying', '')]",[],
2239431944,issue,closed,completed,Migrate global css in `frontend/src/metabase/reference/components/Formula.module.css`,,oisincoveney,2024-04-12 08:46:32+00:00,['oisincoveney'],2024-04-17 06:34:16+00:00,2024-04-17 06:34:16+00:00,https://github.com/metabase/metabase/issues/41347,"[('.CSS', ''), ('.Frontend', ''), ('.Team/Embedding', '')]",[],
2239170187,issue,open,,RFC: Advanced DB sync options revamp,"### Problem

The sync process has 2 main steps:

- Sync metadata (db info, table, fields, fingerprint…)
- Scan field values (to power filter dropdowns)

By default, the schedule for these 2 steps is randomized, but you can customize it further in the advanced options.

<img width=""710"" alt=""Screenshot 2024-04-08 at 17 58 11"" src=""https://github.com/metabase/metabase/assets/25661381/d2a71e49-73ab-469c-8731-a437b2d257cd"">


Let’s review how we represent these options in the DB

| Options | details.let_user_control_scheduling | is_full_sync | is_on_demand |
| --- | --- | --- | --- |
| Default | false | true | false |
| Regularly on a schedule | true | true | false |
| Only when adding a new filter | true | false | true |
| Never, I'll do it manually | true | false | false |
- We’re using 3 boolean columns to represent 4 states!
- `is_on_demand` is overloaded, it’s used for both controlling sync behavior and updating field values when updating `card` `dashboard` (not part of the sync process)
    - see references of `metabase.models.field-values/update-field-values-for-on-demand-dbs!` to learn how it’s used
- Why `is_full_sync = false` means we only sync metadata, what if we want to turn off metadata syncing and only enable scan field values?
- `details.let_user_control_scheduling` is a nested field in a jsonified column

Let’s revamp this by replacing all these 3 booleans with an enum `sync_strategy` column. The mapping is as follow:

| Options | details.let_user_control_scheduling | is_full_sync | is_on_demand | sync_strategy (new) |
| --- | --- | --- | --- | --- |
| Default | false | true | false | auto_full_sync |
| Regularly on a schedule | true | true | false | manual_full_sync |
| Only when adding a new filter | true | false | true | manual_on_demand |
| Never, I'll do it manually | true | false | false | manual_metadata_only |",qnkhuat,2024-04-12 06:17:56+00:00,[],2024-04-12 06:18:23+00:00,,https://github.com/metabase/metabase/issues/41345,"[('Type:Tech Debt', 'or Refactoring'), ('Administration/Metadata & Sync', ''), ('.Backend', '')]",[],
2238957705,issue,open,,pMBQL schema should disallow aggregate functions like `count()` and `sum()` inside `:expressions` list,"I would expect this to fail

```clj
(let [query (-> (lib/query meta/metadata-provider (meta/table-metadata :orders))
                (lib/expression ""x"" (lib/count)))]
  (or (me/humanize (mc/explain :metabase.lib.schema/query query))
      query))
```

But instead it happily returns a nonsense query
```clj
{:lib/type :mbql/query,
 :lib/metadata metabase.lib.test-metadata/metadata-provider,
 :database 96001,
 :stages [{:lib/type :mbql.stage/mbql,
           :source-table 96060,
           :expressions [[:count #:lib{:uuid ""542151db-36ff-4812-a97b-ec0101560f0d"", :expression-name ""x""}]]}]}
```

Luckily it fails in the legacy MBQL schema 
",camsaul,2024-04-12 03:07:38+00:00,[],2025-02-04 20:27:56+00:00,,https://github.com/metabase/metabase/issues/41344,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Processor', ''), ('Querying/MBQL', ''), ('Difficulty:Easy', ''), ('.Backend', ''), ('.metabase-lib', 'Label for tracking all issues related to the shared CLJC metabase-lib'), ('.Team/Querying', '')]","[{'comment_id': 2256733584, 'issue_id': 2238957705, 'author': 'RiyanaD', 'body': 'Hi! Can I be assigned this issue?', 'created_at': datetime.datetime(2024, 7, 29, 19, 27, 6, tzinfo=datetime.timezone.utc)}]","RiyanaD on (2024-07-29 19:27:06 UTC): Hi! Can I be assigned this issue?

"
2238751465,issue,open,,Allow cloud hosting in Australia region,"**Is your feature request related to a problem? Please describe.**
A customer would like to have our cloud hosting available in the Australia region 

**Additional context**
This particular customer has a data sovereignty requirement to host their data in Australia.
",cbalusek,2024-04-11 23:06:50+00:00,[],2024-05-09 02:38:12+00:00,,https://github.com/metabase/metabase/issues/41339,"[('Type:New Feature', ''), ('Deployment/MetabaseCloud', 'Issue only affects users of Metabase Cloud')]","[{'comment_id': 2101824008, 'issue_id': 2238751465, 'author': 'itssimon', 'body': ""We're also interested in this and have the same requirement."", 'created_at': datetime.datetime(2024, 5, 9, 2, 37, 16, tzinfo=datetime.timezone.utc)}]","itssimon on (2024-05-09 02:37:16 UTC): We're also interested in this and have the same requirement.

"
2238732005,issue,closed,not_planned,Allow Metabase Cloud customers to be able to change the from email address,"**Is your feature request related to a problem? Please describe.**
Metabase Cloud customers have requested the ability to change the from email address.  Currently, emails are sent from a noreply Metabase email address.

Self-hosted customers are able to change this setting.
",cbalusek,2024-04-11 22:45:02+00:00,[],2024-04-12 16:13:26+00:00,2024-04-12 16:13:25+00:00,https://github.com/metabase/metabase/issues/41338,"[('Reporting/Pulses', 'Now called Subscriptions'), ('Type:New Feature', ''), ('Operation/Environment variables', ''), ('Misc/Emails', ''), ('Deployment/MetabaseCloud', 'Issue only affects users of Metabase Cloud')]","[{'comment_id': 2052061523, 'issue_id': 2238732005, 'author': 'ignacio-mb', 'body': 'Dupe of https://github.com/metabase/metabase/issues/31837', 'created_at': datetime.datetime(2024, 4, 12, 16, 13, 25, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-04-12 16:13:25 UTC): Dupe of https://github.com/metabase/metabase/issues/31837

"
2238679662,issue,closed,completed,Admin checklist indicates more progress than actual due to audit items,"### Describe the bug

The admin checklist of a completely fresh enterprise instance makes me think i have set the instance up. 
<img width=""1276"" alt=""image"" src=""https://github.com/metabase/metabase/assets/6377293/b00da519-043e-497f-8bf8-5c3ebaf9e34e"">


### To Reproduce

`MB_JETTY_PORT=3007 java -jar 1.49.5.jar`

Run a recent ee version and the checklist is far too filled out.

```clojure
setup=> (state-for-checklist)
{:db-type :h2,
 :hosted? false,
 :configured {:email false, :slack false},
 :counts {:user 2, :card 75, :table 21}, ;; <- audit content here
;; the following indicates that there are dashboards, non-sample dbs (audit db connection), collections, models. 
;; It's a rich instance but solely because of the audit info
 :exists {:non-sample-db true, :dashboard true, :pulse false, :hidden-table false, :collection true, :model true}}
```

### Expected behavior

The audit items should not factor into this checklist for new admins

### Logs

_No response_

### Information about your Metabase installation

```JSON
1.49.5.jar
```


### Severity

p2

### Additional context

_No response_",dpsutton,2024-04-11 21:53:37+00:00,['calherries'],2024-05-02 10:03:55+00:00,2024-04-23 10:54:03+00:00,https://github.com/metabase/metabase/issues/41335,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Administration/', ''), ('First Experience/Setup', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2051497065, 'issue_id': 2238679662, 'author': 'albertoperdomo', 'body': 'Related: would it be possible to skip this content in the [usage stats aggregates](https://github.com/metabase/metabase/blob/master/src/metabase/analytics/stats.clj)?', 'created_at': datetime.datetime(2024, 4, 12, 10, 30, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2061495295, 'issue_id': 2238679662, 'author': 'calherries', 'body': ""@dpsutton I can take this and I'll look into https://github.com/metabase/metabase/issues/41524 as well, since I made the issue much worse with the sample content."", 'created_at': datetime.datetime(2024, 4, 17, 15, 8, 35, tzinfo=datetime.timezone.utc)}]","albertoperdomo on (2024-04-12 10:30:35 UTC): Related: would it be possible to skip this content in the [usage stats aggregates](https://github.com/metabase/metabase/blob/master/src/metabase/analytics/stats.clj)?

calherries (Assginee) on (2024-04-17 15:08:35 UTC): @dpsutton I can take this and I'll look into https://github.com/metabase/metabase/issues/41524 as well, since I made the issue much worse with the sample content.

"
2238656693,issue,closed,completed,[dc.js migration] tool-tip with breakout shows breakout category in tool-tip instead of the y-axis column name,"
![image](https://github.com/metabase/metabase/assets/22608765/51754baf-3aeb-4347-a128-69f9076b3b91)

![image](https://github.com/metabase/metabase/assets/22608765/1381c0e3-dbfe-4611-a51e-46f8a40af3be)


![image](https://github.com/metabase/metabase/assets/22608765/857cefb8-9cd6-4015-9c40-96c493ada8ce)",JesseSDevaney,2024-04-11 21:33:06+00:00,['alxnddr'],2024-04-15 15:35:10+00:00,2024-04-15 15:35:10+00:00,https://github.com/metabase/metabase/issues/41333,"[('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2238580589,issue,closed,completed,Add a button Disconnect from cards,"[🎨  design](https://www.figma.com/file/gs70ybpemgX6f1RjCZdvKH/Allow-dashboard-filter-type-to-be-changed-after-it's-added?type=design&node-id=2684-8479&mode=design&t=JryoUsLFGmuF1f3p-0)

<img width=""405"" alt=""image"" src=""https://github.com/metabase/metabase/assets/125459446/73090e1a-e0aa-4c63-bdb3-35eb10645f24"">",uladzimirdev,2024-04-11 20:50:19+00:00,['uladzimirdev'],2024-04-15 14:25:08+00:00,2024-04-15 11:14:49+00:00,https://github.com/metabase/metabase/issues/41331,[],[],
2238520679,issue,open,,Remove SSO Admin Group Sync code in the FE,"We have some code in the LDAP settings forms and tests to handle the `ldap-sync-admin-group` setting. However, this setting was sunsetted back in https://github.com/metabase/metabase/pull/20991, but we didn't remove references on the FE.

- [Slack Thread](https://metaboat.slack.com/archives/C064EB1UE5P/p1712861487368909)

",npfitz,2024-04-11 20:18:02+00:00,[],2024-07-15 16:49:22+00:00,,https://github.com/metabase/metabase/issues/41327,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2238505460,issue,closed,completed,`add-alias-info` gets confused when using multiple nominal field literal refs for same column in source query,"With a query like

```clj
(lib.tu.macros/mbql-query orders
  {:source-query {:source-table $$orders
                  :fields [!year.created-at
                           !month.created-at
                           $total]}
   :aggregation [[:cum-sum [:field ""TOTAL"" {:base-type :type/Integer}]]]
   :breakout    [[:field ""CREATED_AT"" {:base-type :type/Date, :temporal-unit :default}]
                 [:field ""CREATED_AT_2"" {:base-type :type/Date, :temporal-unit :default}]]})
```

it actually adds info like this

```clj
[[:asc [:field ""CREATED_AT"" {:base-type :type/Date
                             :temporal-unit :default
                             ::add/source-table ::add/source
                             ::add/source-alias ""CREATED_AT""
                             ::add/desired-alias ""CREATED_AT""
                             ::add/position 0}]]
 [:asc [:field ""CREATED_AT_2"" {:base-type :type/Date
                               :temporal-unit :default
                               ::add/source-table ::add/source
                               ::add/source-alias ""CREATED_AT"" ; <= WRONG
                               ::add/desired-alias ""CREATED_AT_2""
                               ::add/position 1}]]]
```

which results in us generating incorrect queries like

```sql
SELECT 
  source.CREATED_AT AS CREATED_AT, 
  source.CREATED_AT AS CREATED_AT_2 -- wrong, should have been source.CREATED_AT_2
FROM (
  ...) AS source
  ```  

I'm not 100% sure whether this is affecting people in the wild since we tend to use Field ID refs, but it's definitely a bug and incorrect behavior we should fix either way.",camsaul,2024-04-11 20:11:36+00:00,['camsaul'],2024-08-28 02:10:42+00:00,2024-04-12 12:20:51+00:00,https://github.com/metabase/metabase/issues/41325,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Processor', ''), ('.Correctness', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2238035023,issue,closed,completed,Archived models continue to be cached,"### Describe the bug

Models that have been archive continue to show up in the cache log. 


### To Reproduce

1. Archive a model 
2. Wait for caching schedule to trigger.
3. Go to Admin settings > Tools > Model Caching Log
5. See that the archived model is still being cached on the set schedule


### Expected behavior

I would not expect archived models to be cached.

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Metabase version: v1.49.2
```


### Severity

Low

### Additional context

_No response_",sambradbury,2024-04-11 15:39:06+00:00,['johnswanson'],2024-04-22 20:20:26+00:00,2024-04-18 20:57:36+00:00,https://github.com/metabase/metabase/issues/41318,"[('Type:Bug', 'Product defects')]",[],
2237831088,issue,closed,completed,"Drop operator selection from ""add filter"" popover","<img width=""519"" alt=""image"" src=""https://github.com/metabase/metabase/assets/125459446/16ed821b-24e6-46a5-a336-5c8abb1c5bbd"">

^^ should not be there, instead parameter and operator selection goes to parameter sidebar",uladzimirdev,2024-04-11 14:12:52+00:00,['uladzimirdev'],2024-04-17 14:11:39+00:00,2024-04-17 14:11:38+00:00,https://github.com/metabase/metabase/issues/41313,[],[],
2237652657,issue,closed,not_planned,(v1.49.4) Metabase Initialization failed initially multiple times on linux platform and the Metabase Dashboard Page will take time to open.,"### Describe the bug

Recently, I've been experiencing repeated failures during the initialization of Metabase( Metabase Initialization FAILED ) in logs, resulting in multiple shutdowns. Initially, the Metabase dashboard takes approximately 15 minutes to open due to these initialization failures. 

![image](https://github.com/metabase/metabase/assets/87641643/082d297d-3fd9-4493-8301-0ef46516d5d8)


However, once the initialization is successful, the dashboard operates smoothly.

However, the main concern is why Metabase initialization failed initially on the NVIDIA CUDA Container Environment. It's working fine with the same version in the Intel Vaapi environment.



### To Reproduce

1. Install Pre-requisites packages ( openjdk-11-jdk,openjdk-11-jre, clojure linux-install-1.10.3.998.sh & NodeJS 20.12.2 )
2. Compile metabase from source ( tag=v1.49.4)
3. (Build) Installation Successful.
4. Open Metabase Page
5. Its Stuck at ""Starting Metabase...""
6. Metabase Initialization FAILED Logs 
 ```
INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
 INFO db.setup :: Verifying mysql Database Connection ...
 ERROR metabase.core :: Metabase Initialization FAILED
 2024-04-09T19:35:30.565491+09:00 <info> scorer-metabase-metabase1[1480]: clojure.lang.ExceptionInfo: Unable to connect 
 to Metabase mysql DB. {}
 at metabase.db.setup$fn__33711$verify_db_connection__33716$fn__33717$fn__33718.invoke(setup.clj:102)
 Caused by: java.sql.SQLNonTransientConnectionException: Could not connect to address=(host=metabase1-rdb1.ctr) 
 (port=3306)(type=master) : Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection 
 refused)
 at org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory.createException(ExceptionFactory.java:73)Caused by: 
  java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection 
  refused (Connection refused)
  Caused by: java.net.ConnectException: Connection refused (Connection refused)
  INFO metabase.core :: Metabase Shutting Down ...
  INFO metabase.server :: Shutting Down Embedded Jetty Webserver
  INFO metabase.core :: Metabase Shutdown COMPLETE
```

```
 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
 INFO db.setup :: Verifying mysql Database Connection ...
 INFO db.setup :: Successfully verified MySQL 8.0.36-0ubuntu0.22.04.1 application database connection. ✅
 INFO db.setup :: Running Database Migrations...
 INFO db.setup :: Setting up Liquibase...
 INFO db.setup :: Liquibase is ready.
 INFO db.liquibase :: Checking if Database has unrun migrations...
 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
INFO sync.util :: FINISHED: Sync h2 Database 1 'Sample Dataset' (21.8 s)
main ERROR An exception occurred processing Appender metabase-appender java.lang.IllegalArgumentException: No implementation of method: :explain of protocol: #'schema.core/Schema found for class: clojure.lang.Var$Unbound
at clojure.core$_cache_protocol_fn.invokeStatic(core_deftype.clj:583)
at clojure.core$_cache_protocol_fn.invoke(core_deftype.clj:575)
ERROR metabase.core :: Metabase Initialization FAILED
org.apache.logging.log4j.core.appender.AppenderLoggingException: An exception occurred processing Appender metabase-appender at org.apache.logging.log4j.core.appender.DefaultErrorHandler.error(DefaultErrorHandler.java:93)
Caused by: java.lang.IllegalArgumentException: No implementation of method: :explain of protocol: #'schema.core/Schema found for class: clojure.lang.Var$Unbound

INFO metabase.core :: Metabase Shutting Down ...
INFO metabase.server :: Shutting Down Embedded Jetty Webserver
INFO metabase.core :: Metabase Shutdown COMPLETE
```


```
INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
INFO db.setup :: Verifying mysql Database Connection ...
ERROR metabase.core :: Metabase Initialization FAILED
clojure.lang.ExceptionInfo: Unable to connect to Metabase mysql DB. {}
at metabase.db.setup$fn__34071$verify_db_connection__34076$fn__34077$fn__34078.invoke(setup.clj:102)
Caused by: java.sql.SQLNonTransientConnectionException: Could not connect to address=(host=metabase1-rdb1.ctr)(port=3306)(type=master) : Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)
Caused by: java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)
Caused by: java.net.ConnectException: Connection refused (Connection refused)
INFO metabase.core :: Metabase Shutting Down ...
INFO metabase.server :: Shutting Down Embedded Jetty Webserver
INFO metabase.core :: Metabase Shutdown COMPLETE
```
```

INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
INFO db.setup :: Verifying mysql Database Connection ...
INFO db.setup :: Successfully verified MySQL 8.0.36-0ubuntu0.22.04.1 application database connection. ✅
INFO db.setup :: Running Database Migrations...
INFO db.setup :: Setting up Liquibase...
INFO db.setup :: Liquibase is ready.
INFO db.liquibase :: Checking if Database has unrun migrations...
WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
INFO sync.util :: FINISHED: Analyze data for h2 Database 1 'Sample Database' (1.4 s)
INFO task.send-pulses :: Sending scheduled pulses...
INFO metabase.core :: Metabase Shutting Down ...
INFO metabase.server :: Shutting Down Embedded Jetty Webserver
INFO metabase.core :: Metabase Shutdown COMPLETE
```

### Expected behavior
**Metabase Initialization success Logs** 

```
2024-04-11T16:44:09.625746+09:00 <info> scorer-metabase-metabase1[1399]: ==========
2024-04-11T16:44:09.625767+09:00 <info> scorer-metabase-metabase1[1399]: == CUDA ==
2024-04-11T16:44:09.625786+09:00 <info> scorer-metabase-metabase1[1399]: ==========
2024-04-11T16:44:09.626914+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:09.626961+09:00 <info> scorer-metabase-metabase1[1399]: CUDA Version 12.1.0
2024-04-11T16:44:09.627321+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:09.627362+09:00 <info> scorer-metabase-metabase1[1399]: Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.
2024-04-11T16:44:09.627664+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:09.627705+09:00 <info> scorer-metabase-metabase1[1399]: This container image and its contents are governed by the NVIDIA Deep Learning Container License.
2024-04-11T16:44:09.627736+09:00 <info> scorer-metabase-metabase1[1399]: By pulling and using the container, you accept the terms and conditions of this license:
2024-04-11T16:44:09.627759+09:00 <info> scorer-metabase-metabase1[1399]: https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license
2024-04-11T16:44:09.627783+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:09.627801+09:00 <info> scorer-metabase-metabase1[1399]: A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.
2024-04-11T16:44:09.634303+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:09.634417+09:00 <info> scorer-metabase-metabase1[1399]: *************************
2024-04-11T16:44:09.634458+09:00 <info> scorer-metabase-metabase1[1399]: ** DEPRECATION NOTICE! **
2024-04-11T16:44:09.634486+09:00 <info> scorer-metabase-metabase1[1399]: *************************
2024-04-11T16:44:09.634517+09:00 <info> scorer-metabase-metabase1[1399]: THIS IMAGE IS DEPRECATED and is scheduled for DELETION.
2024-04-11T16:44:09.634544+09:00 <info> scorer-metabase-metabase1[1399]:     https://gitlab.com/nvidia/container-images/cuda/blob/master/doc/support-policy.md
2024-04-11T16:44:09.634569+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:11.641590+09:00 <info> scorer-metabase-metabase1[1399]: Mysql has initialised.
2024-04-11T16:44:11.641804+09:00 <info> scorer-metabase-metabase1[1399]: Creating LOG directory.
2024-04-11T16:44:13.899922+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:13,898 INFO metabase.util :: Maximum memory available to JVM: 1.0 GB
2024-04-11T16:44:14.807172+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:14,806 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓
2024-04-11T16:44:14.807254+09:00 <info> scorer-metabase-metabase1[1399]:  For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html
2024-04-11T16:44:17.731072+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:17,730 INFO driver.impl :: Registered abstract driver :sql  🚚
2024-04-11T16:44:17.737025+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:17,736 INFO driver.impl :: Registered abstract driver :sql-jdbc (parents: [:sql]) 🚚
2024-04-11T16:44:17.740282+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:17,739 INFO metabase.util :: Load driver :sql-jdbc took 41.3 ms
2024-04-11T16:44:17.740522+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:17,740 INFO driver.impl :: Registered driver :h2 (parents: [:sql-jdbc]) 🚚
2024-04-11T16:44:17.829741+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:17,829 INFO driver.impl :: Registered driver :mysql (parents: [:sql-jdbc]) 🚚
2024-04-11T16:44:17.847539+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:17,847 INFO driver.impl :: Registered driver :postgres (parents: [:sql-jdbc]) 🚚
2024-04-11T16:44:18.731423+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,728 INFO metabase.core ::
2024-04-11T16:44:18.731513+09:00 <info> scorer-metabase-metabase1[1399]: Metabase v0.49.5-SNAPSHOT (0fdefcf)
2024-04-11T16:44:18.731534+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:18.731568+09:00 <info> scorer-metabase-metabase1[1399]: Copyright © 2024 Metabase, Inc.
2024-04-11T16:44:18.731584+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:18.731599+09:00 <info> scorer-metabase-metabase1[1399]: Metabase Enterprise Edition extensions are NOT PRESENT.
2024-04-11T16:44:18.733594+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,733 INFO metabase.core :: Starting Metabase in STANDALONE mode
2024-04-11T16:44:18.758927+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,758 INFO metabase.server :: Launching Embedded Jetty Webserver with config:
2024-04-11T16:44:18.758989+09:00 <info> scorer-metabase-metabase1[1399]:  {:port 3000}
2024-04-11T16:44:18.759011+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:18.785596+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,785 INFO metabase.core :: Starting Metabase version v0.49.5-SNAPSHOT (0fdefcf) ...
2024-04-11T16:44:18.788420+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,788 INFO metabase.core :: System info:
2024-04-11T16:44:18.788470+09:00 <info> scorer-metabase-metabase1[1399]:  {""file.encoding"" ""UTF-8"",
2024-04-11T16:44:18.788487+09:00 <info> scorer-metabase-metabase1[1399]:  ""java.runtime.name"" ""OpenJDK Runtime Environment"",
2024-04-11T16:44:18.788505+09:00 <info> scorer-metabase-metabase1[1399]:  ""java.runtime.version"" ""11.0.22+7-post-Ubuntu-0ubuntu222.04.1"",
2024-04-11T16:44:18.788522+09:00 <info> scorer-metabase-metabase1[1399]:  ""java.vendor"" ""Ubuntu"",
2024-04-11T16:44:18.788537+09:00 <info> scorer-metabase-metabase1[1399]:  ""java.vendor.url"" ""https://ubuntu.com/"",
2024-04-11T16:44:18.788552+09:00 <info> scorer-metabase-metabase1[1399]:  ""java.version"" ""11.0.22"",
2024-04-11T16:44:18.788569+09:00 <info> scorer-metabase-metabase1[1399]:  ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",
2024-04-11T16:44:18.788589+09:00 <info> scorer-metabase-metabase1[1399]:  ""java.vm.version"" ""11.0.22+7-post-Ubuntu-0ubuntu222.04.1"",
2024-04-11T16:44:18.788604+09:00 <info> scorer-metabase-metabase1[1399]:  ""os.name"" ""Linux"",
2024-04-11T16:44:18.788620+09:00 <info> scorer-metabase-metabase1[1399]:  ""os.version"" ""6.5.0-0.deb12.4-amd64"",
2024-04-11T16:44:18.788637+09:00 <info> scorer-metabase-metabase1[1399]:  ""user.language"" ""en"",
2024-04-11T16:44:18.788653+09:00 <info> scorer-metabase-metabase1[1399]:  ""user.timezone"" ""Asia/Tokyo""}
2024-04-11T16:44:18.788670+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:18.789345+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,789 INFO metabase.plugins :: Loading plugins in /root/plugins...
2024-04-11T16:44:18.965765+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,965 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...
2024-04-11T16:44:18.965988+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,965 INFO driver.impl :: Registered driver :mongo  🚚
2024-04-11T16:44:18.971028+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,970 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...
2024-04-11T16:44:18.971369+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,971 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚
2024-04-11T16:44:18.989608+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,989 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...
2024-04-11T16:44:18.990006+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,989 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚
2024-04-11T16:44:18.998461+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,998 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...
2024-04-11T16:44:18.998817+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:18,998 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚
2024-04-11T16:44:19.001751+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,001 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...
2024-04-11T16:44:19.002125+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,001 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚
2024-04-11T16:44:19.008789+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,008 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :athena...
2024-04-11T16:44:19.009120+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,008 INFO driver.impl :: Registered driver :athena (parents: [:sql-jdbc]) 🚚
2024-04-11T16:44:19.015044+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,014 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...
2024-04-11T16:44:19.015319+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,015 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚
2024-04-11T16:44:19.017772+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,017 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.
2024-04-11T16:44:19.017861+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:19.018572+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,018 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false
2024-04-11T16:44:19.018882+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,018 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver""]
2024-04-11T16:44:19.020948+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,020 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...
2024-04-11T16:44:19.021179+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,020 INFO driver.impl :: Registered driver :druid  🚚
2024-04-11T16:44:19.022880+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,022 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...
2024-04-11T16:44:19.023118+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,022 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚
2024-04-11T16:44:19.026188+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,025 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Oracle Driver due to required dependencies. Metabase requires the Oracle JDBC driver in order to connect to Oracle databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/oracle.html for more details.
2024-04-11T16:44:19.026267+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:44:19.026327+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,026 INFO plugins.dependencies :: Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? false
2024-04-11T16:44:19.026615+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,026 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver"" ""Metabase Oracle Driver""]
2024-04-11T16:44:19.030957+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,030 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...
2024-04-11T16:44:19.031196+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,031 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚
2024-04-11T16:44:19.031390+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,031 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...
2024-04-11T16:44:19.031604+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,031 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚
2024-04-11T16:44:19.034693+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,034 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...
2024-04-11T16:44:19.035020+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,034 INFO driver.impl :: Registered driver :googleanalytics  🚚
2024-04-11T16:44:19.039420+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,039 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
2024-04-11T16:44:19.040656+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:19,040 INFO db.setup :: Verifying mysql Database Connection ...
2024-04-11T16:44:28.214514+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:28,214 INFO db.setup :: Successfully verified MySQL 8.0.36-0ubuntu0.22.04.1 application database connection. ✅
2024-04-11T16:44:28.214618+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:28,214 INFO db.setup :: Checking if a database downgrade is required...
2024-04-11T16:44:31.326028+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:31,325 INFO db.setup :: Running Database Migrations...
2024-04-11T16:44:31.326322+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:31,326 INFO db.setup :: Setting up Liquibase...
2024-04-11T16:44:31.463637+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:31,463 INFO db.setup :: Liquibase is ready.
2024-04-11T16:44:31.463775+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:31,463 INFO db.liquibase :: Checking if Database has unrun migrations...
2024-04-11T16:44:31.709344+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:31,708 INFO db.liquibase :: Database has unrun migrations. Checking if migraton lock is taken...
2024-04-11T16:44:31.714864+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:31,714 INFO db.liquibase :: No migration lock found.
2024-04-11T16:44:31.820141+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:44:31,819 INFO db.liquibase :: Running 277 migrations ...
2024-04-11T16:49:33.807903+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:33,807 INFO impl.StdSchedulerFactory :: Using default implementation for ThreadExecutor
2024-04-11T16:49:33.813980+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:33,813 INFO core.SchedulerSignalerImpl :: Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2024-04-11T16:49:33.814042+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:33,813 INFO core.QuartzScheduler :: Quartz Scheduler v.2.3.2 created.
2024-04-11T16:49:33.814448+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:33,814 INFO jdbcjobstore.JobStoreTX :: Using db table-based data access locking (synchronization).
2024-04-11T16:49:33.815224+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:33,815 INFO jdbcjobstore.JobStoreTX :: JobStoreTX initialized.
2024-04-11T16:49:33.815576+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:33,815 INFO core.QuartzScheduler :: Scheduler meta-data: Quartz Scheduler (v2.3.2) 'MetabaseScheduler' with instanceId '32c4e4be24631712821773808'
2024-04-11T16:49:33.815606+09:00 <info> scorer-metabase-metabase1[1399]:   Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
2024-04-11T16:49:33.815633+09:00 <info> scorer-metabase-metabase1[1399]:   NOT STARTED.
2024-04-11T16:49:33.815662+09:00 <info> scorer-metabase-metabase1[1399]:   Currently in standby mode.
2024-04-11T16:49:33.815692+09:00 <info> scorer-metabase-metabase1[1399]:   Number of jobs executed: 0
2024-04-11T16:49:33.815737+09:00 <info> scorer-metabase-metabase1[1399]:   Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
2024-04-11T16:49:33.815769+09:00 <info> scorer-metabase-metabase1[1399]:   Using job-store 'org.quartz.impl.jdbcjobstore.JobStoreTX' - which supports persistence. and is clustered.
2024-04-11T16:49:33.815791+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:49:33.815818+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:33,815 INFO impl.StdSchedulerFactory :: Quartz scheduler 'MetabaseScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2024-04-11T16:49:33.815846+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:33,815 INFO impl.StdSchedulerFactory :: Quartz scheduler version: 2.3.2
2024-04-11T16:49:34.061489+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:34,060 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 started.
2024-04-11T16:49:34.180164+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:34,179 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 shutting down.
2024-04-11T16:49:34.180239+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:34,179 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 paused.
2024-04-11T16:49:34.180785+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:49:34,180 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 shutdown complete.
2024-04-11T16:50:10.718577+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:50:10,717 INFO db.custom-migrations :: No forward migration for DowngradeDashboardTab
2024-04-11T16:56:04.665379+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,664 INFO impl.StdSchedulerFactory :: Using default implementation for ThreadExecutor
2024-04-11T16:56:04.666060+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,665 INFO core.SchedulerSignalerImpl :: Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2024-04-11T16:56:04.666132+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,665 INFO core.QuartzScheduler :: Quartz Scheduler v.2.3.2 created.
2024-04-11T16:56:04.666158+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,666 INFO jdbcjobstore.JobStoreTX :: Using db table-based data access locking (synchronization).
2024-04-11T16:56:04.666202+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,666 INFO jdbcjobstore.JobStoreTX :: JobStoreTX initialized.
2024-04-11T16:56:04.666275+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,666 INFO core.QuartzScheduler :: Scheduler meta-data: Quartz Scheduler (v2.3.2) 'MetabaseScheduler' with instanceId '32c4e4be24631712822164665'
2024-04-11T16:56:04.666302+09:00 <info> scorer-metabase-metabase1[1399]:   Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
2024-04-11T16:56:04.666327+09:00 <info> scorer-metabase-metabase1[1399]:   NOT STARTED.
2024-04-11T16:56:04.666349+09:00 <info> scorer-metabase-metabase1[1399]:   Currently in standby mode.
2024-04-11T16:56:04.666370+09:00 <info> scorer-metabase-metabase1[1399]:   Number of jobs executed: 0
2024-04-11T16:56:04.666390+09:00 <info> scorer-metabase-metabase1[1399]:   Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
2024-04-11T16:56:04.666420+09:00 <info> scorer-metabase-metabase1[1399]:   Using job-store 'org.quartz.impl.jdbcjobstore.JobStoreTX' - which supports persistence. and is clustered.
2024-04-11T16:56:04.666443+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:56:04.666466+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,666 INFO impl.StdSchedulerFactory :: Quartz scheduler 'MetabaseScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2024-04-11T16:56:04.666491+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,666 INFO impl.StdSchedulerFactory :: Quartz scheduler version: 2.3.2
2024-04-11T16:56:04.667830+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,667 INFO jdbcjobstore.JobStoreTX :: ClusterManager: detected 1 failed or restarted instances.
2024-04-11T16:56:04.667871+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,667 INFO jdbcjobstore.JobStoreTX :: ClusterManager: Scanning for instance ""32c4e4be24631712821773808""'s failed in-progress jobs.
2024-04-11T16:56:04.773028+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,772 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 started.
2024-04-11T16:56:04.775832+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,775 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 shutting down.
2024-04-11T16:56:04.775954+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,775 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 paused.
2024-04-11T16:56:04.776517+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:04,776 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 shutdown complete.
2024-04-11T16:56:04.919447+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:56:04.919499+09:00 <info> scorer-metabase-metabase1[1399]: UPDATE SUMMARY
2024-04-11T16:56:04.919519+09:00 <info> scorer-metabase-metabase1[1399]: Run:                        277
2024-04-11T16:56:04.919537+09:00 <info> scorer-metabase-metabase1[1399]: Previously run:               0
2024-04-11T16:56:04.919554+09:00 <info> scorer-metabase-metabase1[1399]: Filtered out:                 5
2024-04-11T16:56:04.919571+09:00 <info> scorer-metabase-metabase1[1399]: -------------------------------
2024-04-11T16:56:04.919587+09:00 <info> scorer-metabase-metabase1[1399]: Total change sets:          282
2024-04-11T16:56:04.919607+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:56:04.919623+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:56:04.919638+09:00 <info> scorer-metabase-metabase1[1399]: FILTERED CHANGE SETS SUMMARY
2024-04-11T16:56:04.919654+09:00 <info> scorer-metabase-metabase1[1399]: DBMS mismatch:                5
2024-04-11T16:56:04.919670+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:56:05.257159+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,256 INFO db.liquibase :: Migration complete in 11.6 mins
2024-04-11T16:56:05.257425+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,257 INFO db.setup :: Database Migrations Current ...  ✅
2024-04-11T16:56:05.257853+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,257 INFO metabase.util :: Database setup took 11.8 mins
2024-04-11T16:56:05.273818+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,273 INFO metabase.core :: Looks like this is a new installation ... preparing setup wizard
2024-04-11T16:56:05.792473+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,792 INFO metabase.core :: Please use the following URL to setup your Metabase installation:
2024-04-11T16:56:05.792574+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:56:05.792597+09:00 <info> scorer-metabase-metabase1[1399]: http://localhost:3000/setup/
2024-04-11T16:56:05.792618+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:56:05.792636+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:56:05.802139+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,801 INFO metabase.events :: Loading events namespace: metabase.events.audit-log 👂
2024-04-11T16:56:05.820714+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,820 INFO metabase.events :: Loading events namespace: metabase.events.driver-notifications 👂
2024-04-11T16:56:05.826669+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,826 INFO metabase.events :: Loading events namespace: metabase.events.last-login 👂
2024-04-11T16:56:05.830860+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,830 INFO metabase.events :: Loading events namespace: metabase.events.persisted-info 👂
2024-04-11T16:56:05.839344+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,839 INFO metabase.events :: Loading events namespace: metabase.events.recent-views 👂
2024-04-11T16:56:05.844354+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,844 INFO metabase.events :: Loading events namespace: metabase.events.revision 👂
2024-04-11T16:56:05.866676+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,866 INFO metabase.events :: Loading events namespace: metabase.events.schema 👂
2024-04-11T16:56:05.866742+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,866 INFO metabase.events :: Loading events namespace: metabase.events.sync-database 👂
2024-04-11T16:56:05.870530+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,870 INFO metabase.events :: Loading events namespace: metabase.events.view-log 👂
2024-04-11T16:56:05.902205+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,901 INFO metabase.sample-data :: Loading sample database
2024-04-11T16:56:05.937930+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,937 INFO util.files :: Extract file /sample-database.db.mv.db -> /root/plugins/sample-database.db.mv.db
2024-04-11T16:56:05.962015+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,961 INFO driver.impl :: Initializing driver :sql...
2024-04-11T16:56:05.962146+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,962 INFO driver.impl :: Initializing driver :sql-jdbc...
2024-04-11T16:56:05.962277+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,962 INFO driver.impl :: Initializing driver :mysql...
2024-04-11T16:56:05.979401+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:05,979 INFO driver.impl :: Initializing driver :h2...
2024-04-11T16:56:06.056642+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:06,056 INFO task.sync-databases :: Scheduling sync/analyze for database 1: trigger: metabase.task.sync-and-analyze.trigger.1
2024-04-11T16:56:06.056698+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:06,056 INFO task.sync-databases :: Scheduling field-values for database 1: trigger: metabase.task.update-field-values.trigger.1
2024-04-11T16:56:06.259790+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:06,259 INFO sync.util :: STARTING: Sync h2 Database 1 ''Sample Database''
2024-04-11T16:56:06.260423+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:06,260 INFO sync.util :: STARTING: Sync metadata for h2 Database 1 ''Sample Database''
2024-04-11T16:56:06.429781+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:06,429 INFO sync.util :: STARTING: step ''sync-dbms-version'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:06.616834+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:06,616 INFO sync.util :: FINISHED: step ''sync-dbms-version'' for h2 Database 1 ''Sample Database'' (186.8 ms)
2024-04-11T16:56:06.616911+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:06,616 INFO sync.util :: STARTING: step ''sync-timezone'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:06.617442+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:06,617 INFO sync-metadata.sync-timezone :: :h2 database 1 default timezone is ""Asia/Tokyo""
2024-04-11T16:56:06.809003+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:06,808 INFO sync.util :: FINISHED: step ''sync-timezone'' for h2 Database 1 ''Sample Database'' (191.7 ms)
2024-04-11T16:56:06.809063+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:06,808 INFO sync.util :: STARTING: step ''sync-tables'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:06.821372+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:06,821 INFO sync-metadata.tables :: Found new tables: (Table  ''PUBLIC.ANALYTIC_EVENTS'' Table  ''PUBLIC.FEEDBACK'' Table  ''PUBLIC.PEOPLE'' Table  ''PUBLIC.REVIEWS'' Table  ''PUBLIC.ORDERS'' Table  ''PUBLIC.ACCOUNTS'' Table  ''PUBLIC.INVOICES'' Table  ''PUBLIC.PRODUCTS'')
2024-04-11T16:56:08.663531+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:08,663 INFO sync-metadata.tables :: Updating table metadata for Table 8 ''PUBLIC.PRODUCTS''
2024-04-11T16:56:08.663616+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:08,663 INFO sync-metadata.tables :: Updating table metadata for Table 3 ''PUBLIC.PEOPLE''
2024-04-11T16:56:08.663651+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:08,663 INFO sync-metadata.tables :: Updating table metadata for Table 7 ''PUBLIC.INVOICES''
2024-04-11T16:56:08.663680+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:08,663 INFO sync-metadata.tables :: Updating table metadata for Table 5 ''PUBLIC.ORDERS''
2024-04-11T16:56:08.663804+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:08,663 INFO sync-metadata.tables :: Updating table metadata for Table 4 ''PUBLIC.REVIEWS''
2024-04-11T16:56:08.663845+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:08,663 INFO sync-metadata.tables :: Updating table metadata for Table 2 ''PUBLIC.FEEDBACK''
2024-04-11T16:56:08.663906+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:08,663 INFO sync-metadata.tables :: Updating table metadata for Table 1 ''PUBLIC.ANALYTIC_EVENTS''
2024-04-11T16:56:08.663985+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:08,663 INFO sync-metadata.tables :: Updating table metadata for Table 6 ''PUBLIC.ACCOUNTS''
2024-04-11T16:56:08.844806+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:08,844 INFO sync.util :: FINISHED: step ''sync-tables'' for h2 Database 1 ''Sample Database'' (2.0 s)
2024-04-11T16:56:08.844871+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:08,844 INFO sync.util :: STARTING: step ''sync-fields'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:10.606442+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:10,605 INFO sync.util :: FINISHED: step ''sync-fields'' for h2 Database 1 ''Sample Database'' (1.8 s)
2024-04-11T16:56:10.608586+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:10,606 INFO sync.util :: STARTING: step ''sync-fks'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:10.998742+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:10,998 INFO sync-metadata.fks :: Marking foreign key from Table  ''PUBLIC.ANALYTIC_EVENTS'' Field  ''ACCOUNT_ID'' -> Table  ''PUBLIC.ANALYTIC_EVENTS'' Field  ''ID''
2024-04-11T16:56:11.458447+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:11,457 INFO sync-metadata.fks :: Marking foreign key from Table  ''PUBLIC.FEEDBACK'' Field  ''ACCOUNT_ID'' -> Table  ''PUBLIC.FEEDBACK'' Field  ''ID''
2024-04-11T16:56:11.742714+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:11,741 INFO sync-metadata.fks :: Marking foreign key from Table  ''PUBLIC.INVOICES'' Field  ''ACCOUNT_ID'' -> Table  ''PUBLIC.INVOICES'' Field  ''ID''
2024-04-11T16:56:11.850742+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:11,849 INFO sync-metadata.fks :: Marking foreign key from Table  ''PUBLIC.ORDERS'' Field  ''USER_ID'' -> Table  ''PUBLIC.ORDERS'' Field  ''ID''
2024-04-11T16:56:11.975996+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:11,974 INFO sync-metadata.fks :: Marking foreign key from Table  ''PUBLIC.ORDERS'' Field  ''PRODUCT_ID'' -> Table  ''PUBLIC.ORDERS'' Field  ''ID''
2024-04-11T16:56:12.251247+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:12,250 INFO sync-metadata.fks :: Marking foreign key from Table  ''PUBLIC.REVIEWS'' Field  ''PRODUCT_ID'' -> Table  ''PUBLIC.REVIEWS'' Field  ''ID''
2024-04-11T16:56:12.443983+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:12,443 INFO sync.util :: FINISHED: step ''sync-fks'' for h2 Database 1 ''Sample Database'' (1.8 s)
2024-04-11T16:56:12.444508+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:12,443 INFO sync.util :: STARTING: step ''sync-indexes'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:12.482607+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:12,482 INFO sync-metadata.indexes :: Marking Field 7 as indexed
2024-04-11T16:56:12.685035+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:12,684 INFO sync-metadata.indexes :: Marking Field 20 as indexed
2024-04-11T16:56:12.685124+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:12,684 INFO sync-metadata.indexes :: Marking Field 21 as indexed
2024-04-11T16:56:12.938871+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:12,938 INFO sync-metadata.indexes :: Marking Field 24 as indexed
2024-04-11T16:56:12.938922+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:12,938 INFO sync-metadata.indexes :: Marking Field 25 as indexed
2024-04-11T16:56:13.215857+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:13,215 INFO sync-metadata.indexes :: Marking Field 31 as indexed
2024-04-11T16:56:13.215921+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:13,215 INFO sync-metadata.indexes :: Marking Field 32 as indexed
2024-04-11T16:56:13.424970+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:13,424 INFO sync-metadata.indexes :: Marking Field 40 as indexed
2024-04-11T16:56:13.425043+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:13,424 INFO sync-metadata.indexes :: Marking Field 43 as indexed
2024-04-11T16:56:13.425075+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:13,424 INFO sync-metadata.indexes :: Marking Field 37 as indexed
2024-04-11T16:56:13.558553+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:13,558 INFO sync-metadata.indexes :: Marking Field 46 as indexed
2024-04-11T16:56:13.742229+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:13,741 INFO sync-metadata.indexes :: Marking Field 62 as indexed
2024-04-11T16:56:13.874965+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:13,874 INFO sync-metadata.indexes :: Marking Field 68 as indexed
2024-04-11T16:56:13.875052+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:13,874 INFO sync-metadata.indexes :: Marking Field 71 as indexed
2024-04-11T16:56:14.295921+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:14,295 INFO sync.util :: FINISHED: step ''sync-indexes'' for h2 Database 1 ''Sample Database'' (1.9 s)
2024-04-11T16:56:14.296000+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:14,295 INFO sync.util :: STARTING: step ''sync-metabase-metadata'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:25.648685+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:25,648 INFO sync.util :: FINISHED: step ''sync-metabase-metadata'' for h2 Database 1 ''Sample Database'' (11.4 s)
2024-04-11T16:56:25.648763+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:25,648 INFO sync.util :: STARTING: step ''sync-table-privileges'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:25.648794+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:25,648 INFO sync.util :: FINISHED: step ''sync-table-privileges'' for h2 Database 1 ''Sample Database'' (126.3 µs)
2024-04-11T16:56:27.218811+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:27,218 INFO sync.util :: FINISHED: Sync metadata for h2 Database 1 ''Sample Database'' (21.0 s)
2024-04-11T16:56:27.219890+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:27,219 INFO sync.util :: STARTING: Analyze data for h2 Database 1 ''Sample Database''
2024-04-11T16:56:27.223387+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:27,223 INFO sync.util :: STARTING: step ''fingerprint-fields'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:32.578138+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:32,577 INFO sync.analyze :: fingerprint-fields Analyzed [*****·············································] 😢   12% Table 2 ''PUBLIC.FEEDBACK''
2024-04-11T16:56:36.643535+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:36,642 INFO sync.analyze :: fingerprint-fields Analyzed [***********·······································] 😒   24% Table 3 ''PUBLIC.PEOPLE''
2024-04-11T16:56:41.558454+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:41,557 INFO sync.util :: FINISHED: step ''fingerprint-fields'' for h2 Database 1 ''Sample Database'' (14.3 s)
2024-04-11T16:56:41.558529+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:41,558 INFO sync.util :: STARTING: step ''classify-fields'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:43.887035+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:43,886 INFO sync.analyze :: classify-fields Analyzed [******************································] 😕   36% Table 6 ''PUBLIC.ACCOUNTS''
2024-04-11T16:56:45.906589+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:45,906 INFO sync.analyze :: classify-fields Analyzed [***********************···························] 😬   48% Table 7 ''PUBLIC.INVOICES''
2024-04-11T16:56:49.213049+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:49,212 INFO sync.analyze :: classify-fields Analyzed [******************************····················] 😌   60% Table 8 ''PUBLIC.PRODUCTS''
2024-04-11T16:56:49.789075+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:49,788 INFO sync.util :: FINISHED: step ''classify-fields'' for h2 Database 1 ''Sample Database'' (8.2 s)
2024-04-11T16:56:49.789151+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:49,788 INFO sync.util :: STARTING: step ''classify-tables'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:50.132715+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:50,131 INFO sync.analyze :: classify-tables Analyzed [************************************··············] 😋   72% Table 1 ''PUBLIC.ANALYTIC_EVENTS''
2024-04-11T16:56:51.023598+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:51,023 INFO sync.analyze :: classify-tables Analyzed [*****************************************·········] 😊   84% Table 5 ''PUBLIC.ORDERS''
2024-04-11T16:56:51.799859+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:51,799 INFO sync.analyze :: classify-tables Analyzed [***********************************************···] 😎   96% Table 4 ''PUBLIC.REVIEWS''
2024-04-11T16:56:51.800003+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:51,799 INFO sync.util :: FINISHED: step ''classify-tables'' for h2 Database 1 ''Sample Database'' (2.0 s)
2024-04-11T16:56:53.145817+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:53,144 INFO sync.util :: FINISHED: Analyze data for h2 Database 1 ''Sample Database'' (25.9 s)
2024-04-11T16:56:53.149057+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:53,148 INFO sync.util :: STARTING: Cache field values in h2 Database 1 ''Sample Database''
2024-04-11T16:56:53.158977+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:53,158 INFO sync.util :: STARTING: step ''delete-expired-advanced-field-values'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:53.319502+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:53,319 INFO sync.util :: FINISHED: step ''delete-expired-advanced-field-values'' for h2 Database 1 ''Sample Database'' (160.9 ms)
2024-04-11T16:56:53.319567+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:53,319 INFO sync.util :: STARTING: step ''update-field-values'' for h2 Database 1 ''Sample Database''
2024-04-11T16:56:56.566923+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:56,566 INFO models.field-values :: Field BODY was previously automatically set to show a list widget, but now has 231 values. Switching Field to use a search widget instead.
2024-04-11T16:57:01.698954+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:01,698 INFO sync.util :: FINISHED: step ''update-field-values'' for h2 Database 1 ''Sample Database'' (8.4 s)
2024-04-11T16:57:03.011535+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,011 INFO sync.util :: FINISHED: Cache field values in h2 Database 1 ''Sample Database'' (9.9 s)
2024-04-11T16:57:03.012228+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,011 INFO sync.util :: FINISHED: Sync h2 Database 1 ''Sample Database'' (56.8 s)
2024-04-11T16:57:03.013586+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,013 INFO impl.StdSchedulerFactory :: Using default implementation for ThreadExecutor
2024-04-11T16:57:03.014336+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,014 INFO core.SchedulerSignalerImpl :: Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2024-04-11T16:57:03.014381+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,014 INFO core.QuartzScheduler :: Quartz Scheduler v.2.3.2 created.
2024-04-11T16:57:03.014411+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,014 INFO jdbcjobstore.JobStoreTX :: Using db table-based data access locking (synchronization).
2024-04-11T16:57:03.014510+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,014 INFO jdbcjobstore.JobStoreTX :: JobStoreTX initialized.
2024-04-11T16:57:03.014559+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,014 INFO core.QuartzScheduler :: Scheduler meta-data: Quartz Scheduler (v2.3.2) 'MetabaseScheduler' with instanceId '32c4e4be24631712822223013'
2024-04-11T16:57:03.014581+09:00 <info> scorer-metabase-metabase1[1399]:   Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
2024-04-11T16:57:03.014617+09:00 <info> scorer-metabase-metabase1[1399]:   NOT STARTED.
2024-04-11T16:57:03.014638+09:00 <info> scorer-metabase-metabase1[1399]:   Currently in standby mode.
2024-04-11T16:57:03.014666+09:00 <info> scorer-metabase-metabase1[1399]:   Number of jobs executed: 0
2024-04-11T16:57:03.014688+09:00 <info> scorer-metabase-metabase1[1399]:   Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
2024-04-11T16:57:03.014711+09:00 <info> scorer-metabase-metabase1[1399]:   Using job-store 'org.quartz.impl.jdbcjobstore.JobStoreTX' - which supports persistence. and is clustered.
2024-04-11T16:57:03.014736+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T16:57:03.014763+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,014 INFO impl.StdSchedulerFactory :: Quartz scheduler 'MetabaseScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2024-04-11T16:57:03.014789+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,014 INFO impl.StdSchedulerFactory :: Quartz scheduler version: 2.3.2
2024-04-11T16:57:03.054844+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,054 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822223013 paused.
2024-04-11T16:57:03.054914+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,054 INFO metabase.task :: Task scheduler initialized into standby mode.
2024-04-11T16:57:03.055276+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,055 INFO metabase.task :: Initializing task SyncDatabases
2024-04-11T16:57:03.761208+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,760 INFO models.database :: :h2 Database 'Sample Database' sync/analyze schedules have changed!
2024-04-11T16:57:03.761285+09:00 <info> scorer-metabase-metabase1[1399]:  Sync metadata was: '0 50 * * * ? *' is now: '0 24 * * * ? *'
2024-04-11T16:57:03.761312+09:00 <info> scorer-metabase-metabase1[1399]:  Cache FieldValues was: '0 50 0 * * ? *', is now: '0 0 22 * * ? *'
2024-04-11T16:57:03.767501+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:03,767 INFO task.sync-databases :: Scheduling sync/analyze for database 1: trigger: metabase.task.sync-and-analyze.trigger.1
2024-04-11T16:57:04.151277+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:04,150 INFO task.sync-databases :: Scheduling field-values for database 1: trigger: metabase.task.update-field-values.trigger.1
2024-04-11T16:57:04.735778+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:04,735 INFO task.sync-databases :: Updated default schedules for %d databases 1
2024-04-11T16:57:04.735892+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:04,735 INFO metabase.task :: Initializing task PersistRefresh
2024-04-11T16:57:04.997225+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:04,996 INFO metabase.task :: Initializing task CheckForNewVersions
2024-04-11T16:57:05.253767+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:05,253 INFO metabase.task :: Initializing task PersistPrune
2024-04-11T16:57:05.772945+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:05,772 INFO metabase.task :: Initializing task SendAnonymousUsageStats
2024-04-11T16:57:06.046062+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:06,045 INFO metabase.task :: Initializing task ModelIndexValues
2024-04-11T16:57:06.379344+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:06,379 INFO metabase.task :: Initializing task RefreshSlackChannelsAndUsers
2024-04-11T16:57:07.490699+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:07,490 INFO metabase.task :: Initializing task TruncateAuditTables
2024-04-11T16:57:07.877791+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:07,877 INFO metabase.task :: Initializing task SendPulses
2024-04-11T16:57:08.515910+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:08,515 INFO metabase.task :: Initializing task SendFollowUpEmails
2024-04-11T16:57:08.816542+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:08,816 INFO metabase.task :: Initializing task SendCreatorSentimentEmails
2024-04-11T16:57:09.249571+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:09,249 INFO metabase.task :: Initializing task TaskHistoryCleanup
2024-04-11T16:57:09.678566+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:09,678 INFO metabase.task :: Initializing task SendWarnPulseRemovalEmail
2024-04-11T16:57:10.002140+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:10,001 INFO jdbcjobstore.JobStoreTX :: ClusterManager: detected 1 failed or restarted instances.
2024-04-11T16:57:10.002221+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:10,001 INFO jdbcjobstore.JobStoreTX :: ClusterManager: Scanning for instance ""32c4e4be24631712822164665""'s failed in-progress jobs.
2024-04-11T16:57:10.351640+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:10,351 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822223013 started.
2024-04-11T16:57:10.351780+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:10,351 INFO metabase.task :: Task scheduler started
2024-04-11T16:57:10.352246+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:10,352 INFO metabase.core :: Metabase Initialization COMPLETE in 13.0 mins
2024-04-11T16:57:11.205428+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:57:11,204 INFO task.refresh-slack-channel-user-cache :: Slack is not configured, not refreshing slack user/channel cache.
2024-04-11T17:00:00.110336+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:00:00,110 INFO task.send-pulses :: Sending scheduled pulses...
2024-04-11T17:12:19.353943+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:12:19,353 INFO middleware.misc :: Setting Metabase site URL to 192.168.10.146
2024-04-11T17:12:20.369139+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:12:20,368 INFO i18n.impl :: Reading available locales from locales.clj...
2024-04-11T17:12:20.441907+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:12:20,441 INFO util.fonts :: Reading available fonts from /frontend_client/app/fonts
2024-04-11T17:12:22.592232+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:12:22,591 DEBUG middleware.log :: GET /api/user/current 401 847.3 µs (0 DB calls)
2024-04-11T17:12:22.592315+09:00 <info> scorer-metabase-metabase1[1399]: ""Unauthenticated""
2024-04-11T17:12:22.592340+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T17:12:22.602955+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:12:22,602 DEBUG middleware.log :: GET /api/session/properties 200 8.3 ms (2 DB calls) App DB connections: 2/7 Jetty threads: 6/50 (1 idle, 0 queued) (53 total active threads) Queries in flight: 0 (0 queued)
2024-04-11T17:24:00.267550+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,267 INFO task.sync-databases :: Starting sync task for Database 1.
2024-04-11T17:24:00.273608+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,273 INFO sync.util :: STARTING: Sync metadata for h2 Database 1 ''Sample Database''
2024-04-11T17:24:00.277173+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,276 INFO sync.util :: STARTING: step ''sync-dbms-version'' for h2 Database 1 ''Sample Database''
2024-04-11T17:24:00.277444+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,277 INFO sync.util :: FINISHED: step ''sync-dbms-version'' for h2 Database 1 ''Sample Database'' (323.4 µs)
2024-04-11T17:24:00.277538+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,277 INFO sync.util :: STARTING: step ''sync-timezone'' for h2 Database 1 ''Sample Database''
2024-04-11T17:24:00.277575+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,277 INFO sync-metadata.sync-timezone :: :h2 database 1 default timezone is ""Asia/Tokyo""
2024-04-11T17:24:00.277703+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,277 INFO sync.util :: FINISHED: step ''sync-timezone'' for h2 Database 1 ''Sample Database'' (153.9 µs)
2024-04-11T17:24:00.277778+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,277 INFO sync.util :: STARTING: step ''sync-tables'' for h2 Database 1 ''Sample Database''
2024-04-11T17:24:00.280942+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,280 INFO sync-metadata.tables :: Updating table metadata for Table 8 ''PUBLIC.PRODUCTS''
2024-04-11T17:24:00.281000+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,280 INFO sync-metadata.tables :: Updating table metadata for Table 3 ''PUBLIC.PEOPLE''
2024-04-11T17:24:00.281067+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,280 INFO sync-metadata.tables :: Updating table metadata for Table 7 ''PUBLIC.INVOICES''
2024-04-11T17:24:00.281143+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,281 INFO sync-metadata.tables :: Updating table metadata for Table 5 ''PUBLIC.ORDERS''
2024-04-11T17:24:00.281222+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,281 INFO sync-metadata.tables :: Updating table metadata for Table 4 ''PUBLIC.REVIEWS''
2024-04-11T17:24:00.281322+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,281 INFO sync-metadata.tables :: Updating table metadata for Table 2 ''PUBLIC.FEEDBACK''
2024-04-11T17:24:00.281435+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,281 INFO sync-metadata.tables :: Updating table metadata for Table 1 ''PUBLIC.ANALYTIC_EVENTS''
2024-04-11T17:24:00.281543+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,281 INFO sync-metadata.tables :: Updating table metadata for Table 6 ''PUBLIC.ACCOUNTS''
2024-04-11T17:24:00.281719+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,281 INFO sync.util :: FINISHED: step ''sync-tables'' for h2 Database 1 ''Sample Database'' (3.8 ms)
2024-04-11T17:24:00.281790+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,281 INFO sync.util :: STARTING: step ''sync-fields'' for h2 Database 1 ''Sample Database''
2024-04-11T17:24:00.338727+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,338 INFO sync.util :: FINISHED: step ''sync-fields'' for h2 Database 1 ''Sample Database'' (56.6 ms)
2024-04-11T17:24:00.338782+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,338 INFO sync.util :: STARTING: step ''sync-fks'' for h2 Database 1 ''Sample Database''
2024-04-11T17:24:00.750859+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,750 INFO sync.util :: FINISHED: step ''sync-fks'' for h2 Database 1 ''Sample Database'' (411.8 ms)
2024-04-11T17:24:00.750936+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,750 INFO sync.util :: STARTING: step ''sync-indexes'' for h2 Database 1 ''Sample Database''
2024-04-11T17:24:00.775559+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,775 INFO sync.util :: FINISHED: step ''sync-indexes'' for h2 Database 1 ''Sample Database'' (24.4 ms)
2024-04-11T17:24:00.775624+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:00,775 INFO sync.util :: STARTING: step ''sync-metabase-metadata'' for h2 Database 1 ''Sample Database''
2024-04-11T17:24:23.196711+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:23,196 INFO sync.util :: FINISHED: step ''sync-metabase-metadata'' for h2 Database 1 ''Sample Database'' (22.4 s)
2024-04-11T17:24:23.196808+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:23,196 INFO sync.util :: STARTING: step ''sync-table-privileges'' for h2 Database 1 ''Sample Database''
2024-04-11T17:24:23.196837+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:23,196 INFO sync.util :: FINISHED: step ''sync-table-privileges'' for h2 Database 1 ''Sample Database'' (102.0 µs)
2024-04-11T17:24:26.742051+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,741 INFO sync.util :: FINISHED: Sync metadata for h2 Database 1 ''Sample Database'' (26.5 s)
2024-04-11T17:24:26.742414+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,742 INFO sync.util :: STARTING: Analyze data for h2 Database 1 ''Sample Database''
2024-04-11T17:24:26.744838+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,744 INFO sync.util :: STARTING: step ''fingerprint-fields'' for h2 Database 1 ''Sample Database''
2024-04-11T17:24:26.749296+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,748 INFO sync.analyze :: fingerprint-fields Analyzed [*****·············································] 😢   12% Table 2 ''PUBLIC.FEEDBACK''
2024-04-11T17:24:26.753202+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,752 INFO sync.analyze :: fingerprint-fields Analyzed [***********·······································] 😒   24% Table 3 ''PUBLIC.PEOPLE''
2024-04-11T17:24:26.757497+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,757 INFO sync.util :: FINISHED: step ''fingerprint-fields'' for h2 Database 1 ''Sample Database'' (12.5 ms)
2024-04-11T17:24:26.757609+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,757 INFO sync.util :: STARTING: step ''classify-fields'' for h2 Database 1 ''Sample Database''
2024-04-11T17:24:26.759058+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,758 INFO sync.analyze :: classify-fields Analyzed [******************································] 😕   36% Table 6 ''PUBLIC.ACCOUNTS''
2024-04-11T17:24:26.762270+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,761 INFO sync.analyze :: classify-fields Analyzed [***********************···························] 😬   48% Table 7 ''PUBLIC.INVOICES''
2024-04-11T17:24:26.765756+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,765 INFO sync.analyze :: classify-fields Analyzed [******************************····················] 😌   60% Table 8 ''PUBLIC.PRODUCTS''
2024-04-11T17:24:26.766776+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,766 INFO sync.util :: FINISHED: step ''classify-fields'' for h2 Database 1 ''Sample Database'' (9.1 ms)
2024-04-11T17:24:26.766836+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,766 INFO sync.util :: STARTING: step ''classify-tables'' for h2 Database 1 ''Sample Database''
2024-04-11T17:24:26.767055+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,766 INFO sync.analyze :: classify-tables Analyzed [************************************··············] 😋   72% Table 1 ''PUBLIC.ANALYTIC_EVENTS''
2024-04-11T17:24:26.768728+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,768 INFO sync.analyze :: classify-tables Analyzed [*****************************************·········] 😊   84% Table 5 ''PUBLIC.ORDERS''
2024-04-11T17:24:26.768891+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,768 INFO sync.analyze :: classify-tables Analyzed [***********************************************···] 😎   96% Table 4 ''PUBLIC.REVIEWS''
2024-04-11T17:24:26.768997+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:26,768 INFO sync.util :: FINISHED: step ''classify-tables'' for h2 Database 1 ''Sample Database'' (2.1 ms)
2024-04-11T17:24:28.575124+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:24:28,574 INFO sync.util :: FINISHED: Analyze data for h2 Database 1 ''Sample Database'' (1.8 s)
2024-04-11T17:31:39.972249+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:31:39,971 DEBUG middleware.log :: GET /api/user/current 401 135.9 µs (0 DB calls)
2024-04-11T17:31:39.972332+09:00 <info> scorer-metabase-metabase1[1399]: ""Unauthenticated""
2024-04-11T17:31:39.972354+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T17:31:39.982383+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:31:39,982 DEBUG middleware.log :: GET /api/session/properties 200 6.0 ms (2 DB calls) App DB connections: 2/7 Jetty threads: 6/50 (1 idle, 0 queued) (55 total active threads) Queries in flight: 0 (0 queued)
root@DEB-SystemPr-f02f74b24382:~#
```


**Metabase dashboard should be opened :** 

![image](https://github.com/metabase/metabase/assets/87641643/59013d9c-1cf8-470d-b5b9-66676360d04f)


![image](https://github.com/metabase/metabase/assets/87641643/bc15ff44-3875-4791-95ec-32e4cb4536a2)



### Logs

I have added the complete logs please check below: 
- [debian_nvidia_metabase.log](https://github.com/metabase/metabase/files/14943929/debian_nvidia_metabase.log)
- [debian_nvidia_metabase_mysql_log](https://github.com/metabase/metabase/files/14943935/debian_nvidia_metabase_mysql_log.txt)


### Information about your Metabase installation

```JSON
- Browser : Microsoft Edge & Google Chrome 
- Operating System: Ubuntu 22.04
- Kernel Version : 6.5.0-0.deb12.4-amd64
- Data Base:  MYSQL 8.0.36-0ubuntu0.22.04.1
- Meta Base Version : v1.49.4
- Meta Base Hosting Environment : Build from source code.
- CUDA Version 12.1.0
- Java : openjdk-11-jdk
- NodeJS : 20.12.2
- clojure Version : linux-install-1.10.3.998.sh
```


### Severity

default

### Additional context

_No response_",fti-sfuke,2024-04-11 12:49:02+00:00,[],2024-04-22 09:19:45+00:00,2024-04-22 09:19:44+00:00,https://github.com/metabase/metabase/issues/41310,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2049634404, 'issue_id': 2237652657, 'author': 'luizarakaki', 'body': 'Why are you running Metabase on CUDA?', 'created_at': datetime.datetime(2024, 4, 11, 12, 55, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2049679726, 'issue_id': 2237652657, 'author': 'fti-sfuke', 'body': '> Why are you running Metabase on CUDA?\r\n\r\nActually, we run metadata in a Docker containerized environment. \r\nHere are the complete environment details.\r\n```\r\nroot@32c4e4be2463:~# cat /etc/os-release\r\nPRETTY_NAME=""Ubuntu 22.04.4 LTS""\r\nNAME=""Ubuntu""\r\nVERSION_ID=""22.04""\r\nVERSION=""22.04.4 LTS (Jammy Jellyfish)""\r\nVERSION_CODENAME=jammy\r\nID=ubuntu\r\nID_LIKE=debian\r\nHOME_URL=""https://www.ubuntu.com/""\r\nSUPPORT_URL=""https://help.ubuntu.com/""\r\nBUG_REPORT_URL=""https://bugs.launchpad.net/ubuntu/""\r\nPRIVACY_POLICY_URL=""https://www.ubuntu.com/legal/terms-and-policies/privacy-policy""\r\nUBUNTU_CODENAME=jammy\r\nroot@32c4e4be2463:~#\r\n```\r\n```\r\nroot@32c4e4be2463:~# uname -a\r\nLinux 32c4e4be2463 6.5.0-0.deb12.4-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.5.10-1~bpo12+1 (2023-11-23) x86_64 \r\nx86_64 x86_64 GNU/Linux\r\n```\r\n```\r\nroot@32c4e4be2463:~# nvidia-smi\r\nThu Apr 11 22:15:20 2024\r\n+---------------------------------------------------------------------------------------+\r\n| NVIDIA-SMI 535.154.05             Driver Version: 535.154.05   CUDA Version: 12.2     |\r\n|-----------------------------------------+----------------------+----------------------+\r\n| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |\r\n| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |\r\n|                                         |                      |               MIG M. |\r\n|=========================================+======================+======================|\r\n|   0  NVIDIA GeForce RTX 3060        Off | 00000000:01:00.0 Off |                  N/A |\r\n| 32%   58C    P2              47W / 170W |    285MiB / 12288MiB |      3%      Default |\r\n|                                         |                      |                  N/A |\r\n+-----------------------------------------+----------------------+----------------------+\r\n|   1  NVIDIA GeForce RTX 3060        Off | 00000000:02:00.0 Off |                  N/A |\r\n|  0%   44C    P8              17W / 170W |     17MiB / 12288MiB |      0%      Default |\r\n|                                         |                      |                  N/A |\r\n+-----------------------------------------+----------------------+----------------------+\r\n\r\n+---------------------------------------------------------------------------------------+\r\n| Processes:                                                                            |\r\n|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |\r\n|        ID   ID                                                             Usage      |\r\n|=======================================================================================|\r\n+---------------------------------------------------------------------------------------+\r\nroot@32c4e4be2463:~#\r\n```', 'created_at': datetime.datetime(2024, 4, 11, 13, 19, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2049760060, 'issue_id': 2237652657, 'author': 'dpsutton', 'body': 'A couple comments:\r\n- the first error is being unable to communicate with the database. Nothing we can do with that\r\n- can you try to replicate with an official release from https://github.com/metabase/metabase/releases to see if you have the same issue with our jars as with your current ones? Perhaps you are missing something in the build step\r\n- can you give it more ram? From your logs ""Maximum memory available to JVM: 1.0 GB"" isn\'t a lot of headroom\r\n- This issue lists the version as 1.49.4 but your logs indicate ""Metabase Enterprise Edition extensions are NOT PRESENT."" so it\'s 0.49.4. Did you intend to build an enterprise version?\r\n\r\nFrom the logs, the timing seems to be this:\r\n16:44:18 startup\r\n16:44:18 register drivers\r\n16:44:19 start to verify mysql database connection\r\n16:44:28 successfully verify mysql database connection (~ 10 seconds!)\r\n(3 seconds) check if downgrade is necessary \r\n(5 minutes) Running 277 migrations (16:44:31 - 16:49:33)\r\n(6 minutes) Running custom migrations (16:50:10 - 16:56:04)\r\n(1 minute) syninc the h2 sample database (16:56:06 - 16:57:03)\r\n\r\n\r\nEverything touching a database is slow for you. I\'d pull on that thread, and check if giving it more RAM was an easy fix. It would be sad if that does indeed fix it, but that should hopefully be an easy experiment to run.\r\n\r\nEdit: one other thing we\'ve seen in the past is a lack of entropy can slow down startup (https://github.com/metabase/metabase/issues/10175). I don\'t know at which points this slows down startup so it might not be related to your case, but a thread to pull on if you exhaust other avenues to look at.', 'created_at': datetime.datetime(2024, 4, 11, 13, 59, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2068903804, 'issue_id': 2237652657, 'author': 'paoliniluis', 'body': 'This is Metabase running out of RAM, closing', 'created_at': datetime.datetime(2024, 4, 22, 9, 19, 45, tzinfo=datetime.timezone.utc)}]","luizarakaki on (2024-04-11 12:55:49 UTC): Why are you running Metabase on CUDA?

fti-sfuke (Issue Creator) on (2024-04-11 13:19:43 UTC): Actually, we run metadata in a Docker containerized environment. 
Here are the complete environment details.
```
root@32c4e4be2463:~# cat /etc/os-release
PRETTY_NAME=""Ubuntu 22.04.4 LTS""
NAME=""Ubuntu""
VERSION_ID=""22.04""
VERSION=""22.04.4 LTS (Jammy Jellyfish)""
VERSION_CODENAME=jammy
ID=ubuntu
ID_LIKE=debian
HOME_URL=""https://www.ubuntu.com/""
SUPPORT_URL=""https://help.ubuntu.com/""
BUG_REPORT_URL=""https://bugs.launchpad.net/ubuntu/""
PRIVACY_POLICY_URL=""https://www.ubuntu.com/legal/terms-and-policies/privacy-policy""
UBUNTU_CODENAME=jammy
root@32c4e4be2463:~#
```
```
root@32c4e4be2463:~# uname -a
Linux 32c4e4be2463 6.5.0-0.deb12.4-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.5.10-1~bpo12+1 (2023-11-23) x86_64 
x86_64 x86_64 GNU/Linux
```
```
root@32c4e4be2463:~# nvidia-smi
Thu Apr 11 22:15:20 2024
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.154.05             Driver Version: 535.154.05   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA GeForce RTX 3060        Off | 00000000:01:00.0 Off |                  N/A |
| 32%   58C    P2              47W / 170W |    285MiB / 12288MiB |      3%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA GeForce RTX 3060        Off | 00000000:02:00.0 Off |                  N/A |
|  0%   44C    P8              17W / 170W |     17MiB / 12288MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+

+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
+---------------------------------------------------------------------------------------+
root@32c4e4be2463:~#
```

dpsutton on (2024-04-11 13:59:28 UTC): A couple comments:
- the first error is being unable to communicate with the database. Nothing we can do with that
- can you try to replicate with an official release from https://github.com/metabase/metabase/releases to see if you have the same issue with our jars as with your current ones? Perhaps you are missing something in the build step
- can you give it more ram? From your logs ""Maximum memory available to JVM: 1.0 GB"" isn't a lot of headroom
- This issue lists the version as 1.49.4 but your logs indicate ""Metabase Enterprise Edition extensions are NOT PRESENT."" so it's 0.49.4. Did you intend to build an enterprise version?

From the logs, the timing seems to be this:
16:44:18 startup
16:44:18 register drivers
16:44:19 start to verify mysql database connection
16:44:28 successfully verify mysql database connection (~ 10 seconds!)
(3 seconds) check if downgrade is necessary 
(5 minutes) Running 277 migrations (16:44:31 - 16:49:33)
(6 minutes) Running custom migrations (16:50:10 - 16:56:04)
(1 minute) syninc the h2 sample database (16:56:06 - 16:57:03)


Everything touching a database is slow for you. I'd pull on that thread, and check if giving it more RAM was an easy fix. It would be sad if that does indeed fix it, but that should hopefully be an easy experiment to run.

Edit: one other thing we've seen in the past is a lack of entropy can slow down startup (https://github.com/metabase/metabase/issues/10175). I don't know at which points this slows down startup so it might not be related to your case, but a thread to pull on if you exhaust other avenues to look at.

paoliniluis on (2024-04-22 09:19:45 UTC): This is Metabase running out of RAM, closing

"
2237542930,issue,closed,completed,Pivot Table fires multiple queries,"### Describe the bug

Since upgrading to 0.49.x we experience heavy problems with pivot tables.
We use clickhouse (24.3) as the database and connect via https://github.com/ClickHouse/metabase-clickhouse-driver (v1.4.0).

Pivot Tables which used to load in 2-3 seconds now take around 30 seconds or more.

Firing the exact same query used by the pivot table manually still only took 2-3 seconds, which was very confusing.

After hours of investigation I think I have found the problem.
Metabase seems to send the pivot table query roughly 10times in sequence.
I can see this very clearly in clickhouse, by checking the running queries.

Metabase sends the query for the pivot table, however after its finished, the query is resent and resent (roughly 10 times), before finally displaying the pivot table.
This obviously causes the Question/Dashboard to load very long and also causes massive load on our clickhouse server (since 10 times the queries need to be run)

### To Reproduce

1. Have clickhouse as your datasource
2. create a question and visualize it as pivot table
3. The query should take roughly 2-3 seconds, so it has to be somewhat complex and the queries data should be somewhat big. Our table is roughly 30million entries.


### Expected behavior

Only one query should be sent.

### Logs

[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 23.7 ms (4 DB calls) App DB connections: 1/7 Jetty threads: 6/50 (8 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/bookmark 200 13.6 ms (1 DB calls) App DB connections: 4/7 Jetty threads: 10/50 (5 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/database 200 17.7 ms (3 DB calls) App DB connections: 3/7 Jetty threads: 9/50 (5 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/card/216 200 81.5 ms (13 DB calls) App DB connections: 2/7 Jetty threads: 8/50 (5 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/collection/tree 200 51.9 ms (6 DB calls) App DB connections: 2/7 Jetty threads: 7/50 (5 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/search 200 63.6 ms (4 DB calls) App DB connections: 1/7 Jetty threads: 6/50 (5 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/timeline 200 9.5 ms (3 DB calls) App DB connections: 1/7 Jetty threads: 7/50 (6 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/alert/question/216 200 2.7 ms (1 DB calls) App DB connections: 1/7 Jetty threads: 7/50 (6 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/database/2/schemas 200 43.5 ms (4 DB calls) App DB connections: 2/7 Jetty threads: 7/50 (6 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/table/89/query_metadata 200 80.8 ms (9 DB calls) App DB connections: 1/7 Jetty threads: 6/50 (6 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/collection/80 200 27.7 ms (5 DB calls) App DB connections: 1/7 Jetty threads: 6/50 (6 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:11:35+02:00 DEBUG metabase.server.middleware.log GET /api/collection/67 200 17.3 ms (4 DB calls) App DB connections: 1/7 Jetty threads: 6/50 (6 idle, 0 queued) (80 total active threads) Queries in flight: 0 (0 queued)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:12:10+02:00 DEBUG metabase.server.middleware.log POST /api/card/pivot/216/query 202 [ASYNC: completed] 34.3 s (80 DB calls) App DB connections: 1/7 Jetty threads: 5/50 (7 idle, 0 queued) (82 total active threads) Queries in flight: 0 (0 queued); clickhouse DB 2 connections: 0/1 (0 threads blocked)
[25512333-1343-4001-9d5d-f3f4196e5f1a] 2024-04-11T13:12:10+02:00 DEBUG metabase.server.middleware.log GET /api/database/2 200 10.5 ms (3 DB calls) App DB connections: 1/7 Jetty threads: 6/50 (7 idle, 0 queued) (82 total active threads) Queries in flight: 0 (0 queued)

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Safari/605.1.15"",
    ""vendor"": ""Apple Computer, Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.0-18-amd64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""clickhouse""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MariaDB"",
        ""version"": ""10.11.6-MariaDB-0+deb12u1""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-10"",
      ""tag"": ""v0.49.4"",
      ""hash"": ""0fdefcf""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Unable to use Metabase like this

### Additional context

_No response_",dbs5,2024-04-11 11:48:40+00:00,[],2024-04-15 07:57:21+00:00,2024-04-15 07:11:14+00:00,https://github.com/metabase/metabase/issues/41309,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2051720749, 'issue_id': 2237542930, 'author': 'Tony-metabase', 'body': ""The way metabase works for pivot is that it will not send just 1 query ... Even though you are running the above query which will give the table results. The moment you select Pivot Visual and start playing around with the aggregates Metabase will fire a number of small queries based on the main query you sent to gather all the aggregates and then create the pivot table on the frontend. \r\n\r\nThat's how pivots always worked. so you can see those queries right? Are you able to see the syntax? It could be that metabase is also adding some joins to create those aggregates which for a Clickhouse table of 30 million entries is a killer"", 'created_at': datetime.datetime(2024, 4, 12, 13, 2, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2055766813, 'issue_id': 2237542930, 'author': 'dbs5', 'body': 'Thank you very much for the explanation Tony.\r\nIt turns out, the performance problems are related to our datasource clickhouse.\r\nThey have a big performance issue in their latest 24.3 version.\r\n\r\nVery sorry to have bothered you over nothing.', 'created_at': datetime.datetime(2024, 4, 15, 7, 11, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2056016695, 'issue_id': 2237542930, 'author': 'Tony-metabase', 'body': '@dbs5 No worries! Reach out anytime :)', 'created_at': datetime.datetime(2024, 4, 15, 7, 57, 20, tzinfo=datetime.timezone.utc)}]","Tony-metabase on (2024-04-12 13:02:12 UTC): The way metabase works for pivot is that it will not send just 1 query ... Even though you are running the above query which will give the table results. The moment you select Pivot Visual and start playing around with the aggregates Metabase will fire a number of small queries based on the main query you sent to gather all the aggregates and then create the pivot table on the frontend. 

That's how pivots always worked. so you can see those queries right? Are you able to see the syntax? It could be that metabase is also adding some joins to create those aggregates which for a Clickhouse table of 30 million entries is a killer

dbs5 (Issue Creator) on (2024-04-15 07:11:14 UTC): Thank you very much for the explanation Tony.
It turns out, the performance problems are related to our datasource clickhouse.
They have a big performance issue in their latest 24.3 version.

Very sorry to have bothered you over nothing.

Tony-metabase on (2024-04-15 07:57:20 UTC): @dbs5 No worries! Reach out anytime :)

"
2237540127,issue,closed,completed,Question with Progress visualisation shows 'Something went wrong',"### Describe the bug

After updating to 0.49.1 we faced with this bug in Progress visualisation:
1. I created a native SQL-question to ClickHouse.
2. Then I created a question to that question:
<img width=""533"" alt=""Screenshot at Apr 11 15-24-57"" src=""https://github.com/metabase/metabase/assets/74110979/7fdfe004-ed9a-43ed-8e47-782f257bb399"">

3. Then I see error in progress visualisation:
<img width=""717"" alt=""Screenshot at Apr 11 15-25-59"" src=""https://github.com/metabase/metabase/assets/74110979/64cd2b3c-55f4-43c5-ac5c-24cd6b295b6d"">

4. If I save this question and then add it to a dashboard it works ok. So the issue is only when you open a question separately.
It is necessary for us to use progress, because we add an alert there.

### To Reproduce

1. Create a SQL-question to Clickhouse
2. Create a question to the previous question
3. Select progress visualisation and enter Goal = 1
4. See error


### Expected behavior

I expect to see gauge visualisation instead of the error.

### Logs

```
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:31+04:00 INFO metabase.query-processor.card Средняя продолжительность выполнения запроса: 13,2 s; используя ' magic ' TTL из 43,8 mins 💾
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:37+04:00 INFO metabase.server.middleware.exceptions Запрос отменен до завершения.
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/user/current 200 22,5 ms (10 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (2 бездействует, 0 в очереди) (219 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 27,0 ms (7 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (2 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/collection/root 200 12,0 ms (2 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (2 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/search 200 89,7 ms (5 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (2 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/database 200 30,1 ms (3 вызовы БД) Соединения с БД приложения: 3 / 15 Потоки Jetty: 6 / 50 (1 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/collection/tree 200 59,7 ms (6 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (1 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/bookmark 200 3,2 ms (1 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (2 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/card/1702 200 43,1 ms (13 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (1 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/timeline 200 4,3 ms (3 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (2 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/alert/question/1702 200 1,6 ms (1 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (2 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/database/14/schemas 200 25,6 ms (4 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 6 / 50 (1 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:42+04:00 DEBUG metabase.server.middleware.log GET /api/table/card__1695/query_metadata 200 23,6 ms (7 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 6 / 50 (1 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:43+04:00 DEBUG metabase.server.middleware.log GET /api/collection/327 200 20,3 ms (5 вызовы БД) Соединения с БД приложения: 4 / 15 Потоки Jetty: 6 / 50 (1 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:43+04:00 DEBUG metabase.server.middleware.log GET /api/card/1695 200 29,6 ms (13 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (1 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:43+04:00 INFO metabase.query-processor.card Средняя продолжительность выполнения запроса: 7,3 s; используя ' magic ' TTL из 24,5 mins 💾
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:43+04:00 DEBUG metabase.server.middleware.log GET /api/collection/296 200 17,0 ms (4 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (2 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 2 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:43+04:00 DEBUG metabase.server.middleware.log GET /api/collection/326 200 17,5 ms (5 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 5 / 50 (2 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 2 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:45+04:00 INFO metabase.query-processor.middleware.cache Query took 2,4 s to run; minimum for cache eligibility is 10,0 s; not eligible
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:45+04:00 DEBUG metabase.server.middleware.log POST /api/card/1702/query 202 [АСИНХРОННЫЙ: completed] 2,4 s (11 вызовы БД) Соединения с БД приложения: 3 / 15 Потоки Jetty: 2 / 50 (4 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди); clickhouse DB 14 connections: 1/1 (0 threads blocked)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:45+04:00 DEBUG metabase.server.middleware.log GET /api/database/14 200 5,5 ms (3 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (4 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 1 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:49+04:00 INFO metabase.query-processor.middleware.cache Query took 18,1 s to run; minimum for cache eligibility is 10,0 s; eligible
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:49+04:00 INFO metabase.query-processor.middleware.cache Кэширование результатов в следующий раз для запроса с хешем ""a9a2865d"". 💾
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:49+04:00 DEBUG metabase.server.middleware.log POST /api/dashboard/177/dashcard/1857/card/2008/query 202 [АСИНХРОННЫЙ: completed] 18,4 s (26 вызовы БД) Соединения с БД приложения: 3 / 15 Потоки Jetty: 2 / 50 (4 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 0 (0 в очереди); clickhouse DB 14 connections: 0/1 (0 threads blocked)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:51+04:00 DEBUG metabase.server.middleware.log GET /api/user/current 200 12,9 ms (10 вызовы БД) Соединения с БД приложения: 3 / 15 Потоки Jetty: 4 / 50 (3 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:51+04:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 15,8 ms (6 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (3 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:52+04:00 DEBUG metabase.server.middleware.log GET /api/bookmark 200 3,1 ms (1 вызовы БД) Соединения с БД приложения: 6 / 15 Потоки Jetty: 7 / 50 (0 бездействует, 0 в очереди) (220 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:52+04:00 DEBUG metabase.server.middleware.log GET /api/collection/root 200 27,2 ms (2 вызовы БД) Соединения с БД приложения: 5 / 15 Потоки Jetty: 8 / 50 (0 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:52+04:00 DEBUG metabase.server.middleware.log GET /api/database 200 32,3 ms (3 вызовы БД) Соединения с БД приложения: 4 / 15 Потоки Jetty: 5 / 50 (2 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:52+04:00 DEBUG metabase.server.middleware.log GET /api/collection/tree 200 47,0 ms (6 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 4 / 50 (3 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:52+04:00 DEBUG metabase.server.middleware.log GET /api/search 200 63,1 ms (5 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (4 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:52+04:00 DEBUG metabase.server.middleware.log GET /api/setting 200 26,4 ms (12 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 4 / 50 (4 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:52+04:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 17,2 ms (6 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 4 / 50 (4 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:42:52+04:00 DEBUG metabase.server.middleware.log GET /api/setup/admin_checklist 200 8,6 ms (9 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (5 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:01+04:00 DEBUG metabase.server.middleware.log GET /api/permissions/group 200 3,5 ms (2 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (5 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:01+04:00 DEBUG metabase.server.middleware.log GET /api/user 200 13,4 ms (5 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (5 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:01+04:00 DEBUG metabase.server.middleware.log GET /api/permissions/membership 200 24,5 ms (1 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (5 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:03+04:00 ERROR metabase.models.permissions.parse Ошибка анализа дерева разрешений Parse error at line 1, column 1:
/application/subscription/
^
Expected one of:
""/"" (followed by end-of-string)
""/query/db/""
""/data/db/""
""/collection/""
""/details""
""/data-model""
""/download""
""/block/db/""
""/db/""
""/execute/""

[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:03+04:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/2 200 14,5 ms (3 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 4 / 50 (4 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:03+04:00 DEBUG metabase.server.middleware.log GET /api/permissions/graph/group/1 200 23,7 ms (3 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (4 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:04+04:00 DEBUG metabase.server.middleware.log GET /api/persist 200 17,9 ms (2 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (5 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:05+04:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 11,9 ms (1 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (5 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:12+04:00 DEBUG metabase.server.middleware.log GET /api/card/2008 200 23,6 ms (13 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (5 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:13+04:00 DEBUG metabase.server.middleware.log GET /api/alert/question/2008 200 1,4 ms (1 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (5 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:29+04:00 INFO metabase.integrations.slack Refreshing slack channels and usernames.
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:29+04:00 DEBUG metabase.server.middleware.log GET /api/pulse/form_input 200 25,5 ms (2 вызовы БД) Соединения с БД приложения: 2 / 15 Потоки Jetty: 3 / 50 (5 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:29+04:00 INFO metabase.query-processor.card Средняя продолжительность выполнения запроса: 13,7 s; используя ' magic ' TTL из 45,6 mins 💾
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:29+04:00 DEBUG metabase.server.middleware.log POST /api/dashboard/177/dashcard/1857/card/2008/query 202 [АСИНХРОННЫЙ: completed] 272,3 ms (23 вызовы БД) Соединения с БД приложения: 3 / 15 Потоки Jetty: 3 / 50 (5 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
[55e24841-dd2e-400b-a342-e7ac95be56ff] 2024-04-11T15:43:32+04:00 DEBUG metabase.server.middleware.log GET /api/alert/question/2008 200 1,5 ms (1 вызовы БД) Соединения с БД приложения: 3 / 15 Потоки Jetty: 3 / 50 (5 бездействует, 0 в очереди) (221 всего активных тем) Запросы в полете: 0 (0 в очереди)
```

```
analytics.js:24 Refused to load the script 'https://www.googletagmanager.com/gtag/js?id=G-29NY6M1W10&cx=c&_slc=1' because it violates the following Content Security Policy directive: ""script-src 'self' https://maps.google.com https://accounts.google.com https://www.google-analytics.com   'sha256-9uFLu5CG8mWlvx0LK6lgendCxUX57TuWk3wkgZpBeWU=' 'sha256-ib2/2v5zC6gGM6Ety7iYgBUvpy/caRX9xV/pzzV7hf0=' 'sha256-isH538cVBUY8IMlGYGbWtBwr+cGqkc4mN6nLcA7lUjE='"". Note that 'script-src-elem' was not explicitly set, so 'script-src' is used as a fallback.

Id @ analytics.js:24
(anonymous) @ analytics.js:75
oc @ analytics.js:37
Ea @ analytics.js:36
g.onreadystatechange @ analytics.js:35
XMLHttpRequest.send (async)
wd @ analytics.js:36
pe @ analytics.js:35
Sa @ analytics.js:41
Ha.D @ analytics.js:38
pc.send @ analytics.js:77
X.b.<computed> @ analytics.js:57
Z.v @ analytics.js:93
Z.D @ analytics.js:92
N @ analytics.js:94
m @ analytics.js:82
u @ analytics.js:27
onEnter @ routes.jsx:101
await in onEnter (async)
i @ TransitionUtils.js:43
(anonymous) @ TransitionUtils.js:114
(anonymous) @ TransitionUtils.js:84
l @ AsyncUtils.js:34
O @ AsyncUtils.js:49
r @ TransitionUtils.js:83
runEnterHooks @ TransitionUtils.js:107
(anonymous) @ createTransitionManager.js:70
r @ TransitionUtils.js:74
runChangeHooks @ TransitionUtils.js:131
l @ createTransitionManager.js:67
(anonymous) @ createTransitionManager.js:45
l @ AsyncUtils.js:41
O @ AsyncUtils.js:49
N @ matchRoutes.js:231
c @ createTransitionManager.js:41
r @ createTransitionManager.js:222
listen @ createTransitionManager.js:246
componentWillMount @ Router.js:102
oB @ react-dom.production.min.js:137
iF @ react-dom.production.min.js:176
l @ react-dom.production.min.js:263
aH @ react-dom.production.min.js:246
(anonymous) @ react-dom.production.min.js:246
aW @ react-dom.production.min.js:246
ak @ react-dom.production.min.js:230
si @ react-dom.production.min.js:281
(anonymous) @ react-dom.production.min.js:284
aD @ react-dom.production.min.js:240
sp @ react-dom.production.min.js:284
t.render @ react-dom.production.min.js:290
dR @ app.js:75
dQ @ app.js:106
84553 @ app-main.js:24
a @ bootstrap:19
(anonymous) @ app-main.6e9b1451c96b0a1b9bbd.js:243
a.O @ chunk loaded:25
(anonymous) @ app-main.6e9b1451c96b0a1b9bbd.js:243
i @ jsonp chunk loading:73
(anonymous) @ app-main.6e9b1451c96b0a1b9bbd.js:7
Show 31 more frames
Show less
Third-party cookie will be blocked. Learn more in the Issues tab.
Third-party cookie will be blocked. Learn more in the Issues tab.
Third-party cookie will be blocked. Learn more in the Issues tab.
Third-party cookie will be blocked. Learn more in the Issues tab.
Third-party cookie will be blocked. Learn more in the Issues tab.
Third-party cookie will be blocked. Learn more in the Issues tab.
metadata.js:316 loadMetadataForQueries: type question not implemented
(anonymous) @ metadata.js:316
tT @ map.js:13
eu.<computed> @ mixin.js:14
(anonymous) @ metadata.js:304
(anonymous) @ index.js:16
dispatch @ redux.js:691
(anonymous) @ actions.ts:22
(anonymous) @ index.js:16
dispatch @ redux.js:691
ni @ initializeQB.ts:325
await in ni (async)
(anonymous) @ initializeQB.ts:399
(anonymous) @ index.js:16
n.<computed> @ bindActionCreators.js:8
(anonymous) @ QueryBuilder.jsx:317
(anonymous) @ useMount.js:4
i2 @ react-dom.production.min.js:211
aV @ react-dom.production.min.js:257
t.unstable_runWithPriority @ scheduler.production.min.js:19
on @ react-dom.production.min.js:122
aQ @ react-dom.production.min.js:257
aW @ react-dom.production.min.js:239
(anonymous) @ react-dom.production.min.js:123
t.unstable_runWithPriority @ scheduler.production.min.js:19
on @ react-dom.production.min.js:122
oi @ react-dom.production.min.js:123
oo @ react-dom.production.min.js:122
aT @ react-dom.production.min.js:240
notify @ Subscription.js:16
notifyNestedSubs @ Subscription.js:88
o @ Subscription.js:93
b @ redux.js:296
(anonymous) @ middleware.js:22
(anonymous) @ index.js:28
(anonymous) @ index.js:20
dispatch @ redux.js:691
(anonymous) @ utils.js:245
setTimeout (async)
(anonymous) @ utils.js:245
await in (anonymous) (async)
i @ utils.js:335
n.type @ utils.js:202
(anonymous) @ index.js:16
(anonymous) @ redux.js:578
(anonymous) @ EntityListLoader.jsx:112
componentDidMount @ EntityListLoader.jsx:131
(anonymous) @ react-dom.production.min.js:212
a$ @ react-dom.production.min.js:213
t.unstable_runWithPriority @ scheduler.production.min.js:19
on @ react-dom.production.min.js:122
aX @ react-dom.production.min.js:248
aW @ react-dom.production.min.js:239
(anonymous) @ react-dom.production.min.js:123
t.unstable_runWithPriority @ scheduler.production.min.js:19
on @ react-dom.production.min.js:122
oi @ react-dom.production.min.js:123
oo @ react-dom.production.min.js:122
ak @ react-dom.production.min.js:230
enqueueSetState @ react-dom.production.min.js:132
y.setState @ react.production.min.js:12
(anonymous) @ Router.js:109
(anonymous) @ createTransitionManager.js:228
(anonymous) @ createTransitionManager.js:83
(anonymous) @ AsyncUtils.js:74
(anonymous) @ getComponents.js:6
(anonymous) @ getComponents.js:19
(anonymous) @ AsyncUtils.js:79
(anonymous) @ AsyncUtils.js:78
S @ AsyncUtils.js:83
u @ createTransitionManager.js:77
l @ AsyncUtils.js:47
(anonymous) @ TransitionUtils.js:88
(anonymous) @ TransitionUtils.js:110
onEnter @ routes.jsx:102
await in onEnter (async)
i @ TransitionUtils.js:43
(anonymous) @ TransitionUtils.js:114
(anonymous) @ TransitionUtils.js:84
l @ AsyncUtils.js:34
O @ AsyncUtils.js:49
r @ TransitionUtils.js:83
runEnterHooks @ TransitionUtils.js:107
(anonymous) @ createTransitionManager.js:70
r @ TransitionUtils.js:74
runChangeHooks @ TransitionUtils.js:131
l @ createTransitionManager.js:67
(anonymous) @ createTransitionManager.js:45
l @ AsyncUtils.js:41
O @ AsyncUtils.js:49
N @ matchRoutes.js:231
c @ createTransitionManager.js:41
r @ createTransitionManager.js:222
listen @ createTransitionManager.js:246
componentWillMount @ Router.js:102
oB @ react-dom.production.min.js:137
iF @ react-dom.production.min.js:176
l @ react-dom.production.min.js:263
aH @ react-dom.production.min.js:246
(anonymous) @ react-dom.production.min.js:246
aW @ react-dom.production.min.js:246
ak @ react-dom.production.min.js:230
si @ react-dom.production.min.js:281
(anonymous) @ react-dom.production.min.js:284
aD @ react-dom.production.min.js:240
sp @ react-dom.production.min.js:284
t.render @ react-dom.production.min.js:290
dR @ app.js:75
dQ @ app.js:106
84553 @ app-main.js:24
a @ bootstrap:19
(anonymous) @ app-main.6e9b1451c96b0a1b9bbd.js:243
a.O @ chunk loaded:25
(anonymous) @ app-main.6e9b1451c96b0a1b9bbd.js:243
i @ jsonp chunk loading:73
(anonymous) @ app-main.6e9b1451c96b0a1b9bbd.js:7
Show 89 more frames
Show less
querying.js:201 TypeError: Cannot read properties of undefined (reading 'height')
    at oy.componentDidUpdate (Progress.jsx:100:39)
    at oy.componentDidMount (Progress.jsx:86:10)
    at react-dom.production.min.js:212:132
    at a$ (react-dom.production.min.js:213:322)
    at t.unstable_runWithPriority (scheduler.production.min.js:19:467)
    at on (react-dom.production.min.js:122:325)
    at aX (react-dom.production.min.js:248:370)
    at aW (react-dom.production.min.js:239:376)
    at react-dom.production.min.js:123:115
    at t.unstable_runWithPriority (scheduler.production.min.js:19:467)
iJ @ react-dom.production.min.js:209
n.payload @ react-dom.production.min.js:227
oO @ react-dom.production.min.js:129
iF @ react-dom.production.min.js:179
l @ react-dom.production.min.js:263
aH @ react-dom.production.min.js:246
(anonymous) @ react-dom.production.min.js:246
aW @ react-dom.production.min.js:246
(anonymous) @ react-dom.production.min.js:123
t.unstable_runWithPriority @ scheduler.production.min.js:19
on @ react-dom.production.min.js:122
oi @ react-dom.production.min.js:123
oo @ react-dom.production.min.js:122
aT @ react-dom.production.min.js:240
notify @ Subscription.js:16
notifyNestedSubs @ Subscription.js:88
o @ Subscription.js:93
b @ redux.js:296
(anonymous) @ middleware.js:22
(anonymous) @ index.js:28
(anonymous) @ index.js:20
dispatch @ redux.js:691
(anonymous) @ querying.js:201
(anonymous) @ index.js:16
dispatch @ redux.js:691
(anonymous) @ querying.js:138
Promise.then (async)
(anonymous) @ querying.js:129
(anonymous) @ index.js:16
dispatch @ redux.js:691
(anonymous) @ initializeQB.ts:381
setTimeout (async)
ni @ initializeQB.ts:380
await in ni (async)
(anonymous) @ initializeQB.ts:399
(anonymous) @ index.js:16
n.<computed> @ bindActionCreators.js:8
(anonymous) @ QueryBuilder.jsx:317
(anonymous) @ useMount.js:4
i2 @ react-dom.production.min.js:211
aV @ react-dom.production.min.js:257
t.unstable_runWithPriority @ scheduler.production.min.js:19
on @ react-dom.production.min.js:122
aQ @ react-dom.production.min.js:257
aW @ react-dom.production.min.js:239
(anonymous) @ react-dom.production.min.js:123
t.unstable_runWithPriority @ scheduler.production.min.js:19
on @ react-dom.production.min.js:122
oi @ react-dom.production.min.js:123
oo @ react-dom.production.min.js:122
aT @ react-dom.production.min.js:240
notify @ Subscription.js:16
notifyNestedSubs @ Subscription.js:88
o @ Subscription.js:93
b @ redux.js:296
(anonymous) @ middleware.js:22
(anonymous) @ index.js:28
(anonymous) @ index.js:20
dispatch @ redux.js:691
(anonymous) @ utils.js:245
setTimeout (async)
(anonymous) @ utils.js:245
await in (anonymous) (async)
i @ utils.js:335
n.type @ utils.js:202
(anonymous) @ index.js:16
(anonymous) @ redux.js:578
(anonymous) @ EntityListLoader.jsx:112
componentDidMount @ EntityListLoader.jsx:131
(anonymous) @ react-dom.production.min.js:212
a$ @ react-dom.production.min.js:213
t.unstable_runWithPriority @ scheduler.production.min.js:19
on @ react-dom.production.min.js:122
aX @ react-dom.production.min.js:248
aW @ react-dom.production.min.js:239
(anonymous) @ react-dom.production.min.js:123
t.unstable_runWithPriority @ scheduler.production.min.js:19
on @ react-dom.production.min.js:122
oi @ react-dom.production.min.js:123
oo @ react-dom.production.min.js:122
ak @ react-dom.production.min.js:230
enqueueSetState @ react-dom.production.min.js:132
y.setState @ react.production.min.js:12
(anonymous) @ Router.js:109
(anonymous) @ createTransitionManager.js:228
(anonymous) @ createTransitionManager.js:83
(anonymous) @ AsyncUtils.js:74
(anonymous) @ getComponents.js:6
(anonymous) @ getComponents.js:19
(anonymous) @ AsyncUtils.js:79
(anonymous) @ AsyncUtils.js:78
S @ AsyncUtils.js:83
u @ createTransitionManager.js:77
l @ AsyncUtils.js:47
(anonymous) @ TransitionUtils.js:88
(anonymous) @ TransitionUtils.js:110
onEnter @ routes.jsx:102
await in onEnter (async)
i @ TransitionUtils.js:43
(anonymous) @ TransitionUtils.js:114
(anonymous) @ TransitionUtils.js:84
l @ AsyncUtils.js:34
O @ AsyncUtils.js:49
r @ TransitionUtils.js:83
runEnterHooks @ TransitionUtils.js:107
(anonymous) @ createTransitionManager.js:70
r @ TransitionUtils.js:74
runChangeHooks @ TransitionUtils.js:131
l @ createTransitionManager.js:67
(anonymous) @ createTransitionManager.js:45
l @ AsyncUtils.js:41
O @ AsyncUtils.js:49
N @ matchRoutes.js:231
c @ createTransitionManager.js:41
r @ createTransitionManager.js:222
listen @ createTransitionManager.js:246
componentWillMount @ Router.js:102
oB @ react-dom.production.min.js:137
iF @ react-dom.production.min.js:176
l @ react-dom.production.min.js:263
aH @ react-dom.production.min.js:246
(anonymous) @ react-dom.production.min.js:246
aW @ react-dom.production.min.js:246
ak @ react-dom.production.min.js:230
si @ react-dom.production.min.js:281
(anonymous) @ react-dom.production.min.js:284
aD @ react-dom.production.min.js:240
sp @ react-dom.production.min.js:284
t.render @ react-dom.production.min.js:290
dR @ app.js:75
dQ @ app.js:106
84553 @ app-main.js:24
a @ bootstrap:19
(anonymous) @ app-main.6e9b1451c96b0a1b9bbd.js:243
a.O @ chunk loaded:25
(anonymous) @ app-main.6e9b1451c96b0a1b9bbd.js:243
i @ jsonp chunk loading:73
(anonymous) @ app-main.6e9b1451c96b0a1b9bbd.js:7
Show 109 more frames
Show less
```

### Information about your Metabase installation

```JSON
- browser: Chrome 123.0.6312.107, (arm64)
- Mac OS BigSur 11.2.3 (20D91)
- Metabase 0.49.1
```


### Severity

blocking some users

### Additional context

_No response_",tritatuy,2024-04-11 11:47:06+00:00,['JesseSDevaney'],2024-07-01 19:30:24+00:00,2024-07-01 19:30:23+00:00,https://github.com/metabase/metabase/issues/41308,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Scalars', 'Numbers, progress bars, gauges'), ('.Reproduced', 'Issues reproduced in test (usually Cypress)'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2051684924, 'issue_id': 2237540127, 'author': 'dl-github-reporter', 'body': 'I have the same issue =/', 'created_at': datetime.datetime(2024, 4, 12, 12, 39, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2200874951, 'issue_id': 2237540127, 'author': 'JesseSDevaney', 'body': 'Closing this issue as it was a duplicated issue of:\r\n- https://github.com/metabase/metabase/issues/41243\r\n\r\nwhich was already fixed.', 'created_at': datetime.datetime(2024, 7, 1, 19, 30, 23, tzinfo=datetime.timezone.utc)}]","dl-github-reporter on (2024-04-12 12:39:33 UTC): I have the same issue =/

JesseSDevaney (Assginee) on (2024-07-01 19:30:23 UTC): Closing this issue as it was a duplicated issue of:
- https://github.com/metabase/metabase/issues/41243

which was already fixed.

"
2237492959,issue,open,,Suggestion editor popover middle/right click closes the popover,"### Describe the bug

In the suggestion editor there are info popovers for the suggestion items.

The mouse behavior on right or middle click is broken.

### To Reproduce

Go to:
1. New question → Sample dataset → Orders
2. Custom Column
3. Type `con` in the expression editor
4. Hover the suggestions and hover the info icons on the suggestions

When the popover is shown on hover:
- It's not possible to select the text in the popover when it's shown on hover
- It's not possible to use the right-click or middle-click inside the popove

### Expected behavior

The mouse should be able to interact with the popover.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:124.0) Gecko/20100101 Firefox/124.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-04-05"",
      ""src_hash"": ""f9fce33f8986a6a70a225d9d717c63573bd7db12"",
      ""tag"": ""v0.48.1-SNAPSHOT"",
      ""hash"": ""69e4661""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-04-11 11:24:12+00:00,[],2025-02-04 20:27:33+00:00,,https://github.com/metabase/metabase/issues/41305,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]","[{'comment_id': 2630687173, 'issue_id': 2237492959, 'author': 'uladzimirdev', 'body': 'it should be addressed in scope of a bigger refactoring in https://github.com/metabase/metabase/pull/51494', 'created_at': datetime.datetime(2025, 2, 3, 11, 31, 9, tzinfo=datetime.timezone.utc)}]","uladzimirdev on (2025-02-03 11:31:09 UTC): it should be addressed in scope of a bigger refactoring in https://github.com/metabase/metabase/pull/51494

"
2237279028,issue,closed,completed,Backend support to show and archive related Cards,"We should show a follow-up that says “These models / questions use this table as their primary source. Do you want to archive these as well?” for further clean-up.[^1]

[^1]: https://www.notion.so/metabase/Let-admins-delete-previous-CSV-uploads-and-their-underlying-table-843a48623b474010a8886ee93740bde1?pvs=4#fa2f9cf9b4cb4db7a84757e8f1a974d7",crisptrutski,2024-04-11 09:19:23+00:00,[],2024-04-18 07:35:54+00:00,2024-04-18 07:35:54+00:00,https://github.com/metabase/metabase/issues/41302,[],"[{'comment_id': 2049283949, 'issue_id': 2237279028, 'author': 'crisptrutski', 'body': ""I need to clarify exactly how this flow works, is it:\r\n\r\n1. A follow-up shown *after* the delete, as an optional clean-up? (what it sounds like)\r\n2. A warning shown *before* the delete, indicating that this will be a by-product (what I'd expect)\r\n\r\nWhat I like about the latter, is that since the user is only shown a usage count before clicking delete it makes sense to show them the relevant cards before they commit to breaking them.\r\n\r\nThe former could use the response from the DELETE to populate the modal, whereas the second option would need a new GET endpoint. On the other hand there isn't that hard in an extra request after we delete, so perhaps the new route is best due to its agnosticism."", 'created_at': datetime.datetime(2024, 4, 11, 9, 25, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2063219994, 'issue_id': 2237279028, 'author': 'crisptrutski', 'body': 'Archival was rolled into the DELETE call itself, the user is prompted before confirming the deletion.\r\n\r\nDisplay of the affected cards is only a v2 deliverable, so closing this issue and unlinking it for now.', 'created_at': datetime.datetime(2024, 4, 18, 7, 35, 54, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-04-11 09:25:16 UTC): I need to clarify exactly how this flow works, is it:

1. A follow-up shown *after* the delete, as an optional clean-up? (what it sounds like)
2. A warning shown *before* the delete, indicating that this will be a by-product (what I'd expect)

What I like about the latter, is that since the user is only shown a usage count before clicking delete it makes sense to show them the relevant cards before they commit to breaking them.

The former could use the response from the DELETE to populate the modal, whereas the second option would need a new GET endpoint. On the other hand there isn't that hard in an extra request after we delete, so perhaps the new route is best due to its agnosticism.

crisptrutski (Issue Creator) on (2024-04-18 07:35:54 UTC): Archival was rolled into the DELETE call itself, the user is prompted before confirming the deletion.

Display of the affected cards is only a v2 deliverable, so closing this issue and unlinking it for now.

"
2236790540,issue,closed,completed,[dc.js migration] hovering areas in some cases stucks in an invalid hover state,https://metaboat.slack.com/archives/C06G94JTWBS/p1712762117177099,alxnddr,2024-04-11 02:24:52+00:00,[],2024-05-14 18:39:48+00:00,2024-05-14 18:39:48+00:00,https://github.com/metabase/metabase/issues/41298,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]","[{'comment_id': 2110879271, 'issue_id': 2236790540, 'author': 'EmmadUsmani', 'body': ""Was not able to reproduce, I'm assuming it's already fixed."", 'created_at': datetime.datetime(2024, 5, 14, 18, 39, 48, tzinfo=datetime.timezone.utc)}]","EmmadUsmani on (2024-05-14 18:39:48 UTC): Was not able to reproduce, I'm assuming it's already fixed.

"
2236497329,issue,closed,not_planned,Validation fault on downgrade from v0.49.2 to v0.48.8,"### Describe the bug

I'm hosting metabase on GKE and tried to downgrade the version from 0.49.2 to 0.48.8.
I ran the migrate down command in my container and changed the container image version back to v0.48.8, but I get a validation error.



### To Reproduce

1. Execute the following command in my pod
`./run_metabase.sh ""migrate down""`
2. Change the container image  from metabase/metabase:v0.49.2 To metabase/metabase:v0.48.8


### Expected behavior

Down grade is successfully completed.

### Logs

Log  at execute ""migrate down"" command.
```Warning: environ value jdk-11.0.22+7 for key :java-version has been overwritten with 11.0.22
2024-04-02 02:47:20,767 INFO metabase.util :: Maximum memory available to JVM: 494.9 MB
2024-04-02 02:47:34,083 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓 
For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html
2024-04-02 02:48:08,179 INFO driver.impl :: Registered abstract driver :sql  🚚
2024-04-02 02:48:08,285 INFO driver.impl :: Registered abstract driver :sql-jdbc (parents: [:sql]) 🚚
2024-04-02 02:48:08,368 INFO metabase.util :: Load driver :sql-jdbc took 660.4 ms
2024-04-02 02:48:08,369 INFO driver.impl :: Registered driver :h2 (parents: [:sql-jdbc]) 🚚
2024-04-02 02:48:09,463 INFO driver.impl :: Registered driver :mysql (parents: [:sql-jdbc]) 🚚
2024-04-02 02:48:09,686 INFO driver.impl :: Registered driver :postgres (parents: [:sql-jdbc]) 🚚
2024-04-02 02:48:18,070 INFO metabase.core :: 
Metabase v0.49.2 (4b83b88) 

Copyright © 2024 Metabase, Inc. 

Metabase Enterprise Edition extensions are NOT PRESENT.
2024-04-02 02:48:19,074 INFO db.setup :: Setting up Liquibase...
2024-04-02 02:48:23,200 INFO db.setup :: Liquibase is ready.
2024-04-02 02:48:23,270 INFO db.liquibase :: Rolling back app database schema to version 48
2024-04-02 02:48:25,686 INFO db.custom-migrations :: No rollback for:  DeleteTruncateAuditLogTask
```

Log at launch on v0.48.8.

```
2024-04-02 02:58:22,471 INFO db.setup :: Verifying postgres Database Connection ...
2024-04-02 02:58:23,474 INFO db.setup :: Successfully verified PostgreSQL 13.13 application database connection. ✅
2024-04-02 02:58:23,474 INFO db.setup :: Checking if a database downgrade is required...
2024-04-02 02:58:26,491 INFO db.setup :: Running Database Migrations...
2024-04-02 02:58:26,492 INFO db.setup :: Setting up Liquibase...
2024-04-02 02:58:27,662 INFO db.setup :: Liquibase is ready.
2024-04-02 02:58:27,662 INFO db.liquibase :: Checking if Database has unrun migrations...
2024-04-02 02:58:30,071 ERROR metabase.core :: Metabase Initialization FAILED
liquibase.exception.ValidationFailedException: Validation Failed:
    203 changesets check sum
         migrations/001_update_migrations.yaml::v00.00-000::qnkhuat was: 9:e346841fa1cd9d142e1237b37fdc8a20 but is now: 8:a59595109e74e7a2678a1b0dfd25f74a
         migrations/001_update_migrations.yaml::v45.00-001::snoe was: 9:15c13a8aa3fdc72ef0c54f4cccfc39e1 but is now: 8:da99b71a4ac7eb662f6a95e69585935e
         migrations/001_update_migrations.yaml::v45.00-002::snoe was: 9:d2c9f50f5a29947a07e4808957d63ab6 but is now: 8:6da7a6285edb138c404de0eeba209570
         migrations/001_update_migrations.yaml::v45.00-003::snoe was: 9:dafaaf7c9f0efbf92670ea93c001f7a1 but is now: 8:512337d6d4af38016aa79585abbe03a1
         migrations/001_update_migrations.yaml::v45.00-011::snoe was: 9:c539f152aa1c2287c5b602c7a395f9e8 but is now: 8:dcf1cda9f20dca4b6ff8101b13b98c4a
         migrations/001_update_migrations.yaml::v45.00-012::snoe was: 9:b872219f47d12ec80db8f1731be4ce94 but is now: 8:aadf28229f585cff7c4b4c1918e558b2
         migrations/001_update_migrations.yaml::v45.00-013::snoe was: 9:54c5d6a9659b7ae62e8c42f60f9620d2 but is now: 8:26dba276b14255d4346507a1a25d117b
         migrations/001_update_migrations.yaml::v45.00-022::snoe was: 9:06e8a3ba8c4c5e5cf8e6aa3f35081cac but is now: 8:d46fa24e4d75a11b2e92aecbf39c6ee1
         migrations/001_update_migrations.yaml::v45.00-023::snoe was: 9:082d296233ee6dbbf2871b9d93c3a6a4 but is now: 8:c6c1ff9ca3b62d4cda3a2d782dd86f2f
         migrations/001_update_migrations.yaml::v45.00-025::metamben was: 9:2214b0d71acc8a8cf90781a2aca98664 but is now: 8:50a43cea3123ecdb602123825f5a7dbf
         migrations/001_update_migrations.yaml::v45.00-026::snoe was: 9:9f2ce2d2d79d0dce365ddf3464d1f648 but is now: 8:ae77d4086998911877e3207fcf90c9c7
         migrations/001_update_migrations.yaml::v45.00-027::snoe was: 9:73718f7b7c3fb4ef30f71dc6e6170528 but is now: 8:40c3c8391c1416a3bce09ca3c7237173
         migrations/001_update_migrations.yaml::v45.00-028::camsaul was: 9:883315d70f3fc10b07858aa0e48ed9da but is now: 8:f8f68f80627aeb2ef7f28f2af2b5a31b
         migrations/001_update_migrations.yaml::v45.00-029::camsaul was: 9:fe3b8aca811ef5b541f922a83c7ded8c but is now: 8:579957652133eab3ee023dd911162a1e
         migrations/001_update_migrations.yaml::v45.00-030::camsaul was: 9:63da8f2f82baf396ad30f3fd451c501d but is now: 8:41eda097feb034c4d01b2dbda74753c8
         migrations/001_update_migrations.yaml::v45.00-031::camsaul was: 9:3628c1c692bec0f7258ea983b18340b5 but is now: 8:6416e373e335dc1c12c7571af674dede
         migrations/001_update_migrations.yaml::v45.00-032::camsaul was: 9:7a6f0320210b82c5eafe836ea98f477d but is now: 8:d97444fe24a2dca618a2804741335f6d
         migrations/001_update_migrations.yaml::v45.00-033::camsaul was: 9:b93dab321e4a1fcaeb74d12b52867fd4 but is now: 8:34df79fc79e086ab05bb2fd79bb4e322
         migrations/001_update_migrations.yaml::v45.00-034::camsaul was: 9:39c965f9dc521d2a1e196f645d11de9e but is now: 8:ba0505a87ef876026759cdcb4e704f41
         migrations/001_update_migrations.yaml::v45.00-035::camsaul was: 9:207984e21c44681a6135592cab3d0f3f but is now: 8:dcee49781d80d9c4be5ad9dd51975a07
         migrations/001_update_migrations.yaml::v45.00-036::snoe was: 9:8632f7a046e1094399c517b05f0feea3 but is now: 8:cd4009254bd2c56aaf281082038c1f0b
         migrations/001_update_migrations.yaml::v45.00-037::snoe was: 9:6600702fb0cc9dcd8628fca8df9c0b39 but is now: 8:56f548cc84a53cc6d18302761ee71554
         migrations/001_update_migrations.yaml::v45.00-038::camsaul was: 9:5ae52c12861e5eec6a2a9a8c5a442826 but is now: 8:c38ddc295206e807c7254581ed9566c3
         migrations/001_update_migrations.yaml::v45.00-039::camsaul was: 9:7b331f47a0260218275c58fa21fdcc60 but is now: 8:2c539d76d3aead7f7366b15333132b30
         migrations/001_update_migrations.yaml::v45.00-040::camsaul was: 9:6d6fb2c7cd62868b9878a951c8596cec but is now: 8:00ac7c24cfd3e7ea3a21f21f4e45dbcf
         migrations/001_update_migrations.yaml::v45.00-041::camsaul was: 9:84d479472b81809b8067f72b28934954 but is now: 8:82dc368fa3e0163a06929da6e9556fe2

       at liquibase.changelog.DatabaseChangeLog.validate(DatabaseChangeLog.java:354)
       at liquibase.Liquibase.lambda$listUnrunChangeSets$16(Liquibase.java:1287)
       at liquibase.Scope.lambda$child$0(Scope.java:194)
       at liquibase.Scope.child(Scope.java:203)
       at liquibase.Scope.child(Scope.java:193)
       at liquibase.Scope.child(Scope.java:172)
       at liquibase.Liquibase.runInScope(Liquibase.java:1618)
       at liquibase.Liquibase.listUnrunChangeSets(Liquibase.java:1279)
       at liquibase.Liquibase.listUnrunChangeSets(Liquibase.java:1270)
       at metabase.db.liquibase$unrun_migrations$fn__47763.invoke(liquibase.clj:180)
       at metabase.db.liquibase$do_with_liquibase$f_STAR___47748.invoke(liquibase.clj:134)
       at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:137)
       at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:125)
       at metabase.db.liquibase$unrun_migrations.invokeStatic(liquibase.clj:179)
       at metabase.db.liquibase$unrun_migrations.invoke(liquibase.clj:170)
       at metabase.db.liquibase$migrate_up_if_needed_BANG_.invokeStatic(liquibase.clj:225)
       at metabase.db.liquibase$migrate_up_if_needed_BANG_.invoke(liquibase.clj:221)
       at metabase.db.setup$migrate_BANG_$fn__49980.invoke(setup.clj:80)
       at metabase.db.liquibase$do_with_liquibase$f_STAR___47748.invoke(liquibase.clj:134)
       at metabase.db.liquibase$do_with_liquibase.invokeStatic(liquibase.clj:137)
       at metabase.db.liquibase$do_with_liquibase.invoke(liquibase.clj:125)
       at metabase.db.setup$migrate_BANG_.invokeStatic(setup.clj:75)
       at metabase.db.setup$migrate_BANG_.doInvoke(setup.clj:56)
       at clojure.lang.RestFn.invoke(RestFn.java:445)
       at metabase.db.setup$run_schema_migrations_BANG_.invokeStatic(setup.clj:148)
       at metabase.db.setup$run_schema_migrations_BANG_.invoke(setup.clj:142)
       at metabase.db.setup$setup_db_BANG_$fn__50010$fn__50011.invoke(setup.clj:166)
       at metabase.util.jvm$do_with_us_locale.invokeStatic(jvm.clj:239)
       at metabase.util.jvm$do_with_us_locale.invoke(jvm.clj:225)
       at metabase.db.setup$setup_db_BANG_$fn__50010.invoke(setup.clj:161)
       at metabase.db.setup$setup_db_BANG_.invokeStatic(setup.clj:160)
       at metabase.db.setup$setup_db_BANG_.invoke(setup.clj:154)
       at metabase.db$setup_db_BANG_$fn__50024.invoke(db.clj:69)
       at metabase.db$setup_db_BANG_.invokeStatic(db.clj:64)
       at metabase.db$setup_db_BANG_.invoke(db.clj:55)
       at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:113)
       at metabase.core$init_BANG__STAR_.invoke(core.clj:98)
       at metabase.core$init_BANG_.invokeStatic(core.clj:156)
       at metabase.core$init_BANG_.invoke(core.clj:151)
       at metabase.core$start_normally.invokeStatic(core.clj:168)
       at metabase.core$start_normally.invoke(core.clj:162)
       at metabase.core$entrypoint.invokeStatic(core.clj:201)
       at metabase.core$entrypoint.doInvoke(core.clj:195)
       at clojure.lang.RestFn.invoke(RestFn.java:397)
       at clojure.lang.AFn.applyToHelper(AFn.java:152)
       at clojure.lang.RestFn.applyTo(RestFn.java:132)
       at clojure.lang.Var.applyTo(Var.java:705)
       at clojure.core$apply.invokeStatic(core.clj:667)
       at clojure.core$apply.invoke(core.clj:662)
       at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
       at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
       at clojure.lang.RestFn.invoke(RestFn.java:397)
       at clojure.lang.AFn.applyToHelper(AFn.java:152)
       at clojure.lang.RestFn.applyTo(RestFn.java:132)
       at metabase.bootstrap.main(Unknown Source)
2024-04-02 02:58:30,170 INFO metabase.core :: Metabase Shutting Down ...
2024-04-02 02:58:30,264 INFO metabase.server :: Shutting Down Embedded Jetty Webserver
2024-04-02 02:58:30,376 INFO metabase.core :: Metabase Shutdown COMPLETE 
```

### Information about your Metabase installation

```JSON
- Metabase:version : 0.49.2
- Metabase:hosting environment : GKE
- Metabase:intenal database : CloudSQL(PostgreSQL 13)
```


### Severity

If there is a bug in a version up image, the previous stable version cannot be provided to the user.

### Additional context

_No response_",ssxota,2024-04-10 21:58:12+00:00,[],2024-05-13 21:20:28+00:00,2024-05-13 21:20:27+00:00,https://github.com/metabase/metabase/issues/41295,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2080441792, 'issue_id': 2236497329, 'author': 'paoliniluis', 'body': ""@ssxota is this the same as https://github.com/metabase/metabase/issues/41641? please confirm and close the issue if that's the case"", 'created_at': datetime.datetime(2024, 4, 27, 10, 16, 49, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-27 10:16:49 UTC): @ssxota is this the same as https://github.com/metabase/metabase/issues/41641? please confirm and close the issue if that's the case

"
2236472039,issue,closed,completed,[Cache] Support Schedule strategy,,dpsutton,2024-04-10 21:38:39+00:00,['rafpaf'],2024-04-15 17:19:13+00:00,2024-04-15 17:07:49+00:00,https://github.com/metabase/metabase/issues/41292,[],[],
2236464234,issue,closed,completed,[dc.js migration] very small values on bar charts can appear invisible,"https://metaboat.slack.com/archives/C06G94JTWBS/p1712762689537319
https://metaboat.slack.com/archives/C06G94JTWBS/p1712762882999739",alxnddr,2024-04-10 21:32:18+00:00,['alxnddr'],2024-06-05 10:41:30+00:00,2024-06-05 10:41:29+00:00,https://github.com/metabase/metabase/issues/41291,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2236463143,issue,closed,completed,[dc.js migration] some charts are crashing,"https://metaboat.slack.com/archives/C06G94JTWBS/p1712761815053639
https://metaboat.slack.com/archives/C06G94JTWBS/p1712762100101589

![Screenshot from 2024-04-22 15-20-19](https://github.com/metabase/metabase/assets/22608765/02dc91b3-f1a8-4463-8649-923404114ed9)
![image](https://github.com/metabase/metabase/assets/22608765/ba5c4aca-4478-4ebe-8d34-3834b2ade20c)

- https://github.com/metabase/metabase/blob/echarts/e2e/test/scenarios/visualizations-charts/bar_chart.cy.spec.js#L406

---
- Other relevant tests: 
  - https://github.com/metabase/metabase/blob/echarts/e2e/test/scenarios/visualizations-charts/line_chart.cy.spec.js#L371
  - https://github.com/metabase/metabase/blob/echarts/e2e/test/scenarios/visualizations-charts/line_chart.cy.spec.js#L425
  - https://github.com/metabase/metabase/blob/echarts/e2e/test/scenarios/visualizations-charts/line-bar-tooltips.cy.spec.js#L95
  - https://github.com/metabase/metabase/blob/echarts/e2e/test/scenarios/visualizations-charts/line-bar-tooltips.cy.spec.js#L225
  - https://github.com/metabase/metabase/blob/echarts/e2e/test/scenarios/visualizations-charts/line-bar-tooltips.cy.spec.js#L368
",alxnddr,2024-04-10 21:31:21+00:00,['alxnddr'],2024-04-24 19:13:55+00:00,2024-04-24 19:13:55+00:00,https://github.com/metabase/metabase/issues/41290,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2236462114,issue,closed,completed,[dc.js migration] time series chart is completely broken,https://metaboat.slack.com/archives/C06G94JTWBS/p1712761516867389,alxnddr,2024-04-10 21:30:28+00:00,[],2024-04-19 19:59:16+00:00,2024-04-19 19:59:16+00:00,https://github.com/metabase/metabase/issues/41289,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2236459326,issue,closed,completed,[dc.js migration] chart layout includes excessive paddings,"https://metaboat.slack.com/archives/C06G94JTWBS/p1712761135590019
https://metaboat.slack.com/archives/C06G94JTWBS/p1712761335456369

This issue is caused by a bug within echarts. The bug is that echarts applies an inconsistent amount of bottom padding if x-axis labels are rotated 45 degrees, and the `grid.containLabel` option is `true`.

<img width=""497"" alt=""Screenshot 2024-04-18 at 9 48 30 AM"" src=""https://github.com/metabase/metabase/assets/37751258/7e768fb7-5676-46dd-8ff9-ac195f691b1f"">

In this example, `grid.bottom` is 40 and `grid.containLabel` is `true`. When the axis labels are not rotated, echarts applies 49px of bottom padding, but when they are rotated 45 degrees, then an extra 9 pixels of bottom padding are added, despite the `grid.bottom` option still being 40.

We unfortunately cannot solve this by subtracting a constant offset from `grid.bottom` when labels are rotated 45 degrees, because the amount of extra padding varies.

<img width=""507"" alt=""Screenshot 2024-04-18 at 9 48 35 AM"" src=""https://github.com/metabase/metabase/assets/37751258/ab90ee59-3c93-45ae-a043-75be6bfba95b"">

In this example where `grid.bottom` is 30, then only 6 extra pixels are added.",alxnddr,2024-04-10 21:29:01+00:00,['EmmadUsmani'],2024-04-24 14:58:49+00:00,2024-04-24 14:58:49+00:00,https://github.com/metabase/metabase/issues/41288,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]","[{'comment_id': 2064595390, 'issue_id': 2236459326, 'author': 'alxnddr', 'body': '@EmmadUsmani since we compute ticks dimensions, axis name dimensions by ourselves we can use it to add grid paddings and do not use `containLabel`', 'created_at': datetime.datetime(2024, 4, 18, 17, 8, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2064728010, 'issue_id': 2236459326, 'author': 'EmmadUsmani', 'body': '@alxnddr We still need `containLabel` to contain data labels and goal line labels', 'created_at': datetime.datetime(2024, 4, 18, 17, 47, 58, tzinfo=datetime.timezone.utc)}]","alxnddr (Issue Creator) on (2024-04-18 17:08:29 UTC): @EmmadUsmani since we compute ticks dimensions, axis name dimensions by ourselves we can use it to add grid paddings and do not use `containLabel`

EmmadUsmani (Assginee) on (2024-04-18 17:47:58 UTC): @alxnddr We still need `containLabel` to contain data labels and goal line labels

"
2236435261,issue,closed,completed,[dc.js migration] hovering legend items does not focus on series,"https://metaboat.slack.com/archives/C06G94JTWBS/p1712760861817309
https://metaboat.slack.com/archives/C06G94JTWBS/p1712762117177099",alxnddr,2024-04-10 21:11:18+00:00,['alxnddr'],2024-04-15 19:40:16+00:00,2024-04-15 19:40:16+00:00,https://github.com/metabase/metabase/issues/41287,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2236431040,issue,closed,not_planned,[dc.js migration] lines should be thicker on charts with fewer data points,https://metaboat.slack.com/archives/C06G94JTWBS/p1712760815044859,alxnddr,2024-04-10 21:08:46+00:00,['kulyk'],2024-04-29 17:43:34+00:00,2024-04-29 17:43:25+00:00,https://github.com/metabase/metabase/issues/41286,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]","[{'comment_id': 2083301867, 'issue_id': 2236431040, 'author': 'kulyk', 'body': 'Closing in favor of #9255, more context in [internal thread](https://metaboat.slack.com/archives/C064QMXEV9N/p1714410866824009)', 'created_at': datetime.datetime(2024, 4, 29, 17, 43, 25, tzinfo=datetime.timezone.utc)}]","kulyk (Assginee) on (2024-04-29 17:43:25 UTC): Closing in favor of #9255, more context in [internal thread](https://metaboat.slack.com/archives/C064QMXEV9N/p1714410866824009)

"
2236429796,issue,closed,completed,[dc.js migration] incorrect y-axis label when y-axis is split,"https://metaboat.slack.com/archives/C06G94JTWBS/p1712761908453659
",alxnddr,2024-04-10 21:07:55+00:00,['EmmadUsmani'],2024-04-16 15:28:09+00:00,2024-04-16 15:28:09+00:00,https://github.com/metabase/metabase/issues/41285,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]","[{'comment_id': 2057655613, 'issue_id': 2236429796, 'author': 'EmmadUsmani', 'body': ""@alxnddr For the [first slack message](https://metaboat.slack.com/archives/C06G94JTWBS/p1712760809293889) you originally listed, the issue isn't a missing y-axis label, it's actually due to the y-axis not splitting which is a separate issue https://github.com/metabase/metabase/issues/41283."", 'created_at': datetime.datetime(2024, 4, 15, 19, 31, 21, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Assginee) on (2024-04-15 19:31:21 UTC): @alxnddr For the [first slack message](https://metaboat.slack.com/archives/C06G94JTWBS/p1712760809293889) you originally listed, the issue isn't a missing y-axis label, it's actually due to the y-axis not splitting which is a separate issue https://github.com/metabase/metabase/issues/41283.

"
2236428259,issue,closed,not_planned,[dc.js migration] we should focus on y-axis of the currently hovered series by hiding the other y-axis,"https://metaboat.slack.com/archives/C06G94JTWBS/p1712760809293889
",alxnddr,2024-04-10 21:06:41+00:00,[],2024-04-15 21:46:06+00:00,2024-04-12 04:47:58+00:00,https://github.com/metabase/metabase/issues/41284,[],"[{'comment_id': 2050967503, 'issue_id': 2236428259, 'author': 'alxnddr', 'body': 'Duplicate of https://github.com/metabase/metabase/issues/41217', 'created_at': datetime.datetime(2024, 4, 12, 4, 47, 58, tzinfo=datetime.timezone.utc)}]","alxnddr (Issue Creator) on (2024-04-12 04:47:58 UTC): Duplicate of https://github.com/metabase/metabase/issues/41217

"
2236426764,issue,closed,completed,[dc.js migration] y-axis split works differently,"https://metaboat.slack.com/archives/C06G94JTWBS/p1712760809293889

I assume some column formatting settings for series may differ which leads to y-axis split logic use a single y-axis for two vastly different series",alxnddr,2024-04-10 21:05:38+00:00,['alxnddr'],2024-04-19 19:34:53+00:00,2024-04-19 19:34:53+00:00,https://github.com/metabase/metabase/issues/41283,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2236423755,issue,closed,completed,[dc.js migration] timeseries x-axis sometimes shows fewer ticks,"https://metaboat.slack.com/archives/C06G94JTWBS/p1712760628635309

P3 because It happens only in some cases. ECharts automatically hides overlapping ticks.

There is a potential improvement by introducing new intervals such as half a year https://metaboat.slack.com/archives/C064QMXEV9N/p1715962353532299?thread_ts=1715962202.978199&cid=C064QMXEV9N",alxnddr,2024-04-10 21:03:23+00:00,['kulyk'],2024-10-08 17:10:29+00:00,2024-05-28 12:15:14+00:00,https://github.com/metabase/metabase/issues/41281,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2236420496,issue,closed,completed,[dc.js migration] data labels are less readable when overlap with goal and trend lines,https://metaboat.slack.com/archives/C06G94JTWBS/p1712762682431379,alxnddr,2024-04-10 21:01:16+00:00,['EmmadUsmani'],2024-06-10 20:49:56+00:00,2024-06-03 22:09:08+00:00,https://github.com/metabase/metabase/issues/41280,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]","[{'comment_id': 2111180172, 'issue_id': 2236420496, 'author': 'EmmadUsmani', 'body': '![image](https://github.com/metabase/metabase/assets/37751258/42d33325-39e4-424e-89c6-9d19a58dac94)\r\n\r\n#### Problem\r\n\r\nData label z value is the same as the series z value. Since we render trend and goal lines above the series, they will also render above the the data labels\r\n\r\n#### Solution\r\n\r\nUse a separate series with higher z value for data labels, like stacked bars and waterfall', 'created_at': datetime.datetime(2024, 5, 14, 21, 36, 37, tzinfo=datetime.timezone.utc)}]","EmmadUsmani (Assginee) on (2024-05-14 21:36:37 UTC): ![image](https://github.com/metabase/metabase/assets/37751258/42d33325-39e4-424e-89c6-9d19a58dac94)

#### Problem

Data label z value is the same as the series z value. Since we render trend and goal lines above the series, they will also render above the the data labels

#### Solution

Use a separate series with higher z value for data labels, like stacked bars and waterfall

"
2236418473,issue,closed,completed,[dc.js migration] scatter charts y-axis range sometimes is incorrect,"https://metaboat.slack.com/archives/C06G94JTWBS/p1712760251646769
https://metaboat.slack.com/archives/C06G94JTWBS/p1712761780815899
https://metaboat.slack.com/archives/C06G94JTWBS/p1712762800666539",alxnddr,2024-04-10 21:00:09+00:00,['alxnddr'],2024-04-15 19:31:22+00:00,2024-04-15 19:31:22+00:00,https://github.com/metabase/metabase/issues/41279,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2236417098,issue,closed,completed,[dc.js migration] y-axis labels sometimes cut off ,"https://metaboat.slack.com/archives/C06G94JTWBS/p1712760196184959
https://metaboat.slack.com/archives/C06G94JTWBS/p1712760451880029

This issue will be fixed by proper layout calculation which should also fix another related issue
https://metaboat.slack.com/archives/C06G94JTWBS/p1712760552737579
",alxnddr,2024-04-10 20:59:04+00:00,['EmmadUsmani'],2024-04-16 15:28:25+00:00,2024-04-16 15:28:25+00:00,https://github.com/metabase/metabase/issues/41278,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2236287114,issue,closed,completed,Visualization settings are not persisted during question edits.  ,"### Describe the bug

The visualization settings of certain chart types (line chart is the primary tested) are lost when making unrelated changes to the question.  

### To Reproduce

Create a question with your sql
Choose line chart visualization and set your x & y axis in the visualization settings
Save and leave question
Come back to question and alter anything, except visualization settings, that allows you to save.  For example change a Field Filter's filter widget type from date range to date filter.  
Save
Leave question and return.  Run your query and receive a greyed out line chart with no axis selected.

### Expected behavior

Axis should remain selected unless something about the query changes that removes the selected axis columns.  If axis are not selected for chart types then disable save or provide some UI indicator to the user. 

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.4.16-linuxkit"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.2""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-02"",
      ""tag"": ""v1.49.3"",
      ""hash"": ""dba0992""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

Low

### Additional context

**EDIT**

Added video of bug

https://github.com/metabase/metabase/assets/6433224/54693473-e9ec-4ffe-9225-f0bd27db8642

SQL Used -
`SELECT
""PUBLIC"".""ORDERS"".""USER_ID"" AS ""USER_ID"",
  SUM(""PUBLIC"".""ORDERS"".""TOTAL"") AS ""TOTAL"",
  CAST(""PUBLIC"".""ORDERS"".""CREATED_AT"" AS DATE) AS ""CREATED_AT""
FROM
  ""PUBLIC"".""ORDERS""
WHERE {{time_period}} 
AND ""PUBLIC"".""ORDERS"".""USER_ID"" = {{user}}
GROUP BY 
    CAST(""PUBLIC"".""ORDERS"".""CREATED_AT"" AS DATE), ""PUBLIC"".""ORDERS"".""USER_ID""
LIMIT
  200`

Note - I believe the text filter for `User` with no default is part of the problem.   
When you navigate to the question it's initially ""broken"" until you enter a value into the filter.  I believe saving the question  in this state saves it without the AXIS selected.  

",DillonWhatley,2024-04-10 19:30:48+00:00,['EmmadUsmani'],2024-08-02 18:41:14+00:00,2024-08-02 02:37:29+00:00,https://github.com/metabase/metabase/issues/41276,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Chart Settings', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2052087771, 'issue_id': 2236287114, 'author': 'ignacio-mb', 'body': 'Hi @DillonWhatley I used the following SQL and couldn\'t reproduce:\r\n\r\n`SELECT\r\n  DATE_TRUNC(\'month\', ""PUBLIC"".""ORDERS"".""CREATED_AT"") AS ""CREATED_AT"",\r\n  COUNT(*) AS ""count""\r\nFROM\r\n  ""PUBLIC"".""ORDERS""\r\n[[WHERE {{TEST}}]]\r\nGROUP BY\r\n  DATE_TRUNC(\'month\', ""PUBLIC"".""ORDERS"".""CREATED_AT"")\r\nORDER BY\r\n  DATE_TRUNC(\'month\', ""PUBLIC"".""ORDERS"".""CREATED_AT"") ASC`\r\n\r\nCan you provide the SQL using Sample data?\r\n\r\nMaybe a video can help as well.\r\n\r\nThanks!', 'created_at': datetime.datetime(2024, 4, 12, 16, 30, 6, tzinfo=datetime.timezone.utc)}, {'comment_id': 2057085707, 'issue_id': 2236287114, 'author': 'DillonWhatley', 'body': 'Added Video and SQL used to the original post.  I believe the text filter for `User` with no default is part of the problem.   \r\nWhen you navigate to the question it\'s initially ""broken"" until you enter a value into the filter.  I believe saving it in this state saves it without the AXIS selected.  \r\n@ignacio-mb', 'created_at': datetime.datetime(2024, 4, 15, 15, 5, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2102620901, 'issue_id': 2236287114, 'author': 'zbodi74', 'body': 'Thank you @DillonWhatley, yes, it appears the visualization settings are lost if the native question is saved in a ""broken"" state, when a required parameter is missing.', 'created_at': datetime.datetime(2024, 5, 9, 13, 4, 5, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-04-12 16:30:06 UTC): Hi @DillonWhatley I used the following SQL and couldn't reproduce:

`SELECT
  DATE_TRUNC('month', ""PUBLIC"".""ORDERS"".""CREATED_AT"") AS ""CREATED_AT"",
  COUNT(*) AS ""count""
FROM
  ""PUBLIC"".""ORDERS""
[[WHERE {{TEST}}]]
GROUP BY
  DATE_TRUNC('month', ""PUBLIC"".""ORDERS"".""CREATED_AT"")
ORDER BY
  DATE_TRUNC('month', ""PUBLIC"".""ORDERS"".""CREATED_AT"") ASC`

Can you provide the SQL using Sample data?

Maybe a video can help as well.

Thanks!

DillonWhatley (Issue Creator) on (2024-04-15 15:05:50 UTC): Added Video and SQL used to the original post.  I believe the text filter for `User` with no default is part of the problem.   
When you navigate to the question it's initially ""broken"" until you enter a value into the filter.  I believe saving it in this state saves it without the AXIS selected.  
@ignacio-mb

zbodi74 on (2024-05-09 13:04:05 UTC): Thank you @DillonWhatley, yes, it appears the visualization settings are lost if the native question is saved in a ""broken"" state, when a required parameter is missing.

"
2236265208,issue,closed,completed,[dc.js migration] Small dashcards should auto-hide axes,"https://metaboat.slack.com/archives/C06G94JTWBS/p1712760092922369
https://metaboat.slack.com/archives/C06G94JTWBS/p1712760335760029
https://metaboat.slack.com/archives/C06G94JTWBS/p1712761335456369
",alxnddr,2024-04-10 19:18:17+00:00,['alxnddr'],2024-04-15 19:46:00+00:00,2024-04-15 19:46:00+00:00,https://github.com/metabase/metabase/issues/41273,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2236187867,issue,closed,completed,Migrate types so that `useCallback` functions are typed,,npfitz,2024-04-10 18:29:14+00:00,['npfitz'],2024-04-12 15:58:34+00:00,2024-04-12 15:58:34+00:00,https://github.com/metabase/metabase/issues/41271,[],[],
2236166622,issue,open,,Public Dashboard Links with Locked Parameters,"**Is your feature request related to a problem? Please describe.**
In this scenario, we have a a dashboard that needs to be provided to many different customers. Each customer needs the data to be filtered differently. There is no need (or desire or resources) to build an embedding solution.

**Describe the solution you'd like**
Being able to create multiple public links with hidden locked filters configured for each. 

**Describe alternatives you've considered**
- Static embed
- Subscriptions
- Setting up accounts for customers and leveraging data sandboxing
",ixipixi,2024-04-10 18:14:48+00:00,[],2024-05-21 13:07:19+00:00,,https://github.com/metabase/metabase/issues/41269,"[('Type:New Feature', ''), ('Embedding/Public', 'Simple public iframe embeds'), ('.Team/Embedding', '')]",[],
2236065611,issue,open,,"`notempty(regexextract([Referer URL], ""store|pricing""))` not usable as filter custom expression","`notempty(regexextract([Referer URL], ""store|pricing""))` not usable as filter custom expression. For more info see the following:

- [slack discussion](https://metaboat.slack.com/archives/C0645JP1W81/p1712762382063409)
- [reproduction on stats](https://stats.metabase.com/question/17038-store-or-pricing-filtered-page-view-version-1)
- [workaround on stats](https://stats.metabase.com/question/17039-store-or-pricing-filtered-page-view-version-2)

---

I get an error on current master 184cb81275a1c39b358cf2fdd49c955e890e8728 and 49.3. But the different one as discussed on slack. Screenshot:

<img width=""1496"" alt=""Screenshot 2024-04-10 at 18 55 51"" src=""https://github.com/metabase/metabase/assets/8920752/be407437-ab02-4132-be5b-3fb01c270c7a"">
",lbrdnk,2024-04-10 17:07:26+00:00,[],2025-02-04 20:27:56+00:00,,https://github.com/metabase/metabase/issues/41265,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Processor', ''), ('Querying/MBQL', ''), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2048330688, 'issue_id': 2236065611, 'author': 'lbrdnk', 'body': ""Possible solution could be to modify `is-empty` and its counterpart schema in [legacy_mbql/schema.cljc](https://github.com/metabase/metabase/blob/82dd157aca0bc95b4b543d1395bb1be1ab5c948f/src/metabase/legacy_mbql/schema.cljc#L769) to something as following:\r\n\r\n```\r\n[:or [:ref :metabase.legacy-mbql.schema/FieldOrExpressionDef] Field]\r\n```\r\n\r\nWith that change in place this specific case returns correct results, but that's rather conicidence. Eg. `metabase.legacy-mbql.util/desugar-is-empty-and-not-empty` and related code should be updated accordingly if we pursue proposed solution."", 'created_at': datetime.datetime(2024, 4, 10, 19, 55, 14, tzinfo=datetime.timezone.utc)}]","lbrdnk (Issue Creator) on (2024-04-10 19:55:14 UTC): Possible solution could be to modify `is-empty` and its counterpart schema in [legacy_mbql/schema.cljc](https://github.com/metabase/metabase/blob/82dd157aca0bc95b4b543d1395bb1be1ab5c948f/src/metabase/legacy_mbql/schema.cljc#L769) to something as following:

```
[:or [:ref :metabase.legacy-mbql.schema/FieldOrExpressionDef] Field]
```

With that change in place this specific case returns correct results, but that's rather conicidence. Eg. `metabase.legacy-mbql.util/desugar-is-empty-and-not-empty` and related code should be updated accordingly if we pursue proposed solution.

"
2235853632,issue,closed,completed,Starburst connector impersonation based on another field than email field,"**Is your feature request related to a problem? Please describe.**
We are benchmarking Metabase for our next BI tool. We are making some test trying to use Metabase with Starburst Trino connector. As authentication system, we use LDAP. Actually, if we want to impersonate queries, Metabase use by default user mail field filled by LDAP when new user sign-on. 

We take a look inside Metabase code and found that function that confirm that email user field is used by default ([here](https://github.com/starburstdata/metabase-driver/blob/main/drivers/starburst/src/metabase/driver/implementation/execute.clj#L158)):
```clojure
(defn impersonate-user
  [conn]
  (if
    (clojure.string/includes? (.getProperty (.getClientInfo conn) ""ClientInfo"" """") ""impersonate:true"")
    (let [email (get (deref api/*current-user*) :email)]
      (.setSessionUser (.unwrap conn TrinoConnection) email))
    nil))
```

**Describe the solution you'd like**
We think that it could be really nice to choose which field we want to use between user fields (first name, last name and email).

**Describe alternatives you've considered**
We don't really have alternative as our Trino authentication is based on another field than email. For the moment, we are not going to use impersonation which is a problem for us because we can't manage data access very well using Trino user rules..

**How important is this feature to you?**
To be honest, this feature is really important for us because without this feature, we can't go futher using Metabase in production while we think that it's a great tool for our needs.

**Additional context**
Metabase version: v0.49.3
Starburst driver version: 4.1.0
Trino version: 439

Thanks for your help 🙂
",maxpoulain,2024-04-10 15:15:06+00:00,[],2024-05-28 16:06:54+00:00,2024-05-28 16:06:54+00:00,https://github.com/metabase/metabase/issues/41261,"[('Type:New Feature', ''), ('Administration/Permissions', 'Collection or Data permissions'), ('Administration/Impersonation', 'Role level security')]",[],
2235818868,issue,closed,not_planned,"BE flakes: ""java.util.ConcurrentModificationException"" in H2","I hit this flake but admittedly have no idea how frequent it is. I suspect it's not tied to any test in particular so will probably be really difficult to track its frequency. It seems like a bug with H2, and may be related to [this issue](https://github.com/h2database/h2database/issues/2288).

Example run: https://github.com/metabase/metabase/actions/runs/8631518868/job/23660129347?pr=41249#step:10:1548

This test runs in parallel and the query executes on H2.

The important part of the stack trace is here:
```
    originalMessage: ""General error: \""java.util.ConcurrentModificationException\""""
java.util.ConcurrentModificationException: 
                                                           java.util.HashMap$HashIterator.nextNode                HashMap.java: 1511
                                                              java.util.HashMap$ValueIterator.next                HashMap.java: 1539
                                                        org.h2.engine.SessionLocal.cleanTempTables           SessionLocal.java:  965
                                                                 org.h2.engine.SessionLocal.commit           SessionLocal.java:  681
                                                                       org.h2.command.Command.stop                Command.java:  157
                                                              org.h2.command.CommandContainer.stop       CommandContainer.java:  259
                                                               org.h2.command.Command.executeQuery                Command.java:  229
```

`SessionLocal.java:965` is here:
`https://github.com/h2database/h2database/blob/version-2.1.214/h2/src/main/org/h2/engine/SessionLocal.java#L965`

full stack trace: 

```
metabase.query-processor-test.parameters-test/ignore-parameters-for-unparameterized-native-query-test (execute.clj:707)
Parameters passed for unparameterized queries should get ignored
expected: (=
           (->
            (qp/process-query query)
            (m/dissoc-in [:data :results_metadata :checksum]))
           (->
            (qp/process-query
             (assoc
              query
              :parameters
              [{:target [:dimension
                         [:field
                          (mt/id :categories :id)
                          {:source-field (mt/id :venues :category_id)}]],
                :type ""category"",
                :value [:param-value]}]))
            (m/dissoc-in [:data :native_form :params])
            (m/dissoc-in [:data :results_metadata :checksum])))
  actual: 
               clojure.lang.ExceptionInfo: Error executing query: General error: ""java.util.ConcurrentModificationException"" [50000-214]
    driver: :h2
    params: nil
       sql: [""-- Metabase"" ""select"" ""  111 as my_number,"" ""  'foo' as my_string""]
      type: :invalid-query
 org.h2.jdbc.JdbcSQLNonTransientException: General error: ""java.util.ConcurrentModificationException"" [50000-214]
           SQLState: ""HY000""
          errorCode: 50000
    originalMessage: ""General error: \""java.util.ConcurrentModificationException\""""
java.util.ConcurrentModificationException: 
                                                           java.util.HashMap$HashIterator.nextNode                HashMap.java: 1511
                                                              java.util.HashMap$ValueIterator.next                HashMap.java: 1539
                                                        org.h2.engine.SessionLocal.cleanTempTables           SessionLocal.java:  965
                                                                 org.h2.engine.SessionLocal.commit           SessionLocal.java:  681
                                                                       org.h2.command.Command.stop                Command.java:  157
                                                              org.h2.command.CommandContainer.stop       CommandContainer.java:  259
                                                               org.h2.command.Command.executeQuery                Command.java:  229
                                                         org.h2.jdbc.JdbcStatement.executeInternal          JdbcStatement.java:  247
                                                                 org.h2.jdbc.JdbcStatement.execute          JdbcStatement.java:  223
                                                com.mchange.v2.c3p0.impl.NewProxyStatement.execute      NewProxyStatement.java:   75
                                                    metabase.driver.sql-jdbc.execute/eval108245/fn                 execute.clj:  560
                                                                                               ...                                  
                         metabase.driver.sql-jdbc.execute/execute-statement-or-prepared-statement!                 execute.clj:  568
                                    metabase.driver.sql-jdbc.execute/execute-reducible-query/fn/fn                 execute.clj:  705
                                       metabase.driver.sql-jdbc.execute/execute-reducible-query/fn                 execute.clj:  704
                                                               metabase.driver.h2/eval110477/fn/fn                      h2.clj:  546
                                                            metabase.driver.sql-jdbc.execute/fn/&f                 execute.clj:  335
                                                            metabase.driver.sql-jdbc.execute/fn/fn                 execute.clj:  318
                                                                  metabase.driver.h2/eval110477/fn                      h2.clj:  537
                                                                                               ...                                  
                                          metabase.driver.sql-jdbc.execute/execute-reducible-query                 execute.clj:  698
                                          metabase.driver.sql-jdbc.execute/execute-reducible-query                 execute.clj:  695
                                                            metabase.driver.sql-jdbc/eval109441/fn                sql_jdbc.clj:   78
                                                                  metabase.driver.h2/eval110233/fn                      h2.clj:  272
                                                                                               ...                                  
                                                       metabase.query-processor.pipeline/*execute*                pipeline.clj:   47
                                                           metabase.query-processor.pipeline/*run*                pipeline.clj:   88
                                                              metabase.query-processor.execute/run                 execute.clj:   45
                            metabase.query-processor.execute/add-native-form-to-result-metadata/fn                 execute.clj:   21
metabase.query-processor.middleware.cache/maybe-return-cached-results/maybe-return-cached-results*                   cache.clj:  242
                        metabase.query-processor.middleware.permissions/check-query-permissions/fn             permissions.clj:  118
           metabase.query-processor.middleware.enterprise/check-download-permissions-middleware/fn              enterprise.clj:   51
 metabase.query-processor.middleware.enterprise/maybe-apply-column-level-perms-check-middleware/fn              enterprise.clj:   64
                                                         metabase.query-processor.execute/fn/&f/fn                 execute.clj:   74
                                                              metabase.query-processor.setup/fn/&f                   setup.clj:  215
                                                              metabase.query-processor.setup/fn/fn                   setup.clj:  206
                                                            metabase.query-processor.execute/fn/&f                 execute.clj:   73
                                                            metabase.query-processor.execute/fn/fn                 execute.clj:   64
                                                          metabase.query-processor/process-query**         query_processor.clj:   47
     metabase.query-processor.middleware.enterprise/eval84647/handle-audit-app-internal-queries/fn              enterprise.clj:   96
    metabase.query-processor.middleware.enterprise/handle-audit-app-internal-queries-middleware/fn              enterprise.clj:  103
                               metabase.query-processor.middleware.process-userland-query/fn/&f/&f  process_userland_query.clj:  157
                               metabase.query-processor.middleware.process-userland-query/fn/&f/fn  process_userland_query.clj:  154
                                     metabase.query-processor.middleware.catch-exceptions/fn/&f/&f        catch_exceptions.clj:  121
                                     metabase.query-processor.middleware.catch-exceptions/fn/&f/fn        catch_exceptions.clj:  118
                                                                 metabase.query-processor/fn/&f/fn         query_processor.clj:   78
                                                           metabase.query-processor.setup/fn/&f/fn                   setup.clj:  178
                                                           metabase.query-processor.setup/fn/&f/fn                   setup.clj:  170
                                                        metabase.query-processor.setup/fn/&f/fn/fn                   setup.clj:  146
                                                                    metabase.driver/do-with-driver                  driver.clj:   97
                                                           metabase.query-processor.setup/fn/&f/fn                   setup.clj:  145
                                                           metabase.query-processor.setup/fn/&f/fn                   setup.clj:  155
                                                        metabase.query-processor.setup/fn/&f/fn/fn                   setup.clj:  131
                                                              metabase.query-processor.store/fn/&f                   store.clj:  170
                                                              metabase.query-processor.store/fn/fn                   store.clj:  150
                                                              metabase.query-processor.store/fn/&f                   store.clj:  159
                                                              metabase.query-processor.store/fn/fn                   store.clj:  150
                                                           metabase.query-processor.setup/fn/&f/fn                   setup.clj:  130
                                                           metabase.query-processor.setup/fn/&f/&f                   setup.clj:  108
                                                           metabase.query-processor.setup/fn/&f/fn                   setup.clj:  102
                                                              metabase.query-processor.setup/fn/&f                   setup.clj:  222
                                                              metabase.query-processor.setup/fn/fn                   setup.clj:  206
                                                                    metabase.query-processor/fn/&f         query_processor.clj:   76
                                                                    metabase.query-processor/fn/fn         query_processor.clj:   69
                                                                    metabase.query-processor/fn/&f         query_processor.clj:   72
                                                                    metabase.query-processor/fn/fn         query_processor.clj:   69
                                                  metabase.query-processor-test.parameters-test/fn         parameters_test.clj:  378
                                                                          clojure.test/test-var/fn                    test.clj:  717
                                                                             clojure.test/test-var                    test.clj:  717
                                                                             mb.hawk.core/run-test                    core.clj:  151
                                                                     eftest.runner/test-vars/fn/fn                  runner.clj:  106
                                                                      clojure.test/default-fixture                    test.clj:  687
                                                                        eftest.runner/test-vars/fn                  runner.clj:   98
                                                             eftest.runner/wrap-test-with-timer/fn                  runner.clj:   38
                                                                         eftest.runner/pmap*/fn/fn                  runner.clj:   72
                                                                                               ...                                  
                                                                                clojure.core/apply                    core.clj:  667
                                                                       clojure.core/with-bindings*                    core.clj: 1990 (repeats 2 times)
                                                                                               ...                                  
                                                           eftest.runner/bound-callback/reify/call                  runner.clj:   55
                                                               java.util.concurrent.FutureTask.run             FutureTask.java:  264
                                                 java.util.concurrent.ThreadPoolExecutor.runWorker     ThreadPoolExecutor.java: 1128
                                                java.util.concurrent.ThreadPoolExecutor$Worker.run     ThreadPoolExecutor.java:  628
                                                                              java.lang.Thread.run                 Thread.java:  829
```",calherries,2024-04-10 14:59:24+00:00,[],2024-12-13 16:43:35+00:00,2024-12-13 16:43:35+00:00,https://github.com/metabase/metabase/issues/41259,"[('.Backend', ''), ('flaky-test-fix', ''), ('.Team/Querying', '')]","[{'comment_id': 2049652387, 'issue_id': 2235818868, 'author': 'calherries', 'body': ""From Cam on slack:\r\n\r\n> I'm guessing it's an upstream H2 bug, most be a race condition because this is the first time I've ever seen it. Seems like it would only be an issue when running a lot of threads simultaneously (e.g. parallel tests)... Most people in prod hopefully aren't using H2 or at least not with a ton of simultaneous users so I wouldn't be worried about this affecting prod too much."", 'created_at': datetime.datetime(2024, 4, 11, 13, 5, 22, tzinfo=datetime.timezone.utc)}]","calherries (Issue Creator) on (2024-04-11 13:05:22 UTC): From Cam on slack:

"
2235802782,issue,closed,completed,Migrate global css in `frontend/src/metabase/visualizations/components/TableInteractive/TableInteractive.module.css`,,deniskaber,2024-04-10 14:53:28+00:00,['deniskaber'],2024-04-15 15:20:02+00:00,2024-04-15 15:20:02+00:00,https://github.com/metabase/metabase/issues/41258,[],[],
2235682317,issue,closed,completed,"Migrate global styles in `base.module.css`, extract global html styles to GlobalStyles component","```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/pull/41246
- [ ] https://github.com/metabase/metabase/pull/41527
```
",WiNloSt,2024-04-10 14:01:31+00:00,['WiNloSt'],2024-04-18 08:41:22+00:00,2024-04-18 08:41:22+00:00,https://github.com/metabase/metabase/issues/41256,[],[],
2235649160,issue,closed,not_planned,Serialization: Field filter modification on source Instance doesn't correctly update the Field Filter on Destination Instance,"### Describe the bug

If you have a field filter set up on a source instance and destination instance that your managing with serialization for version control, changing the column reference on the source instance, exporting the change and importing into the destination doesn't result in correct values being displayed in the field filter.

### To Reproduce

1. Set up 2 fresh Metabase installation
2. In Instance1 create ""Test Dashboard"" with a question that has a field filter on it that populates a list of values from another question
3. Create an export
4. Import this into Instance2
5. Note that the imported ""Test Dashboard"" and field filter works in Instance2 as expected
6. Go back to Instance1 and edit the field filter on ""Test Dashboard"" to refer to a different text column
7. Create a new export
8. Import this into Instance2 to update the dashboard
9. Go to ""Test Dashboard"" and note that it doesn't show the values from the newly selected text column - it still displays the original list from prior to the reimport. You also cannot edit the field filter - Metabase doesn't recognize t4ext columns exist on the table the filter is source from. navigating to the question the values are sourced from corrects this issue.|

Loom: https://www.loom.com/share/fcfa604a9f9a495881235563fc68506e

### Expected behavior

Changes from the source instance should reflect correctly in the destination instance.

### Logs

HAR file navigating the dashboard and opening the edit modal in Instance2 after the field filter has been broken.

[har.zip](https://github.com/metabase/metabase/files/14932923/har.zip)


### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.133.1-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.22 (Debian 11.22-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-03-14"",
      ""tag"": ""v1.49.0"",
      ""hash"": ""46c668b""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

For customers that use serialization for version control this is significant.

### Additional context

_No response_",ixipixi,2024-04-10 13:47:36+00:00,['piranha'],2024-05-29 15:27:34+00:00,2024-04-17 09:20:38+00:00,https://github.com/metabase/metabase/issues/41255,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Operation/Serialization', 'Enterprise contents migration'), ('.Escalation', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2047636023, 'issue_id': 2235649160, 'author': 'ixipixi', 'body': 'Also confirmed this is still an issue in 49.3', 'created_at': datetime.datetime(2024, 4, 10, 14, 1, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2059087563, 'issue_id': 2235649160, 'author': 'piranha', 'body': ""@ixipixi I wasn't able to reproduce that, could you please verify that I'm not missing anything peculiar: https://www.loom.com/share/3b0aee6aee4345c5b811d6be0365b1fd\r\n\r\nThis is on master but I believe it has no meaningful difference regarding serialization to any of latest releases."", 'created_at': datetime.datetime(2024, 4, 16, 13, 24, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2059434413, 'issue_id': 2235649160, 'author': 'ixipixi', 'body': '@piranha in my test case the dashboard filter was set up to pull a list of values from another model or question. Changing which column the values come from in the source and then importing that change is where the bug is introduced. \r\n\r\n![filter_change](https://github.com/metabase/metabase/assets/13661163/c42b20a7-d006-40ef-be51-cec535e3dad0)', 'created_at': datetime.datetime(2024, 4, 16, 15, 59, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2060727424, 'issue_id': 2235649160, 'author': 'piranha', 'body': '@ixipixi okay great news! I can reproduce exactly this issue on 49.0, but not on master - which means we have it fixed, I just need to find that fix. :)', 'created_at': datetime.datetime(2024, 4, 17, 8, 45, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2060803417, 'issue_id': 2235649160, 'author': 'piranha', 'body': '@ixipixi this is a problem with [result_metadata not being serialized](https://github.com/metabase/metabase/pull/41131) and is fixed in 0.49.5.', 'created_at': datetime.datetime(2024, 4, 17, 9, 20, 38, tzinfo=datetime.timezone.utc)}, {'comment_id': 2062050143, 'issue_id': 2235649160, 'author': 'ixipixi', 'body': '@piranha awesome. Thank you!', 'created_at': datetime.datetime(2024, 4, 17, 19, 26, 48, tzinfo=datetime.timezone.utc)}]","ixipixi (Issue Creator) on (2024-04-10 14:01:41 UTC): Also confirmed this is still an issue in 49.3

piranha (Assginee) on (2024-04-16 13:24:25 UTC): @ixipixi I wasn't able to reproduce that, could you please verify that I'm not missing anything peculiar: https://www.loom.com/share/3b0aee6aee4345c5b811d6be0365b1fd

This is on master but I believe it has no meaningful difference regarding serialization to any of latest releases.

ixipixi (Issue Creator) on (2024-04-16 15:59:59 UTC): @piranha in my test case the dashboard filter was set up to pull a list of values from another model or question. Changing which column the values come from in the source and then importing that change is where the bug is introduced. 

![filter_change](https://github.com/metabase/metabase/assets/13661163/c42b20a7-d006-40ef-be51-cec535e3dad0)

piranha (Assginee) on (2024-04-17 08:45:05 UTC): @ixipixi okay great news! I can reproduce exactly this issue on 49.0, but not on master - which means we have it fixed, I just need to find that fix. :)

piranha (Assginee) on (2024-04-17 09:20:38 UTC): @ixipixi this is a problem with [result_metadata not being serialized](https://github.com/metabase/metabase/pull/41131) and is fixed in 0.49.5.

ixipixi (Issue Creator) on (2024-04-17 19:26:48 UTC): @piranha awesome. Thank you!

"
2235191397,issue,closed,completed,"Progress visualizations don't show, except on dashboards","### Describe the bug

Questions with a ""Progress"" visualization have an error on the visualization on the question page, although they work fine when you add them to a dashboard.

- Duplicated Issue: https://github.com/metabase/metabase/issues/40658

Here's the error:

<img width=""821"" alt=""image"" src=""https://github.com/metabase/metabase/assets/39073188/050a6111-6f6a-4318-88e5-e1fa519ce82c"">

this is the error in the browser console:
```
console.js:13 TypeError: Cannot read properties of undefined (reading 'height')
    at bP.componentDidUpdate (Progress.jsx:101:39)
    at bP.componentDidMount (Progress.jsx:87:10)
    at react-dom.production.min.js:219:411
    at a9 (react-dom.production.min.js:221:83)
    at t.unstable_runWithPriority (scheduler.production.min.js:18:343)
    at on (react-dom.production.min.js:122:325)
    at a7 (react-dom.production.min.js:252:279)
    at aG (react-dom.production.min.js:243:371)
    at react-dom.production.min.js:123:115
```


### To Reproduce

See an example on [stats](https://stats.metabase.com/question/15546-revenue-goal-for-this-quarter) or

1. Create a new question that selects one number, such as ""Sum of Total"" from ""Orders"":
![image](https://github.com/metabase/metabase/assets/39073188/108aba3b-0ee5-4616-8fc5-341407ce2179)
2. Select the ""Progress"" visualization type, and observe the error


### Expected behavior

the graph should look like it does on a dashboard, e.g.
![image](https://github.com/metabase/metabase/assets/39073188/990775a6-3106-4a56-8697-b5932a016121)


### Logs

_No response_

### Information about your Metabase installation

```JSON
master, haven't checked 49 though
```


### Severity

blocks users from using the progress visualization

### Additional context

_No response_",calherries,2024-04-10 09:53:34+00:00,['JesseSDevaney'],2024-04-16 13:55:54+00:00,2024-04-15 21:14:34+00:00,https://github.com/metabase/metabase/issues/41243,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Visualization/Scalars', 'Numbers, progress bars, gauges'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2048956831, 'issue_id': 2235191397, 'author': 'NicolasPA', 'body': 'I think it is the same as https://github.com/metabase/metabase/issues/40658.', 'created_at': datetime.datetime(2024, 4, 11, 5, 34, 12, tzinfo=datetime.timezone.utc)}]","NicolasPA on (2024-04-11 05:34:12 UTC): I think it is the same as https://github.com/metabase/metabase/issues/40658.

"
2235138160,issue,closed,completed,Support parsing native queries with a {{#card-id}} ref in them,,tsmacdonald,2024-04-10 09:24:45+00:00,['tsmacdonald'],2024-04-30 09:23:48+00:00,2024-04-10 13:46:31+00:00,https://github.com/metabase/metabase/issues/41242,"[('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]",[],
2235090796,issue,closed,completed,Create collection modal starts with an error,"### Describe the bug


https://github.com/metabase/metabase/assets/6830683/fdcef297-eac0-411c-bb29-e8d61a38c0ed



### To Reproduce

1. Click ""New +""
2. Choose ""Collection""

Create collection modal opens
- error is shown
- name input does not get auto focus

3. Press the Space key

Modal closes (because ""x"" button gets auto focus

### Expected behavior

- Error isn't shown after opening the modal
- Name input is auto-focused after opening the modal
- Modal isn't closed after pressing the Space key

### Information about your Metabase installation

master, f3d161382d


### Severity

P3",kamilmielnik,2024-04-10 08:58:11+00:00,['sloansparger'],2024-06-10 20:38:34+00:00,2024-06-04 23:07:49+00:00,https://github.com/metabase/metabase/issues/41241,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Organization/Collections', ''), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2235064830,issue,closed,completed,"When exporting to CSV (or JSON or XLSX) from an embedded report, the file only contains 'Unknown parameter :format_rows.'","### Describe the bug

When trying to export a query-based report, which is embedded, the export is invalid an only contains 'Unknown parameter :format_rows.'

### To Reproduce

1. go to any report
2. Go to sharing > embed > static Embed > edit settings
3. Tab Appearance > Preview
4. Click the download icon in the left corner


### Expected behavior

Expect to export the result.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""nl-NL"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.0-17-amd64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""mysql""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MySQL"",
        ""version"": ""8.0.30""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-02"",
      ""tag"": ""v0.49.3"",
      ""hash"": ""dba0992""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

blocking for users using embedded reports

### Additional context

_No response_",jdvconsult,2024-04-10 08:43:33+00:00,['adam-james-v'],2024-04-11 11:27:56+00:00,2024-04-10 16:57:21+00:00,https://github.com/metabase/metabase/issues/41240,"[('Type:Bug', 'Product defects'), ('Reporting/Export', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2047249991, 'issue_id': 2235064830, 'author': 'darksciencebase', 'body': 'same as https://github.com/metabase/metabase/issues/40959 ?', 'created_at': datetime.datetime(2024, 4, 10, 11, 10, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2048048428, 'issue_id': 2235064830, 'author': 'adam-james-v', 'body': ""Closing this because it's a dupe of #40959 and will be fixed with #41264"", 'created_at': datetime.datetime(2024, 4, 10, 16, 57, 21, tzinfo=datetime.timezone.utc)}]","darksciencebase on (2024-04-10 11:10:32 UTC): same as https://github.com/metabase/metabase/issues/40959 ?

adam-james-v (Assginee) on (2024-04-10 16:57:21 UTC): Closing this because it's a dupe of #40959 and will be fixed with #41264

"
2235060307,issue,closed,completed,"Migrate global css in `frontend/src/metabase/css/core/bordered.module.css`, `frontend/src/metabase/css/core/clearfix.module.css`, `frontend/src/metabase/css/core/float.module.css`","```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/pull/41307
- [ ] https://github.com/metabase/metabase/pull/41509
- [ ] https://github.com/metabase/metabase/pull/41510
```",WiNloSt,2024-04-10 08:40:51+00:00,['WiNloSt'],2024-04-17 13:53:33+00:00,2024-04-17 13:53:33+00:00,https://github.com/metabase/metabase/issues/41239,[],[],
2235035817,issue,closed,completed,"Add ""Most used functions"" to suggestion dropdown",Add most used functions or aggregations to the expression editor dropdwon.,romeovs,2024-04-10 08:26:41+00:00,['romeovs'],2024-04-16 14:16:16+00:00,2024-04-16 14:16:15+00:00,https://github.com/metabase/metabase/issues/41237,[],[],
2234964071,issue,closed,completed,Wrong File Name of the attachement in Subscription Email,"**Describe the bug**
A clear and concise description of what the bug is.

![image](https://github.com/metabase/metabase/assets/3712729/a8619cdd-cd1a-4eaf-a4d2-8cb56659db8e)


**Logs**
Please include javascript console and server logs around the time this bug occurred. For information about how to get these, consult our [bug troubleshooting guide](https://metabase.com/docs/latest/troubleshooting-guide/bugs.html)

**To Reproduce**
Steps to reproduce the behavior:
1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**Severity**
How severe an issue is this bug to you? Is this annoying, blocking some users, blocking an upgrade or blocking your usage of Metabase entirely?
Note: the more honest and specific you are here the more we will take you seriously.

**Additional context**
Add any other context about the problem here.

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""zh-CN"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""4.15.0-121-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""clickhouse""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.16 (Debian 11.16-1.pgdg90+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-02"",
      ""tag"": ""v0.49.3"",
      ""hash"": ""dba0992""
    },
    ""settings"": {
      ""report-timezone"": ""Asia/Shanghai""
    }
  }
}
```",oliverzgy,2024-04-10 07:44:39+00:00,[],2025-01-07 21:43:17+00:00,2025-01-07 21:43:16+00:00,https://github.com/metabase/metabase/issues/41235,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Pulses', 'Now called Subscriptions'), ('.Backend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2047736633, 'issue_id': 2234964071, 'author': 'ignacio-mb', 'body': ""Hi @oliverzgy  can you provide reproduction steps for this? What's the name of the questions you are sending?"", 'created_at': datetime.datetime(2024, 4, 10, 14, 37, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2576277984, 'issue_id': 2234964071, 'author': 'tsplude', 'body': 'Closing as unable to reproduce\n\nFrom the posted image, `%E5%8E%9F` is the url encoding of 原 (U+539F) and `%E5%8D%95` is the url encoding of 单 (U+5355). I see the correctly encoded characters in exported filenames using both Chrome & Firefox. The filename is correctly percent/url encoded over the wire through the `Content-Disposition` header. I would guess that the failure to re-encode them from their url encoded representations ultimately is a Linux file system / locale settings issue and thus not a Metabase bug', 'created_at': datetime.datetime(2025, 1, 7, 21, 43, 16, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-04-10 14:37:35 UTC): Hi @oliverzgy  can you provide reproduction steps for this? What's the name of the questions you are sending?

tsplude on (2025-01-07 21:43:16 UTC): Closing as unable to reproduce

From the posted image, `%E5%8E%9F` is the url encoding of 原 (U+539F) and `%E5%8D%95` is the url encoding of 单 (U+5355). I see the correctly encoded characters in exported filenames using both Chrome & Firefox. The filename is correctly percent/url encoded over the wire through the `Content-Disposition` header. I would guess that the failure to re-encode them from their url encoded representations ultimately is a Linux file system / locale settings issue and thus not a Metabase bug

"
2234888378,issue,open,,Grid map based on hexagons (H3) rather than rectangles,"Earth is round and rectangles are not a good way to capture that. resulting in varying and suboptimal partitions on the grid maps (based on the location).

I'd like hexagons to be used instead of rectangles. [H3](https://h3geo.org/) might be a good choice.",ValdarT,2024-04-10 06:56:33+00:00,[],2024-04-10 14:38:23+00:00,,https://github.com/metabase/metabase/issues/41233,"[('Type:New Feature', ''), ('Visualization/Maps', '')]",[],
2234504888,issue,closed,not_planned,Digits being lopped off during csv export,"### Describe the bug

After upgrading to v1.49.0 (currently on v1.49.3) a CSV export of a postgres sql data resource with `AMOUNT` for example turns a value like `99145` to `991`, perhaps rounding, perhaps truncating/lopping, not sure.
<img width=""311"" alt=""Screenshot 2024-04-04 at 2 07 37 PM"" src=""https://github.com/metabase/metabase/assets/3313148/6802ffa6-e982-4037-a054-4e7c5ecd4203"">
![Screenshot 2024-04-04 at 2 07 29 PM](https://github.com/metabase/metabase/assets/3313148/a3f6ab02-076b-4a64-955a-88d343172354)


### To Reproduce

0. Using postgres 15 as a backend
1. Go to a table view
2. Click on Download 
4. Scroll down to CSV
5. Compare values one should have 2 trailing characters lopped off


### Expected behavior

should not truncate values on export

### Logs

_No response_

### Information about your Metabase installation

```JSON
gke metabase 1.49.3
```


### Severity

blocking normal export and reporting use

### Additional context

we do not want to roll back to 1.48 can you help fix this or offer a workaround?",rojomisin,2024-04-10 00:06:47+00:00,[],2024-05-01 08:55:17+00:00,2024-05-01 08:55:17+00:00,https://github.com/metabase/metabase/issues/41226,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2046242291, 'issue_id': 2234504888, 'author': 'adam-james-v', 'body': ""Since you're on 49.3, it would be helpful if you could try to download the data 'unformatted'. To do this, before you click download, if you hold the 'option'/'alt' key and then hover over the .csv download option, you should see (Unformatted) to the right of the .csv label.\r\n\r\nThen, download your results and see if the issue still happens with this unformatted version. If not, that might be a useful workaround for you while we solve the reported bug."", 'created_at': datetime.datetime(2024, 4, 10, 0, 26, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2086816564, 'issue_id': 2234504888, 'author': 'paoliniluis', 'body': '@rojomisin have you checked the suggestion from above?', 'created_at': datetime.datetime(2024, 4, 30, 19, 29, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2087954633, 'issue_id': 2234504888, 'author': 'rojomisin', 'body': 'yes this worked thank you', 'created_at': datetime.datetime(2024, 5, 1, 4, 22, 17, tzinfo=datetime.timezone.utc)}]","adam-james-v on (2024-04-10 00:26:44 UTC): Since you're on 49.3, it would be helpful if you could try to download the data 'unformatted'. To do this, before you click download, if you hold the 'option'/'alt' key and then hover over the .csv download option, you should see (Unformatted) to the right of the .csv label.

Then, download your results and see if the issue still happens with this unformatted version. If not, that might be a useful workaround for you while we solve the reported bug.

paoliniluis on (2024-04-30 19:29:55 UTC): @rojomisin have you checked the suggestion from above?

rojomisin (Issue Creator) on (2024-05-01 04:22:17 UTC): yes this worked thank you

"
2234324651,issue,closed,completed,Product Iteration - Split data permissions UI,"```[tasklist]
### Tasks
- [x] Add a warning at the top of the permissions table if permissions graph contains Legacy No Self Service
- [x] Add warning that native query permissions will be removed from all tables if it's currently selected and the user is createing granular permissions for a table
- [x] Update warning when sandboxing a table should also notify the user that native query permissions will be removed from all tables/schemas if native is selected
```
",sloansparger,2024-04-09 21:25:19+00:00,['sloansparger'],2024-04-17 13:41:15+00:00,2024-04-17 13:41:14+00:00,https://github.com/metabase/metabase/issues/41221,[],[],
2234290559,issue,closed,completed,[dc.js migration] hovering over a point on a split y-axis does not highlight the corresponding y-axis it is being measured against,"**Master**

https://github.com/metabase/metabase/assets/22608765/e61cb7b8-63e0-4882-83bf-d70cfe9f721c

**ECharts**

https://github.com/metabase/metabase/assets/22608765/99d09f9d-8064-478f-b537-481a98efe611

",JesseSDevaney,2024-04-09 21:02:35+00:00,['alxnddr'],2024-04-24 14:50:24+00:00,2024-04-24 14:50:24+00:00,https://github.com/metabase/metabase/issues/41217,"[('Priority:P2', 'Average run of the mill bug'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2234276247,issue,open,,Return value of `driver/database-supports?` should depend on dbms and driver capabilities -- not applicaiton state,"There are places in codebase where return value of `driver/database-supports?` depends on app state and not on driver and dbms capabilities only. As per [this slack discusssion](https://metaboat.slack.com/archives/C04DN5VRQM6/p1712600437339579), we should make that depend only on on driver and dbms capabilities only again.",lbrdnk,2024-04-09 20:51:02+00:00,[],2025-02-04 20:29:49+00:00,,https://github.com/metabase/metabase/issues/41216,"[('Type:Tech Debt', 'or Refactoring'), ('.Backend', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Querying', '')]",[],
2234250782,issue,closed,completed,[dc.js migration] multi-series tooltip does not respect column name and switches to card title,"**Master**

https://github.com/metabase/metabase/assets/22608765/273918b4-08d6-4f74-aa2e-e83f1d77bd0b


**ECharts**


https://github.com/metabase/metabase/assets/22608765/cb872131-a5c9-4f10-8a3d-cd426aa89083

---
**Note:** Both the legend and tool-tip use the `name` property of the series. So for this fix, another property will have to be used or added, so that the legend can use the series name and the tool-tip can use the column name
- ECharts name setter location: https://github.com/metabase/metabase/blob/echarts/frontend/src/metabase/visualizations/echarts/cartesian/model/series.ts#L72",JesseSDevaney,2024-04-09 20:33:11+00:00,['EmmadUsmani'],2024-04-17 14:40:48+00:00,2024-04-17 14:40:48+00:00,https://github.com/metabase/metabase/issues/41215,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2234141192,issue,closed,completed,Upgrade react-draggable and react-dnd to 18 compatible versions,,npfitz,2024-04-09 19:11:39+00:00,[],2024-04-25 20:18:06+00:00,2024-04-10 12:16:45+00:00,https://github.com/metabase/metabase/issues/41208,[],[],
2233970386,issue,closed,completed,Wrong suggested join condition when joining 2 models,"There is a case where wrong join condition is suggested while joining 2 models. More context can be found in [this slack thread](https://metaboat.slack.com/archives/C05MPF0TM3L/p1712273440956579). Steps to reproduce follow.

1. Use the following sql to create a postgres database:

```
create table organization (
    id serial primary key,
    account_id int
);

create table account (
    id serial primary key,
    organization_id int
);

create table contact (
    id serial primary key,
    organization_id int
);

alter table
    organization
add
    constraint fk_account foreign key (account_id) references account(id);

alter table
    account
add
    constraint fk_organization foreign key (organization_id) references organization(id);

alter table
    contact
add
    constraint fk_organization foreign key (organization_id) references organization(id);

insert into organization (account_id) values (NULL);
insert into account (organization_id) values (1);
insert into contact (organization_id) values (1);
update organization set account_id = 1 where id = 1;
```
2. Add that database and use it as data source for next steps.
3. Now create model `Account model` from plain mbql query with source `Account`.
4. Create model `Contact model` from plain mbql query with source `Contact`.

5. Now create a new mbql query with source `Account model`.
6. Attempt to join `Contact model` in query builder.

Wrong join condition is suggested: only table `Organization` has column `account_id`. (Aside: both other tables have foreign keys to that table.)

Screen of incorrect join condition:

<img width=""1496"" alt=""Screenshot 2024-04-09 at 19 25 48"" src=""https://github.com/metabase/metabase/assets/8920752/7267d6c7-2221-4627-8493-92d4fd229086"">
",lbrdnk,2024-04-09 17:28:43+00:00,['lbrdnk'],2024-08-28 02:10:41+00:00,2024-04-12 18:59:03+00:00,https://github.com/metabase/metabase/issues/41202,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/Querying', '')]",[],
2233953158,issue,closed,completed,Handle joining tables in consuming query,,snoe,2024-04-09 17:20:53+00:00,['metamben'],2024-04-18 18:09:49+00:00,2024-04-18 18:09:48+00:00,https://github.com/metabase/metabase/issues/41200,[],[],
2233894830,issue,closed,completed,Filter header is not perfectly fitted when scrolling,"### Describe the bug

This wasn't here in 48

### To Reproduce

1. Create a dashboard with lots of cards
2. Scroll

See the following video, in between the top header and the filters

https://github.com/metabase/metabase/assets/132273646/d01898ec-179d-405d-9181-7f05291b9325




### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
- 49.3 and master
```


### Severity

p3

### Additional context

_No response_",ignacio-mb,2024-04-09 16:57:41+00:00,[],2024-06-18 20:03:09+00:00,2024-06-18 20:03:09+00:00,https://github.com/metabase/metabase/issues/41199,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2176868209, 'issue_id': 2233894830, 'author': 'ignacio-mb', 'body': 'Cannot reproduce as of 50', 'created_at': datetime.datetime(2024, 6, 18, 20, 3, 9, tzinfo=datetime.timezone.utc)}]","ignacio-mb (Issue Creator) on (2024-06-18 20:03:09 UTC): Cannot reproduce as of 50

"
2233872637,issue,closed,completed,Update suggestions to use Mantine components,Update the expression editor suggestions to use Mantine components.,romeovs,2024-04-09 16:45:01+00:00,[],2024-04-12 14:44:17+00:00,2024-04-12 14:44:17+00:00,https://github.com/metabase/metabase/issues/41198,[],[],
2233829093,issue,closed,completed,"Suggest the original question name for derived question in a ""save question"" modal","[Product doc](https://www.notion.so/metabase/Suggest-original-question-name-for-derived-question-528b990f16204d91945ca2d7bb5a9ba3)

When you modify a saved question and want to save it as a new question we auto-generate a new name for it by default.
The task here is to stop auto-generating names, and to suggest the original question name instead.

Motivation:
Most of the time people just want to slightly modify the original (previous) question name.
",nemanjaglumac,2024-04-09 16:20:29+00:00,['nemanjaglumac'],2024-04-11 07:43:48+00:00,2024-04-11 07:43:20+00:00,https://github.com/metabase/metabase/issues/41196,"[('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Querying', '')]",[],
2233804649,issue,closed,completed,Signed Embedding without Title will remove all the tabs of a dashboard as well,"### Describe the bug

Removing the Title From a Dashboard will remove all the tabs leaving only the first one

### To Reproduce

1. Go to New Dashboard -> Add 2 tabs -> Add something in the Tabs and embed it using signed embedding and you will get this:

<img width=""1507"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/b1dfe37d-3732-48c0-bc93-23bef352f0e4"">

2. Change the parameter to remove the title `http://localhost:3000/embed/dashboard/...?tab=21-tab-1#theme=light&bordered&titled=false` and the tabs gets removed as well

<img width=""1512"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/95ef86da-2185-40ef-a79f-2b7c92a5c372"">

The workaround is to add the Title back but it will break already created dashboards that remove the title

### Expected behavior

All Tabs stay there and only the Title gets removed

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
Abel to replicate on 49.3 and master
```


### Severity

It will break current implementation so it's blocking 

### Additional context

_No response_",Tony-metabase,2024-04-09 16:07:48+00:00,['deniskaber'],2024-04-10 08:35:34+00:00,2024-04-10 08:35:33+00:00,https://github.com/metabase/metabase/issues/41195,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('Embedding/Static', 'Static embedding, previously known as signed embedding'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Escalation', '')]",[],
2233711099,issue,closed,completed,Bug bash - Split data access and query builder access,"```[tasklist]
### FE Bugs
- [x] `legacy-no-self-service` `view-data` permissions should disable `create-queries` input
- [x] Missing tooltip message for No self service legacy option’s warning icon
- [x] Hide the View data column on OSS
- [x] Changing a table from “Can view” to “Sandboxed” (don’t save) and back to “Can view” displays the save button still and if saved converts the table to sandboxed
- [x] The tooltip for Download results when you have Blocked data permissions should be updated to match the tooltip for Create queries?
- [x] Warning messages about ""All Users"" group permissions overrides aren't consistent with the new permissions logic
- [x] Saving table permissions warns users with incorrect info in warning modal (e.g. saving w/ query builder only warns admin that users will have native query permissions)
```

```[tasklist]
### BE Bugs
- [x] migrate down command doesn’t seem to work on a non-release JAR, or when running it off of a branch with clj
```
",sloansparger,2024-04-09 15:22:43+00:00,['sloansparger'],2024-04-17 13:40:59+00:00,2024-04-17 13:40:58+00:00,https://github.com/metabase/metabase/issues/41192,[],[],
2233579515,issue,closed,not_planned,[Epic] Admin panel facelift,"**Links**
- product doc: [link](https://www.notion.so/metabase/Give-the-Admin-Panel-a-facelift-55a4b937f056458e861f0247918f4e69?pvs=4)
- figma: [Need to update this link to spec when done](https://www.figma.com/file/7tK3V0ecizJ82FcK09sVDX/Admin-UI-facelift?type=design&node-id=2103-5575&mode=design&t=fdnfKeq46PQatVX7-0)
- [tech design](https://www.notion.so/metabase/Admin-Settings-Redesign-b8a9435f4c7d423399ac296d6b58cf1a)


",luizarakaki,2024-04-09 14:28:19+00:00,['iethree'],2025-02-05 16:59:40+00:00,2025-02-05 16:59:40+00:00,https://github.com/metabase/metabase/issues/41189,"[('Administration/', ''), ('.Epic', 'Feature Implementation or Project'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2233561860,issue,closed,completed,[Epic] Suggest custom expressions,"Suggest some popular expressions when you start creating a custom expression for custom column, aggregation or filter, as well as the link to the full list.

[Product doc](https://www.notion.so/metabase/Suggest-custom-expressions-0e70c47b22ba499699d3d5699cc076cc)
[Tech doc](https://www.notion.so/metabase/Tech-Suggest-custom-expressions-fbf00fa566b1439b8871024a4e23a5f6)

## Implementation Plan

```[tasklist]
### Milestone 1
- [ ] https://github.com/metabase/metabase/issues/41198
- [ ] https://github.com/metabase/metabase/issues/41237
```
",romeovs,2024-04-09 14:20:20+00:00,['romeovs'],2024-04-17 08:40:33+00:00,2024-04-17 08:40:33+00:00,https://github.com/metabase/metabase/issues/41187,"[('.Epic', 'Feature Implementation or Project')]",[],
2233485822,issue,open,,Error during upload - prepared statement already exists,"### Describe the bug

When creating a model from an uploaded CSV a user received `ERROR: prepared statement ""S_1"" already exists`.

See: https://metaboat.slack.com/archives/C05MPF0TM3L/p1712664980135029

### To Reproduce

1. Use postgres as the upload database.
2. Upload the same file a number of times
3. See the error

### Expected behavior

Uploads should continue to succeed

### Logs

_No response_

### Information about your Metabase installation

```JSON
- Metabase version: master (~50.0)
```


### Severity

P3

### Additional context

_No response_",crisptrutski,2024-04-09 13:48:09+00:00,[],2024-05-16 20:32:20+00:00,,https://github.com/metabase/metabase/issues/41185,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Organization/Uploads', 'Direct data upload (CSV)')]","[{'comment_id': 2045358706, 'issue_id': 2233485822, 'author': 'crisptrutski', 'body': 'The issue appears to relate to the server side pooling implementation used by Supabase for ""transaction mode"" connections. These connections are designed for use with serverless applications, not a session based application like Metabase which uses its own connection pools.\r\n\r\nThe issue is also intermittent - retrying can succeed, I guess when the connection you get from Metabase\'s connection pool is not one that thinks its already run a particular statement (but Supabase was switched out the actual underlying connection in its proxy).', 'created_at': datetime.datetime(2024, 4, 9, 14, 43, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2045451513, 'issue_id': 2233485822, 'author': 'crisptrutski', 'body': ""As far as I can tell the issue only affects connection that use explicit transactions - when the transaction is closed it indicates to the Supabase proxy that it can return the underlying connection to its internal pool. Since Uploads are the only place where we use transactions, the scope should be quite narrow - especially since it's unlikely that users would need to upload the same data multiple times within a short time (the duration our pool keeps connections alive).\r\n\r\nPerhaps something like the following:\r\n\r\n> Error executing prepared statement - this may be caused by using a transaction or statement based connection pool. Make sure to use Session level pooling if this is the case.\r\n\r\nThis would give them the relevant search terms to use with Supabase, Supavisor, PgBouncer, etc. It's possible there are other proxies out there that use other terminology though."", 'created_at': datetime.datetime(2024, 4, 9, 15, 18, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2046648483, 'issue_id': 2233485822, 'author': 'calherries', 'body': 'I labelled this P3 as we discussed it should be relatively rare and has an easy workaround (use the correct mode for the connection)', 'created_at': datetime.datetime(2024, 4, 10, 6, 47, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2047105416, 'issue_id': 2233485822, 'author': 'crisptrutski', 'body': 'To help anyone finding this issue when having issues with Supabase, the solution is to change from the tx port (6543) to the session port (5432).', 'created_at': datetime.datetime(2024, 4, 10, 10, 3, 22, tzinfo=datetime.timezone.utc)}]","crisptrutski (Issue Creator) on (2024-04-09 14:43:07 UTC): The issue appears to relate to the server side pooling implementation used by Supabase for ""transaction mode"" connections. These connections are designed for use with serverless applications, not a session based application like Metabase which uses its own connection pools.

The issue is also intermittent - retrying can succeed, I guess when the connection you get from Metabase's connection pool is not one that thinks its already run a particular statement (but Supabase was switched out the actual underlying connection in its proxy).

crisptrutski (Issue Creator) on (2024-04-09 15:18:23 UTC): As far as I can tell the issue only affects connection that use explicit transactions - when the transaction is closed it indicates to the Supabase proxy that it can return the underlying connection to its internal pool. Since Uploads are the only place where we use transactions, the scope should be quite narrow - especially since it's unlikely that users would need to upload the same data multiple times within a short time (the duration our pool keeps connections alive).

Perhaps something like the following:


This would give them the relevant search terms to use with Supabase, Supavisor, PgBouncer, etc. It's possible there are other proxies out there that use other terminology though.

calherries on (2024-04-10 06:47:54 UTC): I labelled this P3 as we discussed it should be relatively rare and has an easy workaround (use the correct mode for the connection)

crisptrutski (Issue Creator) on (2024-04-10 10:03:22 UTC): To help anyone finding this issue when having issues with Supabase, the solution is to change from the tx port (6543) to the session port (5432).

"
2233382786,issue,closed,completed,Add metrics to DataStep in the notebook editor,,ranquild,2024-04-09 12:56:49+00:00,"['kamilmielnik', 'ranquild']",2024-04-19 13:55:10+00:00,2024-04-19 13:55:10+00:00,https://github.com/metabase/metabase/issues/41184,"[('.Frontend', ''), ('.Team/Querying', '')]","[{'comment_id': 2066642510, 'issue_id': 2233382786, 'author': 'kamilmielnik', 'body': 'Closed by #40442', 'created_at': datetime.datetime(2024, 4, 19, 13, 55, 10, tzinfo=datetime.timezone.utc)}]","kamilmielnik (Assginee) on (2024-04-19 13:55:10 UTC): Closed by #40442

"
2233331226,issue,closed,completed,Data Picker is too big,https://metaboat.slack.com/archives/C0645JP1W81/p1712586211035699,kamilmielnik,2024-04-09 12:28:56+00:00,['kamilmielnik'],2024-04-11 06:15:44+00:00,2024-04-11 06:15:44+00:00,https://github.com/metabase/metabase/issues/41182,"[('.Frontend', ''), ('.Team/Querying', '')]",[],
2233259101,issue,closed,completed,Text column combination modal in the notebook editor,"Implement the text column combination modal for the notebook editor.

See [Figma](https://www.figma.com/file/Rh7vrNTZX4TPAGC1fDtS55/QB-expressivity-and-column-actions%3A-extract-and-combine?type=design&mode=design&t=fkudaF5sAbXXQRif-0)

<img width=""527"" alt=""Screenshot 2024-04-12 at 11 42 07"" src=""https://github.com/metabase/metabase/assets/1250185/cf0e54b0-7884-4967-8bbe-76f26d31c8ab"">

",romeovs,2024-04-09 11:47:40+00:00,[],2024-04-26 11:22:05+00:00,2024-04-24 08:24:28+00:00,https://github.com/metabase/metabase/issues/41178,"[('.Frontend', ''), ('.Team/Querying', '')]",[],
2233256696,issue,closed,completed,[Epic] Custom column expression shortcuts,"[product doc](https://www.notion.so/metabase/Custom-expression-snippet-to-combine-columns-858e52c35829436ab9ef89bcfdd4b2c2)
[technical doc](https://www.notion.so/metabase/Tech-Combine-shortcuts-for-custom-columns-a527ffcd30314f388215a79e3b416de4)
[testing plan](https://github.com/metabase/metabase/issues/41782)

Feature branch: [`notebook-expression-shortcuts`](https://github.com/metabase/metabase/tree/notebook-expression-shortcuts)


## Implementation Plan

### Milestone 1: Combine columns

```[tasklist]
#### Backend
- [x] Add support for previewing the result of an expression on a column `Lib.previewExpression`
```

```[tasklist]
#### Frontend
- [ ] https://github.com/metabase/metabase/issues/41178
- [x] https://github.com/metabase/metabase/issues/41766
- [ ] https://github.com/metabase/metabase/issues/41350
```

### Milestone 3: Extract columns

```[tasklist]
#### Frontend
- [ ] https://github.com/metabase/metabase/issues/41504
- [ ] https://github.com/metabase/metabase/issues/42093
```



",romeovs,2024-04-09 11:46:10+00:00,['romeovs'],2024-05-03 11:41:34+00:00,2024-05-03 11:41:34+00:00,https://github.com/metabase/metabase/issues/41177,"[('.Epic', 'Feature Implementation or Project')]",[],
2233242378,issue,closed,not_planned,"(v 41) Metabase Dashboard Stuck at ""Starting Metabase...""","### Describe the bug

 Encountering an issue where the Metabase dashboard fails to initialize and remains stuck at the ""Starting Metabase..."" stage
Please check attached screenshot 
![image](https://github.com/metabase/metabase/assets/87641643/bfcd20c9-5f8a-4e88-aff9-fa57f6112468)


### To Reproduce

1. Install Pre-requisites packages ( openjdk-11-jdk,openjdk-11-jre, clojure linux-install-1.10.3.998.sh)
2. Compile metabase from source ( tag=v1.41.0)
3.  ( Build )  Installation Successful.
4. Open Metabase Page
5. Its Stuck at ""Starting Metabase..."" 

### Expected behavior

The Metabase Dashboard Page should be opened.

### Logs

```

==========
== CUDA ==
==========

CUDA Version 12.1.0

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

*************************
** DEPRECATION NOTICE! **
*************************
THIS IMAGE IS DEPRECATED and is scheduled for DELETION.
    https://gitlab.com/nvidia/container-images/cuda/blob/master/doc/support-policy.md

Mysql has initialised.
Creating LOG directory.
WARNING: sun.reflect.Reflection.getCallerClass is not supported. This will impact performance.
2024-04-09 19:37:51,342 INFO metabase.util :: Maximum memory available to JVM: 1.0 GB
2024-04-09 19:37:56,793 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓
 For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html
2024-04-09 19:37:57,928 INFO driver.impl :: Registered abstract driver :sql  🚚
 ↙ Load driver :sql took 234.2 ms
2024-04-09 19:37:57,934 INFO driver.impl :: Registered abstract driver :sql-jdbc (parents: [:sql]) 🚚
Load driver :sql-jdbc took 241.5 ms
2024-04-09 19:37:57,935 INFO driver.impl :: Registered driver :h2 (parents: [:sql-jdbc]) 🚚
2024-04-09 19:37:57,943 INFO driver.impl :: Registered driver :mysql (parents: [:sql-jdbc]) 🚚
2024-04-09 19:37:58,207 INFO driver.impl :: Registered driver :postgres (parents: [:sql-jdbc]) 🚚
2024-04-09 19:37:59,167 INFO metabase.core ::
Metabase v0.41.1-SNAPSHOT (c529fe2 ?)

Copyright © 2024 Metabase, Inc.

Metabase Enterprise Edition extensions are NOT PRESENT.
2024-04-09 19:37:59,171 WARN metabase.core :: WARNING: You have enabled namespace tracing, which could log sensitive information like db passwords.
2024-04-09 19:37:59,171 INFO metabase.core :: Starting Metabase in STANDALONE mode
2024-04-09 19:37:59,187 INFO metabase.server :: Launching Embedded Jetty Webserver with config:
 {:port 3000}

2024-04-09 19:37:59,202 INFO metabase.core :: Starting Metabase version v0.41.1-SNAPSHOT (c529fe2 ?) ...
2024-04-09 19:37:59,217 INFO metabase.core :: System info:
 {""file.encoding"" ""UTF-8"",
 ""java.runtime.name"" ""OpenJDK Runtime Environment"",
 ""java.runtime.version"" ""11.0.22+7-post-Ubuntu-0ubuntu222.04.1"",
 ""java.vendor"" ""Ubuntu"",
 ""java.vendor.url"" ""https://ubuntu.com/"",
 ""java.version"" ""11.0.22"",
 ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",
 ""java.vm.version"" ""11.0.22+7-post-Ubuntu-0ubuntu222.04.1"",
 ""os.name"" ""Linux"",
 ""os.version"" ""6.5.0-0.deb12.4-amd64"",
 ""user.language"" ""en"",
 ""user.timezone"" ""Asia/Tokyo""}

2024-04-09 19:37:59,217 INFO metabase.plugins :: Loading plugins in /root/plugins...
2024-04-09 19:37:59,367 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...
2024-04-09 19:37:59,368 INFO driver.impl :: Registered driver :mongo  🚚
2024-04-09 19:37:59,371 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...
2024-04-09 19:37:59,374 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚
2024-04-09 19:37:59,383 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...
2024-04-09 19:37:59,384 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚
2024-04-09 19:37:59,387 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...
2024-04-09 19:37:59,388 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚
2024-04-09 19:37:59,390 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...
2024-04-09 19:37:59,390 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚
2024-04-09 19:37:59,396 INFO plugins.dependencies :: Plugin 'Metabase Presto JDBC Driver' depends on plugin 'Presto Common Driver'
2024-04-09 19:37:59,397 INFO plugins.dependencies :: Metabase Presto JDBC Driver dependency {:plugin Presto Common Driver} satisfied? false
2024-04-09 19:37:59,397 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto JDBC Driver""]
2024-04-09 19:37:59,399 INFO plugins.dependencies :: Plugin 'Metabase Presto Driver' depends on plugin 'Presto Common Driver'
2024-04-09 19:37:59,399 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? false
2024-04-09 19:37:59,400 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Presto Driver"" ""Metabase Presto JDBC Driver""]
2024-04-09 19:37:59,401 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-common...
2024-04-09 19:37:59,401 INFO driver.impl :: Registered abstract driver :presto-common  🚚
2024-04-09 19:37:59,401 INFO plugins.dependencies :: Metabase Presto Driver dependency {:plugin Presto Common Driver} satisfied? true
2024-04-09 19:37:59,402 INFO plugins.dependencies :: Metabase Presto JDBC Driver dependency {:plugin Presto Common Driver} satisfied? true
2024-04-09 19:37:59,402 DEBUG plugins.initialize :: Dependencies satisfied; these plugins will now be loaded: [""Metabase Presto JDBC Driver"" ""Metabase Presto Driver""]
2024-04-09 19:37:59,402 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...
2024-04-09 19:37:59,402 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:presto-common]) 🚚
2024-04-09 19:37:59,403 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto...
2024-04-09 19:37:59,403 INFO driver.impl :: Registered driver :presto (parents: [:presto-common]) 🚚
2024-04-09 19:37:59,405 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Vertica Driver due to required dependencies. Metabase requires the Vertica JDBC driver in order to connect to Vertica databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/vertica.html for more details.

2024-04-09 19:37:59,405 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false
2024-04-09 19:37:59,405 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver""]
2024-04-09 19:37:59,407 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...
2024-04-09 19:37:59,407 INFO driver.impl :: Registered driver :druid  🚚
2024-04-09 19:37:59,408 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...
2024-04-09 19:37:59,409 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚
2024-04-09 19:37:59,411 INFO plugins.dependencies :: Metabase cannot initialize plugin Metabase Oracle Driver due to required dependencies. Metabase requires the Oracle JDBC driver in order to connect to Oracle databases, but we can't ship it as part of Metabase due to licensing restrictions. See https://metabase.com/docs/latest/administration-guide/databases/oracle.html for more details.

2024-04-09 19:37:59,411 INFO plugins.dependencies :: Metabase Oracle Driver dependency {:class oracle.jdbc.OracleDriver} satisfied? false
2024-04-09 19:37:59,411 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver"" ""Metabase Oracle Driver""]
2024-04-09 19:37:59,412 INFO plugins.dependencies :: Plugin 'Metabase BigQuery Driver' depends on plugin 'Metabase Google Drivers Shared Dependencies'
2024-04-09 19:37:59,413 INFO plugins.dependencies :: Metabase BigQuery Driver dependency {:plugin Metabase Google Drivers Shared Dependencies} satisfied? false
2024-04-09 19:37:59,413 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver"" ""Metabase BigQuery Driver"" ""Metabase Oracle Driver""]
2024-04-09 19:37:59,414 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :google...
2024-04-09 19:37:59,415 INFO driver.impl :: Registered abstract driver :google  🚚
2024-04-09 19:37:59,415 INFO plugins.dependencies :: Metabase BigQuery Driver dependency {:plugin Metabase Google Drivers Shared Dependencies} satisfied? true
2024-04-09 19:37:59,416 DEBUG plugins.initialize :: Dependencies satisfied; these plugins will now be loaded: [""Metabase BigQuery Driver""]
2024-04-09 19:37:59,416 WARN plugins.lazy-loaded-driver :: Warning: plugin manifest for :bigquery does not include connection properties
2024-04-09 19:37:59,416 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery...
2024-04-09 19:37:59,416 INFO driver.impl :: Registered driver :bigquery (parents: [:sql :google]) 🚚
2024-04-09 19:37:59,428 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...
2024-04-09 19:37:59,428 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚
2024-04-09 19:37:59,428 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...
2024-04-09 19:37:59,429 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚
2024-04-09 19:37:59,430 INFO plugins.dependencies :: Plugin 'Metabase Google Analytics Driver' depends on plugin 'Metabase Google Drivers Shared Dependencies'
2024-04-09 19:37:59,431 INFO plugins.dependencies :: Metabase Google Analytics Driver dependency {:plugin Metabase Google Drivers Shared Dependencies} satisfied? true
2024-04-09 19:37:59,431 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...
2024-04-09 19:37:59,431 INFO driver.impl :: Registered driver :googleanalytics (parents: [:google]) 🚚
2024-04-09 19:37:59,431 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
2024-04-09 19:37:59,433 INFO db.setup :: Verifying mysql Database Connection ...
2024-04-09 19:37:59,499 INFO db.setup :: Successfully verified MySQL 8.0.36-0ubuntu0.22.04.1 application database connection. ✅
2024-04-09 19:37:59,500 INFO db.setup :: Running Database Migrations...
2024-04-09 19:37:59,501 INFO db.setup :: Setting up Liquibase...
2024-04-09 19:37:59,509 INFO db.setup :: Liquibase is ready.
2024-04-09 19:37:59,509 INFO db.liquibase :: Checking if Database has unrun migrations...
2024-04-09 19:38:04,599 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,599 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,599 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,599 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,599 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,599 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,599 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,599 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,601 INFO db.liquibase :: Database has unrun migrations. Waiting for migration lock to be cleared...
2024-04-09 19:38:04,625 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,626 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,626 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,626 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,626 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,626 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,626 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,626 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,627 INFO db.liquibase :: Migration lock is cleared. Running migrations...
2024-04-09 19:38:04,784 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,784 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,784 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,784 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,784 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,785 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,785 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:38:04,785 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
2024-04-09 19:49:49,730 INFO db.setup :: Database Migrations Current ...  ✅
2024-04-09 19:49:49,738 INFO db.data-migrations :: Running all necessary data migrations, this may take a minute.
2024-04-09 19:49:49,742 INFO db.data-migrations :: Running data migration 'add-users-to-default-permissions-groups'...
2024-04-09 19:49:49,987 INFO models.permissions-group :: Created magic permissions group 'All Users' (ID = 1)
2024-04-09 19:49:50,115 INFO models.permissions-group :: Created magic permissions group 'Administrators' (ID = 2)
2024-04-09 19:49:50,255 INFO db.data-migrations :: Running data migration 'add-admin-group-root-entry'...
2024-04-09 19:49:50,349 INFO models.permissions-group :: Created magic permissions group 'MetaBot' (ID = 3)
2024-04-09 19:49:50,606 INFO db.data-migrations :: Running data migration 'add-databases-to-magic-permissions-groups'...
2024-04-09 19:49:50,765 INFO db.data-migrations :: Running data migration 'copy-site-url-setting-and-remove-trailing-slashes'...
2024-04-09 19:49:50,889 INFO db.data-migrations :: Running data migration 'ensure-protocol-specified-in-site-url'...
2024-04-09 19:49:51,015 INFO db.data-migrations :: Running data migration 'populate-card-database-id'...
2024-04-09 19:49:51,132 INFO db.data-migrations :: Running data migration 'migrate-humanization-setting'...
2024-04-09 19:49:51,297 INFO db.data-migrations :: Running data migration 'mark-category-fields-as-list'...
2024-04-09 19:49:51,482 INFO db.data-migrations :: Running data migration 'add-legacy-sql-directive-to-bigquery-sql-cards'...
2024-04-09 19:49:51,817 INFO db.data-migrations :: Running data migration 'clear-ldap-user-local-passwords'...
2024-04-09 19:49:52,017 INFO db.data-migrations :: Running data migration 'add-migrated-collections'...
2024-04-09 19:49:52,434 INFO db.data-migrations :: Running data migration 'migrate-click-through'...
2024-04-09 19:49:52,635 INFO db.data-migrations :: Finished running data migrations.
Database setup took 11.9 mins
2024-04-09 19:49:52,856 INFO metabase.events :: Starting events listener: :metabase.events.dependencies/Dependencies 👂
2024-04-09 19:49:52,858 INFO metabase.events :: Starting events listener: :metabase.events.activity-feed/ActivityFeed 👂
2024-04-09 19:49:52,858 INFO metabase.events :: Starting events listener: :metabase.events.metabot-lifecycle/MetaBotLifecycle 👂
2024-04-09 19:49:52,859 INFO metabase.events :: Starting events listener: :metabase.events.last-login/LastLogin 👂
2024-04-09 19:49:52,859 INFO metabase.events :: Starting events listener: :metabase.events.notifications/Notifications 👂
2024-04-09 19:49:52,859 INFO metabase.events :: Starting events listener: :metabase.events.sync-database/Sync 👂
2024-04-09 19:49:52,859 INFO metabase.events :: Starting events listener: :metabase.events.driver-notifications/DriverNotifications 👂
2024-04-09 19:49:52,859 INFO metabase.events :: Starting events listener: :metabase.events.revision/Revisions 👂
2024-04-09 19:49:52,860 INFO metabase.events :: Starting events listener: :metabase.events.view-log/ViewLog 👂
2024-04-09 19:49:53,037 INFO metabase.task :: Initializing task SyncDatabases 📆
2024-04-09 19:49:53,379 INFO metabase.task :: Initializing task CheckForNewVersions 📆
2024-04-09 19:49:53,554 INFO metabase.task :: Initializing task SendAnonymousUsageStats 📆
2024-04-09 19:49:53,695 INFO metabase.task :: Initializing task SendAbandomentEmails 📆
2024-04-09 19:49:53,830 INFO metabase.task :: Initializing task SendPulses 📆
2024-04-09 19:49:53,937 INFO metabase.task :: Initializing task SendFollowUpEmails 📆
2024-04-09 19:49:54,071 INFO metabase.task :: Initializing task TaskHistoryCleanup 📆
2024-04-09 19:49:54,296 INFO metabase.core :: Looks like this is a new installation ... preparing setup wizard
2024-04-09 19:49:55,081 INFO metabase.core :: Please use the following URL to setup your Metabase installation:

http://localhost:3000/setup/


2024-04-09 19:49:55,083 INFO metabase.sample-data :: Loading sample dataset...
2024-04-09 19:49:55,086 INFO driver.impl :: Initializing driver :sql...
2024-04-09 19:49:55,086 INFO driver.impl :: Initializing driver :sql-jdbc...
2024-04-09 19:49:55,086 INFO driver.impl :: Initializing driver :mysql...
2024-04-09 19:49:55,420 INFO task.sync-databases :: Scheduling sync/analyze for database 1: trigger: metabase.task.sync-and-analyze.trigger.1
2024-04-09 19:49:55,750 INFO task.sync-databases :: Scheduling field-values for database 1: trigger: metabase.task.update-field-values.trigger.1
2024-04-09 19:49:55,913 INFO sync.util :: STARTING: Sync h2 Database 1 'Sample Dataset'
2024-04-09 19:49:55,913 INFO driver.impl :: Initializing driver :h2...
2024-04-09 19:49:55,914 INFO sync.util :: STARTING: Sync metadata for h2 Database 1 'Sample Dataset'
2024-04-09 19:49:55,916 INFO sync.util :: STARTING: step 'sync-timezone' for h2 Database 1 'Sample Dataset'
2024-04-09 19:49:56,333 INFO sync.util :: FINISHED: step 'sync-timezone' for h2 Database 1 'Sample Dataset' (417.0 ms)
2024-04-09 19:49:56,334 INFO sync.util :: STARTING: step 'sync-tables' for h2 Database 1 'Sample Dataset'
2024-04-09 19:49:56,363 INFO sync-metadata.tables :: Found new tables: (Table  'PUBLIC.PRODUCTS' Table  'PUBLIC.ORDERS' Table  'PUBLIC.PEOPLE' Table  'PUBLIC.REVIEWS')
2024-04-09 19:49:56,943 INFO sync-metadata.tables :: Updating description for tables: (Table  'PUBLIC.PEOPLE' Table  'PUBLIC.REVIEWS' Table  'PUBLIC.ORDERS' Table  'PUBLIC.PRODUCTS')
2024-04-09 19:49:56,944 INFO sync.util :: FINISHED: step 'sync-tables' for h2 Database 1 'Sample Dataset' (609.5 ms)
2024-04-09 19:49:56,944 INFO sync.util :: STARTING: step 'sync-fields' for h2 Database 1 'Sample Dataset'
2024-04-09 19:50:00,490 INFO task.sync-databases :: Starting sync task for Database 1.
2024-04-09 19:50:00,492 INFO sync.util :: STARTING: Analyze data for h2 Database 1 'Sample Dataset'
2024-04-09 19:50:00,494 INFO sync.util :: STARTING: step 'fingerprint-fields' for h2 Database 1 'Sample Dataset'
2024-04-09 19:50:02,596 INFO sync.analyze :: fingerprint-fields Analyzed [*******···········································] 😞   15% Table 3 'PUBLIC.PEOPLE'
2024-04-09 19:50:03,065 INFO sync.util :: FINISHED: step 'sync-fields' for h2 Database 1 'Sample Dataset' (6.1 s)
2024-04-09 19:50:03,065 INFO sync.util :: STARTING: step 'sync-fks' for h2 Database 1 'Sample Dataset'
2024-04-09 19:50:03,075 INFO sync-metadata.fks :: Marking foreign key from Table 2 'PUBLIC.ORDERS' Field 3 'USER_ID' -> Table 3 'PUBLIC.PEOPLE' Field 22 'ID'
2024-04-09 19:50:03,263 INFO sync-metadata.fks :: Marking foreign key from Table 2 'PUBLIC.ORDERS' Field 5 'PRODUCT_ID' -> Table 1 'PUBLIC.PRODUCTS' Field 30 'ID'
2024-04-09 19:50:03,448 INFO sync-metadata.fks :: Marking foreign key from Table 4 'PUBLIC.REVIEWS' Field 33 'PRODUCT_ID' -> Table 1 'PUBLIC.PRODUCTS' Field 30 'ID'
2024-04-09 19:50:03,737 INFO sync.util :: FINISHED: step 'sync-fks' for h2 Database 1 'Sample Dataset' (671.6 ms)
2024-04-09 19:50:03,737 INFO sync.util :: STARTING: step 'sync-metabase-metadata' for h2 Database 1 'Sample Dataset'
2024-04-09 19:50:06,945 INFO sync.analyze :: fingerprint-fields Analyzed [***************···································] 😕   31% Table 4 'PUBLIC.REVIEWS'
2024-04-09 19:50:08,229 INFO sync.util :: FINISHED: step 'fingerprint-fields' for h2 Database 1 'Sample Dataset' (7.7 s)
2024-04-09 19:50:08,230 INFO sync.util :: STARTING: step 'classify-fields' for h2 Database 1 'Sample Dataset'
2024-04-09 19:50:11,037 INFO sync.analyze :: classify-fields Analyzed [***********************···························] 😬   46% Table 3 'PUBLIC.PEOPLE'
2024-04-09 19:50:14,113 INFO sync.analyze :: classify-fields Analyzed [******************************····················] 😌   62% Table 4 'PUBLIC.REVIEWS'
2024-04-09 19:50:14,113 INFO sync.util :: FINISHED: step 'classify-fields' for h2 Database 1 'Sample Dataset' (5.9 s)
2024-04-09 19:50:14,113 INFO sync.util :: STARTING: step 'classify-tables' for h2 Database 1 'Sample Dataset'
2024-04-09 19:50:14,259 INFO sync.util :: FINISHED: step 'sync-metabase-metadata' for h2 Database 1 'Sample Dataset' (10.5 s)
2024-04-09 19:50:14,608 INFO sync.analyze :: classify-tables Analyzed [**************************************············] 😋   77% Table 3 'PUBLIC.PEOPLE'
2024-04-09 19:50:15,234 INFO sync.analyze :: classify-tables Analyzed [**********************************************····] 😍   92% Table 4 'PUBLIC.REVIEWS'
2024-04-09 19:50:15,234 INFO sync.util :: FINISHED: step 'classify-tables' for h2 Database 1 'Sample Dataset' (1.1 s)
2024-04-09 19:50:15,882 INFO sync.util :: FINISHED: Sync metadata for h2 Database 1 'Sample Dataset' (20.0 s)
2024-04-09 19:50:15,885 INFO sync.util :: STARTING: Cache field values in h2 Database 1 'Sample Dataset'
2024-04-09 19:50:15,885 INFO sync.util :: STARTING: step 'update-field-values' for h2 Database 1 'Sample Dataset'
2024-04-09 19:50:16,429 INFO sync.util :: FINISHED: Analyze data for h2 Database 1 'Sample Dataset' (15.9 s)
2024-04-09 19:50:17,329 INFO sync.util :: FINISHED: step 'update-field-values' for h2 Database 1 'Sample Dataset' (1.4 s)
2024-04-09 19:50:17,728 INFO sync.util :: FINISHED: Cache field values in h2 Database 1 'Sample Dataset' (1.8 s)
2024-04-09 19:50:17,728 INFO sync.util :: FINISHED: Sync h2 Database 1 'Sample Dataset' (21.8 s)
2024-04-09 19:50:17,736 main ERROR An exception occurred processing Appender metabase-appender java.lang.IllegalArgumentException: No implementation of method: :explain of protocol: #'schema.core/Schema found for class: clojure.lang.Var$Unbound
        at clojure.core$_cache_protocol_fn.invokeStatic(core_deftype.clj:583)
        at clojure.core$_cache_protocol_fn.invoke(core_deftype.clj:575)
        at schema.core$fn__2717$G__2712__2722.invoke(core.clj:110)
        at schema.core$explain_input_schema$fn__3740.invoke(core.clj:1050)
        at clojure.core$map$fn__5884.invoke(core.clj:2759)
        at clojure.lang.LazySeq.sval(LazySeq.java:42)
        at clojure.lang.LazySeq.seq(LazySeq.java:51)
        at clojure.lang.RT.seq(RT.java:535)
        at clojure.core$seq__5419.invokeStatic(core.clj:139)
        at clojure.core$concat$fn__5510.invoke(core.clj:727)
        at clojure.lang.LazySeq.sval(LazySeq.java:42)
        at clojure.lang.LazySeq.seq(LazySeq.java:51)
        at clojure.lang.Cons.next(Cons.java:39)
        at clojure.lang.RT.next(RT.java:713)
        at clojure.core$next__5403.invokeStatic(core.clj:64)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:64)
        at clojure.core$fn__7329.invokeStatic(core_print.clj:174)
        at clojure.core$fn__7329.invoke(core_print.clj:174)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$fn__7329.invokeStatic(core_print.clj:174)
        at clojure.core$fn__7329.invoke(core_print.clj:174)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at schema.core$fn__2739.invokeStatic(core.clj:124)
        at schema.core$fn__2739.invoke(core.clj:123)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_prefix_map$fn__7352.invoke(core_print.clj:233)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$print_prefix_map.invokeStatic(core_print.clj:229)
        at clojure.core$print_map.invokeStatic(core_print.clj:238)
        at clojure.core$fn__7381.invokeStatic(core_print.clj:266)
        at clojure.core$fn__7381.invoke(core_print.clj:263)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_prefix_map$fn__7352.invoke(core_print.clj:233)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$print_prefix_map.invokeStatic(core_print.clj:229)
        at clojure.core$print_map.invokeStatic(core_print.clj:238)
        at clojure.core$fn__7402.invokeStatic(core_print.clj:320)
        at clojure.core$fn__7402.invoke(core_print.clj:317)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$fn__7349.invokeStatic(core_print.clj:225)
        at clojure.core$fn__7349.invoke(core_print.clj:225)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$fn__7349.invokeStatic(core_print.clj:225)
        at clojure.core$fn__7349.invoke(core_print.clj:225)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_prefix_map$fn__7352.invoke(core_print.clj:233)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$print_prefix_map.invokeStatic(core_print.clj:229)
        at clojure.core$print_map.invokeStatic(core_print.clj:238)
        at clojure.core$fn__7381.invokeStatic(core_print.clj:266)
        at clojure.core$fn__7381.invoke(core_print.clj:263)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$fn__7349.invokeStatic(core_print.clj:225)
        at clojure.core$fn__7349.invoke(core_print.clj:225)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_prefix_map$fn__7352.invoke(core_print.clj:233)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$print_prefix_map.invokeStatic(core_print.clj:229)
        at clojure.core$print_map.invokeStatic(core_print.clj:238)
        at clojure.core$fn__7381.invokeStatic(core_print.clj:266)
        at clojure.core$fn__7381.invoke(core_print.clj:263)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.lang.Var.invoke(Var.java:388)
        at clojure.lang.RT.print(RT.java:1885)
        at clojure.lang.RT.printString(RT.java:1865)
        at clojure.lang.APersistentMap.toString(APersistentMap.java:21)
        at clojure.lang.ExceptionInfo.toString(ExceptionInfo.java:40)
        at java.base/java.lang.String.valueOf(String.java:2951)
        at java.base/java.io.PrintWriter.println(PrintWriter.java:837)
        at java.base/java.lang.Throwable$WrappedPrintWriter.println(Throwable.java:768)
        at java.base/java.lang.Throwable.printStackTrace(Throwable.java:659)
        at java.base/java.lang.Throwable.printStackTrace(Throwable.java:725)
        at org.apache.commons.lang3.exception.ExceptionUtils.getStackTrace(ExceptionUtils.java:369)
        at org.apache.commons.lang3.exception.ExceptionUtils.getStackFrames(ExceptionUtils.java:350)
        at metabase.logger$event__GT_log_data.invokeStatic(logger.clj:27)
        at metabase.logger$event__GT_log_data.invoke(logger.clj:20)
        at metabase.logger$metabase_appender$fn__67605.invoke(logger.clj:37)
        at metabase.logger.proxy$org.apache.logging.log4j.core.appender.AbstractAppender$ff19274a.append(Unknown Source)
        at org.apache.logging.log4j.core.config.AppenderControl.tryCallAppender(AppenderControl.java:156)
        at org.apache.logging.log4j.core.config.AppenderControl.callAppender0(AppenderControl.java:129)
        at org.apache.logging.log4j.core.config.AppenderControl.callAppenderPreventRecursion(AppenderControl.java:120)
        at org.apache.logging.log4j.core.config.AppenderControl.callAppender(AppenderControl.java:84)
        at org.apache.logging.log4j.core.config.LoggerConfig.callAppenders(LoggerConfig.java:540)
        at org.apache.logging.log4j.core.config.LoggerConfig.processLogEvent(LoggerConfig.java:498)
        at org.apache.logging.log4j.core.config.LoggerConfig.log(LoggerConfig.java:481)
        at org.apache.logging.log4j.core.config.LoggerConfig.log(LoggerConfig.java:456)
        at org.apache.logging.log4j.core.config.AwaitCompletionReliabilityStrategy.log(AwaitCompletionReliabilityStrategy.java:82)
        at org.apache.logging.log4j.core.Logger.log(Logger.java:161)
        at org.apache.logging.log4j.spi.AbstractLogger.tryLogMessage(AbstractLogger.java:2205)
        at org.apache.logging.log4j.spi.AbstractLogger.logMessageTrackRecursion(AbstractLogger.java:2159)
        at org.apache.logging.log4j.spi.AbstractLogger.logMessageSafely(AbstractLogger.java:2142)
        at org.apache.logging.log4j.spi.AbstractLogger.logMessage(AbstractLogger.java:2017)
        at org.apache.logging.log4j.spi.AbstractLogger.logIfEnabled(AbstractLogger.java:1983)
        at org.apache.logging.slf4j.Log4jLogger.error(Log4jLogger.java:319)
        at clojure.tools.logging$eval136$fn__141.invoke(NO_SOURCE_FILE:0)
        at clojure.tools.logging.impl$fn__166$G__148__177.invoke(impl.clj:16)
        at clojure.tools.logging$log_STAR_.invokeStatic(logging.clj:63)
        at clojure.tools.logging$log_STAR_.invoke(logging.clj:42)
        at metabase.sample_data$add_sample_dataset_BANG_.invokeStatic(sample_data.clj:36)
        at metabase.sample_data$add_sample_dataset_BANG_.invoke(sample_data.clj:24)
        at metabase.core$init_BANG_.invokeStatic(core.clj:117)
        at metabase.core$init_BANG_.invoke(core.clj:74)
        at metabase.core$start_normally.invokeStatic(core.clj:135)
        at metabase.core$start_normally.invoke(core.clj:129)
        at metabase.core$_main.invokeStatic(core.clj:168)
        at metabase.core$_main.doInvoke(core.clj:162)
        at clojure.lang.RestFn.invoke(RestFn.java:397)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at metabase.core.main(Unknown Source)

2024-04-09 19:50:17,737 ERROR metabase.core :: Metabase Initialization FAILED
org.apache.logging.log4j.core.appender.AppenderLoggingException: An exception occurred processing Appender metabase-appender
        at org.apache.logging.log4j.core.appender.DefaultErrorHandler.error(DefaultErrorHandler.java:93)
        at org.apache.logging.log4j.core.config.AppenderControl.handleAppenderError(AppenderControl.java:165)
        at org.apache.logging.log4j.core.config.AppenderControl.tryCallAppender(AppenderControl.java:158)
        at org.apache.logging.log4j.core.config.AppenderControl.callAppender0(AppenderControl.java:129)
        at org.apache.logging.log4j.core.config.AppenderControl.callAppenderPreventRecursion(AppenderControl.java:120)
        at org.apache.logging.log4j.core.config.AppenderControl.callAppender(AppenderControl.java:84)
        at org.apache.logging.log4j.core.config.LoggerConfig.callAppenders(LoggerConfig.java:540)
        at org.apache.logging.log4j.core.config.LoggerConfig.processLogEvent(LoggerConfig.java:498)
        at org.apache.logging.log4j.core.config.LoggerConfig.log(LoggerConfig.java:481)
        at org.apache.logging.log4j.core.config.LoggerConfig.log(LoggerConfig.java:456)
        at org.apache.logging.log4j.core.config.AwaitCompletionReliabilityStrategy.log(AwaitCompletionReliabilityStrategy.java:82)
        at org.apache.logging.log4j.core.Logger.log(Logger.java:161)
        at org.apache.logging.log4j.spi.AbstractLogger.tryLogMessage(AbstractLogger.java:2205)
        at org.apache.logging.log4j.spi.AbstractLogger.logMessageTrackRecursion(AbstractLogger.java:2159)
        at org.apache.logging.log4j.spi.AbstractLogger.logMessageSafely(AbstractLogger.java:2142)
        at org.apache.logging.log4j.spi.AbstractLogger.logMessage(AbstractLogger.java:2017)
        at org.apache.logging.log4j.spi.AbstractLogger.logIfEnabled(AbstractLogger.java:1983)
        at org.apache.logging.slf4j.Log4jLogger.error(Log4jLogger.java:319)
        at clojure.tools.logging$eval136$fn__141.invoke(NO_SOURCE_FILE:0)
        at clojure.tools.logging.impl$fn__166$G__148__177.invoke(impl.clj:16)
        at clojure.tools.logging$log_STAR_.invokeStatic(logging.clj:63)
        at clojure.tools.logging$log_STAR_.invoke(logging.clj:42)
        at metabase.sample_data$add_sample_dataset_BANG_.invokeStatic(sample_data.clj:36)
        at metabase.sample_data$add_sample_dataset_BANG_.invoke(sample_data.clj:24)
        at metabase.core$init_BANG_.invokeStatic(core.clj:117)
        at metabase.core$init_BANG_.invoke(core.clj:74)
        at metabase.core$start_normally.invokeStatic(core.clj:135)
        at metabase.core$start_normally.invoke(core.clj:129)
        at metabase.core$_main.invokeStatic(core.clj:168)
        at metabase.core$_main.doInvoke(core.clj:162)
        at clojure.lang.RestFn.invoke(RestFn.java:397)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:132)
        at metabase.core.main(Unknown Source)
Caused by: java.lang.IllegalArgumentException: No implementation of method: :explain of protocol: #'schema.core/Schema found for class: clojure.lang.Var$Unbound
        at clojure.core$_cache_protocol_fn.invokeStatic(core_deftype.clj:583)
        at clojure.core$_cache_protocol_fn.invoke(core_deftype.clj:575)
        at schema.core$fn__2717$G__2712__2722.invoke(core.clj:110)
        at schema.core$explain_input_schema$fn__3740.invoke(core.clj:1050)
        at clojure.core$map$fn__5884.invoke(core.clj:2759)
        at clojure.lang.LazySeq.sval(LazySeq.java:42)
        at clojure.lang.LazySeq.seq(LazySeq.java:51)
        at clojure.lang.RT.seq(RT.java:535)
        at clojure.core$seq__5419.invokeStatic(core.clj:139)
        at clojure.core$concat$fn__5510.invoke(core.clj:727)
        at clojure.lang.LazySeq.sval(LazySeq.java:42)
        at clojure.lang.LazySeq.seq(LazySeq.java:51)
        at clojure.lang.Cons.next(Cons.java:39)
        at clojure.lang.RT.next(RT.java:713)
        at clojure.core$next__5403.invokeStatic(core.clj:64)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:64)
        at clojure.core$fn__7329.invokeStatic(core_print.clj:174)
        at clojure.core$fn__7329.invoke(core_print.clj:174)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$fn__7329.invokeStatic(core_print.clj:174)
        at clojure.core$fn__7329.invoke(core_print.clj:174)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at schema.core$fn__2739.invokeStatic(core.clj:124)
        at schema.core$fn__2739.invoke(core.clj:123)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_prefix_map$fn__7352.invoke(core_print.clj:233)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$print_prefix_map.invokeStatic(core_print.clj:229)
        at clojure.core$print_map.invokeStatic(core_print.clj:238)
        at clojure.core$fn__7381.invokeStatic(core_print.clj:266)
        at clojure.core$fn__7381.invoke(core_print.clj:263)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_prefix_map$fn__7352.invoke(core_print.clj:233)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$print_prefix_map.invokeStatic(core_print.clj:229)
        at clojure.core$print_map.invokeStatic(core_print.clj:238)
        at clojure.core$fn__7402.invokeStatic(core_print.clj:320)
        at clojure.core$fn__7402.invoke(core_print.clj:317)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$fn__7349.invokeStatic(core_print.clj:225)
        at clojure.core$fn__7349.invoke(core_print.clj:225)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$fn__7349.invokeStatic(core_print.clj:225)
        at clojure.core$fn__7349.invoke(core_print.clj:225)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_prefix_map$fn__7352.invoke(core_print.clj:233)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$print_prefix_map.invokeStatic(core_print.clj:229)
        at clojure.core$print_map.invokeStatic(core_print.clj:238)
        at clojure.core$fn__7381.invokeStatic(core_print.clj:266)
        at clojure.core$fn__7381.invoke(core_print.clj:263)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$fn__7349.invokeStatic(core_print.clj:225)
        at clojure.core$fn__7349.invoke(core_print.clj:225)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.core$print_prefix_map$fn__7352.invoke(core_print.clj:233)
        at clojure.core$print_sequential.invokeStatic(core_print.clj:66)
        at clojure.core$print_prefix_map.invokeStatic(core_print.clj:229)
        at clojure.core$print_map.invokeStatic(core_print.clj:238)
        at clojure.core$fn__7381.invokeStatic(core_print.clj:266)
        at clojure.core$fn__7381.invoke(core_print.clj:263)
        at clojure.lang.MultiFn.invoke(MultiFn.java:234)
        at clojure.core$pr_on.invokeStatic(core.clj:3662)
        at clojure.core$pr_on.invoke(core.clj:3656)
        at clojure.lang.Var.invoke(Var.java:388)
        at clojure.lang.RT.print(RT.java:1885)
        at clojure.lang.RT.printString(RT.java:1865)
        at clojure.lang.APersistentMap.toString(APersistentMap.java:21)
        at clojure.lang.ExceptionInfo.toString(ExceptionInfo.java:40)
        at java.base/java.lang.String.valueOf(String.java:2951)
        at java.base/java.io.PrintWriter.println(PrintWriter.java:837)
        at java.base/java.lang.Throwable$WrappedPrintWriter.println(Throwable.java:768)
        at java.base/java.lang.Throwable.printStackTrace(Throwable.java:659)
        at java.base/java.lang.Throwable.printStackTrace(Throwable.java:725)
        at org.apache.commons.lang3.exception.ExceptionUtils.getStackTrace(ExceptionUtils.java:369)
        at org.apache.commons.lang3.exception.ExceptionUtils.getStackFrames(ExceptionUtils.java:350)
        at metabase.logger$event__GT_log_data.invokeStatic(logger.clj:27)
        at metabase.logger$event__GT_log_data.invoke(logger.clj:20)
        at metabase.logger$metabase_appender$fn__67605.invoke(logger.clj:37)
        at metabase.logger.proxy$org.apache.logging.log4j.core.appender.AbstractAppender$ff19274a.append(Unknown Source)
        at org.apache.logging.log4j.core.config.AppenderControl.tryCallAppender(AppenderControl.java:156)
        ... 31 more
2024-04-09 19:50:17,740 INFO metabase.core :: Metabase Shutting Down ...
2024-04-09 19:50:17,741 INFO metabase.server :: Shutting Down Embedded Jetty Webserver
2024-04-09 19:50:17,744 INFO metabase.core :: Metabase Shutdown COMPLETE

```

### Information about your Metabase installation

```JSON
Operating System:
  Ubuntu 22.04
Kernel
  6.5.0-0.deb12.4-amd64
Data Base:
  MYSQL 8.0.36-0ubuntu0.22.04.1
Meta Base Version :
  1.41.0
Meta Base Hosting Environment
  Build from source code.
```


### Severity

default

### Additional context

_No response_",fti-sfuke,2024-04-09 11:37:23+00:00,[],2024-04-16 10:48:13+00:00,2024-04-10 14:42:48+00:00,https://github.com/metabase/metabase/issues/41176,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2044894291, 'issue_id': 2233242378, 'author': 'perivamsi', 'body': 'Metabase 41.0 is an old release that is not actively supported. Could you upgrade to the [latest version](https://github.com/metabase/metabase/releases/)?', 'created_at': datetime.datetime(2024, 4, 9, 11, 43, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2047748879, 'issue_id': 2233242378, 'author': 'ignacio-mb', 'body': 'Closing as this is an unsupported version', 'created_at': datetime.datetime(2024, 4, 10, 14, 42, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2049484769, 'issue_id': 2233242378, 'author': 'fti-sfuke', 'body': '@perivamsi \r\n> Metabase 41.0 is an old release that is not actively supported. Could you upgrade to the [latest version](https://github.com/metabase/metabase/releases/)?\r\n\r\nI have updated metabase version to latest one [ [v1.49.4](https://github.com/metabase/metabase/releases/tag/v1.49.4) ]\r\nTo Fix build issue we also upgraded NodeJS 20.12.2\r\n\r\n**I encountered an issue where the metabase initialization failed and the metabase was shut down multiple times.\r\nMetabase Dashboard will take almost 15 minutes to open because Metabase Initiation failed initially multiple times, but after successful initialization, it works fine. The Metabase Dashboard will open and also work fine**.\xa0\r\n\r\n\r\n**But the main concern is why Metabase initialization failed initially on the NVIDIA CUDA Container Environment. ?\r\nIt\'s working fine with the same version in the Intel Vaapi environment.**\r\n\r\n**Metabase Dashboard will take almost 15 minutes to open because Metabase Initiation failed initially multiple times:\xa0\r\nIt stuck on the below screenshot until Metabase Initiation was not successful.**\r\n\r\n![image](https://github.com/metabase/metabase/assets/87641643/77218c58-317c-4c41-bc23-cf327cfba6b8)\r\n\r\n\r\nI have found the following errors in the logs. By checking this, it looks like there is an issue with MySQL connectivity initially.\r\n```\r\n INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\n INFO db.setup :: Verifying mysql Database Connection ...\r\n ERROR metabase.core :: Metabase Initialization FAILED\r\n 2024-04-09T19:35:30.565491+09:00 <info> scorer-metabase-metabase1[1480]: clojure.lang.ExceptionInfo: Unable to connect \r\n to Metabase mysql DB. {}\r\n at metabase.db.setup$fn__33711$verify_db_connection__33716$fn__33717$fn__33718.invoke(setup.clj:102)\r\n Caused by: java.sql.SQLNonTransientConnectionException: Could not connect to address=(host=metabase1-rdb1.ctr) \r\n (port=3306)(type=master) : Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection \r\n refused)\r\n at org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory.createException(ExceptionFactory.java:73)Caused by: \r\n  java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection \r\n  refused (Connection refused)\r\n  Caused by: java.net.ConnectException: Connection refused (Connection refused)\r\n  INFO metabase.core :: Metabase Shutting Down ...\r\n  INFO metabase.server :: Shutting Down Embedded Jetty Webserver\r\n  INFO metabase.core :: Metabase Shutdown COMPLETE\r\n```\r\n\r\nIn 2nd attempt Starting Metabase in STANDALONE mode and here is the logs\r\n```\r\n INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\n INFO db.setup :: Verifying mysql Database Connection ...\r\n INFO db.setup :: Successfully verified MySQL 8.0.36-0ubuntu0.22.04.1 application database connection. ✅\r\n INFO db.setup :: Running Database Migrations...\r\n INFO db.setup :: Setting up Liquibase...\r\n INFO db.setup :: Liquibase is ready.\r\n INFO db.liquibase :: Checking if Database has unrun migrations...\r\n WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case\r\nINFO sync.util :: FINISHED: Sync h2 Database 1 \'Sample Dataset\' (21.8 s)\r\nmain ERROR An exception occurred processing Appender metabase-appender java.lang.IllegalArgumentException: No implementation of method: :explain of protocol: #\'schema.core/Schema found for class: clojure.lang.Var$Unbound\r\nat clojure.core$_cache_protocol_fn.invokeStatic(core_deftype.clj:583)\r\nat clojure.core$_cache_protocol_fn.invoke(core_deftype.clj:575)\r\nERROR metabase.core :: Metabase Initialization FAILED\r\norg.apache.logging.log4j.core.appender.AppenderLoggingException: An exception occurred processing Appender metabase-appender at org.apache.logging.log4j.core.appender.DefaultErrorHandler.error(DefaultErrorHandler.java:93)\r\nCaused by: java.lang.IllegalArgumentException: No implementation of method: :explain of protocol: #\'schema.core/Schema found for class: clojure.lang.Var$Unbound\r\n\r\nINFO metabase.core :: Metabase Shutting Down ...\r\nINFO metabase.server :: Shutting Down Embedded Jetty Webserver\r\nINFO metabase.core :: Metabase Shutdown COMPLETE\r\n\r\n```\r\n\r\nIn 3rd attempt Starting Metabase in STANDALONE mode and here is the logs\r\n```\r\nINFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\nINFO db.setup :: Verifying mysql Database Connection ...\r\nERROR metabase.core :: Metabase Initialization FAILED\r\nclojure.lang.ExceptionInfo: Unable to connect to Metabase mysql DB. {} \r\nat metabase.db.setup$fn__34071$verify_db_connection__34076$fn__34077$fn__34078.invoke(setup.clj:102)\r\nat metabase.db.setup$fn__34071$verify_db_connection__34076$fn__34077.invoke(setup.clj:100)\r\nCaused by: java.sql.SQLNonTransientConnectionException: Could not connect to address=(host=metabase1-rdb1.ctr)(port=3306)(type=master) : Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)\r\nCaused by: java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)\r\nCaused by: java.net.ConnectException: Connection refused (Connection refused)\r\nINFO metabase.core :: Metabase Shutting Down ...\r\nINFO metabase.server :: Shutting Down Embedded Jetty Webserver\r\nINFO metabase.core :: Metabase Shutdown COMPLETE\r\n```\r\n\r\nIn 4th attempt Starting Metabase in STANDALONE mode and here is the logs\r\n```\r\nINFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\nINFO db.setup :: Verifying mysql Database Connection ...\r\nERROR metabase.core :: Metabase Initialization FAILED\r\nclojure.lang.ExceptionInfo: Unable to connect to Metabase mysql DB. {}\r\nat metabase.db.setup$fn__34071$verify_db_connection__34076$fn__34077$fn__34078.invoke(setup.clj:102)\r\nCaused by: java.sql.SQLNonTransientConnectionException: Could not connect to address=(host=metabase1-rdb1.ctr)(port=3306)(type=master) : Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)\r\nCaused by: java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)\r\nCaused by: java.net.ConnectException: Connection refused (Connection refused)\r\nINFO metabase.core :: Metabase Shutting Down ...\r\nINFO metabase.server :: Shutting Down Embedded Jetty Webserver\r\nINFO metabase.core :: Metabase Shutdown COMPLETE\r\n```\r\n\r\nIn 5th attempt Starting Metabase in STANDALONE mode and here is the logs\r\n```\r\nINFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\nINFO db.setup :: Verifying mysql Database Connection ...\r\nINFO db.setup :: Successfully verified MySQL 8.0.36-0ubuntu0.22.04.1 application database connection. ✅\r\nINFO db.setup :: Running Database Migrations...\r\nINFO db.setup :: Setting up Liquibase...\r\nINFO db.setup :: Liquibase is ready.\r\nINFO db.liquibase :: Checking if Database has unrun migrations...\r\nWARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case\r\nINFO sync.util :: FINISHED: Analyze data for h2 Database 1 \'Sample Database\' (1.4 s)\r\nINFO task.send-pulses :: Sending scheduled pulses...\r\nINFO metabase.core :: Metabase Shutting Down ...\r\nINFO metabase.server :: Shutting Down Embedded Jetty Webserver\r\nINFO metabase.core :: Metabase Shutdown COMPLETE\r\n```\r\n\r\nIn 5th attempts Starting Metabase in STANDALONE mode and here is the logs\r\n```\r\nINFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...\r\nINFO db.setup :: Verifying mysql Database Connection ...\r\nERROR metabase.core :: Metabase Initialization FAILED\r\nclojure.lang.ExceptionInfo: Unable to connect to Metabase mysql DB. {}\r\nCaused by: java.sql.SQLException: Connections could not be acquired from the underlying database!\r\nCaused by: com.mchange.v2.resourcepool.CannotAcquireResourceException: A ResourcePool could not acquire a resource from its primary factory or source.\r\nCaused by: java.sql.SQLNonTransientConnectionException: Could not connect to address=(host=metabase1-rdb1.ctr)(port=3306)(type=master) : Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)\r\nCaused by: java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)\r\nCaused by: java.net.ConnectException: Connection refused (Connection refused)\r\nINFO metabase.core :: Metabase Shutting Down ...\r\nINFO metabase.server :: Shutting Down Embedded Jetty Webserver\r\nINFO metabase.core :: Metabase Shutdown COMPLETE\r\n```\r\n\r\n\r\nIn 6th attempts Starting Metabase in STANDALONE mode and here is the logs\r\n```\r\n4 INFO db.setup :: Successfully verified MySQL 8.0.36-0ubuntu0.22.04.1 application database connection. ✅\r\nINFO db.setup :: Checking if a database downgrade is required...\r\nINFO db.setup :: Running Database Migrations...\r\nINFO db.setup :: Setting up Liquibase...\r\nINFO db.setup :: Liquibase is ready.\r\nINFO db.liquibase :: Checking if Database has unrun migrations...\r\nINFO db.liquibase :: Database has unrun migrations. Checking if migraton lock is taken...\r\nINFO db.liquibase :: No migration lock found.\r\nINFO db.liquibase :: Running 277 migrations ...\r\nINFO impl.StdSchedulerFactory :: Using default implementation for ThreadExecutor\r\nINFO core.SchedulerSignalerImpl :: Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl\r\nINFO core.QuartzScheduler :: Quartz Scheduler v.2.3.2 created.\r\nINFO jdbcjobstore.JobStoreTX :: Using db table-based data access locking (synchronization).\r\nINFO jdbcjobstore.JobStoreTX :: JobStoreTX initialized.\r\nINFO core.QuartzScheduler :: Scheduler meta-data: Quartz Scheduler (v2.3.2) \'MetabaseScheduler\' with instanceId \'32c4e4be24631712821773808\'\r\nScheduler class: \'org.quartz.core.QuartzScheduler\' - running locally.\r\nNOT STARTED.\r\nCurrently in standby mode.\r\nNumber of jobs executed: 0\r\nUsing thread pool \'org.quartz.simpl.SimpleThreadPool\' - with 10 threads.\r\nUsing job-store \'org.quartz.impl.jdbcjobstore.JobStoreTX\' - which supports persistence. and is clustered.\r\nINFO impl.StdSchedulerFactory :: Quartz scheduler \'MetabaseScheduler\' initialized from default resource file in Quartz package: \'quartz.properties\'\r\nINFO impl.StdSchedulerFactory :: Quartz scheduler version: 2.3.2\r\nINFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 started.\r\nINFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 shutting down.\r\nINFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 paused.\r\nINFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 shutdown complete.\r\nINFO db.custom-migrations :: No forward migration for DowngradeDashboardTab\r\nINFO impl.StdSchedulerFactory :: Using default implementation for ThreadExecutor\r\nINFO core.SchedulerSignalerImpl :: Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl\r\nINFO core.QuartzScheduler :: Quartz Scheduler v.2.3.2 created.\r\nINFO jdbcjobstore.JobStoreTX :: Using db table-based data access locking (synchronization).\r\nINFO jdbcjobstore.JobStoreTX :: JobStoreTX initialized.\r\nINFO core.QuartzScheduler :: Scheduler meta-data: Quartz Scheduler (v2.3.2) \'MetabaseScheduler\' with instanceId \'32c4e4be24631712822164665\'\r\nScheduler class: \'org.quartz.core.QuartzScheduler\' - running locally.\r\nNOT STARTED.\r\nCurrently in standby mode.\r\nNumber of jobs executed: 0\r\nUsing thread pool \'org.quartz.simpl.SimpleThreadPool\' - with 10 threads.\r\nUsing job-store \'org.quartz.impl.jdbcjobstore.JobStoreTX\' - which supports persistence. and is clustered.\r\nINFO impl.StdSchedulerFactory :: Quartz scheduler \'MetabaseScheduler\' initialized from default resource file in Quartz package: \'quartz.properties\'\r\nINFO impl.StdSchedulerFactory :: Quartz scheduler version: 2.3.2\r\nINFO jdbcjobstore.JobStoreTX :: ClusterManager: detected 1 failed or restarted instances.\r\nINFO jdbcjobstore.JobStoreTX :: ClusterManager: Scanning for instance ""32c4e4be24631712821773808""\'s failed in-progress jobs.\r\nINFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 started.\r\nINFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 shutting down.\r\nINFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 paused.\r\nINFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 shutdown complete.\r\nUPDATE SUMMARY\r\n Run:                        277\r\n Previously run:               0\r\nFiltered out:                 5\r\n -------------------------------\r\nTotal change sets:          282\r\nINFO db.liquibase :: Migration complete in 11.6 mins\r\nINFO db.setup :: Database Migrations Current ...  ✅\r\nINFO metabase.util :: Database setup took 11.8 mins\r\nINFO metabase.core :: Looks like this is a new installation ... preparing setup wizard\r\nINFO metabase.core :: Please use the following URL to setup your Metabase installation:\r\n2024-04-11T16:56:05.792597+09:00 <info> scorer-metabase-metabase1[1399]: http://localhost:3000/setup/\r\nINFO metabase.events :: Loading events namespace: metabase.events.audit-log 👂\r\nINFO sync.util :: FINISHED: step \'\'sync-dbms-version\'\' for h2 Database 1 \'\'Sample Database\'\' (186.8 ms)\r\nINFO sync.util :: STARTING: step \'\'sync-timezone\'\' for h2 Database 1 \'\'Sample Database\'\'\r\nINFO sync-metadata.sync-timezone :: :h2 database 1 default timezone is ""Asia/Tokyo""\r\nINFO sync.util :: FINISHED: step \'\'sync-timezone\'\' for h2 Database 1 \'\'Sample Database\'\' (191.7 ms)\r\nINFO sync.util :: STARTING: step \'\'sync-tables\'\' for h2 Database 1 \'\'Sample Database\'\'\r\nINFO sync-metadata.tables :: Found new tables: (Table  \'\'PUBLIC.ANALYTIC_EVENTS\'\' Table  \'\'PUBLIC.FEEDBACK\'\' Table  \'\'PUBLIC.PEOPLE\'\' Table  \'\'PUBLIC.REVIEWS\'\' Table  \'\'PUBLIC.ORDERS\'\' Table  \'\'PUBLIC.ACCOUNTS\'\' Table  \'\'PUBLIC.INVOICES\'\' Table  \'\'PUBLIC.PRODUCTS\'\')\r\nINFO sync-metadata.tables :: Updating table metadata for Table 8 \'\'PUBLIC.PRODUCTS\'\'\r\nINFO sync-metadata.tables :: Updating table metadata for Table 3 \'\'PUBLIC.PEOPLE\'\'\r\nINFO sync-metadata.tables :: Updating table metadata for Table 7 \'\'PUBLIC.INVOICES\'\'\r\nINFO sync-metadata.tables :: Updating table metadata for Table 5 \'\'PUBLIC.ORDERS\'\'\r\nINFO sync-metadata.tables :: Updating table metadata for Table 4 \'\'PUBLIC.REVIEWS\'\'\r\nINFO sync.analyze :: fingerprint-fields Analyzed [*****·············································] 😢   12% Table 2 \'\'PUBLIC.FEEDBACK\'\'\r\nclassify-fields Analyzed [******************································] 😕   36% Table 6 \'\'PUBLIC.ACCOUNTS\'\'\r\nclassify-tables Analyzed [************************************··············] 😋   72% Table 1 \'\'PUBLIC.ANALYTIC_EVENTS\'\'\r\nINFO sync.analyze :: classify-tables Analyzed [***********************************************···] 😎   96% Table 4 \'\'PUBLIC.REVIEWS\'\'\r\nINFO sync.util :: FINISHED: step \'\'classify-tables\'\' for h2 Database 1 \'\'Sample Database\'\' (2.0 s)\r\n2024-04-11T16:56:53.145817+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:53,144 INFO sync.util :: FINISHED: Analyze data for h2 Database 1 \'\'Sample Database\'\' (25.9 s)\r\n2024-04-11T17:12:22.592232+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:12:22,591 DEBUG middleware.log :: GET /api/user/current 401 847.3 µs (0 DB calls)\r\n2024-04-11T17:12:22.592315+09:00 <info> scorer-metabase-metabase1[1399]: ""Unauthenticated""\r\n2024-04-11T17:12:22.592340+09:00 <info> scorer-metabase-metabase1[1399]:\r\n2024-04-11T17:12:22.602955+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:12:22,602 DEBUG middleware.log :: GET /api/session/properties 200 8.3 ms (2 DB calls) App DB connections: 2/7 Jetty threads: 6/50 (1 idle, 0 queued) (53 total active threads) Queries in flight: 0 (0 queued)\r\n\r\n```\r\nAfter the sixth attempt, Metabase initialized successfully, and the Metabase Dashboard Page opened successfully.\r\n![image](https://github.com/metabase/metabase/assets/87641643/cfa4724e-9dd2-4062-8d4c-de2f42bf5d2e)\r\n![image](https://github.com/metabase/metabase/assets/87641643/daad4eea-3c3b-4a0d-9b16-997fdf652e0a)\r\n\r\n\r\nI have added the complete logs please check below: \r\n- [debian_nvidia_metabase.log](https://github.com/metabase/metabase/files/14943929/debian_nvidia_metabase.log)\r\n- [debian_nvidia_metabase_mysql_log](https://github.com/metabase/metabase/files/14943935/debian_nvidia_metabase_mysql_log.txt)', 'created_at': datetime.datetime(2024, 4, 11, 11, 29, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2058795362, 'issue_id': 2233242378, 'author': 'darksciencebase', 'body': 'follow-up issue here: https://github.com/metabase/metabase/issues/41310', 'created_at': datetime.datetime(2024, 4, 16, 10, 48, 11, tzinfo=datetime.timezone.utc)}]","perivamsi on (2024-04-09 11:43:46 UTC): Metabase 41.0 is an old release that is not actively supported. Could you upgrade to the [latest version](https://github.com/metabase/metabase/releases/)?

ignacio-mb on (2024-04-10 14:42:36 UTC): Closing as this is an unsupported version

fti-sfuke (Issue Creator) on (2024-04-11 11:29:40 UTC): @perivamsi 

I have updated metabase version to latest one [ [v1.49.4](https://github.com/metabase/metabase/releases/tag/v1.49.4) ]
To Fix build issue we also upgraded NodeJS 20.12.2

**I encountered an issue where the metabase initialization failed and the metabase was shut down multiple times.
Metabase Dashboard will take almost 15 minutes to open because Metabase Initiation failed initially multiple times, but after successful initialization, it works fine. The Metabase Dashboard will open and also work fine**. 


**But the main concern is why Metabase initialization failed initially on the NVIDIA CUDA Container Environment. ?
It's working fine with the same version in the Intel Vaapi environment.**

**Metabase Dashboard will take almost 15 minutes to open because Metabase Initiation failed initially multiple times: 
It stuck on the below screenshot until Metabase Initiation was not successful.**

![image](https://github.com/metabase/metabase/assets/87641643/77218c58-317c-4c41-bc23-cf327cfba6b8)


I have found the following errors in the logs. By checking this, it looks like there is an issue with MySQL connectivity initially.
```
 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
 INFO db.setup :: Verifying mysql Database Connection ...
 ERROR metabase.core :: Metabase Initialization FAILED
 2024-04-09T19:35:30.565491+09:00 <info> scorer-metabase-metabase1[1480]: clojure.lang.ExceptionInfo: Unable to connect 
 to Metabase mysql DB. {}
 at metabase.db.setup$fn__33711$verify_db_connection__33716$fn__33717$fn__33718.invoke(setup.clj:102)
 Caused by: java.sql.SQLNonTransientConnectionException: Could not connect to address=(host=metabase1-rdb1.ctr) 
 (port=3306)(type=master) : Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection 
 refused)
 at org.mariadb.jdbc.internal.util.exceptions.ExceptionFactory.createException(ExceptionFactory.java:73)Caused by: 
  java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection 
  refused (Connection refused)
  Caused by: java.net.ConnectException: Connection refused (Connection refused)
  INFO metabase.core :: Metabase Shutting Down ...
  INFO metabase.server :: Shutting Down Embedded Jetty Webserver
  INFO metabase.core :: Metabase Shutdown COMPLETE
```

In 2nd attempt Starting Metabase in STANDALONE mode and here is the logs
```
 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
 INFO db.setup :: Verifying mysql Database Connection ...
 INFO db.setup :: Successfully verified MySQL 8.0.36-0ubuntu0.22.04.1 application database connection. ✅
 INFO db.setup :: Running Database Migrations...
 INFO db.setup :: Setting up Liquibase...
 INFO db.setup :: Liquibase is ready.
 INFO db.liquibase :: Checking if Database has unrun migrations...
 WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
INFO sync.util :: FINISHED: Sync h2 Database 1 'Sample Dataset' (21.8 s)
main ERROR An exception occurred processing Appender metabase-appender java.lang.IllegalArgumentException: No implementation of method: :explain of protocol: #'schema.core/Schema found for class: clojure.lang.Var$Unbound
at clojure.core$_cache_protocol_fn.invokeStatic(core_deftype.clj:583)
at clojure.core$_cache_protocol_fn.invoke(core_deftype.clj:575)
ERROR metabase.core :: Metabase Initialization FAILED
org.apache.logging.log4j.core.appender.AppenderLoggingException: An exception occurred processing Appender metabase-appender at org.apache.logging.log4j.core.appender.DefaultErrorHandler.error(DefaultErrorHandler.java:93)
Caused by: java.lang.IllegalArgumentException: No implementation of method: :explain of protocol: #'schema.core/Schema found for class: clojure.lang.Var$Unbound

INFO metabase.core :: Metabase Shutting Down ...
INFO metabase.server :: Shutting Down Embedded Jetty Webserver
INFO metabase.core :: Metabase Shutdown COMPLETE

```

In 3rd attempt Starting Metabase in STANDALONE mode and here is the logs
```
INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
INFO db.setup :: Verifying mysql Database Connection ...
ERROR metabase.core :: Metabase Initialization FAILED
clojure.lang.ExceptionInfo: Unable to connect to Metabase mysql DB. {} 
at metabase.db.setup$fn__34071$verify_db_connection__34076$fn__34077$fn__34078.invoke(setup.clj:102)
at metabase.db.setup$fn__34071$verify_db_connection__34076$fn__34077.invoke(setup.clj:100)
Caused by: java.sql.SQLNonTransientConnectionException: Could not connect to address=(host=metabase1-rdb1.ctr)(port=3306)(type=master) : Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)
Caused by: java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)
Caused by: java.net.ConnectException: Connection refused (Connection refused)
INFO metabase.core :: Metabase Shutting Down ...
INFO metabase.server :: Shutting Down Embedded Jetty Webserver
INFO metabase.core :: Metabase Shutdown COMPLETE
```

In 4th attempt Starting Metabase in STANDALONE mode and here is the logs
```
INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
INFO db.setup :: Verifying mysql Database Connection ...
ERROR metabase.core :: Metabase Initialization FAILED
clojure.lang.ExceptionInfo: Unable to connect to Metabase mysql DB. {}
at metabase.db.setup$fn__34071$verify_db_connection__34076$fn__34077$fn__34078.invoke(setup.clj:102)
Caused by: java.sql.SQLNonTransientConnectionException: Could not connect to address=(host=metabase1-rdb1.ctr)(port=3306)(type=master) : Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)
Caused by: java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)
Caused by: java.net.ConnectException: Connection refused (Connection refused)
INFO metabase.core :: Metabase Shutting Down ...
INFO metabase.server :: Shutting Down Embedded Jetty Webserver
INFO metabase.core :: Metabase Shutdown COMPLETE
```

In 5th attempt Starting Metabase in STANDALONE mode and here is the logs
```
INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
INFO db.setup :: Verifying mysql Database Connection ...
INFO db.setup :: Successfully verified MySQL 8.0.36-0ubuntu0.22.04.1 application database connection. ✅
INFO db.setup :: Running Database Migrations...
INFO db.setup :: Setting up Liquibase...
INFO db.setup :: Liquibase is ready.
INFO db.liquibase :: Checking if Database has unrun migrations...
WARN changelog.DatabaseChangeLog :: modifyDataType will lose primary key/autoincrement/not null settings for mysql.  Use <sql> and re-specify all configuration if this is the case
INFO sync.util :: FINISHED: Analyze data for h2 Database 1 'Sample Database' (1.4 s)
INFO task.send-pulses :: Sending scheduled pulses...
INFO metabase.core :: Metabase Shutting Down ...
INFO metabase.server :: Shutting Down Embedded Jetty Webserver
INFO metabase.core :: Metabase Shutdown COMPLETE
```

In 5th attempts Starting Metabase in STANDALONE mode and here is the logs
```
INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
INFO db.setup :: Verifying mysql Database Connection ...
ERROR metabase.core :: Metabase Initialization FAILED
clojure.lang.ExceptionInfo: Unable to connect to Metabase mysql DB. {}
Caused by: java.sql.SQLException: Connections could not be acquired from the underlying database!
Caused by: com.mchange.v2.resourcepool.CannotAcquireResourceException: A ResourcePool could not acquire a resource from its primary factory or source.
Caused by: java.sql.SQLNonTransientConnectionException: Could not connect to address=(host=metabase1-rdb1.ctr)(port=3306)(type=master) : Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)
Caused by: java.sql.SQLNonTransientConnectionException: Socket fail to connect to host:metabase1-rdb1.ctr, port:3306. Connection refused (Connection refused)
Caused by: java.net.ConnectException: Connection refused (Connection refused)
INFO metabase.core :: Metabase Shutting Down ...
INFO metabase.server :: Shutting Down Embedded Jetty Webserver
INFO metabase.core :: Metabase Shutdown COMPLETE
```


In 6th attempts Starting Metabase in STANDALONE mode and here is the logs
```
4 INFO db.setup :: Successfully verified MySQL 8.0.36-0ubuntu0.22.04.1 application database connection. ✅
INFO db.setup :: Checking if a database downgrade is required...
INFO db.setup :: Running Database Migrations...
INFO db.setup :: Setting up Liquibase...
INFO db.setup :: Liquibase is ready.
INFO db.liquibase :: Checking if Database has unrun migrations...
INFO db.liquibase :: Database has unrun migrations. Checking if migraton lock is taken...
INFO db.liquibase :: No migration lock found.
INFO db.liquibase :: Running 277 migrations ...
INFO impl.StdSchedulerFactory :: Using default implementation for ThreadExecutor
INFO core.SchedulerSignalerImpl :: Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
INFO core.QuartzScheduler :: Quartz Scheduler v.2.3.2 created.
INFO jdbcjobstore.JobStoreTX :: Using db table-based data access locking (synchronization).
INFO jdbcjobstore.JobStoreTX :: JobStoreTX initialized.
INFO core.QuartzScheduler :: Scheduler meta-data: Quartz Scheduler (v2.3.2) 'MetabaseScheduler' with instanceId '32c4e4be24631712821773808'
Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
NOT STARTED.
Currently in standby mode.
Number of jobs executed: 0
Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
Using job-store 'org.quartz.impl.jdbcjobstore.JobStoreTX' - which supports persistence. and is clustered.
INFO impl.StdSchedulerFactory :: Quartz scheduler 'MetabaseScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
INFO impl.StdSchedulerFactory :: Quartz scheduler version: 2.3.2
INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 started.
INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 shutting down.
INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 paused.
INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712821773808 shutdown complete.
INFO db.custom-migrations :: No forward migration for DowngradeDashboardTab
INFO impl.StdSchedulerFactory :: Using default implementation for ThreadExecutor
INFO core.SchedulerSignalerImpl :: Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
INFO core.QuartzScheduler :: Quartz Scheduler v.2.3.2 created.
INFO jdbcjobstore.JobStoreTX :: Using db table-based data access locking (synchronization).
INFO jdbcjobstore.JobStoreTX :: JobStoreTX initialized.
INFO core.QuartzScheduler :: Scheduler meta-data: Quartz Scheduler (v2.3.2) 'MetabaseScheduler' with instanceId '32c4e4be24631712822164665'
Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
NOT STARTED.
Currently in standby mode.
Number of jobs executed: 0
Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
Using job-store 'org.quartz.impl.jdbcjobstore.JobStoreTX' - which supports persistence. and is clustered.
INFO impl.StdSchedulerFactory :: Quartz scheduler 'MetabaseScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
INFO impl.StdSchedulerFactory :: Quartz scheduler version: 2.3.2
INFO jdbcjobstore.JobStoreTX :: ClusterManager: detected 1 failed or restarted instances.
INFO jdbcjobstore.JobStoreTX :: ClusterManager: Scanning for instance ""32c4e4be24631712821773808""'s failed in-progress jobs.
INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 started.
INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 shutting down.
INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 paused.
INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_32c4e4be24631712822164665 shutdown complete.
UPDATE SUMMARY
 Run:                        277
 Previously run:               0
Filtered out:                 5
 -------------------------------
Total change sets:          282
INFO db.liquibase :: Migration complete in 11.6 mins
INFO db.setup :: Database Migrations Current ...  ✅
INFO metabase.util :: Database setup took 11.8 mins
INFO metabase.core :: Looks like this is a new installation ... preparing setup wizard
INFO metabase.core :: Please use the following URL to setup your Metabase installation:
2024-04-11T16:56:05.792597+09:00 <info> scorer-metabase-metabase1[1399]: http://localhost:3000/setup/
INFO metabase.events :: Loading events namespace: metabase.events.audit-log 👂
INFO sync.util :: FINISHED: step ''sync-dbms-version'' for h2 Database 1 ''Sample Database'' (186.8 ms)
INFO sync.util :: STARTING: step ''sync-timezone'' for h2 Database 1 ''Sample Database''
INFO sync-metadata.sync-timezone :: :h2 database 1 default timezone is ""Asia/Tokyo""
INFO sync.util :: FINISHED: step ''sync-timezone'' for h2 Database 1 ''Sample Database'' (191.7 ms)
INFO sync.util :: STARTING: step ''sync-tables'' for h2 Database 1 ''Sample Database''
INFO sync-metadata.tables :: Found new tables: (Table  ''PUBLIC.ANALYTIC_EVENTS'' Table  ''PUBLIC.FEEDBACK'' Table  ''PUBLIC.PEOPLE'' Table  ''PUBLIC.REVIEWS'' Table  ''PUBLIC.ORDERS'' Table  ''PUBLIC.ACCOUNTS'' Table  ''PUBLIC.INVOICES'' Table  ''PUBLIC.PRODUCTS'')
INFO sync-metadata.tables :: Updating table metadata for Table 8 ''PUBLIC.PRODUCTS''
INFO sync-metadata.tables :: Updating table metadata for Table 3 ''PUBLIC.PEOPLE''
INFO sync-metadata.tables :: Updating table metadata for Table 7 ''PUBLIC.INVOICES''
INFO sync-metadata.tables :: Updating table metadata for Table 5 ''PUBLIC.ORDERS''
INFO sync-metadata.tables :: Updating table metadata for Table 4 ''PUBLIC.REVIEWS''
INFO sync.analyze :: fingerprint-fields Analyzed [*****·············································] 😢   12% Table 2 ''PUBLIC.FEEDBACK''
classify-fields Analyzed [******************································] 😕   36% Table 6 ''PUBLIC.ACCOUNTS''
classify-tables Analyzed [************************************··············] 😋   72% Table 1 ''PUBLIC.ANALYTIC_EVENTS''
INFO sync.analyze :: classify-tables Analyzed [***********************************************···] 😎   96% Table 4 ''PUBLIC.REVIEWS''
INFO sync.util :: FINISHED: step ''classify-tables'' for h2 Database 1 ''Sample Database'' (2.0 s)
2024-04-11T16:56:53.145817+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 16:56:53,144 INFO sync.util :: FINISHED: Analyze data for h2 Database 1 ''Sample Database'' (25.9 s)
2024-04-11T17:12:22.592232+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:12:22,591 DEBUG middleware.log :: GET /api/user/current 401 847.3 µs (0 DB calls)
2024-04-11T17:12:22.592315+09:00 <info> scorer-metabase-metabase1[1399]: ""Unauthenticated""
2024-04-11T17:12:22.592340+09:00 <info> scorer-metabase-metabase1[1399]:
2024-04-11T17:12:22.602955+09:00 <info> scorer-metabase-metabase1[1399]: 2024-04-11 17:12:22,602 DEBUG middleware.log :: GET /api/session/properties 200 8.3 ms (2 DB calls) App DB connections: 2/7 Jetty threads: 6/50 (1 idle, 0 queued) (53 total active threads) Queries in flight: 0 (0 queued)

```
After the sixth attempt, Metabase initialized successfully, and the Metabase Dashboard Page opened successfully.
![image](https://github.com/metabase/metabase/assets/87641643/cfa4724e-9dd2-4062-8d4c-de2f42bf5d2e)
![image](https://github.com/metabase/metabase/assets/87641643/daad4eea-3c3b-4a0d-9b16-997fdf652e0a)


I have added the complete logs please check below: 
- [debian_nvidia_metabase.log](https://github.com/metabase/metabase/files/14943929/debian_nvidia_metabase.log)
- [debian_nvidia_metabase_mysql_log](https://github.com/metabase/metabase/files/14943935/debian_nvidia_metabase_mysql_log.txt)

darksciencebase on (2024-04-16 10:48:11 UTC): follow-up issue here: https://github.com/metabase/metabase/issues/41310

"
2233197198,issue,closed,completed,Parameter Sidebar renders wrong tab content when Linked filters are not allowed to change,"### Describe the bug


https://github.com/metabase/metabase/assets/125459446/55f6cf7a-1d4a-4783-905e-8eb9551663c8



### To Reproduce

1. create a dahboard
2. add a card (new question -> orders -> save) to the dashboard
3. add 2 filtes (one for category and one for date) and map them to the orders question
4. go to edit dashboard, click on first parameter, choose ""Linked filters"" tab, then click on second parameter
5. sidebar is changed, title rendered ""Filter settings"", but tab content still renders ""Linked filters"" which is not correct 
<img width=""958"" alt=""image"" src=""https://github.com/metabase/metabase/assets/125459446/c01d3453-fcf9-40b6-940b-0cd7012f0f4d"">



### Expected behavior

5. Filter settings content is rendered in the tab content

<img width=""958"" alt=""image"" src=""https://github.com/metabase/metabase/assets/125459446/d0d45e74-f23d-40b7-8e31-98f4b650e755"">


### Logs

_No response_

### Information about your Metabase installation

```JSON
15e5ca6c86, 49.3
```


### Severity

p3

### Additional context

_No response_",uladzimirdev,2024-04-09 11:10:20+00:00,['uladzimirdev'],2024-04-11 10:26:45+00:00,2024-04-11 10:26:45+00:00,https://github.com/metabase/metabase/issues/41174,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/Querying', '')]",[],
2233166063,issue,closed,completed,Do not require `onConfirm` prop in `EntityPickerModal`,See discussion https://github.com/metabase/metabase/pull/40509/files#r1556931796,kamilmielnik,2024-04-09 10:55:07+00:00,['kamilmielnik'],2024-05-07 10:05:51+00:00,2024-05-07 10:05:50+00:00,https://github.com/metabase/metabase/issues/41172,"[('.Frontend', ''), ('.Team/Querying', '')]","[{'comment_id': 2097930692, 'issue_id': 2233166063, 'author': 'kamilmielnik', 'body': 'Closed by #42317', 'created_at': datetime.datetime(2024, 5, 7, 10, 5, 50, tzinfo=datetime.timezone.utc)}]","kamilmielnik (Issue Creator) on (2024-05-07 10:05:50 UTC): Closed by #42317

"
2233068764,issue,closed,completed,Add data type and operator to the sidebar,,uladzimirdev,2024-04-09 09:58:16+00:00,['uladzimirdev'],2024-04-12 19:27:13+00:00,2024-04-12 19:27:13+00:00,https://github.com/metabase/metabase/issues/41168,[],[],
2232817676,issue,closed,completed,Cannot interact with the scrollbar in the suggestions list,"### Describe the bug

https://github.com/metabase/metabase/assets/6830683/2304f6f6-7797-4dc4-ba0c-d38c3ecedb51



### To Reproduce

1. Start a new question based on the Orders table
2. Click + to add new column
3. Type `[` to show suggestions list
4. Try to press & hold the vertical scrollbar to scroll the list

Suggestions list disappears

### Expected behavior

Scrollbar is interactive

### Information about your Metabase installation

master, 1504b86572

### Severity

P2
",kamilmielnik,2024-04-09 07:43:38+00:00,[],2024-06-12 07:26:13+00:00,2024-06-12 07:07:41+00:00,https://github.com/metabase/metabase/issues/41165,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]",[],
2232743085,issue,closed,completed,Add a setting to disable native query parsing completely (triggered only by ENV variable),,tsmacdonald,2024-04-09 07:00:19+00:00,['piranha'],2024-04-30 09:24:10+00:00,2024-04-16 10:21:50+00:00,https://github.com/metabase/metabase/issues/41163,"[('Querying/Native/Parser', '')]","[{'comment_id': 2047885525, 'issue_id': 2232743085, 'author': 'tsmacdonald', 'body': '@piranha I leave it to you to come up with a clever compromise between this and `nqa/*parse-queries-in-test?*` :thinking:', 'created_at': datetime.datetime(2024, 4, 10, 15, 39, 39, tzinfo=datetime.timezone.utc)}]","tsmacdonald (Issue Creator) on (2024-04-10 15:39:39 UTC): @piranha I leave it to you to come up with a clever compromise between this and `nqa/*parse-queries-in-test?*` :thinking:

"
2232740296,issue,open,,Prevent cards from saving (both create and update) if they have a dirty query,,tsmacdonald,2024-04-09 06:58:20+00:00,[],2024-04-09 06:58:20+00:00,,https://github.com/metabase/metabase/issues/41162,[],[],
2232737907,issue,open,,[ParseSQL] Get stale field usages from MBQL queries,,tsmacdonald,2024-04-09 06:57:24+00:00,[],2024-06-14 09:21:33+00:00,,https://github.com/metabase/metabase/issues/41161,"[('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2167617000, 'issue_id': 2232737907, 'author': 'crisptrutski', 'body': 'Is the idea here that we just search for QueryField rows which join to inactive fields?', 'created_at': datetime.datetime(2024, 6, 14, 9, 21, 32, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2024-06-14 09:21:32 UTC): Is the idea here that we just search for QueryField rows which join to inactive fields?

"
2232714413,issue,open,,CSV export crashes (error reducing results),"**Describe the bug**
With some questions we are not able to export the results as a csv. The result size is around 330k so its under the 1Mio limit. If we filter down the results more the export is working like expected. 

**Logs**

```
[79f08b8c-9a86-4c47-8f88-e60e1a44d26f] 2024-04-09T08:14:52+02:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: Broken pipe
{:database_id 20,
 :started_at #t ""2024-04-09T08:14:21.985027+02:00[Europe/Zurich]"",
 :via
 [{:status :failed,
   :class org.eclipse.jetty.io.EofException,
   :error nil,
   :stacktrace
   [""org.eclipse.jetty.io.SocketChannelEndPoint.flush(SocketChannelEndPoint.java:116)""
    ""org.eclipse.jetty.io.WriteFlusher.flush(WriteFlusher.java:422)""
    ""org.eclipse.jetty.io.WriteFlusher.write(WriteFlusher.java:275)""
    ""org.eclipse.jetty.io.WriteFlusher.write(WriteFlusher.java:254)""
    ""org.eclipse.jetty.io.AbstractEndPoint.write(AbstractEndPoint.java:386)""
    ""org.eclipse.jetty.server.HttpConnection$SendCallback.process(HttpConnection.java:832)""
    ""org.eclipse.jetty.util.IteratingCallback.processing(IteratingCallback.java:243)""
    ""org.eclipse.jetty.util.IteratingCallback.iterate(IteratingCallback.java:224)""
    ""org.eclipse.jetty.server.HttpConnection.send(HttpConnection.java:589)""
    ""org.eclipse.jetty.server.HttpChannel.sendResponse(HttpChannel.java:1051)""
    ""org.eclipse.jetty.server.HttpChannel.write(HttpChannel.java:1123)""
    ""org.eclipse.jetty.server.HttpOutput.channelWrite(HttpOutput.java:270)""
    ""org.eclipse.jetty.server.HttpOutput.channelWrite(HttpOutput.java:254)""
    ""org.eclipse.jetty.server.HttpOutput.flush(HttpOutput.java:736)""
    ""java.base/java.util.zip.DeflaterOutputStream.flush(Unknown Source)""
    ""--> async.streaming_response$delay_output_stream$fn__43773.invoke(streaming_response.clj:123)""
    ""async.streaming_response.proxy$java.io.OutputStream$ff19274a.flush(Unknown Source)""
    ""query_processor.streaming.csv$fn$reify__52334.write_row_BANG_(csv.clj:48)""
    ""query_processor.streaming$streaming_rff$fn__53086$fn__53091.invoke(streaming.clj:127)""
    ""query_processor.middleware.process_userland_query$add_and_save_execution_info_xform_BANG_$execution_info_rf_STAR___72127.invoke(process_userland_query.clj:110)""
    ""query_processor.middleware.add_rows_truncated$add_rows_truncated_xform$fn__70926.invoke(add_rows_truncated.clj:34)""
    ""query_processor.reducible$combine_additional_reducing_fns$combine_additional_reducing_fns_rf_STAR___62648.invoke(reducible.clj:233)""
    ""query_processor.middleware.cache$save_results_xform$fn__71938.invoke(cache.clj:125)""
    ""query_processor.reducible$reducible_rows$reify__62640.reduce(reducible.clj:177)""
    ""query_processor.context.default$default_reducef$fn__50422.invoke(default.clj:34)""
    ""query_processor.context.default$default_reducef.invokeStatic(default.clj:33)""
    ""query_processor.context.default$default_reducef.invoke(default.clj:25)""
    ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___71979$fn__71980.invoke(cache.clj:201)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:83)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:73)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
    ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___71979.invoke(cache.clj:197)""
    ""query_processor.context$reducef.invokeStatic(context.clj:70)""
    ""query_processor.context$reducef.invoke(context.clj:63)""
    ""query_processor.context.default$default_runf$respond_STAR___50426.invoke(default.clj:45)""
    ""driver.mongo.execute$reduce_results.invokeStatic(execute.clj:177)""
    ""driver.mongo.execute$reduce_results.invoke(execute.clj:171)""
    ""driver.mongo.execute$execute_reducible_query.invokeStatic(execute.clj:207)""
    ""driver.mongo.execute$execute_reducible_query.invoke(execute.clj:182)""
    ""driver.mongo$fn__125711$f__121949__auto____125712.invoke(mongo.clj:320)""
    ""driver.mongo.connection$do_with_mongo_client$fn__121940.invoke(connection.clj:95)""
    ""util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:165)""
    ""util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154)""
    ""driver.mongo.connection$do_with_mongo_client.invokeStatic(connection.clj:90)""
    ""driver.mongo.connection$do_with_mongo_client.invoke(connection.clj:86)""
    ""driver.mongo$fn__125711.invokeStatic(mongo.clj:319)""
    ""driver.mongo$fn__125711.invoke(mongo.clj:317)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$run_query_with_cache.invokeStatic(cache.clj:202)""
    ""query_processor.middleware.cache$run_query_with_cache.invoke(cache.clj:186)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___71992.invoke(cache.clj:228)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66378.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__71813.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__71823.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71255.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73137$combined_post_process__73142$combined_post_process_STAR___73143.invoke(query_processor.clj:262)""
    ""query_processor$fn__73137$combined_pre_process__73138$combined_pre_process_STAR___73139.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66475.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__71903$fn__71907.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__71903.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67081$fn__67082.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67081.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__71900.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72205.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__71840$handle_audit_app_internal_queries__71841$fn__71843.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__71851.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__70966.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72136.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72737.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62625$thunk__62627.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62625$fn__62629.invoke(reducible.clj:131)""]}
  {:status :failed,
   :class clojure.lang.ExceptionInfo,
   :error ""Error reducing result rows: null"",
   :stacktrace
   [""--> query_processor.context.default$default_reducef$fn__50422.invoke(default.clj:36)""
    ""query_processor.context.default$default_reducef.invokeStatic(default.clj:33)""
    ""query_processor.context.default$default_reducef.invoke(default.clj:25)""
    ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___71979$fn__71980.invoke(cache.clj:201)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:83)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:73)""
    ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
    ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___71979.invoke(cache.clj:197)""
    ""query_processor.context$reducef.invokeStatic(context.clj:70)""
    ""query_processor.context$reducef.invoke(context.clj:63)""
    ""query_processor.context.default$default_runf$respond_STAR___50426.invoke(default.clj:45)""
    ""driver.mongo.execute$reduce_results.invokeStatic(execute.clj:177)""
    ""driver.mongo.execute$reduce_results.invoke(execute.clj:171)""
    ""driver.mongo.execute$execute_reducible_query.invokeStatic(execute.clj:207)""
    ""driver.mongo.execute$execute_reducible_query.invoke(execute.clj:182)""
    ""driver.mongo$fn__125711$f__121949__auto____125712.invoke(mongo.clj:320)""
    ""driver.mongo.connection$do_with_mongo_client$fn__121940.invoke(connection.clj:95)""
    ""util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:165)""
    ""util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154)""
    ""driver.mongo.connection$do_with_mongo_client.invokeStatic(connection.clj:90)""
    ""driver.mongo.connection$do_with_mongo_client.invoke(connection.clj:86)""
    ""driver.mongo$fn__125711.invokeStatic(mongo.clj:319)""
    ""driver.mongo$fn__125711.invoke(mongo.clj:317)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$run_query_with_cache.invokeStatic(cache.clj:202)""
    ""query_processor.middleware.cache$run_query_with_cache.invoke(cache.clj:186)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___71992.invoke(cache.clj:228)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66378.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__71813.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__71823.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71255.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73137$combined_post_process__73142$combined_post_process_STAR___73143.invoke(query_processor.clj:262)""
    ""query_processor$fn__73137$combined_pre_process__73138$combined_pre_process_STAR___73139.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66475.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__71903$fn__71907.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__71903.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67081$fn__67082.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67081.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__71900.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72205.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__71840$handle_audit_app_internal_queries__71841$fn__71843.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__71851.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__70966.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72136.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72737.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62625$thunk__62627.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62625$fn__62629.invoke(reducible.clj:131)""],
   :error_type :qp,
   :ex-data {:type :qp}}],
 :action_id nil,
 :error_type :qp,
 :json_query
 {:constraints nil,
  :type :native,
  :middleware
  {:js-int-to-string? false,
   :ignore-cached-results? true,
   :process-viz-settings? true,
   :skip-results-metadata? true,
   :format-rows? false},
  :native
  {:template-tags
   {""date_from""
    {:id ""d57ca0ce-25ab-a4db-3f41-381b4cf60352"",
     :name ""date_from"",
     :display-name ""Date from"",
     :type :date,
     :required true},
    ""date_to""
    {:id ""a7ddd35b-cfb2-f40d-dfab-4d14fe6ee2f0"",
     :name ""date_to"",
     :display-name ""Date to"",
     :type :date,
     :required true}},
   :query
   ""[\n        { \n            \""$match\"" : { \n                \""created\"" : { \n                     \""$gte\"" : {{date_from}},\n                    \""$lt\"" : {{date_to}}\n                },\n                \""suisseimage_channel_id\"": {\n                    \""$ne\"": null\n                },\n                \""action\"" : \""timeout\""\n            }\n        }, \n        { \n            \""$project\"" : { \n                \""_id\"" : false, \n                \""distributor_name_100\"" : \""Teleboy - Teleboy AG\"", \n                \""suissedigital_member_id_101\"" : \""5003\"", \n                \""swissstream_member_id_102\"" : \""teleboy.ch\"", \n                \""channel_name_103\"" : \""$channel_name\"", \n                \""suisseimage_channel_id_104\"" : \""$suisseimage_channel_id\"", \n                \""adrequest_datetime_utc_205\"" : { \n                    \""$replaceAll\"" : { \n                        \""input\"" : { \n                            \""$dateToString\"" : { \n                                \""date\"" : { \n                                    \""$toDate\"" : \""$created\""\n                                }, \n                                \""format\"" : \""%d/%m/%Y %H:%M:%S\""\n                            }\n                        }, \n                        \""find\"" : \""/xxx20\"", \n                        \""replacement\"" : \""/\""\n                    }\n                }, \n                \""ad_format_206\"" : { \n                    \""$switch\"" : { \n                        \""branches\"" : [\n                            { \n                                \""case\"" : { \n                                    \""$eq\"" : [\n                                        \""$type\"", \n                                        \""start\""\n                                    ]\n                                }, \n                                \""then\"" : \""1\""\n                            }, \n                            { \n                                \""case\"" : { \n                                    \""$eq\"" : [\n                                        \""$type\"", \n                                        \""pause\""\n                                    ]\n                                }, \n                                \""then\"" : \""2\""\n                            }, \n                            { \n                                \""case\"" : { \n                                    \""$eq\"" : [\n                                        \""$type\"", \n                                        \""ffwd\""\n                                    ]\n                                }, \n                                \""then\"" : \""3\""\n                            }\n                        ], \n                        \""default\"" : \""0\""\n                    }\n                }\n            }\n        },  \n        { \n            \""$sort\"" : { \n                \""created\"" : 1.0\n            }\n        }\n    ]"",
   :collection ""gt12_tracking""},
  :viz-settings nil,
  :database 20,
  :parameters
  ({:id ""d57ca0ce-25ab-a4db-3f41-381b4cf60352"",
    :type ""date/single"",
    :value ""2024-03-01"",
    :target [""variable"" [""template-tag"" ""date_from""]]}
   {:id ""a7ddd35b-cfb2-f40d-dfab-4d14fe6ee2f0"",
    :type ""date/single"",
    :value ""2024-03-31"",
    :target [""variable"" [""template-tag"" ""date_to""]]}),
  :async? true,
  :cache-ttl 268},
 :status :failed,
 :class java.io.IOException,
 :stacktrace
 [""java.base/sun.nio.ch.FileDispatcherImpl.writev0(Native Method)""
  ""java.base/sun.nio.ch.SocketDispatcher.writev(Unknown Source)""
  ""java.base/sun.nio.ch.IOUtil.write(Unknown Source)""
  ""java.base/sun.nio.ch.IOUtil.write(Unknown Source)""
  ""java.base/sun.nio.ch.SocketChannelImpl.write(Unknown Source)""
  ""java.base/java.nio.channels.SocketChannel.write(Unknown Source)""
  ""org.eclipse.jetty.io.SocketChannelEndPoint.flush(SocketChannelEndPoint.java:110)""
  ""org.eclipse.jetty.io.WriteFlusher.flush(WriteFlusher.java:422)""
  ""org.eclipse.jetty.io.WriteFlusher.write(WriteFlusher.java:275)""
  ""org.eclipse.jetty.io.WriteFlusher.write(WriteFlusher.java:254)""
  ""org.eclipse.jetty.io.AbstractEndPoint.write(AbstractEndPoint.java:386)""
  ""org.eclipse.jetty.server.HttpConnection$SendCallback.process(HttpConnection.java:832)""
  ""org.eclipse.jetty.util.IteratingCallback.processing(IteratingCallback.java:243)""
  ""org.eclipse.jetty.util.IteratingCallback.iterate(IteratingCallback.java:224)""
  ""org.eclipse.jetty.server.HttpConnection.send(HttpConnection.java:589)""
  ""org.eclipse.jetty.server.HttpChannel.sendResponse(HttpChannel.java:1051)""
  ""org.eclipse.jetty.server.HttpChannel.write(HttpChannel.java:1123)""
  ""org.eclipse.jetty.server.HttpOutput.channelWrite(HttpOutput.java:270)""
  ""org.eclipse.jetty.server.HttpOutput.channelWrite(HttpOutput.java:254)""
  ""org.eclipse.jetty.server.HttpOutput.flush(HttpOutput.java:736)""
  ""java.base/java.util.zip.DeflaterOutputStream.flush(Unknown Source)""
  ""--> async.streaming_response$delay_output_stream$fn__43773.invoke(streaming_response.clj:123)""
  ""async.streaming_response.proxy$java.io.OutputStream$ff19274a.flush(Unknown Source)""
  ""query_processor.streaming.csv$fn$reify__52334.write_row_BANG_(csv.clj:48)""
  ""query_processor.streaming$streaming_rff$fn__53086$fn__53091.invoke(streaming.clj:127)""
  ""query_processor.middleware.process_userland_query$add_and_save_execution_info_xform_BANG_$execution_info_rf_STAR___72127.invoke(process_userland_query.clj:110)""
  ""query_processor.middleware.add_rows_truncated$add_rows_truncated_xform$fn__70926.invoke(add_rows_truncated.clj:34)""
  ""query_processor.reducible$combine_additional_reducing_fns$combine_additional_reducing_fns_rf_STAR___62648.invoke(reducible.clj:233)""
  ""query_processor.middleware.cache$save_results_xform$fn__71938.invoke(cache.clj:125)""
  ""query_processor.reducible$reducible_rows$reify__62640.reduce(reducible.clj:177)""
  ""query_processor.context.default$default_reducef$fn__50422.invoke(default.clj:34)""
  ""query_processor.context.default$default_reducef.invokeStatic(default.clj:33)""
  ""query_processor.context.default$default_reducef.invoke(default.clj:25)""
  ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___71979$fn__71980.invoke(cache.clj:201)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:83)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invokeStatic(impl.clj:73)""
  ""query_processor.middleware.cache.impl$do_with_serialization.invoke(impl.clj:54)""
  ""query_processor.middleware.cache$run_query_with_cache$reducef_SINGLEQUOTE___71979.invoke(cache.clj:197)""
  ""query_processor.context$reducef.invokeStatic(context.clj:70)""
  ""query_processor.context$reducef.invoke(context.clj:63)""
  ""query_processor.context.default$default_runf$respond_STAR___50426.invoke(default.clj:45)""
  ""driver.mongo.execute$reduce_results.invokeStatic(execute.clj:177)""
  ""driver.mongo.execute$reduce_results.invoke(execute.clj:171)""
  ""driver.mongo.execute$execute_reducible_query.invokeStatic(execute.clj:207)""
  ""driver.mongo.execute$execute_reducible_query.invoke(execute.clj:182)""
  ""driver.mongo$fn__125711$f__121949__auto____125712.invoke(mongo.clj:320)""
  ""driver.mongo.connection$do_with_mongo_client$fn__121940.invoke(connection.clj:95)""
  ""util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:165)""
  ""util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154)""
  ""driver.mongo.connection$do_with_mongo_client.invokeStatic(connection.clj:90)""
  ""driver.mongo.connection$do_with_mongo_client.invoke(connection.clj:86)""
  ""driver.mongo$fn__125711.invokeStatic(mongo.clj:319)""
  ""driver.mongo$fn__125711.invoke(mongo.clj:317)""
  ""query_processor.context$executef.invokeStatic(context.clj:60)""
  ""query_processor.context$executef.invoke(context.clj:49)""
  ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
  ""query_processor.context.default$default_runf.invoke(default.clj:42)""
  ""query_processor.context$runf.invokeStatic(context.clj:46)""
  ""query_processor.context$runf.invoke(context.clj:40)""
  ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
  ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
  ""query_processor.middleware.cache$run_query_with_cache.invokeStatic(cache.clj:202)""
  ""query_processor.middleware.cache$run_query_with_cache.invoke(cache.clj:186)""
  ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___71992.invoke(cache.clj:228)""
  ""query_processor.middleware.permissions$check_query_permissions$fn__66378.invoke(permissions.clj:140)""
  ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__71813.invoke(enterprise.clj:51)""
  ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__71823.invoke(enterprise.clj:64)""
  ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71255.invoke(mbql_to_native.clj:24)""
  ""query_processor$fn__73137$combined_post_process__73142$combined_post_process_STAR___73143.invoke(query_processor.clj:262)""
  ""query_processor$fn__73137$combined_pre_process__73138$combined_pre_process_STAR___73139.invoke(query_processor.clj:259)""
  ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66475.invoke(fetch_source_query.clj:303)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__71903$fn__71907.invoke(resolve_database_and_driver.clj:77)""
  ""driver$do_with_driver.invokeStatic(driver.clj:97)""
  ""driver$do_with_driver.invoke(driver.clj:92)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__71903.invoke(resolve_database_and_driver.clj:76)""
  ""query_processor.middleware.store$initialize_store$fn__67081$fn__67082.invoke(store.clj:14)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.middleware.store$initialize_store$fn__67081.invoke(store.clj:13)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__71900.invoke(resolve_database_and_driver.clj:60)""
  ""query_processor.middleware.normalize_query$normalize$fn__72205.invoke(normalize_query.clj:38)""
  ""query_processor.middleware.enterprise$fn__71840$handle_audit_app_internal_queries__71841$fn__71843.invoke(enterprise.clj:96)""
  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__71851.invoke(enterprise.clj:103)""
  ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__70966.invoke(constraints.clj:104)""
  ""query_processor.middleware.process_userland_query$process_userland_query$fn__72136.invoke(process_userland_query.clj:156)""
  ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72737.invoke(catch_exceptions.clj:171)""
  ""query_processor.reducible$async_qp$qp_STAR___62625$thunk__62627.invoke(reducible.clj:126)""
  ""query_processor.reducible$async_qp$qp_STAR___62625$fn__62629.invoke(reducible.clj:131)""],
 :card_id 1890,
 :context :csv-download,
 :error ""Broken pipe"",
 :row_count 0,
 :running_time 0,
 :data {:rows [], :cols []}}
[79f08b8c-9a86-4c47-8f88-e60e1a44d26f] 2024-04-09T08:14:52+02:00 ERROR metabase.async.streaming-response Caught unexpected Exception in streaming response body,java.lang.NullPointerException: Deflater has been closed,	at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source),	at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source),	at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121),	at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source),	at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:58),	at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46),	at metabase.query_processor.streaming$streaming_response_STAR_$fn__53145.invoke(streaming.clj:176),	at clojure.lang.AFn.applyToHelper(AFn.java:156),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$with_bindings_STAR_.invokeStatic(core.clj:1990),	at clojure.core$with_bindings_STAR_.doInvoke(core.clj:1990),	at clojure.lang.RestFn.applyTo(RestFn.java:142),	at clojure.core$apply.invokeStatic(core.clj:671),	at clojure.core$bound_fn_STAR_$fn__5818.doInvoke(core.clj:2020),	at clojure.lang.RestFn.invoke(RestFn.java:421),	at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69),	at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67),	at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88),	at clojure.lang.AFn.run(AFn.java:22),	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source)
[79f08b8c-9a86-4c47-8f88-e60e1a44d26f] 2024-04-09T08:14:52+02:00 ERROR metabase.async.streaming-response Error writing error to output stream {:via [{:type java.lang.NullPointerException, :message Deflater has been closed, :at [java.util.zip.Deflater ensureOpen nil -1]}], :trace [[java.util.zip.Deflater ensureOpen nil -1] [java.util.zip.Deflater deflate nil -1] [java.util.zip.Deflater deflate nil -1] [java.util.zip.GZIPOutputStream finish nil -1] [java.util.zip.DeflaterOutputStream close nil -1] [metabase.async.streaming_response$delay_output_stream$fn__43771 invoke streaming_response.clj 121] [metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a close nil -1] [metabase.async.streaming_response$write_error_BANG_ invokeStatic streaming_response.clj 58] [metabase.async.streaming_response$write_error_BANG_ invoke streaming_response.clj 46] [metabase.query_processor.streaming$streaming_response_STAR_$fn__53145 invoke streaming.clj 176] [clojure.lang.AFn applyToHelper AFn.java 156] [clojure.lang.AFn applyTo AFn.java 144] [clojure.core$apply invokeStatic core.clj 667] [clojure.core$with_bindings_STAR_ invokeStatic core.clj 1990] [clojure.core$with_bindings_STAR_ doInvoke core.clj 1990] [clojure.lang.RestFn applyTo RestFn.java 142] [clojure.core$apply invokeStatic core.clj 671] [clojure.core$bound_fn_STAR_$fn__5818 doInvoke core.clj 2020] [clojure.lang.RestFn invoke RestFn.java 421] [metabase.async.streaming_response$do_f_STAR_ invokeStatic streaming_response.clj 69] [metabase.async.streaming_response$do_f_STAR_ invoke streaming_response.clj 67] [metabase.async.streaming_response$do_f_async$task__43756 invoke streaming_response.clj 88] [clojure.lang.AFn run AFn.java 22] [java.util.concurrent.Executors$RunnableAdapter call nil -1] [java.util.concurrent.FutureTask run nil -1] [java.util.concurrent.ThreadPoolExecutor runWorker nil -1] [java.util.concurrent.ThreadPoolExecutor$Worker run nil -1] [java.lang.Thread run nil -1]], :cause Deflater has been closed, :_status 500},java.lang.NullPointerException: Deflater has been closed,	at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source),	at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source),	at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121),	at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source),	at java.base/sun.nio.cs.StreamEncoder.implClose(Unknown Source),	at java.base/sun.nio.cs.StreamEncoder.close(Unknown Source),	at java.base/java.io.OutputStreamWriter.close(Unknown Source),	at java.base/java.io.BufferedWriter.close(Unknown Source),	at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:61),	at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46),	at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78),	at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67),	at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88),	at clojure.lang.AFn.run(AFn.java:22),	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source)
[79f08b8c-9a86-4c47-8f88-e60e1a44d26f] 2024-04-09T08:14:52+02:00 ERROR metabase.async.streaming-response bound-fn caught unexpected Exception,java.lang.NullPointerException: Deflater has been closed,	at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.Deflater.deflate(Unknown Source),	at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source),	at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source),	at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121),	at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source),	at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:58),	at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46),	at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78),	at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67),	at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88),	at clojure.lang.AFn.run(AFn.java:22),	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source)
[79f08b8c-9a86-4c47-8f88-e60e1a44d26f] 2024-04-09T08:14:52+02:00 DEBUG metabase.server.middleware.log POST /api/card/1890/query/csv 200 [ASYNC: unexpected-error] 30.2 s (10 DB calls) App DB connections: 1/16 Jetty threads: 2/50 (5 idle, 0 queued) (151 total active threads) Queries in flight: 0 (0 queued)
```


**Expected behavior**
The hole export works like the smaller ones


**Severity**
Our prodcut team has a decent amount more work, because they have to do the export in small batches and put it together in excel sheets and has to double check everything


**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""de-DE"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.58+"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Zurich""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mysql"",
      ""googleanalytics"",
      ""mongo"",
      ""bigquery-cloud-sdk""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MySQL"",
        ""version"": ""8.0.20""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-03-21"",
      ""tag"": ""v0.49.1"",
      ""hash"": ""54ef5e9""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Zurich""
    }
  }
}
```",RaoulBrueckler,2024-04-09 06:42:36+00:00,[],2025-02-04 20:29:39+00:00,,https://github.com/metabase/metabase/issues/41159,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Database/Mongo', None), ('Reporting/Export', ''), ('.Backend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2047755982, 'issue_id': 2232714413, 'author': 'ignacio-mb', 'body': '@RaoulBrueckler does this happen as well with JSON or CSV? \r\nHow much time does the query take to run?', 'created_at': datetime.datetime(2024, 4, 10, 14, 45, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2047871238, 'issue_id': 2232714413, 'author': 'RaoulBrueckler', 'body': 'Yes and the query runs about 22 seconds\r\n\r\nAm Mi., 10. Apr. 2024 um 16:45 Uhr schrieb ignacio ***@***.***\r\n>:\r\n\r\n> @RaoulBrueckler <https://github.com/RaoulBrueckler> does this happen as\r\n> well with JSON or CSV?\r\n> How much time does the query take to run?\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/metabase/metabase/issues/41159#issuecomment-2047755982>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AAUSP4RTWCTFUS3ZNNIG27LY4VGCLAVCNFSM6AAAAABF5642QGVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDANBXG42TKOJYGI>\r\n> .\r\n> You are receiving this because you were mentioned.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 4, 10, 15, 32, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2052115731, 'issue_id': 2232714413, 'author': 'ignacio-mb', 'body': 'Can be related to https://github.com/metabase/metabase/issues/40492', 'created_at': datetime.datetime(2024, 4, 12, 16, 49, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2052118794, 'issue_id': 2232714413, 'author': 'ignacio-mb', 'body': '@RaoulBrueckler Do you have any date fields on the data? Can you share the field types?', 'created_at': datetime.datetime(2024, 4, 12, 16, 51, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2058302584, 'issue_id': 2232714413, 'author': 'RaoulBrueckler', 'body': 'Yes there are date fields....\r\n\r\nHere ist the Query\r\n`[\r\n        { \r\n            ""$match"" : { \r\n                ""created"" : { \r\n                     ""$gte"" : {{date_from}},\r\n                    ""$lt"" : {{date_to}}\r\n                },\r\n                ""suisseimage_channel_id"": {\r\n                    ""$ne"": null\r\n                },\r\n                ""action"" : ""timeout""\r\n            }\r\n        }, \r\n        { \r\n            ""$project"" : { \r\n                ""_id"" : false, \r\n                ""distributor_name_100"" : ""Teleboy - Teleboy AG"", \r\n                ""suissedigital_member_id_101"" : ""5003"", \r\n                ""swissstream_member_id_102"" : ""teleboy.ch"", \r\n                ""channel_name_103"" : ""$channel_name"", \r\n                ""suisseimage_channel_id_104"" : ""$suisseimage_channel_id"", \r\n                ""adrequest_datetime_utc_205"" : { \r\n                    ""$replaceAll"" : { \r\n                        ""input"" : { \r\n                            ""$dateToString"" : { \r\n                                ""date"" : { \r\n                                    ""$toDate"" : ""$created""\r\n                                }, \r\n                                ""format"" : ""%d/%m/%Y %H:%M:%S""\r\n                            }\r\n                        }, \r\n                        ""find"" : ""/xxx20"", \r\n                        ""replacement"" : ""/""\r\n                    }\r\n                }, \r\n                ""ad_format_206"" : { \r\n                    ""$switch"" : { \r\n                        ""branches"" : [\r\n                            { \r\n                                ""case"" : { \r\n                                    ""$eq"" : [\r\n                                        ""$type"", \r\n                                        ""start""\r\n                                    ]\r\n                                }, \r\n                                ""then"" : ""1""\r\n                            }, \r\n                            { \r\n                                ""case"" : { \r\n                                    ""$eq"" : [\r\n                                        ""$type"", \r\n                                        ""pause""\r\n                                    ]\r\n                                }, \r\n                                ""then"" : ""2""\r\n                            }, \r\n                            { \r\n                                ""case"" : { \r\n                                    ""$eq"" : [\r\n                                        ""$type"", \r\n                                        ""ffwd""\r\n                                    ]\r\n                                }, \r\n                                ""then"" : ""3""\r\n                            }\r\n                        ], \r\n                        ""default"" : ""0""\r\n                    }\r\n                }\r\n            }\r\n        },  \r\n        { \r\n            ""$sort"" : { \r\n                ""created"" : 1.0\r\n            }\r\n        }\r\n    ]`\r\n\r\nAnd here are the field types\r\n![metabase-export-gt12](https://github.com/metabase/metabase/assets/2697202/d489ab2f-0c1f-4fc1-93e2-9982fff61e31)', 'created_at': datetime.datetime(2024, 4, 16, 6, 10, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2062099739, 'issue_id': 2232714413, 'author': 'ignacio-mb', 'body': '@RaoulBrueckler and what happens if you remove the date fields (day and created) and try to export?', 'created_at': datetime.datetime(2024, 4, 17, 19, 50, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2068565137, 'issue_id': 2232714413, 'author': 'RaoulBrueckler', 'body': 'No it crashes as well.... \r\n\r\n`2024-04-22 08:09:17,319 ERROR async.streaming-response :: Caught unexpected Exception in streaming response body                                                                           │\r\n│ java.lang.NullPointerException: Deflater has been closed                                                                                                                                   │\r\n│     at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source)                                                                                                                         │\r\n│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │\r\n│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │\r\n│     at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source)                                                                                                                     │\r\n│     at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source)                                                                                                                  │\r\n│     at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121)                                                                                  │\r\n│     at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source)                                                                                         │\r\n│     at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:58)                                                                                         │\r\n│     at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46)                                                                                               │\r\n│     at metabase.query_processor.streaming$streaming_response_STAR_$fn__53145.invoke(streaming.clj:176)                                                                                     │\r\n│     at clojure.lang.AFn.applyToHelper(AFn.java:156)                                                                                                                                        │\r\n│     at clojure.lang.AFn.applyTo(AFn.java:144)                                                                                                                                              │\r\n│     at clojure.core$apply.invokeStatic(core.clj:667)                                                                                                                                       │\r\n│     at clojure.core$with_bindings_STAR_.invokeStatic(core.clj:1990)                                                                                                                        │\r\n│     at clojure.core$with_bindings_STAR_.doInvoke(core.clj:1990)                                                                                                                            │\r\n│     at clojure.lang.RestFn.applyTo(RestFn.java:142)                                                                                                                                        │\r\n│     at clojure.core$apply.invokeStatic(core.clj:671)                                                                                                                                       │\r\n│     at clojure.core$bound_fn_STAR_$fn__5818.doInvoke(core.clj:2020)                                                                                                                        │\r\n│     at clojure.lang.RestFn.invoke(RestFn.java:421)                                                                                                                                         │\r\n│     at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)                                                                                                │\r\n│     at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)                                                                                                      │\r\n│     at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88)                                                                                          │\r\n│     at clojure.lang.AFn.run(AFn.java:22)                                                                                                                                                   │\r\n│     at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)                                                                                                       │\r\n│     at java.base/java.util.concurrent.FutureTask.run(Unknown Source)                                                                                                                       │\r\n│     at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)                                                                                                         │\r\n│     at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)                                                                                                        │\r\n│     at java.base/java.lang.Thread.run(Unknown Source)                                                                                                                                      │\r\n│ 2024-04-22 08:09:17,320 ERROR async.streaming-response :: Error writing error to output stream {:via [{:type java.lang.NullPointerException, :message Deflater has been closed, :at [java. │\r\n│ java.lang.NullPointerException: Deflater has been closed                                                                                                                                   │\r\n│     at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source)                                                                                                                         │\r\n│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │\r\n│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │\r\n│     at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source)                                                                                                                     │\r\n│     at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source)                                                                                                                  │\r\n│     at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121)                                                                                  │\r\n│     at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source)                                                                                         │\r\n│     at java.base/sun.nio.cs.StreamEncoder.implClose(Unknown Source)                                                                                                                        │\r\n│     at java.base/sun.nio.cs.StreamEncoder.close(Unknown Source)                                                                                                                            │\r\n│     at java.base/java.io.OutputStreamWriter.close(Unknown Source)                                                                                                                          │\r\n│     at java.base/java.io.BufferedWriter.close(Unknown Source)                                                                                                                              │\r\n│     at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:61)                                                                                         │\r\n│     at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46)                                                                                               │\r\n│     at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)                                                                                                │\r\n│     at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)                                                                                                      │\r\n│     at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88)                                                                                          │\r\n│     at clojure.lang.AFn.run(AFn.java:22)                                                                                                                                                   │\r\n│     at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)                                                                                                       │\r\n│     at java.base/java.util.concurrent.FutureTask.run(Unknown Source)                                                                                                                       │\r\n│     at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)                                                                                                         │\r\n│     at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)                                                                                                        │\r\n│     at java.base/java.lang.Thread.run(Unknown Source)                                                                                                                                      │\r\n│ 2024-04-22 08:09:17,321 ERROR async.streaming-response :: bound-fn caught unexpected Exception                                                                                             │\r\n│ java.lang.NullPointerException: Deflater has been closed                                                                                                                                   │\r\n│     at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source)                                                                                                                         │\r\n│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │\r\n│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │\r\n│     at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source)                                                                                                                     │\r\n│     at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source)                                                                                                                  │\r\n│     at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121)                                                                                  │\r\n│     at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source)                                                                                         │\r\n│     at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:58)                                                                                         │\r\n│     at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46)                                                                                               │\r\n│     at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)                                                                                                │\r\n│     at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)                                                                                                      │\r\n│     at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88)                                                                                          │\r\n│     at clojure.lang.AFn.run(AFn.java:22)                                                                                                                                                   │\r\n│     at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)                                                                                                       │\r\n│     at java.base/java.util.concurrent.FutureTask.run(Unknown Source)                                                                                                                       │\r\n│     at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)                                                                                                         │\r\n│     at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)                                                                                                        │\r\n│     at java.base/java.lang.Thread.run(Unknown Source)                                         `', 'created_at': datetime.datetime(2024, 4, 22, 6, 11, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2325179322, 'issue_id': 2232714413, 'author': 'paoliniluis', 'body': '@RaoulBrueckler do you still see this in v50.23?', 'created_at': datetime.datetime(2024, 9, 2, 18, 22, 50, tzinfo=datetime.timezone.utc)}, {'comment_id': 2325192143, 'issue_id': 2232714413, 'author': 'RaoulBrueckler', 'body': 'I will Push a Ticket in pur backlog to test it.\r\n\r\nLuis Paolini ***@***.***> schrieb am Mo. 2. Sept. 2024 um\r\n20:23:\r\n\r\n> @RaoulBrueckler <https://github.com/RaoulBrueckler> do you still see this\r\n> in v50.23?\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/metabase/metabase/issues/41159#issuecomment-2325179322>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AAUSP4TJPCKSAWREJ66IYKTZUSUJBAVCNFSM6AAAAABF5642QGVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDGMRVGE3TSMZSGI>\r\n> .\r\n> You are receiving this because you were mentioned.Message ID:\r\n> ***@***.***>\r\n>', 'created_at': datetime.datetime(2024, 9, 2, 18, 37, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2367682937, 'issue_id': 2232714413, 'author': 'RaoulBrueckler', 'body': '@paoliniluis We checked the version 50.24 and the issue is still there :/ \r\n\r\n[csv-export.log](https://github.com/user-attachments/files/17095332/csv-export.log)', 'created_at': datetime.datetime(2024, 9, 23, 9, 32, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2612927306, 'issue_id': 2232714413, 'author': 'paoliniluis', 'body': '@RaoulBrueckler do you still see this in 52?', 'created_at': datetime.datetime(2025, 1, 24, 16, 28, 32, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-04-10 14:45:35 UTC): @RaoulBrueckler does this happen as well with JSON or CSV? 
How much time does the query take to run?

RaoulBrueckler (Issue Creator) on (2024-04-10 15:32:57 UTC): Yes and the query runs about 22 seconds

Am Mi., 10. Apr. 2024 um 16:45 Uhr schrieb ignacio ***@***.***

ignacio-mb on (2024-04-12 16:49:27 UTC): Can be related to https://github.com/metabase/metabase/issues/40492

ignacio-mb on (2024-04-12 16:51:23 UTC): @RaoulBrueckler Do you have any date fields on the data? Can you share the field types?

RaoulBrueckler (Issue Creator) on (2024-04-16 06:10:35 UTC): Yes there are date fields....

Here ist the Query
`[
        { 
            ""$match"" : { 
                ""created"" : { 
                     ""$gte"" : {{date_from}},
                    ""$lt"" : {{date_to}}
                },
                ""suisseimage_channel_id"": {
                    ""$ne"": null
                },
                ""action"" : ""timeout""
            }
        }, 
        { 
            ""$project"" : { 
                ""_id"" : false, 
                ""distributor_name_100"" : ""Teleboy - Teleboy AG"", 
                ""suissedigital_member_id_101"" : ""5003"", 
                ""swissstream_member_id_102"" : ""teleboy.ch"", 
                ""channel_name_103"" : ""$channel_name"", 
                ""suisseimage_channel_id_104"" : ""$suisseimage_channel_id"", 
                ""adrequest_datetime_utc_205"" : { 
                    ""$replaceAll"" : { 
                        ""input"" : { 
                            ""$dateToString"" : { 
                                ""date"" : { 
                                    ""$toDate"" : ""$created""
                                }, 
                                ""format"" : ""%d/%m/%Y %H:%M:%S""
                            }
                        }, 
                        ""find"" : ""/xxx20"", 
                        ""replacement"" : ""/""
                    }
                }, 
                ""ad_format_206"" : { 
                    ""$switch"" : { 
                        ""branches"" : [
                            { 
                                ""case"" : { 
                                    ""$eq"" : [
                                        ""$type"", 
                                        ""start""
                                    ]
                                }, 
                                ""then"" : ""1""
                            }, 
                            { 
                                ""case"" : { 
                                    ""$eq"" : [
                                        ""$type"", 
                                        ""pause""
                                    ]
                                }, 
                                ""then"" : ""2""
                            }, 
                            { 
                                ""case"" : { 
                                    ""$eq"" : [
                                        ""$type"", 
                                        ""ffwd""
                                    ]
                                }, 
                                ""then"" : ""3""
                            }
                        ], 
                        ""default"" : ""0""
                    }
                }
            }
        },  
        { 
            ""$sort"" : { 
                ""created"" : 1.0
            }
        }
    ]`

And here are the field types
![metabase-export-gt12](https://github.com/metabase/metabase/assets/2697202/d489ab2f-0c1f-4fc1-93e2-9982fff61e31)

ignacio-mb on (2024-04-17 19:50:49 UTC): @RaoulBrueckler and what happens if you remove the date fields (day and created) and try to export?

RaoulBrueckler (Issue Creator) on (2024-04-22 06:11:02 UTC): No it crashes as well.... 

`2024-04-22 08:09:17,319 ERROR async.streaming-response :: Caught unexpected Exception in streaming response body                                                                           │
│ java.lang.NullPointerException: Deflater has been closed                                                                                                                                   │
│     at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source)                                                                                                                         │
│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │
│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │
│     at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source)                                                                                                                     │
│     at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source)                                                                                                                  │
│     at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121)                                                                                  │
│     at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source)                                                                                         │
│     at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:58)                                                                                         │
│     at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46)                                                                                               │
│     at metabase.query_processor.streaming$streaming_response_STAR_$fn__53145.invoke(streaming.clj:176)                                                                                     │
│     at clojure.lang.AFn.applyToHelper(AFn.java:156)                                                                                                                                        │
│     at clojure.lang.AFn.applyTo(AFn.java:144)                                                                                                                                              │
│     at clojure.core$apply.invokeStatic(core.clj:667)                                                                                                                                       │
│     at clojure.core$with_bindings_STAR_.invokeStatic(core.clj:1990)                                                                                                                        │
│     at clojure.core$with_bindings_STAR_.doInvoke(core.clj:1990)                                                                                                                            │
│     at clojure.lang.RestFn.applyTo(RestFn.java:142)                                                                                                                                        │
│     at clojure.core$apply.invokeStatic(core.clj:671)                                                                                                                                       │
│     at clojure.core$bound_fn_STAR_$fn__5818.doInvoke(core.clj:2020)                                                                                                                        │
│     at clojure.lang.RestFn.invoke(RestFn.java:421)                                                                                                                                         │
│     at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)                                                                                                │
│     at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)                                                                                                      │
│     at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88)                                                                                          │
│     at clojure.lang.AFn.run(AFn.java:22)                                                                                                                                                   │
│     at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)                                                                                                       │
│     at java.base/java.util.concurrent.FutureTask.run(Unknown Source)                                                                                                                       │
│     at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)                                                                                                         │
│     at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)                                                                                                        │
│     at java.base/java.lang.Thread.run(Unknown Source)                                                                                                                                      │
│ 2024-04-22 08:09:17,320 ERROR async.streaming-response :: Error writing error to output stream {:via [{:type java.lang.NullPointerException, :message Deflater has been closed, :at [java. │
│ java.lang.NullPointerException: Deflater has been closed                                                                                                                                   │
│     at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source)                                                                                                                         │
│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │
│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │
│     at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source)                                                                                                                     │
│     at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source)                                                                                                                  │
│     at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121)                                                                                  │
│     at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source)                                                                                         │
│     at java.base/sun.nio.cs.StreamEncoder.implClose(Unknown Source)                                                                                                                        │
│     at java.base/sun.nio.cs.StreamEncoder.close(Unknown Source)                                                                                                                            │
│     at java.base/java.io.OutputStreamWriter.close(Unknown Source)                                                                                                                          │
│     at java.base/java.io.BufferedWriter.close(Unknown Source)                                                                                                                              │
│     at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:61)                                                                                         │
│     at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46)                                                                                               │
│     at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)                                                                                                │
│     at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)                                                                                                      │
│     at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88)                                                                                          │
│     at clojure.lang.AFn.run(AFn.java:22)                                                                                                                                                   │
│     at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)                                                                                                       │
│     at java.base/java.util.concurrent.FutureTask.run(Unknown Source)                                                                                                                       │
│     at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)                                                                                                         │
│     at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)                                                                                                        │
│     at java.base/java.lang.Thread.run(Unknown Source)                                                                                                                                      │
│ 2024-04-22 08:09:17,321 ERROR async.streaming-response :: bound-fn caught unexpected Exception                                                                                             │
│ java.lang.NullPointerException: Deflater has been closed                                                                                                                                   │
│     at java.base/java.util.zip.Deflater.ensureOpen(Unknown Source)                                                                                                                         │
│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │
│     at java.base/java.util.zip.Deflater.deflate(Unknown Source)                                                                                                                            │
│     at java.base/java.util.zip.GZIPOutputStream.finish(Unknown Source)                                                                                                                     │
│     at java.base/java.util.zip.DeflaterOutputStream.close(Unknown Source)                                                                                                                  │
│     at metabase.async.streaming_response$delay_output_stream$fn__43771.invoke(streaming_response.clj:121)                                                                                  │
│     at metabase.async.streaming_response.proxy$java.io.OutputStream$ff19274a.close(Unknown Source)                                                                                         │
│     at metabase.async.streaming_response$write_error_BANG_.invokeStatic(streaming_response.clj:58)                                                                                         │
│     at metabase.async.streaming_response$write_error_BANG_.invoke(streaming_response.clj:46)                                                                                               │
│     at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)                                                                                                │
│     at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)                                                                                                      │
│     at metabase.async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88)                                                                                          │
│     at clojure.lang.AFn.run(AFn.java:22)                                                                                                                                                   │
│     at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)                                                                                                       │
│     at java.base/java.util.concurrent.FutureTask.run(Unknown Source)                                                                                                                       │
│     at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)                                                                                                         │
│     at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)                                                                                                        │
│     at java.base/java.lang.Thread.run(Unknown Source)                                         `

paoliniluis on (2024-09-02 18:22:50 UTC): @RaoulBrueckler do you still see this in v50.23?

RaoulBrueckler (Issue Creator) on (2024-09-02 18:37:24 UTC): I will Push a Ticket in pur backlog to test it.

Luis Paolini ***@***.***> schrieb am Mo. 2. Sept. 2024 um
20:23:

RaoulBrueckler (Issue Creator) on (2024-09-23 09:32:13 UTC): @paoliniluis We checked the version 50.24 and the issue is still there :/ 

[csv-export.log](https://github.com/user-attachments/files/17095332/csv-export.log)

paoliniluis on (2025-01-24 16:28:32 UTC): @RaoulBrueckler do you still see this in 52?

"
2232599175,issue,closed,not_planned,"SQL generated for datetime ""is empty"" filter on MSSQL is not correct","### Describe the bug

I upgraded to v0.49.3 and have found a significant issue when using MS SQL Server as a data source.

When setting a question filter on a datetime field to ""is empty"", Metabase is generating incorrect SQL:
![image](https://github.com/metabase/metabase/assets/4504437/e57268fd-51c6-4708-93ed-6483c3f8395c)
Uses this SQL:
![image](https://github.com/metabase/metabase/assets/4504437/8522edb9-b9cf-4375-b91d-b5500eea76d8)

The where clause is:
```sql
WHERE
    ""xxx"".""yyy"".""IssueDate"" = CAST(NULL AS datetime)
```

Equality comparisons should never be used for for NULL, is needs to be `""xxx"".""yyy"".""IssueDate"" = is NULL`.

This is a blocking issue for us, I rolled back as soon as this was found.

### To Reproduce

1. Create a new question on a MSSQL data source table with a datetime field
2. Filter for any datetime fields ""is empty"" (see note in additional context)
3. Visualise, no data will be shown, that's not expected in my case.
4. View the SQL and the, see that it's using `""xxx"".""yyy"".""zzzDate"" = CAST(NULL AS datetime)` for the empty check
5. Convert to SQL, change where clause to  `""xxx"".""yyy"".""IssueDate"" = is NULL`
6. Visualise, data is returned as expected.


### Expected behavior

Correct SQL will be generated, `dateField is NULL` is the way to check for NULLs.

### Logs

Nothing

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-NZ"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""Cp1252"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""17.0.2+8"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""17.0.2"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""17.0.2+8"",
    ""os.name"": ""Windows 10"",
    ""os.version"": ""10.0"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Pacific/Auckland""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres"",
      ""sqlserver""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""12.1""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-02"",
      ""tag"": ""v0.49.3"",
      ""hash"": ""dba0992""
    },
    ""settings"": {
      ""report-timezone"": ""Pacific/Auckland""
    }
  }
}
```


### Severity

Major, we can't use a system that can't find rows with a missing date.

### Additional context


Sample dataset queries are generating the correct SQL so it seems to be MS SQL server specific. I'd guess related to the changes recently to date filtering applying timezones where it wasn't appropriate.

Setting a filter for a date ""is empty"" is harder than it should be. I do these steps:
- filter date field
- Exclude
- Not Empty
![image](https://github.com/metabase/metabase/assets/4504437/9c3a6b38-eb02-4e26-9c5e-2a04265c8e7d)

To me that's cumbersome and non-intuitive",notrom,2024-04-09 04:53:45+00:00,[],2024-08-28 02:10:41+00:00,2024-04-09 06:05:36+00:00,https://github.com/metabase/metabase/issues/41158,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/SQLServer', None), ('Querying/Processor', ''), ('.Team/Querying', '')]","[{'comment_id': 2044210666, 'issue_id': 2232599175, 'author': 'perivamsi', 'body': '@notrom this will be fixed in 49.4 https://github.com/metabase/metabase/pull/40957', 'created_at': datetime.datetime(2024, 4, 9, 6, 4, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2044212629, 'issue_id': 2232599175, 'author': 'perivamsi', 'body': 'Closing as duplicate of https://github.com/metabase/metabase/issues/41005', 'created_at': datetime.datetime(2024, 4, 9, 6, 6, 35, tzinfo=datetime.timezone.utc)}]","perivamsi on (2024-04-09 06:04:54 UTC): @notrom this will be fixed in 49.4 https://github.com/metabase/metabase/pull/40957

perivamsi on (2024-04-09 06:06:35 UTC): Closing as duplicate of https://github.com/metabase/metabase/issues/41005

"
2232461977,issue,open,,field != field filters generate incorrect SQL,"Failing test:

```clj
(deftest ^:parallel field-not-equals-field-test
  (testing ""field != field should work as expected, and account for NULL values""
    (mt/test-drivers (mt/normal-drivers)
      (mt/dataset airports
        (let [query (mt/mbql-query region
                      {:aggregation [[:count]]
                       :filter      [:!= $name $name]})]
          (mt/with-native-query-testing-context query
            (is (= [[0]]
                   (mt/formatted-rows [int]
                     (qp/process-query query))))))))))
```

These compile to SQL like

```sql
SELECT count(*)
FROM region
WHERE x <> y OR x IS NULL -- wrong if y is NULL as well
```

which is wrong if if the RHS of the `!=` is `NULL`... we should probably generate something like 

```sql
SELECT count(*)
FROM region
WHERE x <> y OR (x IS NULL AND y IS NOT NULL)
```

instead, or maybe even `COALESCE` the values.",camsaul,2024-04-09 01:59:13+00:00,[],2025-02-04 20:27:55+00:00,,https://github.com/metabase/metabase/issues/41155,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Processor', ''), ('.Correctness', ''), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2155993653, 'issue_id': 2232461977, 'author': 'janfrederik', 'body': '@camsaul I suppose the behavior of x!=y and y!=x should be the same.  \r\nSo, if not coalescing _both_ values, I suppose your proposal should be symmetrical, as follows\r\n\r\n```\r\nSELECT count(*)\r\nFROM region\r\nWHERE x <> y OR ((x IS NULL) <> (y IS NULL))\r\n```\r\nor\r\n```\r\nSELECT count(*)\r\nFROM region\r\nWHERE x <> y OR (x IS NULL AND y IS NOT NULL) OR (x IS NOT NULL AND y IS NULL)\r\n```', 'created_at': datetime.datetime(2024, 6, 8, 11, 14, 38, tzinfo=datetime.timezone.utc)}]","janfrederik on (2024-06-08 11:14:38 UTC): @camsaul I suppose the behavior of x!=y and y!=x should be the same.  
So, if not coalescing _both_ values, I suppose your proposal should be symmetrical, as follows

```
SELECT count(*)
FROM region
WHERE x <> y OR ((x IS NULL) <> (y IS NULL))
```
or
```
SELECT count(*)
FROM region
WHERE x <> y OR (x IS NULL AND y IS NOT NULL) OR (x IS NOT NULL AND y IS NULL)
```

"
2232456296,issue,open,,field = field filters should match when both fields are `NULL`,"Failing test:

```clj
(deftest ^:parallel field-equals-field-test
  (testing ""field = field should be truthy when both fields are NULL""
    (mt/test-drivers (mt/normal-drivers)
      (mt/dataset airports
        (let [query (mt/mbql-query region
                      {:aggregation [[:count]]
                       :filter      [:= $name $name]})]
          (mt/with-native-query-testing-context query
            (is (= [[415]]
                   (mt/formatted-rows [int]
                     (qp/process-query query))))))))))
```

We're currently generating SQL like

```sql
SELECT count(*)
FROM t
WHERE x = y -- false if X is NULL and Y is NULL
```

which returns falsey if `NAME` is `NULL`, because `NULL` is not equal to `NULL` in SQL. We should consider generating something like 

```sql
SELECT count(*)
FROM t
WHERE x = y OR (x IS NULL AND y IS NULL)
```

",camsaul,2024-04-09 01:51:42+00:00,[],2025-02-04 20:27:56+00:00,,https://github.com/metabase/metabase/issues/41154,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Processor', ''), ('.Correctness', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2232312791,issue,closed,not_planned,"The question mark ""?"" character in the ""?|"" operator is interpreted as prepared statement parameter","### Describe the bug

When using the [`?|` operator](https://www.postgresql.org/docs/9.5/functions-json.html#FUNCTIONS-JSONB-OP-TABLE) in a Postgres query, the Metabase interpreter interprets the `?` in the operator as a prepared statement parameter.

### To Reproduce

1. Go to New SQL Query
2. Enter `select '[""a"",""b"",""c""]'::jsonb ?| array['c','d','e']::text[] where {{var}}  = 'asdf'`
3. Set `var`s Variable ""Default filter widget value"" as `asdf`
4. Hit the `|>` button

### Expected behavior

I'd expect any `?|` operator in the initial query to be preserved after the prepared statement is generated.

Instead, I get the error `No value specified for parameter 2.`

Here is the query preview:
```sql
select '[""a"",""b"",""c""]'::jsonb 'asdf'| array['c','d','e']::text[] where ? = 'asdf'
```
(note the `'asdf'|` in the above query preview - That should be `?|`)

Here's what I'd expect it to be:
```sql
select '[""a"",""b"",""c""]'::jsonb ?| array['c','d','e']::text[] where 'asdf' = 'asdf';
```


### Logs


Admin logs follow:
```[cc6e031f-71e8-4497-98df-5c80fe8cc5eb] 2024-04-08T16:04:06-07:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: No value specified for parameter 2.```

```js
{:database_id 4,
 :started_at #t ""2024-04-08T16:04:06.127859-07:00[US/Pacific]"",
 :via
 [{:status :failed,
   :class clojure.lang.ExceptionInfo,
   :error ""Error executing query: No value specified for parameter 2."",
   :stacktrace
   [""--> driver.sql_jdbc.execute$execute_reducible_query$fn__79250$fn__79251.invoke(execute.clj:701)""
    ""driver.sql_jdbc.execute$execute_reducible_query$fn__79250.invoke(execute.clj:698)""
    ""driver.sql_jdbc.execute$fn__79043$fn__79044.invoke(execute.clj:388)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:317)""
    ""driver.sql_jdbc.execute$fn__79043.invokeStatic(execute.clj:382)""
    ""driver.sql_jdbc.execute$fn__79043.invoke(execute.clj:380)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:692)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:689)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
    ""driver.sql_jdbc$fn__106638.invokeStatic(sql_jdbc.clj:78)""
    ""driver.sql_jdbc$fn__106638.invoke(sql_jdbc.clj:76)""
    ""query_processor.context$executef.invokeStatic(context.clj:60)""
    ""query_processor.context$executef.invoke(context.clj:49)""
    ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
    ""query_processor.context.default$default_runf.invoke(default.clj:42)""
    ""query_processor.context$runf.invokeStatic(context.clj:46)""
    ""query_processor.context$runf.invoke(context.clj:40)""
    ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
    ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72138.invoke(cache.clj:229)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__66516.invoke(permissions.clj:140)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__71959.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__71969.invoke(enterprise.clj:64)""
    ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71401.invoke(mbql_to_native.clj:24)""
    ""query_processor$fn__73306$combined_post_process__73311$combined_post_process_STAR___73312.invoke(query_processor.clj:262)""
    ""query_processor$fn__73306$combined_pre_process__73307$combined_pre_process_STAR___73308.invoke(query_processor.clj:259)""
    ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66613.invoke(fetch_source_query.clj:303)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72049$fn__72053.invoke(resolve_database_and_driver.clj:77)""
    ""driver$do_with_driver.invokeStatic(driver.clj:97)""
    ""driver$do_with_driver.invoke(driver.clj:92)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72049.invoke(resolve_database_and_driver.clj:76)""
    ""query_processor.middleware.store$initialize_store$fn__67219$fn__67220.invoke(store.clj:14)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
    ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
    ""query_processor.middleware.store$initialize_store$fn__67219.invoke(store.clj:13)""
    ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72046.invoke(resolve_database_and_driver.clj:60)""
    ""query_processor.middleware.normalize_query$normalize$fn__72351.invoke(normalize_query.clj:38)""
    ""query_processor.middleware.enterprise$fn__71986$handle_audit_app_internal_queries__71987$fn__71989.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__71997.invoke(enterprise.clj:103)""
    ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71112.invoke(constraints.clj:104)""
    ""query_processor.middleware.process_userland_query$process_userland_query$fn__72282.invoke(process_userland_query.clj:156)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72883.invoke(catch_exceptions.clj:171)""
    ""query_processor.reducible$async_qp$qp_STAR___62758$thunk__62760.invoke(reducible.clj:126)""
    ""query_processor.reducible$async_qp$qp_STAR___62758.invoke(reducible.clj:132)""
    ""query_processor.reducible$sync_qp$qp_STAR___62770.doInvoke(reducible.clj:153)""
    ""query_processor$process_userland_query.invokeStatic(query_processor.clj:402)""
    ""query_processor$process_userland_query.doInvoke(query_processor.clj:398)""
    ""query_processor$process_query_and_save_execution_BANG_.invokeStatic(query_processor.clj:416)""
    ""query_processor$process_query_and_save_execution_BANG_.invoke(query_processor.clj:406)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invokeStatic(query_processor.clj:431)""
    ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invoke(query_processor.clj:421)""
    ""api.dataset$run_query_async$fn__93841.invoke(dataset.clj:79)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53188$fn__53190.invoke(streaming.clj:168)""
    ""query_processor.streaming$streaming_response_STAR_$fn__53188.invoke(streaming.clj:167)""
    ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)""
    ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)""
    ""async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88)""],
   :error_type :invalid-query,
   :ex-data
   {:driver :postgres,
    :sql
    [""-- Metabase:: userID: REDACTED queryType: native queryHash: 7868f8dd211e1e48f15967e9a9ebf0d87d22a98babd6274e1da28038319f4ad9""
     ""select""
     ""  '[\""a\"",\""b\"",\""c\""]' :: jsonb ? | array [ 'c',""
     ""  'd',""
     ""  'e' ] :: text [ ]""
     ""where""
     ""  ? = 'asdf'""],
    :params [""asdf""],
    :type :invalid-query}}],
 :action_id nil,
 :state ""22023"",
 :error_type :invalid-query,
 :json_query
 {:type ""native"",
  :database 4,
  :native
  {:query ""select '[\""a\"",\""b\"",\""c\""]'::jsonb ?| array['c','d','e']::text[]\nwhere {{variable}} = 'asdf'"",
   :template-tags
   {:variable
    {:type ""text"",
     :name ""variable"",
     :id ""40defe9d-77af-498a-9a8a-d830f7f7e568"",
     :display-name ""Variable"",
     :default ""asdf""}}},
  :parameters
  [{:id ""40defe9d-77af-498a-9a8a-d830f7f7e568"",
    :type ""category"",
    :value [""asdf""],
    :target [""variable"" [""template-tag"" ""variable""]]}],
  :middleware {:js-int-to-string? true, :add-default-userland-constraints? true}},
 :status :failed,
 :class org.postgresql.util.PSQLException,
 :stacktrace
 [""org.postgresql.core.v3.SimpleParameterList.checkAllParametersSet(SimpleParameterList.java:346)""
  ""org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:355)""
  ""org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)""
  ""org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)""
  ""org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)""
  ""org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:137)""
  ""com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:1471)""
  ""--> driver.sql_jdbc.execute$fn__79167.invokeStatic(execute.clj:556)""
  ""driver.sql_jdbc.execute$fn__79167.invoke(execute.clj:554)""
  ""driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invokeStatic(execute.clj:569)""
  ""driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invoke(execute.clj:565)""
  ""driver.sql_jdbc.execute$execute_reducible_query$fn__79250$fn__79251.invoke(execute.clj:699)""
  ""driver.sql_jdbc.execute$execute_reducible_query$fn__79250.invoke(execute.clj:698)""
  ""driver.sql_jdbc.execute$fn__79043$fn__79044.invoke(execute.clj:388)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:334)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:317)""
  ""driver.sql_jdbc.execute$fn__79043.invokeStatic(execute.clj:382)""
  ""driver.sql_jdbc.execute$fn__79043.invoke(execute.clj:380)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:692)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:689)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:678)""
  ""driver.sql_jdbc$fn__106638.invokeStatic(sql_jdbc.clj:78)""
  ""driver.sql_jdbc$fn__106638.invoke(sql_jdbc.clj:76)""
  ""query_processor.context$executef.invokeStatic(context.clj:60)""
  ""query_processor.context$executef.invoke(context.clj:49)""
  ""query_processor.context.default$default_runf.invokeStatic(default.clj:44)""
  ""query_processor.context.default$default_runf.invoke(default.clj:42)""
  ""query_processor.context$runf.invokeStatic(context.clj:46)""
  ""query_processor.context$runf.invoke(context.clj:40)""
  ""query_processor.reducible$identity_qp.invokeStatic(reducible.clj:39)""
  ""query_processor.reducible$identity_qp.invoke(reducible.clj:36)""
  ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___72138.invoke(cache.clj:229)""
  ""query_processor.middleware.permissions$check_query_permissions$fn__66516.invoke(permissions.clj:140)""
  ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__71959.invoke(enterprise.clj:51)""
  ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__71969.invoke(enterprise.clj:64)""
  ""query_processor.middleware.mbql_to_native$mbql__GT_native$fn__71401.invoke(mbql_to_native.clj:24)""
  ""query_processor$fn__73306$combined_post_process__73311$combined_post_process_STAR___73312.invoke(query_processor.clj:262)""
  ""query_processor$fn__73306$combined_pre_process__73307$combined_pre_process_STAR___73308.invoke(query_processor.clj:259)""
  ""query_processor.middleware.fetch_source_query$resolve_card_id_source_tables$fn__66613.invoke(fetch_source_query.clj:303)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72049$fn__72053.invoke(resolve_database_and_driver.clj:77)""
  ""driver$do_with_driver.invokeStatic(driver.clj:97)""
  ""driver$do_with_driver.invoke(driver.clj:92)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_driver_and_database_local_values$fn__72049.invoke(resolve_database_and_driver.clj:76)""
  ""query_processor.middleware.store$initialize_store$fn__67219$fn__67220.invoke(store.clj:14)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:169)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.store$do_with_metadata_provider.invokeStatic(store.clj:158)""
  ""query_processor.store$do_with_metadata_provider.invoke(store.clj:150)""
  ""query_processor.middleware.store$initialize_store$fn__67219.invoke(store.clj:13)""
  ""query_processor.middleware.resolve_database_and_driver$resolve_database$fn__72046.invoke(resolve_database_and_driver.clj:60)""
  ""query_processor.middleware.normalize_query$normalize$fn__72351.invoke(normalize_query.clj:38)""
  ""query_processor.middleware.enterprise$fn__71986$handle_audit_app_internal_queries__71987$fn__71989.invoke(enterprise.clj:96)""
  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__71997.invoke(enterprise.clj:103)""
  ""query_processor.middleware.constraints$mark_needs_default_userland_constraints$fn__71112.invoke(constraints.clj:104)""
  ""query_processor.middleware.process_userland_query$process_userland_query$fn__72282.invoke(process_userland_query.clj:156)""
  ""query_processor.middleware.catch_exceptions$catch_exceptions$fn__72883.invoke(catch_exceptions.clj:171)""
  ""query_processor.reducible$async_qp$qp_STAR___62758$thunk__62760.invoke(reducible.clj:126)""
  ""query_processor.reducible$async_qp$qp_STAR___62758.invoke(reducible.clj:132)""
  ""query_processor.reducible$sync_qp$qp_STAR___62770.doInvoke(reducible.clj:153)""
  ""query_processor$process_userland_query.invokeStatic(query_processor.clj:402)""
  ""query_processor$process_userland_query.doInvoke(query_processor.clj:398)""
  ""query_processor$process_query_and_save_execution_BANG_.invokeStatic(query_processor.clj:416)""
  ""query_processor$process_query_and_save_execution_BANG_.invoke(query_processor.clj:406)""
  ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invokeStatic(query_processor.clj:431)""
  ""query_processor$process_query_and_save_with_max_results_constraints_BANG_.invoke(query_processor.clj:421)""
  ""api.dataset$run_query_async$fn__93841.invoke(dataset.clj:79)""
  ""query_processor.streaming$streaming_response_STAR_$fn__53188$fn__53190.invoke(streaming.clj:168)""
  ""query_processor.streaming$streaming_response_STAR_$fn__53188.invoke(streaming.clj:167)""
  ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:69)""
  ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:67)""
  ""async.streaming_response$do_f_async$task__43756.invoke(streaming_response.clj:88)""],
 :card_id nil,
 :context :ad-hoc,
 :error ""No value specified for parameter 2."",
 :row_count 0,
 :running_time 0,
 :data {:rows [], :cols []}}
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.209-198.812.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""US/Pacific""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""redshift""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""11.22""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-02"",
      ""tag"": ""v0.49.3"",
      ""hash"": ""dba0992""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

annoying

### Additional context

I'm using `??|` to escape the question mark in the operator for now.",anoakie,2024-04-08 23:30:43+00:00,[],2024-07-01 22:52:51+00:00,2024-07-01 22:52:37+00:00,https://github.com/metabase/metabase/issues/41151,"[('Priority:P2', 'Average run of the mill bug'), ('Database/Postgres', None), ('Querying/Processor', ''), ('.Limitation', '')]","[{'comment_id': 2047794008, 'issue_id': 2232312791, 'author': 'ignacio-mb', 'body': 'Related to https://github.com/metabase/metabase/issues/34402', 'created_at': datetime.datetime(2024, 4, 10, 15, 0, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2201300700, 'issue_id': 2232312791, 'author': 'camsaul', 'body': 'This is a limitation, since `?` in JDBC is interpreted as a parameter placeholder you have to escape Postgres JSON operators and use `??` instead; in this case you need to use `??|` instead of `?|`.\r\n\r\nDuplicate of #1964', 'created_at': datetime.datetime(2024, 7, 1, 22, 52, 37, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-04-10 15:00:29 UTC): Related to https://github.com/metabase/metabase/issues/34402

camsaul on (2024-07-01 22:52:37 UTC): This is a limitation, since `?` in JDBC is interpreted as a parameter placeholder you have to escape Postgres JSON operators and use `??` instead; in this case you need to use `??|` instead of `?|`.

Duplicate of #1964

"
2232137740,issue,closed,completed,[dc.js migration] x-axis ticks auto rotation is not working on histograms,"https://metaboat.slack.com/archives/C05NQSWPRMK/p1712610606860229
https://metaboat.slack.com/archives/C06G94JTWBS/p1712762397818089",alxnddr,2024-04-08 21:48:12+00:00,['alxnddr'],2024-04-25 19:51:27+00:00,2024-04-25 19:51:27+00:00,https://github.com/metabase/metabase/issues/41148,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.echarts-regression', 'Issues in the echarts feature branch that were not broken in the previous dc.js implementation')]",[],
2231920673,issue,closed,completed,Rework filter settings sidebar to mantine,,uladzimirdev,2024-04-08 19:16:28+00:00,['uladzimirdev'],2024-04-11 09:37:24+00:00,2024-04-11 09:37:24+00:00,https://github.com/metabase/metabase/issues/41140,[],[],
2231545657,issue,closed,completed,Visual regression: too many items are getting a separator,"### Describe the bug

Too much items are getting a separator in the data picker.

<img width=""371"" alt=""Screenshot 2024-04-08 at 17 39 06"" src=""https://github.com/metabase/metabase/assets/1250185/3b564cd5-35f5-4cfa-a57c-cff5ed6ccb7c"">


### To Reproduce

1. Go to New Question → Sample Database
2. see that each table has a separator

### Expected behavior

Only the ""Raw Data"" section should have a separator.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:124.0) Gecko/20100101 Firefox/124.0"",
    ""vendor"": """"
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.20.1+1"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.20.1"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.20.1+1"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.2.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Amsterdam""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    },
    ""run-mode"": ""dev"",
    ""version"": {
      ""date"": ""2024-04-05"",
      ""src_hash"": ""f9fce33f8986a6a70a225d9d717c63573bd7db12"",
      ""tag"": ""v0.48.1-SNAPSHOT"",
      ""hash"": ""69e4661""
    },
    ""settings"": {
      ""report-timezone"": null
    }
  }
}
```


### Severity

P3

### Additional context

_No response_",romeovs,2024-04-08 15:40:23+00:00,['romeovs'],2024-04-09 16:43:15+00:00,2024-04-09 16:43:14+00:00,https://github.com/metabase/metabase/issues/41136,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]",[],
2231463882,issue,closed,completed,Object detail view is not scrollable at narrow screen widths,"### Describe the bug

Object detail view cannot be scrolled at narrow screen breakpoint

### To Reproduce

- open any object detail view with enough content to scroll
- make your window narrow
- try to scroll

![objectDetailscroll](https://github.com/metabase/metabase/assets/30528226/683fa936-698d-460d-973b-574bcbd50882)




### Expected behavior

overflow should always be scrollable

### Logs

_No response_

### Information about your Metabase installation

```JSON
master - 177a70ef78
```


### Severity

P3

### Additional context

_No response_",iethree,2024-04-08 15:02:54+00:00,['alxnddr'],2024-07-09 19:34:33+00:00,2024-07-09 18:57:03+00:00,https://github.com/metabase/metabase/issues/41133,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Difficulty:Easy', ''), ('Visualization/Detail', 'ObjectDetail'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2231194328,issue,open,,Template Dashboard,"**Is your feature request related to a problem? Please describe.**
It's common for us in our data team, to build a dashboard from an existing template, or just creating multiple copies of a dashboard to change some filters. 

**Describe the solution you'd like**
It would be awesome to have a single dashboard where changes are made, and then the copies (child dashboards) are just updated with the changes from the parent dashboard. It also would be cool to break this parent-child relationship is the child needs to be customized. 

**How important is this feature to you?**
It would be a great feature to save us time replicating changes in multiple dashboards.
",subzet,2024-04-08 13:13:29+00:00,[],2024-06-28 12:54:14+00:00,,https://github.com/metabase/metabase/issues/41128,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('Organization/', '')]","[{'comment_id': 2047804608, 'issue_id': 2231194328, 'author': 'ignacio-mb', 'body': 'Related to https://github.com/metabase/metabase/issues/39227', 'created_at': datetime.datetime(2024, 4, 10, 15, 4, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2168234706, 'issue_id': 2231194328, 'author': 'ThomasGoodvest', 'body': ""I have a similar need: we share the same dashboard for different partners (via public link), we need them to see only the data relevant to them (and prevent them from changing filters). Currently, we make copies of the same dashboard, and apply a simple filter in each SQL query in the board (around 20 queries). Its really annoying, and maintaining about 20 dashboards is painful: if we need to change some wording we have to do it on each individual board. I can't see myself managing this this way if we reach 50 or 100 partners."", 'created_at': datetime.datetime(2024, 6, 14, 15, 5, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2196397412, 'issue_id': 2231194328, 'author': 'TheRJMB', 'body': 'This is vital for us as we use Metabase to service 30+ clients, which means currently we have 30+ dashboards that need updating individually when a change is made.\r\n\r\nAn alternative/additional idea would be that a question/widget that can be applied across multiple dashboards where, except maybe for the DB attached, any other changes would be reflected wherever that widget is used.', 'created_at': datetime.datetime(2024, 6, 28, 8, 25, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2196841273, 'issue_id': 2231194328, 'author': 'wukimidaire', 'body': 'Upvote, experiencing the same pains as mentioned.', 'created_at': datetime.datetime(2024, 6, 28, 12, 54, 13, tzinfo=datetime.timezone.utc)}]","ignacio-mb on (2024-04-10 15:04:26 UTC): Related to https://github.com/metabase/metabase/issues/39227

ThomasGoodvest on (2024-06-14 15:05:30 UTC): I have a similar need: we share the same dashboard for different partners (via public link), we need them to see only the data relevant to them (and prevent them from changing filters). Currently, we make copies of the same dashboard, and apply a simple filter in each SQL query in the board (around 20 queries). Its really annoying, and maintaining about 20 dashboards is painful: if we need to change some wording we have to do it on each individual board. I can't see myself managing this this way if we reach 50 or 100 partners.

TheRJMB on (2024-06-28 08:25:37 UTC): This is vital for us as we use Metabase to service 30+ clients, which means currently we have 30+ dashboards that need updating individually when a change is made.

An alternative/additional idea would be that a question/widget that can be applied across multiple dashboards where, except maybe for the DB attached, any other changes would be reflected wherever that widget is used.

wukimidaire on (2024-06-28 12:54:13 UTC): Upvote, experiencing the same pains as mentioned.

"
2231163978,issue,open,,An expand option for cards within a dashbaord,"**Is your feature request related to a problem? Please describe.**
Currently the only way to enlarge a card is by clicking the card and it will take you to the actual question. There is no option to enlarge/expand the card within a dashbaord

**Describe the solution you'd like**
A top left corner icon in which you can click and the card will expand without taking you out of the dashbaord

<img width=""610"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/2be53bf1-1c39-44c0-b574-3cb895c9720b"">

**Describe alternatives you've considered**
None only clicking the card is the current option",Tony-metabase,2024-04-08 13:00:56+00:00,[],2024-04-08 13:00:56+00:00,,https://github.com/metabase/metabase/issues/41127,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('.Frontend', ''), ('Reporting/Dashboards/Click Behavior', '')]",[],
2231075522,issue,closed,completed,Migration to transfer *.cache_ttl fields to cache_config,,darksciencebase,2024-04-08 12:30:47+00:00,['piranha'],2024-04-18 10:03:10+00:00,2024-04-18 10:03:10+00:00,https://github.com/metabase/metabase/issues/41126,"[('.Backend', ''), ('Querying/Cache', ''), ('.Team/Workflows', 'aka BEC')]",[],
2231070617,issue,open,,Do not execute identical queries when cache is on the way,,darksciencebase,2024-04-08 12:28:51+00:00,[],2024-04-08 14:23:29+00:00,,https://github.com/metabase/metabase/issues/41125,"[('Type:Tech Debt', 'or Refactoring'), ('.Backend', ''), ('Querying/Cache', '')]","[{'comment_id': 2042622716, 'issue_id': 2231070617, 'author': 'darksciencebase', 'body': 'Leaving this for later as a potential optimization', 'created_at': datetime.datetime(2024, 4, 8, 12, 29, 51, tzinfo=datetime.timezone.utc)}]","darksciencebase (Issue Creator) on (2024-04-08 12:29:51 UTC): Leaving this for later as a potential optimization

"
2231028195,issue,closed,completed,Casting integer to Datatime via Table Metadata makes column unusable ,"### Describe the bug

Casting integer to Datatime via Table Metadata makes column unusable  ... The lack of logs or error in console makes this absolutely insane to debug

### To Reproduce

1. Go to Admin -> Table Metadata -> Sample DB -> Orders -> Set Product_ID to Creation Date

<img width=""1510"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/61793350-8711-45ab-acb8-4a57caccb3af"">

2. Then edit setting and cast it to DateTime

<img width=""1223"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/3399dc9b-2cd5-4797-98fd-8363e09cd2f5"">

3. Go to the orders table via the GUI and notice that the product ID turned into a Date (I know it doesn't make sense in this case but it's the easiest replication path)

<img width=""1364"" alt=""image"" src=""https://github.com/metabase/metabase/assets/110378427/acba9f51-8018-4b2e-8225-73131cd7dc76"">

4. Now try to filter on the Product_ID

https://github.com/metabase/metabase/assets/110378427/61c7746e-945a-427b-be46-8f77d55dbfc9





### Expected behavior

The filtering needs to work and even though it kind of works it's not visible in the GUI

### Logs

None

### Information about your Metabase installation

```JSON
Works on 48 but breaks on any 49 release
```


### Severity

This will break the GUI functionality for anyone casting epoch times to Date

### Additional context

Left the needs triage since i have no clue if its a backend or frontend issue since there are no logs anywhere",Tony-metabase,2024-04-08 12:09:18+00:00,['bshepherdson'],2024-08-28 02:10:40+00:00,2024-04-09 17:42:29+00:00,https://github.com/metabase/metabase/issues/41122,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.metabase-lib', 'Label for tracking all issues related to the shared CLJC metabase-lib'), ('.Escalation', ''), ('.Team/Querying', '')]","[{'comment_id': 2042617417, 'issue_id': 2231028195, 'author': 'bshepherdson', 'body': ""This is very likely an MLv2 issue, rejecting the badly typed filter.\r\n\r\nI'll look into it."", 'created_at': datetime.datetime(2024, 4, 8, 12, 27, 10, tzinfo=datetime.timezone.utc)}]","bshepherdson (Assginee) on (2024-04-08 12:27:10 UTC): This is very likely an MLv2 issue, rejecting the badly typed filter.

I'll look into it.

"
2230860648,issue,closed,completed,Add Danish Language Support,"Many thanks to our Danish community translators! [Danish language translation](https://poeditor.com/projects/po_edit?id_language=39&per_page=20&id=200535) is nearly complete, so we can add it in an upcoming Metabase release.


",iethree,2024-04-08 10:42:53+00:00,['iethree'],2024-06-06 17:30:07+00:00,2024-06-06 17:30:07+00:00,https://github.com/metabase/metabase/issues/41120,"[('Customization/i18n', '')]",[],
2230736698,issue,closed,completed,Put Cache Upsell component on OSS page,,iethree,2024-04-08 09:42:41+00:00,[],2024-10-08 17:09:42+00:00,2024-05-31 16:30:59+00:00,https://github.com/metabase/metabase/issues/41119,[],"[{'comment_id': 2042311045, 'issue_id': 2230736698, 'author': 'iethree', 'body': 'see: https://github.com/metabase/metabase/issues/41116', 'created_at': datetime.datetime(2024, 4, 8, 9, 43, 24, tzinfo=datetime.timezone.utc)}]","iethree (Issue Creator) on (2024-04-08 09:43:24 UTC): see: https://github.com/metabase/metabase/issues/41116

"
2230669639,issue,closed,completed,Endpoint to delete uploaded tables,"This adds two new routes:

- GET `/api/ee/upload-management/tables` (lists all the uploaded tables)
- DELETE `/api/ee/upload-management/tables/:id` (deletes the given uploaded table, has an option to archive cards)

This first route replaces `/api/tables/uploaded`, a provisional route which had not been released.",crisptrutski,2024-04-08 09:10:45+00:00,['crisptrutski'],2024-08-21 21:21:30+00:00,2024-04-17 18:36:00+00:00,https://github.com/metabase/metabase/issues/41118,"[('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2303033968, 'issue_id': 2230669639, 'author': 'addison-grant', 'body': 'Is there any plan to release this to Open Source?', 'created_at': datetime.datetime(2024, 8, 21, 21, 21, 5, tzinfo=datetime.timezone.utc)}]","addison-grant on (2024-08-21 21:21:05 UTC): Is there any plan to release this to Open Source?

"
2230648453,issue,closed,completed,[Epic] In-Product Upsells (part 1),"**Links**
- [product doc](https://www.notion.so/metabase/Upsells-System-4d198833c10d4f89a2ddfe407b2ef026)
- [another product doc](https://www.notion.so/metabase/Implement-upsell-system-part-1-1f01945a71b845c4870ac1b37ec93632?pm=c)
- [design doc](https://www.notion.so/metabase/Upsell-System-Guidelines-WIP-72ce6f7402fb4c93a165e904dcf7a93c)
- [eng doc](https://www.notion.so/metabase/Upsells-Engineering-Plan-32229bdbaaf84e59be135e5af9227f42)
- [figma designs](https://www.figma.com/file/kdZZogH2tWBVwnG03N7XXc/Upsell-System?type=design&node-id=232-4979&mode=design&t=URjxcPyUA9YXCG8H-0)
- [slack discussion](https://metaboat.slack.com/archives/C064EB1UE5P/p1711980324110339)


```[tasklist]
### Preliminary: Generic/Reusable Components
- [x] Wrapper HoC to control when components appear
- [x] Create Generic Upsell Badge
- [x] Create Generic Upsell Card
- [x] Implement UTM linking/tracking
- [x] add plan info to UTM
- [ ] https://github.com/metabase/metabase/issues/42802
- [ ] Add hoverGem component
- [x] Remove `utm_` from the `source_plan` parameter
```

```[tasklist]
### Specific Upsell Components
- [ ] https://github.com/metabase/metabase/issues/42706
- [ ] https://github.com/metabase/metabase/issues/42708
- [ ] https://github.com/metabase/metabase/issues/42707
- [ ] https://github.com/metabase/metabase/issues/42713
- [ ] https://github.com/metabase/metabase/issues/42828
```

",iethree,2024-04-08 09:00:44+00:00,['iethree'],2024-06-13 16:35:13+00:00,2024-06-13 16:35:12+00:00,https://github.com/metabase/metabase/issues/41116,"[('.Frontend', ''), ('.Epic', 'Feature Implementation or Project'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2166179702, 'issue_id': 2230648453, 'author': 'luizarakaki', 'body': 'Closing this epic as the work expected for part 1 is done.\nFollowing work will be done in [#42846](https://github.com/metabase/metabase/issues/42846)', 'created_at': datetime.datetime(2024, 6, 13, 16, 35, 12, tzinfo=datetime.timezone.utc)}]","luizarakaki on (2024-06-13 16:35:12 UTC): Closing this epic as the work expected for part 1 is done.
Following work will be done in [#42846](https://github.com/metabase/metabase/issues/42846)

"
2230634921,issue,closed,completed,[ParseSQL] Catch mutation commands,,tsmacdonald,2024-04-08 08:54:10+00:00,['tsmacdonald'],2024-04-30 09:24:00+00:00,2024-04-09 09:30:59+00:00,https://github.com/metabase/metabase/issues/41115,"[('.Team/Workflows', 'aka BEC'), ('Querying/Native/Parser', '')]",[],
2230556761,issue,closed,completed,Endpoint to list uploaded tables,,crisptrutski,2024-04-08 08:15:48+00:00,['crisptrutski'],2024-04-16 15:11:34+00:00,2024-04-08 11:45:42+00:00,https://github.com/metabase/metabase/issues/41114,"[('.Team/Workflows', 'aka BEC')]",[],
2230139997,issue,closed,completed,The pie chart cannot display the details of Other correctly,"### Describe the bug

![image](https://github.com/metabase/metabase/assets/7403734/39cd5871-1a73-48a3-8f25-37ad2a1039c1)
After updating to 0.49.3，The pie chart cannot display the details of Other correctly

### To Reproduce

The Other of each pie chart is the same

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
version: 0.49.3
```


### Severity

blocking an upgrade 

### Additional context

_No response_",LampStudy,2024-04-08 02:42:19+00:00,[],2024-05-29 15:04:28+00:00,2024-05-29 01:40:00+00:00,https://github.com/metabase/metabase/issues/41113,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2099055076, 'issue_id': 2230139997, 'author': 'jsantana3c', 'body': 'I\'m having the same problem.\r\n\r\n```\r\n\r\n{\r\n  ""browser-info"": {\r\n    ""language"": ""it-IT"",\r\n    ""platform"": ""Win32"",\r\n    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",\r\n    ""vendor"": ""Google Inc.""\r\n  },\r\n  ""system-info"": {\r\n    ""file.encoding"": ""UTF-8"",\r\n    ""java.runtime.name"": ""OpenJDK Runtime Environment"",\r\n    ""java.runtime.version"": ""11.0.23+9"",\r\n    ""java.vendor"": ""Eclipse Adoptium"",\r\n    ""java.vendor.url"": ""https://adoptium.net/"",\r\n    ""java.version"": ""11.0.23"",\r\n    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",\r\n    ""java.vm.version"": ""11.0.23+9"",\r\n    ""os.name"": ""Linux"",\r\n    ""os.version"": ""5.15.146.1-microsoft-standard-WSL2"",\r\n    ""user.language"": ""en"",\r\n    ""user.timezone"": ""GMT""\r\n  },\r\n  ""metabase-info"": {\r\n    ""databases"": [\r\n      ""oracle""\r\n    ],\r\n    ""hosting-env"": ""unknown"",\r\n    ""application-database"": ""postgres"",\r\n    ""application-database-details"": {\r\n      ""database"": {\r\n        ""name"": ""PostgreSQL"",\r\n        ""version"": ""16.2 (Debian 16.2-1.pgdg120+2)""\r\n      },\r\n      ""jdbc-driver"": {\r\n        ""name"": ""PostgreSQL JDBC Driver"",\r\n        ""version"": ""42.7.2""\r\n      }\r\n    },\r\n    ""run-mode"": ""prod"",\r\n    ""version"": {\r\n      ""date"": ""2024-05-02"",\r\n      ""tag"": ""v0.49.8"",\r\n      ""hash"": ""38cb850""\r\n    },\r\n    ""settings"": {\r\n      ""report-timezone"": ""Europe/Rome""\r\n    }\r\n  }\r\n}\r\n```', 'created_at': datetime.datetime(2024, 5, 7, 18, 28, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2136363152, 'issue_id': 2230139997, 'author': 'alxnddr', 'body': 'Duplicate of https://github.com/metabase/metabase/issues/42458\nFixed in 0.49.10', 'created_at': datetime.datetime(2024, 5, 29, 1, 40, tzinfo=datetime.timezone.utc)}]","jsantana3c on (2024-05-07 18:28:43 UTC): I'm having the same problem.

```

{
  ""browser-info"": {
    ""language"": ""it-IT"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.146.1-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  },
  ""metabase-info"": {
    ""databases"": [
      ""oracle""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.2 (Debian 16.2-1.pgdg120+2)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-05-02"",
      ""tag"": ""v0.49.8"",
      ""hash"": ""38cb850""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Rome""
    }
  }
}
```

alxnddr on (2024-05-29 01:40:00 UTC): Duplicate of https://github.com/metabase/metabase/issues/42458
Fixed in 0.49.10

"
2230066700,issue,closed,not_planned,"Browser title changes to ""e=>e?l.t'Waiting for results...'"" while data is being fetched","### Describe the bug

Updated to v0.49.3 and now getting strange browser window title while the data is fetched.
![image](https://github.com/metabase/metabase/assets/4504437/15e54426-5e14-4595-8a01-94b9fc1da0be)

It resolves when the query completes and data is returned

### To Reproduce

1. Start a new question, Sample Database > Orders
2. To make a slightly slow query join Orders a few times (4 worked for me)
3. Visualize the question
4. The browser title changes to ""e=>e?l.t`Waiting for restults...`""
5. Once the query completes the title changes to the expected wording


### Expected behavior

No strange content that looks like code in the window title

### Logs

Nothing of note.

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-NZ"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""system-info"": {
    ""file.encoding"": ""Cp1252"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""17.0.2+8"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""17.0.2"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""17.0.2+8"",
    ""os.name"": ""Windows Server 2012 R2"",
    ""os.version"": ""6.3"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Pacific/Auckland""
  },
  ""metabase-info"": {
    ""databases"": [
      ""sqlserver"",
      ""postgres"",
      ""h2""
    ],
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""10.5""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.2""
      }
    },
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2024-04-02"",
      ""tag"": ""v0.49.3"",
      ""hash"": ""dba0992""
    },
    ""settings"": {
      ""report-timezone"": ""Pacific/Auckland""
    }
  }
}
```


### Severity

Minor, just looks strange for a short time.

### Additional context

Same for Firefox browser. Same behaviour for saved and ad-hoc questions.",notrom,2024-04-08 01:14:38+00:00,[],2024-04-08 06:05:14+00:00,2024-04-08 04:28:09+00:00,https://github.com/metabase/metabase/issues/41112,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2041840369, 'issue_id': 2230066700, 'author': 'qnkhuat', 'body': 'Duplicated of https://github.com/metabase/metabase/issues/40051. The fix will be included in 49.4', 'created_at': datetime.datetime(2024, 4, 8, 4, 28, 9, tzinfo=datetime.timezone.utc)}]","qnkhuat on (2024-04-08 04:28:09 UTC): Duplicated of https://github.com/metabase/metabase/issues/40051. The fix will be included in 49.4

"
2228922491,issue,open,,CSV uploads support for Oracle,"**Is your feature request related to a problem? Please describe.**
Allow users to upload CSV files when connecting Oracle Database.

**Describe the solution you'd like**
Support CSV uploads for Oracle. 

**Describe alternatives you've considered**
None

**How important is this feature to you?**
Requested by a potential customer

**Additional context**
N/A
",dahyeik,2024-04-05 23:03:23+00:00,[],2024-04-05 23:03:23+00:00,,https://github.com/metabase/metabase/issues/41110,"[('Type:New Feature', ''), ('Database/Oracle', None), ('Organization/Uploads', 'Direct data upload (CSV)')]",[],
2228719290,issue,closed,not_planned,empty filter for a date field is creating invalid SQL,"### Describe the bug

On a table using the sql builder I added a filter to only display rows where a date column is null and ended up with SQL that looked like this.   A value can never equal null in Sql server.  (https://stackoverflow.com/a/12108091/30850)

Below is the Sql output

SELECT
  ""dbo"".""FulfillmentInfo"".""PromotionType"" AS ""PromotionType"",
  COUNT(*) AS ""count""
FROM
  ""dbo"".""FulfillmentInfo""
WHERE
  (""dbo"".""FulfillmentInfo"".""CitySparkFulfilled"" = 1)
 
   AND (
    ""dbo"".""FulfillmentInfo"".""fulfillDate"" = CAST(NULL AS datetime)
  )
GROUP BY
  ""dbo"".""FulfillmentInfo"".""PromotionType""
ORDER BY
  ""dbo"".""FulfillmentInfo"".""PromotionType"" ASC

### To Reproduce

1. Ask a new question of a table that contains a date column
2. Add a filter for that column
3. Select Exclude from the date options
4. Select Is Not empty
5. End up with a Column is empty filter
6. Click View SQL to see invalid SQL


### Expected behavior

It should  create a Column IS NULL statement as opposed to a = CAST(NULL AS DATETIME) statement

### Logs

_No response_

### Information about your Metabase installation

```JSON
metabase:latest from docker
```


### Severity

Blocks the abilty to check if DateTime values are null

### Additional context

This is running against SQL Server, there could be some SQL dialect that understands the statement but it's probably not valid for most all SQL implementations",runxc1,2024-04-05 19:57:33+00:00,[],2024-04-05 20:05:03+00:00,2024-04-05 20:05:02+00:00,https://github.com/metabase/metabase/issues/41105,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2040548504, 'issue_id': 2228719290, 'author': 'paoliniluis', 'body': 'We fixed that a few days ago (should be in 49.3 or 49.4), so closing', 'created_at': datetime.datetime(2024, 4, 5, 20, 5, 3, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-05 20:05:03 UTC): We fixed that a few days ago (should be in 49.3 or 49.4), so closing

"
2228493580,issue,closed,completed,[Mega Epic] Embedding SDK,"**Links**
- product doc: https://www.notion.so/metabase/Embedding-ccadeca5900e44428b2ed87f96a1beb1
- eng doc: https://www.notion.so/metabase/Embedding-SDK-Roadmap-02d1fba72171455bb3496d7d996cd302


**Implementation Plan**

***Milestone 1 – PoC***

```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/issues/39115
```


***Milestone 2 – Technical foundation***

```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/issues/40241
- [ ] https://github.com/metabase/metabase/issues/38811
- [ ] https://github.com/metabase/metabase/pull/40975
```

***Milestone 3 – Single question w/ drill-down***

```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/pull/41106
- [ ] https://github.com/metabase/metabase/pull/41560
- [ ] https://github.com/metabase/metabase/pull/41860
- [ ] Fixup `window.history` usages in QueryVisualization component
```

",deniskaber,2024-04-05 17:23:37+00:00,[],2024-06-06 14:44:40+00:00,2024-06-06 14:44:40+00:00,https://github.com/metabase/metabase/issues/41095,"[('.Epic', 'Feature Implementation or Project')]",[],
2228486887,issue,closed,completed,Make driver respect database level `:json-unfolding`,Current implementation does not respect database wide `:json-unfolding` setting. Find out why and resolve.,lbrdnk,2024-04-05 17:18:30+00:00,[],2024-04-10 19:15:35+00:00,2024-04-10 19:15:35+00:00,https://github.com/metabase/metabase/issues/41094,[],"[{'comment_id': 2048270042, 'issue_id': 2228486887, 'author': 'lbrdnk', 'body': ""Fixed in [abfb13b](https://github.com/metabase/metabase/commit/abfb13bd8419e8695b2dd28e47fc0664eacb0b18). `driver/database-supports?` was made dynamic to conform sync code requirements. That's considered tech debt and tracked by #41216."", 'created_at': datetime.datetime(2024, 4, 10, 19, 15, 35, tzinfo=datetime.timezone.utc)}]","lbrdnk (Issue Creator) on (2024-04-10 19:15:35 UTC): Fixed in [abfb13b](https://github.com/metabase/metabase/commit/abfb13bd8419e8695b2dd28e47fc0664eacb0b18). `driver/database-supports?` was made dynamic to conform sync code requirements. That's considered tech debt and tracked by #41216.

"
2228276039,issue,closed,completed,Add logging when something fails at Query Editor level ,"**Is your feature request related to a problem? Please describe.**
Sometimes a custom expression, might now work or simply is not supported by a driver and instead of outputting some kind of error the column simply vanishes. I don't have a specific replication step but a customer is currently experiencing this and I have no way of troubleshooting

**Describe the solution you'd like**
That behaviour on the frontend gets logged in the console. Currently nothing happens:


https://github.com/metabase/metabase/assets/110378427/d96c1e83-8fd3-437a-b0ec-9d7f27e18047


**Describe alternatives you've considered**
Nothing is available to debug this

",Tony-metabase,2024-04-05 15:14:01+00:00,[],2024-06-10 19:40:47+00:00,2024-06-10 19:39:48+00:00,https://github.com/metabase/metabase/issues/41090,"[('Priority:P2', 'Average run of the mill bug'), ('Type:New Feature', ''), ('.Frontend', ''), ('.metabase-lib', 'Label for tracking all issues related to the shared CLJC metabase-lib')]","[{'comment_id': 2142978268, 'issue_id': 2228276039, 'author': 'metamben', 'body': ""@Tony-metabase, can we get more information about the data involved in the scenario in the description? What type of DW is used, what type is `created_on`, do all filters disappear or just this one or just the ones using this column?\r\nI'm asking because looking at the code I couldn't find where we would swallow an error without logging."", 'created_at': datetime.datetime(2024, 5, 31, 21, 6, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2144576375, 'issue_id': 2228276039, 'author': 'Tony-metabase', 'body': ""@metamben the issue there was generated by this bug, you could repicate it via the Sample Database (you need verison lower than 49.4)\r\n\r\nhttps://github.com/metabase/metabase/issues/41122\r\n\r\nThe point is that errors like this shouldn't fail in such a manner"", 'created_at': datetime.datetime(2024, 6, 3, 8, 20, 11, tzinfo=datetime.timezone.utc)}]","metamben on (2024-05-31 21:06:48 UTC): @Tony-metabase, can we get more information about the data involved in the scenario in the description? What type of DW is used, what type is `created_on`, do all filters disappear or just this one or just the ones using this column?
I'm asking because looking at the code I couldn't find where we would swallow an error without logging.

Tony-metabase (Issue Creator) on (2024-06-03 08:20:11 UTC): @metamben the issue there was generated by this bug, you could repicate it via the Sample Database (you need verison lower than 49.4)

https://github.com/metabase/metabase/issues/41122

The point is that errors like this shouldn't fail in such a manner

"
2228050687,issue,closed,completed,Make search surface columns when I’m working on joined tables,"[Product doc](https://www.notion.so/metabase/Make-search-surface-columns-when-I-m-working-on-joined-tables-bc79b831564a4db2a646ab7a70b86580)

### Goal
Make searching on joined data in filters etc. more usable by surfacing column names as well.

- [ ] Update `AccordionList` to allow searching of all sections at once
- [ ] Keep supporting the previous usecases of AccordionList",romeovs,2024-04-05 13:32:14+00:00,['romeovs'],2024-04-08 15:38:08+00:00,2024-04-08 13:59:05+00:00,https://github.com/metabase/metabase/issues/41085,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2228047875,issue,closed,completed,[E2E] Fix flaky `visualizations-tabular/object_detail.cy.spec.js`,"It's been flaking a lot lately. [See this on stats.](https://stats.metabase.com/question?objectId=962b69ff6840f2a3d3e731c3ae73b34e#eyJuYW1lIjoiVGVzdCBGbGFraW5lc3MiLCJkZXNjcmlwdGlvbiI6IkZsYWtleSB0ZXN0cyBmb3IgTWV0YWJhc2UgZnJvbSB3b3JrZmxvdyBqb2JzIHBlciB0ZXN0L2pvYi9ydW4vYnJhbmNoL2NvbW1pdC4gVXBkYXRlZCBkYWlseS4iLCJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoyNiwidHlwZSI6InF1ZXJ5IiwicXVlcnkiOnsic291cmNlLXRhYmxlIjoiY2FyZF9fMTQ4MjgiLCJmaWx0ZXIiOlsiPSIsWyJmaWVsZCIsInN1aXRlX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJzY2VuYXJpb3MgPiBxdWVzdGlvbiA-IG9iamVjdCBkZXRhaWxzIl19fSwiZGlzcGxheSI6InRhYmxlIiwicGFyYW1ldGVycyI6W10sInZpc3VhbGl6YXRpb25fc2V0dGluZ3MiOnsidGFibGUucGl2b3RfY29sdW1uIjoicmVwb3NpdG9yeSIsInRhYmxlLmNlbGxfY29sdW1uIjoidGVzdHMifSwib3JpZ2luYWxfY2FyZF9pZCI6MTQ4Mjh9)

[Example flake on `master`](https://github.com/metabase/metabase/actions/runs/8569495315/job/23486979803#step:11:616)",WiNloSt,2024-04-05 13:31:08+00:00,['WiNloSt'],2024-04-10 07:20:24+00:00,2024-04-10 07:20:24+00:00,https://github.com/metabase/metabase/issues/41084,"[('.CI & Tests', ''), ('flaky-test-fix', '')]","[{'comment_id': 2040070843, 'issue_id': 2228047875, 'author': 'WiNloSt', 'body': ""I [attempted to fix this](https://github.com/metabase/metabase/pull/41086), but it didn't seem to be easy."", 'created_at': datetime.datetime(2024, 4, 5, 15, 19, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2046699954, 'issue_id': 2228047875, 'author': 'WiNloSt', 'body': 'Fixed by https://github.com/metabase/metabase/pull/41096', 'created_at': datetime.datetime(2024, 4, 10, 7, 20, 19, tzinfo=datetime.timezone.utc)}]","WiNloSt (Issue Creator) on (2024-04-05 15:19:03 UTC): I [attempted to fix this](https://github.com/metabase/metabase/pull/41086), but it didn't seem to be easy.

WiNloSt (Issue Creator) on (2024-04-10 07:20:19 UTC): Fixed by https://github.com/metabase/metabase/pull/41096

"
2227857761,issue,closed,completed,Migrate global css in `frontend/src/metabase/css/components/modal.module.css`,"```[tasklist]
### Tasks
- [ ] https://github.com/metabase/metabase/pull/41091
```
",WiNloSt,2024-04-05 11:56:38+00:00,['WiNloSt'],2024-04-10 08:06:24+00:00,2024-04-10 08:06:23+00:00,https://github.com/metabase/metabase/issues/41077,[],[],
2227521778,issue,closed,completed,[E2E] Fix flaky `onboarding/command-palette.cy.spec.js`,"[Stats](https://stats.metabase.com/question?objectId=6cd383cd46f9cf965cba7b9f5557356a#eyJuYW1lIjoiVGVzdCBGbGFraW5lc3MiLCJkZXNjcmlwdGlvbiI6IkZsYWtleSB0ZXN0cyBmb3IgTWV0YWJhc2UgZnJvbSB3b3JrZmxvdyBqb2JzIHBlciB0ZXN0L2pvYi9ydW4vYnJhbmNoL2NvbW1pdC4gVXBkYXRlZCBkYWlseS4iLCJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjoyNiwidHlwZSI6InF1ZXJ5IiwicXVlcnkiOnsic291cmNlLXRhYmxlIjoiY2FyZF9fMTQ4MjgiLCJmaWx0ZXIiOlsiPSIsWyJmaWVsZCIsInN1aXRlX25hbWUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJjb21tYW5kIHBhbGV0dGUiXX19LCJkaXNwbGF5IjoidGFibGUiLCJwYXJhbWV0ZXJzIjpbXSwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6eyJ0YWJsZS5waXZvdF9jb2x1bW4iOiJyZXBvc2l0b3J5IiwidGFibGUuY2VsbF9jb2x1bW4iOiJ0ZXN0cyJ9LCJvcmlnaW5hbF9jYXJkX2lkIjoxNDgyOH0=)
[GH action run](https://github.com/metabase/metabase/actions/runs/8556716908/job/23447686936?pr=41030#step:13:236)

I'm not sure why some runs aren't included in the first stat link, like the example GH Action run I included here.
",WiNloSt,2024-04-05 09:35:50+00:00,['WiNloSt'],2024-04-05 12:05:54+00:00,2024-04-05 12:05:54+00:00,https://github.com/metabase/metabase/issues/41072,"[('.CI & Tests', ''), ('.Frontend', ''), ('flaky-test-fix', '')]",[],
2227484035,issue,closed,completed,Dashboards are broken,"### Describe the bug

https://github.com/metabase/metabase/assets/6830683/4a10c7e8-68ec-4d4e-bc44-deb709c56318

### To Reproduce

1. Create a new dashboard
2. Add a question to it
3. Save the dashboard
4. Refresh the page
5. See the error


### Expected behavior

Page does not crash


### Information about your Metabase installation

master, 199e069

Also reproducible in stats


### Severity

P1
",kamilmielnik,2024-04-05 09:22:57+00:00,['ranquild'],2024-04-05 15:30:35+00:00,2024-04-05 15:30:22+00:00,https://github.com/metabase/metabase/issues/41071,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Regression/master', 'Regression that is only present on master, or bug in new upcoming feature'), ('.Team/Querying', '')]","[{'comment_id': 2039340962, 'issue_id': 2227484035, 'author': 'kamilmielnik', 'body': ""[`queryFromTableOrCardMetadata`](https://github.com/metabase/metabase/blob/448a4f3dcaa80681a8154966b12235f217b6f2f4/frontend/src/metabase-lib/v1/Question.ts#L447) fails with\r\n\r\n```\r\nUncaught Error: No method in multimethod 'metabase.lib.query/query-method' for dispatch value: :dispatch-type/nil\r\n    at Object.cljs$core$throw_no_method_error [as throw_no_method_error] (app-main.hot.bundle.js:487039:8)\r\n    at Object.cljs$core$IFn$_invoke$arity$2 (app-main.hot.bundle.js:487199:11)\r\n    at Function.metabase$lib$query$query (app-main.hot.bundle.js:611222:40)\r\n    at Function.cljs$core$IFn$_invoke$arity$4 (app-main.hot.bundle.js:463502:10)\r\n    at Function.cljs$core$IFn$_invoke$arity$3 (app-main.hot.bundle.js:463493:34)\r\n    at Function.cljs$core$IFn$_invoke$arity$2 (app-main.hot.bundle.js:463481:34)\r\n    at Function.cljs$core$IFn$_invoke$arity$2 (app-main.hot.bundle.js:463763:34)\r\n    at Function.metabase$lib$core$query__delegate [as cljs$core$IFn$_invoke$arity$variadic] (app-main.hot.bundle.js:586661:24)\r\n    at Function.cljs$core$IFn$_invoke$arity$2 (app-main.hot.bundle.js:603043:32)\r\n    at Object.metabase$lib$js$query (app-main.hot.bundle.js:603028:30)\r\n```\r\n\r\nBecause [`table` is `null`](https://github.com/metabase/metabase/blob/448a4f3dcaa80681a8154966b12235f217b6f2f4/frontend/src/metabase-lib/v1/Question.ts#L446), due to table not being present in the metadata."", 'created_at': datetime.datetime(2024, 4, 5, 9, 38, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2039371182, 'issue_id': 2227484035, 'author': 'kamilmielnik', 'body': 'Broken by #40181', 'created_at': datetime.datetime(2024, 4, 5, 9, 51, 50, tzinfo=datetime.timezone.utc)}]","kamilmielnik (Issue Creator) on (2024-04-05 09:38:01 UTC): [`queryFromTableOrCardMetadata`](https://github.com/metabase/metabase/blob/448a4f3dcaa80681a8154966b12235f217b6f2f4/frontend/src/metabase-lib/v1/Question.ts#L447) fails with

```
Uncaught Error: No method in multimethod 'metabase.lib.query/query-method' for dispatch value: :dispatch-type/nil
    at Object.cljs$core$throw_no_method_error [as throw_no_method_error] (app-main.hot.bundle.js:487039:8)
    at Object.cljs$core$IFn$_invoke$arity$2 (app-main.hot.bundle.js:487199:11)
    at Function.metabase$lib$query$query (app-main.hot.bundle.js:611222:40)
    at Function.cljs$core$IFn$_invoke$arity$4 (app-main.hot.bundle.js:463502:10)
    at Function.cljs$core$IFn$_invoke$arity$3 (app-main.hot.bundle.js:463493:34)
    at Function.cljs$core$IFn$_invoke$arity$2 (app-main.hot.bundle.js:463481:34)
    at Function.cljs$core$IFn$_invoke$arity$2 (app-main.hot.bundle.js:463763:34)
    at Function.metabase$lib$core$query__delegate [as cljs$core$IFn$_invoke$arity$variadic] (app-main.hot.bundle.js:586661:24)
    at Function.cljs$core$IFn$_invoke$arity$2 (app-main.hot.bundle.js:603043:32)
    at Object.metabase$lib$js$query (app-main.hot.bundle.js:603028:30)
```

Because [`table` is `null`](https://github.com/metabase/metabase/blob/448a4f3dcaa80681a8154966b12235f217b6f2f4/frontend/src/metabase-lib/v1/Question.ts#L446), due to table not being present in the metadata.

kamilmielnik (Issue Creator) on (2024-04-05 09:51:50 UTC): Broken by #40181

"
2227457232,issue,closed,completed,Copy question link from dashboard,"**Context**
- product doc: https://www.notion.so/metabase/Copy-question-link-from-dashboard-702fe6ec9c874f12bb2cda19dbbf6f47

Allow copying the question link address from the dashboard",kamilmielnik,2024-04-05 09:09:53+00:00,['kamilmielnik'],2024-06-11 10:39:47+00:00,2024-06-11 10:39:47+00:00,https://github.com/metabase/metabase/issues/41070,"[('.Frontend', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Querying', '')]","[{'comment_id': 2150560336, 'issue_id': 2227457232, 'author': 'bshepherdson', 'body': 'Reopening per #43499 .', 'created_at': datetime.datetime(2024, 6, 5, 17, 11, 14, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2024-06-05 17:11:14 UTC): Reopening per #43499 .

"
2226596613,issue,open,,A way to convert seconds to minutes with the UI,"**Is your feature request related to a problem? Please describe.**
You might have a column that has seconds and you want to know the minutes, but you don't know SQL or you just want to do it fast :)
For example, you have a column seconds_field that has the values `140` and `60`, you want to convert them to `2:20` and `1:00`

**Describe the solution you'd like**
A way to format an integer field from seconds to minutes.

**Describe alternatives you've considered**
Doing SQL like

```
SELECT
CONCAT(FLOOR(second_field / 60), ':', LPAD(CAST(MOD(second_field, 60) AS TEXT), 2, '0')) AS formatted_time
FROM
seconds_model;
```

**How important is this feature to you?**
Requested by a customer, internal ticket [26236](https://metabase.zendesk.com/agent/tickets/26236)

**Additional context**
N/A
",ignacio-mb,2024-04-04 22:02:36+00:00,[],2024-04-04 22:02:37+00:00,,https://github.com/metabase/metabase/issues/41062,"[('Type:New Feature', ''), ('Visualization/Chart Settings', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations')]",[],
2226554447,issue,closed,completed,Pie chart disappears once you add filter,"### Describe the bug

If you create a new question, switch the visualization type to a pie chart, add a new filter to the pie chart, and then click 'visualize', the pie chart will disappear and you'll only see the legend on the side. Refreshing the chart won't resolve the issue; it only reappears when you resize the window.

Context: https://metaboat.slack.com/archives/C01LQQ2UW03/p1712261043955499

### To Reproduce

1. Create a question
2. Change the viz type to pie chart
3. Hit the editor button
4. Add an additional filter
5. Hit visualize
See pie chart disappear

### Expected behavior

It should just work - without resizing windows. 

### Logs

_No response_

### Information about your Metabase installation

```JSON
stats
```


### Severity

  P3

### Additional context

_No response_",dahyeik,2024-04-04 21:31:07+00:00,[],2024-05-17 15:25:35+00:00,2024-05-17 15:25:34+00:00,https://github.com/metabase/metabase/issues/41059,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Visualization/Charts/Pie', ''), ('.echarts-scope', 'Issues related to chart types that have already been or will be migrated to echarts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2117843562, 'issue_id': 2226554447, 'author': 'alxnddr', 'body': 'Closed by https://github.com/metabase/metabase/pull/42430', 'created_at': datetime.datetime(2024, 5, 17, 15, 25, 34, tzinfo=datetime.timezone.utc)}]","alxnddr on (2024-05-17 15:25:34 UTC): Closed by https://github.com/metabase/metabase/pull/42430

"
2226537834,issue,closed,completed,Preserve the notebook native preview sidebar state and width as a user setting,"The decision has been made internally to save the notebook native preview sidebar user preferences to the backend, as a user-local setting. These preferences include:
1. sidebar state (shown/hidden)
2. last known sidebar width

The relevant section of the tech doc: https://www.notion.so/metabase/Tech-Show-generated-SQL-in-a-side-bar-automatically-febee0259d2d40e294a06d2f4930122e?pvs=4#02be04b83bb144528f88a2491662a779",nemanjaglumac,2024-04-04 21:19:44+00:00,['nemanjaglumac'],2024-04-08 18:41:45+00:00,2024-04-08 18:41:45+00:00,https://github.com/metabase/metabase/issues/41058,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Querying', '')]","[{'comment_id': 2043430123, 'issue_id': 2226537834, 'author': 'nemanjaglumac', 'body': 'Implemented in https://github.com/metabase/metabase/pull/41064', 'created_at': datetime.datetime(2024, 4, 8, 18, 41, 45, tzinfo=datetime.timezone.utc)}]","nemanjaglumac (Issue Creator) on (2024-04-08 18:41:45 UTC): Implemented in https://github.com/metabase/metabase/pull/41064

"
2226459115,issue,open,,Map filters don't show valid values in some cases,"### Describe the bug

On the Pin Map Visualization I have over a thousand pins all over the world so in order to see the details you have to use the ""draw box to filter"" functionality to get proper pins with details.

If you select a box in the australia area you get a bogus latitude/longitude area.   

### To Reproduce

1. Go to Pin Map visualization of the world
2. Click on Draw box to filter
3. Select an area in Australia and get a result that looks like the following
4. latitude is between -15.948376882697627 and -9.788770636626007 and longitude is between -234.51114320954838 and -221.0616648849495
5. Observe that longitude is less than -180 which is the lowest the scale should go
6.  A Valid lat,long in australia as an example is -12.46, 130.84

7. See error as no results


### Expected behavior

It should show the area selected 

### Logs

NA

### Information about your Metabase installation

```JSON
docker metabase:latests
```


### Severity

blocking adoption in an organization

### Additional context

Probably a simple math error due to only testing in the US and Europe.  Probably should add additional data points to the Sample data.",runxc1,2024-04-04 20:34:56+00:00,['appleby'],2025-02-04 20:31:55+00:00,,https://github.com/metabase/metabase/issues/41056,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/MBQL', ''), ('Difficulty:Easy', ''), ('.Backend', ''), ('Visualization/Maps', ''), ('.Team/Querying', '')]","[{'comment_id': 2039614368, 'issue_id': 2226459115, 'author': 'paoliniluis', 'body': ""Hi, I just tested and got the correct lat lon\r\n![image](https://github.com/metabase/metabase/assets/1711649/9064327c-8220-45c6-81b1-6a9518860337)\r\n\r\ncan you upload a video so we can see what you're hitting?"", 'created_at': datetime.datetime(2024, 4, 5, 11, 56, 21, tzinfo=datetime.timezone.utc)}, {'comment_id': 2040177735, 'issue_id': 2226459115, 'author': 'runxc1', 'body': 'Here is a video,  I just created a visualization off of the Sample data.\r\n\r\nhttps://screenrec.com/share/igTGbjw5xh', 'created_at': datetime.datetime(2024, 4, 5, 16, 5, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2047858681, 'issue_id': 2226459115, 'author': 'ignacio-mb', 'body': '@runxc1 Can you provide some sample data for Australia so we can reproduce your error?', 'created_at': datetime.datetime(2024, 4, 10, 15, 27, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2197501636, 'issue_id': 2226459115, 'author': 'ranquild', 'body': 'I\'m not 100% sure if this is it but here is my attempt to reproduce the issue.\r\n\r\n1. Create a SQL query:\r\n```\r\nSELECT 1 AS COUNT, -30 AS LATITUDE, 179 AS LONGITUDE\r\nUNION ALL\r\nSELECT 1 AS COUNT, -30 AS LATITUDE, -179 AS LONGITUDE\r\n```\r\n\r\n2. Visualize as Pin map\r\n3. See that `-179` and `179` are on the different sides of the map\r\n<img width=""1728"" alt=""Screenshot 2024-06-28 at 15 19 57"" src=""https://github.com/metabase/metabase/assets/8542534/b238605d-9d0c-411a-9311-c6f9d24bf5d7"">\r\n\r\n4. Draw a box to filter the values. Each time it works based on what you see on this map, e.g. you only get values for one of the sides without correct semantics:\r\n<img width=""1174"" alt=""Screenshot 2024-06-28 at 15 19 45"" src=""https://github.com/metabase/metabase/assets/8542534/f8d6b54e-8a05-4629-8b7a-607c6c5ba03a"">\r\n<img width=""1728"" alt=""Screenshot 2024-06-28 at 15 20 12"" src=""https://github.com/metabase/metabase/assets/8542534/54b23006-07a4-4a35-849d-6d022f0703eb"">\r\n\r\nFilters with longitude outside of `-180,180` range prove this. I think what we might want to do instead is to flip values less than `-180` to `180` and wise versa. If this makes sense, then `Lib.updateLatLonFilter` MBQL lib function could be updated to hide this complexity; most likely 2 filters instead of 1 need to be created for these cases.\r\n\r\n<img width=""1606"" alt=""Screenshot 2024-06-28 at 15 09 22"" src=""https://github.com/metabase/metabase/assets/8542534/517d1d03-b45c-40d4-b65d-78da07d9beaa"">', 'created_at': datetime.datetime(2024, 6, 28, 19, 25, 17, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2024-04-05 11:56:21 UTC): Hi, I just tested and got the correct lat lon
![image](https://github.com/metabase/metabase/assets/1711649/9064327c-8220-45c6-81b1-6a9518860337)

can you upload a video so we can see what you're hitting?

runxc1 (Issue Creator) on (2024-04-05 16:05:52 UTC): Here is a video,  I just created a visualization off of the Sample data.

https://screenrec.com/share/igTGbjw5xh

ignacio-mb on (2024-04-10 15:27:39 UTC): @runxc1 Can you provide some sample data for Australia so we can reproduce your error?

ranquild on (2024-06-28 19:25:17 UTC): I'm not 100% sure if this is it but here is my attempt to reproduce the issue.

1. Create a SQL query:
```
SELECT 1 AS COUNT, -30 AS LATITUDE, 179 AS LONGITUDE
UNION ALL
SELECT 1 AS COUNT, -30 AS LATITUDE, -179 AS LONGITUDE
```

2. Visualize as Pin map
3. See that `-179` and `179` are on the different sides of the map
<img width=""1728"" alt=""Screenshot 2024-06-28 at 15 19 57"" src=""https://github.com/metabase/metabase/assets/8542534/b238605d-9d0c-411a-9311-c6f9d24bf5d7"">

4. Draw a box to filter the values. Each time it works based on what you see on this map, e.g. you only get values for one of the sides without correct semantics:
<img width=""1174"" alt=""Screenshot 2024-06-28 at 15 19 45"" src=""https://github.com/metabase/metabase/assets/8542534/f8d6b54e-8a05-4629-8b7a-607c6c5ba03a"">
<img width=""1728"" alt=""Screenshot 2024-06-28 at 15 20 12"" src=""https://github.com/metabase/metabase/assets/8542534/54b23006-07a4-4a35-849d-6d022f0703eb"">

Filters with longitude outside of `-180,180` range prove this. I think what we might want to do instead is to flip values less than `-180` to `180` and wise versa. If this makes sense, then `Lib.updateLatLonFilter` MBQL lib function could be updated to hide this complexity; most likely 2 filters instead of 1 need to be created for these cases.

<img width=""1606"" alt=""Screenshot 2024-06-28 at 15 09 22"" src=""https://github.com/metabase/metabase/assets/8542534/517d1d03-b45c-40d4-b65d-78da07d9beaa"">

"
2226388076,issue,closed,completed,`lib.convert/->legacy-mbql` incorrectly generates `:aggregation-options` clauses in `:expressions` if they contain certain options,"This can lead to broken queries, since `:aggregation-options` is not allowed inside `:expressions` in the legacy MBQL schema.

```clj
(let [query (-> (lib/query meta/metadata-provider (meta/table-metadata :orders))
                (lib/breakout (meta/field-metadata :orders :created-at))
                (lib/expression ""expr"" (lib.options/update-options (lib/+ 1 2) assoc :name ""my_expr"", :base-type :type/Number)))]
  (lib.convert/->legacy-MBQL query))
;; =>
{:database 26001,          
 :type :query,
 :query
 {:source-table 26060,
  :breakout [[:field 26606 {:base-type :type/DateTimeWithLocalTZ}]],
  :expressions {""expr"" [:aggregation-options [:+ 1 2] {:base-type :type/Number}]}}}
```",camsaul,2024-04-04 19:51:41+00:00,['camsaul'],2024-04-08 23:36:12+00:00,2024-04-08 21:41:55+00:00,https://github.com/metabase/metabase/issues/41053,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Processor', ''), ('.Backend', ''), ('.metabase-lib', 'Label for tracking all issues related to the shared CLJC metabase-lib')]",[],
