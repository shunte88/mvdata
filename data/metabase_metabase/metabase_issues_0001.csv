id,type,state,state_reason,title,body,author,created_at,assignees,updated_at,closed_at,url,labels,comments_list,comment_thread
2840343460,issue,open,,Link Checker Report,,github-actions[bot],2025-02-09 00:19:49+00:00,['jeff-bruemmer'],2025-02-09 00:19:50+00:00,,https://github.com/metabase/metabase/issues/53430,"[('Type:Documentation', '')]",[],
2839962409,issue,closed,not_planned,502 Bad Gateway after upgrade 0.52.9 to 0.53.1,"### Describe the bug

After upgrading 0.52.9 to 0.53.1 following these [instructions](https://www.metabase.com/docs/latest/installation-and-operation/running-metabase-on-debian), I get 502 errors. The nginx only tells me that the connection is refused.
Previous upgrades did work without issues and I didn't change anything configure wise. 
Reverting to  0.52.9  makes it work again


### To Reproduce

Follow these [instructions](https://www.metabase.com/docs/latest/installation-and-operation/upgrading-metabase)

### Expected behavior

Upgrade should work fine.

### Logs

_No response_

### Information about your Metabase installation

```JSON
As I can't run 0.53.1 here's the one for 0.52.9
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:135.0) Gecko/20100101 Firefox/135.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""mysql""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-31"",
      ""tag"": ""v0.52.9"",
      ""hash"": ""f9fbbf8""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MariaDB"",
        ""version"": ""10.6.21-MariaDB-ubu2004""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.26+4-post-Ubuntu-1ubuntu120.04"",
    ""java.vendor"": ""Ubuntu"",
    ""java.vendor.url"": ""https://ubuntu.com/"",
    ""java.version"": ""11.0.26"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.26+4-post-Ubuntu-1ubuntu120.04"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.4.0-204-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Berlin""
  }
}
```

### Severity

blocks the upgrade

### Additional context

_No response_",searchjaunt,2025-02-08 13:08:28+00:00,[],2025-02-08 15:22:36+00:00,2025-02-08 15:22:35+00:00,https://github.com/metabase/metabase/issues/53429,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2645729538, 'issue_id': 2839962409, 'author': 'paoliniluis', 'body': 'Please upgrade to Java 21', 'created_at': datetime.datetime(2025, 2, 8, 14, 11, 46, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-02-08 14:11:46 UTC): Please upgrade to Java 21

"
2839718723,issue,open,,feature request for custom expression doy - day of the year,"**Feature Request: Implement ""doy"" (Day of the Year) in Custom Expressions**

**Objective:**
Introduce support for ""doy"" (day of the year) in custom expressions to allow analyzing relative trends over periods other than months, such as quarters. This feature would align with the existing support for ""day"" and enhance data flexibility.

**Technical Details:**
We propose adding ""doy"" within custom expressions through SQL, allowing users to perform calculations like:

```custom expression
between(doy([Created At]), 1, doy(now))
```

```sql
CAST(
  extract(
    doy from
    CAST(""source"".""created_at"" AS timestamp)
  ) AS integer
) BETWEEN 1 AND CAST(
  extract(
    doy from
    NOW()
  ) AS integer
)
```
Its the very same of actual `day`, but with `doy` keyword instead.",michelegirini,2025-02-08 08:44:43+00:00,[],2025-02-08 08:56:04+00:00,,https://github.com/metabase/metabase/issues/53428,"[('Type:New Feature', ''), ('.Needs Triage', '')]",[],
2839439475,issue,closed,completed,Java 21 JRE from Eclipse Temurin with NSSM manager,"### Describe the bug

Not a Metabase issue but I think it might help others who runs a similar setup as mine.

Metabase 0.53 requires Java 21 now, official document suggest using Java 21 JRE from Eclipse Temurin.
I run metabase open source version as a service using a batch file with **NSSM** manager, after 0.53 update, it simply refuse to work. After some investigations it turns out I need to escape using extra ""\\"" in the batch file, so the bat now looks like:

`C:\\""Program Files""\\""Eclipse Adoptium""\\""jdk-21.0.6.7-hotspot""\\bin\java.exe -jar metabase.jar`

Otherwise it throw an java class not found exception.

### To Reproduce

N/A

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Metabase 0.53.1
```

### Severity

Mild

### Additional context

Feel free to closed the issue, as it is not metabase specific related, thank you.",ojjj13,2025-02-08 03:15:16+00:00,[],2025-02-08 03:15:37+00:00,2025-02-08 03:15:37+00:00,https://github.com/metabase/metabase/issues/53423,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]",[],
2839097367,issue,open,,Should not offer to save metric referencing itself,"### Describe the bug

Saving a metric that refers to itself in Formula results in failure without explanation.

The failure is actually due to cycle detection on the backend. The backend reports a 400 response with an error message. This error message could be used to inform the user of the trouble.

Old description:

> As per [this](https://metaboat.slack.com/archives/C0645JP1W81/p1737375866253629) slack thread, editing a metric definition could result in  metric referencing itself saved in the application database. 


### To Reproduce


1. Create new metric.
2. Save.
3. Edit that metric's aggregation. Set it to custom aggregation. Reference the metric being updated.
4. Click save.
5. Notice the failure in the Save button.
6. Notice the 400 error message in the Network tab of the Dev Tools. Notice the error message in the response.

### Expected behavior

a. Ideally, FE should not provide metric references in custom aggregation expression to metrics that depend on it including itself. 
b. Frontend should disable save button when cycles can be detected.
c. Frontend should detect 400 error and report error message from backend.

### Logs

_No response_

### Information about your Metabase installation

```JSON
0c5c608e6fccf8e649ba44b5e8caffef9c5a50d8
```

### Severity

P2

### Additional context

This is the frontend portion of #52385. That backend one is being fixed.

#53373 adds a new function `metadata.lib.query/check-overwrite` which can be added to `Lib` and used to detect cycles on the frontend when enough metadata is available to fully expand the whole dependency graph. That might make it hard to reproduce, depending on how the card is created.

Regardless, the backend is protecting cards with cycles from being saved, so the frontend should catch the error and display it to the user.",ericnormand,2025-02-07 21:11:38+00:00,[],2025-02-07 21:11:38+00:00,,https://github.com/metabase/metabase/issues/53407,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]",[],
2839085350,issue,open,,Error 401 Latitude/Longitude Endpoint on public question/dashboard,"### Describe the bug

Hi,

When making a map public using a public question or public dashboard, none of the Pins show up.

For example:

What I see when I go to the Question normally:

<img width=""1415"" alt=""Image"" src=""https://github.com/user-attachments/assets/5ab9a8f8-99a1-4f3e-9b64-54acd45f4231"" />

What I see when I got to the public URL:
<img width=""1428"" alt=""Image"" src=""https://github.com/user-attachments/assets/2bb960a3-a6b9-49a0-90a2-a592f1bd5009"" />


There is a series of errors in the console, see logs below.

We are on a pretty recent version of Metabase, but not the latest version, please let me know if this has been fixed and I just need to upgrade. But I could not find any mention of this issue in the Release notes.

Thank you

### To Reproduce

1. Create a question that query longitude/latitude
2. Add Map visualization, Map type: Pin Map
3. Create a public link
4. Go to the public link, you'll see the errors in the Web console, and no pins are going to show up.


### Expected behavior

_No response_

### Logs

GET https://*************************/Latitude/Longitude?query=%7B%22type%22%3A%22native%22%2C%22native%22%3A%7B%22template-tags%22%3A%7B%7D%7D%7D 401 (Unauthorized)
createTile | @ | vendor.ecdac9f4035b000c.js:1
-- | -- | --
  | _addTile | @ | vendor.ecdac9f4035b000c.js:1
  | _update | @ | vendor.ecdac9f4035b000c.js:1
  | redraw | @ | vendor.ecdac9f4035b000c.js:1
  | setUrl | @ | vendor.ecdac9f4035b000c.js:1
  | componentDidUpdate | @ | LeafletTilePinMap.jsx:20
  | componentDidMount | @ | LeafletTilePinMap.jsx:10
  | a0 | @ | vendor.ecdac9f4035b000c.js:1
  | e | @ | vendor.ecdac9f4035b000c.js:1
  | (anonymous) | @ | vendor.ecdac9f4035b000c.js:1
  | sH | @ | vendor.ecdac9f4035b000c.js:1
  | sS | @ | vendor.ecdac9f4035b000c.js:1
  | w | @ | vendor.ecdac9f4035b000c.js:1
  | B | @ | vendor.ecdac9f4035b000c.js:1


<img width=""1426"" alt=""Image"" src=""https://github.com/user-attachments/assets/b3c69098-4d46-4fd4-bd94-0f88d94f5c89"" />

<img width=""1124"" alt=""Image"" src=""https://github.com/user-attachments/assets/1d4fa3c5-1e9e-421f-8b8a-f564951fbbf2"" />

<img width=""398"" alt=""Image"" src=""https://github.com/user-attachments/assets/0e3d7cd7-d783-427e-8d3a-a2f432b601a6"" />

<img width=""410"" alt=""Image"" src=""https://github.com/user-attachments/assets/4659deaf-0846-499d-88e3-d9b3e181a5a4"" />

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-06"",
      ""tag"": ""v0.51.11"",
      ""hash"": ""02729cf""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""heroku"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.6 (Ubuntu 16.6-1.pgdg20.04+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.25+9-LTS"",
    ""java.vendor"": ""Azul Systems, Inc."",
    ""java.vendor.url"": ""http://www.azul.com/"",
    ""java.version"": ""11.0.25"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.25+9-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.0-1072-aws"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Etc/UTC""
  }
}
```

### Severity

Blocking some users

### Additional context

_No response_",beld2107,2025-02-07 21:04:36+00:00,[],2025-02-09 04:05:47+00:00,,https://github.com/metabase/metabase/issues/53405,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2646057602, 'issue_id': 2839085350, 'author': 'Sid-80', 'body': 'I am willing to work on this issue!', 'created_at': datetime.datetime(2025, 2, 9, 4, 5, 46, tzinfo=datetime.timezone.utc)}]","Sid-80 on (2025-02-09 04:05:46 UTC): I am willing to work on this issue!

"
2839064598,issue,open,,Should not allow saving query with cycle,"### Describe the bug



We should not offer to replace existing question when saving a question that creates a cyclic dependency.



### To Reproduce


1. Create a new question: ""Orders"", summarize ""Count"" by ""Created At: Month""
2. Save it
3. Add a join step and join the newly created question to itself on ""Created At: Month"" = ""Created At: Month""
4. Save it
5. When asked to replace existing question or create a new one, just hit ""Save""
7. Notice the red error message in the modal. `Cannot read properties of undefined (reading 'id')`
8. Notice in Network panel of Dev Tools that the server responded 400 with an error message in the body.

<img width=""659"" alt=""Image"" src=""https://github.com/user-attachments/assets/5eb934bc-b402-40ca-915e-4d303e4fa095"" />

<img width=""474"" alt=""Image"" src=""https://github.com/user-attachments/assets/ff079fee-04ae-49a3-9164-844ad6b0748f"" />



### Expected behavior


1. We should not offer to replace existing question when saving a question that joins itself - we know it will result in an error.
2. When you do hit save (in case cycle cannot be detected), detect 400 response and use error message in modal.


### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-02-05"",
      ""tag"": ""v0.54.0-SNAPSHOT"",
      ""hash"": ""a4b2ccd""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.2 (Homebrew)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.5""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""15.2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

P2

### Additional context


This is the frontend portion of #35980. The backend portion was fixed in #53373. That PR adds a function to `metabase.lib.query` called `check-overwrite` which can be used from the frontend to check for cycles if we have enough metadata to detect them. It uses the same function on the backend to protect the API.",ericnormand,2025-02-07 20:50:38+00:00,[],2025-02-07 21:01:16+00:00,,https://github.com/metabase/metabase/issues/53404,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2644120176, 'issue_id': 2839064598, 'author': 'ericnormand', 'body': 'Note that there are times when `metabase.lib.query/check-overwrite` cannot detect cycles on the frontend because of lack of metadata. But there are also times when it can. This may make it hard to reproduce. Either way, the backend is protected from saves.', 'created_at': datetime.datetime(2025, 2, 7, 21, 1, 14, tzinfo=datetime.timezone.utc)}]","ericnormand (Issue Creator) on (2025-02-07 21:01:14 UTC): Note that there are times when `metabase.lib.query/check-overwrite` cannot detect cycles on the frontend because of lack of metadata. But there are also times when it can. This may make it hard to reproduce. Either way, the backend is protected from saves.

"
2838985578,issue,open,,[Epic] Title,"### Links

- [product doc](LINK_TO_PRODUCT_DOC)
- [technical design doc](LINK_TO_TECHNICAL_DESIGN_DOC)
- [testing plan](LINK_TO_TESTING_PLAN)
- feature branch: `BRANCH_NAME`
- issue links: _related issues, if any_

### Implementation Plan

```[tasklist]
#### Milestone 1
- [ ] _Add tasks here_
```
",Zaidalamari,2025-02-07 19:57:20+00:00,[],2025-02-07 19:57:20+00:00,,https://github.com/metabase/metabase/issues/53393,"[('.Epic', 'Feature Implementation or Project')]",[],
2838582106,issue,open,,sandbox UI doesn't show hidden columns,"### Describe the bug

Sandbox on a column

<img width=""1104"" alt=""Image"" src=""https://github.com/user-attachments/assets/0a3bc824-be56-4c66-938f-70c29c4bd446"" />

Hide the column

<img width=""1449"" alt=""Image"" src=""https://github.com/user-attachments/assets/9db6afad-b936-45f7-ae67-f84d98b48147"" />

UI no longer shows column in config box

<img width=""1465"" alt=""Image"" src=""https://github.com/user-attachments/assets/6f49fc22-07a3-4663-b010-de01dc8f1dcc"" />

Network includes correctly configured sandbox information

<img width=""1484"" alt=""Image"" src=""https://github.com/user-attachments/assets/dd560c75-032a-49db-a100-4b96b429584f"" />
But the field is missing from query metadata (presumably)

### To Reproduce

above is a pretty exhaustive repro

### Expected behavior

should show the column in the config box.

### Logs

_No response_

### Information about your Metabase installation

```JSON
any version
```

### Severity

p2

### Additional context

_No response_",dpsutton,2025-02-07 16:31:09+00:00,[],2025-02-07 16:48:51+00:00,,https://github.com/metabase/metabase/issues/53378,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Administration/Data Sandboxes', 'Enterprise Sandboxing'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2838551812,issue,open,,We need GetTableMetadata on tables now on Athena,"### Describe the bug

Seems that we forgot to document the permissions we need after https://github.com/metabase/metabase/pull/44032

Things are gonna keep running ""as usual"", but slower and maybe we get a deprecation at some point, which should be sad

### To Reproduce

1) follow the Athena tutorial
2) see the logs when syncing

### Expected behavior

We should tell users how to connect correctly to Athena

### Logs

```
2025-02-07 16:01:15,882 WARN results.ListTableMetadataResultSet :: Could not list tables: software.amazon.awssdk.services.athena.model.AthenaException: You are not authorized to perform: athena:GetTableMetadata on the resource. After your AWS administrator or you have updated your permissions, please try again. (Service: Athena, Status Code: 400, Request ID: d565803f-77bb-4aad-bf04-f9df881e47c5)
java.util.concurrent.CompletionException: software.amazon.awssdk.services.athena.model.AthenaException: You are not authorized to perform: athena:GetTableMetadata on the resource. After your AWS administrator or you have updated your permissions, please try again. (Service: Athena, Status Code: 400, Request ID: d565803f-77bb-4aad-bf04-f9df881e47c5)
	at software.amazon.awssdk.utils.CompletableFutureUtils.errorAsCompletionException(CompletableFutureUtils.java:64)
	at software.amazon.awssdk.core.internal.http.pipeline.stages.AsyncExecutionFailureExceptionReportingStage.lambda$execute$0(AsyncExecutionFailureExceptionReportingStage.java:51)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(Unknown Source)
	at software.amazon.awssdk.utils.CompletableFutureUtils.lambda$forwardExceptionTo$0(CompletableFutureUtils.java:78)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(Unknown Source)
	at software.amazon.awssdk.core.internal.http.pipeline.stages.AsyncRetryableStage2$RetryingExecutor.maybeAttemptExecute(AsyncRetryableStage2.java:135)
	at software.amazon.awssdk.core.internal.http.pipeline.stages.AsyncRetryableStage2$RetryingExecutor.maybeRetryExecute(AsyncRetryableStage2.java:152)
	at software.amazon.awssdk.core.internal.http.pipeline.stages.AsyncRetryableStage2$RetryingExecutor.lambda$attemptExecute$1(AsyncRetryableStage2.java:123)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture.complete(Unknown Source)
	at software.amazon.awssdk.core.internal.http.pipeline.stages.MakeAsyncHttpRequestStage.lambda$null$0(MakeAsyncHttpRequestStage.java:110)
	at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture.complete(Unknown Source)
	at software.amazon.awssdk.core.internal.http.pipeline.stages.MakeAsyncHttpRequestStage.completeResponseFuture(MakeAsyncHttpRequestStage.java:253)
	at software.amazon.awssdk.core.internal.http.pipeline.stages.MakeAsyncHttpRequestStage.lambda$executeHttpRequest$3(MakeAsyncHttpRequestStage.java:167)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture$Completion.run(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: software.amazon.awssdk.services.athena.model.AthenaException: You are not authorized to perform: athena:GetTableMetadata on the resource. After your AWS administrator or you have updated your permissions, please try again. (Service: Athena, Status Code: 400, Request ID: d565803f-77bb-4aad-bf04-f9df881e47c5)
	at software.amazon.awssdk.services.athena.model.AthenaException$BuilderImpl.build(AthenaException.java:104)
	at software.amazon.awssdk.services.athena.model.AthenaException$BuilderImpl.build(AthenaException.java:58)
	at software.amazon.awssdk.protocols.json.internal.unmarshall.AwsJsonProtocolErrorUnmarshaller.unmarshall(AwsJsonProtocolErrorUnmarshaller.java:92)
	at software.amazon.awssdk.protocols.json.internal.unmarshall.AwsJsonProtocolErrorUnmarshaller.handle(AwsJsonProtocolErrorUnmarshaller.java:66)
	at software.amazon.awssdk.protocols.json.internal.unmarshall.AwsJsonProtocolErrorUnmarshaller.handle(AwsJsonProtocolErrorUnmarshaller.java:41)
	at software.amazon.awssdk.core.http.MetricCollectingHttpResponseHandler.lambda$handle$0(MetricCollectingHttpResponseHandler.java:52)
	at software.amazon.awssdk.core.internal.util.MetricUtils.measureDurationUnsafe(MetricUtils.java:99)
	at software.amazon.awssdk.core.internal.util.MetricUtils.measureDurationUnsafe(MetricUtils.java:92)
	at software.amazon.awssdk.core.http.MetricCollectingHttpResponseHandler.handle(MetricCollectingHttpResponseHandler.java:52)
	at software.amazon.awssdk.core.internal.http.async.AsyncResponseHandler.lambda$prepare$0(AsyncResponseHandler.java:92)
	at java.base/java.util.concurrent.CompletableFuture$UniCompose.tryFire(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(Unknown Source)
	at java.base/java.util.concurrent.CompletableFuture.complete(Unknown Source)
	at software.amazon.awssdk.core.internal.http.async.AsyncResponseHandler$BaosSubscriber.onComplete(AsyncResponseHandler.java:135)
	at software.amazon.awssdk.core.internal.metrics.BytesReadTrackingPublisher$BytesReadTracker.onComplete(BytesReadTrackingPublisher.java:74)
	at software.amazon.awssdk.http.nio.netty.internal.ResponseHandler$DataCountingPublisher$1.onComplete(ResponseHandler.java:519)
	at software.amazon.awssdk.http.nio.netty.internal.ResponseHandler.runAndLogError(ResponseHandler.java:254)
	at software.amazon.awssdk.http.nio.netty.internal.ResponseHandler.access$600(ResponseHandler.java:77)
	at software.amazon.awssdk.http.nio.netty.internal.ResponseHandler$PublisherAdapter$1.onComplete(ResponseHandler.java:375)
	at software.amazon.awssdk.http.nio.netty.internal.nrs.HandlerPublisher.publishMessage(HandlerPublisher.java:402)
	at software.amazon.awssdk.http.nio.netty.internal.nrs.HandlerPublisher.flushBuffer(HandlerPublisher.java:338)
	at software.amazon.awssdk.http.nio.netty.internal.nrs.HandlerPublisher.receivedDemand(HandlerPublisher.java:291)
	at software.amazon.awssdk.http.nio.netty.internal.nrs.HandlerPublisher.access$200(HandlerPublisher.java:61)
	at software.amazon.awssdk.http.nio.netty.internal.nrs.HandlerPublisher$ChannelSubscription$1.run(HandlerPublisher.java:495)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:173)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:166)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:469)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:566)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:994)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	... 1 more

```

### Information about your Metabase installation

```JSON
it's been like that since the PR above
```

### Severity

P2

### Additional context

NA",paoliniluis,2025-02-07 16:17:24+00:00,[],2025-02-07 16:50:55+00:00,,https://github.com/metabase/metabase/issues/53377,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Database/Athena', ''), ('.Team/Drivers', '')]",[],
2838390268,issue,open,,Multiple instance issue upgrading to 52.9,"### Describe the bug

Hey all we upgraded from 51.X to 52.9 (enterprise) and we are seeing problems requiring many refreshes to resolve due to missing files such as `app-main.bea0c0b00ebc313c.js` missing. Seems to be a horizontal scaling issue as when i scale us down to 1 instance everything is fine. Did something change with serving that breaks multiple instances? We run on gke with a google load balancer, nothing too fancy.

### To Reproduce

Run 2 or more instances of metabase, refresh the page a few times, eventually see a failed load due to a file (js /css /etc) not being found.

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""bigquery-cloud-sdk"",
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-self-hosted"",
    ""version"": {
      ""date"": ""2025-02-05"",
      ""tag"": ""v1.52.9.3"",
      ""hash"": ""9e94cc5""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.13""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.6+7-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.6"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.6+7-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.112+"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

high

### Additional context

_No response_",rob-pomelo,2025-02-07 15:04:13+00:00,[],2025-02-07 19:37:46+00:00,,https://github.com/metabase/metabase/issues/53372,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('.Team/DevEx', '')]","[{'comment_id': 2643308036, 'issue_id': 2838390268, 'author': 'paoliniluis', 'body': '@rob-pomelo Do you use a CDN?', 'created_at': datetime.datetime(2025, 2, 7, 15, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2643336789, 'issue_id': 2838390268, 'author': 'rob-pomelo', 'body': 'We do not use a cdn (specifically we use google Identity aware proxy (IAP) to keep app internal which prevents usage of a cdn)', 'created_at': datetime.datetime(2025, 2, 7, 16, 2, 28, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-02-07 15:51:00 UTC): @rob-pomelo Do you use a CDN?

rob-pomelo (Issue Creator) on (2025-02-07 16:02:28 UTC): We do not use a cdn (specifically we use google Identity aware proxy (IAP) to keep app internal which prevents usage of a cdn)

"
2838305855,issue,open,,"Metabase casts date fields to datetime on Oracle, making indexes to be unusable","### Describe the bug

A similar one to https://github.com/metabase/metabase/issues/47026, but this time with Oracle.

### To Reproduce

1) Let's say you have a table in oracle like:
Number, (int) Date (date)
1,2020-01-01
2,2020-01-02
3,2020-01-03
4,2020-01-04
5,2020-01-05

2) Add an index into the table field

3) Now sync it with Metabase and do a query that gives you the sum between some dates... see that it will do a full table scan rather than an index scan, as we don't understand the dates and we cast it to a timestamp

### Expected behavior

We should use the plain date and not cast it

### Logs

NA

### Information about your Metabase installation

```JSON
It has always been like that
```

### Severity

P1

### Additional context

Hurting an enterprise customer",paoliniluis,2025-02-07 14:29:07+00:00,[],2025-02-07 16:53:31+00:00,,https://github.com/metabase/metabase/issues/53371,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Oracle', None), ('.Backend', ''), ('.Team/Drivers', '')]",[],
2838289945,issue,open,,long question name breaks notebook editor layout,"**Context**

<img width=""1920"" alt=""Image"" src=""https://github.com/user-attachments/assets/5f9762ed-7ff8-4629-b9e6-d638777f5ebc"" />

<img width=""1920"" alt=""Image"" src=""https://github.com/user-attachments/assets/5c21566a-ea5c-494a-aebb-1f3dd99478d5"" />

",uladzimirdev,2025-02-07 14:22:59+00:00,['uladzimirdev'],2025-02-07 16:53:51+00:00,,https://github.com/metabase/metabase/issues/53370,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2838011712,issue,open,,long question name breaks duplicate question modal layout,"<img width=""1185"" alt=""Image"" src=""https://github.com/user-attachments/assets/ce84f5a6-0125-46d9-9b5d-0c3814292fb1"" />

Steps:
- create a question with a long name like `'a'.repeat(200)`
- save it
- click on ""duplicate it""",uladzimirdev,2025-02-07 12:12:14+00:00,['uladzimirdev'],2025-02-07 16:54:09+00:00,,https://github.com/metabase/metabase/issues/53364,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2837864161,issue,open,,Allow adding explicit JSON column unfolding,"**Is your feature request related to a problem? Please describe.**
For (PostgreSQL and MySQL) tables with JSON/B columns where unfolding is enabled, but the JSON key you would like to access is not included in the scanned number of rows, I'd like an easy way to tell Metabase to unfold those keys explicitly.

**Describe the solution you'd like**
Have the option to add explicitly unfolded fields from a JSON/B column in the `Admin UI -> Table Metadata -> [table] -> [JSON/B column] -> Field Settings` in **addition** to the automatically unfolded fields.

**Describe alternatives you've considered**
* Using a Model using native question
* Explicitly adding the keys to records being scanned

**How important is this feature to you?**
As there are no good workaround to solve this, while we restrict the usage of native questions (for multiple reasons), this is almost a blocker for us in same cases where users are not able to filter on keys in JSON/B which does not unfold.

**Additional context**
This is related to, and complement the following issues (which I could find at least):
* https://github.com/metabase/metabase/issues/10217
* https://github.com/metabase/metabase/issues/37180
* https://github.com/metabase/metabase/issues/24007",ilons,2025-02-07 10:57:35+00:00,[],2025-02-07 18:52:50+00:00,,https://github.com/metabase/metabase/issues/53361,"[('Database/Postgres', None), ('Database/MySQL', None), ('Type:New Feature', ''), ('Administration/Table Metadata', '')]",[],
2837391569,issue,open,,Serialization fails due to Duplicate entry 'xxx' for key 'report_card.entity_id',"### Describe the bug

Export using `/api/ee/serialization/export` endpoint fails with error message given below. 

### To Reproduce

```
curl \
    -H ""x-api-key: $METABASE_API_KEY"" \
    -X POST 'https://metabase.my_company.com/api/ee/serialization/export'
```

### Expected behavior

Should serialize properly

### Logs

2025-02-07 07:43:00,902 INFO v2.backfill-ids :: Backfilling entity_id for 133 rows of Card
2025-02-07 07:43:00,925 ERROR serialization.api :: Error during serialization: (conn=49549116) Duplicate entry 'RC91I805jPdd46KkIWfIQ' for key 'report_card.entity_id' {}
2025-02-07 07:43:00,925 ERROR serialization.api ::   caused by: (conn=49549116) Duplicate entry 'RC91I805jPdd46KkIWfIQ' for key 'report_card.entity_id' 
2025-02-07 07:43:00,925 ERROR serialization.api ::   caused by: Duplicate entry 'RC91I805jPdd46KkIWfIQ' for key 'report_card.entity_id' 
2025-02-07 07:43:00,925 ERROR serialization.api ::   caused by: Duplicate entry 'RC91I805jPdd46KkIWfIQ' for key 'report_card.entity_id' 

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""bigquery-cloud-sdk"",
      ""mysql"",
      ""sparksql"",
      ""oracle"",
      ""clickhouse""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-self-hosted-yearly"",
    ""version"": {
      ""date"": ""2024-09-03"",
      ""tag"": ""v1.50.24"",
      ""hash"": ""3b63317""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MySQL"",
        ""version"": ""8.0.34-26""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.24+8"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.24"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.24+8"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.14.0-545.el9.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Berlin""
  }
}
```

### Severity

blocking an upgrade

### Additional context

_No response_",s-diehl,2025-02-07 06:58:31+00:00,[],2025-02-07 16:55:10+00:00,,https://github.com/metabase/metabase/issues/53354,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Operation/Serialization', 'Enterprise contents migration'), ('.Team/Workflows', 'aka BEC')]",[],
2837372993,issue,closed,not_planned,[Epic] Title,"### Links

- [product doc](LINK_TO_PRODUCT_DOC)
- [technical design doc](LINK_TO_TECHNICAL_DESIGN_DOC)
- [testing plan](LINK_TO_TESTING_PLAN)
- feature branch: `BRANCH_NAME`
- issue links: _related issues, if any_

### Implementation Plan

```[tasklist]
#### Milestone 1
- [x] _Add tasks here_
```",Theffhax,2025-02-07 06:45:28+00:00,[],2025-02-07 17:09:42+00:00,2025-02-07 17:09:42+00:00,https://github.com/metabase/metabase/issues/53353,"[('.Epic', 'Feature Implementation or Project')]",[],
2836826586,issue,open,,"Cannot invoke ""Object.toString()"" because ""s"" is null","### Describe the bug

If you don't complete the region on an Athena connection that error will appear

### To Reproduce

1) go to Athena and try a connection without the region completed
2) see the error

![Image](https://github.com/user-attachments/assets/4b841c35-6d32-4c61-bb69-1bef50bfaaa2)

### Expected behavior

Should work without the region populated

### Logs

```
2025-02-06 23:18:14,407 ERROR driver.util :: Failed to connect to Database
java.lang.NullPointerException: Cannot invoke ""Object.toString()"" because ""s"" is null
	at clojure.string$starts_with_QMARK_.invokeStatic(string.clj:365)
	at clojure.string$starts_with_QMARK_.invoke(string.clj:361)
	at metabase.driver.athena$endpoint_for_region.invokeStatic(athena.clj:55)
	at metabase.driver.athena$endpoint_for_region.invoke(athena.clj:51)
	at metabase.driver.athena$fn__135307.invokeStatic(athena.clj:63)
	at metabase.driver.athena$fn__135307.invoke(athena.clj:58)
	at clojure.lang.MultiFn.invoke(MultiFn.java:234)
	at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection$fn__78624.invoke(connection.clj:379)
	at metabase.util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:165)
	at metabase.util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154)
	at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invokeStatic(connection.clj:375)
	at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invoke(connection.clj:371)
	at metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invokeStatic(connection.clj:403)
	at metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invoke(connection.clj:399)
	at metabase.driver.sql_jdbc$fn__128093.invokeStatic(sql_jdbc.clj:50)
	at metabase.driver.sql_jdbc$fn__128093.invoke(sql_jdbc.clj:48)
	at clojure.lang.MultiFn.invoke(MultiFn.java:234)
	at metabase.driver.util$can_connect_with_details_QMARK_$fn__66621.invoke(util.clj:173)
	at clojure.core$binding_conveyor_fn$fn__5842.invoke(core.clj:2047)
	at clojure.lang.AFn.call(AFn.java:18)
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at java.base/java.lang.Thread.run(Unknown Source)
2025-02-06 23:18:14,409 ERROR api.database :: Cannot connect to Database
clojure.lang.ExceptionInfo: Cannot invoke ""Object.toString()"" because ""s"" is null {:message ""Cannot invoke \""Object.toString()\"" because \""s\"" is null""}
	at metabase.driver.util$can_connect_with_details_QMARK_.invokeStatic(util.clj:190)
	at metabase.driver.util$can_connect_with_details_QMARK_.doInvoke(util.clj:161)
	at clojure.lang.RestFn.invoke(RestFn.java:445)
	at metabase.api.database$test_database_connection.invokeStatic(database.clj:729)
	at metabase.api.database$test_database_connection.doInvoke(database.clj:719)
	at clojure.lang.RestFn.invoke(RestFn.java:428)
	at metabase.api.database$test_connection_details105696__105697.invokeStatic(database.clj:783)
	at metabase.api.database$test_connection_details105696__105697.invoke(database.clj:763)
	at metabase.api.database$fn__105704$fn__105710.invoke(database.clj:807)
	at metabase.api.macros$_defendpoint_core_fn55092__55093$_core_fn__55094.invoke(macros.clj:393)
	at metabase.api.macros$defendpoint_handler_STAR_55125__55127$handler__55131.invoke(macros.clj:574)
	at metabase.api.macros$build_ns_handler55178__55179$ns_handler_STAR___55180.invoke(macros.clj:671)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833.invoke(core.clj:200)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at metabase.server.middleware.auth$enforce_authentication$fn__64248.invoke(auth.clj:18)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833.invoke(core.clj:200)
	at compojure.core$make_context$handler__55861.invoke(core.clj:290)
	at compojure.core$make_context$fn__55865.invoke(core.clj:300)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:199)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:199)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833.invoke(core.clj:200)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:199)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833.invoke(core.clj:200)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833.invoke(core.clj:200)
	at metabase.api.routes$fn__110749$fn__110750.invoke(routes.clj:70)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833.invoke(core.clj:200)
	at clojure.lang.AFn.applyToHelper(AFn.java:160)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$apply.invoke(core.clj:662)
	at metabase.server.routes$fn__111518$fn__111519.doInvoke(routes.clj:67)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833.invoke(core.clj:200)
	at compojure.core$make_context$handler__55861.invoke(core.clj:290)
	at compojure.core$make_context$fn__55865.invoke(core.clj:300)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__55814.invoke(core.clj:153)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__55814.invoke(core.clj:153)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__55814.invoke(core.clj:153)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__55814.invoke(core.clj:153)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:199)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:199)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:199)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833.invoke(core.clj:200)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833.invoke(core.clj:200)
	at compojure.core$make_context$handler__55861.invoke(core.clj:290)
	at compojure.core$make_context$fn__55865.invoke(core.clj:300)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833$f__55834$respond_SINGLEQUOTE___55835.invoke(core.clj:197)
	at compojure.core$make_context$fn__55865.invoke(core.clj:301)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833.invoke(core.clj:200)
	at compojure.core$routes$fn__55833$f__55834.invoke(core.clj:198)
	at compojure.core$routes$fn__55833.invoke(core.clj:200)
	at metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__64588.invoke(exceptions.clj:111)
	at metabase.server.middleware.exceptions$catch_api_exceptions$fn__64585.invoke(exceptions.clj:100)
	at metabase.server.middleware.log$log_api_call$fn__118484$fn__118485$fn__118486.invoke(log.clj:232)
	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:17)
	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12)
	at metabase.server.middleware.log$log_api_call$fn__118484$fn__118485.invoke(log.clj:223)
	at toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112)
	at toucan2.execute$do_with_call_counts.invoke(execute.clj:103)
	at metabase.server.middleware.log$log_api_call$fn__118484.invoke(log.clj:222)
	at metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__126865.invoke(browser_cookie.clj:40)
	at metabase.server.middleware.security$add_security_headers$fn__64544.invoke(security.clj:273)
	at metabase.server.middleware.json$wrap_json_body$fn__57452.invoke(json.clj:128)
	at metabase.server.middleware.offset_paging$handle_paging$fn__125718.invoke(offset_paging.clj:48)
	at metabase.server.middleware.json$wrap_streamed_json_response$fn__57440.invoke(json.clj:83)
	at ring.middleware.keyword_params$wrap_keyword_params$fn__127132.invoke(keyword_params.clj:55)
	at ring.middleware.params$wrap_params$fn__127151.invoke(params.clj:77)
	at metabase.server.middleware.misc$maybe_set_site_url$fn__117736.invoke(misc.clj:59)
	at metabase.server.middleware.session$reset_session_timeout$fn__120271.invoke(session.clj:270)
	at metabase.server.middleware.session$bind_current_user$fn__120264$fn__120265.invoke(session.clj:245)
	at metabase.request.session$do_with_current_user.invokeStatic(session.clj:50)
	at metabase.request.session$do_with_current_user.invoke(session.clj:33)
	at metabase.server.middleware.session$bind_current_user$fn__120264.invoke(session.clj:244)
	at metabase.server.middleware.session$wrap_current_user_info$fn__120256.invoke(session.clj:204)
	at metabase.analytics.sdk$embedding_mw$embedding_mw_fn__81383.invoke(sdk.clj:63)
	at metabase.server.middleware.session$wrap_session_id$fn__120228.invoke(session.clj:82)
	at metabase.server.middleware.auth$wrap_static_api_key$fn__64256.invoke(auth.clj:33)
	at ring.middleware.cookies$wrap_cookies$fn__127052.invoke(cookies.clj:200)
	at metabase.server.middleware.misc$add_content_type$fn__117718.invoke(misc.clj:28)
	at metabase.server.middleware.misc$disable_streaming_buffering$fn__117744.invoke(misc.clj:75)
	at ring.middleware.gzip$wrap_gzip$fn__127094.invoke(gzip.clj:86)
	at metabase.server.middleware.request_id$wrap_request_id$fn__115678.invoke(request_id.clj:9)
	at metabase.server.middleware.misc$bind_request$fn__117747$fn__117748.invoke(misc.clj:87)
	at metabase.request.current$do_with_current_request.invokeStatic(current.clj:19)
	at metabase.request.current$do_with_current_request.invoke(current.clj:15)
	at metabase.server.middleware.misc$bind_request$fn__117747.invoke(misc.clj:86)
	at metabase.server.middleware.ssl$redirect_to_https_middleware$fn__126881.invoke(ssl.clj:51)
	at clojure.lang.Var.invoke(Var.java:395)
	at metabase.server.instance$async_proxy_handler$fn__64928.invoke(instance.clj:76)
	at metabase.server.instance.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source)
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)
	at org.eclipse.jetty.server.Server.handle(Server.java:563)
	at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)
	at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NullPointerException: Cannot invoke ""Object.toString()"" because ""s"" is null
	at clojure.string$starts_with_QMARK_.invokeStatic(string.clj:365)
	at clojure.string$starts_with_QMARK_.invoke(string.clj:361)
	at metabase.driver.athena$endpoint_for_region.invokeStatic(athena.clj:55)
	at metabase.driver.athena$endpoint_for_region.invoke(athena.clj:51)
	at metabase.driver.athena$fn__135307.invokeStatic(athena.clj:63)
	at metabase.driver.athena$fn__135307.invoke(athena.clj:58)
	at clojure.lang.MultiFn.invoke(MultiFn.java:234)
	at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection$fn__78624.invoke(connection.clj:379)
	at metabase.util.ssh$do_with_ssh_tunnel.invokeStatic(ssh.clj:165)
	at metabase.util.ssh$do_with_ssh_tunnel.invoke(ssh.clj:154)
	at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invokeStatic(connection.clj:375)
	at metabase.driver.sql_jdbc.connection$do_with_connection_spec_for_testing_connection.invoke(connection.clj:371)
	at metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invokeStatic(connection.clj:403)
	at metabase.driver.sql_jdbc.connection$can_connect_QMARK_.invoke(connection.clj:399)
	at metabase.driver.sql_jdbc$fn__128093.invokeStatic(sql_jdbc.clj:50)
	at metabase.driver.sql_jdbc$fn__128093.invoke(sql_jdbc.clj:48)
	at clojure.lang.MultiFn.invoke(MultiFn.java:234)
	at metabase.driver.util$can_connect_with_details_QMARK_$fn__66621.invoke(util.clj:173)
	at clojure.core$binding_conveyor_fn$fn__5842.invoke(core.clj:2047)
	at clojure.lang.AFn.call(AFn.java:18)
	at java.base/java.util.concurrent.FutureTask.run(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	... 1 more
2025-02-06 23:18:14,619 DEBUG middleware.log :: POST /api/database 400 212ms (0 DB calls) {:metabase-user-id 13371339} 
{:message ""Cannot invoke \""Object.toString()\"" because \""s\"" is null""}
```

### Information about your Metabase installation

```JSON
v53.0-beta
```

### Severity

P2

### Additional context

NA",paoliniluis,2025-02-06 23:19:54+00:00,[],2025-02-07 18:53:26+00:00,,https://github.com/metabase/metabase/issues/53346,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Administration/Databases', ''), ('.Team/Drivers', '')]",[],
2836810894,issue,open,,Allow all pop-up modals to be accessible with the correct focus,"**Is your feature request related to a problem? Please describe.**
To make Metabase more accessible by allowing all interactive elements/pop-ups to be usable via keyboard navigation. 

Impact (from the customer):
	•	Keyboard-only users experience difficulty completing interactions.
	•	Users with assistive technologies (e.g., screen readers) are disrupted by illogical focus shifts, making navigation cumbersome.
	•	Critical user flows (e.g., editing or customizing columns) are less accessible.

Currently, there are some components like the filter modal that work great via keyboard navigation, but there are others such as the following that have their respective modal pop up, but you are not able to navigate them / the focus does not shift to that modal once you press Enter/Space on that icon: 
- Settings (cogwheel) button at the top right
- New button
- Settings (cogwheel) button next to Visualization (when viewing a question) 
- the ellipsis at the top of a chart
- changing the row limit at the bottom of the chart 
- toggling download options 
- probably more that I haven't listed 

It did work for events pop-up though. 

**Describe the solution you'd like**
(from the customer)
Ensure Focus Shift Upon Activation
	1.	After pressing Enter on the cogwheel or kebab menu, programmatically set focus to:
	•	The first focusable item within the modal or menu.
	•	If no interactive items exist, trap focus inside the modal.
	2.	Test Tab Order
	•	Ensure logical next focus when pressing Tab. Focus order should follow the next actionable item, avoiding context shifts that confuse users.
	3.	ARIA Role Enhancements
	•	Add proper ARIA roles (e.g., role=""menu"", role=""dialog"") to modals and interactive menus.
	•	Announce modals via screen readers with aria-label or aria-labelledby.

**How important is this feature to you?**
Customer request 
",jessicaul,2025-02-06 23:07:40+00:00,[],2025-02-07 18:52:41+00:00,,https://github.com/metabase/metabase/issues/53345,"[('Type:New Feature', ''), ('.Frontend', ''), ('Misc/Accessibility', '')]","[{'comment_id': 2643488943, 'issue_id': 2836810894, 'author': 'bshepherdson', 'body': ""Assigning this to AdminWebapp for now, though it's not really team-specific."", 'created_at': datetime.datetime(2025, 2, 7, 17, 1, 16, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2025-02-07 17:01:16 UTC): Assigning this to AdminWebapp for now, though it's not really team-specific.

"
2836789798,issue,open,,Allow Targeting which Field to Count in CumulativeCount Function,"**Is your feature request related to a problem? Please describe.**
I need to do a cumulative count of different columns. Ex a table that looks like this:

date | order_id | customer_Id
01/01/2025 | a1 | c1
01/03/2025 | a2 | c1
01/03/2025 | a3 | c1
01/05/2025 | a4 | c2
01/05/2025 | a5 | c2
01/07/2025 | a6 | c3
01/07/2025 | a7 | c3

We would like a result set like this:

date	| cumulative count(order_id)| cumulative_count(customer_id)
01/01/2025 | 1 | 1
01/03/2025 | 3	| 1
01/05/2025 | 5	| 2
01/07/2025 | 7 | 3


**Describe the solution you'd like**
It would be great if we could pass the column in as a variable to the cumulative count expression so that we could include multiple window functions that target specific fields.

**Describe alternatives you've considered**
Writing this in SQL

**Additional context**
Customer request
",ixipixi,2025-02-06 22:50:33+00:00,[],2025-02-07 17:08:34+00:00,,https://github.com/metabase/metabase/issues/53344,"[('Priority:P2', 'Average run of the mill bug'), ('Type:New Feature', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Product Input Needed', ''), ('.Team/Querying', '')]","[{'comment_id': 2641430499, 'issue_id': 2836789798, 'author': 'mngr', 'body': ""What does this exactly mean, cumulative count here?\nWe calculate just count of the rows, it doesn't depend on the column values at all.\nThey want like cumulative distinct count by ID?"", 'created_at': datetime.datetime(2025, 2, 7, 0, 6, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2643505322, 'issue_id': 2836789798, 'author': 'bshepherdson', 'body': 'Yeah, this looks like `COUNT DISTINCT(order_id)` and `customer_id` in one stage, and then `Cumulative Sum` on each of them in a second stage.', 'created_at': datetime.datetime(2025, 2, 7, 17, 8, 14, tzinfo=datetime.timezone.utc)}]","mngr on (2025-02-07 00:06:30 UTC): What does this exactly mean, cumulative count here?
We calculate just count of the rows, it doesn't depend on the column values at all.
They want like cumulative distinct count by ID?

bshepherdson on (2025-02-07 17:08:14 UTC): Yeah, this looks like `COUNT DISTINCT(order_id)` and `customer_id` in one stage, and then `Cumulative Sum` on each of them in a second stage.

"
2836753899,issue,open,,Make switch to data button keyboard accessible/interactive,"**Is your feature request related to a problem? Please describe.**
The query results / visualization toggle is not keyboard accessible. The <div> element is being used as a button, but it cannot be focused via the keyboard and doesn't respond to the Enter or Space key presses by default. 

<img width=""712"" alt=""Image"" src=""https://github.com/user-attachments/assets/aee5788d-4533-41c6-8ae5-440debe6bcd8"" />

This setup fails WCAG 2.2 AA guidelines, specifically:
	•	2.1.1 Keyboard Accessible: All functionality must be operable using a keyboard.
	•	4.1.2 Name, Role, Value: Elements must have a semantic role (e.g., a button) for assistive technologies like screen readers.


**Describe the solution you'd like**
(from the customer)
Replace the `<div>` with a semantic `<button>` element, ensuring it inherits:
	•	Keyboard focus and activation (via Enter or Space).
	•	Accessible naming for assistive technologies.

Code Fix Example:

`<button aria-label=""Switch to data"" class=""emotion-13ndh3o e1leag9o1"">
  <svg ...></svg>
</button>`


**How important is this feature to you?**
Customer request
",jessicaul,2025-02-06 22:24:07+00:00,[],2025-02-07 17:09:12+00:00,,https://github.com/metabase/metabase/issues/53343,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Type:New Feature', ''), ('.Frontend', ''), ('Misc/Accessibility', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2836666527,issue,open,,Enable arrow key navigation in a table,"**Is your feature request related to a problem? Please describe.**
To make Metabase more accessible by allowing keyboard navigation to be done with arrow keys (up, down, left, right) and not just tab when in a grid-like / table structure. It will also be more efficient with these additional buttons. 

**Describe the solution you'd like**
(from the customer, condensed version, let me know if you would like the full details and examples they provided) 

To enable arrow key navigation within a grid-like structure, you need to use ARIA roles, keyboard event listeners, and appropriate DOM structure to make it accessible and functional. Here’s how you can achieve this:

Steps to Enable Arrow Key Navigation in a Grid:

1. Proper Grid Structure with ARIA Roles

Ensure your grid complies with ARIA standards by using the correct roles:
	•	role=""grid"": Assigned to the main container of the grid.
	•	role=""row"": Assigned to each row inside the grid.
	•	role=""gridcell"": Assigned to each individual cell.
	•	Add aria-selected=""true"" or similar state attributes as needed for focus/selection.

2. Focus Management

Only one cell should be focusable at a time. Use tabindex=""0"" for the currently focused cell and tabindex=""-1"" for others.

3. Keyboard Event Handling

Attach event listeners to the grid container to handle arrow key navigation.

4. Enhancing Accessibility with ARIA States
	•	aria-selected: Indicates whether the cell is selected.
	•	aria-activedescendant: Use on the grid container to point to the active cell’s ID (optional).

5. Keyboard Navigation Best Practices
	•	Prevent Default Actions: For arrow keys, use event.preventDefault() to avoid browser scrolls.
	•	Focus Indicator: Style the focused cell for visibility (e.g., with a border or background color).
	•	Circular Navigation: Optional: If a user reaches the last cell and presses “Right,” loop back to the first cell.

6. Testing and Validation
	•	Use a screen reader to ensure proper announcement of rows, cells, and their states.
	•	Test on multiple browsers and devices.

**How important is this feature to you?**
Customer request
",jessicaul,2025-02-06 21:35:03+00:00,[],2025-02-07 17:10:21+00:00,,https://github.com/metabase/metabase/issues/53337,"[('Type:New Feature', ''), ('.Frontend', ''), ('Misc/Accessibility', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2836609543,issue,open,,Provide a way to skip the header when using keyboard navigation,"**Is your feature request related to a problem? Please describe.**
To make Metabase more accessible by allowing the user to go to the content of the page directly and skipping all of the header when using the keyboard navigation. This will allow the user to more easily navigate the core parts of the page, if they choose to. 

Currently, when you press tab, the default first component that is navigated to is the chart title. 

<img width=""726"" alt=""Image"" src=""https://github.com/user-attachments/assets/d4322353-abb8-4d99-ba1d-940c454a5203"" />

**Describe the solution you'd like**
A go to content button or a keyboard shortcut that allows the user to directly go to the content. 

**How important is this feature to you?**
Customer Request 
",jessicaul,2025-02-06 21:13:44+00:00,[],2025-02-07 18:52:34+00:00,,https://github.com/metabase/metabase/issues/53334,"[('Type:New Feature', ''), ('.Frontend', ''), ('Misc/Accessibility', '')]",[],
2836186753,issue,open,,Ensure links and buttons have accessible text/names,"**Is your feature request related to a problem? Please describe.**
To make Metabase more accessible by ensuring links and buttons have discernible text. If there is no accessible name or text associated with the link/button, then screen readers will announce it as ""button"" / ""link"", making it unusable for users who rely on screen readers.

more information: [https://dequeuniversity.com/rules/axe/4.10/link-name?application=AxeChrome](https://dequeuniversity.com/rules/axe/4.10/link-name?application=AxeChrome) and [https://dequeuniversity.com/rules/axe/4.10/button-name](https://dequeuniversity.com/rules/axe/4.10/button-name)

**Describe the solution you'd like** (from the customer)  To solve this problem, you need to fix at least (1) of the following:

* Element does not have text that is visible to screen readers
* aria-label attribute does not exist or is empty
* aria-labelledby attribute does not exist, references elements that do not exist or references elements that are empty
* Element has no title attribute

And fix the following:
Element is in tab order and does not have accessible text. There are hyperlinks with no description for where it leads.

**How important is this feature to you?**
Customer request

Related: [https://github.com/metabase/metabase/issues/1462](https://github.com/metabase/metabase/issues/1462)",jessicaul,2025-02-06 17:40:09+00:00,[],2025-02-07 18:52:25+00:00,,https://github.com/metabase/metabase/issues/53325,"[('Type:New Feature', ''), ('.Frontend', ''), ('Misc/Accessibility', '')]",[],
2836169984,issue,open,,Increase contrast of foreground and background colors,"**Is your feature request related to a problem? Please describe.**
To make Metabase more accessible by ensuring that there is sufficient contrast in color for buttons, text, and other components in Metabase. 

**Describe the solution you'd like**
Allow font colors to be customizable and / or have a feature that enables the colors to have enough contrast that meets the WCAG 2 AA minimum contrast ratio thresholds. 

**Describe alternatives you've considered**
Being able to change the main colors of the app in the Appearance section of the admin app is great, but without the ability to change font colors, this improved contrast breaks in a few places. For example: 

<img width=""726"" alt=""Image"" src=""https://github.com/user-attachments/assets/17119973-b0a9-49d8-a5b4-98821c061e79"" />

**How important is this feature to you?**
Customer requested",jessicaul,2025-02-06 17:31:11+00:00,[],2025-02-07 18:52:10+00:00,,https://github.com/metabase/metabase/issues/53324,"[('.CSS', ''), ('Type:New Feature', ''), ('.Frontend', ''), ('Misc/Accessibility', '')]","[{'comment_id': 2640551944, 'issue_id': 2836169984, 'author': 'jessicaul', 'body': 'Related: https://github.com/metabase/metabase/issues/40146', 'created_at': datetime.datetime(2025, 2, 6, 17, 34, 21, tzinfo=datetime.timezone.utc)}]","jessicaul (Issue Creator) on (2025-02-06 17:34:21 UTC): Related: https://github.com/metabase/metabase/issues/40146

"
2836120318,issue,open,,Slack integration should be able to send images to private channels,"With #53128, we are now able to send slack messages to private channels. It would make sense that the image file channel could also be private.

The current documentation describes creating a 'public channel' for images, so I think this is a new feature rather than a bug.

The slack app can send images to a private channel - but they are not displayed in messages:

![Image](https://github.com/user-attachments/assets/9d607bb7-b768-439c-b579-5c30c54f4087)

we expect the preview image to be displayed and look like this:

![Image](https://github.com/user-attachments/assets/d6a0b0a8-809c-41c6-a61c-540ba475a70b)",wotbrew,2025-02-06 17:07:36+00:00,['wotbrew'],2025-02-07 17:16:36+00:00,,https://github.com/metabase/metabase/issues/53319,"[('Type:New Feature', ''), ('Reporting/', ''), ('.Backend', ''), ('Notifications/Slack', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2643351830, 'issue_id': 2836120318, 'author': 'wotbrew', 'body': '> Here\'s a potentially confusing bit when you use the channel_id parameter during your upload: supplying channel_id will ""share"" the file to a channel. If you don\'t use the channel_id parameter, this only ""uploads"" the file — hosting the file in Slack — but doesn\'t ""share"" the file anywhere. Crucially, only the uploader will have access to the file if it is not shared anywhere.\n\nNot sure why we need to send to a channel at all. My understanding is as long as you get a public URL it will work, it doesnt need to be shared. Seems we might satisfy the requirements when you pair a normal upload with: \n\n> [files.sharedPublicURL](https://api.slack.com/methods/files.sharedPublicURL): Enable a file for public sharing.\n\nSee https://api.slack.com/messaging/files#uploading_files\n\n---\n\nTLDR; I wonder if we can drop the public images channel requirement altogether. What do you think @qnkhuat?', 'created_at': datetime.datetime(2025, 2, 7, 16, 9, 17, tzinfo=datetime.timezone.utc)}]","wotbrew (Issue Creator) on (2025-02-07 16:09:17 UTC): Not sure why we need to send to a channel at all. My understanding is as long as you get a public URL it will work, it doesnt need to be shared. Seems we might satisfy the requirements when you pair a normal upload with: 


See https://api.slack.com/messaging/files#uploading_files

---

TLDR; I wonder if we can drop the public images channel requirement altogether. What do you think @qnkhuat?

"
2835825351,issue,open,,Search bar in Settings,"**Is your feature request related to a problem? Please describe.**
I didn't know you could open the command palette in the Admin Settings. This is a cool feature that I would never have discovered.

<img width=""1512"" alt=""Image"" src=""https://github.com/user-attachments/assets/14091aa6-6f32-4a6a-b5c6-df0fb43d3dcd"" />


**Describe the solution you'd like**
Put a search bar in admin settings :)

**Describe alternatives you've considered**
N/a

**How important is this feature to you?**
Just a nice-to-have feature 

**Additional context**
N/A

",ignacio-mb,2025-02-06 15:19:33+00:00,[],2025-02-07 18:51:54+00:00,,https://github.com/metabase/metabase/issues/53307,"[('Type:New Feature', ''), ('Organization/Search', ''), ('.Frontend', ''), ('Administration/Settings', '')]",[],
2835694537,issue,open,,It's not possible to switch to MongoDB in native query editor,"### Describe the bug

Locally, I'm running the sample database and a MongoDB database.

I cannot write native queries in the MongoDB anymore.





### To Reproduce

1. New > Native query
2. Click the datbase selector and select the MongoDB instance
3. Nothing happens

There is an error message in the browser console:
```
Uncaught (in promise) Error: Assert failed: Missing extra, required keys for native query: #{:collection}
(empty? missing-keys)
    with_native_extras61457 native.cljc:150
    3 core.cljs:5464
    cljs$core$IFn$_invoke$arity$3 app-main.hot.bundle.js:35442
    cljs$core$apply_to core.cljs:3966
    cljs$core$IFn$_invoke$arity$5 core.cljs:4045
    metabase$lib$util$update_query_stage37074__delegate util.cljc:348
    metabase$lib$util$update_query_stage37074 util.cljc:343
    metabase$lib$native$with_native_extras61457 native.cljc:141
    metabase$lib$native$with_different_database61459__3 native.cljc:186
    cljs$core$IFn$_invoke$arity$5 core.cljs:4001
    cljs$core$IFn$_invoke$arity$4 core.cljs:3997
    cljs$core$IFn$_invoke$arity$3 core.cljs:3991
    cljs$core$IFn$_invoke$arity$2 core.cljs:3985
    cljs$core$IFn$_invoke$arity$2 core.cljs:4020
    metabase$lib$core$with_different_database__delegate core.cljc:80
    cljs$core$IFn$_invoke$arity$4 js.cljs:1898
    cljs$core$IFn$_invoke$arity$3 js.cljs:1898
    metabase$lib$js$with_different_database js.cljs:1898
    withDifferentDatabase native.ts:39
    setDatabaseId NativeQuery.ts:161
    setDatabaseId NativeQueryEditor.tsx:246
    onChangeDatabase DataSelector.jsx:781
    onChange DataSelectorDatabasePicker.tsx:86
    handleChange AccordionList.jsx:252
    onClick AccordionListCell.jsx:276
    React 15
    4 native.cljc:150
```

### Expected behavior

I should be able to select the MongoDB instance.

### Logs

_No response_

### Information about your Metabase installation

```JSON
`master` on `c9d6609021f5db9275a0307190c3db7c727eb555`
```

### Severity

P2

### Additional context

_No response_",romeovs,2025-02-06 14:28:49+00:00,[],2025-02-06 17:53:52+00:00,,https://github.com/metabase/metabase/issues/53299,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Native', 'The SQL/native query editor'), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2835667748,issue,open,,[SDK] Check what we have to do to support react 19,"**Context**

https://metaboat.slack.com/archives/C063Q3F1HPF/p1738765321118069

The typescript and react template of vite started using react 19, which we don't officially support.
It's also used by the latest version of next.
",npretto,2025-02-06 14:18:37+00:00,[],2025-02-06 14:18:37+00:00,,https://github.com/metabase/metabase/issues/53297,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2835573841,issue,open,,Help users understand where to find MB by including the MB URL in the json file,"In METABASE_LOGIN.json file we could include the URL. I didn't remember what port it was running on.
Sure, I can look this up in the app, but it seems straightforward to add a key to the JSON with the URL
",albertoperdomo,2025-02-06 13:42:42+00:00,[],2025-02-06 14:56:50+00:00,,https://github.com/metabase/metabase/issues/53294,"[('Type:New Feature', ''), ('.Team/Embedding', ''), ('Embedding/SDK-CLI', 'Onboarding CLI for React SDK')]",[],
2835154429,issue,closed,not_planned,You can't get filter values from custom columns,"### Describe the bug

If you create a custom column and then try to get its values from a filter in a dashboard, it won't work

### To Reproduce

1) create a question with the orders table that has a custom column that concats source and category. Save it
2) add it to a dashboard and add a filter that connects to this custom column (you won't get filter values populated). 
3) Now try to get the filter values from a question (trying to work around the limitation), and use the same question you created on step 1 to get the values from the custom columns

... the query will fail

### Expected behavior

It should get the filter values

### Logs

metabase        | 2025-02-06 10:31:51,584 ERROR middleware.log :: POST /api/dataset/parameter/values 500 28ms (10 DB calls) {:metabase-user-id 1} 
metabase        | {:via
metabase        |  [{:type clojure.lang.ExceptionInfo,
metabase        |    :message
metabase        |    ""Error compiling query: Cannot determine the source table or query for Field clause [:field \""some custom\"" {:base-type :type/Text}]"",
metabase        |    :data
metabase        |    {:query
metabase        |     {:database 1,
metabase        |      :middleware {:disable-remaps? true},
metabase        |      :type :query,
metabase        |      :query
metabase        |      {:source-table 3,
metabase        |       :breakout [[:field ""some custom"" {:base-type :type/Text}]],
metabase        |       :expressions
metabase        |       {""some custom""
metabase        |        [:concat
metabase        |         [:field 51 {:base-type :type/Text, :source-field 38, :join-alias ""people__via__user_id""}]
metabase        |         [:field 58 {:base-type :type/Text, :source-field 37, :join-alias ""products__via__product_id""}]]},
metabase        |       :limit 1000,
metabase        |       :order-by [[:asc [:field ""some custom"" {:base-type :type/Text}]]],
metabase        |       :joins
metabase        |       [{:alias ""people__via__user_id"",
metabase        |         :strategy :left-join,
metabase        |         :fk-field-id 38,
metabase        |         :condition [:= [:field 38 nil] [:field 48 {:join-alias ""people__via__user_id""}]],
metabase        |         :source-table 5}
metabase        |        {:alias ""products__via__product_id"",
metabase        |         :strategy :left-join,
metabase        |         :fk-field-id 37,
metabase        |         :condition [:= [:field 37 nil] [:field 60 {:join-alias ""products__via__product_id""}]],
metabase        |         :source-table 1}],
metabase        |       :filter
metabase        |       [:and
metabase        |        [:!= [:field ""some custom"" {:base-type :type/Text}] [:value nil {:base_type :type/Text}]]
metabase        |        [:!= [:field ""some custom"" {:base-type :type/Text}] [:value """" {:base_type :type/Text}]]]}},
metabase        |     :type :driver},
metabase        |    :at [metabase.query_processor.compile$compile_preprocessed74583__74584$fn__74585 invoke ""compile.clj"" 35]}
metabase        |   {:type clojure.lang.ExceptionInfo,
metabase        |    :message
metabase        |    ""Cannot determine the source table or query for Field clause [:field \""some custom\"" {:base-type :type/Text}]"",
metabase        |    :data
metabase        |    {:type :invalid-query,
metabase        |     :clause [:field ""some custom"" {:base-type :type/Text}],
metabase        |     :query
metabase        |     {:source-table 3,
metabase        |      :breakout [[:field ""some custom"" {:base-type :type/Text}]],
metabase        |      :expressions
metabase        |      {""some custom""
metabase        |       [:concat
metabase        |        [:field 51 {:base-type :type/Text, :source-field 38, :join-alias ""people__via__user_id""}]
metabase        |        [:field 58 {:base-type :type/Text, :source-field 37, :join-alias ""products__via__product_id""}]]},
metabase        |      :limit 1000,
metabase        |      :order-by [[:asc [:field ""some custom"" {:base-type :type/Text}]]],
metabase        |      :joins
metabase        |      [{:alias ""people__via__user_id"",
metabase        |        :strategy :left-join,
metabase        |        :fk-field-id 38,
metabase        |        :condition [:= [:field 38 nil] [:field 48 {:join-alias ""people__via__user_id""}]],
metabase        |        :source-table 5}
metabase        |       {:alias ""products__via__product_id"",
metabase        |        :strategy :left-join,
metabase        |        :fk-field-id 37,
metabase        |        :condition [:= [:field 37 nil] [:field 60 {:join-alias ""products__via__product_id""}]],
metabase        |        :source-table 1}],
metabase        |      :filter
metabase        |      [:and
metabase        |       [:!= [:field ""some custom"" {:base-type :type/Text}] [:value nil {:base_type :type/Text}]]
metabase        |       [:!= [:field ""some custom"" {:base-type :type/Text}] [:value """" {:base_type :type/Text}]]]}},
metabase        |    :at
metabase        |    [metabase.query_processor.util.add_alias_info$field_source_table_alias67240__67243
metabase        |     invokeStatic
metabase        |     ""add_alias_info.clj""
metabase        |     192]}],
metabase        |  :trace
metabase        |  [[metabase.query_processor.util.add_alias_info$field_source_table_alias67240__67243
metabase        |    invokeStatic
metabase        |    ""add_alias_info.clj""
metabase        |    192]
metabase        |   [metabase.query_processor.util.add_alias_info$field_source_table_alias67240__67243 invoke ""add_alias_info.clj"" 179]
metabase        |   [metabase.query_processor.util.add_alias_info$fn__67423 invokeStatic ""add_alias_info.clj"" 415]
metabase        |   [metabase.query_processor.util.add_alias_info$fn__67423 invoke ""add_alias_info.clj"" 412]
metabase        |   [clojure.lang.MultiFn invoke ""MultiFn.java"" 239]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info_STAR_$replace_67500__67501$fn__67508$fn__67509
metabase        |    invoke
metabase        |    ""add_alias_info.clj""
metabase        |    511]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info_STAR_$replace_67500__67501$fn__67508
metabase        |    invoke
metabase        |    ""add_alias_info.clj""
metabase        |    504]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info_STAR_$replace_67500__67501
metabase        |    invoke
metabase        |    ""add_alias_info.clj""
metabase        |    504]
metabase        |   [clojure.core$partial$fn__5927 invoke ""core.clj"" 2641]
metabase        |   [clojure.core$mapv$fn__8565 invoke ""core.clj"" 7059]
metabase        |   [clojure.lang.PersistentVector reduce ""PersistentVector.java"" 418]
metabase        |   [clojure.core$reduce invokeStatic ""core.clj"" 6964]
metabase        |   [clojure.core$mapv invokeStatic ""core.clj"" 7050]
metabase        |   [clojure.core$mapv invoke ""core.clj"" 7050]
metabase        |   [metabase.lib.util.match.impl$replace_in_collection invokeStatic ""impl.cljc"" 57]
metabase        |   [metabase.lib.util.match.impl$replace_in_collection invoke ""impl.cljc"" 47]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info_STAR_$replace_67500__67501$fn__67508
metabase        |    invoke
metabase        |    ""add_alias_info.clj""
metabase        |    504]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info_STAR_$replace_67500__67501
metabase        |    invoke
metabase        |    ""add_alias_info.clj""
metabase        |    504]
metabase        |   [metabase.lib.util.match.impl$replace_in_collection$fn__16945 invoke ""impl.cljc"" 53]
metabase        |   [clojure.lang.PersistentArrayMap kvreduce ""PersistentArrayMap.java"" 475]
metabase        |   [clojure.core$fn__8555 invokeStatic ""core.clj"" 6987]
metabase        |   [clojure.core$fn__8555 invoke ""core.clj"" 6967]
metabase        |   [clojure.core.protocols$fn__8283$G__8278__8292 invoke ""protocols.clj"" 174]
metabase        |   [clojure.core$reduce_kv invokeStatic ""core.clj"" 6998]
metabase        |   [clojure.core$reduce_kv invoke ""core.clj"" 6989]
metabase        |   [metabase.lib.util.match.impl$replace_in_collection invokeStatic ""impl.cljc"" 52]
metabase        |   [metabase.lib.util.match.impl$replace_in_collection invoke ""impl.cljc"" 47]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info_STAR_$replace_67500__67501$fn__67508
metabase        |    invoke
metabase        |    ""add_alias_info.clj""
metabase        |    504]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info_STAR_$replace_67500__67501
metabase        |    invoke
metabase        |    ""add_alias_info.clj""
metabase        |    504]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info_STAR_ invokeStatic ""add_alias_info.clj"" 504]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info_STAR_ invoke ""add_alias_info.clj"" 501]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info$fn__67518 invoke ""add_alias_info.clj"" 548]
metabase        |   [clojure.walk$walk invokeStatic ""walk.clj"" 50]
metabase        |   [clojure.walk$postwalk invokeStatic ""walk.clj"" 53]
metabase        |   [clojure.walk$postwalk invoke ""walk.clj"" 53]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info invokeStatic ""add_alias_info.clj"" 543]
metabase        |   [metabase.query_processor.util.add_alias_info$add_alias_info invoke ""add_alias_info.clj"" 514]
metabase        |   [metabase.driver.sql.query_processor$fn__69105 invokeStatic ""query_processor.clj"" 1817]
metabase        |   [metabase.driver.sql.query_processor$fn__69105 invoke ""query_processor.clj"" 1815]
metabase        |   [clojure.lang.MultiFn invoke ""MultiFn.java"" 234]
metabase        |   [metabase.driver.sql.query_processor$mbql__GT_honeysql69107__69109 invokeStatic ""query_processor.clj"" 1827]
metabase        |   [metabase.driver.sql.query_processor$mbql__GT_honeysql69107__69109 invoke ""query_processor.clj"" 1822]
metabase        |   [metabase.driver.sql.query_processor$mbql__GT_native69118__69119 invokeStatic ""query_processor.clj"" 1842]
metabase        |   [metabase.driver.sql.query_processor$mbql__GT_native69118__69119 invoke ""query_processor.clj"" 1835]
metabase        |   [metabase.driver.sql$fn__86177 invokeStatic ""sql.clj"" 47]
metabase        |   [metabase.driver.sql$fn__86177 invoke ""sql.clj"" 45]
metabase        |   [clojure.lang.MultiFn invoke ""MultiFn.java"" 234]
metabase        |   [metabase.query_processor.compile$compile_STAR_ invokeStatic ""compile.clj"" 24]
metabase        |   [metabase.query_processor.compile$compile_STAR_ invoke ""compile.clj"" 20]
metabase        |   [metabase.query_processor.compile$compile_preprocessed74583__74584$fn__74585 invoke ""compile.clj"" 32]
metabase        |   [metabase.query_processor.setup$do_with_qp_setup73972__73973 invokeStatic ""setup.clj"" 225]
metabase        |   [metabase.query_processor.setup$do_with_qp_setup73972__73973 invoke ""setup.clj"" 216]
metabase        |   [metabase.query_processor.compile$compile_preprocessed74583__74584 invokeStatic ""compile.clj"" 30]
metabase        |   [metabase.query_processor.compile$compile_preprocessed74583__74584 invoke ""compile.clj"" 26]
metabase        |   [metabase.query_processor.compile$attach_compiled_query74595__74596 invokeStatic ""compile.clj"" 54]
metabase        |   [metabase.query_processor.compile$attach_compiled_query74595__74596 invoke ""compile.clj"" 45]
metabase        |   [metabase.query_processor$process_query_STAR__STAR_ invokeStatic ""query_processor.clj"" 47]
metabase        |   [metabase.query_processor$process_query_STAR__STAR_ invoke ""query_processor.clj"" 44]
metabase        |   [metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$fn__91340$handle_audit_app_internal_queries__91341$fn__91342
metabase        |    invoke
metabase        |    ""handle_audit_queries.clj""
metabase        |    145]
metabase        |   [metabase.query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__73456
metabase        |    invoke
metabase        |    ""enterprise.clj""
metabase        |    103]
metabase        |   [metabase.query_processor.middleware.process_userland_query$process_userland_query_middleware78697__78698$fn__78699
metabase        |    invoke
metabase        |    ""process_userland_query.clj""
metabase        |    204]
metabase        |   [metabase.query_processor.middleware.catch_exceptions$catch_exceptions78762__78763$fn__78764
metabase        |    invoke
metabase        |    ""catch_exceptions.clj""
metabase        |    125]
metabase        |   [metabase.query_processor$process_query78803__78804$fn__78805 invoke ""query_processor.clj"" 80]
metabase        |   [metabase.query_processor.setup$do_with_canceled_chan73967__73968$fn__73969 invoke ""setup.clj"" 189]
metabase        |   [metabase.query_processor.setup$do_with_database_local_settings73960__73961$fn__73962 invoke ""setup.clj"" 181]
metabase        |   [metabase.query_processor.setup$do_with_driver73953__73954$fn__73955$fn__73956 invoke ""setup.clj"" 166]
metabase        |   [metabase.driver$do_with_driver invokeStatic ""driver.clj"" 106]
metabase        |   [metabase.driver$do_with_driver invoke ""driver.clj"" 101]
metabase        |   [metabase.query_processor.setup$do_with_driver73953__73954$fn__73955 invoke ""setup.clj"" 165]
metabase        |   [metabase.query_processor.setup$do_with_metadata_provider73944__73945$fn__73946$fn__73949 invoke ""setup.clj"" 151]
metabase        |   [metabase.query_processor.store$do_with_metadata_provider59845__59846 invokeStatic ""store.clj"" 170]
metabase        |   [metabase.query_processor.store$do_with_metadata_provider59845__59846 invoke ""store.clj"" 150]
metabase        |   [metabase.query_processor.store$do_with_metadata_provider59845__59846 invokeStatic ""store.clj"" 159]
metabase        |   [metabase.query_processor.store$do_with_metadata_provider59845__59846 invoke ""store.clj"" 150]
metabase        |   [metabase.query_processor.setup$do_with_metadata_provider73944__73945$fn__73946 invoke ""setup.clj"" 150]
metabase        |   [metabase.query_processor.setup$do_with_resolved_database73934__73935$fn__73936 invoke ""setup.clj"" 128]
metabase        |   [metabase.query_processor.setup$do_with_qp_setup73972__73973 invokeStatic ""setup.clj"" 232]
metabase        |   [metabase.query_processor.setup$do_with_qp_setup73972__73973 invoke ""setup.clj"" 216]
metabase        |   [metabase.query_processor$process_query78803__78804 invokeStatic ""query_processor.clj"" 78]
metabase        |   [metabase.query_processor$process_query78803__78804 invoke ""query_processor.clj"" 71]
metabase        |   [metabase.query_processor$process_query78803__78804 invokeStatic ""query_processor.clj"" 74]
metabase        |   [metabase.query_processor$process_query78803__78804 invoke ""query_processor.clj"" 71]
metabase        |   [metabase.models.params.custom_values$values_from_card103089__103090 invokeStatic ""custom_values.clj"" 117]
metabase        |   [metabase.models.params.custom_values$values_from_card103089__103090 invoke ""custom_values.clj"" 96]
metabase        |   [metabase.models.params.custom_values$card_values invokeStatic ""custom_values.clj"" 129]
metabase        |   [metabase.models.params.custom_values$card_values invoke ""custom_values.clj"" 124]
metabase        |   [metabase.models.params.custom_values$parameter__GT_values103097__103098 invokeStatic ""custom_values.clj"" 152]
metabase        |   [metabase.models.params.custom_values$parameter__GT_values103097__103098 invoke ""custom_values.clj"" 139]
metabase        |   [metabase.api.dataset$parameter_values invokeStatic ""dataset.clj"" 216]
metabase        |   [metabase.api.dataset$parameter_values invoke ""dataset.clj"" 212]
metabase        |   [metabase.api.dataset$fn__103184 invokeStatic ""dataset.clj"" 225]
metabase        |   [metabase.api.dataset$fn__103184 invoke ""dataset.clj"" 220]
metabase        |   [compojure.core$wrap_response$fn__54251 invoke ""core.clj"" 160]
metabase        |   [compojure.core$wrap_route_middleware$fn__54235 invoke ""core.clj"" 132]
metabase        |   [compojure.core$wrap_route_info$fn__54240 invoke ""core.clj"" 139]
metabase        |   [compojure.core$wrap_route_matches$fn__54244 invoke ""core.clj"" 151]
metabase        |   [clojure.lang.Var invoke ""Var.java"" 395]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$wrap_route_matches$fn__54244 invoke ""core.clj"" 152]
metabase        |   [clojure.lang.Var invoke ""Var.java"" 395]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$wrap_route_matches$fn__54244 invoke ""core.clj"" 152]
metabase        |   [clojure.lang.Var invoke ""Var.java"" 395]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$wrap_route_matches$fn__54244 invoke ""core.clj"" 152]
metabase        |   [clojure.lang.Var invoke ""Var.java"" 395]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263 invoke ""core.clj"" 200]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [metabase.server.middleware.auth$enforce_authentication$fn__105588 invoke ""auth.clj"" 18]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263 invoke ""core.clj"" 200]
metabase        |   [compojure.core$make_context$handler__54291 invoke ""core.clj"" 290]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 300]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$wrap_route_matches$fn__54244 invoke ""core.clj"" 153]
metabase        |   [clojure.lang.Var invoke ""Var.java"" 395]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 199]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 199]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263 invoke ""core.clj"" 200]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 199]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263 invoke ""core.clj"" 200]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263 invoke ""core.clj"" 200]
metabase        |   [metabase.api.routes$fn__110258$fn__110259 invoke ""routes.clj"" 72]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.lang.AFunction$1 doInvoke ""AFunction.java"" 33]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263 invoke ""core.clj"" 200]
metabase        |   [clojure.lang.AFn applyToHelper ""AFn.java"" 160]
metabase        |   [clojure.lang.AFn applyTo ""AFn.java"" 144]
metabase        |   [clojure.core$apply invokeStatic ""core.clj"" 667]
metabase        |   [clojure.core$apply invoke ""core.clj"" 662]
metabase        |   [metabase.server.routes$fn__111014$fn__111015 doInvoke ""routes.clj"" 67]
metabase        |   [clojure.lang.RestFn invoke ""RestFn.java"" 439]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263 invoke ""core.clj"" 200]
metabase        |   [compojure.core$make_context$handler__54291 invoke ""core.clj"" 290]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 300]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$wrap_route_matches$fn__54244 invoke ""core.clj"" 153]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$wrap_route_matches$fn__54244 invoke ""core.clj"" 153]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$wrap_route_matches$fn__54244 invoke ""core.clj"" 153]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$wrap_route_matches$fn__54244 invoke ""core.clj"" 153]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 199]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 199]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 199]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263 invoke ""core.clj"" 200]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263 invoke ""core.clj"" 200]
metabase        |   [compojure.core$make_context$handler__54291 invoke ""core.clj"" 290]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 300]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263$f__54264$respond_SINGLEQUOTE___54265 invoke ""core.clj"" 197]
metabase        |   [compojure.core$make_context$fn__54295 invoke ""core.clj"" 301]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263 invoke ""core.clj"" 200]
metabase        |   [compojure.core$routes$fn__54263$f__54264 invoke ""core.clj"" 198]
metabase        |   [compojure.core$routes$fn__54263 invoke ""core.clj"" 200]
metabase        |   [metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__107717 invoke ""exceptions.clj"" 111]
metabase        |   [metabase.server.middleware.exceptions$catch_api_exceptions$fn__107714 invoke ""exceptions.clj"" 100]
metabase        |   [metabase.server.middleware.log$log_api_call$fn__113576$fn__113577$fn__113578 invoke ""log.clj"" 233]
metabase        |   [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invokeStatic ""diagnostic.clj"" 17]
metabase        |   [metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info invoke ""diagnostic.clj"" 12]
metabase        |   [metabase.server.middleware.log$log_api_call$fn__113576$fn__113577 invoke ""log.clj"" 224]
metabase        |   [toucan2.execute$do_with_call_counts invokeStatic ""execute.clj"" 112]
metabase        |   [toucan2.execute$do_with_call_counts invoke ""execute.clj"" 103]
metabase        |   [metabase.server.middleware.log$log_api_call$fn__113576 invoke ""log.clj"" 223]
metabase        |   [metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__120525 invoke ""browser_cookie.clj"" 40]
metabase        |   [metabase.server.middleware.security$add_security_headers$fn__107673 invoke ""security.clj"" 273]
metabase        |   [ring.middleware.json$wrap_json_body$fn__120784 invoke ""json.clj"" 64]
metabase        |   [metabase.server.middleware.offset_paging$handle_paging$fn__97183 invoke ""offset_paging.clj"" 56]
metabase        |   [metabase.server.middleware.json$wrap_streamed_json_response$fn__55896 invoke ""json.clj"" 88]
metabase        |   [ring.middleware.keyword_params$wrap_keyword_params$fn__120873 invoke ""keyword_params.clj"" 55]
metabase        |   [ring.middleware.params$wrap_params$fn__120892 invoke ""params.clj"" 77]
metabase        |   [metabase.server.middleware.misc$maybe_set_site_url$fn__70147 invoke ""misc.clj"" 59]
metabase        |   [metabase.server.middleware.session$reset_session_timeout$fn__72235 invoke ""session.clj"" 566]
metabase        |   [metabase.server.middleware.session$bind_current_user$fn__72201$fn__72202 invoke ""session.clj"" 459]
metabase        |   [metabase.server.middleware.session$do_with_current_user invokeStatic ""session.clj"" 438]
metabase        |   [metabase.server.middleware.session$do_with_current_user invoke ""session.clj"" 421]
metabase        |   [metabase.server.middleware.session$bind_current_user$fn__72201 invoke ""session.clj"" 458]
metabase        |   [metabase.server.middleware.session$wrap_current_user_info$fn__72178 invoke ""session.clj"" 383]
metabase        |   [metabase.analytics.sdk$embedding_mw$embedding_mw_fn__78511 invoke ""sdk.clj"" 63]
metabase        |   [metabase.server.middleware.session$wrap_session_id$fn__72150 invoke ""session.clj"" 261]
metabase        |   [metabase.server.middleware.auth$wrap_static_api_key$fn__105596 invoke ""auth.clj"" 33]
metabase        |   [ring.middleware.cookies$wrap_cookies$fn__120712 invoke ""cookies.clj"" 200]
metabase        |   [metabase.server.middleware.misc$add_content_type$fn__70129 invoke ""misc.clj"" 28]
metabase        |   [metabase.server.middleware.misc$disable_streaming_buffering$fn__70155 invoke ""misc.clj"" 75]
metabase        |   [ring.middleware.gzip$wrap_gzip$fn__120754 invoke ""gzip.clj"" 86]
metabase        |   [metabase.server.middleware.request_id$wrap_request_id$fn__111442 invoke ""request_id.clj"" 9]
metabase        |   [metabase.server.middleware.misc$bind_request$fn__70158 invoke ""misc.clj"" 91]
metabase        |   [metabase.server.middleware.ssl$redirect_to_https_middleware$fn__120541 invoke ""ssl.clj"" 41]
metabase        |   [metabase.server$async_proxy_handler$fn__56865 invoke ""server.clj"" 77]
metabase        |   [metabase.server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a handle nil -1]
metabase        |   [org.eclipse.jetty.server.handler.StatisticsHandler handle ""StatisticsHandler.java"" 173]
metabase        |   [org.eclipse.jetty.server.handler.HandlerWrapper handle ""HandlerWrapper.java"" 122]
metabase        |   [org.eclipse.jetty.server.Server handle ""Server.java"" 563]
metabase        |   [org.eclipse.jetty.server.HttpChannel$RequestDispatchable dispatch ""HttpChannel.java"" 1598]
metabase        |   [org.eclipse.jetty.server.HttpChannel dispatch ""HttpChannel.java"" 753]
metabase        |   [org.eclipse.jetty.server.HttpChannel handle ""HttpChannel.java"" 501]
metabase        |   [org.eclipse.jetty.server.HttpConnection onFillable ""HttpConnection.java"" 287]
metabase        |   [org.eclipse.jetty.io.AbstractConnection$ReadCallback succeeded ""AbstractConnection.java"" 314]
metabase        |   [org.eclipse.jetty.io.FillInterest fillable ""FillInterest.java"" 100]
metabase        |   [org.eclipse.jetty.io.SelectableChannelEndPoint$1 run ""SelectableChannelEndPoint.java"" 53]
metabase        |   [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy runTask ""AdaptiveExecutionStrategy.java"" 421]
metabase        |   [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy consumeTask ""AdaptiveExecutionStrategy.java"" 390]
metabase        |   [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy tryProduce ""AdaptiveExecutionStrategy.java"" 277]
metabase        |   [org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy run ""AdaptiveExecutionStrategy.java"" 199]
metabase        |   [org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread run ""ReservedThreadExecutor.java"" 411]
metabase        |   [org.eclipse.jetty.util.thread.QueuedThreadPool runJob ""QueuedThreadPool.java"" 969]
metabase        |   [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner doRunJob ""QueuedThreadPool.java"" 1194]
metabase        |   [org.eclipse.jetty.util.thread.QueuedThreadPool$Runner run ""QueuedThreadPool.java"" 1149]
metabase        |   [java.lang.Thread run nil -1]],
metabase        |  :cause ""Cannot determine the source table or query for Field clause [:field \""some custom\"" {:base-type :type/Text}]"",
metabase        |  :data
metabase        |  {:type :invalid-query,
metabase        |   :clause [:field ""some custom"" {:base-type :type/Text}],
metabase        |   :query
metabase        |   {:source-table 3,
metabase        |    :breakout [[:field ""some custom"" {:base-type :type/Text}]],
metabase        |    :expressions
metabase        |    {""some custom""
metabase        |     [:concat
metabase        |      [:field 51 {:base-type :type/Text, :source-field 38, :join-alias ""people__via__user_id""}]
metabase        |      [:field 58 {:base-type :type/Text, :source-field 37, :join-alias ""products__via__product_id""}]]},
metabase        |    :limit 1000,
metabase        |    :order-by [[:asc [:field ""some custom"" {:base-type :type/Text}]]],
metabase        |    :joins
metabase        |    [{:alias ""people__via__user_id"",
metabase        |      :strategy :left-join,
metabase        |      :fk-field-id 38,
metabase        |      :condition [:= [:field 38 nil] [:field 48 {:join-alias ""people__via__user_id""}]],
metabase        |      :source-table 5}
metabase        |     {:alias ""products__via__product_id"",
metabase        |      :strategy :left-join,
metabase        |      :fk-field-id 37,
metabase        |      :condition [:= [:field 37 nil] [:field 60 {:join-alias ""products__via__product_id""}]],
metabase        |      :source-table 1}],
metabase        |    :filter
metabase        |    [:and
metabase        |     [:!= [:field ""some custom"" {:base-type :type/Text}] [:value nil {:base_type :type/Text}]]
metabase        |     [:!= [:field ""some custom"" {:base-type :type/Text}] [:value """" {:base_type :type/Text}]]]}},
metabase        |  :message
metabase        |  ""Error compiling query: Cannot determine the source table or query for Field clause [:field \""some custom\"" {:base-type :type/Text}]"",
metabase        |  :query
metabase        |  {:database 1,
metabase        |   :middleware {:disable-remaps? true},
metabase        |   :type :query,
metabase        |   :query
metabase        |   {:source-table 3,
metabase        |    :breakout [[:field ""some custom"" {:base-type :type/Text}]],
metabase        |    :expressions
metabase        |    {""some custom""
metabase        |     [:concat
metabase        |      [:field 51 {:base-type :type/Text, :source-field 38, :join-alias ""people__via__user_id""}]
metabase        |      [:field 58 {:base-type :type/Text, :source-field 37, :join-alias ""products__via__product_id""}]]},
metabase        |    :limit 1000,
metabase        |    :order-by [[:asc [:field ""some custom"" {:base-type :type/Text}]]],
metabase        |    :joins
metabase        |    [{:alias ""people__via__user_id"",
metabase        |      :strategy :left-join,
metabase        |      :fk-field-id 38,
metabase        |      :condition [:= [:field 38 nil] [:field 48 {:join-alias ""people__via__user_id""}]],
metabase        |      :source-table 5}
metabase        |     {:alias ""products__via__product_id"",
metabase        |      :strategy :left-join,
metabase        |      :fk-field-id 37,
metabase        |      :condition [:= [:field 37 nil] [:field 60 {:join-alias ""products__via__product_id""}]],
metabase        |      :source-table 1}],
metabase        |    :filter
metabase        |    [:and
metabase        |     [:!= [:field ""some custom"" {:base-type :type/Text}] [:value nil {:base_type :type/Text}]]
metabase        |     [:!= [:field ""some custom"" {:base-type :type/Text}] [:value """" {:base_type :type/Text}]]]}}}
metabase        | 

### Information about your Metabase installation

```JSON
52.8
```

### Severity

P2

### Additional context

This is a regression, I used this workaround in previous versions to get filter values from custom columns",paoliniluis,2025-02-06 10:38:12+00:00,[],2025-02-06 17:57:07+00:00,2025-02-06 17:55:58+00:00,https://github.com/metabase/metabase/issues/53288,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2640599841, 'issue_id': 2835154429, 'author': 'bshepherdson', 'body': 'This seems like a duplicate of [https://github.com/metabase/metabase/issues/44703](https://github.com/metabase/metabase/issues/44703)', 'created_at': datetime.datetime(2025, 2, 6, 17, 57, 6, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2025-02-06 17:57:06 UTC): This seems like a duplicate of [https://github.com/metabase/metabase/issues/44703](https://github.com/metabase/metabase/issues/44703)

"
2834933862,issue,closed,not_planned,Docker Pulling Error,"### Describe the bug

I got error when pulling the latest docker metabase. 

here is the bash i run : ""docker pull metabase/metabase:latest"", 

And here is the error log I received : ""error pulling image configuration: download failed after attempts=6: received unexpected HTTP status: 500 Internal Server Error""

### To Reproduce

1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Can not access to Admin to get the Metabase installation
```

### Severity

Can not compose. the docker on EC2

### Additional context

_No response_",beto1810,2025-02-06 08:59:54+00:00,[],2025-02-06 09:07:30+00:00,2025-02-06 09:07:28+00:00,https://github.com/metabase/metabase/issues/53286,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2639222441, 'issue_id': 2834933862, 'author': 'paoliniluis', 'body': 'This is a docker error (their servers might be down). Please retry', 'created_at': datetime.datetime(2025, 2, 6, 9, 7, 28, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-02-06 09:07:28 UTC): This is a docker error (their servers might be down). Please retry

"
2834256022,issue,open,,[Backend modularization] `legacy-mbql`,DEV-249,camsaul,2025-02-06 00:54:38+00:00,[],2025-02-07 22:17:02+00:00,,https://github.com/metabase/metabase/issues/53281,"[('.Backend', ''), ('.Team/DevEx', '')]",[],
2834156180,issue,open,,Dashboard parameter selection uses incorrect style on foreign keys,"### Describe the bug

When you have a dashboard parameter hooked up to a foreign key, it seems to look at the original column in the other table instead of the foreign key column in the current table when deciding what sort of dropdown to show (plain text box vs list of values).

### To Reproduce

1. Set up ""Filtering on this field"" table metadata on the sample database such that orders.product_id uses ""a list of all values"" and products.id uses ""plain input box""
2. Create dashboard with the question that is just ""count orders""
3. Create id parameter and hook it up to orders.product_id
4. Save dashboard
5. Try to use the id parameter and see that it is using a plain input box

### Expected behavior

I would expect it to use a list of all values instead of a plain input box, given that orders.product_id was explicitly set to use that sort of dropdown

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-16"",
      ""src_hash"": ""a8b23670b1827cdb0a04650edac0dfff4c6de1d5"",
      ""tag"": ""v0.53.0-SNAPSHOT"",
      ""hash"": ""bea3c3d""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.15 (Homebrew)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.5""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""15.1.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

Very confusing while debugging other problems

### Additional context

_No response_",wzimrin,2025-02-05 23:19:37+00:00,[],2025-02-06 03:30:51+00:00,,https://github.com/metabase/metabase/issues/53275,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2638745144, 'issue_id': 2834156180, 'author': 'ranquild', 'body': 'The same root cause as in https://github.com/metabase/metabase/issues/21528. Please read https://github.com/metabase/metabase/issues/21528#issuecomment-2426791607. The problem is that we follow FKs when the PK is available, and therefore ignore settings on the FK.', 'created_at': datetime.datetime(2025, 2, 6, 3, 30, 50, tzinfo=datetime.timezone.utc)}]","ranquild on (2025-02-06 03:30:50 UTC): The same root cause as in https://github.com/metabase/metabase/issues/21528. Please read https://github.com/metabase/metabase/issues/21528#issuecomment-2426791607. The problem is that we follow FKs when the PK is available, and therefore ignore settings on the FK.

"
2834084571,issue,open,,Make sure elements support ARIA attributes,"**Is your feature request related to a problem? Please describe.**
To make Metabase more accessible by having elements use only ARIA-supported attributes. 

More information: https://dequeuniversity.com/rules/axe/4.10/aria-allowed-attr?application=AxeChrome

aria-expanded=""false"" appears in multiple elements like
- New button
- settings button
- view-only label 
- ... menu on a question 
- column name headers 
-  cloud icon for downloads

The aria-expanded property is currently on the button, but they believe it should be on the div. 

**How important is this feature to you?**
Customer request 

Related: https://github.com/metabase/metabase/issues/1462",jessicaul,2025-02-05 22:23:30+00:00,[],2025-02-07 18:51:40+00:00,,https://github.com/metabase/metabase/issues/53270,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Type:New Feature', ''), ('.Frontend', ''), ('Misc/Accessibility', '')]",[],
2833955616,issue,open,,We shouldn't preserve google sign in (not logout users) and respect MAX_SESSION_AGE and MB_SESSION_TIMEOUT,"### Describe the bug

Users are often logged out from Metabase when signing in using Google.
As almost all applications, we should preserve google login and respect our own max_session_age and session_timeout variables.

This means most users will have to login only every 2 weeks, not multiple times a day.

### To Reproduce

1. Sign in with Google
2. Close all tabs and wait a few minutes
3. Will be prompted to auth again


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
53
```

### Severity

P2

### Additional context

_No response_",luizarakaki,2025-02-05 21:02:32+00:00,[],2025-02-05 21:04:09+00:00,,https://github.com/metabase/metabase/issues/53264,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Administration/Auth', 'Google Auth, LDAP, pw+email login'), ('.Backend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2638015659, 'issue_id': 2833955616, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-6231/we-shouldnt-preserve-google-sign-in-not-logout-users-and-respect-max"">TRI-6231 We shouldn\'t preserve google sign in (not logout users) and respect MAX_SESSION_AGE and MB_SESSION_TIMEOUT</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 21, 2, 35, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 21:02:35 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-6231/we-shouldnt-preserve-google-sign-in-not-logout-users-and-respect-max"">TRI-6231 We shouldn't preserve google sign in (not logout users) and respect MAX_SESSION_AGE and MB_SESSION_TIMEOUT</a></p>

"
2833736523,issue,open,,Plot an axis at 0 if there are negative values and a positive goal,"**Is your feature request related to a problem? Please describe.**
A chart that shows negative values and has a positive goal line currently has the bars floating in the chart or coming out of the bottom of the chart, which is a negative number and doesn't necessarily make sense. 

**Describe the solution you'd like**
Have an axis or some line at 0 for the negative bars to come out of. 

**Describe alternatives you've considered**
Creating a second chart of 0s and adding it as a series in a dashboard (not ideal though) 

**How important is this feature to you?**
Customer request. Not a deal breaker but would greatly help the visual understanding of the chart. 

**Additional context**
Example of current state: 
<img width=""1418"" alt=""Image"" src=""https://github.com/user-attachments/assets/2cccd538-c09d-46db-a00e-3745c2dad6f3"" />





",jessicaul,2025-02-05 19:00:52+00:00,[],2025-02-07 17:19:20+00:00,,https://github.com/metabase/metabase/issues/53259,"[('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Type:New Feature', ''), ('.Frontend', ''), ('.Product Input Needed', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2637778233, 'issue_id': 2833736523, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-6230/plot-an-axis-at-0-if-there-are-negative-values-and-a-positive-goal"">TRI-6230 Plot an axis at 0 if there are negative values and a positive goal</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 19, 0, 55, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 19:00:55 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-6230/plot-an-axis-at-0-if-there-are-negative-values-and-a-positive-goal"">TRI-6230 Plot an axis at 0 if there are negative values and a positive goal</a></p>

"
2833598667,issue,open,,Metabot - create API endpoint for the find-outliers tool,"**Context**

Like #53003, but for `find-outliers`.",metamben,2025-02-05 17:53:41+00:00,[],2025-02-05 17:53:45+00:00,,https://github.com/metabase/metabase/issues/53257,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]","[{'comment_id': 2637630627, 'issue_id': 2833598667, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-6229/metabot-create-api-endpoint-for-the-find-outliers-tool"">TRI-6229 Metabot - create API endpoint for the find-outliers tool</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 17, 53, 44, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 17:53:44 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-6229/metabot-create-api-endpoint-for-the-find-outliers-tool"">TRI-6229 Metabot - create API endpoint for the find-outliers tool</a></p>

"
2833596554,issue,open,,Metabot - create API endpoint for the find-metric tool,"**Context**

Like #53003, but for `find-metric`.",metamben,2025-02-05 17:52:42+00:00,[],2025-02-05 17:52:45+00:00,,https://github.com/metabase/metabase/issues/53256,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]","[{'comment_id': 2637628333, 'issue_id': 2833596554, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-6228/metabot-create-api-endpoint-for-the-find-metric-tool"">TRI-6228 Metabot - create API endpoint for the find-metric tool</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 17, 52, 44, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 17:52:44 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-6228/metabot-create-api-endpoint-for-the-find-metric-tool"">TRI-6228 Metabot - create API endpoint for the find-metric tool</a></p>

"
2833592451,issue,open,,Metabot - create API endpoint for the filter-records tool,"**Context**

Like #53003, but for `filter-records`.

",metamben,2025-02-05 17:50:54+00:00,['metamben'],2025-02-05 17:51:16+00:00,,https://github.com/metabase/metabase/issues/53255,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]","[{'comment_id': 2637623389, 'issue_id': 2833592451, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-6227/metabot-create-api-endpoint-for-the-filter-records-tool"">TRI-6227 Metabot - create API endpoint for the filter-records tool</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 17, 50, 56, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 17:50:56 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-6227/metabot-create-api-endpoint-for-the-filter-records-tool"">TRI-6227 Metabot - create API endpoint for the filter-records tool</a></p>

"
2833571968,issue,closed,completed,Metabot - create API endpoint for the generate-insight tool,"**Context**

Like #53003, but for `generate-insight`.",metamben,2025-02-05 17:40:49+00:00,['metamben'],2025-02-07 18:26:44+00:00,2025-02-07 18:26:44+00:00,https://github.com/metabase/metabase/issues/53252,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]","[{'comment_id': 2637602155, 'issue_id': 2833571968, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-6226/metabot-create-api-endpoint-for-the-generate-insight-tool"">TRI-6226 Metabot - create API endpoint for the generate-insight tool</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 17, 40, 52, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 17:40:52 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-6226/metabot-create-api-endpoint-for-the-generate-insight-tool"">TRI-6226 Metabot - create API endpoint for the generate-insight tool</a></p>

"
2833568833,issue,closed,completed,Metabot - create API endpoint for the create-dashboard-subscription tool,"**Context**

Like #53003, but for `create-dashboard-subscription`.",metamben,2025-02-05 17:39:11+00:00,['metamben'],2025-02-07 18:27:01+00:00,2025-02-07 18:27:01+00:00,https://github.com/metabase/metabase/issues/53251,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]","[{'comment_id': 2637598590, 'issue_id': 2833568833, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-6225/metabot-create-api-endpoint-for-the-create-dashboard-subscription-tool"">TRI-6225 Metabot - create API endpoint for the create-dashboard-subscription tool</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 17, 39, 14, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 17:39:14 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-6225/metabot-create-api-endpoint-for-the-create-dashboard-subscription-tool"">TRI-6225 Metabot - create API endpoint for the create-dashboard-subscription tool</a></p>

"
2833512163,issue,open,,"""Show values for this series"" option is missing on stacked bar/combo charts","### Describe the bug

When editing a bar or combo chart that has multiple series stacked, there is no option to show/hide the values for a specific series. You can do this when the chart has ""Don't Stack"" set.

With Don't Stack (expected behavior):

![Image](https://github.com/user-attachments/assets/3220dc80-c71a-46b3-9073-b53360280224)

![Image](https://github.com/user-attachments/assets/27ba346a-9f9d-4ee2-a245-b6de46554d33)

With Stack (bug?):

![Image](https://github.com/user-attachments/assets/606ca0b2-ed29-47c7-b416-dae20be7f57b)

![Image](https://github.com/user-attachments/assets/e316c3c1-1bed-43f5-8bb1-6a95e45a5946)

### To Reproduce

1. Open a bar or combo chart that has various series of data in the x-axis 
2. With Display > Stacking set to `Don't Stack`, note how under each series you can see the ""Show values for this series""
3. With Display > Stacking set to `Stack`, note how now the ""Show values for this series"" option goes missing for all series.

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""snowflake""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-21"",
      ""tag"": ""v1.52.7"",
      ""hash"": ""ddbc480""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.3""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.119-129.201.amzn2023.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

Annoying

### Additional context

_No response_",natebessa,2025-02-05 17:11:11+00:00,[],2025-02-06 18:31:57+00:00,,https://github.com/metabase/metabase/issues/53248,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2637535210, 'issue_id': 2833512163, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-6223/show-values-for-this-series-option-is-missing-on-stacked-barcombo"">TRI-6223 ""Show values for this series"" option is missing on stacked bar/combo charts</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 17, 11, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2639785825, 'issue_id': 2833512163, 'author': 'lorem--ipsum', 'body': 'Hi @natebessa, thank you for the report. If I understand properly the issue, you\'re trying to display values for individual segments of stacks, only for certain series, correct? Something like this:\n\n<img width=""1303"" alt=""Image"" src=""https://github.com/user-attachments/assets/ed07d49c-cdbb-4fad-81f6-3093f26b086d"" />\n\nbut with the ability to hide the values for one or more arbitrary series?', 'created_at': datetime.datetime(2025, 2, 6, 13, 9, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2640690632, 'issue_id': 2833512163, 'author': 'natebessa', 'body': '@lorem--ipsum In my use case specifically, I have a chart is a combo of lines + a stacked bar, and I wanted to hide values from the lines and show the values for the stacked bar. I could do that if we were able to use the Show Values For This Series in a chart with stacked bars.', 'created_at': datetime.datetime(2025, 2, 6, 18, 30, 51, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 17:11:14 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-6223/show-values-for-this-series-option-is-missing-on-stacked-barcombo"">TRI-6223 ""Show values for this series"" option is missing on stacked bar/combo charts</a></p>

lorem--ipsum on (2025-02-06 13:09:14 UTC): Hi @natebessa, thank you for the report. If I understand properly the issue, you're trying to display values for individual segments of stacks, only for certain series, correct? Something like this:

<img width=""1303"" alt=""Image"" src=""https://github.com/user-attachments/assets/ed07d49c-cdbb-4fad-81f6-3093f26b086d"" />

but with the ability to hide the values for one or more arbitrary series?

natebessa (Issue Creator) on (2025-02-06 18:30:51 UTC): @lorem--ipsum In my use case specifically, I have a chart is a combo of lines + a stacked bar, and I wanted to hide values from the lines and show the values for the stacked bar. I could do that if we were able to use the Show Values For This Series in a chart with stacked bars.

"
2833500603,issue,closed,completed,fix value of `enable-embedding-sdk`,"### Describe the bug

we set this to the value of `enable-embedding`. But we prefer to set it to who has actually enabled sdk specific embedding. We will leave it alone if there is no `enable-embedding-sdk` value in the setting table (default is false and that is good).

If there is a value,  if there is a value for `embedding-app-origins-sdk` we will set `enable-embedding-sdk` to true. This is a good proxy for people have configured and tried the sdk.

### To Reproduce

[https://metaboat.slack.com/archives/C063Q3F1HPF/p1738740652017869](https://metaboat.slack.com/archives/C063Q3F1HPF/p1738740652017869)

### Expected behavior

we should know who has enabled the sdk embedding or not.

### Logs

*No response*

### Information about your Metabase installation

```JSON
n/a
```

### Severity

necessary

### Additional context

*No response*",dpsutton,2025-02-05 17:05:49+00:00,['escherize'],2025-02-06 20:23:57+00:00,2025-02-06 20:23:57+00:00,https://github.com/metabase/metabase/issues/53247,"[('Type:Bug', 'Product defects'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2637521992, 'issue_id': 2833500603, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-6222/fix-value-of-enable-embedding-sdk"">TRI-6222 fix value of `enable-embedding-sdk`</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 17, 5, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2638038437, 'issue_id': 2833500603, 'author': 'escherize', 'body': ""> if there is a value for embedding-app-origins-sdk we will set enable-embedding-sdk to true. This is a good proxy for people have configured and tried the sdk.\n\nThis is backwards based on https://www.notion.so/metabase/enable-embedding-sdk-snafu-19169354c901802f8bb5db7436cb3393?pvs=4#19169354c901805eb872fe29f69db5d9, where we say: set `enable-embedding-sdk` to false if there is NOT a value for `embedding-app-origins-sdk`. I've updated the PR to match the behavior outlined in notion"", 'created_at': datetime.datetime(2025, 2, 5, 21, 15, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2639326233, 'issue_id': 2833500603, 'author': 'albertoperdomo', 'body': ""Given we want to flip this back to false for everyone who's not actively using it, I think the description in Notion is correct:\n\nIf the setting `enable-embedding-sdk` exists in the table (non-default value, so true), and there is no setting `embedding-app-origins-sdk` (other value than localhost) we set `enable-embedding-sdk` to false."", 'created_at': datetime.datetime(2025, 2, 6, 9, 49, 55, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 17:05:52 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-6222/fix-value-of-enable-embedding-sdk"">TRI-6222 fix value of `enable-embedding-sdk`</a></p>

escherize (Assginee) on (2025-02-05 21:15:58 UTC): This is backwards based on https://www.notion.so/metabase/enable-embedding-sdk-snafu-19169354c901802f8bb5db7436cb3393?pvs=4#19169354c901805eb872fe29f69db5d9, where we say: set `enable-embedding-sdk` to false if there is NOT a value for `embedding-app-origins-sdk`. I've updated the PR to match the behavior outlined in notion

albertoperdomo on (2025-02-06 09:49:55 UTC): Given we want to flip this back to false for everyone who's not actively using it, I think the description in Notion is correct:

If the setting `enable-embedding-sdk` exists in the table (non-default value, so true), and there is no setting `embedding-app-origins-sdk` (other value than localhost) we set `enable-embedding-sdk` to false.

"
2833201043,issue,open,,Renaming Custom Column Breaks Downstream Questions that Reference it in Expressions,"### Describe the bug

If you create a question with a custom column then refer to that column in a custom expression in a downstream question, renaming it will break downstream questions.

### To Reproduce

1. Build Question1 on sample orders that contains a custom expression
2. Build Question2 on Question1; include a custom column that references the expression from Q1
3. Rename custom column in Q1
4. Navigate back to Q2 and see error

### Expected behavior

Renaming custom column shouldn't break downstream references to the column. 

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""mysql""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-27"",
      ""tag"": ""v1.52.8"",
      ""hash"": ""3cbfc1e""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MySQL"",
        ""version"": ""8.2.0""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.167.4-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

If a lot of downstream questions break this is very difficult to correct

### Additional context

_No response_",ixipixi,2025-02-05 15:02:46+00:00,[],2025-02-07 19:53:34+00:00,,https://github.com/metabase/metabase/issues/53234,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Notebook/Custom Column', '')]","[{'comment_id': 2637113347, 'issue_id': 2833201043, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-6218/renaming-custom-column-breaks-downstream-questions-that-reference-it"">TRI-6218 Renaming Custom Column Breaks Downstream Questions that Reference it in Expressions</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 15, 2, 49, tzinfo=datetime.timezone.utc)}, {'comment_id': 2638137479, 'issue_id': 2833201043, 'author': 'bshepherdson', 'body': 'Deeply agree! This will be fixed as part of the field refs overhaul: [https://github.com/metabase/metabase/issues/49182](https://github.com/metabase/metabase/issues/49182)', 'created_at': datetime.datetime(2025, 2, 5, 22, 5, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2643051415, 'issue_id': 2833201043, 'author': 'ixipixi', 'body': ""Also, FWIW, this was broken in 51 but seemed to work fine in 49. Haven't tried 50 yet. Any idea what may have changed @bshepherdson ?"", 'created_at': datetime.datetime(2025, 2, 7, 14, 13, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2643882075, 'issue_id': 2833201043, 'author': 'bshepherdson', 'body': 'That\'s strange, since this issue is pretty fundamental to MBQL. I would have expected it to be broken going back forever.\n\nPreviously there was a special case where if the original custom expression were a no-op, like `= [Subtotal]` then we\'d reference it by ID rather than by name. Maybe that\'s how this ""worked"" in earlier versions?\n\nTo test this properly on older versions, the expression needs to be real, eg. `= [Subtotal] * 2`.', 'created_at': datetime.datetime(2025, 2, 7, 19, 35, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2643963545, 'issue_id': 2833201043, 'author': 'ixipixi', 'body': ""@bshepherdson the test definitely could've differed between the two versions."", 'created_at': datetime.datetime(2025, 2, 7, 19, 53, 33, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 15:02:49 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-6218/renaming-custom-column-breaks-downstream-questions-that-reference-it"">TRI-6218 Renaming Custom Column Breaks Downstream Questions that Reference it in Expressions</a></p>

bshepherdson on (2025-02-05 22:05:03 UTC): Deeply agree! This will be fixed as part of the field refs overhaul: [https://github.com/metabase/metabase/issues/49182](https://github.com/metabase/metabase/issues/49182)

ixipixi (Issue Creator) on (2025-02-07 14:13:13 UTC): Also, FWIW, this was broken in 51 but seemed to work fine in 49. Haven't tried 50 yet. Any idea what may have changed @bshepherdson ?

bshepherdson on (2025-02-07 19:35:09 UTC): That's strange, since this issue is pretty fundamental to MBQL. I would have expected it to be broken going back forever.

Previously there was a special case where if the original custom expression were a no-op, like `= [Subtotal]` then we'd reference it by ID rather than by name. Maybe that's how this ""worked"" in earlier versions?

To test this properly on older versions, the expression needs to be real, eg. `= [Subtotal] * 2`.

ixipixi (Issue Creator) on (2025-02-07 19:53:33 UTC): @bshepherdson the test definitely could've differed between the two versions.

"
2833166771,issue,open,,long question name breaks save question modal layout,"if you want to save a question with the long name, it becomes wider than a save question modal itself

![Image](https://github.com/user-attachments/assets/f452a5d0-27cc-42fd-9e4a-934541092727)

we need to use mantine components in this modal",uladzimirdev,2025-02-05 14:50:06+00:00,['uladzimirdev'],2025-02-05 14:50:11+00:00,,https://github.com/metabase/metabase/issues/53231,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/Querying', '')]","[{'comment_id': 2637072413, 'issue_id': 2833166771, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-6217/long-question-name-breaks-save-question-modal-layout"">TRI-6217 long question name breaks save question modal layout</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 14, 50, 10, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 14:50:10 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-6217/long-question-name-breaks-save-question-modal-layout"">TRI-6217 long question name breaks save question modal layout</a></p>

"
2832648942,issue,closed,completed,[Epic] New custom expression editor,"### Links

- [product doc](https://www.notion.so/metabase/New-custom-expression-editor-5ea71d8f256f4b81bd28697cbe65294a)
- [technical design doc](https://www.notion.so/metabase/Tech-Doc-New-custom-expression-editor-18169354c9018022b579fc16bbc0da64)
- [testing plan](https://www.notion.so/metabase/Testing-Plan-New-custom-expression-editor-19169354c90180918c2aeb557ad2a0a1)

### Implementation Plan

```[tasklist]
#### Milestone 1: Single line editor
- [ ] Write a lezer grammar for the custom expression syntax, to be used by CodeMirror
- [ ] Replace ACE with CodeMirror
- [ ] Port the suggestions code to CodeMirror
- [ ] Render suggestions and helptext in new custom popover
- [ ] Fix all e2e tests to use new CodeMirror helpers
```

```[tasklist]
#### Milestone 2: Multi line editor
- [ ] Multi-line formatter for the custom expression syntax
- [ ] Update UI to multi-line editor
- [ ] Add function browser to the multiline editor
- [ ] Render custom diagnostics
```
",romeovs,2025-02-05 11:19:09+00:00,['romeovs'],2025-02-06 11:07:09+00:00,2025-02-06 11:07:08+00:00,https://github.com/metabase/metabase/issues/53216,"[('.Epic', 'Feature Implementation or Project'), ('.Team/Querying', '')]","[{'comment_id': 2636451416, 'issue_id': 2832648942, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-2357/[epic]-new-custom-expression-editor"">TRI-2357 [Epic] New custom expression editor</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 11, 19, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2639514140, 'issue_id': 2832648942, 'author': 'romeovs', 'body': 'Closing in favour of Linear', 'created_at': datetime.datetime(2025, 2, 6, 11, 7, 8, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 11:19:13 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-2357/[epic]-new-custom-expression-editor"">TRI-2357 [Epic] New custom expression editor</a></p>

romeovs (Issue Creator) on (2025-02-06 11:07:08 UTC): Closing in favour of Linear

"
2831896398,issue,open,,Graph lines disappear when touched on mobile Safari,"### Describe the bug

https://github.com/user-attachments/assets/1fdc0605-cbfa-45c7-9ea2-75ff6102af0d


Attached the video.

It may be related to this issue: https://github.com/metabase/metabase/issues/51383

On the dashboard, when I tap on a line in the graph to show values, it disappears.

Found this on 0.52.5 and tested on 0.52.9, but still exists.


### To Reproduce


1. Create a question using SQL and set its visualization to line chart.
2. Configure each line to have no dots on the data points.
3. Add the question to a dashboard.
4. Embed the dashboard to another website. (In 0.52.9, move in the question after I tap it, so need embedding to tap)
5. Open the dashboard in Safari on an iPhone. 
6. Refresh the dashboard, tap or drag on the line.

### Expected behavior

All lines and values are showing clearly 

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.1.1 Safari/605.1.15"",
    ""vendor"": ""Apple Computer, Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-02-04"",
      ""tag"": ""v0.52.9.2"",
      ""hash"": ""9bd30d0""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.2 (Ubuntu 17.2-1.pgdg24.04+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""19.0.2+7-Ubuntu-0ubuntu322.04"",
    ""java.vendor"": ""Private Build"",
    ""java.vendor.url"": ""Unknown"",
    ""java.version"": ""19.0.2"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""19.0.2+7-Ubuntu-0ubuntu322.04"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.8.0-1021-aws"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Etc/UTC""
  }
}
```

### Severity

P1

### Additional context

_No response_",cartbooster-yohan,2025-02-05 04:59:04+00:00,[],2025-02-07 17:29:28+00:00,,https://github.com/metabase/metabase/issues/53209,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Client:Mobile Web', 'and tablets and smaller screens'), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2635705074, 'issue_id': 2831896398, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-2356/graph-lines-disappear-when-touched-on-mobile-safari"">TRI-2356 Graph lines disappear when touched on mobile Safari</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 4, 59, 6, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 04:59:06 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-2356/graph-lines-disappear-when-touched-on-mobile-safari"">TRI-2356 Graph lines disappear when touched on mobile Safari</a></p>

"
2831690550,issue,open,,"Set ""View Data"" Permissions to Block on Reactivated Tables","**Is your feature request related to a problem? Please describe.**

Data was exposed to the wrong user group because of the following flow: 

- Delete a table
- Months later new table is created w/ the same name
- Sync reactivates the table
- Table inherits the previous permission graph because the graph itself was not changed when the table was deactivated


**Describe the solution you'd like**
If tables become deactivated for any reason we would prefer them to have a status of ""Blocked"" if they become reactivated.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**How important is this feature to you?**
We consider this a security loophole. Data was exposed to a permission group that shouldn't have seen it. 

**Additional context**
- Customer request
- Internal [Slack thread](https://metaboat.slack.com/archives/C01LQQ2UW03/p1738347369080969)
- Other Internal [Slack thread](https://metaboat.slack.com/archives/C052ZBWRG3W/p1738690566280829?thread_ts=1736784615.708579&cid=C052ZBWRG3W)
",ixipixi,2025-02-05 02:16:09+00:00,[],2025-02-05 02:31:35+00:00,,https://github.com/metabase/metabase/issues/53205,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2635549987, 'issue_id': 2831690550, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-2355/set-view-data-permissions-to-block-on-reactivated-tables"">TRI-2355 Set ""View Data"" Permissions to Block on Reactivated Tables</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 2, 16, 12, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 02:16:12 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-2355/set-view-data-permissions-to-block-on-reactivated-tables"">TRI-2355 Set ""View Data"" Permissions to Block on Reactivated Tables</a></p>

"
2831607756,issue,open,,Error using cast to unix seconds on a field,"### Describe the bug

Casting a field to a unix seconds in admin field settings on uploaded css data fails in both postgreSQl and Sample Database

Possibly related to [#46656](https://github.com/metabase/metabase/issues/46656)

Can be worked around by editing the SQL to remove one of the casts, but makes it hard for non SQLheads to use.

Thanks for your excellent product!

### To Reproduce

I uploaded a csv file containing unix seconds timestamps, a much reduced example file attached here that shows the same error [reduced.csv](https://github.com/user-attachments/files/18664835/reduced.csv).

On seeing the data displayed as integers I wanted to cast to a timestamp and went into the admin field settings for that field and set it to cast to unix seconds

<img width=""329"" alt=""Image"" src=""https://github.com/user-attachments/assets/c33d5696-4214-4f1e-8674-0c075952ab11"" />

This gave me this error when querying the data (postgresql)
```
ERROR: function to_timestamp(timestamp with time zone) does not exist
  Hint: No function matches the given name and argument types. You might need to add explicit type casts.
  Position: 163
```
The SQL it generates is this
```sql
SELECT
  ""source"".""_mb_row_id"" AS ""_mb_row_id"",
  TO_TIMESTAMP(""source"".""timestamp"") AS ""timestamp"",
  ""source"".""user_count"" AS ""user_count""
FROM
  (
    SELECT
      ""public"".""reduced_20250205092032"".""_mb_row_id"" AS ""_mb_row_id"",
      TO_TIMESTAMP(""public"".""reduced_20250205092032"".""timestamp"") AS ""timestamp"",
      ""public"".""reduced_20250205092032"".""user_count"" AS ""user_count""
    FROM
      ""public"".""reduced_20250205092032""
  ) AS ""source""
LIMIT
  1048575
```

A similar error occurred when I tried to reproduce using the Sample Database
```
Data conversion error converting ""TIMESTAMP to BIGINT""; SQL statement:
-- Metabase:: userID: 1 queryType: MBQL queryHash: 708537531143192377f501f83c147fa1664e9849d3433fde61bbba4bec8d6b0a
SELECT ""source"".""_mb_row_id"" AS ""_mb_row_id"", TIMESTAMPADD('second', ""source"".""timestamp"", timestamp '1970-01-01T00:00:00Z') AS ""timestamp"", ""source"".""user_count"" AS ""user_count"" FROM (SELECT ""PUBLIC"".""reduced_20250205094647"".""_mb_row_id"" AS ""_mb_row_id"", TIMESTAMPADD('second', ""PUBLIC"".""reduced_20250205094647"".""timestamp"", timestamp '1970-01-01T00:00:00Z') AS ""timestamp"", ""PUBLIC"". [22018-214]
```

### Expected behavior

Fixing the SQL by removing one cast...
```sql
SELECT
  ""source"".""_mb_row_id"" AS ""_mb_row_id"",
  ""source"".""timestamp"" AS ""timestamp"",
  ""source"".""user_count"" AS ""user_count""
FROM
  (
    SELECT
      ""public"".""reduced_20250205092032"".""_mb_row_id"" AS ""_mb_row_id"",
      TO_TIMESTAMP(""public"".""reduced_20250205092032"".""timestamp"") AS ""timestamp"",
      ""public"".""reduced_20250205092032"".""user_count"" AS ""user_count""
    FROM
      ""public"".""reduced_20250205092032""
  ) AS ""source""
LIMIT
  1048575
```
Gives the result I expected

<img width=""444"" alt=""Image"" src=""https://github.com/user-attachments/assets/bfa29e3f-1b57-4a59-85de-c1bc91e7b5c2"" />

### Logs

```
[6f8ad6c3-7ca3-48ab-b2d1-56a802d55110] 2025-02-05T09:21:13+09:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: ERROR: function to_timestamp(timestamp with time zone) does not exist
  Hint: No function matches the given name and argument types. You might need to add explicit type casts.
  Position: 163
{:database_id 2,
 :started_at #t ""2025-02-05T09:21:13.226977008+09:00[Asia/Dili]"",
 :via
 [{:status :failed,
   :class clojure.lang.ExceptionInfo,
   :error
   ""Error executing query: ERROR: function to_timestamp(timestamp with time zone) does not exist\n  Hint: No function matches the given name and argument types. You might need to add explicit type casts.\n  Position: 163"",
   :stacktrace
   [""--> driver.sql_jdbc.execute$execute_reducible_query$fn__87832$fn__87833.invoke(execute.clj:716)""
    ""driver.sql_jdbc.execute$execute_reducible_query$fn__87832.invoke(execute.clj:713)""
    ""driver.sql_jdbc.execute$fn__87638$fn__87639.invoke(execute.clj:398)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection87608__87609.invokeStatic(execute.clj:338)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection87608__87609.invoke(execute.clj:321)""
    ""driver.sql_jdbc.execute$fn__87638.invokeStatic(execute.clj:392)""
    ""driver.sql_jdbc.execute$fn__87638.invoke(execute.clj:390)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:707)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:693)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:704)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:693)""
    ""driver.sql_jdbc$fn__116057.invokeStatic(sql_jdbc.clj:79)""
    ""driver.sql_jdbc$fn__116057.invoke(sql_jdbc.clj:77)""
    ""query_processor.pipeline$_STAR_execute_STAR_.invokeStatic(pipeline.clj:52)""
    ""query_processor.pipeline$_STAR_execute_STAR_.invoke(pipeline.clj:39)""
    ""query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:102)""
    ""query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:95)""
    ""query_processor.execute$run.invokeStatic(execute.clj:62)""
    ""query_processor.execute$run.invoke(execute.clj:56)""
    ""query_processor.middleware.update_used_cards$update_used_cards_BANG_76007__76008$fn__76009.invoke(update_used_cards.clj:60)""
    ""query_processor.execute$add_native_form_to_result_metadata$fn__76024.invoke(execute.clj:25)""
    ""query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__76030.invoke(execute.clj:36)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___75980.invoke(cache.clj:241)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__72652.invoke(permissions.clj:148)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__73373.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__73383.invoke(enterprise.clj:64)""
    ""query_processor.execute$execute76057__76058$fn__76059.invoke(execute.clj:94)""
    ""query_processor.setup$do_with_qp_setup73927__73928.invokeStatic(setup.clj:225)""
    ""query_processor.setup$do_with_qp_setup73927__73928.invoke(setup.clj:216)""
    ""query_processor.execute$execute76057__76058.invokeStatic(execute.clj:93)""
    ""query_processor.execute$execute76057__76058.invoke(execute.clj:89)""
    ""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:49)""
    ""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:44)""
    ""query_processor.middleware.enterprise$fn__73400$handle_audit_app_internal_queries__73401$fn__73403.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__73411.invoke(enterprise.clj:103)""
    ""query_processor.middleware.process_userland_query$process_userland_query_middleware78670__78671$fn__78672.invoke(process_userland_query.clj:217)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions78735__78736$fn__78737.invoke(catch_exceptions.clj:132...

....

[6f8ad6c3-7ca3-48ab-b2d1-56a802d55110] 2025-02-05T09:47:27+09:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: Data conversion error converting ""TIMESTAMP to BIGINT""; SQL statement:
-- Metabase:: userID: 1 queryType: MBQL queryHash: 708537531143192377f501f83c147fa1664e9849d3433fde61bbba4bec8d6b0a
SELECT ""source"".""_mb_row_id"" AS ""_mb_row_id"", TIMESTAMPADD('second', ""source"".""timestamp"", timestamp '1970-01-01T00:00:00Z') AS ""timestamp"", ""source"".""user_count"" AS ""user_count"" FROM (SELECT ""PUBLIC"".""reduced_20250205094647"".""_mb_row_id"" AS ""_mb_row_id"", TIMESTAMPADD('second', ""PUBLIC"".""reduced_20250205094647"".""timestamp"", timestamp '1970-01-01T00:00:00Z') AS ""timestamp"", ""PUBLIC"". [22018-214]
{:database_id 1,
 :started_at #t ""2025-02-05T09:47:27.207750125+09:00[Asia/Dili]"",
 :via
 [{:status :failed,
   :class clojure.lang.ExceptionInfo,
   :error
   ""Error executing query: Data conversion error converting \""TIMESTAMP to BIGINT\""; SQL statement:\n-- Metabase:: userID: 1 queryType: MBQL queryHash: 708537531143192377f501f83c147fa1664e9849d3433fde61bbba4bec8d6b0a\nSELECT \""source\"".\""_mb_row_id\"" AS \""_mb_row_id\"", TIMESTAMPADD('second', \""source\"".\""timestamp\"", timestamp '1970-01-01T00:00:00Z') AS \""timestamp\"", \""source\"".\""user_count\"" AS \""user_count\"" FROM (SELECT \""PUBLIC\"".\""reduced_20250205094647\"".\""_mb_row_id\"" AS \""_mb_row_id\"", TIMESTAMPADD('second', \""PUBLIC\"".\""reduced_20250205094647\"".\""timestamp\"", timestamp '1970-01-01T00:00:00Z') AS \""timestamp\"", \""PUBLIC\"". [22018-214]"",
   :stacktrace
   [""--> driver.sql_jdbc.execute$execute_reducible_query$fn__87832$fn__87833.invoke(execute.clj:716)""
    ""driver.sql_jdbc.execute$execute_reducible_query$fn__87832.invoke(execute.clj:713)""
    ""driver.h2$fn__93262$fn__93264.invoke(h2.clj:543)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection87608__87609.invokeStatic(execute.clj:338)""
    ""driver.sql_jdbc.execute$do_with_resolved_connection87608__87609.invoke(execute.clj:321)""
    ""driver.h2$fn__93262.invokeStatic(h2.clj:534)""
    ""driver.h2$fn__93262.invoke(h2.clj:530)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:707)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:693)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:704)""
    ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:693)""
    ""driver.sql_jdbc$fn__116057.invokeStatic(sql_jdbc.clj:79)""
    ""driver.sql_jdbc$fn__116057.invoke(sql_jdbc.clj:77)""
    ""driver.h2$fn__93101.invokeStatic(h2.clj:271)""
    ""driver.h2$fn__93101.invoke(h2.clj:267)""
    ""query_processor.pipeline$_STAR_execute_STAR_.invokeStatic(pipeline.clj:52)""
    ""query_processor.pipeline$_STAR_execute_STAR_.invoke(pipeline.clj:39)""
    ""query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:102)""
    ""query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:95)""
    ""query_processor.execute$run.invokeStatic(execute.clj:62)""
    ""query_processor.execute$run.invoke(execute.clj:56)""
    ""query_processor.middleware.update_used_cards$update_used_cards_BANG_76007__76008$fn__76009.invoke(update_used_cards.clj:60)""
    ""query_processor.execute$add_native_form_to_result_metadata$fn__76024.invoke(execute.clj:25)""
    ""query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__76030.invoke(execute.clj:36)""
    ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___75980.invoke(cache.clj:241)""
    ""query_processor.middleware.permissions$check_query_permissions$fn__72652.invoke(permissions.clj:148)""
    ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__73373.invoke(enterprise.clj:51)""
    ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__73383.invoke(enterprise.clj:64)""
    ""query_processor.execute$execute76057__76058$fn__76059.invoke(execute.clj:94)""
    ""query_processor.setup$do_with_qp_setup73927__73928.invokeStatic(setup.clj:225)""
    ""query_processor.setup$do_with_qp_setup73927__73928.inv...

```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.2 Safari/605.1.15"",
    ""vendor"": ""Apple Computer, Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-31"",
      ""tag"": ""v0.52.9"",
      ""hash"": ""f9fbbf8""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.2""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.6+7-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.6"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.6+7-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.10.14-linuxkit"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Asia/Dili""
  }
}
```

### Severity

annoying, but not blocking

### Additional context

_No response_",PeteCoward,2025-02-05 00:56:52+00:00,[],2025-02-07 17:27:53+00:00,,https://github.com/metabase/metabase/issues/53202,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/MBQL', ''), ('Administration/Table Metadata', ''), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2635467369, 'issue_id': 2831607756, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-2354/error-using-cast-to-unix-seconds-on-a-field"">TRI-2354 Error using cast to unix seconds on a field</a></p>', 'created_at': datetime.datetime(2025, 2, 5, 0, 56, 55, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-05 00:56:55 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-2354/error-using-cast-to-unix-seconds-on-a-field"">TRI-2354 Error using cast to unix seconds on a field</a></p>

"
2831048634,issue,open,,Frozen UI after viewing a table with missing fields in the metadata browser,"### Describe the bug

The UI becomes unresponsive when attempting to view table metadata of a table with missing fields.

### To Reproduce

1. Go to **Admin Settings / Table Metadata**, and set the visibility of all fields to **Do not include**.
2. Open the native query editor
3. Click on **Learn about your data** to open the metadata browser in the side bar
4. In the side bar navigate locate the table edited in Step 1
5. Click to view the metadata of the table and see the error:
- the UI is frozen and the browser tab cannot be returned to a working state
- it is not possible to copy text from the SQL editor, so any unsaved work will be lost.



### Expected behavior

It should work. Occasionally, tables may have missing columns in the metadata due to permission issues or related errors. Even if this happens as a result of an error, the UI should handle this situation gracefully.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres"",
      ""mongo"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""internal"",
    ""version"": {
      ""date"": ""2025-01-28"",
      ""tag"": ""v1.52.8.2"",
      ""hash"": ""412e324""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres""
  }
}
```

### Severity

Very annoying, and unsaved work can be lost. Reported by a customer.

### Additional context

_No response_",zbodi74,2025-02-04 18:54:17+00:00,[],2025-02-07 17:25:24+00:00,,https://github.com/metabase/metabase/issues/53194,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Native', 'The SQL/native query editor'), ('Administration/Table Metadata', ''), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2830986597,issue,open,,Moving from a viz to the notebook will make Metabase act like if it was in the viz and will run queries on every change,"### Describe the bug

Interesting state bug: if you build a question in the notebook then everything's fine, but if you build the question in the viz first and then you go to the notebook, we'll fire a query on every change to the question, which is problematic on big datasets

### To Reproduce

1) create a question with the notebook editor, add aggregations and see that the queries won't run in the DB till you hit ""visualize""
2) now go to browse data, select orders, then save the question
3) then go to the notebook and start changing the aggregations, see the queries running

### Expected behavior

We should never run queries if you're in the notebook editor till you click visualize

### Logs

NA

### Information about your Metabase installation

```JSON
v53.x but I think this comes from many many versions ago
```

### Severity

P1

### Additional context

NA",paoliniluis,2025-02-04 18:21:07+00:00,['kamilmielnik'],2025-02-07 17:28:02+00:00,,https://github.com/metabase/metabase/issues/53190,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]",[],
2830932255,issue,open,,No way to open/preview a question via the question picker when selecting a source for field values,"### Describe the bug

If you're configuring a dashboard filter to pull its values from another question or model, it'll open a question picker modal to choose the question. But there's no way from this modal to preview the question you're selecting or even open it in a new tab to check that it's the one you're intending to choose.

<img width=""903"" alt=""Image"" src=""https://github.com/user-attachments/assets/455a6884-2284-45eb-9f1c-18ed325360f8"" />

### To Reproduce

Reproducible with this dashboard: https://stats.metabase.com/dashboard/3170-github-issue-words?feature_cluster=Visualization&issue_opened_at_1=2025-02-01&issue_opened_at_2=2025-02-28&release=0.50.32&tab=1420-by-milestone

1. Edit the dashboard and click on the `Release` filter
2. Under `How should people filter on this column?` click `Edit`
3. Click the dropdown under `Model or question to supply the values`
4. In the modal that pops up, there's no way to open and/or preview any of the questions

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
feb7db2c06
```

### Severity

P3

### Additional context

_No response_",noahmoss,2025-02-04 17:55:52+00:00,[],2025-02-07 17:22:46+00:00,,https://github.com/metabase/metabase/issues/53186,"[('Priority:P2', 'Average run of the mill bug'), ('Type:New Feature', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]",[],
2830902645,issue,open,,Order of values in dropdown filter that come from another question is not customizable,"### Describe the bug

If you set up a filter on a dashboard with dropdown values derived from a column from another question, the values in the dropdown are in ascending order, regardless of the original order of values in the question.

In addition, there doesn't seem to be a way to control this in the filter settings, and/or at the user-level.

### To Reproduce

Reproducible on stats: https://stats.metabase.com/dashboard/3170-github-issue-words?feature_cluster=Visualization&issue_opened_at_1=2025-02-01&issue_opened_at_2=2025-02-28&release=0.50.32&tab=1420-by-milestone

The `Release` filter values here are in ascending order, but in the [question](https://stats.metabase.com/question/23904-milestones) they're in descending order. And there doesn't seem to be a way to change it.

### Expected behavior

It should match the order from the source question and/or be customizable.

### Logs

_No response_

### Information about your Metabase installation

```JSON
feb7db2c06
```

### Severity

P2?

### Additional context

_No response_",noahmoss,2025-02-04 17:42:59+00:00,[],2025-02-07 17:21:26+00:00,,https://github.com/metabase/metabase/issues/53184,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Team/DashViz', 'Dashboard and Viz team'), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]",[],
2830790668,issue,closed,not_planned,testing issue,,luizarakaki,2025-02-04 16:48:08+00:00,[],2025-02-04 16:53:41+00:00,2025-02-04 16:53:41+00:00,https://github.com/metabase/metabase/issues/53180,[],[],
2830784918,issue,open,,Separate Columncondition and Column to set color on,"When adding a conditional formatting rule, I want to:

1. Select a column to which the color should apply for (is already possible)
2. Create a condition based on a differend column.

So:

If Column ""X"" has value ""A"" set color green on Column ""Y""",unartic,2025-02-04 16:45:27+00:00,[],2025-02-05 17:51:46+00:00,,https://github.com/metabase/metabase/issues/53179,"[('Visualization/', ''), ('Type:New Feature', ''), ('Visualization/Chart Settings', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Visualization/Conditional Formatting', '')]","[{'comment_id': 2635132621, 'issue_id': 2830784918, 'author': 'linear[bot]', 'body': '<p><a href=""https://linear.app/metabase/issue/TRI-2353/seperate-columncondition-and-column-to-set-color-on"">TRI-2353 Seperate Columncondition and Column to set color on</a></p>', 'created_at': datetime.datetime(2025, 2, 4, 21, 38, 11, tzinfo=datetime.timezone.utc)}]","linear[bot] on (2025-02-04 21:38:11 UTC): <p><a href=""https://linear.app/metabase/issue/TRI-2353/seperate-columncondition-and-column-to-set-color-on"">TRI-2353 Seperate Columncondition and Column to set color on</a></p>

"
2830711039,issue,open,,This tool cost me thousands of usd because of automatic field value scan,"Hello everyone,

I just wanted to inform anyone about huge costs who has large DB like me. 

Summary : When you add a new DB to Metabase there is an option called Choose when syncs and scans happen in Advanced Settings which is selected by default. And Advanced Settings are hidden menu you should click Advanced Settings link to see Choose when syncs and scans happen option. If you don't change this parameter, Metabase sends full table scan queries for each field to get distinct field values in the tables and It can cost you thousands of USD like me if you miss this hidden parameter.


I installed Metabase in my cloud account on AWS. I didn't want to connect customer data directly because of the privacy concerns so I decided to try it with my Load Balancer logs.

My Load Balancer logs have date partition and I used Athena connector to connect the ALB logs. My ALB log size is around a few hundred TB (TeraBytes).

Once I added my ALB DB with AWS Athena connector to Metabase I just missed out Scanning for Filter Values prop and it's enabled by default. 

When I see huge cost increase in Athena and S3 I just checked Athena query history and have seen that Metabase creates lots of full table scan SQLs to get field values for each fields in the tables without using any partition and these queries scan a few hundred TB data for each field. 

Here are the sample SQLs = 
SELECT ""alblogs"".""alb_access_logs"".""elb_status_code"" AS ""elb_status_code"" FROM ""alblogs"".""alb_access_logs"" GROUP BY ""alblogs"".""alb_access_logs"".""elb_status_code"" ORDER BY ""alblogs"".""alb_access_logs"".""elb_status_code"" ASC LIMIT 100;

SELECT ""alblogs"".""alb_access_logs"".""target_port"" AS ""target_port"" FROM ""alblogs"".""alb_access_logs"" GROUP BY ""alblogs"".""alb_access_logs"".""target_port"" ORDER BY ""alblogs"".""alb_access_logs"".""target_port"" ASC LIMIT 1000

As I understand Metabase collects values for each field using all the data. 

What I can recommend is that disable auto field value scans by default. (at least for Big Data connectors such as Athena, BigQuery,etc...) 

Thanks.",ozgurhangisi,2025-02-04 16:12:46+00:00,[],2025-02-04 16:12:46+00:00,,https://github.com/metabase/metabase/issues/53175,[],[],
2830606368,issue,closed,not_planned,View SQL button in query builder preserves state across tabs,"### Describe the bug

If you click the ""View SQL"" button in the query builder, but don't close it, the next time you start a new query the SQL view will be opened automatically (even in a new tab)

### To Reproduce

1. Go to New -> Question -> select any table
2. Click on `View SQL` to open the generated SQL
3. Close the tab and open a new one (don't need to save the question)
4. Start a new query and select any table. The SQL view will open automatically by default, and you'll need to close it to see the query builder.

### Expected behavior

This shouldn't be global state — if you start a new query it should always show you the query builder, not SQL.

### Logs

_No response_

### Information about your Metabase installation

```JSON
feb7db2c06 on Firefox
```

### Severity

P3

### Additional context

_No response_",noahmoss,2025-02-04 15:32:14+00:00,[],2025-02-04 16:27:11+00:00,2025-02-04 16:27:03+00:00,https://github.com/metabase/metabase/issues/53173,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Native', 'The SQL/native query editor'), ('.Frontend', ''), ('.Product Input Needed', ''), ('.Team/Querying', '')]","[{'comment_id': 2634473880, 'issue_id': 2830606368, 'author': 'ranquild', 'body': '@noahmoss this is actually the expected behavior. Your last choice is preserved.', 'created_at': datetime.datetime(2025, 2, 4, 16, 26, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2634475162, 'issue_id': 2830606368, 'author': 'mngr', 'body': 'This is an intended behavior, we save the preference if you prefer it to be shown or hidden', 'created_at': datetime.datetime(2025, 2, 4, 16, 26, 57, tzinfo=datetime.timezone.utc)}]","ranquild on (2025-02-04 16:26:27 UTC): @noahmoss this is actually the expected behavior. Your last choice is preserved.

mngr on (2025-02-04 16:26:57 UTC): This is an intended behavior, we save the preference if you prefer it to be shown or hidden

"
2830565915,issue,open,,Sidebar with information about a card referenced from a native query is buggy,"### Describe the bug

If you [reference a card in a native query](https://www.metabase.com/docs/latest/questions/native-editor/referencing-saved-questions-in-queries), and click on the card ID/slug, it opens a sidebar with some details about the card being referenced.

This has a couple problems:
* Some of the icons are extremely small (see screenshot)
* If your cursor is still positioned over the card reference in the query, you can't close the sidebar. Clicking the X icon (or the < icon) to close it will result it in immediately re-opening.
* If you move the cursor away from the card reference, clicking the `<` icon takes you to the list of tables in the database, and there isn't an intuitive link forward to the card info again

<img width=""1221"" alt=""Image"" src=""https://github.com/user-attachments/assets/63faf19a-0cf1-4c31-b193-0b43eff683e7"" />

related to https://github.com/metabase/metabase/issues/53171

### To Reproduce

1. Create a saved card or model
2. Reference it from a native query


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
feb7db2c06 on firefox
```

### Severity

P3

### Additional context

_No response_",noahmoss,2025-02-04 15:16:23+00:00,[],2025-02-04 20:28:29+00:00,,https://github.com/metabase/metabase/issues/53172,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Native', 'The SQL/native query editor'), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2830545372,issue,open,,Card reference in a native query with a long title does not wrap,"### Describe the bug

Referencing a card in a native query will insert its entire slug, which doesn't line wrap. This can cause the ""learn about your data"" sidebar to be cut off awkwardly, or entirely non-visible.

<img width=""990"" alt=""Image"" src=""https://github.com/user-attachments/assets/2fddc6c0-019d-4432-bb8a-07a3111d9b66"" />

### To Reproduce

1. Create and save a question or model with a long title 
2. Reference it from a native query, using the inline autocomplete to fill in the card title
3. Try to open the sidebar, and see that it gets cut off


### Expected behavior

Slug should probably be truncated at a certain length? Or allowed to wrap in some way.

### Logs

_No response_

### Information about your Metabase installation

```JSON
feb7db2c06
```

### Severity

p3

### Additional context

_No response_",noahmoss,2025-02-04 15:08:35+00:00,[],2025-02-04 20:28:40+00:00,,https://github.com/metabase/metabase/issues/53171,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Native', 'The SQL/native query editor'), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2830515695,issue,open,,Add column popover is cut off,"### Describe the bug

<img width=""293"" alt=""Image"" src=""https://github.com/user-attachments/assets/f08f57f9-08ab-4270-87b0-c1b03d408127"" />

### To Reproduce

1. Open any table in QB
2. Make screen narrow so that Add Column button in the header is sticky on the right
3. Click on the add column button, then click combine columns


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Stats
```

### Severity

P2

### Additional context

_No response_",alxnddr,2025-02-04 14:57:15+00:00,[],2025-02-04 20:28:54+00:00,,https://github.com/metabase/metabase/issues/53170,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('Querying/Notebook/Custom Expression', ''), ('.Team/Querying', '')]",[],
2828775743,issue,open,,Mismatch in Results for GUI-built Questions Using SQL Server Tables with 'Description' Column,"### Describe the bug

I'm looking for confirmation to see if anyone else can reproduce this issue, as it seems to be specific.  
Subscriptions containing GUI-built questions or models based on Microsoft SQL Server tables—where at least one column contains 'Description'—produce different results compared to what’s displayed in Metabase.  
Only seems to happen with GUI-built questions.  


<br>

**Within Metabase**
<img width=""956"" alt=""Image"" src=""https://github.com/user-attachments/assets/c74fbbbc-2711-4ba2-8fa0-215ce5de90af"" />. 

<br>

**Subscription with ""Description"" column having date information and ""DateAdded"" column missing**
![Image](https://github.com/user-attachments/assets/5189b33c-7f6c-4416-8093-217eb652004e)

### To Reproduce

What’s needed:
- SQL Server 2019 or 2022
- Metabase 1.52.8 (haven’t tested 52.9)
- A table with a column containing the word “description”. 

Create a question or a model using GUI builder based on a table with a ""Description"" column, add it to a dashboard, and send a subscription. This should product different results between Metabase and the subscription.  


<br>

Next, either convert the question to SQL or create the question from scratch using native SQL, add it to a dashboard, send a subscription, and it should match what is displayed in Metabase.  

<br>


**Gists of sample tables with and without a Description column**
Products table with Description column
https://gist.github.com/FilmonK/7da9af4e2171e16da9795407b76c6374

Products table without Description column
https://gist.github.com/FilmonK/86fef8a75562a3fb0a30bfff42257309

Employees table without Description column
https://gist.github.com/FilmonK/ac534624ac1fae5cb57db1ce5f18c91f

UserLogs with a column containing ""Description"" in a column name
https://gist.github.com/FilmonK/85a10fd99dafbf7dfeea1c1b8dcc760f


### Expected behavior

For the subscription to match what is displayed in Metabase when building GUI questions.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""snowflake"",
      ""mysql"",
      ""mongo"",
      ""postgres"",
      ""h2"",
      ""sqlserver"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-29"",
      ""tag"": ""v1.52.8.3"",
      ""hash"": ""5a23445""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.3""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.5"",
    ""user.language"": ""en"",
    ""user.timezone"": ""America/Chicago""
  }
}
```

### Severity

P2 - Major issue for customer who's built questions and models with these scenario

### Additional context

_No response_",FilmonK,2025-02-03 23:27:10+00:00,[],2025-02-04 20:29:30+00:00,,https://github.com/metabase/metabase/issues/53149,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Database/SQLServer', None), ('Reporting/Pulses', 'Now called Subscriptions'), ('.Backend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/DashViz', 'Dashboard and Viz team'), ('Bug:v52', 'bugs or regressions introduced in v52')]",[],
2828702957,issue,open,,[BE] Add `ai-sql-fixer` token feature,,metamben,2025-02-03 22:32:16+00:00,['metamben'],2025-02-04 20:26:19+00:00,,https://github.com/metabase/metabase/issues/53144,"[('Metabot/General', 'General Metabot AI')]",[],
2828691843,issue,open,,[BE] Add a endpoint to autofix SQL,,metamben,2025-02-03 22:27:20+00:00,['metamben'],2025-02-04 20:26:19+00:00,,https://github.com/metabase/metabase/issues/53142,"[('Metabot/General', 'General Metabot AI')]",[],
2828637669,issue,closed,completed,Cannot change/update a Snowflake connection,"### Describe the bug

I believe after we did the fix for snowflake we broke the option to save the connection when you're using username and password. 

### To Reproduce

Go to stats and try to edit the connection [here](https://stats.metabase.com/admin/databases/122) ...just disable sync and scan and try to save.  The save button remains greyed out

<img width=""1014"" alt=""Image"" src=""https://github.com/user-attachments/assets/898f33ae-f01d-415a-854c-03d5c625a862"" />

### Expected behavior

You're able to save when you do a change

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
1.52.8.2 and master
```

### Severity

Blocker if you don't know of the workaround

### Additional context

There is a workaround, I believe the issue is related to this toggle 

<img width=""931"" alt=""Image"" src=""https://github.com/user-attachments/assets/9d7002d7-790c-4db9-839e-cf3d4408cc80"" />

If your connection is using username and password this will be toggled off by default even if you're actually using username and password. So the moment you enable it you're able to save again.",Tony-metabase,2025-02-03 22:05:04+00:00,[],2025-02-06 00:33:17+00:00,2025-02-05 23:47:28+00:00,https://github.com/metabase/metabase/issues/53141,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Snowflake', ''), ('Administration/Databases', ''), ('.Escalation', ''), ('.Team/Drivers', '')]","[{'comment_id': 2638341708, 'issue_id': 2828637669, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)', 'created_at': datetime.datetime(2025, 2, 6, 0, 33, 16, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-02-06 00:33:16 UTC): 🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)

"
2828407168,issue,open,,Dynamic Date/Timestamp Variables in Subscription Email Subject,"**Describe the solution you'd like**

This feature request proposes adding dynamic date/timestamp variables that can be used in report subjects, allowing for automated, time-sensitive naming.  The variables should represent the start and end of the reporting period.

Two variations are needed:

1. Single Period Variable:  For reports covering a single, defined period.

-     {{timestamp}}: Start of the hour. Example: {{timestamp}} Acme Hourly Business Report (e.g., 2024-10-27 10:00:00 Acme Hourly Business Report)
-     {{date}}: Start of the day. Example: {{date}} Acme Daily Business Report (e.g., 2024-10-27 Acme Daily Business Report)
-     {{week}}: Start of the week (e.g., Monday). Example: {{week}} Acme Weekly Business Report (e.g., 2024-10-21 Acme Weekly Business Report)
-     {{month}}: Start of the month. Example: {{month}} Acme Monthly Business Report (e.g., 2024-10-01 Acme Monthly Business Report)

2. Start/End Period Variables: For reports covering a range of time.

-     {{start_timestamp}} - {{end_timestamp}}: Example: {{start_timestamp}} - {{end_timestamp}} Acme Hourly Business Report (e.g., 2024-10-27 10:00:00 - 2024-10-27 11:00:00 Acme Hourly Business Report)
-     {{start_date}} - {{end_date}}: Example: {{start_date}} - {{end_date}} Acme Daily Business Report (e.g., 2024-10-26 - 2024-10-27 Acme Daily Business Report)
-     {{start_week}} - {{end_week}}: Example: {{start_week}} - {{end_week}} Acme Weekly Business Report (e.g., 2024-10-21 - 2024-10-27 Acme Weekly Business Report)
-     {{start_month}} - {{end_month}}: Example: {{start_month}} - {{end_month}} Acme Monthly Business Report (e.g., 2024-10-01 - 2024-10-31 Acme Monthly Business Report)

**Describe alternatives you've considered**

I explored using ""Adding a header to text"" with a data picker parameter called this_date. While this approach allows a default value of yesterday, the output is the string 'Yesterday.' It doesn't dynamically update the parameter with the actual date. Also, this method is unable to update the subject of the notification.

**How important is this feature to you?**

Fairly important. This feature has been requested by at least one other user ([Link](https://discourse.metabase.com/t/dashboard-subcrsiptions-include-date-and-time-in-email-subject/142158/1)).  Dynamic report naming is crucial for organization and efficient retrieval of historical data.

**Additional context**

This feature would significantly improve the automation and usability of report generation.  It would eliminate the need for manual subject line updates, reducing errors and saving time.  Providing both single-period and start/end period variables offers flexibility for various reporting needs.  Clear documentation on the date/time format used for each variable is essential.",pbEF,2025-02-03 20:01:01+00:00,[],2025-02-06 08:56:39+00:00,,https://github.com/metabase/metabase/issues/53134,"[('Reporting/Pulses', 'Now called Subscriptions'), ('Type:New Feature', ''), ('.Team/Workflows', 'aka BEC')]",[],
2827894339,issue,closed,completed,ClassNotFoundException: com.google.cloud.bigquery.BigQuery$JobOption Intermittent Error,"### Describe the bug

Full error shown on questions/sql using BigQuery connections: `Exception java.lang.ClassNotFoundException: com.google.cloud.bigquery.BigQuery$JobOption [in thread ""streaming-response-thread-pool-12""]`. I.e., instead of getting the sql results, we just get this error on ALL BigQuery questions/sql. 

This is the second time this has happened where all BigQuery connections from Metabase start to throw this error. Restarting the server seems to ""fix"" it, at least until it shows up again at some point. 

### To Reproduce

We run Metabase locally. There's nothing obvious on our end that we are doing, it just sort of shows up seemingly out of nowhere and we have to restart the server. Upon restarting, it works completely fine. 

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""bigquery-cloud-sdk"",
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-07"",
      ""tag"": ""v0.52.5"",
      ""hash"": ""cc77eeb""
    },
    ""settings"": {
      ""report-timezone"": ""UTC""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.8""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.112+"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

Blocking users when it happens

### Additional context

_No response_",acorso522,2025-02-03 15:51:16+00:00,['snoe'],2025-02-04 14:56:41+00:00,2025-02-04 14:23:45+00:00,https://github.com/metabase/metabase/issues/53122,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/BigQuery', ''), ('.Team/Drivers', ''), ('Bug:v52', 'bugs or regressions introduced in v52')]","[{'comment_id': 2631712856, 'issue_id': 2827894339, 'author': 'paoliniluis', 'body': 'We’re fixing this as we speak, for now please reboot your server', 'created_at': datetime.datetime(2025, 2, 3, 18, 8, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2634118517, 'issue_id': 2827894339, 'author': 'dpsutton', 'body': 'This is fixed by https://github.com/metabase/metabase/pull/52990', 'created_at': datetime.datetime(2025, 2, 4, 14, 23, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2634229156, 'issue_id': 2827894339, 'author': 'acorso522', 'body': 'Wonderful, thank you!', 'created_at': datetime.datetime(2025, 2, 4, 14, 56, 40, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-02-03 18:08:02 UTC): We’re fixing this as we speak, for now please reboot your server

dpsutton on (2025-02-04 14:23:45 UTC): This is fixed by https://github.com/metabase/metabase/pull/52990

acorso522 (Issue Creator) on (2025-02-04 14:56:40 UTC): Wonderful, thank you!

"
2827774925,issue,open,,[Epic] Make it easier for hardcore creators to fix their SQL,"### Links

- [Product doc](https://www.notion.so/metabase/Make-it-easier-for-hardcore-creators-to-fix-their-SQL-through-the-magic-of-AI-18969354c9018039bc79f0e3f219572e)

### Implementation Plan

New endpoint (accessible with the `ai-sql-fixer` token)

request:
```
{
  query: {
    type: ""native"",
    database: 1,
    native: {
      query: ""SELECT * FROM ORDERS"",
    }
  },
  error_message: ""Syntax error in SQL statement...""
}
```

response - list of fixes to apply to the query:
```
{
  fixes: [
    {
      line_number: 0,
      fixed_sql: ""string""
    }
  ]
}
```

```[tasklist]
#### Milestone 1 - without DDL
- [ ] https://github.com/metabase/metabase/issues/53142
- [ ] https://github.com/metabase/metabase/issues/53144
- [ ] [FE] Add a UI to autofix SQL
```
",ranquild,2025-02-03 15:04:29+00:00,"['ranquild', 'metamben']",2025-02-05 19:45:00+00:00,,https://github.com/metabase/metabase/issues/53117,"[('.Epic', 'Feature Implementation or Project'), ('.Team/Querying', '')]",[],
2827762526,issue,open,,Switcher between table and viz is off center and jumps when switching,"### Describe the bug

https://www.loom.com/share/b611dcd6e4274d9d9bfadbdd141b2e15

### To Reproduce

1. Open any question with a viz other than table
2. Click on the switcher to show the table results
3. Click on the switcher to show the viz
4. You see that the switcher changes its position


### Expected behavior

The switcher should be centered horizontally and should not change it's position when switching

### Logs

_No response_

### Information about your Metabase installation

```JSON
49a83e9
```

### Severity

Just annoying, but very often

### Additional context

_No response_",mngr,2025-02-03 14:59:44+00:00,['uladzimirdev'],2025-02-06 21:19:07+00:00,,https://github.com/metabase/metabase/issues/53116,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2827750567,issue,open,,Option to search a whole table at once,"**Is your feature request related to a problem? Please describe.**
If you want to search a table you need to apply a filter. If you have many columns you will need to add a column for each filter. I would like 1 filter that gets applied at row level rather than at column level. 

**Describe the solution you'd like**

Some kind of filter that when you search fro it it filters the whole table (as a text)

<img width=""796"" alt=""Image"" src=""https://github.com/user-attachments/assets/8455ba78-9e3c-411c-9ac3-9131eac65adf"" />

The example on [here](https://datatables.net/) shows what the customer has in mind

**Describe alternatives you've considered**
Add filter for each column

**How important is this feature to you?**
Was requested by a customer
",Tony-metabase,2025-02-03 14:55:04+00:00,[],2025-02-04 20:31:02+00:00,,https://github.com/metabase/metabase/issues/53115,"[('Type:New Feature', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('Querying/', '')]",[],
2827617659,issue,closed,completed,Mitigating the risk of SDK misuse,"**Context**

[Product doc](https://www.notion.so/metabase/Mitigate-risk-of-SDK-abuse-until-enforced-18469354c90180ff91bfcfc76bf90ff2)

- [ ] Add modal on FE SDK toggles
- [ ] Add BE setting
- [ ] Adjust FE to match styling

",NevRA,2025-02-03 14:06:15+00:00,['oisincoveney'],2025-02-05 16:45:02+00:00,2025-02-05 16:45:01+00:00,https://github.com/metabase/metabase/issues/53111,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2825517959,issue,open,,Link Checker Report,,github-actions[bot],2025-02-02 00:19:17+00:00,['jeff-bruemmer'],2025-02-04 20:31:10+00:00,,https://github.com/metabase/metabase/issues/53100,"[('Type:Documentation', '')]",[],
2824439458,issue,open,,Subscriptions Fail if Card is Based on a Question that Contains array_agg() - Postgres,"### Describe the bug

Subscriptions fail if the dashboard contains a question with array_agg() function. 

### To Reproduce

1. Create a SQL question in postgres that contains an array_agg() function

```
/*make table*/
CREATE TABLE public.orders (
	order_id uuid DEFAULT uuid_generate_v4() NOT NULL,
	user_id uuid NOT NULL,
	order_date timestamp DEFAULT CURRENT_TIMESTAMP NULL);

/*add some data*/
INSERT INTO public.orders (order_id, user_id, order_date)
VALUES
  (uuid_generate_v4(), uuid_generate_v4(), NOW()),
  (uuid_generate_v4(), uuid_generate_v4(), NOW() - INTERVAL '1 day'),
  (uuid_generate_v4(), uuid_generate_v4(), NOW() - INTERVAL '2 days');

/*select with array*/
SELECT
  CAST(order_date AS DATE) AS order_date,
  ARRAY_AGG(DISTINCT user_id) AS user_ids
FROM public.orders
GROUP BY CAST(order_date AS DATE)
ORDER BY order_date ASC;
```

2. Add the question to a dashboard
3. Attempt to send a subscription
4. Subscription fails

https://jam.dev/c/279153b5-2bc7-4f00-b02a-8bb650cf374e

### Expected behavior

Subscriptions shouldn't fail.

### Logs

[7274f9d5-eaad-4d46-b330-87fb9efd36d1] 2025-01-31T15:21:21-06:00 WARN metabase.driver.common Don't know how to map class 'class org.postgresql.jdbc.PgArray' to a Field base_type, falling back to :type/*.
[7274f9d5-eaad-4d46-b330-87fb9efd36d1] 2025-01-31T15:21:21-06:00 ERROR metabase.notification.send [Notification null] Failed to send,clojure.lang.ExceptionInfo: Unfreezable type: class org.postgresql.jdbc.PgArray {:type org.postgresql.jdbc.PgArray, :as-str ""#object[org.postgresql.jdbc.PgArray 0x4d84b07 \""{alice}\""]""}

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""snowflake"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-21"",
      ""tag"": ""v1.52.7"",
      ""hash"": ""ddbc480""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.1 (Debian 15.1-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.167.4-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

severe

### Additional context

Several of a customers subscriptions are failing to deliver. Tested in v51 and it works.",ixipixi,2025-01-31 21:38:12+00:00,['rileythomp'],2025-02-06 15:26:04+00:00,,https://github.com/metabase/metabase/issues/53083,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Postgres', None), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Escalation', ''), ('.Team/Drivers', '')]","[{'comment_id': 2628608603, 'issue_id': 2824439458, 'author': 'dpsutton', 'body': '<details>\n\n<summary> stacktrace </summary>\n\n\n```\n2025-02-01 00:18:46,531 ERROR notification.send :: [Notification null] Failed to send\nclojure.lang.ExceptionInfo: Unfreezable type: class org.postgresql.jdbc.PgArray {:type org.postgresql.jdbc.PgArray, :as-str ""#object[org.postgresql.jdbc.PgArray 0x7c2683bd \\""{apple,banana}\\""]""}\n\tat taoensso.nippy$throw_unfreezable.invokeStatic(nippy.clj:953)\n\tat taoensso.nippy$throw_unfreezable.invoke(nippy.clj:950)\n\tat taoensso.nippy$eval82435$fn__82438.invoke(nippy.clj:1188)\n\tat taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)\n\tat taoensso.nippy$eval81998$fn__81999.invoke(nippy.clj:605)\n\tat taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)\n\tat taoensso.nippy$write_vec$fn__82101$fn__82102.invoke(nippy.clj:746)\n\tat taoensso.nippy$write_vec$fn__82101.invoke(nippy.clj:746)\n\tat clojure.lang.PersistentVector.reduce(PersistentVector.java:418)\n\tat clojure.core$reduce.invokeStatic(core.clj:6964)\n\tat clojure.core$reduce.invoke(core.clj:6947)\n\tat taoensso.nippy$write_vec.invokeStatic(nippy.clj:746)\n\tat taoensso.nippy$write_vec.invoke(nippy.clj:735)\n\tat taoensso.nippy$eval82360$fn__82363.invoke(nippy.clj:1113)\n\tat taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)\n\tat taoensso.nippy$eval81989$fn__81990.invoke(nippy.clj:602)\n\tat taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)\n\tat taoensso.nippy$write_vec$fn__82101$fn__82102.invoke(nippy.clj:746)\n\tat taoensso.nippy$write_vec$fn__82101.invoke(nippy.clj:746)\n\tat clojure.lang.PersistentVector.reduce(PersistentVector.java:418)\n\tat clojure.core$reduce.invokeStatic(core.clj:6964)\n\tat clojure.core$reduce.invoke(core.clj:6947)\n\tat taoensso.nippy$write_vec.invokeStatic(nippy.clj:746)\n\tat taoensso.nippy$write_vec.invoke(nippy.clj:735)\n\tat taoensso.nippy$eval82360$fn__82363.invoke(nippy.clj:1113)\n\tat taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)\n\tat taoensso.nippy$eval81989$fn__81990.invoke(nippy.clj:602)\n\tat taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)\n\tat taoensso.nippy$freeze$fn__82467$fn__82470.invoke(nippy.clj:1288)\n\tat taoensso.nippy$freeze$fn__82467.invoke(nippy.clj:1288)\n\tat taoensso.nippy$call_with_bindings.invokeStatic(nippy.clj:1213)\n\tat taoensso.nippy$call_with_bindings.invoke(nippy.clj:1209)\n\tat taoensso.nippy$freeze.invokeStatic(nippy.clj:1272)\n\tat taoensso.nippy$freeze.invoke(nippy.clj:1263)\n\tat taoensso.nippy$freeze_to_file.invokeStatic(nippy.clj:2155)\n\tat taoensso.nippy$freeze_to_file.invoke(nippy.clj:2151)\n\tat taoensso.nippy$freeze_to_file.invokeStatic(nippy.clj:2153)\n\tat taoensso.nippy$freeze_to_file.invoke(nippy.clj:2151)\n\tat metabase.notification.payload.temp_storage$write_to_file.invokeStatic(temp_storage.clj:34)\n\tat metabase.notification.payload.temp_storage$write_to_file.invoke(temp_storage.clj:32)\n\tat metabase.notification.payload.temp_storage$to_temp_file_BANG_.invokeStatic(temp_storage.clj:84)\n\tat metabase.notification.payload.temp_storage$to_temp_file_BANG_.invoke(temp_storage.clj:78)\n\tat clojure.lang.AFn.applyToHelper(AFn.java:154)\n\tat clojure.lang.AFn.applyTo(AFn.java:144)\n\tat clojure.core$apply.invokeStatic(core.clj:669)\n\tat clojure.core$update_in$up__6945.invoke(core.clj:6248)\n\tat clojure.core$update_in$up__6945.invoke(core.clj:6247)\n\tat clojure.core$update_in.invokeStatic(core.clj:6249)\n\tat clojure.core$update_in.doInvoke(core.clj:6235)\n\tat clojure.lang.RestFn.invoke(RestFn.java:448)\n\tat metabase.notification.payload.execute$data_rows_to_disk_BANG_.invokeStatic(execute.clj:139)\n\tat metabase.notification.payload.execute$data_rows_to_disk_BANG_.invoke(execute.clj:137)\n\tat medley.core$update_existing.invokeStatic(core.cljc:55)\n\tat medley.core$update_existing.invoke(core.cljc:49)\n\tat metabase.notification.payload.execute$dashcard__GT_part.invokeStatic(execute.clj:191)\n\tat metabase.notification.payload.execute$dashcard__GT_part.invoke(execute.clj:180)\n\tat metabase.notification.payload.execute$dashcards__GT_part$fn__119045.invoke(execute.clj:218)\n\tat clojure.core$keep$fn__8691.invoke(core.clj:7533)\n\tat clojure.lang.LazySeq.force(LazySeq.java:50)\n\tat clojure.lang.LazySeq.realize(LazySeq.java:89)\n\tat clojure.lang.LazySeq.seq(LazySeq.java:106)\n\tat clojure.lang.RT.seq(RT.java:555)\n\tat clojure.core$seq__5486.invokeStatic(core.clj:139)\n\tat clojure.core$dorun.invokeStatic(core.clj:3141)\n\tat clojure.core$doall.invokeStatic(core.clj:3156)\n\tat clojure.core$doall.invoke(core.clj:3156)\n\tat metabase.notification.payload.execute$dashcards__GT_part.invokeStatic(execute.clj:218)\n\tat metabase.notification.payload.execute$dashcards__GT_part.invoke(execute.clj:215)\n\tat metabase.notification.payload.execute$fn__119050$execute_dashboard119049__119051$fn__119052.invoke(execute.clj:249)\n\tat metabase.request.session$do_with_current_user.invokeStatic(session.clj:50)\n\tat metabase.request.session$do_with_current_user.invoke(session.clj:33)\n\tat metabase.notification.payload.execute$fn__119050$execute_dashboard119049__119051.invoke(execute.clj:239)\n\tat metabase.notification.payload.execute$fn__119050$fn__119073.invoke(execute.clj:236)\n\tat metabase.notification.payload.impl.dashboard$eval178284$_AMPERSAND_f__178286.invoke(dashboard.clj:34)\n\tat metabase.notification.payload.impl.dashboard$eval178284$fn__178295.invoke(dashboard.clj:29)\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:229)\n\tat metabase.notification.payload.core$fn__152113$notification_payload152112__152114.invoke(core.clj:149)\n\tat metabase.notification.payload.core$fn__152113$fn__152116.invoke(core.clj:144)\n\tat metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888$fn__154889$fn__154892.invoke(send.clj:129)\n\tat metabase.models.task_history$fn__102474$do_with_task_history102473__102475.invoke(task_history.clj:117)\n\tat metabase.models.task_history$fn__102474$fn__102483.invoke(task_history.clj:105)\n\tat metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888$fn__154889.invoke(send.clj:126)\n\tat metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888.invoke(send.clj:123)\n\tat metabase.notification.send$fn__154887$fn__154958.invoke(send.clj:120)\n\tat metabase.notification.core$fn__154991$send_notification_BANG_154990__154993.doInvoke(core.clj:37)\n\tat clojure.lang.RestFn.invoke(RestFn.java:426)\n\tat metabase.notification.core$fn__154991$fn__155001.doInvoke(core.clj:31)\n\tat clojure.lang.RestFn.invoke(RestFn.java:442)\n\tat clojure.lang.Var.invoke(Var.java:395)\n\tat metabase.pulse.send$send_pulse_BANG__STAR_$fn__156920.invoke(send.clj:106)\n\tat metabase.pulse.send$send_pulse_BANG__STAR_.invokeStatic(send.clj:105)\n\tat metabase.pulse.send$send_pulse_BANG__STAR_.invoke(send.clj:98)\n\tat metabase.pulse.send$send_pulse_BANG_.invokeStatic(send.clj:132)\n\tat metabase.pulse.send$send_pulse_BANG_.doInvoke(send.clj:111)\n\tat clojure.lang.RestFn.invoke(RestFn.java:413)\n\tat metabase.api.pulse$eval157265$fn__157271$fn__157283.invoke(pulse.clj:375)\n\tat metabase.api.pulse$eval157265$fn__157271.invoke(pulse.clj:374)\n\tat metabase.api.macros$fn__130911$_core_fn130910__130912$core_fn__130913.invoke(macros.clj:405)\n\tat metabase.api.macros$fn__130991$endpoint_handler_STAR_130990__130993$handler__130997.invoke(macros.clj:601)\n\tat metabase.api.macros$fn__131044$build_ns_handler131043__131045$ns_handler_STAR___131046.invoke(macros.clj:665)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.api.macros$fn__131091$ns_handler131090__131092$dev_handler__131097.invoke(macros.clj:762)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.channel.render.preview$style_tag_nonce_middleware$fn__119123.invoke(preview.clj:163)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.server.middleware.auth$enforce_authentication$fn__112637.invoke(auth.clj:18)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154.invoke(core.clj:200)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:23)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat clojure.lang.Var.invoke(Var.java:395)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154.invoke(core.clj:200)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.server.routes$fn__168676$fn__168677.invoke(routes.clj:70)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154.invoke(core.clj:200)\n\tat compojure.core$make_context$handler__129222.invoke(core.clj:290)\n\tat compojure.core$make_context$fn__129226.invoke(core.clj:300)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:23)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat clojure.lang.Var.invoke(Var.java:395)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154.invoke(core.clj:200)\n\tat metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__114157.invoke(exceptions.clj:111)\n\tat metabase.server.middleware.exceptions$catch_api_exceptions$fn__114154.invoke(exceptions.clj:100)\n\tat metabase.server.middleware.log$log_api_call$fn__128522$fn__128523$fn__128524.invoke(log.clj:232)\n\tat metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:17)\n\tat metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12)\n\tat metabase.server.middleware.log$log_api_call$fn__128522$fn__128523.invoke(log.clj:223)\n\tat toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112)\n\tat toucan2.execute$do_with_call_counts.invoke(execute.clj:103)\n\tat metabase.server.middleware.log$log_api_call$fn__128522.invoke(log.clj:222)\n\tat metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__128251.invoke(browser_cookie.clj:40)\n\tat metabase.server.middleware.security$add_security_headers$fn__114099.invoke(security.clj:273)\n\tat metabase.server.middleware.json$wrap_json_body$fn__199162.invoke(json.clj:129)\n\tat metabase.server.middleware.offset_paging$handle_paging$fn__128613.invoke(offset_paging.clj:48)\n\tat metabase.server.middleware.json$wrap_streamed_json_response$fn__199150.invoke(json.clj:84)\n\tat ring.middleware.keyword_params$wrap_keyword_params$fn__168979.invoke(keyword_params.clj:55)\n\tat ring.middleware.params$wrap_params$fn__169006.invoke(params.clj:77)\n\tat metabase.server.middleware.misc$maybe_set_site_url$fn__128570.invoke(misc.clj:59)\n\tat metabase.server.middleware.session$reset_session_timeout$fn__128749.invoke(session.clj:270)\n\tat metabase.server.middleware.session$bind_current_user$fn__128742$fn__128743.invoke(session.clj:245)\n\tat metabase.request.session$do_with_current_user.invokeStatic(session.clj:50)\n\tat metabase.request.session$do_with_current_user.invoke(session.clj:33)\n\tat metabase.server.middleware.session$bind_current_user$fn__128742.invoke(session.clj:244)\n\tat metabase.server.middleware.session$wrap_current_user_info$fn__128730.invoke(session.clj:204)\n\tat metabase.analytics.sdk$embedding_mw$embedding_mw_fn__117361.invoke(sdk.clj:63)\n\tat metabase.server.middleware.session$wrap_session_id$fn__128700.invoke(session.clj:82)\n\tat metabase.server.middleware.auth$wrap_static_api_key$fn__112645.invoke(auth.clj:33)\n\tat ring.middleware.cookies$wrap_cookies$fn__168883.invoke(cookies.clj:200)\n\tat metabase.server.middleware.misc$add_content_type$fn__128548.invoke(misc.clj:28)\n\tat metabase.server.middleware.misc$disable_streaming_buffering$fn__128578.invoke(misc.clj:75)\n\tat ring.middleware.gzip$wrap_gzip$fn__168933.invoke(gzip.clj:86)\n\tat metabase.server.middleware.request_id$wrap_request_id$fn__128630.invoke(request_id.clj:9)\n\tat metabase.server.middleware.misc$bind_request$fn__128581$fn__128582.invoke(misc.clj:87)\n\tat metabase.request.current$do_with_current_request.invokeStatic(current.clj:19)\n\tat metabase.request.current$do_with_current_request.invoke(current.clj:15)\n\tat metabase.server.middleware.misc$bind_request$fn__128581.invoke(misc.clj:86)\n\tat metabase.server.middleware.ssl$redirect_to_https_middleware$fn__128774.invoke(ssl.clj:41)\n\tat clojure.lang.Var.invoke(Var.java:395)\n\tat metabase.server.instance$async_proxy_handler$fn__112589.invoke(instance.clj:76)\n\tat metabase.server.instance.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source)\n\tat org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:563)\n\tat org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598)\n\tat org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287)\n\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314)\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)\n\tat org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199)\n\tat org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149)\n\tat java.base/java.lang.Thread.run(Thread.java:1583)\n2025-02-01 00:18:46,566 ERROR pulse.send :: [Pulse null] Error sending to email channel\nclojure.lang.ExceptionInfo: Unfreezable type: class org.postgresql.jdbc.PgArray {:type org.postgresql.jdbc.PgArray, :as-str ""#object[org.postgresql.jdbc.PgArray 0x7c2683bd \\""{apple,banana}\\""]""}\n\tat taoensso.nippy$throw_unfreezable.invokeStatic(nippy.clj:953)\n\tat taoensso.nippy$throw_unfreezable.invoke(nippy.clj:950)\n\tat taoensso.nippy$eval82435$fn__82438.invoke(nippy.clj:1188)\n\tat taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)\n\tat taoensso.nippy$eval81998$fn__81999.invoke(nippy.clj:605)\n\tat taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)\n\tat taoensso.nippy$write_vec$fn__82101$fn__82102.invoke(nippy.clj:746)\n\tat taoensso.nippy$write_vec$fn__82101.invoke(nippy.clj:746)\n\tat clojure.lang.PersistentVector.reduce(PersistentVector.java:418)\n\tat clojure.core$reduce.invokeStatic(core.clj:6964)\n\tat clojure.core$reduce.invoke(core.clj:6947)\n\tat taoensso.nippy$write_vec.invokeStatic(nippy.clj:746)\n\tat taoensso.nippy$write_vec.invoke(nippy.clj:735)\n\tat taoensso.nippy$eval82360$fn__82363.invoke(nippy.clj:1113)\n\tat taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)\n\tat taoensso.nippy$eval81989$fn__81990.invoke(nippy.clj:602)\n\tat taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)\n\tat taoensso.nippy$write_vec$fn__82101$fn__82102.invoke(nippy.clj:746)\n\tat taoensso.nippy$write_vec$fn__82101.invoke(nippy.clj:746)\n\tat clojure.lang.PersistentVector.reduce(PersistentVector.java:418)\n\tat clojure.core$reduce.invokeStatic(core.clj:6964)\n\tat clojure.core$reduce.invoke(core.clj:6947)\n\tat taoensso.nippy$write_vec.invokeStatic(nippy.clj:746)\n\tat taoensso.nippy$write_vec.invoke(nippy.clj:735)\n\tat taoensso.nippy$eval82360$fn__82363.invoke(nippy.clj:1113)\n\tat taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)\n\tat taoensso.nippy$eval81989$fn__81990.invoke(nippy.clj:602)\n\tat taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)\n\tat taoensso.nippy$freeze$fn__82467$fn__82470.invoke(nippy.clj:1288)\n\tat taoensso.nippy$freeze$fn__82467.invoke(nippy.clj:1288)\n\tat taoensso.nippy$call_with_bindings.invokeStatic(nippy.clj:1213)\n\tat taoensso.nippy$call_with_bindings.invoke(nippy.clj:1209)\n\tat taoensso.nippy$freeze.invokeStatic(nippy.clj:1272)\n\tat taoensso.nippy$freeze.invoke(nippy.clj:1263)\n\tat taoensso.nippy$freeze_to_file.invokeStatic(nippy.clj:2155)\n\tat taoensso.nippy$freeze_to_file.invoke(nippy.clj:2151)\n\tat taoensso.nippy$freeze_to_file.invokeStatic(nippy.clj:2153)\n\tat taoensso.nippy$freeze_to_file.invoke(nippy.clj:2151)\n\tat metabase.notification.payload.temp_storage$write_to_file.invokeStatic(temp_storage.clj:34)\n\tat metabase.notification.payload.temp_storage$write_to_file.invoke(temp_storage.clj:32)\n\tat metabase.notification.payload.temp_storage$to_temp_file_BANG_.invokeStatic(temp_storage.clj:84)\n\tat metabase.notification.payload.temp_storage$to_temp_file_BANG_.invoke(temp_storage.clj:78)\n\tat clojure.lang.AFn.applyToHelper(AFn.java:154)\n\tat clojure.lang.AFn.applyTo(AFn.java:144)\n\tat clojure.core$apply.invokeStatic(core.clj:669)\n\tat clojure.core$update_in$up__6945.invoke(core.clj:6248)\n\tat clojure.core$update_in$up__6945.invoke(core.clj:6247)\n\tat clojure.core$update_in.invokeStatic(core.clj:6249)\n\tat clojure.core$update_in.doInvoke(core.clj:6235)\n\tat clojure.lang.RestFn.invoke(RestFn.java:448)\n\tat metabase.notification.payload.execute$data_rows_to_disk_BANG_.invokeStatic(execute.clj:139)\n\tat metabase.notification.payload.execute$data_rows_to_disk_BANG_.invoke(execute.clj:137)\n\tat medley.core$update_existing.invokeStatic(core.cljc:55)\n\tat medley.core$update_existing.invoke(core.cljc:49)\n\tat metabase.notification.payload.execute$dashcard__GT_part.invokeStatic(execute.clj:191)\n\tat metabase.notification.payload.execute$dashcard__GT_part.invoke(execute.clj:180)\n\tat metabase.notification.payload.execute$dashcards__GT_part$fn__119045.invoke(execute.clj:218)\n\tat clojure.core$keep$fn__8691.invoke(core.clj:7533)\n\tat clojure.lang.LazySeq.force(LazySeq.java:50)\n\tat clojure.lang.LazySeq.realize(LazySeq.java:89)\n\tat clojure.lang.LazySeq.seq(LazySeq.java:106)\n\tat clojure.lang.RT.seq(RT.java:555)\n\tat clojure.core$seq__5486.invokeStatic(core.clj:139)\n\tat clojure.core$dorun.invokeStatic(core.clj:3141)\n\tat clojure.core$doall.invokeStatic(core.clj:3156)\n\tat clojure.core$doall.invoke(core.clj:3156)\n\tat metabase.notification.payload.execute$dashcards__GT_part.invokeStatic(execute.clj:218)\n\tat metabase.notification.payload.execute$dashcards__GT_part.invoke(execute.clj:215)\n\tat metabase.notification.payload.execute$fn__119050$execute_dashboard119049__119051$fn__119052.invoke(execute.clj:249)\n\tat metabase.request.session$do_with_current_user.invokeStatic(session.clj:50)\n\tat metabase.request.session$do_with_current_user.invoke(session.clj:33)\n\tat metabase.notification.payload.execute$fn__119050$execute_dashboard119049__119051.invoke(execute.clj:239)\n\tat metabase.notification.payload.execute$fn__119050$fn__119073.invoke(execute.clj:236)\n\tat metabase.notification.payload.impl.dashboard$eval178284$_AMPERSAND_f__178286.invoke(dashboard.clj:34)\n\tat metabase.notification.payload.impl.dashboard$eval178284$fn__178295.invoke(dashboard.clj:29)\n\tat clojure.lang.MultiFn.invoke(MultiFn.java:229)\n\tat metabase.notification.payload.core$fn__152113$notification_payload152112__152114.invoke(core.clj:149)\n\tat metabase.notification.payload.core$fn__152113$fn__152116.invoke(core.clj:144)\n\tat metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888$fn__154889$fn__154892.invoke(send.clj:129)\n\tat metabase.models.task_history$fn__102474$do_with_task_history102473__102475.invoke(task_history.clj:117)\n\tat metabase.models.task_history$fn__102474$fn__102483.invoke(task_history.clj:105)\n\tat metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888$fn__154889.invoke(send.clj:126)\n\tat metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888.invoke(send.clj:123)\n\tat metabase.notification.send$fn__154887$fn__154958.invoke(send.clj:120)\n\tat metabase.notification.core$fn__154991$send_notification_BANG_154990__154993.doInvoke(core.clj:37)\n\tat clojure.lang.RestFn.invoke(RestFn.java:426)\n\tat metabase.notification.core$fn__154991$fn__155001.doInvoke(core.clj:31)\n\tat clojure.lang.RestFn.invoke(RestFn.java:442)\n\tat clojure.lang.Var.invoke(Var.java:395)\n\tat metabase.pulse.send$send_pulse_BANG__STAR_$fn__156920.invoke(send.clj:106)\n\tat metabase.pulse.send$send_pulse_BANG__STAR_.invokeStatic(send.clj:105)\n\tat metabase.pulse.send$send_pulse_BANG__STAR_.invoke(send.clj:98)\n\tat metabase.pulse.send$send_pulse_BANG_.invokeStatic(send.clj:132)\n\tat metabase.pulse.send$send_pulse_BANG_.doInvoke(send.clj:111)\n\tat clojure.lang.RestFn.invoke(RestFn.java:413)\n\tat metabase.api.pulse$eval157265$fn__157271$fn__157283.invoke(pulse.clj:375)\n\tat metabase.api.pulse$eval157265$fn__157271.invoke(pulse.clj:374)\n\tat metabase.api.macros$fn__130911$_core_fn130910__130912$core_fn__130913.invoke(macros.clj:405)\n\tat metabase.api.macros$fn__130991$endpoint_handler_STAR_130990__130993$handler__130997.invoke(macros.clj:601)\n\tat metabase.api.macros$fn__131044$build_ns_handler131043__131045$ns_handler_STAR___131046.invoke(macros.clj:665)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.api.macros$fn__131091$ns_handler131090__131092$dev_handler__131097.invoke(macros.clj:762)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.channel.render.preview$style_tag_nonce_middleware$fn__119123.invoke(preview.clj:163)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.server.middleware.auth$enforce_authentication$fn__112637.invoke(auth.clj:18)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154.invoke(core.clj:200)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:23)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat clojure.lang.Var.invoke(Var.java:395)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154.invoke(core.clj:200)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.server.routes$fn__168676$fn__168677.invoke(routes.clj:70)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154.invoke(core.clj:200)\n\tat compojure.core$make_context$handler__129222.invoke(core.clj:290)\n\tat compojure.core$make_context$fn__129226.invoke(core.clj:300)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)\n\tat metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:23)\n\tat metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)\n\tat clojure.lang.Var.invoke(Var.java:395)\n\tat compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)\n\tat compojure.core$routes$fn__129154.invoke(core.clj:200)\n\tat metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__114157.invoke(exceptions.clj:111)\n\tat metabase.server.middleware.exceptions$catch_api_exceptions$fn__114154.invoke(exceptions.clj:100)\n\tat metabase.server.middleware.log$log_api_call$fn__128522$fn__128523$fn__128524.invoke(log.clj:232)\n\tat metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:17)\n\tat metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12)\n\tat metabase.server.middleware.log$log_api_call$fn__128522$fn__128523.invoke(log.clj:223)\n\tat toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112)\n\tat toucan2.execute$do_with_call_counts.invoke(execute.clj:103)\n\tat metabase.server.middleware.log$log_api_call$fn__128522.invoke(log.clj:222)\n\tat metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__128251.invoke(browser_cookie.clj:40)\n\tat metabase.server.middleware.security$add_security_headers$fn__114099.invoke(security.clj:273)\n\tat metabase.server.middleware.json$wrap_json_body$fn__199162.invoke(json.clj:129)\n\tat metabase.server.middleware.offset_paging$handle_paging$fn__128613.invoke(offset_paging.clj:48)\n\tat metabase.server.middleware.json$wrap_streamed_json_response$fn__199150.invoke(json.clj:84)\n\tat ring.middleware.keyword_params$wrap_keyword_params$fn__168979.invoke(keyword_params.clj:55)\n\tat ring.middleware.params$wrap_params$fn__169006.invoke(params.clj:77)\n\tat metabase.server.middleware.misc$maybe_set_site_url$fn__128570.invoke(misc.clj:59)\n\tat metabase.server.middleware.session$reset_session_timeout$fn__128749.invoke(session.clj:270)\n\tat metabase.server.middleware.session$bind_current_user$fn__128742$fn__128743.invoke(session.clj:245)\n\tat metabase.request.session$do_with_current_user.invokeStatic(session.clj:50)\n\tat metabase.request.session$do_with_current_user.invoke(session.clj:33)\n\tat metabase.server.middleware.session$bind_current_user$fn__128742.invoke(session.clj:244)\n\tat metabase.server.middleware.session$wrap_current_user_info$fn__128730.invoke(session.clj:204)\n\tat metabase.analytics.sdk$embedding_mw$embedding_mw_fn__117361.invoke(sdk.clj:63)\n\tat metabase.server.middleware.session$wrap_session_id$fn__128700.invoke(session.clj:82)\n\tat metabase.server.middleware.auth$wrap_static_api_key$fn__112645.invoke(auth.clj:33)\n\tat ring.middleware.cookies$wrap_cookies$fn__168883.invoke(cookies.clj:200)\n\tat metabase.server.middleware.misc$add_content_type$fn__128548.invoke(misc.clj:28)\n\tat metabase.server.middleware.misc$disable_streaming_buffering$fn__128578.invoke(misc.clj:75)\n\tat ring.middleware.gzip$wrap_gzip$fn__168933.invoke(gzip.clj:86)\n\tat metabase.server.middleware.request_id$wrap_request_id$fn__128630.invoke(request_id.clj:9)\n\tat metabase.server.middleware.misc$bind_request$fn__128581$fn__128582.invoke(misc.clj:87)\n\tat metabase.request.current$do_with_current_request.invokeStatic(current.clj:19)\n\tat metabase.request.current$do_with_current_request.invoke(current.clj:15)\n\tat metabase.server.middleware.misc$bind_request$fn__128581.invoke(misc.clj:86)\n\tat metabase.server.middleware.ssl$redirect_to_https_middleware$fn__128774.invoke(ssl.clj:41)\n\tat clojure.lang.Var.invoke(Var.java:395)\n\tat metabase.server.instance$async_proxy_handler$fn__112589.invoke(instance.clj:76)\n\tat metabase.server.instance.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source)\n\tat org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:563)\n\tat org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598)\n\tat org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287)\n\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314)\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)\n\tat org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)\n\tat org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199)\n\tat org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149)\n\tat java.base/java.lang.Thread.run(Thread.java:1583)\n````\n</details>\n\nand a simple query to repro:\n\n```sql\nWITH sample_data AS (\n  SELECT * FROM (\n    VALUES \n      (\'2024-01-01\', \'apple\'),\n      (\'2024-01-01\', \'banana\'),\n      (\'2024-01-02\', \'apple\'),\n      (\'2024-01-02\', \'orange\')\n  ) t(sale_date, fruit)\n)\nSELECT \n  sale_date,\n  array_agg(fruit ORDER BY fruit) as fruits_sold\nFROM sample_data\nGROUP BY sale_date\nORDER BY sale_date;\n```', 'created_at': datetime.datetime(2025, 2, 1, 0, 19, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2631300980, 'issue_id': 2824439458, 'author': 'dpsutton', 'body': 'There are a few ways to fix this:\n\n#### Normal Nippy way\nFix it the ""normal"" way. Tell nippy how to serialize and deserialize the data. This has a slight wrinkle. Normally you write the instance to bytes and then figure out how to reconstruct it. This is not possible here because a `PgArray` has a connection in it. It\'s nullable, but the class seems a bit strange: https://jdbc.postgresql.org/documentation/publicapi/org/postgresql/jdbc/PgArray.html\n\nBut this does work:\n```clojure\n(nippy/extend-freeze PgArray :postgres/PgArray\n  [^PgArray pg-arr data-output]\n  (nippy/try-write-readable data-output (vec (.getArray pg-arr))))\n\n(nippy/extend-thaw :postgres/PgArray\n  [data-input]\n  (nippy/thaw-from-in! data-input))\n```\n\nHave to use vector rather than the array for json encoding reasons. More on that below.\nWhy is this not great? Because the query changes. A ""fresh"" query has a `org.postgresql.jdbc.PgArray` object; one from the cache has a clojure `vector`. This seems innocuous at the moment as they are essentially opaque bits until we hit the wire, but it feels like a very surprising footgun to the future.\n\n#### read column thunk fix 1\nWhy read this as a PgArray at all? Let\'s just get the backing array\n```clojure\n;; de-CLOB any CLOB values that come back\n(defmethod sql-jdbc.execute/read-column-thunk :postgres\n  [_ ^ResultSet rs _ ^Integer i]\n  (fn []\n    (let [obj (.getObject rs i)]\n      (cond (instance? org.postgresql.util.PGobject obj)\n            (.getValue ^org.postgresql.util.PGobject obj)\n            (instance? org.postgresql.jdbc.PgArray obj) ;; new branch\n            (.getArray ^org.postgresql.jdbc.PgArray obj)\n            :else\n            obj))))\n```\n\nThis _almost_ works. It requires one change in addition:\n\n```clojure\ntell middleware json how to turn a string array into json\n(json/add-encoder\n (Class/forName ""[Ljava.lang.String;"")\n (fn [string-arr json-generator]\n   (json/write-string json-generator (cheshire.core/generate-string (vec string-arr)))))\n```\n\nI alluded to this above. If things are arrays, we need to know how to put them on the wire. This solution has the benefit of uniform types in the query results. Whether cached or fresh, they are java arrays. These are easily serialized by nippy so notifications and cache are happy.\n\n#### read column thunk fix 2\nFewer changes are necessary if we just turn the array into a clojure vector. No need to instruct how to turn arrays into json, nippy serialization is obviously handled. Only thing is does this offend our sense of taste? I don\'t think it does or should but want to call it out. The fix is similar to above but `vec`ing the array that comes back.\n\n```clojure\n(defmethod sql-jdbc.execute/read-column-thunk :postgres\n  [_ ^ResultSet rs _ ^Integer i]\n  (fn []\n    (let [obj (.getObject rs i)]\n      (cond (instance? org.postgresql.util.PGobject obj)\n            (.getValue ^org.postgresql.util.PGobject obj)\n            (instance? org.postgresql.jdbc.PgArray obj)\n            (vec (.getArray ^org.postgresql.jdbc.PgArray obj)) ;; vec\n            :else\n            obj))))\n```', 'created_at': datetime.datetime(2025, 2, 3, 15, 17, 43, tzinfo=datetime.timezone.utc)}]","dpsutton on (2025-02-01 00:19:51 UTC): <details>

<summary> stacktrace </summary>


```
2025-02-01 00:18:46,531 ERROR notification.send :: [Notification null] Failed to send
clojure.lang.ExceptionInfo: Unfreezable type: class org.postgresql.jdbc.PgArray {:type org.postgresql.jdbc.PgArray, :as-str ""#object[org.postgresql.jdbc.PgArray 0x7c2683bd \""{apple,banana}\""]""}
	at taoensso.nippy$throw_unfreezable.invokeStatic(nippy.clj:953)
	at taoensso.nippy$throw_unfreezable.invoke(nippy.clj:950)
	at taoensso.nippy$eval82435$fn__82438.invoke(nippy.clj:1188)
	at taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)
	at taoensso.nippy$eval81998$fn__81999.invoke(nippy.clj:605)
	at taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)
	at taoensso.nippy$write_vec$fn__82101$fn__82102.invoke(nippy.clj:746)
	at taoensso.nippy$write_vec$fn__82101.invoke(nippy.clj:746)
	at clojure.lang.PersistentVector.reduce(PersistentVector.java:418)
	at clojure.core$reduce.invokeStatic(core.clj:6964)
	at clojure.core$reduce.invoke(core.clj:6947)
	at taoensso.nippy$write_vec.invokeStatic(nippy.clj:746)
	at taoensso.nippy$write_vec.invoke(nippy.clj:735)
	at taoensso.nippy$eval82360$fn__82363.invoke(nippy.clj:1113)
	at taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)
	at taoensso.nippy$eval81989$fn__81990.invoke(nippy.clj:602)
	at taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)
	at taoensso.nippy$write_vec$fn__82101$fn__82102.invoke(nippy.clj:746)
	at taoensso.nippy$write_vec$fn__82101.invoke(nippy.clj:746)
	at clojure.lang.PersistentVector.reduce(PersistentVector.java:418)
	at clojure.core$reduce.invokeStatic(core.clj:6964)
	at clojure.core$reduce.invoke(core.clj:6947)
	at taoensso.nippy$write_vec.invokeStatic(nippy.clj:746)
	at taoensso.nippy$write_vec.invoke(nippy.clj:735)
	at taoensso.nippy$eval82360$fn__82363.invoke(nippy.clj:1113)
	at taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)
	at taoensso.nippy$eval81989$fn__81990.invoke(nippy.clj:602)
	at taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)
	at taoensso.nippy$freeze$fn__82467$fn__82470.invoke(nippy.clj:1288)
	at taoensso.nippy$freeze$fn__82467.invoke(nippy.clj:1288)
	at taoensso.nippy$call_with_bindings.invokeStatic(nippy.clj:1213)
	at taoensso.nippy$call_with_bindings.invoke(nippy.clj:1209)
	at taoensso.nippy$freeze.invokeStatic(nippy.clj:1272)
	at taoensso.nippy$freeze.invoke(nippy.clj:1263)
	at taoensso.nippy$freeze_to_file.invokeStatic(nippy.clj:2155)
	at taoensso.nippy$freeze_to_file.invoke(nippy.clj:2151)
	at taoensso.nippy$freeze_to_file.invokeStatic(nippy.clj:2153)
	at taoensso.nippy$freeze_to_file.invoke(nippy.clj:2151)
	at metabase.notification.payload.temp_storage$write_to_file.invokeStatic(temp_storage.clj:34)
	at metabase.notification.payload.temp_storage$write_to_file.invoke(temp_storage.clj:32)
	at metabase.notification.payload.temp_storage$to_temp_file_BANG_.invokeStatic(temp_storage.clj:84)
	at metabase.notification.payload.temp_storage$to_temp_file_BANG_.invoke(temp_storage.clj:78)
	at clojure.lang.AFn.applyToHelper(AFn.java:154)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$update_in$up__6945.invoke(core.clj:6248)
	at clojure.core$update_in$up__6945.invoke(core.clj:6247)
	at clojure.core$update_in.invokeStatic(core.clj:6249)
	at clojure.core$update_in.doInvoke(core.clj:6235)
	at clojure.lang.RestFn.invoke(RestFn.java:448)
	at metabase.notification.payload.execute$data_rows_to_disk_BANG_.invokeStatic(execute.clj:139)
	at metabase.notification.payload.execute$data_rows_to_disk_BANG_.invoke(execute.clj:137)
	at medley.core$update_existing.invokeStatic(core.cljc:55)
	at medley.core$update_existing.invoke(core.cljc:49)
	at metabase.notification.payload.execute$dashcard__GT_part.invokeStatic(execute.clj:191)
	at metabase.notification.payload.execute$dashcard__GT_part.invoke(execute.clj:180)
	at metabase.notification.payload.execute$dashcards__GT_part$fn__119045.invoke(execute.clj:218)
	at clojure.core$keep$fn__8691.invoke(core.clj:7533)
	at clojure.lang.LazySeq.force(LazySeq.java:50)
	at clojure.lang.LazySeq.realize(LazySeq.java:89)
	at clojure.lang.LazySeq.seq(LazySeq.java:106)
	at clojure.lang.RT.seq(RT.java:555)
	at clojure.core$seq__5486.invokeStatic(core.clj:139)
	at clojure.core$dorun.invokeStatic(core.clj:3141)
	at clojure.core$doall.invokeStatic(core.clj:3156)
	at clojure.core$doall.invoke(core.clj:3156)
	at metabase.notification.payload.execute$dashcards__GT_part.invokeStatic(execute.clj:218)
	at metabase.notification.payload.execute$dashcards__GT_part.invoke(execute.clj:215)
	at metabase.notification.payload.execute$fn__119050$execute_dashboard119049__119051$fn__119052.invoke(execute.clj:249)
	at metabase.request.session$do_with_current_user.invokeStatic(session.clj:50)
	at metabase.request.session$do_with_current_user.invoke(session.clj:33)
	at metabase.notification.payload.execute$fn__119050$execute_dashboard119049__119051.invoke(execute.clj:239)
	at metabase.notification.payload.execute$fn__119050$fn__119073.invoke(execute.clj:236)
	at metabase.notification.payload.impl.dashboard$eval178284$_AMPERSAND_f__178286.invoke(dashboard.clj:34)
	at metabase.notification.payload.impl.dashboard$eval178284$fn__178295.invoke(dashboard.clj:29)
	at clojure.lang.MultiFn.invoke(MultiFn.java:229)
	at metabase.notification.payload.core$fn__152113$notification_payload152112__152114.invoke(core.clj:149)
	at metabase.notification.payload.core$fn__152113$fn__152116.invoke(core.clj:144)
	at metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888$fn__154889$fn__154892.invoke(send.clj:129)
	at metabase.models.task_history$fn__102474$do_with_task_history102473__102475.invoke(task_history.clj:117)
	at metabase.models.task_history$fn__102474$fn__102483.invoke(task_history.clj:105)
	at metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888$fn__154889.invoke(send.clj:126)
	at metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888.invoke(send.clj:123)
	at metabase.notification.send$fn__154887$fn__154958.invoke(send.clj:120)
	at metabase.notification.core$fn__154991$send_notification_BANG_154990__154993.doInvoke(core.clj:37)
	at clojure.lang.RestFn.invoke(RestFn.java:426)
	at metabase.notification.core$fn__154991$fn__155001.doInvoke(core.clj:31)
	at clojure.lang.RestFn.invoke(RestFn.java:442)
	at clojure.lang.Var.invoke(Var.java:395)
	at metabase.pulse.send$send_pulse_BANG__STAR_$fn__156920.invoke(send.clj:106)
	at metabase.pulse.send$send_pulse_BANG__STAR_.invokeStatic(send.clj:105)
	at metabase.pulse.send$send_pulse_BANG__STAR_.invoke(send.clj:98)
	at metabase.pulse.send$send_pulse_BANG_.invokeStatic(send.clj:132)
	at metabase.pulse.send$send_pulse_BANG_.doInvoke(send.clj:111)
	at clojure.lang.RestFn.invoke(RestFn.java:413)
	at metabase.api.pulse$eval157265$fn__157271$fn__157283.invoke(pulse.clj:375)
	at metabase.api.pulse$eval157265$fn__157271.invoke(pulse.clj:374)
	at metabase.api.macros$fn__130911$_core_fn130910__130912$core_fn__130913.invoke(macros.clj:405)
	at metabase.api.macros$fn__130991$endpoint_handler_STAR_130990__130993$handler__130997.invoke(macros.clj:601)
	at metabase.api.macros$fn__131044$build_ns_handler131043__131045$ns_handler_STAR___131046.invoke(macros.clj:665)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.api.macros$fn__131091$ns_handler131090__131092$dev_handler__131097.invoke(macros.clj:762)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.channel.render.preview$style_tag_nonce_middleware$fn__119123.invoke(preview.clj:163)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.server.middleware.auth$enforce_authentication$fn__112637.invoke(auth.clj:18)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154.invoke(core.clj:200)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:23)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at clojure.lang.Var.invoke(Var.java:395)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154.invoke(core.clj:200)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.server.routes$fn__168676$fn__168677.invoke(routes.clj:70)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154.invoke(core.clj:200)
	at compojure.core$make_context$handler__129222.invoke(core.clj:290)
	at compojure.core$make_context$fn__129226.invoke(core.clj:300)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:23)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at clojure.lang.Var.invoke(Var.java:395)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154.invoke(core.clj:200)
	at metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__114157.invoke(exceptions.clj:111)
	at metabase.server.middleware.exceptions$catch_api_exceptions$fn__114154.invoke(exceptions.clj:100)
	at metabase.server.middleware.log$log_api_call$fn__128522$fn__128523$fn__128524.invoke(log.clj:232)
	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:17)
	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12)
	at metabase.server.middleware.log$log_api_call$fn__128522$fn__128523.invoke(log.clj:223)
	at toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112)
	at toucan2.execute$do_with_call_counts.invoke(execute.clj:103)
	at metabase.server.middleware.log$log_api_call$fn__128522.invoke(log.clj:222)
	at metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__128251.invoke(browser_cookie.clj:40)
	at metabase.server.middleware.security$add_security_headers$fn__114099.invoke(security.clj:273)
	at metabase.server.middleware.json$wrap_json_body$fn__199162.invoke(json.clj:129)
	at metabase.server.middleware.offset_paging$handle_paging$fn__128613.invoke(offset_paging.clj:48)
	at metabase.server.middleware.json$wrap_streamed_json_response$fn__199150.invoke(json.clj:84)
	at ring.middleware.keyword_params$wrap_keyword_params$fn__168979.invoke(keyword_params.clj:55)
	at ring.middleware.params$wrap_params$fn__169006.invoke(params.clj:77)
	at metabase.server.middleware.misc$maybe_set_site_url$fn__128570.invoke(misc.clj:59)
	at metabase.server.middleware.session$reset_session_timeout$fn__128749.invoke(session.clj:270)
	at metabase.server.middleware.session$bind_current_user$fn__128742$fn__128743.invoke(session.clj:245)
	at metabase.request.session$do_with_current_user.invokeStatic(session.clj:50)
	at metabase.request.session$do_with_current_user.invoke(session.clj:33)
	at metabase.server.middleware.session$bind_current_user$fn__128742.invoke(session.clj:244)
	at metabase.server.middleware.session$wrap_current_user_info$fn__128730.invoke(session.clj:204)
	at metabase.analytics.sdk$embedding_mw$embedding_mw_fn__117361.invoke(sdk.clj:63)
	at metabase.server.middleware.session$wrap_session_id$fn__128700.invoke(session.clj:82)
	at metabase.server.middleware.auth$wrap_static_api_key$fn__112645.invoke(auth.clj:33)
	at ring.middleware.cookies$wrap_cookies$fn__168883.invoke(cookies.clj:200)
	at metabase.server.middleware.misc$add_content_type$fn__128548.invoke(misc.clj:28)
	at metabase.server.middleware.misc$disable_streaming_buffering$fn__128578.invoke(misc.clj:75)
	at ring.middleware.gzip$wrap_gzip$fn__168933.invoke(gzip.clj:86)
	at metabase.server.middleware.request_id$wrap_request_id$fn__128630.invoke(request_id.clj:9)
	at metabase.server.middleware.misc$bind_request$fn__128581$fn__128582.invoke(misc.clj:87)
	at metabase.request.current$do_with_current_request.invokeStatic(current.clj:19)
	at metabase.request.current$do_with_current_request.invoke(current.clj:15)
	at metabase.server.middleware.misc$bind_request$fn__128581.invoke(misc.clj:86)
	at metabase.server.middleware.ssl$redirect_to_https_middleware$fn__128774.invoke(ssl.clj:41)
	at clojure.lang.Var.invoke(Var.java:395)
	at metabase.server.instance$async_proxy_handler$fn__112589.invoke(instance.clj:76)
	at metabase.server.instance.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source)
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)
	at org.eclipse.jetty.server.Server.handle(Server.java:563)
	at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)
	at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-02-01 00:18:46,566 ERROR pulse.send :: [Pulse null] Error sending to email channel
clojure.lang.ExceptionInfo: Unfreezable type: class org.postgresql.jdbc.PgArray {:type org.postgresql.jdbc.PgArray, :as-str ""#object[org.postgresql.jdbc.PgArray 0x7c2683bd \""{apple,banana}\""]""}
	at taoensso.nippy$throw_unfreezable.invokeStatic(nippy.clj:953)
	at taoensso.nippy$throw_unfreezable.invoke(nippy.clj:950)
	at taoensso.nippy$eval82435$fn__82438.invoke(nippy.clj:1188)
	at taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)
	at taoensso.nippy$eval81998$fn__81999.invoke(nippy.clj:605)
	at taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)
	at taoensso.nippy$write_vec$fn__82101$fn__82102.invoke(nippy.clj:746)
	at taoensso.nippy$write_vec$fn__82101.invoke(nippy.clj:746)
	at clojure.lang.PersistentVector.reduce(PersistentVector.java:418)
	at clojure.core$reduce.invokeStatic(core.clj:6964)
	at clojure.core$reduce.invoke(core.clj:6947)
	at taoensso.nippy$write_vec.invokeStatic(nippy.clj:746)
	at taoensso.nippy$write_vec.invoke(nippy.clj:735)
	at taoensso.nippy$eval82360$fn__82363.invoke(nippy.clj:1113)
	at taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)
	at taoensso.nippy$eval81989$fn__81990.invoke(nippy.clj:602)
	at taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)
	at taoensso.nippy$write_vec$fn__82101$fn__82102.invoke(nippy.clj:746)
	at taoensso.nippy$write_vec$fn__82101.invoke(nippy.clj:746)
	at clojure.lang.PersistentVector.reduce(PersistentVector.java:418)
	at clojure.core$reduce.invokeStatic(core.clj:6964)
	at clojure.core$reduce.invoke(core.clj:6947)
	at taoensso.nippy$write_vec.invokeStatic(nippy.clj:746)
	at taoensso.nippy$write_vec.invoke(nippy.clj:735)
	at taoensso.nippy$eval82360$fn__82363.invoke(nippy.clj:1113)
	at taoensso.nippy$eval81926$fn__81938$G__81917__81945.invoke(nippy.clj:580)
	at taoensso.nippy$eval81989$fn__81990.invoke(nippy.clj:602)
	at taoensso.nippy$eval81965$fn__81966$G__81956__81973.invoke(nippy.clj:587)
	at taoensso.nippy$freeze$fn__82467$fn__82470.invoke(nippy.clj:1288)
	at taoensso.nippy$freeze$fn__82467.invoke(nippy.clj:1288)
	at taoensso.nippy$call_with_bindings.invokeStatic(nippy.clj:1213)
	at taoensso.nippy$call_with_bindings.invoke(nippy.clj:1209)
	at taoensso.nippy$freeze.invokeStatic(nippy.clj:1272)
	at taoensso.nippy$freeze.invoke(nippy.clj:1263)
	at taoensso.nippy$freeze_to_file.invokeStatic(nippy.clj:2155)
	at taoensso.nippy$freeze_to_file.invoke(nippy.clj:2151)
	at taoensso.nippy$freeze_to_file.invokeStatic(nippy.clj:2153)
	at taoensso.nippy$freeze_to_file.invoke(nippy.clj:2151)
	at metabase.notification.payload.temp_storage$write_to_file.invokeStatic(temp_storage.clj:34)
	at metabase.notification.payload.temp_storage$write_to_file.invoke(temp_storage.clj:32)
	at metabase.notification.payload.temp_storage$to_temp_file_BANG_.invokeStatic(temp_storage.clj:84)
	at metabase.notification.payload.temp_storage$to_temp_file_BANG_.invoke(temp_storage.clj:78)
	at clojure.lang.AFn.applyToHelper(AFn.java:154)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$update_in$up__6945.invoke(core.clj:6248)
	at clojure.core$update_in$up__6945.invoke(core.clj:6247)
	at clojure.core$update_in.invokeStatic(core.clj:6249)
	at clojure.core$update_in.doInvoke(core.clj:6235)
	at clojure.lang.RestFn.invoke(RestFn.java:448)
	at metabase.notification.payload.execute$data_rows_to_disk_BANG_.invokeStatic(execute.clj:139)
	at metabase.notification.payload.execute$data_rows_to_disk_BANG_.invoke(execute.clj:137)
	at medley.core$update_existing.invokeStatic(core.cljc:55)
	at medley.core$update_existing.invoke(core.cljc:49)
	at metabase.notification.payload.execute$dashcard__GT_part.invokeStatic(execute.clj:191)
	at metabase.notification.payload.execute$dashcard__GT_part.invoke(execute.clj:180)
	at metabase.notification.payload.execute$dashcards__GT_part$fn__119045.invoke(execute.clj:218)
	at clojure.core$keep$fn__8691.invoke(core.clj:7533)
	at clojure.lang.LazySeq.force(LazySeq.java:50)
	at clojure.lang.LazySeq.realize(LazySeq.java:89)
	at clojure.lang.LazySeq.seq(LazySeq.java:106)
	at clojure.lang.RT.seq(RT.java:555)
	at clojure.core$seq__5486.invokeStatic(core.clj:139)
	at clojure.core$dorun.invokeStatic(core.clj:3141)
	at clojure.core$doall.invokeStatic(core.clj:3156)
	at clojure.core$doall.invoke(core.clj:3156)
	at metabase.notification.payload.execute$dashcards__GT_part.invokeStatic(execute.clj:218)
	at metabase.notification.payload.execute$dashcards__GT_part.invoke(execute.clj:215)
	at metabase.notification.payload.execute$fn__119050$execute_dashboard119049__119051$fn__119052.invoke(execute.clj:249)
	at metabase.request.session$do_with_current_user.invokeStatic(session.clj:50)
	at metabase.request.session$do_with_current_user.invoke(session.clj:33)
	at metabase.notification.payload.execute$fn__119050$execute_dashboard119049__119051.invoke(execute.clj:239)
	at metabase.notification.payload.execute$fn__119050$fn__119073.invoke(execute.clj:236)
	at metabase.notification.payload.impl.dashboard$eval178284$_AMPERSAND_f__178286.invoke(dashboard.clj:34)
	at metabase.notification.payload.impl.dashboard$eval178284$fn__178295.invoke(dashboard.clj:29)
	at clojure.lang.MultiFn.invoke(MultiFn.java:229)
	at metabase.notification.payload.core$fn__152113$notification_payload152112__152114.invoke(core.clj:149)
	at metabase.notification.payload.core$fn__152113$fn__152116.invoke(core.clj:144)
	at metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888$fn__154889$fn__154892.invoke(send.clj:129)
	at metabase.models.task_history$fn__102474$do_with_task_history102473__102475.invoke(task_history.clj:117)
	at metabase.models.task_history$fn__102474$fn__102483.invoke(task_history.clj:105)
	at metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888$fn__154889.invoke(send.clj:126)
	at metabase.notification.send$fn__154887$send_notification_sync_BANG_154886__154888.invoke(send.clj:123)
	at metabase.notification.send$fn__154887$fn__154958.invoke(send.clj:120)
	at metabase.notification.core$fn__154991$send_notification_BANG_154990__154993.doInvoke(core.clj:37)
	at clojure.lang.RestFn.invoke(RestFn.java:426)
	at metabase.notification.core$fn__154991$fn__155001.doInvoke(core.clj:31)
	at clojure.lang.RestFn.invoke(RestFn.java:442)
	at clojure.lang.Var.invoke(Var.java:395)
	at metabase.pulse.send$send_pulse_BANG__STAR_$fn__156920.invoke(send.clj:106)
	at metabase.pulse.send$send_pulse_BANG__STAR_.invokeStatic(send.clj:105)
	at metabase.pulse.send$send_pulse_BANG__STAR_.invoke(send.clj:98)
	at metabase.pulse.send$send_pulse_BANG_.invokeStatic(send.clj:132)
	at metabase.pulse.send$send_pulse_BANG_.doInvoke(send.clj:111)
	at clojure.lang.RestFn.invoke(RestFn.java:413)
	at metabase.api.pulse$eval157265$fn__157271$fn__157283.invoke(pulse.clj:375)
	at metabase.api.pulse$eval157265$fn__157271.invoke(pulse.clj:374)
	at metabase.api.macros$fn__130911$_core_fn130910__130912$core_fn__130913.invoke(macros.clj:405)
	at metabase.api.macros$fn__130991$endpoint_handler_STAR_130990__130993$handler__130997.invoke(macros.clj:601)
	at metabase.api.macros$fn__131044$build_ns_handler131043__131045$ns_handler_STAR___131046.invoke(macros.clj:665)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.api.macros$fn__131091$ns_handler131090__131092$dev_handler__131097.invoke(macros.clj:762)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.channel.render.preview$style_tag_nonce_middleware$fn__119123.invoke(preview.clj:163)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.server.middleware.auth$enforce_authentication$fn__112637.invoke(auth.clj:18)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154.invoke(core.clj:200)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:23)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at clojure.lang.Var.invoke(Var.java:395)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154.invoke(core.clj:200)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.server.routes$fn__168676$fn__168677.invoke(routes.clj:70)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154.invoke(core.clj:200)
	at compojure.core$make_context$handler__129222.invoke(core.clj:290)
	at compojure.core$make_context$fn__129226.invoke(core.clj:300)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at compojure.core$wrap_route_matches$fn__129135.invoke(core.clj:153)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154$f__129155$respond_SINGLEQUOTE___129156.invoke(core.clj:197)
	at metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:24)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at metabase.api.util.handlers$_route_map_handler$fn__151417.invoke(handlers.clj:23)
	at metabase.api.open_api.HandlerWithOpenAPISpec.invoke(open_api.clj:42)
	at clojure.lang.Var.invoke(Var.java:395)
	at compojure.core$routes$fn__129154$f__129155.invoke(core.clj:198)
	at compojure.core$routes$fn__129154.invoke(core.clj:200)
	at metabase.server.middleware.exceptions$catch_uncaught_exceptions$fn__114157.invoke(exceptions.clj:111)
	at metabase.server.middleware.exceptions$catch_api_exceptions$fn__114154.invoke(exceptions.clj:100)
	at metabase.server.middleware.log$log_api_call$fn__128522$fn__128523$fn__128524.invoke(log.clj:232)
	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:17)
	at metabase.driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12)
	at metabase.server.middleware.log$log_api_call$fn__128522$fn__128523.invoke(log.clj:223)
	at toucan2.execute$do_with_call_counts.invokeStatic(execute.clj:112)
	at toucan2.execute$do_with_call_counts.invoke(execute.clj:103)
	at metabase.server.middleware.log$log_api_call$fn__128522.invoke(log.clj:222)
	at metabase.server.middleware.browser_cookie$ensure_browser_id_cookie$fn__128251.invoke(browser_cookie.clj:40)
	at metabase.server.middleware.security$add_security_headers$fn__114099.invoke(security.clj:273)
	at metabase.server.middleware.json$wrap_json_body$fn__199162.invoke(json.clj:129)
	at metabase.server.middleware.offset_paging$handle_paging$fn__128613.invoke(offset_paging.clj:48)
	at metabase.server.middleware.json$wrap_streamed_json_response$fn__199150.invoke(json.clj:84)
	at ring.middleware.keyword_params$wrap_keyword_params$fn__168979.invoke(keyword_params.clj:55)
	at ring.middleware.params$wrap_params$fn__169006.invoke(params.clj:77)
	at metabase.server.middleware.misc$maybe_set_site_url$fn__128570.invoke(misc.clj:59)
	at metabase.server.middleware.session$reset_session_timeout$fn__128749.invoke(session.clj:270)
	at metabase.server.middleware.session$bind_current_user$fn__128742$fn__128743.invoke(session.clj:245)
	at metabase.request.session$do_with_current_user.invokeStatic(session.clj:50)
	at metabase.request.session$do_with_current_user.invoke(session.clj:33)
	at metabase.server.middleware.session$bind_current_user$fn__128742.invoke(session.clj:244)
	at metabase.server.middleware.session$wrap_current_user_info$fn__128730.invoke(session.clj:204)
	at metabase.analytics.sdk$embedding_mw$embedding_mw_fn__117361.invoke(sdk.clj:63)
	at metabase.server.middleware.session$wrap_session_id$fn__128700.invoke(session.clj:82)
	at metabase.server.middleware.auth$wrap_static_api_key$fn__112645.invoke(auth.clj:33)
	at ring.middleware.cookies$wrap_cookies$fn__168883.invoke(cookies.clj:200)
	at metabase.server.middleware.misc$add_content_type$fn__128548.invoke(misc.clj:28)
	at metabase.server.middleware.misc$disable_streaming_buffering$fn__128578.invoke(misc.clj:75)
	at ring.middleware.gzip$wrap_gzip$fn__168933.invoke(gzip.clj:86)
	at metabase.server.middleware.request_id$wrap_request_id$fn__128630.invoke(request_id.clj:9)
	at metabase.server.middleware.misc$bind_request$fn__128581$fn__128582.invoke(misc.clj:87)
	at metabase.request.current$do_with_current_request.invokeStatic(current.clj:19)
	at metabase.request.current$do_with_current_request.invoke(current.clj:15)
	at metabase.server.middleware.misc$bind_request$fn__128581.invoke(misc.clj:86)
	at metabase.server.middleware.ssl$redirect_to_https_middleware$fn__128774.invoke(ssl.clj:41)
	at clojure.lang.Var.invoke(Var.java:395)
	at metabase.server.instance$async_proxy_handler$fn__112589.invoke(instance.clj:76)
	at metabase.server.instance.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source)
	at org.eclipse.jetty.server.handler.StatisticsHandler.handle(StatisticsHandler.java:173)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:122)
	at org.eclipse.jetty.server.Server.handle(Server.java:563)
	at org.eclipse.jetty.server.HttpChannel$RequestDispatchable.dispatch(HttpChannel.java:1598)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:753)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:501)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:287)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:314)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:100)
	at org.eclipse.jetty.io.SelectableChannelEndPoint$1.run(SelectableChannelEndPoint.java:53)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.runTask(AdaptiveExecutionStrategy.java:421)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.consumeTask(AdaptiveExecutionStrategy.java:390)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.tryProduce(AdaptiveExecutionStrategy.java:277)
	at org.eclipse.jetty.util.thread.strategy.AdaptiveExecutionStrategy.run(AdaptiveExecutionStrategy.java:199)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:411)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:969)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.doRunJob(QueuedThreadPool.java:1194)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1149)
	at java.base/java.lang.Thread.run(Thread.java:1583)
````
</details>

and a simple query to repro:

```sql
WITH sample_data AS (
  SELECT * FROM (
    VALUES 
      ('2024-01-01', 'apple'),
      ('2024-01-01', 'banana'),
      ('2024-01-02', 'apple'),
      ('2024-01-02', 'orange')
  ) t(sale_date, fruit)
)
SELECT 
  sale_date,
  array_agg(fruit ORDER BY fruit) as fruits_sold
FROM sample_data
GROUP BY sale_date
ORDER BY sale_date;
```

dpsutton on (2025-02-03 15:17:43 UTC): There are a few ways to fix this:

#### Normal Nippy way
Fix it the ""normal"" way. Tell nippy how to serialize and deserialize the data. This has a slight wrinkle. Normally you write the instance to bytes and then figure out how to reconstruct it. This is not possible here because a `PgArray` has a connection in it. It's nullable, but the class seems a bit strange: https://jdbc.postgresql.org/documentation/publicapi/org/postgresql/jdbc/PgArray.html

But this does work:
```clojure
(nippy/extend-freeze PgArray :postgres/PgArray
  [^PgArray pg-arr data-output]
  (nippy/try-write-readable data-output (vec (.getArray pg-arr))))

(nippy/extend-thaw :postgres/PgArray
  [data-input]
  (nippy/thaw-from-in! data-input))
```

Have to use vector rather than the array for json encoding reasons. More on that below.
Why is this not great? Because the query changes. A ""fresh"" query has a `org.postgresql.jdbc.PgArray` object; one from the cache has a clojure `vector`. This seems innocuous at the moment as they are essentially opaque bits until we hit the wire, but it feels like a very surprising footgun to the future.

#### read column thunk fix 1
Why read this as a PgArray at all? Let's just get the backing array
```clojure
;; de-CLOB any CLOB values that come back
(defmethod sql-jdbc.execute/read-column-thunk :postgres
  [_ ^ResultSet rs _ ^Integer i]
  (fn []
    (let [obj (.getObject rs i)]
      (cond (instance? org.postgresql.util.PGobject obj)
            (.getValue ^org.postgresql.util.PGobject obj)
            (instance? org.postgresql.jdbc.PgArray obj) ;; new branch
            (.getArray ^org.postgresql.jdbc.PgArray obj)
            :else
            obj))))
```

This _almost_ works. It requires one change in addition:

```clojure
tell middleware json how to turn a string array into json
(json/add-encoder
 (Class/forName ""[Ljava.lang.String;"")
 (fn [string-arr json-generator]
   (json/write-string json-generator (cheshire.core/generate-string (vec string-arr)))))
```

I alluded to this above. If things are arrays, we need to know how to put them on the wire. This solution has the benefit of uniform types in the query results. Whether cached or fresh, they are java arrays. These are easily serialized by nippy so notifications and cache are happy.

#### read column thunk fix 2
Fewer changes are necessary if we just turn the array into a clojure vector. No need to instruct how to turn arrays into json, nippy serialization is obviously handled. Only thing is does this offend our sense of taste? I don't think it does or should but want to call it out. The fix is similar to above but `vec`ing the array that comes back.

```clojure
(defmethod sql-jdbc.execute/read-column-thunk :postgres
  [_ ^ResultSet rs _ ^Integer i]
  (fn []
    (let [obj (.getObject rs i)]
      (cond (instance? org.postgresql.util.PGobject obj)
            (.getValue ^org.postgresql.util.PGobject obj)
            (instance? org.postgresql.jdbc.PgArray obj)
            (vec (.getArray ^org.postgresql.jdbc.PgArray obj)) ;; vec
            :else
            obj))))
```

"
2824373002,issue,closed,duplicate,Add legalese to enable SDK for Pro/Enterprise Users,"- [ ] Add modal on FE SDK toggles
- [ ] Add BE setting
- [ ] Adjust FE to match styling",oisincoveney,2025-01-31 20:50:53+00:00,['oisincoveney'],2025-02-03 20:43:26+00:00,2025-02-03 20:43:24+00:00,https://github.com/metabase/metabase/issues/53077,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]","[{'comment_id': 2632032722, 'issue_id': 2824373002, 'author': 'oisincoveney', 'body': 'Closing to use #53111 to track this', 'created_at': datetime.datetime(2025, 2, 3, 20, 43, 24, tzinfo=datetime.timezone.utc)}]","oisincoveney (Issue Creator) on (2025-02-03 20:43:24 UTC): Closing to use #53111 to track this

"
2824190728,issue,open,,FK-mapped filter list disappears when using aggregated questions on a model,"### Describe the bug

The dropdown filter correctly shows the FK mapping when the question is built on a table. But when the question is built on a model that is based on the table, the dropdown filter no longer shows the foreign key mapping. 

The request URL in both cases is the same, but the responses are different so this is a BE bug. 

Maybe related: https://github.com/metabase/metabase/issues/21528 

### To Reproduce

1. Set up FK mappings in table metadata and have the fields used for filtering be ""a list of all values."" 
2. Create an aggregated question based on the table and add it to a dashboard. 
3. Set up an ID dashboard filter and connect it to the card.
4. Observe that the filter list includes the FK mappings.
5. Create a model based on the table. 
6. Edit the question in the dashboard to be based on the model and include the same aggregation.
7. Going back to the dashboard, re-connect the dashboard filter.
8. Observe that the filter list no longer includes the FK mappings. 

Here's a video to more easily follow: https://www.loom.com/share/1a2694d9235548e08fcd517e39b7761d
I used the Orders table from the Sample Database. 

### Expected behavior

The dropdown filter for the question built on the model should also show the FK mapping 

### Logs

_No response_

### Information about your Metabase installation

```JSON
Version 52, but I believe this existed before then
```

### Severity

there's a workaround but not ideal 

### Additional context

_No response_",jessicaul,2025-01-31 18:58:54+00:00,['wzimrin'],2025-02-04 20:29:04+00:00,,https://github.com/metabase/metabase/issues/53059,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Backend', ''), ('.Team/Querying', '')]",[],
2824124392,issue,open,,Color picker not working for Style tab in Viz settings,"### Describe the bug


Loom: https://www.loom.com/share/80585885218e42aca1720075fbfd0cd4?sid=6cf151b3-9d18-4eb0-a3ca-63a8a1dce6f8

### To Reproduce

1. Create a question with Bar Chart
2. go to the Viz settings, change the color of the Y axis by clicking the three dots
3. not possible

Detailed steps in the Loom

### Expected behavior

Should let you change the color

### Logs

_No response_

### Information about your Metabase installation

```JSON
-52. 8, not present in 51.x
```

### Severity

P3

### Additional context

_No response_",ignacio-mb,2025-01-31 18:15:29+00:00,[],2025-02-04 20:31:26+00:00,,https://github.com/metabase/metabase/issues/53055,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Visualization/Chart Settings', ''), ('Difficulty:Easy', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2824101904,issue,closed,completed,Old permissions deprecation email is triggered many times after upgrading to 52.8,"### Describe the bug

Customers say that since this Monday (cloud upgrade to 52.8), they have received permission deprecation notices many times daily.

We noticed that the thing these instances have in common is that they deprecated/hidden tables that can't be accessed via the Permissions tab in Admin Settings (all their permissions for the DBs they have connected are well-changed)

### To Reproduce

Haven't reproduced

### Expected behavior

I don't know what is the expected behavior; I'm assuming one email a month? And not several per day

### Logs

_No response_

### Information about your Metabase installation

```JSON
- 52.8
```

### Severity

P1

### Additional context

Customer tickets with this behavior:
- [one](https://app.usepylon.com/issues/views/663f0f78-70ed-4cfa-8ea0-6f97128e13c8?conversationID=30c77c59-0c8f-4d8b-9b67-95f3beec743d)
- [two](https://app.usepylon.com/issues/views/663f0f78-70ed-4cfa-8ea0-6f97128e13c8?conversationID=93d6a281-47d1-4321-971a-0b60d6e13e6c)
- [three](https://app.usepylon.com/issues?conversationID=681bf47c-9ed9-4582-89ce-ceebbad973d6)
- [four](https://app.usepylon.com/issues?conversationID=c5a881d4-530d-4890-bdd9-fc73d5e2b7f6)

[Internal discussion thread](https://metaboat.slack.com/archives/C01LQQ2UW03/p1738242919307319)",ignacio-mb,2025-01-31 18:01:01+00:00,['noahmoss'],2025-01-31 20:26:49+00:00,2025-01-31 20:16:17+00:00,https://github.com/metabase/metabase/issues/53054,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Administration/Permissions', 'Collection or Data permissions'), ('Administration/', ''), ('Misc/Emails', ''), ('.Escalation', '')]","[{'comment_id': 2628343451, 'issue_id': 2824101904, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)', 'created_at': datetime.datetime(2025, 1, 31, 20, 26, 48, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-01-31 20:26:48 UTC): 🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)

"
2823877291,issue,open,,"Add `entity_id` columns to databases, tables and fields; use these opaque IDs for `:ident`s",,bshepherdson,2025-01-31 16:02:56+00:00,[],2025-01-31 16:02:56+00:00,,https://github.com/metabase/metabase/issues/53048,[],[],
2823716846,issue,closed,not_planned,Testing Linear integration,"### Describe the bug

Testing this

### To Reproduce

1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
asdf
```

### Severity

P3

### Additional context

_No response_",luizarakaki,2025-01-31 14:53:34+00:00,[],2025-01-31 14:58:15+00:00,2025-01-31 14:58:15+00:00,https://github.com/metabase/metabase/issues/53043,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Administration/', '')]","[{'comment_id': 2627545367, 'issue_id': 2823716846, 'author': 'luizarakaki', 'body': 'This issue should be closed', 'created_at': datetime.datetime(2025, 1, 31, 14, 55, 45, tzinfo=datetime.timezone.utc)}]","luizarakaki (Issue Creator) on (2025-01-31 14:55:45 UTC): This issue should be closed

"
2823679245,issue,closed,completed,Unable to replace a question with a long name,"### Describe the bug

https://github.com/user-attachments/assets/60331a88-731b-4c6c-96c0-0e8380a96236

### To Reproduce

1. New > Question > Orders > Visualize
2. Save
3. Set name: `aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa`
4. Save
5. Go to editor
6. Join a table
7. Click ""Save""

❌ ""Save"" button is disabled in the modal


### Information about your Metabase installation

master, 59d45e5ef45d2d25b7cb7a0060c49f3370b17cdb

### Severity

P2",kamilmielnik,2025-01-31 14:37:12+00:00,['uladzimirdev'],2025-02-05 15:52:44+00:00,2025-02-05 14:47:25+00:00,https://github.com/metabase/metabase/issues/53042,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]",[],
2823201594,issue,open,,static embedded questions can't download their results when `?locale` is passed in the URL,"### Describe the bug

Happens to both questions and SQL questions. I can repro with 1.51.13 and 1.52.8.

If we pass `?locale` in the URL when embedding, it will crash the download. This doesn't happen with other parameters.

Nicolo found it's likely from this line
https://github.com/metabase/metabase/blob/106da5d11c26a1b84cbc6bec93520b055f99a167/frontend/src/metabase/dashboard/hooks/use-dashboard-url-query.ts#L125-L126

From this commit https://github.com/metabase/metabase/commit/76b0a3f513173477fe2e21599d28f1296288e50b

This was probably from when we supported `?locale` parameter, but since https://github.com/metabase/metabase/issues/50182, we stop supporting `?locale` in static embedding and public links, so we need to clean those code up.

![Image](https://github.com/user-attachments/assets/d0117a1f-00fd-4fb6-9871-ee1732827a0a)

### To Reproduce

1. Create a question
2. Embed it
3. In the embed code, add `?locale=en` to the URL e.g.
    ```
     var iframeUrl =
    METABASE_SITE_URL + '/embed/question/' + token + '?locale=en#bordered=true&titled=true'
    ```
4. Visit the embed URL and try to download the results.



### Expected behavior

the download works and `?locale` is ignored.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-15"",
      ""tag"": ""v1.51.13"",
      ""hash"": ""5523ff7""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.25+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.25"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.25+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.10.14-linuxkit"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

annoying

### Additional context

This is for completion. We don't expect users to pass `?locale` in the URL anymore, but users might not realize it.",WiNloSt,2025-01-31 11:50:46+00:00,[],2025-02-04 20:25:47+00:00,,https://github.com/metabase/metabase/issues/53037,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Embedding/Static', 'Static embedding, previously known as signed embedding'), ('.Team/Embedding', '')]",[],
2823188457,issue,open,,Preview icon overlaps notebook editor controls,"### Describe the bug

![Image](https://github.com/user-attachments/assets/a15c9364-19c4-4df8-975c-e92b967aa8be)

### To Reproduce

1. New > Question > Accounts
2. Join Invoices
3. Open SQL preview
4. Set viewport width to 1575px

Preview icon overlaps ""add join condition"" button

### Information about your Metabase installation

master, dff830c1f6

### Severity

P3
",kamilmielnik,2025-01-31 11:46:04+00:00,[],2025-02-04 20:27:55+00:00,,https://github.com/metabase/metabase/issues/53036,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/Notebook', 'Items specific to the Custom/Notebook query builder'), ('.Team/Querying', '')]",[],
2823078948,issue,open,,Slack Notification Send Spinning CPU Usage to 100% and crashing,"### Describe the bug

I am testing the Send this dashboard to Slack feature, with the ""Send to Slack now"" to test because it keeps failing for the scheduled one.

When I click the test button, the instance goes on 100% CPU usage for a couple minutes and becomes unresponsive, and then nothing happens (nothing received on Slack), or sometimes I receive an image with ""An error occured while displaying this card"" (I think I fixed this one).

### To Reproduce

1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error


### Expected behavior

_No response_

### Logs

## Job `notification-send`
- Duration (ms): 202172
- Status: Failed
- Logs
```
{
    ""status"": ""failed"",
    ""exception"": ""class clojure.lang.ExceptionInfo"",
    ""message"": ""Assert failed: Expected map row, got ^java.lang.Integer 0\n(map? row)"",
    ""stacktrace"":
    [
        ""toucan2.tools.transformed$transform_result_rows_transducer$fn__27563.invoke(transformed.clj:230)"",
        ""clojure.core$map$fn__5950$fn__5951.invoke(core.clj:2759)"",
        ""clojure.lang.PersistentVector.reduce(PersistentVector.java:418)"",
        ""clojure.core$reduce.invokeStatic(core.clj:6964)"",
        ""clojure.core$reduce.invoke(core.clj:6947)"",
        ""toucan2.jdbc.query$reduce_jdbc_query.invokeStatic(query.clj:56)"",
        ""toucan2.jdbc.query$reduce_jdbc_query.invoke(query.clj:22)"",
        ""toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invokeStatic(pipeline.clj:19)"",
        ""toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invoke(pipeline.clj:9)"",
        ""methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:15)"",
        ""methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733.invoke(threaded.clj:64)"",
        ""methodical.util.FnWithMeta.invoke(util.clj:46)"",
        ""methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65)"",
        ""methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)"",
        ""methodical.impl.standard.StandardMultiFn.invoke(standard.clj:216)"",
        ""toucan2.pipeline$transduce_execute$with_connection_STAR___22818.invoke(pipeline.clj:78)"",
        ""toucan2.connection$bind_current_connectable_fn$fn__22495.invoke(connection.clj:104)"",
        ""toucan2.connection$bind_current_connectable_fn$fn__22495.invoke(connection.clj:104)"",
        ""toucan2.connection$bind_current_connectable_fn$fn__22495.invoke(connection.clj:104)"",
        ""toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource.invokeStatic(connection.clj:18)"",
        ""toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource.invoke(connection.clj:15)"",
        ""methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:12)"",
        ""methodical.util.FnWithMeta.invoke(util.clj:46)"",
        ""toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)"",
        ""toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)"",
        ""methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:12)"",
        ""methodical.util.FnWithMeta.invoke(util.clj:46)"",
        ""methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)"",
        ""methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)"",
        ""methodical.impl.standard.StandardMultiFn.invoke(standard.clj:210)"",
        ""--> db.connection$do_with_connection_primary_method_default.invokeStatic(connection.clj:132)"",
        ""db.connection$do_with_connection_primary_method_default.invoke(connection.clj:130)"",
        ""channel.render.card$defaulted_timezone89113__89114.invokeStatic(card.clj:247)"",
        ""channel.render.card$defaulted_timezone89113__89114.invoke(card.clj:244)"",
        ""channel.impl.slack$part__GT_attachment_data.invokeStatic(slack.clj:44)"",
        ""channel.impl.slack$part__GT_attachment_data.invoke(slack.clj:36)"",
        ""channel.impl.slack$create_slack_attachment_data$iter__113920__113924$fn__113925.invoke(slack.clj:146)"",
        ""channel.impl.slack$fn__113937$_AMPERSAND_f__113939$iter__113941__113945$fn__113946$fn__113947.invoke(slack.clj:156)"",
        ""channel.impl.slack$fn__113937$_AMPERSAND_f__113939$iter__113941__113945$fn__113946.invoke(slack.clj:154)"",
        ""util.malli.registry$explainer$make_explainer__9738$schema_explainer__9739.invoke(registry.cljc:47)"",
        ""util.malli.registry$explain.invokeStatic(registry.cljc:54)"",
        ""util.malli.registry$explain.invoke(registry.cljc:51)"",
        ""util.malli.fn$validate.invokeStatic(fn.clj:176)"",
        ""util.malli.fn$validate.invoke(fn.clj:174)"",
        ""util.malli.fn$validate_output.invokeStatic(fn.clj:213)"",
        ""util.malli.fn$validate_output.invoke(fn.clj:209)"",
        ""channel.impl.slack$fn__113937$fn__113956.invoke(slack.clj:150)"",
        ""notification.send$send_notification_sync_BANG_104785__104786$fn__104787$fn__104790.invoke(send.clj:135)"",
        ""models.task_history$do_with_task_history63467__63468.invokeStatic(task_history.clj:121)"",
        ""models.task_history$do_with_task_history63467__63468.invoke(task_history.clj:109)"",
        ""notification.send$send_notification_sync_BANG_104785__104786$fn__104787.invoke(send.clj:126)"",
        ""notification.send$send_notification_sync_BANG_104785__104786.invokeStatic(send.clj:123)"",
        ""notification.send$send_notification_sync_BANG_104785__104786.invoke(send.clj:120)"",
        ""notification.core$send_notification_BANG_104841__104843.invokeStatic(core.clj:37)"",
        ""notification.core$send_notification_BANG_104841__104843.doInvoke(core.clj:31)"",
        ""pulse.send$send_pulse_BANG__STAR_$fn__104857.invoke(send.clj:106)"",
        ""pulse.send$send_pulse_BANG__STAR_.invokeStatic(send.clj:105)"",
        ""pulse.send$send_pulse_BANG__STAR_.invoke(send.clj:98)"",
        ""pulse.send$send_pulse_BANG_.invokeStatic(send.clj:132)"",
        ""pulse.send$send_pulse_BANG_.doInvoke(send.clj:111)"",
        ""api.pulse$fn__108848$fn__108861.invoke(pulse.clj:362)"",
        ""api.pulse$fn__108848.invokeStatic(pulse.clj:361)"",
        ""api.pulse$fn__108848.invoke(pulse.clj:342)"",
        ""channel.render.preview$style_tag_nonce_middleware$fn__89959.invoke(preview.clj:163)"",
        ""server.middleware.auth$enforce_authentication$fn__104882.invoke(auth.clj:18)"",
        ""api.routes$fn__109552$fn__109555.invoke(routes.clj:75)"",
        ""server.routes$fn__110308$fn__110309.doInvoke(routes.clj:67)"",
        ""server.middleware.exceptions$catch_uncaught_exceptions$fn__107011.invoke(exceptions.clj:111)"",
        ""server.middleware.exceptions$catch_api_exceptions$fn__107008.invoke(exceptions.clj:100)"",
        ""server.middleware.log$log_api_call$fn__110674$fn__110675$fn__110676.invoke(log.clj:233)"",
        ""driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invokeStatic(diagnostic.clj:17)"",
        ""driver.sql_jdbc.execute.diagnostic$do_with_diagnostic_info.invoke(diagnostic.clj:12)"",
        ""server.middleware.log$log_api_call$fn__110674$fn__110675.invoke(log.clj:224)"",
        ""server.middleware.log$log_api_call$fn__110674.invoke(log.clj:223)"",
        ""server.middleware.browser_cookie$ensure_browser_id_cookie$fn__114411.invoke(browser_cookie.clj:40)"",
        ""server.middleware.security$add_security_headers$fn__106967.invoke(security.clj:273)"",
        ""server.middleware.offset_paging$handle_paging$fn__96477.invoke(offset_paging.clj:56)"",
        ""server.middleware.json$wrap_streamed_json_response$fn__55892.invoke(json.clj:88)"",
        ""server.middleware.misc$maybe_set_site_url$fn__70143.invoke(misc.clj:59)"",
        ""server.middleware.session$reset_session_timeout$fn__72231.invoke(session.clj:566)"",
        ""server.middleware.session$bind_current_user$fn__72197$fn__72198.invoke(session.clj:459)"",
        ""server.middleware.session$do_with_current_user.invokeStatic(session.clj:438)"",
        ""server.middleware.session$do_with_current_user.invoke(session.clj:421)"",
        ""server.middleware.session$bind_current_user$fn__72197.invoke(session.clj:458)"",
        ""server.middleware.session$wrap_current_user_info$fn__72174.invoke(session.clj:383)"",
        ""analytics.sdk$embedding_mw$embedding_mw_fn__78507.invoke(sdk.clj:63)"",
        ""server.middleware.session$wrap_session_id$fn__72146.invoke(session.clj:261)"",
        ""server.middleware.auth$wrap_static_api_key$fn__104890.invoke(auth.clj:33)"",
        ""server.middleware.misc$add_content_type$fn__70125.invoke(misc.clj:28)"",
        ""server.middleware.misc$disable_streaming_buffering$fn__70151.invoke(misc.clj:75)"",
        ""server.middleware.request_id$wrap_request_id$fn__110370.invoke(request_id.clj:9)"",
        ""server.middleware.misc$bind_request$fn__70154.invoke(misc.clj:91)"",
        ""server.middleware.ssl$redirect_to_https_middleware$fn__114427.invoke(ssl.clj:51)"",
        ""server$async_proxy_handler$fn__56861.invoke(server.clj:77)"",
        ""server.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source)""
    ],
    ""ex-data"":
    {
        ""toucan2/context-trace"":
        [
            [
                ""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"",
                {
                    ""toucan2.jdbc.query/sql-args"":
                    [
                        ""SELECT * FROM \""metabase_database\"" WHERE \""id\"" = ?"",
                        2
                    ]
                }
            ],
            [
                ""resolve connection"",
                {
                    ""toucan2.connection/connectable"": ""class metabase.db.connection.ApplicationDB""
                }
            ],
            [
                ""resolve connection"",
                {
                    ""toucan2.connection/connectable"": ""default""
                }
            ],
            [
                ""resolve connection"",
                {
                    ""toucan2.connection/connectable"": null
                }
            ],
            {
                ""toucan2.pipeline/rf"": ""clojure.core$map$fn__5950$fn__5951@6fec20""
            },
            [
                ""with compiled query"",
                {
                    ""toucan2.pipeline/compiled-query"":
                    [
                        ""SELECT * FROM \""metabase_database\"" WHERE \""id\"" = ?"",
                        2
                    ]
                }
            ],
            [
                ""with built query"",
                {
                    ""toucan2.pipeline/built-query"":
                    {
                        ""select"":
                        [
                            ""*""
                        ],
                        ""from"":
                        [
                            [
                                ""metabase_database""
                            ]
                        ],
                        ""where"":
                        [
                            ""="",
                            ""id"",
                            2
                        ]
                    }
                }
            ],
            [
                ""with resolved query"",
                {
                    ""toucan2.pipeline/resolved-query"":
                    {}
                }
            ],
            [
                ""with parsed args"",
                {
                    ""toucan2.pipeline/query-type"": ""toucan.query-type/select.instances"",
                    ""toucan2.pipeline/parsed-args"":
                    {
                        ""kv-args"":
                        {
                            ""id"": 2
                        },
                        ""queryable"":
                        {}
                    }
                }
            ],
            [
                ""with model"",
                {
                    ""toucan2.pipeline/model"": ""model/Database""
                }
            ],
            [
                ""with unparsed args"",
                {
                    ""toucan2.pipeline/query-type"": ""toucan.query-type/select.instances"",
                    ""toucan2.pipeline/unparsed-args"":
                    [
                        ""model/Database"",
                        ""id"",
                        2
                    ]
                }
            ]
        ]
    },
    ""original-info"":
    {
        ""notification_id"": null,
        ""notification_handlers"":
        [
            {
                ""channel_type"": ""channel/slack""
            }
        ]
    }
}
```

## Instance logs
```
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:41:26+01:00 WARN org.eclipse.jetty.server.AbstractConnector Accept Failure,java.lang.OutOfMemoryError: Java heap space
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:05+01:00 WARN org.quartz.impl.jdbcjobstore.AttributeRestoringConnectionInvocationHandler Failed restore connection's original auto commit setting.,java.lang.OutOfMemoryError: Java heap space
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:06+01:00 ERROR metabase.models.interface Unable to normalize:
""[{\""slug\"":\""period\"",\""name\"":\""Period\"",\""isMultiSelect\"":false,\""type\"":\""date/all-options\"",\""sectionId\"":\""date\"",\""id\"":\""bf22d0a7\"",\""required\"":true,\""default\"":\""past3months~\""},{\""name\"":\""Contact ID\"",\""slug\"":\""contact_id\"",\""id\"":\""5682e03\"",\""type\"":\""id\"",\""sectionId\"":\""id\"",\""isMultiSelect\"":false,\""default\"":[\""67484\""],\""required\"":true}]""
,java.lang.OutOfMemoryError: Java heap space
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:27+01:00 WARN org.eclipse.jetty.util.thread.QueuedThreadPool Job failed,java.lang.OutOfMemoryError: Java heap space
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 ERROR org.quartz.core.ErrorLogger Job (DEFAULT.metabase.task.analyze-queries.job threw an exception.,org.quartz.SchedulerException: Job threw an unhandled exception. [See nested exception: java.lang.OutOfMemoryError: Java heap space],	at org.quartz.core.JobRunShell.run(JobRunShell.java:213),	at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573),Caused by: java.lang.OutOfMemoryError: Java heap space
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 WARN org.eclipse.jetty.io.ManagedSelector ParameterizedMessage[messagePattern=Could not accept {}: {}, argCount=2, throwableProvided=false]
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 WARN org.eclipse.jetty.io.ManagedSelector ParameterizedMessage[messagePattern=Could not accept {}: {}, argCount=2, throwableProvided=false]
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 ERROR org.quartz.impl.jdbcjobstore.JobStoreTX Couldn't rollback jdbc connection. This connection has been closed.,org.postgresql.util.PSQLException: This connection has been closed.,	at org.postgresql.jdbc.PgConnection.checkClosed(PgConnection.java:1009),	at org.postgresql.jdbc.PgConnection.rollback(PgConnection.java:1016),	at com.mchange.v2.c3p0.impl.NewProxyConnection.rollback(NewProxyConnection.java:218),	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103),	at java.base/java.lang.reflect.Method.invoke(Method.java:580),	at org.quartz.impl.jdbcjobstore.AttributeRestoringConnectionInvocationHandler.invoke(AttributeRestoringConnectionInvocationHandler.java:73),	at jdk.proxy3/jdk.proxy3.$Proxy31.rollback(Unknown Source),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.rollbackConnection(JobStoreSupport.java:3727),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.executeInNonManagedTXLock(JobStoreSupport.java:3886),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.acquireNextTriggers(JobStoreSupport.java:2802),	at org.quartz.core.QuartzSchedulerThread.run(QuartzSchedulerThread.java:287)
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 WARN org.quartz.impl.jdbcjobstore.AttributeRestoringConnectionInvocationHandler Failed restore connection's original auto commit setting.,org.postgresql.util.PSQLException: This connection has been closed.,	at org.postgresql.jdbc.PgConnection.checkClosed(PgConnection.java:1009),	at org.postgresql.jdbc.PgConnection.setAutoCommit(PgConnection.java:938),	at com.mchange.v2.c3p0.impl.NewProxyConnection.setAutoCommit(NewProxyConnection.java:1401),	at org.quartz.impl.jdbcjobstore.AttributeRestoringConnectionInvocationHandler.restoreOriginalAtributes(AttributeRestoringConnectionInvocationHandler.java:141),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.cleanupConnection(JobStoreSupport.java:3677),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.executeInNonManagedTXLock(JobStoreSupport.java:3896),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.acquireNextTriggers(JobStoreSupport.java:2802),	at org.quartz.core.QuartzSchedulerThread.run(QuartzSchedulerThread.java:287)
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 ERROR org.quartz.core.ErrorLogger An error occurred while scanning for the next triggers to fire.,org.quartz.JobPersistenceException: Couldn't acquire next trigger: An I/O error occurred while sending to the backend. [See nested exception: org.postgresql.util.PSQLException: An I/O error occurred while sending to the backend.],	at org.quartz.impl.jdbcjobstore.JobStoreSupport.acquireNextTrigger(JobStoreSupport.java:2923),	at org.quartz.impl.jdbcjobstore.JobStoreSupport$41.execute(JobStoreSupport.java:2805),	at org.quartz.impl.jdbcjobstore.JobStoreSupport$41.execute(JobStoreSupport.java:2803),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.executeInNonManagedTXLock(JobStoreSupport.java:3864),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.acquireNextTriggers(JobStoreSupport.java:2802),	at org.quartz.core.QuartzSchedulerThread.run(QuartzSchedulerThread.java:287),Caused by: org.postgresql.util.PSQLException: An I/O error occurred while sending to the backend.,	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:398),	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502),	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419),	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194),	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:137),	at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:743),	at org.quartz.impl.jdbcjobstore.StdJDBCDelegate.selectTriggerToAcquire(StdJDBCDelegate.java:2613),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.acquireNextTrigger(JobStoreSupport.java:2844),	... 5 more,Caused by: javax.net.ssl.SSLException: Tag mismatch,	at java.base/sun.security.ssl.Alert.createSSLException(Alert.java:132),	at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:383),	at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:326),	at java.base/sun.security.ssl.TransportContext.fatal(TransportContext.java:321),	at java.base/sun.security.ssl.SSLTransport.decode(SSLTransport.java:123),	at java.base/sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1509),	at java.base/sun.security.ssl.SSLSocketImpl.readApplicationRecord(SSLSocketImpl.java:1480),	at java.base/sun.security.ssl.SSLSocketImpl$AppInputStream.read(SSLSocketImpl.java:1066),	at org.postgresql.core.VisibleBufferedInputStream.readMore(VisibleBufferedInputStream.java:162),	at org.postgresql.core.VisibleBufferedInputStream.ensureBytes(VisibleBufferedInputStream.java:129),	at org.postgresql.core.VisibleBufferedInputStream.ensureBytes(VisibleBufferedInputStream.java:114),	at org.postgresql.core.VisibleBufferedInputStream.read(VisibleBufferedInputStream.java:74),	at org.postgresql.core.PGStream.receiveChar(PGStream.java:467),	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2166),	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371),	... 12 more,Caused by: javax.crypto.AEADBadTagException: Tag mismatch,	at java.base/com.sun.crypto.provider.GaloisCounterMode$GCMDecrypt.doFinal(GaloisCounterMode.java:1652),	at java.base/com.sun.crypto.provider.GaloisCounterMode.engineDoFinal(GaloisCounterMode.java:458),	at java.base/javax.crypto.Cipher.doFinal(Cipher.java:2543),	at java.base/sun.security.ssl.SSLCipher$T13GcmReadCipherGenerator$GcmReadCipher.decrypt(SSLCipher.java:1908),	at java.base/sun.security.ssl.SSLSocketInputRecord.decodeInputRecord(SSLSocketInputRecord.java:264),	at java.base/sun.security.ssl.SSLSocketInputRecord.decode(SSLSocketInputRecord.java:181),	at java.base/sun.security.ssl.SSLTransport.decode(SSLTransport.java:111),	... 22 more
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 ERROR metabase.server Unexpected Exception in API request handler,clojure.lang.ExceptionInfo: An I/O error occurred while sending to the backend. {:toucan2/context-trace [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"" {:toucan2.jdbc.query/sql-args (""SELECT \""session\"".\""user_id\"" AS \""metabase-user-id\"", \""user\"".\""is_superuser\"" AS \""is-superuser?\"", \""user\"".\""locale\"" AS \""user-locale\"" FROM \""core_session\"" AS \""session\"" LEFT JOIN \""core_user\"" AS \""user\"" ON \""session\"".\""user_id\"" = \""user\"".\""id\"" WHERE (\""user\"".\""is_active\"" = TRUE) AND (\""session\"".\""id\"" = ?) AND (\""session\"".\""created_at\"" > (CAST(NOW() AS timestamp) + INTERVAL '-20160 minute')) AND (\""session\"".\""anti_csrf_token\"" IS NULL) LIMIT 1"" ""355bc837-f69c-44cb-b9af-5d59a6483e7c"")}] [""resolve connection"" {:toucan2.connection/connectable metabase.db.connection.ApplicationDB}] [""resolve connection"" {:toucan2.connection/connectable :default}] [""resolve connection"" {:toucan2.connection/connectable nil}] {:toucan2.pipeline/rf #object[clojure.core$completing$fn__8558 0x1b6194c3 ""clojure.core$completing$fn__8558@1b6194c3""]} [""with compiled query"" {:toucan2.pipeline/compiled-query (""SELECT \""session\"".\""user_id\"" AS \""metabase-user-id\"", \""user\"".\""is_superuser\"" AS \""is-superuser?\"", \""user\"".\""locale\"" AS \""user-locale\"" FROM \""core_session\"" AS \""session\"" LEFT JOIN \""core_user\"" AS \""user\"" ON \""session\"".\""user_id\"" = \""user\"".\""id\"" WHERE (\""user\"".\""is_active\"" = TRUE) AND (\""session\"".\""id\"" = ?) AND (\""session\"".\""created_at\"" > (CAST(NOW() AS timestamp) + INTERVAL '-20160 minute')) AND (\""session\"".\""anti_csrf_token\"" IS NULL) LIMIT 1"" ""355bc837-f69c-44cb-b9af-5d59a6483e7c"")}] [""with built query"" {:toucan2.pipeline/built-query (""SELECT \""session\"".\""user_id\"" AS \""metabase-user-id\"", \""user\"".\""is_superuser\"" AS \""is-superuser?\"", \""user\"".\""locale\"" AS \""user-locale\"" FROM \""core_session\"" AS \""session\"" LEFT JOIN \""core_user\"" AS \""user\"" ON \""session\"".\""user_id\"" = \""user\"".\""id\"" WHERE (\""user\"".\""is_active\"" = TRUE) AND (\""session\"".\""id\"" = ?) AND (\""session\"".\""created_at\"" > (CAST(NOW() AS timestamp) + INTERVAL '-20160 minute')) AND (\""session\"".\""anti_csrf_token\"" IS NULL) LIMIT 1"" ""355bc837-f69c-44cb-b9af-5d59a6483e7c"")}] [""with resolved query"" {:toucan2.pipeline/resolved-query (""SELECT \""session\"".\""user_id\"" AS \""metabase-user-id\"", \""user\"".\""is_superuser\"" AS \""is-superuser?\"", \""user\"".\""locale\"" AS \""user-locale\"" FROM \""core_session\"" AS \""session\"" LEFT JOIN \""core_user\"" AS \""user\"" ON \""session\"".\""user_id\"" = \""user\"".\""id\"" WHERE (\""user\"".\""is_active\"" = TRUE) AND (\""session\"".\""id\"" = ?) AND (\""session\"".\""created_at\"" > (CAST(NOW() AS timestamp) + INTERVAL '-20160 minute')) AND (\""session\"".\""anti_csrf_token\"" IS NULL) LIMIT 1"" ""355bc837-f69c-44cb-b9af-5d59a6483e7c"")}] [""with parsed args"" {:toucan2.pipeline/query-type :toucan.result-type/*, :toucan2.pipeline/parsed-args {:connectable nil, :queryable (""SELECT \""session\"".\""user_id\"" AS \""metabase-user-id\"", \""user\"".\""is_superuser\"" AS \""is-superuser?\"", \""user\"".\""locale\"" AS \""user-locale[...truncated]
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 ERROR org.quartz.impl.jdbcjobstore.JobStoreTX Couldn't rollback jdbc connection. This connection has been closed.,org.postgresql.util.PSQLException: This connection has been closed.,	at org.postgresql.jdbc.PgConnection.checkClosed(PgConnection.java:1009),	at org.postgresql.jdbc.PgConnection.rollback(PgConnection.java:1016),	at com.mchange.v2.c3p0.impl.NewProxyConnection.rollback(NewProxyConnection.java:218),	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103),	at java.base/java.lang.reflect.Method.invoke(Method.java:580),	at org.quartz.impl.jdbcjobstore.AttributeRestoringConnectionInvocationHandler.invoke(AttributeRestoringConnectionInvocationHandler.java:73),	at jdk.proxy3/jdk.proxy3.$Proxy31.rollback(Unknown Source),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.rollbackConnection(JobStoreSupport.java:3727),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.executeInNonManagedTXLock(JobStoreSupport.java:3886),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.acquireNextTriggers(JobStoreSupport.java:2802),	at org.quartz.core.QuartzSchedulerThread.run(QuartzSchedulerThread.java:287)
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 ERROR metabase.server Unexpected Exception in API request handler,clojure.lang.ExceptionInfo: An I/O error occurred while sending to the backend. {:toucan2/context-trace [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"" {:toucan2.jdbc.query/sql-args [""SELECT * FROM \""setting\"" WHERE (\""key\"" = ?) AND (\""value\"" > ?)"" ""settings-last-updated"" ""2025-01-31 10:38:33.222721+00""]}] [""resolve connection"" {:toucan2.connection/connectable metabase.db.connection.ApplicationDB}] [""resolve connection"" {:toucan2.connection/connectable :default}] [""resolve connection"" {:toucan2.connection/connectable nil}] {:toucan2.pipeline/rf #object[clojure.core$map$fn__5950$fn__5951 0x1621f898 ""clojure.core$map$fn__5950$fn__5951@1621f898""]} [""with compiled query"" {:toucan2.pipeline/compiled-query [""SELECT * FROM \""setting\"" WHERE (\""key\"" = ?) AND (\""value\"" > ?)"" ""settings-last-updated"" ""2025-01-31 10:38:33.222721+00""]}] [""with built query"" {:toucan2.pipeline/built-query {:select [:*], :from [[:setting]], :where [:and [:= :key ""settings-last-updated""] [:> :value ""2025-01-31 10:38:33.222721+00""]]}}] [""with resolved query"" {:toucan2.pipeline/resolved-query {:where [:and [:= :key ""settings-last-updated""] [:> :value ""2025-01-31 10:38:33.222721+00""]]}}] [""with parsed args"" {:toucan2.pipeline/query-type :toucan.query-type/select.instances.fns, :toucan2.pipeline/parsed-args {:queryable {:where [:and [:= :key ""settings-last-updated""] [:> :value ""2025-01-31 10:38:33.222721+00""]]}}}] [""with model"" {:toucan2.pipeline/model :model/Setting}] [""with unparsed args"" {:toucan2.pipeline/query-type :toucan.query-type/select.instances.fns, :toucan2.pipeline/unparsed-args (:model/Setting {:where [:and [:= :key ""settings-last-updated""] [:> :value ""2025-01-31 10:38:33.222721+00""]]})}]]},	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:398),	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502),	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419),	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194),	at org.postgresql.jdbc.PgPreparedStatement.execute(PgPreparedStatement.java:180),	at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.execute(NewProxyPreparedStatement.java:1216),	at toucan2.jdbc.query$reduce_jdbc_query.invokeStatic(query.clj:40),	at toucan2.jdbc.query$reduce_jdbc_query.invoke(query.clj:22),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invokeStatic(pipeline.clj:19),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invoke(pipeline.clj:9),	at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:15),	at methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733.invoke(threaded.clj:64),	at methodical.util.FnWithMeta.invoke(util.clj:46),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47), [...truncated]
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 WARN org.quartz.impl.jdbcjobstore.AttributeRestoringConnectionInvocationHandler Failed restore connection's original auto commit setting.,org.postgresql.util.PSQLException: This connection has been closed.,	at org.postgresql.jdbc.PgConnection.checkClosed(PgConnection.java:1009),	at org.postgresql.jdbc.PgConnection.setAutoCommit(PgConnection.java:938),	at com.mchange.v2.c3p0.impl.NewProxyConnection.setAutoCommit(NewProxyConnection.java:1401),	at org.quartz.impl.jdbcjobstore.AttributeRestoringConnectionInvocationHandler.restoreOriginalAtributes(AttributeRestoringConnectionInvocationHandler.java:141),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.cleanupConnection(JobStoreSupport.java:3677),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.executeInNonManagedTXLock(JobStoreSupport.java:3896),	at org.quartz.impl.jdbcjobstore.JobStoreSupport.acquireNextTriggers(JobStoreSupport.java:2802),	at org.quartz.core.QuartzSchedulerThread.run(QuartzSchedulerThread.java:287)
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 ERROR metabase.server Unexpected exception in endpoint,clojure.lang.ExceptionInfo: An I/O error occurred while sending to the backend. {:toucan2/context-trace [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"" {:toucan2.jdbc.query/sql-args [""SELECT * FROM \""setting\"" WHERE (\""key\"" = ?) AND (\""value\"" > ?)"" ""settings-last-updated"" ""2025-01-31 10:38:33.222721+00""]}] [""resolve connection"" {:toucan2.connection/connectable metabase.db.connection.ApplicationDB}] [""resolve connection"" {:toucan2.connection/connectable :default}] [""resolve connection"" {:toucan2.connection/connectable nil}] {:toucan2.pipeline/rf #object[clojure.core$map$fn__5950$fn__5951 0x1621f898 ""clojure.core$map$fn__5950$fn__5951@1621f898""]} [""with compiled query"" {:toucan2.pipeline/compiled-query [""SELECT * FROM \""setting\"" WHERE (\""key\"" = ?) AND (\""value\"" > ?)"" ""settings-last-updated"" ""2025-01-31 10:38:33.222721+00""]}] [""with built query"" {:toucan2.pipeline/built-query {:select [:*], :from [[:setting]], :where [:and [:= :key ""settings-last-updated""] [:> :value ""2025-01-31 10:38:33.222721+00""]]}}] [""with resolved query"" {:toucan2.pipeline/resolved-query {:where [:and [:= :key ""settings-last-updated""] [:> :value ""2025-01-31 10:38:33.222721+00""]]}}] [""with parsed args"" {:toucan2.pipeline/query-type :toucan.query-type/select.instances.fns, :toucan2.pipeline/parsed-args {:queryable {:where [:and [:= :key ""settings-last-updated""] [:> :value ""2025-01-31 10:38:33.222721+00""]]}}}] [""with model"" {:toucan2.pipeline/model :model/Setting}] [""with unparsed args"" {:toucan2.pipeline/query-type :toucan.query-type/select.instances.fns, :toucan2.pipeline/unparsed-args (:model/Setting {:where [:and [:= :key ""settings-last-updated""] [:> :value ""2025-01-31 10:38:33.222721+00""]]})}]]},	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:398),	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502),	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419),	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194),	at org.postgresql.jdbc.PgPreparedStatement.execute(PgPreparedStatement.java:180),	at com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.execute(NewProxyPreparedStatement.java:1216),	at toucan2.jdbc.query$reduce_jdbc_query.invokeStatic(query.clj:40),	at toucan2.jdbc.query$reduce_jdbc_query.invoke(query.clj:22),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invokeStatic(pipeline.clj:19),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invoke(pipeline.clj:9),	at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:15),	at methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733.invoke(threaded.clj:64),	at methodical.util.FnWithMeta.invoke(util.clj:46),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65),	at methodical.impl.standard$invoke_multifn. [...truncated]
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:36+01:00 ERROR metabase.server Unexpected exception in endpoint,clojure.lang.ExceptionInfo: An I/O error occurred while sending to the backend. {:toucan2/context-trace [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"" {:toucan2.jdbc.query/sql-args (""SELECT \""session\"".\""user_id\"" AS \""metabase-user-id\"", \""user\"".\""is_superuser\"" AS \""is-superuser?\"", \""user\"".\""locale\"" AS \""user-locale\"" FROM \""core_session\"" AS \""session\"" LEFT JOIN \""core_user\"" AS \""user\"" ON \""session\"".\""user_id\"" = \""user\"".\""id\"" WHERE (\""user\"".\""is_active\"" = TRUE) AND (\""session\"".\""id\"" = ?) AND (\""session\"".\""created_at\"" > (CAST(NOW() AS timestamp) + INTERVAL '-20160 minute')) AND (\""session\"".\""anti_csrf_token\"" IS NULL) LIMIT 1"" ""355bc837-f69c-44cb-b9af-5d59a6483e7c"")}] [""resolve connection"" {:toucan2.connection/connectable metabase.db.connection.ApplicationDB}] [""resolve connection"" {:toucan2.connection/connectable :default}] [""resolve connection"" {:toucan2.connection/connectable nil}] {:toucan2.pipeline/rf #object[clojure.core$completing$fn__8558 0x1b6194c3 ""clojure.core$completing$fn__8558@1b6194c3""]} [""with compiled query"" {:toucan2.pipeline/compiled-query (""SELECT \""session\"".\""user_id\"" AS \""metabase-user-id\"", \""user\"".\""is_superuser\"" AS \""is-superuser?\"", \""user\"".\""locale\"" AS \""user-locale\"" FROM \""core_session\"" AS \""session\"" LEFT JOIN \""core_user\"" AS \""user\"" ON \""session\"".\""user_id\"" = \""user\"".\""id\"" WHERE (\""user\"".\""is_active\"" = TRUE) AND (\""session\"".\""id\"" = ?) AND (\""session\"".\""created_at\"" > (CAST(NOW() AS timestamp) + INTERVAL '-20160 minute')) AND (\""session\"".\""anti_csrf_token\"" IS NULL) LIMIT 1"" ""355bc837-f69c-44cb-b9af-5d59a6483e7c"")}] [""with built query"" {:toucan2.pipeline/built-query (""SELECT \""session\"".\""user_id\"" AS \""metabase-user-id\"", \""user\"".\""is_superuser\"" AS \""is-superuser?\"", \""user\"".\""locale\"" AS \""user-locale\"" FROM \""core_session\"" AS \""session\"" LEFT JOIN \""core_user\"" AS \""user\"" ON \""session\"".\""user_id\"" = \""user\"".\""id\"" WHERE (\""user\"".\""is_active\"" = TRUE) AND (\""session\"".\""id\"" = ?) AND (\""session\"".\""created_at\"" > (CAST(NOW() AS timestamp) + INTERVAL '-20160 minute')) AND (\""session\"".\""anti_csrf_token\"" IS NULL) LIMIT 1"" ""355bc837-f69c-44cb-b9af-5d59a6483e7c"")}] [""with resolved query"" {:toucan2.pipeline/resolved-query (""SELECT \""session\"".\""user_id\"" AS \""metabase-user-id\"", \""user\"".\""is_superuser\"" AS \""is-superuser?\"", \""user\"".\""locale\"" AS \""user-locale\"" FROM \""core_session\"" AS \""session\"" LEFT JOIN \""core_user\"" AS \""user\"" ON \""session\"".\""user_id\"" = \""user\"".\""id\"" WHERE (\""user\"".\""is_active\"" = TRUE) AND (\""session\"".\""id\"" = ?) AND (\""session\"".\""created_at\"" > (CAST(NOW() AS timestamp) + INTERVAL '-20160 minute')) AND (\""session\"".\""anti_csrf_token\"" IS NULL) LIMIT 1"" ""355bc837-f69c-44cb-b9af-5d59a6483e7c"")}] [""with parsed args"" {:toucan2.pipeline/query-type :toucan.result-type/*, :toucan2.pipeline/parsed-args {:connectable nil, :queryable (""SELECT \""session\"".\""user_id\"" AS \""metabase-user-id\"", \""user\"".\""is_superuser\"" AS \""is-superuser?\"", \""user\"". [...truncated]
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:38+01:00 ERROR metabase.channel.render.card Pulse card render error,SyntaxError: class com.oracle.js.parser.ParserContextLoopNode cannot be cast to class com.oracle.js.parser.ParserContextBlockNode (com.oracle.js.parser.ParserContextLoopNode and com.oracle.js.parser.ParserContextBlockNode are in unnamed module of loader 'app')class com.oracle.js.parser.ParserContextFunctionNode cannot be cast to class com.oracle.js.parser.ParserContextBlockNode (com.oracle.js.parser.ParserContextFunctionNode and com.oracle.js.parser.ParserContextBlockNode are in unnamed module of loader 'app'),class com.oracle.js.parser.ParserContextFunctionNode cannot be cast to class com.oracle.js.parser.ParserContextBlockNode (com.oracle.js.parser.ParserContextFunctionNode and com.oracle.js.parser.ParserContextBlockNode are in unnamed module of loader 'app'),class com.oracle.js.parser.ParserContextFunctionNode cannot be cast to class com.oracle.js.parser.ParserContextBlockNode (com.oracle.js.parser.ParserContextFunctionNode and com.oracle.js.parser.ParserContextBlockNode are in unnamed module of loader 'app'),	at org.graalvm.polyglot.Context.eval(Context.java:399),	at metabase.channel.render.js.engine$load_resource.invokeStatic(engine.clj:53),	at metabase.channel.render.js.engine$load_resource.invoke(engine.clj:46),	at metabase.channel.render.js.svg$load_viz_bundle.invokeStatic(svg.clj:37),	at metabase.channel.render.js.svg$load_viz_bundle.invoke(svg.clj:35),	at metabase.channel.render.js.svg$fn__88449.invokeStatic(svg.clj:47),	at metabase.channel.render.js.svg$fn__88449.invoke(svg.clj:46),	at metabase.util.delay.DelayWithTTL.deref(delay.clj:15),	at clojure.core$deref.invokeStatic(core.clj:2337),	at clojure.core$deref.invoke(core.clj:2323),	at metabase.channel.render.js.svg$context.invokeStatic(svg.clj:53),	at metabase.channel.render.js.svg$context.invoke(svg.clj:49),	at metabase.channel.render.js.svg$javascript_visualization.invokeStatic(svg.clj:157),	at metabase.channel.render.js.svg$javascript_visualization.invoke(svg.clj:154),	at metabase.channel.render.body$fn__88827$_AMPERSAND_f__88828.invoke(body.clj:463),	at metabase.channel.render.body$fn__88827$fn__88835.invoke(body.clj:453),	at clojure.lang.MultiFn.invoke(MultiFn.java:261),	at metabase.channel.render.card$render_pulse_card_body89074__89076.invokeStatic(card.clj:138),	at metabase.channel.render.card$render_pulse_card_body89074__89076.invoke(card.clj:124),	at metabase.channel.render.card$render_pulse_card89087__89088.invokeStatic(card.clj:169),	at metabase.channel.render.card$render_pulse_card89087__89088.invoke(card.clj:148),	at metabase.channel.render.card$render_pulse_card89087__89088.invokeStatic(card.clj:156),	at metabase.channel.render.card$render_pulse_card89087__89088.invoke(card.clj:148),	at metabase.channel.impl.slack$part__GT_attachment_data.invokeStatic(slack.clj:44),	at metabase.channel.impl.slack$part__GT_attachment_data.invoke(slack.clj:36),	at metabase.channel.impl.slack$create_slack_attachment_data$iter__113920__113924$fn__113925.invoke(slack.clj:146),	 [...truncated]
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:38+01:00 ERROR metabase.notification.send [Notification null] Failed to send,clojure.lang.ExceptionInfo: Assert failed: Expected map row, got ^java.lang.Integer 0,(map? row) {:toucan2/context-trace [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"" {:toucan2.jdbc.query/sql-args [""SELECT * FROM \""metabase_database\"" WHERE \""id\"" = ?"" 2]}] [""resolve connection"" {:toucan2.connection/connectable metabase.db.connection.ApplicationDB}] [""resolve connection"" {:toucan2.connection/connectable :default}] [""resolve connection"" {:toucan2.connection/connectable nil}] {:toucan2.pipeline/rf #object[clojure.core$map$fn__5950$fn__5951 0x6fec20 ""clojure.core$map$fn__5950$fn__5951@6fec20""]} [""with compiled query"" {:toucan2.pipeline/compiled-query [""SELECT * FROM \""metabase_database\"" WHERE \""id\"" = ?"" 2]}] [""with built query"" {:toucan2.pipeline/built-query {:select [:*], :from [[:metabase_database]], :where [:= :id 2]}}] [""with resolved query"" {:toucan2.pipeline/resolved-query {}}] [""with parsed args"" {:toucan2.pipeline/query-type :toucan.query-type/select.instances, :toucan2.pipeline/parsed-args {:kv-args {:id 2}, :queryable {}}}] [""with model"" {:toucan2.pipeline/model :model/Database}] [""with unparsed args"" {:toucan2.pipeline/query-type :toucan.query-type/select.instances, :toucan2.pipeline/unparsed-args (:model/Database :id 2)}]]},	at toucan2.tools.transformed$transform_result_rows_transducer$fn__27563.invoke(transformed.clj:230),	at clojure.core$map$fn__5950$fn__5951.invoke(core.clj:2759),	at clojure.lang.PersistentVector.reduce(PersistentVector.java:418),	at clojure.core$reduce.invokeStatic(core.clj:6964),	at clojure.core$reduce.invoke(core.clj:6947),	at toucan2.jdbc.query$reduce_jdbc_query.invokeStatic(query.clj:56),	at toucan2.jdbc.query$reduce_jdbc_query.invoke(query.clj:22),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invokeStatic(pipeline.clj:19),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invoke(pipeline.clj:9),	at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:15),	at methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733.invoke(threaded.clj:64),	at methodical.util.FnWithMeta.invoke(util.clj:46),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:216),	at toucan2.pipeline$transduce_execute$with_connection_STAR___22818.invoke(pipeline.clj:78),	at toucan2.connection$bind_current_connectable_fn$fn__22495.invoke(connection.clj:104),	at toucan2.connection$bind_current_connectable_fn$fn__22495.invoke(connection.clj:104), [...truncated]	
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:38+01:00 ERROR metabase.pulse.send [Pulse null] Error sending to slack channel,clojure.lang.ExceptionInfo: Assert failed: Expected map row, got ^java.lang.Integer 0,(map? row) {:toucan2/context-trace [[""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"" {:toucan2.jdbc.query/sql-args [""SELECT * FROM \""metabase_database\"" WHERE \""id\"" = ?"" 2]}] [""resolve connection"" {:toucan2.connection/connectable metabase.db.connection.ApplicationDB}] [""resolve connection"" {:toucan2.connection/connectable :default}] [""resolve connection"" {:toucan2.connection/connectable nil}] {:toucan2.pipeline/rf #object[clojure.core$map$fn__5950$fn__5951 0x6fec20 ""clojure.core$map$fn__5950$fn__5951@6fec20""]} [""with compiled query"" {:toucan2.pipeline/compiled-query [""SELECT * FROM \""metabase_database\"" WHERE \""id\"" = ?"" 2]}] [""with built query"" {:toucan2.pipeline/built-query {:select [:*], :from [[:metabase_database]], :where [:= :id 2]}}] [""with resolved query"" {:toucan2.pipeline/resolved-query {}}] [""with parsed args"" {:toucan2.pipeline/query-type :toucan.query-type/select.instances, :toucan2.pipeline/parsed-args {:kv-args {:id 2}, :queryable {}}}] [""with model"" {:toucan2.pipeline/model :model/Database}] [""with unparsed args"" {:toucan2.pipeline/query-type :toucan.query-type/select.instances, :toucan2.pipeline/unparsed-args (:model/Database :id 2)}]]},	at toucan2.tools.transformed$transform_result_rows_transducer$fn__27563.invoke(transformed.clj:230),	at clojure.core$map$fn__5950$fn__5951.invoke(core.clj:2759),	at clojure.lang.PersistentVector.reduce(PersistentVector.java:418),	at clojure.core$reduce.invokeStatic(core.clj:6964),	at clojure.core$reduce.invoke(core.clj:6947),	at toucan2.jdbc.query$reduce_jdbc_query.invokeStatic(query.clj:56),	at toucan2.jdbc.query$reduce_jdbc_query.invoke(query.clj:22),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invokeStatic(pipeline.clj:19),	at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invoke(pipeline.clj:9),	at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:15),	at methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733.invoke(threaded.clj:64),	at methodical.util.FnWithMeta.invoke(util.clj:46),	at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65),	at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47),	at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:216),	at toucan2.pipeline$transduce_execute$with_connection_STAR___22818.invoke(pipeline.clj:78),	at toucan2.connection$bind_current_connectable_fn$fn__22495.invoke(connection.clj:104),	at toucan2.connection$bind_current_connectable_fn$fn__22495.invoke(connection.clj:104),	[...truncated]
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:38+01:00 DEBUG metabase.server.middleware.log POST /api/pulse/test 200 202464ms (502 DB calls) App DB connections: 8/12 Jetty threads: 4/50 (5 idle, 0 queued) (110 total active threads) Queries in flight: 0 (0 queued); mysql DB 2 connections: 0/5 (0 threads blocked) {:metabase-user-id 1}
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:38+01:00 INFO metabase.server.middleware.exceptions Request canceled before finishing.
[a3b9d497-fe70-4334-a78d-61a14e5c3631] 2025-01-31T11:42:38+01:00 DEBUG metabase.server.middleware.log POST /api/pulse/test null 202518ms (502 DB calls) App DB connections: 8/12 Jetty threads: 4/50 (5 idle, 0 queued) (110 total active threads) Queries in flight: 0 (0 queued); mysql DB 2 connections: 0/5 (0 threads blocked) {:metabase-user-id 1}
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mysql""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-27"",
      ""tag"": ""v0.52.8"",
      ""hash"": ""3cbfc1e""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Paris""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.8""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.11.6-clevercloud-vm-dirty"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

Blocking some users

### Additional context

Instance specs: 1CPU, 1GB RAM

The rest of Metabase works fine otherwise.",whisust,2025-01-31 11:05:51+00:00,[],2025-02-04 20:26:25+00:00,,https://github.com/metabase/metabase/issues/53035,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Backend', ''), ('Notifications/Slack', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2626955703, 'issue_id': 2823078948, 'author': 'whisust', 'body': ""I've upgraded to a 2GB / 2CPU machine and it seems to work now..."", 'created_at': datetime.datetime(2025, 1, 31, 11, 12, 44, tzinfo=datetime.timezone.utc)}]","whisust (Issue Creator) on (2025-01-31 11:12:44 UTC): I've upgraded to a 2GB / 2CPU machine and it seems to work now...

"
2823047028,issue,open,,Feature Request: Add API Endpoint to Pin/Unpin Items in a Collection,"**Is your feature request related to a problem? Please describe.**

Currently, there is no way to pin an item (such as a dashboard) in a collection using the Metabase API. The /api/collection/:id/items endpoint allows filtering pinned items via pinned_state, but there is no documented way to programmatically set an item’s pinned state. This limitation makes it impossible to automate dashboard organization fully, requiring manual intervention via the UI.

**Describe the solution you'd like**

An API endpoint to pin or unpin an item in a collection programmatically. A logical implementation would be:


PUT /api/collection/:collection_id/items/:item_id
      {
          ""pinned_state"": ""is_pinned""
      }
or

PUT /api/collection/:collection_id/items/:item_id
      {
          ""pinned_state"": ""is_not_pinned""
      }


This would allow automation scripts, CI/CD pipeline to ensure critical dashboards remain pinned in collections without manual intervention.

**Describe alternatives you've considered**

- Manually pinning dashboards via the UI (time-consuming for large teams).
- Trying to update the pinned status via /api/dashboard/:id, but this doesn’t seem to support pinned_state.
- Exploring collection_position, but it does not appear to control pinned status.
- Checking if moving an item within a collection affects its pinned state—no reliable workaround found.

**How important is this feature to you?**

This feature is useful but not critical for teams that automate dashboard management. Without it, all pinning must be done manually.

Thanks for considering this request! 🙌",JeanLouisLamezec,2025-01-31 10:52:28+00:00,[],2025-02-04 20:31:02+00:00,,https://github.com/metabase/metabase/issues/53034,"[('Type:New Feature', ''), ('.Needs Triage', '')]",[],
2822328087,issue,closed,not_planned,The results metadata contains an invalid set of columns in the pivot table questions,"### Describe the bug

In pivot table query results the `results_metadata` has invalid set of columns which does not match `data.cols`:
<img width=""900"" alt=""Image"" src=""https://github.com/user-attachments/assets/23351dc8-91ef-4c56-b833-abf5b1fc15ac"" />

Causes this https://github.com/metabase/metabase/issues/52339 which will be anyway fixed by https://github.com/metabase/metabase/pull/53013 however it is still worth fixing the metadata.

### To Reproduce

1. Create a pivot table question with 3 measures, 2 rows, and 1 column
2. Open the dataset API response
3. See columns in `results_metadata` do not match `data.cols`


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""oracle"",
      ""h2"",
      ""sqlserver""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-30"",
      ""src_hash"": ""bb99956328d8d59be72d7da5548d5f4dc7c80fac"",
      ""tag"": ""v0.53.2-SNAPSHOT"",
      ""hash"": ""ce8752e""
    },
    ""settings"": {
      ""report-timezone"": ""UTC""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.12 (Homebrew)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.4""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""17.0.5+8"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""17.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""17.0.5+8"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.1.2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""America/Toronto""
  }
}
```

### Severity

Can't reliably use results_metadata, caused a P1 bug

### Additional context

_No response_",alxnddr,2025-01-31 03:00:11+00:00,[],2025-01-31 03:35:22+00:00,2025-01-31 03:35:21+00:00,https://github.com/metabase/metabase/issues/53019,"[('Type:Bug', 'Product defects'), ('Type:Tech Debt', 'or Refactoring'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Backend', ''), ('.Team/Querying', ''), ('Querying/Pivot', 'Queries that generate pivot tables')]","[{'comment_id': 2626227725, 'issue_id': 2822328087, 'author': 'ranquild', 'body': 'Duplicate of https://github.com/metabase/metabase/issues/41896', 'created_at': datetime.datetime(2025, 1, 31, 3, 35, 21, tzinfo=datetime.timezone.utc)}]","ranquild on (2025-01-31 03:35:21 UTC): Duplicate of https://github.com/metabase/metabase/issues/41896

"
2821980042,issue,closed,completed,Font fallback on row chart legend is inconsistent with --mb-default-font-family,"### Describe the bug

Row chart labels override a fallback from Lato (default font?) to sans serif, which when exporting to PDF means that legend fonts can be inconsistent with the rest of the charts in a dashboard. It displays correctly in the browser.

The text for the column charts (works nicely) has this element: ```<text dominant-baseline=""central"" text-anchor=""middle"" y=""-6"" transform=""translate(289.5559 125.7852)"" fill=""#4C5773"" stroke=""#FFFFFF"" stroke-width=""3"" paint-order=""stroke"" stroke-miterlimit=""2"" style=""font-size: 12px; font-family: Lato, Arial, sans-serif; font-weight: 600;"">VALUE GOES HERE</text>```

The text for the row charts (serif unhappiness) has this element: ```<text transform="""" x=""-8"" y=""35.4375"" fill=""#696E7B"" font-family=""Lato"" font-size=""12"" font-weight=""700"" text-anchor=""end""><tspan x=""-8"" dy=""0em"">VALUE GOES HERE</tspan></text>```

In browser 

<img width=""120"" alt=""Image"" src=""https://github.com/user-attachments/assets/ba4217b3-6602-42d4-9a2e-bdea1bf07174"" />

Exported to PDF

<img width=""86"" alt=""Image"" src=""https://github.com/user-attachments/assets/b5b67b68-f3df-486f-a4f8-0dfec219ceaf"" />

### To Reproduce

I'm not sure of the system requirements, if having fonts available or not is important to reproduce (EDIT: Downloaded Lato, restarted stuff, and it's working as expected now) but a minimally viable one on my machine:

Create a dashboard with two charts (one row, one column)
Export to PDF
Observe the font of the row chart, which is different to the column chart and also different to how it appeared in the browser

The default font of ""Lato"" has not been changed.

### Expected behavior

All fonts in exported PDFs to be consistent - if Lato is unavailable, the fallback of sans-serif to be consistently applied to all legends and labels etc.

### Logs

## Console Logs
```document clone with size 679x505 scrolled to 0,0
save-dashboard-pdf.ts:192 [Violation] Avoid using document.write(). https://developers.google.com/web/updates/2016/08/removing-document-write
A.toIFrame @ html2canvas-pro.js:6060
(anonymous) @ html2canvas-pro.js:8624
i @ html2canvas-pro.js:86
(anonymous) @ html2canvas-pro.js:67
(anonymous) @ html2canvas-pro.js:60
__awaiter @ html2canvas-pro.js:56
renderElement @ html2canvas-pro.js:8578
html2canvas @ html2canvas-pro.js:8573
h @ save-dashboard-pdf.ts:192
Show 8 more frames
Show less
save-dashboard-pdf.ts:192 Refused to apply inline style because it violates the following Content Security Policy directive: ""style-src 'self' 'nonce-FoIfPJobTc'   https://accounts.google.com"". Either the 'unsafe-inline' keyword, a hash ('sha256-UP0QZg7irvSMvOBz9mH2PIIE28+57UiavRfeVea0l3g='), or a nonce ('nonce-...') is required to enable inline execution.

A.toIFrame @ html2canvas-pro.js:6063
(anonymous) @ html2canvas-pro.js:8624
i @ html2canvas-pro.js:86
(anonymous) @ html2canvas-pro.js:67
(anonymous) @ html2canvas-pro.js:60
__awaiter @ html2canvas-pro.js:56
renderElement @ html2canvas-pro.js:8578
html2canvas @ html2canvas-pro.js:8573
h @ save-dashboard-pdf.ts:192
Show 8 more frames
Show less
html2canvas-pro.js:8497 #2 730ms Document cloned, element located at 24,161.8984375 with size 631x2493.5 using computed rendering
html2canvas-pro.js:8497 #2 730ms Starting DOM parsing
html2canvas-pro.js:8497 #2 744ms Added image data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2IDYiIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmYwMCIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI2cHgiIGhlaWdodD0iNnB4Ij48ZyBvcGFjaXR5PSIwLjMwMiI+PHBhdGggZD0iTSA2IDYgTCAwID
html2canvas-pro.js:8497 #2 760ms Added image data:image/svg+xml,%3Csvg%20width%3D%22599px%22%20height%3D%22249.8046875px%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20version%3D%221.1%22%20baseProfile%3D%22full%22%20style%3D%2
html2canvas-pro.js:8497 #2 787ms Added image data:image/svg+xml,%3Csvg%20width%3D%22241px%22%20height%3D%22241px%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20version%3D%221.1%22%20baseProfile%3D%22full%22%20style%3D%22positio
html2canvas-pro.js:8497 #2 800ms Added image data:image/svg+xml,%3Csvg%20width%3D%22599px%22%20height%3D%22249.8046875px%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20version%3D%221.1%22%20baseProfile%3D%22full%22%20style%3D%2
html2canvas-pro.js:8497 #2 818ms Added image data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20style%3D%22position%3A%20absolute%3B%20inset%3A%200px%3B%20width%3A%20599px%3B%20transition%3A%20all%3B%20-webkit-writing-mode%3A%20horizontal-tb%3B%20-webkit-user-modify%3A%2
html2canvas-pro.js:8497 #2 824ms Added image data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22currentcolor%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20viewBox%3D%220%200%2016%2016%22%20class%3D%22Icon%20Icon-official_collection%20eixyz712%20e
html2canvas-pro.js:8497 #2 828ms Added image data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%22139.890625px%22%20width%3D%22253.3359375px%22%20class%3D%22CkxlV%20Fw2w3%22%20viewBox%3D%220%200%201%201%22%20preserveAspectRatio%3D%22none%22%20style%3D%22transit
html2canvas-pro.js:8497 #2 831ms Added image data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%22139.890625px%22%20width%3D%22253.3359375px%22%20class%3D%22CkxlV%20Fw2w3%22%20viewBox%3D%220%200%201%201%22%20preserveAspectRatio%3D%22none%22%20style%3D%22transit
html2canvas-pro.js:8497 #2 838ms Added image data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22currentcolor%22%20viewBox%3D%220%200%2016%2016%22%20class%3D%22Icon%20Icon-chevronup%20e1euvgei4%20emotion-mm2b5j%22%20role%3D%22img%22%20aria-label%3D%22chevronup%2
html2canvas-pro.js:8497 #2 846ms Added image data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22currentcolor%22%20viewBox%3D%220%200%2016%2016%22%20class%3D%22Icon%20Icon-chevronleft%20emotion-1avyp1d%22%20role%3D%22img%22%20aria-label%3D%22chevronleft%20icon%2
html2canvas-pro.js:8497 #2 848ms Added image data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20fill%3D%22currentcolor%22%20viewBox%3D%220%200%2016%2016%22%20class%3D%22Icon%20Icon-chevronright%20emotion-1avyp1d%22%20role%3D%22img%22%20aria-label%3D%22chevronright%20icon
html2canvas-pro.js:8497 #2 849ms Starting renderer for element at 24,161.8984375 with size 631x2493.5
html2canvas-pro.js:8497 #2 850ms Canvas renderer initialized (631x2493.5) with scale 2
html2canvas-pro.js:8497 #2 1029ms Finished rendering
analytics.ts:57 
        
        
       POST https://sp.metabase.com/com.snowplowanalytics.snowplow/tp2 net::ERR_BLOCKED_BY_CLIENT```


## Server Logs
```
[c4481f0c-b284-49fa-9601-9e39b470da75] 2025-01-31T09:47:59+11:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 3ms (1 DB calls) App DB connections: 0/15 Jetty threads: 4/50 (2 idle, 0 queued) (143 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 6}
[c4481f0c-b284-49fa-9601-9e39b470da75] 2025-01-31T09:48:03+11:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 3ms (1 DB calls) App DB connections: 0/15 Jetty threads: 4/50 (2 idle, 0 queued) (143 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 6}
[c4481f0c-b284-49fa-9601-9e39b470da75] 2025-01-31T09:48:07+11:00 DEBUG metabase.server.middleware.log GET /api/pulse/form_input 200 3ms (3 DB calls) App DB connections: 0/15 Jetty threads: 4/50 (2 idle, 0 queued) (143 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 6}
[c4481f0c-b284-49fa-9601-9e39b470da75] 2025-01-31T09:48:07+11:00 INFO metabase.integrations.slack Refreshing slack channels and usernames.
[c4481f0c-b284-49fa-9601-9e39b470da75] 2025-01-31T09:49:29+11:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 38ms (15 DB calls) App DB connections: 0/15 Jetty threads: 5/50 (3 idle, 0 queued) (140 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 6}
[c4481f0c-b284-49fa-9601-9e39b470da75] 2025-01-31T09:49:29+11:00 DEBUG metabase.server.middleware.log GET /api/setting 200 48ms (28 DB calls) App DB connections: 0/15 Jetty threads: 5/50 (3 idle, 0 queued) (140 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 6}
[c4481f0c-b284-49fa-9601-9e39b470da75] 2025-01-31T09:49:30+11:00 DEBUG metabase.server.middleware.log GET /api/setting 200 45ms (28 DB calls) App DB connections: 0/15 Jetty threads: 6/50 (2 idle, 0 queued) (142 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 6}
[c4481f0c-b284-49fa-9601-9e39b470da75] 2025-01-31T09:49:30+11:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 31ms (15 DB calls) App DB connections: 0/15 Jetty threads: 6/50 (2 idle, 0 queued) (143 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 6}
[c4481f0c-b284-49fa-9601-9e39b470da75] 2025-01-31T09:49:30+11:00 DEBUG metabase.server.middleware.log GET /api/setup/admin_checklist 200 13ms (11 DB calls) App DB connections: 0/15 Jetty threads: 4/50 (2 idle, 0 queued) (143 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 6}
[c4481f0c-b284-49fa-9601-9e39b470da75] 2025-01-31T09:49:39+11:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 3ms (1 DB calls) App DB connections: 0/15 Jetty threads: 4/50 (2 idle, 0 queued) (143 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 6}```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""bigquery-cloud-sdk"",
      ""snowflake"",
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-cloud"",
    ""version"": {
      ""date"": ""2025-01-28"",
      ""tag"": ""v1.52.8.2"",
      ""hash"": ""412e324""
    },
    ""settings"": {
      ""report-timezone"": ""Australia/Melbourne""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres""
  }
}
```

### Severity

Low

### Additional context

This can be hacked around by playing in the browser, so it's non urgent; we use this same hacking around in the browser to slightly improve the aesthetics of the exported PDFs in other ways.",apzeb,2025-01-30 22:52:05+00:00,[],2025-01-31 22:11:41+00:00,2025-01-31 19:40:27+00:00,https://github.com/metabase/metabase/issues/53007,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Export', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2626368052, 'issue_id': 2821980042, 'author': 'WiNloSt', 'body': 'Reproducible on both 1.51.13 and 1.52.8\n\n[51.13-export.pdf](https://github.com/user-attachments/files/18613563/51.13-export.pdf)\n[52.8-export.pdf](https://github.com/user-attachments/files/18613562/52.8-export.pdf)', 'created_at': datetime.datetime(2025, 1, 31, 5, 56, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2628486007, 'issue_id': 2821980042, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)', 'created_at': datetime.datetime(2025, 1, 31, 22, 11, 40, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-31 05:56:09 UTC): Reproducible on both 1.51.13 and 1.52.8

[51.13-export.pdf](https://github.com/user-attachments/files/18613563/51.13-export.pdf)
[52.8-export.pdf](https://github.com/user-attachments/files/18613562/52.8-export.pdf)

github-actions[bot] on (2025-01-31 22:11:40 UTC): 🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)

"
2821915638,issue,closed,completed,Metabot - create API endpoint for the query-metric tool,"**Context**

Documentation can be found [here](https://www.notion.so/metabase/Tools-API-endpoints-18b69354c9018000b109de03c81b6917?pvs=25)

",retro,2025-01-30 22:08:30+00:00,['metamben'],2025-02-05 17:37:36+00:00,2025-02-05 17:37:36+00:00,https://github.com/metabase/metabase/issues/53003,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('Metabot/Tools', 'Tools that are agnostic of the LLM framework itself, could be reused for notifications framework als')]",[],
2821838374,issue,closed,completed,Tooltip in SQL Query save button can be empty,"### Describe the bug

If starting a new question, if you hover over the save button you will be shown an empty tooltop

![Image](https://github.com/user-attachments/assets/ad18cb98-bdc8-437a-9591-0610281641f4)

### To Reproduce

1. Go to New -> SQL Query
2. With an empty editor, hover over the save button
3. You will see an empty tooltip


### Expected behavior

It looks like there is code to show a permissions message if the button is disabled for that reason. We should have a different message here, or disable the tooltip in this scenario

### Logs

_No response_

### Information about your Metabase installation

```JSON
0.53-RC
```

### Severity

Not severe, but should be an easy fix

### Additional context

_No response_",npfitz,2025-01-30 21:16:56+00:00,[],2025-01-31 07:07:45+00:00,2025-01-31 07:07:44+00:00,https://github.com/metabase/metabase/issues/52996,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Native', 'The SQL/native query editor'), ('.Frontend', ''), ('.Team/Querying', '')]","[{'comment_id': 2626362141, 'issue_id': 2821838374, 'author': 'WiNloSt', 'body': ""Started happening on 52\n\nReproducible on 1.52.8\n![Image](https://github.com/user-attachments/assets/56a0b868-5f38-486c-a81f-3cdcce1e8d5a)\n\nbut couldn't reproduce on 1.51.13\n![Image](https://github.com/user-attachments/assets/8877bbc2-82c6-4872-879d-3d55e9f60ea7)"", 'created_at': datetime.datetime(2025, 1, 31, 5, 50, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2626453589, 'issue_id': 2821838374, 'author': 'kamilmielnik', 'body': 'Duplicate of #51035', 'created_at': datetime.datetime(2025, 1, 31, 7, 7, 44, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-31 05:50:22 UTC): Started happening on 52

Reproducible on 1.52.8
![Image](https://github.com/user-attachments/assets/56a0b868-5f38-486c-a81f-3cdcce1e8d5a)

but couldn't reproduce on 1.51.13
![Image](https://github.com/user-attachments/assets/8877bbc2-82c6-4872-879d-3d55e9f60ea7)

kamilmielnik on (2025-01-31 07:07:44 UTC): Duplicate of #51035

"
2821428173,issue,open,,Order line chart by date in week of the year presentation,"If we create a line chart, count() vs week of the year filtering by current year, the very last week of the previous year (52 or 53)  that most of the time fall between years is showed at the very right of the chart, not at the beginning. This is because line chart order numbers from low to high.
<img width=""1311"" alt=""Image"" src=""https://github.com/user-attachments/assets/3ed5d1ce-4192-4836-bc08-0e02cf960deb"" />

A solution would be to be able to order the line in the editor, by date for example, so the order of the week of the year would follow this rule, 52, 1, 2, 3 --- etc.

This is very important to us since we analyze trends by week of the year, as many other companies.
",giobjk,2025-01-30 17:37:07+00:00,[],2025-02-04 20:30:19+00:00,,https://github.com/metabase/metabase/issues/52983,"[('Type:New Feature', ''), ('.Team/Querying', '')]",[],
2821378797,issue,open,,Cache queries in the find-outliers tool,"**Context**

Although we are running the query in userland, it cannot be saved because the context is missing. Whenever we use the tool, the following warning is getting generated:
```
WARN middleware.process-userland-query :: Cannot save QueryExecution, missing :context
```
",metamben,2025-01-30 17:11:59+00:00,[],2025-02-04 20:23:52+00:00,,https://github.com/metabase/metabase/issues/52980,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2821210373,issue,open,,Long column names overflow in data viz settings on cartesian charts,"[Slack thread](https://metaboat.slack.com/archives/C01LQQ2UW03/p1738228937437259)

**Context**

Column names should not overflow:
<img width=""621"" alt=""Image"" src=""https://github.com/user-attachments/assets/7abb1918-eaa1-4694-9a38-9f840ef482ac"" />

Possibly related to https://github.com/metabase/metabase/pull/52290


",alxnddr,2025-01-30 15:59:16+00:00,['alxnddr'],2025-02-04 20:31:26+00:00,,https://github.com/metabase/metabase/issues/52975,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Chart Settings', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2821148245,issue,open,,"Feature Request: UI Support for PostGIS Spatial Queries (ST_Intersects, ST_Contains, etc.)","**Is your feature request related to a problem? Please describe.**
Metabase currently does not provide a way to perform spatial joins (e.g., ST_Intersects, ST_Contains, ST_DWithin) in the visual query builder. This is frustrating when working with PostGIS-enabled PostgreSQL databases, as spatial queries must be written manually using SQL instead of being supported in the UI.

The visual query builder only supports standard equality (=) joins, which are not applicable for spatial relationships.

Example scenario:

I want to join an addresses table (addresses_gwr_import) with a perimeters table (fw_perimeter_geoms) based on spatial intersections using ST_Intersects(), but the UI only allows an = join on the geom column (as seen in the attached screenshot).

**Describe the solution you'd like**
I would like Metabase's visual query builder to support spatial joins for PostGIS databases.
This could be implemented by allowing users to select PostGIS-specific join conditions such as:

✅ ST_Intersects(a.geom, b.geom) → Find records where geometries intersect.
✅ ST_Contains(a.geom, b.geom) → Find records where one geometry fully contains another.
✅ ST_DWithin(a.geom, b.geom, distance) → Find records within a certain distance.
✅ ST_Within(a.geom, b.geom) → Find records where one geometry is within another.
✅ ST_Equals(a.geom, b.geom) → Find records where geometries are identical.
Ideally, Metabase could detect PostGIS-enabled databases and provide these options when selecting a join condition for geometry or geography columns.

**Describe alternatives you've considered**
Writing raw SQL queries manually – This works but is not user-friendly for non-technical users who rely on the visual builder.

**How important is this feature to you?**
Highly important – Many industries (GIS, urban planning, logistics, utilities, etc.) use spatial data, and supporting PostGIS in the UI would make Metabase a more powerful BI tool.

**Additional context**

![Image](https://github.com/user-attachments/assets/3d540035-e53f-40a9-8791-2e8ab5be07d6)
",khashashin,2025-01-30 15:34:22+00:00,[],2025-02-04 20:30:57+00:00,,https://github.com/metabase/metabase/issues/52972,"[('Type:New Feature', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]",[],
2821110786,issue,closed,not_planned,Metabot feature does not show up even set MB_IS_METABOT_ENABLED=true,"### Describe the bug

Cannot see Metabot option in setting page even I set MB_IS_METABOT_ENABLED=true in the env file..

### To Reproduce

1. Go to 'Admin Settings'
2. See nothing


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""duckdb"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-15"",
      ""tag"": ""v0.52.6"",
      ""hash"": ""1a9cb72""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.2 (Debian 17.2-1.pgdg120+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.26+4-LTS"",
    ""java.vendor"": ""Amazon.com Inc."",
    ""java.vendor.url"": ""https://aws.amazon.com/corretto/"",
    ""java.version"": ""11.0.26"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.26+4-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.0-29-amd64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/London""
  }
}
```

### Severity

blocking an upgrade and discourage the users since all other BI tool are providing AI chat function now

### Additional context

_No response_",moonbug-car,2025-01-30 15:19:51+00:00,[],2025-01-30 15:40:31+00:00,2025-01-30 15:40:29+00:00,https://github.com/metabase/metabase/issues/52968,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2624846166, 'issue_id': 2821110786, 'author': 'paoliniluis', 'body': 'This feature has been deprecated for a very long time', 'created_at': datetime.datetime(2025, 1, 30, 15, 40, 30, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-30 15:40:30 UTC): This feature has been deprecated for a very long time

"
2821080916,issue,open,,Empty target dropdown when editing data reference,"### Describe the bug

![Image](https://github.com/user-attachments/assets/25509f92-d722-4616-825b-6e5f80571011)

### To Reproduce

1. Sidebar > Databases
2. Click ""Learn about our data""
3. Click ""Sample Database""
4. Click ""Tables in Sample Database""
5. Click ""Orders""
6. Click ""Fields in this table""
7. Click ""Edit""
8. Click ""Select a target"" for ""User ID"" field

Dropdown is empty

### Expected behavior

Unclear. Either the dropdown should not be rendered or it should have values.

### Information about your Metabase installation

master, 220e18db22cde8e41a7cf140c5e182af302692e7

### Severity

P2
",kamilmielnik,2025-01-30 15:08:03+00:00,[],2025-02-05 19:30:56+00:00,,https://github.com/metabase/metabase/issues/52966,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Organization/Data Reference', ''), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2820544684,issue,closed,completed,Exception at startup with Java 11 from v0.52.8,"### Describe the bug

Metabase doen't start with Java 11

### To Reproduce

Run

```
$ java -Xmx1g -jar /var/www/demo/metabase/metabase.jar
```

And wait for a few seconds.

### Expected behavior

Metabase should start. It does with v0.52.7.

### Logs

```
Exception in thread ""main"" java.lang.NoClassDefFoundError: java/util/SequencedCollection
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:398)
	at clojure.lang.RT.classForName(RT.java:2229)
	at clojure.lang.RT.classForName(RT.java:2238)
	at instaparse.auto_flatten_seq$fn__6961.<clinit>(auto_flatten_seq.clj:314)
	at instaparse.auto_flatten_seq__init.load(Unknown Source)
	at instaparse.auto_flatten_seq__init.<clinit>(Unknown Source)
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:398)
	at clojure.lang.RT.classForName(RT.java:2229)
	at clojure.lang.RT.classForName(RT.java:2238)
	at clojure.lang.RT.loadClassForName(RT.java:2257)
	at clojure.lang.RT.load(RT.java:469)
	at clojure.lang.RT.load(RT.java:444)
	at clojure.core$load$fn__6931.invoke(core.clj:6189)
	at clojure.core$load.invokeStatic(core.clj:6188)
	at clojure.core$load.doInvoke(core.clj:6172)
	at clojure.lang.RestFn.invoke(RestFn.java:411)
	at clojure.core$load_one.invokeStatic(core.clj:5961)
	at clojure.core$load_one.invoke(core.clj:5956)
	at clojure.core$load_lib$fn__6873.invoke(core.clj:6003)
	at clojure.core$load_lib.invokeStatic(core.clj:6002)
	at clojure.core$load_lib.doInvoke(core.clj:5981)
	at clojure.lang.RestFn.applyTo(RestFn.java:145)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$load_libs.invokeStatic(core.clj:6044)
	at clojure.core$load_libs.doInvoke(core.clj:6028)
	at clojure.lang.RestFn.applyTo(RestFn.java:140)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$require.invokeStatic(core.clj:6066)
	at clojure.core$require.doInvoke(core.clj:6066)
	at clojure.lang.RestFn.invoke(RestFn.java:485)
	at instaparse.gll$loading__6812__auto____6864.invoke(gll.clj:1)
	at instaparse.gll__init.load(Unknown Source)
	at instaparse.gll__init.<clinit>(Unknown Source)
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:398)
	at clojure.lang.RT.classForName(RT.java:2229)
	at clojure.lang.RT.classForName(RT.java:2238)
	at clojure.lang.RT.loadClassForName(RT.java:2257)
	at clojure.lang.RT.load(RT.java:469)
	at clojure.lang.RT.load(RT.java:444)
	at clojure.core$load$fn__6931.invoke(core.clj:6189)
	at clojure.core$load.invokeStatic(core.clj:6188)
	at clojure.core$load.doInvoke(core.clj:6172)
	at clojure.lang.RestFn.invoke(RestFn.java:411)
	at clojure.core$load_one.invokeStatic(core.clj:5961)
	at clojure.core$load_one.invoke(core.clj:5956)
	at clojure.core$load_lib$fn__6873.invoke(core.clj:6003)
	at clojure.core$load_lib.invokeStatic(core.clj:6002)
	at clojure.core$load_lib.doInvoke(core.clj:5981)
	at clojure.lang.RestFn.applyTo(RestFn.java:145)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$load_libs.invokeStatic(core.clj:6044)
	at clojure.core$load_libs.doInvoke(core.clj:6028)
	at clojure.lang.RestFn.applyTo(RestFn.java:140)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$require.invokeStatic(core.clj:6066)
	at clojure.core$require.doInvoke(core.clj:6066)
	at clojure.lang.RestFn.invoke(RestFn.java:1526)
	at instaparse.core$loading__6812__auto____6862.invoke(core.clj:1)
	at instaparse.core__init.load(Unknown Source)
	at instaparse.core__init.<clinit>(Unknown Source)
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:398)
	at clojure.lang.RT.classForName(RT.java:2229)
	at clojure.lang.RT.classForName(RT.java:2238)
	at clojure.lang.RT.loadClassForName(RT.java:2257)
	at clojure.lang.RT.load(RT.java:469)
	at clojure.lang.RT.load(RT.java:444)
	at clojure.core$load$fn__6931.invoke(core.clj:6189)
	at clojure.core$load.invokeStatic(core.clj:6188)
	at clojure.core$load.doInvoke(core.clj:6172)
	at clojure.lang.RestFn.invoke(RestFn.java:411)
	at clojure.core$load_one.invokeStatic(core.clj:5961)
	at clojure.core$load_one.invoke(core.clj:5956)
	at clojure.core$load_lib$fn__6873.invoke(core.clj:6003)
	at clojure.core$load_lib.invokeStatic(core.clj:6002)
	at clojure.core$load_lib.doInvoke(core.clj:5981)
	at clojure.lang.RestFn.applyTo(RestFn.java:145)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$load_libs.invokeStatic(core.clj:6044)
	at clojure.core$load_libs.doInvoke(core.clj:6028)
	at clojure.lang.RestFn.applyTo(RestFn.java:140)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$require.invokeStatic(core.clj:6066)
	at clojure.core$require.doInvoke(core.clj:6066)
	at clojure.lang.RestFn.invoke(RestFn.java:439)
	at clout.core$loading__6812__auto____54743.invoke(core.cljc:1)
	at clout.core__init.load(Unknown Source)
	at clout.core__init.<clinit>(Unknown Source)
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:398)
	at clojure.lang.RT.classForName(RT.java:2229)
	at clojure.lang.RT.classForName(RT.java:2238)
	at clojure.lang.RT.loadClassForName(RT.java:2257)
	at clojure.lang.RT.load(RT.java:469)
	at clojure.lang.RT.load(RT.java:444)
	at clojure.core$load$fn__6931.invoke(core.clj:6189)
	at clojure.core$load.invokeStatic(core.clj:6188)
	at clojure.core$load.doInvoke(core.clj:6172)
	at clojure.lang.RestFn.invoke(RestFn.java:411)
	at clojure.core$load_one.invokeStatic(core.clj:5961)
	at clojure.core$load_one.invoke(core.clj:5956)
	at clojure.core$load_lib$fn__6873.invoke(core.clj:6003)
	at clojure.core$load_lib.invokeStatic(core.clj:6002)
	at clojure.core$load_lib.doInvoke(core.clj:5981)
	at clojure.lang.RestFn.applyTo(RestFn.java:145)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$load_libs.invokeStatic(core.clj:6044)
	at clojure.core$load_libs.doInvoke(core.clj:6028)
	at clojure.lang.RestFn.applyTo(RestFn.java:140)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$require.invokeStatic(core.clj:6066)
	at clojure.core$require.doInvoke(core.clj:6066)
	at clojure.lang.RestFn.invoke(RestFn.java:515)
	at compojure.core$loading__6812__auto____55733.invoke(core.clj:1)
	at compojure.core__init.load(Unknown Source)
	at compojure.core__init.<clinit>(Unknown Source)
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:398)
	at clojure.lang.RT.classForName(RT.java:2229)
	at clojure.lang.RT.classForName(RT.java:2238)
	at clojure.lang.RT.loadClassForName(RT.java:2257)
	at clojure.lang.RT.load(RT.java:469)
	at clojure.lang.RT.load(RT.java:444)
	at clojure.core$load$fn__6931.invoke(core.clj:6189)
	at clojure.core$load.invokeStatic(core.clj:6188)
	at clojure.core$load.doInvoke(core.clj:6172)
	at clojure.lang.RestFn.invoke(RestFn.java:411)
	at clojure.core$load_one.invokeStatic(core.clj:5961)
	at clojure.core$load_one.invoke(core.clj:5956)
	at clojure.core$load_lib$fn__6873.invoke(core.clj:6003)
	at clojure.core$load_lib.invokeStatic(core.clj:6002)
	at clojure.core$load_lib.doInvoke(core.clj:5981)
	at clojure.lang.RestFn.applyTo(RestFn.java:145)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$load_libs.invokeStatic(core.clj:6044)
	at clojure.core$load_libs.doInvoke(core.clj:6028)
	at clojure.lang.RestFn.applyTo(RestFn.java:140)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$require.invokeStatic(core.clj:6066)
	at clojure.core$require.doInvoke(core.clj:6066)
	at clojure.lang.RestFn.invoke(RestFn.java:3207)
	at metabase.api.common$loading__6812__auto____55641.invoke(common.clj:79)
	at metabase.api.common__init.load(Unknown Source)
	at metabase.api.common__init.<clinit>(Unknown Source)
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:398)
	at clojure.lang.RT.classForName(RT.java:2229)
	at clojure.lang.RT.classForName(RT.java:2238)
	at clojure.lang.RT.loadClassForName(RT.java:2257)
	at clojure.lang.RT.load(RT.java:469)
	at clojure.lang.RT.load(RT.java:444)
	at clojure.core$load$fn__6931.invoke(core.clj:6189)
	at clojure.core$load.invokeStatic(core.clj:6188)
	at clojure.core$load.doInvoke(core.clj:6172)
	at clojure.lang.RestFn.invoke(RestFn.java:411)
	at clojure.core$load_one.invokeStatic(core.clj:5961)
	at clojure.core$load_one.invoke(core.clj:5956)
	at clojure.core$load_lib$fn__6873.invoke(core.clj:6003)
	at clojure.core$load_lib.invokeStatic(core.clj:6002)
	at clojure.core$load_lib.doInvoke(core.clj:5981)
	at clojure.lang.RestFn.applyTo(RestFn.java:145)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$load_libs.invokeStatic(core.clj:6044)
	at clojure.core$load_libs.doInvoke(core.clj:6028)
	at clojure.lang.RestFn.applyTo(RestFn.java:140)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$require.invokeStatic(core.clj:6066)
	at clojure.core$require.doInvoke(core.clj:6066)
	at clojure.lang.RestFn.invoke(RestFn.java:3897)
	at metabase.models.setting$loading__6812__auto____57512.invoke(setting.clj:1)
	at metabase.models.setting__init.load(Unknown Source)
	at metabase.models.setting__init.<clinit>(Unknown Source)
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:398)
	at clojure.lang.RT.classForName(RT.java:2229)
	at clojure.lang.RT.classForName(RT.java:2238)
	at clojure.lang.RT.loadClassForName(RT.java:2257)
	at clojure.lang.RT.load(RT.java:469)
	at clojure.lang.RT.load(RT.java:444)
	at clojure.core$load$fn__6931.invoke(core.clj:6189)
	at clojure.core$load.invokeStatic(core.clj:6188)
	at clojure.core$load.doInvoke(core.clj:6172)
	at clojure.lang.RestFn.invoke(RestFn.java:411)
	at clojure.core$load_one.invokeStatic(core.clj:5961)
	at clojure.core$load_one.invoke(core.clj:5956)
	at clojure.core$load_lib$fn__6873.invoke(core.clj:6003)
	at clojure.core$load_lib.invokeStatic(core.clj:6002)
	at clojure.core$load_lib.doInvoke(core.clj:5981)
	at clojure.lang.RestFn.applyTo(RestFn.java:145)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$load_libs.invokeStatic(core.clj:6044)
	at clojure.core$load_libs.doInvoke(core.clj:6028)
	at clojure.lang.RestFn.applyTo(RestFn.java:140)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$require.invokeStatic(core.clj:6066)
	at clojure.core$require.doInvoke(core.clj:6066)
	at clojure.lang.RestFn.invoke(RestFn.java:933)
	at metabase.analytics.prometheus$loading__6812__auto____64960.invoke(prometheus.clj:1)
	at metabase.analytics.prometheus__init.load(Unknown Source)
	at metabase.analytics.prometheus__init.<clinit>(Unknown Source)
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:398)
	at clojure.lang.RT.classForName(RT.java:2229)
	at clojure.lang.RT.classForName(RT.java:2238)
	at clojure.lang.RT.loadClassForName(RT.java:2257)
	at clojure.lang.RT.load(RT.java:469)
	at clojure.lang.RT.load(RT.java:444)
	at clojure.core$load$fn__6931.invoke(core.clj:6189)
	at clojure.core$load.invokeStatic(core.clj:6188)
	at clojure.core$load.doInvoke(core.clj:6172)
	at clojure.lang.RestFn.invoke(RestFn.java:411)
	at clojure.core$load_one.invokeStatic(core.clj:5961)
	at clojure.core$load_one.invoke(core.clj:5956)
	at clojure.core$load_lib$fn__6873.invoke(core.clj:6003)
	at clojure.core$load_lib.invokeStatic(core.clj:6002)
	at clojure.core$load_lib.doInvoke(core.clj:5981)
	at clojure.lang.RestFn.applyTo(RestFn.java:145)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$load_libs.invokeStatic(core.clj:6044)
	at clojure.core$load_libs.doInvoke(core.clj:6028)
	at clojure.lang.RestFn.applyTo(RestFn.java:140)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$require.invokeStatic(core.clj:6066)
	at clojure.core$require.doInvoke(core.clj:6066)
	at clojure.lang.RestFn.invoke(RestFn.java:3897)
	at metabase.core.core$loading__6812__auto____116547.invoke(core.clj:1)
	at metabase.core.core__init.load(Unknown Source)
	at metabase.core.core__init.<clinit>(Unknown Source)
	at java.base/java.lang.Class.forName0(Native Method)
	at java.base/java.lang.Class.forName(Class.java:398)
	at clojure.lang.RT.classForName(RT.java:2229)
	at clojure.lang.RT.classForName(RT.java:2238)
	at clojure.lang.RT.loadClassForName(RT.java:2257)
	at clojure.lang.RT.load(RT.java:469)
	at clojure.lang.RT.load(RT.java:444)
	at clojure.core$load$fn__6931.invoke(core.clj:6189)
	at clojure.core$load.invokeStatic(core.clj:6188)
	at clojure.core$load.doInvoke(core.clj:6172)
	at clojure.lang.RestFn.invoke(RestFn.java:411)
	at clojure.core$load_one.invokeStatic(core.clj:5961)
	at clojure.core$load_one.invoke(core.clj:5956)
	at clojure.core$load_lib$fn__6873.invoke(core.clj:6003)
	at clojure.core$load_lib.invokeStatic(core.clj:6002)
	at clojure.core$load_lib.doInvoke(core.clj:5981)
	at clojure.lang.RestFn.applyTo(RestFn.java:145)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$load_libs.invokeStatic(core.clj:6044)
	at clojure.core$load_libs.doInvoke(core.clj:6028)
	at clojure.lang.RestFn.applyTo(RestFn.java:140)
	at clojure.core$apply.invokeStatic(core.clj:669)
	at clojure.core$require.invokeStatic(core.clj:6066)
	at clojure.core$require.doInvoke(core.clj:6066)
	at clojure.lang.RestFn.applyTo(RestFn.java:140)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$serialized_require.invokeStatic(core.clj:6142)
	at clojure.core$requiring_resolve.invokeStatic(core.clj:6151)
	at clojure.core$requiring_resolve.invoke(core.clj:6145)
	at metabase.core.bootstrap$_main.invokeStatic(bootstrap.clj:31)
	at metabase.core.bootstrap$_main.doInvoke(bootstrap.clj:28)
	at clojure.lang.RestFn.invoke(RestFn.java:400)
	at clojure.lang.AFn.applyToHelper(AFn.java:152)
	at clojure.lang.RestFn.applyTo(RestFn.java:135)
	at metabase.core.bootstrap.main(Unknown Source)
Caused by: java.lang.ClassNotFoundException: java.util.SequencedCollection
	at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:581)
	at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:178)
	at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:527)
	... 266 more
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""fr"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:134.0) Gecko/20100101 Firefox/134.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""mysql""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-21"",
      ""tag"": ""v0.52.7"",
      ""hash"": ""ddbc480""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MariaDB"",
        ""version"": ""10.3.39-MariaDB-0ubuntu0.20.04.2""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.25+9-post-Ubuntu-1ubuntu120.04"",
    ""java.vendor"": ""Ubuntu"",
    ""java.vendor.url"": ""https://ubuntu.com/"",
    ""java.version"": ""11.0.25"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.25+9-post-Ubuntu-1ubuntu120.04"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.4.0-205-generic"",
    ""user.language"": ""fr"",
    ""user.timezone"": ""Europe/Paris""
  }
}
```

### Severity

Critical, app in unusable

### Additional context

_No response_",marc-dll,2025-01-30 11:13:40+00:00,[],2025-02-04 19:21:20+00:00,2025-02-04 19:21:19+00:00,https://github.com/metabase/metabase/issues/52950,"[('Type:Bug', 'Product defects'), ('.Backend', ''), ('.Team/DevEx', '')]","[{'comment_id': 2624397299, 'issue_id': 2820544684, 'author': 'paoliniluis', 'body': '@marc-dll can you move to Java 21? We were explicit in the docs', 'created_at': datetime.datetime(2025, 1, 30, 12, 38, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2624944354, 'issue_id': 2820544684, 'author': 'marc-dll', 'body': 'Hello @paoliniluis,\n\nThank you for your reply. I assumed versions 11 and 17 were supported based on the following pages, that are still online as of now :\n\nhttps://www.metabase.com/docs/latest/installation-and-operation/running-the-metabase-jar-file\n\n> If Java isn’t installed, you’ll need to install Java before you can run Metabase. We recommend version 21 of JRE from [Eclipse Temurin](https://adoptium.net/) with HotSpot JVM, **but we also support 11 and 17**. You can run Metabase wherever Java 21 runs. The particular processor architecture shouldn’t matter (although we only test Metabase for x86 and ARM).\n\nhttps://www.metabase.com/start/oss/jar\n\n> Metabase requires that you have **Java 11 or higher** available on your system. We have run Metabase with both the OpenJDK and Oracle JDK, so feel free to use either.\n\nSince when is it the case ? The changes in the repo are only 6 days old (https://github.com/metabase/metabase/pull/52620/files) and are not in branch `release-x.52.x` : https://github.com/metabase/metabase/commits/release-x.52.x/docs \n\nI can adapt fine if needed.', 'created_at': datetime.datetime(2025, 1, 30, 16, 16, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2625546343, 'issue_id': 2820544684, 'author': 'paoliniluis', 'body': '@marc-dll did you build this yourself or you downloaded the JAR?', 'created_at': datetime.datetime(2025, 1, 30, 20, 48, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2626600040, 'issue_id': 2820544684, 'author': 'marc-dll', 'body': 'Hello @paoliniluis,\n\nI downloaded the JAR from https://downloads.metabase.com/v0.52.8.x/metabase.jar (link taken from https://github.com/metabase/metabase/releases/tag/v0.52.8)\n\nGreetings', 'created_at': datetime.datetime(2025, 1, 31, 8, 18, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2632377009, 'issue_id': 2820544684, 'author': 'dpsutton', 'body': 'I\'m having trouble recreating\n\n```\n/tmp/java-version-check via ☕ v11.0.25 on ☁️  metabase-query took 10s\n❯ curl -L -o metabase.jar https://downloads.metabase.com/v0.52.8.x/metabase.jar\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100  409M  100  409M    0     0  54.4M      0  0:00:07  0:00:07 --:--:-- 54.9M\n\n/tmp/java-version-check via ☕ v11.0.25 on ☁️  metabase-query took 7s\n❯ java -version\nopenjdk version ""11.0.25"" 2024-10-15\nOpenJDK Runtime Environment Temurin-11.0.25+9 (build 11.0.25+9)\nOpenJDK 64-Bit Server VM Temurin-11.0.25+9 (build 11.0.25+9, mixed mode)\n\n/tmp/java-version-check via ☕ v11.0.25 on ☁️  metabase-query\n❯ MB_JETTY_PORT=3008 java -jar metabase.jar\n2025-02-03 16:59:51,719 INFO metabase.util :: Maximum memory available to JVM: 8.0 GB\n2025-02-03 16:59:53,155 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓\n For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html\n...\n2025-02-03 17:00:06,820 INFO metabase.task :: Task scheduler started\n2025-02-03 17:00:06,826 INFO task.sync-databases :: A trigger for ""Sync and Analyze"" of Database ""Sample Database"" has been enabled with schedule: ""0 43 * * * ? *""\n2025-02-03 17:00:06,829 INFO task.sync-databases :: A trigger for ""Scan Field Values"" of Database ""Sample Database"" has been enabled with schedule: ""0 0 14 * * ? *""\n2025-02-03 17:00:06,831 INFO metabase.core :: Metabase Initialization COMPLETE in 17.6 s\n```\n\nMoreover, from your stacktrace i see\n```\n\tat metabase.core.core$loading__6812__auto____116547.invoke(core.clj:1)\n\tat metabase.core.core__init.load(Unknown Source)\n\tat metabase.core.core__init.<clinit>(Unknown Source)\n```\n\nThis is part of a refactor that is in `master`: https://github.com/metabase/metabase/blob/master/src/metabase/core/core.clj but is not yet in 52: \n\n<img width=""1155"" alt=""Image"" src=""https://github.com/user-attachments/assets/99892495-392e-470a-9910-920515bcf97f"" />', 'created_at': datetime.datetime(2025, 2, 3, 23, 4, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2634865782, 'issue_id': 2820544684, 'author': 'marc-dll', 'body': '@dpsutton Hello,\n\nI tried again and it seems to work fine. I swear I had downloaded the 0.52.8 jar, but I might have messed up somewhere.\n\nSorry about that and thank you for your time.', 'created_at': datetime.datetime(2025, 2, 4, 19, 21, 19, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-30 12:38:59 UTC): @marc-dll can you move to Java 21? We were explicit in the docs

marc-dll (Issue Creator) on (2025-01-30 16:16:56 UTC): Hello @paoliniluis,

Thank you for your reply. I assumed versions 11 and 17 were supported based on the following pages, that are still online as of now :

https://www.metabase.com/docs/latest/installation-and-operation/running-the-metabase-jar-file


https://www.metabase.com/start/oss/jar


Since when is it the case ? The changes in the repo are only 6 days old (https://github.com/metabase/metabase/pull/52620/files) and are not in branch `release-x.52.x` : https://github.com/metabase/metabase/commits/release-x.52.x/docs 

I can adapt fine if needed.

paoliniluis on (2025-01-30 20:48:20 UTC): @marc-dll did you build this yourself or you downloaded the JAR?

marc-dll (Issue Creator) on (2025-01-31 08:18:58 UTC): Hello @paoliniluis,

I downloaded the JAR from https://downloads.metabase.com/v0.52.8.x/metabase.jar (link taken from https://github.com/metabase/metabase/releases/tag/v0.52.8)

Greetings

dpsutton on (2025-02-03 23:04:24 UTC): I'm having trouble recreating

```
/tmp/java-version-check via ☕ v11.0.25 on ☁️  metabase-query took 10s
❯ curl -L -o metabase.jar https://downloads.metabase.com/v0.52.8.x/metabase.jar
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  409M  100  409M    0     0  54.4M      0  0:00:07  0:00:07 --:--:-- 54.9M

/tmp/java-version-check via ☕ v11.0.25 on ☁️  metabase-query took 7s
❯ java -version
openjdk version ""11.0.25"" 2024-10-15
OpenJDK Runtime Environment Temurin-11.0.25+9 (build 11.0.25+9)
OpenJDK 64-Bit Server VM Temurin-11.0.25+9 (build 11.0.25+9, mixed mode)

/tmp/java-version-check via ☕ v11.0.25 on ☁️  metabase-query
❯ MB_JETTY_PORT=3008 java -jar metabase.jar
2025-02-03 16:59:51,719 INFO metabase.util :: Maximum memory available to JVM: 8.0 GB
2025-02-03 16:59:53,155 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓
 For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html
...
2025-02-03 17:00:06,820 INFO metabase.task :: Task scheduler started
2025-02-03 17:00:06,826 INFO task.sync-databases :: A trigger for ""Sync and Analyze"" of Database ""Sample Database"" has been enabled with schedule: ""0 43 * * * ? *""
2025-02-03 17:00:06,829 INFO task.sync-databases :: A trigger for ""Scan Field Values"" of Database ""Sample Database"" has been enabled with schedule: ""0 0 14 * * ? *""
2025-02-03 17:00:06,831 INFO metabase.core :: Metabase Initialization COMPLETE in 17.6 s
```

Moreover, from your stacktrace i see
```
	at metabase.core.core$loading__6812__auto____116547.invoke(core.clj:1)
	at metabase.core.core__init.load(Unknown Source)
	at metabase.core.core__init.<clinit>(Unknown Source)
```

This is part of a refactor that is in `master`: https://github.com/metabase/metabase/blob/master/src/metabase/core/core.clj but is not yet in 52: 

<img width=""1155"" alt=""Image"" src=""https://github.com/user-attachments/assets/99892495-392e-470a-9910-920515bcf97f"" />

marc-dll (Issue Creator) on (2025-02-04 19:21:19 UTC): @dpsutton Hello,

I tried again and it seems to work fine. I swear I had downloaded the 0.52.8 jar, but I might have messed up somewhere.

Sorry about that and thank you for your time.

"
2820274029,issue,open,,Model action is being referred to as native question,"### Describe the bug

While technically correct in a way, it's confusing from user's perspective.

https://github.com/user-attachments/assets/075f6a54-58ec-49a6-8072-ccfaed27fa58

### To Reproduce

1. Enable model actions in Sample DB
2. New > Model > Notebook > Orders > Save
3. Create basic actions in the model
4. New > Dashboard
5. Add text parameter
6. Click text parameter to unselect it
7. Add action button, connect it to ""Create"" action from model created in step 2, map ""Email"" field to ""Text"" parameter and hit ""Done""
8. Resize the action button card so you can see the warning message
9. Click the text parameter

❌ The warning message mentions ""native question variables"" instead of ""action parameters""

### Expected behavior

Vocabulary in the message is relevant to the action card

### Information about your Metabase installation

master, 2d6c18162b58954e57b8ac2ccfb2f45ebb45c2af

### Severity

P3
",kamilmielnik,2025-01-30 09:08:23+00:00,[],2025-02-06 09:57:42+00:00,,https://github.com/metabase/metabase/issues/52945,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/Actions', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2626358227, 'issue_id': 2820274029, 'author': 'WiNloSt', 'body': 'Reproducible on 1.51.13\n\n![Image](https://github.com/user-attachments/assets/a60dc2fc-a7f0-4133-aace-db86880721be)', 'created_at': datetime.datetime(2025, 1, 31, 5, 46, 47, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-31 05:46:47 UTC): Reproducible on 1.51.13

![Image](https://github.com/user-attachments/assets/a60dc2fc-a7f0-4133-aace-db86880721be)

"
2819331595,issue,closed,completed,[Backend modularization] `permissions`,,camsaul,2025-01-29 21:10:43+00:00,['camsaul'],2025-02-07 01:48:03+00:00,2025-02-01 04:14:04+00:00,https://github.com/metabase/metabase/issues/52926,[],[],
2819192899,issue,open,,Trend Line Missing from Line Viz in Slack Alerts,"### Describe the bug

When you add ""trend line"" to a line chart, the line isn't visible when it's delivered to Slack channels.

### To Reproduce

1. Set up a a line chart and enable the ""Trend line""
2. Set up a Slack alert to send it hourly
3. Observe the delivered diagram doesn't have the trend line on it

The trendline is visible on alerts delivered via email.

### Expected behavior

The chart should look the same in the alert as it does in Metabase.

### Logs

025-01-29 14:59:35 2025-01-29 20:59:35,642 INFO sync.analyze :: classify-tables Analyzed [******************************************········] 😊   84% Table 38 ''TEST.TEST_REF_TABLE''
2025-01-29 14:59:35 2025-01-29 20:59:35,642 INFO sync.analyze :: classify-tables Analyzed [***********************************************···] 😍   95% Table 40 ''PUBLIC.products''
2025-01-29 14:59:35 2025-01-29 20:59:35,648 INFO sync.util :: FINISHED: step ''classify-tables'' for snowflake Database 3 ''sf'' (13.5 ms)
2025-01-29 14:59:35 2025-01-29 20:59:35,657 INFO sync.util :: FINISHED: Analyze data for snowflake Database 3 ''sf'' (526.9 ms)
2025-01-29 14:59:42 2025-01-29 20:59:42,752 DEBUG middleware.log :: GET /api/health 200 0ms (0 DB calls) App DB connections: 0/15 Jetty threads: 6/50 (4 idle, 0 queued) (123 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
2025-01-29 15:00:00 2025-01-29 21:00:00,097 INFO notification.send :: [Notification 1] Sending
2025-01-29 15:00:03 2025-01-29 21:00:03,295 INFO notification.send :: [Notification 1] Sending message to channel :channel/slack
2025-01-29 15:00:03 2025-01-29 21:00:03,499 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property azimuth.
2025-01-29 15:00:03 2025-01-29 21:00:03,499 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property speech-rate.
2025-01-29 15:00:03 2025-01-29 21:00:03,499 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property pitch.
2025-01-29 15:00:03 2025-01-29 21:00:03,499 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property cue.
2025-01-29 15:00:03 2025-01-29 21:00:03,499 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property pause-after.
2025-01-29 15:00:03 2025-01-29 21:00:03,499 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property cue-after.
2025-01-29 15:00:03 2025-01-29 21:00:03,499 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property speak.
2025-01-29 15:00:03 2025-01-29 21:00:03,499 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property stress.
2025-01-29 15:00:03 2025-01-29 21:00:03,500 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property speak-header.
2025-01-29 15:00:03 2025-01-29 21:00:03,500 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property pitch-range.
2025-01-29 15:00:03 2025-01-29 21:00:03,500 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property speak-punctuation.
2025-01-29 15:00:03 2025-01-29 21:00:03,500 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property richness.
2025-01-29 15:00:03 2025-01-29 21:00:03,501 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property page-break.
2025-01-29 15:00:03 2025-01-29 21:00:03,501 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property pause.
2025-01-29 15:00:03 2025-01-29 21:00:03,501 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property cue-before.
2025-01-29 15:00:03 2025-01-29 21:00:03,501 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property volume.
2025-01-29 15:00:03 2025-01-29 21:00:03,502 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property speak-numeral.
2025-01-29 15:00:03 2025-01-29 21:00:03,502 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property pause-before.
2025-01-29 15:00:03 2025-01-29 21:00:03,502 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property play-during.
2025-01-29 15:00:03 2025-01-29 21:00:03,502 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property voice-family.
2025-01-29 15:00:03 2025-01-29 21:00:03,502 WARN domassign.DeclarationTransformerImpl :: Unable to find method for property elevation.
2025-01-29 15:00:07 2025-01-29 21:00:07,302 INFO notification.send :: [Notification 1] Sent successfully
2025-01-29 15:00:12 2025-01-29 21:00:12,771 DEBUG middleware.log :: GET /api/health 200 0ms (0 DB calls) App DB connections: 0/15 Jetty threads: 6/50 (4 idle, 0 queued) (124 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
2025-01-29 15:00:42 2025-01-29 21:00:42,794 DEBUG middleware.log :: GET /api/health 200 0ms (0 DB calls) App DB connections: 0/15 Jetty threads: 6/50 (3 idle, 0 queued) (123 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
2025-01-29 15:01:12 2025-01-29 21:01:12,814 DEBUG middleware.log :: GET /api/health 200 0ms (0 DB calls) App DB connections: 0/15 Jetty threads: 6/50 (3 idle, 0 queued) (123 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
2025-01-29 15:01:42 2025-01-29 21:01:42,835 DEBUG middleware.log :: GET /api/health 200 0ms (0 DB calls) App DB connections: 0/15 Jetty threads: 6/50 (2 idle, 0 queued) (122 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
2025-01-29 15:02:12 2025-01-29 21:02:12,859 DEBUG middleware.log :: GET /api/health 200 0ms (0 DB calls) App DB connections: 0/15 Jetty threads: 6/50 (2 idle, 0 queued) (122 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""snowflake"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-21"",
      ""tag"": ""v1.52.7"",
      ""hash"": ""ddbc480""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.1 (Debian 15.1-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.167.4-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

annoying

### Additional context

Most likely `insights` part of the result dataset is not passed to js bundle for question alerts. It works on dashboard subscriptions.",ixipixi,2025-01-29 20:20:39+00:00,[],2025-02-04 20:31:50+00:00,,https://github.com/metabase/metabase/issues/52923,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Backend', ''), ('Notifications/Slack', ''), ('Visualization/Static', 'Subscriptions/pulse generated image'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2818947241,issue,closed,completed,Calendar widget for default filter value is partly hidden behind the scroll,"### Describe the bug

https://github.com/user-attachments/assets/21dcb2fa-d7fc-4300-b681-88b154a260bb

### To Reproduce

1. Go to a dashboard
2. Set up a date filter
3. Try to set the default value
4. Choose ""Specific dates""
5. See the calendar widget partly hidden behind the scroll


### Expected behavior

Calendar widget should be shown fully without the scroll

### Logs

_No response_

### Information about your Metabase installation

```JSON
60b85b6
```

### Severity

Frustrating, inconvenient

### Additional context

_No response_",mngr,2025-01-29 18:33:54+00:00,['ranquild'],2025-01-31 15:02:26+00:00,2025-01-31 15:02:26+00:00,https://github.com/metabase/metabase/issues/52918,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/Querying', '')]",[],
2818910180,issue,open,,Pivot vizualization grant totals is different between FE and csv export,"### Describe the bug

Grant totals is different between FE and csv export for query with limit.

See the attached screenshots of (1) QB, (2) results, (3) csv export, (4) viz settings.

(1):
<img width=""1496"" alt=""Image"" src=""https://github.com/user-attachments/assets/19d25845-5f59-4b28-ad06-0b35e80c7932"" />

(2):
<img width=""1496"" alt=""Image"" src=""https://github.com/user-attachments/assets/749525aa-30f0-422d-8ecb-1b962bc0fc8b"" />

(3):
<img width=""364"" alt=""Image"" src=""https://github.com/user-attachments/assets/ce0166b6-3a7e-4e7d-8f78-24248a867c2a"" />

(4):
<img width=""344"" alt=""Image"" src=""https://github.com/user-attachments/assets/38c3409b-0718-4e4a-8b48-a1f5b0896c87"" />


### To Reproduce

Recreate query as per attached screenshots. Compare csv export's results with FE rendered results.

### Expected behavior

Grand totals should be consistent across FE and exports.

### Logs

_No response_

### Information about your Metabase installation

```JSON
Found on today's master, 4b2db972d722368b8cd1f0f96ebb924451f48c8c.
```

### Severity

P1-ish

### Additional context

_No response_",lbrdnk,2025-01-29 18:14:59+00:00,[],2025-02-04 20:29:43+00:00,,https://github.com/metabase/metabase/issues/52915,"[('Type:Bug', 'Product defects'), ('.Frontend', ''), ('.Backend', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Reporting/Export/Pivot', 'Exporting data as pivoted tables')]",[],
2818693854,issue,open,,Misaligned column labels while editing dashboard visualization options of pivot tables,"### Describe the bug

The measure and grouping column labels become misaligned when dragged while editing the dashboard-specific visualization options of a pivot table.









### To Reproduce

1. Edit a dashboard with a pivot table
2. Bring up visualization options for the pivot
3. Try to drag measures
4. See the metric label is misaligned while being dragged

https://github.com/user-attachments/assets/1b7fc625-ccd9-4bc3-a4e0-dacd254c704b


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
1.52.8
```

### Severity

Annoying, reported by a customer

### Additional context

_No response_",zbodi74,2025-01-29 16:30:20+00:00,['lorem--ipsum'],2025-02-04 20:31:25+00:00,,https://github.com/metabase/metabase/issues/52905,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('Visualization/Chart Settings', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2623626979, 'issue_id': 2818693854, 'author': 'WiNloSt', 'body': 'Reproducible on v1.51.13', 'created_at': datetime.datetime(2025, 1, 30, 6, 31, 49, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-30 06:31:49 UTC): Reproducible on v1.51.13

"
2818290810,issue,open,,Tab-level Permissions,"**Is your feature request related to a problem? Please describe.**
Allow tabs to appear/disappear based on user permissions 

**How important is this feature to you?**
Requested by a user


",psalinasy,2025-01-29 13:53:10+00:00,[],2025-02-04 20:30:47+00:00,,https://github.com/metabase/metabase/issues/52891,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('Administration/Permissions', 'Collection or Data permissions')]",[],
2818277599,issue,open,,Allow for permissions which limit users to their own CSV uploads,"**Is your feature request related to a problem? Please describe.**
Today if you have permissions to upload a CSV file you will have permissions to also see any other uploads that other users might have done. It would be ideal to have a way to only have access to the tables/datasets you have uploaded. 

**Describe the solution you'd like**
Permissions in the uploaded tables. 

**Describe alternatives you've considered**
None. 

**How important is this feature to you?**
Requested by a user

",psalinasy,2025-01-29 13:48:27+00:00,[],2025-02-04 20:30:12+00:00,,https://github.com/metabase/metabase/issues/52890,"[('Type:New Feature', ''), ('Administration/Permissions', 'Collection or Data permissions'), ('Organization/Uploads', 'Direct data upload (CSV)')]",[],
2818204643,issue,open,,[Epic] Simplify data picker for iframe embedding,"### Links

- [product doc](https://www.notion.so/metabase/Simplify-data-picker-for-iframe-embedding-14969354c9018050b611e596733bf104)
- [technical design doc](https://www.notion.so/metabase/Tech-Simplify-data-picker-for-iframe-embedding-17d69354c90180aa8fadfdd88ff2d16a)
- [testing plan](https://www.notion.so/metabase/Testing-plan-Simplify-data-picker-for-iframe-embedding-18269354c90180909dbaf402e118f292?pvs=25)
- feature branch: `52889-simpler-embedding-data-picker`

### Implementation Plan

```[tasklist]
#### Milestone 1: The flattened list
- [ ] Create a pure UI component + storybook
- [ ] [Connect with](https://www.notion.so/metabase/Tech-Simplify-data-picker-for-iframe-embedding-17d69354c90180aa8fadfdd88ff2d16a?pvs=4#18269354c901807e992aeefec4f75f9b) the actual data
- [ ] Add interactive embed tests
- [ ] Add the simple data picker to the SDK
- [ ] Add SDK tests
```

```[tasklist]
#### Milestone 2: UI to support more complex data. Solution still TBD
- [ ] _Add tasks here_
```",WiNloSt,2025-01-29 13:19:59+00:00,[],2025-02-04 20:25:56+00:00,,https://github.com/metabase/metabase/issues/52889,"[('.Epic', 'Feature Implementation or Project'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2818172911,issue,open,,Link visualization tooltip does not render markdown,"### Describe the bug

![Image](https://github.com/user-attachments/assets/d0ab24e2-326f-40c8-af20-9538708c2d36)

### To Reproduce

1. Create a new dashboard and save it
2. Add this description to it:
```md
# Heading 1

Hello world

## Heading 2

![img](https://upload.wikimedia.org/wikipedia/commons/thumb/c/c1/Six_weeks_old_cat_%28aka%29.jpg/640px-Six_weeks_old_cat_%28aka%29.jpg)
 ```
3. Edit dashboard
4. Add a link to this very dashboard
5. Save dashboard
6. Hover the ""i"" icon in the link

❌ Tooltip is shown but markdown syntax is ignored

### Expected behavior

Markdown is rendered in the tooltip

### Information about your Metabase installation

master, a034598d144231befa096575de675d9ff723ae6a

### Severity

P2
",kamilmielnik,2025-01-29 13:08:08+00:00,['alxnddr'],2025-02-04 20:28:43+00:00,,https://github.com/metabase/metabase/issues/52888,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2623623700, 'issue_id': 2818172911, 'author': 'WiNloSt', 'body': 'Reproducible on v1.51.13\n![Image](https://github.com/user-attachments/assets/dc8353d7-bd94-4030-903a-d8ed70dbb90b)', 'created_at': datetime.datetime(2025, 1, 30, 6, 29, 9, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-30 06:29:09 UTC): Reproducible on v1.51.13
![Image](https://github.com/user-attachments/assets/dc8353d7-bd94-4030-903a-d8ed70dbb90b)

"
2818113897,issue,closed,completed,Database name errors are not shown,"### Describe the bug

This happens when adding or editing a database.

### To Reproduce

1. Admin > Databases
2. Add new database (use real parameters) with this name: `aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa`
3. Hit ""Save changes""

❌ API call fails silently, no error is shown

### Expected behavior

API error is shown to the user



### Information about your Metabase installation

master, a034598d144231befa096575de675d9ff723ae6a

### Severity

P3

### Additional context

Similar to #52886",kamilmielnik,2025-01-29 12:44:51+00:00,[],2025-01-29 12:49:10+00:00,2025-01-29 12:48:37+00:00,https://github.com/metabase/metabase/issues/52887,[],"[{'comment_id': 2621550667, 'issue_id': 2818113897, 'author': 'kamilmielnik', 'body': 'Invalid report, apologies 🙏', 'created_at': datetime.datetime(2025, 1, 29, 12, 49, 9, tzinfo=datetime.timezone.utc)}]","kamilmielnik (Issue Creator) on (2025-01-29 12:49:09 UTC): Invalid report, apologies 🙏

"
2817950702,issue,open,,"No error handling when creating, editing, or removing groups","### Describe the bug

API errors are not shown in UI, there is no feedback for the user when it happens.

https://github.com/user-attachments/assets/53e8f798-e3df-48b8-9f8e-54699d37b67b

### To Reproduce

1. Admin > People > Groups
2. Try to create a group with too long name: `aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa`

❌ API call fails silently, no error is shown

----

1. Admin > People > Groups
2. Create a group called ""a""
3. Try to edit this group and use too long name: `aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa`

❌ API call fails silently, no error is shown

----

1. Admin > People > Groups
2. Create a group called ""a""
3. Disable network in developer tools
4. Try to remove that group

❌ API call fails silently, no error is shown


### Expected behavior

API error is shown to the user


### Information about your Metabase installation

master, a034598d144231befa096575de675d9ff723ae6a

### Severity

P2
",kamilmielnik,2025-01-29 11:31:47+00:00,[],2025-02-04 20:24:37+00:00,,https://github.com/metabase/metabase/issues/52886,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Administration/People', 'and Groups. Also user Account Settings'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2817787996,issue,open,,"Allow for filter values to be appended, not only replaced, using using click behavior","I would like to have an option that for a single filter that contains mulitple values click behaviour does not overwrite the old filter value but adds the new input to the filter.

case:

I have a single filter on my dashboard that can hold multiple values
I also have pin map.

What i want is that when I click on a pin, a value from this pin (name of location) is put in my filter. So far so good. However, when i click on another pin, it throws away my original value. but I have a filter that can hold multiple values. I want to click on multiple pins and all values are added to my filter.

So first i click 'location1' and then i click 'location2' on my map , i want my filter to contain both 'location1' and 'location 2' (which works if I type it). but currently it throws away 'location1' and inserts 'location2'

--

This will make it easy for our users to select information from multiple sites. with lots of locations a, drop down is not workable anymore and this would make it very intuïtieve to select infomation based on a location.
",Flashover1234,2025-01-29 10:21:24+00:00,[],2025-02-04 20:30:25+00:00,,https://github.com/metabase/metabase/issues/52882,"[('Type:New Feature', ''), ('Reporting/Dashboards/Click Behavior', ''), ('.Team/Querying', ''), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]",[],
2817588403,issue,closed,completed,Handle legacy secrets double encoded with base64,"### Describe the bug

Opening this issue as a placeholder for this fix

https://github.com/metabase/metabase/pull/52836

### To Reproduce

https://metaboat.slack.com/archives/C010ZSXQY87/p1738061316598399

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
1.52.8
```

### Severity

Blocker

### Additional context

_No response_",Tony-metabase,2025-01-29 08:51:01+00:00,[],2025-01-29 08:51:07+00:00,2025-01-29 08:51:07+00:00,https://github.com/metabase/metabase/issues/52879,"[('Type:Bug', 'Product defects'), ('Database/', ''), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Snowflake', ''), ('Administration/Databases', '')]",[],
2817388276,issue,open,,Long dashboard/question names would hide their menu,"### Describe the bug

When the name is super long (254 chars), the menu would be pushed out of the screen.

![Image](https://github.com/user-attachments/assets/0f08411d-ead0-4f09-bd1b-259813aad749)

![Image](https://github.com/user-attachments/assets/cdd0cbaa-f0e0-4768-ab05-c66284faa559)

### To Reproduce

1. Create a dashboard
2. Set its name to be super long (do that after you have created a dashboard because a dashboard modal only allows 100 characters https://github.com/metabase/metabase/issues/52774)


### Expected behavior

I think we should just fix https://github.com/metabase/metabase/issues/52774. If we capped the name to 100, we won't have this problem.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-27"",
      ""src_hash"": ""052ee3c2dd054cc78a2c25d542482a07bf5647d9"",
      ""tag"": ""v1.53.2-SNAPSHOT"",
      ""hash"": ""3e755ba""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.2+13-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.2"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.2+13-LTS"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""15.2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

annoying

### Additional context

Reproducible in v1.51.13",WiNloSt,2025-01-29 06:49:49+00:00,[],2025-02-04 20:27:27+00:00,,https://github.com/metabase/metabase/issues/52872,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]",[],
2816906766,issue,closed,not_planned,BigQuery backend doesn't work,"**Describe the Bug**
This is my first installation of Metabase using Docker and connection to a BigQuery database. Although indexing appears to complete successfully, any attempt to query the database results in failures.

**Logs**
- **Initialization Error**: `Could not initialize class metabase.driver.bigquery_cloud_sdk`
   - Error details: 
     ```
     java.lang.NoClassDefFoundError: Could not initialize class metabase.driver.bigquery_cloud_sdk$execute_bigquery$fn__133070...
     ```
   - This error suggests a possible issue with the BigQuery SDK initialization in the Metabase setup.

- **Query Preprocessing Error**:
   - Original Error (Czech): `Chyba předzpracování dotazu v clojure.lang.AFunction$1@3d854700: Žádné pole nenalezeno pro tabulku ""MyTable"".`
   - Translated Error: ""Preprocessing query error in clojure.lang.AFunction$1@3d854700: No field found for table \""MyTable\"".""
   - This error occurred when attempting to query the database, indicating a misconfiguration or a bug related to field detection in tables.

**To Reproduce**
Steps to reproduce the behavior:
1. Run Metabase in Docker using the image `metabase/metabase:v0.52.x`.
2. Connect to a BigQuery database by adding it through the Metabase admin interface.
3. Attempt to execute a query against the BigQuery database.

**Expected vs. Actual**
- **Expected**: Queries run successfully with correct returns from the BigQuery database.
- **Actual**: Queries fail with class initialization errors and preprocessing errors indicating missing fields.

**Severity**
While this issue is not severe for my testing purposes, it could be critical for users in a production environment, potentially impacting data-driven decision-making processes.

**Metabase Diagnostic Info**
```json
{
  ""browser-info"": {
    ""language"": ""cs"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64; rv:134.0) Gecko/20100101 Firefox/134.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""version"": {
      ""date"": ""2025-01-28"",
      ""tag"": ""v0.52.8.1"",
      ""hash"": ""344fb8a""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Prague""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.2""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.230-223.885.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```",bambooCZ,2025-01-28 23:20:59+00:00,[],2025-01-30 17:53:45+00:00,2025-01-29 12:16:17+00:00,https://github.com/metabase/metabase/issues/52863,[],"[{'comment_id': 2620281651, 'issue_id': 2816906766, 'author': 'paoliniluis', 'body': 'Has the sync finished? Please force a sync and check the logs. Also post the logs of the sync here', 'created_at': datetime.datetime(2025, 1, 28, 23, 45, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2620302047, 'issue_id': 2816906766, 'author': 'bambooCZ', 'body': ""Sync logs\n```\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T00:59:38+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 0/4 Jetty threads: 3/50 (4 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:00+01:00 INFO metabase.task.truncate-audit-tables Cleaning up query_execution table\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:00+01:00 INFO metabase.task.truncate-audit-tables query_execution cleanup successful, no rows were deleted\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:03+01:00 DEBUG metabase.server.middleware.log GET /api/database/2 200 121ms (1 DB calls) App DB connections: 0/4 Jetty threads: 3/50 (4 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:06+01:00 INFO metabase.events Loading events namespace: metabase.events.alerts-deleted-on-card-save 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:06+01:00 INFO metabase.events Loading events namespace: metabase.events.audit-log 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.driver-notifications 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.last-login 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.notification 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.persisted-info 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.recent-views 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.revision 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.schema 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.slack 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.sync-database 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.view-log 👂\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:08+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 0/4 Jetty threads: 4/50 (3 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:08+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 4ms (0 DB calls) App DB connections: 0/4 Jetty threads: 5/50 (2 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:08+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 2ms (0 DB calls) App DB connections: 0/4 Jetty threads: 6/50 (1 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:08+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 0/4 Jetty threads: 6/50 (1 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:10+01:00 DEBUG metabase.server.middleware.log POST /api/database/2/sync_schema 200 3637ms (1 DB calls) App DB connections: 0/4 Jetty threads: 3/50 (3 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:10+01:00 INFO metabase.sync.util STARTING: Sync metadata for bigquery-cloud-sdk Database 2 ''My BigQuery''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:10+01:00 ERROR metabase.sync.fetch-metadata Error while fetching metdata with 'db-metadata',java.lang.ExceptionInInitializerError,\tat metabase.driver.bigquery_cloud_sdk$execute_bigquery.invokeStatic(bigquery_cloud_sdk.clj:597),\tat metabase.driver.bigquery_cloud_sdk$execute_bigquery.invoke(bigquery_cloud_sdk.clj:588),\tat metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343$thunk__133348.invoke(bigquery_cloud_sdk.clj:632),\tat metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343.invokeStatic(bigquery_cloud_sdk.clj:639),\tat metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343.invoke(bigquery_cloud_sdk.clj:622),\tat metabase.driver.bigquery_cloud_sdk$query_honeysql.invokeStatic(bigquery_cloud_sdk.clj:140),\tat metabase.driver.bigquery_cloud_sdk$query_honeysql.invoke(bigquery_cloud_sdk.clj:133),\tat metabase.driver.bigquery_cloud_sdk$describe_database_tables$iter__132515__132521$fn__132522.invoke(bigquery_cloud_sdk.clj:154),\tat clojure.lang.LazySeq.force(LazySeq.java:50),\tat clojure.lang.LazySeq.realize(LazySeq.java:89),\tat clojure.lang.LazySeq.seq(LazySeq.java:106),\tat clojure.lang.RT.seq(RT.java:555),\tat clojure.core$seq__5486.invokeStatic(core.clj:139),\tat clojure.core$reduce1.invokeStatic(core.clj:932),\tat clojure.core$set.invokeStatic(core.clj:4139),\tat clojure.core$set.invoke(core.clj:4131),\tat metabase.driver.bigquery_cloud_sdk$describe_database_tables.invokeStatic(bigquery_cloud_sdk.clj:151),\tat metabase.driver.bigquery_cloud_sdk$describe_database_tables.invoke(bigquery_cloud_sdk.clj:149),\tat metabase.driver.bigquery_cloud_sdk$fn__132610.invokeStatic(bigquery_cloud_sdk.clj:179)\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:11+01:00 WARN metabase.sync.util Error in sync step Sync metadata for bigquery-cloud-sdk Database 2 ''My BigQuery'',java.lang.ExceptionInInitializerError,\tat metabase.driver.bigquery_cloud_sdk$execute_bigquery.invokeStatic(bigquery_cloud_sdk.clj:597),\tat metabase.driver.bigquery_cloud_sdk$execute_bigquery.invoke(bigquery_cloud_sdk.clj:588),\tat metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343$thunk__133348.invoke(bigquery_cloud_sdk.clj:632),\tat metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343.invokeStatic(bigquery_cloud_sdk.clj:639),\tat metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343.invoke(bigquery_cloud_sdk.clj:622),\tat metabase.driver.bigquery_cloud_sdk$query_honeysql.invokeStatic(bigquery_cloud_sdk.clj:140),\tat metabase.driver.bigquery_cloud_sdk$query_honeysql.invoke(bigquery_cloud_sdk.clj:133),\tat metabase.driver.bigquery_cloud_sdk$describe_database_tables$iter__132515__132521$fn__132522.invoke(bigquery_cloud_sdk.clj:154),\tat clojure.lang.LazySeq.force(LazySeq.java:50),\tat clojure.lang.LazySeq.realize(LazySeq.java:89),\tat clojure.lang.LazySeq.seq(LazySeq.java:106),\tat clojure.lang.RT.seq(RT.java:555),\tat clojure.core$seq__5486.invokeStatic(core.clj:139),\tat clojure.core$reduce1.invokeStatic(core.clj:932),\tat clojure.core$set.invokeStatic(core.clj:4139),\tat clojure.core$set.invoke(core.clj:4131),\tat metabase.driver.bigquery_cloud_sdk$describe_database_tables.invokeStatic(bigquery_cloud_sdk.clj:151),\tat metabase.driver.bigquery_cloud_sdk$describe_database_tables.invoke(bigquery_cloud_sdk.clj:149),\tat metabase.driver.bigquery_cloud_sdk$fn__132610.invokeStatic(bigquery_cloud_sdk.clj:179)\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:11+01:00 INFO metabase.sync.util FINISHED: Sync metadata for bigquery-cloud-sdk Database 2 ''My BigQuery'' (692.2 ms)\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:11+01:00 INFO metabase.sync.util STARTING: Analyze data for bigquery-cloud-sdk Database 2 ''My BigQuery''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:11+01:00 INFO metabase.sync.util STARTING: step ''fingerprint-fields'' for bigquery-cloud-sdk Database 2 ''My BigQuery''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:13+01:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 169ms (1 DB calls) App DB connections: 1/4 Jetty threads: 3/50 (4 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:25+01:00 INFO metabase.sync.analyze fingerprint-fields Analyzed [*****·············································] 😢   10% Table 471 ''analytics_318022985.events_20240712''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:35+01:00 INFO metabase.sync.analyze fingerprint-fields Analyzed [**********········································] 😞   20% Table 1761 ''analytics_186958925.events_20220917''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:38+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 1ms (0 DB calls) App DB connections: 1/4 Jetty threads: 3/50 (4 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:38+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 1/4 Jetty threads: 4/50 (3 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:38+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 1/4 Jetty threads: 5/50 (3 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:42+01:00 INFO metabase.sync.analyze fingerprint-fields Analyzed [***************···································] 😕   30% Table 2905 ''analytics_186958925.events_20240930''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:44+01:00 INFO metabase.sync.util FINISHED: step ''fingerprint-fields'' for bigquery-cloud-sdk Database 2 ''My BigQuery'' (32.8 s)\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:44+01:00 INFO metabase.sync.util STARTING: step ''classify-fields'' for bigquery-cloud-sdk Database 2 ''My BigQuery''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:49+01:00 INFO metabase.sync.analyze classify-fields Analyzed [********************······························] 😐   40% Table 3276 ''analytics_283574372.events_20230310''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:54+01:00 INFO metabase.sync.analyze classify-fields Analyzed [*************************·························] 😬   50% Table 1180 ''RAW_core.AdyenPayout''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:00+01:00 INFO metabase.sync.analyze classify-fields Analyzed [******************************····················] 😌   60% Table 2518 ''analytics_186958925.events_20240226''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:04+01:00 INFO metabase.sync.util FINISHED: step ''classify-fields'' for bigquery-cloud-sdk Database 2 ''My BigQuery'' (20.7 s)\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:04+01:00 INFO metabase.sync.util STARTING: step ''classify-tables'' for bigquery-cloud-sdk Database 2 ''My BigQuery''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:05+01:00 INFO metabase.sync.analyze classify-tables Analyzed [***********************************···············] 😏   70% Table 853 ''analytics_318022985.events_20220923''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:05+01:00 INFO metabase.sync.analyze classify-tables Analyzed [****************************************··········] 😊   80% Table 864 ''analytics_186958925.events_20240511''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:05+01:00 INFO metabase.sync.analyze classify-tables Analyzed [*********************************************·····] 😍   90% Table 2155 ''rep.rpt_jakub_ad_hoc_day''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:05+01:00 INFO metabase.sync.util FINISHED: step ''classify-tables'' for bigquery-cloud-sdk Database 2 ''My BigQuery'' (851.9 ms)\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:05+01:00 INFO metabase.sync.util FINISHED: Analyze data for bigquery-cloud-sdk Database 2 ''My BigQuery'' (54.7 s)\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:08+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 0/4 Jetty threads: 4/50 (3 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n```\nI can see tables in Metabase."", 'created_at': datetime.datetime(2025, 1, 29, 0, 4, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2620306286, 'issue_id': 2816906766, 'author': 'bambooCZ', 'body': ""Fields scan logs\n```\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:10+01:00 DEBUG metabase.server.middleware.log GET /api/database/2 200 9ms (1 DB calls) App DB connections: 0/4 Jetty threads: 3/50 (4 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:12+01:00 INFO metabase.sync.util STARTING: Cache field values in bigquery-cloud-sdk Database 2 ''My BigQuery''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:13+01:00 DEBUG metabase.server.middleware.log POST /api/database/2/rescan_values 200 63ms (2 DB calls) App DB connections: 1/4 Jetty threads: 3/50 (4 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:13+01:00 INFO metabase.sync.util STARTING: step ''delete-expired-advanced-field-values'' for bigquery-cloud-sdk Database 2 ''My BigQuery''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:16+01:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 7ms (1 DB calls) App DB connections: 1/4 Jetty threads: 3/50 (4 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:27+01:00 INFO metabase.sync.util FINISHED: step ''delete-expired-advanced-field-values'' for bigquery-cloud-sdk Database 2 ''My BigQuery'' (14.0 s)\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:27+01:00 INFO metabase.sync.util STARTING: step ''update-field-values'' for bigquery-cloud-sdk Database 2 ''My BigQuery''\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:33+01:00 INFO metabase.sync.util FINISHED: step ''update-field-values'' for bigquery-cloud-sdk Database 2 ''My BigQuery'' (6.4 s)\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:33+01:00 INFO metabase.sync.util FINISHED: Cache field values in bigquery-cloud-sdk Database 2 ''My BigQuery'' (20.5 s)\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:38+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 0/4 Jetty threads: 3/50 (4 idle, 0 queued) (33 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}\n```"", 'created_at': datetime.datetime(2025, 1, 29, 0, 7, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2620392242, 'issue_id': 2816906766, 'author': 'bambooCZ', 'body': 'Full log with the error:\n```\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T02:19:25+01:00 ERROR metabase.models.query.permissions ,clojure.lang.ExceptionInfo: Error calculating permissions for query {:query {:database 2, :type :query, :query {:source-table 1174}}},\tat metabase.models.query.permissions$legacy_mbql_required_perms.invokeStatic(permissions.clj:187),\tat metabase.models.query.permissions$legacy_mbql_required_perms.invoke(permissions.clj:165),\tat metabase.models.query.permissions$required_perms_for_query.invokeStatic(permissions.clj:214),\tat metabase.models.query.permissions$required_perms_for_query.doInvoke(permissions.clj:205),\tat clojure.lang.RestFn.invoke(RestFn.java:413),\tat metabase.models.query.permissions$can_run_query_QMARK_72609__72611.invokeStatic(permissions.clj:318),\tat metabase.models.query.permissions$can_run_query_QMARK_72609__72611.invoke(permissions.clj:314),\tat metabase.models.query.permissions$can_query_table_QMARK_.invokeStatic(permissions.clj:332),\tat metabase.models.query.permissions$can_query_table_QMARK_.invoke(permissions.clj:329),\tat metabase.events.view_log$publish_event_BANG__primary_method_metabase_events_view_log_table_read.invokeStatic(view_log.clj:194),\tat metabase.events.view_log$publish_event_BANG__primary_method_metabase_events_view_log_table_read.invoke(view_log.clj:181),\tat methodical.util.FnWithMeta.invoke(util.clj:46),\tat methodical.impl.combo.operator$invoke_fn$fn__19537.invoke(operator.clj:69),\tat methodical.impl.combo.operator$fn__19558$fn__19559$fn__19560.invoke(operator.clj:112),\tat clojure.core$comp$fn__5895.invoke(core.clj:2587),\tat metabase.events$publish_event_BANG__around_method_default$fn__40782.invoke(events.clj:137),\tat metabase.events$publish_event_BANG__around_method_default.invokeStatic(events.clj:134),\tat metabase.events$publish_event_BANG__around_method_default.invoke(events.clj:113),\tat methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:12)\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T02:19:25+01:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: No fields found for table ""MyTable"".\n{:database_id 2,\n :started_at #t ""2025-01-29T01:19:25.042029998Z[GMT]"",\n :via\n [{:status :failed,\n   :class clojure.lang.ExceptionInfo,\n   :error\n   ""Error preprocessing query in clojure.lang.AFunction$1@748c5e37: No fields found for table \\""MyTable\\""."",\n   :stacktrace\n   [""--> query_processor.preprocess$preprocess74460__74461$fn__74462$fn__74463.invoke(preprocess.clj:178)""\n    ""query_processor.preprocess$preprocess74460__74461$fn__74462.invoke(preprocess.clj:151)""\n    ""query_processor.setup$do_with_qp_setup73968__73969.invokeStatic(setup.clj:225)""\n    ""query_processor.setup$do_with_qp_setup73968__73969.invoke(setup.clj:216)""\n    ""query_processor.preprocess$preprocess74460__74461.invokeStatic(preprocess.clj:149)""\n    ""query_processor.preprocess$preprocess74460__74461.invoke(preprocess.clj:145)""\n    ""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:46)""\n    ""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:44)""\n    ""query_processor.middleware.enterprise$fn__73441$handle_audit_app_internal_queries__73442$fn__73444.invoke(enterprise.clj:96)""\n    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__73452.invoke(enterprise.clj:103)""\n    ""query_processor.middleware.process_userland_query$process_userland_query_middleware78693__78694$fn__78695.invoke(process_userland_query.clj:217)""\n    ""query_processor.middleware.catch_exceptions$catch_exceptions78758__78759$fn__78760.invoke(catch_exceptions.clj:132)""\n    ""query_processor$process_query78799__78800$fn__78801.invoke(query_processor.clj:80)""\n    ""query_processor.setup$do_with_canceled_chan73963__73964$fn__73965.invoke(setup.clj:187)""\n    ""query_processor.setup$do_with_database_local_settings73956__73957$fn__73958.invoke(setup.clj:181)""\n    ""query_processor.setup$do_with_driver73949__73950$fn__73951$fn__73952.invoke(setup.clj:166)""\n    ""driver$do_with_driver.invokeStatic(driver.clj:106)""\n    ""driver$do_with_driver.invoke(driver.clj:101)""\n    ""query_processor.setup$do_with_driver73949__73950$fn__73951.invoke(setup.clj:165)""\n    ""query_processor.setup$do_with_metadata_provider73940__73941$fn__73942$fn__73945.invoke(setup.clj:151)""\n    ""query_processor.store$do_with_metadata_provider59841__59842.invokeStatic(store.clj:170)""\n    ""query_processor.store$do_with_metadata_provider59841__59842.invoke(store.clj:150)""\n    ""query_processor.store$do_with_metadata_provider59841__59842.invokeStatic(store.clj:159)""\n    ""query_processor.store$do_with_metadata_provider59841__59842.invoke(store.clj:150)""\n    ""query_processor.setup$do_with_metadata_provider73940__73941$fn__73942.invoke(setup.clj:150)""\n    ""query_processor.setup$do_with_resolved_database73930__73931$fn__73932.invoke(setup.clj:128)""\n    ""query_processor.setup$do_with_qp_setup73968__73969.invokeStatic(setup.clj:232)""\n    ""query_processor.setup$do_with_qp_setup73968__73969.invoke(setup.clj:216)""\n    ""query_processor$process_query78799__78800.invokeStatic(query_processor.clj:78)""\n    ""query_processor$process_query78799__78800.invoke(query_processor.clj:71)""\n    ""api.dataset$run_streaming_query102407__102410$fn__102414.invoke(dataset.clj:84)""\n    ""query_processor.streaming$_streaming_response$fn__83350$fn__83351$fn__83352.invoke(streaming.clj:185)""\n    ""query_processor.streaming$_streaming_response$fn__83350$fn__83351.invoke(streaming.clj:183)""\n    ""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:174)""\n    ""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:161)""\n    ""query_processor.streaming$_streaming_response$fn__83350.invoke(streaming.clj:180)""\n    ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)""\n    ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:76)""\n    ""async.streaming_response$do_f_async$task__53501.invoke(streaming_response.clj:93)""],\n   :error_type :qp,\n   :ex-data\n   {:fn...\n[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T02:19:25+01:00 DEBUG metabase.server.middleware.log POST /api/dataset 202 [ASYNC: completed] 157ms (18 DB calls) App DB connections: 0/15 Jetty threads: 2/50 (6 idle, 0 queued) (49 total active threads) Queries in flight: 1 (0 queued) {:metabase-user-id 1}\n```\n\nThere are mentioned permissions. The service user has:\n* BigQuery Data Viewer\n* BigQuery Job User\n* BigQuery Metadata Viewer\n\nThe user in Metabase is in the Administrators group.', 'created_at': datetime.datetime(2025, 1, 29, 1, 26, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2621655449, 'issue_id': 2816906766, 'author': 'bambooCZ', 'body': ""For anyone who might be addressing the same issue - it was lack of resources. Metabase crashed when the BigQuery database is added. After restart it doesn't crash, but the scanning process is just unfinished and broken.\n\nWay out of this is to delete the database and add it again. Rescan didn't replicate the crash in my case.\n\nGood luck."", 'created_at': datetime.datetime(2025, 1, 29, 13, 28, 13, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-28 23:45:03 UTC): Has the sync finished? Please force a sync and check the logs. Also post the logs of the sync here

bambooCZ (Issue Creator) on (2025-01-29 00:04:02 UTC): Sync logs
```
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T00:59:38+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 0/4 Jetty threads: 3/50 (4 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:00+01:00 INFO metabase.task.truncate-audit-tables Cleaning up query_execution table
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:00+01:00 INFO metabase.task.truncate-audit-tables query_execution cleanup successful, no rows were deleted
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:03+01:00 DEBUG metabase.server.middleware.log GET /api/database/2 200 121ms (1 DB calls) App DB connections: 0/4 Jetty threads: 3/50 (4 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:06+01:00 INFO metabase.events Loading events namespace: metabase.events.alerts-deleted-on-card-save 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:06+01:00 INFO metabase.events Loading events namespace: metabase.events.audit-log 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.driver-notifications 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.last-login 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.notification 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.persisted-info 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.recent-views 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.revision 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.schema 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.slack 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.sync-database 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:07+01:00 INFO metabase.events Loading events namespace: metabase.events.view-log 👂
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:08+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 0/4 Jetty threads: 4/50 (3 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:08+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 4ms (0 DB calls) App DB connections: 0/4 Jetty threads: 5/50 (2 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:08+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 2ms (0 DB calls) App DB connections: 0/4 Jetty threads: 6/50 (1 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:08+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 0/4 Jetty threads: 6/50 (1 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:10+01:00 DEBUG metabase.server.middleware.log POST /api/database/2/sync_schema 200 3637ms (1 DB calls) App DB connections: 0/4 Jetty threads: 3/50 (3 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:10+01:00 INFO metabase.sync.util STARTING: Sync metadata for bigquery-cloud-sdk Database 2 ''My BigQuery''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:10+01:00 ERROR metabase.sync.fetch-metadata Error while fetching metdata with 'db-metadata',java.lang.ExceptionInInitializerError,	at metabase.driver.bigquery_cloud_sdk$execute_bigquery.invokeStatic(bigquery_cloud_sdk.clj:597),	at metabase.driver.bigquery_cloud_sdk$execute_bigquery.invoke(bigquery_cloud_sdk.clj:588),	at metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343$thunk__133348.invoke(bigquery_cloud_sdk.clj:632),	at metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343.invokeStatic(bigquery_cloud_sdk.clj:639),	at metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343.invoke(bigquery_cloud_sdk.clj:622),	at metabase.driver.bigquery_cloud_sdk$query_honeysql.invokeStatic(bigquery_cloud_sdk.clj:140),	at metabase.driver.bigquery_cloud_sdk$query_honeysql.invoke(bigquery_cloud_sdk.clj:133),	at metabase.driver.bigquery_cloud_sdk$describe_database_tables$iter__132515__132521$fn__132522.invoke(bigquery_cloud_sdk.clj:154),	at clojure.lang.LazySeq.force(LazySeq.java:50),	at clojure.lang.LazySeq.realize(LazySeq.java:89),	at clojure.lang.LazySeq.seq(LazySeq.java:106),	at clojure.lang.RT.seq(RT.java:555),	at clojure.core$seq__5486.invokeStatic(core.clj:139),	at clojure.core$reduce1.invokeStatic(core.clj:932),	at clojure.core$set.invokeStatic(core.clj:4139),	at clojure.core$set.invoke(core.clj:4131),	at metabase.driver.bigquery_cloud_sdk$describe_database_tables.invokeStatic(bigquery_cloud_sdk.clj:151),	at metabase.driver.bigquery_cloud_sdk$describe_database_tables.invoke(bigquery_cloud_sdk.clj:149),	at metabase.driver.bigquery_cloud_sdk$fn__132610.invokeStatic(bigquery_cloud_sdk.clj:179)
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:11+01:00 WARN metabase.sync.util Error in sync step Sync metadata for bigquery-cloud-sdk Database 2 ''My BigQuery'',java.lang.ExceptionInInitializerError,	at metabase.driver.bigquery_cloud_sdk$execute_bigquery.invokeStatic(bigquery_cloud_sdk.clj:597),	at metabase.driver.bigquery_cloud_sdk$execute_bigquery.invoke(bigquery_cloud_sdk.clj:588),	at metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343$thunk__133348.invoke(bigquery_cloud_sdk.clj:632),	at metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343.invokeStatic(bigquery_cloud_sdk.clj:639),	at metabase.driver.bigquery_cloud_sdk$_STAR_process_native_STAR_133332__133343.invoke(bigquery_cloud_sdk.clj:622),	at metabase.driver.bigquery_cloud_sdk$query_honeysql.invokeStatic(bigquery_cloud_sdk.clj:140),	at metabase.driver.bigquery_cloud_sdk$query_honeysql.invoke(bigquery_cloud_sdk.clj:133),	at metabase.driver.bigquery_cloud_sdk$describe_database_tables$iter__132515__132521$fn__132522.invoke(bigquery_cloud_sdk.clj:154),	at clojure.lang.LazySeq.force(LazySeq.java:50),	at clojure.lang.LazySeq.realize(LazySeq.java:89),	at clojure.lang.LazySeq.seq(LazySeq.java:106),	at clojure.lang.RT.seq(RT.java:555),	at clojure.core$seq__5486.invokeStatic(core.clj:139),	at clojure.core$reduce1.invokeStatic(core.clj:932),	at clojure.core$set.invokeStatic(core.clj:4139),	at clojure.core$set.invoke(core.clj:4131),	at metabase.driver.bigquery_cloud_sdk$describe_database_tables.invokeStatic(bigquery_cloud_sdk.clj:151),	at metabase.driver.bigquery_cloud_sdk$describe_database_tables.invoke(bigquery_cloud_sdk.clj:149),	at metabase.driver.bigquery_cloud_sdk$fn__132610.invokeStatic(bigquery_cloud_sdk.clj:179)
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:11+01:00 INFO metabase.sync.util FINISHED: Sync metadata for bigquery-cloud-sdk Database 2 ''My BigQuery'' (692.2 ms)
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:11+01:00 INFO metabase.sync.util STARTING: Analyze data for bigquery-cloud-sdk Database 2 ''My BigQuery''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:11+01:00 INFO metabase.sync.util STARTING: step ''fingerprint-fields'' for bigquery-cloud-sdk Database 2 ''My BigQuery''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:13+01:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 169ms (1 DB calls) App DB connections: 1/4 Jetty threads: 3/50 (4 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:25+01:00 INFO metabase.sync.analyze fingerprint-fields Analyzed [*****·············································] 😢   10% Table 471 ''analytics_318022985.events_20240712''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:35+01:00 INFO metabase.sync.analyze fingerprint-fields Analyzed [**********········································] 😞   20% Table 1761 ''analytics_186958925.events_20220917''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:38+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 1ms (0 DB calls) App DB connections: 1/4 Jetty threads: 3/50 (4 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:38+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 1/4 Jetty threads: 4/50 (3 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:38+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 1/4 Jetty threads: 5/50 (3 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:42+01:00 INFO metabase.sync.analyze fingerprint-fields Analyzed [***************···································] 😕   30% Table 2905 ''analytics_186958925.events_20240930''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:44+01:00 INFO metabase.sync.util FINISHED: step ''fingerprint-fields'' for bigquery-cloud-sdk Database 2 ''My BigQuery'' (32.8 s)
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:44+01:00 INFO metabase.sync.util STARTING: step ''classify-fields'' for bigquery-cloud-sdk Database 2 ''My BigQuery''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:49+01:00 INFO metabase.sync.analyze classify-fields Analyzed [********************······························] 😐   40% Table 3276 ''analytics_283574372.events_20230310''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:00:54+01:00 INFO metabase.sync.analyze classify-fields Analyzed [*************************·························] 😬   50% Table 1180 ''RAW_core.AdyenPayout''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:00+01:00 INFO metabase.sync.analyze classify-fields Analyzed [******************************····················] 😌   60% Table 2518 ''analytics_186958925.events_20240226''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:04+01:00 INFO metabase.sync.util FINISHED: step ''classify-fields'' for bigquery-cloud-sdk Database 2 ''My BigQuery'' (20.7 s)
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:04+01:00 INFO metabase.sync.util STARTING: step ''classify-tables'' for bigquery-cloud-sdk Database 2 ''My BigQuery''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:05+01:00 INFO metabase.sync.analyze classify-tables Analyzed [***********************************···············] 😏   70% Table 853 ''analytics_318022985.events_20220923''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:05+01:00 INFO metabase.sync.analyze classify-tables Analyzed [****************************************··········] 😊   80% Table 864 ''analytics_186958925.events_20240511''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:05+01:00 INFO metabase.sync.analyze classify-tables Analyzed [*********************************************·····] 😍   90% Table 2155 ''rep.rpt_jakub_ad_hoc_day''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:05+01:00 INFO metabase.sync.util FINISHED: step ''classify-tables'' for bigquery-cloud-sdk Database 2 ''My BigQuery'' (851.9 ms)
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:05+01:00 INFO metabase.sync.util FINISHED: Analyze data for bigquery-cloud-sdk Database 2 ''My BigQuery'' (54.7 s)
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:01:08+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 0/4 Jetty threads: 4/50 (3 idle, 0 queued) (34 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
```
I can see tables in Metabase.

bambooCZ (Issue Creator) on (2025-01-29 00:07:41 UTC): Fields scan logs
```
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:10+01:00 DEBUG metabase.server.middleware.log GET /api/database/2 200 9ms (1 DB calls) App DB connections: 0/4 Jetty threads: 3/50 (4 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:12+01:00 INFO metabase.sync.util STARTING: Cache field values in bigquery-cloud-sdk Database 2 ''My BigQuery''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:13+01:00 DEBUG metabase.server.middleware.log POST /api/database/2/rescan_values 200 63ms (2 DB calls) App DB connections: 1/4 Jetty threads: 3/50 (4 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:13+01:00 INFO metabase.sync.util STARTING: step ''delete-expired-advanced-field-values'' for bigquery-cloud-sdk Database 2 ''My BigQuery''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:16+01:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 7ms (1 DB calls) App DB connections: 1/4 Jetty threads: 3/50 (4 idle, 0 queued) (32 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:27+01:00 INFO metabase.sync.util FINISHED: step ''delete-expired-advanced-field-values'' for bigquery-cloud-sdk Database 2 ''My BigQuery'' (14.0 s)
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:27+01:00 INFO metabase.sync.util STARTING: step ''update-field-values'' for bigquery-cloud-sdk Database 2 ''My BigQuery''
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:33+01:00 INFO metabase.sync.util FINISHED: step ''update-field-values'' for bigquery-cloud-sdk Database 2 ''My BigQuery'' (6.4 s)
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:33+01:00 INFO metabase.sync.util FINISHED: Cache field values in bigquery-cloud-sdk Database 2 ''My BigQuery'' (20.5 s)
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T01:06:38+01:00 DEBUG metabase.server.middleware.log GET /api/health 200 0ms (0 DB calls) App DB connections: 0/4 Jetty threads: 3/50 (4 idle, 0 queued) (33 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
```

bambooCZ (Issue Creator) on (2025-01-29 01:26:28 UTC): Full log with the error:
```
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T02:19:25+01:00 ERROR metabase.models.query.permissions ,clojure.lang.ExceptionInfo: Error calculating permissions for query {:query {:database 2, :type :query, :query {:source-table 1174}}},	at metabase.models.query.permissions$legacy_mbql_required_perms.invokeStatic(permissions.clj:187),	at metabase.models.query.permissions$legacy_mbql_required_perms.invoke(permissions.clj:165),	at metabase.models.query.permissions$required_perms_for_query.invokeStatic(permissions.clj:214),	at metabase.models.query.permissions$required_perms_for_query.doInvoke(permissions.clj:205),	at clojure.lang.RestFn.invoke(RestFn.java:413),	at metabase.models.query.permissions$can_run_query_QMARK_72609__72611.invokeStatic(permissions.clj:318),	at metabase.models.query.permissions$can_run_query_QMARK_72609__72611.invoke(permissions.clj:314),	at metabase.models.query.permissions$can_query_table_QMARK_.invokeStatic(permissions.clj:332),	at metabase.models.query.permissions$can_query_table_QMARK_.invoke(permissions.clj:329),	at metabase.events.view_log$publish_event_BANG__primary_method_metabase_events_view_log_table_read.invokeStatic(view_log.clj:194),	at metabase.events.view_log$publish_event_BANG__primary_method_metabase_events_view_log_table_read.invoke(view_log.clj:181),	at methodical.util.FnWithMeta.invoke(util.clj:46),	at methodical.impl.combo.operator$invoke_fn$fn__19537.invoke(operator.clj:69),	at methodical.impl.combo.operator$fn__19558$fn__19559$fn__19560.invoke(operator.clj:112),	at clojure.core$comp$fn__5895.invoke(core.clj:2587),	at metabase.events$publish_event_BANG__around_method_default$fn__40782.invoke(events.clj:137),	at metabase.events$publish_event_BANG__around_method_default.invokeStatic(events.clj:134),	at metabase.events$publish_event_BANG__around_method_default.invoke(events.clj:113),	at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:12)
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T02:19:25+01:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: No fields found for table ""MyTable"".
{:database_id 2,
 :started_at #t ""2025-01-29T01:19:25.042029998Z[GMT]"",
 :via
 [{:status :failed,
   :class clojure.lang.ExceptionInfo,
   :error
   ""Error preprocessing query in clojure.lang.AFunction$1@748c5e37: No fields found for table \""MyTable\""."",
   :stacktrace
   [""--> query_processor.preprocess$preprocess74460__74461$fn__74462$fn__74463.invoke(preprocess.clj:178)""
    ""query_processor.preprocess$preprocess74460__74461$fn__74462.invoke(preprocess.clj:151)""
    ""query_processor.setup$do_with_qp_setup73968__73969.invokeStatic(setup.clj:225)""
    ""query_processor.setup$do_with_qp_setup73968__73969.invoke(setup.clj:216)""
    ""query_processor.preprocess$preprocess74460__74461.invokeStatic(preprocess.clj:149)""
    ""query_processor.preprocess$preprocess74460__74461.invoke(preprocess.clj:145)""
    ""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:46)""
    ""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:44)""
    ""query_processor.middleware.enterprise$fn__73441$handle_audit_app_internal_queries__73442$fn__73444.invoke(enterprise.clj:96)""
    ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__73452.invoke(enterprise.clj:103)""
    ""query_processor.middleware.process_userland_query$process_userland_query_middleware78693__78694$fn__78695.invoke(process_userland_query.clj:217)""
    ""query_processor.middleware.catch_exceptions$catch_exceptions78758__78759$fn__78760.invoke(catch_exceptions.clj:132)""
    ""query_processor$process_query78799__78800$fn__78801.invoke(query_processor.clj:80)""
    ""query_processor.setup$do_with_canceled_chan73963__73964$fn__73965.invoke(setup.clj:187)""
    ""query_processor.setup$do_with_database_local_settings73956__73957$fn__73958.invoke(setup.clj:181)""
    ""query_processor.setup$do_with_driver73949__73950$fn__73951$fn__73952.invoke(setup.clj:166)""
    ""driver$do_with_driver.invokeStatic(driver.clj:106)""
    ""driver$do_with_driver.invoke(driver.clj:101)""
    ""query_processor.setup$do_with_driver73949__73950$fn__73951.invoke(setup.clj:165)""
    ""query_processor.setup$do_with_metadata_provider73940__73941$fn__73942$fn__73945.invoke(setup.clj:151)""
    ""query_processor.store$do_with_metadata_provider59841__59842.invokeStatic(store.clj:170)""
    ""query_processor.store$do_with_metadata_provider59841__59842.invoke(store.clj:150)""
    ""query_processor.store$do_with_metadata_provider59841__59842.invokeStatic(store.clj:159)""
    ""query_processor.store$do_with_metadata_provider59841__59842.invoke(store.clj:150)""
    ""query_processor.setup$do_with_metadata_provider73940__73941$fn__73942.invoke(setup.clj:150)""
    ""query_processor.setup$do_with_resolved_database73930__73931$fn__73932.invoke(setup.clj:128)""
    ""query_processor.setup$do_with_qp_setup73968__73969.invokeStatic(setup.clj:232)""
    ""query_processor.setup$do_with_qp_setup73968__73969.invoke(setup.clj:216)""
    ""query_processor$process_query78799__78800.invokeStatic(query_processor.clj:78)""
    ""query_processor$process_query78799__78800.invoke(query_processor.clj:71)""
    ""api.dataset$run_streaming_query102407__102410$fn__102414.invoke(dataset.clj:84)""
    ""query_processor.streaming$_streaming_response$fn__83350$fn__83351$fn__83352.invoke(streaming.clj:185)""
    ""query_processor.streaming$_streaming_response$fn__83350$fn__83351.invoke(streaming.clj:183)""
    ""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:174)""
    ""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:161)""
    ""query_processor.streaming$_streaming_response$fn__83350.invoke(streaming.clj:180)""
    ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)""
    ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:76)""
    ""async.streaming_response$do_f_async$task__53501.invoke(streaming_response.clj:93)""],
   :error_type :qp,
   :ex-data
   {:fn...
[311164d4-dfe3-445b-b8b6-1ec51c618f73] 2025-01-29T02:19:25+01:00 DEBUG metabase.server.middleware.log POST /api/dataset 202 [ASYNC: completed] 157ms (18 DB calls) App DB connections: 0/15 Jetty threads: 2/50 (6 idle, 0 queued) (49 total active threads) Queries in flight: 1 (0 queued) {:metabase-user-id 1}
```

There are mentioned permissions. The service user has:
* BigQuery Data Viewer
* BigQuery Job User
* BigQuery Metadata Viewer

The user in Metabase is in the Administrators group.

bambooCZ (Issue Creator) on (2025-01-29 13:28:13 UTC): For anyone who might be addressing the same issue - it was lack of resources. Metabase crashed when the BigQuery database is added. After restart it doesn't crash, but the scanning process is just unfinished and broken.

Way out of this is to delete the database and add it again. Rescan didn't replicate the crash in my case.

Good luck.

"
2816837112,issue,open,,Binned Data does not get passed to between filter,"### Describe the bug

I have a dashboard with a question where a column is a score between 1 and 100, and I bin the items into groups.
I want to set it up so that when I click on a bar it will go to a different page in the dashboard to show all items in that bin.
So if i click on 95-100 i now see the items filtered with score between 95 and 100.

right now if i set up a between filter on that page of the dashboard only the value 95 is sent and the second part of the filter stays empty.

![Image](https://github.com/user-attachments/assets/cbc86e70-c105-48a0-a7ba-048f29f0eaa2)

### To Reproduce

1. create date with the following columns (name [text field] and score [number 1-100])
3. create a question that is a bar chart with binned data (say 1-25, 25-100)
4. add to a dashboard and create a second page with the original data set
5. add a between filter to the second page on the score column
6. add a click action on the first (binned) question to set the between filter


### Expected behavior

if i click on bin 1-25, 
I should go to the next page and see the between filter set as 1-25. What  i see is just the lower bound set to 1

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-21"",
      ""tag"": ""v0.52.7"",
      ""hash"": ""ddbc480""
    },
    ""settings"": {
      ""report-timezone"": ""America/Los_Angeles""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.3""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.102-108.177.amzn2023.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

blocking some user

### Additional context

_No response_",mnetkin,2025-01-28 22:26:03+00:00,[],2025-02-04 20:29:46+00:00,,https://github.com/metabase/metabase/issues/52861,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]","[{'comment_id': 2620868850, 'issue_id': 2816837112, 'author': 'WiNloSt', 'body': 'Reproducible on v1.51.13.\n\nThe essence of the issue is that click behavior mapped to a between filter only updates the `from` value, but not `to` value e.g. between A and B. When clicking the binned column (1-25), the between filter is updated to between 1 and null.', 'created_at': datetime.datetime(2025, 1, 29, 7, 13, 6, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-29 07:13:06 UTC): Reproducible on v1.51.13.

The essence of the issue is that click behavior mapped to a between filter only updates the `from` value, but not `to` value e.g. between A and B. When clicking the binned column (1-25), the between filter is updated to between 1 and null.

"
2816672070,issue,open,,Bump `com.ibm.icu/icu4j` version,"Metabase tests are failing with new ICU versions, so we're pinned on `71.1`.

We previously had this only as a transitive dep, but as of c09ff48c6c075be9249a189be4f4256ac803c570 it's pinned, because there are [test failures](https://github.com/metabase/metabase/actions/runs/12926546646/job/36049844305?pr=52581).

Assigning this to the DashViz BE team since it's apparently a static viz issue.",bshepherdson,2025-01-28 20:39:33+00:00,[],2025-02-04 20:31:57+00:00,,https://github.com/metabase/metabase/issues/52851,"[('.Backend', ''), ('Visualization/Static', 'Subscriptions/pulse generated image'), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2816388701,issue,closed,completed,Start of 54 Cycle Routine Clojure Dependency Bump,"[Notion doc about dependency bumping](https://www.notion.so/metabase/Dependency-Bumping-8ab452bbfc1f4131addd1653235c1b0f?pvs=4)

Subtasks:

- [ ] Update all minor and patch versions and test. Revert breakage.
- [ ] Update minor versions in modules
- [ ] Anything else, TBD",bshepherdson,2025-01-28 18:02:11+00:00,['bshepherdson'],2025-02-03 15:26:29+00:00,2025-02-03 15:26:29+00:00,https://github.com/metabase/metabase/issues/52843,"[('Type:Tech Debt', 'or Refactoring'), ('.Backend', ''), (':broom:', 'no-brainer cleanup issues to clear out when you have an hour left until EoD or something')]","[{'comment_id': 2619860201, 'issue_id': 2816388701, 'author': 'bshepherdson', 'body': '```\n| :file                                       | :name                                               | :current      | :latest              |                                                                                     \n|---------------------------------------------+-----------------------------------------------------+---------------+----------------------|                                                                                     \n| deps.edn                                    | babashka/fs                                         | 0.5.22        | 0.5.24               |                                                                                     \n|                                             | ch.qos.logback/logback-classic                      | 1.5.12        | 1.5.16               |                                                                                     \n|                                             | cider/cider-nrepl                                   | 0.50.2        | 0.52.0               |                                                                                     \n|                                             | cider/piggieback                                    | 0.5.3         | 0.6.0                |                                                                                     \n|                                             | clj-kondo/clj-kondo                                 | 2024.11.14    | 2025.01.16           |                                                                                     \n|                                             | clj-kondo/clj-kondo                                 | 2024.11.14    | 2025.01.16           |                                                                                     \n|                                             | com.github.seancorfield/next.jdbc                   | 1.3.955       | 1.3.981              |                                                                                     \n|                                             | com.google.guava/guava                              | 33.3.1-jre    | 33.4.0-jre           |                                                                                     \n|                                             | com.ibm.icu/icu4j                                   | 71.1          | 76.1                 |                                                                                     \n|                                             | commons-codec/commons-codec                         | 1.17.1        | 1.18.0               |                                                                                     \n|                                             | djblue/portal                                       | 0.58.3        | 0.58.5               |                                                                                     \n|                                             | dk.ative/docjure                                    | 1.19.0        | 1.21.0               |                                                                                     \n|                                             | net.thisptr/jackson-jq                              | 1.1.0         | 1.2.0                |                                                                                     \n|                                             | nrepl/nrepl                                         | 1.3.0         | 1.3.1                |                                                                                     \n|                                             | org.apache.logging.log4j/log4j-1.2-api              | 2.24.2        | 2.24.3               |                                                                                     \n|                                             | org.apache.logging.log4j/log4j-api                  | 2.24.2        | 2.24.3               |                                                                                     \n|                                             | org.apache.logging.log4j/log4j-core                 | 2.24.2        | 2.24.3               |                                                                                     \n|                                             | org.apache.logging.log4j/log4j-jcl                  | 2.24.2        | 2.24.3               |                                                                                     \n|                                             | org.apache.logging.log4j/log4j-jul                  | 2.24.2        | 2.24.3               |                                                                                     \n|                                             | org.apache.logging.log4j/log4j-layout-template-json | 2.24.2        | 2.24.3               |                                                                                     \n|                                             | org.apache.logging.log4j/log4j-slf4j2-impl          | 2.24.2        | 2.24.3               |                                                                                     \n|                                             | org.apache.poi/poi                                  | 5.3.0         | 5.4.0                |                                                                                     \n|                                             | org.apache.poi/poi-ooxml                            | 5.3.0         | 5.4.0                |                                                                                     \n|                                             | org.apache.poi/poi-ooxml-full                       | 5.3.0         | 5.4.0                |                                                                                     \n|                                             | org.bouncycastle/bcpkix-jdk18on                     | 1.79          | 1.80                 |                                                                                     \n|                                             | org.bouncycastle/bcprov-jdk18on                     | 1.79          | 1.80                 |                                                                                     \n|                                             | org.clojure/core.async                              | 1.6.681       | 1.7.701              |                                                                                     \n|                                             | org.jsoup/jsoup                                     | 1.18.2        | 1.18.3               |                                                                                     \n|                                             | org.postgresql/postgresql                           | 42.7.4        | 42.7.5               |                                                                                     \n| modules/drivers/bigquery-cloud-sdk/deps.edn | com.google.cloud/google-cloud-bigquery              | 2.44.0        | 2.46.0               |                                                                                     \n|                                             | io.netty/netty-buffer                               | 4.1.115.Final | 4.1.117.Final        |                                                                                     \n|                                             | io.netty/netty-common                               | 4.1.115.Final | 4.1.117.Final        |                                                                                     \n| modules/drivers/mongo/deps.edn              | com.google.guava/guava                              | 33.3.1-jre    | 33.4.0-jre           |                                                                                     \n|                                             | org.mongodb/mongodb-driver-sync                     | 5.2.1         | 5.3.1                |                                                                                     \n| modules/drivers/oracle/deps.edn             | com.oracle.database.jdbc/ojdbc11                    | 23.5.0.24.07  | 23.6.0.24.10         |                                                                                     \n| modules/drivers/presto-jdbc/deps.edn        | com.facebook.presto/presto-jdbc                     | 0.289         | 0.290                |                                                                                     \n| modules/drivers/redshift/deps.edn           | com.amazon.redshift/redshift-jdbc42                 | 2.1.0.30      | 2.1.0.32             |                                                                                     \n| modules/drivers/snowflake/deps.edn          | net.snowflake/snowflake-jdbc                        | 3.20.0        | 3.21.0               |                                                                                     \n| modules/drivers/sqlite/deps.edn             | org.xerial/sqlite-jdbc                              | 3.47.1.0      | 3.48.0.0             |                                                                                     \n| modules/drivers/sqlserver/deps.edn          | com.microsoft.sqlserver/mssql-jdbc                  | 12.8.1.jre11  | 12.9.0.jre11-preview |                                                                                     \n```', 'created_at': datetime.datetime(2025, 1, 28, 19, 16, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2619877212, 'issue_id': 2816388701, 'author': 'bshepherdson', 'body': ""Most of these are minor or micro version bumps, so hopefully little impact on us.\n\nA few notable upgrades:\n- `next.jdbc` 1.3.967 includes a few changes that might impact us, but may be fine:\n    - Strengthens `assert`s to throwing `IllegalArgumentException`s\n    - Relaxing some conditions around nested transactions.\n- We don't actually want a preview version of `mssql-jdbc`; I'll leave it on `12.8.1.jre11` (the latest non-preview version).\n- `core.async` update is an overhead optimization, low impact."", 'created_at': datetime.datetime(2025, 1, 28, 19, 25, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2620018233, 'issue_id': 2816388701, 'author': 'bshepherdson', 'body': '- `icu4j` is pinned to `71.1` because upgrading breaks some static viz tests; see #52851.', 'created_at': datetime.datetime(2025, 1, 28, 20, 43, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2620284099, 'issue_id': 2816388701, 'author': 'paoliniluis', 'body': 'We need to add to this table:\n- jetty to version 12\n- make the new cssbox to work with our subscriptions\n- mariadb driver to version 3 and ensure compatibility with MySQL', 'created_at': datetime.datetime(2025, 1, 28, 23, 47, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2622055823, 'issue_id': 2816388701, 'author': 'bshepherdson', 'body': 'Where is this coming from? This isn\'t a general ""libraries we should update"" issue, it\'s the basic bump of deps that don\'t cause serious issues. If we want to get unpinned from Jetty 11, that\'s a separate issue and separate PR. Likewise for the other two points.', 'created_at': datetime.datetime(2025, 1, 29, 16, 2, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2622072630, 'issue_id': 2816388701, 'author': 'bshepherdson', 'body': ""I'm reverting `clj-kondo` back to `2024.11.14`. The new version causes issues by breaking the way some of the `macros` overrides tell it to ignore `:unused-binding` errors. Cam filed [an issue](https://github.com/clj-kondo/clj-kondo/issues/2469) to figure out the Right Way to handle that, and we need to wait for that to land in Toucan and a few other upstream libs first."", 'created_at': datetime.datetime(2025, 1, 29, 16, 8, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2624198330, 'issue_id': 2816388701, 'author': 'piranha', 'body': '@bshepherdson jetty 11 is pinned just because of Java bytecode version issues, no other reasons :)', 'created_at': datetime.datetime(2025, 1, 30, 11, 12, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2631281184, 'issue_id': 2816388701, 'author': 'bshepherdson', 'body': 'I had to add an explicit dep on `aws-java-sdk-core` in the Redshift driver.\n\nThis is listed as an optional dep, but it seems that at least one class from it (`com.amazonaws.util.StringUtils`) is now dynamically required by our driver - tests were throwing `NoClassDefFoundError`s without it.\n\nRedshift tests are passing locally with this dependency added.', 'created_at': datetime.datetime(2025, 2, 3, 15, 10, 48, tzinfo=datetime.timezone.utc)}]","bshepherdson (Issue Creator) on (2025-01-28 19:16:25 UTC): ```
| :file                                       | :name                                               | :current      | :latest              |                                                                                     
|---------------------------------------------+-----------------------------------------------------+---------------+----------------------|                                                                                     
| deps.edn                                    | babashka/fs                                         | 0.5.22        | 0.5.24               |                                                                                     
|                                             | ch.qos.logback/logback-classic                      | 1.5.12        | 1.5.16               |                                                                                     
|                                             | cider/cider-nrepl                                   | 0.50.2        | 0.52.0               |                                                                                     
|                                             | cider/piggieback                                    | 0.5.3         | 0.6.0                |                                                                                     
|                                             | clj-kondo/clj-kondo                                 | 2024.11.14    | 2025.01.16           |                                                                                     
|                                             | clj-kondo/clj-kondo                                 | 2024.11.14    | 2025.01.16           |                                                                                     
|                                             | com.github.seancorfield/next.jdbc                   | 1.3.955       | 1.3.981              |                                                                                     
|                                             | com.google.guava/guava                              | 33.3.1-jre    | 33.4.0-jre           |                                                                                     
|                                             | com.ibm.icu/icu4j                                   | 71.1          | 76.1                 |                                                                                     
|                                             | commons-codec/commons-codec                         | 1.17.1        | 1.18.0               |                                                                                     
|                                             | djblue/portal                                       | 0.58.3        | 0.58.5               |                                                                                     
|                                             | dk.ative/docjure                                    | 1.19.0        | 1.21.0               |                                                                                     
|                                             | net.thisptr/jackson-jq                              | 1.1.0         | 1.2.0                |                                                                                     
|                                             | nrepl/nrepl                                         | 1.3.0         | 1.3.1                |                                                                                     
|                                             | org.apache.logging.log4j/log4j-1.2-api              | 2.24.2        | 2.24.3               |                                                                                     
|                                             | org.apache.logging.log4j/log4j-api                  | 2.24.2        | 2.24.3               |                                                                                     
|                                             | org.apache.logging.log4j/log4j-core                 | 2.24.2        | 2.24.3               |                                                                                     
|                                             | org.apache.logging.log4j/log4j-jcl                  | 2.24.2        | 2.24.3               |                                                                                     
|                                             | org.apache.logging.log4j/log4j-jul                  | 2.24.2        | 2.24.3               |                                                                                     
|                                             | org.apache.logging.log4j/log4j-layout-template-json | 2.24.2        | 2.24.3               |                                                                                     
|                                             | org.apache.logging.log4j/log4j-slf4j2-impl          | 2.24.2        | 2.24.3               |                                                                                     
|                                             | org.apache.poi/poi                                  | 5.3.0         | 5.4.0                |                                                                                     
|                                             | org.apache.poi/poi-ooxml                            | 5.3.0         | 5.4.0                |                                                                                     
|                                             | org.apache.poi/poi-ooxml-full                       | 5.3.0         | 5.4.0                |                                                                                     
|                                             | org.bouncycastle/bcpkix-jdk18on                     | 1.79          | 1.80                 |                                                                                     
|                                             | org.bouncycastle/bcprov-jdk18on                     | 1.79          | 1.80                 |                                                                                     
|                                             | org.clojure/core.async                              | 1.6.681       | 1.7.701              |                                                                                     
|                                             | org.jsoup/jsoup                                     | 1.18.2        | 1.18.3               |                                                                                     
|                                             | org.postgresql/postgresql                           | 42.7.4        | 42.7.5               |                                                                                     
| modules/drivers/bigquery-cloud-sdk/deps.edn | com.google.cloud/google-cloud-bigquery              | 2.44.0        | 2.46.0               |                                                                                     
|                                             | io.netty/netty-buffer                               | 4.1.115.Final | 4.1.117.Final        |                                                                                     
|                                             | io.netty/netty-common                               | 4.1.115.Final | 4.1.117.Final        |                                                                                     
| modules/drivers/mongo/deps.edn              | com.google.guava/guava                              | 33.3.1-jre    | 33.4.0-jre           |                                                                                     
|                                             | org.mongodb/mongodb-driver-sync                     | 5.2.1         | 5.3.1                |                                                                                     
| modules/drivers/oracle/deps.edn             | com.oracle.database.jdbc/ojdbc11                    | 23.5.0.24.07  | 23.6.0.24.10         |                                                                                     
| modules/drivers/presto-jdbc/deps.edn        | com.facebook.presto/presto-jdbc                     | 0.289         | 0.290                |                                                                                     
| modules/drivers/redshift/deps.edn           | com.amazon.redshift/redshift-jdbc42                 | 2.1.0.30      | 2.1.0.32             |                                                                                     
| modules/drivers/snowflake/deps.edn          | net.snowflake/snowflake-jdbc                        | 3.20.0        | 3.21.0               |                                                                                     
| modules/drivers/sqlite/deps.edn             | org.xerial/sqlite-jdbc                              | 3.47.1.0      | 3.48.0.0             |                                                                                     
| modules/drivers/sqlserver/deps.edn          | com.microsoft.sqlserver/mssql-jdbc                  | 12.8.1.jre11  | 12.9.0.jre11-preview |                                                                                     
```

bshepherdson (Issue Creator) on (2025-01-28 19:25:27 UTC): Most of these are minor or micro version bumps, so hopefully little impact on us.

A few notable upgrades:
- `next.jdbc` 1.3.967 includes a few changes that might impact us, but may be fine:
    - Strengthens `assert`s to throwing `IllegalArgumentException`s
    - Relaxing some conditions around nested transactions.
- We don't actually want a preview version of `mssql-jdbc`; I'll leave it on `12.8.1.jre11` (the latest non-preview version).
- `core.async` update is an overhead optimization, low impact.

bshepherdson (Issue Creator) on (2025-01-28 20:43:41 UTC): - `icu4j` is pinned to `71.1` because upgrading breaks some static viz tests; see #52851.

paoliniluis on (2025-01-28 23:47:23 UTC): We need to add to this table:
- jetty to version 12
- make the new cssbox to work with our subscriptions
- mariadb driver to version 3 and ensure compatibility with MySQL

bshepherdson (Issue Creator) on (2025-01-29 16:02:09 UTC): Where is this coming from? This isn't a general ""libraries we should update"" issue, it's the basic bump of deps that don't cause serious issues. If we want to get unpinned from Jetty 11, that's a separate issue and separate PR. Likewise for the other two points.

bshepherdson (Issue Creator) on (2025-01-29 16:08:40 UTC): I'm reverting `clj-kondo` back to `2024.11.14`. The new version causes issues by breaking the way some of the `macros` overrides tell it to ignore `:unused-binding` errors. Cam filed [an issue](https://github.com/clj-kondo/clj-kondo/issues/2469) to figure out the Right Way to handle that, and we need to wait for that to land in Toucan and a few other upstream libs first.

piranha on (2025-01-30 11:12:44 UTC): @bshepherdson jetty 11 is pinned just because of Java bytecode version issues, no other reasons :)

bshepherdson (Issue Creator) on (2025-02-03 15:10:48 UTC): I had to add an explicit dep on `aws-java-sdk-core` in the Redshift driver.

This is listed as an optional dep, but it seems that at least one class from it (`com.amazonaws.util.StringUtils`) is now dynamically required by our driver - tests were throwing `NoClassDefFoundError`s without it.

Redshift tests are passing locally with this dependency added.

"
2816213973,issue,closed,completed,Unable to perform full export using cli,"### Describe the bug

I encountered this bug while attempting to migrate all Metabase dashboards and questions (i.e., all collections) from an Oracle source to PostgreSQL. My plan was to first export everything using serialization. I was provided with a production clone to test on, which works correctly. It starts up without issues, and all dashboards are displayed correctly with no errors.

To verify my approach, I initially exported a single collection using the -c flag and the collection ID. The export was performed as expected. I then modified the files by converting names to lowercase and renaming schema references to public. After reimporting the collection, I successfully restored a working dashboard connected to the PostgreSQL source.

Next, I wrote a Python script to automate the reformatting process. I then attempted to export all collections and databases to generate input for my script using this command:

java -jar metabase.jar export metabase_psql_full.dump

The export process started as expected but ended with multiple warnings, such as:

Failed to export Dashboard 44 (dashboard-name) containing Card saved outside requested collections.




### To Reproduce

1. Go to the metabase directory where it is installed
2. enter `java -jar metabase.jar export **target-directory-of-exported-files**`
3. the process results in an warning and the **target-directory-of-exported-files** is empty. 


### Expected behavior

1. Go to the metabase directory where it is installed
2. enter `java -jar metabase.jar export **target-directory-of-exported-files**`
3. the process results in success and the **target-directory-of-exported-files** should contain multple yaml files in an folder hierachy representing your metabase collection-structure

### Logs

```
2025-01-28 16:12:14,315 WARN v2.extract :: Failed to export Dashboard 88 (**censored_name**) containing Card saved outside requested collections: Card 580 (**censored_name**)
2025-01-28 16:12:14,331 WARN v2.extract :: Failed to export Dashboard 58 (**censored_name**) containing Card saved outside requested collections: Card 448 (**censored_name**)
2025-01-28 16:12:14,353 WARN v2.extract :: Failed to export Dashboard 22 (**censored_name**) containing Card saved outside requested collections: Card 260 (**censored_name**), Card 264 (**censored_name**), Card 262 (**censored_name**), Card 266 (**censored_name**), Card 268 (**censored_name**)
2025-01-28 16:12:14,361 WARN v2.extract :: Failed to export Dashboard 594 (**censored_name**) containing Card saved outside requested collections: Card 3190 (**censored_name**)
2025-01-28 16:12:14,372 WARN v2.extract :: Failed to export Dashboard 44 (**censored_name**) containing Card saved outside requested collections: Card 344 (**censored_name**), Card 346 (**censored_name**)
2025-01-28 16:12:14,391 WARN v2.extract :: Failed to export Cards based on questions outside requested collections: Card 1222 (**censored_name**) -> Card 1212 (**censored_name**), Card 1224 (**censored_name**) -> Card 1220 (**censored_name**)
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""de-DE"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""oracle"",
      ""mysql"",
      ""csv""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-07"",
      ""tag"": ""v1.52.5"",
      ""hash"": ""cc77eeb""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Amsterdam""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MariaDB"",
        ""version"": ""10.11.8-MariaDB-0ubuntu0.24.04.1""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-Ubuntu-1ubuntu124.04"",
    ""java.vendor"": ""Ubuntu"",
    ""java.vendor.url"": ""https://ubuntu.com/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-Ubuntu-1ubuntu124.04"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.8.0-51-generic"",
    ""user.language"": ""de"",
    ""user.timezone"": ""Etc/UTC""
  }
}
```

### Severity

blocks migration process

### Additional context


To me, this doesn't make sense since it's supposed to export all collections and shouldn't be limited to just one.

I believe this is a bug that Metabase should fix. Please correct me if I'm wrong.

If I'm mistaken, I would really appreciate some guidance.

Thanks in advance!",lokoamigo,2025-01-28 16:43:18+00:00,[],2025-01-29 13:21:43+00:00,2025-01-29 13:12:20+00:00,https://github.com/metabase/metabase/issues/52831,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Backend', ''), ('Operation/Serialization', 'Enterprise contents migration'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2620903799, 'issue_id': 2816213973, 'author': 'piranha', 'body': ""It limits to exporting only public collections, I think that's why it reports those problems. Can you move (offending) cards to some other but public collection and try again?"", 'created_at': datetime.datetime(2025, 1, 29, 7, 40, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2621620931, 'issue_id': 2816213973, 'author': 'lokoamigo', 'body': 'Indeed this fixed my issue. Why does it only support public collections though? There seems to be no flag that allows the export of private collections. Can this be implemented in the future?', 'created_at': datetime.datetime(2025, 1, 29, 13, 12, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2621641253, 'issue_id': 2816213973, 'author': 'luizarakaki', 'body': 'You can export personal collections, but you need to explicitly ask for them:\n\nhttps://www.metabase.com/docs/latest/installation-and-operation/serialization#export-options\nBy default, Metabase will include all collections (except for personal collections) in the export. To include personal collections, you must explicitly add them with the --collection flag.', 'created_at': datetime.datetime(2025, 1, 29, 13, 21, 42, tzinfo=datetime.timezone.utc)}]","piranha on (2025-01-29 07:40:45 UTC): It limits to exporting only public collections, I think that's why it reports those problems. Can you move (offending) cards to some other but public collection and try again?

lokoamigo (Issue Creator) on (2025-01-29 13:12:20 UTC): Indeed this fixed my issue. Why does it only support public collections though? There seems to be no flag that allows the export of private collections. Can this be implemented in the future?

luizarakaki on (2025-01-29 13:21:42 UTC): You can export personal collections, but you need to explicitly ask for them:

https://www.metabase.com/docs/latest/installation-and-operation/serialization#export-options
By default, Metabase will include all collections (except for personal collections) in the export. To include personal collections, you must explicitly add them with the --collection flag.

"
2815923739,issue,closed,completed,Migrate Metabot API endpoint to new the defendpoint,"**Context**

On `master` metabase API endpoints are migrated to using the new Malli based defendpoint macro. I expect the old macro to disappear soon. Metabot's API has to be migrated as well otherwise merging to `master` will be impossible.",metamben,2025-01-28 14:54:48+00:00,['metamben'],2025-01-29 15:36:25+00:00,2025-01-29 15:36:25+00:00,https://github.com/metabase/metabase/issues/52817,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2815683146,issue,open,,Uncaught TypeError when making native query parameter required,"### Describe the bug

`TagEditorParam` assumes `parameter` prop is never `undefined`, but it can be so.


### To Reproduce

1. New > SQL Query
2. `{{x}}`
3. Change variable type to ""Field Filter""
4. Notice Field picker automatically opened
5. Close the field picker by click on ""Select...""
6. Observe JS console in the next step
7. Check the ""Always require a value"" switch
 
```
TagEditorParam.tsx:165 Uncaught TypeError: Cannot read properties of undefined (reading 'value')
    at TagEditorParamInner.setRequired (TagEditorParam.tsx:165:1)
```

### Information about your Metabase installation

master, 760f65f7e5a4973d583544cafe26a3d3d14debcf

### Severity

P3

### Additional context

Things still seem to work afterwards, so marking as P3 only",kamilmielnik,2025-01-28 13:30:53+00:00,[],2025-02-04 20:29:09+00:00,,https://github.com/metabase/metabase/issues/52812,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Querying/Native', 'The SQL/native query editor'), ('.Frontend', ''), ('.Team/Querying', '')]","[{'comment_id': 2619221022, 'issue_id': 2815683146, 'author': 'WiNloSt', 'body': 'Reproducible on v1.51.13', 'created_at': datetime.datetime(2025, 1, 28, 14, 49, 7, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-28 14:49:07 UTC): Reproducible on v1.51.13

"
2815658551,issue,open,,Variable type picker covered by field picker,"### Describe the bug

![Image](https://github.com/user-attachments/assets/d4d08a66-5ca6-492e-8bc5-07b9a973c368)

### To Reproduce

1. New > SQL Query
2. `{{x}}`
3. Change variable type to ""Field Filter""
4. Notice Field picker automatically opened
5. Click to change variable type again (assume you want to change it to ""Date"")

❌ Field picker covers variable type picker

### Expected behavior

Field picker is closed when variable type picker is opened


### Information about your Metabase installation

master, 760f65f7e5a4973d583544cafe26a3d3d14debcf

### Severity

P3
",kamilmielnik,2025-01-28 13:21:16+00:00,[],2025-02-04 20:29:07+00:00,,https://github.com/metabase/metabase/issues/52811,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Querying/Native', 'The SQL/native query editor'), ('.Frontend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/Querying', ''), ('Bug:v52', 'bugs or regressions introduced in v52')]","[{'comment_id': 2618987643, 'issue_id': 2815658551, 'author': 'kamilmielnik', 'body': ""While we're at it, please also consider fixing field picker width to match the trigger width:\n\n![Image](https://github.com/user-attachments/assets/ceb12552-07f8-44cd-8caf-44c8ed43a372)"", 'created_at': datetime.datetime(2025, 1, 28, 13, 23, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2619213431, 'issue_id': 2815658551, 'author': 'WiNloSt', 'body': 'Not reproducible on v1.51.13, but reproducible on v1.52.7.3.\n\nOn 51, when selecting the variable type, the field popover will be automatically closed.\n![Image](https://github.com/user-attachments/assets/2f092c3c-00b1-453f-9ed0-6e19f3189907)', 'created_at': datetime.datetime(2025, 1, 28, 14, 46, 21, tzinfo=datetime.timezone.utc)}]","kamilmielnik (Issue Creator) on (2025-01-28 13:23:27 UTC): While we're at it, please also consider fixing field picker width to match the trigger width:

![Image](https://github.com/user-attachments/assets/ceb12552-07f8-44cd-8caf-44c8ed43a372)

WiNloSt on (2025-01-28 14:46:21 UTC): Not reproducible on v1.51.13, but reproducible on v1.52.7.3.

On 51, when selecting the variable type, the field popover will be automatically closed.
![Image](https://github.com/user-attachments/assets/2f092c3c-00b1-453f-9ed0-6e19f3189907)

"
2815455944,issue,closed,completed,Bookmark and collection highlighted in the sidebar when creating new native question,"### Describe the bug

https://github.com/user-attachments/assets/c02532b8-07ed-4acd-820a-b819180ceac9

### To Reproduce

1. New > SQL Query
2. `select 1`
3. Save it as ""Native Question""
4. Bookmark it
5. New > SQL Query
6. Open sidebar

❌ ""Native Question"" and ""Our analytics"" are highlighted in the sidebar

TODO: check with product team whether it's expected for ""Our analytics"" to be highlighted (it shouldn't be, because new question is assigned to a collection/dashboard when it's saved)

### Expected behavior

Nothing is highlighted in the sidebar

### Information about your Metabase installation

master, 760f65f7e5a4973d583544cafe26a3d3d14debcf

### Severity

P3

### Additional context

If you have more native questions bookmarked, the last one will be highlighted.",kamilmielnik,2025-01-28 12:03:02+00:00,[],2025-01-29 16:37:40+00:00,2025-01-29 16:37:40+00:00,https://github.com/metabase/metabase/issues/52809,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Design System', 'Overall UI patterns and components, not specific to a single part of the product')]","[{'comment_id': 2619193612, 'issue_id': 2815455944, 'author': 'WiNloSt', 'body': 'Not reproducible on v1.51.13 or v1.52.7.3, but reproducible on master@ 8edbc3fda59b1068f76f06fecd8b37c6f699e46b', 'created_at': datetime.datetime(2025, 1, 28, 14, 40, 26, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-28 14:40:26 UTC): Not reproducible on v1.51.13 or v1.52.7.3, but reproducible on master@ 8edbc3fda59b1068f76f06fecd8b37c6f699e46b

"
2815440948,issue,closed,completed,MongoDB query FailedToParse due to invalid character in variable names,"### Describe the bug

I have a MongoDB database where the collection names have underscores, e.g. company_users this gets translated to CompanyUsers.

If you use now lookups aka joins within the graphical interface then the following errors gets produced:

```Command failed with error 9 (FailedToParse): 
''let_join_alias_Category Courses_course_id___2' contains an invalid character for a variable name: ' '' on server rf-percona-mongodb-replicaset.percona-mongodb.svc.cluster.local:27017. 
The full response is 

{ 
""ok"": 0.0, 
""errmsg"": ""'let_join_alias_Category Courses_course_id___2' contains an invalid character for a variable name: ' '"", 
""code"": 9, 
""codeName"": ""FailedToParse"", 
""$clusterTime"": {""clusterTime"": {""$timestamp"": {""t"": 1738064961, ""i"": 1}}, ""signature"": {""hash"": {""$binary"": {""base64"": ""AAAAAAAAAAAAAAAAAAAAAAAAAAA="", ""subType"": ""00""}}, ""keyId"": 0}}, ""operationTime"": {""$timestamp"": {""t"": 1738064961, ""i"": 1}}}
```

### To Reproduce

1. Have a MongoDB database with at least three tables that include underscores in their names.
2. Create a join from table A to B and from table B to C


### Expected behavior

The space and other invalid MongoDB variable name characters are eliminated.

More info: [User Variables MongoDB](https://www.mongodb.com/docs/v6.0/reference/aggregation-variables/#user-variables) 

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mongo""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-27"",
      ""tag"": ""v0.52.8"",
      ""hash"": ""3cbfc1e""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.2 (Debian 16.2-1.pgdg120+2)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.167.4-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

Blocker

### Additional context

_No response_",MatthiasBiskop,2025-01-28 11:58:04+00:00,[],2025-01-31 07:03:14+00:00,2025-01-31 06:27:21+00:00,https://github.com/metabase/metabase/issues/52807,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/Mongo', None), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Team/Drivers', '')]",[],
2815420016,issue,open,,Native query params not cleaned from URL after leaving editor,"### Describe the bug

https://github.com/user-attachments/assets/a4c3a009-cf7c-43b4-8193-bc30bddd7f36

### To Reproduce

1. New > SQL Query
2. `select {{x}}`
3. Click Metabase logo in page header to go to the index page
4. Confirm when asked to discard your changes

You land on `/?x=` instead of `/`

### Information about your Metabase installation

master, 760f65f7e5a4973d583544cafe26a3d3d14debcf

### Severity

P3
",kamilmielnik,2025-01-28 11:51:45+00:00,[],2025-02-04 20:28:30+00:00,,https://github.com/metabase/metabase/issues/52806,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Native', 'The SQL/native query editor'), ('.Frontend', ''), ('.Team/Querying', '')]","[{'comment_id': 2619147975, 'issue_id': 2815420016, 'author': 'WiNloSt', 'body': 'Reproducible on v1.51.13', 'created_at': datetime.datetime(2025, 1, 28, 14, 23, 48, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-28 14:23:48 UTC): Reproducible on v1.51.13

"
2815386306,issue,open,,"[Epic] Ensure the usage of the latest Embedding SDK code in documentation samples, code snippets, etc","We want to ensure the usage of the latest Embedding SDK/MB code in documentation samples, code snippets, etc

* [Quickstart Guide](https://www.metabase.com/docs/latest/embedding/sdk/quickstart) should contain up-to-date Embedding SDK code samples
* [Shoppy](https://github.com/metabase/shoppy) project should contain code to work with the latest Embedding SDK version
* The [sample repo](https://github.com/metabase/metabase-nodejs-react-sdk-embedding-sample) should contain code to work with the latest Embedding SDK version
* Embedding SDK CLI should generate code compatible with the corresponding MB version
* Next.JS compatible layer should generate compatible code with the corresponding Embedding SDK/MB version

### Links

* [product doc](https://www.notion.so/metabase/Ensure-Shoppy-SDK-Sample-CLI-Next-compat-layer-are-working-use-current-SDK-versions-and-in-sync--13769354c901802b983ff8a6b360787e)
* [technical design doc](https://www.notion.so/metabase/Ensure-the-usage-of-the-latest-Embedding-SDK-code-in-documentation-samples-code-snippets-etc-18969354c90180d5a6a5d9237bb46431?pvs=4)
* feature branch: `ensure-valid-sdk-code-in-code-snippets`
  * multiple repositories are affected, the same branch name for all repositories",sanex3339,2025-01-28 11:37:30+00:00,['sanex3339'],2025-02-07 13:44:46+00:00,,https://github.com/metabase/metabase/issues/52804,"[('.Epic', 'Feature Implementation or Project'), ('.Team/Embedding', '')]",[],
2814804492,issue,open,,Dashboard not found error in Embedding CLI when selecting other tables,"See this [private Loom](https://www.loom.com/share/c128f17ae99144639ff4648b6940bf9d?sid=44f72cb8-227a-4bd7-a6a4-446b85476202) by Matthew. When selecting ""People"" or ""Products"" table, there is an error that says ""Dashboard 11 not found. Make sure you pass the correct ID.""

![Image](https://github.com/user-attachments/assets/e50a34ec-6dfe-4e6b-b488-f5eb255161bf)",heypoom,2025-01-28 07:06:25+00:00,[],2025-02-04 20:25:53+00:00,,https://github.com/metabase/metabase/issues/52796,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('.Team/Embedding', ''), ('Embedding/SDK-CLI', 'Onboarding CLI for React SDK')]",[],
2814227254,issue,open,,Inconsistency in Character Limit for dashboard names,"### Describe the bug

Creating a new dashboard or duplicating an existing dashboard set a max limit of 100 characters for the name. But you can set the name by clicking on the title in the dashboard editor and set it to something <= 254 characters.

### To Reproduce

For new dashboads:

1. Click +New and choose Dashboard.
2. Click Fill in a name > 100 characters.
3. Blur the field (hit Tab or click outside the field).
4. Observe the textbox gets a red border and a helpful error message.

For duplicating dashboards:

1. Open an existing dashboard in the dashboard editor.
2. Click ""..."" and select Duplicate.
3. Change the name to something longer than 100 characters.
4. Blur the field (hit Tab or click outside the field).
5. Observe the textbox gets a red border and a helpful error message.

For existing dashboards:

1. Open an existing dashboard in the dashboard editor.
2. Click the name to begin editing it.
3. Change the name to something > 100 characters.
4. Hit enter.
5. Reload the page (to make sure it is saved on the backend).
6. Observe that the title is longer than 100 characters.

### Expected behavior

Editing the name of an existing dashboard should have the same limit as the two modals. Further, it would be nice to signal that error to the user with a red border and red validation message.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-16"",
      ""tag"": ""v0.53.2-SNAPSHOT"",
      ""hash"": ""346d982""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.2 (Homebrew)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.4""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""15.2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

confusing

### Additional context

Related to: https://github.com/metabase/metabase/issues/52771

Similar to: https://github.com/metabase/metabase/issues/49600",ericnormand,2025-01-27 22:55:45+00:00,[],2025-02-04 20:28:41+00:00,,https://github.com/metabase/metabase/issues/52774,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2619141196, 'issue_id': 2814227254, 'author': 'WiNloSt', 'body': 'The same thing happens when duplicating questions.\n\nReproducible on v1.51.13', 'created_at': datetime.datetime(2025, 1, 28, 14, 21, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2621527285, 'issue_id': 2814227254, 'author': 'kamilmielnik', 'body': 'The same happens with [actions](https://github.com/user-attachments/assets/8ff79c02-bacb-4166-b932-be04b33c5702), [collections](https://github.com/user-attachments/assets/33804a73-625c-451d-9c5c-a360d1a39b57) and [users](https://github.com/user-attachments/assets/d7909761-89c0-43be-8435-6164058d7dbc)', 'created_at': datetime.datetime(2025, 1, 29, 12, 37, 36, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-28 14:21:13 UTC): The same thing happens when duplicating questions.

Reproducible on v1.51.13

kamilmielnik on (2025-01-29 12:37:36 UTC): The same happens with [actions](https://github.com/user-attachments/assets/8ff79c02-bacb-4166-b932-be04b33c5702), [collections](https://github.com/user-attachments/assets/33804a73-625c-451d-9c5c-a360d1a39b57) and [users](https://github.com/user-attachments/assets/d7909761-89c0-43be-8435-6164058d7dbc)

"
2814200679,issue,closed,not_planned,Silent failure when changing the name of a dashboard,"### Describe the bug

Changing the name of an existing dashboard in the dashboard editor silently fails if the name is longer than 254 characters.

### To Reproduce

1. Open an existing dashboard in the dashboard editor.
2. Click on the name of the dashboard to begin editing it.
3. Type enough characters to make it more than 254 characters.
4. Hit enter.
5. Reload the page and see that the old name remains.


### Expected behavior

The editor should signal the error to the user (red border and clear error text) and keep the name editor open. Bonus points for not requiring the user to hit enter to learn that it's too long.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-16"",
      ""tag"": ""v0.53.2-SNAPSHOT"",
      ""hash"": ""346d982""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.2 (Homebrew)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.4""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""15.2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

confusing

### Additional context

You can see that the request to the server fails with a 500 and this response (truncated):

```
{
    ""via"": [
        {
            ""type"": ""clojure.lang.ExceptionInfo"",
            ""message"": ""ERROR: value too long for type character varying(254)"",
            ""data"": {
                ""toucan2/context-trace"": [
                    [
                        ""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"",
```",ericnormand,2025-01-27 22:35:42+00:00,[],2025-01-29 06:55:49+00:00,2025-01-28 14:52:53+00:00,https://github.com/metabase/metabase/issues/52771,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]","[{'comment_id': 2619131864, 'issue_id': 2814200679, 'author': 'WiNloSt', 'body': ""didn't try to repro this, but I guess it's the same as https://github.com/metabase/metabase/issues/52770#issuecomment-2619116326"", 'created_at': datetime.datetime(2025, 1, 28, 14, 17, 34, tzinfo=datetime.timezone.utc)}, {'comment_id': 2619231340, 'issue_id': 2814200679, 'author': 'ranquild', 'body': 'Duplicate of https://github.com/metabase/metabase/issues/49600', 'created_at': datetime.datetime(2025, 1, 28, 14, 52, 53, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-28 14:17:34 UTC): didn't try to repro this, but I guess it's the same as https://github.com/metabase/metabase/issues/52770#issuecomment-2619116326

ranquild on (2025-01-28 14:52:53 UTC): Duplicate of https://github.com/metabase/metabase/issues/49600

"
2814193275,issue,closed,not_planned,Silent failure when changing the name of an existing question,"### Describe the bug

Changing the name of an existing question in the question editor silently fails if the name is longer than 254 characters.

### To Reproduce

1. Open an existing question in the question editor.
2. Click on the name of the question to begin editing it.
3. Type enough characters to make it more than 254 characters.
4. Hit enter.
5. Reload the page and see that the old title remains.


### Expected behavior

The editor should signal the error to the user (red border and clear error text) and keep the name editor open. Bonus points for not requiring the user to hit enter to learn that it's too long.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-16"",
      ""tag"": ""v0.53.2-SNAPSHOT"",
      ""hash"": ""346d982""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.2 (Homebrew)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.4""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""15.2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

confusing

### Additional context

You can see that the request to the server fails with a 500 and this response (truncated):

```
{
    ""via"": [
        {
            ""type"": ""clojure.lang.ExceptionInfo"",
            ""message"": ""ERROR: value too long for type character varying(254)"",
            ""data"": {
                ""toucan2/context-trace"": [
                    [
                        ""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"",
```",ericnormand,2025-01-27 22:30:28+00:00,[],2025-01-28 14:52:30+00:00,2025-01-28 14:52:27+00:00,https://github.com/metabase/metabase/issues/52770,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]","[{'comment_id': 2617035637, 'issue_id': 2814193275, 'author': 'ericnormand', 'body': 'This should be consistent with the limits set here (https://github.com/metabase/metabase/issues/49600) which also deals with long titles.', 'created_at': datetime.datetime(2025, 1, 27, 22, 31, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2617040637, 'issue_id': 2814193275, 'author': 'ixipixi', 'body': 'Probably also related:\n- https://github.com/metabase/metabase/issues/5030\n- https://github.com/metabase/metabase/issues/40175', 'created_at': datetime.datetime(2025, 1, 27, 22, 34, 56, tzinfo=datetime.timezone.utc)}, {'comment_id': 2619116326, 'issue_id': 2814193275, 'author': 'WiNloSt', 'body': 'Reproducible on \n- v1.51.13\n- v1.52.7.3\n- master@ 8edbc3fda59b1068f76f06fecd8b37c6f699e46b', 'created_at': datetime.datetime(2025, 1, 28, 14, 11, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2619230069, 'issue_id': 2814193275, 'author': 'ranquild', 'body': 'Duplicate of https://github.com/metabase/metabase/issues/49600', 'created_at': datetime.datetime(2025, 1, 28, 14, 52, 27, tzinfo=datetime.timezone.utc)}]","ericnormand (Issue Creator) on (2025-01-27 22:31:33 UTC): This should be consistent with the limits set here (https://github.com/metabase/metabase/issues/49600) which also deals with long titles.

ixipixi on (2025-01-27 22:34:56 UTC): Probably also related:
- https://github.com/metabase/metabase/issues/5030
- https://github.com/metabase/metabase/issues/40175

WiNloSt on (2025-01-28 14:11:20 UTC): Reproducible on 
- v1.51.13
- v1.52.7.3
- master@ 8edbc3fda59b1068f76f06fecd8b37c6f699e46b

ranquild on (2025-01-28 14:52:27 UTC): Duplicate of https://github.com/metabase/metabase/issues/49600

"
2814164441,issue,open,,"""Reset to Default"" on Viz Settings Doesn't Indicate that Chart Name will Change","### Describe the bug

When you choose ""reset to default"" on a dashboard card to reset the custom visualization settings the chart preview changes so you can tell what impact this decision will have on the card. However, it's not made clear that the title of the card will be reset (you still see the custom title in the ""title"" box). Saving the change does, in fact, modify the card title.

### To Reproduce

1. Add a line chart to a dashboard
2. Customize the line color and chart title in dashboard level viz settings and save
3. Go back into dashboard edit mode and reset the viz settings for the card
4. Note that the preview shows the chart itself reverted to the Question level settings but the Title looks as though it will remain the same
5. Save changes
6. Note the dash card title has actually changed

### Expected behavior

Something should Indicate to Users what all will change when they reset viz settings.

### Logs

https://jam.dev/c/e2646456-71e6-4f35-b299-aa75f976810f

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-15"",
      ""tag"": ""v1.52.6"",
      ""hash"": ""1a9cb72""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.1 (Debian 15.1-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.167.4-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

annoying

### Additional context

_No response_",ixipixi,2025-01-27 22:10:30+00:00,['lorem--ipsum'],2025-02-08 14:05:42+00:00,,https://github.com/metabase/metabase/issues/52769,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('Visualization/Chart Settings', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Bug:v52', 'bugs or regressions introduced in v52')]","[{'comment_id': 2619084579, 'issue_id': 2814164441, 'author': 'WiNloSt', 'body': ""> [!note]\n> Please ignore the incorrect circle. Just focus on the title in the input box, it's not reset on master and 52\n\n\nReproducible on master@ 8edbc3fda59b1068f76f06fecd8b37c6f699e46b and v1.52.7.3\n![Image](https://github.com/user-attachments/assets/bdc85d73-bf66-4da5-ae2a-57c75abd4a59)\n\nNot present on 51.13\n![Image](https://github.com/user-attachments/assets/38993fe5-a828-4db7-8532-67fa974faed7)"", 'created_at': datetime.datetime(2025, 1, 28, 13, 58, 52, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-28 13:58:52 UTC): Reproducible on master@ 8edbc3fda59b1068f76f06fecd8b37c6f699e46b and v1.52.7.3
![Image](https://github.com/user-attachments/assets/bdc85d73-bf66-4da5-ae2a-57c75abd4a59)

Not present on 51.13
![Image](https://github.com/user-attachments/assets/38993fe5-a828-4db7-8532-67fa974faed7)

"
2814082698,issue,closed,completed,Export of pivot table with multiple columns with the same name will silently remove duplicates,"### Describe the bug

A pivot table can have two columns with the same name as pivot rows or columns, i.e. from two different tables linked by a FK. This displays properly on the frontend, but when you export it (as CSV or XLSX), only one of the same-named columns will be present in the export.

### To Reproduce

Create a question with this definition, or something similar that has breakouts for two columns in different tables with the same name. Visualize it as a pivot table with both columns as pivot rows.

<img width=""800"" alt=""Image"" src=""https://github.com/user-attachments/assets/569a4961-460d-4765-8f8d-dcf355063fc4"" />

On the frontend it appears correctly:

<img width=""500"" alt=""Image"" src=""https://github.com/user-attachments/assets/75445a5c-6330-4fd7-8189-d86fd676e4e2"" />

When you export, one of the columns is dropped:

<img width=""176"" alt=""Image"" src=""https://github.com/user-attachments/assets/2933cbc4-a14c-4c1f-8f0c-48c6da8e4191"" />

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Current master (62eb4a6dbe)
```

### Severity

Possible p1 correctness issue

### Additional context

_No response_",noahmoss,2025-01-27 21:20:21+00:00,['lbrdnk'],2025-01-30 15:28:25+00:00,2025-01-30 14:47:38+00:00,https://github.com/metabase/metabase/issues/52768,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/MBQL', ''), ('.Backend', ''), ('.Team/Querying', ''), ('Querying/Pivot', 'Queries that generate pivot tables')]","[{'comment_id': 2616955420, 'issue_id': 2814082698, 'author': 'noahmoss', 'body': 'Root cause: in `column-name-pivot-options` we try to correlate the column names from the `:pivot_table.column_split` key in the card\'s viz settings with the `:lib/desired-column-alias` of each column returned by the query. https://github.com/metabase/metabase/blob/62eb4a6dbeda776e01c362058e6f32cd4d8f3c4a/src/metabase/query_processor/pivot.clj#L352-L378\n\n`:pivot_table.column_split` looks like this: `{:rows [""ID"" ""ID_2""], :columns [], :values [""count""]}`\n\n`:lib/desired-column-alias` for the joined column is `PRODUCTS__via__PRODUCT_ID__ID`\n\nSince the column names don\'t match, the joined column is not included in the pivot settings, causing it to get dropped by the export. (Still not sure why this doesn\'t also cause it to get dropped on the FE...)', 'created_at': datetime.datetime(2025, 1, 27, 21, 41, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2617788595, 'issue_id': 2814082698, 'author': 'ranquild', 'body': 'MBQL lib deduplicates `:name`s for `returned-columns` only on the FE and not on the BE. It\'s `[""ID"", ""ID"", ""count""]` while should be `[""ID"", ""ID_2"", ""count""]`. See https://github.com/metabase/metabase/blob/29dafe465f6cf201716062f294490ef79d2735a4/src/metabase/lib/js.cljs#L1349 A quick fix would be to use `unique-name-fn` in `column-name-pivot-options`.', 'created_at': datetime.datetime(2025, 1, 28, 3, 54, 40, tzinfo=datetime.timezone.utc)}]","noahmoss (Issue Creator) on (2025-01-27 21:41:05 UTC): Root cause: in `column-name-pivot-options` we try to correlate the column names from the `:pivot_table.column_split` key in the card's viz settings with the `:lib/desired-column-alias` of each column returned by the query. https://github.com/metabase/metabase/blob/62eb4a6dbeda776e01c362058e6f32cd4d8f3c4a/src/metabase/query_processor/pivot.clj#L352-L378

`:pivot_table.column_split` looks like this: `{:rows [""ID"" ""ID_2""], :columns [], :values [""count""]}`

`:lib/desired-column-alias` for the joined column is `PRODUCTS__via__PRODUCT_ID__ID`

Since the column names don't match, the joined column is not included in the pivot settings, causing it to get dropped by the export. (Still not sure why this doesn't also cause it to get dropped on the FE...)

ranquild on (2025-01-28 03:54:40 UTC): MBQL lib deduplicates `:name`s for `returned-columns` only on the FE and not on the BE. It's `[""ID"", ""ID"", ""count""]` while should be `[""ID"", ""ID_2"", ""count""]`. See https://github.com/metabase/metabase/blob/29dafe465f6cf201716062f294490ef79d2735a4/src/metabase/lib/js.cljs#L1349 A quick fix would be to use `unique-name-fn` in `column-name-pivot-options`.

"
2813807024,issue,closed,completed,`POST /api/dashboard/pivot/:dashboard-id/dashcard/:dashcard-id/card/:card-id/query/:export-format` with `parameters` is broken,"The backend code says `parameters` has to be a JSON string 

https://github.com/metabase/metabase/blob/d304dae6686ab52c876b758659ef7792be631514/src/metabase/api/dashboard.clj#L1382 

while the frontend code says it has to be an array of objects 

https://github.com/metabase/metabase/blob/d304dae6686ab52c876b758659ef7792be631514/frontend/src/metabase/redux/downloads.ts#L187. 

I'm 99% sure the FE code is right if you look at the endpoints above and below that one in the backend code they both have `[:maybe [:sequential ParameterWithID]]` for their schema",camsaul,2025-01-27 18:52:49+00:00,['camsaul'],2025-01-30 01:54:32+00:00,2025-01-27 23:06:08+00:00,https://github.com/metabase/metabase/issues/52760,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('Misc/API', ''), ('Reporting/Export', ''), ('Visualization/Download', '')]",[],
2813368886,issue,closed,completed,Task History rows can grow quite large,"### Describe the bug

The task_history table can grow quite large. We aim to keep ~100,000 items in this table. Each row has a text field called `task_details` which is often of the form `{""total-table-privileges"":138}`, or the number of fields synced, etc. But it will include any errors encountered. And these errors can be large. We need to limit this.

Note this is compounded due to https://github.com/metabase/metabase/issues/52746

### To Reproduce

To reproduce, I'm hijacking `sync-all-indexes!` to ""find"" 100,000 indexes and proceed with that. It doesn't matter that they are nonsensical for the database since it will break before running the query.

```clojure
(defn- sync-all-indexes!
  [database]
  (sync-util/with-error-handling ""Error syncing Indexes""
    (let [indexes #_(fetch-metadata/log-if-error
                     ""index-metadata""
                     (into [] (driver/describe-indexes (driver.u/database->driver database) database)))
          (repeat 100000 {:table-schema ""public"",
                          :table-name ""serialization_stats"",
                          :field-name ""id""})
          database-id (:id database)
,,,
```

And then just call a sync on a postgres database (h2 doesn't seem to sync indexes):

```clojure
indexes=> (let [database (t2/select-one :model/Database :id 2)]
            (metabase.sync.core/sync-database! database {:scan :full}))
Process inf-clojure metabase connection broken by remote peer
```

<img width=""1361"" alt=""Image"" src=""https://github.com/user-attachments/assets/dc919320-8a08-4bd5-8361-ea00ba190c58"" />

<img width=""1361"" alt=""Image"" src=""https://github.com/user-attachments/assets/c894bc59-78ad-4c1c-b61f-417035e91a4f"" />

I didn't actually get a large task history because my process died :(

### Expected behavior

_No response_

### Logs

pictured above. Quite big

### Information about your Metabase installation

```JSON
master
```

### Severity

p1

### Additional context

_No response_",dpsutton,2025-01-27 15:44:11+00:00,[],2025-02-06 19:58:59+00:00,2025-02-03 20:20:10+00:00,https://github.com/metabase/metabase/issues/52748,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Backend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2640869026, 'issue_id': 2813368886, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)', 'created_at': datetime.datetime(2025, 2, 6, 19, 58, 58, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-02-06 19:58:58 UTC): 🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)

"
2813324682,issue,closed,completed,Task sync indexes can throw enormous stacktraces,"### Describe the bug

We sync indexes in sync: https://github.com/metabase/metabase/blob/master/src/metabase/sync/sync_metadata/indexes.clj#L51-L61

This uses an `in` clause that is unbounded. We can run into issues where we are using more parameters than postgres allows:

> """"exception"""":""""class clojure.lang.ExceptionInfo"""",""""message"""":""""PreparedStatement can have at most 65,535 parameters. Please consider using arrays, or splitting the query in several ones, or using COPY. Given query has 226,886 parameters""""

(from a csv dump of task_history). A knock on effect that this table grows too large, and the in memory logger also holds onto it: https://github.com/metabase/metabase/issues/52537

### To Reproduce

Difficult, because the bug happens at scale. The gist is in this query:

```clojure
(defn- all-indexes->field-ids
  [database-id indexes]
  (when (seq indexes)
    (let [normal-indexes (map (juxt #(:table-schema % ""__null__"") :table-name :field-name) indexes)
          query (t2/reducible-query {:select [[:f.id]]
                                     :from [[(t2/table-name :model/Field) :f]]
                                     :inner-join [[(t2/table-name :model/Table) :t] [:= :f.table_id :t.id]]
                                     :where [:and [:in [:composite [:coalesce :t.schema ""__null__""] :t.name :f.name] normal-indexes]
                                             [:= :t.db_id database-id]
                                             [:= :parent_id nil]]})]
      (into #{} (keep :id) query))))
```

Indexes here look like
```clojure
[{:table-schema ""public"",
  :table-name ""serialization_stats"",
  :field-name ""id""}
 ,,,]
```

And this shows how the number of parameters to the query scales linearly (but with coefficient 3) with the number of indexes in a database:

```clojure
indexes=> (let [normal-indexes [[""public"" ""table_1"" ""id""]
                                [""public"" ""table_2"" ""id""]]
                database-id 1]
            (honey.sql/format {:select [[:f.id]]
                               :from [[(t2/table-name :model/Field) :f]]
                               :inner-join [[(t2/table-name :model/Table) :t] [:= :f.table_id :t.id]]
                               :where [:and [:in [:composite [:coalesce :t.schema ""__null__""] :t.name :f.name] normal-indexes]
                                       [:= :t.db_id database-id]
                                       [:= :parent_id nil]]}))
[""SELECT f.id FROM metabase_field AS f INNER JOIN metabase_table AS t ON f.table_id = t.id WHERE ((COALESCE(t.schema, ?), t.name, f.name) IN ((?, ?, ?), (?, ?, ?))) AND (t.db_id = ?) AND (parent_id IS NULL)""
 ""__null__""
 ""public""
 ""table_1""
 ""id""
 ""public""
 ""table_2""
 ""id""
 1]
```

### Expected behavior

We need to not be sensitive to this.

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```

### Severity

p

### Additional context

Note this has knock on effects elsewhere in the in-memory logger and the task_history table.",dpsutton,2025-01-27 15:26:01+00:00,[],2025-01-31 20:16:57+00:00,2025-01-31 20:16:57+00:00,https://github.com/metabase/metabase/issues/52746,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Team/Drivers', '')]","[{'comment_id': 2616111356, 'issue_id': 2813324682, 'author': 'dpsutton', 'body': 'To reproduce, I\'m hijacking `sync-all-indexes!` to ""find"" 100,000 indexes and proceed with that. It doesn\'t matter that they are nonsensical for the database since it will break before running the query.\n\n```clojure\n(defn- sync-all-indexes!\n  [database]\n  (sync-util/with-error-handling ""Error syncing Indexes""\n    (let [indexes #_(fetch-metadata/log-if-error\n                     ""index-metadata""\n                     (into [] (driver/describe-indexes (driver.u/database->driver database) database)))\n          (repeat 100000 {:table-schema ""public"",\n                          :table-name ""serialization_stats"",\n                          :field-name ""id""})\n          database-id (:id database)\n,,,\n```\n\nAnd then just call a sync on a postgres database (h2 doesn\'t seem to sync indexes):\n\n```clojure\nindexes=> (let [database (t2/select-one :model/Database :id 2)]\n            (metabase.sync.core/sync-database! database {:scan :full}))\nProcess inf-clojure metabase connection broken by remote peer\n```\n\n<img width=""1361"" alt=""Image"" src=""https://github.com/user-attachments/assets/dc919320-8a08-4bd5-8361-ea00ba190c58"" />\n\n<img width=""1361"" alt=""Image"" src=""https://github.com/user-attachments/assets/c894bc59-78ad-4c1c-b61f-417035e91a4f"" />', 'created_at': datetime.datetime(2025, 1, 27, 15, 44, 1, tzinfo=datetime.timezone.utc)}]","dpsutton (Issue Creator) on (2025-01-27 15:44:01 UTC): To reproduce, I'm hijacking `sync-all-indexes!` to ""find"" 100,000 indexes and proceed with that. It doesn't matter that they are nonsensical for the database since it will break before running the query.

```clojure
(defn- sync-all-indexes!
  [database]
  (sync-util/with-error-handling ""Error syncing Indexes""
    (let [indexes #_(fetch-metadata/log-if-error
                     ""index-metadata""
                     (into [] (driver/describe-indexes (driver.u/database->driver database) database)))
          (repeat 100000 {:table-schema ""public"",
                          :table-name ""serialization_stats"",
                          :field-name ""id""})
          database-id (:id database)
,,,
```

And then just call a sync on a postgres database (h2 doesn't seem to sync indexes):

```clojure
indexes=> (let [database (t2/select-one :model/Database :id 2)]
            (metabase.sync.core/sync-database! database {:scan :full}))
Process inf-clojure metabase connection broken by remote peer
```

<img width=""1361"" alt=""Image"" src=""https://github.com/user-attachments/assets/dc919320-8a08-4bd5-8361-ea00ba190c58"" />

<img width=""1361"" alt=""Image"" src=""https://github.com/user-attachments/assets/c894bc59-78ad-4c1c-b61f-417035e91a4f"" />

"
2812708020,issue,open,,MongoDB - support whitelisting or blacklisting collections,"**Is your feature request related to a problem? Please describe.**
Currently, when Metabase has access to multiple collections, all of them are scanned, which may cause unnecessary operations and performance issues in certain cases. 

A customer ended up having 1.5 million column entries in their application db, caused by documents they did not intend to use. Being able to exclude collections would prevent similar issues.

**Describe the solution you'd like**
Introduce blacklist and whitelist configuration option in Metabase to allow users to exclude or include specific MongoDB collections to be scanned and exposed in Metabase.

**Describe alternatives you've considered**
Tried setting up collection specific permissions for the Metabase account in MongoDB as a workaround, however not having access to specific collections causes the schema sync to fail. Also, whitelists / blacklists would be simpler to use.

**How important is this feature to you?**
Requested by a pro customer.",zbodi74,2025-01-27 11:04:35+00:00,[],2025-02-04 20:30:38+00:00,,https://github.com/metabase/metabase/issues/52735,"[('Database/Mongo', None), ('Administration/Metadata & Sync', ''), ('Type:New Feature', '')]",[],
2812643098,issue,open,,Unable to focus search input with keyboard in Filter Modal,"### Describe the bug

https://github.com/user-attachments/assets/994e7f38-7601-456c-82ab-945f7a0a59f2

### To Reproduce

1. New > Question > Orders > Visualize
2. Click ""Filter""
3. Try to use <kbd>Tab</kbd> to focus the search input

### Information about your Metabase installation

master, a7b8f79b031eefeff5b3b0c8f8f40bcb7fd2e005

### Severity

P3
",kamilmielnik,2025-01-27 10:34:59+00:00,[],2025-02-04 20:27:34+00:00,,https://github.com/metabase/metabase/issues/52733,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('Misc/Accessibility', ''), ('.Team/Querying', '')]",[],
2812615705,issue,closed,completed,Tooltip is hidden behind the chart in a dashboard,"### Describe the bug

The tooltip now appears behind the chart instead of infront of it. This is at chart level

<img width=""1502"" alt=""Image"" src=""https://github.com/user-attachments/assets/a63ee393-d23b-497a-a331-2f7862ac918d"" />

and this is at dashboard level:

<img width=""1292"" alt=""Image"" src=""https://github.com/user-attachments/assets/03617c77-0b8a-4d97-9b5a-8361500f051d"" />


### To Reproduce

1. Go to New Question -> Products -> Count Group by Title -> Plot as a PieChart.
2. Check the Tooltip and you will notice it's broken
3. Add this to a Dashboard 4 times and then try using the tooltip again. 

Images shared in the description

### Expected behavior

The tooltip works as used to work on 52.6

<img width=""966"" alt=""Image"" src=""https://github.com/user-attachments/assets/3536d166-aa97-4bc5-a04b-c3f4244f6083"" />

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
Tested with 52.7.2/3 and both have the issue but works with 52.6
```

### Severity

Blocker, broke functionality within metabase

### Additional context

_No response_",Tony-metabase,2025-01-27 10:22:25+00:00,"['npretto', 'WiNloSt']",2025-01-27 14:14:31+00:00,2025-01-27 12:34:05+00:00,https://github.com/metabase/metabase/issues/52732,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Escalation', ''), ('.Team/Embedding', '')]","[{'comment_id': 2615544025, 'issue_id': 2812615705, 'author': 'WiNloSt', 'body': 'This is caused by https://github.com/metabase/metabase/pull/52310', 'created_at': datetime.datetime(2025, 1, 27, 11, 47, 56, tzinfo=datetime.timezone.utc)}]","WiNloSt (Assginee) on (2025-01-27 11:47:56 UTC): This is caused by https://github.com/metabase/metabase/pull/52310

"
2812404476,issue,open,,Removing a Database from the UI can timeout if the DB is very large,"### Describe the bug

From the UI there is only 1 option to delete a DB which is Admin -> Databases -> Then Remove this Database  If the process takes more than 10 min or the value specified in the ENV Variable the task will fail:

```
{""lvl"":""ERROR"",""lgr"":""metabase.server.middleware.log"",""m"":""DELETE /api/database/34 500 10.0 mins (321 DB calls) {:metabase-user-id 1} \n{:via\n [{:type clojure.lang.ExceptionInfo,\n   :message \""This connection has been closed.
```

You will not know what is happening and why the DB is still there

### To Reproduce

Create a large Database, we have experienced this recently with a 500GB with 100k Tables and around 15 columns each

Go to Admin -> Database -> Remove this Datbase

<img width=""560"" alt=""Image"" src=""https://github.com/user-attachments/assets/3cd52b9c-4fc0-4700-8d26-8e63fc28c8b6"" />

Notice how the `DELETE /api/database will timeout`


### Expected behavior

Make the `DELETE /api/database/` more efficient so it doesn't take much time to delete the database

### Logs


```
{""lvl"":""ERROR"",""lgr"":""metabase.server.middleware.log"",""m"":""DELETE /api/database/34 500 10.0 mins (321 DB calls) {:metabase-user-id 1} \n{:via\n [{:type clojure.lang.ExceptionInfo,\n   :message \""This connection has been closed.
```

### Information about your Metabase installation

```JSON
It was always there and still is
```

### Severity

minor

### Additional context

The only option you end up with is to go to the Application Database table `metabase_database` and delete the row entry from there",Tony-metabase,2025-01-27 08:45:50+00:00,[],2025-02-05 19:17:10+00:00,,https://github.com/metabase/metabase/issues/52729,"[('Type:Bug', 'Product defects'), ('Database/', ''), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Backend', ''), ('Administration/Settings', ''), ('Administration/Databases', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2812235682,issue,open,,The display of the collection name is not synchronized with the objects displayed on the page.,"### Describe the bug

Hello!
Earlier, I added an [issue](https://github.com/metabase/metabase/issues/51560) related to the slow performance of the interface for users with a large number of security groups. Some users noticed and reported another annoying feature in its operation. In short, the display of the collection's name is not synchronized with the objects displayed on the page. What I mean is that if the interface is slow, when opening a collection, it may happen that the collection's name will update and point to the last opened one, while the displayed content remains from the previously opened collection. 

An exaggerated example might look like this:
![Image](https://github.com/user-attachments/assets/bb197822-55c4-49f0-824f-c64f2e36dfd4)

### To Reproduce

For a user with a large number of permission groups, open one collection after another.



### Expected behavior

After clicking on a collection, an animation is displayed indicating that the collection is opening in place of the outdated content.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""exasol"",
      ""mysql"",
      ""clickhouse"",
      ""mongo""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-15"",
      ""tag"": ""v0.52.6"",
      ""hash"": ""1a9cb72""
    },
    ""settings"": { },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MariaDB"",
        ""version"": ""10.5.13-MariaDB""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.14.0-375.el9.x86_64"",
    ""user.language"": ""en""
  }
}
```

### Severity

Annoying

### Additional context

_No response_",ppavlov39,2025-01-27 07:04:57+00:00,[],2025-01-27 10:52:47+00:00,,https://github.com/metabase/metabase/issues/52727,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2615425170, 'issue_id': 2812235682, 'author': 'WiNloSt', 'body': 'Reproducible on V1.51.13\n\n![Image](https://github.com/user-attachments/assets/e408f46f-c946-4b40-955a-dd7e0a55c08f)\n\nHere, we show the content of `1` (same as the last screenshot) for a brief moment instead of the content of `1-1`\n![Image](https://github.com/user-attachments/assets/7228bea1-e5ba-434e-9f13-f84f641b5cf0)', 'created_at': datetime.datetime(2025, 1, 27, 10, 52, 28, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-27 10:52:28 UTC): Reproducible on V1.51.13

![Image](https://github.com/user-attachments/assets/e408f46f-c946-4b40-955a-dd7e0a55c08f)

Here, we show the content of `1` (same as the last screenshot) for a brief moment instead of the content of `1-1`
![Image](https://github.com/user-attachments/assets/7228bea1-e5ba-434e-9f13-f84f641b5cf0)

"
2811237731,issue,closed,completed,Link Checker Report,,github-actions[bot],2025-01-26 00:17:43+00:00,['jeff-bruemmer'],2025-01-30 13:58:29+00:00,2025-01-30 13:58:29+00:00,https://github.com/metabase/metabase/issues/52726,"[('Type:Documentation', '')]",[],
2810921118,issue,closed,completed,Empty states for dashboard subscriptions,"- [product doc](https://www.notion.so/metabase/Empty-states-for-better-activation-pt-1-2a77f6fbe8e3461ab9fac4886de0ff09?pvs=4#d80d0e59e02c4ff1896b097c223d8eae)
- [design](https://www.figma.com/design/ZPJPG7HQbSEMp4lvd8Dzwe/Empty-states?node-id=4272-3541&t=d4wMBwknOQkCv5LK-0)",nemanjaglumac,2025-01-25 10:51:47+00:00,['nemanjaglumac'],2025-01-27 22:10:05+00:00,2025-01-27 18:25:48+00:00,https://github.com/metabase/metabase/issues/52724,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2810920626,issue,closed,completed,Empty states for dashboards,"- [product doc](https://www.notion.so/metabase/Empty-states-for-better-activation-pt-1-2a77f6fbe8e3461ab9fac4886de0ff09?pvs=4#c36e4804455f4cba8500f8d0fcfa1310)
- [design](https://www.figma.com/design/ZPJPG7HQbSEMp4lvd8Dzwe/Empty-states?node-id=4272-2630&m=dev)

",nemanjaglumac,2025-01-25 10:50:20+00:00,['nemanjaglumac'],2025-01-28 21:17:28+00:00,2025-01-28 16:07:28+00:00,https://github.com/metabase/metabase/issues/52723,[],[],
2810420613,issue,closed,completed,Function usage suggestion is not fully visible,"### Describe the bug

Hello, team! Thank you for a great software.

I found small, but still nasty bug, where I'm not able to see manual on how to use a function in custom expression field.

<img width=""527"" alt=""Image"" src=""https://github.com/user-attachments/assets/cdd9456f-479a-436d-9b95-649b9ac7f9fd"" />

### To Reproduce

1. Go to a New Question
2. Click on Summarize->Pick formula->Custom expression
3. Try to type Count(
4. See error: Count function suggestion is overlayed by edit popup


### Expected behavior

Suggestion should be above or behind edit field fully visible

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""bigquery-cloud-sdk"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-21"",
      ""tag"": ""v0.52.7"",
      ""hash"": ""ddbc480""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.6""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.226-214.879.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

Degrades UX when using custom expressions

### Additional context

_No response_",NGorco,2025-01-24 21:38:17+00:00,['oisincoveney'],2025-01-27 16:55:34+00:00,2025-01-27 16:55:33+00:00,https://github.com/metabase/metabase/issues/52711,"[('Type:Bug', 'Product defects'), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('.Frontend', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2810348363,issue,open,,Port QP middleware: `fix-bad-refs` and `escape-join-aliases`,,bshepherdson,2025-01-24 20:46:21+00:00,[],2025-01-24 20:46:21+00:00,,https://github.com/metabase/metabase/issues/52707,[],[],
2810348270,issue,open,,Port QP middleware: `add-implicit-joins`,,bshepherdson,2025-01-24 20:46:17+00:00,[],2025-01-24 20:46:17+00:00,,https://github.com/metabase/metabase/issues/52706,[],[],
2810348190,issue,open,,Port QP middleware: `add-implicit-clauses`,,bshepherdson,2025-01-24 20:46:14+00:00,[],2025-01-24 20:46:14+00:00,,https://github.com/metabase/metabase/issues/52705,[],[],
2810347795,issue,open,,Port QP middleware: `reconcile-breakout-and-order-by-bucketing`,,bshepherdson,2025-01-24 20:45:57+00:00,[],2025-01-24 20:45:57+00:00,,https://github.com/metabase/metabase/issues/52704,[],[],
2810347714,issue,open,,Port QP util: `nest-query` (and `nest-breakouts`),,bshepherdson,2025-01-24 20:45:53+00:00,[],2025-01-24 20:45:53+00:00,,https://github.com/metabase/metabase/issues/52703,[],[],
2810347500,issue,open,,Cleanup: Delete the `old-refs` side and rename `foo:new-refs` to simply `foo`.,,bshepherdson,2025-01-24 20:45:45+00:00,[],2025-01-24 20:45:45+00:00,,https://github.com/metabase/metabase/issues/52702,[],[],
2810347423,issue,open,,Flip the master `old-refs`/`new-refs` flag - all tests passing!,,bshepherdson,2025-01-24 20:45:41+00:00,[],2025-01-24 20:45:41+00:00,,https://github.com/metabase/metabase/issues/52701,[],[],
2810347346,issue,open,,New refs for explicit joins,,bshepherdson,2025-01-24 20:45:38+00:00,[],2025-01-24 20:45:38+00:00,,https://github.com/metabase/metabase/issues/52700,[],[],
2810347253,issue,open,,New refs for implicit joins,,bshepherdson,2025-01-24 20:45:33+00:00,[],2025-01-24 20:45:33+00:00,,https://github.com/metabase/metabase/issues/52699,[],[],
2810347167,issue,open,,New refs for aggregations,,bshepherdson,2025-01-24 20:45:30+00:00,[],2025-01-24 20:45:30+00:00,,https://github.com/metabase/metabase/issues/52698,[],[],
2810347092,issue,open,,New refs for breakouts,,bshepherdson,2025-01-24 20:45:27+00:00,[],2025-01-24 20:45:27+00:00,,https://github.com/metabase/metabase/issues/52697,[],[],
2810347016,issue,open,,New refs for expressions,,bshepherdson,2025-01-24 20:45:23+00:00,[],2025-01-24 20:45:23+00:00,,https://github.com/metabase/metabase/issues/52696,[],[],
2810346801,issue,open,,"New refs for tables, cards, stages - the core of metadata",,bshepherdson,2025-01-24 20:45:13+00:00,[],2025-01-24 20:45:13+00:00,,https://github.com/metabase/metabase/issues/52695,[],[],
2810234921,issue,open,,Pivot table of a json field will show wrong data,"### Describe the bug

We end up showing the same row on the grouping with counts of the real rows

![Image](https://github.com/user-attachments/assets/7fd8c62e-8a4d-4820-bb31-1daa0e7727c0)

### To Reproduce

1) set up Metabase with MongoDB
2) add to the MongoDB this table

```
// Connect to your MongoDB database
use sample; // Replace 'myDatabase' with your database name

// Define the collection name
const collectionName = ""myCollection"";

// Drop the collection if it exists (optional, for clean slate)
db[collectionName].drop();

// Insert documents into the collection
db[collectionName].insertMany([
    {
        key1: ""value1"",
        key2: { nestedKey1: ""nestedValue1"", nestedKey2: null },
        key3: ""value3"",
        key4: null,
        key5: { nestedKey1: ""nestedValue2"" },
        key6: ""value6"",
        key7: null,
        key8: { nestedKey1: ""nestedValue3"", nestedKey2: ""nestedValue4"" },
        key9: null,
        key10: ""value10""
    },
    {
        key1: null,
        key2: { nestedKey1: ""nestedValue1"" },
        key3: null,
        key4: ""value4"",
        key5: null,
        key6: { nestedKey1: ""nestedValue5"", nestedKey2: null },
        key7: ""value7"",
        key8: null,
        key9: { nestedKey1: ""nestedValue6"" },
        key10: null
    },
    {
        key1: ""value1"",
        key2: ""value2"",
        key3: null,
        key4: null,
        key5: { nestedKey1: ""nestedValue7"", nestedKey2: ""nestedValue8"" },
        key6: null,
        key7: ""value7"",
        key8: ""value8"",
        key9: null,
        key10: { nestedKey1: ""nestedValue9"" }
    },
    {
        key1: null,
        key2: null,
        key3: ""value3"",
        key4: { nestedKey1: ""nestedValue10"", nestedKey2: ""nestedValue11"" },
        key5: null,
        key6: null,
        key7: { nestedKey1: ""nestedValue12"" },
        key8: null,
        key9: ""value9"",
        key10: ""value10""
    },
    {
        key1: ""value1"",
        key2: null,
        key3: ""value3"",
        key4: null,
        key5: { nestedKey1: ""nestedValue13"" },
        key6: { nestedKey1: ""nestedValue14"", nestedKey2: null },
        key7: null,
        key8: ""value8"",
        key9: null,
        key10: { nestedKey1: ""nestedValue15"", nestedKey2: ""nestedValue16"" }
    }
]);

print(""Documents with nested properties inserted successfully!"");
```

3) sync
4) go to a table view on that new table
5) Make a count of Key5

![Image](https://github.com/user-attachments/assets/e8d9c343-9a49-49c5-be33-e268f7697ff3)

6) Do a pivot table 


### Expected behavior

We should render the correct data

### Logs

NA

### Information about your Metabase installation

```JSON
v52.6
```

### Severity

P2 only because no one reported it yet

### Additional context

NA",paoliniluis,2025-01-24 19:25:20+00:00,[],2025-02-04 20:31:57+00:00,,https://github.com/metabase/metabase/issues/52687,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2810221826,issue,open,,Pie chart represents only a single series when there should be more,"### Describe the bug

There's data that the pie chart will not represent even though the values are the same as other series

### To Reproduce

1) set up Metabase with MongoDB
2) add to the MongoDB this table

```
// Connect to your MongoDB database
use sample; // Replace 'myDatabase' with your database name

// Define the collection name
const collectionName = ""myCollection"";

// Drop the collection if it exists (optional, for clean slate)
db[collectionName].drop();

// Insert documents into the collection
db[collectionName].insertMany([
    {
        key1: ""value1"",
        key2: { nestedKey1: ""nestedValue1"", nestedKey2: null },
        key3: ""value3"",
        key4: null,
        key5: { nestedKey1: ""nestedValue2"" },
        key6: ""value6"",
        key7: null,
        key8: { nestedKey1: ""nestedValue3"", nestedKey2: ""nestedValue4"" },
        key9: null,
        key10: ""value10""
    },
    {
        key1: null,
        key2: { nestedKey1: ""nestedValue1"" },
        key3: null,
        key4: ""value4"",
        key5: null,
        key6: { nestedKey1: ""nestedValue5"", nestedKey2: null },
        key7: ""value7"",
        key8: null,
        key9: { nestedKey1: ""nestedValue6"" },
        key10: null
    },
    {
        key1: ""value1"",
        key2: ""value2"",
        key3: null,
        key4: null,
        key5: { nestedKey1: ""nestedValue7"", nestedKey2: ""nestedValue8"" },
        key6: null,
        key7: ""value7"",
        key8: ""value8"",
        key9: null,
        key10: { nestedKey1: ""nestedValue9"" }
    },
    {
        key1: null,
        key2: null,
        key3: ""value3"",
        key4: { nestedKey1: ""nestedValue10"", nestedKey2: ""nestedValue11"" },
        key5: null,
        key6: null,
        key7: { nestedKey1: ""nestedValue12"" },
        key8: null,
        key9: ""value9"",
        key10: ""value10""
    },
    {
        key1: ""value1"",
        key2: null,
        key3: ""value3"",
        key4: null,
        key5: { nestedKey1: ""nestedValue13"" },
        key6: { nestedKey1: ""nestedValue14"", nestedKey2: null },
        key7: null,
        key8: ""value8"",
        key9: null,
        key10: { nestedKey1: ""nestedValue15"", nestedKey2: ""nestedValue16"" }
    }
]);

print(""Documents with nested properties inserted successfully!"");
```

3) sync
4) go to a table view on that new table
5) Make a count of Key5

![Image](https://github.com/user-attachments/assets/e8d9c343-9a49-49c5-be33-e268f7697ff3)

6) Do a pie chart

See that there's many series that we don't render (and the series has the count wrong)

![Image](https://github.com/user-attachments/assets/28ea202a-a54d-4813-9c9d-04bfb211085b)

![Image](https://github.com/user-attachments/assets/244647af-d3e0-4068-8103-4ec6944bb68f)

### Expected behavior

We should render the correct data

### Logs

NA

### Information about your Metabase installation

```JSON
v52.6
```

### Severity

P2 only because no one reported it yet

### Additional context

NA",paoliniluis,2025-01-24 19:16:57+00:00,[],2025-02-04 20:31:28+00:00,,https://github.com/metabase/metabase/issues/52686,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Visualization/Charts/Pie', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2810198988,issue,open,,We render [object Object] on the chart series when the make a chart of a nested json,"### Describe the bug

Just a FE bug where we represent the machine representation of the object rather than the stringified version of it

### To Reproduce

1) set up Metabase with MongoDB
2) add to the MongoDB this table

```
// Connect to your MongoDB database
use sample; // Replace 'myDatabase' with your database name

// Define the collection name
const collectionName = ""myCollection"";

// Drop the collection if it exists (optional, for clean slate)
db[collectionName].drop();

// Insert documents into the collection
db[collectionName].insertMany([
    {
        key1: ""value1"",
        key2: { nestedKey1: ""nestedValue1"", nestedKey2: null },
        key3: ""value3"",
        key4: null,
        key5: { nestedKey1: ""nestedValue2"" },
        key6: ""value6"",
        key7: null,
        key8: { nestedKey1: ""nestedValue3"", nestedKey2: ""nestedValue4"" },
        key9: null,
        key10: ""value10""
    },
    {
        key1: null,
        key2: { nestedKey1: ""nestedValue1"" },
        key3: null,
        key4: ""value4"",
        key5: null,
        key6: { nestedKey1: ""nestedValue5"", nestedKey2: null },
        key7: ""value7"",
        key8: null,
        key9: { nestedKey1: ""nestedValue6"" },
        key10: null
    },
    {
        key1: ""value1"",
        key2: ""value2"",
        key3: null,
        key4: null,
        key5: { nestedKey1: ""nestedValue7"", nestedKey2: ""nestedValue8"" },
        key6: null,
        key7: ""value7"",
        key8: ""value8"",
        key9: null,
        key10: { nestedKey1: ""nestedValue9"" }
    },
    {
        key1: null,
        key2: null,
        key3: ""value3"",
        key4: { nestedKey1: ""nestedValue10"", nestedKey2: ""nestedValue11"" },
        key5: null,
        key6: null,
        key7: { nestedKey1: ""nestedValue12"" },
        key8: null,
        key9: ""value9"",
        key10: ""value10""
    },
    {
        key1: ""value1"",
        key2: null,
        key3: ""value3"",
        key4: null,
        key5: { nestedKey1: ""nestedValue13"" },
        key6: { nestedKey1: ""nestedValue14"", nestedKey2: null },
        key7: null,
        key8: ""value8"",
        key9: null,
        key10: { nestedKey1: ""nestedValue15"", nestedKey2: ""nestedValue16"" }
    }
]);

print(""Documents with nested properties inserted successfully!"");
```

3) sync
4) go to a table view on that new table
5) Make a count of Key5

![Image](https://github.com/user-attachments/assets/e8d9c343-9a49-49c5-be33-e268f7697ff3)

6) Do a bar chart/line chart/area chart/combo/waterfall


### Expected behavior

We should show the key name

### Logs

NA

### Information about your Metabase installation

```JSON
v52.6
```

### Severity

P2 only because no one reported it yet

### Additional context

NA",paoliniluis,2025-01-24 19:01:45+00:00,[],2025-02-04 20:31:22+00:00,,https://github.com/metabase/metabase/issues/52684,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2810177814,issue,closed,duplicate,We don't show JSON keys on the table view,"### Describe the bug

I don't know if this is Mongo only but we're not showing the nested json keys although they appear in the metadata

### To Reproduce

1) set up Metabase with MongoDB
2) add to the MongoDB this table

```
// Connect to your MongoDB database
use sample; // Replace 'myDatabase' with your database name

// Define the collection name
const collectionName = ""myCollection"";

// Drop the collection if it exists (optional, for clean slate)
db[collectionName].drop();

// Insert documents into the collection
db[collectionName].insertMany([
    {
        key1: ""value1"",
        key2: { nestedKey1: ""nestedValue1"", nestedKey2: null },
        key3: ""value3"",
        key4: null,
        key5: { nestedKey1: ""nestedValue2"" },
        key6: ""value6"",
        key7: null,
        key8: { nestedKey1: ""nestedValue3"", nestedKey2: ""nestedValue4"" },
        key9: null,
        key10: ""value10""
    },
    {
        key1: null,
        key2: { nestedKey1: ""nestedValue1"" },
        key3: null,
        key4: ""value4"",
        key5: null,
        key6: { nestedKey1: ""nestedValue5"", nestedKey2: null },
        key7: ""value7"",
        key8: null,
        key9: { nestedKey1: ""nestedValue6"" },
        key10: null
    },
    {
        key1: ""value1"",
        key2: ""value2"",
        key3: null,
        key4: null,
        key5: { nestedKey1: ""nestedValue7"", nestedKey2: ""nestedValue8"" },
        key6: null,
        key7: ""value7"",
        key8: ""value8"",
        key9: null,
        key10: { nestedKey1: ""nestedValue9"" }
    },
    {
        key1: null,
        key2: null,
        key3: ""value3"",
        key4: { nestedKey1: ""nestedValue10"", nestedKey2: ""nestedValue11"" },
        key5: null,
        key6: null,
        key7: { nestedKey1: ""nestedValue12"" },
        key8: null,
        key9: ""value9"",
        key10: ""value10""
    },
    {
        key1: ""value1"",
        key2: null,
        key3: ""value3"",
        key4: null,
        key5: { nestedKey1: ""nestedValue13"" },
        key6: { nestedKey1: ""nestedValue14"", nestedKey2: null },
        key7: null,
        key8: ""value8"",
        key9: null,
        key10: { nestedKey1: ""nestedValue15"", nestedKey2: ""nestedValue16"" }
    }
]);

print(""Documents with nested properties inserted successfully!"");
```

3) sync
4) go to a table view on that new table

see that there are no nested json keys

![Image](https://github.com/user-attachments/assets/f45afd6c-c2a6-4656-af03-e203eefb6480)

but you see those in the query builder

![Image](https://github.com/user-attachments/assets/70347522-882f-4060-818c-19262b15f3f1)

### Expected behavior

We should show those columns as json keys, in the same way we show these in the table views

### Logs

```
2025-01-24 18:51:16,177 DEBUG middleware.log :: POST /api/dataset/query_metadata 200 25ms (9 DB calls) App DB connections: 0/15 Jetty threads: 3/50 (11 idle, 0 queued) (74 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}
2025-01-24 18:51:16,251 WARN sql.query-processor :: No implementation of metabase.driver.sql.query-processor/inline-value for [:mongo java.lang.String], falling back to default implementation of honey.sql.protocols/sqlize
2025-01-24 18:51:16,251 WARN sql.query-processor :: No implementation of metabase.driver.sql.query-processor/inline-value for [:mongo java.lang.String], falling back to default implementation of honey.sql.protocols/sqlize
2025-01-24 18:51:16,251 WARN sql.query-processor :: No implementation of metabase.driver.sql.query-processor/inline-value for [:mongo java.lang.String], falling back to default implementation of honey.sql.protocols/sqlize
2025-01-24 18:51:16,265 WARN sql.query-processor :: No implementation of metabase.driver.sql.query-processor/inline-value for [:mongo java.lang.String], falling back to default implementation of honey.sql.protocols/sqlize
2025-01-24 18:51:16,265 WARN sql.query-processor :: No implementation of metabase.driver.sql.query-processor/inline-value for [:mongo java.lang.String], falling back to default implementation of honey.sql.protocols/sqlize
2025-01-24 18:51:16,265 WARN sql.query-processor :: No implementation of metabase.driver.sql.query-processor/inline-value for [:mongo java.lang.String], falling back to default implementation of honey.sql.protocols/sqlize

```

### Information about your Metabase installation

```JSON
v52.6
```

### Severity

P2 only because no one reported it yet

### Additional context

NA",paoliniluis,2025-01-24 18:51:49+00:00,[],2025-01-24 19:23:34+00:00,2025-01-24 19:23:32+00:00,https://github.com/metabase/metabase/issues/52682,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2613229886, 'issue_id': 2810177814, 'author': 'paoliniluis', 'body': 'duplicate of https://github.com/metabase/metabase/issues/47146', 'created_at': datetime.datetime(2025, 1, 24, 19, 23, 32, tzinfo=datetime.timezone.utc)}]","paoliniluis (Issue Creator) on (2025-01-24 19:23:32 UTC): duplicate of https://github.com/metabase/metabase/issues/47146

"
2809952529,issue,open,,Granular limits for download results permissions - MB_DOWNLOAD_ROW_LIMIT option in GUI,"**Is your feature request related to a problem? Please describe.**
Currently, Metabase provides a predefined download row limit via the MB_DOWNLOAD_ROW_LIMIT environment variable, which sets a universal cap on the number of rows that can be downloaded. While this is useful for enforcing limits, it would be nice to have something similar within Metabase admin settings.  
Introducing this functionality in the interface would not only provide flexibility for different use cases but also help reduce potential confusion. For example, changes made to the environment variable might not always be communicated to the entire team, leading to inconsistencies in expectations.


**Describe the solution you'd like**
It would be beneficial to introduce more granular download options, such as:

- Predefined increments (e.g., 100,000 rows, 200,000 rows, etc.) for users to select from.
- Or customizable field where users can specify a desired row limit for their downloads, up to the maximum allowed by the system configuration. 



",FilmonK,2025-01-24 17:20:53+00:00,[],2025-02-04 20:30:18+00:00,,https://github.com/metabase/metabase/issues/52677,"[('Type:New Feature', ''), ('Administration/Permissions', 'Collection or Data permissions'), ('.Needs Triage', ''), ('Operation/Environment variables', '')]",[],
2809868653,issue,open,,Accessibility issue with Filters in Dashboard,"### Describe the bug

Using Tab doesn't let you open a filter

<img width=""880"" alt=""Image"" src=""https://github.com/user-attachments/assets/fbc0bae2-c163-47b3-99cd-21d6678b1bbe"" />

Very silly loom showing this:
https://www.loom.com/share/45d13c5913554995adf47d62e625d6d9?sid=9672e36b-4f8c-45de-8f6b-5827fc1c10b2



### To Reproduce

1. Start pressing tab until you get into a filter in a dashboard
2. Press enter, you wont be able to open the filter


### Expected behavior

should open the filter modal

### Logs

_No response_

### Information about your Metabase installation

```JSON
- 52.6
```

### Severity

p3

### Additional context

_No response_",ignacio-mb,2025-01-24 16:40:01+00:00,[],2025-02-04 20:29:07+00:00,,https://github.com/metabase/metabase/issues/52674,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('Misc/Accessibility', ''), ('.Team/Querying', '')]",[],
2809116244,issue,closed,not_planned,Failied to initialize plugin clickhouse.metabase-driver.jar,"### Describe the bug

metabase run in docker

2025-01-24 09:47:48,662 INFO plugins.dependencies :: Metabase Vertica Driver dependency {:class com.vertica.jdbc.Driver} satisfied? false
2025-01-24 09:47:48,663 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Vertica Driver"" ""Metabase Presto JDBC Driver"" ""Metabase Presto Driver""]
2025-01-24 09:47:48,669 ERROR metabase.plugins :: Failied to initialize plugin clickhouse.metabase-driver.jar
java.lang.Exception: Default connection property ssh-tunnel does not exist.
	at metabase.plugins.lazy_loaded_driver$parse_connection_property.invokeStatic(lazy_loaded_driver.clj:22)
	at metabase.plugins.lazy_loaded_driver$parse_connection_property.invoke(lazy_loaded_driver.clj:18)
	at metabase.plugins.lazy_loaded_driver$parse_connection_properties$iter__83188__83192$fn__83193$fn__83194.invoke(lazy_loaded_driver.clj:39)
	at metabase.plugins.lazy_loaded_driver$parse_connection_properties$iter__83188__83192$fn__83193.invoke(lazy_loaded_driver.clj:38)
	at clojure.lang.LazySeq.sval(LazySeq.java:42)
	at clojure.lang.LazySeq.seq(LazySeq.java:51)
	at clojure.lang.RT.seq(RT.java:535)
	at clojure.core$seq__5419.invokeStatic(core.clj:139)
	at clojure.core$concat$fn__5510.invoke(core.clj:727)
	at clojure.lang.LazySeq.sval(LazySeq.java:42)
	at clojure.lang.LazySeq.seq(LazySeq.java:51)
	at clojure.lang.RT.seq(RT.java:535)
	at clojure.core$seq__5419.invokeStatic(core.clj:139)
	at clojure.core$empty_QMARK_.invokeStatic(core.clj:6195)
	at clojure.core$empty_QMARK_.invoke(core.clj:6195)
	at metabase.plugins.lazy_loaded_driver$register_lazy_loaded_driver_BANG_.invokeStatic(lazy_loaded_driver.clj:78)
	at metabase.plugins.lazy_loaded_driver$register_lazy_loaded_driver_BANG_.invoke(lazy_loaded_driver.clj:62)
	at metabase.plugins.initialize$init_BANG_.invokeStatic(initialize.clj:26)
	at metabase.plugins.initialize$init_BANG_.invoke(initialize.clj:18)
	at metabase.plugins.initialize$fn__83265$init_plugin_with_info_BANG___83270$fn__83271.invoke(initialize.clj:57)
	at metabase.plugins.initialize$fn__83265$init_plugin_with_info_BANG___83270.invoke(initialize.clj:47)
	at metabase.plugins$init_plugin_with_info_BANG_.invokeStatic(plugins.clj:78)
	at metabase.plugins$init_plugin_with_info_BANG_.invoke(plugins.clj:74)
	at metabase.plugins$init_plugin_BANG_.invokeStatic(plugins.clj:85)
	at metabase.plugins$init_plugin_BANG_.invoke(plugins.clj:80)
	at metabase.plugins$init_plugins_BANG_$fn__83382.invoke(plugins.clj:153)
	at metabase.plugins$init_plugins_BANG_.invokeStatic(plugins.clj:152)
	at metabase.plugins$init_plugins_BANG_.invoke(plugins.clj:145)
	at metabase.plugins$load_BANG_.invokeStatic(plugins.clj:161)
	at metabase.plugins$load_BANG_.invoke(plugins.clj:157)
	at metabase.plugins$fn__83392$fn__83393.invoke(plugins.clj:165)
	at clojure.lang.Delay.deref(Delay.java:42)
	at clojure.core$deref.invokeStatic(core.clj:2324)
	at clojure.core$deref.invoke(core.clj:2310)
	at metabase.plugins$load_plugins_BANG_.invokeStatic(plugins.clj:167)
	at metabase.plugins$load_plugins_BANG_.invoke(plugins.clj:167)
	at metabase.core$init_BANG_.invokeStatic(core.clj:86)
	at metabase.core$init_BANG_.invoke(core.clj:74)
	at metabase.core$start_normally.invokeStatic(core.clj:135)
	at metabase.core$start_normally.invoke(core.clj:129)
	at metabase.core$_main.invokeStatic(core.clj:168)
	at metabase.core$_main.doInvoke(core.clj:162)
	at clojure.lang.RestFn.invoke(RestFn.java:397)
	at clojure.lang.AFn.applyToHelper(AFn.java:152)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at metabase.core.main(Unknown Source)


### To Reproduce

1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
x
```

### Severity

x

### Additional context

_No response_",wlsoftware,2025-01-24 10:39:51+00:00,[],2025-01-24 15:20:47+00:00,2025-01-24 15:20:45+00:00,https://github.com/metabase/metabase/issues/52654,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2612583557, 'issue_id': 2809116244, 'author': 'luizarakaki', 'body': 'Please complete the bug report form.\n\nWe need to diagnostic info, version, and which external drivers you are using', 'created_at': datetime.datetime(2025, 1, 24, 13, 53, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2612782594, 'issue_id': 2809116244, 'author': 'paoliniluis', 'body': ""Closing as this doesn't have enough information to do a decent debugging."", 'created_at': datetime.datetime(2025, 1, 24, 15, 20, 45, tzinfo=datetime.timezone.utc)}]","luizarakaki on (2025-01-24 13:53:18 UTC): Please complete the bug report form.

We need to diagnostic info, version, and which external drivers you are using

paoliniluis on (2025-01-24 15:20:45 UTC): Closing as this doesn't have enough information to do a decent debugging.

"
2808864697,issue,closed,completed,Provide default_time_dimension_field_id for Metrics,"## Problem

We don't send the default time dimensions for a metric to the LLM. Also the property is kebab-case and not camel_case.

Example history:
```
{
    ""role"" : ""user"",
    ""content"" : ""How was our average order value last week?""
  }, 
{
    ""content"" : """",
    ""role"" : ""assistant"",
    ""tool-calls"" : [ {
      ""id"" : ""call_gpt1n0t1gjw84SvaIuGBmXFh"",
      ""name"" : ""metabot.tool/find-metric"",
      ""arguments"" : {
        ""message"" : ""Average Order Value (AOV) - the average revenue generated per order.""
      }
    } ]
  }, 
{
    ""role"" : ""tool"",
    ""tool-call-id"" : ""call_gpt1n0t1gjw84SvaIuGBmXFh"",
    ""structured-content"" : {
      ""id"" : 106,
      ""name"" : ""Average order value"",
      ""description"" : null,
      ""default-time-dimension-field-id"" : null,         <-------------- HERE IS THE ISSUE
      ""queryable-dimensions"" : [ {
        ""field_id"" : ""c106/0"",
        ""name"" : ""ID"",
        ""type"" : ""number"",
        ""description"" : ""This is a unique ID for the product. It is also called the “Invoice number” or “Confirmation number” in customer facing emails and screens.""
      }
```

Steps to reproduce:

* Create a metric with a time dimension
* Go to the metric page (or try to query from the home page directly)
* Ask a question to Metabot and look at the history",Somtom,2025-01-24 08:37:51+00:00,['metamben'],2025-01-24 20:34:23+00:00,2025-01-24 20:34:23+00:00,https://github.com/metabase/metabase/issues/52650,[],[],
2808288639,issue,closed,not_planned,"Error while using some Grouping functions (Cumulative sum, Offset, maybe more)","**Describe the bug**
There is an issue when using some functions in the in the Summarize section of the UI query builder.
So far we've seen issues with Offset and Cumulative sum.

This is the error message we see:
> [Databricks][JDBCDriver](500051) ERROR processing query/statement. Error Code: 0, SQL state: 42703, Query: -- Metabas***, Error message from Server: org.apache.hive.service.cli.HiveSQLException: Error running query: [UNRESOLVED_COLUMN.WITH_SUGGESTION] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column, variable, or function parameter with name `source`.`example_column` cannot be resolved. Did you mean one of the following? [`example_column`]

By transforming into a query and running it, the issue seems to be:
The CTE is being called ""source""
Then in the SELECT statement there is something like `SELECT source.example_column as example_column` to rename the column
Later on in the WHERE / JOIN or GROUP BY clauses the code references `source`.`example_column` and it can't be resolved as it is now simply called `example_column` 
Removing `source`. in those instances fixes it and allows us to run the query but we would rather keep the question as it is originally rather than transforming it to a SQL question.

**To Reproduce**
Steps to reproduce the behavior:
1. Create a new question
2. Add the Cumulative Sum function in the Summarize section
3. Click on Visualize
4. See error

**Screenshots**
If applicable, add screenshots to help explain your problem.

**Severity**
This is affecting some of our users as not all the grouping Functions are having this issue but it does affect several Dashboards.

**Additional context**
We were running a community Databricks driver and we did not have the issue we believe this started happening once we updated our version to the one with the Native Databricks driver.

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""redshift"",
      ""databricks"",
      ""athena""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-21"",
      ""tag"": ""v1.52.7"",
      ""hash"": ""ddbc480""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.7""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.106-116.188.amzn2023.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```",miguel-magos-cl,2025-01-24 01:28:23+00:00,[],2025-02-05 17:24:13+00:00,2025-02-05 17:24:12+00:00,https://github.com/metabase/metabase/issues/52643,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Backend', ''), ('Database/Databricks', ''), ('.Team/Drivers', '')]","[{'comment_id': 2622787150, 'issue_id': 2808288639, 'author': 'luizarakaki', 'body': ""@miguel-magos-cl we couldn't reproduce this. Do you have screenshots of your question?"", 'created_at': datetime.datetime(2025, 1, 29, 20, 35, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2625066285, 'issue_id': 2808288639, 'author': 'miguel-magos-cl', 'body': 'Maybe it needs to have more than one grouping level.\n\n<img width=""1345"" alt=""Image"" src=""https://github.com/user-attachments/assets/c00c13a4-db2b-420c-8383-618066f95ee2"" />\n\nI\'ll add to code in a few minutes', 'created_at': datetime.datetime(2025, 1, 30, 17, 2, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2625124865, 'issue_id': 2808288639, 'author': 'luizarakaki', 'body': 'Can you send us the generated SQL?<br><br>If you recreate the question, does it work?', 'created_at': datetime.datetime(2025, 1, 30, 17, 27, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2628009527, 'issue_id': 2808288639, 'author': 'miguel-magos-cl', 'body': ""This is the generated query, it doesn't run we get the same error:\n\nSELECT\n  `source`.`file_date` AS `file_date`,\n  `source`.`clara_industry` AS `clara_industry`,\n  `source`.`country` AS `country`,\n  `source`.`TPV Delta percentage` AS `TPV Delta percentage`,\n  `source`.`sum` AS `sum`,\n  `source`.`TPV previous quantile` AS `TPV previous quantile`\nFROM\n  (\n    SELECT\n      CAST(`source`.`file_date` AS timestamp) AS `file_date`,\n      `source`.`clara_industry` AS `clara_industry`,\n      `source`.`country` AS `country`,\n      CAST(\n        SUM(`source`.`invoice_amount_local`) - LAG(SUM(`source`.`invoice_amount_local`), 1) OVER (\n          PARTITION BY\n            `source`.`clara_industry`,\n            `source`.`country`\n         \nORDER BY\n            `source`.`clara_industry` ASC,\n            `source`.`country` ASC,\n            CAST(`source`.`file_date` AS timestamp) ASC\n        ) AS float\n      ) / NULLIF(\n        LAG(SUM(`source`.`invoice_amount_local`), 1) OVER (\n          PARTITION BY\n            `source`.`clara_industry`,\n            `source`.`country`\n          ORDER BY\n            `source`.`clara_industry` ASC,\n            `source`.`country` ASC,\n            CAST(`source`.`file_date` AS timestamp) ASC\n        ),\n        0\n      ) AS `TPV Delta percentage`,\n      SUM(`source`.`invoice_amount_usd`) AS `sum`,\n      LAG(SUM(`source`.`invoice_amount_usd`), 1) OVER (\n        PARTITION BY\n          `source`.`clara_industry`,\n          `source`.`country`\n        ORDER BY\n          `source`.`clara_industry` ASC,\n          `source`.`country` ASC,\n          CAST(`source`.`file_date` AS timestamp) ASC\n      ) AS `TPV previous quantile`\n    FROM\n      (\n        WITH `source` (\n          `file_date`,\n          `operation_uuid`,\n          `invoice_amount_local`,\n          `invoice_amount_usd`,\n          `country`,\n          `clara_industry`\n        ) AS (\n          WITH companies AS (\n            SELECT\n              contract_id,\n              country,\n              clara_industry\n            FROM\n              production.entities.all_clients\n          ),\n          tpv AS (\n            SELECT\n              t.file_date,\n              t.operation_uuid,\n              DATE_TRUNC ('MONTH', file_date) AS file_month,\n              t.invoice_amount_local,\n              t.invoice_amount_usd,\n              coalesce(t.clara_category, 'Undefined') as clara_category,\n              t.country,\n              coalesce(k.clara_industry, 'Undefined') as clara_industry\n            FROM\n              production.finance.tpv_global AS t\n             \nLEFT JOIN companies AS k ON t.country = k.country\n             \n   AND t.contract_id = k.contract_id\n           \nWHERE\n              tpv = TRUE\n              AND file_date >= '2023-01-01'\n          ),\n          totals AS (\n            SELECT\n              file_month,\n              country,\n              SUM(invoice_amount_usd) AS monthly_tpv,\n              SUM(invoice_amount_local) AS monthly_tpv_local\n            FROM\n              tpv\n           \nGROUP BY\n              country,\n              file_month\n          ),\n          tpv2 AS (\n            SELECT\n              t.*,\n              a.monthly_tpv,\n              a.monthly_tpv_local\n            FROM\n              tpv t\n              LEFT OUTER JOIN totals a ON t.country = a.country\n              AND t.file_month = a.file_month\n          ),\n          \nfinal as (\n            SELECT\n              t.file_date,\n              t.operation_uuid,\n              t.invoice_amount_local,\n              t.invoice_amount_usd,\n              t.country,\n              t.clara_industry\n            FROM\n              tpv2 AS t\n          )\n          SELECT\n            *\n          FROM\n            final\n        )\n        SELECT\n          ADD_MONTHS(\n            TRUNC(CAST(`source`.`file_date` AS timestamp), 'year'),\n            (\n              QUARTER(CAST(`source`.`file_date` AS timestamp)) - 1\n            ) * 3\n          ) AS `file_date`,\n          `source`.`clara_industry` AS `clara_industry`,\n          `source`.`country` AS `country`,\n          `source`.`invoice_amount_local` AS `invoice_amount_local`,\n          `source`.`invoice_amount_usd` AS `invoice_amount_usd`\n        FROM\n          `source`\n      ) AS `source`\n    GROUP BY\n      CAST(`source`.`file_date` AS timestamp),\n      `source`.`clara_industry`,\n      `source`.`country`\n    ORDER BY\n      `source`.`clara_industry` ASC,\n      `source`.`country` ASC,\n      CAST(`source`.`file_date` AS timestamp) ASC\n  ) AS `source`\nWHERE\n  (\n    CAST(`source`.`file_date` AS timestamp) >= ADD_MONTHS(TRUNC(NOW(), 'year'), (QUARTER(NOW()) - 1) * 3)\n  )\n  AND (\n    CAST(`source`.`file_date` AS timestamp) < ADD_MONTHS(\n      TRUNC((NOW() + (interval '3' month)), 'year'),\n      (QUARTER((NOW() + (interval '3' month))) - 1) * 3\n    )\n  )\nLIMIT\n  1048575"", 'created_at': datetime.datetime(2025, 1, 31, 18, 9, 13, tzinfo=datetime.timezone.utc)}, {'comment_id': 2628013190, 'issue_id': 2808288639, 'author': 'miguel-magos-cl', 'body': 'If we change the last section of the query removing ""source."" from the names of columns it works.\nThese are the last lines of the query we changed to make it work:\n\n GROUP BY\n      CAST(`file_date` AS timestamp),\n      `clara_industry`,\n      `country`\n    ORDER BY\n      `clara_industry` ASC,\n      `country` ASC,\n      CAST(`file_date` AS timestamp) ASC\n  ) AS `source`\nWHERE\n  (\n    CAST(`file_date` AS timestamp) >= ADD_MONTHS(TRUNC(NOW(), \'year\'), (QUARTER(NOW()) - 1) * 3)\n  )\n  AND (\n    CAST(`file_date` AS timestamp) < ADD_MONTHS(\n      TRUNC((NOW() + (interval \'3\' month)), \'year\'),\n      (QUARTER((NOW() + (interval \'3\' month))) - 1) * 3\n    )\n  )\nLIMIT\n1048575', 'created_at': datetime.datetime(2025, 1, 31, 18, 11, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2637565355, 'issue_id': 2808288639, 'author': 'luizarakaki', 'body': '@miguel-magos-cl we need better reproduction steps... we tried simple question, using models, nested questions but we are unable to reproduce this.', 'created_at': datetime.datetime(2025, 2, 5, 17, 24, 12, tzinfo=datetime.timezone.utc)}]","luizarakaki on (2025-01-29 20:35:03 UTC): @miguel-magos-cl we couldn't reproduce this. Do you have screenshots of your question?

miguel-magos-cl (Issue Creator) on (2025-01-30 17:02:10 UTC): Maybe it needs to have more than one grouping level.

<img width=""1345"" alt=""Image"" src=""https://github.com/user-attachments/assets/c00c13a4-db2b-420c-8383-618066f95ee2"" />

I'll add to code in a few minutes

luizarakaki on (2025-01-30 17:27:20 UTC): Can you send us the generated SQL?<br><br>If you recreate the question, does it work?

miguel-magos-cl (Issue Creator) on (2025-01-31 18:09:13 UTC): This is the generated query, it doesn't run we get the same error:

SELECT
  `source`.`file_date` AS `file_date`,
  `source`.`clara_industry` AS `clara_industry`,
  `source`.`country` AS `country`,
  `source`.`TPV Delta percentage` AS `TPV Delta percentage`,
  `source`.`sum` AS `sum`,
  `source`.`TPV previous quantile` AS `TPV previous quantile`
FROM
  (
    SELECT
      CAST(`source`.`file_date` AS timestamp) AS `file_date`,
      `source`.`clara_industry` AS `clara_industry`,
      `source`.`country` AS `country`,
      CAST(
        SUM(`source`.`invoice_amount_local`) - LAG(SUM(`source`.`invoice_amount_local`), 1) OVER (
          PARTITION BY
            `source`.`clara_industry`,
            `source`.`country`
         
ORDER BY
            `source`.`clara_industry` ASC,
            `source`.`country` ASC,
            CAST(`source`.`file_date` AS timestamp) ASC
        ) AS float
      ) / NULLIF(
        LAG(SUM(`source`.`invoice_amount_local`), 1) OVER (
          PARTITION BY
            `source`.`clara_industry`,
            `source`.`country`
          ORDER BY
            `source`.`clara_industry` ASC,
            `source`.`country` ASC,
            CAST(`source`.`file_date` AS timestamp) ASC
        ),
        0
      ) AS `TPV Delta percentage`,
      SUM(`source`.`invoice_amount_usd`) AS `sum`,
      LAG(SUM(`source`.`invoice_amount_usd`), 1) OVER (
        PARTITION BY
          `source`.`clara_industry`,
          `source`.`country`
        ORDER BY
          `source`.`clara_industry` ASC,
          `source`.`country` ASC,
          CAST(`source`.`file_date` AS timestamp) ASC
      ) AS `TPV previous quantile`
    FROM
      (
        WITH `source` (
          `file_date`,
          `operation_uuid`,
          `invoice_amount_local`,
          `invoice_amount_usd`,
          `country`,
          `clara_industry`
        ) AS (
          WITH companies AS (
            SELECT
              contract_id,
              country,
              clara_industry
            FROM
              production.entities.all_clients
          ),
          tpv AS (
            SELECT
              t.file_date,
              t.operation_uuid,
              DATE_TRUNC ('MONTH', file_date) AS file_month,
              t.invoice_amount_local,
              t.invoice_amount_usd,
              coalesce(t.clara_category, 'Undefined') as clara_category,
              t.country,
              coalesce(k.clara_industry, 'Undefined') as clara_industry
            FROM
              production.finance.tpv_global AS t
             
LEFT JOIN companies AS k ON t.country = k.country
             
   AND t.contract_id = k.contract_id
           
WHERE
              tpv = TRUE
              AND file_date >= '2023-01-01'
          ),
          totals AS (
            SELECT
              file_month,
              country,
              SUM(invoice_amount_usd) AS monthly_tpv,
              SUM(invoice_amount_local) AS monthly_tpv_local
            FROM
              tpv
           
GROUP BY
              country,
              file_month
          ),
          tpv2 AS (
            SELECT
              t.*,
              a.monthly_tpv,
              a.monthly_tpv_local
            FROM
              tpv t
              LEFT OUTER JOIN totals a ON t.country = a.country
              AND t.file_month = a.file_month
          ),
          
final as (
            SELECT
              t.file_date,
              t.operation_uuid,
              t.invoice_amount_local,
              t.invoice_amount_usd,
              t.country,
              t.clara_industry
            FROM
              tpv2 AS t
          )
          SELECT
            *
          FROM
            final
        )
        SELECT
          ADD_MONTHS(
            TRUNC(CAST(`source`.`file_date` AS timestamp), 'year'),
            (
              QUARTER(CAST(`source`.`file_date` AS timestamp)) - 1
            ) * 3
          ) AS `file_date`,
          `source`.`clara_industry` AS `clara_industry`,
          `source`.`country` AS `country`,
          `source`.`invoice_amount_local` AS `invoice_amount_local`,
          `source`.`invoice_amount_usd` AS `invoice_amount_usd`
        FROM
          `source`
      ) AS `source`
    GROUP BY
      CAST(`source`.`file_date` AS timestamp),
      `source`.`clara_industry`,
      `source`.`country`
    ORDER BY
      `source`.`clara_industry` ASC,
      `source`.`country` ASC,
      CAST(`source`.`file_date` AS timestamp) ASC
  ) AS `source`
WHERE
  (
    CAST(`source`.`file_date` AS timestamp) >= ADD_MONTHS(TRUNC(NOW(), 'year'), (QUARTER(NOW()) - 1) * 3)
  )
  AND (
    CAST(`source`.`file_date` AS timestamp) < ADD_MONTHS(
      TRUNC((NOW() + (interval '3' month)), 'year'),
      (QUARTER((NOW() + (interval '3' month))) - 1) * 3
    )
  )
LIMIT
  1048575

miguel-magos-cl (Issue Creator) on (2025-01-31 18:11:26 UTC): If we change the last section of the query removing ""source."" from the names of columns it works.
These are the last lines of the query we changed to make it work:

 GROUP BY
      CAST(`file_date` AS timestamp),
      `clara_industry`,
      `country`
    ORDER BY
      `clara_industry` ASC,
      `country` ASC,
      CAST(`file_date` AS timestamp) ASC
  ) AS `source`
WHERE
  (
    CAST(`file_date` AS timestamp) >= ADD_MONTHS(TRUNC(NOW(), 'year'), (QUARTER(NOW()) - 1) * 3)
  )
  AND (
    CAST(`file_date` AS timestamp) < ADD_MONTHS(
      TRUNC((NOW() + (interval '3' month)), 'year'),
      (QUARTER((NOW() + (interval '3' month))) - 1) * 3
    )
  )
LIMIT
1048575

luizarakaki on (2025-02-05 17:24:12 UTC): @miguel-magos-cl we need better reproduction steps... we tried simple question, using models, nested questions but we are unable to reproduce this.

"
2807730772,issue,closed,completed,Drill-Down Summarize Not Showing Underlying Fields After Version 52,"### Describe the bug

After the version 52 update, there's a difference with drill-down functionality. 
When drilling down into a chart and selecting ""Summarize,"" the underlying fields do not appear. Instead, only the fields that have already been summarized are visible. 
However, opening the editor and then clicking ""Visualize"" again makes the underlying fields accessible.

### To Reproduce

1. Create a question like the following.  

<img width=""918"" alt=""Image"" src=""https://github.com/user-attachments/assets/2040cafe-4370-403f-a278-e8809c47ee33"" />

<br> 

 2. Add it to a dashboard.  
<img width=""1061"" alt=""Image"" src=""https://github.com/user-attachments/assets/ec7a9e9a-31f4-4891-9ce0-a9b3f09de6c7"" />

<br> 

3. Break out by date period.  

<img width=""251"" alt=""Image"" src=""https://github.com/user-attachments/assets/aebd7eef-a43b-481e-bb8f-06fa96a6951a"" />. 

<br>

4. Click Summarize button.  

<img width=""1088"" alt=""Image"" src=""https://github.com/user-attachments/assets/46539fbc-f9eb-4e31-84f2-a41d4cf03bd6"" />

<br>

5. Click Show Editor, then Visualize, then Summarize once again.    

<img width=""1088"" alt=""Image"" src=""https://github.com/user-attachments/assets/08f87564-dd64-4841-96e7-d594f96f895b"" />. 

<br>

Loom recording in 1.52.7
https://www.loom.com/share/be91cf5c39e24339bb7898a56e87ccd9?sid=4062e94a-0964-4c27-8ee2-e3f89a1e1d4f. 

<br>

Loom recording in 1.51.6
https://www.loom.com/share/a336cfe684de4ed9a21967a7a0898358?sid=08999c53-f585-43ec-a846-07f6d6616610. 


### Expected behavior

To behave similar to previous to 52 release.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""snowflake"",
      ""postgres"",
      ""mysql"",
      ""mongo"",
      ""h2"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-22"",
      ""tag"": ""v1.52.7.1"",
      ""hash"": ""d8f503d""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.3""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.5"",
    ""user.language"": ""en"",
    ""user.timezone"": ""America/Chicago""
  }
}
```

### Severity

P2 - It's become a friction point for a customer providing self-serve analytics

### Additional context

_No response_",FilmonK,2025-01-23 19:23:33+00:00,['ranquild'],2025-01-24 15:22:27+00:00,2025-01-24 14:21:30+00:00,https://github.com/metabase/metabase/issues/52627,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('Querying/MBQL', ''), ('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]",[],
2807489428,issue,closed,completed,Metabot - remove schema check for top level keys casing,"There is an issue happening caused by the various key casings used by different Metabot parts (frontend, backend AI Service) where the fix is to have snake_cased keys in top level tools object. Currently kebab-case  is enforced by the schema.

More info: https://metaboat.slack.com/archives/C07SJT1P0ET/p1737649249835089?thread_ts=1737641593.103299&cid=C07SJT1P0ET",retro,2025-01-23 17:22:29+00:00,['metamben'],2025-01-23 19:38:20+00:00,2025-01-23 19:38:20+00:00,https://github.com/metabase/metabase/issues/52612,"[('Metabot/Tools', 'Tools that are agnostic of the LLM framework itself, could be reused for notifications framework als')]",[],
2807464228,issue,closed,completed,support aggregation functions inside expressions in aggregation,"**Context**

- create a new question from Orders table
- open summarize block -> expression
- add `case(Sum([Total]) > 10, Sum([Total]), Sum([Subtotal]))` -> `Expecting expression but found function Sum returning aggregation`


<img width=""526"" alt=""Image"" src=""https://github.com/user-attachments/assets/daf9f34a-c055-49c9-b0c8-42ecd71ff519"" />

FE should be able to handle this case, the source of the problem is inside `frontend/src/metabase-lib/v1/expressions/resolver.js` -> `isCompatible` function. 

It checks our custom map from `MBQL_CLAUSES` and identifies that we pass aggregation and not expression and marks the expression as invalid

",uladzimirdev,2025-01-23 17:11:02+00:00,['uladzimirdev'],2025-01-24 15:00:28+00:00,2025-01-24 11:00:34+00:00,https://github.com/metabase/metabase/issues/52611,"[('.Frontend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2807438152,issue,open,,Custom Colors for Sankey Charts,"**Is your feature request related to a problem? Please describe.**
We update all of our chart colors such that the colors indicate a specific category. Sankey diagrams don't allow this customization, so the color system we use for other charts cannot be applied to Sankey diagrams. This leads to inconsistency in our visualizations, making it harder for users to interpret data quickly and maintain a cohesive visual experience across dashboards.

**Describe the solution you'd like**
The option to set colors in a fashion similar to how you can for Pie Charts.

**Describe alternatives you've considered**
We're using a 3rd party for Sankey charts. 

**How important is this feature to you?**
In our case it make sit difficult to use Sankey diagrams at all because it confuses our users.

**Additional context**
Customer request",ixipixi,2025-01-23 16:59:01+00:00,[],2025-02-04 20:31:32+00:00,,https://github.com/metabase/metabase/issues/52610,"[('Type:New Feature', ''), ('Visualization/Chart Settings', ''), ('Visualization/Charts/Sankey', '')]",[],
2807416648,issue,closed,completed,using aggregation inside expression in summarize block throws an exception,"**Context**

- create a new question from orders table
- in Summarize block, add an expression with an aggregation function
- in breakout block select ""Product -> Category""

e.g.

```
case([Product → Category] = ""Gizmo"", Sum([Total]) * 1.2, [Product → Category] = ""Gadget"", Sum([Total]) * 0.9, Sum([Total]) / 1)
```

It works fine, but if you remove last `/ 1` and just keep that aggregation, query will fail

```
case([Product → Category] = ""Gizmo"", Sum([Total]) * 1.2, [Product → Category] = ""Gadget"", Sum([Total]) * 0.9, Sum([Total]))
```


<details><summary>POST request to `/api/dataset`:</summary>
<p>

```json
{
  ""database"": 1,
  ""type"": ""query"",
  ""query"": {
    ""source-table"": 5,
    ""aggregation"": [
      [
        ""aggregation-options"",
        [
          ""case"",
          [
            [
              [
                ""="",
                [
                  ""field"",
                  58,
                  {
                    ""base-type"": ""type/Text"",
                    ""source-field"": 40
                  }
                ],
                ""Gizmo""
              ],
              [
                ""*"",
                [
                  ""sum"",
                  [
                    ""field"",
                    42,
                    {
                      ""base-type"": ""type/Float""
                    }
                  ]
                ],
                1.2
              ]
            ],
            [
              [
                ""="",
                [
                  ""field"",
                  58,
                  {
                    ""base-type"": ""type/Text"",
                    ""source-field"": 40
                  }
                ],
                ""Gadget""
              ],
              [
                ""*"",
                [
                  ""sum"",
                  [
                    ""field"",
                    42,
                    {
                      ""base-type"": ""type/Float""
                    }
                  ]
                ],
                0.9
              ]
            ]
          ],
          {
            ""default"": [
              ""sum"",
              [
                ""field"",
                42,
                {
                  ""base-type"": ""type/Float""
                }
              ]
            ]
          }
        ],
        {
          ""name"": ""custom total"",
          ""display-name"": ""custom total""
        }
      ]
    ],
    ""breakout"": [
      [
        ""field"",
        58,
        {
          ""base-type"": ""type/Text"",
          ""source-field"": 40
        }
      ]
    ],
    ""aggregation-idents"": {
      ""0"": ""XQ7KEe-QRkPB21UdEosfi""
    },
    ""breakout-idents"": {
      ""0"": ""wYrEuUwGgS-udIffygUER""
    }
  },
  ""parameters"": []
}
```

</p>
</details> 

<details><summary>Response</summary>
<p>

```
{
	""via"": [
		{
			""status"": ""failed"",
			""class"": ""class clojure.lang.ExceptionInfo"",
			""error"": ""Error creating query from legacy query: Invalid output: {:query {:aggregation [[nil [nil nil {:default [\""valid instance of one of these MBQL clauses: :expression, :field, got: [:sum [:field 42 {:base-type :type/Float}]]\""], :malli/error [\""input remaining, got: {:default [:sum [:field 42 {:base-type :type/Float}]]}\""]}]]]}}"",
			""stacktrace"": [
				""--> lib.query$query_from_legacy_query.invokeStatic(query.cljc:183)"",
				""lib.query$query_from_legacy_query.invoke(query.cljc:173)"",
				""lib.query$eval52833$fn__52834.invoke(query.cljc:197)"",
				""lib.query$fn__52898$query52897__52899.invoke(query.cljc:294)"",
				""lib.query$fn__52898$fn__52901.invoke(query.cljc:288)"",
				""query_processor.middleware.normalize_query$normalize_STAR_.invokeStatic(normalize_query.clj:21)"",
				""query_processor.middleware.normalize_query$normalize_STAR_.invoke(normalize_query.clj:13)"",
				""query_processor.middleware.normalize_query$fn__101034$normalize_preprocessing_middleware101033__101035.invoke(normalize_query.clj:38)"",
				""query_processor.middleware.normalize_query$fn__101034$fn__101039.invoke(normalize_query.clj:33)"",
				""query_processor.preprocess$fn__102943$preprocess102942__102944$fn__102945$fn__102946.invoke(preprocess.clj:161)"",
				""query_processor.preprocess$fn__102943$preprocess102942__102944$fn__102945.invoke(preprocess.clj:151)"",
				""query_processor.setup$fn__102898$do_with_qp_setup102897__102899.invoke(setup.clj:225)"",
				""query_processor.setup$fn__102898$fn__102903.invoke(setup.clj:216)"",
				""query_processor.preprocess$fn__102943$preprocess102942__102944.invoke(preprocess.clj:149)"",
				""query_processor.preprocess$fn__102943$fn__102959.invoke(preprocess.clj:145)"",
				""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:46)"",
				""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:44)"",
				""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$eval155803$handle_audit_app_internal_queries__155804$fn__155805.invoke(handle_audit_queries.clj:143)"",
				""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__97581.invoke(enterprise.clj:103)"",
				""query_processor.middleware.process_userland_query$fn__103982$process_userland_query_middleware103981__103983$_AMPERSAND_f__103984.invoke(process_userland_query.clj:221)"",
				""query_processor.middleware.process_userland_query$fn__103982$process_userland_query_middleware103981__103983$fn__103990.invoke(process_userland_query.clj:205)"",
				""query_processor.middleware.catch_exceptions$fn__103648$catch_exceptions103647__103649$_AMPERSAND_f__103650.invoke(catch_exceptions.clj:132)"",
				""query_processor.middleware.catch_exceptions$fn__103648$catch_exceptions103647__103649$fn__103662.invoke(catch_exceptions.clj:122)"",
				""query_processor$fn__104318$process_query104317__104319$fn__104320.invoke(query_processor.clj:80)"",
				""query_processor.setup$fn__102889$do_with_canceled_chan102888__102890$fn__102891.invoke(setup.clj:187)"",
				""query_processor.setup$fn__102878$do_with_database_local_settings102877__102879$fn__102880.invoke(setup.clj:181)"",
				""query_processor.setup$fn__102867$do_with_driver102866__102868$fn__102869$fn__102870.invoke(setup.clj:166)"",
				""driver$do_with_driver.invokeStatic(driver.clj:106)"",
				""driver$do_with_driver.invoke(driver.clj:101)"",
				""query_processor.setup$fn__102867$do_with_driver102866__102868$fn__102869.invoke(setup.clj:165)"",
				""query_processor.setup$fn__102854$do_with_metadata_provider102853__102855$fn__102856$fn__102859.invoke(setup.clj:151)"",
				""query_processor.store$fn__86879$do_with_metadata_provider86878__86880.invoke(store.clj:170)"",
				""query_processor.store$fn__86879$fn__86883.invoke(store.clj:150)"",
				""query_processor.store$fn__86879$do_with_metadata_provider86878__86880.invoke(store.clj:159)"",
				""query_processor.store$fn__86879$fn__86883.invoke(store.clj:150)"",
				""query_processor.setup$fn__102854$do_with_metadata_provider102853__102855$fn__102856.invoke(setup.clj:150)"",
				""query_processor.setup$fn__102834$do_with_resolved_database102833__102835$_AMPERSAND_f__102836.invoke(setup.clj:128)"",
				""query_processor.setup$fn__102834$do_with_resolved_database102833__102835$fn__102839.invoke(setup.clj:122)"",
				""query_processor.setup$fn__102898$do_with_qp_setup102897__102899.invoke(setup.clj:232)"",
				""query_processor.setup$fn__102898$fn__102903.invoke(setup.clj:216)"",
				""query_processor$fn__104318$process_query104317__104319.invoke(query_processor.clj:78)"",
				""query_processor$fn__104318$fn__104324.invoke(query_processor.clj:71)"",
				""api.dataset$fn__135293$run_streaming_query135292__135296$fn__135300.invoke(dataset.clj:81)"",
				""query_processor.streaming$_streaming_response$fn__90284$fn__90285$fn__90286.invoke(streaming.clj:185)"",
				""query_processor.streaming$_streaming_response$fn__90284$fn__90285.invoke(streaming.clj:183)"",
				""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:174)"",
				""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:161)"",
				""query_processor.streaming$_streaming_response$fn__90284.invoke(streaming.clj:180)"",
				""server.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)"",
				""server.streaming_response$do_f_STAR_.invoke(streaming_response.clj:76)"",
				""server.streaming_response$do_f_async$task__27959.invoke(streaming_response.clj:93)""
			],
			""ex-data"": {
				""legacy-query"": {
					""database"": 1,
					""type"": ""query"",
					""query"": {
						""source-table"": 5,
						""aggregation"": [
							[
								""aggregation-options"",
								[
									""case"",
									[
										[
											[
												""="",
												[
													""field"",
													58,
													{
														""base-type"": ""type/Text"",
														""source-field"": 40
													}
												],
												""Gizmo""
											],
											[
												""*"",
												[
													""sum"",
													[
														""field"",
														42,
														{
															""base-type"": ""type/Float""
														}
													]
												],
												1.2
											]
										],
										[
											[
												""="",
												[
													""field"",
													58,
													{
														""base-type"": ""type/Text"",
														""source-field"": 40
													}
												],
												""Gadget""
											],
											[
												""*"",
												[
													""sum"",
													[
														""field"",
														42,
														{
															""base-type"": ""type/Float""
														}
													]
												],
												0.9
											]
										]
									],
									{
										""default"": [
											""sum"",
											[
												""field"",
												42,
												{
													""base-type"": ""type/Float""
												}
											]
										]
									}
								],
								{
									""name"": ""custom total"",
									""display-name"": ""custom total""
								}
							]
						],
						""breakout"": [
							[
								""field"",
								58,
								{
									""base-type"": ""type/Text"",
									""source-field"": 40
								}
							]
						],
						""aggregation-idents"": {
							""0"": ""XQ7KEe-QRkPB21UdEosfi""
						},
						""breakout-idents"": {
							""0"": ""wYrEuUwGgS-udIffygUER""
						}
					},
					""parameters"": [],
					""middleware"": {
						""js-int-to-string?"": true,
						""userland-query?"": true,
						""add-default-userland-constraints?"": true
					},
					""info"": {
						""executed-by"": 1,
						""context"": ""ad-hoc"",
						""card-id"": null,
						""query-hash"": ""0xAA9EA3F9""
					}
				}
			}
		},
		{
			""status"": ""failed"",
			""class"": ""class clojure.lang.ExceptionInfo"",
			""error"": ""Error normalizing query: Error creating query from legacy query: Invalid output: {:query {:aggregation [[nil [nil nil {:default [\""valid instance of one of these MBQL clauses: :expression, :field, got: [:sum [:field 42 {:base-type :type/Float}]]\""], :malli/error [\""input remaining, got: {:default [:sum [:field 42 {:base-type :type/Float}]]}\""]}]]]}}"",
			""stacktrace"": [
				""--> query_processor.middleware.normalize_query$fn__101034$normalize_preprocessing_middleware101033__101035.invoke(normalize_query.clj:41)"",
				""query_processor.middleware.normalize_query$fn__101034$fn__101039.invoke(normalize_query.clj:33)"",
				""query_processor.preprocess$fn__102943$preprocess102942__102944$fn__102945$fn__102946.invoke(preprocess.clj:161)"",
				""query_processor.preprocess$fn__102943$preprocess102942__102944$fn__102945.invoke(preprocess.clj:151)"",
				""query_processor.setup$fn__102898$do_with_qp_setup102897__102899.invoke(setup.clj:225)"",
				""query_processor.setup$fn__102898$fn__102903.invoke(setup.clj:216)"",
				""query_processor.preprocess$fn__102943$preprocess102942__102944.invoke(preprocess.clj:149)"",
				""query_processor.preprocess$fn__102943$fn__102959.invoke(preprocess.clj:145)"",
				""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:46)"",
				""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:44)"",
				""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$eval155803$handle_audit_app_internal_queries__155804$fn__155805.invoke(handle_audit_queries.clj:143)"",
				""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__97581.invoke(enterprise.clj:103)"",
				""query_processor.middleware.process_userland_query$fn__103982$process_userland_query_middleware103981__103983$_AMPERSAND_f__103984.invoke(process_userland_query.clj:221)"",
				""query_processor.middleware.process_userland_query$fn__103982$process_userland_query_middleware103981__103983$fn__103990.invoke(process_userland_query.clj:205)"",
				""query_processor.middleware.catch_exceptions$fn__103648$catch_exceptions103647__103649$_AMPERSAND_f__103650.invoke(catch_exceptions.clj:132)"",
				""query_processor.middleware.catch_exceptions$fn__103648$catch_exceptions103647__103649$fn__103662.invoke(catch_exceptions.clj:122)"",
				""query_processor$fn__104318$process_query104317__104319$fn__104320.invoke(query_processor.clj:80)"",
				""query_processor.setup$fn__102889$do_with_canceled_chan102888__102890$fn__102891.invoke(setup.clj:187)"",
				""query_processor.setup$fn__102878$do_with_database_local_settings102877__102879$fn__102880.invoke(setup.clj:181)"",
				""query_processor.setup$fn__102867$do_with_driver102866__102868$fn__102869$fn__102870.invoke(setup.clj:166)"",
				""driver$do_with_driver.invokeStatic(driver.clj:106)"",
				""driver$do_with_driver.invoke(driver.clj:101)"",
				""query_processor.setup$fn__102867$do_with_driver102866__102868$fn__102869.invoke(setup.clj:165)"",
				""query_processor.setup$fn__102854$do_with_metadata_provider102853__102855$fn__102856$fn__102859.invoke(setup.clj:151)"",
				""query_processor.store$fn__86879$do_with_metadata_provider86878__86880.invoke(store.clj:170)"",
				""query_processor.store$fn__86879$fn__86883.invoke(store.clj:150)"",
				""query_processor.store$fn__86879$do_with_metadata_provider86878__86880.invoke(store.clj:159)"",
				""query_processor.store$fn__86879$fn__86883.invoke(store.clj:150)"",
				""query_processor.setup$fn__102854$do_with_metadata_provider102853__102855$fn__102856.invoke(setup.clj:150)"",
				""query_processor.setup$fn__102834$do_with_resolved_database102833__102835$_AMPERSAND_f__102836.invoke(setup.clj:128)"",
				""query_processor.setup$fn__102834$do_with_resolved_database102833__102835$fn__102839.invoke(setup.clj:122)"",
				""query_processor.setup$fn__102898$do_with_qp_setup102897__102899.invoke(setup.clj:232)"",
				""query_processor.setup$fn__102898$fn__102903.invoke(setup.clj:216)"",
				""query_processor$fn__104318$process_query104317__104319.invoke(query_processor.clj:78)"",
				""query_processor$fn__104318$fn__104324.invoke(query_processor.clj:71)"",
				""api.dataset$fn__135293$run_streaming_query135292__135296$fn__135300.invoke(dataset.clj:81)"",
				""query_processor.streaming$_streaming_response$fn__90284$fn__90285$fn__90286.invoke(streaming.clj:185)"",
				""query_processor.streaming$_streaming_response$fn__90284$fn__90285.invoke(streaming.clj:183)"",
				""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:174)"",
				""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:161)"",
				""query_processor.streaming$_streaming_response$fn__90284.invoke(streaming.clj:180)"",
				""server.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)"",
				""server.streaming_response$do_f_STAR_.invoke(streaming_response.clj:76)"",
				""server.streaming_response$do_f_async$task__27959.invoke(streaming_response.clj:93)""
			],
			""error_type"": ""qp"",
			""ex-data"": {
				""type"": ""qp"",
				""query"": {
					""database"": 1,
					""type"": ""query"",
					""query"": {
						""source-table"": 5,
						""aggregation"": [
							[
								""aggregation-options"",
								[
									""case"",
									[
										[
											[
												""="",
												[
													""field"",
													58,
													{
														""base-type"": ""type/Text"",
														""source-field"": 40
													}
												],
												""Gizmo""
											],
											[
												""*"",
												[
													""sum"",
													[
														""field"",
														42,
														{
															""base-type"": ""type/Float""
														}
													]
												],
												1.2
											]
										],
										[
											[
												""="",
												[
													""field"",
													58,
													{
														""base-type"": ""type/Text"",
														""source-field"": 40
													}
												],
												""Gadget""
											],
											[
												""*"",
												[
													""sum"",
													[
														""field"",
														42,
														{
															""base-type"": ""type/Float""
														}
													]
												],
												0.9
											]
										]
									],
									{
										""default"": [
											""sum"",
											[
												""field"",
												42,
												{
													""base-type"": ""type/Float""
												}
											]
										]
									}
								],
								{
									""name"": ""custom total"",
									""display-name"": ""custom total""
								}
							]
						],
						""breakout"": [
							[
								""field"",
								58,
								{
									""base-type"": ""type/Text"",
									""source-field"": 40
								}
							]
						],
						""aggregation-idents"": {
							""0"": ""XQ7KEe-QRkPB21UdEosfi""
						},
						""breakout-idents"": {
							""0"": ""wYrEuUwGgS-udIffygUER""
						}
					},
					""parameters"": [],
					""middleware"": {
						""js-int-to-string?"": true,
						""userland-query?"": true,
						""add-default-userland-constraints?"": true
					},
					""info"": {
						""executed-by"": 1,
						""context"": ""ad-hoc"",
						""card-id"": null,
						""query-hash"": ""0xAA9EA3F9""
					}
				}
			}
		},
		{
			""status"": ""failed"",
			""class"": ""class clojure.lang.ExceptionInfo"",
			""error"": ""Error preprocessing query in #'metabase.query-processor.middleware.normalize-query/normalize-preprocessing-middleware: Error normalizing query: Error creating query from legacy query: Invalid output: {:query {:aggregation [[nil [nil nil {:default [\""valid instance of one of these MBQL clauses: :expression, :field, got: [:sum [:field 42 {:base-type :type/Float}]]\""], :malli/error [\""input remaining, got: {:default [:sum [:field 42 {:base-type :type/Float}]]}\""]}]]]}}"",
			""stacktrace"": [
				""--> query_processor.preprocess$fn__102943$preprocess102942__102944$fn__102945$fn__102946.invoke(preprocess.clj:178)"",
				""query_processor.preprocess$fn__102943$preprocess102942__102944$fn__102945.invoke(preprocess.clj:151)"",
				""query_processor.setup$fn__102898$do_with_qp_setup102897__102899.invoke(setup.clj:225)"",
				""query_processor.setup$fn__102898$fn__102903.invoke(setup.clj:216)"",
				""query_processor.preprocess$fn__102943$preprocess102942__102944.invoke(preprocess.clj:149)"",
				""query_processor.preprocess$fn__102943$fn__102959.invoke(preprocess.clj:145)"",
				""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:46)"",
				""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:44)"",
				""metabase_enterprise.audit_app.query_processor.middleware.handle_audit_queries$eval155803$handle_audit_app_internal_queries__155804$fn__155805.invoke(handle_audit_queries.clj:143)"",
				""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__97581.invoke(enterprise.clj:103)"",
				""query_processor.middleware.process_userland_query$fn__103982$process_userland_query_middleware103981__103983$_AMPERSAND_f__103984.invoke(process_userland_query.clj:221)"",
				""query_processor.middleware.process_userland_query$fn__103982$process_userland_query_middleware103981__103983$fn__103990.invoke(process_userland_query.clj:205)"",
				""query_processor.middleware.catch_exceptions$fn__103648$catch_exceptions103647__103649$_AMPERSAND_f__103650.invoke(catch_exceptions.clj:132)"",
				""query_processor.middleware.catch_exceptions$fn__103648$catch_exceptions103647__103649$fn__103662.invoke(catch_exceptions.clj:122)"",
				""query_processor$fn__104318$process_query104317__104319$fn__104320.invoke(query_processor.clj:80)"",
				""query_processor.setup$fn__102889$do_with_canceled_chan102888__102890$fn__102891.invoke(setup.clj:187)"",
				""query_processor.setup$fn__102878$do_with_database_local_settings102877__102879$fn__102880.invoke(setup.clj:181)"",
				""query_processor.setup$fn__102867$do_with_driver102866__102868$fn__102869$fn__102870.invoke(setup.clj:166)"",
				""driver$do_with_driver.invokeStatic(driver.clj:106)"",
				""driver$do_with_driver.invoke(driver.clj:101)"",
				""query_processor.setup$fn__102867$do_with_driver102866__102868$fn__102869.invoke(setup.clj:165)"",
				""query_processor.setup$fn__102854$do_with_metadata_provider102853__102855$fn__102856$fn__102859.invoke(setup.clj:151)"",
				""query_processor.store$fn__86879$do_with_metadata_provider86878__86880.invoke(store.clj:170)"",
				""query_processor.store$fn__86879$fn__86883.invoke(store.clj:150)"",
				""query_processor.store$fn__86879$do_with_metadata_provider86878__86880.invoke(store.clj:159)"",
				""query_processor.store$fn__86879$fn__86883.invoke(store.clj:150)"",
				""query_processor.setup$fn__102854$do_with_metadata_provider102853__102855$fn__102856.invoke(setup.clj:150)"",
				""query_processor.setup$fn__102834$do_with_resolved_database102833__102835$_AMPERSAND_f__102836.invoke(setup.clj:128)"",
				""query_processor.setup$fn__102834$do_with_resolved_database102833__102835$fn__102839.invoke(setup.clj:122)"",
				""query_processor.setup$fn__102898$do_with_qp_setup102897__102899.invoke(setup.clj:232)"",
				""query_processor.setup$fn__102898$fn__102903.invoke(setup.clj:216)"",
				""query_processor$fn__104318$process_query104317__104319.invoke(query_processor.clj:78)"",
				""query_processor$fn__104318$fn__104324.invoke(query_processor.clj:71)"",
				""api.dataset$fn__135293$run_streaming_query135292__135296$fn__135300.invoke(dataset.clj:81)"",
				""query_processor.streaming$_streaming_response$fn__90284$fn__90285$fn__90286.invoke(streaming.clj:185)"",
				""query_processor.streaming$_streaming_response$fn__90284$fn__90285.invoke(streaming.clj:183)"",
				""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:174)"",
				""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:161)"",
				""query_processor.streaming$_streaming_response$fn__90284.invoke(streaming.clj:180)"",
				""server.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)"",
				""server.streaming_response$do_f_STAR_.invoke(streaming_response.clj:76)"",
				""server.streaming_response$do_f_async$task__27959.invoke(streaming_response.clj:93)""
			],
			""error_type"": ""qp"",
			""ex-data"": {
				""fn"": ""#'metabase.query-processor.middleware.normalize-query/normalize-preprocessing-middleware"",
				""query"": {
					""database"": 1,
					""type"": ""query"",
					""query"": {
						""source-table"": 5,
						""aggregation"": [
							[
								""aggregation-options"",
								[
									""case"",
									[
										[
											[
												""="",
												[
													""field"",
													58,
													{
														""base-type"": ""type/Text"",
														""source-field"": 40
													}
												],
												""Gizmo""
											],
											[
												""*"",
												[
													""sum"",
													[
														""field"",
														42,
														{
															""base-type"": ""type/Float""
														}
													]
												],
												1.2
											]
										],
										[
											[
												""="",
												[
													""field"",
													58,
													{
														""base-type"": ""type/Text"",
														""source-field"": 40
													}
												],
												""Gadget""
											],
											[
												""*"",
												[
													""sum"",
													[
														""field"",
														42,
														{
															""base-type"": ""type/Float""
														}
													]
												],
												0.9
											]
										]
									],
									{
										""default"": [
											""sum"",
											[
												""field"",
												42,
												{
													""base-type"": ""type/Float""
												}
											]
										]
									}
								],
								{
									""name"": ""custom total"",
									""display-name"": ""custom total""
								}
							]
						],
						""breakout"": [
							[
								""field"",
								58,
								{
									""base-type"": ""type/Text"",
									""source-field"": 40
								}
							]
						],
						""aggregation-idents"": {
							""0"": ""XQ7KEe-QRkPB21UdEosfi""
						},
						""breakout-idents"": {
							""0"": ""wYrEuUwGgS-udIffygUER""
						}
					},
					""parameters"": [],
					""middleware"": {
						""js-int-to-string?"": true,
						""userland-query?"": true,
						""add-default-userland-constraints?"": true
					},
					""info"": {
						""executed-by"": 1,
						""context"": ""ad-hoc"",
						""card-id"": null,
						""query-hash"": ""0xAA9EA3F9""
					}
				},
				""type"": ""qp""
			}
		}
	]
}
```
</p>
</details> 
",uladzimirdev,2025-01-23 16:48:43+00:00,[],2025-01-23 20:36:52+00:00,2025-01-23 20:36:51+00:00,https://github.com/metabase/metabase/issues/52608,"[('Querying/MBQL', ''), ('.Backend', ''), ('.Task', 'Not a part of any Epic, used by the Task Issue Template')]","[{'comment_id': 2610966584, 'issue_id': 2807416648, 'author': 'uladzimirdev', 'body': 'fixed in https://github.com/metabase/metabase/pull/52505', 'created_at': datetime.datetime(2025, 1, 23, 20, 36, 51, tzinfo=datetime.timezone.utc)}]","uladzimirdev (Issue Creator) on (2025-01-23 20:36:51 UTC): fixed in https://github.com/metabase/metabase/pull/52505

"
2807191186,issue,open,,Metabot - object keys casing decision,"In the Metabot API, we have data coming from the ""outside"":

1. From the frontend API
2. From the tool calls

Currently, object casing is inconsistent (some keys are using snake_case, some are using camelCase while Clojure code is using kebab-case).

Determine which standard are we going to apply to which API layer and consider performing conversion to kebab-case on the boundary

More info: https://metaboat.slack.com/archives/C07SJT1P0ET/p1737645407353569?thread_ts=1737641593.103299&cid=C07SJT1P0ET

Related issues:
https://github.com/metabase/metabase/issues/52597
https://github.com/metabase/metabase/issues/52612",retro,2025-01-23 15:21:00+00:00,['retro'],2025-02-04 20:26:19+00:00,,https://github.com/metabase/metabase/issues/52601,"[('Metabot/General', 'General Metabot AI'), ('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2807086675,issue,closed,completed,Metabot - Query By ID can't be found,More info here https://metaboat.slack.com/archives/C07SJT1P0ET/p1737641593103299,retro,2025-01-23 14:40:49+00:00,['metamben'],2025-01-23 19:39:06+00:00,2025-01-23 19:39:06+00:00,https://github.com/metabase/metabase/issues/52597,"[('Metabot/Tools', 'Tools that are agnostic of the LLM framework itself, could be reused for notifications framework als')]",[],
2807001521,issue,closed,not_planned,DuckDB Connector is not working after upgraded to 0.52.7,"### Describe the bug

Shows error ""Attempting to call unbound fn: #'metabase.models.secret/db-details-prop->secret-map"" when try to access the DuckDB database

### To Reproduce

Any action that requires the access to the table in DuckDB database would trigger this error

### Expected behavior

_No response_

### Logs

```JSON
[d2c05333-13df-4070-945d-711905ed0e5e] 2025-01-23T14:02:42+00:00 ERROR metabase.query-processor.middleware.catch-exceptions Error processing query: Attempting to call unbound fn: #'metabase.models.secret/db-details-prop->secret-map
{:database_id 9,
 :started_at #t ""2025-01-23T14:02:42.467575740Z[Europe/London]"",
 :action_id nil,
 :json_query
 {:database 9,
  :query {:source-table 36531},
  :type ""query"",
  :parameters [],
  :middleware {:js-int-to-string? true, :userland-query? true, :add-default-userland-constraints? true}},
 :native
 {:query
  ""<CENSORED>"",
  :params nil},
 :status :failed,
 :class java.lang.IllegalStateException,
 :stacktrace
 [""clojure.lang.Var$Unbound.throwArity(Var.java:47)""
  ""clojure.lang.AFn.invoke(AFn.java:36)""
  ""--> driver.duckdb$fn__119362.invokeStatic(duckdb.clj:64)""
  ""driver.duckdb$fn__119362.invoke(duckdb.clj:61)""
  ""driver.sql_jdbc.connection$create_pool_BANG_.invokeStatic(connection.clj:224)""
  ""driver.sql_jdbc.connection$create_pool_BANG_.invoke(connection.clj:212)""
  ""driver.sql_jdbc.connection$db__GT_pooled_connection_spec.invokeStatic(connection.clj:354)""
  ""driver.sql_jdbc.connection$db__GT_pooled_connection_spec.invoke(connection.clj:288)""
  ""driver.sql_jdbc.execute$datasource.invokeStatic(execute.clj:198)""
  ""driver.sql_jdbc.execute$datasource.invoke(execute.clj:194)""
  ""driver.sql_jdbc.execute$datasource_with_diagnostic_info_BANG_.invokeStatic(execute.clj:205)""
  ""driver.sql_jdbc.execute$datasource_with_diagnostic_info_BANG_.invoke(execute.clj:200)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection_data_source87447__87449.invokeStatic(execute.clj:300)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection_data_source87447__87449.invoke(execute.clj:266)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection87462__87463.invokeStatic(execute.clj:337)""
  ""driver.sql_jdbc.execute$do_with_resolved_connection87462__87463.invoke(execute.clj:321)""
  ""driver.sql_jdbc.execute$fn__87492.invokeStatic(execute.clj:392)""
  ""driver.sql_jdbc.execute$fn__87492.invoke(execute.clj:390)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:707)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:693)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:704)""
  ""driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:693)""
  ""driver.sql_jdbc$fn__115850.invokeStatic(sql_jdbc.clj:79)""
  ""driver.sql_jdbc$fn__115850.invoke(sql_jdbc.clj:77)""
  ""query_processor.pipeline$_STAR_execute_STAR_.invokeStatic(pipeline.clj:52)""
  ""query_processor.pipeline$_STAR_execute_STAR_.invoke(pipeline.clj:39)""
  ""query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:102)""
  ""query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:95)""
  ""query_processor.execute$run.invokeStatic(execute.clj:62)""
  ""query_processor.execute$run.invoke(execute.clj:56)""
  ""query_processor.middleware.update_used_cards$update_used_cards_BANG_76031__76032$fn__76033.invoke(update_used_cards.clj:60)""
  ""query_processor.execute$add_native_form_to_result_metadata$fn__76048.invoke(execute.clj:25)""
  ""query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__76054.invoke(execute.clj:36)""
  ""query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___76004.invoke(cache.clj:241)""
  ""query_processor.middleware.permissions$check_query_permissions$fn__72676.invoke(permissions.clj:148)""
  ""query_processor.middleware.enterprise$check_download_permissions_middleware$fn__73397.invoke(enterprise.clj:51)""
  ""query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__73407.invoke(enterprise.clj:64)""
  ""query_processor.execute$execute76081__76082$fn__76083.invoke(execute.clj:94)""
  ""query_processor.setup$do_with_qp_setup73951__73952.invokeStatic(setup.clj:225)""
  ""query_processor.setup$do_with_qp_setup73951__73952.invoke(setup.clj:216)""
  ""query_processor.execute$execute76081__76082.invokeStatic(execute.clj:93)""
  ""query_processor.execute$execute76081__76082.invoke(execute.clj:89)""
  ""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:49)""
  ""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:44)""
  ""query_processor.middleware.enterprise$fn__73424$handle_audit_app_internal_queries__73425$fn__73427.invoke(enterprise.clj:96)""
  ""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__73435.invoke(enterprise.clj:103)""
  ""query_processor.middleware.process_userland_query$process_userland_query_middleware78594__78595$fn__78596.invoke(process_userland_query.clj:217)""
  ""query_processor.middleware.catch_exceptions$catch_exceptions78659__78660$fn__78661.invoke(catch_exceptions.clj:132)""
  ""query_processor$process_query78700__78701$fn__78702.invoke(query_processor.clj:80)""
  ""query_processor.setup$do_with_canceled_chan73946__73947$fn__73948.invoke(setup.clj:187)""
  ""query_processor.setup$do_with_database_local_settings73939__73940$fn__73941.invoke(setup.clj:181)""
  ""query_processor.setup$do_with_driver73932__73933$fn__73934$fn__73935.invoke(setup.clj:166)""
  ""driver$do_with_driver.invokeStatic(driver.clj:106)""
  ""driver$do_with_driver.invoke(driver.clj:101)""
  ""query_processor.setup$do_with_driver73932__73933$fn__73934.invoke(setup.clj:165)""
  ""query_processor.setup$do_with_metadata_provider73923__73924$fn__73925$fn__73928.invoke(setup.clj:151)""
  ""query_processor.store$do_with_metadata_provider59833__59834.invokeStatic(store.clj:170)""
  ""query_processor.store$do_with_metadata_provider59833__59834.invoke(store.clj:150)""
  ""query_processor.store$do_with_metadata_provider59833__59834.invokeStatic(store.clj:159)""
  ""query_processor.store$do_with_metadata_provider59833__59834.invoke(store.clj:150)""
  ""query_processor.setup$do_with_metadata_provider73923__73924$fn__73925.invoke(setup.clj:150)""
  ""query_processor.setup$do_with_resolved_database73913__73914$fn__73915.invoke(setup.clj:128)""
  ""query_processor.setup$do_with_qp_setup73951__73952.invokeStatic(setup.clj:232)""
  ""query_processor.setup$do_with_qp_setup73951__73952.invoke(setup.clj:216)""
  ""query_processor$process_query78700__78701.invokeStatic(query_processor.clj:78)""
  ""query_processor$process_query78700__78701.invoke(query_processor.clj:71)""
  ""api.dataset$run_streaming_query102258__102261$fn__102265.invoke(dataset.clj:84)""
  ""query_processor.streaming$_streaming_response$fn__83227$fn__83228$fn__83229.invoke(streaming.clj:185)""
  ""query_processor.streaming$_streaming_response$fn__83227$fn__83228.invoke(streaming.clj:183)""
  ""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:174)""
  ""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:161)""
  ""query_processor.streaming$_streaming_response$fn__83227.invoke(streaming.clj:180)""
  ""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)""
  ""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:76)""
  ""async.streaming_response$do_f_async$task__53492.invoke(streaming_response.clj:93)""],
 :card_id nil,
 :context :ad-hoc,
 :error ""Attempting to call unbound fn: #'metabase.models.secret/db-details-prop->secret-map"",
 :row_count 0,
 :running_time 0,
 :preprocessed
 {:database 9,
  :middleware {:js-int-to-string? true, :userland-query? true, :add-default-userland-constraints? true},
  :info {:executed-by 1, :context :ad-hoc},
  :constraints {:max-results 10000, :max-results-bare-rows 2000},
  :type :query,
  :query
  {:source-table 36531,
   :fields
   [[:field 32218 nil]
    [:field 32213 nil]
    [:field 32204 nil]
    [:field 32215 nil]
    [:field 32222 nil]
    [:field 32220 nil]
    [:field 32219 nil]
    [:field 32232 nil]
    [:field 32201 nil]
    [:field 32209 nil]
    [:field 32224 nil]
    [:field 32200 nil]
    [:field 32225 nil]
    [:field 32223 nil]
    [:field 32231 nil]
    [:field 32214 nil]
    [:field 32212 nil]
    [:field 32227 nil]
    [:field 32211 nil]
    [:field 32217 nil]
    [:field 32199 nil]
    [:field 32230 nil]
    [:field 32229 nil]
    [:field 32203 nil]
    [:field 32208 nil]
    [:field 32216 nil]
    [:field 32205 nil]
    [:field 32202 nil]
    [:field 32207 nil]
    [:field 32206 nil]
    [:field 32228 nil]
    [:field 32210 nil]
    [:field 32221 nil]
    [:field 32226 nil]],
   :limit 2000,
   :metabase.query-processor.middleware.limit/original-limit nil}},
 :data {:rows [], :cols []}}
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""duckdb"",
      ""h2"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-21"",
      ""tag"": ""v0.52.7"",
      ""hash"": ""ddbc480""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.0 (Debian 17.0-1.pgdg120+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""Java(TM) SE Runtime Environment"",
    ""java.runtime.version"": ""23.0.1+11-39"",
    ""java.vendor"": ""Oracle Corporation"",
    ""java.vendor.url"": ""https://java.oracle.com/"",
    ""java.version"": ""23.0.1"",
    ""java.vm.name"": ""Java HotSpot(TM) 64-Bit Server VM"",
    ""java.vm.version"": ""23.0.1+11-39"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.0-25-amd64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/London""
  }
}
```

### Severity

Blocking the usage of Metabase entirely

### Additional context

![Image](https://github.com/user-attachments/assets/41ea8e89-27b0-4982-9fd1-4a414f7a262b)",moonbug-car,2025-01-23 14:05:57+00:00,[],2025-02-04 18:33:37+00:00,2025-02-04 18:33:37+00:00,https://github.com/metabase/metabase/issues/52595,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Drivers', '')]","[{'comment_id': 2622650513, 'issue_id': 2807001521, 'author': 'feanor12', 'body': 'Duplicate of https://github.com/MotherDuck-Open-Source/metabase_duckdb_driver/issues/32', 'created_at': datetime.datetime(2025, 1, 29, 19, 29, 21, tzinfo=datetime.timezone.utc)}]","feanor12 on (2025-01-29 19:29:21 UTC): Duplicate of https://github.com/MotherDuck-Open-Source/metabase_duckdb_driver/issues/32

"
2806956868,issue,open,,Incomplete / confusing information for tooltips on bar style funnel charts,"### Describe the bug

When the Funnel type of a funnel chart is set to bar chart the tooltips will display incomplete and confusing information.

### To Reproduce

1. Open **Checkout funnel** from the *Examples* collection
2. Hover over a column to see a tooltip displayed. Note the correct data.
<img width=""756"" alt=""Image"" src=""https://github.com/user-attachments/assets/fe5cd386-5541-4e19-8650-d674625819bb"" />

3. In the **Display** tab in visualization settings, set **Funnel type** to **Bar chart**
4. See the error:
* the chart is displayed as if it were a regular bar chart with a series breakout:
* the tooltip does not show how the metric has changed compared to the previous step
* it unnecessarily shows '(empty)' for unrelated steps 
<img width=""752"" alt=""Image"" src=""https://github.com/user-attachments/assets/df46f8b6-8be4-4fd5-a8a3-46392c0d6c5b"" />



### Expected behavior

Similarly to the Funnel mode, the tooltip should display the metric of the highlighted step and the change compared to the previous one.

### Logs

_No response_

### Information about your Metabase installation

```JSON
1.52.6
```

### Severity

P2

### Additional context

Labeled the issue as a regression as this behaved slightly better in v50 - the information was still incomplete, but the series breakout and the confusing '(empty)' entries were not there.",zbodi74,2025-01-23 13:47:21+00:00,['alxnddr'],2025-02-04 20:31:49+00:00,,https://github.com/metabase/metabase/issues/52592,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/', ''), ('.Frontend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('Visualization/Tooltips', '')]",[],
2806954837,issue,closed,completed,Metabot - return a user friendly message when round trips are exhausted,"In the current implementation an exception is thrown when we exhaust the max number of round trips. The message returned to the user is something like ""Metabot is currently offline"".  We should return a more friendly user message - something like ""I can't answer your question"".",retro,2025-01-23 13:46:27+00:00,['metamben'],2025-01-23 19:38:02+00:00,2025-01-23 19:38:02+00:00,https://github.com/metabase/metabase/issues/52591,"[('Metabot/General', 'General Metabot AI')]",[],
2806741808,issue,open,,Data picker flickers when creating a new question,"### Describe the bug

https://github.com/user-attachments/assets/2b59d4e8-0252-4795-82f7-65757e0a3805

### To Reproduce

1. Open Metabase home page
2. New > Question

✅ Data picker is shown
❌ Data picker disappears and is shown again

----

I can't reproduce it every time.
Having browser dev tools open seems to increase probability of reproduction.
I reproduced it in both Chrome and Firefox.

It can be reproduced in stats without having dev tools open though (just repeat the repro steps from above until you hit it) - video attached [in Slack](https://metaboat.slack.com/archives/C05NXACAG1G/p1737634534343529?thread_ts=1737634214.921349&cid=C05NXACAG1G).

⚠ This is not due to React's double render in dev env as I was able to reproduce in prod as well.


### Information about your Metabase installation

master, 9e9292d5e45e6440d6b01a2e159cd3435962907a

### Severity

P2/P3 - annoying when you start to interact with the modal and then it disappears
",kamilmielnik,2025-01-23 12:10:01+00:00,[],2025-02-04 20:26:44+00:00,,https://github.com/metabase/metabase/issues/52587,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Organization/Entity picker', '')]",[],
2806605221,issue,closed,completed,Fix CodeMirror editor feedback,"### Description

Fixes product issues brought up by @mngr in the native editor revamp:

1. When I press Return in the middle of the text a new line is inserted as well as 2 trailing spaces, stats - the number of inserted trailing spaces or tabs depends on what was in the beginning of the previous line (correct)
2. When I hit Cmd+Return a new line is inserted (it shouldn't)
3. When I press tab, 2 spaces are inserted, stats - tab is inserted (ideally this should be a user setting)
4. The designation 'keyword' is not shown
5. The designations like 'table' or 'ACCOUNTS :type/integer' are aligned left and shown in italic, they should be aligned right and shown in normal font (correct)
6. The same suggestion shown multiple times (same column name in different tables), they should be deduplicated
7. Make the editor use query from MBQL lib instead of the legacy JS query. There are MBQL lib functions for native queries in metabase-lib/native.ts
8. Have component or unit tests for custom logic like autocompletion. Currently this seems to be covered with mostly e2e tests.
9. When hitting Tab in the end of the text, the indentation is inserted in the beginning of the text - it should be added in the end (as on stats)
10. Accept completions with tab
11. no need to show the suggestion when the word is entered already (as on stats)
12. Move this component from query_builder to the querying module, perhaps to a new querying/native submodule.
13. When aliases are set in the query they should be returned in the list of suggestions
",romeovs,2025-01-23 11:06:25+00:00,[],2025-01-29 18:42:42+00:00,2025-01-29 18:42:42+00:00,https://github.com/metabase/metabase/issues/52585,[],[],
2806180179,issue,closed,not_planned,webhook for wechat,"I have a problem: I configured the address of the WeChat in webhook, but I cannot receive the information, and no error was reported in the test. May I ask how the configuration can take effect? The following WeChat webook call example：

curl 'https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=693axxx6-7aoc-4bc4-97a0-0ec2sifa5aaa'
-H 'Content-Type: application/json'
-d '
{
""msgtype"": ""text"",
""text"": {
""content"": ""hello world""
}
}'",xy-qimu,2025-01-23 07:51:39+00:00,[],2025-01-24 15:22:23+00:00,2025-01-24 15:22:22+00:00,https://github.com/metabase/metabase/issues/52575,[],"[{'comment_id': 2612785938, 'issue_id': 2806180179, 'author': 'paoliniluis', 'body': 'Please post questions in the forum', 'created_at': datetime.datetime(2025, 1, 24, 15, 22, 22, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-24 15:22:22 UTC): Please post questions in the forum

"
2805168768,issue,closed,completed,Limit the amount of logs we store in our ring buffer for the UI,"### Describe the bug

We store a lot of text in our 2,500 line ring buffer

https://github.com/metabase/metabase/blob/master/src/metabase/logger.clj#L24-L26

We also store really long exception messages and stackframes:
https://github.com/metabase/metabase/blob/master/src/metabase/logger.clj#L38-L39

Let's do two things:
1. We don't need 2500 items (stats right now has 5 mb of text in this). Store fewer
2. We shouldn't store unbounded text. Let's substring these. Again, this powers the UI. We still have full logs in the console and in whatever aggregator that people are using.



### To Reproduce

```
❯ http get 'https://stats.metabase.com/api/util/logs' x-api-key:$(kv-client get stats-key) -pb > /tmp/logs-from-stats

❯ ls -lh /tmp/logs-from-stats
-rw-r--r--  1 dan  wheel   5.9M Jan 22 11:37 /tmp/logs-from-stats

❯ cat /tmp/logs-from-stats| jq 'length'
2500
```

Make all of this smaller

### Expected behavior

It should be informative and small.

### Logs

meta

### Information about your Metabase installation

```JSON
master
```

### Severity

p2

### Additional context

_No response_",dpsutton,2025-01-22 19:21:07+00:00,['nvoxland'],2025-01-28 10:18:49+00:00,2025-01-28 00:10:57+00:00,https://github.com/metabase/metabase/issues/52537,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2608123358, 'issue_id': 2805168768, 'author': 'dpsutton', 'body': 'bumping priority because this can actually get _quite_ large', 'created_at': datetime.datetime(2025, 1, 22, 19, 45, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2618574449, 'issue_id': 2805168768, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)', 'created_at': datetime.datetime(2025, 1, 28, 10, 18, 47, tzinfo=datetime.timezone.utc)}]","dpsutton (Issue Creator) on (2025-01-22 19:45:37 UTC): bumping priority because this can actually get _quite_ large

github-actions[bot] on (2025-01-28 10:18:47 UTC): 🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)

"
2804856528,issue,open,,Option to configure dashboard table cards to dynamically adjust its height based on the number of data rows,"**Is your feature request related to a problem? Please describe.**
When we try to export a dashboard as PDF, rows in table (or pivot) cards that are in the pages 2 and further will not appear in the PDF report. In order to have them appear in the report, the user needs to manually adjust the height of the table card so that all rows fit in its first page (hence showing up in the PDF export).

**Describe the solution you'd like**
The dashboard table (or pivot) card should be configurable to dynamically and automatically adjust its height so that all rows appear in the first page (and therefore in the PDF export). It could also be useful to be able to configure a maximum height in the case that there are too many rows making the dashboard extremely long (e.g. table card height will adjust itself up to a maximum of X dashboard grid slots).

**Describe alternatives you've considered**
Using a different tool (not Metabase), but we don't want to do that.

**How important is this feature to you?**
Very important. As of now, we can't have table/pivot cards in dashboards intended for PDF export, because in most of the cases the height defined will not make sense. They will either have a blank space (when there's more height allocated than rows in the table) or rows will go into next pages and will not appear in the PDF export.",fabiolanza,2025-01-22 16:39:11+00:00,[],2025-02-04 20:30:53+00:00,,https://github.com/metabase/metabase/issues/52531,"[('Visualization/', ''), ('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('Reporting/Export', ''), ('Reporting/Export/Pivot', 'Exporting data as pivoted tables')]","[{'comment_id': 2612443126, 'issue_id': 2804856528, 'author': 'brunobergher', 'body': 'Related to #37301', 'created_at': datetime.datetime(2025, 1, 24, 12, 42, 25, tzinfo=datetime.timezone.utc)}]","brunobergher on (2025-01-24 12:42:25 UTC): Related to #37301

"
2804633068,issue,open,,Long running subscriptions/alerts will clog the queue making subscriptions to stop working,"### Describe the bug

When long running queries get stuck in the queue, they will block all other queries from running

### To Reproduce

Let's say you have a question that takes A LOT of time, e.g. 30 mins (use pg_sleep function to make a long running query), and a shorter one that's 10 milliseconds (same thing)
- create a subscription or an alert from these
- then Metabase will fire these queries when the time comes:
```
2025-01-22 14:54:00,025 INFO notification.send :: [Notification 1] Sending
2025-01-22 14:54:00,026 INFO notification.send :: [Notification 2] Sending
2025-01-22 14:54:00,105 INFO notification.send :: [Notification 1] Sending message to channel :channel/email
2025-01-22 14:54:00,228 INFO notification.send :: [Notification 1] Sent successfully
```
(short one finishes, long one is running)
- then it will fire the queries again
```
2025-01-22 14:55:00,019 INFO notification.send :: [Notification 1] Sending
2025-01-22 14:55:00,088 INFO notification.send :: [Notification 1] Sending message to channel :channel/email
2025-01-22 14:55:00,217 INFO notification.send :: [Notification 1] Sent successfully
2025-01-22 14:55:00,226 INFO notification.send :: [Notification 2] Sending
```
(short one finishes, long one is running)

... aaaaandddd, now it's gone. The instance won't fire any subscriptions never again since the queue is filled up and the only way to make work is by rebooting

### Expected behavior

Nothing should clog the queue, so every subscription should be independent

### Logs

None

### Information about your Metabase installation

```JSON
52.x, but this has been due to the changes in subscriptions recently
```

### Severity

P1

### Additional context

![Image](https://github.com/user-attachments/assets/337a4f81-f44a-4c8b-8a2f-1fe22f950b55)",paoliniluis,2025-01-22 15:04:13+00:00,[],2025-02-04 20:29:30+00:00,,https://github.com/metabase/metabase/issues/52525,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Pulses', 'Now called Subscriptions'), ('.Escalation', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2607494551, 'issue_id': 2804633068, 'author': 'paoliniluis', 'body': 'I think we went back to https://github.com/metabase/metabase/issues/14613', 'created_at': datetime.datetime(2025, 1, 22, 15, 5, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607582753, 'issue_id': 2804633068, 'author': 'piranha', 'body': 'Given that we have `notification-thread-pool-size` setting I think the immediate action here should be to notify Metabase admins that their queue is filled up with long-running processes.', 'created_at': datetime.datetime(2025, 1, 22, 15, 39, 54, tzinfo=datetime.timezone.utc)}]","paoliniluis (Issue Creator) on (2025-01-22 15:05:39 UTC): I think we went back to https://github.com/metabase/metabase/issues/14613

piranha on (2025-01-22 15:39:54 UTC): Given that we have `notification-thread-pool-size` setting I think the immediate action here should be to notify Metabase admins that their queue is filled up with long-running processes.

"
2804560975,issue,closed,completed,Join data picker does not show recent tables,"### Describe the bug

https://github.com/user-attachments/assets/0cab745c-338b-4db4-ab14-d835f67a2a67

### To Reproduce

Scenario: you want to create a question ""Orders join Products""

1. Make sure you have Orders and Products tables in Recents
2. New > Question
3. Notice that you can see Orders and Products tables in Recents
4. Choose Orders
5. Click ""Join data""
6. Entity picker is shown

❌ Products table is not shown in Recents


### Information about your Metabase installation

master, 9290125217ab473835298e58d3b7e6a3b73cbde0

### Severity

P2, annoying
",kamilmielnik,2025-01-22 14:36:16+00:00,['ranquild'],2025-01-24 01:20:09+00:00,2025-01-23 21:47:10+00:00,https://github.com/metabase/metabase/issues/52523,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Querying/Notebook', 'Items specific to the Custom/Notebook query builder'), ('.Team/Querying', '')]",[],
2804511127,issue,closed,completed,Metabot - ensure that IDs are passed as expected to the AI Service,"Use strings for `table_id`s because these might refer to tables and models, and ints for everything else. More [info](https://metaboat.slack.com/archives/C07SJT1P0ET/p1737555001930119?thread_ts=1737550283.686759&cid=C07SJT1P0ET)",retro,2025-01-22 14:15:29+00:00,['metamben'],2025-01-23 13:43:24+00:00,2025-01-23 13:43:24+00:00,https://github.com/metabase/metabase/issues/52522,[],[],
2804504118,issue,closed,completed,Metabot - find-outliers tool with pivot questions,`find-outliers` tool is not working correctly with pivot questions. See [here](https://metaboat.slack.com/archives/C07SJT1P0ET/p1737550283686759) for more info,retro,2025-01-22 14:12:34+00:00,['metamben'],2025-01-23 13:43:19+00:00,2025-01-23 13:43:19+00:00,https://github.com/metabase/metabase/issues/52521,[],[],
2804499071,issue,open,,"When creating an API key and the user doesn't select a group, the input bar is red even after the user resolving the error","### Describe the bug

https://www.loom.com/share/3640d02e3852401aa2120c00a115d3d4?sid=a154b9b4-a550-45bb-8aa5-a162102b27da

### To Reproduce

see Loom

### Expected behavior

Selecting a valid group should make the bar normal

### Logs

_No response_

### Information about your Metabase installation

```JSON
master @ 1df2e40
```

### Severity

P3

### Additional context

_No response_",luizarakaki,2025-01-22 14:10:29+00:00,[],2025-02-05 19:18:40+00:00,,https://github.com/metabase/metabase/issues/52520,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Administration/Auth/API Keys', '')]",[],
2804230490,issue,closed,completed,[SDK] Update Next.js compat layer's components list,"We filed this issue before [our customer ran into it.](https://metaboat.slack.com/archives/C063Q3F1HPF/p1737657965959669)

`generate-nextjs-compat` is out of date as the InteractiveQuestion sub-components has been updated:

https://github.com/metabase/metabase/blob/1d5b5c6b33ba26fb032c0d7d32a44d3eb4c35f34/enterprise/frontend/src/embedding-sdk/components/public/InteractiveQuestion/InteractiveQuestion.tsx#L95",heypoom,2025-01-22 12:13:57+00:00,['WiNloSt'],2025-01-27 14:57:34+00:00,2025-01-27 14:11:32+00:00,https://github.com/metabase/metabase/issues/52511,"[('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2612239596, 'issue_id': 2804230490, 'author': 'npretto', 'body': 'We also forgot to add other components such as collection browser: https://metaboat.slack.com/archives/C063Q3F1HPF/p1737657965959669', 'created_at': datetime.datetime(2025, 1, 24, 10, 55, 19, tzinfo=datetime.timezone.utc)}]","npretto on (2025-01-24 10:55:19 UTC): We also forgot to add other components such as collection browser: https://metaboat.slack.com/archives/C063Q3F1HPF/p1737657965959669

"
2804108289,issue,open,,"Subscription ""From Name"" Customization","**Is your feature request related to a problem? Please describe.**
When using the E-Mail Subscriptions for plenty of Dashboards, Metabase does not support using custom Sender Name per Dashboard. Instead only the global config [Mail From Name](https://www.metabase.com/docs/latest/configuring-metabase/environment-variables#mb_email_from_name) is always used.

There is no way to categorize different subscription beside the Dashboard Name, which is different from the Metabase Frontend, which gives more Context from the Collection Structure. 
Sender name is a great field to add give more structural context to email subscriptions.

**Describe the solution you'd like**
Enduser should override `mb_email_from_name` on a subscription base. The `mb_email_from_address` is not affected and its okay to always use the global setting.

**Describe alternatives you've considered**
-

**How important is this feature to you?**
We are used to set custom sender names from our legacy internal email reporting solution. Adding that feature would help us migrating existing reports to metabase, hence increasing metabase adoption.

**Additional context**

![Image](https://github.com/user-attachments/assets/788742b0-159f-45c1-ba42-a1071218f0da)
",weand,2025-01-22 11:16:18+00:00,[],2025-02-04 20:30:58+00:00,,https://github.com/metabase/metabase/issues/52508,"[('Reporting/Pulses', 'Now called Subscriptions'), ('Type:New Feature', ''), ('.Team/Workflows', 'aka BEC')]",[],
2804073254,issue,open,,Distorted Top Container in E-Mail Subscriptions,"### Describe the bug

Hi,

our company uses a [Blackberry Hub+ E-Mail Client](https://play.google.com/store/apps/details?id=com.blackberry.hub&hl=de) for corporate mail client on mobile devices.

Suddenly the top of all Metabase Subscriptions is not rendered properly in that client
* the Top Container width is too low which result in distorted texts
* the Heading of the first Metabase Question is to far away from the visualization. We would expect the heading looks like for subsequent questions.

![Image](https://github.com/user-attachments/assets/4fbfb257-0626-452c-bc8d-f27ebf397690)




The top container looks fine in the Web E-Mail Client

![Image](https://github.com/user-attachments/assets/a9bc9fe1-9c46-4da2-8872-0c4ec1576e62)


### To Reproduce

1. Go to a Dashboard
2. Send E-Mail of the Dashboard using Subscriptions
3. Check Mail in [Blackberry Hub+ E-Mail Client](https://play.google.com/store/apps/details?id=com.blackberry.hub&hl=de)

### Expected behavior

The top container of Metabase Subscriptions looks properly on every client.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""mysql"",
      ""oracle"",
      ""clickhouse"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-self-hosted-yearly"",
    ""version"": {
      ""date"": ""2024-12-04"",
      ""tag"": ""v1.51.7"",
      ""hash"": ""0dd6eae""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MySQL"",
        ""version"": ""8.0.34-26""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.25+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.25"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.25+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.14.0-545.el9.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Berlin""
  }
}
```

### Severity

Its blocking usage of Subscriptions for Upper Management! -> Has Management Attention

### Additional context

_No response_",weand,2025-01-22 11:00:34+00:00,[],2025-02-04 20:29:29+00:00,,https://github.com/metabase/metabase/issues/52506,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Pulses', 'Now called Subscriptions'), ('.Frontend', ''), ('.Backend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2607432676, 'issue_id': 2804073254, 'author': 'paoliniluis', 'body': ""Hey @weand seems like you're a customer. Can you send us an email so we can track these down? also: what renderer does the blackberry client uses?"", 'created_at': datetime.datetime(2025, 1, 22, 14, 42, 23, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607755697, 'issue_id': 2804073254, 'author': 'weand', 'body': ""I have no clue what renderer the black berry hub+ client uses under the hood. Maybe you find some obvious glitch in the HTML template? I'll leave you an email."", 'created_at': datetime.datetime(2025, 1, 22, 16, 48, 54, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-22 14:42:23 UTC): Hey @weand seems like you're a customer. Can you send us an email so we can track these down? also: what renderer does the blackberry client uses?

weand (Issue Creator) on (2025-01-22 16:48:54 UTC): I have no clue what renderer the black berry hub+ client uses under the hood. Maybe you find some obvious glitch in the HTML template? I'll leave you an email.

"
2803861956,issue,open,,Mantine V7 🤝 SDK - container task,"**Context**

This acts as a container for the tasks that we need to do to to make sdk and mantine v7 play well together, or for the things we need to check.

This can also be used to document the things we find out.

- [X] mantine v7 requires a [global css reset](https://mantine.dev/styles/global-styles/#css-reset)
- [X] [~~we're using metabase/ui (mantine) components in the cypress tests~~](https://metaboat.slack.com/archives/C063Q3F1HPF/p1737483503471319?thread_ts=1737384866.825889&cid=C063Q3F1HPF)~~, with mantine v7 they don't find the correct context~~ This shouldn't block merge, but may be worth looking into-> extracted to [EMB-103](https://linear.app/metabase/issue/EMB-103/were-using-metabaseui-in-sdk-e2e-tests-with-the-new-mantine-this)
- [X] scope css variables/add a prefix to css variables created by mantine (
- [X] [https://github.com/metabase/metabase/pull/53290](https://github.com/metabase/metabase/pull/53290)
- [X] ~~check if sdk works with host app using same version of mantine~~ extracted to [EMB-102](https://linear.app/metabase/issue/EMB-102/%5Bmantine-v7%5D-check-if-sdk-works-with-host-app-using-same-version-of)",npretto,2025-01-22 09:29:58+00:00,['npretto'],2025-02-07 17:32:06+00:00,,https://github.com/metabase/metabase/issues/52500,"[('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2803646854,issue,closed,completed,Metabot - disable filter-records tool,,retro,2025-01-22 07:49:05+00:00,['metamben'],2025-01-23 13:43:25+00:00,2025-01-23 13:43:25+00:00,https://github.com/metabase/metabase/issues/52499,"[('Metabot/Tools', 'Tools that are agnostic of the LLM framework itself, could be reused for notifications framework als')]",[],
2803625547,issue,open,reopened,The task sync-fields fail if table doesn't exist,"### Describe the bug

Hello!
We have Metabase instance connected to several DBs. One of them is Clickhouse, it has about hundred schemas and more than 1700 tables.
After last update (from 0.47.1 to the 0.51.3) we faced with several issues. Metabase is currently unable to reliably synchronize new tables and their structure. Now we are on 0.52.6, the problem still exists. We use the latest version of Clickhouse driver.
I already [posted](https://discourse.metabase.com/t/debugging-table-structure-sync/196874) this on discourse.metabase.com. But now I think that is a bug.

As far as I understand, Metabase finds some table during the sync-tables task and can't find it during the sync-fields.


### To Reproduce

1. Create a new table in Clickhouse
2. In the Metabase UI, start synchronizing the DB schema
3. When the sync-tables task is completed, delete the new table as soon as possible
4. Get a sync-fields task error.

### Expected behavior

Metabase simply displays a WARN message in the log and continues processing other tables.

### Logs

<details><summary>It fails with this SQL-error</summary>

```JSON
{
  ""status"": ""failed"",
  ""exception"": ""class clojure.lang.ExceptionInfo"",
  ""message"": ""Code: 60. DB::Exception: Table <SCHEMA>.<TABLE> does not exist. Maybe you meant <SCHEMA>.<TABLE1>?. (UNKNOWN_TABLE) (version 24.8.4.13 (official build))\n"",
  ""stacktrace"": [
    ""com.clickhouse.jdbc.SqlExceptionUtils.batchUpdateError(SqlExceptionUtils.java:107)"",
    ""com.clickhouse.jdbc.internal.SqlBasedPreparedStatement.executeAny(SqlBasedPreparedStatement.java:219)"",
    ""com.clickhouse.jdbc.internal.SqlBasedPreparedStatement.executeQuery(SqlBasedPreparedStatement.java:246)"",
    ""com.mchange.v2.c3p0.impl.NewProxyPreparedStatement.executeQuery(NewProxyPreparedStatement.java:743)"",
    ""--> driver.sql_jdbc.sync.describe_table$fallback_fields_metadata_from_select_query$reify__92292.reduce(describe_table.clj:94)"",
    ""driver.sql_jdbc.sync.describe_table$fields_metadata$reify$reify__92316.reduce(describe_table.clj:161)"",
    ""driver.sql_jdbc.sync.describe_table$fields_metadata$reify__92311.reduce(describe_table.clj:169)"",
    ""driver.sql_jdbc.sync.describe_table$fn__92332.invokeStatic(describe_table.clj:215)"",
    ""driver.sql_jdbc.sync.describe_table$fn__92332.invoke(describe_table.clj:213)"",
    ""driver.sql_jdbc.sync.describe_table$describe_table_STAR_.invokeStatic(describe_table.clj:283)"",
    ""driver.sql_jdbc.sync.describe_table$describe_table_STAR_.invoke(describe_table.clj:279)"",
    ""driver.sql_jdbc.sync.describe_table$describe_table$fn__92366.invoke(describe_table.clj:295)"",
    ""driver.clickhouse$fn__118389$fn__118391.invoke(clickhouse.clj:126)"",
    ""driver.sql_jdbc.execute$do_with_resolved_connection87379__87380.invokeStatic(execute.clj:338)"",
    ""driver.sql_jdbc.execute$do_with_resolved_connection87379__87380.invoke(execute.clj:321)"",
    ""driver.clickhouse$fn__118389.invokeStatic(clickhouse.clj:87)"",
    ""driver.clickhouse$fn__118389.invoke(clickhouse.clj:85)"",
    ""driver.sql_jdbc.sync.describe_table$describe_table.invokeStatic(describe_table.clj:290)"",
    ""driver.sql_jdbc.sync.describe_table$describe_table.invoke(describe_table.clj:287)"",
    ""driver.clickhouse_introspection$fn__114232.invokeStatic(clickhouse_introspection.clj:160)"",
    ""driver.clickhouse_introspection$fn__114232.invoke(clickhouse_introspection.clj:158)"",
    ""sync.fetch_metadata$table_fields_metadata93306__93307.invokeStatic(fetch_metadata.clj:53)"",
    ""sync.fetch_metadata$table_fields_metadata93306__93307.invoke(fetch_metadata.clj:40)"",
    ""sync.fetch_metadata$describe_fields_using_describe_table$fn__93313.invoke(fetch_metadata.clj:63)"",
    ""db.connection$do_with_connection_primary_method_default.invokeStatic(connection.clj:132)"",
    ""db.connection$do_with_connection_primary_method_default.invoke(connection.clj:130)"",
    ""sync.sync_metadata.fields$sync_fields_BANG_93383__93384$fn__93385.invoke(fields.clj:82)"",
    ""sync.util$do_with_error_handling.invokeStatic(util.clj:191)"",
    ""sync.util$do_with_error_handling.invoke(util.clj:184)"",
    ""sync.sync_metadata.fields$sync_fields_BANG_93383__93384.invokeStatic(fields.clj:76)"",
    ""sync.sync_metadata.fields$sync_fields_BANG_93383__93384.invoke(fields.clj:71)"",
    ""sync.util$run_step_with_metadata63619__63621$fn__63623$fn__63626.invoke(util.clj:495)"",
    ""models.task_history$do_with_task_history63456__63457.invokeStatic(task_history.clj:121)"",
    ""models.task_history$do_with_task_history63456__63457.invoke(task_history.clj:109)"",
    ""sync.util$run_step_with_metadata63619__63621$fn__63623.doInvoke(util.clj:488)"",
    ""sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:132)"",
    ""sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:126)"",
    ""sync.util$do_with_start_and_finish_debug_logging.invokeStatic(util.clj:150)"",
    ""sync.util$do_with_start_and_finish_debug_logging.invoke(util.clj:146)"",
    ""sync.util$run_step_with_metadata63619__63621.invokeStatic(util.clj:482)"",
    ""sync.util$run_step_with_metadata63619__63621.invoke(util.clj:477)"",
    ""sync.util$run_sync_operation63669__63670$fn__63671$fn__63679.invoke(util.clj:568)"",
    ""sync.util$run_sync_operation63669__63670$fn__63671.invoke(util.clj:566)"",
    ""models.task_history$do_with_task_history63456__63457.invokeStatic(task_history.clj:121)"",
    ""models.task_history$do_with_task_history63456__63457.invoke(task_history.clj:109)"",
    ""sync.util$run_sync_operation63669__63670.invokeStatic(util.clj:563)"",
    ""sync.util$run_sync_operation63669__63670.invoke(util.clj:558)"",
    ""sync.sync_metadata$sync_db_metadata_BANG_94014__94015$fn__94016.invoke(sync_metadata.clj:70)"",
    ""sync.util$do_with_error_handling.invokeStatic(util.clj:191)"",
    ""sync.util$do_with_error_handling.invoke(util.clj:184)"",
    ""driver$fn__59501.invokeStatic(driver.clj:914)"",
    ""driver$fn__59501.invoke(driver.clj:914)"",
    ""sync.util$sync_in_context$fn__63528.invoke(util.clj:167)"",
    ""sync.util$with_db_logging_disabled$fn__63525.invoke(util.clj:159)"",
    ""sync.util$with_start_and_finish_logging_STAR_.invokeStatic(util.clj:132)"",
    ""sync.util$with_start_and_finish_logging_STAR_.invoke(util.clj:126)"",
    ""sync.util$with_start_and_finish_logging$fn__63512.invoke(util.clj:144)"",
    ""sync.util$with_sync_events63502__63503$fn__63507.invoke(util.clj:118)"",
    ""sync.util$with_duplicate_ops_prevented$fn__63492.invoke(util.clj:90)"",
    ""sync.util$do_sync_operation63543__63544.invokeStatic(util.clj:216)"",
    ""sync.util$do_sync_operation63543__63544.invoke(util.clj:210)"",
    ""sync.sync_metadata$sync_db_metadata_BANG_94014__94015.invokeStatic(sync_metadata.clj:68)"",
    ""sync.sync_metadata$sync_db_metadata_BANG_94014__94015.invoke(sync_metadata.clj:65)"",
    ""api.database$fn__106499$fn__106504.invoke(database.clj:1017)""
  ],
  ""ex-data"": {
    ""toucan2/context-trace"": [
      [
        ""execute SQL with class com.mchange.v2.c3p0.impl.NewProxyConnection"",
        {
          ""toucan2.jdbc.query/sql-args"": [
            ""SELECT * FROM `metabase_table` WHERE ((`active` = TRUE) AND (`visibility_type` IS NULL)) AND (`schema` IN (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)) AND (`db_id` = ?)"",
            ""..."",
            14
          ]
        }
      ],
      [
        ""resolve connection"",
        {
          ""toucan2.connection/connectable"": ""class metabase.db.connection.ApplicationDB""
        }
      ],
      [
        ""resolve connection"",
        {
          ""toucan2.connection/connectable"": ""default""
        }
      ],
      [
        ""resolve connection"",
        {
          ""toucan2.connection/connectable"": null
        }
      ],
      {
        ""toucan2.pipeline/rf"": ""clojure.core$map$fn__5950$fn__5951@4df7c638""
      },
      [
        ""with compiled query"",
        {
          ""toucan2.pipeline/compiled-query"": [
            ""SELECT * FROM `metabase_table` WHERE ((`active` = TRUE) AND (`visibility_type` IS NULL)) AND (`schema` IN (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)) AND (`db_id` = ?)"",
            ""..."",
            14
          ]
        }
      ],
      [
        ""with built query"",
        {
          ""toucan2.pipeline/built-query"": {
            ""select"": [
              ""*""
            ],
            ""from"": [
              [
                ""metabase_table""
              ]
            ],
            ""where"": [
              ""and"",
              [
                ""and"",
                [
                  ""="",
                  ""active"",
                  true
                ],
                [
                  ""="",
                  ""visibility_type"",
                  null
                ]
              ],
              [
                ""in"",
                ""schema"",
                [
                  ""...""
                ]
              ],
              null,
              [
                ""="",
                ""db_id"",
                14
              ]
            ]
          }
        }
      ],
      [
        ""with resolved query"",
        {
          ""toucan2.pipeline/resolved-query"": {
            ""where"": [
              ""and"",
              [
                ""and"",
                [
                  ""="",
                  ""active"",
                  true
                ],
                [
                  ""="",
                  ""visibility_type"",
                  null
                ]
              ],
              [
                ""in"",
                ""schema"",
                [
                  ""...""
                ]
              ],
              null
            ]
          }
        }
      ],
      [
        ""with parsed args"",
        {
          ""toucan2.pipeline/query-type"": ""toucan.query-type/select.instances"",
          ""toucan2.pipeline/parsed-args"": {
            ""kv-args"": {
              ""db_id"": 14
            },
            ""queryable"": {
              ""where"": [
                ""and"",
                [
                  ""and"",
                  [
                    ""="",
                    ""active"",
                    true
                  ],
                  [
                    ""="",
                    ""visibility_type"",
                    null
                  ]
                ],
                [
                  ""in"",
                  ""schema"",
                  [
                    ""...""
                  ]
                ],
                null
              ]
            }
          }
        }
      ],
      [
        ""with model"",
        {
          ""toucan2.pipeline/model"": ""model/Table""
        }
      ],
      [
        ""with unparsed args"",
        {
          ""toucan2.pipeline/query-type"": ""toucan.query-type/select.instances"",
          ""toucan2.pipeline/unparsed-args"": [
            ""model/Table"",
            ""db_id"",
            14,
            {
              ""where"": [
                ""and"",
                [
                  ""and"",
                  [
                    ""="",
                    ""active"",
                    true
                  ],
                  [
                    ""="",
                    ""visibility_type"",
                    null
                  ]
                ],
                [
                  ""in"",
                  ""schema"",
                  [
                    ""...""
                  ]
                ],
                null
              ]
            }
          ]
        }
      ]
    ]
  },
  ""original-info"": null
}
```
</details>

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""ru-RU"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""exasol"",
      ""mysql"",
      ""clickhouse"",
      ""mongo""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-15"",
      ""tag"": ""v0.52.6"",
      ""hash"": ""1a9cb72""
    },
    ""settings"": {},
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MariaDB"",
        ""version"": ""10.5.13-MariaDB""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.14.0-375.el9.x86_64"",
    ""user.language"": ""en""
  }
}
```

### Severity

blocking

### Additional context

_No response_",ppavlov39,2025-01-22 07:37:17+00:00,[],2025-02-04 20:24:33+00:00,,https://github.com/metabase/metabase/issues/52496,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Administration/Metadata & Sync', ''), ('.Team/Drivers', '')]","[{'comment_id': 2607427064, 'issue_id': 2803625547, 'author': 'luizarakaki', 'body': ""@ppavlov39 the clickhouse driver is maintained by the clickhouse team, please open an issue in the clickhouse driver repo\nhttps://github.com/ClickHouse/metabase-clickhouse-driver\n\nI'll let them know that you opened this issue."", 'created_at': datetime.datetime(2025, 1, 22, 14, 40, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2608032167, 'issue_id': 2803625547, 'author': 'chernser', 'body': ""Good day, @luizarakaki ! \nI'd like to better understand the issue. \nShould CH driver cache schema? \nWhat is expected behavior of a driver? CH Metabase driver is using CH JDBC Driver. The last one queries DB for metadata. If table is removed between calls - then we can do nothing."", 'created_at': datetime.datetime(2025, 1, 22, 18, 58, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2608069833, 'issue_id': 2803625547, 'author': 'luizarakaki', 'body': ""Right, yes... I understand the issue now.\n\nI'll check what we can do, but ideally Metabase should be exposed only to tables that it will query at some point. If these are ephemeral tables, they should be excluded somehow. It is possible to select a database or control via database credentials."", 'created_at': datetime.datetime(2025, 1, 22, 19, 16, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2608970894, 'issue_id': 2803625547, 'author': 'ppavlov39', 'body': ""Unfortunately, it is not always possible to restrict access.\nLet's take the same DBT, which can be found in many places. It creates temporary views in the same schema where the final marts will be created later. These temporary views are created with a certain suffix (*_dbt_view_tmp). It would be possible to restict access to such objects at the access level, but Clickhouse does not provide such an opportunity (the wildcard can only be after part of the name, not before it).\nAlso, it will not prevent the occurrence of such situations with tables that users manage themselves.\nAnd besides, since Clickhouse can be a cluster and have distributed tables that have an incorrect configuration, they can also cause the error in the issue.\n\nTherefore, in my opinion, such errors should be ignored by the process."", 'created_at': datetime.datetime(2025, 1, 23, 6, 33, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2613188274, 'issue_id': 2803625547, 'author': 'chernser', 'body': '@luizarakaki,\nThank you!', 'created_at': datetime.datetime(2025, 1, 24, 18, 56, 30, tzinfo=datetime.timezone.utc)}]","luizarakaki on (2025-01-22 14:40:10 UTC): @ppavlov39 the clickhouse driver is maintained by the clickhouse team, please open an issue in the clickhouse driver repo
https://github.com/ClickHouse/metabase-clickhouse-driver

I'll let them know that you opened this issue.

chernser on (2025-01-22 18:58:29 UTC): Good day, @luizarakaki ! 
I'd like to better understand the issue. 
Should CH driver cache schema? 
What is expected behavior of a driver? CH Metabase driver is using CH JDBC Driver. The last one queries DB for metadata. If table is removed between calls - then we can do nothing.

luizarakaki on (2025-01-22 19:16:03 UTC): Right, yes... I understand the issue now.

I'll check what we can do, but ideally Metabase should be exposed only to tables that it will query at some point. If these are ephemeral tables, they should be excluded somehow. It is possible to select a database or control via database credentials.

ppavlov39 (Issue Creator) on (2025-01-23 06:33:07 UTC): Unfortunately, it is not always possible to restrict access.
Let's take the same DBT, which can be found in many places. It creates temporary views in the same schema where the final marts will be created later. These temporary views are created with a certain suffix (*_dbt_view_tmp). It would be possible to restict access to such objects at the access level, but Clickhouse does not provide such an opportunity (the wildcard can only be after part of the name, not before it).
Also, it will not prevent the occurrence of such situations with tables that users manage themselves.
And besides, since Clickhouse can be a cluster and have distributed tables that have an incorrect configuration, they can also cause the error in the issue.

Therefore, in my opinion, such errors should be ignored by the process.

chernser on (2025-01-24 18:56:30 UTC): @luizarakaki,
Thank you!

"
2803187850,issue,closed,duplicate,Keyless BigQuery Integration with Workload's Service Account,"**Is your feature request related to a problem? Please describe.**

As mentioned in the documentation found at https://www.metabase.com/docs/latest/databases/connections/bigquery, it is necessary to import the Service Account Key for BigQuery integration.

However, managing keys can lead to security risks, as they might get exposed and leaked. And Google [now recommends not using service account keys](https://cloud.google.com/iam/docs/best-practices-for-managing-service-account-keys) by several security reasons.

**Describe the solution you'd like**

We can deploy metabase on the service (GCE, CloudRun, AppEngine) with specific Service Account, and use this Service Account to authenticate to BigQuery.

**Describe alternatives you've considered**

N/A

**How important is this feature to you?**

We should not use static credentials to prevent the critical security incident. The service account that is integrated to matabase has strong permission like access to the BigQuery, so we should support keyless BigQuery integration with workload's service account.

**Additional context**

N/A

Thank you for your great support!
",hi120ki,2025-01-22 02:02:54+00:00,[],2025-01-22 02:29:40+00:00,2025-01-22 02:29:39+00:00,https://github.com/metabase/metabase/issues/52491,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2606148178, 'issue_id': 2803187850, 'author': 'paoliniluis', 'body': 'Duplicate of https://github.com/metabase/metabase/issues/19941', 'created_at': datetime.datetime(2025, 1, 22, 2, 29, 39, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-22 02:29:39 UTC): Duplicate of https://github.com/metabase/metabase/issues/19941

"
2803080358,issue,open,,Cumulative Sum does not work in pivot tables with non-date aggregations,"### Describe the bug

Just simply that

### To Reproduce

1) create a question like
![Image](https://github.com/user-attachments/assets/b5b4f11c-952f-44f2-af6f-1d48b6828e3d)

(check the cumulative sum on the formula)

2) visualize it as a table, see that it's working fine with numbers accumulating on the ""some column"" column

![Image](https://github.com/user-attachments/assets/69c20bdc-f86e-4725-92c1-1fe4b8aca9ef)

3) now swith to a pivot, numbers change entirely

![Image](https://github.com/user-attachments/assets/ac232789-6ab5-4dc7-b210-e862790bb512)


### Expected behavior

numbers should match the ones on the table

### Logs

NA

### Information about your Metabase installation

```JSON
52.6, but this is probably happening from the beginning of the times
```

### Severity

P2

### Additional context

NA",paoliniluis,2025-01-22 00:20:08+00:00,[],2025-02-04 20:29:50+00:00,,https://github.com/metabase/metabase/issues/52483,"[('Type:Bug', 'Product defects'), ('Type:UX', ''), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2606093433, 'issue_id': 2803080358, 'author': 'perivamsi', 'body': 'We should not allow pivots if there is a non-linear aggregation involved. This rough edge came up in several other bugs. There is no sensible way to pivot ""cumulative sums"".', 'created_at': datetime.datetime(2025, 1, 22, 1, 36, tzinfo=datetime.timezone.utc)}]","perivamsi on (2025-01-22 01:36:00 UTC): We should not allow pivots if there is a non-linear aggregation involved. This rough edge came up in several other bugs. There is no sensible way to pivot ""cumulative sums"".

"
2802814569,issue,closed,completed,Metabot - Standalone tools tests,Implement the standalone tests for Metabot tools based on the [testing plan](https://www.notion.so/metabase/Testing-Plan-17b69354c90180d79f29c3cadcf68539),retro,2025-01-21 21:07:54+00:00,['metamben'],2025-01-31 16:33:23+00:00,2025-01-31 16:32:57+00:00,https://github.com/metabase/metabase/issues/52468,"[('Metabot/Tools', 'Tools that are agnostic of the LLM framework itself, could be reused for notifications framework als')]",[],
2802813752,issue,closed,completed,"Email Subscriptions show almost all charts with ""No results"" after auto update to Metabase 52.6","**Describe the bug**
We have daily email subscriptions that show charts of user signups, etc. They have worked consistently until this update, where now almost all of the charts show ""no results"". If you click on the dashboard from the email the charts work and data is there, so the issue is specifically with the email subscription. Nothing has changed in terms of amount of data on the dash or anything else.

**Logs**
Logs in metabase UI do not go back far enough (~6 hours) to show

**To Reproduce**
Not sure if it can be reproduced - set up a dash with simple queries, set up an email subscription, run before and after updating to newest Metabase version.

**Expected behavior**
Show charts with data like on dashboard

**Screenshots**

![Image](https://github.com/user-attachments/assets/3401217f-86c0-4cce-9216-c4c72eebffef)
Data shows in dashboard

**Severity**
We can live with this in the short term but it is making us consider alternatives to Metabase when auto-updates break something we look at daily

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:132.0) Gecko/20100101 Firefox/132.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""athena""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""starter"",
    ""version"": {
      ""date"": ""2025-01-15"",
      ""tag"": ""v1.52.6"",
      ""hash"": ""1a9cb72""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres""
  }
}
```",loganbenable,2025-01-21 21:07:22+00:00,[],2025-01-23 16:47:20+00:00,2025-01-23 11:13:26+00:00,https://github.com/metabase/metabase/issues/52467,"[('Type:Bug', 'Product defects'), ('.Needs Triage', '')]","[{'comment_id': 2605993347, 'issue_id': 2802813752, 'author': 'paoliniluis', 'body': ""@loganbenable hey there! Luis here from Success. Have you raised a ticket already? I know about another user that's hitting this issue and we would love to find commonalities in both issues"", 'created_at': datetime.datetime(2025, 1, 22, 0, 6, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2606004145, 'issue_id': 2802813752, 'author': 'loganbenable', 'body': ""What is raising a ticket as opposed to creating this github issue, and sending an email to support? Not rhetorical, genuinely curious if that's a different thing? Where is the other user's ticket?"", 'created_at': datetime.datetime(2025, 1, 22, 0, 15, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2606152002, 'issue_id': 2802813752, 'author': 'paoliniluis', 'body': '@loganbenable if you’re a Metabase customer:\n1) issues get assigned to your account for traceability (pretty important for us and to know which issues are our customers hitting)\n2) issues get a higher priority than issues that normal free users hit, unless it’s a security issue or something gross (e.g. performance)', 'created_at': datetime.datetime(2025, 1, 22, 2, 33, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2606255749, 'issue_id': 2802813752, 'author': 'loganbenable', 'body': 'Thanks but that does not help me understand how to make a ""ticket"". If I click ""report an issue"" in the Metabase UI it gives me this option to download diagnostics, which I do, and then nothing happens (am I supposed to email it again or what?)\n\n![Image](https://github.com/user-attachments/assets/22900339-72f6-428e-aa60-f393ed965d4f)\n\nIf I go to https://www.metabase.com/help/premium I see this, which just opens an email to help@metabase, which I\'ve already done. \n\n![Image](https://github.com/user-attachments/assets/4c5d3d7d-211a-4c47-bb52-5b15dad51e5c)\n\nGetting help from a ""Metabase Expert"" seems like its all third parties. \n\nIs one of those things already a ""ticket""? Can you walk a confused customer through what I need to do to here?', 'created_at': datetime.datetime(2025, 1, 22, 4, 19, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2606564843, 'issue_id': 2802813752, 'author': 'thebiglabasky', 'body': ""help@metabase.com is indeed what Luis refers to as opening a ticket. \nThanks for sharing, we'll look into it!"", 'created_at': datetime.datetime(2025, 1, 22, 8, 18, 28, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607146977, 'issue_id': 2802813752, 'author': 'Tony-metabase', 'body': '@loganbenable In your case how many questions and tabs are there in that dashboard? And are they SQL or GUI based?', 'created_at': datetime.datetime(2025, 1, 22, 12, 41, 19, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607593985, 'issue_id': 2802813752, 'author': 'chrisdodds', 'body': ""We're also encountering this issue after the upgrade to 0.52.6. Our problem subscription has 6 panels, all GUI-based. Forcing the subscription to manually send works and includes all the data. The scheduled send returns no data found for two of the six panels. Deleting and re-creating the subscription has not fixed it."", 'created_at': datetime.datetime(2025, 1, 22, 15, 44, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607730529, 'issue_id': 2802813752, 'author': 'loganbenable', 'body': 'Ours has 1 tab with 19 questions, all SQL based. It is sent to two different groups of 4 users daily, but this error is not deterministic - for example both groups got the bug version yesterday, today one had the buggy ""no results"" version and one group got a fully populated email.', 'created_at': datetime.datetime(2025, 1, 22, 16, 38, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607745729, 'issue_id': 2802813752, 'author': 'paoliniluis', 'body': '@loganbenable any logs that you see that might be causing an empty subscription?', 'created_at': datetime.datetime(2025, 1, 22, 16, 44, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607761447, 'issue_id': 2802813752, 'author': 'loganbenable', 'body': '@paoliniluis I do not see anything in logs, but for some reason unlike with AWS or other services I only have access to logs from the last hour or so, and the emails send in the middle of the night.\n\nI have set up a subscription for midday, but yesterday it had one of the successful runs so I didn\'t see anything out of order. I will continue to look but I wouldn\'t be surprised if the logs look normal since the email is sending and not showing actual ""errors"", it\'s just not populating results for many of the charts.', 'created_at': datetime.datetime(2025, 1, 22, 16, 51, 18, tzinfo=datetime.timezone.utc)}, {'comment_id': 2608162728, 'issue_id': 2802813752, 'author': 'loganbenable', 'body': ""I scheduled the dashboard to send just to me hourly today, and so far no issues. The cause may be mitigated if the dashboard is cached, so the issues with sending in the middle of the night might occur because nothing is cached.\n\nHowever the questions failing to load in the buggy subscription emails are very quick to load so it is not a time-out issue and should still be fixed to work as it did before this new version update. Attempts to recreate this issue should probably make sure nothing is cached before the attempt, but that's just my theory for now."", 'created_at': datetime.datetime(2025, 1, 22, 20, 7, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-22 00:06:11 UTC): @loganbenable hey there! Luis here from Success. Have you raised a ticket already? I know about another user that's hitting this issue and we would love to find commonalities in both issues

loganbenable (Issue Creator) on (2025-01-22 00:15:36 UTC): What is raising a ticket as opposed to creating this github issue, and sending an email to support? Not rhetorical, genuinely curious if that's a different thing? Where is the other user's ticket?

paoliniluis on (2025-01-22 02:33:26 UTC): @loganbenable if you’re a Metabase customer:
1) issues get assigned to your account for traceability (pretty important for us and to know which issues are our customers hitting)
2) issues get a higher priority than issues that normal free users hit, unless it’s a security issue or something gross (e.g. performance)

loganbenable (Issue Creator) on (2025-01-22 04:19:27 UTC): Thanks but that does not help me understand how to make a ""ticket"". If I click ""report an issue"" in the Metabase UI it gives me this option to download diagnostics, which I do, and then nothing happens (am I supposed to email it again or what?)

![Image](https://github.com/user-attachments/assets/22900339-72f6-428e-aa60-f393ed965d4f)

If I go to https://www.metabase.com/help/premium I see this, which just opens an email to help@metabase, which I've already done. 

![Image](https://github.com/user-attachments/assets/4c5d3d7d-211a-4c47-bb52-5b15dad51e5c)

Getting help from a ""Metabase Expert"" seems like its all third parties. 

Is one of those things already a ""ticket""? Can you walk a confused customer through what I need to do to here?

thebiglabasky on (2025-01-22 08:18:28 UTC): help@metabase.com is indeed what Luis refers to as opening a ticket. 
Thanks for sharing, we'll look into it!

Tony-metabase on (2025-01-22 12:41:19 UTC): @loganbenable In your case how many questions and tabs are there in that dashboard? And are they SQL or GUI based?

chrisdodds on (2025-01-22 15:44:18 UTC): We're also encountering this issue after the upgrade to 0.52.6. Our problem subscription has 6 panels, all GUI-based. Forcing the subscription to manually send works and includes all the data. The scheduled send returns no data found for two of the six panels. Deleting and re-creating the subscription has not fixed it.

loganbenable (Issue Creator) on (2025-01-22 16:38:17 UTC): Ours has 1 tab with 19 questions, all SQL based. It is sent to two different groups of 4 users daily, but this error is not deterministic - for example both groups got the bug version yesterday, today one had the buggy ""no results"" version and one group got a fully populated email.

paoliniluis on (2025-01-22 16:44:35 UTC): @loganbenable any logs that you see that might be causing an empty subscription?

loganbenable (Issue Creator) on (2025-01-22 16:51:18 UTC): @paoliniluis I do not see anything in logs, but for some reason unlike with AWS or other services I only have access to logs from the last hour or so, and the emails send in the middle of the night.

I have set up a subscription for midday, but yesterday it had one of the successful runs so I didn't see anything out of order. I will continue to look but I wouldn't be surprised if the logs look normal since the email is sending and not showing actual ""errors"", it's just not populating results for many of the charts.

loganbenable (Issue Creator) on (2025-01-22 20:07:00 UTC): I scheduled the dashboard to send just to me hourly today, and so far no issues. The cause may be mitigated if the dashboard is cached, so the issues with sending in the middle of the night might occur because nothing is cached.

However the questions failing to load in the buggy subscription emails are very quick to load so it is not a time-out issue and should still be fixed to work as it did before this new version update. Attempts to recreate this issue should probably make sure nothing is cached before the attempt, but that's just my theory for now.

"
2802811397,issue,closed,completed,Metabot - review and expand the testing plan,Testing plan can be found [here](https://www.notion.so/metabase/Testing-Plan-17b69354c90180d79f29c3cadcf68539),retro,2025-01-21 21:05:46+00:00,['metamben'],2025-01-23 13:56:46+00:00,2025-01-23 13:56:46+00:00,https://github.com/metabase/metabase/issues/52466,"[('Metabot/Tools', 'Tools that are agnostic of the LLM framework itself, could be reused for notifications framework als')]",[],
2802778203,issue,open,,Query processor confuses the name of the field when doing aggregations,"### Describe the bug

getting ""ERROR: column source.source does not exist"" when doing an aggregation on the model

### To Reproduce

1) create a SQL question like
```
SELECT
  ""public"".""people"".""id"" AS ""id orders"",
  ""public"".""people"".""address"" AS ""address orders"",
  ""public"".""people"".""email"" AS ""email orders"",
  ""public"".""people"".""password"" AS ""password orders"",
  ""public"".""people"".""name"" AS ""name orders"",
  ""public"".""people"".""city"" AS ""city orders"",
  ""public"".""people"".""longitude"" AS ""longitude orders"",
  ""public"".""people"".""state"" AS ""state orders"",
  ""public"".""people"".""source"" AS ""source orders"",
  ""public"".""people"".""birth_date"" AS ""birth_date orders"",
  ""public"".""people"".""zip"" AS ""zip orders"",
  ""public"".""people"".""latitude"" AS ""latitude orders"",
  ""public"".""people"".""created_at"" AS ""created_at orders""
FROM
  ""public"".""people""
```
2) then tie the ""source"" column to people->source column in the metadata. Save it
3) now go to the model and do a ""distinct"" of the source column, see the query failing

### Expected behavior

The query should work

### Logs

NA

### Information about your Metabase installation

```JSON
v52.6
```

### Severity

P1

### Additional context

Probably a duplicate",paoliniluis,2025-01-21 20:46:43+00:00,[],2025-02-04 20:27:34+00:00,,https://github.com/metabase/metabase/issues/52465,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Querying/', ''), ('.metabase-lib', 'Label for tracking all issues related to the shared CLJC metabase-lib'), ('.Team/Querying', '')]","[{'comment_id': 2605758086, 'issue_id': 2802778203, 'author': 'lbrdnk', 'body': '<img width=""1496"" alt=""Image"" src=""https://github.com/user-attachments/assets/7e7d68a4-89bd-4bc6-8209-c0e8d80019e5"" />', 'created_at': datetime.datetime(2025, 1, 21, 21, 17, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2605839278, 'issue_id': 2802778203, 'author': 'bshepherdson', 'body': 'This is definitely a field refs thing. See #36185.', 'created_at': datetime.datetime(2025, 1, 21, 22, 8, 22, tzinfo=datetime.timezone.utc)}, {'comment_id': 2613607340, 'issue_id': 2802778203, 'author': 'paoliniluis', 'body': 'NOTE: this issue only happens if you connect the model field to a DB field, otherwise you never hit it', 'created_at': datetime.datetime(2025, 1, 24, 23, 47, 28, tzinfo=datetime.timezone.utc)}]","lbrdnk on (2025-01-21 21:17:41 UTC): <img width=""1496"" alt=""Image"" src=""https://github.com/user-attachments/assets/7e7d68a4-89bd-4bc6-8209-c0e8d80019e5"" />

bshepherdson on (2025-01-21 22:08:22 UTC): This is definitely a field refs thing. See #36185.

paoliniluis (Issue Creator) on (2025-01-24 23:47:28 UTC): NOTE: this issue only happens if you connect the model field to a DB field, otherwise you never hit it

"
2802766027,issue,closed,completed,Metabot - manual end to end testing,"Manually test the Metabot functionality, based on the tests in the AI Service test suite.

Tracked here: https://www.notion.so/metabase/17c69354c90180469455f28faa743ad5?v=150a889fa0d44f11a93bd384ded60fb8&pvs=4",retro,2025-01-21 20:39:28+00:00,['retro'],2025-01-22 21:53:39+00:00,2025-01-22 21:53:39+00:00,https://github.com/metabase/metabase/issues/52464,"[('Metabot/General', 'General Metabot AI')]",[],
2802715555,issue,open,,Driver: Connection Impersonation: MySQL,"**Is your feature request related to a problem? Please describe.**
A way to use impersonation with MySQL

**How important is this feature to you?**
Requested by a user

",psalinasy,2025-01-21 20:10:02+00:00,[],2025-02-04 20:31:04+00:00,,https://github.com/metabase/metabase/issues/52463,"[('Type:New Feature', ''), ('Administration/Impersonation', 'Role level security')]",[],
2802441782,issue,open,,Long startup with slow check-and-schedule-tasks execution,"### Describe the bug

I see similar behaviour with Metabase `v0.51.12.1` (upgraded from 0.47, tried v0.52.6.2 with the same result) running in k8s with PostgreSQL 14.

Sometimes initialization gets ""stuck"" at `0.97` and enabling `MB_NS_TRACE: metabase.models.database,metabase.task.sync-databases` shows that initialization reaches `database/check-and-schedule-tasks` [step](https://github.com/metabase/metabase/blob/73a07d797e92708c400ea8598f9070ab435ff05e/src/metabase/core.clj#L168) and then proceeds but very slowly: `metabase.models.database/check-and-schedule-tasks-for-db!` [for each DB](https://github.com/metabase/metabase/blob/73a07d797e92708c400ea8598f9070ab435ff05e/src/metabase/models/database.clj#L135) takes around 10 to 15 seconds which in our case (around 250 databasees) takes about 40 minutes to start metabase.

I already tried ""delay"" the triggers according to comment https://github.com/metabase/metabase/issues/19604#issuecomment-1009008716 so that syncs did not put additional load. Also tried to reindex https://github.com/metabase/metabase/issues/19604#issuecomment-1236383459 . Performing vacuum https://github.com/metabase/metabase/issues/19604#issuecomment-1124167487 did not bring anything either though I don't have so many entries in `qrtz_triggers` (866) and `qrtz_cron_triggers` (851). Even tried to drop indexes in `qrtz_triggers` with no success.

What makes things worse is that this issue is not permanent: If I spawn two instances of Metabase (in k8s deployment), one of them (sometimes first, sometimes last) starts in ~2 minutes and the other takes the above mentioned 40 minutes. I would suspect some race condition but in sometimes even a single instance has this slow initialization.

This issue has been created as follow up for corresponding comment in  #19604 

### To Reproduce

1. Run metabase with PostgreSQL in k8s
2. Have around 250 databases (PostgreSQL, MySQL, ClickHouse, SQLServer)
3. Upgrade from 0.47 to `v0.51.12.1` and wait for all migrations to complete
4. Start additional instances of metabase in k8s deployment
5. See some of the instances get ready quickly but some take very long time

### Expected behavior

All instances get ready in approximately same and reasonable time.

### Logs


[metabase_send.log](https://github.com/user-attachments/files/18495268/metabase_send.log)

During startup a lot of index scans happen:

<img width=""906"" alt=""Image"" src=""https://github.com/user-attachments/assets/f5edada7-40e2-4566-b03a-8f97c7308131"" />

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""ru-RU"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mysql"",
      ""postgres"",
      ""sqlserver"",
      ""clickhouse"",
      ""bigquery-cloud-sdk"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-15"",
      ""tag"": ""v0.51.12.1"",
      ""hash"": ""73a07d7""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Moscow""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.12 (Ubuntu 14.12-201-yandex.53249.ae65d30249)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.25+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.25"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.25+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.4.0-167-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

blocking upgrade

### Additional context

_No response_",k-popov,2025-01-21 17:36:25+00:00,[],2025-02-04 20:26:29+00:00,,https://github.com/metabase/metabase/issues/52458,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Operation/', ''), ('.Backend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2605445528, 'issue_id': 2802441782, 'author': 'dpsutton', 'body': ""from the original issue:\n\nthe frequency of your databases\n\n@dpsutton , here you are:\n\n```sql\nmetabase=> select engine, count(*) from metabase_database group by engine;\n       engine       | count\n--------------------+-------\n postgres           |   232\n bigquery-cloud-sdk |     1\n h2                 |     1\n mysql              |     6\n clickhouse         |    15\n sqlserver          |     2\n(6 rows)\n```\n\nThere is issue https://github.com/metabase/metabase/issues/52188 about clickhouse driver in metabase but that's not the case - the behaviour is the same without clickhouse driver.\n\nI had a hunch clickhouse's slow startup was involved but that's not the case. @k-popov thank you for the information."", 'created_at': datetime.datetime(2025, 1, 21, 18, 21, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2609760103, 'issue_id': 2802441782, 'author': 'k-popov', 'body': 'I\'m not sure but probably this ""check-and-schedule-tasks"" (or similar activity) could also be slow before Metabase v50 but it used to be executed ""in background"", after metabase was marked ready [init complete in 49](https://github.com/metabase/metabase/blob/c611241dd0767fa0623cbf0c91899990875d5171/src/metabase/core.clj#L149) [init  complete in 50](https://github.com/metabase/metabase/blob/785c51d6f0e8b9d58a15551ea76dfa22a2fdb150/src/metabase/core.clj#L164)\n\nWouldn\'t it make sense to mark metabase ready before doing `check-and-schedule-tasks` in background?', 'created_at': datetime.datetime(2025, 1, 23, 13, 4, 56, tzinfo=datetime.timezone.utc)}]","dpsutton on (2025-01-21 18:21:43 UTC): from the original issue:

the frequency of your databases

@dpsutton , here you are:

```sql
metabase=> select engine, count(*) from metabase_database group by engine;
       engine       | count
--------------------+-------
 postgres           |   232
 bigquery-cloud-sdk |     1
 h2                 |     1
 mysql              |     6
 clickhouse         |    15
 sqlserver          |     2
(6 rows)
```

There is issue https://github.com/metabase/metabase/issues/52188 about clickhouse driver in metabase but that's not the case - the behaviour is the same without clickhouse driver.

I had a hunch clickhouse's slow startup was involved but that's not the case. @k-popov thank you for the information.

k-popov (Issue Creator) on (2025-01-23 13:04:56 UTC): I'm not sure but probably this ""check-and-schedule-tasks"" (or similar activity) could also be slow before Metabase v50 but it used to be executed ""in background"", after metabase was marked ready [init complete in 49](https://github.com/metabase/metabase/blob/c611241dd0767fa0623cbf0c91899990875d5171/src/metabase/core.clj#L149) [init  complete in 50](https://github.com/metabase/metabase/blob/785c51d6f0e8b9d58a15551ea76dfa22a2fdb150/src/metabase/core.clj#L164)

Wouldn't it make sense to mark metabase ready before doing `check-and-schedule-tasks` in background?

"
2802230018,issue,open,,Custom expression should not be available to use in join condition,"### Describe the bug

Custom column, expression, is available in join condition picker. Clicking it results in console error, while nothing is happening in the UI. Context in [this](https://metaboat.slack.com/archives/C0645JP1W81/p1737473996582099) slack thread.

### To Reproduce

Create a query is in the screenshot. You can pick the custom expression as column to compare in join condition.

<img width=""1496"" alt=""Image"" src=""https://github.com/user-attachments/assets/22991cee-1d05-40ee-9b23-05ae44df7235"" />


### Expected behavior

Custom column should not be available in aforementioned context.

### Logs

_No response_

### Information about your Metabase installation

```JSON
9c904e8500eba75d665b1189cf87c0af93e7db54
```

### Severity

Confusing

### Additional context

_No response_",lbrdnk,2025-01-21 15:57:24+00:00,[],2025-02-04 20:28:54+00:00,,https://github.com/metabase/metabase/issues/52451,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Querying/Notebook/Custom Expression', ''), ('.metabase-lib', 'Label for tracking all issues related to the shared CLJC metabase-lib'), ('.Team/Querying', ''), ('good first issue', 'A starter issue that is good for someone new to the codebase or is a new contributor')]","[{'comment_id': 2605157693, 'issue_id': 2802230018, 'author': 'bshepherdson', 'body': ""We should tread somewhat carefully here. It's not clear how long this has been possible, and so there may be questions in the wild which make use of it.\n\nTheoretically there's nothing wrong with using an expression in a join condition, but it won't compile correctly today.\n\nThe workaround if you do need a join based on an expression is to define the expression in a model or saved question, and then make that the source for another question that does the join."", 'created_at': datetime.datetime(2025, 1, 21, 16, 10, 24, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2025-01-21 16:10:24 UTC): We should tread somewhat carefully here. It's not clear how long this has been possible, and so there may be questions in the wild which make use of it.

Theoretically there's nothing wrong with using an expression in a join condition, but it won't compile correctly today.

The workaround if you do need a join based on an expression is to define the expression in a model or saved question, and then make that the source for another question that does the join.

"
2802158534,issue,open,,"""You don't have permissions to do that."" when normal user tries to remove a filter after the dashboard has been published","### Describe the bug

A corner case where a normal (non-admin) user tries to remove a filter from a dashboard that has embedding enabled with all filters ""editable"" which can't remove any filter as we'll return a 401

### To Reproduce

As an admin:
1) create a dashboard (e.g. an x-ray)
2) enable embedding of this dashboard and set all the filters as editable
3) create a user and send the user to ""all users""

Log in as the new user
4) go to the dashboard and try to delete one of the filters

### Expected behavior

Is this because we risk breaking the embedding? I don't know how we should handle this

### Logs

NA, we just return a 401

### Information about your Metabase installation

```JSON
It's there since the beginning I guess, I reproduced with 52.6
```

### Severity

P2?

### Additional context

Reported by an enterprise customer",paoliniluis,2025-01-21 15:27:27+00:00,[],2025-02-04 20:30:45+00:00,,https://github.com/metabase/metabase/issues/52448,"[('Priority:P2', 'Average run of the mill bug'), ('Type:New Feature', ''), ('Administration/Permissions', 'Collection or Data permissions'), ('Embedding/Static', 'Static embedding, previously known as signed embedding'), ('.Team/Embedding', '')]","[{'comment_id': 2605158977, 'issue_id': 2802158534, 'author': 'dpsutton', 'body': 'This throws on the backend because of \n\n```clojure\n(defn- check-allowed-to-change-embedding\n  ""You must be a superuser to change the value of `enable_embedding` or `embedding_params`. Embedding must be\n  enabled.""\n  [dash-before-update dash-updates]\n  (when (or (api/column-will-change? :enable_embedding dash-before-update dash-updates)\n            (api/column-will-change? :embedding_params dash-before-update dash-updates))\n    (validation/check-embedding-enabled)\n    (api/check-superuser)))\n```\n\nWe require superusers to vet the changes that affect embedding. I imagine removing filters with values could display all content to embedded users who expected filtered content.', 'created_at': datetime.datetime(2025, 1, 21, 16, 10, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2605201631, 'issue_id': 2802158534, 'author': 'dpsutton', 'body': 'Dashboard:\n\n<img width=""1266"" alt=""Image"" src=""https://github.com/user-attachments/assets/e42c9333-77ef-4bdb-9805-1c728be31562"" />\n\nRemove filter\n\n<img width=""1266"" alt=""Image"" src=""https://github.com/user-attachments/assets/13f4d324-c15b-4073-b27f-260f449a7d08"" />\n\nWhen you hit save you get a full screen 403\n\n<img width=""1266"" alt=""Image"" src=""https://github.com/user-attachments/assets/8e553f3c-dd46-4250-96e7-d3af016a5b58"" />', 'created_at': datetime.datetime(2025, 1, 21, 16, 28, 35, tzinfo=datetime.timezone.utc)}, {'comment_id': 2605214398, 'issue_id': 2802158534, 'author': 'luizarakaki', 'body': 'To solve the bug:\n- Show a more descriptive error message to the user. Something like `Only admins can change parameters from embedded dashboards`\n\nTo improve this situation (feature request)\n- Instead of blocking users from editing embedded dashboards, we should let any user with edit access do it and inform them about the consequences (explain that removing the filter will impact embedding).', 'created_at': datetime.datetime(2025, 1, 21, 16, 33, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2605226266, 'issue_id': 2802158534, 'author': 'dpsutton', 'body': 'This seems to have been the functionality since Feb 22, 2017 in 634acda607820e2bbae3e64279621f6644e9fb56 ""JWT embedding for Cards & Dashboards :yum:""', 'created_at': datetime.datetime(2025, 1, 21, 16, 38, 57, tzinfo=datetime.timezone.utc)}]","dpsutton on (2025-01-21 16:10:55 UTC): This throws on the backend because of 

```clojure
(defn- check-allowed-to-change-embedding
  ""You must be a superuser to change the value of `enable_embedding` or `embedding_params`. Embedding must be
  enabled.""
  [dash-before-update dash-updates]
  (when (or (api/column-will-change? :enable_embedding dash-before-update dash-updates)
            (api/column-will-change? :embedding_params dash-before-update dash-updates))
    (validation/check-embedding-enabled)
    (api/check-superuser)))
```

We require superusers to vet the changes that affect embedding. I imagine removing filters with values could display all content to embedded users who expected filtered content.

dpsutton on (2025-01-21 16:28:35 UTC): Dashboard:

<img width=""1266"" alt=""Image"" src=""https://github.com/user-attachments/assets/e42c9333-77ef-4bdb-9805-1c728be31562"" />

Remove filter

<img width=""1266"" alt=""Image"" src=""https://github.com/user-attachments/assets/13f4d324-c15b-4073-b27f-260f449a7d08"" />

When you hit save you get a full screen 403

<img width=""1266"" alt=""Image"" src=""https://github.com/user-attachments/assets/8e553f3c-dd46-4250-96e7-d3af016a5b58"" />

luizarakaki on (2025-01-21 16:33:47 UTC): To solve the bug:
- Show a more descriptive error message to the user. Something like `Only admins can change parameters from embedded dashboards`

To improve this situation (feature request)
- Instead of blocking users from editing embedded dashboards, we should let any user with edit access do it and inform them about the consequences (explain that removing the filter will impact embedding).

dpsutton on (2025-01-21 16:38:57 UTC): This seems to have been the functionality since Feb 22, 2017 in 634acda607820e2bbae3e64279621f6644e9fb56 ""JWT embedding for Cards & Dashboards :yum:""

"
2802029313,issue,closed,completed,General Settings: autofocus + URL hash = confusion,"### Describe the bug

[2 things simultaneously in focus](https://github.com/user-attachments/assets/c5497de6-7719-4009-92c4-f2dc88f1123d)

https://github.com/user-attachments/assets/7b1240b5-7c48-4d21-b51a-a0eb8741318b

### To Reproduce

1. Set viewport height to 1326px
2. New > Dashboard
3. Add an iframe, use https://example.com and click ""Done""
4. You should see ""example.com can not be embedded in iframe cards."" message
5. Click the ""allowed domains list"" link below.
6. General Settings page opens
7. 2 things are in focus at the same time - the ""Site name"" input and ""Allowed domains"".

(the following actually happened to me 😅)
❌ We want to bring user's attention to ""Allowed domains"", but ""Site name"" is the first thing in focus, so user does not even see it
❌ There's a focused input, but its name is covered by header, so user just assumes that's the input for allowed domains list, and tries to use it as such

So I put my allowed domain in that input, went back to the dashboard, and to my surprise it didn't affect anything.

### Information about your Metabase installation

master, 8590ba6448

### Severity

P3
",kamilmielnik,2025-01-21 14:35:25+00:00,['lorem--ipsum'],2025-01-29 09:20:19+00:00,2025-01-29 06:23:36+00:00,https://github.com/metabase/metabase/issues/52439,"[('Type:Bug', 'Product defects'), ('Type:UX', ''), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2802027645,issue,open,,Sidesheets should only slide left but they also grow,"### Describe the bug

https://metaboat.slack.com/archives/C05MPF0TM3L/p1737392652918079

### To Reproduce

1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
-
```

### Severity

P3

### Additional context

_No response_",rafpaf,2025-01-21 14:34:44+00:00,['rafpaf'],2025-01-22 14:35:26+00:00,,https://github.com/metabase/metabase/issues/52438,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2607415021, 'issue_id': 2802027645, 'author': 'rafpaf', 'body': ""To fix this I'll probably switch the `Sidesheet` to use Mantine's `Drawer`"", 'created_at': datetime.datetime(2025, 1, 22, 14, 35, 25, tzinfo=datetime.timezone.utc)}]","rafpaf (Issue Creator) on (2025-01-22 14:35:25 UTC): To fix this I'll probably switch the `Sidesheet` to use Mantine's `Drawer`

"
2801978898,issue,closed,completed,"Filter value's ""x"" icon not visible on hover","### Describe the bug

https://github.com/user-attachments/assets/c04d47e3-38d5-4935-9db8-016cb2724af9

### To Reproduce

1. New > Dashboard
2. Add Text filter
3. Save
4. Give the filter a value
5. Open it again
6. Hover exactly the ""x"" icon

### Information about your Metabase installation

master, 8590ba6448

### Severity

P3
",kamilmielnik,2025-01-21 14:15:08+00:00,['uladzimirdev'],2025-01-27 22:11:07+00:00,2025-01-21 19:14:52+00:00,https://github.com/metabase/metabase/issues/52434,"[('Type:Bug', 'Product defects'), ('.CSS', ''), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Needs Triage', ''), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]","[{'comment_id': 2604882867, 'issue_id': 2801978898, 'author': 'uladzimirdev', 'body': '@kamilmielnik should it be white on hover?', 'created_at': datetime.datetime(2025, 1, 21, 14, 26, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2604892068, 'issue_id': 2801978898, 'author': 'kamilmielnik', 'body': ""> [@kamilmielnik](https://github.com/kamilmielnik) should it be white on hover?\n\nThat's how I remember it, but better to double-check with an older jar"", 'created_at': datetime.datetime(2025, 1, 21, 14, 30, tzinfo=datetime.timezone.utc)}]","uladzimirdev (Assginee) on (2025-01-21 14:26:24 UTC): @kamilmielnik should it be white on hover?

kamilmielnik (Issue Creator) on (2025-01-21 14:30:00 UTC): That's how I remember it, but better to double-check with an older jar

"
2801756278,issue,open,,We're dropping parameters when exporting an embedded question,"### Describe the bug

If you build a SQL question with default parameters and embed it, we're dropping parameters when a user tries to download it

### To Reproduce

1) create a sql question like ""select * from people where {{state}}"". Set NY and TS as default parameter
2) then embed this question (enable editable parameters)
3) try to download the question

you'll see that although the question has NY and TS in the filter, we're dropping one when the user downloads it

### Expected behavior

We should not drop the parameters

### Logs

![Image](https://github.com/user-attachments/assets/74180962-9cee-4add-a71c-a57b89d8733e)

### Information about your Metabase installation

```JSON
it's been there since 50.x at least
```

### Severity

P1

### Additional context

NA",paoliniluis,2025-01-21 12:48:07+00:00,[],2025-02-04 20:25:46+00:00,,https://github.com/metabase/metabase/issues/52430,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Embedding/Static', 'Static embedding, previously known as signed embedding'), ('.Team/Embedding', '')]",[],
2801745676,issue,open,,Granular Slack channel alerts/subscriptions Permissions,"**Is your feature request related to a problem? Please describe.**
Even though Metabase requires the Metabase Slack app to be added to the channel in order for the pulse to be sent, admins might want to define who can send specific data to a private channel

**Describe the solution you'd like**
In the customer's words:
> Slack integration should have per-channel upload permissions to private channels, and not upload all content to a public channel.

**Describe alternatives you've considered**
N/A

",ignacio-mb,2025-01-21 12:43:28+00:00,[],2025-02-04 20:30:57+00:00,,https://github.com/metabase/metabase/issues/52428,"[('Reporting/Pulses', 'Now called Subscriptions'), ('Type:New Feature', ''), ('Administration/Permissions', 'Collection or Data permissions'), ('Reporting/Alerts', ''), ('.Team/Workflows', 'aka BEC')]",[],
2800764236,issue,open,,Improving date filters on native SQL queries,"**Is your feature request related to a problem? Please describe.**

> I'm always frustrated when I work with native queries for a filter of dates that i cannot simply get the text output of YYYY-MM-DD of type ""date"" from filter. The current implementation forces me to manually format or manipulate the date, which adds unnecessary steps to my workflow and increases the chances of errors. Besides, it would be great if it also provides options like 'previous months' / 'current month' etc. 

**Describe the solution you'd like**
> I would like the option on date filter to natively provide its output in the YYYY-MM-DD format of type date without needing any additional conversion or formatting. This would make it much easier to work with the output in downstream processes or APIs that require this format.

**Describe alternatives you've considered**
1. Making use of Questions, but it blocks me from creating more complex queries.
2. Use text to force user to input YYYY-MM-DD, but it is not user-friendly

**How important is this feature to you?**
> This feature is very important as it would significantly improve productivity, reduce repetitive tasks, and minimize potential errors caused by manual date formatting. Having this feature will greatly improve the experience working with date filters on metabase for native queries.

![Image](https://github.com/user-attachments/assets/3ca8cdd5-8911-4b32-abff-2a8d51deb0e5)",wchtommy,2025-01-21 05:49:36+00:00,[],2025-02-04 20:30:28+00:00,,https://github.com/metabase/metabase/issues/52424,"[('Type:New Feature', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Querying/Native', 'The SQL/native query editor'), ('.Team/Querying', '')]","[{'comment_id': 2604597466, 'issue_id': 2800764236, 'author': 'mngr', 'body': 'Hey @wchtommy, could you please give any specific example when the filter generates something different from YYYY-MM-DD?\nCause from what I see this is what currently happens exactly.\n\n<img width=""1600"" alt=""Image"" src=""https://github.com/user-attachments/assets/25c1352c-50aa-4e6d-963f-72f3f50fa8b8"" />\n<img width=""743"" alt=""Image"" src=""https://github.com/user-attachments/assets/b09a26e6-f9a0-4ba4-9190-2f95871a9af6"" />', 'created_at': datetime.datetime(2025, 1, 21, 12, 26, 41, tzinfo=datetime.timezone.utc)}]","mngr on (2025-01-21 12:26:41 UTC): Hey @wchtommy, could you please give any specific example when the filter generates something different from YYYY-MM-DD?
Cause from what I see this is what currently happens exactly.

<img width=""1600"" alt=""Image"" src=""https://github.com/user-attachments/assets/25c1352c-50aa-4e6d-963f-72f3f50fa8b8"" />
<img width=""743"" alt=""Image"" src=""https://github.com/user-attachments/assets/b09a26e6-f9a0-4ba4-9190-2f95871a9af6"" />

"
2800493156,issue,closed,completed,"""You can't operate on a closed Statement!!!"" error when DB cuts the connection while we're building an export","### Describe the bug

Seems that we're iterating over some closed statement which pegs the CPU

### To Reproduce

1) build a pivot table like 
![Image](https://github.com/user-attachments/assets/0b9beda1-55dd-4141-816b-47298208e130)

dataset is here: https://drive.google.com/file/d/1mQy2gLlcw-CJH83cwc53v8J1KOLIQzq0/view?usp=sharing

(cpu for Metabase is 4 cores and 8GB of RAM)

2) do a csv export of that pivot table

... it will take a lot of time, and the database will cut the connection but Metabase will keep the CPU pegged at 100%, probably waiting for something that won't come since the DB has already cut the connection

### Expected behavior

We should cut the processes when the db's cut the connection

### Logs

```
Exception in thread ""async-dispatch-1"" Exception in thread ""async-dispatch-3"" Exception in thread ""async-dispatch-6"" Exception in thread ""async-dispatch-7"" Exception in thread ""async-dispatch-2"" java.sql.SQLException: You can't operate on a closed Statement!!!
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:117)
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:77)
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:133)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520$fn__87522.invoke(execute.clj:533)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520.invoke(execute.clj:530)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invokeStatic(ioc_macros.clj:972)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invoke(ioc_macros.clj:971)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invokeStatic(ioc_macros.clj:976)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invoke(ioc_macros.clj:974)
	at clojure.core.async.impl.ioc_macros$take_BANG_$fn__50563.invoke(ioc_macros.clj:985)
	at clojure.core.async.impl.channels.ManyToManyChannel$fn__46737$fn__46738.invoke(channels.clj:100)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at clojure.core.async.impl.concurrent$counted_thread_factory$reify__43561$fn__43562.invoke(concurrent.clj:29)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NullPointerException: Cannot invoke ""java.sql.Statement.cancel()"" because ""this.inner"" is null
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:127)
	... 14 more
java.sql.SQLException: You can't operate on a closed Statement!!!
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:117)
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:77)
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:133)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520$fn__87522.invoke(execute.clj:533)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520.invoke(execute.clj:530)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invokeStatic(ioc_macros.clj:972)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invoke(ioc_macros.clj:971)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invokeStatic(ioc_macros.clj:976)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invoke(ioc_macros.clj:974)
	at clojure.core.async.impl.ioc_macros$take_BANG_$fn__50563.invoke(ioc_macros.clj:985)
	at clojure.core.async.impl.channels.ManyToManyChannel$fn__46737$fn__46738.invoke(channels.clj:100)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at clojure.core.async.impl.concurrent$counted_thread_factory$reify__43561$fn__43562.invoke(concurrent.clj:29)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NullPointerException: Cannot invoke ""java.sql.Statement.cancel()"" because ""this.inner"" is null
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:127)
	... 14 more
java.sql.SQLException: You can't operate on a closed Statement!!!
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:117)
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:77)
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:133)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520$fn__87522.invoke(execute.clj:533)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520.invoke(execute.clj:530)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invokeStatic(ioc_macros.clj:972)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invoke(ioc_macros.clj:971)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invokeStatic(ioc_macros.clj:976)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invoke(ioc_macros.clj:974)
	at clojure.core.async.impl.ioc_macros$take_BANG_$fn__50563.invoke(ioc_macros.clj:985)
	at clojure.core.async.impl.channels.ManyToManyChannel$fn__46737$fn__46738.invoke(channels.clj:100)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at clojure.core.async.impl.concurrent$counted_thread_factory$reify__43561$fn__43562.invoke(concurrent.clj:29)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NullPointerException: Cannot invoke ""java.sql.Statement.cancel()"" because ""this.inner"" is null
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:127)
	... 14 more
java.sql.SQLException: You can't operate on a closed Statement!!!
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:117)
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:77)
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:133)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520$fn__87522.invoke(execute.clj:533)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520.invoke(execute.clj:530)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invokeStatic(ioc_macros.clj:972)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invoke(ioc_macros.clj:971)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invokeStatic(ioc_macros.clj:976)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invoke(ioc_macros.clj:974)
	at clojure.core.async.impl.ioc_macros$take_BANG_$fn__50563.invoke(ioc_macros.clj:985)
	at clojure.core.async.impl.channels.ManyToManyChannel$fn__46737$fn__46738.invoke(channels.clj:100)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at clojure.core.async.impl.concurrent$counted_thread_factory$reify__43561$fn__43562.invoke(concurrent.clj:29)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NullPointerException: Cannot invoke ""java.sql.Statement.cancel()"" because ""this.inner"" is null
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:127)
	... 14 more
java.sql.SQLException: You can't operate on a closed Statement!!!
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:117)
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:77)
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:133)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520$fn__87522.invoke(execute.clj:533)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520.invoke(execute.clj:530)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invokeStatic(ioc_macros.clj:972)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invoke(ioc_macros.clj:971)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invokeStatic(ioc_macros.clj:976)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invoke(ioc_macros.clj:974)
	at clojure.core.async.impl.ioc_macros$take_BANG_$fn__50563.invoke(ioc_macros.clj:985)
	at clojure.core.async.impl.channels.ManyToManyChannel$fn__46737$fn__46738.invoke(channels.clj:100)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at clojure.core.async.impl.concurrent$counted_thread_factory$reify__43561$fn__43562.invoke(concurrent.clj:29)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NullPointerException: Cannot invoke ""java.sql.Statement.cancel()"" because ""this.inner"" is null
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:127)
	... 14 more
Exception in thread ""async-dispatch-8"" java.sql.SQLException: You can't operate on a closed Statement!!!
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:117)
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:77)
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:133)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520$fn__87522.invoke(execute.clj:533)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520.invoke(execute.clj:530)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invokeStatic(ioc_macros.clj:972)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invoke(ioc_macros.clj:971)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invokeStatic(ioc_macros.clj:976)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invoke(ioc_macros.clj:974)
	at clojure.core.async.impl.ioc_macros$take_BANG_$fn__50563.invoke(ioc_macros.clj:985)
	at clojure.core.async.impl.channels.ManyToManyChannel$fn__46737$fn__46738.invoke(channels.clj:100)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at clojure.core.async.impl.concurrent$counted_thread_factory$reify__43561$fn__43562.invoke(concurrent.clj:29)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NullPointerException: Cannot invoke ""java.sql.Statement.cancel()"" because ""this.inner"" is null
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:127)
	... 14 more
Exception in thread ""async-dispatch-5"" java.sql.SQLException: You can't operate on a closed Statement!!!
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:117)
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:77)
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:133)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520$fn__87522.invoke(execute.clj:533)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520.invoke(execute.clj:530)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invokeStatic(ioc_macros.clj:972)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invoke(ioc_macros.clj:971)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invokeStatic(ioc_macros.clj:976)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invoke(ioc_macros.clj:974)
	at clojure.core.async.impl.ioc_macros$take_BANG_$fn__50563.invoke(ioc_macros.clj:985)
	at clojure.core.async.impl.channels.ManyToManyChannel$fn__46737$fn__46738.invoke(channels.clj:100)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at clojure.core.async.impl.concurrent$counted_thread_factory$reify__43561$fn__43562.invoke(concurrent.clj:29)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NullPointerException: Cannot invoke ""java.sql.Statement.cancel()"" because ""this.inner"" is null
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:127)
	... 14 more
Exception in thread ""async-dispatch-4"" java.sql.SQLException: You can't operate on a closed Statement!!!
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:117)
	at com.mchange.v2.sql.SqlUtils.toSQLException(SqlUtils.java:77)
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:133)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520$fn__87522.invoke(execute.clj:533)
	at metabase.driver.sql_jdbc.execute$wire_up_canceled_chan_to_cancel_Statement_BANG_$fn__87515$state_machine__50545__auto____87520.invoke(execute.clj:530)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invokeStatic(ioc_macros.clj:972)
	at clojure.core.async.impl.ioc_macros$run_state_machine.invoke(ioc_macros.clj:971)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invokeStatic(ioc_macros.clj:976)
	at clojure.core.async.impl.ioc_macros$run_state_machine_wrapped.invoke(ioc_macros.clj:974)
	at clojure.core.async.impl.ioc_macros$take_BANG_$fn__50563.invoke(ioc_macros.clj:985)
	at clojure.core.async.impl.channels.ManyToManyChannel$fn__46737$fn__46738.invoke(channels.clj:100)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
	at clojure.core.async.impl.concurrent$counted_thread_factory$reify__43561$fn__43562.invoke(concurrent.clj:29)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.lang.NullPointerException: Cannot invoke ""java.sql.Statement.cancel()"" because ""this.inner"" is null
	at com.mchange.v2.c3p0.impl.NewProxyStatement.cancel(NewProxyStatement.java:127)
	... 14 more

```

### Information about your Metabase installation

```JSON
52.6
```

### Severity

P1

### Additional context

I'll test this with a shorter timeout of the DB to see what happens",paoliniluis,2025-01-21 01:13:13+00:00,['noahmoss'],2025-01-28 21:30:11+00:00,2025-01-28 17:39:02+00:00,https://github.com/metabase/metabase/issues/52420,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Backend', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Reporting/Export/Pivot', 'Exporting data as pivoted tables'), ('Bug:v52', 'bugs or regressions introduced in v52')]","[{'comment_id': 2603497621, 'issue_id': 2800493156, 'author': 'paoliniluis', 'body': 'so this one is difficult to reproduce, since you need to make the query to be fast on the UI but slow on the export, pretty difficult...', 'created_at': datetime.datetime(2025, 1, 21, 2, 27, 27, tzinfo=datetime.timezone.utc)}]","paoliniluis (Issue Creator) on (2025-01-21 02:27:27 UTC): so this one is difficult to reproduce, since you need to make the query to be fast on the UI but slow on the export, pretty difficult...

"
2800452047,issue,open,,/api/health will return 200 even if the app is unresponsive,"### Describe the bug

If the app doesn't have any RAM or CPU at all, seems that we're still responding a 200 on the health checks, which is... odd

### To Reproduce

1) do a very big pivot table and assign, let's say, 8GB of RAM. Download it formatted in CSV
![Image](https://github.com/user-attachments/assets/e00252dd-1f6f-40cc-8ebd-14ec02d79c04)
![Image](https://github.com/user-attachments/assets/c4789322-87d2-461e-add1-40a2e5a7b175)

(all your RAM should get eaten up and now your CPU should be at 100% pegged)

2) wait a long time, your cpu and RAM are exhausted, your app can't be alive and does not respond, but your health checks return 200

### Expected behavior

We should design a better health check to see for jetty threads maybe?

### Logs

NOTE: I'M REMOVING SOME LOG LINES SINCE I JUST SAW THEY BELONG TO THE POSTGRES DW RATHER THAN TO THE APP DB, but the issue is still there

```
2025-01-21 00:07:53,391 DEBUG middleware.log :: GET /api/health 200 5ms (0 DB calls) App DB connections: 0/10 Jetty threads: 4/50 (2 idle, 0 queued) (96 total active threads) Queries in flight: 1 (0 queued) {:metabase-user-id nil}
```

### Information about your Metabase installation

```JSON
52.6
```

### Severity

P1-0

### Additional context

The app was dead at all times, and the health check was keeping sending 200's

![Image](https://github.com/user-attachments/assets/cf7a39d2-1ee8-4fc2-8bd4-c925cc1340d6)",paoliniluis,2025-01-21 00:18:42+00:00,[],2025-02-04 20:26:30+00:00,,https://github.com/metabase/metabase/issues/52419,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Operation/', ''), ('.Backend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2610033693, 'issue_id': 2800452047, 'author': 'turbotankist', 'body': 'the same problem with v0.52.4 and RDS\n/api/health responses with timeout\n`Warning   Unhealthy   pod/metabase-5b9c4b7c4-289qb   Readiness probe failed: Get ""http://172.31.115.199:3000/api/health"": context deadline exceeded (Client.Timeout exceeded while awaiting headers)`\nbut resources of the metabase instances are fine.\n![Image](https://github.com/user-attachments/assets/0f30aa1d-83f7-4bc2-be21-00e283928eb9)\n\nThe reason was in postgres (rds) overload\n\n![Image](https://github.com/user-attachments/assets/5ede620c-b46e-4518-88da-747be916a138)\nI can show only part of the query\n```\nSELECT ""metabase_field"".""name"", ""metabase_field"".""base_type"", ""metabase_field"".""semantic_type"", ""metabase_field"".""id"", \n""metabase_field"".""table_id"", ""table"".""name"" AS ""table_name"" FROM ""metabase_field"" INNER JOIN ""metabase_table"" AS \n""table"" ON ""table"".""active"" AND (""table"".""id"" = ""metabase_field"".""table_id"") WHERE (""metabase_field"".""active"" = ?) AND \n(LOWER(""metabase_field"".""name"") LIKE $1) AND (""metabase_field"".""visibility_type"" NOT IN ($2, $3)) AND\n (""table"".""db_id"" = $4) ORDER BY LOWER(""metabase ...\n\n```', 'created_at': datetime.datetime(2025, 1, 23, 14, 57, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2610725121, 'issue_id': 2800452047, 'author': 'paoliniluis', 'body': ""Interesting @turbotankist, what's your RDS sizing? I'm wondering why it can't resolve that very simple query"", 'created_at': datetime.datetime(2025, 1, 23, 18, 47, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2612779056, 'issue_id': 2800452047, 'author': 'turbotankist', 'body': 'We found the problem - it was a huge amount of fields from dev schemas.\nWe had in the metabase_field 3,000,000 rows and in metabase_table 800,000 rows.\nThey just need to be removed.', 'created_at': datetime.datetime(2025, 1, 24, 15, 19, tzinfo=datetime.timezone.utc)}]","turbotankist on (2025-01-23 14:57:17 UTC): the same problem with v0.52.4 and RDS
/api/health responses with timeout
`Warning   Unhealthy   pod/metabase-5b9c4b7c4-289qb   Readiness probe failed: Get ""http://172.31.115.199:3000/api/health"": context deadline exceeded (Client.Timeout exceeded while awaiting headers)`
but resources of the metabase instances are fine.
![Image](https://github.com/user-attachments/assets/0f30aa1d-83f7-4bc2-be21-00e283928eb9)

The reason was in postgres (rds) overload

![Image](https://github.com/user-attachments/assets/5ede620c-b46e-4518-88da-747be916a138)
I can show only part of the query
```
SELECT ""metabase_field"".""name"", ""metabase_field"".""base_type"", ""metabase_field"".""semantic_type"", ""metabase_field"".""id"", 
""metabase_field"".""table_id"", ""table"".""name"" AS ""table_name"" FROM ""metabase_field"" INNER JOIN ""metabase_table"" AS 
""table"" ON ""table"".""active"" AND (""table"".""id"" = ""metabase_field"".""table_id"") WHERE (""metabase_field"".""active"" = ?) AND 
(LOWER(""metabase_field"".""name"") LIKE $1) AND (""metabase_field"".""visibility_type"" NOT IN ($2, $3)) AND
 (""table"".""db_id"" = $4) ORDER BY LOWER(""metabase ...

```

paoliniluis (Issue Creator) on (2025-01-23 18:47:16 UTC): Interesting @turbotankist, what's your RDS sizing? I'm wondering why it can't resolve that very simple query

turbotankist on (2025-01-24 15:19:00 UTC): We found the problem - it was a huge amount of fields from dev schemas.
We had in the metabase_field 3,000,000 rows and in metabase_table 800,000 rows.
They just need to be removed.

"
2800248648,issue,open,,Ability to set a default user to transfer ownership of content once a user is deactivated,"**Is your feature request related to a problem? Please describe.**
In the customer words:

> Dashboard subscriptions created by a deactivated user are currently running the queries while still impersonating the deactivated user role, so they fail and display an error.


**Describe the solution you'd like**
In the customer words:
> When a user is deactivated, their subscriptions sent to non-deactivated users should transfer ownership to a default user to avoid sending failed queries.

**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
N/A

**Additional context**
Add any other context or screenshots about the feature request here.
",ignacio-mb,2025-01-20 20:47:56+00:00,[],2025-02-04 20:30:50+00:00,,https://github.com/metabase/metabase/issues/52407,"[('Type:New Feature', ''), ('Administration/People', 'and Groups. Also user Account Settings')]",[],
2800235478,issue,open,,"'Week of year' breakdown display a 53rd week for 2024, even though there are only 52 weeks in 2024.","### Describe the bug

<img width=""1414"" alt=""Image"" src=""https://github.com/user-attachments/assets/c01e54ff-202d-42ba-84bc-8382ee592be9"" />

<img width=""943"" alt=""Image"" src=""https://github.com/user-attachments/assets/c89e4ba4-efee-4d02-ab07-49b117f14aa4"" />

### To Reproduce

Go to 'New - Question'
Select any metric in the summarize section
Select 2 grouping options :
any timestamp with 'week of year' option
the same timestamp with 'year' option
See error

### Expected behavior

There should be only 52 weeks for year 2024



### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""fr-FR"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-15"",
      ""tag"": ""v0.52.6"",
      ""hash"": ""1a9cb72""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Paris""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.6""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.0-1072-aws"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Paris""
  }
}
```

### Severity

Medium-high

### Additional context

_No response_",kamilbennani,2025-01-20 20:36:55+00:00,[],2025-02-04 20:27:35+00:00,,https://github.com/metabase/metabase/issues/52405,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Querying/GUI', 'Query builder catch-all, including simple mode'), ('.Team/Querying', '')]","[{'comment_id': 2603202324, 'issue_id': 2800235478, 'author': 'ranquild', 'body': '@kamilbennani there are different methods to calculate week-of-year numbers, with results varying between 52-54. It\'s not about 2024 having ""52"" weeks, it\'s about week numbers. Depending on the method, either the last several days of December is week 1 or week 52/53/54.', 'created_at': datetime.datetime(2025, 1, 20, 20, 41, 44, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603288097, 'issue_id': 2800235478, 'author': 'mngr', 'body': 'Currently, when the Week of Year bucketing is specified, we apply some algorithm to calculate week numbers, in fact it assigns 53 as a week number to the first six days of January 2024, cause it considers them as part of the 53rd week of the year 2023.\n<img width=""635"" alt=""Image"" src=""https://github.com/user-attachments/assets/30db7be1-cc16-4c0d-907e-9c1f6a324873"" />\nI understand how this is not desirable when plotting a chart like here.\nWe are researching the possibility to change the current algorithm for the Week of Year bucketing so the 1st of January would always belong to the 1st week of the year.\nRelates to https://github.com/metabase/metabase/issues/51894', 'created_at': datetime.datetime(2025, 1, 20, 22, 5, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603395453, 'issue_id': 2800235478, 'author': 'mngr', 'body': 'Should be closed by https://www.notion.so/metabase/Continuous-week-numbering-18169354c901807c93b7d40e782cd134', 'created_at': datetime.datetime(2025, 1, 21, 0, 17, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2608627696, 'issue_id': 2800235478, 'author': 'wzimrin', 'body': 'Honestly, there will always be a week 53 at times, no matter what the algorithm.  52 weeks is 364 days, so there are 1-2 days left over per year.  Every week numbering system will need to add a week 53 to at least some years to account for those extra days.', 'created_at': datetime.datetime(2025, 1, 23, 1, 5, 46, tzinfo=datetime.timezone.utc)}]","ranquild on (2025-01-20 20:41:44 UTC): @kamilbennani there are different methods to calculate week-of-year numbers, with results varying between 52-54. It's not about 2024 having ""52"" weeks, it's about week numbers. Depending on the method, either the last several days of December is week 1 or week 52/53/54.

mngr on (2025-01-20 22:05:43 UTC): Currently, when the Week of Year bucketing is specified, we apply some algorithm to calculate week numbers, in fact it assigns 53 as a week number to the first six days of January 2024, cause it considers them as part of the 53rd week of the year 2023.
<img width=""635"" alt=""Image"" src=""https://github.com/user-attachments/assets/30db7be1-cc16-4c0d-907e-9c1f6a324873"" />
I understand how this is not desirable when plotting a chart like here.
We are researching the possibility to change the current algorithm for the Week of Year bucketing so the 1st of January would always belong to the 1st week of the year.
Relates to https://github.com/metabase/metabase/issues/51894

mngr on (2025-01-21 00:17:45 UTC): Should be closed by https://www.notion.so/metabase/Continuous-week-numbering-18169354c901807c93b7d40e782cd134

wzimrin on (2025-01-23 01:05:46 UTC): Honestly, there will always be a week 53 at times, no matter what the algorithm.  52 weeks is 364 days, so there are 1-2 days left over per year.  Every week numbering system will need to add a week 53 to at least some years to account for those extra days.

"
2800222963,issue,open,,Add description/message that shows who has access to the collection you are in,"**Is your feature request related to a problem? Please describe.**
A user might not know for sure who has access to their Personal collection or other collections.

**Describe the solution you'd like**
Some sort of FE message that states who has access to that collection, or that is private to you and Admins

**Describe alternatives you've considered**
N/A

**How important is this feature to you?**
Requested by a customer, in their words:
> Inform users better about read-restricted collections (i.e. Personal collections e.g. add a warning message or any visual element in Personal Collections to indicate clearly that content stored there cannot be seen by others.


**Additional context**
N/A
",ignacio-mb,2025-01-20 20:26:28+00:00,[],2025-02-04 20:31:01+00:00,,https://github.com/metabase/metabase/issues/52404,"[('Type:New Feature', ''), ('Organization/Collections', '')]","[{'comment_id': 2603205821, 'issue_id': 2800222963, 'author': 'ignacio-mb', 'body': 'Related to https://github.com/metabase/metabase/issues/50803', 'created_at': datetime.datetime(2025, 1, 20, 20, 44, 54, tzinfo=datetime.timezone.utc)}]","ignacio-mb (Issue Creator) on (2025-01-20 20:44:54 UTC): Related to https://github.com/metabase/metabase/issues/50803

"
2799425659,issue,open,,Saving metric referencing itself should be forbidden,"### Describe the bug

As per [this](https://metaboat.slack.com/archives/C0645JP1W81/p1737375866253629) slack thread, editing a metric definition could result in  metric referencing itself saved in the application database.

We should also further investigate correlation of changing default time dimension of a metric and metric aggregation referencing itself as per linked thread.

### To Reproduce

1. Create new metric.
2. Save.
3. Edit that metric's aggregation. Set it to custom aggregation. Reference the metric being updated.
4. See the error.

### Expected behavior

1. We should prevent this from happening. 
  a. Ideally, FE should not provide metric references in custom aggregation expression to metrics that depend on it including itself. 
  b. BE should return failure for creation or update of metrics as described.
4. We should add safeguards, so when this happens, application is able to recover. At least provide meaningful error.

### Logs

_No response_

### Information about your Metabase installation

```JSON
9c904e8500eba75d665b1189cf87c0af93e7db54 (today's master)
```

### Severity

P2

### Additional context

_No response_",lbrdnk,2025-01-20 14:32:39+00:00,['ericnormand'],2025-02-07 21:13:13+00:00,,https://github.com/metabase/metabase/issues/52385,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('.Team/Querying', ''), ('Querying/Metrics', 'v2')]","[{'comment_id': 2602713784, 'issue_id': 2799425659, 'author': 'lbrdnk', 'body': 'This issue should be probably solved alongside https://github.com/metabase/metabase/issues/35980. Underlying problem is the same in general. That cards could be adjusted so their definition depends on itself. This issues however describe different context of the problem.', 'created_at': datetime.datetime(2025, 1, 20, 15, 30, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2617731447, 'issue_id': 2799425659, 'author': 'ranquild', 'body': 'https://github.com/metabase/metabase/issues/35980#issuecomment-2596870420', 'created_at': datetime.datetime(2025, 1, 28, 2, 59, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2644111309, 'issue_id': 2799425659, 'author': 'ericnormand', 'body': 'I cannot reproduce this by selecting the Metric by name from the Formula pill. However, if I make a custom expression `= [mymetric]` I can reproduce.', 'created_at': datetime.datetime(2025, 2, 7, 20, 55, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2644139092, 'issue_id': 2799425659, 'author': 'ericnormand', 'body': 'I split the frontend part of this bug into https://github.com/metabase/metabase/issues/53407. This issue will be the backend part.', 'created_at': datetime.datetime(2025, 2, 7, 21, 13, 13, tzinfo=datetime.timezone.utc)}]","lbrdnk (Issue Creator) on (2025-01-20 15:30:31 UTC): This issue should be probably solved alongside https://github.com/metabase/metabase/issues/35980. Underlying problem is the same in general. That cards could be adjusted so their definition depends on itself. This issues however describe different context of the problem.

ranquild on (2025-01-28 02:59:40 UTC): https://github.com/metabase/metabase/issues/35980#issuecomment-2596870420

ericnormand (Assginee) on (2025-02-07 20:55:39 UTC): I cannot reproduce this by selecting the Metric by name from the Formula pill. However, if I make a custom expression `= [mymetric]` I can reproduce.

ericnormand (Assginee) on (2025-02-07 21:13:13 UTC): I split the frontend part of this bug into https://github.com/metabase/metabase/issues/53407. This issue will be the backend part.

"
2799169177,issue,open,,Add DnD support to Group By section,"<img width=""389"" alt=""Image"" src=""https://github.com/user-attachments/assets/90485a78-88a3-4eb4-bf61-284800a66c82"" />

There can be pinned and not pinned items, pinned items appear if you go to the viz from notebook editor and click ""Summarize"" button to open right sidebar

",uladzimirdev,2025-01-20 12:42:00+00:00,[],2025-02-04 20:23:51+00:00,,https://github.com/metabase/metabase/issues/52381,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2799165633,issue,open,,Add DnD support to Summarize by section,"<img width=""1065"" alt=""Image"" src=""https://github.com/user-attachments/assets/3c5029c7-b72b-4fc2-a7f0-87ca39aa0256"" />",uladzimirdev,2025-01-20 12:40:26+00:00,[],2025-02-04 20:23:52+00:00,,https://github.com/metabase/metabase/issues/52380,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2799122111,issue,open,,"""Null"" displayed in notification system emails when last name is not set","### Describe the bug

When admin user that doesn't have Last name indicated in the account settings creates an alert and adds other users to it, the email subject line will display 'null' in place of the last name, when we notify other users about being added to an alert. 


### To Reproduce

STR:
- Create an admin user with first name set to ""User"" and no last name filled out - User 1
- Create another user - User 2
- As User 1 set up an alert to be sent to Email channel and indicate User 2 as a recipient of that alert
- As User 2 go to mailbox and look for the email notifying User 2 that User 1 added them to an alert


AR
- subject line says ""User null added you to an alert""

### Expected behavior

ER: 
- email subject line says ""User added you to an alert""

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""url"": ""http://localhost:3000/"",
  ""browserInfo"": {
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36"",
    ""language"": ""en-US"",
    ""browserName"": ""Chrome"",
    ""browserVersion"": ""134.0.0.0"",
    ""platform"": ""desktop"",
    ""os"": ""macOS"",
    ""osVersion"": ""10.15.7""
  },
  ""entityInfo"": null,
  ""bugReportDetails"": {
    ""metabase-info"": {
      ""databases"": [
        ""h2""
      ],
      ""run-mode"": ""dev"",
      ""plan-alias"": """",
      ""version"": {
        ""tag"": ""vLOCAL_DEV"",
        ""hash"": ""06d1ba2ae111e66253209c01c244d6379acfc6dcb1911fa9ab6012cec9ce52e5""
      },
      ""settings"": {
        ""report-timezone"": null
      },
      ""hosting-env"": ""unknown"",
      ""application-database"": ""h2"",
      ""application-database-details"": {
        ""database"": {
          ""name"": ""H2"",
          ""version"": ""2.1.214 (2022-06-13)""
        },
        ""jdbc-driver"": {
          ""name"": ""H2 JDBC Driver"",
          ""version"": ""2.1.214 (2022-06-13)""
        }
      }
    },
    ""system-info"": {
      ""file.encoding"": ""UTF-8"",
      ""java.runtime.name"": ""OpenJDK Runtime Environment"",
      ""java.runtime.version"": ""21.0.5+11-LTS"",
      ""java.vendor"": ""Azul Systems, Inc."",
      ""java.vendor.url"": ""http://www.azul.com/"",
      ""java.version"": ""21.0.5"",
      ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
      ""java.vm.version"": ""21.0.5+11-LTS"",
      ""os.name"": ""Mac OS X"",
      ""os.version"": ""14.6"",
      ""user.language"": ""en"",
      ""user.timezone"": ""Europe/Warsaw""
    }
  }
}
```

### Severity

non-blocking, annoying

### Additional context

_No response_",KorowkaMu,2025-01-20 12:21:03+00:00,['qnkhuat'],2025-02-05 14:29:40+00:00,,https://github.com/metabase/metabase/issues/52377,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Team/Workflows', 'aka BEC')]",[],
2798866570,issue,closed,completed,Fix hover color on `error` color in Mantine components,"### Describe the bug

This bug was introduced in #52029 which was backported to 52 and was released in 52.6.

First [reported on Slack](https://metaboat.slack.com/archives/C063Q3F1HPF/p1737065111890829)

#### Working color vs `error`. The first button is hovered.

![Image](https://github.com/user-attachments/assets/e2f1e962-2439-4251-a7c7-3321622d8d9e)

![Image](https://github.com/user-attachments/assets/4598bc16-511a-4696-82e7-e0791b64ddda)

### To Reproduce

1. Run `yarn storybook` and visit http://localhost:6006/?path=/story/buttons-button--compact-size&args=color:error
2. Hover over any buttons with red background


### Expected behavior

The background shouldn't be black on hover.



### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-15"",
      ""src_hash"": ""8f78f21a044c5483614823a8580565e2db465974"",
      ""tag"": ""v0.52.6-SNAPSHOT"",
      ""hash"": ""59004c5""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.2+13-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.2"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.2+13-LTS"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""15.2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

Annoying

### Additional context

_No response_",WiNloSt,2025-01-20 10:32:57+00:00,['WiNloSt'],2025-01-20 13:05:44+00:00,2025-01-20 12:16:39+00:00,https://github.com/metabase/metabase/issues/52371,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/Embedding', ''), ('Bug:v52', 'bugs or regressions introduced in v52'), ('Design System', 'Overall UI patterns and components, not specific to a single part of the product')]",[],
2798860508,issue,open,,Support Click behaviour in Link cards,"**Is your feature request related to a problem? Please describe.**
I would like to pass the filter values of the dashboard I am currently in to the dashboard I have added via the link option:

<img width=""1273"" alt=""Image"" src=""https://github.com/user-attachments/assets/538231fd-5b5e-4e68-8fe6-8fe006f8d702"" />

But I cannot set click behaviour to those type of cards

<img width=""405"" alt=""Image"" src=""https://github.com/user-attachments/assets/18ddef58-96fe-42e7-9cf3-157da485bd7f"" />

**Describe the solution you'd like**
Similar options to what you get when you add a question:

<img width=""667"" alt=""Image"" src=""https://github.com/user-attachments/assets/310736fb-6613-4a3c-b316-457da8280727"" />

Especially for click behaviour because i want to pass the filter parameters when a user clicks this link

**Describe alternatives you've considered**
You can make use of Custom URLs 


",Tony-metabase,2025-01-20 10:30:29+00:00,[],2025-02-04 20:30:28+00:00,,https://github.com/metabase/metabase/issues/52370,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('Reporting/Dashboards/Click Behavior', ''), ('.Team/Querying', '')]",[],
2798561267,issue,closed,duplicate,Selected `Font` is not applied to a static embedded question,"### Describe the bug

Selected `Font` is not applied to a static embedded question (both preview and when actually embedded).
The issue happens with a question preview only. A dashboard preview works fine.


https://github.com/user-attachments/assets/1e72924d-0a5a-4773-9681-04f553adb0ef



### To Reproduce

- Create any question or open an existing one
- Click the `Sharing/Embed`
- Select the `Static embedding`
- Select the `Look and feel` tab and click `preview`
- Now select any font via the `Font` dropdown
- Font is not changed in the `preview` window

### Expected behavior

Font should be updated in the `preview` window",sanex3339,2025-01-20 08:29:49+00:00,['sanex3339'],2025-01-21 11:47:59+00:00,2025-01-21 11:47:33+00:00,https://github.com/metabase/metabase/issues/52365,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/Embedding', '')]","[{'comment_id': 2604498482, 'issue_id': 2798561267, 'author': 'WiNloSt', 'body': ""duplicate of https://github.com/metabase/metabase/issues/45638. I added your video to the original issue. I missed labeling the mentioned issue here. It's supposed to be assigned to you as well. So I'll close this issue now."", 'created_at': datetime.datetime(2025, 1, 21, 11, 44, 33, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-21 11:44:33 UTC): duplicate of https://github.com/metabase/metabase/issues/45638. I added your video to the original issue. I missed labeling the mentioned issue here. It's supposed to be assigned to you as well. So I'll close this issue now.

"
2796242312,issue,closed,completed,Pivot table click behavior config misses columns,"### Describe the bug

We're missing many columns when trying to configure click behavior on pivot tables

### To Reproduce

1) create a simple pivot table like
![Image](https://github.com/user-attachments/assets/9ac7ee0f-4e3b-4334-8b9d-aab11b11e38f)

2) add it to a dashboard and save it (let's call this dashboard ""dashboard 1"")

3) create another dashboard (let's call this dashboard ""dashboard 2""). On this destination dashboard add the same pivot table and add 3 filters connected to the pivot table (connected to category, source and state field)

![Image](https://github.com/user-attachments/assets/5d3dbac8-f16a-4712-963e-8e78c41e39ab)

4) now go back to the pivot table in dashboard 1 and configure click behavior to a custom destination (dashboard 2):

![Image](https://github.com/user-attachments/assets/fe0f6974-80d4-4de1-9482-be7cb578392c)

you don't see any relevant fields that you can send (only the sums and one pivot grouping)

### Expected behavior

We should expose all the columns here

### Logs

NA

### Information about your Metabase installation

```JSON
v52.5
```

### Severity

P1

### Additional context

This seems kind of broken

maybe related to https://github.com/metabase/metabase/issues/41896?",paoliniluis,2025-01-17 20:28:34+00:00,['alxnddr'],2025-02-06 16:19:33+00:00,2025-02-06 16:19:33+00:00,https://github.com/metabase/metabase/issues/52339,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('.Team/DashViz', 'Dashboard and Viz team'), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]",[],
2796193749,issue,open,,Pivot tables don't show the totals for series that have a unique value,"### Describe the bug

This is more a UI ""inconsistency"" bug than anything, but let's say you have a pivot table like the following you have a weird pivot table

![Image](https://github.com/user-attachments/assets/bc868d1f-aeb7-468b-af0b-4c810bb7ecd5)

### To Reproduce

1) In a postgres db with the sample database do the following
```
drop table if exists orders2;
select * into orders2 from (
SELECT
  ""category"",
  ""source"",
  ""state"",
  SUM(""public"".""orders"".""discount"") AS ""discount"",
  SUM(""public"".""orders"".""total"") AS ""total"",
  SUM(""public"".""orders"".""quantity"") AS ""quantity""
FROM
  ""public"".""orders""
 LEFT JOIN ""public"".""products"" ON ""public"".""orders"".""product_id"" = ""products"".""id""
  LEFT JOIN ""public"".""people"" ON ""public"".""orders"".""user_id"" = ""people"".""id""
group by 1,2,3) test;

delete from orders2 where category = 'Gizmo' and source in ('Facebook', 'Google', 'Organic', 'Twitter') or (category = 'Gizmo' and state not in ('AK'));
```

2) then sync the table and build this query

![Image](https://github.com/user-attachments/assets/9c5e0be8-789d-4130-9cf9-17506c0aa147)

3) use a pivot table viz
4) see that there's no grouping for ""affiliate"" in Gizmo

### Expected behavior

Also allow users to group and have a sub total on series that have a unique value

### Logs

NA

### Information about your Metabase installation

```JSON
it has always been like this
```

### Severity

P2

### Additional context

Requested by a customer that needs this really quickly, as their customers are requesting this every week

NOTE: where, which subtotals we show should be configurable. IDK why we show some and not others",paoliniluis,2025-01-17 19:52:27+00:00,['alxnddr'],2025-02-04 20:31:43+00:00,,https://github.com/metabase/metabase/issues/52333,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Difficulty:Easy', ''), ('.Frontend', ''), ('Visualization/Tables/old-pivoted', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Querying/Pivot', 'Queries that generate pivot tables')]",[],
2796084377,issue,open,,Assign users to a default group when they do SSO,"**Is your feature request related to a problem? Please describe.**
Right now the default group would be ""all users"" (not assigned to any group), but a customer needed us to have a default assignment

**Describe the solution you'd like**
Configure in group mappings a ""default"" so users get assigned to this group when no rule applies

**Describe alternatives you've considered**
None

**How important is this feature to you?**
They can't assign to a group since their group properties in the IdP are very complex (they seem to have a parent child relationship)

**Additional context**
NA
",paoliniluis,2025-01-17 18:36:09+00:00,[],2025-02-04 20:31:03+00:00,,https://github.com/metabase/metabase/issues/52327,"[('Type:New Feature', ''), ('Administration/Auth/SSO', 'Enterprise SSO like SAML and JWT')]",[],
2795852314,issue,closed,completed,[Project] Support stable IDs in interactive embedding,"### Links

- [product doc](https://www.notion.so/metabase/Support-stable-IDs-in-interactive-embedding-1f99db58da9945218519cbbc40de0175)
- [technical design doc + test plan](https://www.notion.so/metabase/Tech-Support-stable-IDs-in-interactive-embedding-16169354c90180898ca9c6509febd0de)


### Implementation Plan

```[tasklist]
#### Milestone 1
- [ ] https://github.com/metabase/metabase/pull/52659
```
",npretto,2025-01-17 16:25:33+00:00,['npretto'],2025-01-28 11:47:37+00:00,2025-01-28 11:47:35+00:00,https://github.com/metabase/metabase/issues/52320,"[('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('.Epic', 'Feature Implementation or Project'), ('Embedding/Interactive', 'Interactive Embedding, previously known as Full app embedding'), ('.Team/Embedding', '')]","[{'comment_id': 2618716892, 'issue_id': 2795852314, 'author': 'npretto', 'body': 'Re-opening until the backport gets merged', 'created_at': datetime.datetime(2025, 1, 28, 11, 22, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2618775558, 'issue_id': 2795852314, 'author': 'npretto', 'body': 'Backport merged, closing this again.', 'created_at': datetime.datetime(2025, 1, 28, 11, 47, 35, tzinfo=datetime.timezone.utc)}]","npretto (Issue Creator) on (2025-01-28 11:22:02 UTC): Re-opening until the backport gets merged

npretto (Issue Creator) on (2025-01-28 11:47:35 UTC): Backport merged, closing this again.

"
2795455604,issue,open,,selectors return new object every time causing unnecessary re-renderings,"**Context**
selectors return new object `{verified: ..}` so it's a new reference with every function call and it prevents memoization on reselect level.
 
- `getDefaultModelFilters` 
- `getDefaultMetricFilters` 

Selectors shouldn't return a different objects with the same arguments

",uladzimirdev,2025-01-17 13:14:05+00:00,[],2025-02-04 20:26:14+00:00,,https://github.com/metabase/metabase/issues/52312,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template'), (':broom:', 'no-brainer cleanup issues to clear out when you have an hour left until EoD or something'), ('.Team/Querying', ''), ('good first issue', 'A starter issue that is good for someone new to the codebase or is a new contributor')]",[],
2795168816,issue,open,,Table header popover not aligned with the header,"### Describe the bug

https://github.com/user-attachments/assets/f014a165-c96b-46e2-a754-0c104a55698e

### To Reproduce

1. New > Question > Orders > Visualize
2. Quickly click on 2 different table headers (2nd click needs to happen before UI reacts to the first click)

### Information about your Metabase installation

master, be81c7f922

### Severity

P3
",kamilmielnik,2025-01-17 10:55:31+00:00,[],2025-02-04 20:31:56+00:00,,https://github.com/metabase/metabase/issues/52307,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Difficulty:Easy', ''), ('.Frontend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2598113773, 'issue_id': 2795168816, 'author': 'romeovs', 'body': 'Double clicking the same header also causes this issue.', 'created_at': datetime.datetime(2025, 1, 17, 11, 13, 16, tzinfo=datetime.timezone.utc)}]","romeovs on (2025-01-17 11:13:16 UTC): Double clicking the same header also causes this issue.

"
2793893774,issue,open,,Alert when New Results appear in Result Set,"**Is your feature request related to a problem? Please describe.**
We would like to implement streaming style alerts where, if new records are in the query results, then the alert is sent. 

**Describe the solution you'd like**
An option to ""Alert when new results"" or ""alert when result set changes"". We only want the new records to be included in the alert.

**Describe alternatives you've considered**
Creating a question that does a lookback time frame (last 1 hour, for example) and schedule the alert for every hour. The timing isn't always perfect and we'd like a more real time method of accomplishing this.

**Additional context**
Customer request
",ixipixi,2025-01-16 22:14:47+00:00,[],2025-02-04 20:30:41+00:00,,https://github.com/metabase/metabase/issues/52288,"[('Type:New Feature', ''), ('Reporting/Alerts', ''), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2602289075, 'issue_id': 2793893774, 'author': 'brunobergher', 'body': ""What part of this wouldn't be accomplished by having more frequent alerts (say, every minute)? Asking because we don't support streaming pretty much anywhere else as the product is not quite designed for real-time analytics, so perhaps we could just bundle the signal of this need with the existing issue."", 'created_at': datetime.datetime(2025, 1, 20, 12, 23, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2602598584, 'issue_id': 2793893774, 'author': 'ixipixi', 'body': '@brunobergher their primary concern was ensuring that they weren\'t resending records in the alerts redundantly. Ex. if the alert runs every minute they only want records that had not been sent previously included in the new alert (I updated the issue description to include that). I was thinking that would be difficult to accomplish this reliably/accurately current state.\n\nI\'ll try to get more info on the operational need. Perhaps some combination of alerts + actions to set a ""reviewed"" status would be viable. Then the results could be filtered on the reviewed status instead of the time frame.', 'created_at': datetime.datetime(2025, 1, 20, 14, 41, tzinfo=datetime.timezone.utc)}]","brunobergher on (2025-01-20 12:23:52 UTC): What part of this wouldn't be accomplished by having more frequent alerts (say, every minute)? Asking because we don't support streaming pretty much anywhere else as the product is not quite designed for real-time analytics, so perhaps we could just bundle the signal of this need with the existing issue.

ixipixi (Issue Creator) on (2025-01-20 14:41:00 UTC): @brunobergher their primary concern was ensuring that they weren't resending records in the alerts redundantly. Ex. if the alert runs every minute they only want records that had not been sent previously included in the new alert (I updated the issue description to include that). I was thinking that would be difficult to accomplish this reliably/accurately current state.

I'll try to get more info on the operational need. Perhaps some combination of alerts + actions to set a ""reviewed"" status would be viable. Then the results could be filtered on the reviewed status instead of the time frame.

"
2793701496,issue,open,,[Epic] Fix Error Alignment on Mantine Input components,"After working on [Change order of input wrapper elements](https://github.com/metabase/metabase/pull/52235), we noticed that the alignment for some of the non-rectangular input components had weird or unsensible error placement, like the ones below:

**Radio**
<img width=""330"" alt=""image"" src=""https://github.com/user-attachments/assets/6c528f19-bce5-44d1-aae8-4a488b495e2c"" />

**Switch**
<img width=""354"" alt=""image"" src=""https://github.com/user-attachments/assets/79342fde-66f5-4a70-b20d-27b6614263b5"" />

While it made sense to place the errors below elements in text and text-style inputs (i.e. `TextInput`, `Select`, etc), these components could use some love.

I'll put a list of non-text input components here and we can go one-by-one ensuring that the layouts for these components are super chill.

- [ ] `Switch`
- [ ] A single `Checkbox`
- [ ] Multiple checkboxes (`Checkbox.Group`)
- [ ] `Radio`
- [ ] `Textarea` - it is text-adjacent but would be good to double-check",oisincoveney,2025-01-16 20:22:50+00:00,[],2025-02-04 20:25:32+00:00,,https://github.com/metabase/metabase/issues/52282,"[('.Epic', 'Feature Implementation or Project'), ('Design System', 'Overall UI patterns and components, not specific to a single part of the product')]",[],
2793001820,issue,closed,completed,Unable to remove a series with too long of a title from viz breakout,"### Describe the bug

I essentially can't remove the ""QueryProcessor (deprecated)"" breakout since the X is not visible there 😅 
<img width=""330"" alt=""Image"" src=""https://github.com/user-attachments/assets/7a73fe73-437b-4aae-9a49-fae97bb57432"" />

### To Reproduce

Create a bar chart with many breakout series, one of which having a long title
Enjoy


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
on stats, master branch
```

### Severity

Annoying

### Additional context

_No response_",thebiglabasky,2025-01-16 14:54:19+00:00,['oisincoveney'],2025-01-17 22:04:30+00:00,2025-01-17 22:04:30+00:00,https://github.com/metabase/metabase/issues/52273,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Team/Embedding', '')]",[],
2792767152,issue,open,,Column Labels Not Preserved in Excel Exports from Metabase,"### Describe the bug

When exporting data from a Metabase table view to an Excel file, the column labels (headers) defined in the Metabase interface are not properly reflected in the exported file. Instead, the exported file displays either default field names from the database schema or other incorrect labels. This issue causes confusion for users who rely on the exported data, as the column headers do not match the expected naming conventions set in Metabase.

### To Reproduce

1. Open a table or query result in Metabase.

2. Verify that the column labels are correctly displayed in the Metabase interface.

3. Export the table/query results to an Excel file by selecting the ""Download as Excel"" option.

4; Open the exported Excel file and review the column headers. 



### Expected behavior

Expected Behavior:
The column headers in the exported Excel file should match the labels displayed in Metabase.

Actual Behavior:
The column headers in the exported Excel file do not match the labels displayed in Metabase. Instead, they appear as default field names from the database schema or other unexpected values.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{   ""browser-info"": {     ""language"": ""fr-FR"",     ""platform"": ""MacIntel"",     ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",     ""vendor"": ""Google Inc.""   },   ""metabase-info"": {     ""databases"": [       ""postgres""     ],     ""run-mode"": ""prod"",     ""plan-alias"": """",     ""version"": {       ""date"": ""2024-09-13"",       ""tag"": ""v0.50.25.3"",       ""hash"": ""ca3c733""     },     ""settings"": {       ""report-timezone"": ""Europe/Paris""     },     ""hosting-env"": ""unknown"",     ""application-database"": ""postgres"",     ""application-database-details"": {       ""database"": {         ""name"": ""PostgreSQL"",         ""version"": ""14.12""       },       ""jdbc-driver"": {         ""name"": ""PostgreSQL JDBC Driver"",         ""version"": ""42.7.3""       }     }   },   ""system-info"": {     ""file.encoding"": ""UTF-8"",     ""java.runtime.name"": ""OpenJDK Runtime Environment"",     ""java.runtime.version"": ""11.0.24+8"",     ""java.vendor"": ""Eclipse Adoptium"",     ""java.vendor.url"": ""https://adoptium.net/"",     ""java.version"": ""11.0.24"",     ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",     ""java.vm.version"": ""11.0.24+8"",     ""os.name"": ""Linux"",     ""os.version"": ""5.10.218-208.862.amzn2.x86_64"",     ""user.language"": ""en"",     ""user.timezone"": ""GMT""   } }
```

### Severity

annoying

### Additional context

_No response_",andybruneteau,2025-01-16 13:23:13+00:00,['tsplude'],2025-02-04 20:31:52+00:00,,https://github.com/metabase/metabase/issues/52269,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('Visualization/Download', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2602885266, 'issue_id': 2792767152, 'author': 'noahmoss', 'body': ""@andybruneteau I'm not able to reproduce. Can you describe exactly how you've set the column headers in Metabase?"", 'created_at': datetime.datetime(2025, 1, 20, 16, 49, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2625062144, 'issue_id': 2792767152, 'author': 'tsplude', 'body': 'Possibly related to #51342 and #49605', 'created_at': datetime.datetime(2025, 1, 30, 17, 0, 20, tzinfo=datetime.timezone.utc)}]","noahmoss on (2025-01-20 16:49:53 UTC): @andybruneteau I'm not able to reproduce. Can you describe exactly how you've set the column headers in Metabase?

tsplude (Assginee) on (2025-01-30 17:00:20 UTC): Possibly related to #51342 and #49605

"
2792664849,issue,closed,completed,Theme change transition issues,"### Describe the bug

Currently, there are a bunch of issues related to theme-changing transitions:
- transitions don't respect the `reduced-motion` setting on the OS level
- we have cases when visually some transitions are out-of-sync with other transitions 
- we don't have transitions when statically embedded

### To Reproduce

See the video:

https://github.com/user-attachments/assets/38efc041-c34c-40bf-bd44-cce528cd81cb

### Expected behavior

Transitions should look better
",sanex3339,2025-01-16 12:51:16+00:00,['sanex3339'],2025-01-21 10:40:02+00:00,2025-01-21 08:36:26+00:00,https://github.com/metabase/metabase/issues/52265,"[('.Needs Triage', '')]",[],
2792348720,issue,closed,completed,Apply theming to unthemed elements in interactive question's default layout in the sdk,"There are some elements in the interactive question's default layout in the SDK that is currently unthemed.

**Theming Issues**

- [x] The filter and summarize popover's background color in the default layout is unthemed
- [x] We should be able to set the question's toolbar background color
- [x] Notebook button's background color is unthemed (it is always `#fff`), so it doesn't work with dark themed apps.
- [x] When the “back” arrow is present (i.e. after drilling-down the dashboard), the question’s title is very close to the left arrow. We should add more spacing there.
- [x] The ""Custom Column"" button has an unthemed background as it uses a semantic color that is not mapped to the SDK. We can add a mapping for the SDK.

### Screenshots

ProficiencyLabs - already looks great, no issue spotted on light mode

![Image](https://github.com/user-attachments/assets/bec127a7-5bb9-494d-9f4d-37810a94a50e)

theStitch - some theming issue spotted on dark theme (e.g. notebook button, popover)

![Image](https://github.com/user-attachments/assets/f4eec733-f034-486f-b5d7-9ddeb025a6de)

Custom Columns

![Image](https://github.com/user-attachments/assets/95b07a65-a0ff-404a-9624-cb094480dce4)",heypoom,2025-01-16 10:39:50+00:00,['heypoom'],2025-02-05 14:24:19+00:00,2025-02-04 13:39:30+00:00,https://github.com/metabase/metabase/issues/52261,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2636940475, 'issue_id': 2792348720, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)', 'created_at': datetime.datetime(2025, 2, 5, 14, 3, 27, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-02-05 14:03:27 UTC): 🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)

"
2792155270,issue,open,,Time Grouping Filter: Unable to select specific query level in Dashboard,"### Describe the bug

When using the new feature allowing filters to be connected to specific query levels in Metabase, the time grouping filter doesn't provide the option to select different query levels, unlike other filter types. The filter automatically defaults to the last level without offering any choice.

**Additional context:**

This issue is specific to time grouping filters
All other filter types work as expected with level selection
This limits the functionality of multi-level temporal analysis in dashboards

![Image](https://github.com/user-attachments/assets/81c3c58f-157d-4bea-a806-7a0f39936a49)

![Image](https://github.com/user-attachments/assets/5637706c-341c-41e4-8840-957ca7b97fe9)

### To Reproduce

**Steps to reproduce:**

1. Create a new query with 2 different levels
2. Include 2 different temporal dimensions in these levels
3. Add the query to a dashboard
4. Try to add a time grouping filter
5. Attempt to connect the filter to a specific level

**Actual behavior:**

No option to select the query level
Filter automatically applies to the last level only
No flexibility in choosing where to apply the time grouping

### Expected behavior

**Expected behavior:**

Should be able to select which query level to apply the time grouping filter to
Should behave similarly to other filter types where level selection is possible

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""fr-FR"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2024-12-21"",
      ""tag"": ""v0.52.4"",
      ""hash"": ""2f8c560""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Paris""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.6""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.0-1072-aws"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Paris""
  }
}
```

### Severity

blocking specific usage of metabase

### Additional context

_No response_",tomdyl,2025-01-16 09:24:47+00:00,[],2025-02-04 20:30:42+00:00,,https://github.com/metabase/metabase/issues/52260,"[('Type:New Feature', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Team/Querying', ''), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]","[{'comment_id': 2595951336, 'issue_id': 2792155270, 'author': 'ranquild', 'body': '@tomdyl this is a known limitation a not a bug. We will try to address this in the future.', 'created_at': datetime.datetime(2025, 1, 16, 14, 57, 51, tzinfo=datetime.timezone.utc)}]","ranquild on (2025-01-16 14:57:51 UTC): @tomdyl this is a known limitation a not a bug. We will try to address this in the future.

"
2791313590,issue,closed,completed,[Backend modularization] `sync`,"- Needs API namespace
- Move sync-related events, tasks, and API endpoints into this module",camsaul,2025-01-16 00:17:53+00:00,['camsaul'],2025-01-27 22:11:28+00:00,2025-01-16 17:36:25+00:00,https://github.com/metabase/metabase/issues/52250,[],[],
2791041954,issue,closed,completed,[Backend modularization] `channel`,"- We should move models and stuff into this model as appropriate.
- Has way too many API namespaces
- See if we can move any tasks into this module.",camsaul,2025-01-15 22:05:47+00:00,['camsaul'],2025-01-27 22:11:34+00:00,2025-01-16 04:17:48+00:00,https://github.com/metabase/metabase/issues/52238,[],[],
2791038379,issue,closed,completed,[Backend modularization] `email`,we should probably merge this entire module into `channel`,camsaul,2025-01-15 22:04:19+00:00,['camsaul'],2025-01-27 22:11:33+00:00,2025-01-16 04:17:48+00:00,https://github.com/metabase/metabase/issues/52237,[],[],
2791006933,issue,closed,completed,Break out by drill thru does not work for queries with joins and filter after summarize,"### Describe the bug

Related to #52221, #46932

The ""Break out by..."" drill thru (a.k.a pivot drill thru) is broken for the following query with a join and filter after summarize.

Since #52221 is a recent regression and P1 bug, the drill will be temporarily disabled again for multi-stage queries, but we should re-enable it again.

Slack thread with context:

https://metaboat.slack.com/archives/C0645JP1W81/p1736970278902299

### To Reproduce

1. Open this question in stats
   1.1. https://stats.metabase.com/question/19189-bugs-and-features-mentioned-by-enterprise-sized-customers
   1.2 Alternatively, see the below query for a minimal repro from the Sample Database
2. Click on a number in the count column
3. Click on ""Break out by...""
4. Select either option (""Time"" or ""Category"")
5. Error


![Image](https://github.com/user-attachments/assets/0edbcd8d-835c-448a-a539-d024802f5c3d)


### Expected behavior

The user should be presented with a context menu to select the breakout column and the drill should apply correctly

### Logs

_No response_

### Information about your Metabase installation

```JSON
v52
```

### Severity

P2

### Additional context

_No response_",appleby,2025-01-15 21:51:19+00:00,['appleby'],2025-02-06 17:24:24+00:00,2025-02-03 22:31:25+00:00,https://github.com/metabase/metabase/issues/52236,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/MBQL', ''), ('.Backend', ''), ('Querying/Drill Thrus', 'Refining existing queries with Drill Thrus'), ('.Team/Querying', '')]",[],
2790901467,issue,closed,completed,[Backend modularization] `setup`,"- Rename `metabase.setup` to `metabase.setup.core`
- Move `metabase.api.setup` into this we can justify this being its own module.",camsaul,2025-01-15 21:07:59+00:00,['camsaul'],2025-01-27 22:11:35+00:00,2025-01-15 22:28:36+00:00,https://github.com/metabase/metabase/issues/52232,[],[],
2790847927,issue,open,,Metadata URL of Azure authentication needs to be configurable,"**Is your feature request related to a problem? Please describe.**
If you're running on Docker on Azure, then https://github.com/metabase/metabase/blob/a6793c406159916d0c230b1072acc2f0063f053f/enterprise/backend/src/metabase_enterprise/auth_provider.clj#L27 will not resolve to the correct place

**Describe the solution you'd like**
Make the metadata URL configurable

**Describe alternatives you've considered**
None unfortunately

**How important is this feature to you?**
Reported by a user

**Additional context**
Without this, docker deployments on Azure can't be used
",paoliniluis,2025-01-15 20:46:39+00:00,[],2025-02-04 20:30:12+00:00,,https://github.com/metabase/metabase/issues/52226,"[('Database/', ''), ('Type:New Feature', ''), ('.Team/Drivers', '')]","[{'comment_id': 2596973691, 'issue_id': 2790847927, 'author': 'benfoster', 'body': 'Note that Azure App Services and Container Apps expose environment variables with the correct endpoint address so ideally they\'d be a mechanism for these to be expanded.\n\nI haven\'t checked if this is also available on VMs - if so, the solution _might_ be as ""simple"" as swapping out the hardcoded IP with the value of this variable.', 'created_at': datetime.datetime(2025, 1, 16, 21, 50, 56, tzinfo=datetime.timezone.utc)}]","benfoster on (2025-01-16 21:50:56 UTC): Note that Azure App Services and Container Apps expose environment variables with the correct endpoint address so ideally they'd be a mechanism for these to be expanded.

I haven't checked if this is also available on VMs - if so, the solution _might_ be as ""simple"" as swapping out the hardcoded IP with the value of this variable.

"
2790805736,issue,closed,completed,[Backend modularization] `async`,"```
src/metabase/async/
├── streaming_response
│   └── thread_pool.clj
├── streaming_response.clj
└── util.clj

test/metabase/async/
├── streaming_response_test.clj
└── util_test.clj
```

We should move the `core.async` util namespace stuff into the `util` module and the streaming response stuff into `server` or somewhere and remove this module.",camsaul,2025-01-15 20:30:01+00:00,['camsaul'],2025-01-27 22:11:36+00:00,2025-01-15 21:41:44+00:00,https://github.com/metabase/metabase/issues/52224,[],[],
2790684953,issue,closed,completed,Breakout by drill fails for query with filter after summarize,"### Describe the bug

Related to https://github.com/metabase/metabase/issues/46932

The ""Break out by..."" drill thru (a.k.a pivot drill thru) is broken for the following query with filter after summarize.





### To Reproduce

1. Open this question in stats
    1.1. https://stats.metabase.com/question/19189-bugs-and-features-mentioned-by-enterprise-sized-customers
3. Click on a number in the count column
4. Click on ""Break out by...""
5. Select either option (""Time"" or ""Category"")
6. Error

### Expected behavior

At step 5. above, user should be presented with context menu to select the breakout column and the drill should apply correctly

### Logs

_No response_

### Information about your Metabase installation

```JSON
v52
```

### Severity

P1

### Additional context

_No response_",appleby,2025-01-15 19:40:31+00:00,['appleby'],2025-01-20 18:14:57+00:00,2025-01-17 19:55:38+00:00,https://github.com/metabase/metabase/issues/52221,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/Drill Thrus', 'Refining existing queries with Drill Thrus'), ('Bug:v52', 'bugs or regressions introduced in v52')]","[{'comment_id': 2593835676, 'issue_id': 2790684953, 'author': 'appleby', 'body': 'Equivalent repro using the Sample Database\n\n![Image](https://github.com/user-attachments/assets/e7c99ed8-e856-4f4e-a787-5e646b8e6dd6)', 'created_at': datetime.datetime(2025, 1, 15, 20, 8, 23, tzinfo=datetime.timezone.utc)}]","appleby (Issue Creator) on (2025-01-15 20:08:23 UTC): Equivalent repro using the Sample Database

![Image](https://github.com/user-attachments/assets/e7c99ed8-e856-4f4e-a787-5e646b8e6dd6)

"
2790459979,issue,open,,Allow Choosing Day of Month for Subscriptions,"**Is your feature request related to a problem? Please describe.**
We need to send out reports at the beginning of the month - but some data isn't complete on the first day. We typically need to send these out on 5th or 6th day.

**Describe the solution you'd like**
The option to choose which day of the month the subscription sends (currently we can do first/last/15th).

**Describe alternatives you've considered**
Use a daily subscription with a question that only returns results if it's the 5th of the month. Then set up the subscription and only send results if they aren't blank.

**Additional context**
Customer Request
",ixipixi,2025-01-15 17:42:09+00:00,[],2025-02-04 20:31:04+00:00,,https://github.com/metabase/metabase/issues/52217,"[('Reporting/Pulses', 'Now called Subscriptions'), ('Type:New Feature', ''), ('.Team/Workflows', 'aka BEC')]",[],
2790188400,issue,open,,Dashboard with Full Width setting enabled causes odd rendering for Text Cards with different resolutions,"### Describe the bug

Dashboard with Full Width setting enabled causes odd rendering for Text Cards with different resolutions ... This might not be an issue while you're using metabase but when you're embedding in different iframe sizes it can show odd behaviour.

### To Reproduce

1. Go to a Dashboard and add a couple of Text Cards. I create an example [here](https://stats.metabase.com/dashboard/3133-text-card-dash)
2. Checkout how the text gets cut with different resolution

https://github.com/user-attachments/assets/6020a9e1-5421-4d2a-8fda-a892bf24d550

### Expected behavior

Dashboard with Full Width setting disabled keep the text consistent so I would expect something similar to happen when Full Width setting is enabled 

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
Happens on 52 (probably since we added the Full Width option) and master
```

### Severity

minor

### Additional context

_No response_",Tony-metabase,2025-01-15 15:41:50+00:00,[],2025-02-04 20:31:44+00:00,,https://github.com/metabase/metabase/issues/52211,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Visualization/Scalars', 'Numbers, progress bars, gauges'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2602777452, 'issue_id': 2790188400, 'author': 'alxnddr', 'body': '@Tony-metabase we preserve aspect ratio of dashboard cards so when resizing as the width is changing the height will change as well. And when full width is disabled, since width becomes fixed, height also do not change. What do you think would be the expected behavior here?', 'created_at': datetime.datetime(2025, 1, 20, 15, 58, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2602797830, 'issue_id': 2790188400, 'author': 'Tony-metabase', 'body': ""The issue is more clear when you try to embed that iframe, Since it's usually always smaller then the `Full Width` in metabase and the Text Cards that have 2 lines would in 1 text card usually is always rendered badly.\n\nIn the non `Full Width` version the hight change doesn't impact the text cards like that ... I would expect the Full Width to behave similar to the non Full Width one and potentially only show 1 line if the card is 1 box. Would that makes sense?"", 'created_at': datetime.datetime(2025, 1, 20, 16, 7, 16, tzinfo=datetime.timezone.utc)}]","alxnddr on (2025-01-20 15:58:10 UTC): @Tony-metabase we preserve aspect ratio of dashboard cards so when resizing as the width is changing the height will change as well. And when full width is disabled, since width becomes fixed, height also do not change. What do you think would be the expected behavior here?

Tony-metabase (Issue Creator) on (2025-01-20 16:07:16 UTC): The issue is more clear when you try to embed that iframe, Since it's usually always smaller then the `Full Width` in metabase and the Text Cards that have 2 lines would in 1 text card usually is always rendered badly.

In the non `Full Width` version the hight change doesn't impact the text cards like that ... I would expect the Full Width to behave similar to the non Full Width one and potentially only show 1 line if the card is 1 box. Would that makes sense?

"
2790099524,issue,closed,completed,Change default persistence option,"At the moment, all models are defaulted to be persisted. We would prefer to opt into this behavior on models that benefit from it. See https://metaboat.slack.com/archives/C01LQQ2UW03/p1736907366965769 for more context.

Point of research:
refresh on behavior differences between oss and ee. This might be an ee only option due to granularity of model persistence not being in oss.",dpsutton,2025-01-15 15:05:48+00:00,['nvoxland'],2025-01-23 16:04:04+00:00,2025-01-15 22:49:26+00:00,https://github.com/metabase/metabase/issues/52209,"[('Type:New Feature', ''), ('.Needs Triage', ''), ('Querying/Models', 'aka Datasets'), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Semantic Model/Models', '')]",[],
2789794056,issue,open,,It should be possible to upload CSVs to tables with columns with default values,"### Describe the bug

When trying to upload data via Metabase's 'Upload data to this model' button, one gets an error if the target table contains a column with a default value, and the column is not present in the CSV.

### To Reproduce

1. Enable Uploads in a MySQL database 
2. Create a model in a MySQL database (e.g. via 'Upload data to personal collection' button)
3. Add a column with a default value to the table in the database, e.g.   
    ```sql
    alter table db.upload_table_12345
    add column `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP
    ````
4. Try to upload a CSV into the model via 'Upload data to this model'. Observe error 
    ```
    The CSV file is missing columns that are in the table:
    - created_at
    ```

### Expected behavior

Upload proceeds normally and fields with a default value in the database get filled with a default value.

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mysql""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-15"",
      ""tag"": ""v0.52.6"",
      ""hash"": ""1a9cb72""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.2""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.14.0-427.42.1.el9_4.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

Anoying

### Additional context

The error is raised by Metabase API [here](https://github.com/metabase/metabase/blob/1a9cb727b982b1b3af9a4a94c778a5a6c7e40b91/src/metabase/upload.clj#L679-L680)
This is because metabase considers the column as missing (although it is not required)
A suggested fix would be not to consider optional columns for missing candidates when calling `check-schema` [here](https://github.com/metabase/metabase/blob/1a9cb727b982b1b3af9a4a94c778a5a6c7e40b91/src/metabase/upload.clj#L765) ",phantom943,2025-01-15 13:01:47+00:00,[],2025-02-05 14:29:23+00:00,,https://github.com/metabase/metabase/issues/52202,"[('Type:New Feature', ''), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Organization/Uploads', 'Direct data upload (CSV)')]","[{'comment_id': 2602580562, 'issue_id': 2789794056, 'author': 'luizarakaki', 'body': ""Moving this issue to feature request. Uploads weren't designed to interact with database features like default values, so this would be a change from the original scope."", 'created_at': datetime.datetime(2025, 1, 20, 14, 33, 31, tzinfo=datetime.timezone.utc)}]","luizarakaki on (2025-01-20 14:33:31 UTC): Moving this issue to feature request. Uploads weren't designed to interact with database features like default values, so this would be a change from the original scope.

"
2789689787,issue,open,,Possible memory leak in v1.52.5,"**Describe the bug**
After upgrading to v1.52.5, we started seeing strange memory behavior, which looks like some memory leak. 
Here is the screenshot of Metabase memory usage for the last two weeks:

![Image](https://github.com/user-attachments/assets/f65d536b-46e7-4f02-8091-1afd448ff597)

As you can see, the maximum memory usage went from ~60% to more than 90%. Previously, we were running three Metabase nodes behind a Load balancer, each with 1 vCPU, 4 GB Memory, and `JAVA_OPTS=-Xmx3072m`. After today's incident, when memory usage exceeded 90%, we changed the Metabase node resources to 1 vCPU, 8GB Memory, and `JAVA_OPTS=-Xmx7168m`. 

**Expected behavior**
Memory remains stable and correlates with Metabase usage. 

**Screenshots**
Attached in **Describe the bug** section ^

**Severity**
In [ablefy.io](ablefy.io), we use Metabase to provide analytics for tens of thousands of users. And this tool is critical to us. This particular incident didn't impact us much as we have configured automatic autoscaling for our Metabase nodes, but if this leak won't be fixed in future releases, it might impact us as our traffic constantly grows and more and more people starting to use our analytics powered by Metabase. 

**Additional context**
I can provide as much info as you need about our current setup. 

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""uk-UA"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""snowflake""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-07"",
      ""tag"": ""v1.52.5"",
      ""hash"": ""cc77eeb""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""13.15""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.228-219.884.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```",zahorniak,2025-01-15 12:24:20+00:00,[],2025-02-08 13:00:55+00:00,,https://github.com/metabase/metabase/issues/52200,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Performance', ''), ('.Memory Usage', '')]","[{'comment_id': 2593016130, 'issue_id': 2789689787, 'author': 'paoliniluis', 'body': 'The peaks happen without any activity? Or when do they happen? Can you give us the logs ?', 'created_at': datetime.datetime(2025, 1, 15, 14, 30, 40, tzinfo=datetime.timezone.utc)}, {'comment_id': 2594665457, 'issue_id': 2789689787, 'author': 'zahorniak', 'body': 'Hey @paoliniluis,\n\nIt happened during low peak hours. The memory pattern is clearly visible and significantly changed after upgrading to v1.52.5. \n\nHere is the link to logs for the last two weeks: [https://metabase-issue-52200-logs.s3.eu-central-1.amazonaws.com/metabase-logs.json.zip](https://metabase-issue-52200-logs.s3.eu-central-1.amazonaws.com/metabase-logs.json.zip)', 'created_at': datetime.datetime(2025, 1, 16, 6, 52, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2599295173, 'issue_id': 2789689787, 'author': 'dpsutton', 'body': ""@zahorniak as an experiment, can you turn the field value scanning off for database 4, Postgres Replica Data?\n\n![Image](https://github.com/user-attachments/assets/d15a4e5d-212e-4faa-876e-537d66f7a702)\n\nI'd like to know if this helps. I see it's always taken a while in your logs, but it seems it has gotten even longer."", 'created_at': datetime.datetime(2025, 1, 17, 22, 9, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2601798587, 'issue_id': 2789689787, 'author': 'zahorniak', 'body': '@dpsutton I turned off automatic scans. I will provide new logs and metrics until EOD.', 'created_at': datetime.datetime(2025, 1, 20, 8, 56, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603188002, 'issue_id': 2789689787, 'author': 'zahorniak', 'body': ""@dpsutton, here is today's log: https://metabase-issue-52200-logs.s3.eu-central-1.amazonaws.com/metabase-logs-2025-01-20.json.zip."", 'created_at': datetime.datetime(2025, 1, 20, 20, 28, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603200700, 'issue_id': 2789689787, 'author': 'zahorniak', 'body': 'Here is the memory graph for the last 3 weeks with annotations:\n\n![Image](https://github.com/user-attachments/assets/778e2bbc-ee2a-41bb-863e-06b2473c9534)\n\nPeak memory usage decreased after turning off automatic syncs and scans, but it is still very ""spiky.""', 'created_at': datetime.datetime(2025, 1, 20, 20, 40, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603388613, 'issue_id': 2789689787, 'author': 'paoliniluis', 'body': ""~@zahorniak do you have users doing pivot table exports?~ Just checked the logs and I don't see anything that resembles a pivot table download"", 'created_at': datetime.datetime(2025, 1, 21, 0, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603404048, 'issue_id': 2789689787, 'author': 'paoliniluis', 'body': '@zahorniak do you have prometheus or grafana? or any APM that supports JVM apps since I would love to see what are those spikes', 'created_at': datetime.datetime(2025, 1, 21, 0, 28, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2606470131, 'issue_id': 2789689787, 'author': 'zahorniak', 'body': 'Hi @paoliniluis,\nWe do not have Prometheus in place because we do not have detailed monitoring for Metabase. If you are willing to wait, we can set it up in the next few days and get back to you with all the metrics.', 'created_at': datetime.datetime(2025, 1, 22, 7, 19, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2645512791, 'issue_id': 2789689787, 'author': 'perivamsi', 'body': '@zahorniak are you still facing this issue? were you able to get any more monitoring added?', 'created_at': datetime.datetime(2025, 2, 8, 13, 0, 54, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-15 14:30:40 UTC): The peaks happen without any activity? Or when do they happen? Can you give us the logs ?

zahorniak (Issue Creator) on (2025-01-16 06:52:43 UTC): Hey @paoliniluis,

It happened during low peak hours. The memory pattern is clearly visible and significantly changed after upgrading to v1.52.5. 

Here is the link to logs for the last two weeks: [https://metabase-issue-52200-logs.s3.eu-central-1.amazonaws.com/metabase-logs.json.zip](https://metabase-issue-52200-logs.s3.eu-central-1.amazonaws.com/metabase-logs.json.zip)

dpsutton on (2025-01-17 22:09:53 UTC): @zahorniak as an experiment, can you turn the field value scanning off for database 4, Postgres Replica Data?

![Image](https://github.com/user-attachments/assets/d15a4e5d-212e-4faa-876e-537d66f7a702)

I'd like to know if this helps. I see it's always taken a while in your logs, but it seems it has gotten even longer.

zahorniak (Issue Creator) on (2025-01-20 08:56:42 UTC): @dpsutton I turned off automatic scans. I will provide new logs and metrics until EOD.

zahorniak (Issue Creator) on (2025-01-20 20:28:48 UTC): @dpsutton, here is today's log: https://metabase-issue-52200-logs.s3.eu-central-1.amazonaws.com/metabase-logs-2025-01-20.json.zip.

zahorniak (Issue Creator) on (2025-01-20 20:40:14 UTC): Here is the memory graph for the last 3 weeks with annotations:

![Image](https://github.com/user-attachments/assets/778e2bbc-ee2a-41bb-863e-06b2473c9534)

Peak memory usage decreased after turning off automatic syncs and scans, but it is still very ""spiky.""

paoliniluis on (2025-01-21 00:09:00 UTC): ~@zahorniak do you have users doing pivot table exports?~ Just checked the logs and I don't see anything that resembles a pivot table download

paoliniluis on (2025-01-21 00:28:29 UTC): @zahorniak do you have prometheus or grafana? or any APM that supports JVM apps since I would love to see what are those spikes

zahorniak (Issue Creator) on (2025-01-22 07:19:39 UTC): Hi @paoliniluis,
We do not have Prometheus in place because we do not have detailed monitoring for Metabase. If you are willing to wait, we can set it up in the next few days and get back to you with all the metrics.

perivamsi on (2025-02-08 13:00:54 UTC): @zahorniak are you still facing this issue? were you able to get any more monitoring added?

"
2789616945,issue,closed,completed,Ultra wide tooltips,"### Describe the bug

![Image](https://github.com/user-attachments/assets/e78066bd-9048-4810-9d12-aa1d02515e3e)

### To Reproduce

To see this in the wild: go to https://stats.metabase.com/dashboard/1887 and inspect tooltips in the ""Dashboards"" section

----

1. Create a new dashboard and save it
2. Add this description to it:
```
This is a very very very very very very very very very very long dashboard description. Boy, I sure hope it does not overflow the screen when it's displayed in a tooltip. The only thing that would make it worse is if the text didn't wrap. 
```
3. Edit dashboard
4. Add a link to this very dashboard
5. Save dashboard
6. Change viewport width to 1000px or less
7. Hover the ""i"" icon in the link




### Expected behavior

1. Tooltip does not overflow the viewport
2. Text is wrapped into multiple lines - tooltip should have a reasonable `max-width` set


### Information about your Metabase installation

master, 304e1077ee9c47336b3766e0665b05eea5ba7fa3

### Severity

P3
",kamilmielnik,2025-01-15 11:57:43+00:00,[],2025-02-06 07:47:58+00:00,2025-01-29 06:23:49+00:00,https://github.com/metabase/metabase/issues/52199,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Reporting/Dashboards', ''), ('Difficulty:Easy', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2789491338,issue,closed,completed,Disable device login emails for authentication via the Embedding SDK,"**Context**
https://metaboat.slack.com/archives/C07166YL2UU/p1733956559768879

[Product doc](https://www.notion.so/metabase/Do-not-send-unexpected-emails-to-embedding-users-15b69354c90180ddbdb2f282ca72dd36#15b69354c9018123801ce4074f493c2c)

Customers have noticed that every time they navigate to our page using the Metabase SDK, they receive an email about a new device login.

While we are working on the proper solution, for the public release, we simply want to disable these messages for the Embedding SDK context. Since we are using the same /auth/sso API endpoint, we can’t base this on the endpoint itself. However, as a temporary solution, we can rely on an additional parameter `token` that is used only in the context of the Embedding SDK.

**Suggestion** 
if `(if (not (nil? token))` in `defmethod sso.i/sso-get :jwt` disable sending emails in session-data -> create-session! -> (events/publish-event! :XXX



",NevRA,2025-01-15 11:01:28+00:00,['nvoxland'],2025-01-30 22:08:56+00:00,2025-01-27 22:36:55+00:00,https://github.com/metabase/metabase/issues/52196,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Embedding', ''), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2625700771, 'issue_id': 2789491338, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)', 'created_at': datetime.datetime(2025, 1, 30, 22, 8, 55, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-01-30 22:08:55 UTC): 🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)

"
2789245749,issue,open,,Invalid Expression error when trying to create Custom Expression using datetimeDiff as a param in datetimeAdd,"### Describe the bug

I get Invalid Expression error when trying to author a Custom Expression using the result of datetimeDiff inside of datetimeAdd.

### To Reproduce

1. Create a custom expression that uses the result of datetimeDiff inside of datetimeAdd
```
CountIf(between([Date], ""2025-01-01"", datetimeAdd(""2025-01-01"", datetimeDiff(""2025-01-01"", now, ""day""), ""day"")))
```
2. Invalid Expression error is displayed in the expression builder.

### Expected behavior

The expression works correctly if I provide datetimeAdd with a hardcoded integer.
```
CountIf(between([Date], ""2025-01-01"", datetimeAdd(""2025-01-01"", 14, ""day"")))
```
I expect the custom expression to work when using the result of datetimeDiff inside of datetimeAdd.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mysql"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2024-12-04"",
      ""tag"": ""v0.52.1"",
      ""hash"": ""5bc320b""
    },
    ""settings"": {
      ""report-timezone"": ""Etc/GMT+0""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MySQL"",
        ""version"": ""8.0.27""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.11.0-41-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Asia/Seoul""
  }
}
```

### Severity

Low severity

### Additional context

_No response_",andrewler,2025-01-15 09:13:13+00:00,[],2025-02-04 20:28:53+00:00,,https://github.com/metabase/metabase/issues/52194,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Querying/Notebook/Custom Expression', ''), ('.Team/Querying', '')]",[],
2788889542,issue,open,,Clickhouse causes long startup,"### Describe the bug

Startup with clickhouse drivers takes a _long_ time. I think everything times out

```clojure
2025-01-14 23:21:29,530 INFO driver.impl :: Registered driver :clickhouse (parents: [:sql-jdbc]) 🚚
2025-01-14 23:21:34,507 ERROR driver.util :: Failed to check feature 'describe-fks' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
        at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:286)
        at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:278)
        at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:293)
        at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:289)
        at metabase.driver.util$supports_QMARK__STAR_.invokeStatic(util.clj:249)
...
        at metabase.driver.util$features.invoke(util.clj:274)
        at metabase.models.database$after_select_primary_method_model_Database.invokeStatic(database.clj:200)
        at metabase.models.database$after_select_primary_method_model_Database.invoke(database.clj:190)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:11)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
...
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invokeStatic(persist_refresh.clj:405)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invoke(persist_refresh.clj:401)
        at metabase.task.persist_refresh$fn__96922.invokeStatic(persist_refresh.clj:439)
        at metabase.task.persist_refresh$fn__96922.invoke(persist_refresh.clj:436)
        at metabase.task$init_tasks_BANG_$fn__76669.invoke(task.clj:79)
        at metabase.task$init_tasks_BANG_.invokeStatic(task.clj:75)
        at metabase.task$init_tasks_BANG_.invoke(task.clj:71)
        at metabase.task$init_scheduler_BANG_.invokeStatic(task.clj:166)
        at metabase.task$init_scheduler_BANG_.invoke(task.clj:153)
        at metabase.task$start_scheduler_BANG_.invokeStatic(task.clj:177)
        at metabase.task$start_scheduler_BANG_.invoke(task.clj:172)

2025-01-14 23:21:39,526 ERROR driver.util :: Failed to check feature 'index-info' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
...
2025-01-14 23:21:44,537 ERROR driver.util :: Failed to check feature 'connection/multiple-databases' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
...
2025-01-14 23:21:49,561 ERROR driver.util :: Failed to check feature 'full-join' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
...
2025-01-14 23:21:54,580 ERROR driver.util :: Failed to check feature 'window-functions/cumulative' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
...
2025-01-14 23:21:59,601 ERROR driver.util :: Failed to check feature 'test/dynamic-dataset-loading' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
...
2025-01-14 23:22:04,623 ERROR driver.util :: Failed to check feature 'describe-fields' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
...
2025-01-14 23:22:09,632 ERROR driver.util :: Failed to check feature 'basic-aggregations' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
...
2025-01-14 23:22:14,646 ERROR driver.util :: Failed to check feature 'temporal-extract' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
...
2025-01-14 23:22:21,576 INFO task.sync-databases :: Not scheduling tasks for audit database
2025-01-14 23:22:21,576 INFO metabase.core :: Metabase Initialization COMPLETE in 1.0 mins
```

I think this is because some features depend on being `cloud?` in clickhouse:

```clojure
(def ^:private ^{:arglists '([db-details])} cloud?
  ""Returns true if the `db-details` are for a ClickHouse Cloud instance, and false otherwise. If it fails to connect
   to the database, it throws a java.sql.SQLException.""
  (memoize/ttl
   (fn [db-details]
     (let [spec (connection-details->spec* db-details)]
       (sql-jdbc.execute/do-with-connection-with-options
        :clickhouse spec nil
        (fn [^java.sql.Connection conn]
          (with-open [stmt (.prepareStatement conn ""SELECT value='1' FROM system.settings WHERE name='cloud_mode'"")
                      rset (.executeQuery stmt)]
            (if (.next rset) (.getBoolean rset 1) false))))))
   ;; cache the results for 48 hours; TTL is here only to eventually clear out old entries
   :ttl/threshold (* 48 60 60 1000)))
```

```clojure
(defmethod sql-jdbc.conn/connection-details->spec :clickhouse
  [_ details]
  (cond-> (connection-details->spec* details)
    (try (cloud? details) ;; just getting a connection spec requires connecting, seems circular
         (catch java.sql.SQLException _e
           false))
    ;; select_sequential_consistency guarantees that we can query data from any replica in CH Cloud
    ;; immediately after it is written
    (assoc :select_sequential_consistency true)))
```



### To Reproduce

have a clickhouse db installed. Needs to have persisted models (as seen in stacktrace). You will have these if you upload csvs to clickhouse

### Expected behavior

speedy startup

### Logs

<img width=""429"" alt=""Image"" src=""https://github.com/user-attachments/assets/58ca2ea8-1682-41dc-9efc-0b16d7833e2e"" />
Actually can't paste full stack trace
<details>
<summary> lots of stack trace </summary>

```shell
❯ env $(kv-client expand ""~token-arg=~token ~port-arg=3007"") java ""$(socket-repl 6007)"" -jar patched-built.jar
Warning: environ value /Users/dan/.sdkman/candidates/java/current for key :java-home has been overwritten with /Users/dan/.sdkman/candidates/java/21.0.2-tem
2025-01-14 23:37:00,537 INFO metabase.util :: Maximum memory available to JVM: 8.0 GB
2025-01-14 23:37:01,561 INFO util.encryption :: Saved credentials encryption is DISABLED for this Metabase instance. 🔓
 For more information, see https://metabase.com/docs/latest/operations-guide/encrypting-database-details-at-rest.html
2025-01-14 23:37:01,956 WARN db.env :: WARNING: Using Metabase with an H2 application database is not recommended for production deployments. For production deployments, we highly recommend using Postgres, MySQL, or MariaDB instead. If you decide to continue to use H2, please be sure to back up the database file regularly. For more information, see https://metabase.com/docs/latest/operations-guide/migrating-from-h2.html
2025-01-14 23:37:02,300 ERROR public-settings.premium-features :: Error validating token: Assert failed: Metabase DB is not yet set up
((requiring-resolve (quote metabase.db/db-is-set-up?)))
WARNING: infinite? already refers to: #'kixi.stats.math/infinite? in namespace: kixi.stats.core, being replaced by: #'clojure.core/infinite?
2025-01-14 23:37:04,347 INFO driver.impl :: Registered abstract driver :sql  🚚
2025-01-14 23:37:04,367 INFO driver.impl :: Registered abstract driver :sql-jdbc (parents: [:sql]) 🚚
2025-01-14 23:37:04,370 INFO metabase.util :: Load driver :sql-jdbc took 7.1 ms
2025-01-14 23:37:04,370 INFO driver.impl :: Registered driver :h2 (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:04,491 INFO driver.impl :: Registered driver :mysql (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:04,512 INFO driver.impl :: Registered driver :postgres (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:04,611 INFO util.namespaces :: Loading namespace: metabase.notification.payload.impl.alert
2025-01-14 23:37:04,613 INFO util.namespaces :: Loading namespace: metabase.notification.payload.impl.dashboard-subscription
2025-01-14 23:37:04,615 INFO util.namespaces :: Loading namespace: metabase.notification.payload.impl.system-event
2025-01-14 23:37:04,622 INFO util.namespaces :: Loading namespace: metabase.channel.impl.email
2025-01-14 23:37:04,628 INFO util.namespaces :: Loading namespace: metabase.channel.impl.http
2025-01-14 23:37:04,631 INFO util.namespaces :: Loading namespace: metabase.channel.impl.slack
2025-01-14 23:37:05,904 INFO metabase.core ::
Metabase v1.52.6-SNAPSHOT (ee9d83e)

Copyright © 2025 Metabase, Inc.

Metabase Enterprise Edition extensions are PRESENT.

Usage of Metabase Enterprise Edition features are subject to the Metabase Commercial License.See https://www.metabase.com/license/commercial/ for details.
2025-01-14 23:37:05,906 INFO metabase.core :: Starting Metabase in STANDALONE mode
2025-01-14 23:37:05,928 INFO metabase.server :: Launching Embedded Jetty Webserver with config:
 {:port 3007}

2025-01-14 23:37:05,950 INFO metabase.core :: Starting Metabase version v1.52.6-SNAPSHOT (ee9d83e) ...
2025-01-14 23:37:05,952 INFO metabase.core :: System info:
 {""file.encoding"" ""UTF-8"",
 ""java.runtime.name"" ""OpenJDK Runtime Environment"",
 ""java.runtime.version"" ""21.0.2+13-LTS"",
 ""java.vendor"" ""Eclipse Adoptium"",
 ""java.vendor.url"" ""https://adoptium.net/"",
 ""java.version"" ""21.0.2"",
 ""java.vm.name"" ""OpenJDK 64-Bit Server VM"",
 ""java.vm.version"" ""21.0.2+13-LTS"",
 ""os.name"" ""Mac OS X"",
 ""os.version"" ""14.5"",
 ""user.language"" ""en"",
 ""user.timezone"" ""America/Chicago""}

2025-01-14 23:37:05,953 INFO metabase.plugins :: Loading plugins in /private/tmp/fixed/plugins...
2025-01-14 23:37:06,152 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :bigquery-cloud-sdk...
2025-01-14 23:37:06,153 INFO driver.impl :: Registered driver :bigquery-cloud-sdk (parents: [:sql]) 🚚
2025-01-14 23:37:06,156 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :googleanalytics...
2025-01-14 23:37:06,156 INFO driver.impl :: Registered driver :googleanalytics  🚚
2025-01-14 23:37:06,174 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :snowflake...
2025-01-14 23:37:06,174 INFO driver.impl :: Registered driver :snowflake (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:06,179 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :oracle...
2025-01-14 23:37:06,179 INFO driver.impl :: Registered driver :oracle (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:06,185 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :mongo...
2025-01-14 23:37:06,185 INFO driver.impl :: Registered driver :mongo  🚚
2025-01-14 23:37:06,188 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :clickhouse...
2025-01-14 23:37:06,189 INFO driver.impl :: Registered driver :clickhouse (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:06,190 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid...
2025-01-14 23:37:06,191 INFO driver.impl :: Registered driver :druid  🚚
2025-01-14 23:37:06,199 INFO plugins.dependencies :: Plugin 'Metabase Databricks Driver' depends on plugin 'Metabase Hive Like Abstract Driver'
2025-01-14 23:37:06,200 INFO plugins.dependencies :: Metabase Databricks Driver dependency {:plugin Metabase Hive Like Abstract Driver} satisfied? false
2025-01-14 23:37:06,200 INFO plugins.dependencies :: Plugins with unsatisfied deps: [""Metabase Databricks Driver""]
2025-01-14 23:37:06,203 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :hive-like...
2025-01-14 23:37:06,203 INFO driver.impl :: Registered abstract driver :hive-like (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:06,204 INFO plugins.dependencies :: Metabase Databricks Driver dependency {:plugin Metabase Hive Like Abstract Driver} satisfied? true
2025-01-14 23:37:06,204 DEBUG plugins.initialize :: Dependencies satisfied; these plugins will now be loaded: [""Metabase Databricks Driver""]
2025-01-14 23:37:06,204 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :databricks...
2025-01-14 23:37:06,204 INFO driver.impl :: Registered driver :databricks (parents: [:hive-like]) 🚚
2025-01-14 23:37:06,207 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :redshift...
2025-01-14 23:37:06,207 INFO driver.impl :: Registered driver :redshift (parents: [:postgres]) 🚚
2025-01-14 23:37:06,208 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :vertica...
2025-01-14 23:37:06,209 INFO driver.impl :: Registered driver :vertica (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:06,210 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlite...
2025-01-14 23:37:06,210 INFO driver.impl :: Registered driver :sqlite (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:06,214 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :presto-jdbc...
2025-01-14 23:37:06,214 INFO driver.impl :: Registered driver :presto-jdbc (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:06,217 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :druid-jdbc...
2025-01-14 23:37:06,217 INFO driver.impl :: Registered driver :druid-jdbc (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:06,219 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sqlserver...
2025-01-14 23:37:06,219 INFO driver.impl :: Registered driver :sqlserver (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:06,223 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :athena...
2025-01-14 23:37:06,224 INFO driver.impl :: Registered driver :athena (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:06,225 INFO plugins.dependencies :: Plugin 'Metabase Spark SQL Driver' depends on plugin 'Metabase Hive Like Abstract Driver'
2025-01-14 23:37:06,226 INFO plugins.dependencies :: Metabase Spark SQL Driver dependency {:plugin Metabase Hive Like Abstract Driver} satisfied? true
2025-01-14 23:37:06,226 DEBUG plugins.lazy-loaded-driver :: Registering lazy loading driver :sparksql...
2025-01-14 23:37:06,226 INFO driver.impl :: Registered driver :sparksql (parents: [:hive-like]) 🚚
2025-01-14 23:37:06,229 INFO metabase.core :: Setting up and migrating Metabase DB. Please sit tight, this may take a minute...
2025-01-14 23:37:06,230 INFO db.setup :: Verifying h2 Database Connection ...
2025-01-14 23:37:06,480 INFO db.setup :: Successfully verified H2 2.1.214 (2022-06-13) application database connection. ✅
2025-01-14 23:37:06,480 INFO db.setup :: Checking if a database downgrade is required...
2025-01-14 23:37:06,500 INFO liquibase.database :: Set default schema name to PUBLIC
2025-01-14 23:37:06,718 INFO liquibase :: Parsed changelog file 'liquibase.yaml'
2025-01-14 23:37:06,766 INFO db.setup :: Running Database Migrations...
2025-01-14 23:37:06,766 INFO db.setup :: Setting up Liquibase...
2025-01-14 23:37:06,768 INFO liquibase.database :: Set default schema name to PUBLIC
2025-01-14 23:37:06,843 INFO liquibase :: Parsed changelog file 'liquibase.yaml'
2025-01-14 23:37:06,851 INFO db.liquibase :: Updating liquibase table to reflect consolidated changeset filenames
2025-01-14 23:37:06,866 INFO liquibase.lockservice :: Successfully acquired change log lock
2025-01-14 23:37:06,867 INFO db.liquibase :: No migration lock found.
2025-01-14 23:37:06,867 INFO db.liquibase :: Migration lock acquired.
2025-01-14 23:37:06,891 INFO liquibase.lockservice :: Successfully released change log lock
2025-01-14 23:37:06,891 INFO db.setup :: Liquibase is ready.
2025-01-14 23:37:06,891 INFO db.liquibase :: Checking if Database has unrun migrations...
2025-01-14 23:37:06,893 INFO liquibase.database :: Set default schema name to PUBLIC
2025-01-14 23:37:06,955 INFO liquibase :: Parsed changelog file 'liquibase.yaml'
2025-01-14 23:37:06,965 INFO liquibase.changelog :: Reading from ""PUBLIC"".""DATABASECHANGELOG""
2025-01-14 23:37:07,056 INFO db.liquibase :: No unrun migrations found.
2025-01-14 23:37:07,056 INFO db.setup :: Database Migrations Current ... ✅
2025-01-14 23:37:07,057 INFO metabase.util :: Database setup took 826.8 ms
2025-01-14 23:37:07,074 INFO metabase.core :: Setting up prometheus metrics
2025-01-14 23:37:07,075 INFO analytics.prometheus :: Running prometheus metrics without a webserver.
2025-01-14 23:37:07,075 INFO analytics.prometheus :: Starting prometheus metrics collector
2025-01-14 23:37:07,124 INFO advanced-config.file :: No config file found at path ""/private/tmp/fixed/config.yml""
2025-01-14 23:37:07,139 INFO driver.impl :: Initializing driver :sql...
2025-01-14 23:37:07,139 INFO driver.impl :: Initializing driver :sql-jdbc...
2025-01-14 23:37:07,139 INFO driver.impl :: Initializing driver :h2...
2025-01-14 23:37:07,218 INFO driver.impl :: Initializing driver :postgres...
2025-01-14 23:37:07,234 INFO task.sync-databases :: Not scheduling tasks for audit database
2025-01-14 23:37:07,289 INFO audit-app.audit :: Adjusted Audit DB for loading Analytics Content
2025-01-14 23:37:07,337 INFO audit-app.audit :: The app is running from a jar, starting copy...
2025-01-14 23:37:07,337 INFO audit-app.audit :: Copying /private/tmp/fixed/patched-built.jar::instance_analytics/ -> /private/tmp/fixed/plugins
2025-01-14 23:37:07,405 INFO audit-app.audit :: Copying complete.
2025-01-14 23:37:07,481 INFO task.sync-databases :: Not scheduling tasks for audit database
2025-01-14 23:37:07,507 INFO audit-app.audit :: Adjusted Audit DB to match host engine: h2
2025-01-14 23:37:07,508 INFO notification.seed :: Truncating table :notification
2025-01-14 23:37:07,513 INFO notification.seed :: Truncating table :notification_handler
2025-01-14 23:37:07,520 INFO notification.seed :: Truncating table :notification_subscription
2025-01-14 23:37:07,522 INFO notification.seed :: Truncating table :notification_recipient
2025-01-14 23:37:07,524 INFO notification.seed :: Truncating table :channel_template
2025-01-14 23:37:07,526 INFO notification.seed :: Seeding default notifications
2025-01-14 23:37:07,622 INFO notification.seed :: Seeded 3 notifications
2025-01-14 23:37:07,639 INFO impl.StdSchedulerFactory :: Using default implementation for ThreadExecutor
2025-01-14 23:37:07,645 INFO core.SchedulerSignalerImpl :: Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl
2025-01-14 23:37:07,646 INFO core.QuartzScheduler :: Quartz Scheduler v.2.3.2 created.
2025-01-14 23:37:07,646 INFO jdbcjobstore.JobStoreTX :: Using db table-based data access locking (synchronization).
2025-01-14 23:37:07,647 INFO jdbcjobstore.JobStoreTX :: JobStoreTX initialized.
2025-01-14 23:37:07,647 INFO core.QuartzScheduler :: Scheduler meta-data: Quartz Scheduler (v2.3.2) 'MetabaseScheduler' with instanceId 'mbp-m1.lan1736919427641'
  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.
  NOT STARTED.
  Currently in standby mode.
  Number of jobs executed: 0
  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.
  Using job-store 'org.quartz.impl.jdbcjobstore.JobStoreTX' - which supports persistence. and is clustered.

2025-01-14 23:37:07,647 INFO impl.StdSchedulerFactory :: Quartz scheduler 'MetabaseScheduler' initialized from default resource file in Quartz package: 'quartz.properties'
2025-01-14 23:37:07,647 INFO impl.StdSchedulerFactory :: Quartz scheduler version: 2.3.2
2025-01-14 23:37:07,690 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_mbp-m1.lan1736919427641 paused.
2025-01-14 23:37:07,690 INFO metabase.task :: Task scheduler initialized into standby mode.
2025-01-14 23:37:07,716 INFO metabase.task :: Initializing task SweepQueryAnalysis 📆
2025-01-14 23:37:07,730 INFO metabase.task :: Initializing task Cache 📆
2025-01-14 23:37:07,740 INFO public-settings.premium-features :: Checking with the MetaStore to see whether token 'f325...d01a' is valid...
2025-01-14 23:37:08,095 INFO metabase.task :: Initializing task SearchIndexReindex 📆
2025-01-14 23:37:08,100 INFO metabase.task :: Initializing task SyncDatabases 📆
2025-01-14 23:37:08,106 INFO task.sync-databases :: Updated default schedules for 0 databases
2025-01-14 23:37:08,106 INFO metabase.task :: Initializing task PersistRefresh 📆
2025-01-14 23:37:08,109 INFO driver.impl :: Initializing driver :clickhouse...
2025-01-14 23:37:08,110 INFO plugins.classloader :: Added URL file:/private/tmp/fixed/plugins/clickhouse.metabase-driver.jar to classpath
2025-01-14 23:37:08,110 DEBUG plugins.init-steps :: Loading plugin namespace metabase.driver.clickhouse...
2025-01-14 23:37:08,138 INFO driver.impl :: Registered driver :clickhouse (parents: [:sql-jdbc]) 🚚
2025-01-14 23:37:13,115 ERROR driver.util :: Failed to check feature 'describe-fks' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
        at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:286)
        at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:278)
        at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:293)
        at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:289)
        at metabase.driver.util$supports_QMARK__STAR_.invokeStatic(util.clj:249)
        at metabase.driver.util$supports_QMARK__STAR_.invoke(util.clj:247)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at clojure.core.memoize$through_STAR_$fn__8191.invoke(memoize.clj:110)
        at clojure.core.cache$through$fn__7913.invoke(cache.clj:55)
        at clojure.core.memoize$through_STAR_$fn__8187$fn__8188.invoke(memoize.clj:109)
        at clojure.core.memoize.RetryingDelay.deref(memoize.clj:47)
        at clojure.core$deref.invokeStatic(core.clj:2337)
        at clojure.core$deref.invoke(core.clj:2323)
        at clojure.core.memoize$cached_function$fn__8255.doInvoke(memoize.clj:234)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.invoke(RestFn.java:439)
        at metabase.driver.util$supports_QMARK_.invokeStatic(util.clj:272)
        at metabase.driver.util$supports_QMARK_.invoke(util.clj:265)
        at metabase.driver.util$features$iter__59904__59908$fn__59909.invoke(util.clj:278)
        at clojure.lang.LazySeq.force(LazySeq.java:50)
        at clojure.lang.LazySeq.realize(LazySeq.java:89)
        at clojure.lang.LazySeq.seq(LazySeq.java:106)
        at clojure.lang.RT.seq(RT.java:555)
        at clojure.core$seq__5486.invokeStatic(core.clj:139)
        at clojure.core$reduce1.invokeStatic(core.clj:932)
        at clojure.core$set.invokeStatic(core.clj:4139)
        at clojure.core$set.invoke(core.clj:4131)
        at metabase.driver.util$features.invokeStatic(util.clj:277)
        at metabase.driver.util$features.invoke(util.clj:274)
        at metabase.models.database$after_select_primary_method_model_Database.invokeStatic(database.clj:200)
        at metabase.models.database$after_select_primary_method_model_Database.invoke(database.clj:190)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:11)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:52)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:208)
        at toucan2.tools.after_select$results_transform_primary_method_toucan_result_type_instances_toucan2_tools_after_select_after_select$fn__26812.invoke(after_select.clj:24)
        at toucan2.tools.simple_out_transform$_xform$fn__26789.invoke(simple_out_transform.clj:12)
        at clojure.core$map$fn__5950$fn__5951.invoke(core.clj:2759)
        at clojure.core$map$fn__5950$fn__5951.invoke(core.clj:2759)
[omitting toucan for brevity]
        at toucan2.select$select.invokeStatic(select.clj:48)
        at toucan2.select$select.doInvoke(select.clj:44)
        at clojure.lang.RestFn.invoke(RestFn.java:411)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invokeStatic(persist_refresh.clj:405)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invoke(persist_refresh.clj:401)
        at metabase.task.persist_refresh$fn__96922.invokeStatic(persist_refresh.clj:439)
        at metabase.task.persist_refresh$fn__96922.invoke(persist_refresh.clj:436)
        at metabase.task$init_tasks_BANG_$fn__76669.invoke(task.clj:79)
        at metabase.task$init_tasks_BANG_.invokeStatic(task.clj:75)
        at metabase.task$init_tasks_BANG_.invoke(task.clj:71)
        at metabase.task$init_scheduler_BANG_.invokeStatic(task.clj:166)
        at metabase.task$init_scheduler_BANG_.invoke(task.clj:153)
        at metabase.task$start_scheduler_BANG_.invokeStatic(task.clj:177)
        at metabase.task$start_scheduler_BANG_.invoke(task.clj:172)
        at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:167)
        at metabase.core$init_BANG__STAR_.invoke(core.clj:102)
        at metabase.core$init_BANG_.invokeStatic(core.clj:180)
        at metabase.core$init_BANG_.invoke(core.clj:175)
        at metabase.core$start_normally.invokeStatic(core.clj:192)
        at metabase.core$start_normally.invoke(core.clj:186)
        at metabase.core$entrypoint.invokeStatic(core.clj:228)
        at metabase.core$entrypoint.doInvoke(core.clj:219)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at clojure.lang.Var.applyTo(Var.java:707)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
        at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at metabase.bootstrap.main(Unknown Source)
2025-01-14 23:37:18,135 ERROR driver.util :: Failed to check feature 'index-info' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
        at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:286)
        at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:278)
        at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:293)
        at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:289)
        at metabase.driver.util$supports_QMARK__STAR_.invokeStatic(util.clj:249)
        at metabase.driver.util$supports_QMARK__STAR_.invoke(util.clj:247)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at clojure.core.memoize$through_STAR_$fn__8191.invoke(memoize.clj:110)
        at clojure.core.cache$through$fn__7913.invoke(cache.clj:55)
        at clojure.core.memoize$through_STAR_$fn__8187$fn__8188.invoke(memoize.clj:109)
        at clojure.core.memoize.RetryingDelay.deref(memoize.clj:47)
        at clojure.core$deref.invokeStatic(core.clj:2337)
        at clojure.core$deref.invoke(core.clj:2323)
        at clojure.core.memoize$cached_function$fn__8255.doInvoke(memoize.clj:234)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.invoke(RestFn.java:439)
        at metabase.driver.util$supports_QMARK_.invokeStatic(util.clj:272)
        at metabase.driver.util$supports_QMARK_.invoke(util.clj:265)
        at metabase.driver.util$features$iter__59904__59908$fn__59909.invoke(util.clj:278)
        at clojure.lang.LazySeq.force(LazySeq.java:50)
        at clojure.lang.LazySeq.realize(LazySeq.java:89)
        at clojure.lang.LazySeq.seq(LazySeq.java:106)
        at clojure.lang.RT.seq(RT.java:555)
        at clojure.core$seq__5486.invokeStatic(core.clj:139)
        at clojure.core$reduce1.invokeStatic(core.clj:932)
        at clojure.core$set.invokeStatic(core.clj:4139)
        at clojure.core$set.invoke(core.clj:4131)
        at metabase.driver.util$features.invokeStatic(util.clj:277)
        at metabase.driver.util$features.invoke(util.clj:274)
        at metabase.models.database$after_select_primary_method_model_Database.invokeStatic(database.clj:200)
   [omitting toucan for brevity]
        at toucan2.select$select.invokeStatic(select.clj:48)
        at toucan2.select$select.doInvoke(select.clj:44)
        at clojure.lang.RestFn.invoke(RestFn.java:411)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invokeStatic(persist_refresh.clj:405)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invoke(persist_refresh.clj:401)
        at metabase.task.persist_refresh$fn__96922.invokeStatic(persist_refresh.clj:439)
        at metabase.task.persist_refresh$fn__96922.invoke(persist_refresh.clj:436)
        at metabase.task$init_tasks_BANG_$fn__76669.invoke(task.clj:79)
        at metabase.task$init_tasks_BANG_.invokeStatic(task.clj:75)
        at metabase.task$init_tasks_BANG_.invoke(task.clj:71)
        at metabase.task$init_scheduler_BANG_.invokeStatic(task.clj:166)
        at metabase.task$init_scheduler_BANG_.invoke(task.clj:153)
        at metabase.task$start_scheduler_BANG_.invokeStatic(task.clj:177)
        at metabase.task$start_scheduler_BANG_.invoke(task.clj:172)
        at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:167)
        at metabase.core$init_BANG__STAR_.invoke(core.clj:102)
        at metabase.core$init_BANG_.invokeStatic(core.clj:180)
        at metabase.core$init_BANG_.invoke(core.clj:175)
        at metabase.core$start_normally.invokeStatic(core.clj:192)
        at metabase.core$start_normally.invoke(core.clj:186)
        at metabase.core$entrypoint.invokeStatic(core.clj:228)
        at metabase.core$entrypoint.doInvoke(core.clj:219)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at clojure.lang.Var.applyTo(Var.java:707)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
        at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at metabase.bootstrap.main(Unknown Source)
2025-01-14 23:37:23,163 ERROR driver.util :: Failed to check feature 'connection/multiple-databases' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
        at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:286)
        at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:278)
        at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:293)
        at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:289)
        at metabase.driver.util$supports_QMARK__STAR_.invokeStatic(util.clj:249)
        at metabase.driver.util$supports_QMARK__STAR_.invoke(util.clj:247)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at clojure.core.memoize$through_STAR_$fn__8191.invoke(memoize.clj:110)
        at clojure.core.cache$through$fn__7913.invoke(cache.clj:55)
        at clojure.core.memoize$through_STAR_$fn__8187$fn__8188.invoke(memoize.clj:109)
        at clojure.core.memoize.RetryingDelay.deref(memoize.clj:47)
        at clojure.core$deref.invokeStatic(core.clj:2337)
        at clojure.core$deref.invoke(core.clj:2323)
        at clojure.core.memoize$cached_function$fn__8255.doInvoke(memoize.clj:234)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.invoke(RestFn.java:439)
        at metabase.driver.util$supports_QMARK_.invokeStatic(util.clj:272)
        at metabase.driver.util$supports_QMARK_.invoke(util.clj:265)
        at metabase.driver.util$features$iter__59904__59908$fn__59909.invoke(util.clj:278)
        at clojure.lang.LazySeq.force(LazySeq.java:50)
        at clojure.lang.LazySeq.realize(LazySeq.java:89)
        at clojure.lang.LazySeq.seq(LazySeq.java:106)
        at clojure.lang.RT.seq(RT.java:555)
        at clojure.core$seq__5486.invokeStatic(core.clj:139)
        at clojure.core$reduce1.invokeStatic(core.clj:932)
        at clojure.core$set.invokeStatic(core.clj:4139)
        at clojure.core$set.invoke(core.clj:4131)
        at metabase.driver.util$features.invokeStatic(util.clj:277)
        at metabase.driver.util$features.invoke(util.clj:274)
    [omitting toucan for brevity]
        at toucan2.select$select.doInvoke(select.clj:44)
        at clojure.lang.RestFn.invoke(RestFn.java:411)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invokeStatic(persist_refresh.clj:405)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invoke(persist_refresh.clj:401)
        at metabase.task.persist_refresh$fn__96922.invokeStatic(persist_refresh.clj:439)
        at metabase.task.persist_refresh$fn__96922.invoke(persist_refresh.clj:436)
        at metabase.task$init_tasks_BANG_$fn__76669.invoke(task.clj:79)
        at metabase.task$init_tasks_BANG_.invokeStatic(task.clj:75)
        at metabase.task$init_tasks_BANG_.invoke(task.clj:71)
        at metabase.task$init_scheduler_BANG_.invokeStatic(task.clj:166)
        at metabase.task$init_scheduler_BANG_.invoke(task.clj:153)
        at metabase.task$start_scheduler_BANG_.invokeStatic(task.clj:177)
        at metabase.task$start_scheduler_BANG_.invoke(task.clj:172)
        at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:167)
        at metabase.core$init_BANG__STAR_.invoke(core.clj:102)
        at metabase.core$init_BANG_.invokeStatic(core.clj:180)
        at metabase.core$init_BANG_.invoke(core.clj:175)
        at metabase.core$start_normally.invokeStatic(core.clj:192)
        at metabase.core$start_normally.invoke(core.clj:186)
        at metabase.core$entrypoint.invokeStatic(core.clj:228)
        at metabase.core$entrypoint.doInvoke(core.clj:219)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at clojure.lang.Var.applyTo(Var.java:707)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
        at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at metabase.bootstrap.main(Unknown Source)
2025-01-14 23:37:28,185 ERROR driver.util :: Failed to check feature 'full-join' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
        at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:286)
        at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:278)
        at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:293)
        at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:289)
        at metabase.driver.util$supports_QMARK__STAR_.invokeStatic(util.clj:249)
        at metabase.driver.util$supports_QMARK__STAR_.invoke(util.clj:247)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at clojure.core.memoize$through_STAR_$fn__8191.invoke(memoize.clj:110)
        at clojure.core.cache$through$fn__7913.invoke(cache.clj:55)
        at clojure.core.memoize$through_STAR_$fn__8187$fn__8188.invoke(memoize.clj:109)
        at clojure.core.memoize.RetryingDelay.deref(memoize.clj:47)
        at clojure.core$deref.invokeStatic(core.clj:2337)
        at clojure.core$deref.invoke(core.clj:2323)
        at clojure.core.memoize$cached_function$fn__8255.doInvoke(memoize.clj:234)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.invoke(RestFn.java:439)
        at metabase.driver.util$supports_QMARK_.invokeStatic(util.clj:272)
        at metabase.driver.util$supports_QMARK_.invoke(util.clj:265)
        at metabase.driver.util$features$iter__59904__59908$fn__59909.invoke(util.clj:278)
        at clojure.lang.LazySeq.force(LazySeq.java:50)
        at clojure.lang.LazySeq.realize(LazySeq.java:89)
        at clojure.lang.LazySeq.seq(LazySeq.java:106)
        at clojure.lang.RT.seq(RT.java:555)
        at clojure.core$seq__5486.invokeStatic(core.clj:139)
        at clojure.core$reduce1.invokeStatic(core.clj:932)
        at clojure.core$set.invokeStatic(core.clj:4139)
        at clojure.core$set.invoke(core.clj:4131)
        at metabase.driver.util$features.invokeStatic(util.clj:277)
        at metabase.driver.util$features.invoke(util.clj:274)
        at metabase.models.database$after_select_primary_method_model_Database.invokeStatic(database.clj:200)
        at metabase.models.database$after_select_primary_method_model_Database.invoke(database.clj:190)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:11)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
[omitting toucan for brevity]
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invokeStatic(persist_refresh.clj:405)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invoke(persist_refresh.clj:401)
        at metabase.task.persist_refresh$fn__96922.invokeStatic(persist_refresh.clj:439)
        at metabase.task.persist_refresh$fn__96922.invoke(persist_refresh.clj:436)
        at metabase.task$init_tasks_BANG_$fn__76669.invoke(task.clj:79)
        at metabase.task$init_tasks_BANG_.invokeStatic(task.clj:75)
        at metabase.task$init_tasks_BANG_.invoke(task.clj:71)
        at metabase.task$init_scheduler_BANG_.invokeStatic(task.clj:166)
        at metabase.task$init_scheduler_BANG_.invoke(task.clj:153)
        at metabase.task$start_scheduler_BANG_.invokeStatic(task.clj:177)
        at metabase.task$start_scheduler_BANG_.invoke(task.clj:172)
        at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:167)
        at metabase.core$init_BANG__STAR_.invoke(core.clj:102)
        at metabase.core$init_BANG_.invokeStatic(core.clj:180)
        at metabase.core$init_BANG_.invoke(core.clj:175)
        at metabase.core$start_normally.invokeStatic(core.clj:192)
        at metabase.core$start_normally.invoke(core.clj:186)
        at metabase.core$entrypoint.invokeStatic(core.clj:228)
        at metabase.core$entrypoint.doInvoke(core.clj:219)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at clojure.lang.Var.applyTo(Var.java:707)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
        at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at metabase.bootstrap.main(Unknown Source)
2025-01-14 23:37:33,213 ERROR driver.util :: Failed to check feature 'window-functions/cumulative' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
        at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:286)
        at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:278)
        at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:293)
        at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:289)
        at metabase.driver.util$supports_QMARK__STAR_.invokeStatic(util.clj:249)
        at metabase.driver.util$supports_QMARK__STAR_.invoke(util.clj:247)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at clojure.core.memoize$through_STAR_$fn__8191.invoke(memoize.clj:110)
        at clojure.core.cache$through$fn__7913.invoke(cache.clj:55)
        at clojure.core.memoize$through_STAR_$fn__8187$fn__8188.invoke(memoize.clj:109)
        at clojure.core.memoize.RetryingDelay.deref(memoize.clj:47)
        at clojure.core$deref.invokeStatic(core.clj:2337)
        at clojure.core$deref.invoke(core.clj:2323)
        at clojure.core.memoize$cached_function$fn__8255.doInvoke(memoize.clj:234)
[omitting toucan for brevity]
        at metabase.task$init_tasks_BANG_$fn__76669.invoke(task.clj:79)
        at metabase.task$init_tasks_BANG_.invokeStatic(task.clj:75)
        at metabase.task$init_tasks_BANG_.invoke(task.clj:71)
        at metabase.task$init_scheduler_BANG_.invokeStatic(task.clj:166)
        at metabase.task$init_scheduler_BANG_.invoke(task.clj:153)
        at metabase.task$start_scheduler_BANG_.invokeStatic(task.clj:177)
        at metabase.task$start_scheduler_BANG_.invoke(task.clj:172)
        at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:167)
        at metabase.core$init_BANG__STAR_.invoke(core.clj:102)
        at metabase.core$init_BANG_.invokeStatic(core.clj:180)
        at metabase.core$init_BANG_.invoke(core.clj:175)
        at metabase.core$start_normally.invokeStatic(core.clj:192)
        at metabase.core$start_normally.invoke(core.clj:186)
        at metabase.core$entrypoint.invokeStatic(core.clj:228)
        at metabase.core$entrypoint.doInvoke(core.clj:219)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at clojure.lang.Var.applyTo(Var.java:707)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
        at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at metabase.bootstrap.main(Unknown Source)
2025-01-14 23:37:38,236 ERROR driver.util :: Failed to check feature 'test/dynamic-dataset-loading' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
        at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:286)
        at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:278)
        at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:293)
        at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:289)
        at metabase.driver.util$supports_QMARK__STAR_.invokeStatic(util.clj:249)
        at metabase.driver.util$supports_QMARK__STAR_.invoke(util.clj:247)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at clojure.core.memoize$through_STAR_$fn__8191.invoke(memoize.clj:110)
        at clojure.core.cache$through$fn__7913.invoke(cache.clj:55)
[omitting toucan for brevity]
        at clojure.lang.RestFn.invoke(RestFn.java:411)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invokeStatic(persist_refresh.clj:405)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invoke(persist_refresh.clj:401)
        at metabase.task.persist_refresh$fn__96922.invokeStatic(persist_refresh.clj:439)
        at metabase.task.persist_refresh$fn__96922.invoke(persist_refresh.clj:436)
        at metabase.task$init_tasks_BANG_$fn__76669.invoke(task.clj:79)
        at metabase.task$init_tasks_BANG_.invokeStatic(task.clj:75)
        at metabase.task$init_tasks_BANG_.invoke(task.clj:71)
        at metabase.task$init_scheduler_BANG_.invokeStatic(task.clj:166)
        at metabase.task$init_scheduler_BANG_.invoke(task.clj:153)
        at metabase.task$start_scheduler_BANG_.invokeStatic(task.clj:177)
        at metabase.task$start_scheduler_BANG_.invoke(task.clj:172)
        at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:167)
        at metabase.core$init_BANG__STAR_.invoke(core.clj:102)
        at metabase.core$init_BANG_.invokeStatic(core.clj:180)
        at metabase.core$init_BANG_.invoke(core.clj:175)
        at metabase.core$start_normally.invokeStatic(core.clj:192)
        at metabase.core$start_normally.invoke(core.clj:186)
        at metabase.core$entrypoint.invokeStatic(core.clj:228)
        at metabase.core$entrypoint.doInvoke(core.clj:219)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at clojure.lang.Var.applyTo(Var.java:707)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
        at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at metabase.bootstrap.main(Unknown Source)
2025-01-14 23:37:43,252 ERROR driver.util :: Failed to check feature 'describe-fields' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
        at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:286)
        at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:278)
        at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:293)
        at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:289)
        at metabase.driver.util$supports_QMARK__STAR_.invokeStatic(util.clj:249)
        at metabase.driver.util$supports_QMARK__STAR_.invoke(util.clj:247)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at clojure.core.memoize$through_STAR_$fn__8191.invoke(memoize.clj:110)
        at clojure.core.cache$through$fn__7913.invoke(cache.clj:55)
        at clojure.core.memoize$through_STAR_$fn__8187$fn__8188.invoke(memoize.clj:109)
        at clojure.core.memoize.RetryingDelay.deref(memoize.clj:47)
        at clojure.core$deref.invokeStatic(core.clj:2337)
        at clojure.core$deref.invoke(core.clj:2323)
        at clojure.core.memoize$cached_function$fn__8255.doInvoke(memoize.clj:234)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.invoke(RestFn.java:439)
        at metabase.driver.util$supports_QMARK_.invokeStatic(util.clj:272)
        at metabase.driver.util$supports_QMARK_.invoke(util.clj:265)
      [omitting toucan for brevity]
        at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:167)
        at metabase.core$init_BANG__STAR_.invoke(core.clj:102)
        at metabase.core$init_BANG_.invokeStatic(core.clj:180)
        at metabase.core$init_BANG_.invoke(core.clj:175)
        at metabase.core$start_normally.invokeStatic(core.clj:192)
        at metabase.core$start_normally.invoke(core.clj:186)
        at metabase.core$entrypoint.invokeStatic(core.clj:228)
        at metabase.core$entrypoint.doInvoke(core.clj:219)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at clojure.lang.Var.applyTo(Var.java:707)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
        at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at metabase.bootstrap.main(Unknown Source)
2025-01-14 23:37:53,282 ERROR driver.util :: Failed to check feature 'temporal-extract' for database 'ch'
java.util.concurrent.TimeoutException: Timed out after 5.0 s
        at metabase.util.jvm$deref_with_timeout.invokeStatic(jvm.clj:286)
        at metabase.util.jvm$deref_with_timeout.invoke(jvm.clj:278)
        at metabase.util.jvm$do_with_timeout.invokeStatic(jvm.clj:293)
        at metabase.util.jvm$do_with_timeout.invoke(jvm.clj:289)
        at metabase.driver.util$supports_QMARK__STAR_.invokeStatic(util.clj:249)
        at metabase.driver.util$supports_QMARK__STAR_.invoke(util.clj:247)
        at clojure.lang.AFn.applyToHelper(AFn.java:160)
        at clojure.lang.AFn.applyTo(AFn.java:144)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at clojure.core.memoize$through_STAR_$fn__8191.invoke(memoize.clj:110)
        at clojure.core.cache$through$fn__7913.invoke(cache.clj:55)
        at clojure.core.memoize$through_STAR_$fn__8187$fn__8188.invoke(memoize.clj:109)
        at clojure.core.memoize.RetryingDelay.deref(memoize.clj:47)
        at clojure.core$deref.invokeStatic(core.clj:2337)
        at clojure.core$deref.invoke(core.clj:2323)
        at clojure.core.memoize$cached_function$fn__8255.doInvoke(memoize.clj:234)
        at clojure.lang.RestFn.applyTo(RestFn.java:140)
        at clojure.lang.AFunction$1.doInvoke(AFunction.java:33)
        at clojure.lang.RestFn.invoke(RestFn.java:439)
        at metabase.driver.util$supports_QMARK_.invokeStatic(util.clj:272)
        at metabase.driver.util$supports_QMARK_.invoke(util.clj:265)
        at metabase.driver.util$features$iter__59904__59908$fn__59909.invoke(util.clj:278)
        at clojure.lang.LazySeq.force(LazySeq.java:50)
        at clojure.lang.LazySeq.realize(LazySeq.java:89)
        at clojure.lang.LazySeq.seq(LazySeq.java:106)
        at clojure.lang.RT.seq(RT.java:555)
        at clojure.core$seq__5486.invokeStatic(core.clj:139)
        at clojure.core$reduce1.invokeStatic(core.clj:932)
        at clojure.core$set.invokeStatic(core.clj:4139)
        at clojure.core$set.invoke(core.clj:4131)
        at metabase.driver.util$features.invokeStatic(util.clj:277)
        at metabase.driver.util$features.invoke(util.clj:274)
        at metabase.models.database$after_select_primary_method_model_Database.invokeStatic(database.clj:200)
        at metabase.models.database$after_select_primary_method_model_Database.invoke(database.clj:190)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:11)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:52)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:208)
        at toucan2.tools.after_select$results_transform_primary_method_toucan_result_type_instances_toucan2_tools_after_select_after_select$fn__26812.invoke(after_select.clj:24)
        at toucan2.tools.simple_out_transform$_xform$fn__26789.invoke(simple_out_transform.clj:12)
        at clojure.core$map$fn__5950$fn__5951.invoke(core.clj:2759)
        at clojure.core$map$fn__5950$fn__5951.invoke(core.clj:2759)
        at toucan2.jdbc.result_set$reduce_result_set.invokeStatic(result_set.clj:156)
        at toucan2.jdbc.result_set$reduce_result_set.invoke(result_set.clj:125)
        at toucan2.jdbc.query$reduce_jdbc_query.invokeStatic(query.clj:51)
        at toucan2.jdbc.query$reduce_jdbc_query.invoke(query.clj:22)
        at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invokeStatic(pipeline.clj:19)
        at toucan2.jdbc.pipeline$transduce_execute_with_connection_primary_method_java_sql_Connection_default_default.invoke(pipeline.clj:9)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:15)
        at methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733.invoke(threaded.clj:64)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:216)
        at toucan2.pipeline$transduce_execute$with_connection_STAR___22818.invoke(pipeline.clj:78)
        at toucan2.connection$bind_current_connectable_fn$fn__22495.invoke(connection.clj:104)
        at toucan2.connection$bind_current_connectable_fn$fn__22495.invoke(connection.clj:104)
        at toucan2.connection$bind_current_connectable_fn$fn__22495.invoke(connection.clj:104)
        at toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource.invokeStatic(connection.clj:18)
        at toucan2.jdbc.connection$do_with_connection_primary_method_javax_sql_DataSource.invoke(connection.clj:15)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:12)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:12)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:210)
        at metabase.db.connection$do_with_connection_primary_method_default.invokeStatic(connection.clj:132)
        at metabase.db.connection$do_with_connection_primary_method_default.invoke(connection.clj:130)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:12)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:12)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:210)
        at toucan2.connection$do_with_connection_primary_method_.invokeStatic(connection.clj:204)
        at toucan2.connection$do_with_connection_primary_method_.invoke(connection.clj:194)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:12)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invokeStatic(connection.clj:118)
        at toucan2.connection$do_with_connection_around_method_toucan2_connection_default.invoke(connection.clj:106)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:12)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:55)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:210)
        at toucan2.pipeline$transduce_execute.invokeStatic(pipeline.clj:77)
        at toucan2.pipeline$transduce_execute.invoke(pipeline.clj:64)
        at clojure.lang.Var.invoke(Var.java:401)
        at toucan2.pipeline$transduce_compiled_query.invokeStatic(pipeline.clj:244)
        at toucan2.pipeline$transduce_compiled_query.invoke(pipeline.clj:240)
        at toucan2.pipeline$transduce_built_query.invokeStatic(pipeline.clj:252)
        at toucan2.pipeline$transduce_built_query.invoke(pipeline.clj:246)
        at toucan2.pipeline$transduce_query_primary_method_default.invokeStatic(pipeline.clj:272)
        at toucan2.pipeline$transduce_query_primary_method_default.invoke(pipeline.clj:269)
        at methodical.impl.combo.common$partial_STAR_$fn__19422.invoke(common.clj:15)
        at methodical.impl.combo.threaded$combine_methods_thread_last$fn__19732$combined_method_thread_last__19733.invoke(threaded.clj:64)
        at methodical.util.FnWithMeta.invoke(util.clj:46)
        at methodical.impl.standard$invoke_multifn.invokeStatic(standard.clj:65)
        at methodical.impl.standard$invoke_multifn.invoke(standard.clj:47)
        at methodical.impl.standard.StandardMultiFn.invoke(standard.clj:216)
        at toucan2.pipeline$transduce_query_STAR_.invokeStatic(pipeline.clj:278)
        at toucan2.pipeline$transduce_query_STAR_.invoke(pipeline.clj:274)
        at toucan2.pipeline$transduce_with_model.invokeStatic(pipeline.clj:293)
        at toucan2.pipeline$transduce_with_model.invoke(pipeline.clj:280)
        at toucan2.pipeline$transduce_parsed.invokeStatic(pipeline.clj:309)
        at toucan2.pipeline$transduce_parsed.invoke(pipeline.clj:295)
        at toucan2.pipeline$transduce_unparsed.invokeStatic(pipeline.clj:317)
        at toucan2.pipeline$transduce_unparsed.invoke(pipeline.clj:311)
        at toucan2.pipeline$transduce_unparsed_with_default_rf.invokeStatic(pipeline.clj:383)
        at toucan2.pipeline$transduce_unparsed_with_default_rf.invoke(pipeline.clj:377)
        at toucan2.select$select.invokeStatic(select.clj:48)
        at toucan2.select$select.doInvoke(select.clj:44)
        at clojure.lang.RestFn.invoke(RestFn.java:411)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invokeStatic(persist_refresh.clj:405)
        at metabase.task.persist_refresh$reschedule_refresh_BANG_.invoke(persist_refresh.clj:401)
        at metabase.task.persist_refresh$fn__96922.invokeStatic(persist_refresh.clj:439)
        at metabase.task.persist_refresh$fn__96922.invoke(persist_refresh.clj:436)
        at metabase.task$init_tasks_BANG_$fn__76669.invoke(task.clj:79)
        at metabase.task$init_tasks_BANG_.invokeStatic(task.clj:75)
        at metabase.task$init_tasks_BANG_.invoke(task.clj:71)
        at metabase.task$init_scheduler_BANG_.invokeStatic(task.clj:166)
        at metabase.task$init_scheduler_BANG_.invoke(task.clj:153)
        at metabase.task$start_scheduler_BANG_.invokeStatic(task.clj:177)
        at metabase.task$start_scheduler_BANG_.invoke(task.clj:172)
        at metabase.core$init_BANG__STAR_.invokeStatic(core.clj:167)
        at metabase.core$init_BANG__STAR_.invoke(core.clj:102)
        at metabase.core$init_BANG_.invokeStatic(core.clj:180)
        at metabase.core$init_BANG_.invoke(core.clj:175)
        at metabase.core$start_normally.invokeStatic(core.clj:192)
        at metabase.core$start_normally.invoke(core.clj:186)
        at metabase.core$entrypoint.invokeStatic(core.clj:228)
        at metabase.core$entrypoint.doInvoke(core.clj:219)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at clojure.lang.Var.applyTo(Var.java:707)
        at clojure.core$apply.invokeStatic(core.clj:667)
        at clojure.core$apply.invoke(core.clj:662)
        at metabase.bootstrap$_main.invokeStatic(bootstrap.clj:31)
        at metabase.bootstrap$_main.doInvoke(bootstrap.clj:28)
        at clojure.lang.RestFn.invoke(RestFn.java:400)
        at clojure.lang.AFn.applyToHelper(AFn.java:152)
        at clojure.lang.RestFn.applyTo(RestFn.java:135)
        at metabase.bootstrap.main(Unknown Source)
2025-01-14 23:37:58,189 DEBUG plugins.jdbc-proxy :: Registering JDBC proxy driver for com.clickhouse.jdbc.ClickHouseDriver...
2025-01-14 23:37:58,192 INFO metabase.util :: Load lazy loading driver :clickhouse took 50.1 s
2025-01-14 23:38:00,107 INFO metabase.task :: Initializing task CheckForNewVersions 📆
2025-01-14 23:38:00,112 INFO metabase.task :: Initializing task SearchIndexInit 📆
2025-01-14 23:38:00,115 INFO metabase.task :: Initializing task SendNotifications 📆
2025-01-14 23:38:00,116 INFO metabase.task :: Initializing task PersistPrune 📆
2025-01-14 23:38:00,117 INFO metabase.task :: Initializing task SendAnonymousUsageStats 📆
2025-01-14 23:38:00,122 INFO metabase.task :: Initializing task BackfillQueryField 📆
2025-01-14 23:38:00,125 INFO metabase.task :: Initializing task ModelIndexValues 📆
2025-01-14 23:38:00,127 INFO metabase.task :: Initializing task RefreshSlackChannelsAndUsers 📆
2025-01-14 23:38:00,132 INFO metabase.task :: Initializing task TruncateAuditTables 📆
2025-01-14 23:38:00,136 INFO metabase.task :: Initializing task SendPulses 📆
2025-01-14 23:38:00,137 INFO metabase.task :: Initializing task SendFollowUpEmails 📆
2025-01-14 23:38:00,140 INFO metabase.task :: Initializing task SendCreatorSentimentEmails 📆
2025-01-14 23:38:00,143 INFO metabase.task :: Initializing task SendLegacyNoSelfServiceEmail 📆
2025-01-14 23:38:00,144 INFO metabase.task :: Initializing task TaskHistoryCleanup 📆
2025-01-14 23:38:00,148 INFO metabase.task :: Initializing task SearchIndexUpdate 📆
2025-01-14 23:38:00,153 INFO metabase.task :: Initializing task SendWarnPulseRemovalEmail 📆
2025-01-14 23:38:00,155 INFO jdbcjobstore.JobStoreTX :: ClusterManager: detected 1 failed or restarted instances.
2025-01-14 23:38:00,155 INFO jdbcjobstore.JobStoreTX :: ClusterManager: Scanning for instance ""mbp-m1.lan1736919239344""'s failed in-progress jobs.
2025-01-14 23:38:00,156 INFO jdbcjobstore.JobStoreTX :: ClusterManager: ......Freed 1 acquired trigger(s).
2025-01-14 23:38:00,156 INFO jdbcjobstore.JobStoreTX :: ClusterManager: ......Cleaned-up 1 other failed job(s).
2025-01-14 23:38:00,159 INFO core.QuartzScheduler :: Scheduler MetabaseScheduler_$_mbp-m1.lan1736919427641 started.
2025-01-14 23:38:00,159 INFO metabase.task :: Task scheduler started
2025-01-14 23:38:00,169 INFO task.sweep-query-analysis :: Calculating analysis for cards without any
2025-01-14 23:38:00,173 INFO task.sweep-query-analysis :: Recalculating potentially stale analysis
2025-01-14 23:38:00,176 INFO task.sync-databases :: Not scheduling tasks for audit database
2025-01-14 23:38:00,176 INFO metabase.core :: Metabase Initialization COMPLETE in 1.0 mins
```


</details>

### Information about your Metabase installation

```JSON
master, 52, etc
```

### Severity

p

### Additional context

This can slow down startup. Adds about 1 minute per clickhouse db with persisted models.",dpsutton,2025-01-15 05:43:46+00:00,[],2025-02-04 20:25:03+00:00,,https://github.com/metabase/metabase/issues/52188,"[('Type:Bug', 'Product defects'), ('Database/', ''), ('Priority:P2', 'Average run of the mill bug'), ('.Team/Drivers', '')]",[],
2788794478,issue,closed,completed,[Backend modularization] `enterprise/models`,"We should probably just move this into the OSS models module and have it check whether config/ee-available? , one function is too small to get its own module IMO.",camsaul,2025-01-15 04:13:02+00:00,['camsaul'],2025-01-27 22:11:37+00:00,2025-01-15 18:14:41+00:00,https://github.com/metabase/metabase/issues/52183,[],[],
2788671496,issue,closed,completed,[Backend modularization] `analyze`,"I modularized this recently so it has a nice API namespace at `metabase.analyze`, it just needs to get moved to `metabase.analyze.core`",camsaul,2025-01-15 02:03:02+00:00,[],2025-02-07 23:36:30+00:00,2025-01-15 04:11:18+00:00,https://github.com/metabase/metabase/issues/52178,[],[],
2788642682,issue,closed,completed,[Backend modularization] `compatibility`,One single namespace with one single helper function used only by Card-related stuff. Merged this into Card model code.,camsaul,2025-01-15 01:33:13+00:00,['camsaul'],2025-01-27 22:11:42+00:00,2025-01-15 02:28:38+00:00,https://github.com/metabase/metabase/issues/52176,[],[],
2788599775,issue,open,,[Backend modularization] `db`,"I think this module is pretty good but `metabase.db` should get moved to `metabase.db.core` . Also there are a lot of namespaces that are used other than the “API” module, `metabase.db.metadata-queries` , `metabase.db.query`, and `metabase.db.setup` are all used outside of this module.",camsaul,2025-01-15 01:10:03+00:00,['camsaul'],2025-01-15 01:11:16+00:00,,https://github.com/metabase/metabase/issues/52174,[],[],
2788575249,issue,closed,completed,[Backend modularization] `troubleshooting`,"We can move this into a `metabase.util.system-info` namespace or something like that.

But it does have some extra non-system-info type stuff like info about premium features airgapping and app DB details for hosted instances. I think maybe it’s better to move these functions into the respective places they’re used",camsaul,2025-01-15 00:50:10+00:00,['camsaul'],2025-01-27 22:11:43+00:00,2025-01-15 02:20:32+00:00,https://github.com/metabase/metabase/issues/52172,[],[],
2788544658,issue,closed,completed,`actions` module cleanup,Has a nice `metabase.actions.core` API namespace but `metabase.actions` needs to be moved into the module.,camsaul,2025-01-15 00:24:45+00:00,['camsaul'],2025-02-07 22:33:26+00:00,2025-01-15 04:10:48+00:00,https://github.com/metabase/metabase/issues/52169,[],[],
2788527770,issue,closed,completed,[Backend modularization] `metabot`,"MetaBot v2 (deprecated) code, we can delete this entirely.",camsaul,2025-01-15 00:13:38+00:00,['camsaul'],2025-01-27 22:11:43+00:00,2025-01-15 02:02:22+00:00,https://github.com/metabase/metabase/issues/52166,[],[],
2788505549,issue,closed,completed,[Backend modularization] `query-analysis`,I think this is generally good for now but we need to make a `metabase.query-analysis.core`,camsaul,2025-01-14 23:55:04+00:00,['camsaul'],2025-01-27 22:11:40+00:00,2025-01-15 07:55:42+00:00,https://github.com/metabase/metabase/issues/52164,[],[],
2788501518,issue,open,,The Japanese translation is broken,"### Describe the bug

The quality of the Japanese translation seems to be entirely machine-generated, and I cannot overlook the issues on the following page. It appears that placeholders like **{0}** and **{1}** should have variables inserted, but instead, it shows **0}** without substitution. This makes it unsuitable for enterprise use.

http://localhost:3000/
>  **0}** で何ができるか、これらのサンプルX線を試してみてください。
> Try out these sample x-rays to see what **Metabase** can do.

http://localhost:3000/getting-started
> **0}** を設定する。
> Set up your **Metabase**

>**0}** を最大限に活用する
>Get the most out of **Metabase**

>Metabaseは多くのことができます。**1}** 、データ可視化、モデリング、その他のデータトピックについてもっと学ぶには、以下をご覧ください。
>Metabase can do a lot. To learn more—about **Metabase** , data visualization, modeling, and other data topics—check out our sites.

http://localhost:3000/admin/performance/databases
> **0}** で各データベース、ダッシュボード、クエリの詳細なキャッシュ制御を取得する
> Get granular caching controls for each database, dashboard, and query with **Metabase Pro**.

Additionally, there are many sentences with issues related to inverted word order, such as phrases like ""Product Summary of."" Since Japanese word order is different from English, the position of the placeholder needs to be changed, otherwise the display will be extremely unnatural.

I followed the manual and went to POEditor, but I received the error message: ""This project can't accept new contributors at this time. Please try again later."" It seems that I cannot edit it. Does this mean I should edit it on GitHub?

```JSON
{
  ""browser-info"": {
    ""language"": ""ja"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-07"",
      ""tag"": ""v0.52.5"",
      ""hash"": ""cc77eeb""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.124-linuxkit"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

Just by looking at the localhost:3000, Japanese companies will likely decide not to adopt the product.

### Additional context

_No response_",disksystem,2025-01-14 23:51:52+00:00,[],2025-02-04 20:25:02+00:00,,https://github.com/metabase/metabase/issues/52163,"[('Priority:P2', 'Average run of the mill bug'), ('Customization/i18n', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2788443772,issue,open,,Ability to hide column in Pivot Table,Currently there is no way to hide a column in Pivot Tables,sanjoyg,2025-01-14 23:04:38+00:00,[],2025-01-14 23:04:38+00:00,,https://github.com/metabase/metabase/issues/52159,[],[],
2788435218,issue,open,,"Variables Linked to text Cards Display ID Instead of ""Entity Name"" or Remapped Values","### Describe the bug

You can link filters to text card variables to display the selected values. With remapped fields or lists that display entity names it seems intuitive that the linked variable in the text card would also show the name / remapped field but it actually displays the selected ID.

### To Reproduce

1. Set entity key for ""sample.users"" to display a list of all values
2. Create a simple question on the users table and add it to a dashboard
3. Add a filter on the ID column and note that the dropdown displays the user name because it's the 'entity name"" field
4. Add a text card with a variable and link it to the filter
5. Not that when you select a name the ID is displayed in the text card

If you explicitly set remapped values for entity ID the remapped values also do not display in the text card.

### Expected behavior

That IDs with display names or remapped fields are displayed as such throughout the product.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-13"",
      ""tag"": ""v1.52.5.5"",
      ""hash"": ""e85b71b""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.1 (Debian 15.1-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.167.4-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

annoying

### Additional context

_No response_",ixipixi,2025-01-14 22:56:43+00:00,[],2025-02-04 20:29:45+00:00,,https://github.com/metabase/metabase/issues/52157,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Difficulty:Easy', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]",[],
2788373322,issue,closed,completed,[Backend modularization] `bootstrap`,We should move this into the core module so it can live with the rest of the app-launch code,camsaul,2025-01-14 22:10:35+00:00,['camsaul'],2025-01-27 22:11:45+00:00,2025-01-15 01:15:35+00:00,https://github.com/metabase/metabase/issues/52154,[],[],
2788372242,issue,closed,completed,[Backend modularization] `core`,Ok for now but `metabase.core` should get moved to `metabase.core.core`,camsaul,2025-01-14 22:09:47+00:00,['camsaul'],2025-01-27 22:11:44+00:00,2025-01-15 01:15:35+00:00,https://github.com/metabase/metabase/issues/52153,[],[],
2788370638,issue,open,,[Backend modularization] `sample-data`,We should move this into core,camsaul,2025-01-14 22:08:39+00:00,['camsaul'],2025-01-14 22:29:02+00:00,,https://github.com/metabase/metabase/issues/52152,[],"[{'comment_id': 2591238716, 'issue_id': 2788370638, 'author': 'camsaul', 'body': ""Actually after looking at this a bit more I'm not sure if this is the right move: it's also used by an endpoint in `metabase.api.database` to add the sample database back if you've deleted it from the admin panel. I don't want a circular dependency between the API stuff and `metabase.core`. Need to think about what to do with this. Maybe the right answer is just to leave it as a standalone module and give it a real API namespace."", 'created_at': datetime.datetime(2025, 1, 14, 22, 29, 1, tzinfo=datetime.timezone.utc)}]","camsaul (Issue Creator) on (2025-01-14 22:29:01 UTC): Actually after looking at this a bit more I'm not sure if this is the right move: it's also used by an endpoint in `metabase.api.database` to add the sample database back if you've deleted it from the admin panel. I don't want a circular dependency between the API stuff and `metabase.core`. Need to think about what to do with this. Maybe the right answer is just to leave it as a standalone module and give it a real API namespace.

"
2788337834,issue,closed,completed,[Backend modularization] `xrays`,"I created this module a few months ago as part of this project so it already has a nice API namespace, unfortunately it’s called metabase.xrays instead of metabase.xrays.core so just needs that minor tweak",camsaul,2025-01-14 21:45:15+00:00,['camsaul'],2025-01-27 22:11:46+00:00,2025-01-14 23:02:57+00:00,https://github.com/metabase/metabase/issues/52146,[],[],
2788330732,issue,closed,completed,[Backend modularization] `related`,This is only used by Automagic Dashboards (which live in the xrays module) so it should be moved there.,camsaul,2025-01-14 21:39:55+00:00,['camsaul'],2025-01-27 22:11:46+00:00,2025-01-14 23:02:56+00:00,https://github.com/metabase/metabase/issues/52142,[],[],
2788267087,issue,open,,"Unable to change password - Unexpected token 'N', ""Not found."" is not valid JSON","### Describe the bug

When I try to reset a user password OR set a password in a new user, it returns:

`
Unexpected token 'N', ""Not found."" is not valid JSON
`

<img width=""528"" alt=""Image"" src=""https://github.com/user-attachments/assets/f34c8468-fafc-4d2f-97c8-6876cf8d95fb"" />

### To Reproduce

1. Create new user
2. In the first access set a password
3. It returns an error


### Expected behavior

_No response_

### Logs

`
[f7d11035-4618-469b-bc23-9b0047233d7b] 2025-01-14T17:47:36-03:00 DEBUG metabase.server.middleware.log GET /api/session/password_reset_token_valid 200 145ms (1 DB calls) App DB connections: 0/15 Jetty threads: 3/50 (3 idle, 0 queued) (116 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[f7d11035-4618-469b-bc23-9b0047233d7b] 2025-01-14T17:47:39-03:00 DEBUG metabase.server.middleware.log POST /api/util/password_check 200 109ms (0 DB calls) App DB connections: 0/15 Jetty threads: 4/50 (3 idle, 0 queued) (116 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[f7d11035-4618-469b-bc23-9b0047233d7b] 2025-01-14T17:47:39-03:00 DEBUG metabase.server.middleware.log POST /api/util/password_check 200 93ms (0 DB calls) App DB connections: 0/15 Jetty threads: 4/50 (3 idle, 0 queued) (116 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[f7d11035-4618-469b-bc23-9b0047233d7b] 2025-01-14T17:47:39-03:00 DEBUG metabase.server.middleware.log POST /api/util/password_check 200 66ms (0 DB calls) App DB connections: 0/15 Jetty threads: 3/50 (3 idle, 0 queued) (116 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[f7d11035-4618-469b-bc23-9b0047233d7b] 2025-01-14T17:47:42-03:00 DEBUG metabase.server.middleware.log POST /api/session/reset_password 200 318ms (17 DB calls) App DB connections: 1/15 Jetty threads: 3/50 (4 idle, 0 queued) (116 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
[f7d11035-4618-469b-bc23-9b0047233d7b] 2025-01-14T17:47:42-03:00 DEBUG metabase.server.middleware.log GET /api/session/properties 200 50ms (5 DB calls) App DB connections: 1/15 Jetty threads: 3/50 (4 idle, 0 queued) (116 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 104}
[f7d11035-4618-469b-bc23-9b0047233d7b] 2025-01-14T17:47:42-03:00 DEBUG metabase.server.middleware.log GET /api/user/current 200 41ms (16 DB calls) App DB connections: 0/15 Jetty threads: 3/50 (4 idle, 0 queued) (117 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 104}
[f7d11035-4618-469b-bc23-9b0047233d7b] 2025-01-14T17:47:43-03:00 DEBUG metabase.server.middleware.log GET /api/search 200 47ms (5 DB calls) App DB connections: 0/15 Jetty threads: 4/50 (2 idle, 0 queued) (117 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 104}
[f7d11035-4618-469b-bc23-9b0047233d7b] 2025-01-14T17:47:43-03:00 DEBUG metabase.server.middleware.log GET /api/database 200 71ms (5 DB calls) App DB connections: 0/15 Jetty threads: 3/50 (3 idle, 0 queued) (117 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 104}
[f7d11035-4618-469b-bc23-9b0047233d7b] 2025-01-14T17:48:19-03:00 DEBUG metabase.server.middleware.log GET /api/util/bug_report_details 200 5ms (1 DB calls) App DB connections: 0/15 Jetty threads: 3/50 (4 idle, 0 queued) (117 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id 1}
`

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""bigquery-cloud-sdk"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-07"",
      ""tag"": ""v0.52.5"",
      ""hash"": ""cc77eeb""
    },
    ""settings"": {
      ""report-timezone"": ""America/Sao_Paulo""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.8 (Debian 15.8-1.pgdg120+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.8.0-1021-aws"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

high

### Additional context

_No response_",lfalcao,2025-01-14 20:58:04+00:00,[],2025-02-05 19:00:13+00:00,,https://github.com/metabase/metabase/issues/52140,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Administration/Auth', 'Google Auth, LDAP, pw+email login'), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2591108273, 'issue_id': 2788267087, 'author': 'paoliniluis', 'body': ""I tried to reproduce this but I couldn't. I was able to reset the password of a new user"", 'created_at': datetime.datetime(2025, 1, 14, 21, 9, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2591124091, 'issue_id': 2788267087, 'author': 'npfitz', 'body': ""I'm also having trouble reproducing this. My guess is that the request from the browser to update the password is 404-ing, hence the Not Found in the response. Is there any information in the network tab that may help us out?"", 'created_at': datetime.datetime(2025, 1, 14, 21, 20, 31, tzinfo=datetime.timezone.utc)}, {'comment_id': 2592884552, 'issue_id': 2788267087, 'author': 'lfalcao', 'body': 'Thanks @paoliniluis and @npfitz for taking a look.\n\nI just discovered that the password was successfully changed, but it fails to retrieve the file at ""https://domain/app/locales/pt.json"" and gets stuck in the new password page. If I try to login with the new password it works.\n\n<img width=""749"" alt=""Image"" src=""https://github.com/user-attachments/assets/a1207bf3-3e5f-4ef0-8e47-0c56438f1af8"" />', 'created_at': datetime.datetime(2025, 1, 15, 13, 39, 17, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-14 21:09:57 UTC): I tried to reproduce this but I couldn't. I was able to reset the password of a new user

npfitz on (2025-01-14 21:20:31 UTC): I'm also having trouble reproducing this. My guess is that the request from the browser to update the password is 404-ing, hence the Not Found in the response. Is there any information in the network tab that may help us out?

lfalcao (Issue Creator) on (2025-01-15 13:39:17 UTC): Thanks @paoliniluis and @npfitz for taking a look.

I just discovered that the password was successfully changed, but it fails to retrieve the file at ""https://domain/app/locales/pt.json"" and gets stuck in the new password page. If I try to login with the new password it works.

<img width=""749"" alt=""Image"" src=""https://github.com/user-attachments/assets/a1207bf3-3e5f-4ef0-8e47-0c56438f1af8"" />

"
2788084201,issue,closed,completed,Create simple prototype,,rafpaf,2025-01-14 19:08:11+00:00,['rafpaf'],2025-01-17 16:35:27+00:00,2025-01-17 16:35:27+00:00,https://github.com/metabase/metabase/issues/52132,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]",[],
2788067630,issue,closed,completed,Prototype to evaluate feasibility of content localization,"[Content localization](https://linear.app/metabase-inc/project/content-localization-e1b1d2541f0c/overview)

- [X] Field values, column names in table viz
- [X] collection names, question names, dashboard names, dashboard tab names
- [ ] Viz settings: legends, axis, tooltips
- [ ] Dashboard text cards
- [X] Export / Import CSV interface

Out of scope for now

* Search
* Filtering and sorting
* Different translations for same string in different contexts
* In-product translations",rafpaf,2025-01-14 18:58:40+00:00,['rafpaf'],2025-01-20 17:57:18+00:00,2025-01-20 17:57:17+00:00,https://github.com/metabase/metabase/issues/52130,"[('.Epic', 'Feature Implementation or Project')]",[],
2788051330,issue,open,,Enhance Xrays to support multi-stage queries with filters after summarize,"Consider updating automagic dashboards / X-rays to support multi-stage queries, e.g. a query with a filter stage after breakouts / aggregations. This would allow us to enable the ""automatic insights"" drill thru for such queries, which is currently disabled. Related to #46932.

Note that the current automagic dashboards implementation has several places that it depends on the structure of the query and expects to find `:breakout`s and/or `:aggregations` at the top level, e.g.

```Clojure
(defn- table-like?
  [card-or-question]
  (and
   (nil? (get-in card-or-question [:dataset_query :query :aggregation]))
   (nil? (get-in card-or-question [:dataset_query :query :breakout]))))
```

As part of this work, it could make sense to first convert x-rays code from legacy MBQL to MBQLv2.



Slack thread

https://metaboat.slack.com/archives/C0645JP1W81/p1736540745810749
",appleby,2025-01-14 18:49:57+00:00,[],2025-02-04 20:30:45+00:00,,https://github.com/metabase/metabase/issues/52129,"[('Type:New Feature', ''), ('Querying/X-rays', ''), ('Querying/Drill Thrus', 'Refining existing queries with Drill Thrus'), ('.Team/Querying', '')]",[],
2787973779,issue,closed,completed,Sorting Generates Bad SQL when Time Granularity of Group by Field Changes,"### Describe the bug

If you build a question in BQ that groups a date and sort on it, it works. If you then change the time granularity of the group, invalid SQL is generated (whether you change the granularity before or after the sort is applied).

In Postgres and H2 you can also observe that we generate unexpected sort clauses but they don't cause the query to fail.

### To Reproduce

1. Run v52
2. Connect to BQ and create a simple question that count records on a group of date column
3. Sort results
4. Note that they work
5. Change time granularity on the group
6. Now preview records at the sort stage and note it fails

https://www.loom.com/share/5ec5698b2a214744bee508883777cf68

### Expected behavior

We should generate valid and correct SQL in this case

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-13"",
      ""tag"": ""v1.52.5.5"",
      ""hash"": ""e85b71b""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.1 (Debian 15.1-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.167.4-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

When usign teh GUI builder its very unclear to non SQL savvy users what's happening and the workaround isn't obvious

### Additional context

_No response_",ixipixi,2025-01-14 18:14:47+00:00,['wzimrin'],2025-01-20 22:59:20+00:00,2025-01-20 21:55:27+00:00,https://github.com/metabase/metabase/issues/52124,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/BigQuery', ''), ('.Backend', ''), ('Querying/', ''), ('.Team/Querying', '')]","[{'comment_id': 2592352454, 'issue_id': 2787973779, 'author': 'lbrdnk', 'body': ""The erroneous order by clause is added in [add-implicit-clauses middleware](https://github.com/metabase/metabase/blob/304e1077ee9c47336b3766e0665b05eea5ba7fa3/src/metabase/query_processor/middleware/add_implicit_clauses.clj#L187).\n\nI believe the problem we should be solving is missing `:original-temporal-unit` key from the order by's field ref. That is causing linked code to add another order by. Also, that presumably happens when initial breakout clause is replaced. In other words: replacement of breakout clause should ensure that references are updated accordingly. \n\nAlternatively, I thought of doing adjustments in the middleware namespace, ie. not to add new clause for the clauses different only by `:original-temporal-unit` but I believe that is no-go, because different sql is generated for those clauses on BigQuery."", 'created_at': datetime.datetime(2025, 1, 15, 11, 2, 51, tzinfo=datetime.timezone.utc)}, {'comment_id': 2592361905, 'issue_id': 2787973779, 'author': 'lbrdnk', 'body': 'Input to the middleware function:\n```\n{:source-table 25,\n :aggregation [[:count]],\n :breakout\n [[:field 250 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :month, :original-temporal-unit ""week""}]],\n :order-by [[:asc [:field 250 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :month}]]],\n :aggregation-idents {0 ""mluzgYL59NdAse5LiiCwU""},\n :breakout-idents {0 ""rOIK3ZeLWSUsSGS6iZ6wH""}}\n```\n\nIts return:\n```\n{:source-table 25,\n :aggregation [[:count]],\n :breakout\n [[:field 250 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :month, :original-temporal-unit ""week""}]],\n :order-by\n [[:asc [:field 250 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :month}]]\n  [:asc [:field 250 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :month, :original-temporal-unit ""week""}]]],\n :aggregation-idents {0 ""mluzgYL59NdAse5LiiCwU""},\n :breakout-idents {0 ""rOIK3ZeLWSUsSGS6iZ6wH""}}\n```', 'created_at': datetime.datetime(2025, 1, 15, 11, 4, 52, tzinfo=datetime.timezone.utc)}]","lbrdnk on (2025-01-15 11:02:51 UTC): The erroneous order by clause is added in [add-implicit-clauses middleware](https://github.com/metabase/metabase/blob/304e1077ee9c47336b3766e0665b05eea5ba7fa3/src/metabase/query_processor/middleware/add_implicit_clauses.clj#L187).

I believe the problem we should be solving is missing `:original-temporal-unit` key from the order by's field ref. That is causing linked code to add another order by. Also, that presumably happens when initial breakout clause is replaced. In other words: replacement of breakout clause should ensure that references are updated accordingly. 

Alternatively, I thought of doing adjustments in the middleware namespace, ie. not to add new clause for the clauses different only by `:original-temporal-unit` but I believe that is no-go, because different sql is generated for those clauses on BigQuery.

lbrdnk on (2025-01-15 11:04:52 UTC): Input to the middleware function:
```
{:source-table 25,
 :aggregation [[:count]],
 :breakout
 [[:field 250 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :month, :original-temporal-unit ""week""}]],
 :order-by [[:asc [:field 250 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :month}]]],
 :aggregation-idents {0 ""mluzgYL59NdAse5LiiCwU""},
 :breakout-idents {0 ""rOIK3ZeLWSUsSGS6iZ6wH""}}
```

Its return:
```
{:source-table 25,
 :aggregation [[:count]],
 :breakout
 [[:field 250 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :month, :original-temporal-unit ""week""}]],
 :order-by
 [[:asc [:field 250 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :month}]]
  [:asc [:field 250 {:base-type :type/DateTimeWithLocalTZ, :temporal-unit :month, :original-temporal-unit ""week""}]]],
 :aggregation-idents {0 ""mluzgYL59NdAse5LiiCwU""},
 :breakout-idents {0 ""rOIK3ZeLWSUsSGS6iZ6wH""}}
```

"
2787536038,issue,closed,completed,Uploading CSV file containing unicode characters to a ClickHouse database creates table with long URL-encoded name,"### Describe the bug

Uploading a CSV file named `سلام.csv` (basename has 4 graphemes encoded as 8 bytes) will create a table named `upload_%d8%b3%d9%84%d8%a7%d9%85_20250114151659` (46 bytes).  I.e. uploading a file with a relatively short name can cause the table name to be quite large.

This can cause ClickHouse table name length limits to be violated, causing problems executing operations on the database: In another example, a 19 grapheme (37 bytes) CSV file name ended up as a 131 bytes table name, which internally in ClickHouse operations ended up as a 203 byte file name, that eventually prevented database operations, cf. https://github.com/ClickHouse/ClickHouse/issues/64861#issuecomment-2586989564 and https://github.com/metabase/harbormaster/issues/5751.

To workaround this, is it possible to create the table with the original unicode name instead of URL-encoding it?

### To Reproduce

1. Connect a Metabase instance to a ClickHouse database and configure it for uploads
2. Create a file named `سلام.csv`
3. Upload the file through Metabase's ""Upload CSV"" button in the left side bar
4. Execute `SHOW TABLES IN [...]` in ClickHouse
5. Notice the table name `upload_%d8%b3%d9%84%d8%a7%d9%85_20250114151659`

### Expected behavior

Metabase encodes file names in a more space-efficient way.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64; rv:134.0) Gecko/20100101 Firefox/134.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""clickhouse"",
      ""h2"",
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""starter"",
    ""version"": {
      ""date"": ""2024-12-09"",
      ""tag"": ""v1.52.2.1"",
      ""hash"": ""35a4c28""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres""
  }
}
```

### Severity

Blocking some users

### Additional context

References: https://github.com/metabase/harbormaster/issues/5751
References: https://github.com/ClickHouse/ClickHouse/issues/64861",devurandom,2025-01-14 15:41:49+00:00,[],2025-01-24 15:10:09+00:00,2025-01-24 13:34:00+00:00,https://github.com/metabase/metabase/issues/52116,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Organization/Uploads', 'Direct data upload (CSV)')]","[{'comment_id': 2590320739, 'issue_id': 2787536038, 'author': 'crisptrutski', 'body': ""This is unfortunately expected behavior, which we cannot just change without breaking appends to existing tables. A bad choice made very early in the uploads project.\n\nPerhaps we're willing to break appends to old tables, or there's something smart we could do, e.g. migrating tables (break any direct access), tracking which version created the table (and knowing that untracked ones used the old scheme), having a fallback etc.\n\n@piranha @luizarakaki \n\nUpdate: I had a brain fart and was thinking about columns. I *think* we can change the table encoding scheme without breaking anything or needing other changes."", 'created_at': datetime.datetime(2025, 1, 14, 15, 54, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2590326565, 'issue_id': 2787536038, 'author': 'crisptrutski', 'body': 'Thinking back to past discussions we had internally on whether we should and could migrate to a better munging scheme, most complexity was actually around column names (they are also url encoded). Just changing it for table names is probably much simpler.', 'created_at': datetime.datetime(2025, 1, 14, 15, 56, 47, tzinfo=datetime.timezone.utc)}, {'comment_id': 2590583424, 'issue_id': 2787536038, 'author': 'dpsutton', 'body': 'thanks for the info. Short reproduction:\n\nFrom ui:\n\n```\n❯ cat سلام.csv\nid,words\n1,here are words\n2,and here are more%\n```\n\nAnd then upload this. Clickhouse is not required. \n\nEnd to end in the repl:\n\n```clojure\nupload=> (metabase.request.session/with-current-user 1\n           (let [table (create-csv-upload! {:collection-id nil\n                                            :filename ""سلام.csv""\n                                            :file (clojure.java.io/file ""/tmp/سلام.csv"")\n                                            :schema-name ""default""\n                                            :table-prefix ""upload_""\n                                            :db-id 14})]\n             (:name (t2/select-one :model/Table :id (:table_id table)))))\n""upload_%d8%b3%d9%84%d8%a7%d9%85_20250114170024""\n```\n\nAnd even shorter:\n\n```clojure\nupload=> (unique-table-name :postgres ""سلام"")\n""%D8%B3%D9%84%D8%A7%D9%85_20250114170048""\n```\n\nTo @crisptrutski \'s point about appending. I\'m not sure this is a problem?\n\nedit:\n\nFrom my read, when updating a csv we use the `(table-identifier table)` where `table` is from the app-db. And there we of course just use whatever we have in the db. Changing how we compute that should not break appending? (am i missing something?)\n\n```clojure\n(mu/defn table-identifier :- :string\n  ""Returns a string that can be used as a table identifier in SQL, including a schema if provided.""\n  [{:keys [schema name] :as _table}\n   :- [:map\n       [:schema {:optional true} [:maybe :string]]\n       [:name :string]]]\n  (if (str/blank? schema)\n    name\n    (str schema ""."" name)))\n```\n\nFor appending, we hit `http://localhost:3000/api/table/720/append-csv` whereas for creating new we use `http://localhost:3000/api/card/from-csv`. For appending to an existing table, we shouldn\'t be computing a name so we\'re not sensitive to changes? For creating from new we can of course fix the bug.', 'created_at': datetime.datetime(2025, 1, 14, 17, 4, 32, tzinfo=datetime.timezone.utc)}, {'comment_id': 2591017038, 'issue_id': 2787536038, 'author': 'crisptrutski', 'body': 'Yeah it looks like we just need to make sure that the canonical model for the upload points to the new table, and that the sync record for that table has `:is_upload` true. Easiest way to do this is to migrate the existing `metabase_table` row in the same script that renames the table, rather than letting a new scan record get created.', 'created_at': datetime.datetime(2025, 1, 14, 20, 14, 11, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2025-01-14 15:54:48 UTC): This is unfortunately expected behavior, which we cannot just change without breaking appends to existing tables. A bad choice made very early in the uploads project.

Perhaps we're willing to break appends to old tables, or there's something smart we could do, e.g. migrating tables (break any direct access), tracking which version created the table (and knowing that untracked ones used the old scheme), having a fallback etc.

@piranha @luizarakaki 

Update: I had a brain fart and was thinking about columns. I *think* we can change the table encoding scheme without breaking anything or needing other changes.

crisptrutski on (2025-01-14 15:56:47 UTC): Thinking back to past discussions we had internally on whether we should and could migrate to a better munging scheme, most complexity was actually around column names (they are also url encoded). Just changing it for table names is probably much simpler.

dpsutton on (2025-01-14 17:04:32 UTC): thanks for the info. Short reproduction:

From ui:

```
❯ cat سلام.csv
id,words
1,here are words
2,and here are more%
```

And then upload this. Clickhouse is not required. 

End to end in the repl:

```clojure
upload=> (metabase.request.session/with-current-user 1
           (let [table (create-csv-upload! {:collection-id nil
                                            :filename ""سلام.csv""
                                            :file (clojure.java.io/file ""/tmp/سلام.csv"")
                                            :schema-name ""default""
                                            :table-prefix ""upload_""
                                            :db-id 14})]
             (:name (t2/select-one :model/Table :id (:table_id table)))))
""upload_%d8%b3%d9%84%d8%a7%d9%85_20250114170024""
```

And even shorter:

```clojure
upload=> (unique-table-name :postgres ""سلام"")
""%D8%B3%D9%84%D8%A7%D9%85_20250114170048""
```

To @crisptrutski 's point about appending. I'm not sure this is a problem?

edit:

From my read, when updating a csv we use the `(table-identifier table)` where `table` is from the app-db. And there we of course just use whatever we have in the db. Changing how we compute that should not break appending? (am i missing something?)

```clojure
(mu/defn table-identifier :- :string
  ""Returns a string that can be used as a table identifier in SQL, including a schema if provided.""
  [{:keys [schema name] :as _table}
   :- [:map
       [:schema {:optional true} [:maybe :string]]
       [:name :string]]]
  (if (str/blank? schema)
    name
    (str schema ""."" name)))
```

For appending, we hit `http://localhost:3000/api/table/720/append-csv` whereas for creating new we use `http://localhost:3000/api/card/from-csv`. For appending to an existing table, we shouldn't be computing a name so we're not sensitive to changes? For creating from new we can of course fix the bug.

crisptrutski on (2025-01-14 20:14:11 UTC): Yeah it looks like we just need to make sure that the canonical model for the upload points to the new table, and that the sync record for that table has `:is_upload` true. Easiest way to do this is to migrate the existing `metabase_table` row in the same script that renames the table, rather than letting a new scan record get created.

"
2787303443,issue,closed,completed,Empty states for models,"- [product doc](https://www.notion.so/metabase/Empty-states-for-better-activation-pt-1-2a77f6fbe8e3461ab9fac4886de0ff09?pvs=4#5615143f0f1648e481c83d1735ac3fcd)
- [design](https://www.figma.com/design/ZPJPG7HQbSEMp4lvd8Dzwe/Empty-states?node-id=4272-1852&p=f&focus-id=4272-1853&m=dev)



",nemanjaglumac,2025-01-14 14:28:45+00:00,['nemanjaglumac'],2025-01-27 22:11:03+00:00,2025-01-21 23:36:54+00:00,https://github.com/metabase/metabase/issues/52106,"[('First Experience/Onboarding', '')]",[],
2787228526,issue,open,,You should be able to edit the filter values by double clicking on them on the notebook,"**Is your feature request related to a problem? Please describe.**
When you go to the notebook and use a ""contains"" filter, you should be able to double click on a selected value and edit it

![Image](https://github.com/user-attachments/assets/45f2074e-3340-4ea0-b10f-558cd356e456)

Otherwise you are forced to delete the value and add it again

**Describe the solution you'd like**
Double clicking on the value should allow the user to edit it

**Describe alternatives you've considered**
None

**How important is this feature to you?**

Ergonomics win

**Additional context**
NA
",paoliniluis,2025-01-14 14:06:28+00:00,[],2025-02-04 20:30:43+00:00,,https://github.com/metabase/metabase/issues/52103,"[('Type:New Feature', ''), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('Querying/Notebook', 'Items specific to the Custom/Notebook query builder'), ('.Team/Querying', '')]","[{'comment_id': 2590279274, 'issue_id': 2787228526, 'author': 'mngr', 'body': 'Thanks, yes, we have it in our plans', 'created_at': datetime.datetime(2025, 1, 14, 15, 39, 4, tzinfo=datetime.timezone.utc)}]","mngr on (2025-01-14 15:39:04 UTC): Thanks, yes, we have it in our plans

"
2787197689,issue,closed,completed,Invalid URLs for some png images when displayed inside Embedding SDK,"### Describe the bug

Some images, when displayed inside the Embedding SDK, are referenced by a path like `app/assets/img/pin.png`, which results in an invalid image URL.

Example:
`frontend/src/metabase/visualizations/components/LeafletMarkerPinMap.jsx`
```
iconUrl: ""app/assets/img/pin.png"",
```

I've also found another example that is reproducible in the Embedded SDK:
`frontend/src/metabase/visualizations/visualizations/Table.tsx`
```
<img
  width={99}
  src=""app/assets/img/hidden-field.png""
  srcSet=""
    app/assets/img/hidden-field.png     1x,
    app/assets/img/hidden-field@2x.png  2x
  ""
  className={CS.mb2}
/>
```

![Image](https://github.com/user-attachments/assets/7857ddf1-7eeb-4101-b1d7-8f5744782b6f)

### To Reproduce

For example, display a dashboard containing a map with the `pin.png` icons inside the Embedding SDK

### Expected behavior

Icons should be displayed ",sanex3339,2025-01-14 13:55:12+00:00,['sanex3339'],2025-01-20 07:44:48+00:00,2025-01-20 07:08:21+00:00,https://github.com/metabase/metabase/issues/52102,"[('Type:Bug', 'Product defects'), ('.Needs Triage', ''), ('.Team/Embedding', '')]",[],
2787137234,issue,open,,[Project] Empty states for better activation,"## About Project
The goal of this project is to provide useful educational content in various parts of the application (when the app is still fresh and the users are onboarding).

### Links

- [product doc](https://www.notion.so/metabase/Empty-states-for-better-activation-pt-1-2a77f6fbe8e3461ab9fac4886de0ff09?pvs=4)
- [figma](https://www.figma.com/design/ZPJPG7HQbSEMp4lvd8Dzwe/Empty-states?node-id=4174-1497&p=f&ready-for-dev=1&m=dev)

### Implementation Plan
It should be possible to treat individual tasks independent of each other as the boundaries are clean between different entities. Each will be listed as a separate (sub)-task under this project, and each will be merged individually.

#### Phase 1
- Models
- Dashboards
- Dashboard subscriptions

#### Phase 2 
- SQL editor (postponed until https://github.com/metabase/metabase/pull/51632 gets implemented)
- Alerts
- tbd",nemanjaglumac,2025-01-14 13:31:44+00:00,['nemanjaglumac'],2025-02-04 20:25:59+00:00,,https://github.com/metabase/metabase/issues/52099,"[('First Experience/Onboarding', ''), ('.Epic', 'Feature Implementation or Project')]",[],
2786928684,issue,closed,completed,Add a disclaimer for uploads to (H2) Sample Database,"[Product doc](https://www.notion.so/metabase/Update-the-legal-text-for-uploading-to-H2-database-on-Cloud-9304583ecfd242678334047a75809396?pvs=4)

## Task
Update the legal text for the warning that precedes enabling upload for our Sample database on Cloud. ",nemanjaglumac,2025-01-14 11:44:42+00:00,['nemanjaglumac'],2025-01-27 22:11:28+00:00,2025-01-16 17:06:51+00:00,https://github.com/metabase/metabase/issues/52094,"[('Organization/Uploads', 'Direct data upload (CSV)')]",[],
2786842807,issue,open,,Offer a way to understand users' interactions with dashboards - filter usage,"**Is your feature request related to a problem? Please describe.**

Currently the [Usage Analytics](https://www.metabase.com/docs/latest/usage-and-performance-tools/usage-analytics) shows basic metrics like daily user access per dashboard and so on. Nothing around how users are using the dashboards, selecting filters, ...

It appears that the required data is stored within the ""parameters"" list in the 'query' column of the Usage Analytics's Query Log model, which is formatted as a JSON object.

<img width=""1511"" alt=""Image"" src=""https://github.com/user-attachments/assets/1fdc3a04-72a3-401f-b80f-dc5cc63e1c95"" />

Currently there is a limitation with JSON functions for strings and a restriction on executing custom SQL against the Usage Analytics database. So you just cannot extract anything via the Usage Analytics on this matter even though the data is there!!

**Describe the solution you'd like**

Ability to show filter values customers use most frequently on specific dashboards via the Usage Analytics

**Describe alternatives you've considered**
Skip the Usage Analytics and query directly the Application Database. For Cloud Customers this is something they are not able to do 

**Additional context**
Might be related to https://github.com/metabase/metabase/issues/49461",Tony-metabase,2025-01-14 10:59:18+00:00,[],2025-02-04 20:30:50+00:00,,https://github.com/metabase/metabase/issues/52092,"[('Type:New Feature', ''), ('Administration/Usage analytics', 'Pro and Enterprise meta analytics, fka audit')]",[],
2786634346,issue,open,,Text overflowing in relative datepicker dropdown,"### Describe the bug

![Image](https://github.com/user-attachments/assets/d1a2a72b-c27b-4454-a88d-a3ff89e3330e)

### To Reproduce

1. New > Dashboard
2. Add date filter
3. Set default value to ""Previous 3 months""
4. Click to edit default value again
5. Add ""Starting from...""

❌ Notice that the word ""ago"" is broken into multiple lines in the first 2 options

6. Set it to 3 years ago

❌ Notice that the word ""ago"" is cut off in the dropdown value - ellipsis should be applied

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
master, 18f4ba60fff883acaaf0e3d84850bbcb1ca08c5f
```

### Severity

P3

### Additional context

_No response_",kamilmielnik,2025-01-14 09:17:03+00:00,[],2025-02-04 20:29:43+00:00,,https://github.com/metabase/metabase/issues/52090,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Team/Querying', ''), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]",[],
2786626460,issue,closed,completed,Metabase logo is cut and the proportions are off,"### Describe the bug

I'm seeing this in Chrome/Arc on a 14"" Macbook. Metabase logo is cut on the right side. Also, it seems like the proportions are off, the height should be different. Instead of 24x32px it should be 24x29.12px if we follow the exact proportions from [the original file](https://drive.google.com/file/d/15IhEeZM7uTSvvqeUey1FHXE_DmkLL2JB/view?usp=drive_link).
![Image](https://github.com/user-attachments/assets/f8a8fbf4-c22f-4a9b-877b-14096a90cd2c)

### To Reproduce

1. Open Metabase.
2. You should be able to see the logo ;) 


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
.
```

### Severity

Annoying 

### Additional context

_No response_",jrayski,2025-01-14 09:13:06+00:00,[],2025-01-30 21:25:46+00:00,2025-01-30 21:25:46+00:00,https://github.com/metabase/metabase/issues/52089,"[('Type:Bug', 'Product defects'), ('Type:UX', ''), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2622179339, 'issue_id': 2786626460, 'author': 'npfitz', 'body': ""@jrayski I'm updating the icon SVG to the one you linked here, though I don't really know what to do about the sizing part. We have some logic that allows folks to use their own logos, and we cap them at 32px in height (but not width). On my screen, I don't see the clipping issue you do, so I'm hoping that updating to the new SVG (which has a different viewbox) will help"", 'created_at': datetime.datetime(2025, 1, 29, 16, 49, 22, tzinfo=datetime.timezone.utc)}]","npfitz on (2025-01-29 16:49:22 UTC): @jrayski I'm updating the icon SVG to the one you linked here, though I don't really know what to do about the sizing part. We have some logic that allows folks to use their own logos, and we cap them at 32px in height (but not width). On my screen, I don't see the clipping issue you do, so I'm hoping that updating to the new SVG (which has a different viewbox) will help

"
2786614095,issue,open,,Incorrect noun capitalization in filter display name,"### Describe the bug

Original report: https://github.com/metabase/metabase/pull/51995#discussion_r1912897202

![Image](https://github.com/user-attachments/assets/2bc19fc9-5dad-4fe7-94cc-a1404793220c)

### To Reproduce

1. New > Dashboard
2. Add date filter
3. Set default value to ""Previous 3 months""

❌ The default value is shown as ""Previous 3 Months"" - it should be ""Previous 3 months""

4. Click to edit default value again
5. Add ""Starting from..."" , set it to 3 years ago, and ""Update filter""

❌ The default value is shown as ""Previous 3 Months, starting 3 years ago"" - it should be ""Previous 3 months, starting 3 years ago""


### Information about your Metabase installation

master, 18f4ba60fff883acaaf0e3d84850bbcb1ca08c5f

### Severity

P3
",kamilmielnik,2025-01-14 09:06:45+00:00,[],2025-02-04 20:27:56+00:00,,https://github.com/metabase/metabase/issues/52088,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/Processor', ''), ('Difficulty:Easy', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2786493047,issue,closed,duplicate,"After exporting to a PDF file, the overall position of the map is misaligned.","### Describe the bug

After exporting to a PDF file, the overall position of the map is misaligned.

![Image](https://github.com/user-attachments/assets/691d5529-d57e-4e2c-9f63-2f8873cfa7f8)

[map_test.pdf](https://github.com/user-attachments/files/18407172/map_test.pdf)

### To Reproduce

Using the attached GeoJSON file to add a map, viewing it on the web page appears normal. However, after exporting to a PDF and opening it for review, you will notice that the overall position of the map is misaligned in the exported file.

[us-states.json](https://github.com/user-attachments/files/18407174/us-states.json)

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""mysql""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-07"",
      ""tag"": ""v0.52.5"",
      ""hash"": ""cc77eeb""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MySQL"",
        ""version"": ""8.4.0""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.7.9-200.fc39.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

General serious fault

### Additional context

_No response_",Afanwf,2025-01-14 08:00:06+00:00,[],2025-01-14 17:27:03+00:00,2025-01-14 17:27:01+00:00,https://github.com/metabase/metabase/issues/52085,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Maps', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2590637721, 'issue_id': 2786493047, 'author': 'alxnddr', 'body': 'Duplicate of https://github.com/metabase/metabase/issues/34753', 'created_at': datetime.datetime(2025, 1, 14, 17, 27, 1, tzinfo=datetime.timezone.utc)}]","alxnddr on (2025-01-14 17:27:01 UTC): Duplicate of https://github.com/metabase/metabase/issues/34753

"
2785650192,issue,open,,Can't open archived model used in question,"### Describe the bug

I have a question using an archived model. In the breadcrumb, it will show the archived model with a warning triangle, but the model isn't clickable. 

Can we restore the link to archived models? It is convenient to be able to open it and unarchive -- for admin. 

### To Reproduce

1. Create question using a model
2. Archive the model
3. Go back to question and there is a warning, but no way to get to the model anymore as link isn't clickable under question title. 


### Expected behavior

Archived model needs to be clickable -- at least for admins so they can be unarchived. 

### Logs

_No response_

### Information about your Metabase installation

```JSON
master @ Postgres
```

### Severity

Can't easily find / unarchive unless you know how to find things in trash (not obvious)

### Additional context

_No response_",maxzheng,2025-01-13 22:51:39+00:00,['npfitz'],2025-02-05 21:57:02+00:00,,https://github.com/metabase/metabase/issues/52071,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Administration/', ''), ('Organization/Trash', 'Where deleted items go'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2785560597,issue,closed,completed,make gsheets-uploaded tables listed in /api/ee/upload-management/tables,Include tables with is_gsheets in the `/api/ee/upload-management/tables` endpoint.,escherize,2025-01-13 22:08:57+00:00,[],2025-01-15 23:28:05+00:00,2025-01-15 23:28:02+00:00,https://github.com/metabase/metabase/issues/52067,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]","[{'comment_id': 2594143056, 'issue_id': 2785560597, 'author': 'escherize', 'body': 'closed by [#52145](https://github.com/metabase/metabase/pull/52145)', 'created_at': datetime.datetime(2025, 1, 15, 23, 28, 2, tzinfo=datetime.timezone.utc)}]","escherize (Issue Creator) on (2025-01-15 23:28:02 UTC): closed by [#52145](https://github.com/metabase/metabase/pull/52145)

"
2785297086,issue,open,,Deep linking stacktrace frame to VSCode,"https://stackoverflow.com/questions/48641921/is-it-possible-to-use-the-vscode-hyperlink-to-open-a-file-or-directory-in-code

We could potentially allow people to set (once and store it in local storage) their workspace path and deeplink stack traces to their VSCode instance instead of GH 🤓 ",thebiglabasky,2025-01-13 20:21:02+00:00,[],2025-01-13 20:21:02+00:00,,https://github.com/metabase/metabase/issues/52058,[],[],
2785054693,issue,open,,Automate documentation of driver features,"**Is your feature request related to a problem? Please describe.**
We got two documents with driver feature descriptions
- [db tierlist
](https://www.notion.so/metabase/Database-Tiers-for-Feature-Development-fabba4d2bbfb4c729029f5e77d585f61)
- [public] [db features for 3rd-party developers](https://www.notion.so/metabase/Driver-feature-flags-2018c687047343b48f545e839d9948b3)

Given the pace we are adding and changing features, we won't be able to keep them up-to-date manually.

**Describe the solution you'd like**
An automation to update these docs or at least notify the Driver team when they need to be updated.

**Describe alternatives you've considered**
Continue the manula updates

**How important is this feature to you?**
Important to help 3rd-party developers and also communicate database support levels internally
",luizarakaki,2025-01-13 19:08:00+00:00,[],2025-02-04 20:30:36+00:00,,https://github.com/metabase/metabase/issues/52053,"[('Database/', ''), ('Type:New Feature', ''), ('.Team/Drivers', '')]",[],
2785014688,issue,open,,Metabase Backend Service Account Flow Updates,"We've moving from OAuth to using service accounts. There will need to be some changes to the backend.

The Service Account should be setup without MB needing to do anything. That removes the OAuth setup part of the flow, and simplifies things on the MB side a lot

We will need to change the way we track the status of the folder connection.

## Setup flow changes:

We no longer need a temp-url, etc.
- [x] remove temp-url

MB will assume that there’s a service account setup for the instance.
The state-tracking we do will now track the status of the Gdrive sync Folder


----

### BE <-> HM routes:

- [x] Rename:
/connections-google-oauth/service-account -> /connections-google/service-account


- [x] `GET /api/v2/mb/connections-google/service-account`
Returns `{""email"": ""<sa-email>""} when the service account is found (which it should be).

- [x] `DELETE /api/v2/mb/connections/:conn-id`
returns OK when the delete worked

-----

### FE<->MB routes:

All these routes return a message key in the json-encoded response body on any errors with a reasonable message.

- [x] `GET api/ee/gsheets/service-account`
when the sa is setup, this returns {email: ""the-email""}
if the sa is Not setup, this returns a 404 (which shouldn't happen afaik)

- [x] `POST api/ee/gsheets/folder`
on success, 200
on error, pass through error code and an error message from HM

- [x] `DELETE api/ee/gsheets/folder`
on success, 200
on error, pass through error code and an error message from HM
- possible errors:
    - `No gdrive connections found.`
        - when the google drive connection id cannot be found
    - `Unable to disconnect google service account`
        - when the delete call to hm with the google drive connection id fails

- [x] update gsheets setting to track gdrive folder sync
    The Folder status will be held in the gsheets setting:
``` json

{
""folder_url"": ""abcsheets.com"",
""email"": ""service_account@email.com""
""status"": ""connected"" | ""not-connected""
}
```


",escherize,2025-01-13 18:55:12+00:00,['escherize'],2025-02-04 20:23:54+00:00,,https://github.com/metabase/metabase/issues/52050,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template')]","[{'comment_id': 2612817819, 'issue_id': 2785014688, 'author': 'trinya', 'body': '@escherize can we call this done? cleaning up the milestone status', 'created_at': datetime.datetime(2025, 1, 24, 15, 36, 17, tzinfo=datetime.timezone.utc)}]","trinya on (2025-01-24 15:36:17 UTC): @escherize can we call this done? cleaning up the milestone status

"
2784693553,issue,closed,completed,Feature exclusion for Materialize,"Go through https://github.com/MaterializeInc/metabase-materialize-driver/pull/60/files#diff-ae5393c6f61a44e4c56da930c73452ed7c0c33154da3354d557899bbb7908550 and ensure we have feature flag exclusion as necessary for anything in the diff.

test/metabase/db/metadata_queries_test.clj
- `table-rows-sample-test`

test/metabase/query_processor_test/date_bucketing_test.clj
- `(not= driver :oracle)` is used

metabase/test/data/dataset_definition_test.clj
- `dataset-with-custom-pk-test` should probably exclude `:metadata/key-constraints`",snoe,2025-01-13 17:19:57+00:00,['rileythomp'],2025-01-31 15:43:33+00:00,2025-01-30 15:37:57+00:00,https://github.com/metabase/metabase/issues/52045,[],"[{'comment_id': 2627652694, 'issue_id': 2784693553, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)', 'created_at': datetime.datetime(2025, 1, 31, 15, 43, 32, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-01-31 15:43:32 UTC): 🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)

"
2784664075,issue,closed,completed,Date/Time Fields Missing from Tooltips in Bar and Line Charts,"### Describe the bug

After updating to Metabase v52, the tooltips for bar and line charts no longer display the date/time fields as they did in previous versions. This functionality was crucial for providing detailed context when analyzing data in the visualizations.

### To Reproduce

Steps to reproduce the behavior:

Create a bar or line chart in Metabase with a date/time field in the query.
Hover over the chart to view the tooltip.
Notice that the date/time fields are missing in the tooltip.


### Expected behavior

Expected behavior
The date/time fields should appear in the tooltips as they did in earlier versions, allowing users to easily identify the exact data point being represented.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-07"",
      ""tag"": ""v0.52.5"",
      ""hash"": ""cc77eeb""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Zurich""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.3 (Debian 15.3-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.8.12-4-pve"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

This issue has disrupted workflows that rely on tooltips for analyzing time-based data. It would be helpful to understand whether there's an alternative approach to achieve similar functionality.

### Additional context

_No response_",arditm,2025-01-13 17:09:37+00:00,[],2025-01-27 22:11:12+00:00,2025-01-21 15:29:14+00:00,https://github.com/metabase/metabase/issues/52043,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('Visualization/Tooltips', '')]",[],
2784590051,issue,open,,Missing columns when download data from dashboard (when columns have null values),"### Describe the bug

When I download a table from the dashboard, only 35 columns are included. However, when downloading directly from the question, all columns are present in the file.

### To Reproduce

1. Go to a dashboard with one table
2. Click on 'download results'
3. XLSX formated


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""pt-BR"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mysql"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-self-hosted-yearly"",
    ""version"": {
      ""date"": ""2024-12-21"",
      ""tag"": ""v1.52.4"",
      ""hash"": ""2f8c560""
    },
    ""settings"": {
      ""report-timezone"": ""America/Sao_Paulo""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.7""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.90+"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

P1

### Additional context

_No response_",fer-batista,2025-01-13 16:45:56+00:00,[],2025-02-04 20:31:32+00:00,,https://github.com/metabase/metabase/issues/52041,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Export', ''), ('Difficulty:Medium', ''), ('.Backend', ''), ('Visualization/Download', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2588315054, 'issue_id': 2784590051, 'author': 'npfitz', 'body': ""Hey @fer-batista, I don't seem to be able to re-pro the issue. Can you confirm that you don't have any filters active on your dashboard? They will be applied when exporting data"", 'created_at': datetime.datetime(2025, 1, 13, 22, 2, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2589756315, 'issue_id': 2784590051, 'author': 'fer-batista', 'body': '@npfitz Hey!\nI only have filters on the dashboard. But for these extractions I am not applying them.\nI tried to create a new dashboard without filters and the issue persists.\nThe file is downloaded with up to 35 columns. Have you tried with +35 columns?', 'created_at': datetime.datetime(2025, 1, 14, 12, 13, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2591142284, 'issue_id': 2784590051, 'author': 'npfitz', 'body': ""My apologies! I had read this as 35 rows, not columns.\n\nI just tried testing with a very large dataset though, and I'm able to get +35 columns with both. Just to double check something else, can you confirm that you don't have any columns hidden in the dashcard? The viz settings applied on the dashboard will take effect when exporting from the dashboard view, and may be different from what's on the source question.\n\n![Image](https://github.com/user-attachments/assets/4b35541e-e516-4e7d-8e3b-164483b0581c)"", 'created_at': datetime.datetime(2025, 1, 14, 21, 32, 17, tzinfo=datetime.timezone.utc)}, {'comment_id': 2593410004, 'issue_id': 2784590051, 'author': 'fer-batista', 'body': '@npfitz Heey!\nThe root cause of the problem lies in the next column (position 36), which contains a significant number of null values. This caused the export process to fail at that point. I resolved the issue by moving this column to a different position, allowing all columns to be successfully downloaded.', 'created_at': datetime.datetime(2025, 1, 15, 16, 38, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2593645847, 'issue_id': 2784590051, 'author': 'paoliniluis', 'body': '@fer-batista so you can confirm that if a column has nulls then the process will skip those columns? is that correct?', 'created_at': datetime.datetime(2025, 1, 15, 18, 18, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2593681981, 'issue_id': 2784590051, 'author': 'fer-batista', 'body': '@paoliniluis in my case most of the values \u200b\u200bwere null so the download skipped that column and the next one. It worked when I changed the column positions.', 'created_at': datetime.datetime(2025, 1, 15, 18, 38, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2602830427, 'issue_id': 2784590051, 'author': 'noahmoss', 'body': ""@fer-batista I'm taking a look, but I'm not able to reproduce on Postgres with 36 columns, where all columns have 20,000 rows and the 36th column has all (or a majority) NULLs.\n\nAny of the following details would help debug:\n* What DBMS are you querying?\n* How many rows total are you exporting?\n* How many columns total are in the table?\n* What % of rows in the missing columns are NULL?\n* Does this only reproduce for XLSX exports, or also CSV and JSON exports?\n* Is there anything else you can share about the types of data in the table?"", 'created_at': datetime.datetime(2025, 1, 20, 16, 22, 43, tzinfo=datetime.timezone.utc)}]","npfitz on (2025-01-13 22:02:25 UTC): Hey @fer-batista, I don't seem to be able to re-pro the issue. Can you confirm that you don't have any filters active on your dashboard? They will be applied when exporting data

fer-batista (Issue Creator) on (2025-01-14 12:13:08 UTC): @npfitz Hey!
I only have filters on the dashboard. But for these extractions I am not applying them.
I tried to create a new dashboard without filters and the issue persists.
The file is downloaded with up to 35 columns. Have you tried with +35 columns?

npfitz on (2025-01-14 21:32:17 UTC): My apologies! I had read this as 35 rows, not columns.

I just tried testing with a very large dataset though, and I'm able to get +35 columns with both. Just to double check something else, can you confirm that you don't have any columns hidden in the dashcard? The viz settings applied on the dashboard will take effect when exporting from the dashboard view, and may be different from what's on the source question.

![Image](https://github.com/user-attachments/assets/4b35541e-e516-4e7d-8e3b-164483b0581c)

fer-batista (Issue Creator) on (2025-01-15 16:38:09 UTC): @npfitz Heey!
The root cause of the problem lies in the next column (position 36), which contains a significant number of null values. This caused the export process to fail at that point. I resolved the issue by moving this column to a different position, allowing all columns to be successfully downloaded.

paoliniluis on (2025-01-15 18:18:52 UTC): @fer-batista so you can confirm that if a column has nulls then the process will skip those columns? is that correct?

fer-batista (Issue Creator) on (2025-01-15 18:38:45 UTC): @paoliniluis in my case most of the values ​​were null so the download skipped that column and the next one. It worked when I changed the column positions.

noahmoss on (2025-01-20 16:22:43 UTC): @fer-batista I'm taking a look, but I'm not able to reproduce on Postgres with 36 columns, where all columns have 20,000 rows and the 36th column has all (or a majority) NULLs.

Any of the following details would help debug:
* What DBMS are you querying?
* How many rows total are you exporting?
* How many columns total are in the table?
* What % of rows in the missing columns are NULL?
* Does this only reproduce for XLSX exports, or also CSV and JSON exports?
* Is there anything else you can share about the types of data in the table?

"
2784391789,issue,closed,completed,Wrong start of the week day,"### Describe the bug

Hello,

When setting up the first day of the week as Monday, when grouping the date, the week starts on Tuesday instead of Monday.
Both the JVM and MB have the same timezone. cc @slvrtrn 

### To Reproduce

1. Set ""First day of the week"" in Metabase as ""Monday"" 

<img width=""979"" alt=""Image"" src=""https://github.com/user-attachments/assets/aaffd39c-9206-4c93-9938-4de6194af75f"" />

2. Group data by week in the GUI
3. Display the data

<img width=""266"" alt=""Image"" src=""https://github.com/user-attachments/assets/10384738-bf40-44ad-99f7-7e0f3b20af8a"" />


### Expected behavior

For example the data should display ""janvier 6 2025, janvier 12 2025"" instead of ""janvier 7 2025, janvier 13 2025""

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""fr-FR"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""sqlserver""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-07"",
      ""tag"": ""v0.52.5"",
      ""hash"": ""cc77eeb""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Paris""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.2""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.4.0-200-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Paris""
  }
}
```

### Severity

It is blocking our head of CSM for her daily reports

### Additional context

_No response_",tlabetup,2025-01-13 15:43:46+00:00,['wzimrin'],2025-01-28 11:27:45+00:00,2025-01-28 10:47:18+00:00,https://github.com/metabase/metabase/issues/52035,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Database/SQLServer', None), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2605736531, 'issue_id': 2784391789, 'author': 'ranquild', 'body': ""@tlabetup I wasn't able to reproduce the issue. Could you provide data from `/api/card/:id/query` endpoint containing the wrong dates? They should be in `data.rows` property of the response body. You could see this request in the network tab in browser developer tools."", 'created_at': datetime.datetime(2025, 1, 21, 21, 4, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2606807205, 'issue_id': 2784391789, 'author': 'tlabetup', 'body': 'Here is the data @ranquild :\n\n""2024-03-26T00:00:00+01:00"",\n            158\n         ],\n         [\n            ""2024-04-02T00:00:00+01:00"",\n            347\n         ],\n         [\n            ""2024-04-09T00:00:00+01:00"",\n            366\n         ],\n         [\n            ""2024-04-16T00:00:00+01:00"",\n            338\n         ],\n         [\n            ""2024-04-23T00:00:00+01:00"",\n            368\n         ],\n         [\n            ""2024-04-30T00:00:00+01:00"",\n            338\n         ],\n         [\n            ""2024-05-07T00:00:00+01:00"",\n            226\n         ],\n         [\n            ""2024-05-14T00:00:00+01:00"",\n            331\n         ],\n         [\n            ""2024-05-21T00:00:00+01:00"",\n            389\n         ],\n         [\n            ""2024-05-28T00:00:00+01:00"",\n            422\n         ],\n         [\n            ""2024-06-04T00:00:00+01:00"",\n            419\n         ],\n         [\n            ""2024-06-11T00:00:00+01:00"",\n            405\n         ],\n         [\n            ""2024-06-18T00:00:00+01:00"",\n            396\n         ],\n         [\n            ""2024-06-25T00:00:00+01:00"",\n            411\n         ],\n         [\n            ""2024-07-02T00:00:00+01:00"",\n            413\n         ],\n         [\n            ""2024-07-09T00:00:00+01:00"",\n            442\n         ],\n         [\n            ""2024-07-16T00:00:00+01:00"",\n            403\n         ],\n         [\n            ""2024-07-23T00:00:00+01:00"",\n            382\n         ],\n         [\n            ""2024-07-30T00:00:00+01:00"",\n            334\n         ],\n         [\n            ""2024-08-06T00:00:00+01:00"",\n            256\n         ],\n         [\n            ""2024-08-13T00:00:00+01:00"",\n            237\n         ],\n         [\n            ""2024-08-20T00:00:00+01:00"",\n            339\n         ],\n         [\n            ""2024-08-27T00:00:00+01:00"",\n            471\n         ],\n         [\n            ""2024-09-03T00:00:00+01:00"",\n            498\n         ],\n         [\n            ""2024-09-10T00:00:00+01:00"",\n            506\n         ],\n         [\n            ""2024-09-17T00:00:00+01:00"",\n            511\n         ],\n         [\n            ""2024-09-24T00:00:00+01:00"",\n            481\n         ],\n         [\n            ""2024-10-01T00:00:00+01:00"",\n            501\n         ],\n         [\n            ""2024-10-08T00:00:00+01:00"",\n            519\n         ],\n         [\n            ""2024-10-15T00:00:00+01:00"",\n            520\n         ],\n         [\n            ""2024-10-22T00:00:00+01:00"",\n            537\n         ],\n         [\n            ""2024-10-29T00:00:00+01:00"",\n            478\n         ],\n         [\n            ""2024-11-05T00:00:00+01:00"",\n            491\n         ],\n         [\n            ""2024-11-12T00:00:00+01:00"",\n            546\n         ],\n         [\n            ""2024-11-19T00:00:00+01:00"",\n            535\n         ],\n         [\n            ""2024-11-26T00:00:00+01:00"",\n            551\n         ],\n         [\n            ""2024-12-03T00:00:00+01:00"",\n            524\n         ],\n         [\n            ""2024-12-10T00:00:00+01:00"",\n            545\n         ],\n         [\n            ""2024-12-17T00:00:00+01:00"",\n            469\n         ],\n         [\n            ""2024-12-24T00:00:00+01:00"",\n            196\n         ],\n         [\n            ""2024-12-31T00:00:00+01:00"",\n            349\n         ],\n         [\n            ""2025-01-07T00:00:00+01:00"",\n            538\n         ],\n         [\n            ""2025-01-14T00:00:00+01:00"",\n            514\n         ],\n         [\n            ""2025-01-21T00:00:00+01:00"",\n            165\n         ]', 'created_at': datetime.datetime(2025, 1, 22, 10, 7, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2608112681, 'issue_id': 2784391789, 'author': 'ranquild', 'body': ""So it's actually a BE issue then - the dates are already incorrect in the query results."", 'created_at': datetime.datetime(2025, 1, 22, 19, 39, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2608601281, 'issue_id': 2784391789, 'author': 'wzimrin', 'body': 'Is it possible that the database is set to the wrong timezone?  Also, did this query ever work, or is this the first time you are trying to run a question like this?', 'created_at': datetime.datetime(2025, 1, 23, 0, 49, 39, tzinfo=datetime.timezone.utc)}, {'comment_id': 2609107971, 'issue_id': 2784391789, 'author': 'tlabetup', 'body': 'Yes indeed it\'s a BE issue and the issue comes from the auto-generated SQL request, using the UI interface @wzimrin :\n\n<img width=""744"" alt=""Image"" src=""https://github.com/user-attachments/assets/016b8042-d3da-4612-b19e-c4b881fdb697"" />\n\nSELECT\n  DATEADD(\n    day,\n    1,\n    CAST(\n      DATEADD(\n        day,\n        (\n          1 - DATEPART(\n            weekday,\n            DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"")\n          )\n        ),\n        CAST(\n          DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"") AS date\n        )\n      ) AS datetime\n    )\n  ) AS ""DateSession"",\n  COUNT(*) AS ""count""\nFROM\n  ""BI"".""SessionAuteurs""\nGROUP BY\n  DATEADD(\n    day,\n    1,\n    CAST(\n      DATEADD(\n        day,\n        (\n          1 - DATEPART(\n            weekday,\n            DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"")\n          )\n        ),\n        CAST(\n          DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"") AS date\n        )\n      ) AS datetime\n    )\n  )\nORDER BY\n  DATEADD(\n    day,\n    1,\n    CAST(\n      DATEADD(\n        day,\n        (\n          1 - DATEPART(\n            weekday,\n            DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"")\n          )\n        ),\n        CAST(\n          DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"") AS date\n        )\n      ) AS datetime\n    )\n  ) ASC', 'created_at': datetime.datetime(2025, 1, 23, 8, 6, 26, tzinfo=datetime.timezone.utc)}, {'comment_id': 2610410975, 'issue_id': 2784391789, 'author': 'wzimrin', 'body': 'Also, to confirm: it looks like you are running sql server, correct?', 'created_at': datetime.datetime(2025, 1, 23, 16, 53, 31, tzinfo=datetime.timezone.utc)}]","ranquild on (2025-01-21 21:04:43 UTC): @tlabetup I wasn't able to reproduce the issue. Could you provide data from `/api/card/:id/query` endpoint containing the wrong dates? They should be in `data.rows` property of the response body. You could see this request in the network tab in browser developer tools.

tlabetup (Issue Creator) on (2025-01-22 10:07:36 UTC): Here is the data @ranquild :

""2024-03-26T00:00:00+01:00"",
            158
         ],
         [
            ""2024-04-02T00:00:00+01:00"",
            347
         ],
         [
            ""2024-04-09T00:00:00+01:00"",
            366
         ],
         [
            ""2024-04-16T00:00:00+01:00"",
            338
         ],
         [
            ""2024-04-23T00:00:00+01:00"",
            368
         ],
         [
            ""2024-04-30T00:00:00+01:00"",
            338
         ],
         [
            ""2024-05-07T00:00:00+01:00"",
            226
         ],
         [
            ""2024-05-14T00:00:00+01:00"",
            331
         ],
         [
            ""2024-05-21T00:00:00+01:00"",
            389
         ],
         [
            ""2024-05-28T00:00:00+01:00"",
            422
         ],
         [
            ""2024-06-04T00:00:00+01:00"",
            419
         ],
         [
            ""2024-06-11T00:00:00+01:00"",
            405
         ],
         [
            ""2024-06-18T00:00:00+01:00"",
            396
         ],
         [
            ""2024-06-25T00:00:00+01:00"",
            411
         ],
         [
            ""2024-07-02T00:00:00+01:00"",
            413
         ],
         [
            ""2024-07-09T00:00:00+01:00"",
            442
         ],
         [
            ""2024-07-16T00:00:00+01:00"",
            403
         ],
         [
            ""2024-07-23T00:00:00+01:00"",
            382
         ],
         [
            ""2024-07-30T00:00:00+01:00"",
            334
         ],
         [
            ""2024-08-06T00:00:00+01:00"",
            256
         ],
         [
            ""2024-08-13T00:00:00+01:00"",
            237
         ],
         [
            ""2024-08-20T00:00:00+01:00"",
            339
         ],
         [
            ""2024-08-27T00:00:00+01:00"",
            471
         ],
         [
            ""2024-09-03T00:00:00+01:00"",
            498
         ],
         [
            ""2024-09-10T00:00:00+01:00"",
            506
         ],
         [
            ""2024-09-17T00:00:00+01:00"",
            511
         ],
         [
            ""2024-09-24T00:00:00+01:00"",
            481
         ],
         [
            ""2024-10-01T00:00:00+01:00"",
            501
         ],
         [
            ""2024-10-08T00:00:00+01:00"",
            519
         ],
         [
            ""2024-10-15T00:00:00+01:00"",
            520
         ],
         [
            ""2024-10-22T00:00:00+01:00"",
            537
         ],
         [
            ""2024-10-29T00:00:00+01:00"",
            478
         ],
         [
            ""2024-11-05T00:00:00+01:00"",
            491
         ],
         [
            ""2024-11-12T00:00:00+01:00"",
            546
         ],
         [
            ""2024-11-19T00:00:00+01:00"",
            535
         ],
         [
            ""2024-11-26T00:00:00+01:00"",
            551
         ],
         [
            ""2024-12-03T00:00:00+01:00"",
            524
         ],
         [
            ""2024-12-10T00:00:00+01:00"",
            545
         ],
         [
            ""2024-12-17T00:00:00+01:00"",
            469
         ],
         [
            ""2024-12-24T00:00:00+01:00"",
            196
         ],
         [
            ""2024-12-31T00:00:00+01:00"",
            349
         ],
         [
            ""2025-01-07T00:00:00+01:00"",
            538
         ],
         [
            ""2025-01-14T00:00:00+01:00"",
            514
         ],
         [
            ""2025-01-21T00:00:00+01:00"",
            165
         ]

ranquild on (2025-01-22 19:39:39 UTC): So it's actually a BE issue then - the dates are already incorrect in the query results.

wzimrin (Assginee) on (2025-01-23 00:49:39 UTC): Is it possible that the database is set to the wrong timezone?  Also, did this query ever work, or is this the first time you are trying to run a question like this?

tlabetup (Issue Creator) on (2025-01-23 08:06:26 UTC): Yes indeed it's a BE issue and the issue comes from the auto-generated SQL request, using the UI interface @wzimrin :

<img width=""744"" alt=""Image"" src=""https://github.com/user-attachments/assets/016b8042-d3da-4612-b19e-c4b881fdb697"" />

SELECT
  DATEADD(
    day,
    1,
    CAST(
      DATEADD(
        day,
        (
          1 - DATEPART(
            weekday,
            DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"")
          )
        ),
        CAST(
          DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"") AS date
        )
      ) AS datetime
    )
  ) AS ""DateSession"",
  COUNT(*) AS ""count""
FROM
  ""BI"".""SessionAuteurs""
GROUP BY
  DATEADD(
    day,
    1,
    CAST(
      DATEADD(
        day,
        (
          1 - DATEPART(
            weekday,
            DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"")
          )
        ),
        CAST(
          DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"") AS date
        )
      ) AS datetime
    )
  )
ORDER BY
  DATEADD(
    day,
    1,
    CAST(
      DATEADD(
        day,
        (
          1 - DATEPART(
            weekday,
            DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"")
          )
        ),
        CAST(
          DATEADD(day, -1, ""BI"".""SessionAuteurs"".""DateSession"") AS date
        )
      ) AS datetime
    )
  ) ASC

wzimrin (Assginee) on (2025-01-23 16:53:31 UTC): Also, to confirm: it looks like you are running sql server, correct?

"
2784239883,issue,closed,not_planned,Field Values sync seems to resume after restarts,"### Describe the bug

Might be a bit synthetic to us, but perhaps a good thread to pull.

We update our internal instance up to ~14 times a day. At the same time, the field values sync job can take ~ 8 hours. It seems that the job resumes after restarts and can clog up the data warehouses.

See https://metaboat.slack.com/archives/C010ZSXQY87/p1736475112999039?thread_ts=1736210748.329009&cid=C010ZSXQY87 for a bit more context

This is a bit surprising as we have configured the job as follows: https://github.com/metabase/metabase/blob/master/src/metabase/task/sync_databases.clj#L254

```clojure
sync-databases=> (->> (metabase.task/scheduler-info)
                      :jobs
                      (filter (comp #{""metabase.task.update-field-values.job""} :key))
                      first
                      ((fn [x]
                         (update x :triggers (fn [t] (map #(select-keys % [:key :misfire-instruction]) t))))))
{:key ""metabase.task.update-field-values.job"",
 :class ""metabase.task.sync_databases.UpdateFieldValues"",
 :description ""update-field-values for all databases"",
 :concurrent-execution-disallowed? true,
 :durable? true,
 :requests-recovery? false,
 :triggers ({:key ""metabase.task.update-field-values.trigger.1"",
             :misfire-instruction ""DO_NOTHING""}
            {:key ""metabase.task.update-field-values.trigger.2"",
             :misfire-instruction ""DO_NOTHING""}
            {:key ""metabase.task.update-field-values.trigger.3"",
             :misfire-instruction ""DO_NOTHING""})}
```

### To Reproduce

field values job.
Might be best to add a system exit 0 in the middle of a function used in the field values and then see what state the system is in on startup. Does the scheduler resume the job? Leave it abandoned, etc.

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```

### Severity

p2

### Additional context

_No response_",dpsutton,2025-01-13 14:59:57+00:00,['snoe'],2025-01-20 18:40:49+00:00,2025-01-20 18:40:49+00:00,https://github.com/metabase/metabase/issues/52033,"[('Priority:P2', 'Average run of the mill bug'), ('Administration/Metadata & Sync', ''), ('.Team/Drivers', '')]",[],
2784239744,issue,closed,completed,Update indicator,"I would like it to be possible for all graphs and visuals, when updated, to show a loading bar, indicating that the data has been updated.

For me, this improvement would be very important, as it makes it easier to see updates.

![Image](https://github.com/user-attachments/assets/93c99871-7587-497a-b170-847c8dd13f9b)
If the indicators stayed like this by default when the data was updated, it would be really good.",igor-silveira-silva,2025-01-13 14:59:53+00:00,[],2025-01-24 16:57:21+00:00,2025-01-24 16:57:20+00:00,https://github.com/metabase/metabase/issues/52032,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2598433001, 'issue_id': 2784239744, 'author': 'paoliniluis', 'body': '@igor-silveira-silva when you say that ""data has been updated"" what do you refer to?', 'created_at': datetime.datetime(2025, 1, 17, 14, 1, 54, tzinfo=datetime.timezone.utc)}, {'comment_id': 2612984659, 'issue_id': 2784239744, 'author': 'brunobergher', 'body': ""Closing for inactivity for now, happy to reopen when there's a response."", 'created_at': datetime.datetime(2025, 1, 24, 16, 57, 20, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-17 14:01:54 UTC): @igor-silveira-silva when you say that ""data has been updated"" what do you refer to?

brunobergher on (2025-01-24 16:57:20 UTC): Closing for inactivity for now, happy to reopen when there's a response.

"
2783947021,issue,open,,Last-Edited-By for nested collections,"**Is your feature request related to a problem? Please describe.**
Returning to work in the new year, it was not clear which of the collections I'd last touched

**Describe the solution you'd like**
Populate the `last edited by` column in the collection list for nested collections as well; this can be the same as the `last edited by` of the most recently edited item within that collection, bubbled upwards

**Describe alternatives you've considered**
None, really

**How important is this feature to you?**
It's a nice to have

**Additional context**
n/a
",igbanam,2025-01-13 13:21:00+00:00,[],2025-02-04 20:30:43+00:00,,https://github.com/metabase/metabase/issues/52028,"[('Type:New Feature', ''), ('Organization/Collections', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2783936140,issue,closed,completed,CreateDashboardModal component's input placeholder text color and create button's background color is not themed correctly in the sdk,"When using the `<CreateDashboardModal />` SDK component in themed environments (e.g. in [Shoppy's ProficiencyLabs theme](https://embedded-analytics-sdk-demo.metabase.com), both the input placeholder text color and the ""Create"" button's background color is not themed correctly. It should follow the theming.

See [this note on Slack](https://metaboat.slack.com/archives/C063Q3F1HPF/p1736765497121959).

![Image](https://github.com/user-attachments/assets/56d1614d-c247-434b-bba3-a9abdd8bd204)",heypoom,2025-01-13 13:16:16+00:00,['oisincoveney'],2025-01-27 22:11:21+00:00,2025-01-22 11:12:14+00:00,https://github.com/metabase/metabase/issues/52027,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2606955044, 'issue_id': 2783936140, 'author': 'heypoom', 'body': 'Closed as this is fixed by Oisin in https://github.com/metabase/metabase/pull/52075. I will create a separate Shoppy PR that updates the Shoppy theme with the correct theme values, and bumps the Shoppy theme.', 'created_at': datetime.datetime(2025, 1, 22, 11, 12, 14, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607026961, 'issue_id': 2783936140, 'author': 'heypoom', 'body': 'Created an accompanying Shoppy PR: https://github.com/metabase/shoppy/pull/95', 'created_at': datetime.datetime(2025, 1, 22, 11, 45, 39, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2025-01-22 11:12:14 UTC): Closed as this is fixed by Oisin in https://github.com/metabase/metabase/pull/52075. I will create a separate Shoppy PR that updates the Shoppy theme with the correct theme values, and bumps the Shoppy theme.

heypoom (Issue Creator) on (2025-01-22 11:45:39 UTC): Created an accompanying Shoppy PR: https://github.com/metabase/shoppy/pull/95

"
2783418585,issue,open,,export problem,"### Describe the bug

export MB_DOWNLOAD_ROW_LIMIT=0   Still able to export a piece of data

### To Reproduce

View problem description

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
Configure confidentiality
```

### Severity

no

### Additional context

_No response_",meicao2999,2025-01-13 09:19:54+00:00,[],2025-02-04 20:29:35+00:00,,https://github.com/metabase/metabase/issues/52019,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Export', ''), ('.Backend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2586587515, 'issue_id': 2783418585, 'author': 'meicao2999', 'body': 'tag"": ""v0.52.5""', 'created_at': datetime.datetime(2025, 1, 13, 9, 24, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2586944001, 'issue_id': 2783418585, 'author': 'paoliniluis', 'body': ""Hi, we don't understand what you need. Please explain or we'll be closing the issue"", 'created_at': datetime.datetime(2025, 1, 13, 12, 12, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2587067108, 'issue_id': 2783418585, 'author': 'npfitz', 'body': 'It looks like if you have that var set to 0, and you go to a chart type visualization, you can choose export as a CSV and we will give you a CSV with the first row used in the chart. Reproduced on Master', 'created_at': datetime.datetime(2025, 1, 13, 13, 10, 42, tzinfo=datetime.timezone.utc)}, {'comment_id': 2587113003, 'issue_id': 2783418585, 'author': 'npfitz', 'body': 'Likely has the same root cause as https://github.com/metabase/metabase/issues/51620', 'created_at': datetime.datetime(2025, 1, 13, 13, 31, 5, tzinfo=datetime.timezone.utc)}, {'comment_id': 2588601592, 'issue_id': 2783418585, 'author': 'meicao2999', 'body': ""I want to control the user's permission to download the data circle. I have set MB_DOWNLOAD_SOW_LIMIT=0, but I am still able to export a single piece of data\n\n![Image](https://github.com/user-attachments/assets/429b4c8b-b46d-42be-a165-48dfb233e975)"", 'created_at': datetime.datetime(2025, 1, 14, 1, 53, 30, tzinfo=datetime.timezone.utc)}, {'comment_id': 2597847239, 'issue_id': 2783418585, 'author': 'meicao2999', 'body': ""Okay, I'll set it to -1 now and limit it with an error message"", 'created_at': datetime.datetime(2025, 1, 17, 9, 52, 8, tzinfo=datetime.timezone.utc)}]","meicao2999 (Issue Creator) on (2025-01-13 09:24:08 UTC): tag"": ""v0.52.5""

paoliniluis on (2025-01-13 12:12:53 UTC): Hi, we don't understand what you need. Please explain or we'll be closing the issue

npfitz on (2025-01-13 13:10:42 UTC): It looks like if you have that var set to 0, and you go to a chart type visualization, you can choose export as a CSV and we will give you a CSV with the first row used in the chart. Reproduced on Master

npfitz on (2025-01-13 13:31:05 UTC): Likely has the same root cause as https://github.com/metabase/metabase/issues/51620

meicao2999 (Issue Creator) on (2025-01-14 01:53:30 UTC): I want to control the user's permission to download the data circle. I have set MB_DOWNLOAD_SOW_LIMIT=0, but I am still able to export a single piece of data

![Image](https://github.com/user-attachments/assets/429b4c8b-b46d-42be-a165-48dfb233e975)

meicao2999 (Issue Creator) on (2025-01-17 09:52:08 UTC): Okay, I'll set it to -1 now and limit it with an error message

"
2782998495,issue,open,,Safari: text got overlayed on full search app,"### Describe the bug

![Image](https://github.com/user-attachments/assets/f74eb8a1-d92c-4427-aa14-bd7f046557e5)

the ""content type"" text is overlapped on safari.

### To Reproduce

1. Use safari 
2. Go to search, type something and hit enter to access full search app

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```

### Severity

P3

### Additional context

_No response_",qnkhuat,2025-01-13 04:38:13+00:00,[],2025-02-04 20:29:51+00:00,,https://github.com/metabase/metabase/issues/52013,"[('Type:Bug', 'Product defects'), ('Type:UX', ''), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Organization/Search', ''), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2782204494,issue,closed,completed,Link Checker Report,"[Full Github Actions output](https://github.com/metabase/metabase/actions/runs/12728788935?check_suite_focus=true)
",github-actions[bot],2025-01-12 00:20:19+00:00,['jeff-bruemmer'],2025-01-17 15:51:02+00:00,2025-01-17 15:51:02+00:00,https://github.com/metabase/metabase/issues/52010,"[('Type:Documentation', '')]",[],
2781540106,issue,open,,Disallow i18n as a side effect of loading a namespace,"How are we supposed to translate a string into the `user-locale` on system launch, when there is no user, or into the `site-locale`, when we can't get the site locale before the app DB is set up? `metabase.util.i18n/str*` is already checking this in most cases, but it misses places where we use things like `deferred-tru` and then call `str` on them anyways. 

Note that there are some cases where I guess we really probably need to allow this, like when generating dox based on the i18n'ed Malli schemas for API endpoints... I think we should allow it if you explicitly bind `*user-locale*` to something like `""en-US""`.  To enforce this we can update these functions in `metabase.util.i18n` as follows

```clj
(defn- translate-user-locale
  ""Translate a string with the current User's locale.""
  [format-string args pluralization-opts]
  (when (and config/tests-available?
             (not *user-locale*))
    ((requiring-resolve 'mb.hawk.init/assert-tests-are-not-initializing)
     (str ""Do not translate i18n strings as a side-effect of loading a namespace, use one of the deferred-* functions,""
          "" and make sure you don't call str on them inadvertently. If you really can't avoid this for some wacko""
          "" reason, bind *user-locale* so we can translate without requiring app DB access."")))
  (let [translated (translate (user-locale) format-string args pluralization-opts)]
    (log/tracef ""Translating %s for user locale %s (site locale %s) -> %s""
                (pr-str format-string) (pr-str (user-locale-string))
                (pr-str (site-locale-string)) (pr-str translated))
    translated))
```",camsaul,2025-01-11 02:27:13+00:00,[],2025-02-04 20:23:41+00:00,,https://github.com/metabase/metabase/issues/52007,"[('.Backend', ''), ('.Team/DevEx', '')]",[],
2781533695,issue,open,,Disallow fetching setting values as a side effect of loading a namespace,"Fetching Setting values requires having the app DB be set up, so it makes no sense to be fetching values on system launch and is probably a bug if we're capturing those values and ignoring future changes... we should disallow this. We can add this code to `metabase.models.setting/get-raw-value`

```clj
(when config/tests-available?
  ((requiring-resolve 'mb.hawk.init/assert-tests-are-not-initializing)
   ""We should not be fetching Setting values as a side effect of loading a namespace -- this requires DB setup!""))
```",camsaul,2025-01-11 02:23:20+00:00,[],2025-02-04 20:23:41+00:00,,https://github.com/metabase/metabase/issues/52006,"[('.Backend', ''), ('.Team/DevEx', '')]","[{'comment_id': 2585014031, 'issue_id': 2781533695, 'author': 'camsaul', 'body': ""We'll probably want to tackle #52007 first because we have a lot of code that tries to do i18n with `(site-locale)` or `(user-locale)` on system launch"", 'created_at': datetime.datetime(2025, 1, 11, 2, 27, 58, tzinfo=datetime.timezone.utc)}, {'comment_id': 2585015710, 'issue_id': 2781533695, 'author': 'camsaul', 'body': 'We have some settings that have descriptions that are generated based on the value of other settings... this is nonsense, right? We need to decide what to do about these.', 'created_at': datetime.datetime(2025, 1, 11, 2, 29, 21, tzinfo=datetime.timezone.utc)}]","camsaul (Issue Creator) on (2025-01-11 02:27:58 UTC): We'll probably want to tackle #52007 first because we have a lot of code that tries to do i18n with `(site-locale)` or `(user-locale)` on system launch

camsaul (Issue Creator) on (2025-01-11 02:29:21 UTC): We have some settings that have descriptions that are generated based on the value of other settings... this is nonsense, right? We need to decide what to do about these.

"
2781529758,issue,open,,Disallow `require` or `requiring-resolve` as a side effect of loading a namespace,"As discussed in https://metaboat.slack.com/archives/CKZEMT1MJ/p1734635053499399 and https://metaboat.slack.com/archives/CKZEMT1MJ/p1736556522733279 this messes up our topo sort for building and limits our ability to enforce module rules. It's an anti-pattern:

1. EE code can use `defenterprise`
2. OSS code should use `(ns (:require ...))` to load namespaces or add them to the module `.init` namespace as needed

To enforce this, we can swizzle `requiring-resolve` in tests and add 

```clj
;; in metabase.test.redefs
(defonce ^:private original-requiring-resolve requiring-resolve)

(defn- new-requiring-resolve [& args]
  (when-not (= args '[mb.hawk.init/assert-tests-are-not-initializing])
    (mb.hawk.init/assert-tests-are-not-initializing
     (str ""Do not use `requiring-resolve` in a top-level form. Wrap it in a function if you really need it. See""
          "" https://metaboat.slack.com/archives/CKZEMT1MJ/p1734635053499399 or talk to Cam if you need more info.""
          ""\nin namespace: "" (ns-name *ns*)
          ""\nform: "" (pr-str (cons 'requiring-resolve args))
          ""\n"")))
  (apply original-requiring-resolve args))

(alter-var-root #'requiring-resolve (constantly new-requiring-resolve))
```

and add some code like this to `metabase.classloader`:

```clj
(defn require
  ""Just like vanilla `require`, but ensures we're using our shared classloader to do it. Always use this over vanilla
  `require` -- otherwise namespaces might get loaded by the wrong ClassLoader, resulting in weird, hard-to-debug
  errors.

  Added benefit -- this is also thread-safe, unlike vanilla require.""
  ([x]
   (when config/tests-available?
     ((requiring-resolve 'mb.hawk.init/assert-tests-are-not-initializing)
      (str ""Do not use `require` in a top-level form outside of `ns`. See""
           "" https://metaboat.slack.com/archives/CKZEMT1MJ/p1734635053499399 or talk to Cam if you need more info.""
           ""\nin namespace: "" (ns-name *ns*)
           ""\nform: "" (pr-str (list `require x))
           ""\n"")))
   ;; Check whether the lib is already loaded (we only do this in simple cases where with just one arg -- this is
   ;; most of the calls anyway). If the lib is already loaded we can skip acquiring the lock and expensive stuff like
   ;; bindings and the try-catch
   (let [already-loaded? (and (symbol? x)
                              ((loaded-libs) x))]
     (when-not already-loaded?
       (require* x))))
  ([x & more]
   (apply require* x more)))
```

then add a `:discouraged-var` rule for Kondo to discourage `clojure.core/require`:

```clj
clojure.core/require                               {:message ""Use  metabase.plugins.classloader/require instead of clojure.core/require, it is thread-safe and works with dynamically loaded classes. Please make sure you're not doing a require that will happen when loading a namespace! See https://metaboat.slack.com/archives/CKZEMT1MJ/p1734635053499399 for more information on why this is bad.""}
```",camsaul,2025-01-11 02:19:46+00:00,[],2025-02-04 20:29:49+00:00,,https://github.com/metabase/metabase/issues/52004,"[('Type:Tech Debt', 'or Refactoring'), ('.Backend', ''), ('.Team/DevEx', '')]","[{'comment_id': 2585014885, 'issue_id': 2781529758, 'author': 'camsaul', 'body': ""We'll probably want to tackle #52006 first since we have a lot of code that fetches setting values on launch"", 'created_at': datetime.datetime(2025, 1, 11, 2, 28, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2585017473, 'issue_id': 2781529758, 'author': 'camsaul', 'body': 'I think as part of this we need to start saying that drivers need to explicitly require parent driver namespaces', 'created_at': datetime.datetime(2025, 1, 11, 2, 30, 33, tzinfo=datetime.timezone.utc)}]","camsaul (Issue Creator) on (2025-01-11 02:28:48 UTC): We'll probably want to tackle #52006 first since we have a lot of code that fetches setting values on launch

camsaul (Issue Creator) on (2025-01-11 02:30:33 UTC): I think as part of this we need to start saying that drivers need to explicitly require parent driver namespaces

"
2781455286,issue,open,,Option to Remove Access to Metrics and Models,"**Is your feature request related to a problem? Please describe.**
We have some non technical users and they don't really leverage these more advanced features when doing self service. We would like the option not to present them at all. It's not very helpful for them to click on ""Models"" or ""Metrics"" and see an empty list.

**Describe the solution you'd like**
Option to remove access to these or remove them navigation in the app.

**Additional context**
Customer request",ixipixi,2025-01-11 00:14:00+00:00,[],2025-02-04 20:31:07+00:00,,https://github.com/metabase/metabase/issues/52001,"[('Type:New Feature', ''), ('Administration/Permissions', 'Collection or Data permissions'), ('Querying/Models', 'aka Datasets'), ('Querying/Metrics', 'v2'), ('Semantic Model', ''), ('Semantic Model/Models', ''), ('Semantic Model/Metrics', '')]","[{'comment_id': 2587058391, 'issue_id': 2781455286, 'author': 'paoliniluis', 'body': 'dupe of https://github.com/metabase/metabase/issues/49116 @ixipixi ?', 'created_at': datetime.datetime(2025, 1, 13, 13, 7, 9, tzinfo=datetime.timezone.utc)}, {'comment_id': 2587455228, 'issue_id': 2781455286, 'author': 'ixipixi', 'body': ""@paoliniluis in this case they want to completely disable them - not just prevent users from creating them. In other words, since they don't create models or metrics for consumption they don't want users presented with models or metrics as a starting point for new questions at all. The other one sounds more specific to creator permissions?"", 'created_at': datetime.datetime(2025, 1, 13, 15, 36, 39, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-13 13:07:09 UTC): dupe of https://github.com/metabase/metabase/issues/49116 @ixipixi ?

ixipixi (Issue Creator) on (2025-01-13 15:36:39 UTC): @paoliniluis in this case they want to completely disable them - not just prevent users from creating them. In other words, since they don't create models or metrics for consumption they don't want users presented with models or metrics as a starting point for new questions at all. The other one sounds more specific to creator permissions?

"
2781303360,issue,open,,[Epic] DashViz frontend onboarding bugs,"Onboarding-friendly list of frontend bugs in DashViz scope for Sébastien.

- https://github.com/metabase/metabase/issues/46897
- https://github.com/metabase/metabase/issues/25967
- https://github.com/metabase/metabase/issues/50797
- https://github.com/metabase/metabase/issues/52199
- https://github.com/metabase/metabase/issues/50044
- https://github.com/metabase/metabase/issues/51082
- https://github.com/metabase/metabase/issues/49348
- https://github.com/metabase/metabase/issues/48036
- https://github.com/metabase/metabase/issues/52439


",alxnddr,2025-01-10 22:20:56+00:00,[],2025-01-21 14:57:27+00:00,,https://github.com/metabase/metabase/issues/51999,"[('.Epic', 'Feature Implementation or Project'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2781246921,issue,closed,completed,Default names for date and number filters are off,"### Describe the bug

When I add a date dashboard filter, I get a default name of ""All options"".
For a number filter by default it's ""Equal to"".

### To Reproduce

1. Go to any dashboard
2. Start adding a date filter or a number filter
3. See that the default name is ""All options"" or ""Equal to"", respectively


### Expected behavior

Should be just ""Date"" and ""Number"". When multiple filters of the same type added, should be like ""Date 1"", ""Date 2"", etc...

### Logs

_No response_

### Information about your Metabase installation

```JSON
27c6fe4
```

### Severity

Confusing, frequent

### Additional context

_No response_",mngr,2025-01-10 21:49:06+00:00,['kamilmielnik'],2025-01-22 08:38:49+00:00,2025-01-22 07:39:25+00:00,https://github.com/metabase/metabase/issues/51996,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Difficulty:Easy', ''), ('.Frontend', ''), ('.Team/Querying', ''), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]",[],
2781233078,issue,closed,completed,Selected first date is not highlighted in the date range picker when trying to change the range,"### Describe the bug

https://www.loom.com/share/e88e070e82274685afd7a89af9f1dda9

### To Reproduce

1. Go to the query builder
2. Start adding Specific dates filter
3. See the range preselected
4. Click on any date inside or outside the current range (except for the first date of it)
5. See that the range selection is removed, while the first date of the old range still is shown in blue and the date you clicked is not highlighted


### Expected behavior

The previous range highlight should be removed completely and the clicked date should be highlighted as the start date of the new range.
This worked fine in the dashboard filter component before it was replaced by the QB component.

### Logs

_No response_

### Information about your Metabase installation

```JSON
27c6fe4
```

### Severity

Misleading, frequent

### Additional context

_No response_",mngr,2025-01-10 21:42:56+00:00,['ranquild'],2025-01-27 22:11:38+00:00,2025-01-15 15:01:59+00:00,https://github.com/metabase/metabase/issues/51994,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Team/Querying', '')]",[],
2781078664,issue,open,,Add custom Kondo linter that says all `defmulti`s should have `:arglists` metadata,,camsaul,2025-01-10 20:25:30+00:00,[],2025-02-04 20:31:08+00:00,,https://github.com/metabase/metabase/issues/51991,"[('Type:Tech Debt', 'or Refactoring'), ('Type:Documentation', ''), ('.CI & Tests', ''), ('.Backend', ''), ('dev/ergonomic', ''), ('.Team/DevEx', '')]",[],
2780768381,issue,open,,Default User Attributes for Impersonation in Metabase,"**Is your feature request related to a problem? Please describe.**
It would be helpful to have a default user attribute that can be set at the user or group level for seamless use with Impersonation. Currently, if an attribute value is missing, it must be manually added or updated via the API, which is time-consuming for larger teams.

**Describe the solution you'd like**
Introduce the ability to define a default user attribute in Metabase that is tied to a database role. This default value would automatically apply when using Impersonation if no specific value is set for an individual user.

Example:
Consider a group named ""Marketing."" If a user in that group does not have a value for an attribute like database_role, the system could default to ""east-region"" or a predefined value.

<img width=""405"" alt=""Image"" src=""https://github.com/user-attachments/assets/c48a7f8c-5e11-4bbe-a586-403ce38fcd85"" />

**Describe alternatives you've considered**
Either manually enter a user attribute or use the API to update groups of users.




",FilmonK,2025-01-10 18:02:06+00:00,[],2025-02-04 20:30:41+00:00,,https://github.com/metabase/metabase/issues/51979,"[('Type:New Feature', ''), ('Administration/People', 'and Groups. Also user Account Settings'), ('Administration/Impersonation', 'Role level security')]","[{'comment_id': 2583415327, 'issue_id': 2780768381, 'author': 'joeledwardson', 'body': 'bump on this pls', 'created_at': datetime.datetime(2025, 1, 10, 18, 4, 5, tzinfo=datetime.timezone.utc)}]","joeledwardson on (2025-01-10 18:04:05 UTC): bump on this pls

"
2780690017,issue,open,,Dragged column has wrong position in dashcard visualization settings,"**Context**


Dragged column has wrong position in dashcard visualization settings. The dragged item is slightly shifted, although reordering works
<video src=""https://github.com/user-attachments/assets/e6cd77c5-ca62-471c-a324-724f9bce5295"" />

",alxnddr,2025-01-10 17:17:58+00:00,[],2025-02-04 20:31:26+00:00,,https://github.com/metabase/metabase/issues/51976,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Visualization/Chart Settings', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2780568644,issue,closed,completed,Make `/auth/sso` return a json error on oss instead of a 404 html page,"**Context**
https://metaboat.slack.com/archives/C063Q3F1HPF/p1736522047905719

Short version:
The `/auth/sso` endpoint doesn't exist in the OSS build, and a a request to that url returns an html page with a 404 error, it would make it easier to debug issues if it returned a json with an error message in the same format the ee endpoint does for other errors.

Longer version:
When using the SDK, the customer is expected to write an auth provider endpoint that calls `${METABASE_INSTANCE_URL}/auth/sso?token=true&jwt=${token}` and pipes whatever that endpoints returns to the sdk.
The SDK expects a session object from that endpoint, but it [can handle errors](https://github.com/metabase/metabase/blob/b660eb2958302a4be62e43980b40050b200b39fd/enterprise/frontend/src/embedding-sdk/store/auth.ts#L107-L128) in the format
```
{
  ""message"": ""A message explaining the error, by default it's shown in the UI of the sdk"",
  ""status"": ""an-error-code""
}
```
For example this is the error when jwt is disabled:
```
{
    ""via"": ...,
    ""trace"": ...,
    ""cause"": ""SSO has not been enabled and/or configured"",
    ""data"": {
        ""status-code"": 400,
        ""status"": ""error-sso-disabled""
    },
    ""message"": ""SSO has not been enabled and/or configured"",
    ""status"": ""error-sso-disabled""
}
```
And how its displayed (by default):

<img width=""519"" alt=""Image"" src=""https://github.com/user-attachments/assets/924069f8-6db3-4b2f-8a29-3a400a38e0f6"" />

When the SDK connects to a OSS instance, that endpoints returns a 404 **html** page, which makes the sdk show an unhelpful message in the form of `The ${source} must return an object with the shape {id:string, exp:number, iat:number, status:string}, got ${full html of the page here} instead` which fills the entire page.


I believe even a static response of
```
{
  ""message"": ""The auth/sso endpoint only exists in enterprise builds"",
  ""status"": ""ee-build-required""
}
```
would enough",npretto,2025-01-10 16:20:40+00:00,[],2025-01-22 16:21:37+00:00,2025-01-22 15:32:46+00:00,https://github.com/metabase/metabase/issues/51972,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2780523342,issue,open,,Customize visualization click actions in the sdk via onVisualizationClick prop,"We are disabling all URL click actions when in the SDK via https://github.com/metabase/metabase/pull/51290 to prevent users from being able to escape the application or accidentally navigating to internal Metabase URLs (e.g. dashboards, questions) where they might not have the right permission.

To allow users to handle visualization click actions (e.g. clicking on a table's column) in their own application, we should add an `onVisualizationClick` prop which allows underlying access to the row data and the current cell, e.g. `onVisualizationClick({ row, cell })`. SDK users could use this to build their own click behaviors.

See the [Technical Design Doc](https://www.notion.so/metabase/SDK-Customize-visualization-click-actions-and-provide-visual-cues-in-table-cells-17a69354c901807ca339eb438260d48a?pvs=4) for this task.",heypoom,2025-01-10 16:03:00+00:00,[],2025-02-04 20:30:38+00:00,,https://github.com/metabase/metabase/issues/51970,"[('Type:New Feature', ''), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2780514730,issue,closed,completed,[SDK] Interactive questions render `Question not found` for the first render,"**Context**
https://metaboat.slack.com/archives/C063Q3F1HPF/p1736522763070599?thread_ts=1736511082.514869&cid=C063Q3F1HPF

I think this is caused because the `loading` variables are only set to true in a use effect, and so the first render they're false -> the logic is ""if not loading but also no question -> not found"".

This should not affect customers directly, but it makes all the tests a bit problematic to debug, I saw ""Question not found"" in some testing library found and I thought some mocks were wrong and spent a lot of time debugging in the wrong direction
",npretto,2025-01-10 15:59:49+00:00,[],2025-01-16 13:54:51+00:00,2025-01-15 12:27:59+00:00,https://github.com/metabase/metabase/issues/51969,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2590140554, 'issue_id': 2780514730, 'author': 'WiNloSt', 'body': 'Might be fixed by https://github.com/metabase/metabase/pull/49714', 'created_at': datetime.datetime(2025, 1, 14, 14, 54, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2592679571, 'issue_id': 2780514730, 'author': 'npretto', 'body': 'Fixed by https://github.com/metabase/metabase/pull/49714/commits/3a1b42cddc5ea19203fb530db704e222b660d8a6', 'created_at': datetime.datetime(2025, 1, 15, 12, 27, 59, tzinfo=datetime.timezone.utc)}]","WiNloSt on (2025-01-14 14:54:16 UTC): Might be fixed by https://github.com/metabase/metabase/pull/49714

npretto (Issue Creator) on (2025-01-15 12:27:59 UTC): Fixed by https://github.com/metabase/metabase/pull/49714/commits/3a1b42cddc5ea19203fb530db704e222b660d8a6

"
2780302763,issue,open,,Rename Question to something else,"**Context**

Slack thread: https://metaboat.slack.com/archives/C063Q3F1HPF/p1733248491934379?thread_ts=1733229083.773739&cid=C063Q3F1HPF
",albertoperdomo,2025-01-10 14:19:51+00:00,[],2025-02-04 20:25:55+00:00,,https://github.com/metabase/metabase/issues/51961,"[('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2780242393,issue,open,,"Timezone used in Metabase system processes like sync, scanning, model persistence should be clearer","### Describe the bug

It is unclear which timezone these processes run, so it is hard to debug performance issues.
[Context](https://metaboat.slack.com/archives/C010ZSXQY87/p1736210748329009)

### To Reproduce

Go to `/admin/databases/` and configure a schedule for scanning. Unclear which timezone is used.
    same for sync schedule
Go to `/admin/performance/models/`. Change the schedule. Unsure which timezone is used.

Interestingly, we show the timezone in `/admin/performance/databases/` when setting up a schedule cache config.

### Expected behavior

The timezone used is preferrably the report timezone. But in any case, it should be visible to the user.
(the component on `/admin/performance/databases/` is clear.

### Logs

_No response_

### Information about your Metabase installation

```JSON
v52 - master
```

### Severity

P2

### Additional context

_No response_",luizarakaki,2025-01-10 13:52:47+00:00,[],2025-02-05 20:51:40+00:00,,https://github.com/metabase/metabase/issues/51959,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Misc/Timezones', ''), ('.Backend', ''), ('.Product Input Needed', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2780058235,issue,closed,completed,Field Filters get unlinked the moment you make changes to other Filters inside a Dashboard,"### Describe the bug

For some odd reason if you have an SQL question with field filters and set those up in a Dashboard. The moment you edit one of them the other filter gets unlinked.

### To Reproduce

1. Go to New -> Native Query -> Sample DB -> Create and Save the following Query (make sure to link Vendor with vendor column and date_ with created_at column)

`Select * from products WHERE {{Vendor}} AND {{date_}}`

2. Add this question to a dashboard and together with it add 2 filters. I am sharing a video cause it's easier to see what is going on:

https://github.com/user-attachments/assets/25679329-f6b1-4d31-8e22-70ceb8015f6d

You can check this out on stats as well [here](https://stats.metabase.com/dashboard/3119).

### Expected behavior

When I am doing changes to filters it doesn't impact the other filters

### Logs

None that are relevant

### Information about your Metabase installation

```JSON
I tested on both 52.5.2 and 51 ... Both have the issue and also happens on master
```

### Severity

Setting this to P1 cause if you have a lot of filters you might not notice of this change and can impact customers not knowing what is happening 

### Additional context

_No response_",Tony-metabase,2025-01-10 12:18:49+00:00,['ranquild'],2025-01-11 04:42:36+00:00,2025-01-11 03:33:11+00:00,https://github.com/metabase/metabase/issues/51957,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('.Escalation', ''), ('.Team/Querying', ''), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]","[{'comment_id': 2583659034, 'issue_id': 2780058235, 'author': 'paoliniluis', 'body': '@Tony-metabase is this a duplicate of https://github.com/metabase/metabase/issues/50349?', 'created_at': datetime.datetime(2025, 1, 10, 19, 10, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2583703292, 'issue_id': 2780058235, 'author': 'Tony-metabase', 'body': ""@paoliniluis yep you're right, that's the same! I closed that one and will keep this one open since there are replication steps here"", 'created_at': datetime.datetime(2025, 1, 10, 19, 19, 48, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-10 19:10:55 UTC): @Tony-metabase is this a duplicate of https://github.com/metabase/metabase/issues/50349?

Tony-metabase (Issue Creator) on (2025-01-10 19:19:48 UTC): @paoliniluis yep you're right, that's the same! I closed that one and will keep this one open since there are replication steps here

"
2779895514,issue,open,,"Add the 'additional tooltip metrics' configuration for Row, Funnel (and other) charts","**Is your feature request related to a problem? Please describe.**
In v51, bar, and area charts can now be customized which metrics are displayed in the tooltip via the 'Additional tooltip metrics' dropdown.

This is not available for row charts at the moment: tooltips on row charts display all available metrics but it is not possible to configure which metrics are shown.

**Describe the solution you'd like**
Add the ‘Additional tooltip metrics’ dropdown to row charts (and possibly to other charts) so it is possible to customize which metrics are shown.

**How important is this feature to you?**
Requested by a Pro customer.

**Additional context**
Add any other context or screenshots about the feature request here.
",zbodi74,2025-01-10 10:55:54+00:00,[],2025-02-04 20:31:31+00:00,,https://github.com/metabase/metabase/issues/51956,"[('Type:New Feature', ''), ('Visualization/Chart Settings', ''), ('.Completeness', ''), ('Visualization/Charts/Row', ''), ('.Product/Pothole', ''), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2582444471, 'issue_id': 2779895514, 'author': 'zbodi74', 'body': 'Related issues:\n #42594\n #42178\n #5176', 'created_at': datetime.datetime(2025, 1, 10, 11, 6, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582867745, 'issue_id': 2779895514, 'author': 'cdeweyx', 'body': 'Row charts have fallen behind others since the ECharts migration — This should be fairly easy to add once we migrate them over to ECharts as well.', 'created_at': datetime.datetime(2025, 1, 10, 14, 43, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582869244, 'issue_id': 2779895514, 'author': 'cdeweyx', 'body': '@zbodi74 Out of curiosity, are there any other chart types in particular you\'re referencing here with ""and other?""', 'created_at': datetime.datetime(2025, 1, 10, 14, 44, 37, tzinfo=datetime.timezone.utc)}, {'comment_id': 2583329595, 'issue_id': 2779895514, 'author': 'zbodi74', 'body': '@cdeweyx – I didn’t give much thought to which additional charts would benefit from this, mainly brought up others for completeness. That said, funnel, waterfall charts, area and grid maps seem like good candidates.', 'created_at': datetime.datetime(2025, 1, 10, 17, 36, 48, tzinfo=datetime.timezone.utc)}, {'comment_id': 2611978421, 'issue_id': 2779895514, 'author': 'zbodi74', 'body': 'The title has been updated to include Funnel charts, following a specific request by another customer.', 'created_at': datetime.datetime(2025, 1, 24, 8, 46, 11, tzinfo=datetime.timezone.utc)}]","zbodi74 (Issue Creator) on (2025-01-10 11:06:37 UTC): Related issues:
 #42594
 #42178
 #5176

cdeweyx on (2025-01-10 14:43:52 UTC): Row charts have fallen behind others since the ECharts migration — This should be fairly easy to add once we migrate them over to ECharts as well.

cdeweyx on (2025-01-10 14:44:37 UTC): @zbodi74 Out of curiosity, are there any other chart types in particular you're referencing here with ""and other?""

zbodi74 (Issue Creator) on (2025-01-10 17:36:48 UTC): @cdeweyx – I didn’t give much thought to which additional charts would benefit from this, mainly brought up others for completeness. That said, funnel, waterfall charts, area and grid maps seem like good candidates.

zbodi74 (Issue Creator) on (2025-01-24 08:46:11 UTC): The title has been updated to include Funnel charts, following a specific request by another customer.

"
2779885746,issue,open,,Absolute url,"URL column is always prefixed with site url: like htts://metabase.example.com/{{url-created-from column}}
This is problem when link refers to external site, like log report.

* when url starts with https:// or http:// don't prefix it
* or make same settings to allow RAW url, even without url encoded  column values
",janezj,2025-01-10 10:50:53+00:00,[],2025-02-04 20:31:53+00:00,,https://github.com/metabase/metabase/issues/51955,"[('Type:New Feature', ''), ('.Needs Triage', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('Reporting/Dashboards/Click Behavior', '')]","[{'comment_id': 2582854458, 'issue_id': 2779885746, 'author': 'paoliniluis', 'body': ""hi @janezj can you give us any example? I don't understand what you mean here"", 'created_at': datetime.datetime(2025, 1, 10, 14, 37, 16, tzinfo=datetime.timezone.utc)}, {'comment_id': 2584513886, 'issue_id': 2779885746, 'author': 'janezj', 'body': 'If I have a field value https://www.example.com the value will be displayed as such. But url will be prefixed with metabase host in my case https://metabase.myorg.com/www.example.com', 'created_at': datetime.datetime(2025, 1, 10, 22, 19, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2587750797, 'issue_id': 2779885746, 'author': 'brunobergher', 'body': ""@janezj, I can't follow what you're saying. What I understand from your request is how the product works today:\n- If there's a scheme, the link is shown absolutely (as in starting with http)\n- If there's no scheme, it's a relative path\n\nWhat would you like to change? And what version are you running?"", 'created_at': datetime.datetime(2025, 1, 13, 17, 33, 7, tzinfo=datetime.timezone.utc)}, {'comment_id': 2598523987, 'issue_id': 2779885746, 'author': 'janezj', 'body': ""No, I'm expecting such behavior.\r\nIn current 0.52.5 site-url is always prepended\r\n\r\nOn Mon, Jan 13, 2025 at 6:33\u202fPM Bruno Bergher ***@***.***>\r\nwrote:\r\n\r\n> @janezj <https://github.com/janezj>, I can't follow what you're saying.\r\n> What I understand from your request is how the product works today:\r\n>\r\n>    - If there's a scheme, the link is shown absolutely (as in starting\r\n>    with http)\r\n>    - If there's no scheme, it's a relative path\r\n>\r\n> What would you like to change? And what version are you running?\r\n>\r\n> —\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/metabase/metabase/issues/51955#issuecomment-2587750797>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AAJ2CMCZ5P4A4XL3VHNBAGD2KP2GVAVCNFSM6AAAAABU6DN3DOVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDKOBXG42TANZZG4>\r\n> .\r\n> You are receiving this because you were mentioned.Message ID:\r\n> ***@***.***>\r\n>"", 'created_at': datetime.datetime(2025, 1, 17, 14, 45, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2599143501, 'issue_id': 2779885746, 'author': 'paoliniluis', 'body': ""@janezj can you give us reproduction steps? I'm not able to reproduce and I'm wondering if you're running metabase in a sub path now\n\n![Image](https://github.com/user-attachments/assets/a547ff9b-bc42-40f5-a57b-142323b5ff9b)"", 'created_at': datetime.datetime(2025, 1, 17, 20, 32, 19, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-10 14:37:16 UTC): hi @janezj can you give us any example? I don't understand what you mean here

janezj (Issue Creator) on (2025-01-10 22:19:46 UTC): If I have a field value https://www.example.com the value will be displayed as such. But url will be prefixed with metabase host in my case https://metabase.myorg.com/www.example.com

brunobergher on (2025-01-13 17:33:07 UTC): @janezj, I can't follow what you're saying. What I understand from your request is how the product works today:
- If there's a scheme, the link is shown absolutely (as in starting with http)
- If there's no scheme, it's a relative path

What would you like to change? And what version are you running?

janezj (Issue Creator) on (2025-01-17 14:45:11 UTC): No, I'm expecting such behavior.
In current 0.52.5 site-url is always prepended

On Mon, Jan 13, 2025 at 6:33 PM Bruno Bergher ***@***.***>
wrote:

paoliniluis on (2025-01-17 20:32:19 UTC): @janezj can you give us reproduction steps? I'm not able to reproduce and I'm wondering if you're running metabase in a sub path now

![Image](https://github.com/user-attachments/assets/a547ff9b-bc42-40f5-a57b-142323b5ff9b)

"
2779156133,issue,closed,duplicate,Cannot change x-axis date formatting style on cartesian charts,"**Context**

[Slack report](https://metaboat.slack.com/archives/C064QMXEV9N/p1736465522973049)

This button got missing:
<img width=""656"" alt=""Image"" src=""https://github.com/user-attachments/assets/e7cd39c1-80c4-42d8-a4a1-3af6e823f103"" />


",alxnddr,2025-01-10 02:48:39+00:00,['alxnddr'],2025-01-10 16:54:13+00:00,2025-01-10 16:54:12+00:00,https://github.com/metabase/metabase/issues/51952,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Visualization/Chart Settings', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Bug:v52', 'bugs or regressions introduced in v52')]","[{'comment_id': 2583258587, 'issue_id': 2779156133, 'author': 'alxnddr', 'body': 'Dupliacte of https://github.com/metabase/metabase/issues/51839', 'created_at': datetime.datetime(2025, 1, 10, 16, 54, 12, tzinfo=datetime.timezone.utc)}]","alxnddr (Issue Creator) on (2025-01-10 16:54:12 UTC): Dupliacte of https://github.com/metabase/metabase/issues/51839

"
2778922911,issue,open,,Add customization options for Dashboard PDF title,"We have a customer using the SDK that would like to dynamically customize the dashboard title or add elements (like a logo or user-specific text) to the title space during PDF generation

[Slack thread](https://metaboat.slack.com/archives/C0836M8EN2C/p1736450354039189)",oisincoveney,2025-01-09 23:03:16+00:00,[],2025-02-04 20:30:36+00:00,,https://github.com/metabase/metabase/issues/51945,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('Reporting/Export', ''), ('.Frontend', ''), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2778905571,issue,open,,New fast sync for mysql is causing problems with non-well-behaving mysql-compatible systems (starrocks),"### Describe the bug

https://github.com/metabase/metabase/issues/49010 has caused issues with a mysql wire compatible tool that I use called starrocks.  https://www.starrocks.io

It used to work before 0.51.2 (I think), the new system doesn't work with non-well-behaving information_schema column information.  I was wondering if it would be possible to make fast/slow sync configurable, and put something in the help dialogue like, `slow is more compatible with systems that are mysql-like`

I did file an issue with them, not sure if they plan on working on it though. https://github.com/StarRocks/starrocks/issues/54896

### To Reproduce

Add a starrocks db as a connector using the mysql connector
Have all the tables show up with no fields.


### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""mysql"",
      ""clickhouse"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-07"",
      ""tag"": ""v0.52.5"",
      ""hash"": ""cc77eeb""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MySQL"",
        ""version"": ""8.0.32""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.224-212.876.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

medium

### Additional context

_No response_",dispalt,2025-01-09 22:53:24+00:00,[],2025-02-04 20:25:10+00:00,,https://github.com/metabase/metabase/issues/51943,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Database/MySQL', None), ('.Team/Drivers', ''), ('Bug:v52', 'bugs or regressions introduced in v52')]",[],
2778689226,issue,closed,completed,Visualization options is broke,"### Describe the bug

The visualization options tab is opening incorrectly, becoming completely broken.

The problem appears only ""reduce motion"" settings are enabled on OS level.

![Image](https://github.com/user-attachments/assets/972c6f2e-5fe5-4041-8342-0a457e406701)


### To Reproduce

1. Click edit dashboard
2. Click on visualization options

![Image](https://github.com/user-attachments/assets/b7c3a0d5-cdb2-4d54-a778-5301552c18ed)



### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""pt-BR"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:134.0) Gecko/20100101 Firefox/134.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2025-01-07"",
      ""tag"": ""v0.52.5"",
      ""hash"": ""cc77eeb""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""h2"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""H2"",
        ""version"": ""2.1.214 (2022-06-13)""
      },
      ""jdbc-driver"": {
        ""name"": ""H2 JDBC Driver"",
        ""version"": ""2.1.214 (2022-06-13)""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.0-125-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

Urgent

### Additional context

_No response_",igor-silveira-silva,2025-01-09 20:22:30+00:00,[],2025-01-20 16:43:39+00:00,2025-01-10 14:14:30+00:00,https://github.com/metabase/metabase/issues/51936,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround')]","[{'comment_id': 2581268852, 'issue_id': 2778689226, 'author': 'paoliniluis', 'body': 'This is a duplicate', 'created_at': datetime.datetime(2025, 1, 9, 21, 20, 57, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582137805, 'issue_id': 2778689226, 'author': 'uladzimirdev', 'body': '@paoliniluis duplicate of which issue?\n\n@igor-silveira-silva could you please share what kind of question do you have on the dashboard? Can you reproduce the issue using sample database and share the steps?', 'created_at': datetime.datetime(2025, 1, 10, 9, 14, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582332358, 'issue_id': 2778689226, 'author': 'igor-silveira-silva', 'body': '@uladzimirdev follow what was requested:\n\nI ran a direct SQL query on the Sample database:\n\n`select RATING_MAPPED,\n    count(*) as number_of_rating\nfrom FEEDBACK\ngroup by RATING_MAPPED\norder by 2 desc`\n\nSo I added this question to a dashboardand then when I click on the viewing options the screen is completely broken, making it difficult to view the options:\n\n![Image](https://github.com/user-attachments/assets/d69af1a7-57f7-4ced-8d24-80204d04892d)\n\nThe screen looks like this:\n\n![Image](https://github.com/user-attachments/assets/3d6a3fa8-ca98-41b5-9801-b696d599aefc)', 'created_at': datetime.datetime(2025, 1, 10, 10, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582496832, 'issue_id': 2778689226, 'author': 'uladzimirdev', 'body': ""Interesting, I wasn't able to reproduce this behavior on both mac and windows. Any chance you can try in different browser or in incognito mode (without extensions)?"", 'created_at': datetime.datetime(2025, 1, 10, 11, 33, 45, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582509973, 'issue_id': 2778689226, 'author': 'igor-silveira-silva', 'body': '@uladzimirdev before I was using Firefox, now I tested it with Edge, I had the same error:\n\n![Image](https://github.com/user-attachments/assets/610e9c78-9843-43e9-8c99-6c976a838af6)\n\nI also tested accessing an anonymous Edge tab and got the same error:\n\n![Image](https://github.com/user-attachments/assets/191c6c23-31fe-48b3-b791-60c64e0dd6f8)\n\nAnd Google Chrome same error too:\n\n![Image](https://github.com/user-attachments/assets/520ebe67-f567-4b4e-910b-7357321e1dc9)\n\n\nI remember that in version 0.52.4 it was normal, but in 0.52.5 this started to happen.', 'created_at': datetime.datetime(2025, 1, 10, 11, 40, 29, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582781090, 'issue_id': 2778689226, 'author': 'uladzimirdev', 'body': '@igor-silveira-silva to double check: did you (or admininistrator) enable reduced motion on windows? \n\n`Start > Settings > Accessibility > Visual Effects > toggle Animation Effects`', 'created_at': datetime.datetime(2025, 1, 10, 14, 3, 33, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582800373, 'issue_id': 2778689226, 'author': 'igor-silveira-silva', 'body': ""That really was it, I checked and this setting on the company's computer was disabled, I enabled it and tested again and the options screen rendered smoothly.\n\nHow it was:\n\n![Image](https://github.com/user-attachments/assets/0923affb-877b-41d3-b370-4ba57ecbe1c6)\n\nAs I left:\n\n![Image](https://github.com/user-attachments/assets/50f9338e-2f3c-4816-ade9-e25e9d22071f)\n\nHow the screen is opening now:\n\n![Image](https://github.com/user-attachments/assets/e7abfcdf-8434-432b-8bd6-636daae41755)\n\nThank you very much for your attention and support @uladzimirdev"", 'created_at': datetime.datetime(2025, 1, 10, 14, 11, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2582814685, 'issue_id': 2778689226, 'author': 'uladzimirdev', 'body': ""@igor-silveira-silva great to hear that the problem is resolved. Nevertheless we'll provide a fix in the next releases"", 'created_at': datetime.datetime(2025, 1, 10, 14, 17, 23, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-09 21:20:57 UTC): This is a duplicate

uladzimirdev on (2025-01-10 09:14:29 UTC): @paoliniluis duplicate of which issue?

@igor-silveira-silva could you please share what kind of question do you have on the dashboard? Can you reproduce the issue using sample database and share the steps?

igor-silveira-silva (Issue Creator) on (2025-01-10 10:36:00 UTC): @uladzimirdev follow what was requested:

I ran a direct SQL query on the Sample database:

`select RATING_MAPPED,
    count(*) as number_of_rating
from FEEDBACK
group by RATING_MAPPED
order by 2 desc`

So I added this question to a dashboardand then when I click on the viewing options the screen is completely broken, making it difficult to view the options:

![Image](https://github.com/user-attachments/assets/d69af1a7-57f7-4ced-8d24-80204d04892d)

The screen looks like this:

![Image](https://github.com/user-attachments/assets/3d6a3fa8-ca98-41b5-9801-b696d599aefc)

uladzimirdev on (2025-01-10 11:33:45 UTC): Interesting, I wasn't able to reproduce this behavior on both mac and windows. Any chance you can try in different browser or in incognito mode (without extensions)?

igor-silveira-silva (Issue Creator) on (2025-01-10 11:40:29 UTC): @uladzimirdev before I was using Firefox, now I tested it with Edge, I had the same error:

![Image](https://github.com/user-attachments/assets/610e9c78-9843-43e9-8c99-6c976a838af6)

I also tested accessing an anonymous Edge tab and got the same error:

![Image](https://github.com/user-attachments/assets/191c6c23-31fe-48b3-b791-60c64e0dd6f8)

And Google Chrome same error too:

![Image](https://github.com/user-attachments/assets/520ebe67-f567-4b4e-910b-7357321e1dc9)


I remember that in version 0.52.4 it was normal, but in 0.52.5 this started to happen.

uladzimirdev on (2025-01-10 14:03:33 UTC): @igor-silveira-silva to double check: did you (or admininistrator) enable reduced motion on windows? 

`Start > Settings > Accessibility > Visual Effects > toggle Animation Effects`

igor-silveira-silva (Issue Creator) on (2025-01-10 14:11:52 UTC): That really was it, I checked and this setting on the company's computer was disabled, I enabled it and tested again and the options screen rendered smoothly.

How it was:

![Image](https://github.com/user-attachments/assets/0923affb-877b-41d3-b370-4ba57ecbe1c6)

As I left:

![Image](https://github.com/user-attachments/assets/50f9338e-2f3c-4816-ade9-e25e9d22071f)

How the screen is opening now:

![Image](https://github.com/user-attachments/assets/e7abfcdf-8434-432b-8bd6-636daae41755)

Thank you very much for your attention and support @uladzimirdev

uladzimirdev on (2025-01-10 14:17:23 UTC): @igor-silveira-silva great to hear that the problem is resolved. Nevertheless we'll provide a fix in the next releases

"
2778645222,issue,open,reopened,Data source picker in the joins defaults to tables on embeddings,"### Describe the bug

Maybe we missed this or it's something we did on purpose, but when you pick the source table on embedded contexts you get the full menu, but the joins will always default to a the table view

### To Reproduce

1) embed Metabase (interactive)
2) create a question that has a join
first step lets you pick the source from anywhere
![Image](https://github.com/user-attachments/assets/8bf4bd12-67c7-4822-8cf4-92cc6653f1ef)
second will just default to the table
![Image](https://github.com/user-attachments/assets/bed1f0b4-a703-433e-b1ca-3d5d6703d754)

### Expected behavior

We should always show the original source picker

### Logs

NA

### Information about your Metabase installation

```JSON
v52.x, but I guess this comes from a long way back
```

### Severity

P3

### Additional context

NA",paoliniluis,2025-01-09 19:52:57+00:00,[],2025-02-04 20:25:58+00:00,,https://github.com/metabase/metabase/issues/51934,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Embedding/Interactive', 'Interactive Embedding, previously known as Full app embedding'), ('.Team/Embedding', '')]","[{'comment_id': 2587690170, 'issue_id': 2778645222, 'author': 'luizarakaki', 'body': ""Not sure if this is the expected behavior... if the user is picking a table, shouldn't we default to join on tables too? They can always go back and join models/questions if they want to."", 'created_at': datetime.datetime(2025, 1, 13, 17, 6, 11, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603116836, 'issue_id': 2778645222, 'author': 'albertoperdomo', 'body': 'I am not following @paoliniluis. Can you please try to explain it to me?', 'created_at': datetime.datetime(2025, 1, 20, 19, 27, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603119657, 'issue_id': 2778645222, 'author': 'albertoperdomo', 'body': ""Let me try to explain what I understand:\n\n1. You select a table to start the question\n2. When opening the data picker to select a question, we start by showing tables in the same DB/schema\n\nAnd you believe it would be better to start from the top again?\n\nIf it's this, this is the expected behavior and I believe it makes sense. Nevertherless, as @luizarakaki says, you select something else like a model instead just by adding one more click to go back. Either way, this is going to change soon since we are working on some simplifications on the data picker for embedding."", 'created_at': datetime.datetime(2025, 1, 20, 19, 29, 46, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603138307, 'issue_id': 2778645222, 'author': 'albertoperdomo', 'body': ""Actually, I've watched the recording from the customer in [the ticket](https://app.usepylon.com/issues?conversationID=6b93478d-c9a7-4b65-ba81-5e28083d128b)  There are two things at play here:\n\n* they are seeing an empty list to choose from, which is bad UX, if there is nothing to choose from, we should probably start at the top\n* they seem to prefer using models in their joins, I think this may be more preference based. I am not sure we will ever make this a configurable option though."", 'created_at': datetime.datetime(2025, 1, 20, 19, 46, 10, tzinfo=datetime.timezone.utc)}]","luizarakaki on (2025-01-13 17:06:11 UTC): Not sure if this is the expected behavior... if the user is picking a table, shouldn't we default to join on tables too? They can always go back and join models/questions if they want to.

albertoperdomo on (2025-01-20 19:27:20 UTC): I am not following @paoliniluis. Can you please try to explain it to me?

albertoperdomo on (2025-01-20 19:29:46 UTC): Let me try to explain what I understand:

1. You select a table to start the question
2. When opening the data picker to select a question, we start by showing tables in the same DB/schema

And you believe it would be better to start from the top again?

If it's this, this is the expected behavior and I believe it makes sense. Nevertherless, as @luizarakaki says, you select something else like a model instead just by adding one more click to go back. Either way, this is going to change soon since we are working on some simplifications on the data picker for embedding.

albertoperdomo on (2025-01-20 19:46:10 UTC): Actually, I've watched the recording from the customer in [the ticket](https://app.usepylon.com/issues?conversationID=6b93478d-c9a7-4b65-ba81-5e28083d128b)  There are two things at play here:

* they are seeing an empty list to choose from, which is bad UX, if there is nothing to choose from, we should probably start at the top
* they seem to prefer using models in their joins, I think this may be more preference based. I am not sure we will ever make this a configurable option though.

"
2778507126,issue,closed,completed,SDK builds created with `--watch` don't seem to work with cypress anymore,"**Context**

https://metaboat.slack.com/archives/C063Q3F1HPF/p1736244627716549
https://metaboat.slack.com/archives/C063Q3F1HPF/p1736428218835559

We don't know what happened, but builds from both `embedding-sdk:dev` and `build-embedding-sdk:watch` don't seem to work, when cypress imports them all it sees are the [e2e helper functions](https://metaboat.slack.com/archives/C063Q3F1HPF/p1736253785751389?thread_ts=1736244627.716549&cid=C063Q3F1HPF)",npretto,2025-01-09 18:28:44+00:00,['sanex3339'],2025-01-14 14:42:30+00:00,2025-01-14 14:07:06+00:00,https://github.com/metabase/metabase/issues/51930,"[('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2778335849,issue,closed,completed,Pivot table does not render until its viewport is resized,"**Context**

[Slack report](https://metaboat.slack.com/archives/C064QMXEV9N/p1736441257112909)

",alxnddr,2025-01-09 17:02:04+00:00,['alxnddr'],2025-01-10 21:00:24+00:00,2025-01-10 20:23:21+00:00,https://github.com/metabase/metabase/issues/51926,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('Visualization/Tables', 'raw, summarized and tabular visualizations'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2778323366,issue,closed,completed,"""Display as Link"" Configuration in Model Metadata doesn't Work","### Describe the bug

In model metadata you can configure a column to display as a link. When you add ""Link text"" and ""Link URL"" and save the changes sometimes they will be visible in the model and sometimes they won't. If they are visible and you refresh the model - the link is no longer visible in the model or in model metadata.



### To Reproduce

1. Create a model
2. Edit model metadata
3. Choose any column and set it to ""Display as Link"" and target some external URL
4. Save changes
5. If the link is visible in the model, refresh the page and it will vanish
6. Edit metadata and see the settings are also not available there.

https://www.loom.com/share/048978f37941464aba5b095be7f7c869

### Expected behavior

Link settings in model metadata should work

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""redshift"",
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-07"",
      ""tag"": ""v1.52.5"",
      ""hash"": ""cc77eeb""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.1 (Debian 15.1-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.167.4-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

annoying

### Additional context

Works correctly in 51 and on Stats",ixipixi,2025-01-09 16:55:27+00:00,['ranquild'],2025-01-29 20:21:05+00:00,2025-01-29 16:25:31+00:00,https://github.com/metabase/metabase/issues/51925,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('Querying/Models', 'aka Datasets'), ('.Team/Querying', ''), ('Bug:v52', 'bugs or regressions introduced in v52')]","[{'comment_id': 2622759390, 'issue_id': 2778323366, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)', 'created_at': datetime.datetime(2025, 1, 29, 20, 21, 5, tzinfo=datetime.timezone.utc)}]","github-actions[bot] on (2025-01-29 20:21:05 UTC): 🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)

"
2778075815,issue,closed,completed,Upload CSV modal isn't closable via the keyboard,"### Describe the bug

This modal isn't closable by pressing escape on the keyboard, which is an accessibility issue.

![Image](https://github.com/user-attachments/assets/bec42b38-6210-49fc-85f0-9b7598a16025)


### To Reproduce

1. Go to a collection on a fresh Metabase instance
2. Click the upload button to open the setup modal
3. Notice that it can only be closed by clicking the x in the corner

### Expected behavior

Should be closed when pressing escape

### Logs

_No response_

### Information about your Metabase installation

```JSON
Current master `fe092c1156` on firefox
```

### Severity

p3

### Additional context

_No response_",noahmoss,2025-01-09 15:04:14+00:00,[],2025-02-04 18:12:22+00:00,2025-02-04 18:12:22+00:00,https://github.com/metabase/metabase/issues/51920,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Misc/Accessibility', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2777992094,issue,open,,Source data types are not respected.,"### Describe the bug

Field/semantic types do not respect source data types. The columns in many of my tables get automatically -and without warning- casted to the wrong types, causing all sorts of issues.

### To Reproduce

I don't know how you could reproduce this, but I go to tables in my database and click on 'Fields in this table' to display this, which shows the mismatch between my source table and Metabase:

![Image](https://github.com/user-attachments/assets/7c5730a3-0fb1-4cd0-94ce-99f6a4ef7272)

### Expected behavior

Field/semantic types should be the same as the data types by default.

### Logs

Does not apply.

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""de-DE"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""snowflake""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2024-12-04"",
      ""tag"": ""v0.52.1"",
      ""hash"": ""5bc320b""
    },
    ""settings"": {
      ""report-timezone"": ""UTC""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.12""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""17.0.13+11-LTS"",
    ""java.vendor"": ""Amazon.com Inc."",
    ""java.vendor.url"": ""https://aws.amazon.com/corretto/"",
    ""java.version"": ""17.0.13"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""17.0.13+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.228-219.884.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

No scale given, so 'annoying', 'blocking' users who don't know how to manipulate columns to cast them back and 'blocking' productivity.

### Additional context

**By the way**, referring to something with two different names makes everything harder. [Here](https://www.metabase.com/learn/grow-your-data-skills/data-fundamentals/data-types-overview#:~:text=In%20Metabase%2C%20semantic%20types%20are,or%20display%20URLs%20as%20links.), you say the following:

<p align=""center"">
<img src=""https://github.com/user-attachments/assets/abe20775-9809-4ac5-b387-12d25cdaa674"" width=50%>
</p>

This makes one look for _field types_ in the docs and the app, since you declare that is your nomenclature. But then you use _semantic_ in some places and don't qualify _type_ at all in others:

<p align=""center"">
<img src=""https://github.com/user-attachments/assets/2decdb10-bbf5-4b41-9dd7-7fd3d466e215"" width=70%>
</p>

And back to _field_:

<p align=""center"">
<img src=""https://github.com/user-attachments/assets/a8ab4005-f56a-4262-bf32-2a283eb116a5"" width=30%>
</p>

It would be nice for the documentation and UI to be consistent.",odros,2025-01-09 14:28:50+00:00,[],2025-02-04 20:31:09+00:00,,https://github.com/metabase/metabase/issues/51917,"[('Priority:P2', 'Average run of the mill bug'), ('Type:Documentation', '')]","[{'comment_id': 2580398488, 'issue_id': 2777992094, 'author': 'paoliniluis', 'body': 'Hi there, quick question: what problem are you trying to solve? What I see in the description is just a misunderstanding of how the semantic types work so i want to make sure i can put you in the right track', 'created_at': datetime.datetime(2025, 1, 9, 14, 34, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2580519607, 'issue_id': 2777992094, 'author': 'odros', 'body': 'Hi! I\'m trying to make it default behaviour for Metabase to use the source data types and not cast to arbitrary types without warning.\n\nProblem: source data types get cast to arbitrary field/semantic types.\nSolution: source data types are ""respected"" and field/semantic types correspond to them.\n\nFor example, the data type `type/Number` should automatically map to the field/semantic type `# Quantity`.\n\nDoes this make sense?', 'created_at': datetime.datetime(2025, 1, 9, 15, 9, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2580851425, 'issue_id': 2777992094, 'author': 'paoliniluis', 'body': 'Sorry, it does still not make sense.\n\ne.g. the data type/number is a BASE type (the data type which is on the database), while ""quantity"" is just a ""hint"" that the metabase admin gives to Metabase to display stuff better on the frontend.\n\nMetabase does not do any kind of casting of values with semantic types', 'created_at': datetime.datetime(2025, 1, 9, 17, 15, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2634189654, 'issue_id': 2777992094, 'author': 'bshepherdson', 'body': ""I'm assigning this as a docs issue, since there do seem to be clarifications we could make.\n\nAs Luis says, there's no casting going on with the semantic types. (Except maybe for detecting date/times stored as ISO strings? I don't know if that's on by default or you have to enable that.) Instead, they're hints to Metabase about how to treat eg. certain numbers: as quantities, latitude/longitude values, amounts of money in a particular currency, etc."", 'created_at': datetime.datetime(2025, 2, 4, 14, 42, 59, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-09 14:34:10 UTC): Hi there, quick question: what problem are you trying to solve? What I see in the description is just a misunderstanding of how the semantic types work so i want to make sure i can put you in the right track

odros (Issue Creator) on (2025-01-09 15:09:10 UTC): Hi! I'm trying to make it default behaviour for Metabase to use the source data types and not cast to arbitrary types without warning.

Problem: source data types get cast to arbitrary field/semantic types.
Solution: source data types are ""respected"" and field/semantic types correspond to them.

For example, the data type `type/Number` should automatically map to the field/semantic type `# Quantity`.

Does this make sense?

paoliniluis on (2025-01-09 17:15:03 UTC): Sorry, it does still not make sense.

e.g. the data type/number is a BASE type (the data type which is on the database), while ""quantity"" is just a ""hint"" that the metabase admin gives to Metabase to display stuff better on the frontend.

Metabase does not do any kind of casting of values with semantic types

bshepherdson on (2025-02-04 14:42:59 UTC): I'm assigning this as a docs issue, since there do seem to be clarifications we could make.

As Luis says, there's no casting going on with the semantic types. (Except maybe for detecting date/times stored as ISO strings? I don't know if that's on by default or you have to enable that.) Instead, they're hints to Metabase about how to treat eg. certain numbers: as quantities, latitude/longitude values, amounts of money in a particular currency, etc.

"
2777967424,issue,closed,completed,[Epic] Clean up date parameter values conversion to display values and mbql,"Remove legacy (pseudo-) MBQL from date parameters.

### Implementation Plan

```[tasklist]
#### Milestone 1
- [ ] https://github.com/metabase/metabase/pull/51924
- [ ] https://github.com/metabase/metabase/pull/51995
- [ ] https://github.com/metabase/metabase/pull/52056
```
",ranquild,2025-01-09 14:19:20+00:00,['ranquild'],2025-01-14 16:15:41+00:00,2025-01-14 16:15:29+00:00,https://github.com/metabase/metabase/issues/51911,"[('.Epic', 'Feature Implementation or Project'), ('.Team/Querying', '')]",[],
2777882630,issue,closed,completed,Notebook data picker throws an error in the sdk's starter kit environment,"When rendering the the notebook's data picker in the Embedding SDK starter kit at https://github.com/metabase/metabase-nodejs-react-sdk-embedding-sample, the component throws a Tether error due to the old data picker causing crashes.

The same error does not show up when rendering  the notebook data picker in the Storybook environment and in the [Shoppy demo app](https://embedded-analytics-sdk-demo.metabase.com).

This is reproducible by rendering either the `<CreateQuestion />` component, or the notebook editor inside interactive question:

```tsx
<InteractiveQuestion>
  <InteractiveQuestion.Editor />
</InteractiveQuestion>
```

### Stacktrace

```tsx
Error: Tether Error: Both element and target must be defined
    at tether.js:700:1
    at Array.forEach (<anonymous>)
    at TetherClass2.setOptions (tether.js:698:1)
    at new TetherClass2 (tether.js:640:1)
    at Popover._setTetherOptions (Popover.jsx:293:1)
    at Popover._getBestAttachmentOptions (Popover.jsx:338:1)
    at Popover.updateComponentPosition (Popover.jsx:145:1)
    at Popover.componentDidMount (Popover.jsx:121:1)
    at invokeLayoutEffectMountInDEV (react-dom.development.js:25172:22)
    at invokeEffectsInDev (react-dom.development.js:27390:11)
```

### Screenshot

<img src=""https://github.com/user-attachments/assets/563778db-2733-4e80-b510-4d5041cae87d"" width=""400"">",heypoom,2025-01-09 13:44:05+00:00,['heypoom'],2025-01-21 11:34:06+00:00,2025-01-15 13:43:54+00:00,https://github.com/metabase/metabase/issues/51906,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2589624785, 'issue_id': 2777882630, 'author': 'heypoom', 'body': ""Seems like this happened before in https://github.com/metabase/metabase/issues/45488, and was fixed by Oisin once in https://github.com/metabase/metabase/pull/45671 by replacing the legacy Popover with Mantine's. See this [Slack thread](https://metaboat.slack.com/archives/C06FCQT0KMZ/p1720796036153659?thread_ts=1720535074.923449&cid=C06FCQT0KMZ)."", 'created_at': datetime.datetime(2025, 1, 14, 11, 4, 37, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2025-01-14 11:04:37 UTC): Seems like this happened before in https://github.com/metabase/metabase/issues/45488, and was fixed by Oisin once in https://github.com/metabase/metabase/pull/45671 by replacing the legacy Popover with Mantine's. See this [Slack thread](https://metaboat.slack.com/archives/C06FCQT0KMZ/p1720796036153659?thread_ts=1720535074.923449&cid=C06FCQT0KMZ).

"
2777676402,issue,closed,completed,Chart tooltips does not show up below the initial screen height in the sdk,"Tooltips of visualizations gets cut off at a point beyond the bottom edge of the initial screen size, then disappears completely. Tooltips will never be visible for any dashboard cards that are below the initial screen size.

The root cause is that the `.echarts-tooltip-container` class only covers the screen height (painted in blue in the below screenshot), so tooltips don't show up below that. If you update the tooltip container to either `position: fixed` (with high z-index) or a very tall height in your browser's inspector, the tooltip now shows up again.

![Image](https://github.com/user-attachments/assets/e974051e-9a8c-400b-9e8a-9109a6fe6c07)

See this [private Loom video](https://www.loom.com/share/43a6ab205ca7410eb12b60559814342e?sid=d39067f8-5359-41de-b516-5dc947ca1a99) for how to reproduce. 

### How to reproduce

- Open an interactive dashboard in the SDK, using a dashboard that has a longer height than your screen size (e.g. an x-rayed auto-generated dashboard)
  - I recommend https://embedded-analytics-sdk-demo.metabase.com/admin/analytics/12 and scroll down to the ""Hours when Orders were added"" dashboard card - it becomes really obvious.
- Scroll to a dashcard at the edge at your screen. Tooltips gets partially cut off - notice the bottom of the tooltip in the above screenshot.
- Scroll to a dashcard beyond the edge of your screen. Tooltips are no longer visible.",heypoom,2025-01-09 12:19:03+00:00,['heypoom'],2025-02-05 08:28:59+00:00,2025-02-04 18:24:40+00:00,https://github.com/metabase/metabase/issues/51904,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2615855606, 'issue_id': 2777676402, 'author': 'heypoom', 'body': 'Re-opening as we had to revert this because of a P1, which is caused by CSS variables being missing from a backport. Related [post-mortem](https://www.notion.so/metabase/Echarts-tooltip-in-a-dashboard-is-hidden-behind-charts-18869354c9018094a5efe812c3a8228b?pvs=4) here. I will re-open the PR again and add more rigorous checks.', 'created_at': datetime.datetime(2025, 1, 27, 14, 6, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2636057005, 'issue_id': 2777676402, 'author': 'github-actions[bot]', 'body': '🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)', 'created_at': datetime.datetime(2025, 2, 5, 8, 28, 58, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2025-01-27 14:06:08 UTC): Re-opening as we had to revert this because of a P1, which is caused by CSS variables being missing from a backport. Related [post-mortem](https://www.notion.so/metabase/Echarts-tooltip-in-a-dashboard-is-hidden-behind-charts-18869354c9018094a5efe812c3a8228b?pvs=4) here. I will re-open the PR again and add more rigorous checks.

github-actions[bot] on (2025-02-05 08:28:58 UTC): 🚀 This should also be released by [v0.53](https://github.com/metabase/metabase/milestone/287)

"
2777353324,issue,open,,Error during deserialization: Failed to read file for NativeQuerySnippet,"### Describe the bug

Native query snippets do not seem be exported when exporting a collection using the Metabase CLI, which leads to `Failed to read file for NativeQuerySnippet` on a subsequent import. 

We're exporting as follows: `metabase.jar export export --full-stacktrace --collection 2 --no-settings --no-data-model`

### To Reproduce

Export a collection containing questions that reference native SQL snippets.

### Expected behavior

Snippets should be exported.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64; rv:133.0) Gecko/20100101 Firefox/133.0"",
    ""vendor"": """"
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""pro-self-hosted-yearly"",
    ""version"": {
      ""date"": ""2024-12-23"",
      ""tag"": ""v1.51.10"",
      ""hash"": ""e9d96ac""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.12""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.25+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.25"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.25+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.10.230-223.885.amzn2.x86_64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""UTC""
  }
}
```

### Severity

Blocks our use of snippets

### Additional context

_No response_",YvesBos,2025-01-09 09:54:37+00:00,[],2025-02-04 20:26:37+00:00,,https://github.com/metabase/metabase/issues/51901,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Operation/Serialization', 'Enterprise contents migration'), ('.Team/Workflows', 'aka BEC')]",[],
2777255091,issue,open,,"Incorrect ""..."" button visual focus state when sidebar is open","### Describe the bug

![Image](https://github.com/user-attachments/assets/2a516194-5b45-47e5-829b-334e266a7dfe)



### To Reproduce

1. Have some metrics
2. Go to http://localhost:3000/browse/metrics
3. Open the sidebar
4. Change viewport width to 1165px or less
5. Click ""..."" button near the **last** metric

- Outline does not match the trigger button, it matches parent table cell instead
- Clicking on the right of the outlined rectangle does nothing
- Bottom of the outline is cut off

### Expected behavior

- Outline matches the trigger button and its hitbox
- Outline is not cut off for the last metric in the table

### Information about your Metabase installation

master, 8ceed8d65e1f466045026215f563e7f7e11e908a

### Severity

P3
",kamilmielnik,2025-01-09 09:14:27+00:00,[],2025-02-04 20:26:40+00:00,,https://github.com/metabase/metabase/issues/51898,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Organization/Browse Data', '')]","[{'comment_id': 2581623016, 'issue_id': 2777255091, 'author': 'Abhinavagarwa', 'body': 'can I work upon this issue', 'created_at': datetime.datetime(2025, 1, 10, 2, 35, 24, tzinfo=datetime.timezone.utc)}]","Abhinavagarwa on (2025-01-10 02:35:24 UTC): can I work upon this issue

"
2777147679,issue,open,,Remove Diacritic Sensitivity in Search,"**Is your feature request related to a problem? Please describe.**
When searching for usernames or other text fields in Metabase, the search functionality is diacritic-sensitive. This means typing ""Angela"" does not return results for ""Ángela"" and vice versa. This behavior can cause inefficiencies and confusion when working with datasets containing names or text with diacritics, especially in multilingual environments.

**Describe the solution you’d like**
An option to make Metabase’s search functionality diacritic-insensitive. With this feature enabled, typing ""a"" would match both ""a"" and ""á"" (as well as other diacritic variants like ""ä"", ""ã"", ""à""). This should apply to all fields where text search is used, such as filters, dropdown selectors, and search bars across the interface.

**Describe alternatives you’ve considered**
- Manual normalization of text fields in the database itself, which can be complex and not always feasible.
- Writing custom SQL queries that apply functions like LOWER() and UNACCENT() (for PostgreSQL), but this requires technical knowledge and is not user-friendly for non-technical users.

**How important is this feature to you?**
I encounter this issue every day. It would greatly improve the user experience and reduce errors in searches.

**Additional context**
The attached screenshots show how typing ""angela"" and ""ángela"" yield different results, demonstrating the diacritic sensitivity in Metabase’s current search implementation.

<img width=""405"" alt=""Image"" src=""https://github.com/user-attachments/assets/1b928030-48c8-4832-bccf-b72c7513f518"" />
<img width=""397"" alt=""Image"" src=""https://github.com/user-attachments/assets/cbf239a5-d8fa-47bd-8e0b-14278e5deb29"" />

Thank you for considering this feature request!",silvhoch,2025-01-09 08:24:09+00:00,[],2025-02-04 20:31:01+00:00,,https://github.com/metabase/metabase/issues/51897,"[('Type:New Feature', ''), ('Organization/Search', '')]",[],
2776753089,issue,open,,Days at the start of the year are assigned to incorrect weeks using week-of-year,"### Describe the bug

In [this stats question](https://stats.metabase.com/question/23356-whats-up-with-week-52-in-2025), we apparently have page views for week 52 of 2025, even though that is months in the future.  That shouldn't happen.

The issue is that to get the week of year, we get the preceding sunday and then do `ceil(day_of_year/7)`.  If the preceding sunday was in the previous year, you'll get an inaccurate result

### To Reproduce

1. Go to [this stats question](https://stats.metabase.com/question/23356-whats-up-with-week-52-in-2025)
2. See data for week 52 of 2025

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""mongo"",
      ""sqlserver"",
      ""athena"",
      ""h2""
    ],
    ""run-mode"": ""dev"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""tag"": ""vLOCAL_DEV"",
      ""hash"": ""06d1ba2ae111e66253209c01c244d6379acfc6dcb1911fa9ab6012cec9ce52e5""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.15 (Homebrew)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.4""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""15.1.1"",
    ""user.language"": ""en"",
    ""user.timezone"": ""America/Chicago""
  }
}
```

### Severity

incorrect data

### Additional context

_No response_",wzimrin,2025-01-09 03:27:44+00:00,[],2025-02-04 20:27:57+00:00,,https://github.com/metabase/metabase/issues/51894,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Processor', ''), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2603395137, 'issue_id': 2776753089, 'author': 'mngr', 'body': 'Should be closed by https://www.notion.so/metabase/Continuous-week-numbering-18169354c901807c93b7d40e782cd134', 'created_at': datetime.datetime(2025, 1, 21, 0, 17, 20, tzinfo=datetime.timezone.utc)}]","mngr on (2025-01-21 00:17:20 UTC): Should be closed by https://www.notion.so/metabase/Continuous-week-numbering-18169354c901807c93b7d40e782cd134

"
2776647899,issue,open,,Multiple Zoom in drills in context menu,"### Describe the bug

Both the `zoom-in.binning` and `zoom-in.geographic` drills appear as ""Zoom in"" in the drills context menu. If more than one of these drills apply for a given query, it's confusing and impossible to tell them apart.

### To Reproduce

![Image](https://github.com/user-attachments/assets/306c7e16-079b-4577-a000-7ed8ce720f31)

1. New Question
2. Sample DB
3. People
4. Summarize: Count
5. Breakouts on: City, State, Latitude, and Longitude
6. Visualize
7. Select the table viz
8. Click on a value in the ""count"" column

You will see 6 ""Zoom in"" options in the context menu. These correspond to (not necessarily in this order)

- `zoom-in.geographic` drill for City
- `zoom-in.geographic` drill for State
- `zoom-in.geographic ` drill for Latitude
- `zoom-in.geographic ` drill for Longitude
- `zoom-in.binning` drill for Latitude
- `zoom-in.binning` drill for Longitude

![Image](https://github.com/user-attachments/assets/f347b414-25c9-4bbd-96f0-aab38751b1fc)


### Expected behavior

Fewer ""Zoom in"" options, or else some way to distinguish them.

We probably don't want to return both `zoom-in.binning` and `zoom-in.geographic` for the lat/lon breakouts, e.g., and IIRC both the `zoom-in.geographic` drills for lat/lon will perform the same zoom (i.e. zoom both lat and lon). It's just that the drill ""matches"" for both breakouts.

### Logs

_No response_

### Information about your Metabase installation

```JSON
Reproducible at least as far back v49.25.2, but still present in v52 and current master at ccdd98bc68.
```

### Severity

confusing

### Additional context

_No response_",appleby,2025-01-09 01:08:06+00:00,[],2025-02-04 20:27:16+00:00,,https://github.com/metabase/metabase/issues/51890,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Querying/MBQL', ''), ('.Backend', ''), ('Querying/Drill Thrus', 'Refining existing queries with Drill Thrus'), ('.Team/Querying', '')]","[{'comment_id': 2584106055, 'issue_id': 2776647899, 'author': 'mngr', 'body': 'Proposed solution:\n- display more info in the context menu, like ""Zoom in: State"" and ""Zoom in: City""\n- keep only a single geographic zoom in option like Zoom in: geo', 'created_at': datetime.datetime(2025, 1, 10, 20, 46, 8, tzinfo=datetime.timezone.utc)}]","mngr on (2025-01-10 20:46:08 UTC): Proposed solution:
- display more info in the context menu, like ""Zoom in: State"" and ""Zoom in: City""
- keep only a single geographic zoom in option like Zoom in: geo

"
2776637063,issue,open,,SSO does not respect MAX_SESSION_AGE and MB_SESSION_COOKIES,"### Describe the bug

Even though I set both env vars the session cookie keeps being valid just for the session and not for the validity of the MAX_SESSION_AGE

### To Reproduce

1) set up Google Auth in Metabase + the 2 env vars
2) log in via SSO to Metabase, see that the cookie is only valid for the session (you quit the browser and you need to reauthenticate)

this does not happen when you log in via user/pass, where drop a session cookie with the correct validity

### Expected behavior

We should respect what we put in the session age

### Logs

NA

### Information about your Metabase installation

```JSON
I have a feeling it has always been like that
```

### Severity

P2

### Additional context

NA",paoliniluis,2025-01-09 00:56:40+00:00,[],2025-02-04 20:23:55+00:00,,https://github.com/metabase/metabase/issues/51889,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Backend', ''), ('Administration/Auth/SSO', 'Enterprise SSO like SAML and JWT'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2776323094,issue,open,,OpenAPI/Scalar API documentation example code should include authentication,"Right now it doesn't include any authentication-related stuff:

![Image](https://github.com/user-attachments/assets/4edb24d9-8812-426a-bdb8-4ec09293f1fd)

e.g. for cURL it should include

```sh
--header 'x-api-key: YOUR_KEY'
```

(or `X-Metabase-Session`). Bonus points if these are configurable somehow e.g. if the user can edit `YOUR_KEY` at the top of the page and then the example output all includes that key.

We can configure Scalar to include this stuff: https://github.com/scalar/scalar/blob/main/documentation/configuration.md#authentication-partial

For the live version that lives at http://localhost:3000/api/docs we could even pre-populate this stuff with the session token for the current user. Nice!",camsaul,2025-01-08 20:49:44+00:00,[],2025-02-04 20:31:08+00:00,,https://github.com/metabase/metabase/issues/51874,"[('Type:Documentation', ''), ('Misc/API', ''), ('.Backend', ''), ('.Team/DevEx', '')]",[],
2776307498,issue,open,,Switch to OpenAPI/Scalar documentation for REST API in https://www.metabase.com/docs/latest/api-documentation,"Currently we have two versions of the API documentation, OpenAPI + Scalar that lives in http://localhost:3000/api/docs and static Markdown files in [`docs/api`](https://github.com/metabase/metabase/tree/master/docs/api) generated by `clojure -M:ee:doc api-documentation`... we should unify the two and put all of our documentation eggs in one basket. See [this Slack thread](https://metaboat.slack.com/archives/C0669P4AF9N/p1736211057145479?thread_ts=1736195168.832009&cid=C0669P4AF9N) for more discussion between me, @jeff-bruemmer, and others.",camsaul,2025-01-08 20:41:17+00:00,[],2025-02-04 20:31:09+00:00,,https://github.com/metabase/metabase/issues/51873,"[('Type:Documentation', ''), ('Misc/API', ''), ('.Building & Releasing', ''), ('.Team/DevEx', '')]",[],
2775913437,issue,open,,Remove serdes v1 `dump` and `load` commands,"We released serdes v2 (export and import) on 46. Since then, we have a deprecation warning on these commands. Now, Serdes v1 isn't maintained for a long time. We should remove it from the product.

- [ ] Disable the dump and load CLI commands. If a user tries to run these commands, we show a message: ""Serialization v1 dump and load commands were replaced by Serialization v2 export and import on v45 and removed on v53""
- [ ] Remove Serdes v1 code from the product",luizarakaki,2025-01-08 17:16:28+00:00,[],2025-02-04 20:26:37+00:00,,https://github.com/metabase/metabase/issues/51865,"[('Operation/Serialization', 'Enterprise contents migration'), ('.Task', 'Not a part of any Epic, used by the Task Issue Template'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2775802819,issue,open,,Surface cards' error message on dashboard instead of the generic error message,"**Is your feature request related to a problem? Please describe.**

The error messages in a dashboard are uninformative : e.g. “warning There was a problem displaying this chart” 
It requires clicking on the actual question to see the specific error message, eg: “SQL compilation error…”
We should be able to see this same error at the dashboard level so users can understand what is actually wrong without clicking into a question.

![Image](https://github.com/user-attachments/assets/f39b3d21-7ffe-49c8-bf28-c512ddce5823)

![Image](https://github.com/user-attachments/assets/d8cac4cb-7f5d-40a8-85f6-2fb981cefef0)

**Describe the solution you'd like**
Surface a card's specific error message directly on the dashboard, instead of the generic error message ""There was a problem displaying this chart""

**Describe alternatives you've considered**
none

**How important is this feature to you?**
This places us in the critical path of mitigating the issue, as users lack sufficient context to determine their next steps for gaining access to the dashboard.

**Additional context**
It looks like we do get the real error in network response so this might only be a front-end change.
![Image](https://github.com/user-attachments/assets/9b8a4688-97d9-4dca-9244-460651714340)
",margueritevial,2025-01-08 16:22:01+00:00,[],2025-02-04 20:30:45+00:00,,https://github.com/metabase/metabase/issues/51863,"[('Reporting/Dashboards', ''), ('Type:New Feature', ''), ('.Product Input Needed', ''), ('.Product/Pothole', '')]","[{'comment_id': 2578302375, 'issue_id': 2775802819, 'author': 'cdeweyx', 'body': 'Note for future reference: This has come up internally before and there was some concerns about surfacing technical details to dashboard consumers, when it might not be desirable for that audience. Not a ""no go"" but a little bit of thinking required.', 'created_at': datetime.datetime(2025, 1, 8, 18, 2, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2579602975, 'issue_id': 2775802819, 'author': 'margueritevial', 'body': 'As a typical example of what I have in mind, here is a message received today from a user about these generic error messages on dashboards, and our answer.\n\n<img width=""1462"" alt=""Image"" src=""https://github.com/user-attachments/assets/c591c37c-f5f0-4af9-8aae-bdb60fdde689"" />\n\nHere is a suggested solution to improve this, directly showing to the user which data permission they are lacking and should request:\n\n<img width=""1342"" alt=""Image"" src=""https://github.com/user-attachments/assets/a13623c5-a90d-4125-8d1c-896ff9a4685c"" />', 'created_at': datetime.datetime(2025, 1, 9, 9, 43, 14, tzinfo=datetime.timezone.utc)}]","cdeweyx on (2025-01-08 18:02:41 UTC): Note for future reference: This has come up internally before and there was some concerns about surfacing technical details to dashboard consumers, when it might not be desirable for that audience. Not a ""no go"" but a little bit of thinking required.

margueritevial (Issue Creator) on (2025-01-09 09:43:14 UTC): As a typical example of what I have in mind, here is a message received today from a user about these generic error messages on dashboards, and our answer.

<img width=""1462"" alt=""Image"" src=""https://github.com/user-attachments/assets/c591c37c-f5f0-4af9-8aae-bdb60fdde689"" />

Here is a suggested solution to improve this, directly showing to the user which data permission they are lacking and should request:

<img width=""1342"" alt=""Image"" src=""https://github.com/user-attachments/assets/a13623c5-a90d-4125-8d1c-896ff9a4685c"" />

"
2775413215,issue,open,,[MLv2] Join alias deduplication in query with multiple nesting levels with joins results in incorrect native form,"Join alias deduplication in query containing multiple levels of nesting and joins, where joins have same join alias (the default generated by lib) makes the compiled query incorrect.

Noteworthy:
- To reproduce:
  - Use master `ef01a0f9f10633bee72eade16bbe0a935a0472fd`.
  - Execute the _quasi test_ found on the following lines in `test.metabase.query-processor.middleware.metrics-test` namespace.
-  Error was discovered during metrics middleware re-write, PR https://github.com/metabase/metabase/pull/51047, issues https://github.com/metabase/metabase/issues/25455 and https://github.com/metabase/metabase/issues/30574.
- While attempting to reproduce it without metrics expansion coming into play, the issue https://github.com/metabase/metabase/issues/51690 was discovered. This issue manifests similarly as the linked issue. In this case however the same error seems to be caused by alias deduplication instead of use of `with-fields` and `visible-columns` combination.
- This issue is not blocking further metrics work as different approach to join alias generation is used there now.

Quasi test:
```clojure
(deftest deduplication-repro-attempt-test
  (let [mp (lib.metadata.jvm/application-database-metadata-provider (mt/id))
        q (as-> (lib/query mp (lib.metadata/table mp (mt/id :products))) $$
            (lib/join $$ (-> (lib/join-clause (as-> (lib/query mp (lib.metadata/table mp (mt/id :products))) $
                                                (lib/join $ (-> (lib/join-clause (-> (lib/query mp (lib.metadata/table mp (mt/id :products)))
                                                                                     (lib/aggregate (lib/count))
                                                                                     (lib/append-stage)))
                                                                (lib/with-join-conditions [(lib/= (lib/+ 1 1) 2)])))
                                                (lib/breakout $ (m/find-first (comp #{""count""} :name) @(def coco (lib/breakoutable-columns $))))
                                                (lib/append-stage $)
                                                (lib/with-fields $ [(first @(def voco (lib/visible-columns $)))])
                                                (lib/append-stage $)))
                             (lib/with-join-conditions [(lib/= (lib/+ 1 1) 2)])))
            (lib/breakout $$ (m/find-first (comp #{""Products__count""} :name) @(def boco (lib/breakoutable-columns $$))))
            (lib.stage/append-stage $$)
            (lib/with-fields $$ [(first (lib/visible-columns $$))]))]
    (def qqq q)
    (def ppp (metabase.query-processor.preprocess/preprocess q))
    (def ccc (metabase.query-processor.compile/compile q))
    ;; following call throws an exception
    (def res (metabase.query-processor/process-query q))))
```

Compiled sql:
```sql
SELECT
    ""source"".""Products__Products__count"" AS ""Products__Products__count""
FROM
    (
        SELECT
            ""Products"".""Products__count"" AS ""Products__Products__count""
        FROM
            ""PUBLIC"".""PRODUCTS""
            LEFT JOIN (
                SELECT
                    -- Following source alias does not use deduplicated desired aliased from the subquery.
                    ""source"".""Products__count"" AS ""Products__count""
                FROM
                    (
                        SELECT
                            ""Products_2"".""count"" AS ""Products_2__count""
                        FROM
                            ""PUBLIC"".""PRODUCTS""
                            LEFT JOIN (
                                SELECT
                                    COUNT(*) AS ""count""
                                FROM
                                    ""PUBLIC"".""PRODUCTS""
                            ) AS ""Products_2"" ON (1 + 1) = 2
                        GROUP BY
                            ""Products_2"".""count""
                        ORDER BY
                            ""Products_2"".""count"" ASC
                    ) AS ""source""
            ) AS ""Products"" ON (1 + 1) = 2
        GROUP BY
            ""Products"".""Products__count""
        ORDER BY
            ""Products"".""Products__count"" ASC
    ) AS ""source""
LIMIT
    1048575
```
",lbrdnk,2025-01-08 13:34:35+00:00,[],2025-02-04 20:27:53+00:00,,https://github.com/metabase/metabase/issues/51856,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Processor', ''), ('Querying/MBQL', ''), ('Querying/Nested Queries', 'Questions based on other saved questions'), ('.Backend', ''), ('.metabase-lib', 'Label for tracking all issues related to the shared CLJC metabase-lib'), ('.Team/Querying', '')]","[{'comment_id': 2577989516, 'issue_id': 2775413215, 'author': 'bshepherdson', 'body': '#49182 should make it possible to avoid disambiguating join aliases across levels.\n\nIn fact, putting it more strongly: join aliases post-refs overhaul can be unique by construction, instead of requiring disambiguation. `clojure.core/gensym` or similar can be used to create unique names like `Products317`, `Products318`, etc. for each join. Then all aliases are guaranteed not to collide, either across subqueries, or within one level that joins the same table more than once.', 'created_at': datetime.datetime(2025, 1, 8, 15, 40, 48, tzinfo=datetime.timezone.utc)}]","bshepherdson on (2025-01-08 15:40:48 UTC): #49182 should make it possible to avoid disambiguating join aliases across levels.

In fact, putting it more strongly: join aliases post-refs overhaul can be unique by construction, instead of requiring disambiguation. `clojure.core/gensym` or similar can be used to create unique names like `Products317`, `Products318`, etc. for each join. Then all aliases are guaranteed not to collide, either across subqueries, or within one level that joins the same table more than once.

"
2775232530,issue,open,,Allow different default Filter values based on users/tenant,"**Is your feature request related to a problem? Please describe.**

I'm using a multi-tenant Metabase environment and different tenants require different default values for the same dashbaord:

<img width=""432"" alt=""Image"" src=""https://github.com/user-attachments/assets/80526325-29a7-4290-8ee4-6898d31a60ad"" />


**Describe the solution you'd like**
Allow setting up different default values per tenant and/or per user both on a normal filter and a filter that `Always Require a Value`

**Describe alternatives you've considered**
Different Dashboards per user/tenant

How important is this feature to you?
Requested by a customer

Additional context
N/A
",Tony-metabase,2025-01-08 12:08:19+00:00,[],2025-02-04 20:30:32+00:00,,https://github.com/metabase/metabase/issues/51854,"[('Type:New Feature', ''), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('.Needs Triage', ''), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only'), ('Administration/Tenants', 'Multi-tenant isolation and customization')]",[],
2775212242,issue,open,,Sidebar items not properly highlighted after moving collection to trash,"### Describe the bug

https://github.com/user-attachments/assets/b2fd6812-d94b-4455-8eed-13ab9c802a54


### To Reproduce

1. Create a subcollection in ""Our analytics"" and open it
2. Click ""...""
3. Click ""Move to trash"" and confirm
4. ✅ ""Trash"" is highlighted in the sidebar
5. Click ""Home"" in the sidebar
6. ❌ ""Trash"" is highlighted in the sidebar
7. Click ""Our analytics"" in the sidebar
8. ❌ ""Trash"" is highlighted in the sidebar

### Information about your Metabase installation

master, a0ae2a8f289d4ad1b7baf962e28ebabfa00e0121

### Severity

P2
",kamilmielnik,2025-01-08 11:58:40+00:00,[],2025-02-04 20:26:59+00:00,,https://github.com/metabase/metabase/issues/51853,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Frontend', ''), ('Organization/Trash', 'Where deleted items go'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2775203359,issue,open,,Target collection overridden with a recently used dashboard,"### Describe the bug

https://github.com/user-attachments/assets/f91e4c8c-14a9-4331-88c1-9accf80f7923


### To Reproduce

1. Create and save a dashboard (or whatever will make new question modal show that dashboard as default target)
2. Create and save a new collection ""My collection"" in ""Our analytics""
3. Open ""My collection""
4. Click ""Create a new..."" in the empty state of that collection
5. Click ""Question""
6. Choose any table
7. Click ""Save""

Save question modal offers to save the question in the dashboard

### Expected behavior

Save question modal offers to save the question in ""My collection""

### Information about your Metabase installation

master, a0ae2a8f289d4ad1b7baf962e28ebabfa00e0121

### Severity

P2
",kamilmielnik,2025-01-08 11:53:58+00:00,[],2025-02-04 20:26:42+00:00,,https://github.com/metabase/metabase/issues/51851,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Organization/Collections', ''), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2775186729,issue,open,,"Non-SPA routing when trying to move, duplicate or archive dashboard","### Describe the bug

Page reloads when trying to move, duplicate or archive dashboard

### To Reproduce

1. Create and save a dashboard
2. Click on '...'
3. Click ""Move"", ""Duplicate"" or ""Archive""

Page reloads


### Expected behavior

Page does not reload. SPA routing kicks in.

### Information about your Metabase installation

master, a0ae2a8f289d4ad1b7baf962e28ebabfa00e0121

### Severity

P2
",kamilmielnik,2025-01-08 11:45:32+00:00,[],2025-02-04 20:28:42+00:00,,https://github.com/metabase/metabase/issues/51850,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Reporting/Dashboards', ''), ('.Frontend', ''), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2775133261,issue,closed,completed,Dashboard filters does not have a transition effect when switching between light and dark theme,"When we switch to dark mode (via fullscreen dark mode button, or via embedding sdk's theming configuration), the dashboard filter is the only component on the page that does not have a transition effect.

https://github.com/user-attachments/assets/7b4b6157-09f2-4db9-9ef8-92cf82d5d35f
",heypoom,2025-01-08 11:19:08+00:00,['sanex3339'],2025-01-15 19:29:39+00:00,2025-01-15 18:54:09+00:00,https://github.com/metabase/metabase/issues/51848,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Team/Embedding', ''), ('good first issue', 'A starter issue that is good for someone new to the codebase or is a new contributor')]",[],
2775108213,issue,closed,completed,Field with URL semantic types does not open up a link in the sdk,"To investigate why custom click URLs does not work on embedding sdk. A customer has made a field format as a link (and it works when in the Metabase app). But it does not work via embedding sdk - when clicking on the link, it opens up the filter popover instead of navigating to the link.",heypoom,2025-01-08 11:06:31+00:00,['heypoom'],2025-01-10 16:10:40+00:00,2025-01-10 16:04:56+00:00,https://github.com/metabase/metabase/issues/51846,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2583081060, 'issue_id': 2775108213, 'author': 'heypoom', 'body': 'Superseded by a combination of https://github.com/metabase/metabase/issues/51099 plus https://github.com/metabase/metabase/issues/51970 together. That would allow them to handle URL opening in a way that makes sense for their app (e.g. open up the link in a new window, same window, in an iframe)\n\nIn the future, we could add a prop like `allowExternalUrlClickBehavior` to allow external URL clicks by default - but this is lower priority and more of a convenience.', 'created_at': datetime.datetime(2025, 1, 10, 16, 4, 56, tzinfo=datetime.timezone.utc)}]","heypoom (Issue Creator) on (2025-01-10 16:04:56 UTC): Superseded by a combination of https://github.com/metabase/metabase/issues/51099 plus https://github.com/metabase/metabase/issues/51970 together. That would allow them to handle URL opening in a way that makes sense for their app (e.g. open up the link in a new window, same window, in an iframe)

In the future, we could add a prop like `allowExternalUrlClickBehavior` to allow external URL clicks by default - but this is lower priority and more of a convenience.

"
2774977951,issue,closed,not_planned,Multiple analytics DATABASE connections,"Metabase supports connecting to multiple PostgreSQL databases for analytics and visualization.

These include two types of databases:

1) one used exclusively by Metabase to store its metadata (configured via MB_DB_CONNECTION_URI)
2) others that are connected to Metabase for querying and visualization.


Is there a way to configure these visualization databases directly through the Docker image or by using environment variables?
",amishajais21,2025-01-08 10:20:52+00:00,[],2025-01-08 10:54:07+00:00,2025-01-08 10:54:06+00:00,https://github.com/metabase/metabase/issues/51845,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2577378524, 'issue_id': 2774977951, 'author': 'paoliniluis', 'body': 'The app db is configured by environment variables, the dw can be configured via api calls or the config files\n\nPlease check the documentation', 'created_at': datetime.datetime(2025, 1, 8, 10, 54, 6, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-08 10:54:06 UTC): The app db is configured by environment variables, the dw can be configured via api calls or the config files

Please check the documentation

"
2774422625,issue,open,,SparkSql driver connect to apache hive,"### Describe the bug

hello! sparksql driver connect to apache hive exception!!!

### To Reproduce

1. Sparksql driver connect to apache hive
2. not found table
![Image](https://github.com/user-attachments/assets/13dc22c8-35de-4169-a4ff-9d2d1d49b01a)


### Expected behavior

{
  ""url"": ""http://:3000/question#eyJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjo0MywicXVlcnkiOnsic291cmNlLXRhYmxlIjoxMjd9LCJ0eXBlIjoicXVlcnkifSwiZGlzcGxheSI6InRhYmxlIiwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6e319"",
  ""entityName"": ""question"",
  ""browserInfo"": {
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""language"": ""zh-CN"",
    ""browserName"": ""Chrome"",
    ""browserVersion"": ""131.0.0.0"",
    ""platform"": ""desktop"",
    ""os"": ""Windows"",
    ""osVersion"": ""NT 10.0""
  },
  ""entityInfo"": {
    ""dataset_query"": {
      ""database"": 43,
      ""query"": {
        ""source-table"": 127
      },
      ""type"": ""query""
    },
    ""display"": ""table"",
    ""visualization_settings"": {}
  },
  ""frontendErrors"": [
    ""{\""status\"":400,\""data\"":{\""message\"":\""Could not open client transport with JDBC Uri: jdbc:hive2://172.16.8.61:10000/defaultnull: Failed to open new session: Database defaultnull does not exist\""},\""isCancelled\"":false}"",
    ""\""Request entities,databases,43,update failed:\""{\""status\"":400,\""data\"":{\""message\"":\""Could not open client transport with JDBC Uri: jdbc:hive2://172.16.8.61:10000/defaultnull: Failed to open new session: Database defaultnull does not exist\""},\""isCancelled\"":false}""
  ],
  ""backendErrors"": [
    {
      ""timestamp"": ""2025-01-08T06:14:47.944Z"",
      ""level"": ""ERROR"",
      ""fqns"": ""metabase.query-processor.middleware.catch-exceptions"",
      ""msg"": ""Error processing query: 找不到表\""buriallog\""的字段。\n{:database_id 43,\n :started_at #t \""2025-01-08T14:14:47.944794400+08:00[Asia/Shanghai]\"",\n :via\n [{:status :failed,\n   :class clojure.lang.ExceptionInfo,\n   :error \""在 clojure.lang.AFunction$1@461120c 中预处理查询时出错：找不到表\\\""buriallog\\\""的字段。\"",\n   :stacktrace\n   [\""--> query_processor.preprocess$preprocess74351__74352$fn__74353$fn__74354.invoke(preprocess.clj:178)\""\n    \""query_processor.preprocess$preprocess74351__74352$fn__74353.invoke(preprocess.clj:151)\""\n    \""query_processor.setup$do_with_qp_setup73859__73860.invokeStatic(setup.clj:225)\""\n    \""query_processor.setup$do_with_qp_setup73859__73860.invoke(setup.clj:216)\""\n    \""query_processor.preprocess$preprocess74351__74352.invokeStatic(preprocess.clj:149)\""\n    \""query_processor.preprocess$preprocess74351__74352.invoke(preprocess.clj:145)\""\n    \""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:46)\""\n    \""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:44)\""\n    \""query_processor.middleware.enterprise$fn__73361$handle_audit_app_internal_queries__73362$fn__73364.invoke(enterprise.clj:96)\""\n    \""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__73372.invoke(enterprise.clj:103)\""\n    \""query_processor.middleware.process_userland_query$process_userland_query_middleware78460__78461$fn__78462.invoke(process_userland_query.clj:204)\""\n    \""query_processor.middleware.catch_exceptions$catch_exceptions78525__78526$fn__78527.invoke(catch_exceptions.clj:132)\""\n    \""query_processor$process_query78566__78567$fn__78568.invoke(query_processor.clj:80)\""\n    \""query_processor.setup$do_with_canceled_chan73854__73855$fn__73856.invoke(setup.clj:187)\""\n    \""query_processor.setup$do_with_database_local_settings73847__73848$fn__73849.invoke(setup.clj:181)\""\n    \""query_processor.setup$do_with_driver73840__73841$fn__73842$fn__73843.invoke(setup.clj:166)\""\n    \""driver$do_with_driver.invokeStatic(driver.clj:106)\""\n    \""driver$do_with_driver.invoke(driver.clj:101)\""\n    \""query_processor.setup$do_with_driver73840__73841$fn__73842.invoke(setup.clj:165)\""\n    \""query_processor.setup$do_with_metadata_provider73831__73832$fn__73833$fn__73836.invoke(setup.clj:151)\""\n    \""query_processor.store$do_with_metadata_provider59788__59789.invokeStatic(store.clj:170)\""\n    \""query_processor.store$do_with_metadata_provider59788__59789.invoke(store.clj:150)\""\n    \""query_processor.store$do_with_metadata_provider59788__59789.invokeStatic(store.clj:159)\""\n    \""query_processor.store$do_with_metadata_provider59788__59789.invoke(store.clj:150)\""\n    \""query_processor.setup$do_with_metadata_provider73831__73832$fn__73833.invoke(setup.clj:150)\""\n    \""query_processor.setup$do_with_resolved_database73821__73822$fn__73823.invoke(setup.clj:128)\""\n    \""query_processor.setup$do_with_qp_setup73859__73860.invokeStatic(setup.clj:232)\""\n    \""query_processor.setup$do_with_qp_setup73859__73860.invoke(setup.clj:216)\""\n    \""query_processor$process_query78566__78567.invokeStatic(query_processor.clj:78)\""\n    \""query_processor$process_query78566__78567.invoke(query_processor.clj:71)\""\n    \""api.dataset$run_streaming_query102858__102861$fn__102865.invoke(dataset.clj:84)\""\n    \""query_processor.streaming$_streaming_response$fn__83169$fn__83170$fn__83171.invoke(streaming.clj:185)\""\n    \""query_processor.streaming$_streaming_response$fn__83169$fn__83170.invoke(streaming.clj:183)\""\n    \""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:174)\""\n    \""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:161)\""\n    \""query_processor.streaming$_streaming_response$fn__83169.invoke(streaming.clj:180)\""\n    \""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)\""\n    \""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:76)\""\n    \""async.streaming_response$do_f_async$task__53447.invoke(streaming_response.clj:93)\""],\n   :error_type :qp,\n   :ex-data\n   {:fn #object[clojure.lang.AFunction$1 0x461120c \""clojure.lang.AFunction$1@461120c\""],\n    :query\n    {:database 43,\n     :middleware {:js-int-to-string? true, :userland-query? true, :add-default-userland-constraints? true},\n     :info {:executed-by 1, :context :ad-hoc, :query-hash #object[\""[B\"" 0x2eaa375b \""[B@2eaa375b\""]},\n     :constraints {:max-results 10000, :max-results-bare-rows 2000},\n     :type :query,\n     :query {:source-table 127}},\n    :type :qp}}],\n :action_id nil,\n :error_type :invalid-query,\n :json_query\n {:database 43,\n  :query {:source-table 127},\n  :type \""query\"",\n  :parameters [],\n  :middleware {:js-int-to-string? true, :userland-query? true, :add-default-userland-constraints? true}},\n :native nil,\n :status :failed,\n :class clojure.lang.ExceptionInfo,\n :stacktrace\n [\""--> query_processor.middleware.add_implicit_clauses$sorted_implicit_fields_for_table66454__66455.invokeStatic(add_implicit_clauses.clj:35)\""\n  \""query_processor.middleware.add_implicit_clauses$sorted_implicit_fields_for_table66454__66455.invoke(add_implicit_clauses.clj:29)\""\n  \""query_processor.middleware.add_implicit_clauses$add_implicit_fields66545__66547.invokeStatic(add_implicit_clauses.clj:120)\""\n  \""query_processor.middleware.add_implicit_clauses$add_implicit_fields66545__66547.invoke(add_implicit_clauses.clj:113)\""\n  \""query_processor.middleware.add_implicit_clauses$add_implicit_mbql_clauses$fn__66630.invoke(add_implicit_clauses.clj:205)\""\n  \""query_processor.middleware.add_implicit_clauses$add_implicit_mbql_clauses.invokeStatic(add_implicit_clauses.clj:198)\""\n  \""query_processor.middleware.add_implicit_clauses$add_implicit_mbql_clauses.invoke(add_implicit_clauses.clj:195)\""\n  \""query_processor.middleware.add_implicit_clauses$add_implicit_clauses.invokeStatic(add_implicit_clauses.clj:215)\""\n  \""query_processor.middleware.add_implicit_clauses$add_implicit_clauses.invoke(add_implicit_clauses.clj:209)\""\n  \""query_processor.preprocess$ensure_legacy$fn__74335.invoke(preprocess.clj:64)\""\n  \""query_processor.preprocess$preprocess74351__74352$fn__74353$fn__74354.invoke(preprocess.clj:161)\""\n  \""query_processor.preprocess$preprocess74351__74352$fn__74353.invoke(preprocess.clj:151)\""\n  \""query_processor.setup$do_with_qp_setup73859__73860.invokeStatic(setup.clj:225)\""\n  \""query_processor.setup$do_with_qp_setup73859__73860.invoke(setup.clj:216)\""\n  \""query_processor.preprocess$preprocess74351__74352.invokeStatic(preprocess.clj:149)\""\n  \""query_processor.preprocess$preprocess74351__74352.invoke(preprocess.clj:145)\""\n  \""query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:46)\""\n  \""query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:44)\""\n  \""query_processor.middleware.enterprise$fn__73361$handle_audit_app_internal_queries__73362$fn__73364.invoke(enterprise.clj:96)\""\n  \""query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__73372.invoke(enterprise.clj:103)\""\n  \""query_processor.middleware.process_userland_query$process_userland_query_middleware78460__78461$fn__78462.invoke(process_userland_query.clj:204)\""\n  \""query_processor.middleware.catch_exceptions$catch_exceptions78525__78526$fn__78527.invoke(catch_exceptions.clj:132)\""\n  \""query_processor$process_query78566__78567$fn__78568.invoke(query_processor.clj:80)\""\n  \""query_processor.setup$do_with_canceled_chan73854__73855$fn__73856.invoke(setup.clj:187)\""\n  \""query_processor.setup$do_with_database_local_settings73847__73848$fn__73849.invoke(setup.clj:181)\""\n  \""query_processor.setup$do_with_driver73840__73841$fn__73842$fn__73843.invoke(setup.clj:166)\""\n  \""driver$do_with_driver.invokeStatic(driver.clj:106)\""\n  \""driver$do_with_driver.invoke(driver.clj:101)\""\n  \""query_processor.setup$do_with_driver73840__73841$fn__73842.invoke(setup.clj:165)\""\n  \""query_processor.setup$do_with_metadata_provider73831__73832$fn__73833$fn__73836.invoke(setup.clj:151)\""\n  \""query_processor.store$do_with_metadata_provider59788__59789.invokeStatic(store.clj:170)\""\n  \""query_processor.store$do_with_metadata_provider59788__59789.invoke(store.clj:150)\""\n  \""query_processor.store$do_with_metadata_provider59788__59789.invokeStatic(store.clj:159)\""\n  \""query_processor.store$do_with_metadata_provider59788__59789.invoke(store.clj:150)\""\n  \""query_processor.setup$do_with_metadata_provider73831__73832$fn__73833.invoke(setup.clj:150)\""\n  \""query_processor.setup$do_with_resolved_database73821__73822$fn__73823.invoke(setup.clj:128)\""\n  \""query_processor.setup$do_with_qp_setup73859__73860.invokeStatic(setup.clj:232)\""\n  \""query_processor.setup$do_with_qp_setup73859__73860.invoke(setup.clj:216)\""\n  \""query_processor$process_query78566__78567.invokeStatic(query_processor.clj:78)\""\n  \""query_processor$process_query78566__78567.invoke(query_processor.clj:71)\""\n  \""api.dataset$run_streaming_query102858__102861$fn__102865.invoke(dataset.clj:84)\""\n  \""query_processor.streaming$_streaming_response$fn__83169$fn__83170$fn__83171.invoke(streaming.clj:185)\""\n  \""query_processor.streaming$_streaming_response$fn__83169$fn__83170.invoke(streaming.clj:183)\""\n  \""query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:174)\""\n  \""query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:161)\""\n  \""query_processor.streaming$_streaming_response$fn__83169.invoke(streaming.clj:180)\""\n  \""async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)\""\n  \""async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:76)\""\n  \""async.streaming_response$do_f_async$task__53447.invoke(streaming_response.clj:93)\""],\n :card_id nil,\n :context :ad-hoc,\n :error \""找不到表\\\""buriallog\\\""的字段。\"",\n :row_count 0,\n :running_time 0,\n :preprocessed nil,\n :ex-data 6$respond_SINGLEQUOTE___54207.invoke(core.clj:197)"",

### Logs

_No response_

### Information about your Metabase installation

```JSON
""url"": ""http://xxx:3000/question#eyJkYXRhc2V0X3F1ZXJ5Ijp7ImRhdGFiYXNlIjo0MywicXVlcnkiOnsic291cmNlLXRhYmxlIjoxMjd9LCJ0eXBlIjoicXVlcnkifSwiZGlzcGxheSI6InRhYmxlIiwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6e319"",
  ""entityName"": ""question"",
  ""browserInfo"": {
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""language"": ""zh-CN"",
    ""browserName"": ""Chrome"",
    ""browserVersion"": ""131.0.0.0"",
    ""platform"": ""desktop"",
    ""os"": ""Windows"",
    ""osVersion"": ""NT 10.0""
  },
```

### Severity

blocking  usage of Metabase

### Additional context

_No response_",yangshifei,2025-01-08 06:31:06+00:00,[],2025-02-04 20:25:32+00:00,,https://github.com/metabase/metabase/issues/51843,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Database/Spark', ''), ('.Team/Drivers', '')]","[{'comment_id': 2577081480, 'issue_id': 2774422625, 'author': 'crisptrutski', 'body': 'The `defaultnull` database name looks quite odd, I wonder if this could be a configuration issue? Passing on to the drivers team since I believe they can triage things better from here.', 'created_at': datetime.datetime(2025, 1, 8, 8, 39, 36, tzinfo=datetime.timezone.utc)}, {'comment_id': 2577157187, 'issue_id': 2774422625, 'author': 'yangshifei', 'body': ""I filled in 'default', but the error was' defaultnull '\n![Image](https://github.com/user-attachments/assets/6cba3acc-8209-4ee1-91cc-cbbbd90d71d0)\n![Image](https://github.com/user-attachments/assets/74933696-d4b5-4adf-954d-77d610cf82c1)"", 'created_at': datetime.datetime(2025, 1, 8, 9, 10, 6, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2025-01-08 08:39:36 UTC): The `defaultnull` database name looks quite odd, I wonder if this could be a configuration issue? Passing on to the drivers team since I believe they can triage things better from here.

yangshifei (Issue Creator) on (2025-01-08 09:10:06 UTC): I filled in 'default', but the error was' defaultnull '
![Image](https://github.com/user-attachments/assets/6cba3acc-8209-4ee1-91cc-cbbbd90d71d0)
![Image](https://github.com/user-attachments/assets/74933696-d4b5-4adf-954d-77d610cf82c1)

"
2774418792,issue,closed,not_planned,Database “View Data” is not visible in the database permission section,"### Describe the bug

I am running Metabase in Docker using its latest version, v0.52.4. I have created multiple database connections and want to grant specific user groups their own 'View Data' permissions. However, in the Metabase UI, I can only see the 'Create Queries' option but not 'View Data.'

![Image](https://github.com/user-attachments/assets/5769bb7e-d90e-46df-9b82-d3f9bac86f69)

but for the version v0.48.8 , i can see different way of allowing ""View Data""option

![Image](https://github.com/user-attachments/assets/8d0e7a8a-11cd-4e2e-a544-410b093744da)

https://www.metabase.com/docs/latest/permissions/no-self-service-deprecation#:~:text=split%20the%20old-,Data%20access,-setting%20into%20two
From above reference I know that the ""Data Access"" has been divided into 2 ; View data and Create Queries.

Seems like it is a bug related to newer version or is it not?



### To Reproduce

1. Go to 'Admin Settings'
2. Click on 'Permissions' tab
3. Then Go to ""Data"" tab in the left side of the screen
4. Then select ""Databases"" tab
5. Select one of the available databases

### Expected behavior

The UI should visible both ""View data"" and ""Create queries"" permissions
![Image](https://github.com/user-attachments/assets/8d3a06b9-7d43-4a3b-b20c-826aef99ec88)


### Logs

The following are the logs I see when I check the database permissions.
[metabaselogs.txt](https://github.com/user-attachments/files/18342842/metabaselogs.txt)



### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2024-12-21"",
      ""tag"": ""v0.52.4"",
      ""hash"": ""2f8c560""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""mysql"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""MariaDB"",
        ""version"": ""10.11.7-MariaDB-1:10.11.7+maria~ubu2204""
      },
      ""jdbc-driver"": {
        ""name"": ""MariaDB Connector/J"",
        ""version"": ""2.7.10""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.25+9-post-Ubuntu-1ubuntu122.04"",
    ""java.vendor"": ""Ubuntu"",
    ""java.vendor.url"": ""https://ubuntu.com/"",
    ""java.version"": ""11.0.25"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.25+9-post-Ubuntu-1ubuntu122.04"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.1.0-28-arm64"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

Blocking a feature requirement to allow different user levels to view sensitive data / non-sensitive data

### Additional context

Im using ""SQL Permission"" option mentioned in https://www.metabase.com/learn/metabase-basics/administration/administration-and-operation/managing-people#:~:text=brings%20us%20to%3A-,SQL%20permissions,-Metabase%20lacks%20table to grant different user groups, different permissions",charmLd,2025-01-08 06:28:15+00:00,[],2025-01-08 10:56:35+00:00,2025-01-08 10:56:34+00:00,https://github.com/metabase/metabase/issues/51842,"[('Type:Bug', 'Product defects'), ('Administration/Permissions', 'Collection or Data permissions'), ('.Needs Triage', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2577139585, 'issue_id': 2774418792, 'author': 'crisptrutski', 'body': 'Leaving off priority and regression labels, pending confirmation that these options should be present if your situation.', 'created_at': datetime.datetime(2025, 1, 8, 9, 2, 20, tzinfo=datetime.timezone.utc)}, {'comment_id': 2577383286, 'issue_id': 2774418792, 'author': 'paoliniluis', 'body': 'Check the documentation about data permissions. This is all stated on our docs', 'created_at': datetime.datetime(2025, 1, 8, 10, 56, 34, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2025-01-08 09:02:20 UTC): Leaving off priority and regression labels, pending confirmation that these options should be present if your situation.

paoliniluis on (2025-01-08 10:56:34 UTC): Check the documentation about data permissions. This is all stated on our docs

"
2773882266,issue,closed,completed,Cannot Change Format of Date for X or Y Axis,"### Describe the bug

Cannot change ""Date Style"" for Dates platted along an axis. You can still format for table viz, etc.

### To Reproduce

1. Create a bar, line or area with Sample.Orders that groups by date
2. On the ""Data"" tab note that there are no ellipses to get to format settings for the date axis

You can still format the date in table visualizations, etc. This worked in v51.


### Expected behavior

We should be able to change the style of the dates for the X and Y axes.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""athena"",
      ""redshift"",
      ""h2"",
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-03"",
      ""tag"": ""v1.52.4.6"",
      ""hash"": ""7088999""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.1 (Debian 15.1-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.167.4-microsoft-standard-WSL2"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

annoying

### Additional context

_No response_",ixipixi,2025-01-07 22:39:33+00:00,['alxnddr'],2025-01-11 03:10:40+00:00,2025-01-11 02:19:58+00:00,https://github.com/metabase/metabase/issues/51839,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Regression', 'Bugs that were previously fixed and/or bugs unintentionally shipped with new features.'), ('.Team/DashViz', 'Dashboard and Viz team'), ('Bug:v52', 'bugs or regressions introduced in v52')]",[],
2773785458,issue,open,,Error getting setting graph.x_axis._is_histogram TypeError: Cannot read properties of undefined (reading 'binning_info'),"### Describe the bug

A weird frontend error that is causing card rendering to fail

### To Reproduce

Go to dashboard 1880 on our stats instance and check the cards on the bottom

### Expected behavior

It should work :)

### Logs

No BE logs, only
```
Error getting setting graph.x_axis._is_histogram TypeError: Cannot read properties of undefined (reading 'binning_info')
    at b3 (cartesian-chart.ts:239:26)
    at Object.getDefault (graph.js:530:10)
    at e (settings.js:98:39)
    at E (settings.js:110:1)
    at f (visualization.js:97:10)
    at e$.transform (Visualization.jsx:151:9)
    at e$.UNSAFE_componentWillReceiveProps (Visualization.jsx:102:12)
    at i1 (react-dom.production.min.js:148:172)
    at am (react-dom.production.min.js:201:122)
    at l (react-dom.production.min.js:292:172)
```

### Information about your Metabase installation

```JSON
master
```

### Severity

P2ish

### Additional context

NA",paoliniluis,2025-01-07 21:35:47+00:00,[],2025-02-04 20:31:19+00:00,,https://github.com/metabase/metabase/issues/51836,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Difficulty:Medium', ''), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2577105721, 'issue_id': 2773785458, 'author': 'crisptrutski', 'body': ""All the charts on https://stats.metabase.com/dashboard/1880 are rendering for me, can you confirm that you're still seeing this issue?"", 'created_at': datetime.datetime(2025, 1, 8, 8, 48, 1, tzinfo=datetime.timezone.utc)}, {'comment_id': 2577683708, 'issue_id': 2773785458, 'author': 'paoliniluis', 'body': ""@crisptrutski I see this ![Image](https://github.com/user-attachments/assets/1e829250-6491-4a73-85f9-78a54b2c2372)\n\nI'm using brave BTW"", 'created_at': datetime.datetime(2025, 1, 8, 13, 33, 8, tzinfo=datetime.timezone.utc)}, {'comment_id': 2617238937, 'issue_id': 2773785458, 'author': 'tsplude', 'body': 'Hey @paoliniluis, are you still seeing this?\n\n<details>\n<summary>Appears working on Brave</summary>\n<img width=""495"" alt=""Image"" src=""https://github.com/user-attachments/assets/e6efb614-0168-43d8-a395-881095fe406e"" />\n<img width=""881"" alt=""Image"" src=""https://github.com/user-attachments/assets/e8a85296-cf0b-4965-b128-65d98ea0a156"" />\n</details>', 'created_at': datetime.datetime(2025, 1, 28, 0, 13, 45, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2025-01-08 08:48:01 UTC): All the charts on https://stats.metabase.com/dashboard/1880 are rendering for me, can you confirm that you're still seeing this issue?

paoliniluis (Issue Creator) on (2025-01-08 13:33:08 UTC): @crisptrutski I see this ![Image](https://github.com/user-attachments/assets/1e829250-6491-4a73-85f9-78a54b2c2372)

I'm using brave BTW

tsplude on (2025-01-28 00:13:45 UTC): Hey @paoliniluis, are you still seeing this?

<details>
<summary>Appears working on Brave</summary>
<img width=""495"" alt=""Image"" src=""https://github.com/user-attachments/assets/e6efb614-0168-43d8-a395-881095fe406e"" />
<img width=""881"" alt=""Image"" src=""https://github.com/user-attachments/assets/e8a85296-cf0b-4965-b128-65d98ea0a156"" />
</details>

"
2773737304,issue,closed,not_planned,CPU too high + OOM when generating subscriptions,"### Describe the bug

Seems like there's something on the code path which is eating lots of CPU and memory

### To Reproduce

1) spin up Metabase with CPU and memory constraints, e.g. I started it with 750MB of RAM and 4 cpus
2) create a very simple question and save it as a pie chart, a pivot table, a bar chart and a line chart
![Image](https://github.com/user-attachments/assets/168ad882-16ab-44b2-a9f8-6f2ed2f50e90)
3) add those 4 cards to a dashboard, 2 times each (you'll have a dashboard with 8 cards total)
4) use the subscription test button to send the subscription 50-100 times

you'll see in the logs lots of messages like
[568.320s][warning][gc,alloc] qtp2104039768-125: Retried waiting for GCLocker too often allocating 793202 words
2025-01-07 21:03:48,395 ERROR render.card :: Pulse card render error
java.lang.OutOfMemoryError: Java heap space

also watch the CPU's, it's going to be at 100%

### Expected behavior

We should not go out of memory

### Logs

```
2025-01-07 21:03:30,991 DEBUG middleware.log :: POST /api/pulse/test 200 20809ms (283 DB calls) App DB connections: 0/15 Jetty threads: 43/50 (3 idle, 0 queued) (137 total active threads) Queries in flight: 0 (0 queued); postgres DB 2 connections: 6/11 (0 threads blocked) {:metabase-user-id 1}
2025-01-07 21:03:31,184 INFO notification.send :: [Notification null] Sending message to channel :channel/email
2025-01-07 21:03:31,310 INFO notification.send :: [Notification null] Sent successfully
2025-01-07 21:03:31,313 DEBUG middleware.log :: POST /api/pulse/test 200 21866ms (283 DB calls) App DB connections: 0/15 Jetty threads: 42/50 (4 idle, 0 queued) (137 total active threads) Queries in flight: 0 (0 queued); postgres DB 2 connections: 7/7 (0 threads blocked) {:metabase-user-id 1}
[580.908s][warning][gc,alloc] qtp2104039768-161: Retried waiting for GCLocker too often allocating 720898 words
2025-01-07 21:03:35,360 ERROR render.card :: Pulse card render error
java.lang.OutOfMemoryError: Java heap space
[581.369s][warning][gc,alloc] qtp2104039768-152: Retried waiting for GCLocker too often allocating 793202 words
2025-01-07 21:03:35,821 ERROR render.card :: Pulse card render error
java.lang.OutOfMemoryError: Java heap space
2025-01-07 21:03:37,966 INFO notification.send :: [Notification null] Sending message to channel :channel/email
2025-01-07 21:03:38,305 INFO notification.send :: [Notification null] Sent successfully
2025-01-07 21:03:38,307 DEBUG middleware.log :: POST /api/pulse/test 200 28459ms (283 DB calls) App DB connections: 0/15 Jetty threads: 41/50 (5 idle, 0 queued) (137 total active threads) Queries in flight: 0 (0 queued); postgres DB 2 connections: 9/11 (0 threads blocked) {:metabase-user-id 1}
2025-01-07 21:03:38,390 INFO notification.send :: [Notification null] Sending message to channel :channel/email
2025-01-07 21:03:38,546 INFO notification.send :: [Notification null] Sent successfully
2025-01-07 21:03:38,549 DEBUG middleware.log :: POST /api/pulse/test 200 28484ms (283 DB calls) App DB connections: 0/15 Jetty threads: 40/50 (6 idle, 0 queued) (137 total active threads) Queries in flight: 0 (0 queued); postgres DB 2 connections: 4/11 (0 threads blocked) {:metabase-user-id 1}
2025-01-07 21:03:39,155 INFO notification.send :: [Notification null] Sending message to channel :channel/email
2025-01-07 21:03:39,439 INFO notification.send :: [Notification null] Sent successfully
2025-01-07 21:03:39,444 DEBUG middleware.log :: POST /api/pulse/test 200 29494ms (283 DB calls) App DB connections: 0/15 Jetty threads: 39/50 (7 idle, 0 queued) (137 total active threads) Queries in flight: 0 (0 queued); postgres DB 2 connections: 2/11 (0 threads blocked) {:metabase-user-id 1}
2025-01-07 21:03:40,260 INFO notification.send :: [Notification null] Sending message to channel :channel/email
2025-01-07 21:03:40,388 INFO notification.send :: [Notification null] Sent successfully
2025-01-07 21:03:40,390 DEBUG middleware.log :: POST /api/pulse/test 200 30842ms (283 DB calls) App DB connections: 0/15 Jetty threads: 38/50 (8 idle, 0 queued) (137 total active threads) Queries in flight: 0 (0 queued); postgres DB 2 connections: 1/8 (0 threads blocked) {:metabase-user-id 1}
2025-01-07 21:03:40,924 INFO notification.send :: [Notification null] Sending message to channel :channel/email
2025-01-07 21:03:41,059 INFO notification.send :: [Notification null] Sent successfully
2025-01-07 21:03:41,061 DEBUG middleware.log :: POST /api/pulse/test 200 30715ms (283 DB calls) App DB connections: 0/15 Jetty threads: 37/50 (9 idle, 0 queued) (137 total active threads) Queries in flight: 0 (0 queued); postgres DB 2 connections: 7/15 (0 threads blocked) {:metabase-user-id 1}
2025-01-07 21:03:44,416 DEBUG middleware.log :: GET /api/health 200 0ms (0 DB calls) App DB connections: 0/15 Jetty threads: 37/50 (10 idle, 0 queued) (137 total active threads) Queries in flight: 0 (0 queued) {:metabase-user-id nil}
2025-01-07 21:03:45,183 INFO notification.send :: [Notification null] Sending message to channel :channel/email
2025-01-07 21:03:45,351 INFO notification.send :: [Notification null] Sent successfully
2025-01-07 21:03:45,354 DEBUG middleware.log :: POST /api/pulse/test 200 33148ms (283 DB calls) App DB connections: 0/15 Jetty threads: 36/50 (10 idle, 0 queued) (137 total active threads) Queries in flight: 0 (0 queued); postgres DB 2 connections: 9/15 (0 threads blocked) {:metabase-user-id 1}
[591.730s][warning][gc,alloc] qtp2104039768-29: Retried waiting for GCLocker too often allocating 1081346 words
2025-01-07 21:03:46,182 ERROR render.card :: Pulse card render error
java.lang.OutOfMemoryError: Java heap space
[593.943s][warning][gc,alloc] qtp2104039768-170: Retried waiting for GCLocker too often allocating 793202 words
2025-01-07 21:03:48,395 ERROR render.card :: Pulse card render error
java.lang.OutOfMemoryError: Java heap space
2025-01-07 21:03:50,901 INFO notification.send :: [Notification null] Sending message to channel :channel/email
2025-01-07 21:03:51,200 INFO notification.send :: [Notification null] Sent successfully
2025-01-07 21:03:51,203 DEBUG middleware.log :: POST /api/pulse/test 200 38992ms (283 DB calls) App DB connections: 0/15 Jetty threads: 35/50 (11 idle, 0 queued) (137 total active threads) Queries in flight: 0 (0 queued); postgres DB 2 connections: 10/15 (0 threads blocked) {:metabase-user-id 1}
[596.843s][warning][gc,alloc] qtp2104039768-155: Retried waiting for GCLocker too often allocating 1081346 words
2025-01-07 21:03:51,295 ERROR render.card :: Pulse card render error
java.lang.OutOfMemoryError: Java heap space
[597.164s][warning][gc,alloc] qtp2104039768-164: Retried waiting for GCLocker too often allocating 1081346 words
2025-01-07 21:03:51,615 ERROR render.card :: Pulse card render error
java.lang.OutOfMemoryError: Java heap space
2025-01-07 21:03:52,491 INFO notification.send :: [Notification null] Sending message to channel :channel/email
2025-01-07 21:03:52,780 INFO notification.send :: [Notification null] Sent successfully
2025-01-07 21:03:52,786 DEBUG middleware.log :: POST /api/pulse/test 200 42335ms (283 DB calls) App DB connections: 0/15 Jetty threads: 34/50 (12 idle, 0 queued) (137 total active threads) Queries in flight: 0 (0 queued); postgres DB 2 connections: 3/15 (0 threads blocked) {:metabase-user-id 1}
```

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2025-01-03"",
      ""tag"": ""v1.52.4.6"",
      ""hash"": ""7088999""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""17.0""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""6.9.3-76060903-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Etc/UTC""
  }
}
```

### Severity

P1

### Additional context

NA",paoliniluis,2025-01-07 21:07:20+00:00,[],2025-01-29 15:12:15+00:00,2025-01-29 15:12:14+00:00,https://github.com/metabase/metabase/issues/51833,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Reporting/Pulses', 'Now called Subscriptions'), ('Visualization/Static', 'Subscriptions/pulse generated image'), ('.Team/Workflows', 'aka BEC')]","[{'comment_id': 2577113413, 'issue_id': 2773737304, 'author': 'crisptrutski', 'body': ""This might be resolved by some of the in-flight optimizations we're making, but I'm not sure - we've been focusing on larger sets of cards, rather than a high frequency of triggering.\n\n@qnkhuat any thoughts?"", 'created_at': datetime.datetime(2025, 1, 8, 8, 51, 12, tzinfo=datetime.timezone.utc)}, {'comment_id': 2577249027, 'issue_id': 2773737304, 'author': 'qnkhuat', 'body': ""what we did:\n1. limit the number of concurrent send notification jobs to 2\n2. for dashboard subscriptions, each rows cards are saved on disk when rendering instead of keeping them in memory\n\nif you're using the test endpoint to test then 2) will probably help a lot."", 'created_at': datetime.datetime(2025, 1, 8, 9, 52, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2615364642, 'issue_id': 2773737304, 'author': 'piranha', 'body': '@paoliniluis did the behavior change in any way in that case for you? Since right now it should be only 3 threads executing subscriptions, so memory usage should be much lower (and the throughput of subscription execution much lower).', 'created_at': datetime.datetime(2025, 1, 27, 10, 25, tzinfo=datetime.timezone.utc)}, {'comment_id': 2621930288, 'issue_id': 2773737304, 'author': 'paoliniluis', 'body': ""So this has more to do with OOM and cpu spiking than subscriptions. Metabase can't run with 750M of RAM. I increased it to 1.5G and it will still have some memory pressure. 2G is the bare minimum"", 'created_at': datetime.datetime(2025, 1, 29, 15, 12, 14, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2025-01-08 08:51:12 UTC): This might be resolved by some of the in-flight optimizations we're making, but I'm not sure - we've been focusing on larger sets of cards, rather than a high frequency of triggering.

@qnkhuat any thoughts?

qnkhuat on (2025-01-08 09:52:10 UTC): what we did:
1. limit the number of concurrent send notification jobs to 2
2. for dashboard subscriptions, each rows cards are saved on disk when rendering instead of keeping them in memory

if you're using the test endpoint to test then 2) will probably help a lot.

piranha on (2025-01-27 10:25:00 UTC): @paoliniluis did the behavior change in any way in that case for you? Since right now it should be only 3 threads executing subscriptions, so memory usage should be much lower (and the throughput of subscription execution much lower).

paoliniluis (Issue Creator) on (2025-01-29 15:12:14 UTC): So this has more to do with OOM and cpu spiking than subscriptions. Metabase can't run with 750M of RAM. I increased it to 1.5G and it will still have some memory pressure. 2G is the bare minimum

"
2773634578,issue,open,,"Remove existing model detail pages, links to them, and any related tests or utilities",,rafpaf,2025-01-07 20:00:37+00:00,[],2025-01-07 20:00:37+00:00,,https://github.com/metabase/metabase/issues/51830,[],[],
2773634468,issue,open,,Add a relationships tab with a “used by” card and a “relationships” card,,rafpaf,2025-01-07 20:00:33+00:00,[],2025-01-07 20:00:33+00:00,,https://github.com/metabase/metabase/issues/51829,[],[],
2773634068,issue,open,,"Add fields to model sidesheet, above the entity id card",,rafpaf,2025-01-07 20:00:18+00:00,[],2025-01-07 20:00:18+00:00,,https://github.com/metabase/metabase/issues/51828,[],[],
2773618379,issue,closed,completed,Make JWT Identity Provider URI Setting optional,"in: /admin/settings/authentication/jwt
1. make the field *`JWT Identity Provider URI`* optional
2. change the copy
```URL for JWT-based login page. Optional if using JWT SSO only with the embedded analytics SDK.```

[Slack Message](https://metaboat.slack.com/archives/C064EB1UE5P/p1736273435094229?thread_ts=1734697137.917659&cid=C064EB1UE5P)",iethree,2025-01-07 19:51:29+00:00,['iethree'],2025-01-07 23:11:56+00:00,2025-01-07 21:10:11+00:00,https://github.com/metabase/metabase/issues/51826,"[('Administration/Settings', '')]",[],
2773416410,issue,open,,Render a chart with MBQL passed by the application,"**Is your feature request related to a problem? Please describe.**
A customer suggested this as a way to populate filters dynamically. This can be currently done with SQL questions but not with query builder questions. There might be other reasons to render questions with custom MBQL though.

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**How important is this feature to you?**

**Additional context**
[Slack discussion](https://metaboat.slack.com/archives/C07HRPKA762/p1733791667340499)",albertoperdomo,2025-01-07 17:48:29+00:00,[],2025-02-04 20:31:06+00:00,,https://github.com/metabase/metabase/issues/51821,"[('Type:New Feature', ''), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2773091599,issue,open,,Public download urls can reach the limit of url length,"### Describe the bug

If you have around ~10 filters on a public dashboard, the url can get too long and results in a 502.

The structure of the url is a url encoded version of this:


> https://<test-instance>/public/question/8fe18ad5-4f14-4d7d-a9a2-00fa278fd163.csv?parameters=[{""type"":""category"",""value"":null,""id"":""4f532fd6-9700-4ecc-99e9-47a6db9bd892"",""target"":[""variable"",[""template-tag"",""member_detail_pt_br""]]},{""type"":""category"",""value"":null,""id"":""2af2c58e-7a37-4464-be8f-236118052816"",""target"":[""variable"",[""template-tag"",""plan_type_pt_br""]]},{""type"":""category"",""value"":null,""id"":""6b028f0c-5e54-4003-ada3-25f8bfe597dd"",""target"":[""variable"",[""template-tag"",""is_first_experience_normalized""]]},{""type"":""category"",""value"":null,""id"":""d9965ad2-aecd-4b91-b15f-69d4cf5fef76"",""target"":[""variable"",[""template-tag"",""status_pt_br""]]},{""type"":""category"",""value"":null,""id"":""9921480e-b0a6-4554-91be-97d593802f03"",""target"":[""variable"",[""template-tag"",""user_full_name""]]},{""type"":""category"",""value"":null,""id"":""3fbd3c82-418c-4e4a-9294-86870c93e08c"",""target"":[""variable"",[""template-tag"",""first_started_product_at22""]]},{""type"":""category"",""value"":null,""id"":""0ed9c5ff-d577-450a-97b2-77d41e58019b"",""target"":[""variable"",[""template-tag"",""first_started_product_at""]]},{""type"":""category"",""value"":null,""id"":""9702b8b7-e52f-4fc5-9597-746bd5331685"",""target"":[""variable"",[""template-tag"",""product_name""]]},{""type"":""category"",""value"":null,""id"":""7ea12dd8-7cbb-4f3c-898b-1900280461bc"",""target"":[""variable"",[""template-tag"",""cohort""]]},{""type"":""category"",""value"":null,""id"":""495987dd-4fca-4111-b98a-57a339d90ac7"",""target"":[""variable"",[""template-tag"",""payment_method_pt_br""]]},{""type"":""category"",""value"":null,""id"":""888488f0-2526-4f61-837e-4d71180e0e54"",""target"":[""variable"",[""template-tag"",""product_name_t""]]}]


This can easily get over 2500 characters in length. When this happens we get a 502 which contains a 404.
<img width=""554"" alt=""Image"" src=""https://github.com/user-attachments/assets/88266e81-bf17-420f-a2b8-b7272079d21f"" />

NOTE: this is hit in cloud instances, not locally. I think for local testing you can treat a url length of 2500 as a limit. Anything longer than that will fail.

Solutions:
we are taking a simple and quick solution to bump this url length up. But we should attack this from another angle as well.

Possible solutions:
- switch from get to post and put the info in the body. This perhaps has issues for usability and sharing of download links?
- throw away the extraneous type information. The FE does not need to tell the BE the type and target of the filters as the BE should already know this. We could get this down to a simpler mapping of filter id -> value.
- we could use smaller ids if needed. Full UUIDs don't seem totally necessary to disambiguate 10 filters

### To Reproduce

Set up a publicly shared dashboard in cloud with 10 or more filters. Note that this is sensitive to filter name, filter value, field name, etc so it's a bit of an understandable art to get up to the limit.

```sql
Select * from Orders
    [[WHERE {{cohort}}]]
    [[AND {{product_name}}]]
    [[AND {{product_name_t}}]]
    [[AND {{user_full_name}}]]
    [[AND {{payment_method_pt_br}}]]
    [[AND {{status_pt_br}}]]
    [[AND {{plan_type_pt_br}}]]
    [[AND {{member_detail_pt_br}}]]
    [[AND {{is_first_experience_normalized}}]]
    [[AND {{is_smart_installment_normalized}}]]
    [[AND {{first_started_product_at}}]]
    [[AND {{end_product_subscription_at}}]]
    [[AND {{is_first_experience_normalized1}}]]
    [[AND {{is_smart_installment_normalized1}}]]
    [[AND {{first_started_product_at1}}]]
    [[AND {{end_product_subscription_at1}}]]
```

Using this and then removing one or two to get it short enough and then adding a value to go back over the limit should be a way to conditionally trigger this by length.

### Expected behavior

_No response_

### Logs

_No response_

### Information about your Metabase installation

```JSON
master
```

### Severity

p

### Additional context

_No response_",dpsutton,2025-01-07 15:16:03+00:00,[],2025-02-04 20:29:06+00:00,,https://github.com/metabase/metabase/issues/51813,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2596895199, 'issue_id': 2773091599, 'author': 'ranquild', 'body': 'I think the backend should accept `id` and `value` for each parameter only. Everything else should be inferred from the card. Making it a BE issue; please make it a FE issue again when the BE is fixed.', 'created_at': datetime.datetime(2025, 1, 16, 21, 10, 50, tzinfo=datetime.timezone.utc)}]","ranquild on (2025-01-16 21:10:50 UTC): I think the backend should accept `id` and `value` for each parameter only. Everything else should be inferred from the card. Making it a BE issue; please make it a FE issue again when the BE is fixed.

"
2772897568,issue,open,,Add actions to model sidesheet (paused while we discuss),,rafpaf,2025-01-07 13:48:40+00:00,[],2025-01-07 20:00:59+00:00,,https://github.com/metabase/metabase/issues/51811,[],[],
2772650344,issue,open,,[Epic] Improve InteractiveQuestion and InteractiveDashboard sdk component (Part 3),"These are non-blocking improvements or features for InteractiveQuestion and InteractiveDashboard that can be done after the GA release. They do not cause breaking changes in the API.

**Links**
- product docs:
- [Improvements to Question and Dashboard SDK components](https://www.notion.so/metabase/Improvements-to-Question-and-Dashboard-SDK-components-12469354c90180acbdbcdb8cfeecc455?pvs=4)
- [Make low-hanging fruit improvements to Shoppy](https://www.notion.so/metabase/Make-low-hanging-fruit-improvements-to-Shoppy-12a69354c9018011be49edf18852c7c0?pvs=4)
- eng doc: [improving the question component’s querying experience for embedding sdk](https://www.notion.so/metabase/Tech-Improving-the-question-component-s-querying-experience-for-embedding-sdk-13169354c901802582a8ca9389c544bd?pvs=4)

```[tasklist]
#### Milestone 1
- [ ] https://github.com/metabase/metabase/issues/49748
- [ ] https://github.com/metabase/metabase/issues/49823
- [ ] https://github.com/metabase/shoppy/issues/83
- [ ] https://github.com/metabase/metabase/issues/49831
- [ ] https://github.com/metabase/metabase/issues/49830
- [ ] https://github.com/metabase/metabase/issues/52261
```
",heypoom,2025-01-07 11:50:06+00:00,[],2025-01-16 12:11:24+00:00,,https://github.com/metabase/metabase/issues/51810,"[('.Epic', 'Feature Implementation or Project')]",[],
2771511144,issue,closed,completed,We're activating users on destination instances when loading entities with serialization,"### Describe the bug

Imagine you have 2 instances, A and B. If you create a dashboard on instance A with a user that's not on instance B, then when we load the entities on instance B we'll create an active user on the instance.

### To Reproduce

1) set up instance A and B with the same user ([admin@admin.com](mailto:admin@admin.com))
2) then create user [non-admin@non-admin.com](mailto:non-admin@non-admin.com) on instance A
3) log in as [non-admin@non-admin.com](mailto:non-admin@non-admin.com) on instance A
4) create a dashboard (use the x-rays)
5) now export the entire instance
6) import on the destination
7) see that there's a new user in the destination instance

### Expected behavior

If we're going to import the users, they should be inactive. Or we should reassign the entities to a specific user

### Logs

NA

### Information about your Metabase installation

```JSON
v1.51.x
```

### Severity

P1

### Additional context

NA",paoliniluis,2025-01-06 21:53:57+00:00,[],2025-01-08 17:16:15+00:00,2025-01-08 15:50:44+00:00,https://github.com/metabase/metabase/issues/51801,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Operation/Serialization', 'Enterprise contents migration'), ('.Escalation', '')]",[],
2771470229,issue,closed,completed,[Epic] Cleanup type check functions,"Currently type checking functions in MBQL lib mix effective and semantic types. It's not expected in most cases. The goal of this epic is cleanup existing functions so that they check for either an effective or semantic type.

### Implementation Plan

```[tasklist]
#### Milestone 1
- [ ] https://github.com/metabase/metabase/pull/51796
- [ ] https://github.com/metabase/metabase/pull/51808
```

### Testing Plan

Dimensions:
- Breakouts with extraction units
- Boolean columns in dashboards; filters, parameter mapping, click actions, drills dashboards->QB",ranquild,2025-01-06 21:23:20+00:00,['ranquild'],2025-01-08 14:57:42+00:00,2025-01-08 14:57:42+00:00,https://github.com/metabase/metabase/issues/51799,"[('Type:Tech Debt', 'or Refactoring'), ('.Epic', 'Feature Implementation or Project'), ('.Team/Querying', '')]",[],
2771442251,issue,open,,Embedding SDK for Angular,"**Additional context**
Requested by a prospect",psalinasy,2025-01-06 21:02:49+00:00,[],2025-02-04 20:30:41+00:00,,https://github.com/metabase/metabase/issues/51797,"[('Type:New Feature', ''), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2582052745, 'issue_id': 2771442251, 'author': 'DieudonneCesar', 'body': '+1', 'created_at': datetime.datetime(2025, 1, 10, 8, 31, 54, tzinfo=datetime.timezone.utc)}]","DieudonneCesar on (2025-01-10 08:31:54 UTC): +1

"
2771329467,issue,open,,Users personal collection can show as a folder when no valid options are available,"### Describe the bug

If you have a dashboard, but no collections in your personal collection, the entity picker will show as a folder and allow you to navigate into it, showing you an empty panel.

![Image](https://github.com/user-attachments/assets/09853bc1-4988-414a-8c29-de929a25e1c5)


### To Reproduce

1. Set up an instance where there is a dashboard in your personal collection, but no child collections
2. New -> Collection -> Open entity picker
3. Note that your personal collection is treated like a folder


### Expected behavior

It should be selectable, but it shouldn't open an empty panel

### Logs

_No response_

### Information about your Metabase installation

```JSON
83fe7b1d3f4aeedeeacfa5bb3fbfd16b2ed30f24
```

### Severity

Low impact

### Additional context

_No response_",npfitz,2025-01-06 19:48:44+00:00,[],2025-02-05 19:24:59+00:00,,https://github.com/metabase/metabase/issues/51793,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team'), ('Organization/Entity picker', '')]",[],
2771286577,issue,closed,completed,Update sdk embedding sample to use,,heypoom,2025-01-06 19:19:50+00:00,[],2025-01-06 19:20:21+00:00,2025-01-06 19:20:21+00:00,https://github.com/metabase/metabase/issues/51791,[],[],
2771286254,issue,closed,completed,Update sdk embedding sample to 0.52.6,"We left the ""config"" property for the MetabaseProvider component (https://github.com/metabase/metabase-nodejs-react-sdk-embedding-sample/blob/main/client/src/App.jsx) in some pages, where it should be renamed to authConfig according to the latest version https://github.com/metabase/metabase/pull/50585",heypoom,2025-01-06 19:19:36+00:00,[],2025-01-08 14:11:03+00:00,2025-01-08 14:11:03+00:00,https://github.com/metabase/metabase/issues/51790,"[('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]",[],
2771184376,issue,closed,duplicate,Driver: Microsoft SQL analysis service (OLAP),"Hi, adding support for Microsoft SQL analysis service (OLAP) would be great.  


⬇️ Please click the 👍 reaction instead of leaving a +1 or 👍 comment",bukhbayar,2025-01-06 18:12:33+00:00,[],2025-01-07 13:33:58+00:00,2025-01-07 13:33:58+00:00,https://github.com/metabase/metabase/issues/51787,"[('Type:New Feature', ''), ('.Needs Triage', '')]","[{'comment_id': 2573794939, 'issue_id': 2771184376, 'author': 'paoliniluis', 'body': '@bukhbayar same as https://github.com/metabase/metabase/issues/29263?', 'created_at': datetime.datetime(2025, 1, 6, 19, 44, 9, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-06 19:44:09 UTC): @bukhbayar same as https://github.com/metabase/metabase/issues/29263?

"
2771123202,issue,open,,"Min, Max, Average, Distinct - calculation and formatting errors in xlsx and csv exports of pivot tables","### Describe the bug

There are formatting and calculation inconsistencies between native pivot tables and their xls and csv representation.
- Min, Max, Average, Distinct values are aggregated as Sum for subtotals and grand total in the xlsx export
- Average, Distinct values are aggregated as Sum for subtotals and grand total in the CSV export
- there are formatting issues in the xlsx export

### To Reproduce

1. Create a pivot
<img width=""742"" alt=""Image"" src=""https://github.com/user-attachments/assets/a94ab1de-7926-40e3-a9d0-4f3457b80535"" />

2. Visualize

<img width=""609"" alt=""Image"" src=""https://github.com/user-attachments/assets/34e1f693-1a8f-4cfa-bcce-4775230d5fde"" />

3. Download as xlsx, keep the data pivoted
<img width=""419"" alt=""Image"" src=""https://github.com/user-attachments/assets/a6d7af03-6e02-42de-ae1e-be2b583193e1"" />

Issues:
* Column title for each metric is 'Sum'
* Numeric formatting is different (number of decimals, thousands separator)
* The Min, Max and Average and Distinct aggregations are computed as sum() in the Excel, resulting in incorrect subtotals and grand totals
* A (blank) row is present
 
4. Download as csv, keep the data pivoted

<img width=""821"" alt=""Image"" src=""https://github.com/user-attachments/assets/be087ab6-c568-4e94-b351-9854305932bc"" />

Issues:
* The Average and Distinct aggregations are computed as sum() in the CSV, resulting in incorrect subtotals and grand totals.

### Expected behavior

The exports should have the same values for subtotals and totals, and similar formatting as the original pivot table.

### Logs

_No response_

### Information about your Metabase installation

```JSON
1.52.6
```

### Severity

P1 - This is very confusing, and correctness is affected (incorrect totals and difference between displayed and exported data).

### Additional context

_No response_",zbodi74,2025-01-06 17:33:34+00:00,['noahmoss'],2025-02-04 20:29:49+00:00,,https://github.com/metabase/metabase/issues/51786,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Correctness', ''), ('.Backend', ''), ('.Escalation', ''), ('.Team/DashViz', 'Dashboard and Viz team'), ('Reporting/Export/Pivot', 'Exporting data as pivoted tables'), ('Querying/Pivot', 'Queries that generate pivot tables')]","[{'comment_id': 2573586452, 'issue_id': 2771123202, 'author': 'zbodi74', 'body': 'Relates to https://github.com/metabase/metabase/issues/49957 and https://github.com/metabase/metabase/issues/51654 .', 'created_at': datetime.datetime(2025, 1, 6, 17, 34, 53, tzinfo=datetime.timezone.utc)}, {'comment_id': 2610706708, 'issue_id': 2771123202, 'author': 'zbodi74', 'body': 'Updated the repro steps to reflect all known calculation errors in xlsx and csv exports.', 'created_at': datetime.datetime(2025, 1, 23, 18, 44, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2610837144, 'issue_id': 2771123202, 'author': 'zbodi74', 'body': 'Set priority to P1 / escalating as the issue is confusing and affects correctness.', 'created_at': datetime.datetime(2025, 1, 23, 19, 25, 54, tzinfo=datetime.timezone.utc)}]","zbodi74 (Issue Creator) on (2025-01-06 17:34:53 UTC): Relates to https://github.com/metabase/metabase/issues/49957 and https://github.com/metabase/metabase/issues/51654 .

zbodi74 (Issue Creator) on (2025-01-23 18:44:43 UTC): Updated the repro steps to reflect all known calculation errors in xlsx and csv exports.

zbodi74 (Issue Creator) on (2025-01-23 19:25:54 UTC): Set priority to P1 / escalating as the issue is confusing and affects correctness.

"
2770937007,issue,open,,"Allow ""First Day of the Week"" to be set Per Tenant","**Is your feature request related to a problem? Please describe.**
I'm using a multi-tenant Metabase environment and different tenants have different fiscal weeks (some run Mon - Sun, some run Sun - Sat, etc). I need to be able to define a different ""First Day of the Week"" for each tenant so that date filters and grouping behavior are accurate for users in each tenant group.

**Describe the solution you'd like**
Allow ""First Day of the Week"" to be set per tenant and/or per user.

**Describe alternatives you've considered**
Native SQL questions that offset the day of week based on a user attribute. 

**How important is this feature to you?**
Requested by a customer

**Additional context**
N/A
",ixipixi,2025-01-06 15:49:31+00:00,[],2025-02-04 20:30:15+00:00,,https://github.com/metabase/metabase/issues/51779,"[('Type:New Feature', ''), ('Embedding/', 'Use this label when unsure which flavor of embedding is impacted'), ('Customization/i18n', ''), ('Administration/Settings', ''), ('Administration/People', 'and Groups. Also user Account Settings'), ('Administration/Tenants', 'Multi-tenant isolation and customization')]","[{'comment_id': 2573672554, 'issue_id': 2770937007, 'author': 'iethree', 'body': 'see: https://github.com/metabase/metabase/issues/50292', 'created_at': datetime.datetime(2025, 1, 6, 18, 26, 54, tzinfo=datetime.timezone.utc)}]","iethree on (2025-01-06 18:26:54 UTC): see: https://github.com/metabase/metabase/issues/50292

"
2770312045,issue,closed,completed,YoY vizualisation displays two '1st week' datapoints for year 2025,"### Describe the bug

On YoY visualization, the first week of 2025 appears twice:
- Once after week 52 of 2024
- Once correctly aligned with week 1 of previous years
This issue started a few days ago.

<img width=""1341"" alt=""Image"" src=""https://github.com/user-attachments/assets/5fd84818-0e79-49e4-adf6-d0fe98da2a9f"" />
https://github.com/user-attachments/assets/994fb0e9-09f7-42f9-99a3-562863d5bc34


### To Reproduce

1. Go to 'New - Question'
2. Select any metric in the summarize section
3. Select 2 grouping options : 
- any timestamp with 'week of year' option
- the same timestamp with 'year' option

4. See error


### Expected behavior

There should be only one data point for the first week of 2025, positioned consistently with the first week of previous years.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""fr-FR"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2024-11-28"",
      ""tag"": ""v0.51.6"",
      ""hash"": ""fc77ed4""
    },
    ""settings"": {
      ""report-timezone"": ""Europe/Paris""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""16.6""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.25+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.25"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.25+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.0-1072-aws"",
    ""user.language"": ""en"",
    ""user.timezone"": ""Europe/Paris""
  }
}
```

### Severity

 medium-low

### Additional context

_No response_",kamilbennani,2025-01-06 10:08:41+00:00,['ranquild'],2025-01-13 17:18:06+00:00,2025-01-13 17:18:05+00:00,https://github.com/metabase/metabase/issues/51777,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('.Frontend', ''), ('.Team/Querying', '')]","[{'comment_id': 2573057293, 'issue_id': 2770312045, 'author': 'crisptrutski', 'body': 'Able to reproduce in v51 using the Invoices table in Sample Data', 'created_at': datetime.datetime(2025, 1, 6, 12, 56, 3, tzinfo=datetime.timezone.utc)}, {'comment_id': 2573673786, 'issue_id': 2770312045, 'author': 'alexyarosh', 'body': 'Probably related: [this question on Stats](https://stats.metabase.com/question/23356-whats-up-with-week-52-in-2025) is showing me data for week **52** in year 2025', 'created_at': datetime.datetime(2025, 1, 6, 18, 27, 41, tzinfo=datetime.timezone.utc)}, {'comment_id': 2579105140, 'issue_id': 2770312045, 'author': 'ranquild', 'body': 'FE issue, the fix is in progress', 'created_at': datetime.datetime(2025, 1, 9, 3, 21, 41, tzinfo=datetime.timezone.utc)}]","crisptrutski on (2025-01-06 12:56:03 UTC): Able to reproduce in v51 using the Invoices table in Sample Data

alexyarosh on (2025-01-06 18:27:41 UTC): Probably related: [this question on Stats](https://stats.metabase.com/question/23356-whats-up-with-week-52-in-2025) is showing me data for week **52** in year 2025

ranquild (Assginee) on (2025-01-09 03:21:41 UTC): FE issue, the fix is in progress

"
2770031397,issue,closed,completed,"Hovering over data points in scatter plots displays all values for all data points, instead of just the hovered data point (and it doesn't do so correctly either)","### Describe the bug

We've just updated from v50 to v51. In the previous version, whenever we had many data points on a scatter plot, we could simply hover over each point to view specific information about that particular point. However, in v51, it displays a list of all data points instead, and for many of them, it shows an (empty) value, even though those points are not actually empty. This behavior is very confusing and makes it nearly impossible for us to find specific details about most of our data points.

![Image](https://github.com/user-attachments/assets/159a81e5-a819-4144-bc7a-eb451a70c2e2)


### To Reproduce

1. Create a Scatter Plot
2. Create an additional breakout to the X-axis (because each point represents a different category)
3. Hover on each of the data points
4. See the long list of details for all data points


### Expected behavior

To display the details for that and that only data point when hovered, instead of all data points

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""Win32"",
    ""userAgent"": ""Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""mongo""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2024-11-25"",
      ""tag"": ""v0.51.4.5"",
      ""hash"": ""d72706b""
    },
    ""settings"": {
      ""report-timezone"": ""Iran""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.4 (Debian 14.4-1.pgdg110+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.25+9"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.25"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.25+9"",
    ""os.name"": ""Linux"",
    ""os.version"": ""5.15.0-71-generic"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```

### Severity

Annoying

### Additional context

_No response_",alfiwilo,2025-01-06 07:33:38+00:00,[],2025-01-30 17:33:58+00:00,2025-01-30 17:33:56+00:00,https://github.com/metabase/metabase/issues/51776,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]","[{'comment_id': 2625140824, 'issue_id': 2770031397, 'author': 'alxnddr', 'body': 'Was fixed in v0.51.10 by https://github.com/metabase/metabase/issues/51483', 'created_at': datetime.datetime(2025, 1, 30, 17, 33, 57, tzinfo=datetime.timezone.utc)}]","alxnddr on (2025-01-30 17:33:57 UTC): Was fixed in v0.51.10 by https://github.com/metabase/metabase/issues/51483

"
2769360786,issue,open,,Pie Chart Fails in Embedded Dashboard with Persistent Model After Data Changes,"### Describe the bug

When embedding a Metabase dashboard that includes a Pie Chart visualization, an error occurs if the underlying data for the chart changes after the dashboard has been embedded. Specifically, the chart fails to render and displays the error
```
Error: No row values found for key ...
```
<img width=""956"" alt=""Image"" src=""https://github.com/user-attachments/assets/5f35f018-016f-4930-b4b8-a0c1b2822a4f"" />


This issue seems to arise because the embedded static version of the dashboard cannot handle changes in the dataset, causing a mismatch or absence of expected data rows.

### To Reproduce

1. 	Eneable cache and model persistence
2.	Create a model with persistence enabled in Metabase.
3.	Build a Pie Chart visualization based on this model.
4.	Add the Pie Chart to a dashboard.
5.	Embed the dashboard statically in an external application or webpage.
6.	Update or modify the data source feeding the model (e.g., add/remove rows, modify keys, etc.).
7.	Reload the embedded dashboard.

### Expected behavior

The embedded Pie Chart should update to reflect the changes in the dataset without throwing any errors, even when persistence is enabled on the model.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""es-ES"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2024-12-04"",
      ""tag"": ""v0.52.1"",
      ""hash"": ""5bc320b""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""12.20""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.23+9-LTS"",
    ""java.vendor"": ""Red Hat, Inc."",
    ""java.vendor.url"": ""https://www.redhat.com/"",
    ""java.version"": ""11.0.23"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.23+9-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""3.10.0-1160.114.2.el7.x86_64"",
    ""user.language"": ""es"",
    ""user.timezone"": ""Europe/Madrid""
  }
}
```

### Severity

high

### Additional context

_No response_",rodrigoGA,2025-01-05 16:56:08+00:00,[],2025-02-04 20:25:48+00:00,,https://github.com/metabase/metabase/issues/51775,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Embedding/Static', 'Static embedding, previously known as signed embedding'), ('.Team/Embedding', '')]","[{'comment_id': 2571818547, 'issue_id': 2769360786, 'author': 'paoliniluis', 'body': '@rodrigoGA can you move to 54.4 and check if the issue is still there?', 'created_at': datetime.datetime(2025, 1, 6, 0, 34, 59, tzinfo=datetime.timezone.utc)}, {'comment_id': 2577024081, 'issue_id': 2769360786, 'author': 'mfhanif', 'body': 'I don\'t use model just normal question but encounter same error, is it related?\n\n<img width=""834"" alt=""Image"" src=""https://github.com/user-attachments/assets/270104d5-4030-487b-9244-55755aa42632"" />\n\n```\n{\n  ""browser-info"": {\n    ""language"": ""en-GB"",\n    ""platform"": ""MacIntel"",\n    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.1 Safari/605.1.15"",\n    ""vendor"": ""Apple Computer, Inc.""\n  },\n  ""metabase-info"": {\n    ""databases"": [\n      ""postgres"",\n      ""h2""\n    ],\n    ""run-mode"": ""prod"",\n    ""plan-alias"": ""starter-yearly"",\n    ""version"": {\n      ""date"": ""2024-12-03"",\n      ""tag"": ""v1.51.6.5"",\n      ""hash"": ""22b76e9""\n    },\n    ""settings"": {\n      ""report-timezone"": ""Asia/Jakarta""\n    },\n    ""hosting-env"": ""unknown"",\n    ""application-database"": ""postgres""\n  }\n}', 'created_at': datetime.datetime(2025, 1, 8, 8, 18, 2, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-06 00:34:59 UTC): @rodrigoGA can you move to 54.4 and check if the issue is still there?

mfhanif on (2025-01-08 08:18:02 UTC): I don't use model just normal question but encounter same error, is it related?

<img width=""834"" alt=""Image"" src=""https://github.com/user-attachments/assets/270104d5-4030-487b-9244-55755aa42632"" />

```
{
  ""browser-info"": {
    ""language"": ""en-GB"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.1 Safari/605.1.15"",
    ""vendor"": ""Apple Computer, Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""postgres"",
      ""h2""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""starter-yearly"",
    ""version"": {
      ""date"": ""2024-12-03"",
      ""tag"": ""v1.51.6.5"",
      ""hash"": ""22b76e9""
    },
    ""settings"": {
      ""report-timezone"": ""Asia/Jakarta""
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres""
  }
}

"
2769051606,issue,closed,completed,Link Checker Report,"[Full Github Actions output](https://github.com/metabase/metabase/actions/runs/12614888698?check_suite_focus=true)
",github-actions[bot],2025-01-05 00:19:59+00:00,['jeff-bruemmer'],2025-01-06 16:55:03+00:00,2025-01-06 16:55:03+00:00,https://github.com/metabase/metabase/issues/51771,"[('Type:Documentation', '')]",[],
2768287131,issue,open,,Add custom Malli linter to disallow `format` with no arguments,It doesn't make sense. Actually maybe this is something we can PR against Malli core,camsaul,2025-01-03 23:24:12+00:00,[],2025-02-04 20:29:49+00:00,,https://github.com/metabase/metabase/issues/51766,"[('Type:Tech Debt', 'or Refactoring'), ('.CI & Tests', ''), ('.Backend', ''), ('.Team/DevEx', '')]",[],
2768206899,issue,closed,not_planned,Flaky Test: DistributedLock #tryLock default throws on double unlock,"[https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli](https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli)

```
{
  ""codeowners"": [
    ""@backend""
  ],
  ""failure_rate_last_7d"": 0.1,
  ""file_path"": ""trunk/services/__tests__/distributed_lock.test.js"",
  ""html_url"": ""https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli"",
  ""id"": ""2bfedccc-7fda-442c-bcf9-5e01c6d046d3"",
  ""most_common_failures"": [
    {
      ""last_occurrence"": ""2024-11-22T20:04:33.127Z"",
      ""occurrence_count"": 42,
      ""summary"": ""timeout""
    }
  ],
  ""name"": ""DistributedLock #tryLock default throws on double unlock"",
  ""pull_requests_impacted_last_7d"": 42,
  ""quarantine"": true,
  ""repository"": {
    ""html_url"": ""https://github.com/trunk-io/analytics-cli""
  },
  ""status"": {
    ""reason"": "" Inconsistent results on main"",
    ""timestamp"": ""2024-11-22T20:04:33.127Z"",
    ""value"": ""flaky""
  },
  ""test_suite"": ""DistributedLock"",
  ""ticket"": {
    ""html_url"": ""https://trunk-io.atlassian.net/browse/KAN-130""
  }
}
```",iethree,2025-01-03 21:38:05+00:00,[],2025-01-03 21:46:52+00:00,2025-01-03 21:46:52+00:00,https://github.com/metabase/metabase/issues/51763,"[('flaky-test-fix', '')]",[],
2768205055,issue,closed,not_planned,Flaky Test: DistributedLock #tryLock default throws on double unlock,"[https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli](https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli)

{
  ""codeowners"": \[
    ""@backend""
  \],
  ""failure_rate_last_7d"": 0.1,
  ""file_path"": ""trunk/services/**tests**/distributed_lock.test.js"",
  ""html_url"": ""[https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli](https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli)"",
  ""id"": ""2bfedccc-7fda-442c-bcf9-5e01c6d046d3"",
  ""most_common_failures"": \[
    {
      ""last_occurrence"": ""2024-11-22T20:04:33.127Z"",
      ""occurrence_count"": 42,
      ""summary"": ""timeout""
    }
  \],
  ""name"": ""DistributedLock #tryLock default throws on double unlock"",
  ""pull_requests_impacted_last_7d"": 42,
  ""quarantine"": true,
  ""repository"": {
    ""html_url"": ""[https://github.com/trunk-io/analytics-cli](https://github.com/trunk-io/analytics-cli)""
  },
  ""status"": {
    ""reason"": "" Inconsistent results on main"",
    ""timestamp"": ""2024-11-22T20:04:33.127Z"",
    ""value"": ""flaky""
  },
  ""test_suite"": ""DistributedLock"",
  ""ticket"": {
    ""html_url"": ""[https://trunk-io.atlassian.net/browse/KAN-130](https://trunk-io.atlassian.net/browse/KAN-130)""
  }
}",iethree,2025-01-03 21:36:20+00:00,[],2025-01-03 21:46:52+00:00,2025-01-03 21:46:52+00:00,https://github.com/metabase/metabase/issues/51762,"[('flaky-test-fix', '')]",[],
2768202597,issue,closed,not_planned,Flaky Test: DistributedLock #tryLock default throws on double unlock,"[https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli](https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli)

```
{
  ""codeowners"": [
    ""@backend""
  ],
  ""failure_rate_last_7d"": 0.1,
  ""file_path"": ""trunk/services/__tests__/distributed_lock.test.js"",
  ""html_url"": ""https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli"",
  ""id"": ""2bfedccc-7fda-442c-bcf9-5e01c6d046d3"",
  ""most_common_failures"": [
    {
      ""last_occurrence"": ""2024-11-22T20:04:33.127Z"",
      ""occurrence_count"": 42,
      ""summary"": ""timeout""
    }
  ],
  ""name"": ""DistributedLock #tryLock default throws on double unlock"",
  ""pull_requests_impacted_last_7d"": 42,
  ""quarantine"": true,
  ""repository"": {
    ""html_url"": ""https://github.com/trunk-io/analytics-cli""
  },
  ""status"": {
    ""reason"": "" Inconsistent results on main"",
    ""timestamp"": ""2024-11-22T20:04:33.127Z"",
    ""value"": ""flaky""
  },
  ""test_suite"": ""DistributedLock"",
  ""ticket"": {
    ""html_url"": ""https://trunk-io.atlassian.net/browse/KAN-130""
  }
}
```",iethree,2025-01-03 21:33:55+00:00,[],2025-01-03 21:46:51+00:00,2025-01-03 21:46:51+00:00,https://github.com/metabase/metabase/issues/51761,"[('flaky-test-fix', '')]",[],
2768201740,issue,closed,not_planned,Flaky Test: DistributedLock #tryLock default throws on double unlock,"```
https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli

```
{
```

""codeowners"": \[
    ""@backend""
  \],
  ""failure_rate_last_7d"": 0.1,
  ""file_path"": ""trunk/services/**tests**/distributed_lock.test.js"",
  ""html_url"": ""[https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli](https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli)"",
  ""id"": ""2bfedccc-7fda-442c-bcf9-5e01c6d046d3"",
  ""most_common_failures"": \[
    {
      ""last_occurrence"": ""2024-11-22T20:04:33.127Z"",
      ""occurrence_count"": 42,
      ""summary"": ""timeout""
    }
  \],
  ""name"": ""DistributedLock #tryLock default throws on double unlock"",
  ""pull_requests_impacted_last_7d"": 42,
  ""quarantine"": true,
  ""repository"": {
    ""html_url"": ""[https://github.com/trunk-io/analytics-cli](https://github.com/trunk-io/analytics-cli)""
  },
  ""status"": {
    ""reason"": "" Inconsistent results on main"",
    ""timestamp"": ""2024-11-22T20:04:33.127Z"",
    ""value"": ""flaky""
  },
  ""test_suite"": ""DistributedLock"",
  ""ticket"": {
    ""html_url"": ""[https://trunk-io.atlassian.net/browse/KAN-130](https://trunk-io.atlassian.net/browse/KAN-130)""
  }
}
    \`\`\`",iethree,2025-01-03 21:33:04+00:00,[],2025-01-03 21:46:51+00:00,2025-01-03 21:46:51+00:00,https://github.com/metabase/metabase/issues/51760,"[('flaky-test-fix', '')]",[],
2768200356,issue,closed,not_planned,Flaky Test: DistributedLock #tryLock default throws on double unlock,"[https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli](https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli)

{""codeowners"":\[""@backend""\],""failure_rate_last_7d"":0.1,""file_path"":""trunk/services/**tests**/distributed_lock.test.js"",""html_url"":""[https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli"",""id"":""2bfedccc-7fda-442c-bcf9-5e01c6d046d3"",""most_common_failures"":\[{""last_occurrence"":""2024-11-22T20:04:33.127Z"",""occurrence_count"":42,""summary"":""timeout""}\],""name"":""DistributedLock](https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli%22,%22id%22:%222bfedccc-7fda-442c-bcf9-5e01c6d046d3%22,%22most_common_failures%22:%5B%7B%22last_occurrence%22:%222024-11-22T20:04:33.127Z%22,%22occurrence_count%22:42,%22summary%22:%22timeout%22%7D%5D,%22name%22:%22DistributedLock) #tryLock default throws on double unlock"",""pull_requests_impacted_last_7d"":42,""quarantine"":true,""repository"":{""html_url"":""[https://github.com/trunk-io/analytics-cli""},""status"":{""reason"":""](https://github.com/trunk-io/analytics-cli%22%7D,%22status%22:%7B%22reason%22:%22) Inconsistent results on main"",""timestamp"":""2024-11-22T20:04:33.127Z"",""value"":""flaky""},""test_suite"":""DistributedLock"",""ticket"":{""html_url"":""[https://trunk-io.atlassian.net/browse/KAN-130](https://trunk-io.atlassian.net/browse/KAN-130)""}}",iethree,2025-01-03 21:31:42+00:00,[],2025-01-03 21:46:51+00:00,2025-01-03 21:46:51+00:00,https://github.com/metabase/metabase/issues/51758,"[('flaky-test-fix', '')]",[],
2768186349,issue,closed,not_planned,Flaky Test: DistributedLock #tryLock default throws on double unlock,"```json
https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli

{
```

""codeowners"": \[
    ""@backend""
  \],
  ""failure_rate_last_7d"": 0.1,
  ""file_path"": ""trunk/services/**tests**/distributed_lock.test.js"",
  ""html_url"": ""[https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli](https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli)"",
  ""id"": ""2bfedccc-7fda-442c-bcf9-5e01c6d046d3"",
  ""most_common_failures"": \[
    {
      ""last_occurrence"": ""2024-11-22T20:04:33.127Z"",
      ""occurrence_count"": 42,
      ""summary"": ""timeout""
    }
  \],
  ""name"": ""DistributedLock #tryLock default throws on double unlock"",
  ""pull_requests_impacted_last_7d"": 42,
  ""quarantine"": true,
  ""repository"": {
    ""html_url"": ""[https://github.com/trunk-io/analytics-cli](https://github.com/trunk-io/analytics-cli)""
  },
  ""status"": {
    ""reason"": "" Inconsistent results on main"",
    ""timestamp"": ""2024-11-22T20:04:33.127Z"",
    ""value"": ""flaky""
  },
  ""test_suite"": ""DistributedLock"",
  ""ticket"": {
    ""html_url"": ""[https://trunk-io.atlassian.net/browse/KAN-130](https://trunk-io.atlassian.net/browse/KAN-130)""
  }
}",iethree,2025-01-03 21:18:32+00:00,[],2025-01-03 21:46:50+00:00,2025-01-03 21:46:50+00:00,https://github.com/metabase/metabase/issues/51757,"[('flaky-test-fix', '')]",[],
2768182288,issue,closed,not_planned,Flaky Test: DistributedLock #tryLock default throws on double unlock,"```
Reason:  Inconsistent results on main
https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli


```
{
```

""codeowners"": \[
    ""@backend""
  \],
  ""failure_rate_last_7d"": 0.1,
  ""file_path"": ""trunk/services/**tests**/distributed_lock.test.js"",
  ""html_url"": ""[https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli](https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli)"",
  ""id"": ""2bfedccc-7fda-442c-bcf9-5e01c6d046d3"",
  ""most_common_failures"": \[
    {
      ""last_occurrence"": ""2024-11-22T20:04:33.127Z"",
      ""occurrence_count"": 42,
      ""summary"": ""timeout""
    }
  \],
  ""name"": ""DistributedLock #tryLock default throws on double unlock"",
  ""pull_requests_impacted_last_7d"": 42,
  ""quarantine"": true,
  ""repository"": {
    ""html_url"": ""[https://github.com/trunk-io/analytics-cli](https://github.com/trunk-io/analytics-cli)""
  },
  ""status"": {
    ""reason"": "" Inconsistent results on main"",
    ""timestamp"": ""2024-11-22T20:04:33.127Z"",
    ""value"": ""flaky""
  },
  ""test_suite"": ""DistributedLock"",
  ""ticket"": {
    ""html_url"": ""[https://trunk-io.atlassian.net/browse/KAN-130](https://trunk-io.atlassian.net/browse/KAN-130)""
  }
}
    \`\`\`",iethree,2025-01-03 21:14:37+00:00,[],2025-01-03 21:46:50+00:00,2025-01-03 21:46:50+00:00,https://github.com/metabase/metabase/issues/51756,[],[],
2768180960,issue,closed,not_planned,Flaky Test: DistributedLock #tryLock default throws on double unlock,"Reason:  Inconsistent results on main
[https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli](https://app.trunk.io/trunk/flaky-tests/test/77681877-1608-5871-bf95-e02f8baa5a9a?repo=trunk-io%2Fanalytics-cli)",iethree,2025-01-03 21:13:16+00:00,[],2025-01-03 21:46:49+00:00,2025-01-03 21:46:49+00:00,https://github.com/metabase/metabase/issues/51755,[],[],
2768145839,issue,closed,not_planned,Flaky Test: DistributedLock #tryLock default throws on double unlock,Flaky test is flaky,iethree,2025-01-03 20:40:51+00:00,[],2025-01-03 21:46:49+00:00,2025-01-03 21:46:49+00:00,https://github.com/metabase/metabase/issues/51752,"[('flaky-test-fix', '')]",[],
2768128643,issue,closed,completed,Crash when using a drill-thru with an empty value,"### Describe the bug

The app crashes when using `See these ...` drill with empty values.

### To Reproduce

1. Open https://stats.metabase.com/question#eyJuYW1lIjoiSXNzdWUiLCJkZXNjcmlwdGlvbiI6Iklzc3VlcyBmb3IgTWV0YWJhc2UgcmVwb3MgcmVwb3J0ZWQgYnkgaW50ZXJuYWwgYW5kIGV4dGVybmFsIHVzZXJzIiwiZGF0YXNldF9xdWVyeSI6eyJkYXRhYmFzZSI6MjYsInR5cGUiOiJxdWVyeSIsInF1ZXJ5Ijp7ImFnZ3JlZ2F0aW9uIjpbWyJjb3VudCJdXSwiYnJlYWtvdXQiOltbImZpZWxkIiwidHlwZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV1dLCJzb3VyY2UtdGFibGUiOiJjYXJkX182MTEzIiwiYWdncmVnYXRpb24taWRlbnRzIjp7IjAiOiIzYU9CbGt3N0k2R0RmTjZ0bGt3WnAifSwiYnJlYWtvdXQtaWRlbnRzIjp7IjAiOiJzVlIxY2Z6NHo4TDVIMjNlY2VnSVQifSwiZmlsdGVyIjpbImFuZCIsWyI9IixbImZpZWxkIiwicmVwb3NpdG9yeSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sIm1ldGFiYXNlIl0sWyI9IixbImZpZWxkIiwic3RhdGUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJvcGVuIl1dfX0sImRpc3BsYXkiOiJiYXIiLCJwYXJhbWV0ZXJzIjpbXSwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6e30sIm9yaWdpbmFsX2NhcmRfaWQiOjYxMTMsInR5cGUiOiJxdWVzdGlvbiJ9
2. Click on `(empty)` bar -> `See these ...`
3. See it added `Type is nil` filter. Click on the filter pill in the query builder.
4. The app crashes.

### Expected behavior

Drills should use `is-empty` / `not-empty` / `is-null` / `not-null` for empty values (string/non-string column).

### Logs

_No response_

### Information about your Metabase installation

```JSON
Stats, v52+
```

### Severity

P1

### Additional context

_No response_",ranquild,2025-01-03 20:25:29+00:00,['appleby'],2025-01-17 17:38:59+00:00,2025-01-17 17:02:07+00:00,https://github.com/metabase/metabase/issues/51751,"[('Type:Bug', 'Product defects'), ('Priority:P1', 'Security holes w/o exploit, crashing, setup/upgrade, login, broken common features, correctness'), ('Querying/MBQL', ''), ('.Backend', ''), ('.Team/Querying', '')]",[],
2768093854,issue,closed,completed,Instant test failure updates,"- [X] for e2e tests, update a comment on the PR as soon as a test fails, to help get faster feedback, even before the job fails
- [X] remove comment when a new commit gets pushed
- [X] reset comment on re-run",iethree,2025-01-03 19:53:51+00:00,['iethree'],2025-01-20 14:53:00+00:00,2025-01-20 14:53:00+00:00,https://github.com/metabase/metabase/issues/51749,[],[],
2768079998,issue,open,,Add custom Kondo linter to make sure `[[references]]` in a docstring are valid,This will force people to update docstrings when they change something. I've seen a lot of PRs that remove or rename vars that end up leaving tons of invalid references in our docstrings. This is nice not just for Marginalia dox generation but also for jump-to-definition ,camsaul,2025-01-03 19:41:28+00:00,[],2025-02-04 20:31:07+00:00,,https://github.com/metabase/metabase/issues/51748,"[('Type:Tech Debt', 'or Refactoring'), ('Type:Documentation', ''), ('.CI & Tests', ''), ('.Backend', ''), ('.Team/DevEx', '')]",[],
2767961687,issue,open,,Hide the bottom portion of the dashboard,"[Thread](https://metaboat.slack.com/archives/C063Q3F1HPF/p1735924656934919)

Add an option to hide buttons / bottom line

![Image](https://github.com/user-attachments/assets/b78e4e87-cabe-41e8-83ab-bc4dc8559dee)
",NevRA,2025-01-03 17:57:49+00:00,[],2025-02-04 20:30:51+00:00,,https://github.com/metabase/metabase/issues/51744,"[('Type:New Feature', ''), ('.Team/Embedding', ''), ('Embedding/SDK', 'Embedding SDK for React')]","[{'comment_id': 2575763797, 'issue_id': 2767961687, 'author': 'albertoperdomo', 'body': 'From @WiNloSt :\n\nStaticDashboard and InteractiveDashboard are implemented using embedding dashboard component while the EditableDashboard uses the same dashboard in the core app.\n\nThe EditableDashboard has the same buttons but at the top (screenshot). Does this task only include the change to the static and interactive dashboards? I feel like they’re inherently the same button components, so I’d expect option(s) to control them all.\n\n![Image](https://github.com/user-attachments/assets/ab520c98-7700-4b9c-a8b9-2b01160cb8a2)', 'created_at': datetime.datetime(2025, 1, 7, 16, 42, 43, tzinfo=datetime.timezone.utc)}, {'comment_id': 2575766811, 'issue_id': 2767961687, 'author': 'albertoperdomo', 'body': 'I believe we should add this prop to all dashboard components, for consistency.', 'created_at': datetime.datetime(2025, 1, 7, 16, 44, 4, tzinfo=datetime.timezone.utc)}, {'comment_id': 2607362500, 'issue_id': 2767961687, 'author': 'heypoom', 'body': ""Unassigning this for now as it's not a GA blocker"", 'created_at': datetime.datetime(2025, 1, 22, 14, 14, 43, tzinfo=datetime.timezone.utc)}]","albertoperdomo on (2025-01-07 16:42:43 UTC): From @WiNloSt :

StaticDashboard and InteractiveDashboard are implemented using embedding dashboard component while the EditableDashboard uses the same dashboard in the core app.

The EditableDashboard has the same buttons but at the top (screenshot). Does this task only include the change to the static and interactive dashboards? I feel like they’re inherently the same button components, so I’d expect option(s) to control them all.

![Image](https://github.com/user-attachments/assets/ab520c98-7700-4b9c-a8b9-2b01160cb8a2)

albertoperdomo on (2025-01-07 16:44:04 UTC): I believe we should add this prop to all dashboard components, for consistency.

heypoom on (2025-01-22 14:14:43 UTC): Unassigning this for now as it's not a GA blocker

"
2767805448,issue,closed,not_planned,Incorrect filter created by a drill-thru when clicking on a bar for an empty value,"### Describe the bug

Some random filter is added when using `Filter by this value` with bars for empty values.

### To Reproduce

1. Open https://stats.metabase.com/question#eyJuYW1lIjoiSXNzdWUiLCJkZXNjcmlwdGlvbiI6Iklzc3VlcyBmb3IgTWV0YWJhc2UgcmVwb3MgcmVwb3J0ZWQgYnkgaW50ZXJuYWwgYW5kIGV4dGVybmFsIHVzZXJzIiwiZGF0YXNldF9xdWVyeSI6eyJkYXRhYmFzZSI6MjYsInR5cGUiOiJxdWVyeSIsInF1ZXJ5Ijp7ImFnZ3JlZ2F0aW9uIjpbWyJjb3VudCJdXSwiYnJlYWtvdXQiOltbImZpZWxkIiwidHlwZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV1dLCJzb3VyY2UtdGFibGUiOiJjYXJkX182MTEzIiwiYWdncmVnYXRpb24taWRlbnRzIjp7IjAiOiIzYU9CbGt3N0k2R0RmTjZ0bGt3WnAifSwiYnJlYWtvdXQtaWRlbnRzIjp7IjAiOiJzVlIxY2Z6NHo4TDVIMjNlY2VnSVQifSwiZmlsdGVyIjpbImFuZCIsWyI9IixbImZpZWxkIiwicmVwb3NpdG9yeSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sIm1ldGFiYXNlIl0sWyI9IixbImZpZWxkIiwic3RhdGUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJvcGVuIl1dfX0sImRpc3BsYXkiOiJiYXIiLCJwYXJhbWV0ZXJzIjpbXSwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6e30sIm9yaWdpbmFsX2NhcmRfaWQiOjYxMTMsInR5cGUiOiJxdWVzdGlvbiJ9
2. Click on `(empty)` bar
3. Filter by this value -> `=`
4. See a random `count = 1471` filter. 


### Expected behavior

It should be `Type is empty`.

### Logs

_No response_

### Information about your Metabase installation

```JSON
Stats, v52+
```

### Severity

P2

### Additional context

_No response_",ranquild,2025-01-03 15:57:29+00:00,['appleby'],2025-01-16 20:43:41+00:00,2025-01-16 20:43:41+00:00,https://github.com/metabase/metabase/issues/51742,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/MBQL', ''), ('.Backend', ''), ('.Product Input Needed', ''), ('.Team/Querying', '')]","[{'comment_id': 2569572411, 'issue_id': 2767805448, 'author': 'appleby', 'body': 'Repros in v0.49.25.2 with a question like\n\n* Table: Analytic Events\n* Summarize: Count by Button Label\n* Visualize\n* Click on the `(empty)` bar', 'created_at': datetime.datetime(2025, 1, 3, 17, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2569770807, 'issue_id': 2767805448, 'author': 'ranquild', 'body': 'Might be expected behavior.', 'created_at': datetime.datetime(2025, 1, 3, 20, 23, 2, tzinfo=datetime.timezone.utc)}, {'comment_id': 2569777681, 'issue_id': 2767805448, 'author': 'ranquild', 'body': 'Context https://metaboat.slack.com/archives/C05MPF0TM3L/p1735918912485069', 'created_at': datetime.datetime(2025, 1, 3, 20, 29, 28, tzinfo=datetime.timezone.utc)}]","appleby (Assginee) on (2025-01-03 17:24:00 UTC): Repros in v0.49.25.2 with a question like

* Table: Analytic Events
* Summarize: Count by Button Label
* Visualize
* Click on the `(empty)` bar

ranquild (Issue Creator) on (2025-01-03 20:23:02 UTC): Might be expected behavior.

ranquild (Issue Creator) on (2025-01-03 20:29:28 UTC): Context https://metaboat.slack.com/archives/C05MPF0TM3L/p1735918912485069

"
2767801742,issue,closed,duplicate,"Incorrect ""Filter by this column"" drill-thru option when clicking on a bar in a chart","### Describe the bug

There should be no ""Filter by this column"" option for in-chart clicks.

### To Reproduce

1. Open https://stats.metabase.com/question#eyJuYW1lIjoiSXNzdWUiLCJkZXNjcmlwdGlvbiI6Iklzc3VlcyBmb3IgTWV0YWJhc2UgcmVwb3MgcmVwb3J0ZWQgYnkgaW50ZXJuYWwgYW5kIGV4dGVybmFsIHVzZXJzIiwiZGF0YXNldF9xdWVyeSI6eyJkYXRhYmFzZSI6MjYsInR5cGUiOiJxdWVyeSIsInF1ZXJ5Ijp7ImFnZ3JlZ2F0aW9uIjpbWyJjb3VudCJdXSwiYnJlYWtvdXQiOltbImZpZWxkIiwidHlwZSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV1dLCJzb3VyY2UtdGFibGUiOiJjYXJkX182MTEzIiwiYWdncmVnYXRpb24taWRlbnRzIjp7IjAiOiIzYU9CbGt3N0k2R0RmTjZ0bGt3WnAifSwiYnJlYWtvdXQtaWRlbnRzIjp7IjAiOiJzVlIxY2Z6NHo4TDVIMjNlY2VnSVQifSwiZmlsdGVyIjpbImFuZCIsWyI9IixbImZpZWxkIiwicmVwb3NpdG9yeSIseyJiYXNlLXR5cGUiOiJ0eXBlL1RleHQifV0sIm1ldGFiYXNlIl0sWyI9IixbImZpZWxkIiwic3RhdGUiLHsiYmFzZS10eXBlIjoidHlwZS9UZXh0In1dLCJvcGVuIl1dfX0sImRpc3BsYXkiOiJiYXIiLCJwYXJhbWV0ZXJzIjpbXSwidmlzdWFsaXphdGlvbl9zZXR0aW5ncyI6e30sIm9yaWdpbmFsX2NhcmRfaWQiOjYxMTMsInR5cGUiOiJxdWVzdGlvbiJ9
2. Click on the last bar `(empty)`
3. See there is `Filter by this column`



### Expected behavior

There should be no such option here.

### Logs

-

### Information about your Metabase installation

```JSON
Stats, v52+
```

### Severity

P2

### Additional context

_No response_",ranquild,2025-01-03 15:54:45+00:00,['appleby'],2025-01-21 01:27:01+00:00,2025-01-21 01:27:00+00:00,https://github.com/metabase/metabase/issues/51741,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/MBQL', ''), ('Difficulty:Easy', ''), ('.Backend', ''), ('.Team/Querying', '')]","[{'comment_id': 2569571781, 'issue_id': 2767801742, 'author': 'appleby', 'body': 'Also able to repro in v0.49.25.2 with a question like\n\n* Table: Analytic Events\n* Summarize: Count by Button Label\n* Visualize\n* Click on the `(empty)` bar', 'created_at': datetime.datetime(2025, 1, 3, 17, 23, 27, tzinfo=datetime.timezone.utc)}, {'comment_id': 2569711454, 'issue_id': 2767801742, 'author': 'appleby', 'body': ""Copy/pasted from [slack](https://metaboat.slack.com/archives/C05MPF0TM3L/p1735932015944339?thread_ts=1735918912.485069&cid=C05MPF0TM3L)\n\nThe column-filter drill does correctly `nil?` [ check the value it's passed](https://github.com/metabase/metabase/blob/ae97cbde23126836c08ae1a738d354759bd9d5cb/src/metabase/lib/drill_thru/column_filter.cljc#L103), and the `:value` in the context passed to `available-drill-thrus` from the FE is indeed non-nil (it's the count aggregation's value), but some drills get their [context constructed from their dimensions](https://github.com/metabase/metabase/blob/ae97cbde23126836c08ae1a738d354759bd9d5cb/src/metabase/lib/drill_thru.cljc#L99) (i.e. return-drills-for-dimensions? is true), and the `nil -> :null` [ conversion](https://github.com/metabase/metabase/blob/ae97cbde23126836c08ae1a738d354759bd9d5cb/src/metabase/lib/js.cljs#L2159) at the js/cljs border is only done for the top-level context `:value`, not any values in the row or dimensions. Hence, when the drill is called by `available-drill-thrus`, it sees a nil value.\n\nPresumably, we want to do a similar conversion of undefined and null for values in the dimensions / rows, but would need to check to make sure changing that won't break other drills."", 'created_at': datetime.datetime(2025, 1, 3, 19, 26, 24, tzinfo=datetime.timezone.utc)}, {'comment_id': 2603446559, 'issue_id': 2767801742, 'author': 'appleby', 'body': 'Most likely a duplicate of #49740. Closing this one and assigning myself to #49740. Will re-open if it turns out to be a separate bug.', 'created_at': datetime.datetime(2025, 1, 21, 1, 27, tzinfo=datetime.timezone.utc)}]","appleby (Assginee) on (2025-01-03 17:23:27 UTC): Also able to repro in v0.49.25.2 with a question like

* Table: Analytic Events
* Summarize: Count by Button Label
* Visualize
* Click on the `(empty)` bar

appleby (Assginee) on (2025-01-03 19:26:24 UTC): Copy/pasted from [slack](https://metaboat.slack.com/archives/C05MPF0TM3L/p1735932015944339?thread_ts=1735918912.485069&cid=C05MPF0TM3L)

The column-filter drill does correctly `nil?` [ check the value it's passed](https://github.com/metabase/metabase/blob/ae97cbde23126836c08ae1a738d354759bd9d5cb/src/metabase/lib/drill_thru/column_filter.cljc#L103), and the `:value` in the context passed to `available-drill-thrus` from the FE is indeed non-nil (it's the count aggregation's value), but some drills get their [context constructed from their dimensions](https://github.com/metabase/metabase/blob/ae97cbde23126836c08ae1a738d354759bd9d5cb/src/metabase/lib/drill_thru.cljc#L99) (i.e. return-drills-for-dimensions? is true), and the `nil -> :null` [ conversion](https://github.com/metabase/metabase/blob/ae97cbde23126836c08ae1a738d354759bd9d5cb/src/metabase/lib/js.cljs#L2159) at the js/cljs border is only done for the top-level context `:value`, not any values in the row or dimensions. Hence, when the drill is called by `available-drill-thrus`, it sees a nil value.

Presumably, we want to do a similar conversion of undefined and null for values in the dimensions / rows, but would need to check to make sure changing that won't break other drills.

appleby (Assginee) on (2025-01-21 01:27:00 UTC): Most likely a duplicate of #49740. Closing this one and assigning myself to #49740. Will re-open if it turns out to be a separate bug.

"
2767718969,issue,open,,Enable actions linting,[https://github.com/rhysd/actionlint](https://github.com/rhysd/actionlint),iethree,2025-01-03 15:00:56+00:00,[],2025-01-17 20:29:46+00:00,,https://github.com/metabase/metabase/issues/51738,[],[],
2767561620,issue,closed,completed,Error sending alerts via specific SMTP,"**Describe the bug**
I'm having a problem sending emails from alerts or dashboard subscriptions.

I'm configuring my metabase instance to send emails via Resend's SMTP (https://resend.com/).
The configuration works, the test email is sent without problems, and password recovery emails are also sent.
But emails sent from alerts or subscriptions result in an error in the logs: 450 The `to` field must be a `string`.

**Logs**
The browser console does not show any errors. The call to https://metabase.ecobritelinen.com/api/pulse/test even receives a success response ({""ok"":true}) after ~35 seconds.
But on the server you can see the logs below:
```
[24c2ada7-e4fe-4b2e-89c4-37e82e2cb56e] 2025-01-03T10:00:00-03:00 INFO metabase.notification.send [Notification 3] Sending message to channel :channel/email
[24c2ada7-e4fe-4b2e-89c4-37e82e2cb56e] 2025-01-03T10:00:00-03:00 WARN metabase.notification.send [Notification 3] Failed to send to channel channel/email , retrying...,com.sun.mail.smtp.SMTPSendFailedException: 450 The `to` field must be a `string`.,	at com.sun.mail.smtp.SMTPTransport.issueSendCommand(SMTPTransport.java:2374),	at com.sun.mail.smtp.SMTPTransport.finishData(SMTPTransport.java:2095),	at com.sun.mail.smtp.SMTPTransport.sendMessage(SMTPTransport.java:1301),	at postal.smtp$smtp_send_STAR_.invokeStatic(smtp.clj:36),	at postal.smtp$smtp_send_STAR_.invoke(smtp.clj:29),	at postal.smtp$smtp_send.invokeStatic(smtp.clj:58),	at postal.smtp$smtp_send.doInvoke(smtp.clj:39),	at clojure.lang.RestFn.invoke(RestFn.java:426),	at postal.core$send_message.invokeStatic(core.clj:36),	at postal.core$send_message.invoke(core.clj:29),	at metabase.email$send_email_BANG_.invokeStatic(email.clj:151),	at metabase.email$send_email_BANG_.invoke(email.clj:144),	at metabase.email$send_message_or_throw_BANG_.invokeStatic(email.clj:211),	at metabase.email$send_message_or_throw_BANG_.invoke(email.clj:201),	at metabase.channel.impl.email$fn__115391$_AMPERSAND_f__115393.invoke(email.clj:39),	at metabase.channel.impl.email$fn__115391$fn__115396.invoke(email.clj:37),	at clojure.lang.MultiFn.invoke(MultiFn.java:234),	at metabase.notification.send$channel_send_retrying_BANG_$send_BANG___104490.invoke(send.clj:73),	at clojure.lang.AFn.applyToHelper(AFn.java:152),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at metabase.util.retry$decorate$fn$reify__88040.call(retry.clj:84),	at io.github.resilience4j.retry.Retry.lambda$decorateCallable$5(Retry.java:306),	at metabase.util.retry$decorate$fn__88039.doInvoke(retry.clj:85),	at clojure.lang.RestFn.invoke(RestFn.java:400),	at metabase.util.retry$make$fn__88044.invoke(retry.clj:94),	at metabase.notification.send$channel_send_retrying_BANG_$fn__104499.invoke(send.clj:98),	at metabase.models.task_history$do_with_task_history63412__63413.invokeStatic(task_history.clj:121),	at metabase.models.task_history$do_with_task_history63412__63413.invoke(task_history.clj:109),	at metabase.notification.send$channel_send_retrying_BANG_.invokeStatic(send.clj:83),	at metabase.notification.send$channel_send_retrying_BANG_.invoke(send.clj:59),	at metabase.notification.send$send_notification_sync_BANG_104523__104524$fn__104525$fn__104528.invoke(send.clj:162),	at metabase.models.task_history$do_with_task_history63412__63413.invokeStatic(task_history.clj:121),	at metabase.models.task_history$do_with_task_history63412__63413.invoke(task_history.clj:109),	at metabase.notification.send$send_notification_sync_BANG_104523__104524$fn__104525.invoke(send.clj:141),	at metabase.notification.send$send_notification_sync_BANG_104523__104524.invokeStatic(send.clj:138),	at metabase.notification.send$send_notification_sync_BANG_104523__104524.invoke(send.clj:135),	at metabase.notification.send$send_notification_async_BANG_104572__104573$fn__104574.invoke(send.clj:176),	at clojure.lang.AFn.call(AFn.java:18),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source)
[24c2ada7-e4fe-4b2e-89c4-37e82e2cb56e] 2025-01-03T10:00:01-03:00 WARN metabase.notification.send [Notification 3] Failed to send to channel channel/email , retrying...,com.sun.mail.smtp.SMTPSendFailedException: 450 The `to` field must be a `string`.,	at com.sun.mail.smtp.SMTPTransport.issueSendCommand(SMTPTransport.java:2374),	at com.sun.mail.smtp.SMTPTransport.finishData(SMTPTransport.java:2095),	at com.sun.mail.smtp.SMTPTransport.sendMessage(SMTPTransport.java:1301),	at postal.smtp$smtp_send_STAR_.invokeStatic(smtp.clj:36),	at postal.smtp$smtp_send_STAR_.invoke(smtp.clj:29),	at postal.smtp$smtp_send.invokeStatic(smtp.clj:58),	at postal.smtp$smtp_send.doInvoke(smtp.clj:39),	at clojure.lang.RestFn.invoke(RestFn.java:426),	at postal.core$send_message.invokeStatic(core.clj:36),	at postal.core$send_message.invoke(core.clj:29),	at metabase.email$send_email_BANG_.invokeStatic(email.clj:151),	at metabase.email$send_email_BANG_.invoke(email.clj:144),	at metabase.email$send_message_or_throw_BANG_.invokeStatic(email.clj:211),	at metabase.email$send_message_or_throw_BANG_.invoke(email.clj:201),	at metabase.channel.impl.email$fn__115391$_AMPERSAND_f__115393.invoke(email.clj:39),	at metabase.channel.impl.email$fn__115391$fn__115396.invoke(email.clj:37),	at clojure.lang.MultiFn.invoke(MultiFn.java:234),	at metabase.notification.send$channel_send_retrying_BANG_$send_BANG___104490.invoke(send.clj:73),	at clojure.lang.AFn.applyToHelper(AFn.java:152),	at clojure.lang.AFn.applyTo(AFn.java:144),	at clojure.core$apply.invokeStatic(core.clj:667),	at clojure.core$apply.invoke(core.clj:662),	at metabase.util.retry$decorate$fn$reify__88040.call(retry.clj:84),	at io.github.resilience4j.retry.Retry.lambda$decorateCallable$5(Retry.java:306),	at metabase.util.retry$decorate$fn__88039.doInvoke(retry.clj:85),	at clojure.lang.RestFn.invoke(RestFn.java:400),	at metabase.util.retry$make$fn__88044.invoke(retry.clj:94),	at metabase.notification.send$channel_send_retrying_BANG_$fn__104499.invoke(send.clj:98),	at metabase.models.task_history$do_with_task_history63412__63413.invokeStatic(task_history.clj:121),	at metabase.models.task_history$do_with_task_history63412__63413.invoke(task_history.clj:109),	at metabase.notification.send$channel_send_retrying_BANG_.invokeStatic(send.clj:83),	at metabase.notification.send$channel_send_retrying_BANG_.invoke(send.clj:59),	at metabase.notification.send$send_notification_sync_BANG_104523__104524$fn__104525$fn__104528.invoke(send.clj:162),	at metabase.models.task_history$do_with_task_history63412__63413.invokeStatic(task_history.clj:121),	at metabase.models.task_history$do_with_task_history63412__63413.invoke(task_history.clj:109),	at metabase.notification.send$send_notification_sync_BANG_104523__104524$fn__104525.invoke(send.clj:141),	at metabase.notification.send$send_notification_sync_BANG_104523__104524.invokeStatic(send.clj:138),	at metabase.notification.send$send_notification_sync_BANG_104523__104524.invoke(send.clj:135),	at metabase.notification.send$send_notification_async_BANG_104572__104573$fn__104574.invoke(send.clj:176),	at clojure.lang.AFn.call(AFn.java:18),	at java.base/java.util.concurrent.FutureTask.run(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source),	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source),	at java.base/java.lang.Thread.run(Unknown Source)
```

**To Reproduce**
Steps to reproduce the behavior:
1. Go to Admin Settings > Email
2. Configure Resend as SMTP service
3. Go to any dashboard
4. Click on Sharing > Subscription > Email it
5. Fill ""To"" with a valid e-mail
6. Click on button ""Send Email Now""
7. See the error in logs

**Expected behavior**
An email containing the alert preview is expected to be sent.

**Severity**
It is blocking the use of alerts.

**Additional context**
I'm also in contact with the resend team to try to understand what the problem is.
They asked what format the ""To"" is being sent in. Is there any transformation, any special character? I tried to look in the logs and here in the repository but I'm not familiar with this repository and couldn't find anything.
Can you tell me how ""To"" is transformed and sent to SMTP? Or at least a direction of which class to look for it in?

**Metabase Diagnostic Info**

```json
{
  ""browser-info"": {
    ""language"": ""pt-BR"",
    ""platform"": ""Linux x86_64"",
    ""userAgent"": ""Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""h2"",
      ""postgres""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": """",
    ""version"": {
      ""date"": ""2024-12-21"",
      ""tag"": ""v0.52.4"",
      ""hash"": ""2f8c560""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""14.6 (Ubuntu 14.6-1.pgdg18.04+1)""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""21.0.5+11-LTS"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""21.0.5"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""21.0.5+11-LTS"",
    ""os.name"": ""Linux"",
    ""os.version"": ""4.4.0-1128-aws"",
    ""user.language"": ""en"",
    ""user.timezone"": ""GMT""
  }
}
```",Eduardoamaral66,2025-01-03 13:14:48+00:00,[],2025-01-03 14:09:19+00:00,2025-01-03 14:09:18+00:00,https://github.com/metabase/metabase/issues/51735,[],"[{'comment_id': 2569259580, 'issue_id': 2767561620, 'author': 'paoliniluis', 'body': 'Resend has a bug https://github.com/metabase/metabase/issues/35143', 'created_at': datetime.datetime(2025, 1, 3, 13, 57, 55, tzinfo=datetime.timezone.utc)}, {'comment_id': 2569274374, 'issue_id': 2767561620, 'author': 'Eduardoamaral66', 'body': '> Resend has a bug [#35143](https://github.com/metabase/metabase/issues/35143)\n\nWow, thanks. I\'ve been trying to solve this issue for a while now. Reading through the issue, I found a workaround.\n\nIn case anyone else has this issue, in your Metabase email settings, change the ""Add recipients as CC or BCC"" property to CC.\nAlert and subscription emails will start being sent.', 'created_at': datetime.datetime(2025, 1, 3, 14, 9, 18, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-03 13:57:55 UTC): Resend has a bug https://github.com/metabase/metabase/issues/35143

Eduardoamaral66 (Issue Creator) on (2025-01-03 14:09:18 UTC): Wow, thanks. I've been trying to solve this issue for a while now. Reading through the issue, I found a workaround.

In case anyone else has this issue, in your Metabase email settings, change the ""Add recipients as CC or BCC"" property to CC.
Alert and subscription emails will start being sent.

"
2767469750,issue,closed,completed,Testing the Slack Integration,"**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**How important is this feature to you?**

**Additional context**
Add any other context or screenshots about the feature request here.
",brunobergher,2025-01-03 12:07:25+00:00,[],2025-01-03 12:23:15+00:00,2025-01-03 12:23:15+00:00,https://github.com/metabase/metabase/issues/51733,"[('Type:New Feature', ''), ('.Needs Triage', '')]",[],
2767176795,issue,closed,completed,test,,sugar-lover,2025-01-03 08:32:07+00:00,[],2025-01-03 08:32:32+00:00,2025-01-03 08:32:32+00:00,https://github.com/metabase/metabase/issues/51731,[],[],
2767141945,issue,open,,Automated Y-Axis between Min-Max values,"**Is your feature request related to a problem? Please describe.**
On a line or bar graph, default presentation of the graph includes 0. However sometimes numbers fluctuate around a certain value (i.e. 65-75%) and including 0 makes it hard to see little fluctuations. (see image below)

**Describe the solution you'd like**
Having an option to have axes automated around min-max values.

**Describe alternatives you've considered**
Manually adjusting the axes. This is A) time consuming for multiple views and B) subject to the changes in the KPI, it might exclude new values.

**How important is this feature to you?**
I would say 3 out 5. It is not crucial but it is essential to speed up the development of new dashboards.

**Additional context**
![Image](https://github.com/user-attachments/assets/e933e3ab-1bd5-4b2a-9657-eb031b03d314)
",kazimanil,2025-01-03 08:00:28+00:00,[],2025-02-04 20:31:20+00:00,,https://github.com/metabase/metabase/issues/51730,"[('Type:New Feature', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('Administration/Settings', '')]",[],
2766842403,issue,closed,completed,Add deactivated date to users table in app db,"**Is your feature request related to a problem? Please describe.**
The users table in app db has date joined but there is no date deactivated, so you can't really figure out how long was that user active for -- e.g.  how many months was the user active in order to calculate % active user by month. We used the updated date as a workaround but that got updated in batch in a recent version for all inactive accounts and so it is no longer usable. 

**Describe the solution you'd like**

Set Date Deactivated when the user is deactivated. 

**Describe alternatives you've considered**

Using updated date, but that no longer works as all deactivated account got updated by a recent new upgrade version. 

**How important is this feature to you?**

It's necessary to figure out # of enabled users for a given month, which is a denominator to calculate the % of active users to better understand usage. 

**Additional context**
Add any other context or screenshots about the feature request here.
",maxzheng,2025-01-03 01:05:08+00:00,['noahmoss'],2025-01-27 22:12:13+00:00,2025-01-09 19:51:57+00:00,https://github.com/metabase/metabase/issues/51728,"[('Type:New Feature', ''), ('Administration/People', 'and Groups. Also user Account Settings'), (':broom:', 'no-brainer cleanup issues to clear out when you have an hour left until EoD or something'), ('.Team/AdminWebapp', 'Admin and Webapp team')]",[],
2766746100,issue,open,,Provide checksums and signatures for released files,"Can we get the sha256 checksums back into the release notes? They're missing from recent releases.

Even better, would it be feasible to provide the typical checksum (*.sha256) plus signature (*.asc) files at https://downloads.metabase.com alongside the released .jar files?",j6r33n,2025-01-02 22:49:10+00:00,[],2025-01-27 10:38:11+00:00,,https://github.com/metabase/metabase/issues/51726,[],"[{'comment_id': 2568566284, 'issue_id': 2766746100, 'author': 'paoliniluis', 'body': '@iethree', 'created_at': datetime.datetime(2025, 1, 3, 0, 47, 10, tzinfo=datetime.timezone.utc)}, {'comment_id': 2608385195, 'issue_id': 2766746100, 'author': 'david-ape', 'body': 'We use nix to set up Metabase versions for local testing. The sha256 checksum is needed for that.', 'created_at': datetime.datetime(2025, 1, 22, 22, 17, 52, tzinfo=datetime.timezone.utc)}, {'comment_id': 2615393296, 'issue_id': 2766746100, 'author': 'fcharlaix-opendsi', 'body': 'We are using Ansible to update Metabase, to check if the update is needed we use the checksum of the JAR.', 'created_at': datetime.datetime(2025, 1, 27, 10, 38, 10, tzinfo=datetime.timezone.utc)}]","paoliniluis on (2025-01-03 00:47:10 UTC): @iethree

david-ape on (2025-01-22 22:17:52 UTC): We use nix to set up Metabase versions for local testing. The sha256 checksum is needed for that.

fcharlaix-opendsi on (2025-01-27 10:38:10 UTC): We are using Ansible to update Metabase, to check if the update is needed we use the checksum of the JAR.

"
2766742917,issue,closed,completed,speed up login e2e helper,,iethree,2025-01-02 22:46:43+00:00,['iethree'],2025-01-17 20:29:46+00:00,2025-01-07 21:59:02+00:00,https://github.com/metabase/metabase/issues/51725,[],[],
2766541278,issue,open,,Can't open info sidebar in the native editor when the Variables sidebar is opened,"### Describe the bug

<img width=""235"" alt=""Image"" src=""https://github.com/user-attachments/assets/cda080b4-f025-428d-aef0-8bc1a5d8dd0f"" />

When clicking on the (i) button in this state it just closes and opens the Variables sidebar instead of showing the info sidebar

### To Reproduce

1. Open any SQL question
2. Click on Variables button to open the Variables sidebar
3. Click on the (i) icon
4. Notice that the Variables sidebar is just closed instead of opening the info sidebar
5. Click on the (i) icon again
6. Notice the Variables sidebar opened again instead of opening the info sidebar

### Expected behavior

When Variables, Snippets, or Data explorer sidebar is opened, if clicking on (i) icon, close it and open info sidebar.
Then just close the info sidebar on the second click.

### Logs

_No response_

### Information about your Metabase installation

```JSON
73fe6a6
```

### Severity

Annoying

### Additional context

_No response_",mngr,2025-01-02 19:35:27+00:00,['rafpaf'],2025-02-04 20:28:41+00:00,,https://github.com/metabase/metabase/issues/51717,"[('Type:Bug', 'Product defects'), ('Priority:P2', 'Average run of the mill bug'), ('Querying/Native', 'The SQL/native query editor'), ('.Frontend', ''), ('.Team/AdminWebapp', 'Admin and Webapp team')]","[{'comment_id': 2587923231, 'issue_id': 2766541278, 'author': 'muratkeremozcan', 'body': 'Add the tests\n\n```typescript\ndescribe(""issue 51717"", () => {\n  beforeEach(() => {\n    H.restore();\n    cy.signInAsNormalUser();\n  });\n\n  it(""open info sidebar in the native editor when the Variables sidebar is opened (metabase#51717)"", () => {\n    cy.intercept(""/api/database"").as(""db"");\n    H.openNativeEditor().type(""SELECT 1"");\n    H.saveQuestion(""foo"");\n\n    cy.wait(""@db"");\n    cy.findByLabelText(""variable icon"").should(""be.visible"");\n    cy.findByLabelText(""variable icon"").click();\n\n    cy.findByTestId(""qb-header-info-button"").should(""be.visible"");\n    cy.findByTestId(""qb-header-info-button"").click();\n\n  });\n});\n\n```', 'created_at': datetime.datetime(2025, 1, 13, 18, 42, 10, tzinfo=datetime.timezone.utc)}]","muratkeremozcan on (2025-01-13 18:42:10 UTC): Add the tests

```typescript
describe(""issue 51717"", () => {
  beforeEach(() => {
    H.restore();
    cy.signInAsNormalUser();
  });

  it(""open info sidebar in the native editor when the Variables sidebar is opened (metabase#51717)"", () => {
    cy.intercept(""/api/database"").as(""db"");
    H.openNativeEditor().type(""SELECT 1"");
    H.saveQuestion(""foo"");

    cy.wait(""@db"");
    cy.findByLabelText(""variable icon"").should(""be.visible"");
    cy.findByLabelText(""variable icon"").click();

    cy.findByTestId(""qb-header-info-button"").should(""be.visible"");
    cy.findByTestId(""qb-header-info-button"").click();

  });
});

```

"
2766225329,issue,closed,completed,Testing integration,"**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**How important is this feature to you?**

**Additional context**
Add any other context or screenshots about the feature request here.
",brunobergher,2025-01-02 15:31:32+00:00,[],2025-01-02 15:31:43+00:00,2025-01-02 15:31:43+00:00,https://github.com/metabase/metabase/issues/51712,"[('Type:New Feature', ''), ('.Needs Triage', '')]",[],
2766217044,issue,open,,Goal line label can overlap with series labels,"**Context**

[Slack report](https://metaboat.slack.com/archives/C064QMXEV9N/p1735589599337089)

Goal line label should not overlap with series labels:
<img width=""191"" alt=""Image"" src=""https://github.com/user-attachments/assets/1bc73209-863a-4982-90d0-c539468db348"" />


",alxnddr,2025-01-02 15:26:15+00:00,[],2025-02-04 20:31:23+00:00,,https://github.com/metabase/metabase/issues/51711,"[('Type:Bug', 'Product defects'), ('Priority:P3', 'Cosmetic bugs, minor bugs with a clear workaround'), ('.Frontend', ''), ('Visualization/Charts', 'Line, area, bar, combo, and scatter charts.'), ('.Team/DashViz', 'Dashboard and Viz team')]",[],
2766177090,issue,open,,Allow users to create/edit custom notification templates,"**Is your feature request related to a problem? Please describe.**
There are tons of settings users ask us to add when it comes to the content and display of notifications (alerts, subscriptions, posts to Slack, etc).

**Describe the solution you'd like**
Let's allow users to edit templates themselves, such that we offer a scalable escape hatch for these needs.

**Describe alternatives you've considered**
Making everything an option, which would lead to knob-hell.

**Additional context**
Most likely going to be handled soon by the Notifications arc.
",brunobergher,2025-01-02 15:00:54+00:00,[],2025-02-04 20:31:07+00:00,,https://github.com/metabase/metabase/issues/51710,"[('Reporting/Pulses', 'Now called Subscriptions'), ('Type:New Feature', ''), ('Misc/Emails', ''), ('.Team/Workflows', 'aka BEC')]",[],
2764503276,issue,open,,Dashboard filters - prevent custom text input in dropdowns that are populated from existing data,"### Describe the bug

Typing in the dropdown search box and pressing enter when no matching values are found adds the input as a custom option. However, since the dropdown is populated from existing data, custom text entries will never return any results.
It's not a case of the filter returning incorrect data, but rather having something in place to notify the value entered isn't correct, or prevent this from happening.

### To Reproduce

For this, the field is of Category type and filtering is set to ""A list of all values"" in Table Metadata settings.

Create a question, and place it on a dashboard with a filter associated.
Confirm you can search the filter values and apply them to the dashboard.

<img width=""840"" alt=""Image"" src=""https://github.com/user-attachments/assets/5f120e6a-49da-4e6d-8fb1-7f28de47d2d5"" />

<br>
<br>



Type in a value you know doesn't exist and see it become populated as an available filter value

<img width=""840"" alt=""Image"" src=""https://github.com/user-attachments/assets/91e2c5d5-9de1-4841-af0d-8792cb5f3213"" />


<br>


<img width=""654"" alt=""Image"" src=""https://github.com/user-attachments/assets/176b0022-2649-44c0-bb86-5a383a4cfe7d"" />




### Expected behavior

Either prevent the option for custom values to be added, or notify the end user the value entered is not valid for the filter.

### Logs

_No response_

### Information about your Metabase installation

```JSON
{
  ""browser-info"": {
    ""language"": ""en-US"",
    ""platform"": ""MacIntel"",
    ""userAgent"": ""Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"",
    ""vendor"": ""Google Inc.""
  },
  ""metabase-info"": {
    ""databases"": [
      ""snowflake"",
      ""postgres"",
      ""mysql"",
      ""mongo"",
      ""h2"",
      ""bigquery-cloud-sdk""
    ],
    ""run-mode"": ""prod"",
    ""plan-alias"": ""enterprise-self-hosted"",
    ""version"": {
      ""date"": ""2024-12-14"",
      ""tag"": ""v1.52.3"",
      ""hash"": ""6f76bb6""
    },
    ""settings"": {
      ""report-timezone"": null
    },
    ""hosting-env"": ""unknown"",
    ""application-database"": ""postgres"",
    ""application-database-details"": {
      ""database"": {
        ""name"": ""PostgreSQL"",
        ""version"": ""15.3""
      },
      ""jdbc-driver"": {
        ""name"": ""PostgreSQL JDBC Driver"",
        ""version"": ""42.7.3""
      }
    }
  },
  ""system-info"": {
    ""file.encoding"": ""UTF-8"",
    ""java.runtime.name"": ""OpenJDK Runtime Environment"",
    ""java.runtime.version"": ""11.0.22+7"",
    ""java.vendor"": ""Eclipse Adoptium"",
    ""java.vendor.url"": ""https://adoptium.net/"",
    ""java.version"": ""11.0.22"",
    ""java.vm.name"": ""OpenJDK 64-Bit Server VM"",
    ""java.vm.version"": ""11.0.22+7"",
    ""os.name"": ""Mac OS X"",
    ""os.version"": ""14.5"",
    ""user.language"": ""en"",
    ""user.timezone"": ""America/Chicago""
  }
}
```

### Severity

P2 - Could be confusing to end users

### Additional context

_No response_",FilmonK,2024-12-31 16:01:31+00:00,[],2025-02-04 20:29:45+00:00,,https://github.com/metabase/metabase/issues/51704,"[('Priority:P2', 'Average run of the mill bug'), ('Querying/Parameters & Variables', 'Filter widgets, field filters, variables etc.'), ('.Frontend', ''), ('.Product Input Needed', ''), ('.Team/Querying', ''), ('Reporting/Dashboards/Filters & Parameters', 'Related to the setup and use of filters and parameters in dashboards only')]","[{'comment_id': 2569391854, 'issue_id': 2764503276, 'author': 'ranquild', 'body': 'Please do not change this so lightly without a confirmation from Product. Field values might be out of sync, and it is intentional that there is a way to enter any value now.', 'created_at': datetime.datetime(2025, 1, 3, 15, 22, 26, tzinfo=datetime.timezone.utc)}]","ranquild on (2025-01-03 15:22:26 UTC): Please do not change this so lightly without a confirmation from Product. Field values might be out of sync, and it is intentional that there is a way to enter any value now.

"
2764241657,issue,open,,Logging: Add more logging around Dashboard Subscriptions,"**Is your feature request related to a problem? Please describe.**

On version 52 we do get some logging of when a subscription goes out like this:

<img width=""1506"" alt=""Image"" src=""https://github.com/user-attachments/assets/45c05160-00fc-47fc-801e-e74b9d7054a2"" />

The issue is that you don't have visibility of what is going on. Let me share a real life example ... There are 608 subscriptions on a dashboard that fires every Monday at 2 am. At 2 am you will see below that the CPU keeps going up and up and up, until it got killed (metabase ends up with an OOM) ... Leaving 160 from those 608 subscriptions in an unknown state (won't be sent after restart)

<img width=""745"" alt=""Image"" src=""https://github.com/user-attachments/assets/9eda160b-63a1-4466-b1ee-466a47ad3f50"" />

The logs don't really show what is going on or what is happening at metabase level. 

**Describe the solution you'd like**

Additional logging on what's going on during a subscription. Dashboard_id, subscription_id that is being run, number of questions rendered, if a subscription fails point to which question, number of DB connections opened.

Best case would be as if you opened a dashboard directly, you will see calls to cards like this:

`POST /api/dashboard/1/dashcard/23/card/20/query 202`

Having a similar output during subscriptions would help with debugging

**Describe alternatives you've considered**
Use grafana to monitor other resources like connection pool and so on.

**How important is this feature to you?**

",Tony-metabase,2024-12-31 10:53:44+00:00,[],2025-02-04 20:30:35+00:00,,https://github.com/metabase/metabase/issues/51701,"[('Reporting/Pulses', 'Now called Subscriptions'), ('Type:New Feature', ''), ('.Team/Workflows', 'aka BEC'), ('Operation/Logging', ""Related to what and how we log things to log files/SDOUT (don't confuse with Usage Analytics/Audit)"")]",[],
